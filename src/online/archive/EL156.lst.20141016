* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56******************************************************************
    57
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   3
* EL156.cbl
    59 ENVIRONMENT DIVISION.
    60
    61 DATA DIVISION.
    62
    63 WORKING-STORAGE SECTION.
    64 01  DFH-START PIC X(04).
    65
    66 77  FILLER  PIC X(32)  VALUE '********************************'.
    67 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    68 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    69 77  WS-SSN  PIC X(9) VALUE ZEROS.
    70 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    71 77  C0                          PIC S999 COMP-3 VALUE +0.
    72 77  C1                          PIC S999 COMP-3 VALUE +0.
    73 77  C2                          PIC S999 COMP-3 VALUE +0.
    74 77  C3                          PIC S999 COMP-3 VALUE +0.
    75 77  s1                          PIC S999 COMP-3 VALUE +0.
    76 77  s2                          pic s999 comp-3 value +0.
    77 77  P1                          PIC S999 COMP-3 VALUE +0.
    78 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    81 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    82 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    83 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    84 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    85 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    86 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    87 77  ws-max-bens                 pic s999 comp-3 value +0.
    88 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    89 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    90 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    91 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    92 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    93
    94*    COPY ELCSCTM.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCTM                             *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-MESSAGE.
   105     12  FILLER                          PIC X(30)
   106            VALUE '** LOGIC SECURITY VIOLATION -'.
   107     12  SM-READ                         PIC X(6).
   108     12  FILLER                          PIC X(5)
   109            VALUE ' PGM='.
   110     12  SM-PGM                          PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' OPR='.
   113     12  SM-PROCESSOR-ID                 PIC X(4).
   114     12  FILLER                          PIC X(6)
   115            VALUE ' TERM='.
   116     12  SM-TERMID                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   4
* EL156.cbl
   117     12  FILLER                          PIC XX   VALUE SPACE.
   118     12  SM-JUL-DATE                     PIC 9(5).
   119     12  FILLER                          PIC X    VALUE SPACE.
   120     12  SM-TIME                         PIC 99.99.
   121
   122
   123*    COPY ELCSCRTY.
   124******************************************************************
   125*                                                                *
   126*                                                                *
   127*                            ELCSCRTY                            *
   128*                            VMOD=2.001                          *
   129*                                                                *
   130*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   131*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   132*        SAVED IN PI-SECURITY-ADDRESS.                           *
   133*                                                                *
   134******************************************************************
   135 01  SECURITY-CONTROL.
   136     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   137     12  FILLER                       PIC XX    VALUE 'SC'.
   138     12  SC-CREDIT-CODES.
   139         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   140             20  SC-CREDIT-DISPLAY    PIC X.
   141             20  SC-CREDIT-UPDATE     PIC X.
   142     12  SC-CLAIMS-CODES.
   143         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   144             20  SC-CLAIMS-DISPLAY    PIC X.
   145             20  SC-CLAIMS-UPDATE     PIC X.
   146
   147 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   148 01  WS-DATE-AREA.
   149     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   150     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   151     12  SAVE-DATE-CCYYMMDD.
   152         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   153         16  SAVE-DATE-YMD.
   154             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   155             20  FILLER              PIC X(04)   VALUE SPACES.
   156
   157 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   158 01  STANDARD-AREAS.
   159     12  WS-RESPONSE         PIC S9(8)   COMP.
   160         88  WS-RESP-NORMAL              VALUE +00.
   161         88  WS-RESP-ERROR               VALUE +01.
   162         88  WS-RESP-NOTFND              VALUE +13.
   163         88  WS-RESP-DUPREC              VALUE +14.
   164         88  WS-RESP-ENDFILE             VALUE +20.
   165     12  PMT-HEAD-A.
   166         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   167         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   168         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   169-        '     RESERVES  TYPE    AMOUNT'.
   170     12  PMT-HEAD-B.
   171         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   172         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   173         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   174     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   5
* EL156.cbl
   175     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   176     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   177     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   178     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   179     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   180     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   181     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   182     12  PGM-NAME            PIC X(8).
   183     12  TIME-IN             PIC S9(7).
   184     12  TIME-OUT-R  REDEFINES TIME-IN.
   185         16  FILLER          PIC X.
   186         16  TIME-OUT        PIC 99V99.
   187         16  FILLER          PIC XX.
   188     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   189     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   190     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   191     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   192     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   193     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   194     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   195     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   196     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   197     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   198     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   199     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   200     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   201     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   202     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   203     12  WS-BLANK            PIC X       VALUE ' '.
   204
   205 01  MISC-WORK-AREAS.
   206     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   207     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   208     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   209     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   210     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   211     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   212     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   213     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   214     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   215     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   216     12  W-CALLED-NAME           PIC X(08).
   217     12  W-EOB-CODES.
   218         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   219             20  W-EOB-CODE      PIC XXX.
   220             20  W-EOB-FILLER    PIC X.
   221     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   222     12  W-NAME-LAST             PIC X(15).
   223     12  W-NAME-FIRST            PIC X(15).
   224     12  W-NAME-MIDDLE.
   225         16  FILLER              PIC X.
   226         16  W-NAME-MIDDLE-2     PIC X.
   227         16  FILLER              PIC X(13).
   228     12  W-DMD-CHECK-NO.
   229         16  W-DMD-CHECK-NO-1    PIC X(4).
   230         16  W-DMD-CHECK-NO-2    PIC X.
   231         16  W-DMD-CHECK-NO-3    PIC XX.
   232
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   6
* EL156.cbl
   233     12  WS-COMPUTE-FROM-DT  PIC XX.
   234     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   235     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   236     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   237     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   238     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   239     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   240         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   241         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   242     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   243         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   244     12  WS-UPDATE-SW        PIC X VALUE ' '.
   245     12  WS-GROUPING.
   246         16  WS-GROUP-1      PIC X VALUE SPACES.
   247         16  FILLER          PIC X(05) VALUE SPACES.
   248     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   249     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   250     12  WS-WORK-STATE-ACCT.
   251         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   252         16  FILLER          PIC X       VALUE '/'.
   253         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   254     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   255     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   256     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   257     12  QID.
   258         16  QID-TERM        PIC X(4)    VALUE SPACES.
   259         16  FILLER          PIC X(4)    VALUE '156A'.
   260     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   261     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   262     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   263     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   264     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   265     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   266     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   267     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   268     12  WS-STATUS           PIC X       VALUE SPACES.
   269     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   270     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   271     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   272     12  ws-extended-exp-dt  pic xx      value low-values.
   273     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   274     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   275     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   276     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   277     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   278     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   279     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   280     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   281     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   282     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   283     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   284     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   285     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   286     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   287     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   288     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   289     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   290     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   7
* EL156.cbl
   291     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   292     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   293     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   294     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   295     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   296     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   297     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   298     12  WORK-DATE-FROM.
   299         16  WDF-MONTH       PIC 99        VALUE ZERO.
   300         16  WDF-DAY         PIC 99        VALUE ZERO.
   301         16  WDF-YEAR        PIC 99        VALUE ZERO.
   302     12  WORK-DATE-THRU.
   303         16  WDT-MONTH       PIC 99        VALUE ZERO.
   304         16  WDT-DAY         PIC 99        VALUE ZERO.
   305         16  WDT-YEAR        PIC 99        VALUE ZERO.
   306     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   307     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   308     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   309     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   310     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   311     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   312     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   313     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   314     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   315     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   316     12  WS-PY-WK REDEFINES WS-PY-WORK.
   317         16  WS-PY-NUM       PIC S9(7)V99.
   318         16  WS-PY-SIGN      PIC X.
   319     12  WS-DY-WORK          PIC S9(5).
   320     12  WS-DY-WK REDEFINES WS-DY-WORK.
   321         16  WS-DY-NUM       PIC S9(4).
   322         16  WS-DY-SIGN      PIC X.
   323     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   324         88  COMP-REC-FOUND              VALUE 'Y'.
   325     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   326         88  BENEFIT-FOUND       VALUE 'Y'.
   327         88  NO-BENEFIT-FOUND    VALUE 'N'.
   328     12  WS-TERMS.
   329         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   330         16  FILLER          PIC X       VALUE '/'.
   331         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   332         16  WST-REM-DAYS-GRP.
   333             20  WST-SLASH   PIC X       VALUE '/'.
   334             20  WST-REM-DAYS
   335                             PIC --9.
   336     12  WS-ACCESS.
   337         16  FILLER          PIC XX      VALUE SPACES.
   338         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   339     12  WS-STATE-ACCESS.
   340         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   341         16  FILLER          PIC XX      VALUE SPACES.
   342     12  WS-CARR-ACCESS.
   343         16  FILLER          PIC X(3)    VALUE SPACES.
   344         16  WS-CARR         PIC X       VALUE SPACES.
   345     12  DATE-WORK.
   346         16  FILLER          PIC XX      VALUE SPACES.
   347         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   348     12  WS-SAVE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   8
* EL156.cbl
   349         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   350         16  WS-PAYEE        PIC XX      VALUE SPACE.
   351         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   352         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   353         16  WS-OFFLINE      PIC X       VALUE SPACE.
   354         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   355         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   356         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   357         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   358         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   359         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   360         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   361         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   362         16  WS-ETYPE        PIC X       VALUE SPACE.
   363         16  WS-CASH         PIC X       VALUE SPACE.
   364         16  WS-GROUPED      PIC X       VALUE SPACE.
   365         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   366         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   367         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   368         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   369         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   370         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   371         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   372         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   373     12  LAST-ERROR-LINE.
   374         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   375         16  FILLER              PIC X(30)
   376             VALUE ' FATAL ERRORS ENCOUNTERED'.
   377         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   378         16  FILLER              PIC X(28)
   379             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   380     12  WS-CHECK-AREA.
   381         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   382         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   383     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   384     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   385         16  FILLER              PIC XX.
   386         16  WS-A-CHECK-NUM-5    PIC 9(5).
   387     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   388         16  FILLER              PIC X.
   389         16  WS-A-CHECK-NUM-6    PIC 9(6).
   390     12  OPTION-1-SAVE-AREA.
   391         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   392         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   393     12  WS-WORK-ZIP.
   394         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   395         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   396     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   397                                 PIC 9(9).
   398     12  WS-FLI-PMTNOTE.
   399         16  WS-PMTOPTION        PIC XX.
   400         16  WS-DOCNAME          PIC X(28).
   401         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   402             20  WS-AMOUNT       PIC X(8).
   403             20  FILLER          PIC X(20).
   404         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   405             20  WS-NUM-AMT      PIC 9(6)V99.
   406             20  FILLER          PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   9
* EL156.cbl
   407
   408     12  WS-HAN-PMTNOTE.
   409         16  WS-HAN-PMT-CODE     PIC X.
   410         16  WS-HAN-PMT-NOTE     PIC X(39).
   411
   412     12  WS-NCL-PMT-OPTION       PIC XX.
   413         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   414
   415     12  WS-CLAIM-SEQUENCE.
   416         16  FILLER              PIC X VALUE '('.
   417         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   418         16  FILLER              PIC X(04) VALUE ' OF '.
   419         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   420         16  FILLER              PIC X VALUE ')'.
   421
   422     12  WS-REFUND-AMT           PIC Z(7).99.
   423     12  WS-CALC-INT             PIC S9(7)V99.
   424     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   425
   426     12  SUB                     PIC 99 VALUE ZEROS.
   427
   428     12  WS-BOANOTE1.
   429         16  WS-BOANOTE1-DESC    PIC X(11).
   430         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   431         16  FILLER              PIC X(17).
   432     12  WS-BOANOTE2.
   433         16  WS-BOANOTE2-DESC    PIC X(11).
   434         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   435         16  FILLER              PIC X(17).
   436
   437     12  WS-NCLNOTE1.
   438         16  WS-NCLNOTE1-DESC    PIC X(11).
   439         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   440         16  FILLER              PIC X(17).
   441     12  WS-NCLNOTE2.
   442         16  WS-NCLNOTE2-DESC    PIC X(11).
   443         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   444         16  FILLER              PIC X(17).
   445
   446     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   447     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   448     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   449     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   450     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   451     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   452     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   453     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   454     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   455     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   456
   457     12  WS-AIG-WORK-AREAS.
   458         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   459             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   460         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   461             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   462         16  WS-FROM-DATE-MDY.
   463             20  WS-FROM-MO      PIC 99.
   464             20  WS-FROM-DA      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  10
* EL156.cbl
   465             20  WS-FROM-YR      PIC 99.
   466         16  WS-TEMP-DATE-MDY.
   467             20  WS-TEMP-MO      PIC 99.
   468             20  WS-TEMP-DA      PIC 99.
   469             20  WS-TEMP-YR      PIC 99.
   470         16  WS-BIN-FROM-DT      PIC XX.
   471         16  WS-TEMP-INC-MDY.
   472             20  WS-TEMP-INC-MO  PIC 99.
   473             20  WS-TEMP-INC-DA  PIC 99.
   474             20  WS-TEMP-INC-YR  PIC 99.
   475         16  WS-PMT-DUE-MDY.
   476             20  WS-PMT-DUE-MO   PIC 99.
   477             20  WS-PMT-DUE-DA   PIC 99.
   478             20  WS-PMT-DUE-YR   PIC 99.
   479         16  WS-PMT-DUE-DT       PIC XX.
   480         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   481         16  WS-RETRO-ELIM-DT    PIC XX.
   482         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   483             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   484         16  WS-SAVE-DUE-DA      PIC 99.
   485         16  WS-CDAYS            PIC S9(05).
   486         16  WS-DAYS-OFF         PIC S9(05).
   487         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   488             88  ELIM-SATISFIED            VALUE 'Y'.
   489         16  WS-AIG-CHECKNO.
   490             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   491             20  WS-A-CHECKNO-3-7.
   492                 24  FILLER              PIC X(3)    VALUE SPACES.
   493                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   494                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   495         16  WS-AIG-GROUPING.
   496             20  WS-A-BENE               PIC XXX.
   497             20  FILLER                  PIC XXX.
   498         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   499             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   500             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   501         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   502                 VALUE 'UNEMPLOYMENT PAYMENT'.
   503         16  WS-CHK-THRU-DT              PIC XX.
   504         16  WS-HOLD-BIN-DATE-1          PIC XX.
   505
   506 01  MISC-CSO-AREA.
   507     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   508     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   509     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   510         88  APPROVAL-NEEDED                        VALUE 'Y'.
   511     12  WS-APPROV-NOTE                  PIC X(43)
   512         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   513     12  WS-3550-APPROV-NOTE             PIC X(43)
   514         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   515     12  WS-REAUDIT-NOTE                 PIC X(43)
   516         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   517     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   518     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   519     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   520     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   521     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   522     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  11
* EL156.cbl
   523     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   524         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   525     12  WS-PAYEE-CITY-STATE     PIC X(30).
   526     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   527         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   528     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   529     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   530     12  WS-WORK-NAME            PIC X(30).
   531     12  FILLER  REDEFINES WS-WORK-NAME.
   532         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   533     12  WS-INSURED-NAME         PIC X(30).
   534     12  FILLER  REDEFINES WS-INSURED-NAME.
   535         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   536     12  WS-PAYEE-NAME           PIC X(30).
   537     12  FILLER  REDEFINES WS-PAYEE-NAME.
   538         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   539
   540 01  ERROR-MESSAGES.
   541     12  ER-0000                 PIC X(4)  VALUE '0000'.
   542     12  ER-0004                 PIC X(4)  VALUE '0004'.
   543     12  ER-0008                 PIC X(4)  VALUE '0008'.
   544     12  ER-0019                 PIC X(4)  VALUE '0019'.
   545     12  ER-0029                 PIC X(4)  VALUE '0029'.
   546     12  ER-0042                 PIC X(4)  VALUE '0042'.
   547     12  ER-0070                 PIC X(4)  VALUE '0070'.
   548     12  ER-0130                 PIC X(4)  VALUE '0130'.
   549     12  ER-0149                 PIC X(4)  VALUE '0149'.
   550     12  ER-0154                 PIC X(4)  VALUE '0154'.
   551     12  ER-0168                 PIC X(4)  VALUE '0168'.
   552     12  ER-0169                 PIC X(4)  VALUE '0169'.
   553     12  ER-0172                 PIC X(4)  VALUE '0174'.
   554     12  ER-0198                 PIC X(4)  VALUE '0198'.
   555     12  ER-0204                 PIC X(4)  VALUE '0204'.
   556     12  ER-0206                 PIC X(4)  VALUE '0206'.
   557     12  ER-0252                 PIC X(4)  VALUE '0252'.
   558     12  ER-0254                 PIC X(4)  VALUE '0254'.
   559     12  ER-0282                 PIC X(4)  VALUE '0282'.
   560     12  ER-0283                 PIC X(4)  VALUE '0283'.
   561     12  ER-0294                 PIC X(4)  VALUE '0294'.
   562     12  ER-0338                 PIC X(4)  VALUE '0338'.
   563     12  ER-0419                 PIC X(4)  VALUE '0419'.
   564     12  ER-0420                 PIC X(4)  VALUE '0420'.
   565     12  ER-0421                 PIC X(4)  VALUE '0421'.
   566     12  ER-0422                 PIC X(4)  VALUE '0422'.
   567     12  ER-0433                 PIC X(4)  VALUE '0433'.
   568     12  ER-0436                 PIC X(4)  VALUE '0436'.
   569     12  ER-0437                 PIC X(4)  VALUE '0437'.
   570     12  ER-0438                 PIC X(4)  VALUE '0438'.
   571     12  ER-0439                 PIC X(4)  VALUE '0439'.
   572     12  ER-0440                 PIC X(4)  VALUE '0440'.
   573     12  ER-0441                 PIC X(4)  VALUE '0441'.
   574     12  ER-0442                 PIC X(4)  VALUE '0442'.
   575     12  ER-0443                 PIC X(4)  VALUE '0443'.
   576     12  ER-0444                 PIC X(4)  VALUE '0444'.
   577     12  ER-0445                 PIC X(4)  VALUE '0445'.
   578     12  ER-0446                 PIC X(4)  VALUE '0446'.
   579     12  ER-0447                 PIC X(4)  VALUE '0447'.
   580     12  ER-0448                 PIC X(4)  VALUE '0448'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  12
* EL156.cbl
   581     12  ER-0449                 PIC X(4)  VALUE '0449'.
   582     12  ER-0452                 PIC X(4)  VALUE '0452'.
   583     12  ER-0458                 PIC X(4)  VALUE '0458'.
   584     12  ER-0459                 PIC X(4)  VALUE '0459'.
   585     12  ER-0460                 PIC X(4)  VALUE '0460'.
   586     12  ER-0461                 PIC X(4)  VALUE '0461'.
   587     12  ER-0462                 PIC X(4)  VALUE '0462'.
   588     12  ER-0463                 PIC X(4)  VALUE '0463'.
   589     12  ER-0464                 PIC X(4)  VALUE '0464'.
   590     12  ER-0465                 PIC X(4)  VALUE '0465'.
   591     12  ER-0466                 PIC X(4)  VALUE '0466'.
   592     12  ER-0467                 PIC X(4)  VALUE '0467'.
   593     12  ER-0468                 PIC X(4)  VALUE '0468'.
   594     12  ER-0469                 PIC X(4)  VALUE '0469'.
   595     12  ER-0473                 PIC X(4)  VALUE '0473'.
   596     12  ER-0474                 PIC X(4)  VALUE '0474'.
   597     12  ER-0475                 PIC X(4)  VALUE '0475'.
   598     12  ER-0476                 PIC X(4)  VALUE '0476'.
   599     12  ER-0477                 PIC X(4)  VALUE '0477'.
   600     12  ER-0478                 PIC X(4)  VALUE '0478'.
   601     12  ER-0479                 PIC X(4)  VALUE '0479'.
   602     12  ER-0481                 PIC X(4)  VALUE '0481'.
   603     12  ER-0491                 PIC X(4)  VALUE '0491'.
   604     12  ER-0492                 PIC X(4)  VALUE '0492'.
   605     12  ER-0493                 PIC X(4)  VALUE '0493'.
   606     12  ER-0494                 PIC X(4)  VALUE '0494'.
   607     12  ER-0495                 PIC X(4)  VALUE '0495'.
   608     12  ER-0499                 PIC X(4)  VALUE '0499'.
   609     12  ER-0500                 PIC X(4)  VALUE '0500'.
   610     12  ER-0501                 PIC X(4)  VALUE '0501'.
   611     12  ER-0502                 PIC X(4)  VALUE '0502'.
   612     12  ER-0508                 PIC X(4)  VALUE '0508'.
   613     12  ER-0513                 PIC X(4)  VALUE '0513'.
   614     12  ER-0518                 PIC X(4)  VALUE '0518'.
   615     12  ER-0524                 PIC X(4)  VALUE '0524'.
   616     12  ER-0525                 PIC X(4)  VALUE '0525'.
   617     12  ER-0526                 PIC X(4)  VALUE '0526'.
   618     12  ER-0530                 PIC X(4)  VALUE '0530'.
   619     12  ER-0540                 PIC X(4)  VALUE '0540'.
   620     12  ER-0541                 PIC X(4)  VALUE '0541'.
   621     12  ER-0542                 PIC X(4)  VALUE '0542'.
   622     12  ER-0543                 PIC X(4)  VALUE '0543'.
   623     12  ER-0545                 PIC X(4)  VALUE '0545'.
   624     12  ER-0552                 PIC X(4)  VALUE '0552'.
   625     12  ER-0555                 PIC X(4)  VALUE '0555'.
   626     12  ER-0556                 PIC X(4)  VALUE '0556'.
   627     12  ER-0557                 PIC X(4)  VALUE '0557'.
   628     12  ER-0572                 PIC X(4)  VALUE '0572'.
   629     12  ER-0573                 PIC X(4)  VALUE '0573'.
   630     12  ER-0594                 PIC X(4)  VALUE '0594'.
   631     12  ER-0616                 PIC X(4)  VALUE '0616'.
   632     12  ER-0617                 PIC X(4)  VALUE '0617'.
   633     12  ER-0618                 PIC X(4)  VALUE '0618'.
   634     12  ER-0657                 PIC X(4)  VALUE '0657'.
   635     12  ER-0658                 PIC X(4)  VALUE '0658'.
   636     12  ER-0699                 PIC X(4)  VALUE '0699'.
   637     12  ER-0730                 PIC X(4)  VALUE '0730'.
   638     12  ER-0737                 PIC X(4)  VALUE '0737'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  13
* EL156.cbl
   639     12  ER-0760                 PIC X(4)  VALUE '0760'.
   640     12  ER-0768                 PIC X(4)  VALUE '0768'.
   641     12  ER-0769                 PIC X(4)  VALUE '0769'.
   642     12  ER-0770                 PIC X(4)  VALUE '0770'.
   643     12  ER-0802                 PIC X(4)  VALUE '0802'.
   644     12  ER-0803                 PIC X(4)  VALUE '0803'.
   645     12  ER-0819                 PIC X(4)  VALUE '0819'.
   646     12  ER-0834                 PIC X(4)  VALUE '0834'.
   647     12  ER-0836                 PIC X(4)  VALUE '0836'.
   648     12  ER-0844                 PIC X(4)  VALUE '0844'.
   649     12  ER-0845                 PIC X(4)  VALUE '0845'.
   650     12  ER-0846                 PIC X(4)  VALUE '0846'.
   651     12  ER-0849                 PIC X(4)  VALUE '0849'.
   652     12  ER-0851                 PIC X(4)  VALUE '0851'.
   653     12  ER-0872                 PIC X(4)  VALUE '0872'.
   654     12  ER-0873                 PIC X(4)  VALUE '0873'.
   655     12  ER-0874                 PIC X(4)  VALUE '0874'.
   656     12  ER-0879                 PIC X(4)  VALUE '0879'.
   657     12  ER-0919                 PIC X(4)  VALUE '0919'.
   658     12  ER-0921                 PIC X(4)  VALUE '0921'.
   659     12  ER-0923                 PIC X(4)  VALUE '0923'.
   660     12  ER-0925                 PIC X(4)  VALUE '0925'.
   661     12  ER-0944                 PIC X(4)  VALUE '0944'.
   662     12  ER-0945                 PIC X(4)  VALUE '0945'.
   663     12  ER-0946                 PIC X(4)  VALUE '0946'.
   664     12  ER-0947                 PIC X(4)  VALUE '0947'.
   665     12  ER-0948                 PIC X(4)  VALUE '0948'.
   666     12  ER-0949                 PIC X(4)  VALUE '0949'.
   667     12  ER-0950                 PIC X(4)  VALUE '0950'.
   668     12  ER-0951                 PIC X(4)  VALUE '0951'.
   669     12  ER-0954                 PIC X(4)  VALUE '0954'.
   670     12  ER-0956                 PIC X(4)  VALUE '0956'.
   671     12  ER-0967                 PIC X(4)  VALUE '0967'.
   672     12  ER-0968                 PIC X(4)  VALUE '0968'.
   673     12  ER-0974                 PIC X(4)  VALUE '0974'.
   674     12  ER-0975                 PIC X(4)  VALUE '0975'.
   675     12  ER-1561                 PIC X(4)  VALUE '1561'.
   676     12  ER-1566                 PIC X(4)  VALUE '1566'.
   677     12  ER-1567                 PIC X(4)  VALUE '1567'.
   678     12  ER-1569                 PIC X(4)  VALUE '1569'.
   679     12  er-1657                 pic x(4)  value '1657'.
   680     12  er-1658                 pic x(4)  value '1658'.
   681     12  er-1667                 pic x(4)  value '1667'.
   682     12  er-1670                 pic x(4)  value '1670'.
   683     12  er-1671                 pic x(4)  value '1671'.
   684     12  er-1672                 pic x(4)  value '1672'.
   685     12  er-1673                 pic x(4)  value '1673'.
   686     12  er-1674                 pic x(4)  value '1674'.
   687     12  er-1677                 pic x(4)  value '1677'.
   688     12  ER-1775                 PIC X(4)  VALUE '1775'.
   689     12  ER-1880                 PIC X(4)  VALUE '1880'.
   690     12  ER-2044                 PIC X(4)  VALUE '2044'.
   691     12  ER-3140                 PIC X(4)  VALUE '3140'.
   692     12  ER-3141                 PIC X(4)  VALUE '3141'.
   693     12  ER-3255                 PIC X(4)  VALUE '3255'.
   694     12  ER-3516                 PIC X(4)  VALUE '3516'.
   695     12  ER-3527                 PIC X(4)  VALUE '3527'.
   696     12  ER-3528                 PIC X(4)  VALUE '3528'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  14
* EL156.cbl
   697     12  ER-3529                 PIC X(4)  VALUE '3529'.
   698     12  ER-3530                 PIC X(4)  VALUE '3530'.
   699     12  ER-3531                 PIC X(4)  VALUE '3531'.
   700     12  ER-3532                 PIC X(4)  VALUE '3532'.
   701     12  ER-3533                 PIC X(4)  VALUE '3533'.
   702     12  ER-3534                 PIC X(4)  VALUE '3534'.
   703     12  ER-3535                 PIC X(4)  VALUE '3535'.
   704     12  ER-3536                 PIC X(4)  VALUE '3536'.
   705     12  ER-3537                 PIC X(4)  VALUE '3537'.
   706     12  ER-3538                 PIC X(4)  VALUE '3538'.
   707     12  ER-3539                 PIC X(4)  VALUE '3539'.
   708     12  ER-3540                 PIC X(4)  VALUE '3540'.
   709     12  ER-3541                 PIC X(4)  VALUE '3541'.
   710     12  ER-3542                 PIC X(4)  VALUE '3542'.
   711     12  ER-3543                 PIC X(4)  VALUE '3543'.
   712     12  ER-3546                 PIC X(4)  VALUE '3546'.
   713     12  ER-3549                 PIC X(4)  VALUE '3549'.
   714     12  ER-3818                 PIC X(4)  VALUE '3818'.
   715     12  ER-7540                 PIC X(4)  VALUE '7540'.
   716     12  ER-7576                 PIC X(4)  VALUE '7576'.
   717     12  ER-7579                 PIC X(4)  VALUE '7579'.
   718     12  ER-7580                 PIC X(4)  VALUE '7580'.
   719     12  ER-7583                 PIC X(4)  VALUE '7583'.
   720     12  ER-7830                 PIC X(4)  VALUE '7830'.
   721     12  ER-7831                 PIC X(4)  VALUE '7831'.
   722     12  ER-7832                 PIC X(4)  VALUE '7832'.
   723     12  ER-7833                 PIC X(4)  VALUE '7833'.
   724     12  ER-7834                 PIC X(4)  VALUE '7834'.
   725     12  ER-7835                 PIC X(4)  VALUE '7835'.
   726     12  ER-7836                 PIC X(4)  VALUE '7836'.
   727     12  ER-7837                 PIC X(4)  VALUE '7837'.
   728     12  ER-7838                 PIC X(4)  VALUE '7838'.
   729     12  ER-7841                 PIC X(4)  VALUE '7841'.
   730     12  ER-7844                 PIC X(4)  VALUE '7844'.
   731     12  ER-7845                 PIC X(4)  VALUE '7845'.
   732     12  ER-8000                 PIC X(4)  VALUE '8000'.
   733     12  ER-8051                 PIC X(4)  VALUE '8051'.
   734     12  ER-8052                 PIC X(4)  VALUE '8052'.
   735     12  ER-8053                 PIC X(4)  VALUE '8053'.
   736     12  ER-8054                 PIC X(4)  VALUE '8054'.
   737     12  ER-8055                 PIC X(4)  VALUE '8055'.
   738     12  ER-8056                 PIC X(4)  VALUE '8056'.
   739     12  ER-8057                 PIC X(4)  VALUE '8057'.
   740     12  ER-8058                 PIC X(4)  VALUE '8058'.
   741     12  ER-8059                 PIC X(4)  VALUE '8059'.
   742     12  ER-8060                 PIC X(4)  VALUE '8060'.
   743     12  ER-8061                 PIC X(4)  VALUE '8061'.
   744     12  ER-8062                 PIC X(4)  VALUE '8062'.
   745     12  ER-8063                 PIC X(4)  VALUE '8063'.
   746     12  ER-8064                 PIC X(4)  VALUE '8064'.
   747     12  ER-8065                 PIC X(4)  VALUE '8065'.
   748     12  ER-8066                 PIC X(4)  VALUE '8066'.
   749     12  ER-8146                 PIC X(4)  VALUE '8146'.
   750     12  ER-8147                 PIC X(4)  VALUE '8147'.
   751     12  ER-8152                 PIC X(4)  VALUE '8152'.
   752     12  ER-8153                 PIC X(4)  VALUE '8153'.
   753     12  ER-8154                 PIC X(4)  VALUE '8154'.
   754     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  15
* EL156.cbl
   755     12  ER-8310                 PIC X(4)  VALUE '8310'.
   756     12  ER-8311                 PIC X(4)  VALUE '8311'.
   757     12  ER-8312                 PIC X(4)  VALUE '8312'.
   758     12  ER-8313                 PIC X(4)  VALUE '8313'.
   759     12  ER-8314                 PIC X(4)  VALUE '8314'.
   760     12  ER-8315                 PIC X(4)  VALUE '8315'.
   761     12  ER-8316                 PIC X(4)  VALUE '8316'.
   762     12  ER-8317                 PIC X(4)  VALUE '8317'.
   763
   764 01  CSO-WORK-FIELDS.
   765     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   766       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   767
   768     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   769     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   770         88  CERT-NOTE-ADDED           VALUE 'Y'.
   771     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   772         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   773     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   774
   775     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   776
   777 01  SC-NP6-CERT-NOTE.
   778     12  FILLER                  PIC X(12)
   779               VALUE 'REM BENEFIT '.
   780     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   781     12  SC-NP6-COMM             PIC X(8)
   782               VALUE ' + 6 MO '.
   783     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   784     12  FILLER                  PIC X(12)
   785               VALUE ' = AMT PAID '.
   786     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   787
   788 01  SC-NP6-ORIG-NOTE.
   789     12  FILLER                  PIC X(63)  VALUE
   790         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   791 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   792     88  PDEF-FOUND                   VALUE 'Y'.
   793 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   794     88  ACCT-FOUND                   VALUE 'Y'.
   795 01  CTBL-KEY-SAVE               PIC X(5).
   796 01  CTBL-KEY.
   797     05  CTBL-COMPANY-CD         PIC X.
   798     05  CTBL-TABLE              PIC XXX.
   799     05  CTBL-BEN-TYPE           PIC X.
   800     05  CTBL-BEN-CODE           PIC XX.
   801 01  ERPDEF-KEY-SAVE             PIC X(18).
   802 01  ERPDEF-KEY.
   803     12  ERPDEF-COMPANY-CD       PIC X.
   804     12  ERPDEF-STATE            PIC XX.
   805     12  ERPDEF-PROD-CD          PIC XXX.
   806     12  F                       PIC X(7).
   807     12  ERPDEF-BEN-TYPE         PIC X.
   808     12  ERPDEF-BEN-CODE         PIC XX.
   809     12  ERPDEF-EXP-DT           PIC XX.
   810 01  ELCRTT-KEY.
   811     05  CTRLR-COMP-CD       PIC X.
   812     05  CTRLR-CARRIER       PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  16
* EL156.cbl
   813     05  CTRLR-GROUPING      PIC X(6).
   814     05  CTRLR-STATE         PIC X(2).
   815     05  CTRLR-ACCOUNT       PIC X(10).
   816     05  CTRLR-EFF-DT        PIC XX.
   817     05  CTRLR-CERT-NO       PIC X(11).
   818     05  CTRLR-REC-TYPE      PIC X.
   819 01  ACCESS-KEYS.
   820     12  ELARCH-KEY.
   821         16  ARCH-CO             PIC X.
   822         16  ARCH-NUMBER         PIC S9(08) COMP.
   823         16  ARCH-REC-TYPE       PIC X.
   824         16  ARCH-SEQ            PIC S9(04) COMP.
   825     12  ELMSTR-KEY.
   826         16  MSTR-COMP-CD        PIC X.
   827         16  MSTR-CARRIER        PIC X.
   828         16  MSTR-CLAIM-NO       PIC X(7).
   829         16  MSTR-CERT-NO        PIC X(11).
   830     12  ELCNTL-KEY.
   831         16  CNTL-COMP-ID        PIC X(3).
   832         16  CNTL-REC-TYPE       PIC X.
   833         16  CNTL-ACCESS         PIC X(4).
   834         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   835     12  ELCERT-KEY.
   836         16  CERT-COMP-CD        PIC X.
   837         16  CERT-CARRIER        PIC X.
   838         16  CERT-GROUPING       PIC X(6).
   839         16  CERT-STATE          PIC XX.
   840         16  CERT-ACCOUNT        PIC X(10).
   841         16  CERT-EFF-DT         PIC XX.
   842         16  CERT-CERT-NO        PIC X(11).
   843     12  ELTRLR-KEY.
   844         16  TRLR-COMP-CD        PIC X.
   845         16  TRLR-CARRIER        PIC X.
   846         16  TRLR-CLAIM-NO       PIC X(7).
   847         16  TRLR-CERT-NO        PIC X(11).
   848         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   849     12  ELACTQ-KEY.
   850         16  ACTQ-COMP-CD        PIC X.
   851         16  ACTQ-CARRIER        PIC X.
   852         16  ACTQ-CLAIM-NO       PIC X(7).
   853         16  ACTQ-CERT-NO        PIC X(11).
   854     12  W-NOTE-KEY.
   855         16  W-NOTE-COMP-CD      PIC X.
   856         16  W-NOTE-CERT-KEY.
   857             20  W-NOTE-CARRIER  PIC X.
   858             20  W-NOTE-GROUPING PIC X(6).
   859             20  W-NOTE-STATE    PIC XX.
   860             20  W-NOTE-ACCOUNT  PIC X(10).
   861             20  W-NOTE-EFF-DT   PIC XX.
   862             20  W-NOTE-CERT-NO  PIC X(11).
   863     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   864     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   865     12  ERACCT-KEY.
   866         16  ERACCT-PARTIAL-KEY.
   867             20  ACCT-COMP-CD    PIC X.
   868             20  ACCT-CARRIER    PIC X.
   869             20  ACCT-GROUPING   PIC X(6).
   870             20  ACCT-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  17
* EL156.cbl
   871             20  ACCT-ACCOUNT    PIC X(10).
   872         16  ACCT-EXP-DT         PIC XX.
   873         16  FILLER              PIC X(4) VALUE SPACES.
   874     12  ELCHKQ-KEY.
   875         16  CHKQ-COMP-CD        PIC X.
   876         16  CHKQ-CONTROL        PIC S9(8) COMP.
   877         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   878     12  ELBENE-KEY.
   879         16  BENE-COMP-CD         PIC X.
   880         16  BENE-RECORD-TYPE     PIC X.
   881         16  BENE-NUMBER          PIC X(10).
   882     12  ERCOMP-KEY.
   883         16  COMP-COMP-CD        PIC X.
   884         16  COMP-CARRIER        PIC X.
   885         16  COMP-GROUP          PIC X(06).
   886         16  COMP-FIN-RESP       PIC X(10).
   887         16  COMP-ACCOUNT        PIC X(10).
   888         16  COMP-TYPE           PIC X.
   889
   890     12  DLO035-KEY.
   891         16  DL35-PROCESS-TYPE   PIC X.
   892         16  DL35-CREDIT-CARD    PIC X(20).
   893         16  DL35-BEN-TYPE       PIC XX.
   894         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   895         16  DL35-RETURN-CODE    PIC XX.
   896
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  18
* EL156.cbl
   898*    COPY ELCDATE.
   899******************************************************************
   900*                                                                *
   901*                                                                *
   902*                            ELCDATE.                            *
   903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   904*                            VMOD=2.003
   905*                                                                *
   906*                                                                *
   907*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   908*                 LENGTH = 200                                   *
   909******************************************************************
   910
   911 01  DATE-CONVERSION-DATA.
   912     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   913     12  DC-OPTION-CODE                PIC X.
   914         88  BIN-TO-GREG                VALUE ' '.
   915         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   916         88  EDIT-GREG-TO-BIN           VALUE '2'.
   917         88  YMD-GREG-TO-BIN            VALUE '3'.
   918         88  MDY-GREG-TO-BIN            VALUE '4'.
   919         88  JULIAN-TO-BIN              VALUE '5'.
   920         88  BIN-PLUS-ELAPSED           VALUE '6'.
   921         88  FIND-CENTURY               VALUE '7'.
   922         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   923         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   924         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   925         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   926         88  JULIAN-TO-BIN-3            VALUE 'C'.
   927         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   928         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   929         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   930         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   931         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   932         88  CHECK-LEAP-YEAR            VALUE 'H'.
   933         88  BIN-3-TO-GREG              VALUE 'I'.
   934         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   935         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   936         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   937         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   938         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   939         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   940         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   941         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   942         88  THREE-CHARACTER-BIN
   943                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   944         88  GREGORIAN-TO-BIN
   945                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   946         88  BIN-TO-GREGORIAN
   947                  VALUES ' ' '1' 'I' '8' 'G'.
   948         88  JULIAN-TO-BINARY
   949                  VALUES '5' 'C' 'E' 'F'.
   950     12  DC-ERROR-CODE                 PIC X.
   951         88  NO-CONVERSION-ERROR        VALUE ' '.
   952         88  DATE-CONVERSION-ERROR
   953                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   954         88  DATE-IS-ZERO               VALUE '1'.
   955         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  19
* EL156.cbl
   956         88  DATE-IS-INVALID            VALUE '3'.
   957         88  DATE1-GREATER-DATE2        VALUE '4'.
   958         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   959         88  DATE-INVALID-OPTION        VALUE '9'.
   960         88  INVALID-CENTURY            VALUE 'A'.
   961         88  ONLY-CENTURY               VALUE 'B'.
   962         88  ONLY-LEAP-YEAR             VALUE 'C'.
   963         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   964     12  DC-END-OF-MONTH               PIC X.
   965         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   966     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   967         88  USE-NORMAL-PROCESS         VALUE ' '.
   968         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   969         88  ADJUST-UP-100-YRS          VALUE '2'.
   970     12  FILLER                        PIC X.
   971     12  DC-CONVERSION-DATES.
   972         16  DC-BIN-DATE-1             PIC XX.
   973         16  DC-BIN-DATE-2             PIC XX.
   974         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   975         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   976                       DC-GREG-DATE-1-EDIT.
   977             20  DC-EDIT1-MONTH        PIC 99.
   978             20  SLASH1-1              PIC X.
   979             20  DC-EDIT1-DAY          PIC 99.
   980             20  SLASH1-2              PIC X.
   981             20  DC-EDIT1-YEAR         PIC 99.
   982         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   983         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   984                     DC-GREG-DATE-2-EDIT.
   985             20  DC-EDIT2-MONTH        PIC 99.
   986             20  SLASH2-1              PIC X.
   987             20  DC-EDIT2-DAY          PIC 99.
   988             20  SLASH2-2              PIC X.
   989             20  DC-EDIT2-YEAR         PIC 99.
   990         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   991         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   992                     DC-GREG-DATE-1-YMD.
   993             20  DC-YMD-YEAR           PIC 99.
   994             20  DC-YMD-MONTH          PIC 99.
   995             20  DC-YMD-DAY            PIC 99.
   996         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   997         16  DC-GREG-DATE-1-MDY-R REDEFINES
   998                      DC-GREG-DATE-1-MDY.
   999             20  DC-MDY-MONTH          PIC 99.
  1000             20  DC-MDY-DAY            PIC 99.
  1001             20  DC-MDY-YEAR           PIC 99.
  1002         16  DC-GREG-DATE-1-ALPHA.
  1003             20  DC-ALPHA-MONTH        PIC X(10).
  1004             20  DC-ALPHA-DAY          PIC 99.
  1005             20  FILLER                PIC XX.
  1006             20  DC-ALPHA-CENTURY.
  1007                 24 DC-ALPHA-CEN-N     PIC 99.
  1008             20  DC-ALPHA-YEAR         PIC 99.
  1009         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1010         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1011         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1012         16  DC-JULIAN-DATE            PIC 9(05).
  1013         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  20
* EL156.cbl
  1014                                       PIC 9(05).
  1015         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1016             20  DC-JULIAN-YEAR        PIC 99.
  1017             20  DC-JULIAN-DAYS        PIC 999.
  1018         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1019         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1020         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1021     12  DATE-CONVERSION-VARIBLES.
  1022         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1023         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1024             20  FILLER                PIC 9(3).
  1025             20  HOLD-CEN-1-CCYY.
  1026                 24  HOLD-CEN-1-CC     PIC 99.
  1027                 24  HOLD-CEN-1-YY     PIC 99.
  1028             20  HOLD-CEN-1-MO         PIC 99.
  1029             20  HOLD-CEN-1-DA         PIC 99.
  1030         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1031             20  HOLD-CEN-1-R-MO       PIC 99.
  1032             20  HOLD-CEN-1-R-DA       PIC 99.
  1033             20  HOLD-CEN-1-R-CCYY.
  1034                 24  HOLD-CEN-1-R-CC   PIC 99.
  1035                 24  HOLD-CEN-1-R-YY   PIC 99.
  1036             20  FILLER                PIC 9(3).
  1037         16  HOLD-CENTURY-1-X.
  1038             20  FILLER                PIC X(3)  VALUE SPACES.
  1039             20  HOLD-CEN-1-X-CCYY.
  1040                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1041                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1042             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1043             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1044         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1045             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1046             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1047             20  HOLD-CEN-1-R-X-CCYY.
  1048                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1049                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1050             20  FILLER                PIC XXX.
  1051         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1052         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1053         16  DC-JULIAN-DATE-1          PIC 9(07).
  1054         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1055             20  DC-JULIAN-1-CCYY.
  1056                 24  DC-JULIAN-1-CC    PIC 99.
  1057                 24  DC-JULIAN-1-YR    PIC 99.
  1058             20  DC-JULIAN-DA-1        PIC 999.
  1059         16  DC-JULIAN-DATE-2          PIC 9(07).
  1060         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1061             20  DC-JULIAN-2-CCYY.
  1062                 24  DC-JULIAN-2-CC    PIC 99.
  1063                 24  DC-JULIAN-2-YR    PIC 99.
  1064             20  DC-JULIAN-DA-2        PIC 999.
  1065         16  DC-GREG-DATE-A-EDIT.
  1066             20  DC-EDITA-MONTH        PIC 99.
  1067             20  SLASHA-1              PIC X VALUE '/'.
  1068             20  DC-EDITA-DAY          PIC 99.
  1069             20  SLASHA-2              PIC X VALUE '/'.
  1070             20  DC-EDITA-CCYY.
  1071                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  21
* EL156.cbl
  1072                 24  DC-EDITA-YEAR     PIC 99.
  1073         16  DC-GREG-DATE-B-EDIT.
  1074             20  DC-EDITB-MONTH        PIC 99.
  1075             20  SLASHB-1              PIC X VALUE '/'.
  1076             20  DC-EDITB-DAY          PIC 99.
  1077             20  SLASHB-2              PIC X VALUE '/'.
  1078             20  DC-EDITB-CCYY.
  1079                 24  DC-EDITB-CENT     PIC 99.
  1080                 24  DC-EDITB-YEAR     PIC 99.
  1081         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1082         16  DC-GREG-DATE-CYMD-R REDEFINES
  1083                              DC-GREG-DATE-CYMD.
  1084             20  DC-CYMD-CEN           PIC 99.
  1085             20  DC-CYMD-YEAR          PIC 99.
  1086             20  DC-CYMD-MONTH         PIC 99.
  1087             20  DC-CYMD-DAY           PIC 99.
  1088         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1089         16  DC-GREG-DATE-MDCY-R REDEFINES
  1090                              DC-GREG-DATE-MDCY.
  1091             20  DC-MDCY-MONTH         PIC 99.
  1092             20  DC-MDCY-DAY           PIC 99.
  1093             20  DC-MDCY-CEN           PIC 99.
  1094             20  DC-MDCY-YEAR          PIC 99.
  1095    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1096        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1097    12  DC-EL310-DATE                  PIC X(21).
  1098    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  22
* EL156.cbl
  1100*    COPY ELCLOGOF.
  1101******************************************************************
  1102*                                                                *
  1103*                                                                *
  1104*                            ELCLOGOF.                           *
  1105*                            VMOD=2.001                          *
  1106*                                                                *
  1107*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1108*                                                                *
  1109******************************************************************
  1110 01  CLASIC-LOGOFF.
  1111     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1112     12  LOGOFF-TEXT.
  1113         16  FILLER          PIC X(5)    VALUE SPACES.
  1114         16  LOGOFF-MSG.
  1115             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1116             20  FILLER      PIC X       VALUE SPACES.
  1117             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1118         16  FILLER          PIC X(80)
  1119           VALUE '* YOU ARE NOW LOGGED OFF'.
  1120         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1121         16  FILLER          PIC X       VALUE QUOTE.
  1122         16  LOGOFF-SYS-MSG  PIC X(17)
  1123           VALUE 'S CLAS-IC SYSTEM '.
  1124     12  TEXT-MESSAGES.
  1125         16  UNACCESS-MSG    PIC X(29)
  1126             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1127         16  PGMIDERR-MSG    PIC X(17)
  1128             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  23
* EL156.cbl
  1130*    COPY ELCCALC.
  1131******************************************************************
  1132*                                                                *
  1133*                           ELCCALC.                            *
  1134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1135*                            VMOD=2.025                          *
  1136*                                                                *
  1137*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1138*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1139*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1140*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1141*                                                                *
  1142*  PASSED TO ELRTRM                                              *
  1143*  -----------------                                             *
  1144*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1145*  ORIGINAL TERM                                                 *
  1146*  BEGINNING DATE                                                *
  1147*  ENDING DATE                                                   *
  1148*  COMPANY I.D.                                                  *
  1149*  ACCOUNT MASTER USER FIELD                                     *
  1150*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1151*  FREE LOOK DAYS                                                *
  1152*                                                                *
  1153*  RETURNED FROM ELRTRM                                          *
  1154*  ---------------------                                         *
  1155*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1156*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1157*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1158*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1159*----------------------------------------------------------------*
  1160*  PASSED TO ELRAMT                                              *
  1161*  ----------------                                              *
  1162*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1163*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1164*  ORIGINAL AMOUNT                                               *
  1165*  ALTERNATE BENEFIT (BALLON)                                    *
  1166*  A.P.R. - NET PAY ONLY                                         *
  1167*  METHOD
  1168*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1169*  COMPANY I.D.                                                  *
  1170*  BENEFIT TYPE                                                  *
  1171*                                                                *
  1172*  RETURNED FROM ELRAMT                                          *
  1173*  --------------------                                          *
  1174*  REMAINING AMOUNT 1 - CURRENT                                  *
  1175*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1176*  REMAINING AMOUNT FACTOR
  1177*----------------------------------------------------------------*
  1178*  PASSED TO ELRESV                                              *
  1179*  -----------------                                             *
  1180*  CERTIFICATE EFFECTIVE DATE                                    *
  1181*  VALUATION DATE                                                *
  1182*  PAID THRU DATE                                                *
  1183*  BENEFIT                                                       *
  1184*  INCURRED DATE                                                 *
  1185*  REPORTED DATE                                                 *
  1186*  ISSUE AGE                                                     *
  1187*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  24
* EL156.cbl
  1188*  CDT PERCENT                                                   *
  1189*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1190* *CLAIM TYPE (LIFE, A/H)                                        *
  1191* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1192* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1193*                                                                *
  1194*  RETURNED FROM ELRESV                                          *
  1195*  --------------------                                          *
  1196*  CDT TABLE USED                                                *
  1197*  CDT FACTOR USED                                               *
  1198*  PAY TO CURRENT RESERVE                                        *
  1199*  I.B.N.R. - A/H ONLY                                           *
  1200*  FUTURE (ACCRUED) AH ONLY                                      *
  1201*----------------------------------------------------------------*
  1202*  PASSED TO ELRATE                                              *
  1203*  ----------------                                              *
  1204*  CERT ISSUE DATE                                               *
  1205*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1206*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1207*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1208*  STATE CODE (CLIENT DEFINED)                                   *
  1209*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1210*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1211*  DEVIATION CODE                                                *
  1212*  ISSUE AGE                                                     *
  1213*  ORIGINAL BENEFIT AMOUNT                                       *
  1214*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1215*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1216*  BENEFIT KIND (LIFE OR A/H)                                    *
  1217*  A.P.R.                                                        *
  1218*  METHOD
  1219*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1220*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1221*  COMPANY I.D. (3 CHARACTER)                                    *
  1222*  BENEFIT CODE                                                  *
  1223*  BENEFIT OVERRIDE CODE                                         *
  1224*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1225*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1226*  JOINT INDICATOR (CSL ONLY)                                    *
  1227*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1228*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1229*                                                                *
  1230*  RETURNED FROM ELRATE                                          *
  1231*  --------------------                                          *
  1232*  CALCULATED PREMIUM                                            *
  1233*  PREMIUM RATE                                                  *
  1234*  MORTALITY CODE                                                *
  1235*  MAX ATTAINED AGE                                              *
  1236*  MAX AGE                                                       *
  1237*  MAX TERM                                                      *
  1238*  MAX MONTHLY BENEFIT                                           *
  1239*  MAX TOTAL BENIFIT                                             *
  1240*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1241*----------------------------------------------------------------*
  1242*  PASSED TO ELRFND                                              *
  1243*  ----------------                                              *
  1244*  CERT ISSUE DATE                                               *
  1245*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  25
* EL156.cbl
  1246*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1247*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1248*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1249*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1250*  STATE CODE (CLIENT DEFINED)                                   *
  1251*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1252*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1253*  DEVIATION CODE                                                *
  1254*  ISSUE AGE                                                     *
  1255*  ORIGINAL BENEFIT AMOUNT                                       *
  1256*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1257*  PROCESS TYPE (CANCEL)                                         *
  1258*  BENEFIT KIND (LIFE OR A/H)                                    *
  1259*  A.P.R.                                                        *
  1260*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1261*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1264*  COMPANY I.D. (3 CHARACTER)                                    *
  1265*  BENEFIT CODE                                                  *
  1266*  BENEFIT OVERRIDE CODE                                         *
  1267*                                                                *
  1268*  RETURNED FROM ELRFND                                          *
  1269*  --------------------                                          *
  1270*  CALCULATED REFUND                                             *
  1271*----------------------------------------------------------------*
  1272*  PASSED TO ELEARN                                              *
  1273*  ----------------                                              *
  1274*  CERT ISSUE DATE                                               *
  1275*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1276*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1277*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1278*  STATE CODE (CLIENT DEFINED)                                   *
  1279*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1280*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1281*  DEVIATION CODE                                                *
  1282*  ISSUE AGE                                                     *
  1283*  ORIGINAL BENEFIT AMOUNT                                       *
  1284*  BENEFIT KIND (LIFE OR A/H)                                    *
  1285*  A.P.R.                                                        *
  1286*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1287*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1288*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1289*  COMPANY I.D. (3 CHARACTER)                                    *
  1290*  BENEFIT CODE                                                  *
  1291*  BENEFIT OVERRIDE CODE                                         *
  1292*                                                                *
  1293*  RETURNED FROM ELEARN                                          *
  1294*  --------------------                                          *
  1295*  INDICATED  EARNINGS                                           *
  1296*----------------------------------------------------------------*
  1297*                 LENGTH = 450                                   *
  1298*                                                                *
  1299******************************************************************
  1300******************************************************************
  1301*                   C H A N G E   L O G
  1302*
  1303* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  26
* EL156.cbl
  1304*-----------------------------------------------------------------
  1305*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1306* EFFECTIVE    NUMBER
  1307*-----------------------------------------------------------------
  1308* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1309* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1310* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1311* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1312* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1313* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1314* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1315* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1316* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1317******************************************************************
  1318
  1319 01  CALCULATION-PASS-AREA.
  1320     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1321                                     COMP.
  1322
  1323     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1324       88  NO-CP-ERROR                             VALUE ZERO.
  1325       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1326                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1327       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1328       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1329       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1330       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1331       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1332       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1333       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1334       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1335       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1336       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1337       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1338       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1339       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1340       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1341       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1342       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1343       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1344
  1345     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1346       88  NO-CP-ERROR-2                           VALUE ZERO.
  1347***********************  INPUT AREAS ****************************
  1348
  1349     12  CP-CALCULATION-AREA.
  1350         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1351         16  CP-CERT-EFF-DT        PIC XX.
  1352         16  CP-VALUATION-DT       PIC XX.
  1353         16  CP-PAID-THRU-DT       PIC XX.
  1354         16  CP-BENEFIT-TYPE       PIC X.
  1355           88  CP-AH                               VALUE 'A' 'D'
  1356                                                   'I' 'U'.
  1357           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1358           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1359         16  CP-INCURRED-DT        PIC XX.
  1360         16  CP-REPORTED-DT        PIC XX.
  1361         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  27
* EL156.cbl
  1362         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1363         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1364                                     COMP-3.
  1365         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1366                                     COMP-3.
  1367         16  CP-CDT-METHOD         PIC X.
  1368           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1369           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1370           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1371         16  CP-CLAIM-TYPE         PIC X.
  1372           88  CP-AH-CLAIM                         VALUE 'A'.
  1373           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1374         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1375                                     COMP-3.
  1376         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-REM-TERM-METHOD    PIC X.
  1389           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1390           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1391           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1392           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1393           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1394           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1395           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1396         16  CP-EARNING-METHOD     PIC X.
  1397           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1398           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1399           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1400           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1401           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1402           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1403           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1404           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1405           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1406           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1407           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1408           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1409           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1410           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1411         16  CP-PROCESS-TYPE       PIC X.
  1412           88  CP-CLAIM                            VALUE '1'.
  1413           88  CP-CANCEL                           VALUE '2'.
  1414           88  CP-ISSUE                            VALUE '3'.
  1415         16  CP-SPECIAL-CALC-CD    PIC X.
  1416           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1417           88  CP-1-MTH-INTEREST               VALUE ' '.
  1418           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1419           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  28
* EL156.cbl
  1420           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1421           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1422           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1423           88  CP-FARM-PLAN                    VALUE 'F'.
  1424           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1425           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1426           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1427           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1428           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1429           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1430           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1431           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1432           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1433           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1434                                                     'W' 'X'.
  1435           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1436           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1437           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1438           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1439           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1440           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1441           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1442           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1443           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1444           88  CP-CSL-METH-1                   VALUE '5'.
  1445           88  CP-CSL-METH-2                   VALUE '6'.
  1446           88  CP-CSL-METH-3                   VALUE '7'.
  1447           88  CP-CSL-METH-4                   VALUE '8'.
  1448
  1449         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1450                                     COMP-3.
  1451         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1452         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1453         16  CP-STATE              PIC XX          VALUE SPACE.
  1454         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1455         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1456           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1457               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1458         16  CP-R78-OPTION         PIC X.
  1459           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1460           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1461
  1462         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1463         16  CP-IBNR-RESERVE-SW    PIC X.
  1464         16  CP-CLAIM-STATUS       PIC X.
  1465         16  CP-RATE-FILE          PIC X.
  1466         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1467                                     COMP-3.
  1468
  1469         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1470         16  CP-AH-OVERRIDE-CODE   PIC X.
  1471
  1472         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1473                                     COMP-3.
  1474         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1475                                   PIC S9(5)V99 COMP-3.
  1476         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1477                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  29
* EL156.cbl
  1478         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1479                                     COMP-3.
  1480         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1481                                     COMP-3.
  1482         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1483                                  PIC S9(7)V99 COMP-3.
  1484
  1485         16  CP-PAID-FROM-DATE     PIC X(02).
  1486         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1487         16  CP-EXT-DAYS-CALC      PIC X.
  1488           88  CP-EXT-NO-CHG                   VALUE ' '.
  1489           88  CP-EXT-CHG-LF                   VALUE '1'.
  1490           88  CP-EXT-CHG-AH                   VALUE '2'.
  1491           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1492         16  CP-DOMICILE-STATE     PIC XX.
  1493         16  CP-CARRIER            PIC X.
  1494         16  CP-REIN-FLAG          PIC X.
  1495         16  CP-REM-TRM-CALC-OPTION PIC X.
  1496           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1497                      '2' '3' '4' '5'.
  1498           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1499           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1500           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1501           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1502           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1503           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1504           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1505           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1506         16  CP-SIG-SWITCH         PIC X.
  1507         16  CP-RATING-METHOD      PIC X.
  1508           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1509           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1510           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1511           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1512           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1513           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1514           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1515           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1516           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1517         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1518                                     COMP-3.
  1519         16  CP-BEN-CATEGORY       PIC X.
  1520         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1521         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1522                                   PIC S99V9(5) COMP-3.
  1523         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1524         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1525                                   PIC S99V9(5) COMP-3.
  1526         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1527         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1528         16  CP-EXPIRE-DT          PIC XX.
  1529         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1530         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1531         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1532         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1533         16  CP-DDF-SPEC-CALC      PIC X.
  1534             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1535             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  30
* EL156.cbl
  1536         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1537         16  CP-CANCEL-REASON      PIC X.
  1538         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1539         16  CP-PMT-MODE           PIC X.
  1540         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1541         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1542         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1543         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1544         16  FILLER                PIC X.
  1545
  1546***************    OUTPUT FROM ELRESV   ************************
  1547
  1548         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1549
  1550         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1551                                     COMP-3.
  1552         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1553                                     COMP-3.
  1554         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  FILLER                PIC X(09).
  1559***************    OUTPUT FROM ELRTRM   *************************
  1560
  1561         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1562                                     COMP-3.
  1563         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1568                                     COMP-3.
  1569         16  FILLER                PIC X(12).
  1570
  1571***************    OUTPUT FROM ELRAMT   *************************
  1572
  1573         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  FILLER                PIC X(12).
  1578
  1579***************    OUTPUT FROM ELRATE   *************************
  1580
  1581         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1582                                     COMP-3.
  1583         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1584                                     COMP-3.
  1585         16  CP-MORTALITY-CODE     PIC X(4).
  1586         16  CP-RATE-EDIT-FLAG     PIC X.
  1587             88  CP-RATES-NEED-APR                  VALUE '1'.
  1588         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1589                                     COMP-3.
  1590         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1591         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1592         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1593                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  31
* EL156.cbl
  1594         16  FILLER                PIC X(07).
  1595
  1596***************    OUTPUT FROM ELRFND   *************************
  1597
  1598         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-REFUND-TYPE-USED   PIC X.
  1601           88  CP-R-AS-R78                         VALUE '1'.
  1602           88  CP-R-AS-PRORATA                     VALUE '2'.
  1603           88  CP-R-AS-CALIF                       VALUE '3'.
  1604           88  CP-R-AS-TEXAS                       VALUE '4'.
  1605           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1606           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1607           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1608           88  CP-R-AS-MEAN                        VALUE '8'.
  1609           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1610           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1611           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1612           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1613           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1614           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1615         16  FILLER                PIC X(12).
  1616
  1617***************    OUTPUT FROM ELEARN   *************************
  1618
  1619         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1620                                     COMP-3.
  1621         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-EARNING-TYPE-USED  PIC X.
  1632           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1633           88  CP-E-AS-R78                         VALUE '1'.
  1634           88  CP-E-AS-PRORATA                     VALUE '2'.
  1635           88  CP-E-AS-TEXAS                       VALUE '4'.
  1636           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1637           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1638           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1639           88  CP-E-AS-MEAN                        VALUE '8'.
  1640           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1641         16  FILLER                PIC X(12).
  1642
  1643***************    OUTPUT FROM ELPMNT   *************************
  1644
  1645         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1646                                     COMP-3.
  1647         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1648                                     COMP-3.
  1649         16  FILLER                PIC X(12).
  1650
  1651***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  32
* EL156.cbl
  1652         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1653                                     COMP-3.
  1654         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1655                                     COMP-3.
  1656         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1657                                     COMP-3.
  1658         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1665             88  OPEN-RATE-FILE                   VALUE 'O'.
  1666             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1667             88  IO-ERROR                         VALUE 'E'.
  1668
  1669         16  CP-FIRST-PAY-DATE     PIC XX.
  1670
  1671         16  CP-JOINT-INDICATOR    PIC X.
  1672
  1673         16  CP-RESERVE-REMAINING-TERM
  1674                                   PIC S9(4)V9    VALUE ZERO
  1675                                     COMP-3.
  1676
  1677         16  CP-INSURED-BIRTH-DT   PIC XX.
  1678
  1679         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1680                                     COMP-3.
  1681
  1682         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1683                                     COMP-3.
  1684
  1685         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1686                                     COMP-3.
  1687
  1688         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1695                                     COMP-3.
  1696
  1697         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1701             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1702
  1703         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1704                                     COMP-3.
  1705         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1706                                     COMP-3.
  1707         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1708         16  FILLER                PIC X(15).
  1709******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  33
* EL156.cbl
  1710*    COPY ELCICALC.
  1711******************************************************************
  1712*                                                                *
  1713*                           ELCCICALC.                           *
  1714*                            VMOD=2.001                          *
  1715*                                                                *
  1716*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1717*                 CALCULATION MODULE                             *
  1718*                                                                *
  1719*  PASSED TO ELCLMI                                              *
  1720*  -----------------                                             *
  1721*  STATE                                                         *
  1722*  PRODUCT                                                       *
  1723*  COVERAGE                                                      *
  1724*  EFFECTIVE DATE                                                *
  1725*  INCURRED DATE                                                 *
  1726*  ESTABLISHED DATE                                              *
  1727*  LAST PAID DATE                                                *
  1728*  REPORTED DATE                                                 *
  1729*  CLAIM PAYMENT AMOUNT                                          *
  1730*                                                                *
  1731*  RETURNED FROM ELRTRM                                          *
  1732*  ---------------------                                         *
  1733*  RETURN CODE                                                   *
  1734*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1735*  CLAIM INTEREST AMOUNT                                         *
  1736*----------------------------------------------------------------*
  1737*----------------------------------------------------------------*
  1738*                 LENGTH = 100                                   *
  1739*                                                                *
  1740******************************************************************
  1741******************************************************************
  1742*                   C H A N G E   L O G
  1743*
  1744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1745*-----------------------------------------------------------------
  1746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1747* EFFECTIVE    NUMBER
  1748*-----------------------------------------------------------------
  1749* 120905    2004040700004  PEMA  NEW COPYBOOK
  1750* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1751******************************************************************
  1752
  1753 01  CLAIM-INT-PASS-AREA.
  1754     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1755                                     COMP.
  1756
  1757     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1758       88  NO-CI-ERROR                             VALUE ZERO.
  1759       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1760       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1761       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1762       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1763       88  CP-AMT-LT-5000                          VALUE '4'.
  1764       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1765       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1766       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1767       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  34
* EL156.cbl
  1768***********************  INPUT AREAS ****************************
  1769
  1770     12  CP-CALCULATION-AREA.
  1771         16  CP-COMPANY-CD         PIC X.
  1772         16  CP-STATE              PIC XX.
  1773         16  CP-PRODUCT            PIC XX.
  1774         16  CP-COVERAGE           PIC XX.
  1775         16  CP-INC-DT             PIC XX.
  1776         16  CP-EST-DT             PIC XX.
  1777         16  CP-LSTPD-DT           PIC XX.
  1778         16  CP-RPT-DT             PIC XX.
  1779         16  CP-PRF-DT             PIC XX.
  1780         16  CP-EFF-DT             PIC XX.
  1781         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1782         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1783         16  FILLER                PIC X(37).
  1784
  1785***************    OUTPUT FROM ELCLMI   ************************
  1786
  1787         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1788
  1789         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1790         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1791         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1792         16  FILLER                PIC X(19).
  1793******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  35
* EL156.cbl
  1795*    COPY ELCATTR.
  1796******************************************************************
  1797*                                                                *
  1798*                            ELCATTR.                            *
  1799*                            VMOD=2.001                          *
  1800*                                                                *
  1801*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1802*                                                                *
  1803*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1804*                                                                *
  1805*                   POS 1   P=PROTECTED                          *
  1806*                           U=UNPROTECTED                        *
  1807*                           S=ASKIP                              *
  1808*                   POS 2   A=ALPHA/NUMERIC                      *
  1809*                           N=NUMERIC                            *
  1810*                   POS 3   N=NORMAL                             *
  1811*                           B=BRIGHT                             *
  1812*                           D=DARK                               *
  1813*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1814*                           OF=MODIFIED DATA TAG OFF             *
  1815*                                                                *
  1816*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1817******************************************************************
  1818 01  ATTRIBUTE-LIST.
  1819     12  AL-PABOF            PIC X       VALUE 'Y'.
  1820     12  AL-PABON            PIC X       VALUE 'Z'.
  1821     12  AL-PADOF            PIC X       VALUE '%'.
  1822     12  AL-PADON            PIC X       VALUE '_'.
  1823     12  AL-PANOF            PIC X       VALUE '-'.
  1824     12  AL-PANON            PIC X       VALUE '/'.
  1825     12  AL-SABOF            PIC X       VALUE '8'.
  1826     12  AL-SABON            PIC X       VALUE '9'.
  1827     12  AL-SADOF            PIC X       VALUE '@'.
  1828     12  AL-SADON            PIC X       VALUE QUOTE.
  1829     12  AL-SANOF            PIC X       VALUE '0'.
  1830     12  AL-SANON            PIC X       VALUE '1'.
  1831     12  AL-UABOF            PIC X       VALUE 'H'.
  1832     12  AL-UABON            PIC X       VALUE 'I'.
  1833     12  AL-UADOF            PIC X       VALUE '<'.
  1834     12  AL-UADON            PIC X       VALUE '('.
  1835     12  AL-UANOF            PIC X       VALUE ' '.
  1836     12  AL-UANON            PIC X       VALUE 'A'.
  1837     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1838     12  AL-UNBON            PIC X       VALUE 'R'.
  1839     12  AL-UNDOF            PIC X       VALUE '*'.
  1840     12  AL-UNDON            PIC X       VALUE ')'.
  1841     12  AL-UNNOF            PIC X       VALUE '&'.
  1842     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  36
* EL156.cbl
  1844*    COPY ELCEMIB.
  1845******************************************************************
  1846*                                                                *
  1847*                                                                *
  1848*                            ELCEMIB.                            *
  1849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1850*                            VMOD=2.005                          *
  1851*                                                                *
  1852*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1853*                                                                *
  1854******************************************************************
  1855 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1856     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1857     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1858     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1859     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1860     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1861     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1862     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1863     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1864     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1865         88  EMI-NO-ERRORS                    VALUE '1'.
  1866         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1867         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1868     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1869         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1870     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1871         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1872         88  EMI-AREA1-FULL                   VALUE '2'.
  1873     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1874         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1875         88  EMI-AREA2-FULL                   VALUE '2'.
  1876     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1877         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1878         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1879         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1880         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1881         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1882     12  EMI-ERROR-LINES.
  1883         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1884         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1885         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1886         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1887             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1888                 24  EMI-ERR-NUM         PIC X(4).
  1889                 24  EMI-FILLER          PIC X.
  1890                 24  EMI-SEV             PIC X.
  1891                 24  FILLER              PIC X.
  1892             20  FILLER                  PIC X(02).
  1893     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1894         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1895             20  EMI-ERROR-NUMBER    PIC X(4).
  1896             20  EMI-FILL            PIC X.
  1897             20  EMI-SEVERITY        PIC X.
  1898             20  FILLER              PIC X.
  1899             20  EMI-ERROR-TEXT.
  1900                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1901                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  37
* EL156.cbl
  1902     12  EMI-SEVERITY-SAVE           PIC X.
  1903         88  EMI-NOTE                    VALUE 'N'.
  1904         88  EMI-WARNING                 VALUE 'W'.
  1905         88  EMI-FORCABLE                VALUE 'F'.
  1906         88  EMI-FATAL                   VALUE 'X'.
  1907     12  EMI-MESSAGE-FLAG            PIC X.
  1908         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1909         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1910     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1911     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1912         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1913         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1914         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1915     12  emi-claim-no                pic x(7).
  1916     12  emi-claim-type              pic x(6).
  1917     12  FILLER                      PIC X(124)  VALUE SPACES.
  1918     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1919     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1920     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1921     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  38
* EL156.cbl
  1923*    COPY ELCLNKLT.
  1924******************************************************************
  1925*                                                                *
  1926*                                                                *
  1927*                           ELCLNKLT                             *
  1928*                            VMOD=2.003                          *
  1929*                                                                *
  1930*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1931*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1932*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1933*                                                                *
  1934*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1935*   COMPLETING THE REQUIRED FIELDS.                              *
  1936*                                                                *
  1937*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1938*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1939*                              9999 INDICATES AN UNKNOWN ABEND   *
  1940*                                   WAS DETECTED.                *
  1941*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1942*                              CODES FOUND IN THE ERROR FILE.    *
  1943******************************************************************
  1944 01  W-1523-LINKDATA.
  1945     12  W-1523-COMMON-PI-DATA.
  1946         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1947         16  FILLER              PIC  X(67).
  1948         16  W-1523-COMPANY-CD   PIC  X(01).
  1949         16  FILLER              PIC  X(10).
  1950         16  W-1523-CONTROL-IN-PROGRESS.
  1951             20  W-1523-CARRIER  PIC  X(01).
  1952             20  W-1523-GROUPING PIC  X(06).
  1953             20  W-1523-STATE    PIC  X(02).
  1954             20  W-1523-ACCOUNT  PIC  X(10).
  1955             20  W-1523-CLAIM-CERT-GRP.
  1956                 24  W-1523-CLAIM-NO
  1957                                 PIC  X(07).
  1958                 24  W-1523-CERT-NO.
  1959                     28  W-1523-CERT-PRIME
  1960                                 PIC  X(10).
  1961                     28  W-1523-CERT-SFX
  1962                                 PIC  X(01).
  1963                 24  W-1523-CERT-EFF-DT
  1964                                 PIC  X(02).
  1965         16  FILLER              PIC X(265).
  1966
  1967     12  W-1523-WORK-AREA.
  1968         16  W-1523-FORM-NUMBER  PIC  X(04).
  1969         16  W-1523-NUMBER-COPIES
  1970                                 PIC  9(01).
  1971         16  W-1523-ADDR-TYPE    PIC  X(02).
  1972         16  W-1523-FOLLOW-UP-DATE
  1973                                 PIC  X(02).
  1974         16  W-1523-RESEND-DATE  PIC  X(02).
  1975         16  W-1523-ERROR-CODE   PIC  9(04).
  1976             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1977             88  W-1523-FATAL-ERROR
  1978                                    VALUES  0006 0013 0042
  1979                                            0154 0168 0169
  1980                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  39
* EL156.cbl
  1981                                            0179 0186 0281
  1982                                            0332 2055 3697
  1983                                            3698 3699 3770
  1984                                            3771 3772 7675
  1985                                            9106 9808 9883
  1986                                            9887.
  1987             88  W-1523-STOP-ERRORS
  1988                                    VALUES  0013 0042 0154
  1989                                            0168 0169 0172
  1990                                            0281 0332 2055
  1991                                            3698 3699 7675
  1992                                            9106 9808 9883
  1993                                            9999.
  1994         16  W-1523-REASON       PIC  X(70).
  1995         16  W-1523-ARCHIVE-NUMBER
  1996                                 PIC  9(08).
  1997     12  W-1523-POINTER-AREA.
  1998         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1999         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2000         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2001         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2002         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  40
* EL156.cbl
  2004*    COPY ELCNWA.
  2005*****************************************************************
  2006*                                                               *
  2007*                                                               *
  2008*                            ELCNWA.                            *
  2009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2010*                            VMOD=2.003                         *
  2011*                                                               *
  2012*            M O V E   N A M E   W O R K   A R E A.             *
  2013*                                                               *
  2014*****************************************************************.
  2015
  2016 01  WS-NAME-WORK-AREA.
  2017     05  WS-INSURED-LAST-NAME        PIC X(15).
  2018     05  WS-INSURED-1ST-NAME         PIC X(12).
  2019     05  WS-INSURED-MID-INIT         PIC X.
  2020
  2021     05  WS-NAME-WORK.
  2022         10  WS-NW                   PIC X
  2023             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2024
  2025     05  WS-NAME-WORK2.
  2026         10  WS-NW2                  PIC X
  2027             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2028                                        NWA-INDEX0.
  2029
  2030     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2031                                     COMP-3.
  2032
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  41
* EL156.cbl
  2034*    COPY ELCDMO.
  2035******************************************************************
  2036*                                                                *
  2037*                                                                *
  2038*                            ELCDMO.                             *
  2039*                            VMOD=2.004                          *
  2040*                                                                *
  2041*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2042*        COMMUNICATION AREA                                      *
  2043*   FILE TYPE = NA                                               *
  2044*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2045*                                                                *
  2046******************************************************************
  2047 01  DMO-COMMUNICATION-AREA.
  2048     12  DM-RECORD-TYPE                  PIC  X(02).
  2049             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2050             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2051             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2052     12  DM-DIST-CODE                    PIC  X(04).
  2053     12  DM-MAIL-CODE                    PIC  X(05).
  2054     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2055     12  DM-INSURED-NAME                 PIC  X(30).
  2056     12  DM-CLAIM-NO                     PIC  X(07).
  2057     12  DM-CLAIM-TYPE                   PIC  X.
  2058
  2059     12  DM-STATUS-DATA-AREA.
  2060         16  DM-CLAIM-STATUS             PIC  X.
  2061             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2062             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2063             88  DM-CLOSED                        VALUE '3'.
  2064             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2065             88  DM-DEFAULT                       VALUE '9'.
  2066         16  DM-STATUS-DATE              PIC  X(08).
  2067******YYYYMMDD
  2068         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2069             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2070             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2071             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2072             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2073             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2074             88  DM-RE-OPENED                     VALUE 'R'.
  2075             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2076             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2077             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2078         16  DM-STAT-CARRIER             PIC X.
  2079
  2080     12  DM-DRAFT-DATA-AREA.
  2081         16  DM-PAYMENT-TYPE             PIC  X.
  2082             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2083         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2084         16  DM-PAYMENT-DATE             PIC  X(08).
  2085******YYYYMMDD
  2086         16  DM-CERT-NO                  PIC  X(11).
  2087         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2088         16  DM-CARRIER                  PIC  X.
  2089
  2090     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  42
* EL156.cbl
  2092*    COPY ELCDMDCD.
  2093******************************************************************
  2094*                                                                *
  2095*                                                                *
  2096*                            ELCDMDCD.                           *
  2097*                            VMOD=2.001                          *
  2098*                                                                *
  2099*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2100*       COMMUNICATIONS AREA                                      *
  2101*                                                                *
  2102******************************************************************
  2103 01  CD-COMMUNICATION-AREA.
  2104     12  CD-SYSTEM-ID            PIC  X(02).
  2105         88 CD-CLAIMS                      VALUE 'CL'.
  2106         88 CD-CREDIT                      VALUE 'CR'.
  2107     12  CD-RECORD-TYPE          PIC  X(02).
  2108         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2109         88 CD-EOB-CODE                    VALUE 'EO'.
  2110         88 CD-ICD9-CODE                   VALUE 'I9'.
  2111         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2112         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2113         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2114         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2115         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2116     12  CD-RECORD-KEY           PIC  X(06).
  2117         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2118     12  CD-RETURN-CODE          PIC  X(02).
  2119     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2120     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2121     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2122     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  43
* EL156.cbl
  2124*    COPY ELCDCTB.
  2125******************************************************************
  2126*                                                                *
  2127*                                                                *
  2128*                            ELCDCTB.                            *
  2129*                            VMOD=2.002                          *
  2130*                                                                *
  2131*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2132*       COMMUNICATIONS AREA                                      *
  2133*                                                                *
  2134******************************************************************
  2135 01  DCT-COMMUNICATION-AREA.
  2136     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2137     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2138     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2139     12  DCT-PRODUCT-CODE         PIC  X(02).
  2140     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2141     12  DCT-RETURN-CODE          PIC  X(02).
  2142     12  DCT-MAIL-CODE            PIC  X(05).
  2143     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2144     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  44
* EL156.cbl
  2146 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2147 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2148 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2149 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  45
* EL156.cbl
  2151*    COPY ELCINTF.
  2152******************************************************************
  2153*                                                                *
  2154*                                                                *
  2155*                            ELCINTF.                            *
  2156*                            VMOD=2.017                          *
  2157*                                                                *
  2158*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2159*                                                                *
  2160*       LENGTH = 1024                                            *
  2161*                                                                *
  2162******************************************************************
  2163*                   C H A N G E   L O G
  2164*
  2165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2166*-----------------------------------------------------------------
  2167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2168* EFFECTIVE    NUMBER
  2169*-----------------------------------------------------------------
  2170* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2171******************************************************************
  2172 01  PROGRAM-INTERFACE-BLOCK.
  2173     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2174     12  PI-CALLING-PROGRAM              PIC X(8).
  2175     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2176     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2177     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2178     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2181     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2182     12  PI-COMPANY-ID                   PIC XXX.
  2183     12  PI-COMPANY-CD                   PIC X.
  2184
  2185     12  PI-COMPANY-PASSWORD             PIC X(8).
  2186
  2187     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2188
  2189     12  PI-CONTROL-IN-PROGRESS.
  2190         16  PI-CARRIER                  PIC X.
  2191         16  PI-GROUPING                 PIC X(6).
  2192         16  PI-STATE                    PIC XX.
  2193         16  PI-ACCOUNT                  PIC X(10).
  2194         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2195                                         PIC X(10).
  2196         16  PI-CLAIM-CERT-GRP.
  2197             20  PI-CLAIM-NO             PIC X(7).
  2198             20  PI-CERT-NO.
  2199                 25  PI-CERT-PRIME       PIC X(10).
  2200                 25  PI-CERT-SFX         PIC X.
  2201             20  PI-CERT-EFF-DT          PIC XX.
  2202         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2203             20  PI-PLAN-CODE            PIC X(2).
  2204             20  PI-REVISION-NUMBER      PIC X(3).
  2205             20  PI-PLAN-EFF-DT          PIC X(2).
  2206             20  PI-PLAN-EXP-DT          PIC X(2).
  2207             20  FILLER                  PIC X(11).
  2208         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  46
* EL156.cbl
  2209             20  PI-OE-REFERENCE-1.
  2210                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2211                 25  PI-OE-REF-1-SUFF    PIC XX.
  2212
  2213     12  PI-SESSION-IN-PROGRESS          PIC X.
  2214         88  CLAIM-SESSION                   VALUE '1'.
  2215         88  CREDIT-SESSION                  VALUE '2'.
  2216         88  WARRANTY-SESSION                VALUE '3'.
  2217         88  MORTGAGE-SESSION                VALUE '4'.
  2218         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2219
  2220
  2221*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2222
  2223     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2224     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2225
  2226     12  PI-CREDIT-USER                  PIC X.
  2227         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2228         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2229
  2230     12  PI-CLAIM-USER                   PIC X.
  2231         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2232         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2233
  2234     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2235         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2236         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2237         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2238         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2239         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2240
  2241     12  PI-PROCESSOR-ID                 PIC X(4).
  2242
  2243     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2244
  2245     12  PI-MEMBER-CAPTION               PIC X(10).
  2246
  2247     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2248         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2249
  2250     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2251     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2252     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2253     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2254
  2255     12  PI-AH-OVERRIDE-L1               PIC X.
  2256     12  PI-AH-OVERRIDE-L2               PIC XX.
  2257     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2258     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2259
  2260     12  PI-NEW-SYSTEM                   PIC X(2).
  2261
  2262     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2263     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2264         88  PI-USES-PAID-TO                 VALUE '1'.
  2265     12  PI-CRDTCRD-SYSTEM.
  2266         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  47
* EL156.cbl
  2267             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2268             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2269         16  PI-CC-MONTH-END-DT          PIC XX.
  2270     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2271
  2272     12  PI-OE-REFERENCE-2.
  2273         16  PI-OE-REF-2-PRIME           PIC X(10).
  2274         16  PI-OE-REF-2-SUFF            PIC X.
  2275
  2276     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2277
  2278     12  PI-LANGUAGE-TYPE                PIC X.
  2279             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2280             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2281             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2282
  2283     12  PI-POLICY-LINKAGE-IND           PIC X.
  2284         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2285         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2286                                                   LOW-VALUES.
  2287
  2288     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2289     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2290         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2291         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2292
  2293     12  PI-PROCESSOR-CSR-IND            PIC X.
  2294         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2295         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2296
  2297     12  FILLER                          PIC X(3).
  2298
  2299     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2300
  2301     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2302         PI-SYSTEM-LEVEL.
  2303
  2304         16  PI-ENTRY-CODES.
  2305             20  PI-ENTRY-CD-1           PIC X.
  2306             20  PI-ENTRY-CD-2           PIC X.
  2307
  2308         16  PI-RETURN-CODES.
  2309             20  PI-RETURN-CD-1          PIC X.
  2310             20  PI-RETURN-CD-2          PIC X.
  2311
  2312         16  PI-UPDATE-STATUS-SAVE.
  2313             20  PI-UPDATE-BY            PIC X(4).
  2314             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2315
  2316         16  PI-LOWER-CASE-LETTERS       PIC X.
  2317             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2318
  2319*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2320*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2321*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2322
  2323         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2324             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  48
* EL156.cbl
  2325             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2326             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2327             88  ACCNT-CNTL                  VALUE '3'.
  2328             88  CARR-ACCNT-CNTL             VALUE '4'.
  2329
  2330         16  PI-PROCESSOR-CAP-LIST.
  2331             20  PI-SYSTEM-CONTROLS.
  2332                24 PI-SYSTEM-DISPLAY     PIC X.
  2333                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2334                24 PI-SYSTEM-MODIFY      PIC X.
  2335                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2336             20  FILLER                  PIC XX.
  2337             20  PI-DISPLAY-CAP          PIC X.
  2338                 88  DISPLAY-CAP             VALUE 'Y'.
  2339             20  PI-MODIFY-CAP           PIC X.
  2340                 88  MODIFY-CAP              VALUE 'Y'.
  2341             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2342                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2343             20  PI-FORCE-CAP            PIC X.
  2344                 88  FORCE-CAP               VALUE 'Y'.
  2345
  2346         16  PI-PROGRAM-CONTROLS.
  2347             20  PI-PGM-PRINT-OPT        PIC X.
  2348             20  PI-PGM-FORMAT-OPT       PIC X.
  2349             20  PI-PGM-PROCESS-OPT      PIC X.
  2350             20  PI-PGM-TOTALS-OPT       PIC X.
  2351
  2352         16  PI-HELP-INTERFACE.
  2353             20  PI-LAST-ERROR-NO        PIC X(4).
  2354             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2355
  2356         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2357             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2358
  2359         16  PI-CR-CONTROL-IN-PROGRESS.
  2360             20  PI-CR-CARRIER           PIC X.
  2361             20  PI-CR-GROUPING          PIC X(6).
  2362             20  PI-CR-STATE             PIC XX.
  2363             20  PI-CR-ACCOUNT           PIC X(10).
  2364             20  PI-CR-FIN-RESP          PIC X(10).
  2365             20  PI-CR-TYPE              PIC X.
  2366
  2367         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2368
  2369         16  PI-CR-MONTH-END-DT          PIC XX.
  2370
  2371         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2372             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2373             88  PI-ZERO-CARRIER             VALUE '1'.
  2374             88  PI-ZERO-GROUPING            VALUE '2'.
  2375             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2376
  2377         16  PI-CARRIER-SECURITY         PIC X.
  2378             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2379
  2380         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2381             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2382             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  49
* EL156.cbl
  2383
  2384         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2385             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2386                                         INDEXED BY PI-ACCESS-NDX
  2387                                         PIC X.
  2388
  2389         16  PI-GA-BILLING-CONTROL       PIC X.
  2390             88  PI-GA-BILLING               VALUE '1'.
  2391
  2392         16  PI-MAIL-PROCESSING          PIC X.
  2393             88  PI-MAIL-YES                 VALUE 'Y'.
  2394
  2395         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2396
  2397         16  PI-AR-SYSTEM.
  2398             20  PI-AR-PROCESSING-CNTL   PIC X.
  2399                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2400             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2401             20  PI-AR-MONTH-END-DT      PIC XX.
  2402
  2403         16  PI-MP-SYSTEM.
  2404             20  PI-MORTGAGE-USER            PIC X.
  2405                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2406                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2407             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2408                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2409                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2410                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2411                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2412                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2413             20  PI-MP-MONTH-END-DT          PIC XX.
  2414             20  PI-MP-REFERENCE-NO.
  2415                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2416                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2417
  2418         16  PI-LABEL-CONTROL            PIC X(01).
  2419             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2420             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2421
  2422         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2423             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2424
  2425         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2426             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2427             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2428
  2429         16  FILLER                      PIC X(14).
  2430
  2431     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2432******************************************************************
  2433     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2434         16  PI-SAVE-FORM        PIC X(12).
  2435         16  PI-ACCT-KEY         PIC X(26).
  2436         16  PI-PAYEE-NAME       PIC X(30).
  2437         16  PI-DAILY-RATE       PIC S9(3)V99.
  2438         16  PI-MONTH-END-SAVE   PIC XX.
  2439         16  PI-BENEFIT-SAVE.
  2440             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  50
* EL156.cbl
  2441             20  PI-BEN-TYPE     PIC X.
  2442         16  PI-MANUAL-SW        PIC 9.
  2443         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2444         16  PI-PASS-SW          PIC X.
  2445         16  PI-PFKEY-USED       PIC X.
  2446         16  PI-CK-ASSIGN        PIC X.
  2447         16  PI-FATAL-COUNT      PIC 99.
  2448         16  PI-FORCE-COUNT      PIC 99.
  2449         16  PI-SAVE-INPUT.
  2450             20  PI-PMTTYPE      PIC X.
  2451             20  PI-PAYEE.
  2452                 24  PI-PAYEE-TYPE PIC X.
  2453                 24  PI-PAYEE-SEQ  PIC X.
  2454                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2455                   PI-PAYEE-SEQ    PIC S9.
  2456             20  PI-PMTNOTE1     PIC X(60).
  2457             20  PI-PMTNOTE2     PIC X(60).
  2458             20  PI-OFFLINE      PIC X.
  2459             20  PI-ECHECKNO     PIC X(7).
  2460             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2461                 28  PI-ECHECKNO-N     PIC X.
  2462                 28  PI-ECHECKNO-6     PIC X(6).
  2463             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2464                 24  PI-ECHECKNO-CR    PIC XX.
  2465                 24  PI-ECHECKNO-5     PIC X(5).
  2466             20  PI-HOLDTIL      PIC 9(6).
  2467             20  PI-EPYFROM      PIC 9(6).
  2468             20  PI-EPYTHRU      PIC 9(6).
  2469             20  PI-EDAYS        PIC S9(5).
  2470             20  PI-EPYAMT       PIC S9(7)V99.
  2471             20  PI-ERESV        PIC S9(7)V99.
  2472             20  PI-EEXPENS      PIC 9(6)V99.
  2473             20  PI-ETYPE        PIC X.
  2474             20  PI-CASH         PIC X.
  2475             20  PI-GROUPED      PIC X.
  2476             20  PI-INT-RATE     PIC S99V9(5).
  2477             20  PI-AIGFROM      PIC 9(6).
  2478             20  PI-LOAN-NO      PIC X(20).
  2479             20  PI-PROOF-DATE   PIC 9(6).
  2480             20  PI-PRINT-EOB-YN PIC X.
  2481             20  PI-PRINT-CLM-FRM-YN PIC X.
  2482             20  PI-PRINT-SURVEY-YN PIC X.
  2483             20  PI-SPECIAL-RELEASE-YN PIC X.
  2484         16  PI-SAVE-COMPUTED.
  2485             20  PI-CCHECKNO     PIC X(7).
  2486             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2487                 28  PI-CCHECKNO-N     PIC X.
  2488                 28  PI-CCHECKNO-6     PIC X(6).
  2489             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2490                 24  PI-CCHECKNO-CR    PIC XX.
  2491                 24  PI-CCHECKNO-5     PIC X(5).
  2492             20  PI-CPYFROM      PIC XX.
  2493             20  PI-CPYTHRU      PIC XX.
  2494             20  PI-CDAYS        PIC S9(5).
  2495             20  PI-CPYAMT       PIC S9(7)V99.
  2496             20  PI-CRESV        PIC 9(6)V99.
  2497             20  PI-CEXPENS      PIC 9(6)V99.
  2498             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  51
* EL156.cbl
  2499                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2500                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2501                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2502         16  PI-PREV-CLMNO       PIC X(7).
  2503         16  PI-LF-COVERAGE-TYPE PIC X.
  2504         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2505         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2506         16  PI-PROVISIONAL-IND  PIC X.
  2507             88 PI-PROV-PMT      VALUE 'P'.
  2508         16  PI-PREV-TRLR-KEY    PIC X(22).
  2509         16  PI-SPLIT-PMT-SW     PIC X.
  2510         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2511         16  PI-ACTIVITY-CODE    PIC 99.
  2512         16  PI-RESET-SW         PIC X.
  2513         16  PI-SPECIAL-BEN-SW   PIC X.
  2514             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2515         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2516         16  PI-EXP-DT           PIC XX.
  2517         16  PI-LOAN-DUE-DAY     PIC 99.
  2518         16  PI-3RD-PARTY-SW     PIC X.
  2519         16  PI-LOAN-UPDATE-SW   PIC X.
  2520
  2521         16  PI-DMD-DATA.
  2522             20  PI-SV-CERT-KEY       PIC X(21).
  2523             20  PI-SV-CERT-NO        PIC X(11).
  2524             20  PI-SV-BEN            PIC X(10).
  2525             20  PI-SV-CCN            PIC X(16).
  2526             20  PI-INTEREST-PAID-IND PIC X.
  2527                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2528             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2529             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2530             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2531             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2532         16  PI-AT-EOB-CODES.
  2533             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2534         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2535         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2536         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2537         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2538         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2539         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2540         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2541         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2542         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2543         16  PI-LF-BENEFIT-CD         PIC X(2).
  2544         16  PI-EOB-CODES-EXIST PIC X.
  2545         16  PI-SET-NOTE2-MDT   PIC X.
  2546         16  PI-VFY-2ND-BENE          PIC X.
  2547         16  PI-CLM-TYPE              PIC X.
  2548         16  PI-APPROVAL-LEVEL        PIC X.
  2549         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2550         16  PI-REAUDIT-NEEDED        PIC X.
  2551         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2552         16  PI-AH-BENEFIT-CD         PIC XX.
  2553         16  pi-ah-term               pic s999 comp-3.
  2554         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2555         16  pi-max-ext               pic 999.
  2556         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  52
* EL156.cbl
  2557         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2558         16  PI-JOINT-COV-IND         PIC X.
  2559             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2560             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2561         16  PI-JOINT-INSURED-IND     PIC X.
  2562             88  PI-JOINT-INSURED        VALUE 'Y'.
  2563             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2564*00781          16  FILLER                   PIC X(176).
  2565*052506         16  FILLER                   PIC X(161).
  2566*031808         16  FILLER                   PIC X(154).
  2567*091808         16  FILLER                   PIC X(152).
  2568*041710         16  FILLER                   PIC X(94).
  2569         16  FILLER                   PIC X(67).
  2570
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  53
* EL156.cbl
  2572*    COPY ELCJPFX.
  2573******************************************************************
  2574*                                                                *
  2575*                                                                *
  2576*                            ELCJPFX.                            *
  2577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2578*                            VMOD=2.002                          *
  2579*                                                                *
  2580*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2581*                                                                *
  2582*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2583*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2584*        ELCNTL - CONTROL FILE                                   *
  2585*        ELMSTR - CLAIM MASTERS                                  *
  2586*        ELTRLR - ACTIVITY TRAILERS                              *
  2587*        ELCHKQ - CHECK QUE                                      *
  2588******************************************************************
  2589 01  JOURNAL-RECORD.
  2590     12  jp-date                     pic s9(5) comp-3.
  2591     12  jp-time                     pic s9(7) comp-3.
  2592     12  JP-USER-ID                  PIC X(4).
  2593     12  JP-FILE-ID                  PIC X(8).
  2594     12  JP-PROGRAM-ID               PIC X(8).
  2595     12  JP-RECORD-TYPE              PIC X.
  2596         88 JP-ADD              VALUE 'A'.
  2597         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2598         88 JP-AFTER-CHANGE     VALUE 'C'.
  2599         88 JP-DELETE           VALUE 'D'.
  2600         88 JP-GENERIC-DELETE   VALUE 'G'.
  2601         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2602         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2603     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2604     12  JP-RECORD-AREA
  2605
  2606
  2607                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  54
* EL156.cbl
  2609*    COPY ELCAID.
  2610******************************************************************
  2611*                                                                *
  2612*                            ELCAID.                             *
  2613*                            VMOD=2.001                          *
  2614*                                                                *
  2615*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2616*                                                                *
  2617*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2618*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2619******************************************************************
  2620
  2621 01  DFHAID.
  2622   02  DFHNULL   PIC  X  VALUE  ' '.
  2623   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2624   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2625   02  DFHPEN    PIC  X  VALUE  '='.
  2626   02  DFHOPID   PIC  X  VALUE  'W'.
  2627   02  DFHPA1    PIC  X  VALUE  '%'.
  2628   02  DFHPA2    PIC  X  VALUE  '>'.
  2629   02  DFHPA3    PIC  X  VALUE  ','.
  2630   02  DFHPF1    PIC  X  VALUE  '1'.
  2631   02  DFHPF2    PIC  X  VALUE  '2'.
  2632   02  DFHPF3    PIC  X  VALUE  '3'.
  2633   02  DFHPF4    PIC  X  VALUE  '4'.
  2634   02  DFHPF5    PIC  X  VALUE  '5'.
  2635   02  DFHPF6    PIC  X  VALUE  '6'.
  2636   02  DFHPF7    PIC  X  VALUE  '7'.
  2637   02  DFHPF8    PIC  X  VALUE  '8'.
  2638   02  DFHPF9    PIC  X  VALUE  '9'.
  2639   02  DFHPF10   PIC  X  VALUE  ':'.
  2640   02  DFHPF11   PIC  X  VALUE  '#'.
  2641   02  DFHPF12   PIC  X  VALUE  '@'.
  2642   02  DFHPF13   PIC  X  VALUE  'A'.
  2643   02  DFHPF14   PIC  X  VALUE  'B'.
  2644   02  DFHPF15   PIC  X  VALUE  'C'.
  2645   02  DFHPF16   PIC  X  VALUE  'D'.
  2646   02  DFHPF17   PIC  X  VALUE  'E'.
  2647   02  DFHPF18   PIC  X  VALUE  'F'.
  2648   02  DFHPF19   PIC  X  VALUE  'G'.
  2649   02  DFHPF20   PIC  X  VALUE  'H'.
  2650   02  DFHPF21   PIC  X  VALUE  'I'.
  2651*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2652   02  DFHPF22   PIC  X  VALUE  '['.
  2653   02  DFHPF23   PIC  X  VALUE  '.'.
  2654   02  DFHPF24   PIC  X  VALUE  '<'.
  2655   02  DFHMSRE   PIC  X  VALUE  'X'.
  2656   02  DFHSTRF   PIC  X  VALUE  'h'.
  2657   02  DFHTRIG   PIC  X  VALUE  '"'.
  2658 01  FILLER    REDEFINES DFHAID.
  2659     12  FILLER              PIC X(8).
  2660     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  55
* EL156.cbl
  2662*    COPY EL156S.
  2663 01  EL156AI.
  2664     05  FILLER            PIC  X(0012).
  2665*    -------------------------------
  2666     05  RUNDTEAL PIC S9(0004) COMP.
  2667     05  RUNDTEAF PIC  X(0001).
  2668     05  FILLER REDEFINES RUNDTEAF.
  2669         10  RUNDTEAA PIC  X(0001).
  2670     05  RUNDTEAI PIC  X(0008).
  2671*    -------------------------------
  2672     05  RUNTIMAL PIC S9(0004) COMP.
  2673     05  RUNTIMAF PIC  X(0001).
  2674     05  FILLER REDEFINES RUNTIMAF.
  2675         10  RUNTIMAA PIC  X(0001).
  2676     05  RUNTIMAI PIC  X(0005).
  2677*    -------------------------------
  2678     05  SEQUL PIC S9(0004) COMP.
  2679     05  SEQUF PIC  X(0001).
  2680     05  FILLER REDEFINES SEQUF.
  2681         10  SEQUA PIC  X(0001).
  2682     05  SEQUI PIC  X(0010).
  2683*    -------------------------------
  2684     05  CLMNOL PIC S9(0004) COMP.
  2685     05  CLMNOF PIC  X(0001).
  2686     05  FILLER REDEFINES CLMNOF.
  2687         10  CLMNOA PIC  X(0001).
  2688     05  CLMNOI PIC  X(0007).
  2689*    -------------------------------
  2690     05  CARRL PIC S9(0004) COMP.
  2691     05  CARRF PIC  X(0001).
  2692     05  FILLER REDEFINES CARRF.
  2693         10  CARRA PIC  X(0001).
  2694     05  CARRI PIC  X(0001).
  2695*    -------------------------------
  2696     05  CERTNOL PIC S9(0004) COMP.
  2697     05  CERTNOF PIC  X(0001).
  2698     05  FILLER REDEFINES CERTNOF.
  2699         10  CERTNOA PIC  X(0001).
  2700     05  CERTNOI PIC  X(0010).
  2701*    -------------------------------
  2702     05  SUFXL PIC S9(0004) COMP.
  2703     05  SUFXF PIC  X(0001).
  2704     05  FILLER REDEFINES SUFXF.
  2705         10  SUFXA PIC  X(0001).
  2706     05  SUFXI PIC  X(0001).
  2707*    -------------------------------
  2708     05  CLMTYPL PIC S9(0004) COMP.
  2709     05  CLMTYPF PIC  X(0001).
  2710     05  FILLER REDEFINES CLMTYPF.
  2711         10  CLMTYPA PIC  X(0001).
  2712     05  CLMTYPI PIC  X(0006).
  2713*    -------------------------------
  2714     05  CLMSTATL PIC S9(0004) COMP.
  2715     05  CLMSTATF PIC  X(0001).
  2716     05  FILLER REDEFINES CLMSTATF.
  2717         10  CLMSTATA PIC  X(0001).
  2718     05  CLMSTATI PIC  X(0006).
  2719*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  56
* EL156.cbl
  2720     05  LSTNMEL PIC S9(0004) COMP.
  2721     05  LSTNMEF PIC  X(0001).
  2722     05  FILLER REDEFINES LSTNMEF.
  2723         10  LSTNMEA PIC  X(0001).
  2724     05  LSTNMEI PIC  X(0015).
  2725*    -------------------------------
  2726     05  FSTNMEL PIC S9(0004) COMP.
  2727     05  FSTNMEF PIC  X(0001).
  2728     05  FILLER REDEFINES FSTNMEF.
  2729         10  FSTNMEA PIC  X(0001).
  2730     05  FSTNMEI PIC  X(0012).
  2731*    -------------------------------
  2732     05  MINITL PIC S9(0004) COMP.
  2733     05  MINITF PIC  X(0001).
  2734     05  FILLER REDEFINES MINITF.
  2735         10  MINITA PIC  X(0001).
  2736     05  MINITI PIC  X(0001).
  2737*    -------------------------------
  2738     05  PRIMHDGL PIC S9(0004) COMP.
  2739     05  PRIMHDGF PIC  X(0001).
  2740     05  FILLER REDEFINES PRIMHDGF.
  2741         10  PRIMHDGA PIC  X(0001).
  2742     05  PRIMHDGI PIC  X(0012).
  2743*    -------------------------------
  2744     05  PCERTNOL PIC S9(0004) COMP.
  2745     05  PCERTNOF PIC  X(0001).
  2746     05  FILLER REDEFINES PCERTNOF.
  2747         10  PCERTNOA PIC  X(0001).
  2748     05  PCERTNOI PIC  X(0010).
  2749*    -------------------------------
  2750     05  PSUFXL PIC S9(0004) COMP.
  2751     05  PSUFXF PIC  X(0001).
  2752     05  FILLER REDEFINES PSUFXF.
  2753         10  PSUFXA PIC  X(0001).
  2754     05  PSUFXI PIC  X(0001).
  2755*    -------------------------------
  2756     05  STATUSL PIC S9(0004) COMP.
  2757     05  STATUSF PIC  X(0001).
  2758     05  FILLER REDEFINES STATUSF.
  2759         10  STATUSA PIC  X(0001).
  2760     05  STATUSI PIC  X(0010).
  2761*    -------------------------------
  2762     05  LOANHL PIC S9(0004) COMP.
  2763     05  LOANHF PIC  X(0001).
  2764     05  FILLER REDEFINES LOANHF.
  2765         10  LOANHA PIC  X(0001).
  2766     05  LOANHI PIC  X(0014).
  2767*    -------------------------------
  2768     05  LOANNOL PIC S9(0004) COMP.
  2769     05  LOANNOF PIC  X(0001).
  2770     05  FILLER REDEFINES LOANNOF.
  2771         10  LOANNOA PIC  X(0001).
  2772     05  LOANNOI PIC  X(0025).
  2773*    -------------------------------
  2774     05  DUEDAYHL PIC S9(0004) COMP.
  2775     05  DUEDAYHF PIC  X(0001).
  2776     05  FILLER REDEFINES DUEDAYHF.
  2777         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  57
* EL156.cbl
  2778     05  DUEDAYHI PIC  X(0008).
  2779*    -------------------------------
  2780     05  DUEDAYL PIC S9(0004) COMP.
  2781     05  DUEDAYF PIC  X(0001).
  2782     05  FILLER REDEFINES DUEDAYF.
  2783         10  DUEDAYA PIC  X(0001).
  2784     05  DUEDAYI PIC  X(0002).
  2785*    -------------------------------
  2786     05  ZINTHL PIC S9(0004) COMP.
  2787     05  ZINTHF PIC  X(0001).
  2788     05  FILLER REDEFINES ZINTHF.
  2789         10  ZINTHA PIC  X(0001).
  2790     05  ZINTHI PIC  X(0009).
  2791*    -------------------------------
  2792     05  ZINTL PIC S9(0004) COMP.
  2793     05  ZINTF PIC  X(0001).
  2794     05  FILLER REDEFINES ZINTF.
  2795         10  ZINTA PIC  X(0001).
  2796     05  ZINTI PIC  99V99999.
  2797*    -------------------------------
  2798     05  PTHRHDGL PIC S9(0004) COMP.
  2799     05  PTHRHDGF PIC  X(0001).
  2800     05  FILLER REDEFINES PTHRHDGF.
  2801         10  PTHRHDGA PIC  X(0001).
  2802     05  PTHRHDGI PIC  X(0014).
  2803*    -------------------------------
  2804     05  PDTHRUL PIC S9(0004) COMP.
  2805     05  PDTHRUF PIC  X(0001).
  2806     05  FILLER REDEFINES PDTHRUF.
  2807         10  PDTHRUA PIC  X(0001).
  2808     05  PDTHRUI PIC  X(0008).
  2809*    -------------------------------
  2810     05  TOTPAIDL PIC S9(0004) COMP.
  2811     05  TOTPAIDF PIC  X(0001).
  2812     05  FILLER REDEFINES TOTPAIDF.
  2813         10  TOTPAIDA PIC  X(0001).
  2814     05  TOTPAIDI PIC  X(0010).
  2815*    -------------------------------
  2816     05  COVERL PIC S9(0004) COMP.
  2817     05  COVERF PIC  X(0001).
  2818     05  FILLER REDEFINES COVERF.
  2819         10  COVERA PIC  X(0001).
  2820     05  COVERI PIC  X(0010).
  2821*    -------------------------------
  2822     05  INCURL PIC S9(0004) COMP.
  2823     05  INCURF PIC  X(0001).
  2824     05  FILLER REDEFINES INCURF.
  2825         10  INCURA PIC  X(0001).
  2826     05  INCURI PIC  X(0008).
  2827*    -------------------------------
  2828     05  LSTDTEL PIC S9(0004) COMP.
  2829     05  LSTDTEF PIC  X(0001).
  2830     05  FILLER REDEFINES LSTDTEF.
  2831         10  LSTDTEA PIC  X(0001).
  2832     05  LSTDTEI PIC  X(0008).
  2833*    -------------------------------
  2834     05  CRTSTATL PIC S9(0004) COMP.
  2835     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  58
* EL156.cbl
  2836     05  FILLER REDEFINES CRTSTATF.
  2837         10  CRTSTATA PIC  X(0001).
  2838     05  CRTSTATI PIC  X(0010).
  2839*    -------------------------------
  2840     05  EFFECTL PIC S9(0004) COMP.
  2841     05  EFFECTF PIC  X(0001).
  2842     05  FILLER REDEFINES EFFECTF.
  2843         10  EFFECTA PIC  X(0001).
  2844     05  EFFECTI PIC  X(0008).
  2845*    -------------------------------
  2846     05  TERMSL PIC S9(0004) COMP.
  2847     05  TERMSF PIC  X(0001).
  2848     05  FILLER REDEFINES TERMSF.
  2849         10  TERMSA PIC  X(0001).
  2850     05  TERMSI PIC  X(0011).
  2851*    -------------------------------
  2852     05  STACCTL PIC S9(0004) COMP.
  2853     05  STACCTF PIC  X(0001).
  2854     05  FILLER REDEFINES STACCTF.
  2855         10  STACCTA PIC  X(0001).
  2856     05  STACCTI PIC  X(0013).
  2857*    -------------------------------
  2858     05  EXPDTEHL PIC S9(0004) COMP.
  2859     05  EXPDTEHF PIC  X(0001).
  2860     05  FILLER REDEFINES EXPDTEHF.
  2861         10  EXPDTEHA PIC  X(0001).
  2862     05  EXPDTEHI PIC  X(0014).
  2863*    -------------------------------
  2864     05  EXPDTEL PIC S9(0004) COMP.
  2865     05  EXPDTEF PIC  X(0001).
  2866     05  FILLER REDEFINES EXPDTEF.
  2867         10  EXPDTEA PIC  X(0001).
  2868     05  EXPDTEI PIC  X(0008).
  2869*    -------------------------------
  2870     05  BENECAPL PIC S9(0004) COMP.
  2871     05  BENECAPF PIC  X(0001).
  2872     05  FILLER REDEFINES BENECAPF.
  2873         10  BENECAPA PIC  X(0001).
  2874     05  BENECAPI PIC  X(0013).
  2875*    -------------------------------
  2876     05  BENEL PIC S9(0004) COMP.
  2877     05  BENEF PIC  X(0001).
  2878     05  FILLER REDEFINES BENEF.
  2879         10  BENEA PIC  X(0001).
  2880     05  BENEI PIC  X(0009).
  2881*    -------------------------------
  2882     05  FORMTYPL PIC S9(0004) COMP.
  2883     05  FORMTYPF PIC  X(0001).
  2884     05  FILLER REDEFINES FORMTYPF.
  2885         10  FORMTYPA PIC  X(0001).
  2886     05  FORMTYPI PIC  X(0001).
  2887*    -------------------------------
  2888     05  PMTTYPEL PIC S9(0004) COMP.
  2889     05  PMTTYPEF PIC  X(0001).
  2890     05  FILLER REDEFINES PMTTYPEF.
  2891         10  PMTTYPEA PIC  X(0001).
  2892     05  PMTTYPEI PIC  X(0001).
  2893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  59
* EL156.cbl
  2894     05  PAYEEL PIC S9(0004) COMP.
  2895     05  PAYEEF PIC  X(0001).
  2896     05  FILLER REDEFINES PAYEEF.
  2897         10  PAYEEA PIC  X(0001).
  2898     05  PAYEEI PIC  X(0002).
  2899*    -------------------------------
  2900     05  CHECKNOL PIC S9(0004) COMP.
  2901     05  CHECKNOF PIC  X(0001).
  2902     05  FILLER REDEFINES CHECKNOF.
  2903         10  CHECKNOA PIC  X(0001).
  2904     05  CHECKNOI PIC  X(0007).
  2905*    -------------------------------
  2906     05  OFFLINEL PIC S9(0004) COMP.
  2907     05  OFFLINEF PIC  X(0001).
  2908     05  FILLER REDEFINES OFFLINEF.
  2909         10  OFFLINEA PIC  X(0001).
  2910     05  OFFLINEI PIC  X(0001).
  2911*    -------------------------------
  2912     05  HOLDTILL PIC S9(0004) COMP.
  2913     05  HOLDTILF PIC  X(0001).
  2914     05  FILLER REDEFINES HOLDTILF.
  2915         10  HOLDTILA PIC  X(0001).
  2916     05  HOLDTILI PIC  X(0008).
  2917*    -------------------------------
  2918     05  NOTE1L PIC S9(0004) COMP.
  2919     05  NOTE1F PIC  X(0001).
  2920     05  FILLER REDEFINES NOTE1F.
  2921         10  NOTE1A PIC  X(0001).
  2922     05  NOTE1I PIC  X(0060).
  2923*    -------------------------------
  2924     05  NOTE2L PIC S9(0004) COMP.
  2925     05  NOTE2F PIC  X(0001).
  2926     05  FILLER REDEFINES NOTE2F.
  2927         10  NOTE2A PIC  X(0001).
  2928     05  NOTE2I PIC  X(0060).
  2929*    -------------------------------
  2930     05  EOBYNL PIC S9(0004) COMP.
  2931     05  EOBYNF PIC  X(0001).
  2932     05  FILLER REDEFINES EOBYNF.
  2933         10  EOBYNA PIC  X(0001).
  2934     05  EOBYNI PIC  X(0001).
  2935*    -------------------------------
  2936     05  CLMFMYNL PIC S9(0004) COMP.
  2937     05  CLMFMYNF PIC  X(0001).
  2938     05  FILLER REDEFINES CLMFMYNF.
  2939         10  CLMFMYNA PIC  X(0001).
  2940     05  CLMFMYNI PIC  X(0001).
  2941*    -------------------------------
  2942     05  SURVYYNL PIC S9(0004) COMP.
  2943     05  SURVYYNF PIC  X(0001).
  2944     05  FILLER REDEFINES SURVYYNF.
  2945         10  SURVYYNA PIC  X(0001).
  2946     05  SURVYYNI PIC  X(0001).
  2947*    -------------------------------
  2948     05  SPRELYNL PIC S9(0004) COMP.
  2949     05  SPRELYNF PIC  X(0001).
  2950     05  FILLER REDEFINES SPRELYNF.
  2951         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  60
* EL156.cbl
  2952     05  SPRELYNI PIC  X(0001).
  2953*    -------------------------------
  2954     05  PINTHL PIC S9(0004) COMP.
  2955     05  PINTHF PIC  X(0001).
  2956     05  FILLER REDEFINES PINTHF.
  2957         10  PINTHA PIC  X(0001).
  2958     05  PINTHI PIC  X(0004).
  2959*    -------------------------------
  2960     05  PINTL PIC S9(0004) COMP.
  2961     05  PINTF PIC  X(0001).
  2962     05  FILLER REDEFINES PINTF.
  2963         10  PINTA PIC  X(0001).
  2964     05  PINTI PIC  X(0008).
  2965*    -------------------------------
  2966     05  PROOFDTL PIC S9(0004) COMP.
  2967     05  PROOFDTF PIC  X(0001).
  2968     05  FILLER REDEFINES PROOFDTF.
  2969         10  PROOFDTA PIC  X(0001).
  2970     05  PROOFDTI PIC  X(0008).
  2971*    -------------------------------
  2972     05  AIGFRMHL PIC S9(0004) COMP.
  2973     05  AIGFRMHF PIC  X(0001).
  2974     05  FILLER REDEFINES AIGFRMHF.
  2975         10  AIGFRMHA PIC  X(0001).
  2976     05  AIGFRMHI PIC  X(0012).
  2977*    -------------------------------
  2978     05  AIGFROML PIC S9(0004) COMP.
  2979     05  AIGFROMF PIC  X(0001).
  2980     05  FILLER REDEFINES AIGFROMF.
  2981         10  AIGFROMA PIC  X(0001).
  2982     05  AIGFROMI PIC  X(0008).
  2983*    -------------------------------
  2984     05  PMTHDGAL PIC S9(0004) COMP.
  2985     05  PMTHDGAF PIC  X(0001).
  2986     05  FILLER REDEFINES PMTHDGAF.
  2987         10  PMTHDGAA PIC  X(0001).
  2988     05  PMTHDGAI PIC  X(0066).
  2989*    -------------------------------
  2990     05  EPYFROML PIC S9(0004) COMP.
  2991     05  EPYFROMF PIC  X(0001).
  2992     05  FILLER REDEFINES EPYFROMF.
  2993         10  EPYFROMA PIC  X(0001).
  2994     05  EPYFROMI PIC  X(0008).
  2995*    -------------------------------
  2996     05  EPYTHRUL PIC S9(0004) COMP.
  2997     05  EPYTHRUF PIC  X(0001).
  2998     05  FILLER REDEFINES EPYTHRUF.
  2999         10  EPYTHRUA PIC  X(0001).
  3000     05  EPYTHRUI PIC  X(0008).
  3001*    -------------------------------
  3002     05  EDAYSL PIC S9(0004) COMP.
  3003     05  EDAYSF PIC  X(0001).
  3004     05  FILLER REDEFINES EDAYSF.
  3005         10  EDAYSA PIC  X(0001).
  3006     05  EDAYSI PIC  S9(6).
  3007*    -------------------------------
  3008     05  EPYAMTL PIC S9(0004) COMP.
  3009     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  61
* EL156.cbl
  3010     05  FILLER REDEFINES EPYAMTF.
  3011         10  EPYAMTA PIC  X(0001).
  3012     05  EPYAMTI PIC  S9(8)V99.
  3013*    -------------------------------
  3014     05  ERESVL PIC S9(0004) COMP.
  3015     05  ERESVF PIC  X(0001).
  3016     05  FILLER REDEFINES ERESVF.
  3017         10  ERESVA PIC  X(0001).
  3018     05  ERESVI PIC  S9(7)V99.
  3019*    -------------------------------
  3020     05  ETYPEL PIC S9(0004) COMP.
  3021     05  ETYPEF PIC  X(0001).
  3022     05  FILLER REDEFINES ETYPEF.
  3023         10  ETYPEA PIC  X(0001).
  3024     05  ETYPEI PIC  X(0001).
  3025*    -------------------------------
  3026     05  EEXPENSL PIC S9(0004) COMP.
  3027     05  EEXPENSF PIC  X(0001).
  3028     05  FILLER REDEFINES EEXPENSF.
  3029         10  EEXPENSA PIC  X(0001).
  3030     05  EEXPENSI PIC  9(6)V99.
  3031*    -------------------------------
  3032     05  CPYFROML PIC S9(0004) COMP.
  3033     05  CPYFROMF PIC  X(0001).
  3034     05  FILLER REDEFINES CPYFROMF.
  3035         10  CPYFROMA PIC  X(0001).
  3036     05  CPYFROMI PIC  X(0008).
  3037*    -------------------------------
  3038     05  CPYTHRUL PIC S9(0004) COMP.
  3039     05  CPYTHRUF PIC  X(0001).
  3040     05  FILLER REDEFINES CPYTHRUF.
  3041         10  CPYTHRUA PIC  X(0001).
  3042     05  CPYTHRUI PIC  X(0008).
  3043*    -------------------------------
  3044     05  CDAYSL PIC S9(0004) COMP.
  3045     05  CDAYSF PIC  X(0001).
  3046     05  FILLER REDEFINES CDAYSF.
  3047         10  CDAYSA PIC  X(0001).
  3048     05  CDAYSI PIC  9(6).
  3049*    -------------------------------
  3050     05  CPYAMTL PIC S9(0004) COMP.
  3051     05  CPYAMTF PIC  X(0001).
  3052     05  FILLER REDEFINES CPYAMTF.
  3053         10  CPYAMTA PIC  X(0001).
  3054     05  CPYAMTI PIC  S9(8)V99.
  3055*    -------------------------------
  3056     05  CRESVL PIC S9(0004) COMP.
  3057     05  CRESVF PIC  X(0001).
  3058     05  FILLER REDEFINES CRESVF.
  3059         10  CRESVA PIC  X(0001).
  3060     05  CRESVI PIC  9(6)V99.
  3061*    -------------------------------
  3062     05  CEXPENSL PIC S9(0004) COMP.
  3063     05  CEXPENSF PIC  X(0001).
  3064     05  FILLER REDEFINES CEXPENSF.
  3065         10  CEXPENSA PIC  X(0001).
  3066     05  CEXPENSI PIC  9(6)V99.
  3067*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  62
* EL156.cbl
  3068     05  ERRMSG0L PIC S9(0004) COMP.
  3069     05  ERRMSG0F PIC  X(0001).
  3070     05  FILLER REDEFINES ERRMSG0F.
  3071         10  ERRMSG0A PIC  X(0001).
  3072     05  ERRMSG0I PIC  X(0072).
  3073*    -------------------------------
  3074     05  ERRMSG1L PIC S9(0004) COMP.
  3075     05  ERRMSG1F PIC  X(0001).
  3076     05  FILLER REDEFINES ERRMSG1F.
  3077         10  ERRMSG1A PIC  X(0001).
  3078     05  ERRMSG1I PIC  X(0072).
  3079*    -------------------------------
  3080     05  ERRMSG2L PIC S9(0004) COMP.
  3081     05  ERRMSG2F PIC  X(0001).
  3082     05  FILLER REDEFINES ERRMSG2F.
  3083         10  ERRMSG2A PIC  X(0001).
  3084     05  ERRMSG2I PIC  X(0072).
  3085*    -------------------------------
  3086     05  ENTERPFL PIC S9(0004) COMP.
  3087     05  ENTERPFF PIC  X(0001).
  3088     05  FILLER REDEFINES ENTERPFF.
  3089         10  ENTERPFA PIC  X(0001).
  3090     05  ENTERPFI PIC  99.
  3091*    -------------------------------
  3092     05  PF6TITL PIC S9(0004) COMP.
  3093     05  PF6TITF PIC  X(0001).
  3094     05  FILLER REDEFINES PF6TITF.
  3095         10  PF6TITA PIC  X(0001).
  3096     05  PF6TITI PIC  X(0016).
  3097 01  EL156AO REDEFINES EL156AI.
  3098     05  FILLER            PIC  X(0012).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  RUNDTEAO PIC  X(0008).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  RUNTIMAO PIC  99.99.
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  SEQUO PIC  X(0010).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  CLMNOO PIC  X(0007).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  CARRO PIC  X(0001).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  CERTNOO PIC  X(0010).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  SUFXO PIC  X(0001).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  CLMTYPO PIC  X(0006).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  63
* EL156.cbl
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  LSTNMEO PIC  X(0015).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  FSTNMEO PIC  X(0012).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  MINITO PIC  X(0001).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  PRIMHDGO PIC  X(0012).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  PCERTNOO PIC  X(0010).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  PSUFXO PIC  X(0001).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  STATUSO PIC  X(0010).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  LOANHO PIC  X(0014).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  LOANNOO PIC  X(0025).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  DUEDAYHO PIC  X(0008).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  DUEDAYO PIC  X(0002).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  ZINTHO PIC  X(0009).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  ZINTO PIC  9.99999.
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  PTHRHDGO PIC  X(0014).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  PDTHRUO PIC  X(0008).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  TOTPAIDO PIC  Z(6).99-.
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  COVERO PIC  X(0010).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  INCURO PIC  X(0008).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  LSTDTEO PIC  X(0008).
  3183*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  64
* EL156.cbl
  3184     05  FILLER            PIC  X(0003).
  3185     05  CRTSTATO PIC  X(0010).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  EFFECTO PIC  X(0008).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  TERMSO PIC  X(0011).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  STACCTO PIC  X(0013).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  EXPDTEHO PIC  X(0014).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  EXPDTEO PIC  X(0008).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  BENECAPO PIC  X(0013).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  BENEO PIC  Z(6).99.
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  FORMTYPO PIC  X(0001).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PMTTYPEO PIC  X(0001).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PAYEEO PIC  X(0002).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  CHECKNOO PIC  X(0007).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  OFFLINEO PIC  X(0001).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  HOLDTILO PIC  99B99B99.
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  NOTE1O PIC  X(0060).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  NOTE2O PIC  X(0060).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  EOBYNO PIC  X(0001).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  CLMFMYNO PIC  X(0001).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  SURVYYNO PIC  X(0001).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  65
* EL156.cbl
  3242     05  SPRELYNO PIC  X(0001).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  PINTHO PIC  X(0004).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  PINTO PIC  Z,ZZ9.99.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  PROOFDTO PIC  99B99B99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  AIGFRMHO PIC  X(0012).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  AIGFROMO PIC  99B99B99.
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  PMTHDGAO PIC  X(0066).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  EPYFROMO PIC  99B99B99.
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  EPYTHRUO PIC  99B99B99.
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EDAYSO PIC  Z(4)9-.
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EPYAMTO PIC  Z(6).99-.
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ERESVO PIC  Z(5).99-.
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  ETYPEO PIC  X(0001).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  EEXPENSO PIC  Z(5).99.
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  CPYFROMO PIC  99B99B99.
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  CPYTHRUO PIC  99B99B99.
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CDAYSO PIC  Z(4)9-.
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  CPYAMTO PIC  Z(6).99-.
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  CRESVO PIC  Z(5).99.
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  66
* EL156.cbl
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ERRMSG0O PIC  X(0072).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  ERRMSG1O PIC  X(0072).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ERRMSG2O PIC  X(0072).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  ENTERPFO PIC  X(0002).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  PF6TITO PIC  X(0016).
  3315*    -------------------------------
  3316 01  EL156BI REDEFINES EL156AI.
  3317     05  FILLER            PIC  X(0012).
  3318*    -------------------------------
  3319     05  RUNDTEBL PIC S9(0004) COMP.
  3320     05  RUNDTEBF PIC  X(0001).
  3321     05  FILLER REDEFINES RUNDTEBF.
  3322         10  RUNDTEBA PIC  X(0001).
  3323     05  RUNDTEBI PIC  X(0008).
  3324*    -------------------------------
  3325     05  RUNTIMBL PIC S9(0004) COMP.
  3326     05  RUNTIMBF PIC  X(0001).
  3327     05  FILLER REDEFINES RUNTIMBF.
  3328         10  RUNTIMBA PIC  X(0001).
  3329     05  RUNTIMBI PIC  X(0005).
  3330*    -------------------------------
  3331     05  PAYDTBL PIC S9(0004) COMP.
  3332     05  PAYDTBF PIC  X(0001).
  3333     05  FILLER REDEFINES PAYDTBF.
  3334         10  PAYDTBA PIC  X(0001).
  3335     05  PAYDTBI PIC  X(0008).
  3336*    -------------------------------
  3337     05  PAYTYPBL PIC S9(0004) COMP.
  3338     05  PAYTYPBF PIC  X(0001).
  3339     05  FILLER REDEFINES PAYTYPBF.
  3340         10  PAYTYPBA PIC  X(0001).
  3341     05  PAYTYPBI PIC  X(0015).
  3342*    -------------------------------
  3343     05  PAYAMTBL PIC S9(0004) COMP.
  3344     05  PAYAMTBF PIC  X(0001).
  3345     05  FILLER REDEFINES PAYAMTBF.
  3346         10  PAYAMTBA PIC  X(0001).
  3347     05  PAYAMTBI PIC  X(0011).
  3348*    -------------------------------
  3349     05  LOANHBL PIC S9(0004) COMP.
  3350     05  LOANHBF PIC  X(0001).
  3351     05  FILLER REDEFINES LOANHBF.
  3352         10  LOANHBA PIC  X(0001).
  3353     05  LOANHBI PIC  X(0012).
  3354*    -------------------------------
  3355     05  LOANNBL PIC S9(0004) COMP.
  3356     05  LOANNBF PIC  X(0001).
  3357     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  67
* EL156.cbl
  3358         10  LOANNBA PIC  X(0001).
  3359     05  LOANNBI PIC  X(0025).
  3360*    -------------------------------
  3361     05  CKNUMHDL PIC S9(0004) COMP.
  3362     05  CKNUMHDF PIC  X(0001).
  3363     05  FILLER REDEFINES CKNUMHDF.
  3364         10  CKNUMHDA PIC  X(0001).
  3365     05  CKNUMHDI PIC  X(0012).
  3366*    -------------------------------
  3367     05  CKNUMBL PIC S9(0004) COMP.
  3368     05  CKNUMBF PIC  X(0001).
  3369     05  FILLER REDEFINES CKNUMBF.
  3370         10  CKNUMBA PIC  X(0001).
  3371     05  CKNUMBI PIC  X(0007).
  3372*    -------------------------------
  3373     05  AGTHDGL PIC S9(0004) COMP.
  3374     05  AGTHDGF PIC  X(0001).
  3375     05  FILLER REDEFINES AGTHDGF.
  3376         10  AGTHDGA PIC  X(0001).
  3377     05  AGTHDGI PIC  X(0016).
  3378*    -------------------------------
  3379     05  NAMEBL PIC S9(0004) COMP.
  3380     05  NAMEBF PIC  X(0001).
  3381     05  FILLER REDEFINES NAMEBF.
  3382         10  NAMEBA PIC  X(0001).
  3383     05  NAMEBI PIC  X(0030).
  3384*    -------------------------------
  3385     05  NAMEB2L PIC S9(0004) COMP.
  3386     05  NAMEB2F PIC  X(0001).
  3387     05  FILLER REDEFINES NAMEB2F.
  3388         10  NAMEB2A PIC  X(0001).
  3389     05  NAMEB2I PIC  X(0030).
  3390*    -------------------------------
  3391     05  ADDR1BL PIC S9(0004) COMP.
  3392     05  ADDR1BF PIC  X(0001).
  3393     05  FILLER REDEFINES ADDR1BF.
  3394         10  ADDR1BA PIC  X(0001).
  3395     05  ADDR1BI PIC  X(0030).
  3396*    -------------------------------
  3397     05  ADDR1B2L PIC S9(0004) COMP.
  3398     05  ADDR1B2F PIC  X(0001).
  3399     05  FILLER REDEFINES ADDR1B2F.
  3400         10  ADDR1B2A PIC  X(0001).
  3401     05  ADDR1B2I PIC  X(0030).
  3402*    -------------------------------
  3403     05  ADDR2BL PIC S9(0004) COMP.
  3404     05  ADDR2BF PIC  X(0001).
  3405     05  FILLER REDEFINES ADDR2BF.
  3406         10  ADDR2BA PIC  X(0001).
  3407     05  ADDR2BI PIC  X(0030).
  3408*    -------------------------------
  3409     05  ADDR2B2L PIC S9(0004) COMP.
  3410     05  ADDR2B2F PIC  X(0001).
  3411     05  FILLER REDEFINES ADDR2B2F.
  3412         10  ADDR2B2A PIC  X(0001).
  3413     05  ADDR2B2I PIC  X(0030).
  3414*    -------------------------------
  3415     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  68
* EL156.cbl
  3416     05  CITYSTBF PIC  X(0001).
  3417     05  FILLER REDEFINES CITYSTBF.
  3418         10  CITYSTBA PIC  X(0001).
  3419     05  CITYSTBI PIC  X(0030).
  3420*    -------------------------------
  3421     05  CITYST2L PIC S9(0004) COMP.
  3422     05  CITYST2F PIC  X(0001).
  3423     05  FILLER REDEFINES CITYST2F.
  3424         10  CITYST2A PIC  X(0001).
  3425     05  CITYST2I PIC  X(0030).
  3426*    -------------------------------
  3427     05  ZIPBL PIC S9(0004) COMP.
  3428     05  ZIPBF PIC  X(0001).
  3429     05  FILLER REDEFINES ZIPBF.
  3430         10  ZIPBA PIC  X(0001).
  3431     05  ZIPBI PIC  X(0009).
  3432*    -------------------------------
  3433     05  ZIPB2L PIC S9(0004) COMP.
  3434     05  ZIPB2F PIC  X(0001).
  3435     05  FILLER REDEFINES ZIPB2F.
  3436         10  ZIPB2A PIC  X(0001).
  3437     05  ZIPB2I PIC  X(0009).
  3438*    -------------------------------
  3439     05  INTHDBL PIC S9(0004) COMP.
  3440     05  INTHDBF PIC  X(0001).
  3441     05  FILLER REDEFINES INTHDBF.
  3442         10  INTHDBA PIC  X(0001).
  3443     05  INTHDBI PIC  X(0012).
  3444*    -------------------------------
  3445     05  INTAMTBL PIC S9(0004) COMP.
  3446     05  INTAMTBF PIC  X(0001).
  3447     05  FILLER REDEFINES INTAMTBF.
  3448         10  INTAMTBA PIC  X(0001).
  3449     05  INTAMTBI PIC  X(0011).
  3450*    -------------------------------
  3451     05  PMTHDGBL PIC S9(0004) COMP.
  3452     05  PMTHDGBF PIC  X(0001).
  3453     05  FILLER REDEFINES PMTHDGBF.
  3454         10  PMTHDGBA PIC  X(0001).
  3455     05  PMTHDGBI PIC  X(0034).
  3456*    -------------------------------
  3457     05  CLMNOBL PIC S9(0004) COMP.
  3458     05  CLMNOBF PIC  X(0001).
  3459     05  FILLER REDEFINES CLMNOBF.
  3460         10  CLMNOBA PIC  X(0001).
  3461     05  CLMNOBI PIC  X(0007).
  3462*    -------------------------------
  3463     05  CARRBL PIC S9(0004) COMP.
  3464     05  CARRBF PIC  X(0001).
  3465     05  FILLER REDEFINES CARRBF.
  3466         10  CARRBA PIC  X(0001).
  3467     05  CARRBI PIC  X(0001).
  3468*    -------------------------------
  3469     05  CERTNOBL PIC S9(0004) COMP.
  3470     05  CERTNOBF PIC  X(0001).
  3471     05  FILLER REDEFINES CERTNOBF.
  3472         10  CERTNOBA PIC  X(0001).
  3473     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  69
* EL156.cbl
  3474*    -------------------------------
  3475     05  SUFXBL PIC S9(0004) COMP.
  3476     05  SUFXBF PIC  X(0001).
  3477     05  FILLER REDEFINES SUFXBF.
  3478         10  SUFXBA PIC  X(0001).
  3479     05  SUFXBI PIC  X(0001).
  3480*    -------------------------------
  3481     05  CLMTYPBL PIC S9(0004) COMP.
  3482     05  CLMTYPBF PIC  X(0001).
  3483     05  FILLER REDEFINES CLMTYPBF.
  3484         10  CLMTYPBA PIC  X(0001).
  3485     05  CLMTYPBI PIC  X(0006).
  3486*    -------------------------------
  3487     05  INCURBL PIC S9(0004) COMP.
  3488     05  INCURBF PIC  X(0001).
  3489     05  FILLER REDEFINES INCURBF.
  3490         10  INCURBA PIC  X(0001).
  3491     05  INCURBI PIC  X(0008).
  3492*    -------------------------------
  3493     05  PYFROMBL PIC S9(0004) COMP.
  3494     05  PYFROMBF PIC  X(0001).
  3495     05  FILLER REDEFINES PYFROMBF.
  3496         10  PYFROMBA PIC  X(0001).
  3497     05  PYFROMBI PIC  X(0008).
  3498*    -------------------------------
  3499     05  PYTHRUBL PIC S9(0004) COMP.
  3500     05  PYTHRUBF PIC  X(0001).
  3501     05  FILLER REDEFINES PYTHRUBF.
  3502         10  PYTHRUBA PIC  X(0001).
  3503     05  PYTHRUBI PIC  X(0008).
  3504*    -------------------------------
  3505     05  DAYSBL PIC S9(0004) COMP.
  3506     05  DAYSBF PIC  X(0001).
  3507     05  FILLER REDEFINES DAYSBF.
  3508         10  DAYSBA PIC  X(0001).
  3509     05  DAYSBI PIC  X(0005).
  3510*    -------------------------------
  3511     05  BYBL PIC S9(0004) COMP.
  3512     05  BYBF PIC  X(0001).
  3513     05  FILLER REDEFINES BYBF.
  3514         10  BYBA PIC  X(0001).
  3515     05  BYBI PIC  X(0004).
  3516*    -------------------------------
  3517     05  PROOFDBL PIC S9(0004) COMP.
  3518     05  PROOFDBF PIC  X(0001).
  3519     05  FILLER REDEFINES PROOFDBF.
  3520         10  PROOFDBA PIC  X(0001).
  3521     05  PROOFDBI PIC  X(0008).
  3522*    -------------------------------
  3523     05  ACCTBL PIC S9(0004) COMP.
  3524     05  ACCTBF PIC  X(0001).
  3525     05  FILLER REDEFINES ACCTBF.
  3526         10  ACCTBA PIC  X(0001).
  3527     05  ACCTBI PIC  X(0010).
  3528*    -------------------------------
  3529     05  STATEBL PIC S9(0004) COMP.
  3530     05  STATEBF PIC  X(0001).
  3531     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  70
* EL156.cbl
  3532         10  STATEBA PIC  X(0001).
  3533     05  STATEBI PIC  X(0002).
  3534*    -------------------------------
  3535     05  GROUPBL PIC S9(0004) COMP.
  3536     05  GROUPBF PIC  X(0001).
  3537     05  FILLER REDEFINES GROUPBF.
  3538         10  GROUPBA PIC  X(0001).
  3539     05  GROUPBI PIC  X(0006).
  3540*    -------------------------------
  3541     05  ACARRBL PIC S9(0004) COMP.
  3542     05  ACARRBF PIC  X(0001).
  3543     05  FILLER REDEFINES ACARRBF.
  3544         10  ACARRBA PIC  X(0001).
  3545     05  ACARRBI PIC  X(0001).
  3546*    -------------------------------
  3547     05  ACCTNMBL PIC S9(0004) COMP.
  3548     05  ACCTNMBF PIC  X(0001).
  3549     05  FILLER REDEFINES ACCTNMBF.
  3550         10  ACCTNMBA PIC  X(0001).
  3551     05  ACCTNMBI PIC  X(0030).
  3552*    -------------------------------
  3553     05  UNDISBL PIC S9(0004) COMP.
  3554     05  UNDISBF PIC  X(0001).
  3555     05  FILLER REDEFINES UNDISBF.
  3556         10  UNDISBA PIC  X(0001).
  3557     05  UNDISBI PIC  X(0010).
  3558*    -------------------------------
  3559     05  RATEBL PIC S9(0004) COMP.
  3560     05  RATEBF PIC  X(0001).
  3561     05  FILLER REDEFINES RATEBF.
  3562         10  RATEBA PIC  X(0001).
  3563     05  RATEBI PIC  X(0006).
  3564*    -------------------------------
  3565     05  ERMSG1BL PIC S9(0004) COMP.
  3566     05  ERMSG1BF PIC  X(0001).
  3567     05  FILLER REDEFINES ERMSG1BF.
  3568         10  ERMSG1BA PIC  X(0001).
  3569     05  ERMSG1BI PIC  X(0072).
  3570*    -------------------------------
  3571     05  ENTPFBL PIC S9(0004) COMP.
  3572     05  ENTPFBF PIC  X(0001).
  3573     05  FILLER REDEFINES ENTPFBF.
  3574         10  ENTPFBA PIC  X(0001).
  3575     05  ENTPFBI PIC  99.
  3576 01  EL156BO REDEFINES EL156AI.
  3577     05  FILLER            PIC  X(0012).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  RUNDTEBO PIC  X(0008).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  RUNTIMBO PIC  99.99.
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  PAYDTBO PIC  99B99B99.
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  71
* EL156.cbl
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  LOANHBO PIC  X(0012).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  LOANNBO PIC  X(0025).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  CKNUMHDO PIC  X(0012).
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  CKNUMBO PIC  X(0007).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  AGTHDGO PIC  X(0016).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  NAMEBO PIC  X(0030).
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  NAMEB2O PIC  X(0030).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  ADDR1BO PIC  X(0030).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  ADDR1B2O PIC  X(0030).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  ADDR2BO PIC  X(0030).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  ADDR2B2O PIC  X(0030).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  CITYSTBO PIC  X(0030).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  CITYST2O PIC  X(0030).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  ZIPBO PIC  ZZZZ99999.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  ZIPB2O PIC  ZZZZZZZZZ.
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  INTHDBO PIC  X(0012).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  PMTHDGBO PIC  X(0034).
  3647*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  72
* EL156.cbl
  3648     05  FILLER            PIC  X(0003).
  3649     05  CLMNOBO PIC  X(0007).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  CARRBO PIC  X(0001).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  CERTNOBO PIC  X(0010).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  SUFXBO PIC  X(0001).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  CLMTYPBO PIC  X(0006).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  INCURBO PIC  X(0008).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  PYFROMBO PIC  99B99B99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PYTHRUBO PIC  99B99B99.
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  DAYSBO PIC  X(0005).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  BYBO PIC  X(0004).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  PROOFDBO PIC  99B99B99.
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  ACCTBO PIC  X(0010).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  STATEBO PIC  X(0002).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  GROUPBO PIC  X(0006).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  ACARRBO PIC  X(0001).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  ACCTNMBO PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  UNDISBO PIC  ZZZ,Z99.99.
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  RATEBO PIC  ZZZ.99.
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  ERMSG1BO PIC  X(0072).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  73
* EL156.cbl
  3706     05  ENTPFBO PIC  X(0002).
  3707*    -------------------------------
  3708****************************************************************
  3709*
  3710* Copyright (c) 2007 by Clerity Solutions, Inc.
  3711* All rights reserved.
  3712*
  3713****************************************************************
  3714 01  DFHEIV.
  3715   02  DFHEIV0               PIC X(35).
  3716   02  DFHEIV1               PIC X(08).
  3717   02  DFHEIV2               PIC X(08).
  3718   02  DFHEIV3               PIC X(08).
  3719   02  DFHEIV4               PIC X(06).
  3720   02  DFHEIV5               PIC X(04).
  3721   02  DFHEIV6               PIC X(04).
  3722   02  DFHEIV7               PIC X(02).
  3723   02  DFHEIV8               PIC X(02).
  3724   02  DFHEIV9               PIC X(01).
  3725   02  DFHEIV10              PIC S9(7) COMP-3.
  3726   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3727   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3728   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3729   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3730   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3731   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3732   02  DFHEIV17              PIC X(04).
  3733   02  DFHEIV18              PIC X(04).
  3734   02  DFHEIV19              PIC X(04).
  3735   02  DFHEIV20              USAGE IS POINTER.
  3736   02  DFHEIV21              USAGE IS POINTER.
  3737   02  DFHEIV22              USAGE IS POINTER.
  3738   02  DFHEIV23              USAGE IS POINTER.
  3739   02  DFHEIV24              USAGE IS POINTER.
  3740   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3741   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3742   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3743   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3744   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3745   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3746   02  FILLER                PIC X(02).
  3747   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3748   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3749   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3750   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3751   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3752 LINKAGE  SECTION.
  3753*****************************************************************
  3754*                                                               *
  3755* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3756* All rights reserved.                                          *
  3757*                                                               *
  3758*****************************************************************
  3759 01  dfheiblk.
  3760     02  eibtime          pic s9(7) comp-3.
  3761     02  eibdate          pic s9(7) comp-3.
  3762     02  eibtrnid         pic x(4).
  3763     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  74
* EL156.cbl
  3764     02  eibtrmid         pic x(4).
  3765     02  dfheigdi         pic s9(4) comp.
  3766     02  eibcposn         pic s9(4) comp.
  3767     02  eibcalen         pic s9(4) comp.
  3768     02  eibaid           pic x(1).
  3769     02  eibfiller1       pic x(1).
  3770     02  eibfn            pic x(2).
  3771     02  eibfiller2       pic x(2).
  3772     02  eibrcode         pic x(6).
  3773     02  eibfiller3       pic x(2).
  3774     02  eibds            pic x(8).
  3775     02  eibreqid         pic x(8).
  3776     02  eibrsrce         pic x(8).
  3777     02  eibsync          pic x(1).
  3778     02  eibfree          pic x(1).
  3779     02  eibrecv          pic x(1).
  3780     02  eibsend          pic x(1).
  3781     02  eibatt           pic x(1).
  3782     02  eibeoc           pic x(1).
  3783     02  eibfmh           pic x(1).
  3784     02  eibcompl         pic x(1).
  3785     02  eibsig           pic x(1).
  3786     02  eibconf          pic x(1).
  3787     02  eiberr           pic x(1).
  3788     02  eibrldbk         pic x(1).
  3789     02  eiberrcd         pic x(4).
  3790     02  eibsynrb         pic x(1).
  3791     02  eibnodat         pic x(1).
  3792     02  eibfiller5       pic x(2).
  3793     02  eibresp          pic 9(09) comp.
  3794     02  eibresp2         pic 9(09) comp.
  3795     02  dfheigdj         pic s9(4) comp.
  3796     02  dfheigdk         pic s9(4) comp.
  3797 01  DFHCOMMAREA             PIC X(1024).
  3798
  3799*    COPY ELCMSTR.
  3800******************************************************************
  3801*                                                                *
  3802*                            ELCMSTR.                            *
  3803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3804*                            VMOD=2.012                          *
  3805*                                                                *
  3806*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3812*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3813*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3814*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3815*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3816*                                                 RKP=75,LEN=21  *
  3817*                                                                *
  3818*   **** NOTE ****                                               *
  3819*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3820*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3821*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  75
* EL156.cbl
  3822*   LOG = YES                                                    *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825*                   C H A N G E   L O G
  3826*
  3827* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3828*-----------------------------------------------------------------
  3829*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3830* EFFECTIVE    NUMBER
  3831*-----------------------------------------------------------------
  3832* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3833* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3834* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3835* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3836* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3837******************************************************************
  3838 01  CLAIM-MASTER.
  3839     12  CL-RECORD-ID                PIC XX.
  3840         88  VALID-CL-ID         VALUE 'CL'.
  3841
  3842     12  CL-CONTROL-PRIMARY.
  3843         16  CL-COMPANY-CD           PIC X.
  3844         16  CL-CARRIER              PIC X.
  3845         16  CL-CLAIM-NO             PIC X(7).
  3846         16  CL-CERT-NO.
  3847             20  CL-CERT-PRIME       PIC X(10).
  3848             20  CL-CERT-SFX         PIC X.
  3849
  3850     12  CL-CONTROL-BY-NAME.
  3851         16  CL-COMPANY-CD-A1        PIC X.
  3852         16  CL-INSURED-LAST-NAME    PIC X(15).
  3853         16  CL-INSURED-NAME.
  3854             20  CL-INSURED-1ST-NAME PIC X(12).
  3855             20  CL-INSURED-MID-INIT PIC X.
  3856
  3857     12  CL-CONTROL-BY-SSN.
  3858         16  CL-COMPANY-CD-A2        PIC X.
  3859         16  CL-SOC-SEC-NO.
  3860             20  CL-SSN-STATE        PIC XX.
  3861             20  CL-SSN-ACCOUNT      PIC X(6).
  3862             20  CL-SSN-LN3          PIC X(3).
  3863
  3864     12  CL-CONTROL-BY-CERT-NO.
  3865         16  CL-COMPANY-CD-A4        PIC X.
  3866         16  CL-CERT-NO-A4.
  3867             20  CL-CERT-A4-PRIME    PIC X(10).
  3868             20  CL-CERT-A4-SFX      PIC X.
  3869
  3870     12  CL-CONTROL-BY-CCN.
  3871         16  CL-COMPANY-CD-A5        PIC X.
  3872         16  CL-CCN-A5.
  3873             20  CL-CCN.
  3874                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3875                 24  CL-CCN-PRIME-A5 PIC X(12).
  3876             20  CL-CCN-FILLER-A5    PIC X(4).
  3877
  3878     12  CL-INSURED-PROFILE-DATA.
  3879         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  76
* EL156.cbl
  3880         16  CL-INSURED-SEX-CD       PIC X.
  3881             88  INSURED-IS-MALE        VALUE 'M'.
  3882             88  INSURED-IS-FEMALE      VALUE 'F'.
  3883             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3884         16  CL-INSURED-OCC-CD       PIC X(6).
  3885         16  FILLER                  PIC X(5).
  3886
  3887     12  CL-PROCESSING-INFO.
  3888         16  CL-PROCESSOR-ID         PIC X(4).
  3889         16  CL-CLAIM-STATUS         PIC X.
  3890             88  CLAIM-IS-OPEN          VALUE 'O'.
  3891             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3892         16  CL-CLAIM-TYPE           PIC X.
  3893*            88  AH-CLAIM               VALUE 'A'.
  3894*            88  LIFE-CLAIM             VALUE 'L'.
  3895*            88  PROPERTY-CLAIM         VALUE 'P'.
  3896*            88  IUI-CLAIM              VALUE 'I'.
  3897*            88  GAP-CLAIM              VALUE 'G'.
  3898*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3899         16  CL-CLAIM-PREM-TYPE      PIC X.
  3900             88  SINGLE-PREMIUM         VALUE '1'.
  3901             88  O-B-COVERAGE           VALUE '2'.
  3902             88  OPEN-END-COVERAGE      VALUE '3'.
  3903         16  CL-INCURRED-DT          PIC XX.
  3904         16  CL-REPORTED-DT          PIC XX.
  3905         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3906         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3907         16  CL-LAST-PMT-DT          PIC XX.
  3908         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3909         16  CL-PAID-THRU-DT         PIC XX.
  3910         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3911         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3912         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3913         16  CL-PMT-CALC-METHOD      PIC X.
  3914             88  CL-360-DAY-YR          VALUE '1'.
  3915             88  CL-365-DAY-YR          VALUE '2'.
  3916             88  CL-FULL-MONTHS         VALUE '3'.
  3917         16  CL-CAUSE-CD             PIC X(6).
  3918
  3919         16  CL-PRIME-CERT-NO.
  3920             20  CL-PRIME-CERT-PRIME PIC X(10).
  3921             20  CL-PRIME-CERT-SFX   PIC X.
  3922
  3923         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3924             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3925             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3926
  3927         16  CL-MICROFILM-NO         PIC X(10).
  3928         16  FILLER REDEFINES CL-MICROFILM-NO.
  3929             20  CL-BENEFIT-PERIOD   PIC 99.
  3930             20  FILLER              PIC X(8).
  3931         16  CL-PROG-FORM-TYPE       PIC X.
  3932         16  CL-LAST-ADD-ON-DT       PIC XX.
  3933
  3934         16  CL-LAST-REOPEN-DT       PIC XX.
  3935         16  CL-LAST-CLOSE-DT        PIC XX.
  3936         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3937             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  77
* EL156.cbl
  3938             88  CLAIM-DENIED           VALUE '2'.
  3939             88  AUTO-CLOSE             VALUE '3'.
  3940             88  MANUAL-CLOSE           VALUE '4'.
  3941             88  BENEFITS-CHANGED       VALUE 'C'.
  3942             88  SETUP-ERRORS           VALUE 'E'.
  3943         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3944         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3945         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3946             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3947         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3948         16  FILLER                  PIC X.
  3949
  3950     12  CL-CERTIFICATE-DATA.
  3951         16  CL-CERT-ORIGIN          PIC X.
  3952             88  CERT-WAS-ONLINE        VALUE '1'.
  3953             88  CERT-WAS-CREATED       VALUE '2'.
  3954             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3955         16  CL-CERT-KEY-DATA.
  3956             20  CL-CERT-CARRIER     PIC X.
  3957             20  CL-CERT-GROUPING    PIC X(6).
  3958             20  CL-CERT-STATE       PIC XX.
  3959             20  CL-CERT-ACCOUNT.
  3960                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3961                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3962             20  CL-CERT-EFF-DT      PIC XX.
  3963
  3964     12  CL-STATUS-CONTROLS.
  3965         16  CL-PRIORITY-CD          PIC X.
  3966             88  CONFIDENTIAL-DATA      VALUE '8'.
  3967             88  HIGHEST-PRIORITY       VALUE '9'.
  3968         16  CL-SUPV-ATTN-CD         PIC X.
  3969             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3970             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3971         16  CL-PURGED-DT            PIC XX.
  3972         16  CL-RESTORED-DT          PIC XX.
  3973         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3974         16  CL-NEXT-RESEND-DT       PIC XX.
  3975         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3976         16  CL-CRITICAL-PERIOD      PIC 99.
  3977*        16  FILLER                  PIC XX.
  3978         16  CL-LAST-MAINT-DT        PIC XX.
  3979         16  CL-LAST-MAINT-USER      PIC X(4).
  3980         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3981         16  CL-LAST-MAINT-TYPE      PIC X.
  3982             88  CLAIM-SET-UP           VALUE ' '.
  3983             88  PAYMENT-MADE           VALUE '1'.
  3984             88  LETTER-SENT            VALUE '2'.
  3985             88  MASTER-WAS-ALTERED     VALUE '3'.
  3986             88  MASTER-WAS-RESTORED    VALUE '4'.
  3987             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3988             88  FILE-CONVERTED         VALUE '6'.
  3989             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3990             88  ERROR-CORRECTION       VALUE 'E'.
  3991         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3992         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3993         16  CL-BENEFICIARY          PIC X(10).
  3994         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3995         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  78
* EL156.cbl
  3996             88  CL-TYPE-DENIAL          VALUE '1'.
  3997             88  CL-TYPE-RESCISSION      VALUE '2'.
  3998             88  CL-TYPE-REFORMATION     VALUE '3'.
  3999             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4000             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4001         16  filler                  pic x(5).
  4002*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4003*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4004*        16  CL-RTW-DT               PIC XX.
  4005
  4006     12  CL-TRAILER-CONTROLS.
  4007         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4008             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4009             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4010             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4011         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4012         16  FILLER                  PIC XX.
  4013         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4014         16  CL-ADDRESS-TRAILER-CNT.
  4015             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4016                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4017             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4018                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4019             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4020                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4021             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4022                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4023             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4024                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4025             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4026                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4027             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4028                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4029
  4030     12  CL-CV-REFERENCE-NO.
  4031         16  CL-CV-REFNO-PRIME       PIC X(18).
  4032         16  CL-CV-REFNO-SFX         PIC XX.
  4033
  4034     12  CL-FILE-LOCATION            PIC X(4).
  4035
  4036     12  CL-PROCESS-ERRORS.
  4037         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4038             88  NO-FATAL-ERRORS        VALUE ZERO.
  4039         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4040             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4041
  4042     12  CL-PRODUCT-CD               PIC X.
  4043
  4044     12  CL-CURRENT-KEY-DATA.
  4045         16  CL-CURRENT-CARRIER      PIC X.
  4046         16  CL-CURRENT-GROUPING     PIC X(6).
  4047         16  CL-CURRENT-STATE        PIC XX.
  4048         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4049
  4050     12  CL-ASSOCIATES               PIC X.
  4051         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4052         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4053         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  79
* EL156.cbl
  4054         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4055
  4056     12  CL-ACTIVITY-CODE            PIC 99.
  4057     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4058     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4059
  4060     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4061     12  CL-LAG-REPORT-CODE          PIC 9.
  4062     12  CL-LOAN-TYPE                PIC XX.
  4063     12  CL-LEGAL-STATE              PIC XX.
  4064
  4065     12  CL-YESNOSW                  PIC X.
  4066     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4067         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4068         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4069         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4070     12  cl-insured-type             pic x.
  4071         88  cl-claim-on-primary         value 'P'.
  4072         88  cl-claim-on-co-borrower     value 'C'.
  4073     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  80
* EL156.cbl
  4075*    COPY ELCCNTL.
  4076******************************************************************
  4077*                                                                *
  4078*                                                                *
  4079*                            ELCCNTL.                            *
  4080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4081*                            VMOD=2.059                          *
  4082*                                                                *
  4083*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4084*                                                                *
  4085*   FILE TYPE = VSAM,KSDS                                        *
  4086*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4087*                                                                *
  4088*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4089*       ALTERNATE INDEX = NONE                                   *
  4090*                                                                *
  4091*   LOG = YES                                                    *
  4092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4093******************************************************************
  4094*                   C H A N G E   L O G
  4095*
  4096* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4097*-----------------------------------------------------------------
  4098*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4099* EFFECTIVE    NUMBER
  4100*-----------------------------------------------------------------
  4101* 082503                   PEMA  ADD BENEFIT GROUP
  4102* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4103* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4104* 092705    2005050300006  PEMA  ADD SPP LEASES
  4105* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4106* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4107* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4108* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4109* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4110* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4111* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4112* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4113* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4114* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4115******************************************************************
  4116*
  4117 01  CONTROL-FILE.
  4118     12  CF-RECORD-ID                       PIC XX.
  4119         88  VALID-CF-ID                        VALUE 'CF'.
  4120
  4121     12  CF-CONTROL-PRIMARY.
  4122         16  CF-COMPANY-ID                  PIC XXX.
  4123         16  CF-RECORD-TYPE                 PIC X.
  4124             88  CF-COMPANY-MASTER              VALUE '1'.
  4125             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4126             88  CF-STATE-MASTER                VALUE '3'.
  4127             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4128             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4129             88  CF-CARRIER-MASTER              VALUE '6'.
  4130             88  CF-MORTALITY-MASTER            VALUE '7'.
  4131             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4132             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  81
* EL156.cbl
  4133             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4134             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4135             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4136             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4137             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4138             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4139             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4140             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4141             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4142         16  CF-ACCESS-CD-GENL              PIC X(4).
  4143         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4144             20  CF-PROCESSOR               PIC X(4).
  4145         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4146             20  CF-STATE-CODE              PIC XX.
  4147             20  FILLER                     PIC XX.
  4148         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4149             20  FILLER                     PIC XX.
  4150             20  CF-HI-BEN-IN-REC           PIC XX.
  4151         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4152             20  FILLER                     PIC XXX.
  4153             20  CF-CARRIER-CNTL            PIC X.
  4154         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4155             20  FILLER                     PIC XX.
  4156             20  CF-HI-TYPE-IN-REC          PIC 99.
  4157         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4158             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4159                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4160             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4161             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4162         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4163             20  FILLER                     PIC X.
  4164             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4165         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4166             20  FILLER                     PIC XX.
  4167             20  CF-MORTGAGE-PLAN           PIC XX.
  4168         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4169
  4170     12  CF-LAST-MAINT-DT                   PIC XX.
  4171     12  CF-LAST-MAINT-BY                   PIC X(4).
  4172     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4173
  4174     12  CF-RECORD-BODY                     PIC X(728).
  4175
  4176
  4177****************************************************************
  4178*             COMPANY MASTER RECORD                            *
  4179****************************************************************
  4180
  4181     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4182         16  CF-COMPANY-ADDRESS.
  4183             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4184             20  CF-CL-IN-CARE-OF           PIC X(30).
  4185             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4186             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4187             20  CF-CL-CITY-STATE           PIC X(30).
  4188             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4189             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4190         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  82
* EL156.cbl
  4191         16  CF-COMPANY-PASSWORD            PIC X(8).
  4192         16  CF-SECURITY-OPTION             PIC X.
  4193             88  ALL-SECURITY                   VALUE '1'.
  4194             88  COMPANY-VERIFY                 VALUE '2'.
  4195             88  PROCESSOR-VERIFY               VALUE '3'.
  4196             88  NO-SECURITY                    VALUE '4'.
  4197             88  ALL-BUT-TERM                   VALUE '5'.
  4198         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4199             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4200         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4201             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4202         16  CF-INFORCE-LOCATION            PIC X.
  4203             88  CERTS-ARE-ONLINE               VALUE '1'.
  4204             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4205             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4206         16  CF-LOWER-CASE-LETTERS          PIC X.
  4207         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4208             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4209             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4210             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4211             88  CF-ACCNT-CNTL                  VALUE '3'.
  4212             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4213
  4214         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4215         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4216
  4217         16  CF-LGX-CREDIT-USER             PIC X.
  4218             88  CO-IS-NOT-USER                 VALUE 'N'.
  4219             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4220
  4221         16 CF-CREDIT-CALC-CODES.
  4222             20  CF-CR-REM-TERM-CALC PIC X.
  4223               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4224               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4225               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4226               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4227               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4228               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4229               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4230             20  CF-CR-R78-METHOD           PIC X.
  4231               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4232               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4233
  4234         16  CF-CLAIM-CONTROL-COUNTS.
  4235             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4236                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4237
  4238             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4239                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4240
  4241             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4242                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4243
  4244             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4245                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4246
  4247         16  CF-CURRENT-MONTH-END           PIC XX.
  4248
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  83
* EL156.cbl
  4249         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4250             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4251             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4252             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4253             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4254                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4255                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4256             20  CF-CO-PREM-REJECT-SW       PIC X.
  4257                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4258                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4259             20  CF-CO-REF-REJECT-SW        PIC X.
  4260                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4261                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4262
  4263         16  CF-CO-REPORTING-DT             PIC XX.
  4264         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4265         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4266           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4267           88  CF-CO-MONTH-END                  VALUE '1'.
  4268
  4269         16  CF-LGX-CLAIM-USER              PIC X.
  4270             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4271             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4272
  4273         16  CF-CREDIT-EDIT-CONTROLS.
  4274             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4275             20  CF-MIN-AGE                 PIC 99.
  4276             20  CF-DEFAULT-AGE             PIC 99.
  4277             20  CF-MIN-TERM                PIC S999      COMP-3.
  4278             20  CF-MAX-TERM                PIC S999      COMP-3.
  4279             20  CF-DEFAULT-SEX             PIC X.
  4280             20  CF-JOINT-AGE-INPUT         PIC X.
  4281                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4282             20  CF-BIRTH-DATE-INPUT        PIC X.
  4283                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4284             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4285                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4286                 88  CF-ZERO-CARRIER            VALUE '1'.
  4287                 88  CF-ZERO-GROUPING           VALUE '2'.
  4288                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4289             20  CF-EDIT-SW                 PIC X.
  4290                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4291             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4292             20  CF-CR-PR-METHOD            PIC X.
  4293               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4294               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4295             20  FILLER                     PIC X.
  4296
  4297         16  CF-CREDIT-MISC-CONTROLS.
  4298             20  CF-REIN-TABLE-SW           PIC X.
  4299                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4300             20  CF-COMP-TABLE-SW           PIC X.
  4301                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4302             20  CF-EXPERIENCE-RETENTION-AGE
  4303                                            PIC S9        COMP-3.
  4304             20  CF-CONVERSION-DT           PIC XX.
  4305             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4306             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  84
* EL156.cbl
  4307                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4308                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4309
  4310             20  CF-CR-CHECK-NO-CONTROL.
  4311                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4312                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4313                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4314                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4315                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4316                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4317
  4318                 24  CF-CR-CHECK-COUNT       REDEFINES
  4319                     CF-CR-CHECK-COUNTER      PIC X(4).
  4320
  4321                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4322                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4323
  4324                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4325                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4326                 24  CF-MAIL-PROCESSING       PIC X.
  4327                     88  MAIL-PROCESSING          VALUE 'Y'.
  4328
  4329         16  CF-MISC-SYSTEM-CONTROL.
  4330             20  CF-SYSTEM-C                 PIC X.
  4331                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4332             20  CF-SYSTEM-D                 PIC X.
  4333                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4334             20  CF-SOC-SEC-NO-SW            PIC X.
  4335                 88  SOC-SEC-NO-USED             VALUE '1'.
  4336             20  CF-MEMBER-NO-SW             PIC X.
  4337                 88  MEMBER-NO-USED              VALUE '1'.
  4338             20  CF-TAX-ID-NUMBER            PIC X(11).
  4339             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4340             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4341                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4342                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4343                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4344                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4345             20  CF-SYSTEM-E                 PIC X.
  4346                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4347
  4348         16  CF-LGX-LIFE-USER               PIC X.
  4349             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4350             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4351
  4352         16  CF-CR-MONTH-END-DT             PIC XX.
  4353
  4354         16  CF-FILE-MAINT-DATES.
  4355             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4356                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4357             20  CF-LAST-BATCH       REDEFINES
  4358                 CF-LAST-BATCH-NO               PIC X(4).
  4359             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4360             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4361             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4362             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4363             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4364             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  85
* EL156.cbl
  4365             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4366             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4367             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4368             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4369
  4370         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4371         16  FILLER                         PIC X.
  4372
  4373         16  CF-ALT-MORT-CODE               PIC X(4).
  4374         16  CF-MEMBER-CAPTION              PIC X(10).
  4375
  4376         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4377             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4378             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4379             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4380             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4381             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4382
  4383         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4384
  4385         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4386         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4387         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4388         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4389
  4390         16  CF-AH-OVERRIDE-L1              PIC X.
  4391         16  CF-AH-OVERRIDE-L2              PIC XX.
  4392         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4393         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4394
  4395         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4396         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4397
  4398         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4399         16  CF-AR-LAST-EL860-DT            PIC XX.
  4400         16  CF-MP-MONTH-END-DT             PIC XX.
  4401
  4402         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4403         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4404             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4405
  4406         16  CF-AR-MONTH-END-DT             PIC XX.
  4407
  4408         16  CF-CRDTCRD-USER                PIC X.
  4409             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4410             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4411
  4412         16  CF-CC-MONTH-END-DT             PIC XX.
  4413
  4414         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4415
  4416         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4417             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4418             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4419             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4420         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4421         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4422         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  86
* EL156.cbl
  4423         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4424             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4425             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4426         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4427         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4428         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4429             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4430         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4431
  4432         16  CF-CL-ZIP-CODE.
  4433             20  CF-CL-ZIP-PRIME.
  4434                 24  CF-CL-ZIP-1ST          PIC X.
  4435                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4436                 24  FILLER                 PIC X(4).
  4437             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4438         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4439             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4440             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4441             20  FILLER                     PIC XXX.
  4442
  4443         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4444         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4445         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4446         16  CF-CO-OPTION-START-DATE        PIC XX.
  4447         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4448           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4449                                                      '3' '4'.
  4450           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4451           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4452           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4453           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4454           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4455           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4456
  4457         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4458
  4459         16  CF-PAYMENT-APPROVAL-LEVELS.
  4460             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4461             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4462             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4463             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4464             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4465             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4466
  4467         16  CF-END-USER-REPORTING-USER     PIC X.
  4468             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4469             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4470
  4471         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4472             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4473             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4474
  4475         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4476
  4477         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4478         16  FILLER                         PIC X.
  4479
  4480         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  87
* EL156.cbl
  4481             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4482             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4483             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4484
  4485         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4486
  4487         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4488             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4489             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4490
  4491         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4492             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4493             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4494
  4495         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4496
  4497         16  CF-CO-ACH-ID-CODE              PIC  X.
  4498             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4499             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4500             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4501         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4502         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4503         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4504         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4505         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4506         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4507         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4508         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4509         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4510                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4511         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4512                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4513
  4514         16  CF-CO-OVER-SHORT.
  4515             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4516             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4517
  4518*         16  FILLER                         PIC X(102).
  4519         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4520             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4521             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4522
  4523         16  CF-AH-APPROVAL-DAYS.
  4524             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4525             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4526             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4527             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4528
  4529         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4530
  4531         16  CF-APPROV-LEV-5.
  4532             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4533             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4534             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4535
  4536         16  FILLER                         PIC X(68).
  4537****************************************************************
  4538*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  88
* EL156.cbl
  4539****************************************************************
  4540
  4541     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4542         16  CF-PROCESSOR-NAME              PIC X(30).
  4543         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4544         16  CF-PROCESSOR-TITLE             PIC X(26).
  4545         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4546                 88  MESSAGE-YES                VALUE 'Y'.
  4547                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4548
  4549*****************************************************
  4550****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4551****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4552****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4553****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4554*****************************************************
  4555
  4556         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4557             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4558             20  CF-APPLICATION-FORCE       PIC X.
  4559             20  CF-INDIVIDUAL-APP.
  4560                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4561                     28  CF-BROWSE-APP      PIC X.
  4562                     28  CF-UPDATE-APP      PIC X.
  4563
  4564         16  CF-CURRENT-TERM-ON             PIC X(4).
  4565         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4566             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4567             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4568             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4569             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4570             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4571             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4572             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4573         16  CF-PROCESSOR-CARRIER           PIC X.
  4574             88  NO-CARRIER-SECURITY            VALUE ' '.
  4575         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4576             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4577         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4578             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4579         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4580             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4581
  4582         16  CF-PROC-SYS-ACCESS-SW.
  4583             20  CF-PROC-CREDIT-CLAIMS-SW.
  4584                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4585                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4586                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4587                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4588             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4589                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4590                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4591             20  CF-PROC-LIFE-GNRLDGR-SW.
  4592                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4593                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4594                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4595                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4596             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  89
* EL156.cbl
  4597                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4598                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4599         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4600             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4601             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4602         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4603
  4604         16  CF-APPROVAL-LEVEL                  PIC X.
  4605             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4606             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4607             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4608             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4609             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4610
  4611         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4612
  4613         16  CF-LANGUAGE-TYPE                   PIC X.
  4614             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4615             88  CF-LANG-IS-FR                      VALUE 'F'.
  4616
  4617         16  CF-CSR-IND                         PIC X.
  4618         16  FILLER                             PIC X(239).
  4619
  4620****************************************************************
  4621*             PROCESSOR/REMINDERS RECORD                       *
  4622****************************************************************
  4623
  4624     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4625         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4626             20  CF-START-REMIND-DT         PIC XX.
  4627             20  CF-END-REMIND-DT           PIC XX.
  4628             20  CF-REMINDER-TEXT           PIC X(50).
  4629         16  FILLER                         PIC X(296).
  4630
  4631
  4632****************************************************************
  4633*             STATE MASTER RECORD                              *
  4634****************************************************************
  4635
  4636     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4637         16  CF-STATE-ABBREVIATION          PIC XX.
  4638         16  CF-STATE-NAME                  PIC X(25).
  4639         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4640         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4641             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4642             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4643             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4644             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4645                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4646                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4647             20  CF-ST-PREM-REJECT-SW       PIC X.
  4648                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4649                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4650             20  CF-ST-REF-REJECT-SW        PIC X.
  4651                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4652                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4653         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4654         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  90
* EL156.cbl
  4655         16  CF-ST-REFUND-RULES.
  4656             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4657             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4658             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4659         16  CF-ST-FST-PMT-EXTENSION.
  4660             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4661             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4662                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4663                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4664                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4665                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4666         16  CF-ST-STATE-CALL.
  4667             20  CF-ST-CALL-UNEARNED        PIC X.
  4668             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4669             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4670         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4671             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4672             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4673         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4674         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4675         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4676         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4677         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4678         16  FILLER                         PIC X.
  4679         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4680             20  CF-ST-BENEFIT-CD           PIC XX.
  4681             20  CF-ST-BENEFIT-KIND         PIC X.
  4682                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4683                 88  CF-ST-AH-KIND              VALUE 'A'.
  4684             20  CF-ST-REM-TERM-CALC        PIC X.
  4685                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4686                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4687                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4688                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4689                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4690                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4691                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4692                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4693
  4694             20  CF-ST-REFUND-CALC          PIC X.
  4695                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4696                 88  ST-REFD-BY-R78             VALUE '1'.
  4697                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4698                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4699                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4700                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4701                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4702                 88  ST-REFD-UTAH               VALUE '7'.
  4703                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4704                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4705                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4706
  4707             20  CF-ST-EARNING-CALC         PIC X.
  4708                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4709                 88  ST-EARN-BY-R78             VALUE '1'.
  4710                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4711                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4712                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  91
* EL156.cbl
  4713                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4714                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4715                 88  ST-EARN-MEAN               VALUE '8'.
  4716                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4717
  4718             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4719                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4720                 88  ST-OVRD-BY-R78             VALUE '1'.
  4721                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4722                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4723                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4724                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4725                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4726                 88  ST-OVRD-MEAN               VALUE '8'.
  4727                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4728             20  FILLER                     PIC X.
  4729
  4730         16  CF-ST-COMMISSION-CAPS.
  4731             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4732             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4733             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4734             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4735         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4736                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4737
  4738         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4739
  4740         16  CF-ST-STATUTORY-INTEREST.
  4741             20  CF-ST-STAT-DATE-FROM       PIC X.
  4742                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4743                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4744             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4745             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4746             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4747             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4748             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4749
  4750         16  CF-ST-OVER-SHORT.
  4751             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4752             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4753
  4754         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4755
  4756         16  CF-ST-RT-CALC                  PIC X.
  4757
  4758         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4759         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4760         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4761         16  CF-ST-RF-LR-CALC               PIC X.
  4762         16  CF-ST-RF-LL-CALC               PIC X.
  4763         16  CF-ST-RF-LN-CALC               PIC X.
  4764         16  CF-ST-RF-AH-CALC               PIC X.
  4765         16  CF-ST-RF-CP-CALC               PIC X.
  4766*        16  FILLER                         PIC X(206).
  4767*CIDMOD         16  FILLER                         PIC X(192).
  4768         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4769             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4770         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  92
* EL156.cbl
  4771         16  CF-ST-VFY-2ND-BENE             PIC X.
  4772         16  CF-ST-CAUSAL-STATE             PIC X.
  4773         16  FILLER                         PIC X(185).
  4774
  4775****************************************************************
  4776*             BENEFIT MASTER RECORD                            *
  4777****************************************************************
  4778
  4779     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4780         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4781             20  CF-BENEFIT-CODE            PIC XX.
  4782             20  CF-BENEFIT-NUMERIC  REDEFINES
  4783                 CF-BENEFIT-CODE            PIC XX.
  4784             20  CF-BENEFIT-ALPHA           PIC XXX.
  4785             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4786             20  CF-BENEFIT-COMMENT         PIC X(10).
  4787
  4788             20  CF-LF-COVERAGE-TYPE        PIC X.
  4789                 88  CF-REDUCING                VALUE 'R'.
  4790                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4791
  4792             20  CF-SPECIAL-CALC-CD         PIC X.
  4793                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4794                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4795                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4796                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4797                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4798                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4799                 88  CF-FARM-PLAN               VALUE 'F'.
  4800                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4801                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4802                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4803                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4804                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4805                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4806                 88  CF-PRUDENTIAL              VALUE 'P'.
  4807                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4808                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4809                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4810                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4811                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4812                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4813
  4814             20  CF-JOINT-INDICATOR         PIC X.
  4815                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4816
  4817*            20  FILLER                     PIC X(12).
  4818             20  cf-maximum-benefits        pic s999 comp-3.
  4819             20  FILLER                     PIC X(09).
  4820             20  CF-BENEFIT-CATEGORY        PIC X.
  4821             20  CF-LOAN-TYPE               PIC X(8).
  4822
  4823             20  CF-CO-REM-TERM-CALC        PIC X.
  4824                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4825                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4826                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4827                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4828                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  93
* EL156.cbl
  4829
  4830             20  CF-CO-EARNINGS-CALC        PIC X.
  4831                 88  CO-EARN-BY-R78             VALUE '1'.
  4832                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4833                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4834                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4835                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4836                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4837                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4838                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4839
  4840             20  CF-CO-REFUND-CALC          PIC X.
  4841                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4842                 88  CO-REFD-BY-R78             VALUE '1'.
  4843                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4844                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4845                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4846                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4847                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4848                 88  CO-REFD-MEAN               VALUE '8'.
  4849                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4850                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4851                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4852
  4853             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4854                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4855                 88  CO-OVRD-BY-R78             VALUE '1'.
  4856                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4857                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4858                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4859                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4860                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4861                 88  CO-OVRD-MEAN               VALUE '8'.
  4862                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4863
  4864             20  CF-CO-BEN-I-G-CD           PIC X.
  4865                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4866                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4867                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4868
  4869         16  FILLER                         PIC X(304).
  4870
  4871
  4872****************************************************************
  4873*             CARRIER MASTER RECORD                            *
  4874****************************************************************
  4875
  4876     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4877         16  CF-ADDRESS-DATA.
  4878             20  CF-MAIL-TO-NAME            PIC X(30).
  4879             20  CF-IN-CARE-OF              PIC X(30).
  4880             20  CF-ADDRESS-LINE-1          PIC X(30).
  4881             20  CF-ADDRESS-LINE-2          PIC X(30).
  4882             20  CF-CITY-STATE              PIC X(30).
  4883             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4884             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4885
  4886         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  94
* EL156.cbl
  4887             20  CF-CLAIM-NO-METHOD         PIC X.
  4888                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4889                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4890                 88  CLAIM-NO-SEQ               VALUE '3'.
  4891                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4892             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4893                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4894                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4895                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4896
  4897         16  CF-CHECK-NO-CONTROL.
  4898             20  CF-CHECK-NO-METHOD         PIC X.
  4899                 88  CHECK-NO-MANUAL            VALUE '1'.
  4900                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4901                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4902                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4903             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4904                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4905
  4906         16  CF-DOMICILE-STATE              PIC XX.
  4907
  4908         16  CF-EXPENSE-CONTROLS.
  4909             20  CF-EXPENSE-METHOD          PIC X.
  4910                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4911                 88  DOLLARS-PER-PMT            VALUE '2'.
  4912                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4913                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4914             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4915             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4916
  4917         16  CF-CORRESPONDENCE-CONTROL.
  4918             20  CF-LETTER-RESEND-OPT       PIC X.
  4919                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4920                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4921             20  FILLER                     PIC X(4).
  4922
  4923         16  CF-RESERVE-CONTROLS.
  4924             20  CF-MANUAL-SW               PIC X.
  4925                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4926             20  CF-FUTURE-SW               PIC X.
  4927                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4928             20  CF-PTC-SW                  PIC X.
  4929                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4930             20  CF-IBNR-SW                 PIC X.
  4931                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4932             20  CF-PTC-LF-SW               PIC X.
  4933                 88  CF-LF-PTC-USED             VALUE '1'.
  4934             20  CF-CDT-ACCESS-METHOD       PIC X.
  4935                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4936                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4937                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4938             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4939
  4940         16  CF-CLAIM-CALC-METHOD           PIC X.
  4941             88  360-PLUS-MONTHS                VALUE '1'.
  4942             88  365-PLUS-MONTHS                VALUE '2'.
  4943             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4944             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  95
* EL156.cbl
  4945             88  365-DAILY                      VALUE '5'.
  4946
  4947         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4948         16  FILLER                         PIC X(11).
  4949
  4950         16  CF-LIMIT-AMOUNTS.
  4951             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4952             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4953             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4954             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4955             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4956             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4957             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4958             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4959             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4960             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4961
  4962         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4963         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4964         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4965
  4966         16  CF-ZIP-CODE.
  4967             20  CF-ZIP-PRIME.
  4968                 24  CF-ZIP-1ST             PIC X.
  4969                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4970                 24  FILLER                 PIC X(4).
  4971             20  CF-ZIP-PLUS4               PIC X(4).
  4972         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4973             20  CF-CAN-POSTAL-1            PIC XXX.
  4974             20  CF-CAN-POSTAL-2            PIC XXX.
  4975             20  FILLER                     PIC XXX.
  4976
  4977         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4978         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4979         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4980
  4981         16  CF-RATING-SWITCH               PIC X.
  4982             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4983             88  CF-NO-RATING                   VALUE 'N'.
  4984
  4985         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4986
  4987         16  CF-CARRIER-OVER-SHORT.
  4988             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4989             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4990
  4991         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4992         16  CF-SECPAY-SWITCH               PIC X.
  4993             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4994             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4995         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4996         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4997         16  FILLER                         PIC X(444).
  4998*        16  FILLER                         PIC X(452).
  4999
  5000
  5001****************************************************************
  5002*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  96
* EL156.cbl
  5003****************************************************************
  5004
  5005     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5006         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5007                                INDEXED BY CF-MORT-NDX.
  5008             20  CF-MORT-TABLE              PIC X(5).
  5009             20  CF-MORT-TABLE-TYPE         PIC X.
  5010                 88  CF-MORT-JOINT              VALUE 'J'.
  5011                 88  CF-MORT-SINGLE             VALUE 'S'.
  5012                 88  CF-MORT-COMBINED           VALUE 'C'.
  5013                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5014                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5015             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5016             20  CF-MORT-AGE-METHOD         PIC XX.
  5017                 88  CF-AGE-LAST                VALUE 'AL'.
  5018                 88  CF-AGE-NEAR                VALUE 'AN'.
  5019             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5020             20  CF-MORT-ADJUSTMENT-DIRECTION
  5021                                            PIC X.
  5022                 88  CF-MINUS                   VALUE '-'.
  5023                 88  CF-PLUS                    VALUE '+'.
  5024             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5025             20  CF-MORT-JOINT-CODE         PIC X.
  5026                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5027             20  CF-MORT-PC-Q               PIC X.
  5028                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5029             20  CF-MORT-TABLE-CODE         PIC X(4).
  5030             20  CF-MORT-COMMENTS           PIC X(15).
  5031             20  FILLER                     PIC X(14).
  5032
  5033         16  FILLER                         PIC X(251).
  5034
  5035
  5036****************************************************************
  5037*             BUSSINESS TYPE MASTER RECORD                     *
  5038****************************************************************
  5039
  5040     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5041* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5042* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5043* AND RECORD 05 IS TYPES 81-99
  5044         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5045             20  CF-BUSINESS-TITLE          PIC  X(19).
  5046             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5047                                            PIC S9V9(4) COMP-3.
  5048             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5049             20  FILLER                     PIC  X.
  5050         16  FILLER                         PIC  X(248).
  5051
  5052
  5053****************************************************************
  5054*             TERMINAL MASTER RECORD                           *
  5055****************************************************************
  5056
  5057     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5058
  5059         16  CF-COMPANY-TERMINALS.
  5060             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  97
* EL156.cbl
  5061                                  PIC X(4).
  5062         16  FILLER               PIC X(248).
  5063
  5064
  5065****************************************************************
  5066*             LIFE EDIT MASTER RECORD                          *
  5067****************************************************************
  5068
  5069     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5070         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5071             20  CF-LIFE-CODE-IN            PIC XX.
  5072             20  CF-LIFE-CODE-OUT           PIC XX.
  5073         16  FILLER                         PIC X(248).
  5074
  5075
  5076****************************************************************
  5077*             AH EDIT MASTER RECORD                            *
  5078****************************************************************
  5079
  5080     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5081         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5082             20  CF-AH-CODE-IN              PIC XXX.
  5083             20  CF-AH-CODE-OUT             PIC XX.
  5084         16  FILLER                         PIC X(248).
  5085
  5086
  5087****************************************************************
  5088*             CREDIBILITY TABLES                               *
  5089****************************************************************
  5090
  5091     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5092         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5093                             INDEXED BY CF-CRDB-NDX.
  5094             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5095             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5096             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5097         16  FILLER                         PIC  X(332).
  5098
  5099
  5100****************************************************************
  5101*             REPORT CUSTOMIZATION RECORD                      *
  5102****************************************************************
  5103
  5104     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5105         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5106             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5107             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5108             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5109**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5110****       A T-TRANSFER.                                   ****
  5111             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5112
  5113         16  FILLER                         PIC XX.
  5114
  5115         16  CF-CARRIER-CNTL-OPT.
  5116             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5117                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5118                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  98
* EL156.cbl
  5119             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5120                                            PIC X.
  5121         16  CF-GROUP-CNTL-OPT.
  5122             20  CF-GROUP-OPT-SEQ           PIC 9.
  5123                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5124                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5125             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5126                                            PIC X(6).
  5127         16  CF-STATE-CNTL-OPT.
  5128             20  CF-STATE-OPT-SEQ           PIC 9.
  5129                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5130                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5131             20  CF-STATE-SELECT OCCURS 3 TIMES
  5132                                            PIC XX.
  5133         16  CF-ACCOUNT-CNTL-OPT.
  5134             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5135                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5136                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5137             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5138                                            PIC X(10).
  5139         16  CF-BUS-TYP-CNTL-OPT.
  5140             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5141                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5142                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5143             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5144                                            PIC XX.
  5145         16  CF-LF-TYP-CNTL-OPT.
  5146             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5147                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5148                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5149             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5150                                            PIC XX.
  5151         16  CF-AH-TYP-CNTL-OPT.
  5152             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5153                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5154                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5155             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5156                                            PIC XX.
  5157         16  CF-REPTCD1-CNTL-OPT.
  5158             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5159                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5160                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5161             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5162                                            PIC X(10).
  5163         16  CF-REPTCD2-CNTL-OPT.
  5164             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5165                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5166                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5167             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5168                                            PIC X(10).
  5169         16  CF-USER1-CNTL-OPT.
  5170             20  CF-USER1-OPT-SEQ           PIC 9.
  5171                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5172                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5173             20  CF-USER1-SELECT OCCURS 3 TIMES
  5174                                            PIC X(10).
  5175         16  CF-USER2-CNTL-OPT.
  5176             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  99
* EL156.cbl
  5177                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5178                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5179             20  CF-USER2-SELECT OCCURS 3 TIMES
  5180                                            PIC X(10).
  5181         16  CF-USER3-CNTL-OPT.
  5182             20  CF-USER3-OPT-SEQ           PIC 9.
  5183                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5184                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5185             20  CF-USER3-SELECT OCCURS 3 TIMES
  5186                                            PIC X(10).
  5187         16  CF-USER4-CNTL-OPT.
  5188             20  CF-USER4-OPT-SEQ           PIC 9.
  5189                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5190                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5191             20  CF-USER4-SELECT OCCURS 3 TIMES
  5192                                            PIC X(10).
  5193         16  CF-USER5-CNTL-OPT.
  5194             20  CF-USER5-OPT-SEQ           PIC 9.
  5195                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5196                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5197             20  CF-USER5-SELECT OCCURS 3 TIMES
  5198                                            PIC X(10).
  5199         16  CF-REINS-CNTL-OPT.
  5200             20  CF-REINS-OPT-SEQ           PIC 9.
  5201                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5202                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5203             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5204                 24  CF-REINS-PRIME         PIC XXX.
  5205                 24  CF-REINS-SUB           PIC XXX.
  5206
  5207         16  CF-AGENT-CNTL-OPT.
  5208             20  CF-AGENT-OPT-SEQ           PIC 9.
  5209                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5210                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5211             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5212                                            PIC X(10).
  5213
  5214         16  FILLER                         PIC X(43).
  5215
  5216         16  CF-LOSS-RATIO-SELECT.
  5217             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5218             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5219         16  CF-ENTRY-DATE-SELECT.
  5220             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5221             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5222         16  CF-EFFECTIVE-DATE-SELECT.
  5223             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5224             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5225
  5226         16  CF-EXCEPTION-LIST-IND          PIC X.
  5227             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5228
  5229         16  FILLER                         PIC X(318).
  5230
  5231****************************************************************
  5232*                  EXCEPTION REPORTING RECORD                  *
  5233****************************************************************
  5234
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 100
* EL156.cbl
  5235     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5236         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5237             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5238
  5239         16  CF-COMBINED-LIFE-AH-OPT.
  5240             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5241             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5242             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5243             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5244
  5245         16  CF-LIFE-OPT.
  5246             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5247             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5248             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5249             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5250             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5251             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5252             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5253             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5254             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5255             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5256
  5257         16  CF-AH-OPT.
  5258             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5259             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5260             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5261             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5262             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5263             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5264             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5265             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5266             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5267             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5268
  5269         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5270             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5271             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5272             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5273
  5274         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5275
  5276         16  FILLER                         PIC X(673).
  5277
  5278
  5279****************************************************************
  5280*             MORTGAGE SYSTEM PLAN RECORD                      *
  5281****************************************************************
  5282
  5283     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5284         16  CF-PLAN-TYPE                   PIC X.
  5285             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5286             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5287             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5288         16  CF-PLAN-ABBREV                 PIC XXX.
  5289         16  CF-PLAN-DESCRIPT               PIC X(10).
  5290         16  CF-PLAN-NOTES                  PIC X(20).
  5291         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5292         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 101
* EL156.cbl
  5293             20  CF-PLAN-TERM-DATA.
  5294                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5295                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5296             20  CF-PLAN-AGE-DATA.
  5297                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5298                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5299                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5300             20  CF-PLAN-BENEFIT-DATA.
  5301                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5302                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5303                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5304                                            PIC S9(7)V99  COMP-3.
  5305         16  CF-PLAN-POLICY-FORMS.
  5306             20  CF-POLICY-FORM             PIC X(12).
  5307             20  CF-MASTER-APPLICATION      PIC X(12).
  5308             20  CF-MASTER-POLICY           PIC X(12).
  5309         16  CF-PLAN-RATING.
  5310             20  CF-RATE-CODE               PIC X(5).
  5311             20  CF-SEX-RATING              PIC X.
  5312                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5313                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5314             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5315             20  CF-SUB-STD-TYPE            PIC X.
  5316                 88  CF-PCT-OF-PREM            VALUE '1'.
  5317                 88  CF-PCT-OF-BENE            VALUE '2'.
  5318         16  CF-PLAN-PREM-TOLERANCES.
  5319             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5320             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5321         16  CF-PLAN-PYMT-TOLERANCES.
  5322             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5323             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5324         16  CF-PLAN-MISC-DATA.
  5325             20  FILLER                     PIC X.
  5326             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5327             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5328         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5329         16  CF-PLAN-IND-GRP                PIC X.
  5330             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5331                                                     '1'.
  5332             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5333                                                     '2'.
  5334         16  CF-MIB-SEARCH-SW               PIC X.
  5335             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5336             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5337             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5338             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5339         16  CF-ALPHA-SEARCH-SW             PIC X.
  5340             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5341             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5342             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5343             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5344             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5345             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5346             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5347             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5348             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5349             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5350                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 102
* EL156.cbl
  5351                                                     'X' 'Y' 'Z'.
  5352         16  CF-EFF-DT-RULE-SW              PIC X.
  5353             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5354             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5355             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5356             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5357             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5358         16  FILLER                         PIC X(4).
  5359         16  CF-HEALTH-QUESTIONS            PIC X.
  5360             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5361         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5362         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5363         16  CF-PLAN-SNGL-JNT               PIC X.
  5364             88  CF-COMBINED-PLAN              VALUE 'C'.
  5365             88  CF-JNT-PLAN                   VALUE 'J'.
  5366             88  CF-SNGL-PLAN                  VALUE 'S'.
  5367         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5368         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5369         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5370         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5371         16  CF-RERATE-CNTL                 PIC  X.
  5372             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5373             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5374             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5375             88  CF-AUTO-RECALC                 VALUE '4'.
  5376         16  CF-BENEFIT-TYPE                PIC  X.
  5377             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5378             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5379         16  CF-POLICY-FEE                  PIC S999V99
  5380                                                    COMP-3.
  5381         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5382         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5383         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5384         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5385         16  FILLER                         PIC  X(32).
  5386         16  CF-TERMINATION-FORM            PIC  X(04).
  5387         16  FILLER                         PIC  X(08).
  5388         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5389                                                       COMP-3.
  5390         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5391         16  CF-ISSUE-LETTER                PIC  X(4).
  5392         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5393         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5394             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5395             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5396         16  CF-MP-REFUND-CALC              PIC X.
  5397             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5398             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5399             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5400             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5401             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5402             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5403             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5404             88  CF-MP-REFD-MEAN                VALUE '8'.
  5405         16  CF-ALT-RATE-CODE               PIC  X(5).
  5406
  5407
  5408         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 103
* EL156.cbl
  5409****************************************************************
  5410*             MORTGAGE COMPANY MASTER RECORD                   *
  5411****************************************************************
  5412
  5413     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5414         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5415         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5416             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5417             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5418             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5419             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5420             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5421
  5422         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5423         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5424         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5425         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5426         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5427
  5428         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5429             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5430         16  CF-MP-RECON-USE-IND            PIC X(1).
  5431             88  CF-MP-USE-RECON             VALUE 'Y'.
  5432         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5433             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5434         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5435             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5436             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5437         16  FILLER                         PIC X(1).
  5438         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5439             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5440         16  CF-MORTG-MIB-VERSION           PIC X.
  5441             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5442             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5443             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5444         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5445             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5446                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5447             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5448                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5449             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5450                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5451             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5452                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5453             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5454                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5455             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5456                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5457         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5458         16  FILLER                         PIC X(7).
  5459         16  CF-MORTG-DESTINATION-SYMBOL.
  5460             20  CF-MORTG-MIB-COMM          PIC X(5).
  5461             20  CF-MORTG-MIB-TERM          PIC X(5).
  5462         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5463             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5464         16  FILLER                         PIC X(03).
  5465         16  CF-MP-CHECK-NO-CONTROL.
  5466             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 104
* EL156.cbl
  5467                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5468                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5469                                                ' ' LOW-VALUES.
  5470                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5471                                               VALUE '3'.
  5472         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5473         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5474         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5475             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5476                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5477             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5478                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5479             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5480                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5481             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5482                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5483             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5484                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5485             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5486                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5487         16  CF-MORTG-BILLING-AREA.
  5488             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5489                                            PIC X.
  5490         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5491         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5492         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5493         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5494             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5495             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5496         16  FILLER                         PIC X.
  5497         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5498             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5499             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5500         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5501         16  FILLER                         PIC X(8).
  5502         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5503         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5504         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5505         16  CF-ACH-COMPANY-ID.
  5506             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5507                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5508                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5509                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5510             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5511         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5512             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5513         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5514             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5515             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5516         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5517         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5518         16  FILLER                         PIC X(536).
  5519
  5520****************************************************************
  5521*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5522****************************************************************
  5523
  5524     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 105
* EL156.cbl
  5525         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5526             20  CF-FEMALE-HEIGHT.
  5527                 24  CF-FEMALE-FT           PIC 99.
  5528                 24  CF-FEMALE-IN           PIC 99.
  5529             20  CF-FEMALE-MIN-WT           PIC 999.
  5530             20  CF-FEMALE-MAX-WT           PIC 999.
  5531         16  FILLER                         PIC X(428).
  5532
  5533     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5534         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5535             20  CF-MALE-HEIGHT.
  5536                 24  CF-MALE-FT             PIC 99.
  5537                 24  CF-MALE-IN             PIC 99.
  5538             20  CF-MALE-MIN-WT             PIC 999.
  5539             20  CF-MALE-MAX-WT             PIC 999.
  5540         16  FILLER                         PIC X(428).
  5541******************************************************************
  5542*             AUTOMATIC ACTIVITY RECORD                          *
  5543******************************************************************
  5544     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5545         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5546             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5547             20  CF-SYS-LETTER-ID           PIC X(04).
  5548             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5549             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5550             20  CF-SYS-RESET-SW            PIC X(01).
  5551             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5552             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5553
  5554         16  FILLER                         PIC X(50).
  5555
  5556         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5557             20  CF-USER-ACTIVE-SW          PIC X(01).
  5558             20  CF-USER-LETTER-ID          PIC X(04).
  5559             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5560             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5561             20  CF-USER-RESET-SW           PIC X(01).
  5562             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5563             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5564             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5565
  5566         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 106
* EL156.cbl
  5568*    COPY ELCCERT.
  5569******************************************************************
  5570*                                                                *
  5571*                            ELCCERT.                            *
  5572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5573*                            VMOD=2.013                          *
  5574*                                                                *
  5575*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5576*                                                                *
  5577*   FILE TYPE = VSAM,KSDS                                        *
  5578*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5579*                                                                *
  5580*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5581*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5582*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5583*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5584*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5585*                                                                *
  5586*   LOG = YES                                                    *
  5587*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5588******************************************************************
  5589*                   C H A N G E   L O G
  5590*
  5591* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5592*-----------------------------------------------------------------
  5593*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5594* EFFECTIVE    NUMBER
  5595*-----------------------------------------------------------------
  5596* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5597* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5598* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5599* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5600* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5601* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5602* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5603* 032612  CR2011110200001  PEMA  AHL CHANGES
  5604* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5605******************************************************************
  5606
  5607 01  CERTIFICATE-MASTER.
  5608     12  CM-RECORD-ID                      PIC XX.
  5609         88  VALID-CM-ID                      VALUE 'CM'.
  5610
  5611     12  CM-CONTROL-PRIMARY.
  5612         16  CM-COMPANY-CD                 PIC X.
  5613         16  CM-CARRIER                    PIC X.
  5614         16  CM-GROUPING.
  5615             20  CM-GROUPING-PREFIX        PIC X(3).
  5616             20  CM-GROUPING-PRIME         PIC X(3).
  5617         16  CM-STATE                      PIC XX.
  5618         16  CM-ACCOUNT.
  5619             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5620             20  CM-ACCOUNT-PRIME          PIC X(6).
  5621         16  CM-CERT-EFF-DT                PIC XX.
  5622         16  CM-CERT-NO.
  5623             20  CM-CERT-PRIME             PIC X(10).
  5624             20  CM-CERT-SFX               PIC X.
  5625
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 107
* EL156.cbl
  5626     12  CM-CONTROL-BY-NAME.
  5627         16  CM-COMPANY-CD-A1              PIC X.
  5628         16  CM-INSURED-LAST-NAME          PIC X(15).
  5629         16  CM-INSURED-INITIALS.
  5630             20  CM-INSURED-INITIAL1       PIC X.
  5631             20  CM-INSURED-INITIAL2       PIC X.
  5632
  5633     12  CM-CONTROL-BY-SSN.
  5634         16  CM-COMPANY-CD-A2              PIC X.
  5635         16  CM-SOC-SEC-NO.
  5636             20  CM-SSN-STATE              PIC XX.
  5637             20  CM-SSN-ACCOUNT            PIC X(6).
  5638             20  CM-SSN-LN3.
  5639                 25  CM-INSURED-INITIALS-A2.
  5640                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5641                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5642                 25 CM-PART-LAST-NAME-A2         PIC X.
  5643
  5644     12  CM-CONTROL-BY-CERT-NO.
  5645         16  CM-COMPANY-CD-A4              PIC X.
  5646         16  CM-CERT-NO-A4                 PIC X(11).
  5647
  5648     12  CM-CONTROL-BY-MEMB.
  5649         16  CM-COMPANY-CD-A5              PIC X.
  5650         16  CM-MEMBER-NO.
  5651             20  CM-MEMB-STATE             PIC XX.
  5652             20  CM-MEMB-ACCOUNT           PIC X(6).
  5653             20  CM-MEMB-LN4.
  5654                 25  CM-INSURED-INITIALS-A5.
  5655                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5656                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5657                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5658
  5659     12  CM-INSURED-PROFILE-DATA.
  5660         16  CM-INSURED-FIRST-NAME.
  5661             20  CM-INSURED-1ST-INIT       PIC X.
  5662             20  FILLER                    PIC X(9).
  5663         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5664         16  CM-INSURED-SEX                PIC X.
  5665             88  CM-SEX-MALE                  VALUE 'M'.
  5666             88  CM-SEX-FEMAL                 VALUE 'F'.
  5667         16  CM-INSURED-JOINT-AGE          PIC 99.
  5668         16  CM-JOINT-INSURED-NAME.
  5669             20  CM-JT-LAST-NAME           PIC X(15).
  5670             20  CM-JT-FIRST-NAME.
  5671                 24  CM-JT-1ST-INIT        PIC X.
  5672                 24  FILLER                PIC X(9).
  5673             20  CM-JT-INITIAL             PIC X.
  5674
  5675     12  CM-LIFE-DATA.
  5676         16  CM-LF-BENEFIT-CD              PIC XX.
  5677         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5678         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5679         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5680         16  CM-LF-DEV-CODE                PIC XXX.
  5681         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5682         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5683         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 108
* EL156.cbl
  5684         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5685         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5686         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5687         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5688         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5689         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5690         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5691         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5692         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5693         16  cm-temp-epiq                  pic xx.
  5694             88  EPIQ-CLASS                  value 'EQ'.
  5695*        16  FILLER                        PIC XX.
  5696
  5697     12  CM-AH-DATA.
  5698         16  CM-AH-BENEFIT-CD              PIC XX.
  5699         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5700         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5701         16  CM-AH-DEV-CODE                PIC XXX.
  5702         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5703         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5704         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5705         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5706         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5707         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5708         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5709         16  CM-AH-PAID-THRU-DT            PIC XX.
  5710             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5711         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5712         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5713         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5714         16  FILLER                        PIC X.
  5715
  5716     12  CM-LOAN-INFORMATION.
  5717         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5718         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5719                                           PIC S9(5)V99  COMP-3.
  5720         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5721         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5722         16  CM-PAY-FREQUENCY              PIC S99.
  5723         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5724         16  CM-RATE-CLASS                 PIC XX.
  5725         16  CM-BENEFICIARY                PIC X(25).
  5726         16  CM-POLICY-FORM-NO             PIC X(12).
  5727         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5728         16  CM-LAST-ADD-ON-DT             PIC XX.
  5729         16  CM-DEDUCTIBLE-AMOUNTS.
  5730             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5731             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5732         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5733             20  CM-RESIDENT-STATE         PIC XX.
  5734             20  CM-RATE-CODE              PIC X(4).
  5735             20  FILLER                    PIC XX.
  5736         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5737             20  CM-LOAN-OFFICER           PIC X(5).
  5738             20  FILLER                    PIC XXX.
  5739         16  CM-CSR-CODE                   PIC XXX.
  5740         16  CM-UNDERWRITING-CODE          PIC X.
  5741             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 109
* EL156.cbl
  5742         16  CM-POST-CARD-IND              PIC X.
  5743         16  CM-NH-INTERFACE-SW            PIC X.
  5744         16  CM-PREMIUM-TYPE               PIC X.
  5745             88  CM-SING-PRM                  VALUE '1'.
  5746             88  CM-O-B-COVERAGE              VALUE '2'.
  5747             88  CM-OPEN-END                  VALUE '3'.
  5748         16  CM-IND-GRP-TYPE               PIC X.
  5749             88  CM-INDIVIDUAL                VALUE 'I'.
  5750             88  CM-GROUP                     VALUE 'G'.
  5751         16  CM-SKIP-CODE                  PIC X.
  5752             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5753             88  SKIP-JULY                    VALUE '1'.
  5754             88  SKIP-AUGUST                  VALUE '2'.
  5755             88  SKIP-SEPTEMBER               VALUE '3'.
  5756             88  SKIP-JULY-AUG                VALUE '4'.
  5757             88  SKIP-AUG-SEPT                VALUE '5'.
  5758             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5759             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5760             88  SKIP-JUNE                    VALUE '8'.
  5761             88  SKIP-JUNE-JULY               VALUE '9'.
  5762             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5763             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5764         16  CM-PAYMENT-MODE               PIC X.
  5765             88  PAY-MONTHLY                  VALUE SPACE.
  5766             88  PAY-WEEKLY                   VALUE '1'.
  5767             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5768             88  PAY-BI-WEEKLY                VALUE '3'.
  5769             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5770         16  CM-LOAN-NUMBER                PIC X(8).
  5771         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5772         16  CM-OLD-LOF                    PIC XXX.
  5773*        16  CM-LOAN-OFFICER               PIC XXX.
  5774         16  CM-REIN-TABLE                 PIC XXX.
  5775         16  CM-SPECIAL-REIN-CODE          PIC X.
  5776         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5777         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5778         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5779
  5780     12  CM-STATUS-DATA.
  5781         16  CM-ENTRY-STATUS               PIC X.
  5782         16  CM-ENTRY-DT                   PIC XX.
  5783
  5784         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5785         16  CM-LF-CANCEL-DT               PIC XX.
  5786         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5787
  5788         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5789         16  CM-LF-DEATH-DT                PIC XX.
  5790         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5791
  5792         16  CM-LF-CURRENT-STATUS          PIC X.
  5793             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5794                                                'M' '4' '5' '9'.
  5795             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5796             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5797             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5798             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5799             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 110
* EL156.cbl
  5800             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5801             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5802             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5803             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5804             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5805             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5806             88  CM-LF-DECLINED               VALUE 'D'.
  5807             88  CM-LF-VOIDED                 VALUE 'V'.
  5808
  5809         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5810         16  CM-AH-CANCEL-DT               PIC XX.
  5811         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5812
  5813         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5814         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5815         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5816
  5817         16  CM-AH-CURRENT-STATUS          PIC X.
  5818             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5819                                                'M' '4' '5' '9'.
  5820             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5821             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5822             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5823             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5824             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5825             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5826             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5827             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5828             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5829             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5830             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5831             88  CM-AH-DECLINED               VALUE 'D'.
  5832             88  CM-AH-VOIDED                 VALUE 'V'.
  5833
  5834         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5835             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5836             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5837             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5838         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5839
  5840         16  CM-ENTRY-BATCH                PIC X(6).
  5841         16  CM-LF-EXIT-BATCH              PIC X(6).
  5842         16  CM-AH-EXIT-BATCH              PIC X(6).
  5843         16  CM-LAST-MONTH-END             PIC XX.
  5844
  5845     12  CM-NOTE-SW                        PIC X.
  5846         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5847         88  CERT-NOTES-PRESENT               VALUE '1'.
  5848         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5849         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5850         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5851         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5852         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5853         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5854     12  CM-COMP-EXCP-SW                   PIC X.
  5855         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5856         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5857     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 111
* EL156.cbl
  5858         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5859         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5860
  5861*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5862     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5863     12  FILLER                            PIC X.
  5864
  5865*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5866     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5867     12  FILLER                            PIC X.
  5868*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5869     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5870
  5871     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5872         88  CERT-ADDED-BATCH                 VALUE ' '.
  5873         88  CERT-ADDED-ONLINE                VALUE '1'.
  5874         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5875         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5876         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5877     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5878         88  CERT-AS-LOADED                   VALUE ' '.
  5879         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5880         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5881         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5882         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5883         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5884         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5885         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5886
  5887     12  CM-ACCOUNT-COMM-PCTS.
  5888         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5889         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5890
  5891     12  CM-USER-FIELD                     PIC X.
  5892     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5893     12  CM-CLP-STATE                      PIC XX.
  5894     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5895     12  CM-USER-RESERVED                  PIC XXX.
  5896     12  FILLER REDEFINES CM-USER-RESERVED.
  5897         16  CM-AH-CLASS-CD                PIC XX.
  5898         16  F                             PIC X.
  5899******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 112
* EL156.cbl
  5901*    COPY ELCTRLR.
  5902******************************************************************
  5903*                                                                *
  5904*                            ELCTRLR.                            *
  5905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5906*                            VMOD=2.014                          *
  5907*                                                                *
  5908*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5909*                                                                *
  5910*   FILE TYPE = VSAM,KSDS                                        *
  5911*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5912*                                                                *
  5913*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5914*       ALTERNATE INDEX = NONE                                   *
  5915*                                                                *
  5916*   LOG = YES                                                    *
  5917*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5918******************************************************************
  5919*                   C H A N G E   L O G
  5920*
  5921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5922*-----------------------------------------------------------------
  5923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5924* EFFECTIVE    NUMBER
  5925*-----------------------------------------------------------------
  5926* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5927* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5928* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5929* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5930* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5931* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5932* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5933* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5934* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5935* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5936* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5937* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5938* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5939* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5940* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5941* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5942* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5943* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5944* 040814    2014030500002  AJRA  ADD ICD CODES
  5945* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5946******************************************************************
  5947 01  ACTIVITY-TRAILERS.
  5948     12  AT-RECORD-ID                    PIC XX.
  5949         88  VALID-AT-ID                       VALUE 'AT'.
  5950
  5951     12  AT-CONTROL-PRIMARY.
  5952         16  AT-COMPANY-CD               PIC X.
  5953         16  AT-CARRIER                  PIC X.
  5954         16  AT-CLAIM-NO                 PIC X(7).
  5955         16  AT-CERT-NO.
  5956             20  AT-CERT-PRIME           PIC X(10).
  5957             20  AT-CERT-SFX             PIC X.
  5958         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 113
* EL156.cbl
  5959             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5960             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5961             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5962             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5963             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5964             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5965             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5966             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5967             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5968             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5969             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5970             88  AT-BENEFICIARY-TRL           VALUE +91.
  5971             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5972             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5973             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5974             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5975
  5976     12  AT-TRAILER-TYPE                 PIC X.
  5977         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5978         88  PAYMENT-TR                       VALUE '2'.
  5979         88  AUTO-PAY-TR                      VALUE '3'.
  5980         88  CORRESPONDENCE-TR                VALUE '4'.
  5981         88  ADDRESS-TR                       VALUE '5'.
  5982         88  GENERAL-INFO-TR                  VALUE '6'.
  5983         88  AUTO-PROMPT-TR                   VALUE '7'.
  5984         88  DENIAL-TR                        VALUE '8'.
  5985         88  INCURRED-CHG-TR                  VALUE '9'.
  5986         88  FORM-CONTROL-TR                  VALUE 'A'.
  5987
  5988     12  AT-RECORDED-DT                  PIC XX.
  5989     12  AT-RECORDED-BY                  PIC X(4).
  5990     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5991
  5992     12  AT-TRAILER-BODY                 PIC X(165).
  5993
  5994     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5995         16  AT-RESERVE-CONTROLS.
  5996             20  AT-MANUAL-SW            PIC X.
  5997                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5998             20  AT-FUTURE-SW            PIC X.
  5999                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6000             20  AT-PTC-SW               PIC X.
  6001                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6002             20  AT-IBNR-SW              PIC X.
  6003                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6004             20  AT-PTC-LF-SW            PIC X.
  6005                 88  AT-LF-PTC-USED          VALUE '1'.
  6006             20  AT-CDT-ACCESS-METHOD    PIC X.
  6007                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6008                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6009                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6010             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6011         16  AT-LAST-COMPUTED-DT         PIC XX.
  6012         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6013         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6014         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6015         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6016         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 114
* EL156.cbl
  6017         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6018         16  AT-EXPENSE-CONTROLS.
  6019             20  AT-EXPENSE-METHOD       PIC X.
  6020                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6021                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6022                 88  PERCENT-OF-PMT           VALUE '3'.
  6023                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6024             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6025             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6026         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6027         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6028
  6029         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6030         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6031
  6032*        16  FILLER                      PIC X(53).
  6033         16  FILLER                      PIC X(47).
  6034
  6035         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6036         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6037
  6038         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6039             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6040             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6041*                    C = CLOSED
  6042*                    O = OPEN
  6043             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6044*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6045
  6046     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6047         16  AT-PAYMENT-TYPE             PIC X.
  6048             88  PARTIAL-PAYMENT                VALUE '1'.
  6049             88  FINAL-PAYMENT                  VALUE '2'.
  6050             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6051             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6052             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6053             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6054             88  VOIDED-PAYMENT                 VALUE '9'.
  6055             88  TRANSFER                       VALUE 'T'.
  6056             88  LIFE-INTEREST                  VALUE 'I'.
  6057
  6058         16  AT-CLAIM-TYPE               PIC X.
  6059             88  PAID-FOR-AH                    VALUE 'A'.
  6060             88  PAID-FOR-LIFE                  VALUE 'L'.
  6061             88  PAID-FOR-IUI                   VALUE 'I'.
  6062             88  PAID-FOR-GAP                   VALUE 'G'.
  6063             88  PAID-FOR-FAM                   VALUE 'F'.
  6064         16  AT-CLAIM-PREM-TYPE          PIC X.
  6065             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6066             88  AT-O-B-COVERAGE                VALUE '2'.
  6067             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6068         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6069         16  AT-CHECK-NO                 PIC X(7).
  6070         16  AT-PAID-FROM-DT             PIC XX.
  6071         16  AT-PAID-THRU-DT             PIC XX.
  6072         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6073         16  FILLER                      PIC X.
  6074         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 115
* EL156.cbl
  6075         16  AT-PAYMENT-ORIGIN           PIC X.
  6076             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6077             88  ONLINE-AUTO-PMT                VALUE '2'.
  6078             88  OFFLINE-PMT                    VALUE '3'.
  6079         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6080         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6081         16  AT-VOID-DATA.
  6082             20  AT-VOID-DT              PIC XX.
  6083*00144       20  AT-VOID-REASON          PIC X(30).
  6084             20  AT-VOID-REASON          PIC X(26).
  6085         16  AT-PMT-APPROVED-BY          PIC X(04).
  6086         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6087         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6088         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6089                                         PIC S99V9(5)  COMP-3.
  6090         16  AT-CREDIT-INTERFACE.
  6091             20  AT-PMT-SELECT-DT        PIC XX.
  6092                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6093             20  AT-PMT-ACCEPT-DT        PIC XX.
  6094                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6095             20  AT-VOID-SELECT-DT       PIC XX.
  6096                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6097             20  AT-VOID-ACCEPT-DT       PIC XX.
  6098                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6099
  6100         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6101                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6102                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6103         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6104
  6105         16  AT-FORCE-CONTROL            PIC X.
  6106             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6107         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6108         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6109         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6110         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6111         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6112         16  AT-BENEFIT-TYPE             PIC X.
  6113
  6114         16  AT-EXPENSE-TYPE             PIC X.
  6115         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6116
  6117         16  AT-PAYEE-TYPE-CD.
  6118             20  AT-PAYEE-TYPE           PIC X.
  6119                 88  INSURED-PAID           VALUE 'I'.
  6120                 88  BENEFICIARY-PAID       VALUE 'B'.
  6121                 88  ACCOUNT-PAID           VALUE 'A'.
  6122                 88  OTHER-1-PAID           VALUE 'O'.
  6123                 88  OTHER-2-PAID           VALUE 'Q'.
  6124                 88  DOCTOR-PAID            VALUE 'P'.
  6125                 88  EMPLOYER-PAID          VALUE 'E'.
  6126             20  AT-PAYEE-SEQ            PIC X.
  6127
  6128         16  AT-CASH-PAYMENT             PIC X.
  6129         16  AT-GROUPED-PAYMENT          PIC X.
  6130         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6131         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6132         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 116
* EL156.cbl
  6133         16  AT-VOID-TYPE                PIC X.
  6134             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6135             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6136         16  AT-AIG-UNEMP-IND            PIC X.
  6137             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6138         16  AT-ASSOCIATES               PIC X.
  6139             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6140             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6141
  6142         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6143         16  AT-CV-PMT-CODE              PIC X.
  6144             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6145             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6146             88  FULL-ADD-PAYMENT           VALUE '3'.
  6147             88  HALF-ADD-PAYMENT           VALUE '4'.
  6148             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6149             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6150             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6151             88  ADDL-PAYMENT               VALUE '8'.
  6152
  6153         16  AT-EOB-CODE1                PIC XXX.
  6154         16  AT-EOB-CODE2                PIC XXX.
  6155         16  AT-EOB-CODE3                PIC XXX.
  6156         16  FILLER REDEFINES AT-EOB-CODE3.
  6157             20  AT-PRINT-CLM-FORM       PIC X.
  6158             20  AT-PRINT-SURVEY         PIC X.
  6159             20  AT-SPECIAL-RELEASE      PIC X.
  6160         16  AT-EOB-CODE4                PIC XXX.
  6161         16  FILLER REDEFINES AT-EOB-CODE4.
  6162             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6163             20  FILLER                  PIC X.
  6164         16  AT-EOB-CODE5                PIC XXX.
  6165         16  FILLER REDEFINES AT-EOB-CODE5.
  6166             20  AT-PMT-PROOF-DT         PIC XX.
  6167             20  FILLER                  PIC X.
  6168
  6169         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6170             88  AT-PRINT-EOB            VALUE 'Y'.
  6171
  6172         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6173         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6174
  6175     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6176         16  AT-SCHEDULE-START-DT        PIC XX.
  6177         16  AT-SCHEDULE-END-DT          PIC XX.
  6178         16  AT-TERMINATED-DT            PIC XX.
  6179         16  AT-LAST-PMT-TYPE            PIC X.
  6180             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6181             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6182         16  AT-FIRST-PMT-DATA.
  6183             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6184             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6185             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6186         16  AT-REGULAR-PMT-DATA.
  6187             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6188             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6189             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6190         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 117
* EL156.cbl
  6191             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6192                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6193                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6194                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6195                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6196                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6197             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6198         16  AT-AUTO-PAY-DAY             PIC 99.
  6199         16  AT-AUTO-CASH                PIC X.
  6200             88  AT-CASH                      VALUE 'Y'.
  6201             88  AT-NON-CASH                  VALUE 'N'.
  6202*        16  FILLER                      PIC X(129).
  6203         16  AT-AUTO-END-LETTER          PIC X(4).
  6204         16  FILLER                      PIC X(125).
  6205
  6206         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6207         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6208
  6209     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6210         16  AT-LETTER-SENT-DT           PIC XX.
  6211         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6212         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6213         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6214         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6215         16  AT-LETTER-ORIGIN            PIC X.
  6216             88  ONLINE-CREATION              VALUE '1' '3'.
  6217             88  OFFLINE-CREATION             VALUE '2' '4'.
  6218             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6219             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6220         16  AT-STD-LETTER-FORM          PIC X(4).
  6221         16  AT-REASON-TEXT              PIC X(70).
  6222         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6223         16  AT-ADDRESEE-TYPE            PIC X.
  6224              88  INSURED-ADDRESEE            VALUE 'I'.
  6225              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6226              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6227              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6228              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6229              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6230              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6231         16  AT-ADDRESSEE-NAME           PIC X(30).
  6232         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6233         16  AT-RESEND-PRINT-DATE        PIC XX.
  6234         16  AT-CORR-SOL-UNSOL           PIC X.
  6235         16  AT-LETTER-PURGED-DT         PIC XX.
  6236*
  6237*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6238*
  6239         16  AT-CSO-REDEFINITION.
  6240             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6241             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6242             20  AT-LETTER-TO-BENE       PIC X(1).
  6243             20  AT-STOP-LETTER-DT       PIC X(2).
  6244             20  FILLER                  PIC X(19).
  6245*             20  FILLER                  PIC X(27).
  6246             20  AT-CSO-LETTER-STATUS    PIC X.
  6247                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6248                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 118
* EL156.cbl
  6249                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6250             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6251             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6252*
  6253*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6254*
  6255*        16  FILLER                      PIC X(26).
  6256*
  6257*        16  AT-DMD-BSR-CODE             PIC X.
  6258*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6259*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6260*
  6261*        16  AT-DMD-LETTER-STATUS        PIC X.
  6262*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6263*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6264*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6265*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6266*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6267
  6268         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6269         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6270
  6271     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6272         16  AT-ADDRESS-TYPE             PIC X.
  6273             88  INSURED-ADDRESS               VALUE 'I'.
  6274             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6275             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6276             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6277             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6278             88  OTHER-ADDRESS-1               VALUE 'O'.
  6279             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6280         16  AT-MAIL-TO-NAME             PIC X(30).
  6281         16  AT-ADDRESS-LINE-1           PIC X(30).
  6282         16  AT-ADDRESS-LINE-2           PIC X(30).
  6283         16  AT-CITY-STATE.
  6284             20  AT-CITY                 PIC X(28).
  6285             20  AT-STATE                PIC XX.
  6286         16  AT-ZIP.
  6287             20  AT-ZIP-CODE.
  6288                 24  AT-ZIP-1ST          PIC X.
  6289                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6290                 24  FILLER              PIC X(4).
  6291             20  AT-ZIP-PLUS4            PIC X(4).
  6292         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6293             20  AT-CAN-POSTAL-1         PIC XXX.
  6294             20  AT-CAN-POSTAL-2         PIC XXX.
  6295             20  FILLER                  PIC XXX.
  6296         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6297*         16  FILLER                      PIC X(23).
  6298         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6299         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6300         16  FILLER                      PIC X(13).
  6301         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6302         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6303
  6304     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6305         16  AT-INFO-LINE-1              PIC X(60).
  6306         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 119
* EL156.cbl
  6307             20  AT-NOTE-ERROR-NO OCCURS 15
  6308                                         PIC X(4).
  6309         16  AT-INFO-LINE-2              PIC X(60).
  6310         16  FILLER REDEFINES AT-INFO-LINE-2.
  6311             20  AT-ICD-CODE-1           PIC X(8).
  6312             20  AT-ICD-CODE-2           PIC X(8).
  6313             20  FILLER                  PIC X(44).
  6314         16  AT-INFO-TRAILER-TYPE        PIC X.
  6315             88  AT-ERRORS-NOTE          VALUE 'E'.
  6316             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6317             88  AT-CALL-NOTE            VALUE 'C'.
  6318             88  AT-MAINT-NOTE           VALUE 'M'.
  6319             88  AT-CERT-CHANGE          VALUE 'X'.
  6320             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6321             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6322             88  AT-CERT-CANCELLED       VALUE 'T'.
  6323         16  AT-CALL-TYPE                PIC X.
  6324             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6325             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6326         16  AT-NOTE-CONTINUATION        PIC X.
  6327             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6328         16  AT-EOB-CODES-EXIST          PIC X.
  6329             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6330         16  FILLER                      PIC X(35).
  6331         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6332         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6333
  6334     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6335         16  AT-PROMPT-LINE-1            PIC X(60).
  6336         16  AT-PROMPT-LINE-2            PIC X(60).
  6337         16  AT-PROMPT-START-DT          PIC XX.
  6338         16  AT-PROMPT-END-DT            PIC XX.
  6339         16  FILLER                      PIC X(35).
  6340         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6341         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6342
  6343     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6344         16  AT-DENIAL-INFO-1            PIC X(60).
  6345         16  AT-DENIAL-INFO-2            PIC X(60).
  6346         16  AT-DENIAL-DT                PIC XX.
  6347         16  AT-RETRACTION-DT            PIC XX.
  6348         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6349*         16  FILLER                      PIC X(31).
  6350         16  AT-DENIAL-PROOF-DT          PIC XX.
  6351         16  FILLER                      PIC X(29).
  6352         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6353         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6354
  6355     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6356         16  AT-OLD-INCURRED-DT          PIC XX.
  6357         16  AT-OLD-REPORTED-DT          PIC XX.
  6358         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6359         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6360         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6361         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6362         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6363         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6364         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 120
* EL156.cbl
  6365         16  AT-OLD-DIAG-CODE            PIC X(6).
  6366         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6367         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6368         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6369         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6370         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6371         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6372         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6373         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6374         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6375         16  FILLER                      PIC X(9).
  6376         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6377
  6378     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6379         16  AT-FORM-SEND-ON-DT          PIC XX.
  6380         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6381         16  AT-FORM-RE-SEND-DT          PIC XX.
  6382         16  AT-FORM-ANSWERED-DT         PIC XX.
  6383         16  AT-FORM-PRINTED-DT          PIC XX.
  6384         16  AT-FORM-REPRINT-DT          PIC XX.
  6385         16  AT-FORM-TYPE                PIC X.
  6386             88  INITIAL-FORM                  VALUE '1'.
  6387             88  PROGRESS-FORM                 VALUE '2'.
  6388         16  AT-INSTRUCT-LN-1            PIC X(28).
  6389         16  AT-INSTRUCT-LN-2            PIC X(28).
  6390         16  AT-INSTRUCT-LN-3            PIC X(28).
  6391         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6392         16  AT-FORM-ADDRESS             PIC X.
  6393             88  FORM-TO-INSURED              VALUE 'I'.
  6394             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6395             88  FORM-TO-OTHER-1              VALUE 'O'.
  6396             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6397         16  AT-RELATED-1.
  6398             20 AT-REL-CARR-1            PIC X.
  6399             20 AT-REL-CLAIM-1           PIC X(7).
  6400             20 AT-REL-CERT-1            PIC X(11).
  6401         16  AT-RELATED-2.
  6402             20 AT-REL-CARR-2            PIC X.
  6403             20 AT-REL-CLAIM-2           PIC X(7).
  6404             20 AT-REL-CERT-2            PIC X(11).
  6405         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6406         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6407         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6408         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6409         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6410         16  AT-STOP-FORM-DT             PIC X(2).
  6411
  6412         16  FILLER                      PIC X(09).
  6413         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6414         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6415******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 121
* EL156.cbl
  6417*    COPY ELCACTQ.
  6418******************************************************************
  6419*                                                                *
  6420*                            ELCACTQ.                            *
  6421*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6422*                            VMOD=2.004                          *
  6423*                                                                *
  6424*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6425*                                                                *
  6426*   FILE TYPE = VSAM,KSDS                                        *
  6427*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6428*                                                                *
  6429*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6430*       ALTERNATE INDEX = NONE                                   *
  6431*                                                                *
  6432*   LOG = YES                                                    *
  6433*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6434*                                                                *
  6435*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6436******************************************************************
  6437
  6438 01  ACTIVITY-QUE.
  6439     12  AQ-RECORD-ID                PIC XX.
  6440         88  VALID-AQ-ID                VALUE 'AQ'.
  6441
  6442     12  AQ-CONTROL-PRIMARY.
  6443         16  AQ-COMPANY-CD           PIC X.
  6444         16  AQ-CARRIER              PIC X.
  6445         16  AQ-CLAIM-NO             PIC X(7).
  6446         16  AQ-CERT-NO.
  6447             20  AQ-CERT-PRIME       PIC X(10).
  6448             20  AQ-CERT-SFX         PIC X.
  6449
  6450     12  AQ-PENDING-ACTIVITY-FLAGS.
  6451         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6452         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6453             88  PENDING-PAYMENTS       VALUE '1'.
  6454         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6455             88  PENDING-FULL-PRINT     VALUE '1'.
  6456             88  PENDING-PART-PRINT     VALUE '2'.
  6457         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6458             88  PENDING-LETTERS        VALUE '1'.
  6459         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6460             88  PENDING-RESTORE        VALUE 'C'.
  6461             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6462
  6463     12  FILLER                      PIC X(20).
  6464
  6465     12  AQ-RESEND-DATE              PIC XX.
  6466     12  AQ-FOLLOWUP-DATE            PIC XX.
  6467     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6468     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6469     12  AQ-AUTO-LETTER              PIC X(4).
  6470     12  FILLER                      PIC XX.
  6471     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6472*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 122
* EL156.cbl
  6474*    COPY ERCACCT.
  6475******************************************************************
  6476*                                                                *
  6477*                                                                *
  6478*                            ERCACCT                             *
  6479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6480*                            VMOD=2.031                          *
  6481*                                                                *
  6482*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6483*                                                                *
  6484*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6485*   VSAM ACCOUNT MASTER FILES.                                   *
  6486*                                                                *
  6487*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6488*                                                                *
  6489*   FILE TYPE = VSAM,KSDS                                        *
  6490*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6491*                                                                *
  6492*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6493*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6494*                                                                *
  6495*   LOG = NO                                                     *
  6496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6497*                                                                *
  6498*                                                                *
  6499******************************************************************
  6500*                   C H A N G E   L O G
  6501*
  6502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6503*-----------------------------------------------------------------
  6504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6505* EFFECTIVE    NUMBER
  6506*-----------------------------------------------------------------
  6507* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6508* 092705    2005050300006  PEMA  ADD SPP LEASES
  6509* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6510* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6511* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6512* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6513* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6514******************************************************************
  6515
  6516 01  ACCOUNT-MASTER.
  6517     12  AM-RECORD-ID                      PIC XX.
  6518         88  VALID-AM-ID                      VALUE 'AM'.
  6519
  6520     12  AM-CONTROL-PRIMARY.
  6521         16  AM-COMPANY-CD                 PIC X.
  6522         16  AM-MSTR-CNTRL.
  6523             20  AM-CONTROL-A.
  6524                 24  AM-CARRIER            PIC X.
  6525                 24  AM-GROUPING.
  6526                     28 AM-GROUPING-PREFIX PIC XXX.
  6527                     28 AM-GROUPING-PRIME  PIC XXX.
  6528                 24  AM-STATE              PIC XX.
  6529                 24  AM-ACCOUNT.
  6530                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6531                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 123
* EL156.cbl
  6532             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6533                                           PIC X(19).
  6534             20  AM-CNTRL-B.
  6535                 24  AM-EXPIRATION-DT      PIC XX.
  6536                 24  FILLER                PIC X(4).
  6537             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6538                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6539
  6540     12  AM-CONTROL-BY-VAR-GRP.
  6541         16  AM-COMPANY-CD-A1              PIC X.
  6542         16  AM-VG-CARRIER                 PIC X.
  6543         16  AM-VG-GROUPING                PIC X(6).
  6544         16  AM-VG-STATE                   PIC XX.
  6545         16  AM-VG-ACCOUNT                 PIC X(10).
  6546         16  AM-VG-DATE.
  6547             20  AM-VG-EXPIRATION-DT       PIC XX.
  6548             20  FILLER                    PIC X(4).
  6549         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6550                                           PIC 9(11)      COMP-3.
  6551     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6552         16  FILLER                        PIC X(10).
  6553         16  AM-VG-KEY3.
  6554             20  AM-VG3-ACCOUNT            PIC X(10).
  6555             20  AM-VG3-EXP-DT             PIC XX.
  6556         16  FILLER                        PIC X(4).
  6557     12  AM-MAINT-INFORMATION.
  6558         16  AM-LAST-MAINT-DT              PIC XX.
  6559         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6560         16  AM-LAST-MAINT-USER            PIC X(4).
  6561         16  FILLER                        PIC XX.
  6562
  6563     12  AM-EFFECTIVE-DT                   PIC XX.
  6564     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6565
  6566     12  AM-PREV-DATES  COMP-3.
  6567         16  AM-PREV-EXP-DT                PIC 9(11).
  6568         16  AM-PREV-EFF-DT                PIC 9(11).
  6569
  6570     12  AM-REPORT-CODE-1                  PIC X(10).
  6571     12  AM-REPORT-CODE-2                  PIC X(10).
  6572
  6573     12  AM-CITY-CODE                      PIC X(4).
  6574     12  AM-COUNTY-PARISH                  PIC X(6).
  6575
  6576     12  AM-NAME                           PIC X(30).
  6577     12  AM-PERSON                         PIC X(30).
  6578     12  AM-ADDRS                          PIC X(30).
  6579     12  AM-CITY.
  6580         16  AM-ADDR-CITY                  PIC X(28).
  6581         16  AM-ADDR-STATE                 PIC XX.
  6582     12  AM-ZIP.
  6583         16  AM-ZIP-PRIME.
  6584             20  AM-ZIP-PRI-1ST            PIC X.
  6585                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6586             20  FILLER                    PIC X(4).
  6587         16  AM-ZIP-PLUS4                  PIC X(4).
  6588     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6589         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 124
* EL156.cbl
  6590         16  AM-CAN-POSTAL-2               PIC XXX.
  6591         16  FILLER                        PIC XXX.
  6592     12  AM-TEL-NO.
  6593         16  AM-AREA-CODE                  PIC 999.
  6594         16  AM-TEL-PRE                    PIC 999.
  6595         16  AM-TEL-NBR                    PIC 9(4).
  6596     12  AM-TEL-LOC                        PIC X.
  6597         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6598         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6599
  6600     12  AM-COMM-STRUCTURE.
  6601         16  AM-DEFN-1.
  6602             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6603                 24  AM-AGT.
  6604                     28  AM-AGT-PREFIX     PIC X(4).
  6605                     28  AM-AGT-PRIME      PIC X(6).
  6606                 24  AM-COM-TYP            PIC X.
  6607                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6608                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6609                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6610                 24  AM-RECALC-LV-INDIC    PIC X.
  6611                 24  AM-RETRO-LV-INDIC     PIC X.
  6612                 24  AM-GL-CODES           PIC X.
  6613                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6614                 24  FILLER                PIC X(01).
  6615         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6616             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6617                 24  FILLER                PIC X(11).
  6618                 24  AM-L-COMA             PIC XXX.
  6619                 24  AM-J-COMA             PIC XXX.
  6620                 24  AM-A-COMA             PIC XXX.
  6621                 24  FILLER                PIC X(6).
  6622
  6623     12  AM-COMM-CHANGE-STATUS             PIC X.
  6624         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6625
  6626     12  AM-CSR-CODE                       PIC X(4).
  6627
  6628     12  AM-BILLING-STATUS                 PIC X.
  6629         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6630         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6631     12  AM-AUTO-REFUND-SW                 PIC X.
  6632         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6633         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6634     12  AM-GPCD                           PIC 99.
  6635     12  AM-IG                             PIC X.
  6636         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6637         88  AM-HAS-GROUP                     VALUE '2'.
  6638     12  AM-STATUS                         PIC X.
  6639         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6640         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6641         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6642         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6643         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6644         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6645     12  AM-REMIT-TO                       PIC 99.
  6646     12  AM-ID-NO                          PIC X(11).
  6647
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 125
* EL156.cbl
  6648     12  AM-CAL-TABLE                      PIC XX.
  6649     12  AM-LF-DEVIATION                   PIC XXX.
  6650     12  AM-AH-DEVIATION                   PIC XXX.
  6651     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6652     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6653     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6654     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6655     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6656     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6657
  6658     12  AM-USER-FIELDS.
  6659         16  AM-FLD-1                      PIC XX.
  6660         16  AM-FLD-2                      PIC XX.
  6661         16  AM-FLD-3                      PIC XX.
  6662         16  AM-FLD-4                      PIC XX.
  6663         16  AM-FLD-5                      PIC XX.
  6664
  6665     12  AM-1ST-PROD-DATE.
  6666         16  AM-1ST-PROD-YR                PIC XX.
  6667         16  AM-1ST-PROD-MO                PIC XX.
  6668         16  AM-1ST-PROD-DA                PIC XX.
  6669     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6670     12  AM-CERTS-PURGED-DATE.
  6671         16  AM-PUR-YR                     PIC XX.
  6672         16  AM-PUR-MO                     PIC XX.
  6673         16  AM-PUR-DA                     PIC XX.
  6674     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6675     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6676     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6677     12  AM-INACTIVE-DATE.
  6678         16  AM-INA-MO                     PIC 99.
  6679         16  AM-INA-DA                     PIC 99.
  6680         16  AM-INA-YR                     PIC 99.
  6681     12  AM-AR-HI-CERT-DATE                PIC XX.
  6682
  6683     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6684     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6685
  6686     12  AM-OB-PAYMENT-MODE                PIC X.
  6687         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6688         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6689         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6690         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6691
  6692     12  AM-AH-ONLY-INDICATOR              PIC X.
  6693         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6694         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6695
  6696     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6697
  6698     12  AM-OVER-SHORT.
  6699         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6700         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6701
  6702     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6703     12  AM-DCC-CLP-STATE                  PIC XX.
  6704
  6705     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 126
* EL156.cbl
  6706     12  AM-RECALC-REIN                    PIC X.
  6707
  6708     12  AM-REI-TABLE                      PIC XXX.
  6709     12  AM-REI-ET-LF                      PIC X.
  6710     12  AM-REI-ET-AH                      PIC X.
  6711     12  AM-REI-PE-LF                      PIC X.
  6712     12  AM-REI-PE-AH                      PIC X.
  6713     12  AM-REI-PRT-ST                     PIC X.
  6714     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6717     12  AM-REI-GROUP-A                    PIC X(6).
  6718     12  AM-REI-MORT                       PIC X(4).
  6719     12  AM-REI-PRT-OW                     PIC X.
  6720     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6721     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6722     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6723     12  AM-REI-GROUP-B                    PIC X(6).
  6724
  6725     12  AM-TRUST-TYPE                     PIC X(2).
  6726
  6727     12  AM-EMPLOYER-STMT-USED             PIC X.
  6728     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6729
  6730     12  AM-STD-AH-TYPE                    PIC XX.
  6731     12  AM-EARN-METHODS.
  6732         16  AM-EARN-METHOD-R              PIC X.
  6733             88 AM-REF-RL-R78                 VALUE 'R'.
  6734             88 AM-REF-RL-PR                  VALUE 'P'.
  6735             88 AM-REF-RL-MEAN                VALUE 'M'.
  6736             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6737         16  AM-EARN-METHOD-L              PIC X.
  6738             88 AM-REF-LL-R78                 VALUE 'R'.
  6739             88 AM-REF-LL-PR                  VALUE 'P'.
  6740             88 AM-REF-LL-MEAN                VALUE 'M'.
  6741             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6742         16  AM-EARN-METHOD-A              PIC X.
  6743             88 AM-REF-AH-R78                 VALUE 'R'.
  6744             88 AM-REF-AH-PR                  VALUE 'P'.
  6745             88 AM-REF-AH-MEAN                VALUE 'M'.
  6746             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6747             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6748             88 AM-REF-AH-NET                 VALUE 'N'.
  6749
  6750     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6751     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6752     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6753
  6754     12  AM-RET-Y-N                        PIC X.
  6755     12  AM-RET-P-E                        PIC X.
  6756     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6757     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6758     12  AM-RET-GRP                        PIC X(6).
  6759     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6760         16  AM-POOL-PRIME                 PIC XXX.
  6761         16  AM-POOL-SUB                   PIC XXX.
  6762     12  AM-RETRO-EARNINGS.
  6763         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 127
* EL156.cbl
  6764         16  AM-RET-EARN-L                 PIC X.
  6765         16  AM-RET-EARN-A                 PIC X.
  6766     12  AM-RET-ST-TAX-USE                 PIC X.
  6767         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6768         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6769     12  AM-RETRO-BEG-EARNINGS.
  6770         16  AM-RET-BEG-EARN-R             PIC X.
  6771         16  AM-RET-BEG-EARN-L             PIC X.
  6772         16  AM-RET-BEG-EARN-A             PIC X.
  6773     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6774     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6775
  6776     12  AM-USER-SELECT-OPTIONS.
  6777         16  AM-USER-SELECT-1              PIC X(10).
  6778         16  AM-USER-SELECT-2              PIC X(10).
  6779         16  AM-USER-SELECT-3              PIC X(10).
  6780         16  AM-USER-SELECT-4              PIC X(10).
  6781         16  AM-USER-SELECT-5              PIC X(10).
  6782
  6783     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6784
  6785     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6786
  6787     12  AM-RPT045A-SWITCH                 PIC X.
  6788         88  RPT045A-OFF                   VALUE 'N'.
  6789
  6790     12  AM-INSURANCE-LIMITS.
  6791         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6792         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6793
  6794     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6795         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6796
  6797     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6798         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6799         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6800
  6801     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6802
  6803     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6804     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6805     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6806     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6807     12  AM-DCC-UEF-STATE                  PIC XX.
  6808     12  FILLER                            PIC XXX.
  6809     12  AM-REPORT-CODE-3                  PIC X(10).
  6810*    12  FILLER                            PIC X(22).
  6811
  6812     12  AM-RESERVE-DATE.
  6813         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6814         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6815         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6816
  6817     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6818     12  AM-NOTIFICATION-TYPES.
  6819         16  AM-NOTIF-OF-LETTERS           PIC X.
  6820         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6821         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 128
* EL156.cbl
  6822         16  AM-NOTIF-OF-STATUS            PIC X.
  6823
  6824     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6825         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6826         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6827         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6828         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6829
  6830     12  AM-BENEFIT-CONTROLS.
  6831         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6832             20  AM-BENEFIT-CODE           PIC XX.
  6833             20  AM-BENEFIT-TYPE           PIC X.
  6834             20  AM-BENEFIT-REVISION       PIC XXX.
  6835             20  AM-BENEFIT-REM-TERM       PIC X.
  6836             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6837             20  FILLER                    PIC XX.
  6838         16  FILLER                        PIC X(80).
  6839
  6840     12  AM-TRANSFER-DATA.
  6841         16  AM-TRANSFERRED-FROM.
  6842             20  AM-TRNFROM-CARRIER        PIC X.
  6843             20  AM-TRNFROM-GROUPING.
  6844                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6845                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6846             20  AM-TRNFROM-STATE          PIC XX.
  6847             20  AM-TRNFROM-ACCOUNT.
  6848                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6849                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6850             20  AM-TRNFROM-DTE            PIC XX.
  6851         16  AM-TRANSFERRED-TO.
  6852             20  AM-TRNTO-CARRIER          PIC X.
  6853             20  AM-TRNTO-GROUPING.
  6854                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6855                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6856             20  AM-TRNTO-STATE            PIC XX.
  6857             20  AM-TRNTO-ACCOUNT.
  6858                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6859                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6860             20  AM-TRNTO-DTE              PIC XX.
  6861         16  FILLER                        PIC X(10).
  6862
  6863     12  AM-SAVED-REMIT-TO                 PIC 99.
  6864
  6865     12  AM-COMM-STRUCTURE-SAVED.
  6866         16  AM-DEFN-1-SAVED.
  6867             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6868                 24  AM-AGT-SV             PIC X(10).
  6869                 24  AM-COM-TYP-SV         PIC X.
  6870                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6871                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6872                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6873                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6874                 24  FILLER                PIC X.
  6875                 24  AM-GL-CODES-SV        PIC X.
  6876                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6877                 24  FILLER                PIC X.
  6878         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6879             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 129
* EL156.cbl
  6880                 24  FILLER                PIC X(11).
  6881                 24  AM-L-COMA-SV          PIC XXX.
  6882                 24  AM-J-COMA-SV          PIC XXX.
  6883                 24  AM-A-COMA-SV          PIC XXX.
  6884                 24  FILLER                PIC X(6).
  6885
  6886     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6887         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6888            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6889            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6890            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6891
  6892     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6893     12  FILLER                            PIC X(120).
  6894
  6895     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6896         16  AM-CONTROL-NAME               PIC X(30).
  6897         16  AM-EXECUTIVE-ONE.
  6898             20  AM-EXEC1-NAME             PIC X(15).
  6899             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6900                                                          COMP-3.
  6901             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6902                                                          COMP-3.
  6903         16  AM-EXECUTIVE-TWO.
  6904             20  AM-EXEC2-NAME             PIC X(15).
  6905             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6906                                                          COMP-3.
  6907             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6908                                                          COMP-3.
  6909
  6910     12  AM-RETRO-ADDITIONAL-DATA.
  6911         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6912         16  AM-RETRO-PREM-P-E             PIC X.
  6913         16  AM-RETRO-CLMS-P-I             PIC X.
  6914         16  AM-RETRO-RET-BRACKET-LF.
  6915             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6916                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6917                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6918             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6919                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6920                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6921             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6922                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6923                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6924         16  AM-RETRO-RET-BRACKET-AH.
  6925             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6926                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6927                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6928                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6929             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6930                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6931                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6932             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6933                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6934                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6935
  6936     12  AM-COMMENTS.
  6937         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 130
* EL156.cbl
  6938
  6939     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6940         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6941         16  AM-FLI-BILLING-CODE           PIC X.
  6942         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6943         16  AM-FLI-UNITED-IDENT           PIC X.
  6944         16  AM-FLI-INTEREST-LOST-DATA.
  6945             20  AM-FLI-BANK-NO            PIC X(5).
  6946             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6947             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6948             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6949         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6950             20  AM-FLI-AGT                PIC X(9).
  6951             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6952             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6953         16  FILLER                        PIC X(102).
  6954
  6955     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6956         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6957             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6958             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6959             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6960             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6961             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6962         16  FILLER                          PIC X(10).
  6963******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 131
* EL156.cbl
  6965*    COPY ELCCHKQ.
  6966******************************************************************
  6967*                                                                *
  6968*                                                                *
  6969*                            ELCCHKQ.                            *
  6970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6971*                            VMOD=2.007                          *
  6972*                                                                *
  6973*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6974*                                                                *
  6975*   FILE TYPE = VSAM,KSDS                                        *
  6976*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6977*                                                                *
  6978*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6979*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6980*                                                                *
  6981*   LOG = YES                                                    *
  6982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6983******************************************************************
  6984 01  CHECK-QUE.
  6985     12  CQ-RECORD-ID                PIC XX.
  6986         88  VALID-CQ-ID         VALUE 'CQ'.
  6987
  6988     12  CQ-CONTROL-PRIMARY.
  6989         16  CQ-COMPANY-CD           PIC X.
  6990         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6991         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6992
  6993     12  CQ-CONTROL-BY-PAYEE.
  6994         16  CQ-CONTROL-BY-NUMBER.
  6995             20  CQ-COMPANY-CD-A1     PIC X.
  6996             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6997         16  CQ-PAYEE-CARRIER        PIC X.
  6998         16  CQ-PAYEE-GROUPING       PIC X(6).
  6999         16  CQ-PAYEE-STATE          PIC XX.
  7000         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7001         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7002
  7003     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7004         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7005         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7006         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7007         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7008         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7009         16  FILLER                  PIC X(3).
  7010
  7011     12  CQ-ENTRY-TYPE               PIC X.
  7012             88  CHECK-ON-QUE           VALUE 'Q'.
  7013             88  ALIGNMENT-CHECK        VALUE 'A'.
  7014             88  SPOILED-CHECK          VALUE 'S'.
  7015             88  PAYMENT-ABORTED        VALUE 'X'.
  7016
  7017     12  CQ-CLAIM-MAST-CNTL.
  7018         16  CQ-CARRIER              PIC X.
  7019         16  CQ-CLAIM-NO             PIC X(7).
  7020         16  CQ-CERT-NO.
  7021             20  CQ-CERT-PRIME       PIC X(10).
  7022             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 132
* EL156.cbl
  7023         16  CQ-CLAIM-TYPE           PIC X.
  7024             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7025             88  CQ-AH-CLAIM            VALUE 'A'.
  7026         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7027             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7028             88  CQ-O-B-COVERAGE        VALUE '2'.
  7029             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7030
  7031     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7032     12  CQ-CHECK-NUMBER             PIC X(7).
  7033     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7034     12  CQ-PAYMENT-TYPE             PIC X.
  7035             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7036             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7037             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7038             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7039             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7040             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7041             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7042             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7043     12  CQ-VOID-INDICATOR           PIC X.
  7044             88  CHECK-IS-STOPPED          VALUE 'S'.
  7045             88  CHECK-IS-VOID             VALUE 'V'.
  7046     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7047     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7048     12  CQ-CHECK-BY-USER            PIC X(4).
  7049     12  CQ-PRE-NUMBERING-SW         PIC X.
  7050       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7051       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7052
  7053     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7054     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7055     12  CQ-LEDGER-FLAG              PIC X(01).
  7056     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7057     12  CQ-LAST-UPDATED-DT          PIC XX.
  7058     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7059     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7060
  7061     12  FILLER                      PIC X(04).
  7062
  7063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 133
* EL156.cbl
  7065*    COPY ELCBENE.
  7066******************************************************************
  7067*                                                                *
  7068*                            ELCBENE.                            *
  7069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7070*                            VMOD=2.006                          *
  7071*                                                                *
  7072*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7073*                                                                *
  7074*   FILE TYPE = VSAM,KSDS                                        *
  7075*   RECORD SIZE = 500   RECFORM = FIX                            *
  7076*                                                                *
  7077*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7078*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7079*                                                                *
  7080*   LOG = YES                                                    *
  7081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7082*                                                                *
  7083*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7084******************************************************************
  7085
  7086 01  BENEFICIARY-MASTER.
  7087     12  BE-RECORD-ID                PIC XX.
  7088         88  VALID-BE-ID                VALUE 'BE'.
  7089
  7090     12  BE-CONTROL-PRIMARY.
  7091         16  BE-COMPANY-CD           PIC X.
  7092         16  BE-RECORD-TYPE          PIC X.
  7093             88  BENEFICIARY-RECORD  VALUE 'B'.
  7094             88  ADJUSTOR-RECORD     VALUE 'A'.
  7095         16  BE-BENEFICIARY          PIC X(10).
  7096     12  BE-CONTROL-BY-NAME.
  7097         16  BE-COMPANY-CD-A1        PIC X.
  7098         16  BE-RECORD-TYPE-A1       PIC X.
  7099         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7100         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7101
  7102     12  BE-LAST-MAINT-DT            PIC XX.
  7103     12  BE-LAST-MAINT-BY            PIC X(4).
  7104     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7105
  7106     12  BE-ADDRESS-DATA.
  7107         16  BE-MAIL-TO-NAME         PIC X(30).
  7108         16  BE-ADDRESS-LINE-1       PIC X(30).
  7109         16  BE-ADDRESS-LINE-2       PIC X(30).
  7110         16  BE-ADDRESS-LINE-3       PIC X(30).
  7111         16  BE-CITY-STATE.
  7112             20  BE-CITY             PIC X(28).
  7113             20  BE-STATE            PIC XX.
  7114         16  BE-ZIP-CODE.
  7115             20  BE-ZIP-PRIME.
  7116                 24  BE-ZIP-1ST      PIC X.
  7117                     88  BE-CANADIAN-POST-CODE
  7118                                         VALUE 'A' THRU 'Z'.
  7119                 24  FILLER          PIC X(4).
  7120             20  BE-ZIP-PLUS4        PIC X(4).
  7121         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7122             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 134
* EL156.cbl
  7123             20  BE-CAN-POSTAL-2     PIC XXX.
  7124             20  FILLER              PIC XXX.
  7125         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7126         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7127
  7128******************************************************************
  7129*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7130*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7131******************************************************************
  7132     12  BE-CARRIER                  PIC X.
  7133
  7134     12  BE-ADDRESS-DATA2.
  7135         16  BE-MAIL-TO-NAME2        PIC X(30).
  7136         16  BE-ADDRESS-LINE-12      PIC X(30).
  7137         16  BE-ADDRESS-LINE-22      PIC X(30).
  7138         16  BE-ADDRESS-LINE-32      PIC X(30).
  7139         16  BE-CITY-STATE2.
  7140             20  BE-CITY2            PIC X(28).
  7141             20  BE-STATE2           PIC XX.
  7142         16  BE-ZIP-CODE2.
  7143             20  BE-ZIP-PRIME2.
  7144                 24  BE-ZIP-1ST2     PIC X.
  7145                     88  BE-CANADIAN-POST-CODE2
  7146                                         VALUE 'A' THRU 'Z'.
  7147                 24  FILLER          PIC X(4).
  7148             20  BE-ZIP-PLUS42       PIC X(4).
  7149         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7150             20  BE-CAN-POSTAL-12    PIC XXX.
  7151             20  BE-CAN-POSTAL-22    PIC XXX.
  7152             20  FILLER              PIC XXX.
  7153         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7154         16  BE-BILLING-STMT-DATA.
  7155             20  BE-BSR              PIC X.
  7156                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7157                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7158             20  BE-BSR-FROM         PIC X(30).
  7159             20  BE-BSR-DEPT         PIC X(30).
  7160             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7161             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7162             20  BE-OUTPUT-TYPE      PIC X.
  7163                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7164                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7165
  7166     12  FILLER                      PIC X(28).
  7167******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 135
* EL156.cbl
  7169*    COPY ELCARCH.
  7170******************************************************************
  7171*                                                                *
  7172*                            ELCARCH.                            *
  7173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7174*                            VMOD=2.007                          *
  7175*                                                                *
  7176*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7177*                                                                *
  7178*   FILE TYPE = VSAM,KSDS                                        *
  7179*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7180*                                                                *
  7181*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7182*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7183*                                                                *
  7184*   LOG = NO                                                     *
  7185*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7186*                                                                *
  7187*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7188******************************************************************
  7189 01  LETTER-ARCHIVE.
  7190     12  LA-RECORD-ID                PIC XX.
  7191         88  VALID-LA-ID                VALUE 'LA'.
  7192
  7193     12  LA-CONTROL-PRIMARY.
  7194         16  LA-COMPANY-CD           PIC X.
  7195         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7196         16  LA-RECORD-TYPE          PIC X.
  7197             88  LA-HEADER-DATA         VALUE '1'.
  7198             88  LA-ADDRESS-DATA        VALUE '2'.
  7199             88  LA-TEXT-DATA           VALUE '3'.
  7200             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7201         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7202
  7203     12  LA-CONTROL-BY-TYPE.
  7204         16  LA-COMPANY-CD-A1        PIC X.
  7205         16  LA-RECORD-TYPE-A1       PIC X.
  7206         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7207         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7208
  7209     12  LA-TEXT-RECORD.
  7210         16  LA-SKIP-CONTROL         PIC XX.
  7211             88  NO-LINES-SKIPPED       VALUE SPACES.
  7212             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7213         16  LA-TEXT-LINE            PIC X(70).
  7214
  7215     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7216         16  FILLER                  PIC XX.
  7217         16  LA-ADDRESS-LINE         PIC X(30).
  7218         16  FILLER                  PIC X(40).
  7219
  7220     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7221         16  FILLER                  PIC XX.
  7222         16  LA-CARRIER              PIC X.
  7223         16  LA-CLAIM-NO             PIC X(7).
  7224         16  LA-CERT-NO.
  7225             20  LA-CERT-PRIME       PIC X(10).
  7226             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 136
* EL156.cbl
  7227         16  LA-NO-OF-COPIES         PIC S9.
  7228         16  LA-RESEND-DATE          PIC XX.
  7229         16  LA-PROCESSOR-CD         PIC X(4).
  7230         16  LA-CREATION-DT          PIC XX.
  7231         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7232         16  LA-RESEND-PRINT-DATE    PIC XX.
  7233         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7234         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7235*
  7236* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7237*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7238*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7239*   I        20  LA-DMD-RES-ST           PIC XX.
  7240*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7241*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7242*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7243*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7244*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7245*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7246*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7247*   I        20  LA-DMD-UND-CODE         PIC XX.
  7248*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7249*   V    16  FILLER                  PIC X(15).
  7250* -----
  7251*
  7252* REINSERTED  CSO  MODS
  7253*
  7254         16  FILLER.
  7255             20  FILLER                  PIC X(29).
  7256             20  LA-CSO-LETTER-STATUS    PIC X.
  7257                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7258                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7259                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7260             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7261             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7262*
  7263
  7264     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7265         16  FILLER                  PIC XX.
  7266         16  LA4-CARRIER             PIC X.
  7267         16  LA4-CLAIM-NO            PIC X(7).
  7268         16  LA4-CERT-NO.
  7269             20  LA4-CERT-PRIME      PIC X(10).
  7270             20  LA4-CERT-SFX        PIC X.
  7271         16  LA4-NO-OF-COPIES        PIC S9.
  7272         16  LA4-RESEND-DATE         PIC XX.
  7273         16  LA4-PROCESSOR-CD        PIC X(4).
  7274         16  LA4-CREATION-DT         PIC XX.
  7275         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7276         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7277         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7278         16  LA4-FORM-TYPE           PIC X.
  7279             88  LA4-INITIAL-FORM    VALUE '1'.
  7280             88  LA4-PROGRESS-FORM   VALUE '2'.
  7281         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7282         16  LA4-STATE               PIC X(02).
  7283         16  FILLER                  PIC X(31).
  7284******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 137
* EL156.cbl
  7286*    COPY ELCDAR.
  7287******************************************************************
  7288*                                                                *
  7289*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7290*   FILE TYPE = VSAM,KSDS                                        *
  7291*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7292*   BASE CLUSTER = DLYACTV                                       *
  7293*   LOG = YES                                                    *
  7294*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7295*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7296*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7297*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7298*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7299*               BY PROGRAM "LGINFCE".                            *
  7300*                                                                *
  7301******************************************************************
  7302 01  DAILY-ACTIVITY-RECORD.
  7303     05  DA-KEY.
  7304         10  DA-COMP-CD          PIC X.
  7305         10  DA-CARRIER          PIC X.
  7306         10  DA-CLAIM-NO         PIC X(7).
  7307         10  DA-CERT-NO.
  7308             15  DA-CERT-PRIME   PIC X(10).
  7309             15  DA-CERT-SFX     PIC X.
  7310     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7311     05  DA-RECORD-TYPE          PIC X.
  7312     05  FILLER                  PIC X(2).
  7313******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 138
* EL156.cbl
  7315*    COPY ERCCOMP.
  7316******************************************************************
  7317*                                                                *
  7318*                                                                *
  7319*                            ERCCOMP                             *
  7320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7321*                            VMOD=2.019                          *
  7322*                                                                *
  7323*   ONLINE CREDIT SYSTEM                                         *
  7324*                                                                *
  7325*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7326*                                                                *
  7327*   FILE TYPE = VSAM,KSDS                                        *
  7328*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7329*                                                                *
  7330*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7331*       ALTERNATE PATH = NONE                                    *
  7332*                                                                *
  7333*   LOG = NO                                                     *
  7334*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7335*                                                                *
  7336******************************************************************
  7337*                   C H A N G E   L O G
  7338*
  7339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7340*-----------------------------------------------------------------
  7341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7342* EFFECTIVE    NUMBER
  7343*-----------------------------------------------------------------
  7344* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7345* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7346* 092205    2005050300006  PEMA  ADD LEASE FEE
  7347* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7348* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7349* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7350* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7351* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7352* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7353******************************************************************
  7354
  7355 01  COMPENSATION-MASTER.
  7356     12  CO-RECORD-ID                          PIC XX.
  7357         88  VALID-CO-ID                          VALUE 'CO'.
  7358
  7359     12  CO-CONTROL-PRIMARY.
  7360         16  CO-COMPANY-CD                     PIC X.
  7361         16  CO-CONTROL.
  7362             20  CO-CTL-1.
  7363                 24  CO-CARR-GROUP.
  7364                     28  CO-CARRIER            PIC X.
  7365                     28  CO-GROUPING.
  7366                         32  CO-GROUP-PREFIX   PIC XXX.
  7367                         32  CO-GROUP-PRIME    PIC XXX.
  7368                 24  CO-RESP-NO.
  7369                     28  CO-RESP-PREFIX        PIC X(4).
  7370                     28  CO-RESP-PRIME         PIC X(6).
  7371             20  CO-CTL-2.
  7372                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 139
* EL156.cbl
  7373                     28  CO-ACCT-PREFIX        PIC X(4).
  7374                     28  CO-ACCT-PRIME         PIC X(6).
  7375         16  CO-TYPE                           PIC X.
  7376             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7377             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7378             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7379
  7380     12  CO-MAINT-INFORMATION.
  7381         16  CO-LAST-MAINT-DT                  PIC XX.
  7382         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7383         16  CO-LAST-MAINT-USER                PIC X(4).
  7384     12  FILLER                                PIC XX.
  7385     12  CO-STMT-TYPE                          PIC XXX.
  7386     12  CO-COMP-TYPE                          PIC X.
  7387         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7388     12  CO-STMT-OWNER                         PIC X(4).
  7389     12  CO-BALANCE-CONTROL                    PIC X.
  7390         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7391         88  CO-NO-BALANCE                        VALUE 'N'.
  7392
  7393     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7394         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7395         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7396         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7397
  7398     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7399         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7400         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7401
  7402     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7403     12  CO-GA-DIRECT-DEP                      PIC X.
  7404     12  CO-FUTURE-SPACE                       PIC X.
  7405         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7406
  7407     12  CO-ACCT-NAME                          PIC X(30).
  7408     12  CO-MAIL-NAME                          PIC X(30).
  7409     12  CO-ADDR-1                             PIC X(30).
  7410     12  CO-ADDR-2                             PIC X(30).
  7411     12  CO-ADDR-3.
  7412         16  CO-ADDR-CITY                      PIC X(27).
  7413         16  CO-ADDR-STATE                     PIC XX.
  7414     12  CO-CSO-1099                           PIC X.
  7415     12  CO-ZIP.
  7416         16  CO-ZIP-PRIME.
  7417             20  CO-ZIP-PRI-1ST                PIC X.
  7418                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7419             20  FILLER                        PIC X(4).
  7420         16  CO-ZIP-PLUS4                      PIC X(4).
  7421     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7422         16  CO-CAN-POSTAL-1                   PIC XXX.
  7423         16  CO-CAN-POSTAL-2                   PIC XXX.
  7424         16  FILLER                            PIC XXX.
  7425     12  CO-SOC-SEC                            PIC X(13).
  7426     12  CO-TELEPHONE.
  7427         16  CO-AREA-CODE                      PIC XXX.
  7428         16  CO-PREFIX                         PIC XXX.
  7429         16  CO-PHONE                          PIC X(4).
  7430
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 140
* EL156.cbl
  7431     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7432
  7433     12  CO-AR-BAL-LEVEL                       PIC X.
  7434         88  CO-AR-REF-LVL                        VALUE '1'.
  7435         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7436         88  CO-AR-BILL-LVL                       VALUE '2'.
  7437         88  CO-AR-AGT-LVL                        VALUE '3'.
  7438         88  CO-AR-FR-LVL                         VALUE '4'.
  7439
  7440     12  CO-AR-NORMAL-PRINT                    PIC X.
  7441         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7442         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7443
  7444     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7445
  7446     12  CO-AR-REPORTING                       PIC X.
  7447         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7448         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7449
  7450     12  CO-AR-PULL-CHECK                      PIC X.
  7451         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7452         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7453
  7454     12  CO-AR-BALANCE-PRINT                   PIC X.
  7455         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7456
  7457     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7458         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7459         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7460         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7461
  7462     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7463
  7464     12  CO-USER-CODE                          PIC X.
  7465     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7466
  7467******************************************************************
  7468*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7469*    THE LAST MONTH END RUN.
  7470******************************************************************
  7471
  7472     12  CO-LAST-ACTIVITY-DATE.
  7473         16  CO-ACT-YEAR                       PIC 99.
  7474         16  CO-ACT-MONTH                      PIC 99.
  7475         16  CO-ACT-DAY                        PIC 99.
  7476
  7477     12  CO-LAST-STMT-DT.
  7478         16  CO-LAST-STMT-YEAR                 PIC 99.
  7479         16  CO-LAST-STMT-MONTH                PIC 99.
  7480         16  CO-LAST-STMT-DAY                  PIC 99.
  7481
  7482     12  CO-MO-END-TOTALS.
  7483         16  CO-MONTHLY-TOTALS.
  7484             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7485             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7486             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7487             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7488             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 141
* EL156.cbl
  7489
  7490         16  CO-AGING-TOTALS.
  7491             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7492             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7493             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7494             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7495
  7496         16  CO-YTD-TOTALS.
  7497             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7498             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7499
  7500         16  CO-OVER-UNDER-TOTALS.
  7501             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7502             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7503
  7504     12  CO-MISCELLANEOUS-TOTALS.
  7505         16  CO-FICA-TOTALS.
  7506             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7507             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7508
  7509         16  CO-CLAIM-TOTALS.
  7510             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7511             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7512
  7513******************************************************************
  7514*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7515*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7516******************************************************************
  7517
  7518     12  CO-CURRENT-TOTALS.
  7519         16  CO-CURRENT-LAST-STMT-DT.
  7520             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7521             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7522             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7523
  7524         16  CO-CURRENT-MONTHLY-TOTALS.
  7525             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7526             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7527             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7528             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7529             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7530
  7531         16  CO-CURRENT-AGING-TOTALS.
  7532             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7533             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7534             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7535             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7536
  7537         16  CO-CURRENT-YTD-TOTALS.
  7538             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7539             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7540
  7541     12  CO-PAID-COMM-TOTALS.
  7542         16  CO-YTD-PAID-COMMS.
  7543             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7544             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7545
  7546     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 142
* EL156.cbl
  7547         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7548         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7549
  7550     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7551         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7552         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7553         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7554         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7555         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7556         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7557         88  CO-FINAL-LETTER                  VALUE 'F'.
  7558         88  CO-RECONCILING                   VALUE 'R'.
  7559         88  CO-PHONE-CALL                    VALUE 'P'.
  7560         88  CO-LEGAL                         VALUE 'L'.
  7561         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7562         88  CO-WRITE-OFF                     VALUE 'W'.
  7563         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7564
  7565     12  CO-CSR-CODE                       PIC X(4).
  7566
  7567     12  CO-GA-STATUS-INFO.
  7568         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7569         16  CO-GA-TERMINATION-DT          PIC XX.
  7570         16  CO-GA-STATUS-CODE             PIC X.
  7571             88  CO-GA-ACTIVE                 VALUE 'A'.
  7572             88  CO-GA-INACTIVE               VALUE 'I'.
  7573             88  CO-GA-PENDING                VALUE 'P'.
  7574         16  CO-GA-COMMENTS.
  7575             20  CO-GA-COMMENT-1           PIC X(40).
  7576             20  CO-GA-COMMENT-2           PIC X(40).
  7577             20  CO-GA-COMMENT-3           PIC X(40).
  7578             20  CO-GA-COMMENT-4           PIC X(40).
  7579
  7580     12  CO-RPTCD2                         PIC X(10).
  7581     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7582         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7583         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7584
  7585     12  CO-TYPE-AGENT                     PIC X(01).
  7586         88  CO-CORPORATION                   VALUE 'C'.
  7587         88  CO-PARTNERSHIP                   VALUE 'P'.
  7588         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7589         88  CO-TRUST                         VALUE 'T'.
  7590         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7591
  7592     12  CO-FAXNO.
  7593         16  CO-FAX-AREA-CODE                  PIC XXX.
  7594         16  CO-FAX-PREFIX                     PIC XXX.
  7595         16  CO-FAX-PHONE                      PIC X(4).
  7596
  7597     12  CO-BANK-INFORMATION.
  7598         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7599         16  CO-BANK-TRANSIT-NON REDEFINES
  7600             CO-BANK-TRANSIT-NO                PIC 9(8).
  7601
  7602         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7603     12  CO-MISC-DEDUCT-INFO REDEFINES
  7604                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 143
* EL156.cbl
  7605         16  CO-MD-GL-ACCT                     PIC X(10).
  7606         16  CO-MD-DIV                         PIC XX.
  7607         16  CO-MD-CENTER                      PIC X(4).
  7608         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7609         16  CO-CREATE-AP-CHECK                PIC X.
  7610         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7611         16  FILLER                            PIC XXX.
  7612     12  CO-ACH-STATUS                         PIC X.
  7613         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7614         88  CO-ACH-PENDING                        VALUE 'P'.
  7615
  7616     12  CO-BILL-SW                            PIC X.
  7617     12  CO-CONTROL-NAME                       PIC X(30).
  7618     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7619     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7620     12  CO-CLP-STATE                          PIC XX.
  7621     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7622     12  CO-SPP-REFUND-EDIT                    PIC X.
  7623
  7624******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 144
* EL156.cbl
  7626*    COPY ERCDMDNT.
  7627******************************************************************
  7628*                                                                *
  7629*                            ERCDMDNT                            *
  7630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7631*                            VMOD=2.005                          *
  7632*                                                                *
  7633*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7634*                                                                *
  7635*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7636*                                                                *
  7637*        FILE TYPE= VSAM,KSDS                                    *
  7638*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7639*                                                                *
  7640*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7641*                                                                *
  7642*        LOG = YES                                               *
  7643*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7644*                                                                *
  7645******************************************************************
  7646
  7647 01  CERTIFICATE-NOTE.
  7648     12  CN-RECORD-ID                     PIC  XX.
  7649         88  VALID-CN-ID                      VALUE 'CN'.
  7650
  7651     12  CN-CONTROL-PRIMARY.
  7652         16  CN-COMPANY-CD                PIC X.
  7653         16  CN-CERT-KEY.
  7654             20  CN-CARRIER               PIC X.
  7655             20  CN-GROUPING.
  7656                 24  CN-GROUPING-PREFIX   PIC XXX.
  7657                 24  CN-GROUPING-PRIME    PIC XXX.
  7658             20  CN-STATE                 PIC XX.
  7659             20  CN-ACCOUNT.
  7660                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7661                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7662             20  CN-CERT-EFF-DT           PIC XX.
  7663             20  CN-CERT-NO.
  7664                 24  CN-CERT-PRIME        PIC X(10).
  7665                 24  CN-CERT-SFX          PIC X.
  7666
  7667     12  CN-BILLING-START-LINE-NO         PIC 99.
  7668     12  CN-BILLING-END-LINE-NO           PIC 99.
  7669
  7670     12  CN-LINES.
  7671         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7672
  7673     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7674         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7675         16  CN-CSI-GENERAL-DATA-AREA.
  7676             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7677
  7678         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7679             CN-CSI-GENERAL-DATA-AREA.
  7680             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7681             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7682             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7683             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 145
* EL156.cbl
  7684             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7685             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7686             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7687             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7688             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7689             20  FILLER                       PIC XX.
  7690             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7691             20  FILLER                       PIC X(38).
  7692
  7693         16  CN-CSI-PRODUCT-DATA-AREA.
  7694             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7695
  7696         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7697             CN-CSI-PRODUCT-DATA-AREA.
  7698             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7699             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7700             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7701             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7702             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7703             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7704             20  FILLER                   PIC XX.
  7705             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7706             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7707             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7708             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7709             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7710             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7711             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7712             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7713             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7714             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7715             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7716             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7717             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7718             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7719             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7720             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7721             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7722             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7723             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7724             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7725             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7726             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7727             20  FILLER                   PIC X(25).
  7728
  7729         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7730             CN-CSI-CREDIT-CARD-DATA.
  7731             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7732             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7733             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7734             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7735             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7736             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7737             20  FILLER                   PIC XX.
  7738             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7739             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7740             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7741             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 146
* EL156.cbl
  7742             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7743             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7744             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7745             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7746             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7747             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7748             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7749             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7750             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7751             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7752             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7753             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7754             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7755             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7756             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7757             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7758             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7759             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7760             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7761             20  FILLER                   PIC X(17).
  7762
  7763         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7764             CN-CSI-FAMILY-LEAVE-DATA.
  7765             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7766             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7767             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7768             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7769             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7770             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7771             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7772             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7773             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7774             20  CN-CSI-SL-INT-ON-PROCEEDS
  7775                                          PIC S9(5)V99  COMP-3.
  7776             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7777             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7778             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7779             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7780             20  CN-CSI-SL-POLICY-BENEFITS
  7781                                          PIC S9(5)V99  COMP-3.
  7782             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7783             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7784             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7785             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7786             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7787             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7788             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7789             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7790             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7791             20  CN-CSI-SL-STATE-NOT      PIC X.
  7792             20  FILLER                   PIC XX.
  7793
  7794         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7795             CN-CSI-SENIOR-LIFE-DATA.
  7796             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7797             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7798             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7799                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 147
* EL156.cbl
  7800             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7801             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7802             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7803             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7804             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7805             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7806             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7807             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7808             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7809             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7810             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7811             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7812             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7813             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7814             20  CN-CSI-PP-REPAIR         PIC X.
  7815             20  CN-CSI-PP-REPLACE        PIC X.
  7816             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7817             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7818             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7819             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7820             20  FILLER                   PIC X(5).
  7821
  7822         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7823             CN-CSI-PURCH-PROP-DATA.
  7824             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7825             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7826             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7827             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7828             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7829             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7830             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7831             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7832             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7833             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7834             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7835             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7836             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7837             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7838             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7839             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7840             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7841             20  CN-CSI-EW-REPLACE        PIC X.
  7842             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7843             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7844             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7845             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7846             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7847             20  FILLER                   PIC X(4).
  7848
  7849     12  CN-LAST-MAINT-DT                 PIC XX.
  7850     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7851     12  CN-LAST-MAINT-USER               PIC X(4).
  7852     12  FILLER                           PIC X(6).
  7853
  7854******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 148
* EL156.cbl
  7856*    COPY ERCCNOT.
  7857******************************************************************
  7858*                                                                *
  7859*                            ERCCNOT                             *
  7860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7861*                            VMOD=2.003                          *
  7862*                                                                *
  7863*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7864*                                                                *
  7865*        FILE TYPE= VSAM,KSDS                                    *
  7866*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7867*                                                                *
  7868*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7869*                                                                *
  7870*        LOG = YES                                               *
  7871*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7872*                                                                *
  7873******************************************************************
  7874*                   C H A N G E   L O G
  7875*
  7876* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7877*-----------------------------------------------------------------
  7878*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7879* EFFECTIVE    NUMBER
  7880*-----------------------------------------------------------------
  7881* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7882******************************************************************
  7883
  7884 01  CERT-NOTE-FILE.
  7885     12  CZ-RECORD-ID                PIC  XX.
  7886         88  VALID-CZ-ID                  VALUE 'CZ'.
  7887
  7888     12  CZ-CONTROL-PRIMARY.
  7889         16  CZ-COMPANY-CD           PIC X.
  7890         16  CZ-CARRIER              PIC X.
  7891         16  CZ-GROUPING.
  7892             20 CZ-GROUPING-PREFIX   PIC XXX.
  7893             20 CZ-GROUPING-PRIME    PIC XXX.
  7894         16  CZ-STATE                PIC XX.
  7895         16  CZ-ACCOUNT.
  7896             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7897             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7898         16  CZ-CERT-EFF-DT          PIC XX.
  7899         16  CZ-CERT-NO.
  7900             20  CZ-CERT-PRIME       PIC X(10).
  7901             20  CZ-CERT-SFX         PIC X.
  7902         16  CZ-RECORD-TYPE          PIC X.
  7903             88  CERT-NOTE           VALUE '1'.
  7904             88  CLAIM-CERT-NOTE     VALUE '2'.
  7905         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7906
  7907     12  CZ-LAST-MAINT-DT            PIC XX.
  7908     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7909     12  CZ-LAST-MAINT-USER          PIC X(4).
  7910
  7911     12  CZ-NOTE-INFORMATION.
  7912         16  CZ-NOTE                 PIC X(63).
  7913         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 149
* EL156.cbl
  7914******************************************************************
  7915*                            COPY ERCPDEF.
  7916******************************************************************
  7917*                                                                *
  7918*                                                                *
  7919*                            ERCPDEF.                            *
  7920*                                                                *
  7921*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7922*                                                                *
  7923*    FILE TYPE = VSAM,KSDS                                       *
  7924*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7925*                                                                *
  7926*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7927*                                                                *
  7928*    LOG = YES                                                   *
  7929*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7930******************************************************************
  7931*                   C H A N G E   L O G
  7932*
  7933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7934*-----------------------------------------------------------------
  7935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7936* EFFECTIVE    NUMBER
  7937*-----------------------------------------------------------------
  7938* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7939* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7940******************************************************************
  7941 01  PRODUCT-MASTER.
  7942    12  PD-RECORD-ID                 PIC X(02).
  7943        88  VALID-PD-ID                  VALUE 'PD'.
  7944    12  PD-CONTROL-PRIMARY.
  7945        16  PD-COMPANY-CD            PIC X.
  7946        16  PD-STATE                 PIC XX.
  7947        16  PD-PRODUCT-CD            PIC XXX.
  7948        16  PD-FILLER                PIC X(7).
  7949        16  PD-BEN-TYPE              PIC X.
  7950        16  PD-BEN-CODE              PIC XX.
  7951        16  PD-PROD-EXP-DT           PIC XX.
  7952    12  FILLER                       PIC X(50).
  7953    12  PD-PRODUCT-DATA OCCURS 8.
  7954        16  PD-PROD-CODE             PIC X.
  7955            88  PD-PROD-LIFE           VALUE 'L'.
  7956            88  PD-PROD-PROP           VALUE 'P'.
  7957            88  PD-PROD-AH             VALUE 'A'.
  7958            88  PD-PROD-IU             VALUE 'I'.
  7959            88  PD-PROD-GAP            VALUE 'G'.
  7960            88  PD-PROD-FAML           VALUE 'F'.
  7961        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7962        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7963        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7964        16  PD-MAX-TERM              PIC S999        COMP-3.
  7965        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7966        16  FILLER                   PIC X.
  7967        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7968        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7969        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7970        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7971        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 150
* EL156.cbl
  7972        16  PD-REC-CRIT-PERIOD       PIC 99.
  7973        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7974            20  PD-RECURRING-YN      PIC X.
  7975            20  FILLER               PIC X.
  7976        16  PD-RTW-MOS               PIC 99.
  7977        16  PD-MAX-EXTENSION         PIC 99.
  7978        16  FILLER                   PIC XX.
  7979    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7980    12  PD-TERM-LIMITS OCCURS 15.
  7981        16  PD-LOW-TERM              PIC S999        COMP-3.
  7982        16  PD-HI-TERM               PIC S999        COMP-3.
  7983*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7984    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7985        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7986        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7987    12  PD-EARN-FACTORS.
  7988        16  FILLER OCCURS 15.
  7989            20  FILLER OCCURS 15.
  7990                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7991    12  PD-PRODUCT-DESC              PIC X(80).
  7992    12  PD-TRUNCATED                 PIC X.
  7993    12  FILLER                       PIC X(59).
  7994    12  PD-MAINT-INFORMATION.
  7995        16  PD-LAST-MAINT-DT         PIC X(02).
  7996        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7997        16  PD-LAST-MAINT-BY         PIC X(04).
  7998*                            COPY ELCCRTT.
  7999******************************************************************
  8000*                                                                *
  8001*                            ELCCRTT.                            *
  8002*                                                                *
  8003*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8004*                                                                *
  8005*   FILE TYPE = VSAM,KSDS                                        *
  8006*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8007*                                                                *
  8008*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8009*                                                                *
  8010*   LOG = YES                                                    *
  8011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8012******************************************************************
  8013*                   C H A N G E   L O G
  8014*
  8015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8016*-----------------------------------------------------------------
  8017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8018* EFFECTIVE    NUMBER
  8019*-----------------------------------------------------------------
  8020* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8021* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8022* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8023* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8024* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8025* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8026* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8027******************************************************************
  8028
  8029 01  CERTIFICATE-TRAILERS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 151
* EL156.cbl
  8030     12  CS-RECORD-ID                      PIC XX.
  8031         88  VALID-CS-ID                      VALUE 'CS'.
  8032
  8033     12  CS-CONTROL-PRIMARY.
  8034         16  CS-COMPANY-CD                 PIC X.
  8035         16  CS-CARRIER                    PIC X.
  8036         16  CS-GROUPING                   PIC X(6).
  8037         16  CS-STATE                      PIC XX.
  8038         16  CS-ACCOUNT                    PIC X(10).
  8039         16  CS-CERT-EFF-DT                PIC XX.
  8040         16  CS-CERT-NO.
  8041             20  CS-CERT-PRIME             PIC X(10).
  8042             20  CS-CERT-SFX               PIC X.
  8043         16  CS-TRAILER-TYPE               PIC X.
  8044             88  COMM-TRLR           VALUE 'A'.
  8045             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8046             88  CERT-DATA-TRLR      VALUE 'C'.
  8047
  8048     12  CS-DATA-AREA                      PIC X(516).
  8049
  8050     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8051         16  CS-BANK-COMMISSION-AREA.
  8052             20  CS-BANK-COMMS       OCCURS 10.
  8053                 24  CS-AGT                PIC X(10).
  8054                 24  CS-COM-TYP            PIC X.
  8055                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8056                 24  CS-RECALC-LV-INDIC    PIC X.
  8057                 24  FILLER                PIC X(10).
  8058         16  FILLER                        PIC X(256).
  8059
  8060     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8061****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8062         16  CS-MB-CLAIM-DATA OCCURS 24.
  8063             20  CS-CLAIM-NO               PIC X(7).
  8064             20  CS-CLAIM-TYPE             PIC X.
  8065                 88  CS-AH-CLM               VALUE 'A'.
  8066                 88  CS-IU-CLM               VALUE 'I'.
  8067                 88  CS-GP-CLM               VALUE 'G'.
  8068                 88  CS-LF-CLM               VALUE 'L'.
  8069                 88  CS-PR-CLM               VALUE 'P'.
  8070                 88  CS-FL-CLM               VALUE 'F'.
  8071             20  CS-INSURED-TYPE           PIC X.
  8072                 88  CS-PRIM-INSURED          VALUE 'P'.
  8073                 88  CS-CO-BORROWER           VALUE 'C'.
  8074             20  CS-BENEFIT-PERIOD         PIC 99.
  8075             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8076             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8077             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8078         16  FILLER                        PIC X(12).
  8079     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8080         16  CS-VIN-NUMBER                 PIC X(17).
  8081         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8082         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8083         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8084         16  FILLER                        PIC X(496).
  8085 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8086                          CONTROL-FILE CERTIFICATE-MASTER
  8087                          ACTIVITY-TRAILERS ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 152
* EL156.cbl
  8088                          ACCOUNT-MASTER CHECK-QUE
  8089                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8090                          DAILY-ACTIVITY-RECORD
  8091                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8092                          CERT-NOTE-FILE PRODUCT-MASTER
  8093                          CERTIFICATE-TRAILERS.
  8094 0000-DFHEXIT SECTION.
  8095     MOVE '9#                    $   ' TO DFHEIV0.
  8096     MOVE 'EL156' TO DFHEIV1.
  8097     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8098
  8099     IF EIBCALEN = 0
  8100         GO TO 8800-UNAUTHORIZED-ACCESS.
  8101
  8102     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8103     MOVE EIBTRMID               TO QID-TERM.
  8104     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8105     MOVE '2'                    TO EMI-SWITCH2.
  8106     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8107     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8108
  8109     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8110     MOVE '5'                    TO DC-OPTION-CODE.
  8111     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8112     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8113                                    SAVE-BIN-DATE.
  8114     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8115     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8116
  8117     IF SAVE-DATE-YY > 70
  8118         MOVE 19                 TO SAVE-DATE-CC
  8119     ELSE
  8120         MOVE 20                 TO SAVE-DATE-CC.
  8121
  8122     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8123         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8124     END-IF.
  8125
  8126     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8127        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8128     ELSE
  8129        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8130     END-IF
  8131
  8132     IF PI-PRINT-CLM-FRM-YN = 'N'
  8133         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8134     ELSE
  8135         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8136     END-IF
  8137
  8138     IF PI-PRINT-SURVEY-YN = 'N'
  8139         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8140     ELSE
  8141         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8142     END-IF
  8143
  8144     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8145         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 153
* EL156.cbl
  8146     ELSE
  8147         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8148     END-IF
  8149
  8150* EXEC CICS HANDLE CONDITION
  8151*        NOTOPEN   (9990-ABEND)
  8152*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8153*        MAPFAIL   (0400-FIRST-TIME)
  8154*        DUPREC    (6180-DUPREC)
  8155*        ERROR     (9990-ABEND)
  8156*    END-EXEC.
  8157*    MOVE '"$JL?%.               ! " #00008145' TO DFHEIV0
  8158     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8160     MOVE X'2220233030303038313435' TO DFHEIV0(25:11)
  8161     CALL 'kxdfhei1' USING DFHEIV0
  8162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8163
  8164
  8165     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8166         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8167
  8168     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8169         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8170             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8171             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8172             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8173             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8174             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8175             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8176             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8177             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8178             MOVE LOW-VALUES           TO EL156AI
  8179             MOVE 'Y'                  TO FIRST-ENTRY
  8180         ELSE
  8181             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8182             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8183             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8184             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8185             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8186             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8187             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8188             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8189
  8190     IF RETURNED-FROM NOT = SPACES
  8191        IF (RETURNED-FROM = 'EL614')
  8192           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8193           IF WS-SAVED-EOB-CODES NOT = SPACES
  8194              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8195           ELSE
  8196              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8197           END-IF
  8198        END-IF
  8199         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8200            MOVE 'Y'             TO FIRST-ENTRY
  8201            IF RETURNED-FROM = 'EL614'
  8202               AND (PI-PASS-SW NOT = 'C')
  8203               IF WS-SAVED-EOB-CODES NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 154
* EL156.cbl
  8204                  MOVE WS-SAVED-EOB-CODES
  8205                                 TO PI-PMTNOTE2
  8206                                    WS-PMTNOTE2
  8207                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8208               ELSE
  8209                  MOVE SPACES    TO PI-PMTNOTE2
  8210                                    WS-PMTNOTE2
  8211                                    PI-EOB-CODES-EXIST
  8212               END-IF
  8213            END-IF
  8214            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8215            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8216            IF RETURNED-FROM = 'EL614'
  8217               GO TO 1000-EDIT-DATA
  8218            END-IF
  8219            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8220               (PAYEEI   = LOW-VALUES OR SPACES)
  8221               GO TO 8100-SEND-INITIAL-MAP
  8222            ELSE
  8223               GO TO 1000-EDIT-DATA.
  8224
  8225     IF EIBTRNID NOT = TRANS-ID
  8226         GO TO 0400-FIRST-TIME.
  8227
  8228     IF EIBAID = DFHCLEAR
  8229        IF PI-PASS-SW = 'C'
  8230           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8231           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8232           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8233           MOVE 'Y'            TO RETURNED-FROM-B
  8234           GO TO 1000-EDIT-DATA
  8235        ELSE
  8236           GO TO 9400-CLEAR.
  8237
  8238     IF PI-PASS-SW = 'C'
  8239         MOVE MAP-NAMEB          TO MAP-NAME
  8240         IF EIBAID = DFHPF1 OR DFHPF13
  8241             GO TO 5000-UPDATE
  8242           ELSE
  8243             IF EIBAID NOT = DFHENTER
  8244                 MOVE LOW-VALUES TO EL156BI
  8245                 MOVE MAP-NAMEB  TO MAP-NAME
  8246                 MOVE ER-0029    TO EMI-ERROR
  8247                 MOVE -1         TO  ENTPFBL
  8248                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249                 GO TO 8200-SEND-DATAONLY.
  8250
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 155
* EL156.cbl
  8252 0200-RECEIVE.
  8253     MOVE LOW-VALUES             TO EL156AI.
  8254     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8255         MOVE ER-0008            TO EMI-ERROR
  8256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257         IF PI-PASS-SW = 'C'
  8258             MOVE -1             TO ENTPFBL
  8259             GO TO 8200-SEND-DATAONLY
  8260         ELSE
  8261             MOVE -1             TO PMTTYPEL
  8262             GO TO 8200-SEND-DATAONLY.
  8263
  8264     IF PI-COMPANY-ID = 'DMD'
  8265         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8266
  8267     IF PI-PASS-SW = 'C'
  8268         MOVE MAP-NAMEB          TO MAP-NAME.
  8269
  8270
  8271* EXEC CICS RECEIVE
  8272*        MAP   (MAP-NAME)
  8273*        MAPSET(MAPSET-NAME)
  8274*        ASIS
  8275*        INTO  (EL156AI)
  8276*    END-EXEC.
  8277     MOVE LENGTH OF
  8278      EL156AI
  8279       TO DFHEIV11
  8280*    MOVE '8"TAI  L              ''   #00008258' TO DFHEIV0
  8281     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8282     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8283     MOVE X'2020233030303038323538' TO DFHEIV0(25:11)
  8284     CALL 'kxdfhei1' USING DFHEIV0,
  8285           MAP-NAME,
  8286           EL156AI,
  8287           DFHEIV11,
  8288           MAPSET-NAME,
  8289           DFHEIV99,
  8290           DFHEIV99
  8291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8292
  8293
  8294     IF PI-PASS-SW NOT = 'C'
  8295         GO TO 0250-MAPA.
  8296
  8297     IF ENTPFBL NOT > ZERO
  8298         MOVE MAP-NAMEB          TO MAP-NAME
  8299         MOVE ER-0029            TO EMI-ERROR
  8300         MOVE -1                 TO  ENTPFBL
  8301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8302         GO TO 8200-SEND-DATAONLY.
  8303
  8304     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8305         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8306       ELSE
  8307         MOVE MAP-NAMEB           TO MAP-NAME
  8308         MOVE ER-0029             TO EMI-ERROR
  8309         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 156
* EL156.cbl
  8310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8311         GO TO 8200-SEND-DATAONLY.
  8312
  8313     IF EIBAID = DFHPF1 OR DFHPF13
  8314         IF MODIFY-CAP
  8315            GO TO 5000-UPDATE
  8316          ELSE
  8317            MOVE 'UPDATE'           TO SM-READ
  8318            PERFORM 9995-SECURITY-VIOLATION
  8319            MOVE MAP-NAMEB          TO MAP-NAME
  8320            MOVE ER-0070            TO EMI-ERROR
  8321            MOVE -1                 TO  ENTPFBL
  8322            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8323            GO TO 8200-SEND-DATAONLY.
  8324
  8325 0250-MAPA.
  8326     IF ENTERPFL = 0
  8327         GO TO 0300-CHECK-PFKEYS.
  8328
  8329     IF EIBAID NOT = DFHENTER
  8330         MOVE ER-0004            TO EMI-ERROR
  8331         GO TO 0320-INPUT-ERROR.
  8332
  8333     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8334         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8335     ELSE
  8336         MOVE ER-0029            TO EMI-ERROR
  8337         GO TO 0320-INPUT-ERROR.
  8338
  8339 0300-CHECK-PFKEYS.
  8340     IF EIBAID = DFHPF7 OR DFHPF8
  8341         GO TO 8820-PF7-8.
  8342
  8343     IF EIBAID = DFHPF23
  8344         GO TO 8810-PF23.
  8345
  8346     IF EIBAID = DFHPF24
  8347         GO TO 9200-RETURN-MAIN-MENU.
  8348
  8349     IF EIBAID = DFHPF12
  8350         GO TO 9500-PF12.
  8351
  8352     IF EIBAID = DFHPF1
  8353        IF PI-PASS-SW = 'A' OR 'B'
  8354          GO TO 0330-BROWSE-FORWARD.
  8355
  8356     IF EIBAID = DFHPF2
  8357        IF PI-PASS-SW = 'A' OR 'B'
  8358          GO TO 0350-BROWSE-BACKWARD.
  8359
  8360     IF EIBAID = DFHPF6
  8361        IF PI-EOB-CODES-EXIST = 'Y'
  8362           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8363        ELSE
  8364           MOVE SPACES              TO WS-PMTNOTE2
  8365        END-IF
  8366         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8367         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 157
* EL156.cbl
  8368            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8369         END-IF
  8370         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8371         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8372             MOVE 'EL614'        TO PGM-NAME
  8373             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8374             GO TO 9300-XCTL
  8375         ELSE
  8376             MOVE XCTL-157       TO PGM-NAME
  8377             GO TO 9300-XCTL.
  8378
  8379     IF EIBAID = DFHPF9
  8380        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8381        MOVE XCTL-141            TO PGM-NAME
  8382        GO TO 9300-XCTL.
  8383
  8384     IF EIBAID = DFHPF10
  8385        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8386        MOVE XCTL-155            TO PGM-NAME
  8387        GO TO 9300-XCTL.
  8388
  8389     MOVE SPACES                 TO ERRMSG0O
  8390                                    ERRMSG1O
  8391                                    ERRMSG2O.
  8392
  8393     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8394         IF PI-PASS-SW NOT = 'B'
  8395             MOVE ER-0422        TO EMI-ERROR
  8396             GO TO 0320-INPUT-ERROR
  8397           ELSE
  8398             GO TO 0700-TEST-FOR-CHANGES.
  8399
  8400     IF EIBAID = DFHPF11
  8401        IF PI-PASS-SW = 'C'
  8402           MOVE ER-0029          TO EMI-ERROR
  8403           GO TO 0320-INPUT-ERROR.
  8404
  8405     IF EIBAID = DFHENTER OR DFHPF11
  8406        NEXT SENTENCE
  8407     ELSE
  8408        MOVE ER-0029             TO EMI-ERROR
  8409        GO TO 0320-INPUT-ERROR.
  8410
  8411     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8412
  8413     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8414         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8415         GO TO 1000-EDIT-DATA
  8416     ELSE
  8417         IF PI-FATAL-COUNT NOT = 0 OR
  8418            PI-FORCE-COUNT NOT = 0
  8419             GO TO 1000-EDIT-DATA
  8420         ELSE
  8421             GO TO 2000-EDIT-DONE.
  8422
  8423 0320-INPUT-ERROR.
  8424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8425
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 158
* EL156.cbl
  8426     IF ENTERPFL = 0
  8427         MOVE -1                 TO PMTTYPEL
  8428     ELSE
  8429         MOVE AL-UNBON           TO ENTERPFA
  8430         MOVE -1                 TO ENTERPFL.
  8431
  8432     GO TO 8200-SEND-DATAONLY.
  8433
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 159
* EL156.cbl
  8435 0330-BROWSE-FORWARD.
  8436
  8437     MOVE CLMNOI            TO PI-CLAIM-NO.
  8438     MOVE CARRI             TO PI-CARRIER.
  8439     MOVE CERTNOI           TO PI-CERT-PRIME.
  8440     MOVE SUFXI             TO PI-CERT-SFX.
  8441
  8442     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8443     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8444     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8445     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8446
  8447     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8448
  8449
  8450* EXEC CICS HANDLE CONDITION
  8451*         NOTFND   (0380-CLAIM-END-FILE)
  8452*         ENDFILE  (0380-CLAIM-END-FILE)
  8453*    END-EXEC.
  8454*    MOVE '"$I''                  ! # #00008420' TO DFHEIV0
  8455     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8457     MOVE X'2320233030303038343230' TO DFHEIV0(25:11)
  8458     CALL 'kxdfhei1' USING DFHEIV0
  8459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8460
  8461
  8462
  8463* EXEC CICS STARTBR
  8464*         DATASET    ('ELMSTR')
  8465*         RIDFLD     (ELMSTR-KEY)
  8466*         GTEQ
  8467*    END-EXEC.
  8468     MOVE 'ELMSTR' TO DFHEIV1
  8469     MOVE 0
  8470       TO DFHEIV11
  8471*    MOVE '&,         G          &   #00008425' TO DFHEIV0
  8472     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8474     MOVE X'2020233030303038343235' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0,
  8476           DFHEIV1,
  8477           ELMSTR-KEY,
  8478           DFHEIV99,
  8479           DFHEIV11,
  8480           DFHEIV99
  8481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8482
  8483
  8484     MOVE 'Y' TO WS-BROWSE-START-SW.
  8485
  8486 0335-READNEXT.
  8487
  8488
  8489* EXEC CICS READNEXT
  8490*         DATASET    ('ELMSTR')
  8491*         RIDFLD     (ELMSTR-KEY)
  8492*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 160
* EL156.cbl
  8493*    END-EXEC.
  8494     MOVE 'ELMSTR' TO DFHEIV1
  8495     MOVE 0
  8496       TO DFHEIV11
  8497*    MOVE '&.S                   )   #00008435' TO DFHEIV0
  8498     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8499     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8500     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
  8501     CALL 'kxdfhei1' USING DFHEIV0,
  8502           DFHEIV1,
  8503           DFHEIV20,
  8504           DFHEIV99,
  8505           ELMSTR-KEY,
  8506           DFHEIV99,
  8507           DFHEIV11,
  8508           DFHEIV99,
  8509           DFHEIV99
  8510     SET ADDRESS OF CLAIM-MASTER TO
  8511         DFHEIV20
  8512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8513
  8514
  8515     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8516        GO TO 0380-CLAIM-END-FILE.
  8517
  8518     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8519        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8520        GO TO 0335-READNEXT.
  8521
  8522     IF PI-COMPANY-ID = 'CRI'
  8523         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8524            GO TO 0380-CLAIM-END-FILE.
  8525
  8526     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8527         GO TO 0335-READNEXT.
  8528
  8529     IF PI-CARRIER-SECURITY > SPACES
  8530         IF CL-CARRIER = PI-CARRIER-SECURITY
  8531             NEXT SENTENCE
  8532         ELSE
  8533             GO TO 0335-READNEXT.
  8534
  8535     IF PI-ACCOUNT-SECURITY > SPACES
  8536         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8537             NEXT SENTENCE
  8538         ELSE
  8539             GO TO 0335-READNEXT.
  8540
  8541     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8542     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8543     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8544
  8545     GO TO 0400-FIRST-TIME.
  8546
  8547 0350-BROWSE-BACKWARD.
  8548
  8549     MOVE CLMNOI            TO PI-CLAIM-NO
  8550                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 161
* EL156.cbl
  8551     MOVE CARRI             TO PI-CARRIER.
  8552     MOVE CERTNOI           TO PI-CERT-PRIME.
  8553     MOVE SUFXI             TO PI-CERT-SFX.
  8554
  8555     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8556
  8557     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8558     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8559     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8560
  8561
  8562* EXEC CICS HANDLE CONDITION
  8563*         NOTFND   (0380-CLAIM-END-FILE)
  8564*         ENDFILE  (0380-CLAIM-END-FILE)
  8565*    END-EXEC.
  8566*    MOVE '"$I''                  ! $ #00008487' TO DFHEIV0
  8567     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8569     MOVE X'2420233030303038343837' TO DFHEIV0(25:11)
  8570     CALL 'kxdfhei1' USING DFHEIV0
  8571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8572
  8573
  8574
  8575* EXEC CICS STARTBR
  8576*         DATASET    ('ELMSTR')
  8577*         RIDFLD     (ELMSTR-KEY)
  8578*         GTEQ
  8579*    END-EXEC.
  8580     MOVE 'ELMSTR' TO DFHEIV1
  8581     MOVE 0
  8582       TO DFHEIV11
  8583*    MOVE '&,         G          &   #00008492' TO DFHEIV0
  8584     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8585     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8586     MOVE X'2020233030303038343932' TO DFHEIV0(25:11)
  8587     CALL 'kxdfhei1' USING DFHEIV0,
  8588           DFHEIV1,
  8589           ELMSTR-KEY,
  8590           DFHEIV99,
  8591           DFHEIV11,
  8592           DFHEIV99
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8594
  8595
  8596     MOVE 'Y' TO WS-BROWSE-START-SW.
  8597
  8598
  8599* EXEC CICS READNEXT
  8600*         DATASET    ('ELMSTR')
  8601*         RIDFLD     (ELMSTR-KEY)
  8602*         SET        (ADDRESS OF CLAIM-MASTER)
  8603*    END-EXEC.
  8604     MOVE 'ELMSTR' TO DFHEIV1
  8605     MOVE 0
  8606       TO DFHEIV11
  8607*    MOVE '&.S                   )   #00008500' TO DFHEIV0
  8608     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 162
* EL156.cbl
  8609     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8610     MOVE X'2020233030303038353030' TO DFHEIV0(25:11)
  8611     CALL 'kxdfhei1' USING DFHEIV0,
  8612           DFHEIV1,
  8613           DFHEIV20,
  8614           DFHEIV99,
  8615           ELMSTR-KEY,
  8616           DFHEIV99,
  8617           DFHEIV11,
  8618           DFHEIV99,
  8619           DFHEIV99
  8620     SET ADDRESS OF CLAIM-MASTER TO
  8621         DFHEIV20
  8622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8623
  8624
  8625
  8626* EXEC CICS READPREV
  8627*         DATASET    ('ELMSTR')
  8628*         RIDFLD     (ELMSTR-KEY)
  8629*         SET        (ADDRESS OF CLAIM-MASTER)
  8630*    END-EXEC.
  8631     MOVE 'ELMSTR' TO DFHEIV1
  8632     MOVE 0
  8633       TO DFHEIV11
  8634*    MOVE '&0S                   )   #00008506' TO DFHEIV0
  8635     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8636     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8637     MOVE X'2020233030303038353036' TO DFHEIV0(25:11)
  8638     CALL 'kxdfhei1' USING DFHEIV0,
  8639           DFHEIV1,
  8640           DFHEIV20,
  8641           DFHEIV99,
  8642           ELMSTR-KEY,
  8643           DFHEIV99,
  8644           DFHEIV11,
  8645           DFHEIV99,
  8646           DFHEIV99
  8647     SET ADDRESS OF CLAIM-MASTER TO
  8648         DFHEIV20
  8649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8650
  8651
  8652 0360-BROWSE-BACKWARD.
  8653
  8654
  8655* EXEC CICS READPREV
  8656*         DATASET    ('ELMSTR')
  8657*         RIDFLD     (ELMSTR-KEY)
  8658*         SET        (ADDRESS OF CLAIM-MASTER)
  8659*    END-EXEC.
  8660     MOVE 'ELMSTR' TO DFHEIV1
  8661     MOVE 0
  8662       TO DFHEIV11
  8663*    MOVE '&0S                   )   #00008514' TO DFHEIV0
  8664     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8666     MOVE X'2020233030303038353134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 163
* EL156.cbl
  8667     CALL 'kxdfhei1' USING DFHEIV0,
  8668           DFHEIV1,
  8669           DFHEIV20,
  8670           DFHEIV99,
  8671           ELMSTR-KEY,
  8672           DFHEIV99,
  8673           DFHEIV11,
  8674           DFHEIV99,
  8675           DFHEIV99
  8676     SET ADDRESS OF CLAIM-MASTER TO
  8677         DFHEIV20
  8678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8679
  8680
  8681     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8682        GO TO 0380-CLAIM-END-FILE.
  8683
  8684     IF PI-COMPANY-ID = 'CRI'
  8685         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8686            GO TO 0380-CLAIM-END-FILE.
  8687
  8688     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8689         GO TO 0360-BROWSE-BACKWARD.
  8690
  8691     IF PI-CARRIER-SECURITY > SPACES
  8692         IF CL-CARRIER = PI-CARRIER-SECURITY
  8693             NEXT SENTENCE
  8694         ELSE
  8695             GO TO 0360-BROWSE-BACKWARD.
  8696
  8697     IF PI-ACCOUNT-SECURITY > SPACES
  8698         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8699             NEXT SENTENCE
  8700         ELSE
  8701             GO TO 0360-BROWSE-BACKWARD.
  8702
  8703     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8704     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8705     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8706
  8707     GO TO 0400-FIRST-TIME.
  8708
  8709 0380-CLAIM-END-FILE.
  8710
  8711     MOVE ER-0130     TO EMI-ERROR.
  8712     MOVE -1          TO CLMNOL.
  8713     MOVE AL-UABON    TO CARRA
  8714                         CLMNOA
  8715                         CERTNOA
  8716                         SUFXA.
  8717
  8718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8719
  8720     GO TO 8200-SEND-DATAONLY.
  8721
  8722 0400-FIRST-TIME.
  8723
  8724     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 164
* EL156.cbl
  8725        MOVE 'N'         TO WS-BROWSE-START-SW
  8726
  8727* EXEC CICS ENDBR
  8728*            DATASET    ('ELMSTR')
  8729*       END-EXEC.
  8730     MOVE 'ELMSTR' TO DFHEIV1
  8731     MOVE 0
  8732       TO DFHEIV11
  8733*    MOVE '&2                    $   #00008565' TO DFHEIV0
  8734     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8735     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8736     MOVE X'2020233030303038353635' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0,
  8738           DFHEIV1,
  8739           DFHEIV11,
  8740           DFHEIV99
  8741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8742
  8743
  8744     IF PI-PROCESSOR-ID = 'LGXX'
  8745         NEXT SENTENCE
  8746     ELSE
  8747
  8748* EXEC CICS READQ TS
  8749*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8750*            INTO    (SECURITY-CONTROL)
  8751*            LENGTH  (SC-COMM-LENGTH)
  8752*            ITEM    (SC-ITEM)
  8753*        END-EXEC
  8754*    MOVE '*$II   L              ''   #00008572' TO DFHEIV0
  8755     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8757     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           PI-SECURITY-TEMP-STORE-ID,
  8760           SECURITY-CONTROL,
  8761           SC-COMM-LENGTH,
  8762           SC-ITEM,
  8763           DFHEIV99,
  8764           DFHEIV99
  8765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8766         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8767         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8768
  8769     MOVE LOW-VALUES             TO EL156AI.
  8770     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8771     MOVE 'Y'                    TO FIRST-ENTRY.
  8772     GO TO 7000-SHOW-CLAIM.
  8773
  8774 0500-CREATE-TEMP-STORAGE.
  8775     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8776
  8777
  8778* EXEC CICS WRITEQ TS
  8779*        QUEUE (QID)
  8780*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8781*        LENGTH(PI-COMM-LENGTH)
  8782*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 165
* EL156.cbl
  8783*    MOVE '*"                    ''   #00008589' TO DFHEIV0
  8784     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8785     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8786     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  8787     CALL 'kxdfhei1' USING DFHEIV0,
  8788           QID,
  8789           PROGRAM-INTERFACE-BLOCK,
  8790           PI-COMM-LENGTH,
  8791           DFHEIV99,
  8792           DFHEIV99,
  8793           DFHEIV99
  8794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8795
  8796
  8797
  8798* EXEC CICS WRITEQ TS
  8799*        QUEUE (QID)
  8800*        FROM  (EL156AI)
  8801*        LENGTH(MAP-LENGTH)
  8802*    END-EXEC.
  8803*    MOVE '*"                    ''   #00008595' TO DFHEIV0
  8804     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8806     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
  8807     CALL 'kxdfhei1' USING DFHEIV0,
  8808           QID,
  8809           EL156AI,
  8810           MAP-LENGTH,
  8811           DFHEIV99,
  8812           DFHEIV99,
  8813           DFHEIV99
  8814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8815
  8816
  8817 0599-EXIT.
  8818      EXIT.
  8819
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 166
* EL156.cbl
  8821 0600-RECOVER-TEMP-STORAGE.
  8822
  8823* EXEC CICS READQ TS
  8824*        QUEUE (QID)
  8825*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8826*        LENGTH(PI-COMM-LENGTH)
  8827*    END-EXEC.
  8828*    MOVE '*$I    L              ''   #00008606' TO DFHEIV0
  8829     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8831     MOVE X'2020233030303038363036' TO DFHEIV0(25:11)
  8832     CALL 'kxdfhei1' USING DFHEIV0,
  8833           QID,
  8834           PROGRAM-INTERFACE-BLOCK,
  8835           PI-COMM-LENGTH,
  8836           DFHEIV99,
  8837           DFHEIV99,
  8838           DFHEIV99
  8839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8840
  8841
  8842
  8843* EXEC CICS READQ TS
  8844*        QUEUE (QID)
  8845*        INTO  (EL156AI)
  8846*        LENGTH(MAP-LENGTH)
  8847*    END-EXEC.
  8848*    MOVE '*$I    L              ''   #00008612' TO DFHEIV0
  8849     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8851     MOVE X'2020233030303038363132' TO DFHEIV0(25:11)
  8852     CALL 'kxdfhei1' USING DFHEIV0,
  8853           QID,
  8854           EL156AI,
  8855           MAP-LENGTH,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99
  8859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8860
  8861
  8862     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8863
  8864     IF PMTTYPEI NOT = LOW-VALUES
  8865         MOVE AL-UANON           TO PMTTYPEA.
  8866
  8867     IF PAYEEI NOT = LOW-VALUES
  8868         MOVE AL-UANON           TO PAYEEA.
  8869
  8870     IF NOTE1I NOT = LOW-VALUES
  8871         MOVE AL-UANON           TO NOTE1A.
  8872
  8873     IF (RETURNED-FROM = 'EL614')
  8874        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8875     END-IF
  8876*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8877*       AND (PI-EOB-CODES-EXIST = 'Y')
  8878*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 167
* EL156.cbl
  8879*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8880     IF PI-SET-NOTE2-MDT = 'Y'
  8881         MOVE AL-SANON           TO NOTE2A
  8882     END-IF
  8883
  8884     IF OFFLINEI NOT = LOW-VALUES
  8885         MOVE AL-UANON           TO OFFLINEA.
  8886
  8887*    IF GROUPEDI NOT = LOW-VALUES
  8888*        MOVE AL-UANON           TO GROUPEDA.
  8889
  8890*    IF CASHI NOT = LOW-VALUES
  8891*        MOVE AL-UANON           TO CASHA.
  8892
  8893     IF CHECKNOI NOT = LOW-VALUES
  8894         MOVE AL-UANON           TO CHECKNOA.
  8895
  8896     IF HOLDTILI NOT = LOW-VALUES
  8897         MOVE AL-UANON           TO HOLDTILA.
  8898
  8899     IF EPYFROMI NOT = LOW-VALUES
  8900         MOVE AL-UANON           TO EPYFROMA.
  8901
  8902     IF AIGFROMI NOT = LOW-VALUES
  8903         MOVE AL-UANON           TO AIGFROMA.
  8904
  8905     IF EPYTHRUI NOT = LOW-VALUES
  8906         MOVE AL-UANON           TO EPYTHRUA.
  8907
  8908     IF EDAYSI NOT = LOW-VALUES
  8909         MOVE AL-UNNON           TO EDAYSA.
  8910
  8911     IF EPYAMTL NOT = +0
  8912         MOVE AL-UNNON           TO EPYAMTA.
  8913
  8914     IF ERESVL NOT = +0
  8915         MOVE AL-UNNON           TO ERESVA.
  8916
  8917     IF EEXPENSL NOT = +0
  8918         MOVE AL-UNNON           TO EEXPENSA.
  8919
  8920     IF ETYPEI NOT = LOW-VALUES
  8921         MOVE AL-UNNON           TO ETYPEA.
  8922
  8923     IF PROOFDTI NOT = 0
  8924         MOVE AL-UNNON           TO PROOFDTA.
  8925
  8926     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8927        MOVE AL-UANON            TO EOBYNA
  8928     END-IF
  8929     IF CLMFMYNI = 'Y' OR 'N'
  8930        MOVE AL-UANON            TO CLMFMYNA
  8931     END-IF
  8932
  8933     IF SURVYYNI = 'Y' OR 'N'
  8934        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8935           MOVE AL-UANON         TO SURVYYNA
  8936        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 168
* EL156.cbl
  8937     END-IF
  8938
  8939     IF SPRELYNI = 'Y' OR 'N'
  8940        MOVE AL-UANON            TO SPRELYNA
  8941     END-IF
  8942
  8943     .
  8944 0699-EXIT.
  8945      EXIT.
  8946
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 169
* EL156.cbl
  8948 0700-TEST-FOR-CHANGES.
  8949     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8950         MOVE ER-0433            TO EMI-ERROR
  8951         GO TO 0750-FUNCTION-ERROR.
  8952
  8953     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8954
  8955     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8956         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8957         MOVE 'A'                TO PI-PASS-SW
  8958         GO TO 1000-EDIT-DATA.
  8959
  8960     IF PI-FATAL-COUNT NOT = 0
  8961         MOVE ER-0499            TO EMI-ERROR
  8962         GO TO 0750-FUNCTION-ERROR.
  8963
  8964     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8965         MOVE ER-0500            TO EMI-ERROR
  8966         GO TO 0750-FUNCTION-ERROR.
  8967
  8968     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8969        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8970           MOVE ER-0542          TO EMI-ERROR
  8971           MOVE -1               TO EPYAMTL
  8972           GO TO 0750-FUNCTION-ERROR.
  8973
  8974     IF PI-OFFLINE = 'Y'  OR
  8975        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8976        MOVE EIBAID              TO PI-PFKEY-USED
  8977        GO TO 5000-UPDATE.
  8978
  8979     GO TO 6000-BUILD-SCREEN-B.
  8980
  8981 0750-FUNCTION-ERROR.
  8982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8983
  8984     IF ENTERPFL > 0
  8985         MOVE -1                 TO ENTERPFL
  8986         MOVE AL-UNBON           TO ENTERPFA
  8987         GO TO 8200-SEND-DATAONLY
  8988     ELSE
  8989         MOVE -1                 TO ENTERPFL
  8990         MOVE AL-UNNOF           TO ENTERPFA
  8991         GO TO 8200-SEND-DATAONLY.
  8992
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 170
* EL156.cbl
  8994 0800-DELETE-TS.
  8995
  8996* EXEC CICS HANDLE CONDITION
  8997*        QIDERR(0800-EXIT)
  8998*    END-EXEC.
  8999*    MOVE '"$N                   ! % #00008751' TO DFHEIV0
  9000     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9002     MOVE X'2520233030303038373531' TO DFHEIV0(25:11)
  9003     CALL 'kxdfhei1' USING DFHEIV0
  9004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9005
  9006
  9007
  9008* EXEC CICS DELETEQ TS
  9009*        QUEUE(QID)
  9010*    END-EXEC.
  9011*    MOVE '*&                    #   #00008755' TO DFHEIV0
  9012     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9013     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9014     MOVE X'2020233030303038373535' TO DFHEIV0(25:11)
  9015     CALL 'kxdfhei1' USING DFHEIV0,
  9016           QID,
  9017           DFHEIV99
  9018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9019
  9020
  9021 0800-EXIT.
  9022      EXIT.
  9023 0900-GET-DDF-LIMITS.
  9024
  9025     if cm-clp-state = zeros or spaces or low-values
  9026        move cm-state            to cm-clp-state
  9027     end-if
  9028     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9029     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9030     MOVE cm-clp-state           TO ERPDEF-STATE
  9031     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9032     evaluate true
  9033        when (cl-claim-type = 'L' or 'P')
  9034           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9035             and 'CU')
  9036           move 'L'              to erpdef-ben-type
  9037           move pi-lf-benefit-cd to erpdef-ben-code
  9038        when (cl-claim-type not = 'L' and 'P')
  9039           and (pi-ah-benefit-cd not = '00' and '  ')
  9040           move 'A'              to erpdef-ben-type
  9041           move pi-ah-benefit-cd to erpdef-ben-code
  9042        when (cl-claim-type not = 'L' and 'P')
  9043           and (pi-ah-benefit-cd = '00' or '  ')
  9044           move 'L'              to erpdef-ben-type
  9045           move pi-lf-benefit-cd to erpdef-ben-code
  9046        when (cl-claim-type = 'L' or 'P')
  9047           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9048           move 'A'              to erpdef-ben-type
  9049           move pi-ah-benefit-cd to erpdef-ben-code
  9050        when other
  9051           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 171
* EL156.cbl
  9052           move pi-ah-benefit-cd to erpdef-ben-code
  9053     end-evaluate
  9054*    if (cl-claim-type = 'L' or 'P')
  9055*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9056*          and 'CU')
  9057*       move 'L'                 to erpdef-ben-type
  9058*       move pi-lf-benefit-cd    to erpdef-ben-code
  9059*    else
  9060*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9061*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9062*    end-if
  9063     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9064
  9065     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9066
  9067
  9068* EXEC CICS STARTBR
  9069*        DATASET  ('ERPDEF')
  9070*        RIDFLD   (ERPDEF-KEY)
  9071*        GTEQ
  9072*        RESP     (WS-RESPONSE)
  9073*    END-EXEC
  9074     MOVE 'ERPDEF' TO DFHEIV1
  9075     MOVE 0
  9076       TO DFHEIV11
  9077*    MOVE '&,         G          &  N#00008805' TO DFHEIV0
  9078     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9079     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9080     MOVE X'204E233030303038383035' TO DFHEIV0(25:11)
  9081     CALL 'kxdfhei1' USING DFHEIV0,
  9082           DFHEIV1,
  9083           ERPDEF-KEY,
  9084           DFHEIV99,
  9085           DFHEIV11,
  9086           DFHEIV99
  9087     MOVE EIBRESP  TO WS-RESPONSE
  9088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9089
  9090     IF NOT WS-RESP-NORMAL
  9091        GO TO 0900-EXIT
  9092     END-IF
  9093
  9094     .
  9095 0900-READNEXT.
  9096
  9097
  9098* EXEC CICS READNEXT
  9099*       DATASET  ('ERPDEF')
  9100*       SET      (ADDRESS OF PRODUCT-MASTER)
  9101*       RIDFLD   (ERPDEF-KEY)
  9102*       RESP     (WS-RESPONSE)
  9103*    END-EXEC
  9104     MOVE 'ERPDEF' TO DFHEIV1
  9105     MOVE 0
  9106       TO DFHEIV11
  9107*    MOVE '&.S                   )  N#00008819' TO DFHEIV0
  9108     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9109     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 172
* EL156.cbl
  9110     MOVE X'204E233030303038383139' TO DFHEIV0(25:11)
  9111     CALL 'kxdfhei1' USING DFHEIV0,
  9112           DFHEIV1,
  9113           DFHEIV20,
  9114           DFHEIV99,
  9115           ERPDEF-KEY,
  9116           DFHEIV99,
  9117           DFHEIV11,
  9118           DFHEIV99,
  9119           DFHEIV99
  9120     SET ADDRESS OF PRODUCT-MASTER TO
  9121         DFHEIV20
  9122     MOVE EIBRESP  TO WS-RESPONSE
  9123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9124
  9125     IF NOT WS-RESP-NORMAL
  9126        GO TO 0900-ENDBR
  9127     END-IF
  9128
  9129     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9130        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9131           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9132        ELSE
  9133           GO TO 0900-READNEXT
  9134        END-IF
  9135     ELSE
  9136        GO TO 0900-ENDBR
  9137     END-IF
  9138
  9139     IF CM-LOAN-TERM = ZEROS
  9140        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9141     END-IF
  9142
  9143     .
  9144 0900-ENDBR.
  9145
  9146
  9147* EXEC CICS ENDBR
  9148*       DATASET  ('ERPDEF')
  9149*    END-EXEC
  9150     MOVE 'ERPDEF' TO DFHEIV1
  9151     MOVE 0
  9152       TO DFHEIV11
  9153*    MOVE '&2                    $   #00008847' TO DFHEIV0
  9154     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9155     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9156     MOVE X'2020233030303038383437' TO DFHEIV0(25:11)
  9157     CALL 'kxdfhei1' USING DFHEIV0,
  9158           DFHEIV1,
  9159           DFHEIV11,
  9160           DFHEIV99
  9161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9162
  9163     .
  9164 0900-EXIT.
  9165     EXIT.
  9166 1000-EDIT-DATA.
  9167
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 173
* EL156.cbl
  9168     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9169         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9170         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9171
  9172     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9173
  9174     IF NOT MODIFY-CAP
  9175         MOVE ER-0070            TO EMI-ERROR
  9176         MOVE -1                 TO PMTTYPEL
  9177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9178         GO TO 2000-EDIT-DONE.
  9179
  9180     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9181                         '5' AND '6'
  9182         MOVE ER-0420            TO EMI-ERROR
  9183         MOVE -1                 TO PMTTYPEL
  9184         MOVE AL-UABON           TO PMTTYPEA
  9185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9186     ELSE
  9187         MOVE AL-UANON           TO PMTTYPEA.
  9188
  9189*    IF PI-OFFLINE = 'Y'
  9190*       IF PI-GROUPED = 'Y'
  9191*          MOVE ER-1880         TO EMI-ERROR
  9192*          MOVE -1              TO GROUPEDL
  9193*          MOVE AL-UABON        TO GROUPEDA
  9194*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9195*
  9196*    IF GROUPEDL > +0
  9197*       IF PI-GROUPED = 'Y' OR 'N'
  9198*          MOVE AL-UANON TO GROUPEDA
  9199*       ELSE
  9200*          MOVE ER-3140            TO EMI-ERROR
  9201*          MOVE -1                 TO GROUPEDL
  9202*          MOVE AL-UABON           TO GROUPEDA
  9203*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9204*
  9205*    IF CASHL > +0
  9206*       IF PI-CASH = 'Y' OR 'N'
  9207*          MOVE AL-UANON           TO CASHA
  9208*       ELSE
  9209*          MOVE ER-3141            TO EMI-ERROR
  9210*          MOVE -1                 TO CASHL
  9211*          MOVE AL-UABON           TO CASHA
  9212*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9213
  9214     IF LOANNOL > +0
  9215         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9216
  9217 1000-EDIT-PAYEE.
  9218
  9219     IF PI-PAYEE-SEQ NOT NUMERIC
  9220         MOVE ER-0294            TO  EMI-ERROR
  9221         MOVE -1                 TO  PAYEEL
  9222         MOVE AL-UABON           TO  PAYEEA
  9223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9224         GO TO 1000-CONT-EDIT.
  9225
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 174
* EL156.cbl
  9226     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9227                         'E' OR 'O' OR 'Q'
  9228         NEXT SENTENCE
  9229     ELSE
  9230         MOVE ER-0294            TO  EMI-ERROR
  9231         MOVE -1                 TO  PAYEEL
  9232         MOVE AL-UABON           TO  PAYEEA
  9233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9234         GO TO 1000-CONT-EDIT.
  9235
  9236     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9237        (PI-PAYEE-SEQ NOT < '1' AND
  9238         PI-PAYEE-SEQ NOT > '9'))
  9239      OR
  9240        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9241         (PI-PAYEE-SEQ NOT > '9'))
  9242         MOVE AL-UANON            TO PAYEEA
  9243     ELSE
  9244         MOVE ER-0294            TO EMI-ERROR
  9245         MOVE -1                 TO PAYEEL
  9246         MOVE AL-UABON           TO PAYEEA
  9247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9248
  9249     IF PI-COMPANY-ID = 'DMD'
  9250         IF PI-PAYEE-TYPE = 'B' AND
  9251            PI-PAYEE-SEQ NOT = '0'
  9252               MOVE ER-7841            TO EMI-ERROR
  9253               MOVE -1                 TO PAYEEL
  9254               MOVE AL-UABON           TO PAYEEA
  9255               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9256
  9257     IF PI-COMPANY-ID = 'JHL'
  9258         IF PI-PAYEE = 'B0'
  9259             NEXT SENTENCE
  9260           ELSE
  9261
  9262* EXEC CICS HANDLE CONDITION
  9263*            ENDFILE(1950-NOT-FOUND)
  9264*            NOTFND (1950-NOT-FOUND)
  9265*        END-EXEC
  9266*    MOVE '"$''I                  ! & #00008949' TO DFHEIV0
  9267     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9269     MOVE X'2620233030303038393439' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9272         MOVE 'N'                    TO FOUND-TOL-SW
  9273         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9274         MOVE '2'                    TO CNTL-REC-TYPE
  9275         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9276         MOVE +0                     TO CNTL-SEQ-NO
  9277         MOVE 'PROC'                 TO FILE-SWITCH
  9278         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9279         IF PI-PAYEE = 'I1' AND
  9280            APPROVAL-LEVEL-2
  9281             NEXT SENTENCE
  9282           ELSE
  9283         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 175
* EL156.cbl
  9284             MOVE ER-3546        TO EMI-ERROR
  9285             MOVE -1             TO PAYEEL
  9286             MOVE AL-UABON       TO PAYEEA
  9287             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9288
  9289     IF PI-PAYEE-TYPE = 'E'
  9290        IF PI-PMTTYPE = '5' OR '6'
  9291            NEXT SENTENCE
  9292        ELSE
  9293            MOVE ER-3539            TO EMI-ERROR
  9294            MOVE -1                 TO PAYEEL
  9295            MOVE AL-UABON           TO PAYEEA
  9296            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9297
  9298 1000-CONT-EDIT.
  9299
  9300     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9301        IF PI-EPYAMT NOT NEGATIVE
  9302            MOVE ER-0421         TO EMI-ERROR
  9303            MOVE -1              TO OFFLINEL
  9304            MOVE AL-UABON        TO OFFLINEA
  9305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9306        ELSE
  9307            MOVE AL-UANON        TO OFFLINEA.
  9308
  9309     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9310        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9311           CONTINUE
  9312        ELSE
  9313           IF PI-PRINT-EOB-YN = 'S' AND
  9314              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9315                CONTINUE
  9316           ELSE
  9317              MOVE ER-1561       TO EMI-ERROR
  9318              MOVE -1            TO EOBYNL
  9319              MOVE AL-UABON      TO EOBYNA
  9320              PERFORM 9900-ERROR-FORMAT
  9321                                 THRU 9900-EXIT
  9322           END-IF
  9323        END-IF
  9324
  9325        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9326            MOVE ER-1566        TO EMI-ERROR
  9327            MOVE -1             TO CLMFMYNL
  9328            MOVE AL-UABON       TO CLMFMYNA
  9329            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9330        END-IF
  9331
  9332        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9333            MOVE ER-1567        TO EMI-ERROR
  9334            MOVE -1             TO SURVYYNL
  9335            MOVE AL-UABON       TO SURVYYNA
  9336            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9337        END-IF
  9338
  9339        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9340            MOVE ER-1569        TO EMI-ERROR
  9341            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 176
* EL156.cbl
  9342            MOVE AL-UABON       TO SPRELYNA
  9343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9344        END-IF
  9345
  9346     END-IF
  9347     IF PI-EPYAMT IS NEGATIVE
  9348         IF PI-OFFLINE NOT = 'Y'
  9349             MOVE ER-0836        TO  EMI-ERROR
  9350             MOVE -1             TO  OFFLINEL
  9351             MOVE AL-UABON       TO  OFFLINEA
  9352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9353
  9354     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9355        MOVE ER-0872             TO EMI-ERROR
  9356        MOVE -1                  TO PROOFDTL
  9357        MOVE AL-UABON            TO PROOFDTA
  9358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9359     ELSE
  9360        MOVE '4'                TO DC-OPTION-CODE
  9361        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9362        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9363        IF DATE-CONVERSION-ERROR
  9364            MOVE ER-0873        TO EMI-ERROR
  9365            MOVE -1                  TO PROOFDTL
  9366            MOVE AL-UABON            TO PROOFDTA
  9367            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9368        ELSE
  9369            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9370            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9371                MOVE ER-0873    TO EMI-ERROR
  9372                MOVE -1                  TO PROOFDTL
  9373                MOVE AL-UABON            TO PROOFDTA
  9374                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375            END-IF
  9376        END-IF
  9377     END-IF.
  9378
  9379     IF PI-COMPANY-ID = 'DMD'
  9380        IF NOTE1L NOT = ZEROS
  9381            MOVE ER-7844        TO  EMI-ERROR
  9382            MOVE -1             TO  NOTE1L
  9383            MOVE AL-UABON       TO  NOTE1A
  9384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9385
  9386     IF PI-COMPANY-ID = 'DMD'
  9387        IF NOTE2L NOT = ZEROS
  9388          GO TO 1004-DMD-EOB-CHECKS.
  9389
  9390     IF NOTE1L NOT > +0
  9391         GO TO 1005-CHECK-ERRORS.
  9392
  9393     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9394         GO TO 1005-CHECK-ERRORS.
  9395
  9396     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9397         GO TO 1003-HAN-PMT-NOTES.
  9398
  9399     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 177
* EL156.cbl
  9400
  9401     IF WS-PMTOPTION NUMERIC
  9402        IF WS-PMTOPTION > '00' AND < '17'
  9403           NEXT SENTENCE
  9404        ELSE
  9405           MOVE ER-0618          TO EMI-ERROR
  9406           MOVE -1               TO NOTE1L
  9407           MOVE AL-UABON         TO NOTE1A
  9408           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9409     ELSE
  9410        GO TO 1005-CHECK-ERRORS.
  9411
  9412     IF WS-PMTOPTION = '05' AND
  9413        WS-DOCNAME = SPACES
  9414          MOVE ER-0616             TO EMI-ERROR
  9415          MOVE -1                  TO NOTE1L
  9416          MOVE AL-UABON            TO NOTE1A
  9417          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9418
  9419     IF WS-PMTOPTION = '15' OR '16'
  9420
  9421* EXEC CICS BIF DEEDIT
  9422*            FIELD (WS-AMOUNT)
  9423*            LENGTH(08)
  9424*        END-EXEC
  9425     MOVE 08
  9426       TO DFHEIV11
  9427*    MOVE '@"L                   #   #00009101' TO DFHEIV0
  9428     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9429     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9430     MOVE X'2020233030303039313031' TO DFHEIV0(25:11)
  9431     CALL 'kxdfhei1' USING DFHEIV0,
  9432           WS-AMOUNT,
  9433           DFHEIV11
  9434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9435        IF (WS-NUM-AMT = ZEROS) OR
  9436           (WS-AMOUNT NOT NUMERIC)
  9437           MOVE ER-0617          TO EMI-ERROR
  9438           MOVE -1               TO NOTE1L
  9439           MOVE AL-UABON         TO NOTE1A
  9440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441
  9442     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9443
  9444     GO TO 1005-CHECK-ERRORS.
  9445
  9446 1003-HAN-PMT-NOTES.
  9447
  9448     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9449
  9450     IF WS-HAN-PMT-CODE = SPACE
  9451         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9452     ELSE
  9453     IF WS-HAN-PMT-CODE = 'A'
  9454         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9455                                 TO WS-HAN-PMT-NOTE
  9456     ELSE
  9457     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 178
* EL156.cbl
  9458         MOVE ':FINAL PAYMENT / DECEASED'
  9459                                 TO WS-HAN-PMT-NOTE
  9460     ELSE
  9461     IF WS-HAN-PMT-CODE = 'C'
  9462         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9463                                 TO WS-HAN-PMT-NOTE
  9464     ELSE
  9465     IF WS-HAN-PMT-CODE = 'D'
  9466         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9467                                 TO WS-HAN-PMT-NOTE
  9468     ELSE
  9469     IF WS-HAN-PMT-CODE = 'E'
  9470         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9471                                 TO WS-HAN-PMT-NOTE
  9472     ELSE
  9473     IF WS-HAN-PMT-CODE = 'F'
  9474         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9475                                 TO WS-HAN-PMT-NOTE
  9476     ELSE
  9477     IF WS-HAN-PMT-CODE = 'P'
  9478         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9479
  9480     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9481     GO TO 1005-CHECK-ERRORS.
  9482
  9483 1004-DMD-EOB-CHECKS.
  9484
  9485     INITIALIZE PI-AT-EOB-CODES.
  9486
  9487     IF NOTE2I (20:21) > SPACES
  9488         MOVE ER-7845          TO EMI-ERROR
  9489         MOVE -1               TO NOTE2L
  9490         MOVE AL-UABON         TO NOTE2A
  9491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9492         GO TO 1005-CHECK-ERRORS
  9493      ELSE
  9494         MOVE NOTE2I             TO W-EOB-CODES.
  9495
  9496     MOVE +1                     TO W-EOB-NDX.
  9497
  9498 1004-CHECK-EACH-EOB.
  9499
  9500     IF W-EOB-NDX > +5
  9501             OR
  9502        W-EOB-CODE (W-EOB-NDX) = SPACES
  9503         GO TO 1004-CHECK-DUP-EOB.
  9504
  9505     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9506         MOVE ER-0956            TO EMI-ERROR
  9507         MOVE -1                 TO NOTE2L
  9508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9509         GO TO 1005-CHECK-ERRORS.
  9510
  9511     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9512     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9513     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9514     MOVE 'DLO023'               TO PGM-NAME.
  9515
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 179
* EL156.cbl
  9516
  9517* EXEC CICS LINK
  9518*        PROGRAM    (PGM-NAME)
  9519*        COMMAREA   (CD-COMMUNICATION-AREA)
  9520*        LENGTH     (CD-RCRD-LENGTH)
  9521*    END-EXEC.
  9522*    MOVE '."C                   (   #00009186' TO DFHEIV0
  9523     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9524     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9525     MOVE X'2020233030303039313836' TO DFHEIV0(25:11)
  9526     CALL 'kxdfhei1' USING DFHEIV0,
  9527           PGM-NAME,
  9528           CD-COMMUNICATION-AREA,
  9529           CD-RCRD-LENGTH,
  9530           DFHEIV99,
  9531           DFHEIV99,
  9532           DFHEIV99,
  9533           DFHEIV99
  9534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9535
  9536
  9537     IF CD-RETURN-CODE = 'OK'
  9538         GO TO 1004-CONT.
  9539
  9540     MOVE -1                     TO NOTE2L.
  9541
  9542     IF CD-RETURN-CODE = '01'
  9543         MOVE ER-8310            TO EMI-ERROR
  9544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9545         GO TO 1005-CHECK-ERRORS.
  9546
  9547     IF CD-RETURN-CODE = '02'
  9548         MOVE ER-8311            TO EMI-ERROR
  9549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9550         GO TO 1005-CHECK-ERRORS.
  9551
  9552     IF CD-RETURN-CODE = '03'
  9553         MOVE ER-8312            TO EMI-ERROR
  9554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9555         GO TO 1005-CHECK-ERRORS.
  9556
  9557     IF CD-RETURN-CODE = '04'
  9558         MOVE ER-8313            TO EMI-ERROR
  9559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9560         GO TO 1005-CHECK-ERRORS.
  9561
  9562     IF CD-RETURN-CODE = '05'
  9563         MOVE ER-8314            TO EMI-ERROR
  9564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9565         GO TO 1005-CHECK-ERRORS.
  9566
  9567     IF CD-RETURN-CODE = '06'
  9568         MOVE ER-8315            TO EMI-ERROR
  9569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9570         GO TO 1005-CHECK-ERRORS.
  9571
  9572     IF CD-RETURN-CODE = 'E1'
  9573         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 180
* EL156.cbl
  9574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9575         GO TO 1005-CHECK-ERRORS.
  9576
  9577     IF CD-RETURN-CODE = 'N1'
  9578         MOVE ER-8317            TO EMI-ERROR
  9579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9580         GO TO 1005-CHECK-ERRORS.
  9581
  9582 1004-CONT.
  9583     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9584
  9585     ADD +1 TO W-EOB-NDX.
  9586     GO TO 1004-CHECK-EACH-EOB.
  9587
  9588 1004-CHECK-DUP-EOB.
  9589     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9590         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9591                               PI-AT-EOB-CODE (3) OR
  9592                               PI-AT-EOB-CODE (4) OR
  9593                               PI-AT-EOB-CODE (5)))
  9594                  OR
  9595        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9596         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9597                               PI-AT-EOB-CODE (4) OR
  9598                               PI-AT-EOB-CODE (5)))
  9599                  OR
  9600        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9601         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9602                               PI-AT-EOB-CODE (5)))
  9603                  OR
  9604        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9605         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9606            MOVE ER-8000            TO EMI-ERROR
  9607            MOVE AL-UABON           TO NOTE2A
  9608            MOVE -1                 TO NOTE2L
  9609            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9610            GO TO 1005-CHECK-ERRORS.
  9611
  9612 1005-CHECK-ERRORS.
  9613*    IF PI-COMPANY-ID NOT = 'DMD'
  9614        GO TO 1006-CHECK-ERRORS.
  9615
  9616*********  DMD CODE START ******************
  9617*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9618*       GO TO 1006-CHECK-ERRORS.
  9619*
  9620*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9621*
  9622*    COMPUTE W-PAYMENT-TOTAL
  9623*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9624*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9625*               AND
  9626*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9627*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9628*          MOVE ER-0967    TO EMI-ERROR
  9629*          MOVE -1         TO PMTTYPEL
  9630*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9631*
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 181
* EL156.cbl
  9632*    GO TO 1006-CHECK-ERRORS.
  9633*********  DMD CODE END ******************
  9634
  9635 1006-CHECK-ERRORS.
  9636     IF NOT EMI-NO-ERRORS
  9637        GO TO 2000-EDIT-DONE.
  9638
  9639
  9640* EXEC CICS HANDLE CONDITION
  9641*        NOTFND(1950-NOT-FOUND)
  9642*    END-EXEC.
  9643*    MOVE '"$I                   ! '' #00009294' TO DFHEIV0
  9644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9646     MOVE X'2720233030303039323934' TO DFHEIV0(25:11)
  9647     CALL 'kxdfhei1' USING DFHEIV0
  9648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9649
  9650
  9651     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9652     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9653     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9654     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9655     MOVE 'MSTR'                 TO FILE-SWITCH.
  9656
  9657     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9658
  9659     IF PI-COMPANY-ID = 'DMD'
  9660         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9661
  9662     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9663        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9664           MOVE ER-0873    TO EMI-ERROR
  9665           MOVE -1                  TO PROOFDTL
  9666           MOVE AL-UABON            TO PROOFDTA
  9667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9668        END-IF
  9669     END-IF
  9670     if cl-benefit-period = zeros
  9671        move er-1667             to emi-error
  9672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9673     end-if
  9674     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9675     MOVE +95                    TO TRLR-SEQ-NO
  9676
  9677* EXEC CICS READ
  9678*       DATASET  ('ELTRLR')
  9679*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9680*       RIDFLD   (ELTRLR-KEY)
  9681*       RESP     (WS-RESPONSE)
  9682*    END-EXEC
  9683     MOVE 'ELTRLR' TO DFHEIV1
  9684*    MOVE '&"S        E          (  N#00009323' TO DFHEIV0
  9685     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9687     MOVE X'204E233030303039333233' TO DFHEIV0(25:11)
  9688     CALL 'kxdfhei1' USING DFHEIV0,
  9689           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 182
* EL156.cbl
  9690           DFHEIV20,
  9691           DFHEIV99,
  9692           ELTRLR-KEY,
  9693           DFHEIV99,
  9694           DFHEIV99,
  9695           DFHEIV99
  9696     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9697         DFHEIV20
  9698     MOVE EIBRESP  TO WS-RESPONSE
  9699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9700
  9701     if ws-resp-normal
  9702        perform varying s1 from +1 by +1 until
  9703           at-note-error-no (s1) = spaces
  9704           if at-note-error-no (s1) = '1662'
  9705              continue
  9706           else
  9707              move at-note-error-no (s1)
  9708                                 to emi-error
  9709              if at-note-error-no (s1) = '1653'
  9710                 evaluate true
  9711                    when cl-claim-type = 'L'
  9712                       move '  LF  '
  9713                                 to emi-claim-type
  9714                    when cl-claim-type = 'I'
  9715                       move '  IU  '
  9716                                 to emi-claim-type
  9717                    when cl-claim-type = 'A'
  9718                       move '  AH  '
  9719                                 to emi-claim-type
  9720                    when other
  9721                       move ' FMLA '
  9722                                 to emi-claim-type
  9723                 end-evaluate
  9724              end-if
  9725              PERFORM 9900-ERROR-FORMAT
  9726                                 THRU 9900-EXIT
  9727           end-if
  9728        end-perform
  9729     end-if
  9730     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9731         IF PI-PMTTYPE = '5' OR '6'
  9732             NEXT SENTENCE
  9733         ELSE
  9734             MOVE ER-0555             TO EMI-ERROR
  9735             MOVE -1                  TO PMTTYPEL
  9736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9737
  9738     IF CL-LAST-CLOSE-REASON = '2'
  9739         IF CL-CLAIM-STATUS = 'C'
  9740             MOVE ER-0760        TO  EMI-ERROR
  9741             MOVE -1             TO  PMTTYPEL
  9742             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9743
  9744     IF PI-ACTIVITY-CODE = 9
  9745         MOVE ER-3538            TO  EMI-ERROR
  9746         MOVE -1                 TO  PMTTYPEL
  9747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 183
* EL156.cbl
  9748
  9749     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9750         GO TO 1008-READ-CERT.
  9751**********************AIG LOGIC STARTS *********************
  9752     IF CL-CERT-PRIME = 'INCOMPLETE'
  9753         MOVE ER-3540            TO  EMI-ERROR
  9754         MOVE -1                 TO  PMTTYPEL
  9755         MOVE AL-UABON           TO  PMTTYPEA
  9756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9757         GO TO 2000-EDIT-DONE.
  9758
  9759     IF PI-PMTTYPE = '4'
  9760         IF PI-EPYAMT IS NEGATIVE
  9761             IF PI-ECHECKNO-CR = 'CR'
  9762                 NEXT SENTENCE
  9763             ELSE
  9764                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9765
  9766     IF PI-PMTTYPE = '4'
  9767         IF PI-ECHECKNO-CR = 'CR'
  9768             IF PI-EPYAMT IS NEGATIVE
  9769                 NEXT SENTENCE
  9770             ELSE
  9771                 MOVE ER-0834    TO  EMI-ERROR
  9772                 MOVE -1         TO  EPYAMTL
  9773                 MOVE AL-UNBON   TO  EPYAMTA
  9774                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9775
  9776     IF PI-PMTTYPE = '4'
  9777         IF PI-EPYAMT IS NEGATIVE
  9778             IF PI-OFFLINE = 'Y'
  9779                 NEXT SENTENCE
  9780             ELSE
  9781                 MOVE 'Y'        TO  PI-OFFLINE
  9782                                     WS-OFFLINE
  9783                                     OFFLINEO
  9784                 MOVE AL-UANON   TO  OFFLINEA.
  9785
  9786*    IF PI-PMTTYPE = '4'
  9787*        IF PI-EPYAMT IS NEGATIVE
  9788*            IF PI-CASH = 'Y'
  9789*                NEXT SENTENCE
  9790*            ELSE
  9791*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9792*                MOVE AL-UANON   TO  CASHA
  9793*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9794*
  9795*    IF PI-CASH NOT = 'Y' AND 'N'
  9796*         IF PI-OFFLINE = 'Y'  AND
  9797*            PI-ECHECKNO-CR = 'CR'
  9798*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9799*              MOVE AL-UANON     TO  CASHA
  9800*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9801*
  9802*    IF PI-CASH NOT = 'Y' AND 'N'
  9803*        IF PI-PMTTYPE = '5' OR '6'
  9804*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9805*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 184
* EL156.cbl
  9806*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9807*
  9808*    IF PI-CASH NOT = 'Y' AND 'N'
  9809*       IF CL-ASSOCIATES = 'N' OR 'A'
  9810*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9811*           MOVE AL-UANON        TO  CASHA
  9812*       ELSE
  9813*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9814*           MOVE AL-UANON        TO  CASHA.
  9815*
  9816*    IF PI-PMTTYPE = '5' OR '6'
  9817*        IF PI-CASH = 'N'
  9818*            MOVE ER-0819        TO  EMI-ERROR
  9819*            MOVE AL-UANON       TO  CASHA
  9820*            MOVE -1             TO  CASHL
  9821*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822*
  9823*    IF CL-ASSOCIATES = 'N' OR 'A'
  9824*       IF CASHI = 'N'
  9825*        MOVE ER-3537            TO  EMI-ERROR
  9826*        MOVE AL-UANON           TO  CASHA
  9827*        MOVE -1                 TO  CASHL
  9828*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9829
  9830 1007-DEFAULT-AIG-CHECKNO.
  9831
  9832     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9833         MOVE ER-3532            TO  EMI-ERROR
  9834         MOVE -1                 TO  PMTTYPEL
  9835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9836**********************AIG LOGIC ENDS ***********************
  9837
  9838 1008-READ-CERT.
  9839
  9840     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9841     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9842     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9843     MOVE CL-CERT-STATE          TO CERT-STATE.
  9844     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9845     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9846     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9847     MOVE 'CERT'                 TO FILE-SWITCH.
  9848
  9849     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9850
  9851     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9852        MOVE CM-LF-LOAN-EXPIRE-DT
  9853                                 TO WS-EXP-DT PI-EXP-DT
  9854                                    ws-extended-exp-dt
  9855     ELSE
  9856        MOVE CM-AH-LOAN-EXPIRE-DT
  9857                                 TO WS-EXP-DT PI-EXP-DT
  9858                                    ws-extended-exp-dt
  9859     end-if
  9860     if pi-dcc-product-code not = spaces
  9861        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9862        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9863        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 185
* EL156.cbl
  9864                                 THRU 0900-EXIT
  9865        IF PDEF-FOUND
  9866           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9867              (P1 > +8)
  9868              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9869           END-PERFORM
  9870           IF P1 < +9
  9871              MOVE '6'           TO DC-OPTION-CODE
  9872              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9873              MOVE PD-MAX-EXTENSION (P1)
  9874                                 TO DC-ELAPSED-MONTHS
  9875              PERFORM 9700-LINK-DATE-CONVERT
  9876                                 THRU 9700-EXIT
  9877              if no-conversion-error
  9878                 move dc-bin-date-2 to ws-extended-exp-dt
  9879              end-if
  9880           else
  9881              move er-1674       to emi-error
  9882              PERFORM 9900-ERROR-FORMAT
  9883                                 THRU 9900-EXIT
  9884           end-if
  9885        end-if
  9886     end-if
  9887*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9888*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9889
  9890     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9891         MOVE ER-0458            TO EMI-ERROR
  9892         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9893
  9894     IF (CL-INCURRED-DT > WS-EXP-DT)
  9895        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9896        MOVE ER-1677             TO EMI-ERROR
  9897        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9898     END-IF
  9899     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9900     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9901         MOVE ER-0459            TO EMI-ERROR
  9902         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9903
  9904     IF CL-REPORTED-DT = LOW-VALUES
  9905        MOVE ER-0530             TO EMI-ERROR
  9906        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9907
  9908     IF PI-COMPANY-ID = 'NCL'
  9909        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9910            MOVE ER-0770            TO EMI-ERROR
  9911            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9912
  9913     IF PI-COMPANY-ID = 'NCL'
  9914        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9915            MOVE ER-0737            TO EMI-ERROR
  9916            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9917
  9918     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9919         MOVE ER-0768            TO  EMI-ERROR
  9920         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9921
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 186
* EL156.cbl
  9922     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9923         MOVE ER-0769            TO  EMI-ERROR
  9924         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9925
  9926     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9927         GO TO 1020-DO-LIFE-EDITS
  9928     ELSE
  9929         GO TO 1030-DO-AH-EDITS.
  9930
  9931 1010-GENERAL-ERROR.
  9932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9933
  9934     IF EMI-MESSAGE-FORMATTED
  9935         MOVE -1                 TO PMTTYPEL.
  9936
  9937 1010-EXIT.
  9938     EXIT.
  9939
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 187
* EL156.cbl
  9941 1020-DO-LIFE-EDITS.
  9942     IF CM-LF-BENEFIT-CD = '00'
  9943         IF PI-PMTTYPE = '5' OR '6'
  9944             MOVE ER-0658        TO EMI-ERROR
  9945             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9946         ELSE
  9947            if (pi-company-id = 'DCC')
  9948               and (pi-dcc-product-code not = spaces)
  9949               continue
  9950            else
  9951               MOVE ER-1775      TO EMI-ERROR
  9952               PERFORM 1040-PMTTYPE-ERROR
  9953                                 THRU 1040-EXIT
  9954            end-if
  9955         end-if
  9956     end-if
  9957
  9958     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9959     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9960         MOVE ER-0460            TO EMI-ERROR
  9961         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9962
  9963     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9964     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9965     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9966     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9967     MOVE '4'                    TO  CNTL-REC-TYPE.
  9968     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9969     MOVE 'BENE'                 TO  FILE-SWITCH.
  9970     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9971     IF NO-BENEFIT-FOUND
  9972         GO TO 1950-NOT-FOUND.
  9973
  9974     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9975
  9976     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9977         IF PI-PMTTYPE = '4'
  9978             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9979                PI-LF-COVERAGE-TYPE = 'P'
  9980                 NEXT SENTENCE
  9981             ELSE
  9982                 MOVE ER-0461        TO EMI-ERROR
  9983                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9984         ELSE
  9985            NEXT SENTENCE
  9986     ELSE
  9987         IF PI-PMTTYPE = '2'
  9988            IF NOT CM-O-B-COVERAGE
  9989              AND CM-LF-CURRENT-STATUS = '7'
  9990                MOVE ER-0462     TO EMI-ERROR
  9991                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9992
  9993     IF PI-PMTTYPE = '2'
  9994         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9995            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9996             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9997             MOVE ER-0730            TO  EMI-ERROR
  9998             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 188
* EL156.cbl
  9999             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10000
 10001     IF PI-PMTTYPE = '2'
 10002         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10003            PI-LF-COVERAGE-TYPE = 'P'
 10004             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10005                 MOVE ER-0462    TO  EMI-ERROR
 10006                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10007
 10008     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10009       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10010         MOVE ER-0466            TO EMI-ERROR
 10011         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10012
 10013     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10014         IF PI-PMTTYPE = '3'
 10015             MOVE 0436           TO EMI-ERROR
 10016             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10017             GO TO 1045-EDIT-PAYEE-ADDR
 10018         ELSE
 10019             GO TO 1045-EDIT-PAYEE-ADDR.
 10020
 10021     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10022        PI-LF-COVERAGE-TYPE = 'P'
 10023         IF PI-PMTTYPE = '3'
 10024             MOVE ER-0436          TO  EMI-ERROR
 10025             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10026         ELSE
 10027             NEXT SENTENCE
 10028     ELSE
 10029         IF PI-PMTTYPE = '1' OR '3'
 10030             MOVE ER-0436            TO EMI-ERROR
 10031             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10032*
 10033     IF PI-COMPANY-ID = 'CID' AND
 10034        CL-CERT-STATE = 'SC'  AND
 10035        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10036           MOVE ER-0879    TO  EMI-ERROR
 10037           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10038           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10039     END-IF.
 10040     IF PI-COMPANY-ID = 'AHL'
 10041        evaluate true
 10042           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10043              MOVE ER-0879       TO  EMI-ERROR
 10044              PERFORM 1040-PMTTYPE-ERROR
 10045                                 THRU 1040-EXIT
 10046              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10047           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10048                 '6D' OR '6H' OR '6R'
 10049              MOVE ER-0879       TO  EMI-ERROR
 10050              PERFORM 1040-PMTTYPE-ERROR
 10051                                 THRU 1040-EXIT
 10052              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10053           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10054              MOVE ER-0879       TO  EMI-ERROR
 10055              PERFORM 1040-PMTTYPE-ERROR
 10056                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 189
* EL156.cbl
 10057              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10058        end-evaluate
 10059     END-IF
 10060     GO TO 1045-EDIT-PAYEE-ADDR.
 10061
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 190
* EL156.cbl
 10063 1030-DO-AH-EDITS.
 10064     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10065     IF CM-AH-BENEFIT-CD = '00'
 10066         IF PI-PMTTYPE = '5' OR '6'
 10067             MOVE ER-0658        TO EMI-ERROR
 10068             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10069         ELSE
 10070             MOVE ER-1775        TO EMI-ERROR
 10071             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10072
 10073     IF CL-TOTAL-PAID-AMT = ZEROS
 10074         IF PI-PMTTYPE = '4'
 10075             MOVE ER-0438        TO EMI-ERROR
 10076             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10077
 10078     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10079         IF PI-PMTTYPE = '3'
 10080             MOVE ER-0463        TO EMI-ERROR
 10081             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10082         ELSE
 10083             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10084              AND CM-LF-CURRENT-STATUS = '7'
 10085                 MOVE ER-0465    TO EMI-ERROR
 10086                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10087
 10088     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10089         IF PI-PMTTYPE = '3'
 10090             MOVE ER-0464        TO EMI-ERROR
 10091             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10092         ELSE
 10093             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10094                 MOVE ER-0469    TO EMI-ERROR
 10095                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10096
 10097     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10098         IF PI-PMTTYPE = '3'
 10099             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10100                 MOVE ER-0467    TO EMI-ERROR
 10101                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10102             ELSE
 10103                 NEXT SENTENCE
 10104         ELSE
 10105             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10106                 MOVE ER-0468    TO EMI-ERROR
 10107                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10108
 10109     GO TO 1045-EDIT-PAYEE-ADDR.
 10110
 10111 1040-PMTTYPE-ERROR.
 10112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10113
 10114     IF EMI-MESSAGE-FORMATTED
 10115         MOVE -1                 TO PMTTYPEL
 10116         MOVE AL-UABON           TO PMTTYPEA.
 10117
 10118 1040-EXIT.
 10119     EXIT.
 10120
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 191
* EL156.cbl
 10122 1045-EDIT-PAYEE-ADDR.
 10123
 10124     IF PI-OFFLINE = 'N' AND
 10125        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10126           < PI-PAYEE-SEQ-NUM)
 10127        OR
 10128         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10129         (PI-PAYEE-TYPE = 'B')                 AND
 10130         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10131        OR
 10132         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10133           < PI-PAYEE-SEQ-NUM)
 10134        OR
 10135         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10136           < PI-PAYEE-SEQ-NUM)
 10137        OR
 10138         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10139           < PI-PAYEE-SEQ-NUM)
 10140        OR
 10141         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10142           < PI-PAYEE-SEQ-NUM)
 10143        OR
 10144         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10145           < PI-PAYEE-SEQ-NUM))
 10146             MOVE ER-0437        TO EMI-ERROR
 10147             MOVE -1             TO PAYEEL
 10148             MOVE AL-UABON       TO PAYEEA
 10149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10150
 10151     IF PI-OFFLINE    = 'N' AND
 10152        PI-PAYEE-TYPE = 'B' AND
 10153        PI-PAYEE-SEQ  = '0'
 10154         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10155         IF BENE-FOUND-SW = 'N'
 10156             MOVE ER-0437        TO EMI-ERROR
 10157             MOVE -1             TO PAYEEL
 10158             MOVE AL-UABON       TO PAYEEA
 10159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10160
 10161     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10162        IF PI-OFFLINE    = 'N'  AND
 10163           PI-PAYEE-TYPE = 'B'  AND
 10164           PI-PAYEE-SEQ  = '9'
 10165             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10166             IF BENE-FOUND-SW = 'N'
 10167                MOVE ER-0437        TO EMI-ERROR
 10168                MOVE -1             TO PAYEEL
 10169                MOVE AL-UABON       TO PAYEEA
 10170                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10171
 10172*    IF PI-COMPANY-ID = 'CRI'
 10173*        IF CL-CLAIM-TYPE = 'L'
 10174*            MOVE 'N'                TO  WS-GROUPED
 10175*                                        PI-GROUPED
 10176*                                        GROUPEDI
 10177*            MOVE AL-UANON           TO  GROUPEDA
 10178*            GO TO 1050-EDIT-CHECK-NO
 10179*        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 192
* EL156.cbl
 10180*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10181*            IF WS-GROUP-1 = 'C'
 10182*                NEXT SENTENCE
 10183*            ELSE
 10184*                MOVE 'N'            TO  WS-GROUPED
 10185*                                        PI-GROUPED
 10186*                                        GROUPEDI
 10187*                MOVE AL-UANON       TO  GROUPEDA
 10188*                GO TO 1050-EDIT-CHECK-NO.
 10189
 10190*     IF PI-GROUPED = 'Y'
 10191*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10192*           NEXT SENTENCE
 10193*        ELSE
 10194*           MOVE ER-0437        TO EMI-ERROR
 10195*           MOVE -1             TO PAYEEL
 10196**02180            MOVE AL-UABON       TO PAYEEA
 10197*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10198*
 10199*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10200*        (PI-GROUPED    = ' ')
 10201*        NEXT SENTENCE
 10202*     ELSE
 10203*
 10204     GO TO 1050-EDIT-CHECK-NO.
 10205*     IF PI-COMPANY-ID = 'CRI'
 10206*        MOVE 'N'           TO GROUPEDI
 10207*                              PI-GROUPED
 10208*                              WS-GROUPED
 10209*        MOVE AL-UANON      TO GROUPEDA.
 10210*
 10211*     IF PI-COMPANY-ID = 'CRI'
 10212*        IF PI-PAYEE-TYPE = 'B'
 10213*           IF BENE-FOUND-SW = 'Y'
 10214*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10215*                 MOVE 'Y'           TO GROUPEDI
 10216*                                       PI-GROUPED
 10217*                                       WS-GROUPED
 10218*                 MOVE AL-UANON      TO GROUPEDA
 10219*              ELSE
 10220*                 NEXT SENTENCE
 10221*           ELSE
 10222*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10223*              IF BENE-FOUND-SW = 'Y'
 10224*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10225*                    MOVE 'Y'      TO GROUPEDI
 10226*                                     PI-GROUPED
 10227*                                     WS-GROUPED
 10228*                    MOVE AL-UANON TO GROUPEDA.
 10229*
 10230
 10231     IF PI-COMPANY-ID NOT = 'CRI'
 10232        GO TO 1050-EDIT-CHECK-NO.
 10233
 10234*************** CRI CODE START ******************
 10235     IF PI-PAYEE-TYPE NOT = 'A'
 10236        GO TO 1050-EDIT-CHECK-NO.
 10237
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 193
* EL156.cbl
 10238     MOVE LOW-VALUES             TO ERACCT-KEY.
 10239     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10240     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10241     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10242     MOVE PI-STATE               TO ACCT-STATE.
 10243     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10244     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10245     MOVE 'ACCT'                 TO FILE-SWITCH.
 10246
 10247     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10248     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10249
 10250
 10251* EXEC CICS HANDLE CONDITION
 10252*         NOTFND   (1950-NOT-FOUND)
 10253*         ENDFILE  (1950-NOT-FOUND)
 10254*    END-EXEC.
 10255*    MOVE '"$I''                  ! ( #00009879' TO DFHEIV0
 10256     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10258     MOVE X'2820233030303039383739' TO DFHEIV0(25:11)
 10259     CALL 'kxdfhei1' USING DFHEIV0
 10260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10261
 10262
 10263
 10264* EXEC CICS STARTBR
 10265*         DATASET   ('ERACCT')
 10266*         RIDFLD    (ERACCT-KEY)
 10267*         GTEQ
 10268*    END-EXEC.
 10269     MOVE 'ERACCT' TO DFHEIV1
 10270     MOVE 0
 10271       TO DFHEIV11
 10272*    MOVE '&,         G          &   #00009884' TO DFHEIV0
 10273     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10275     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0,
 10277           DFHEIV1,
 10278           ERACCT-KEY,
 10279           DFHEIV99,
 10280           DFHEIV11,
 10281           DFHEIV99
 10282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10283
 10284
 10285 1046-READNEXT-ERACCT.
 10286
 10287
 10288* EXEC CICS READNEXT
 10289*         DATASET   ('ERACCT')
 10290*         RIDFLD    (ERACCT-KEY)
 10291*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10292*    END-EXEC.
 10293     MOVE 'ERACCT' TO DFHEIV1
 10294     MOVE 0
 10295       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 194
* EL156.cbl
 10296*    MOVE '&.S                   )   #00009892' TO DFHEIV0
 10297     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10298     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10299     MOVE X'2020233030303039383932' TO DFHEIV0(25:11)
 10300     CALL 'kxdfhei1' USING DFHEIV0,
 10301           DFHEIV1,
 10302           DFHEIV20,
 10303           DFHEIV99,
 10304           ERACCT-KEY,
 10305           DFHEIV99,
 10306           DFHEIV11,
 10307           DFHEIV99,
 10308           DFHEIV99
 10309     SET ADDRESS OF ACCOUNT-MASTER TO
 10310         DFHEIV20
 10311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10312
 10313
 10314     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10315        IF WS-ERACCT-HOLD-RECORD = SPACES
 10316           GO TO 1950-NOT-FOUND
 10317        ELSE
 10318           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10319           GO TO 1048-CONTINUE.
 10320
 10321     IF ACCT-EXP-DT = HIGH-VALUES
 10322        NEXT SENTENCE
 10323     ELSE
 10324        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10325        GO TO 1046-READNEXT-ERACCT.
 10326
 10327 1048-CONTINUE.
 10328
 10329*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10330*       MOVE 'Y'                 TO GROUPEDI
 10331*                                   PI-GROUPED
 10332*                                   WS-GROUPED
 10333*       MOVE AL-UANON            TO GROUPEDA.
 10334*************** CRI CODE END ******************
 10335
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 195
* EL156.cbl
 10337 1050-EDIT-CHECK-NO.
 10338
 10339     IF PI-OFFLINE = 'Y'
 10340         IF PI-ECHECKNO = SPACES
 10341              MOVE ER-0439        TO EMI-ERROR
 10342              GO TO 1090-CHECK-NO-ERROR
 10343           ELSE
 10344*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10345*           IF PI-ECHECKNO-N = 'N' AND
 10346*              PI-CASH       = 'Y'
 10347*                MOVE ER-3535        TO EMI-ERROR
 10348*                GO TO 1090-CHECK-NO-ERROR
 10349*             ELSE
 10350*                MOVE AL-UANON    TO CHECKNOA
 10351*                GO TO 1100-EDIT-HOLDTIL
 10352*         ELSE
 10353            MOVE AL-UANON    TO CHECKNOA
 10354            GO TO 1100-EDIT-HOLDTIL.
 10355
 10356     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10357     MOVE '6'                    TO CNTL-REC-TYPE.
 10358
 10359     IF CONTROL-IS-ACTUAL-CARRIER
 10360         MOVE PI-CARRIER         TO WS-CARR
 10361     ELSE
 10362         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10363
 10364     IF PI-COMPANY-ID = 'FIA'
 10365         MOVE PI-CARRIER         TO WS-CARR.
 10366
 10367     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10368     MOVE 0                      TO CNTL-SEQ-NO.
 10369     MOVE 'CARR'                 TO FILE-SWITCH.
 10370
 10371     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10372
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 196
* EL156.cbl
 10374     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10375         GO TO 1051-EDIT-CHECKNO-CONT.
 10376
 10377**********************AIG LOGIC STARTS**********************
 10378     IF PI-ECHECKNO = SPACES
 10379         IF CHECK-NO-MANUAL
 10380             MOVE ER-0441        TO EMI-ERROR
 10381             GO TO 1090-CHECK-NO-ERROR
 10382         ELSE
 10383             MOVE AL-UANOF       TO CHECKNOA
 10384             GO TO 1100-EDIT-HOLDTIL.
 10385
 10386     IF PI-ECHECKNO NOT = SPACES
 10387         IF CHECK-NO-MANUAL
 10388             MOVE AL-UANON       TO CHECKNOA
 10389             GO TO 1100-EDIT-HOLDTIL.
 10390
 10391     IF PI-ECHECKNO-CR = 'CR'
 10392        IF PI-OFFLINE = 'Y'
 10393            MOVE AL-UANON       TO CHECKNOA
 10394            GO TO 1100-EDIT-HOLDTIL
 10395        ELSE
 10396            MOVE ER-3534        TO EMI-ERROR
 10397            GO TO 1090-CHECK-NO-ERROR.
 10398
 10399     IF PI-ECHECKNO-N = 'N'
 10400        IF PI-CASH = 'N'
 10401            MOVE AL-UANON       TO CHECKNOA
 10402            GO TO 1100-EDIT-HOLDTIL
 10403        ELSE
 10404            MOVE ER-3535          TO EMI-ERROR
 10405            GO TO 1090-CHECK-NO-ERROR.
 10406
 10407     MOVE ER-0442        TO EMI-ERROR
 10408     GO TO 1090-CHECK-NO-ERROR.
 10409**********************AIG LOGIC ENDS************************
 10410
 10411 1051-EDIT-CHECKNO-CONT.
 10412
 10413     IF PI-COMPANY-ID = 'DMD'
 10414        IF PI-ECHECKNO NOT = SPACES
 10415           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10416              MOVE ER-0442        TO EMI-ERROR
 10417              GO TO 1090-CHECK-NO-ERROR
 10418            ELSE
 10419              GO TO 1100-EDIT-HOLDTIL
 10420          ELSE
 10421           GO TO 1100-EDIT-HOLDTIL.
 10422
 10423     IF PI-ECHECKNO = SPACES
 10424         IF CHECK-NO-MANUAL
 10425             MOVE ER-0441        TO EMI-ERROR
 10426             GO TO 1090-CHECK-NO-ERROR
 10427         ELSE
 10428             MOVE AL-UANOF       TO CHECKNOA
 10429             GO TO 1100-EDIT-HOLDTIL
 10430     ELSE
 10431         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 197
* EL156.cbl
 10432             MOVE AL-UANON       TO CHECKNOA
 10433             GO TO 1100-EDIT-HOLDTIL
 10434         ELSE
 10435             MOVE ER-0442        TO EMI-ERROR
 10436             GO TO 1090-CHECK-NO-ERROR.
 10437
 10438 1090-CHECK-NO-ERROR.
 10439     MOVE -1                     TO CHECKNOL.
 10440     MOVE AL-UABON               TO CHECKNOA.
 10441     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10442
 10443     GO TO 2000-EDIT-DONE.
 10444
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 198
* EL156.cbl
 10446 1100-EDIT-HOLDTIL.
 10447     MOVE AL-UANON               TO HOLDTILA.
 10448
 10449     IF PI-HOLDTIL = ZEROS
 10450        IF PI-OFFLINE = 'Y'
 10451           MOVE ER-0572          TO EMI-ERROR
 10452           GO TO 1105-HOLDTIL-ERROR
 10453        ELSE
 10454           GO TO 1110-EDIT-PAID-FROM.
 10455
 10456     MOVE '4'                    TO DC-OPTION-CODE.
 10457     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10458     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10459
 10460     IF DATE-CONVERSION-ERROR
 10461         MOVE ER-0446            TO EMI-ERROR
 10462         GO TO 1105-HOLDTIL-ERROR
 10463     END-IF
 10464     IF PI-OFFLINE = 'Y'
 10465        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10466           MOVE ER-0446            TO EMI-ERROR
 10467           GO TO 1105-HOLDTIL-ERROR
 10468        END-IF
 10469     END-IF
 10470
 10471     IF PI-OFFLINE = 'Y'
 10472        GO TO 1110-EDIT-PAID-FROM.
 10473
 10474     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10475     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10476     MOVE '1'                    TO DC-OPTION-CODE.
 10477     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10478
 10479     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10480         MOVE ER-0447            TO EMI-ERROR
 10481         GO TO 1105-HOLDTIL-ERROR.
 10482
 10483     GO TO 1110-EDIT-PAID-FROM.
 10484
 10485 1105-HOLDTIL-ERROR.
 10486     MOVE -1                     TO HOLDTILL.
 10487     MOVE AL-UNBON               TO HOLDTILA.
 10488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10489
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 199
* EL156.cbl
 10491 1110-EDIT-PAID-FROM.
 10492     MOVE AL-UANON               TO EPYFROMA.
 10493
 10494     IF PI-EPYFROM = ZEROS
 10495         GO TO 1120-CALCULATE-PAID-FROM.
 10496
 10497     IF PI-PMTTYPE = '5' OR '6'
 10498         MOVE ER-0448            TO EMI-ERROR
 10499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10500         MOVE AL-UNBON           TO EPYFROMA
 10501         MOVE -1                 TO EPYFROML
 10502         GO TO 1150-EDIT-PAID-THRU.
 10503
 10504     MOVE '4'                    TO DC-OPTION-CODE.
 10505     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10506     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10507
 10508     IF DATE-CONVERSION-ERROR
 10509         MOVE ER-0449            TO EMI-ERROR
 10510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10511         MOVE AL-UNBON           TO EPYFROMA
 10512         MOVE -1                 TO EPYFROML
 10513     ELSE
 10514         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10515
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 200
* EL156.cbl
 10517 1120-CALCULATE-PAID-FROM.
 10518     IF PI-PMTTYPE = '5' OR '6'
 10519         GO TO 1150-EDIT-PAID-THRU.
 10520
 10521*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10522*       IF PI-PMTTYPE = '4'
 10523*         GO TO 1150-EDIT-PAID-THRU.
 10524
 10525     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10526         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10527         MOVE ' '                TO DC-OPTION-CODE
 10528         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10529         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10530         GO TO 1145-TEST-PAID-FROM.
 10531
 10532     IF PI-PMTTYPE = '4'
 10533        GO TO 1150-EDIT-PAID-THRU.
 10534
 10535     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10536     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10537     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10538     MOVE '5'                    TO CNTL-REC-TYPE.
 10539     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10540     MOVE 'BENE'                 TO FILE-SWITCH.
 10541
 10542     IF WS-BEN-CD = ZEROS
 10543         GO TO 1950-NOT-FOUND.
 10544
 10545     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10546
 10547     IF NO-BENEFIT-FOUND
 10548         GO TO 1950-NOT-FOUND.
 10549
 10550     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10551     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10552
 10553     IF PI-BEN-DAYS NOT NUMERIC
 10554        MOVE ZEROS               TO PI-BEN-DAYS.
 10555
 10556     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10557
 10558     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10559        (CL-TOTAL-PAID-AMT > ZEROS)
 10560         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10561         MOVE '6'                 TO DC-OPTION-CODE
 10562         MOVE +0                  TO DC-ELAPSED-MONTHS
 10563         MOVE +1                  TO DC-ELAPSED-DAYS
 10564         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10565         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10566         GO TO 1145-TEST-PAID-FROM.
 10567
 10568******************************************************************
 10569****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10570****** SPECIAL ENTERED DATE.
 10571******************************************************************
 10572
 10573     IF PI-AIGFROM = ZEROS
 10574         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 201
* EL156.cbl
 10575
 10576     MOVE AL-UANON TO AIGFROMA.
 10577
 10578     MOVE '4'                    TO DC-OPTION-CODE.
 10579     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10580     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10581
 10582     IF DATE-CONVERSION-ERROR
 10583         MOVE ER-0449            TO EMI-ERROR
 10584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10585         MOVE AL-UNBON           TO AIGFROMA
 10586         MOVE -1                 TO AIGFROML
 10587         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10588     ELSE
 10589         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10590         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10591
 10592     GO TO 1140-CONTINUE-PAID-FROM.
 10593
 10594 1130-CONTINUE-PAID-FROM.
 10595
 10596     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10597        (CL-TOTAL-PAID-AMT = ZEROS)
 10598           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10599
 10600 1140-CONTINUE-PAID-FROM.
 10601
 10602     IF PI-BEN-TYPE = 'R'
 10603         IF PI-BEN-DAYS = ZEROS
 10604             NEXT SENTENCE
 10605         ELSE
 10606         IF PI-COMPANY-ID NOT = 'DMD'
 10607             SUBTRACT 1 FROM PI-BEN-DAYS.
 10608
 10609     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10610
 10611     IF PI-COMPANY-ID = 'DMD'
 10612         MOVE -1                 TO DC-ELAPSED-DAYS
 10613         MOVE +0                 TO DC-ELAPSED-MONTHS
 10614         MOVE '6'                TO DC-OPTION-CODE
 10615         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10616         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10617         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10618                               REMAINDER DC-ELAPSED-DAYS
 10619      ELSE
 10620         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10621         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10622
 10623     MOVE '6'                    TO DC-OPTION-CODE.
 10624     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10625     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10626
 10627     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10628
 10629     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10630         MOVE ER-0541            TO EMI-ERROR
 10631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10632         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 202
* EL156.cbl
 10633         MOVE AL-UNBON           TO EPYFROMA.
 10634
 10635     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10636        (PI-BENEFIT-SAVE = '60E')
 10637        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10638           (CL-TOTAL-PAID-AMT = ZEROS)
 10639             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10640             MOVE 30                  TO DC-ELAPSED-DAYS
 10641             MOVE +0                  TO DC-ELAPSED-MONTHS
 10642             MOVE '6'                 TO DC-OPTION-CODE
 10643             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10644
 10645     IF PI-BEN-TYPE = 'R'
 10646         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10647     ELSE
 10648         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10649         IF WS-SV-EPYFROM = LOW-VALUES
 10650            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10651
 10652     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10653         IF WS-USE-AIG-PAYFROM   OR
 10654            WS-AIG-RECALC-PAYFROM
 10655              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10656                                      DC-BIN-DATE-1
 10657              MOVE ' '            TO  DC-OPTION-CODE
 10658              MOVE +0             TO  DC-ELAPSED-MONTHS
 10659                                      DC-ELAPSED-DAYS
 10660              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10661              IF NO-CONVERSION-ERROR
 10662                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10663
 10664     IF PI-CPYFROM < CL-INCURRED-DT
 10665        MOVE -1                  TO EPYFROML
 10666        MOVE ER-3542             TO EMI-ERROR
 10667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10668
 10669     IF CM-ENTRY-DT < CL-INCURRED-DT
 10670        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10671        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10672        MOVE +0                     TO DC-ELAPSED-DAYS
 10673        MOVE +0                     TO DC-ELAPSED-MONTHS
 10674        MOVE '1'                    TO DC-OPTION-CODE
 10675        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10676        ELSE
 10677        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10678
 10679     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10680         NEXT SENTENCE
 10681     ELSE
 10682         IF DC-ELAPSED-MONTHS < 2
 10683             MOVE ER-3255        TO EMI-ERROR
 10684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10685
 10686 1145-TEST-PAID-FROM.
 10687     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10688         GO TO 1150-EDIT-PAID-THRU.
 10689
 10690     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 203
* EL156.cbl
 10691         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10692         MOVE ' '                TO DC-OPTION-CODE
 10693         MOVE +0                 TO DC-ELAPSED-MONTHS
 10694                                    DC-ELAPSED-DAYS
 10695         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10696         IF NO-CONVERSION-ERROR
 10697             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10698         ELSE
 10699             MOVE SPACES             TO EMI-DATE-FIELD.
 10700
 10701     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10702         IF CL-TOTAL-PAID-AMT = ZEROS
 10703             MOVE ER-3543            TO EMI-ERROR
 10704             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10705             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10706             IF EMI-MESSAGE-FORMATTED
 10707                MOVE -1             TO EPYFROML
 10708                MOVE AL-UNBON       TO EPYFROMA
 10709             ELSE
 10710                NEXT SENTENCE
 10711         ELSE
 10712             MOVE ER-0452            TO EMI-ERROR
 10713             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10715             IF EMI-MESSAGE-FORMATTED
 10716                MOVE -1             TO EPYFROML
 10717                MOVE AL-UNBON       TO EPYFROMA.
 10718
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 204
* EL156.cbl
 10720 1150-EDIT-PAID-THRU.
 10721
 10722     MOVE AL-UANON               TO EPYTHRUA.
 10723
 10724     IF PI-EPYTHRU = ZEROS
 10725         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10726             GO TO 1200-EDIT-FIND-TOLERANCES
 10727         ELSE
 10728            IF (PI-PMTTYPE = '3') OR
 10729               (PI-PMTTYPE = '2' AND
 10730                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10731               GO TO 1152-CHECK-TYPE
 10732            ELSE
 10733               MOVE ER-0473      TO EMI-ERROR
 10734               GO TO 1170-PAID-THRU-FATAL-ERROR
 10735     ELSE
 10736         IF PI-PMTTYPE = '5' OR '6'
 10737             MOVE ER-0474        TO EMI-ERROR
 10738             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10739
 10740     MOVE '4'                    TO DC-OPTION-CODE.
 10741     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10742     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10743
 10744     IF DATE-CONVERSION-ERROR
 10745         MOVE ER-0475            TO EMI-ERROR
 10746         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10747
 10748     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10749
 10750     IF PI-COMPANY-ID = 'DMD'
 10751         IF PI-PMTTYPE NOT = '2'
 10752                 AND
 10753            WS-EXP-DT > WS-SV-EPYTHRU
 10754             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10755             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10756             MOVE '1'              TO DC-OPTION-CODE
 10757             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10758             IF DATE-CONVERSION-ERROR
 10759                 MOVE ER-0944      TO EMI-ERROR
 10760                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10761             ELSE
 10762                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10763                    DC-ELAPSED-DAYS   = 1
 10764                     MOVE ER-0945  TO EMI-ERROR
 10765                     MOVE -1       TO EPYTHRUL
 10766                     MOVE AL-UABON TO EPYTHRUA
 10767                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10768
 10769     IF PI-PMTTYPE = '4'
 10770         NEXT SENTENCE
 10771     ELSE
 10772         IF WS-SV-EPYTHRU = WS-EXP-DT
 10773             IF PI-PMTTYPE NOT = '2' AND '3'
 10774                 MOVE ER-3541    TO EMI-ERROR
 10775                 MOVE -1         TO PMTTYPEL
 10776                 MOVE AL-UABON   TO PMTTYPEA
 10777                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 205
* EL156.cbl
 10778
 10779     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10780         MOVE ER-0501            TO EMI-ERROR
 10781         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10782
 10783     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10784        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10785*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10786*              MOVE ER-0540         TO EMI-ERROR
 10787*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10788*              MOVE -1              TO EPYTHRUL
 10789*              MOVE AL-UNBON        TO EPYTHRUA
 10790*          ELSE
 10791*          IF PI-COMPANY-ID = 'DMD'
 10792*              MOVE ER-7540         TO EMI-ERROR
 10793*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10794*              MOVE -1              TO EPYTHRUL
 10795*              MOVE AL-UNBON        TO EPYTHRUA
 10796*          ELSE
 10797               IF PI-PMTTYPE NOT = '2' AND '3'
 10798                  IF PI-COMPANY-ID = '???'
 10799                      MOVE ER-7540  TO EMI-ERROR
 10800                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801                      MOVE -1       TO EPYTHRUL
 10802                      MOVE AL-UNBON TO EPYTHRUA
 10803                  ELSE
 10804                      MOVE ER-0540  TO EMI-ERROR
 10805                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806                      MOVE -1       TO EPYTHRUL
 10807                      MOVE AL-UNBON TO EPYTHRUA.
 10808
 10809     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10810            OR
 10811        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10812         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10813            OR
 10814        (PI-CPYFROM NOT = LOW-VALUES AND
 10815         PI-CPYFROM < CL-PAID-THRU-DT)
 10816        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10817
 10818 1152-CHECK-TYPE.
 10819     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10820        OR (PI-PMTTYPE = '5' OR '6')
 10821         GO TO 1160-EDIT-PAID-THRU-AH.
 10822
 10823 1155-EDIT-PAID-THRU-LIFE.
 10824     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10825     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10826     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10827     MOVE '4'                    TO CNTL-REC-TYPE.
 10828     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10829     MOVE 'BENE'                 TO FILE-SWITCH.
 10830
 10831     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10832
 10833     IF NO-BENEFIT-FOUND
 10834         GO TO 1950-NOT-FOUND.
 10835
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 206
* EL156.cbl
 10836     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10837
 10838     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10839
 10840     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10841        PI-LF-COVERAGE-TYPE = 'P'
 10842         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10843         GO TO 1200-EDIT-FIND-TOLERANCES.
 10844
 10845     IF PI-EPYTHRU = ZEROS
 10846        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10847
 10848     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10849         MOVE ER-0476            TO EMI-ERROR
 10850         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10851
 10852     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10853*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10854     move cl-critical-period    to dc-elapsed-months
 10855     MOVE +0                    TO DC-ELAPSED-DAYS.
 10856     MOVE '6'                   TO DC-OPTION-CODE.
 10857     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10858
 10859     IF (NO-CONVERSION-ERROR AND
 10860         WS-SPECIAL-CALC-CD = 'C')
 10861        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10862            MOVE ER-0657 TO EMI-ERROR
 10863            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10864
 10865     IF PI-COMPANY-ID = 'NCL'
 10866         IF WS-SPECIAL-CALC-CD = 'C' AND
 10867            cl-critical-period = zeros
 10868*           CM-LF-CRITICAL-PERIOD = +0
 10869             MOVE ER-0844       TO EMI-ERROR
 10870             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10871
 10872     GO TO 1200-EDIT-FIND-TOLERANCES.
 10873
 10874 1160-EDIT-PAID-THRU-AH.
 10875     IF PI-EPYTHRU = ZEROS
 10876        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10877                                    WS-SV-EPYTHRU
 10878     ELSE
 10879        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10880
 10881     IF WS-SV-EPYTHRU < PI-CPYFROM
 10882         MOVE ER-0508            TO EMI-ERROR
 10883         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10884
 10885     perform 7975-read-acct      thru 7975-exit
 10886     move zeros                  to pi-max-ext
 10887     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10888        PERFORM 0900-GET-DDF-LIMITS
 10889                                 THRU 0900-EXIT
 10890        IF PDEF-FOUND
 10891           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10892              (P1 > +8)
 10893              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 207
* EL156.cbl
 10894           END-PERFORM
 10895           IF P1 < +9
 10896              MOVE PD-MAX-extension (P1)
 10897                                 TO pi-max-ext
 10898           else
 10899              move er-1674       to emi-error
 10900              PERFORM 9900-ERROR-FORMAT
 10901                                 THRU 9900-EXIT
 10902           END-IF
 10903        else
 10904           move er-1672          to emi-error
 10905           PERFORM 9900-ERROR-FORMAT
 10906                                 THRU 9900-EXIT
 10907        END-IF
 10908     end-if
 10909     move spaces                 to pi-max-ext-used
 10910     IF PI-PMTTYPE = '3'
 10911        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10912        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10913           MOVE ER-0477          TO EMI-ERROR
 10914           PERFORM 1165-PAID-THRU-ERROR
 10915                                 THRU 1165-EXIT
 10916        ELSE
 10917           continue
 10918        end-if
 10919     ELSE
 10920        IF WS-SV-EPYTHRU > WS-EXP-DT
 10921           move ws-exp-dt        to dc-bin-date-1
 10922           move ws-sv-epythru    to dc-bin-date-2
 10923           MOVE '1'              TO DC-OPTION-CODE
 10924           MOVE +0               TO DC-ELAPSED-DAYS
 10925                                    DC-ELAPSED-MONTHS
 10926           PERFORM 9700-LINK-DATE-CONVERT
 10927                                 THRU 9700-EXIT
 10928           if no-conversion-error
 10929              if dc-elapsed-days > zeros
 10930                 add +1 to dc-elapsed-months
 10931              end-if
 10932              if dc-elapsed-months > pi-max-ext
 10933                 MOVE ER-0557    TO EMI-ERROR
 10934                 PERFORM 1165-PAID-THRU-ERROR
 10935                                 THRU 1165-EXIT
 10936              else
 10937                 move 'Y'        to pi-max-ext-used
 10938                 move er-1670    to emi-error
 10939                 perform 9900-error-format
 10940                                 thru 9900-exit
 10941              end-if
 10942           end-if
 10943        end-if
 10944     end-if
 10945
 10946     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10947         PI-PMTTYPE NOT = '3'
 10948         MOVE ER-0541        TO EMI-ERROR
 10949         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10950
 10951     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 208
* EL156.cbl
 10952        (PI-PMTTYPE NOT = '3')
 10953         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10954             MOVE ER-0478        TO EMI-ERROR
 10955             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10956
 10957     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10958        (PI-PMTTYPE NOT = '4')
 10959         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10960             MOVE ER-0479        TO EMI-ERROR
 10961             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10962
 10963     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10964         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10965             MOVE ER-0545        TO EMI-ERROR
 10966             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10967
 10968     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10969         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10970             MOVE ER-0481        TO EMI-ERROR
 10971             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10972
 10973*    IF PI-COMPANY-ID = 'NCL'
 10974*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10975*           CM-AH-CRITICAL-PERIOD = +0
 10976*            MOVE ER-0844        TO  EMI-ERROR
 10977*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10978
 10979*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10980     if (cl-critical-period = zeros)
 10981        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10982          GO TO 1200-EDIT-FIND-TOLERANCES.
 10983
 10984     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10985     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10986     MOVE '1'        TO DC-OPTION-CODE.
 10987     MOVE +0         TO DC-ELAPSED-DAYS
 10988                        DC-ELAPSED-MONTHS.
 10989     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10990
 10991*    IF NO-CONVERSION-ERROR
 10992*       COMPUTE ws-benefits-paid =
 10993*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10994*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 10995*           MOVE ER-0657 TO EMI-ERROR
 10996*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10997
 10998     GO TO 1200-EDIT-FIND-TOLERANCES.
 10999
 11000 1165-PAID-THRU-ERROR.
 11001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11002
 11003     IF EMI-MESSAGE-FORMATTED
 11004         MOVE -1                 TO EPYTHRUL
 11005         MOVE AL-UNBON           TO EPYTHRUA.
 11006
 11007 1165-EXIT.
 11008     EXIT.
 11009
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 209
* EL156.cbl
 11010 1166-CHECK-ALL-TRLRS.
 11011
 11012     IF PI-PMTTYPE = '4'
 11013        GO TO 1166-TRLR-EXIT.
 11014
 11015     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11016
 11017     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11018        WS-SV-EPYFROM = LOW-VALUES
 11019          GO TO 1166-END-CHECK.
 11020
 11021
 11022* EXEC CICS HANDLE CONDITION
 11023*        ENDFILE   (1166-END-CHECK)
 11024*        NOTFND    (1166-END-CHECK)
 11025*    END-EXEC.
 11026*    MOVE '"$''I                  ! ) #00010605' TO DFHEIV0
 11027     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11029     MOVE X'2920233030303130363035' TO DFHEIV0(25:11)
 11030     CALL 'kxdfhei1' USING DFHEIV0
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11035     MOVE +100                   TO TRLR-SEQ-NO.
 11036
 11037
 11038* EXEC CICS STARTBR
 11039*         DATASET    ('ELTRLR')
 11040*         RIDFLD     (ELTRLR-KEY)
 11041*         GTEQ
 11042*    END-EXEC.
 11043     MOVE 'ELTRLR' TO DFHEIV1
 11044     MOVE 0
 11045       TO DFHEIV11
 11046*    MOVE '&,         G          &   #00010613' TO DFHEIV0
 11047     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11049     MOVE X'2020233030303130363133' TO DFHEIV0(25:11)
 11050     CALL 'kxdfhei1' USING DFHEIV0,
 11051           DFHEIV1,
 11052           ELTRLR-KEY,
 11053           DFHEIV99,
 11054           DFHEIV11,
 11055           DFHEIV99
 11056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11057
 11058
 11059     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11060
 11061 1166-READ-TRLR-NEXT.
 11062
 11063
 11064* EXEC CICS READNEXT
 11065*         DATASET    ('ELTRLR')
 11066*         RIDFLD     (ELTRLR-KEY)
 11067*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 210
* EL156.cbl
 11068*    END-EXEC.
 11069     MOVE 'ELTRLR' TO DFHEIV1
 11070     MOVE 0
 11071       TO DFHEIV11
 11072*    MOVE '&.S                   )   #00010623' TO DFHEIV0
 11073     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11074     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11075     MOVE X'2020233030303130363233' TO DFHEIV0(25:11)
 11076     CALL 'kxdfhei1' USING DFHEIV0,
 11077           DFHEIV1,
 11078           DFHEIV20,
 11079           DFHEIV99,
 11080           ELTRLR-KEY,
 11081           DFHEIV99,
 11082           DFHEIV11,
 11083           DFHEIV99,
 11084           DFHEIV99
 11085     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11086         DFHEIV20
 11087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11088
 11089
 11090     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11091        TRLR-CARRIER  = MSTR-CARRIER  AND
 11092        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11093        TRLR-CERT-NO  = MSTR-CERT-NO
 11094          NEXT SENTENCE
 11095      ELSE
 11096          GO TO 1166-END-CHECK.
 11097
 11098* **  BYPASS ALL NON-PAYMENT TRAILERS
 11099
 11100     IF AT-TRAILER-TYPE = '2'
 11101        NEXT SENTENCE
 11102     ELSE
 11103        GO TO 1166-READ-TRLR-NEXT.
 11104
 11105* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11106
 11107     IF AT-PAYMENT-TYPE = '1' OR '2'
 11108        NEXT SENTENCE
 11109     ELSE
 11110        GO TO 1166-READ-TRLR-NEXT.
 11111
 11112* **  BYPASS ALL VOID PAYMENTS
 11113
 11114     IF AT-VOID-DT NOT = LOW-VALUES
 11115        GO TO 1166-READ-TRLR-NEXT.
 11116
 11117     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11118        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11119          GO TO 1166-READ-TRLR-NEXT.
 11120
 11121     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11122         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11123            OR
 11124        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11125         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 211
* EL156.cbl
 11126        NEXT SENTENCE
 11127     ELSE
 11128         IF CL-TOTAL-PAID-AMT > ZEROS
 11129             MOVE ER-0502            TO EMI-ERROR
 11130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11131             MOVE -1                 TO EPYTHRUL
 11132             MOVE AL-UNBON           TO EPYTHRUA.
 11133
 11134     GO TO 1166-READ-TRLR-NEXT.
 11135
 11136 1166-END-CHECK.
 11137
 11138     IF WS-BROWSE-TRLR-SW = 'Y'
 11139
 11140* EXEC CICS ENDBR
 11141*            DATASET   ('ELTRLR')
 11142*       END-EXEC.
 11143     MOVE 'ELTRLR' TO DFHEIV1
 11144     MOVE 0
 11145       TO DFHEIV11
 11146*    MOVE '&2                    $   #00010678' TO DFHEIV0
 11147     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11149     MOVE X'2020233030303130363738' TO DFHEIV0(25:11)
 11150     CALL 'kxdfhei1' USING DFHEIV0,
 11151           DFHEIV1,
 11152           DFHEIV11,
 11153           DFHEIV99
 11154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11155
 11156
 11157     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11158
 11159 1166-TRLR-EXIT.
 11160     EXIT.
 11161
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 212
* EL156.cbl
 11163 1170-PAID-THRU-FATAL-ERROR.
 11164     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11165
 11166     MOVE -1                     TO EPYTHRUL.
 11167     MOVE AL-UNBON               TO EPYTHRUA.
 11168
 11169 1200-EDIT-FIND-TOLERANCES.
 11170
 11171* EXEC CICS HANDLE CONDITION
 11172*        ENDFILE(1950-NOT-FOUND)
 11173*        NOTFND (1950-NOT-FOUND)
 11174*    END-EXEC.
 11175*    MOVE '"$''I                  ! * #00010695' TO DFHEIV0
 11176     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11178     MOVE X'2A20233030303130363935' TO DFHEIV0(25:11)
 11179     CALL 'kxdfhei1' USING DFHEIV0
 11180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11181
 11182
 11183     IF PI-PROCESSOR-ID = 'LGXX'
 11184        GO TO 1240-FIND-ACCT-TOLERANCES.
 11185
 11186     MOVE 'N'                    TO FOUND-TOL-SW.
 11187     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11188     MOVE '2'                    TO CNTL-REC-TYPE.
 11189     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11190     MOVE +0                     TO CNTL-SEQ-NO.
 11191     MOVE 'PROC'                 TO FILE-SWITCH.
 11192
 11193     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11194
 11195     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11196     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11197                                    PI-MAX-PMT-TOL.
 11198     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11199
 11200     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11201         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11202
 11203     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11204     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11205                                    PI-MAX-LF-PMT-TOL.
 11206
 11207     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11208         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11209
 11210     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11211                                    PI-MAX-EXP-PMT.
 11212
 11213 1240-FIND-ACCT-TOLERANCES.
 11214
 11215     IF WS-PMT-TOL NOT = +0
 11216         MOVE 'Y'                TO FOUND-TOL-SW.
 11217
 11218     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11219         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11220         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 213
* EL156.cbl
 11221         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11222         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11223         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11224         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11225     ELSE
 11226         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11227         MOVE PI-CARRIER             TO ACCT-CARRIER
 11228         MOVE PI-GROUPING            TO ACCT-GROUPING
 11229         MOVE PI-STATE               TO ACCT-STATE
 11230         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11231         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11232
 11233     MOVE 'ACCT'                 TO FILE-SWITCH.
 11234
 11235     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11236     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11237
 11238
 11239* EXEC CICS HANDLE CONDITION
 11240*         NOTFND   (1950-NOT-FOUND)
 11241*         ENDFILE  (1950-NOT-FOUND)
 11242*    END-EXEC.
 11243*    MOVE '"$I''                  ! + #00010755' TO DFHEIV0
 11244     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11246     MOVE X'2B20233030303130373535' TO DFHEIV0(25:11)
 11247     CALL 'kxdfhei1' USING DFHEIV0
 11248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11249
 11250
 11251
 11252* EXEC CICS STARTBR
 11253*        DATASET('ERACCT')
 11254*        RIDFLD (ERACCT-KEY)
 11255*        GTEQ
 11256*    END-EXEC.
 11257     MOVE 'ERACCT' TO DFHEIV1
 11258     MOVE 0
 11259       TO DFHEIV11
 11260*    MOVE '&,         G          &   #00010760' TO DFHEIV0
 11261     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11263     MOVE X'2020233030303130373630' TO DFHEIV0(25:11)
 11264     CALL 'kxdfhei1' USING DFHEIV0,
 11265           DFHEIV1,
 11266           ERACCT-KEY,
 11267           DFHEIV99,
 11268           DFHEIV11,
 11269           DFHEIV99
 11270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11271
 11272
 11273 1245-FIND-ACCT-TOLERANCES-LOOP.
 11274
 11275
 11276* EXEC CICS READNEXT
 11277*        DATASET('ERACCT')
 11278*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 214
* EL156.cbl
 11279*        RIDFLD (ERACCT-KEY)
 11280*    END-EXEC.
 11281     MOVE 'ERACCT' TO DFHEIV1
 11282     MOVE 0
 11283       TO DFHEIV11
 11284*    MOVE '&.S                   )   #00010768' TO DFHEIV0
 11285     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11286     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11287     MOVE X'2020233030303130373638' TO DFHEIV0(25:11)
 11288     CALL 'kxdfhei1' USING DFHEIV0,
 11289           DFHEIV1,
 11290           DFHEIV20,
 11291           DFHEIV99,
 11292           ERACCT-KEY,
 11293           DFHEIV99,
 11294           DFHEIV11,
 11295           DFHEIV99,
 11296           DFHEIV99
 11297     SET ADDRESS OF ACCOUNT-MASTER TO
 11298         DFHEIV20
 11299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11300
 11301
 11302     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11303        IF WS-ERACCT-HOLD-RECORD = SPACES
 11304           GO TO 1950-NOT-FOUND
 11305        ELSE
 11306           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11307           GO TO 1250-CONTINUE.
 11308
 11309     IF ACCT-EXP-DT = HIGH-VALUES
 11310        NEXT SENTENCE
 11311     ELSE
 11312        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11313        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11314
 11315 1250-CONTINUE.
 11316
 11317     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11318
 11319     IF FOUND-TOL-SW = 'N'
 11320         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11321
 11322********* 1260-FIND-STATE-TOLERANCES.
 11323
 11324     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11325     MOVE PI-STATE               TO WS-ST-ACCESS.
 11326     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11327     MOVE '3'                    TO CNTL-REC-TYPE.
 11328     MOVE +0                     TO CNTL-SEQ-NO.
 11329     MOVE 'STAT'                 TO FILE-SWITCH.
 11330
 11331     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11332
 11333     IF WS-PMT-TOL = +0
 11334         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11335
 11336     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 215
* EL156.cbl
 11337     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11338     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11339     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11340     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11341
 11342****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11343****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11344     IF PI-PAYEE-TYPE <> 'B'
 11345           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11346     END-IF.
 11347
 11348     IF PI-PMTTYPE      = '2'  AND
 11349        PI-SPLIT-PMT-SW = 'Y'  AND
 11350        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11351          MOVE ER-3530                TO EMI-ERROR
 11352          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11353
 11354********* 1280-FIND-BENEFIT-TOLERANCES.
 11355
 11356     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11357        OR (PI-PMTTYPE = '5' OR '6')
 11358         GO TO 1300-FIND-CARR-TOLERANCES.
 11359
 11360     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11361     MOVE '4'                    TO CNTL-REC-TYPE.
 11362     MOVE +0                     TO CNTL-SEQ-NO.
 11363     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11364     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11365     MOVE 'BENE'                 TO FILE-SWITCH.
 11366
 11367     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11368
 11369     IF NO-BENEFIT-FOUND
 11370         GO TO 1950-NOT-FOUND.
 11371
 11372     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11373     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11374     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11375
 11376
 11377* EXEC CICS HANDLE CONDITION
 11378*        NOTFND(1950-NOT-FOUND)
 11379*    END-EXEC.
 11380*    MOVE '"$I                   ! , #00010848' TO DFHEIV0
 11381     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11383     MOVE X'2C20233030303130383438' TO DFHEIV0(25:11)
 11384     CALL 'kxdfhei1' USING DFHEIV0
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11386
 11387
 11388 1300-FIND-CARR-TOLERANCES.
 11389     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11390     MOVE '6'                    TO CNTL-REC-TYPE.
 11391
 11392     IF CONTROL-IS-ACTUAL-CARRIER
 11393         MOVE PI-CARRIER               TO WS-CARR
 11394     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 216
* EL156.cbl
 11395         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11396
 11397     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11398     MOVE +0                     TO CNTL-SEQ-NO.
 11399     MOVE 'CARR'                 TO FILE-SWITCH.
 11400
 11401     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11402
 11403     IF WS-DAYS-TOL = +0
 11404         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11405
 11406     IF WS-PMT-TOL = +0
 11407         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11408
 11409     IF WS-MAX-DAYS-TOL = +0
 11410         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11411
 11412     IF WS-MAX-PMT-TOL = +0
 11413         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11414                                    PI-MAX-PMT-TOL.
 11415
 11416     IF WS-MAX-LF-PMT-TOL = +0
 11417        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11418                                    PI-MAX-LF-PMT-TOL.
 11419
 11420     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11421
 11422********* 1320-FIND-COMP-TOLERANCES.
 11423
 11424     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11425     MOVE '1'                    TO CNTL-REC-TYPE.
 11426     MOVE SPACES                 TO CNTL-ACCESS.
 11427     MOVE +0                     TO CNTL-SEQ-NO.
 11428     MOVE 'COMP'                 TO FILE-SWITCH.
 11429
 11430     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11431
 11432     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11433     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11434
 11435     IF WS-PMT-TOL NOT = +0
 11436        IF WS-TOL-SEVERITY NOT = ' '
 11437         GO TO 1360-EDIT-DAYS.
 11438
 11439     IF WS-PMT-TOL = +0
 11440         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11441
 11442     IF WS-TOL-SEVERITY = ' '
 11443         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11444
 11445 1360-EDIT-DAYS.
 11446     IF PI-PMTTYPE NOT = '4'
 11447        IF PI-EDAYS NEGATIVE OR
 11448           PI-EPYAMT NEGATIVE
 11449          MOVE ER-0513             TO EMI-ERROR
 11450          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451          MOVE -1                  TO PMTTYPEL.
 11452
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 217
* EL156.cbl
 11453     IF PI-PMTTYPE = '5' OR '6'
 11454        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11455
 11456     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11457        IF PI-PMTTYPE = '4'
 11458          MOVE PI-EDAYS          TO PI-CDAYS.
 11459
 11460     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11461         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11462
 11463     IF PI-PMTTYPE = '4'
 11464        MOVE PI-EDAYS            TO PI-CDAYS
 11465        GO TO 1400-EDIT-PAYMENT.
 11466
 11467     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11468        GO TO 1500-EDIT-EXPENSES.
 11469
 11470*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11471*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11472*          CM-AH-BENEFIT-CD = '23'              AND
 11473*          CL-CERT-STATE    = '04'              AND
 11474*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11475*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11476*            GO TO 1362-CHECK-MAX-DAYS.
 11477
 11478     IF PI-EDAYS = ZEROS
 11479*        IF PI-COMPANY-ID = 'DMD'
 11480*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11481*            MOVE -1             TO DC-ELAPSED-DAYS
 11482*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11483*            MOVE '6'            TO DC-OPTION-CODE
 11484*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11485*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11486*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11487*            MOVE '1'            TO DC-OPTION-CODE
 11488*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11489*            IF NO-CONVERSION-ERROR
 11490*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11491*                                 + DC-ODD-DAYS-OVER
 11492*               MOVE 6           TO EDAYSL
 11493*               MOVE AL-UNNON    TO EDAYSA
 11494*            ELSE
 11495*                NEXT SENTENCE
 11496*       ELSE
 11497            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11498            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11499            MOVE '1'             TO DC-OPTION-CODE
 11500            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11501            IF NO-CONVERSION-ERROR
 11502                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11503                ADD 1                 TO PI-EDAYS
 11504                MOVE AL-UNNON         TO EDAYSA.
 11505
 11506*    IF PI-COMPANY-ID = 'DMD'
 11507*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11508*        MOVE -1                 TO DC-ELAPSED-DAYS
 11509*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11510*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 218
* EL156.cbl
 11511*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11512*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11513*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11514*        MOVE '1'                TO DC-OPTION-CODE
 11515*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11516*    ELSE
 11517         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11518         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11519         MOVE '1'                TO DC-OPTION-CODE.
 11520         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11521
 11522     IF NO-CONVERSION-ERROR
 11523        IF PI-COMPANY-ID = 'DMD'
 11524            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11525                             + DC-ODD-DAYS-OVER
 11526        ELSE
 11527            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11528            ADD 1                TO PI-CDAYS.
 11529
 11530     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11531        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11532        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11533
 11534     IF PI-EDAYS NOT NUMERIC
 11535         MOVE ER-0491            TO EMI-ERROR
 11536         GO TO 1370-DAYS-ERROR.
 11537
 11538     IF CL-NO-OF-PMTS-MADE = 0
 11539        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11540        AND CL-CERT-STATE = 'MI'
 11541        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11542            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11543     END-IF.
 11544
 11545 1362-CHECK-MAX-DAYS.
 11546
 11547     IF WS-MAX-DAYS-TOL = +999
 11548         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11549
 11550     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11551         IF PI-EDAYS = ZEROS
 11552             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11553         ELSE
 11554             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11555
 11556     IF WS-MAX-DAYS-TOL NOT = ZERO
 11557        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11558           PI-CDAYS > WS-MAX-DAYS-TOL
 11559             MOVE ER-0492          TO EMI-ERROR
 11560             GO TO 1370-DAYS-ERROR.
 11561
 11562 1365-SKIP-MAX-DAYS-EDIT.
 11563     IF PI-EDAYS = ZEROS
 11564        GO TO 1400-EDIT-PAYMENT.
 11565
 11566     IF WS-DAYS-TOL NOT = ZERO
 11567        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11568           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 219
* EL156.cbl
 11569                MOVE ER-0493     TO EMI-ERROR
 11570                GO TO 1370-DAYS-ERROR.
 11571
 11572     GO TO 1400-EDIT-PAYMENT.
 11573
 11574 1370-DAYS-ERROR.
 11575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11576
 11577     IF EMI-MESSAGE-FORMATTED
 11578         MOVE -1                 TO EDAYSL
 11579         MOVE AL-UABON           TO EDAYSA.
 11580
 11581     GO TO 1400-EDIT-PAYMENT.
 11582
 11583 1380-EDIT-EXPENSE-PMT-AMT.
 11584     IF PI-PMTTYPE = '5' OR '6'
 11585         NEXT SENTENCE
 11586     ELSE
 11587         GO TO 1400-EDIT-PAYMENT.
 11588
 11589     IF WS-MAX-EXP-PMT NOT = ZEROS
 11590        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11591            MOVE ER-3529            TO EMI-ERROR
 11592            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11593
 11594     GO TO 1500-EDIT-EXPENSES.
 11595
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 220
* EL156.cbl
 11597
 11598 1390-CHECK-PAYMENT-DAYS.
 11599
 11600     IF PI-EDAYS = 0
 11601         MOVE PI-CDAYS TO WS-PD-DAYS
 11602     ELSE
 11603         MOVE PI-EDAYS TO WS-PD-DAYS
 11604     END-IF.
 11605
 11606     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11607         IF WS-PD-DAYS = 14
 11608            GO TO 1390-EXIT
 11609         END-IF
 11610     END-IF.
 11611
 11612     IF PI-COMPANY-ID = 'AHL'  AND
 11613        CM-AH-BENEFIT-CD = '1K'
 11614         IF WS-PD-DAYS = 14
 11615            GO TO 1390-EXIT
 11616         END-IF
 11617     END-IF.
 11618
 11619     IF WS-PD-DAYS < 30
 11620         MOVE ER-3549              TO EMI-ERROR
 11621         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11622     END-IF.
 11623
 11624 1390-EXIT.
 11625      EXIT.
 11626
 11627 1400-EDIT-PAYMENT.
 11628*    IF PI-COMPANY-ID = 'DMD'
 11629*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11630*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11631
 11632     IF PI-COMPANY-ID = 'DCC'
 11633        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11634        MOVE PI-CARRIER          TO ACCT-CARRIER
 11635        MOVE PI-GROUPING         TO ACCT-GROUPING
 11636        MOVE PI-STATE            TO ACCT-STATE
 11637        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11638        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11639        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11640        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11641
 11642
 11643* EXEC CICS READ
 11644*          DATASET ('ERACCT')
 11645*          RIDFLD  (ERACCT-KEY)
 11646*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11647*          GTEQ
 11648*          resp    (WS-RESPONSE)
 11649*       END-EXEC
 11650     MOVE 'ERACCT' TO DFHEIV1
 11651*    MOVE '&"S        G          (  N#00011106' TO DFHEIV0
 11652     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11654     MOVE X'204E233030303131313036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 221
* EL156.cbl
 11655     CALL 'kxdfhei1' USING DFHEIV0,
 11656           DFHEIV1,
 11657           DFHEIV20,
 11658           DFHEIV99,
 11659           ERACCT-KEY,
 11660           DFHEIV99,
 11661           DFHEIV99,
 11662           DFHEIV99
 11663     SET ADDRESS OF ACCOUNT-MASTER TO
 11664         DFHEIV20
 11665     MOVE EIBRESP  TO WS-RESPONSE
 11666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11667        IF WS-RESP-NORMAL
 11668           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11669           and pi-cert-eff-dt < am-expiration-dt
 11670           and pi-cert-eff-dt >= am-effective-dt
 11671           move am-dcc-product-code to pi-dcc-product-code
 11672        else
 11673           move spaces           to pi-dcc-product-code
 11674        end-if
 11675        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11676           PERFORM 0900-GET-DDF-LIMITS
 11677                                 THRU 0900-EXIT
 11678           IF PDEF-FOUND
 11679              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11680                 (P1 > +8)
 11681                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11682              END-PERFORM
 11683              IF P1 < +9
 11684                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11685                    MOVE PD-MAX-AMT (P1)
 11686                                 TO CM-AH-BENEFIT-AMT
 11687                 end-if
 11688              else
 11689                 move er-1674    to emi-error
 11690                 PERFORM 9900-ERROR-FORMAT
 11691                                 THRU 9900-EXIT
 11692              END-IF
 11693           else
 11694              move er-1672       to emi-error
 11695              PERFORM 9900-ERROR-FORMAT
 11696                                 THRU 9900-EXIT
 11697           END-IF
 11698        end-if
 11699     END-IF
 11700     IF PI-PMTTYPE NOT = '4'
 11701        GO TO 1405-CALC-PAYMENT.
 11702
 11703     IF PI-EDAYS NOT NUMERIC
 11704         MOVE PI-EPYAMT           TO PI-CPYAMT
 11705         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11706         GO TO 1430-CHECK-AH-TOLERANCE.
 11707
 11708*    IF PI-COMPANY-ID = 'FIA'
 11709*       IF CERT-ACCOUNT = '0000011043'
 11710*        COMPUTE PI-DAILY-RATE ROUNDED =
 11711*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11712*        COMPUTE PI-CPYAMT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 222
* EL156.cbl
 11713*                          PI-DAILY-RATE * PI-EDAYS
 11714*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11715*        GO TO 1430-CHECK-AH-TOLERANCE.
 11716
 11717     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11718         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11719         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11720         GO TO 1420-CHECK-AIG-BENEFIT.
 11721
 11722     IF WS-CALC-METHOD = '2' OR  '5'
 11723         COMPUTE PI-DAILY-RATE ROUNDED =
 11724                        (CM-AH-BENEFIT-AMT * 12) / 365
 11725         COMPUTE PI-CPYAMT ROUNDED =
 11726                           PI-DAILY-RATE * PI-EDAYS
 11727        GO TO 1420-CHECK-AIG-BENEFIT.
 11728
 11729     IF WS-CALC-METHOD = '3'
 11730         COMPUTE PI-DAILY-RATE =
 11731                         (CM-AH-BENEFIT-AMT * 12) / 365
 11732         COMPUTE PI-CPYAMT ROUNDED =
 11733                           PI-DAILY-RATE * PI-EDAYS
 11734        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 223
* EL156.cbl
 11736*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11737
 11738****************************************************************
 11739****************************************************************
 11740*                  CALCULATED FROM      PAYMENT      PAYMENT
 11741*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11742* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11743*1-01-83  1-15-83    0    15     15        15           15
 11744*1-01-83  1-30-83    0    30     30        30           30
 11745*1-01-83  1-31-83    1     0     31        30           30
 11746*1-01-83  2-01-83    1     1     32        31           31
 11747*1-01-83  2-15-83    1    15     46        45           45
 11748*1-01-83  2-28-83    2     0     59        60           60
 11749*1-01-83  3-01-83    2     1     60        61           61
 11750*1-01-83  3-31-83    3     0     90        90           90
 11751*1-15-83  1-31-83    0    17     17        17           16
 11752*1-15-83  2-01-83    0    18     18        18           17
 11753*1-15-83  2-28-83    1    14     45        44           46
 11754*1-21-83  3-09-83    1    20     48        50           49
 11755*2-05-83  3-06-83    1     2     30        32           32
 11756*2-05-83  3-23-83    1    19     47        49           49
 11757*2-15-83  2-28-83    0    14     14        14           16
 11758*2-15-83  3-01-83    0    15     15        15           17
 11759*2-21-83  3-19-83    0    27     27        27           29
 11760*2-21-83  3-20-83    1     0     28        30           30
 11761*2-21-83  4-10-83    1    18     49        30           50
 11762*2-21-83  5-19-83    2    27     88        87           89
 11763*2-21-83  5-22-83    3     2     91        92           92
 11764*3-21-83  5-19-83    1    30     60        60           59
 11765****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 224
* EL156.cbl
 11767 1405-CALC-PAYMENT.
 11768     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11769     MOVE ' '                    TO DC-OPTION-CODE.
 11770     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11771     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11772     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11773
 11774     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11775     MOVE ' '                    TO DC-OPTION-CODE.
 11776     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11777     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11778     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11779
 11780     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11781     MOVE -1                     TO DC-ELAPSED-DAYS.
 11782     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11783     MOVE '6'                    TO DC-OPTION-CODE.
 11784     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11785     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11786
 11787     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11788     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11789     MOVE '1'                    TO DC-OPTION-CODE.
 11790     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11791
 11792     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11793     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11794     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11795
 11796******************************************************************
 11797*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11798*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11799*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11800******************************************************************
 11801
 11802     IF WS-CALC-METHOD = '1'           AND
 11803        DC-ELAPSED-MONTHS > ZERO AND
 11804        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11805        WDF-DAY > WDT-DAY
 11806          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11807          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11808          MOVE -1                  TO DC-ELAPSED-MONTHS
 11809          MOVE '6'                 TO DC-OPTION-CODE
 11810          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11811          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11812          COMPUTE WS-SAVE-ODD-DAYS =
 11813          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11814          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11815
 11816     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11817     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11818     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11819
 11820     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11821     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11822
 11823*    IF PI-COMPANY-ID = 'FIA'
 11824*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 225
* EL156.cbl
 11825*        COMPUTE PI-DAILY-RATE ROUNDED =
 11826*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11827*        COMPUTE PI-CPYAMT ROUNDED =
 11828*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11829*        GO TO 1420-CHECK-AIG-BENEFIT.
 11830
 11831*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11832*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11833*          CM-AH-BENEFIT-CD = '23'               AND
 11834*          CL-CERT-STATE    = '04'               AND
 11835*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11836*            COMPUTE WS-DAILY-RATE ROUNDED =
 11837*                               CM-AH-BENEFIT-AMT / 30
 11838*            COMPUTE PI-CPYAMT ROUNDED =
 11839*                               (WS-DAILY-RATE * PI-CDAYS)
 11840*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11841*            GO TO 1420-CHECK-AIG-BENEFIT.
 11842
 11843     IF WS-CALC-METHOD = '1'
 11844         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11845         COMPUTE PI-CPYAMT ROUNDED =
 11846             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11847             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11848         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11849         GO TO 1420-CHECK-AIG-BENEFIT.
 11850
 11851     IF WS-CALC-METHOD = '2'
 11852         COMPUTE PI-DAILY-RATE ROUNDED =
 11853                          (CM-AH-BENEFIT-AMT * 12) / 365
 11854         COMPUTE PI-CPYAMT ROUNDED =
 11855             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11856             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11857         GO TO 1420-CHECK-AIG-BENEFIT.
 11858
 11859     IF WS-CALC-METHOD = '4'
 11860         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11861         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11862         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11863         COMPUTE PI-CPYAMT ROUNDED =
 11864                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11865         GO TO 1420-CHECK-AIG-BENEFIT.
 11866
 11867     IF WS-CALC-METHOD = '5'
 11868         COMPUTE PI-DAILY-RATE ROUNDED =
 11869                            (CM-AH-BENEFIT-AMT * 12) / 365
 11870         COMPUTE PI-CPYAMT ROUNDED =
 11871                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11872         GO TO 1420-CHECK-AIG-BENEFIT.
 11873
 11874     IF WS-CALC-METHOD NOT = '3'
 11875        GO TO 1410-CHECK-PAYMENT.
 11876
 11877******   CALCULATION METHOD  3  ROUTINE
 11878     COMPUTE PI-DAILY-RATE =
 11879                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11880
 11881******CHECK TO SEE IF WITHIN SAME MONTH
 11882     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 226
* EL156.cbl
 11883        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11884                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11885         GO TO 1420-CHECK-AIG-BENEFIT.
 11886
 11887******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11888     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11889             SAVE-ODD-DAYS-OVER = ZEROS
 11890      COMPUTE PI-CPYAMT  ROUNDED =
 11891                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11892      GO TO 1420-CHECK-AIG-BENEFIT.
 11893
 11894******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11895******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11896     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11897        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11898        IF WDF-MONTH > 12
 11899           ADD 1                 TO WDF-YEAR
 11900           SUBTRACT 12         FROM WDF-MONTH.
 11901
 11902******CONVERT THE NEW FROM MONTH TO BINARY
 11903     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11904        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11905        MOVE '4'              TO DC-OPTION-CODE
 11906        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11907        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11908
 11909     IF WDF-MONTH = WDT-MONTH AND
 11910        WDF-YEAR  = WDT-YEAR
 11911          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11912                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11913                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11914        ELSE
 11915          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11916          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11917          COMPUTE PI-CPYAMT ROUNDED =
 11918       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11919       +
 11920       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11921       +
 11922       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11923
 11924     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 227
* EL156.cbl
 11926 1410-CHECK-PAYMENT.
 11927******PAYMENT OPTION 6
 11928******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11929     IF SAVE-ELAPSED-MONTHS > ZERO
 11930        IF SAVE-ODD-DAYS-OVER = ZEROS
 11931           GO TO 1412-CHECK-TO-DAY
 11932        ELSE
 11933           IF WDF-DAY > WDT-DAY
 11934              IF WDF-MONTH = 02
 11935                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11936                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11937                  GO TO 1412-CHECK-TO-DAY
 11938              ELSE
 11939                  IF FROM-DAYS-IN-MONTH = 31
 11940                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11941                     GO TO 1412-CHECK-TO-DAY
 11942                  ELSE
 11943                     GO TO 1412-CHECK-TO-DAY
 11944           ELSE
 11945               GO TO 1412-CHECK-TO-DAY.
 11946
 11947     IF WDF-MONTH NOT = WDT-MONTH
 11948        IF WDF-MONTH = 02
 11949           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11950           IF WDF-DAY = 29
 11951              ADD 1              TO SAVE-ODD-DAYS-OVER
 11952           ELSE
 11953              ADD 2              TO SAVE-ODD-DAYS-OVER
 11954        ELSE
 11955           IF FROM-DAYS-IN-MONTH = 31
 11956              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11957
 11958 1412-CHECK-TO-DAY.
 11959        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11960           IF WDT-DAY = 28
 11961              ADD 2              TO SAVE-ODD-DAYS-OVER
 11962           ELSE
 11963              IF WDT-DAY = 29
 11964                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11965              ELSE
 11966                 NEXT SENTENCE
 11967        ELSE
 11968           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11969              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11970
 11971     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11972     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11973     COMPUTE PI-CPYAMT ROUNDED =
 11974         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11975         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11976
 11977     GO TO 1420-CHECK-AIG-BENEFIT.
 11978
 11979 1415-CHECK-LEAP-YEAR.
 11980     IF FROM-DAYS-IN-MONTH = 29
 11981        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11982
 11983 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 228
* EL156.cbl
 11984     EXIT.
 11985
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 229
* EL156.cbl
 11987 1420-CHECK-AIG-BENEFIT.
 11988
 11989     IF WS-SPECIAL-CALC-CD = 'Q'
 11990         GO TO 1425-CHECK-WHOLE-MONTH.
 11991
 11992*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11993*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11994*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11995*       (PI-PMTTYPE = '1' OR '2')
 11996*        NEXT SENTENCE
 11997*    ELSE
 11998         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11999         GO TO 1430-CHECK-AH-TOLERANCE.
 12000
 12001******************AIG LOGIC STARTS**********************
 12002*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12003*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12004*    MOVE ER-3533      TO EMI-ERROR.
 12005*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12006*    GO TO 1430-CHECK-AH-TOLERANCE.
 12007******************AIG LOGIC ENDS************************
 12008
 12009 1425-CHECK-WHOLE-MONTH.
 12010******************************************************************
 12011****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12012****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12013****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12014****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12015****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12016****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12017****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12018****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12019****          PAID * MONTHLY BENEFIT.                         ****
 12020******************************************************************
 12021
 12022     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12023
 12024     IF CL-NO-OF-PMTS-MADE > +0
 12025         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12026
 12027     IF PI-CDAYS < WS-BEN-DAYS
 12028         GO TO 1430-CHECK-AH-TOLERANCE.
 12029
 12030     IF PI-CDAYS = WS-BEN-DAYS
 12031         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12032         GO TO 1430-CHECK-AH-TOLERANCE.
 12033
 12034*    IF PI-COMPANY-ID = 'ACM'
 12035*       NEXT SENTENCE
 12036*    ELSE
 12037        GO TO 1425-NOT-ACM-W15C.
 12038
 12039*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12040*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12041*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12042*    MOVE '6'                    TO  DC-OPTION-CODE.
 12043*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12044*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 230
* EL156.cbl
 12045*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12046*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12047*       MOVE '1'                 TO  DC-OPTION-CODE
 12048*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12049*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12050*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12051*       IF NO-CONVERSION-ERROR
 12052*          IF (DC-ELAPSED-MONTHS > +0) OR
 12053*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12054*             NEXT SENTENCE
 12055*          ELSE
 12056*             MOVE +0            TO  PI-CPYAMT
 12057*             MOVE ER-0846       TO  EMI-ERROR
 12058*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12059*             GO TO 1430-CHECK-AH-TOLERANCE
 12060*       ELSE
 12061*           MOVE ER-0846         TO  EMI-ERROR
 12062*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12063*           GO TO 1430-CHECK-AH-TOLERANCE.
 12064*
 12065*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12066*       ADD +1 TO DC-ELAPSED-MONTHS.
 12067*
 12068*    COMPUTE PI-CPYAMT ROUNDED =
 12069*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12070*
 12071*    GO TO 1430-CHECK-AH-TOLERANCE.
 12072
 12073 1425-NOT-ACM-W15C.
 12074
 12075     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12076     MOVE '6'                        TO  DC-OPTION-CODE.
 12077     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12078     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12079
 12080     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12081     IF NO-CONVERSION-ERROR
 12082         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12083     ELSE
 12084         MOVE ER-0846                TO  EMI-ERROR
 12085         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12086         GO TO 1430-CHECK-AH-TOLERANCE.
 12087
 12088     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12089     MOVE '1'                        TO  DC-OPTION-CODE.
 12090     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12091     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12092     IF NO-CONVERSION-ERROR
 12093         IF DC-ODD-DAYS-OVER = +0
 12094             NEXT SENTENCE
 12095         ELSE
 12096             MOVE ER-0846            TO  EMI-ERROR
 12097             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12098             GO TO 1430-CHECK-AH-TOLERANCE
 12099     ELSE
 12100         MOVE ER-0846                TO  EMI-ERROR
 12101         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12102         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 231
* EL156.cbl
 12103
 12104     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12105         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12106
 12107     GO TO 1430-CHECK-AH-TOLERANCE.
 12108
 12109 1425-CONT-WHOLE-MONTH-PMTS.
 12110******************************************************************
 12111****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12112****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12113****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12114******************************************************************
 12115
 12116     IF PI-COMPANY-ID = 'ACM'
 12117        NEXT SENTENCE
 12118     ELSE
 12119        IF DC-ODD-DAYS-OVER = +0
 12120            NEXT SENTENCE
 12121        ELSE
 12122            MOVE ER-0845            TO  EMI-ERROR
 12123            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12124            GO TO 1430-CHECK-AH-TOLERANCE.
 12125
 12126     COMPUTE PI-CPYAMT ROUNDED =
 12127                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12128
 12129 1430-CHECK-AH-TOLERANCE.
 12130     IF PI-PMT-APPR-SW = 'G'
 12131         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12132
 12133*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12134*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12135*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12136*
 12137*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12138*      IF WDF-MONTH = 02
 12139*        IF SAVE-ELAPSED-MONTHS = 0
 12140*          NEXT SENTENCE
 12141*        ELSE
 12142*          IF SAVE-ODD-DAYS-OVER > 0
 12143*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12144*            COMPUTE WS-PMT-MOS ROUNDED =
 12145*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12146*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12147*                                     WS-PMT-MOS
 12148*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12149*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12150*          ELSE
 12151*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12152*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12153*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12154*                                     WS-PMT-MOS.
 12155
 12156     IF WS-MAX-PMT-TOL NOT = ZERO
 12157        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12158           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12159            MOVE ER-0494         TO  EMI-ERROR
 12160            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 232
* EL156.cbl
 12161            GO TO 1500-EDIT-EXPENSES.
 12162
 12163 1430-CONT-CHECK-AH-TOLERANCE.
 12164
 12165     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12166        GO TO 1500-EDIT-EXPENSES.
 12167
 12168     IF CM-O-B-COVERAGE
 12169        GO TO 1500-EDIT-EXPENSES.
 12170
 12171     IF PI-COMPANY-ID = 'NCL'
 12172       IF FOUND-TOL-SW = 'Y'
 12173         IF WS-PMT-TOL NOT = ZERO
 12174           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12175              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12176                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12177                  IF WS-NCL-PMT-OPTION = SPACES
 12178                      MOVE ER-0699 TO EMI-ERROR
 12179                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12180                  ELSE
 12181                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12182                      NEXT SENTENCE
 12183                  ELSE
 12184                  IF NOT WS-VALID-NCL-OPTION
 12185                      MOVE ER-0699 TO EMI-ERROR
 12186                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12187
 12188     IF WS-PMT-TOL NOT = ZERO
 12189        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12190           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12191           MOVE ER-0495          TO EMI-ERROR
 12192           PERFORM 1490-PAYMENT-ERROR
 12193                                 THRU 1490-EXIT
 12194        end-if
 12195     end-if
 12196
 12197     GO TO 1500-EDIT-EXPENSES.
 12198
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 233
* EL156.cbl
 12200 1440-COMPUTE-LIFE-REMAINING.
 12201
 12202     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12203        IF PI-PMTTYPE = '4'
 12204          MOVE PI-EPYAMT TO PI-CPYAMT
 12205          GO TO 1460-TEST-TYPE.
 12206
 12207     IF WS-LF-COVERAGE-TYPE = 'L'
 12208        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12209                          - CL-TOTAL-PAID-AMT
 12210        GO TO 1450-CHECK-MAX.
 12211
 12212     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12213        PI-LF-COVERAGE-TYPE = 'P'
 12214          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12215                              CM-LF-ITD-DEATH-AMT
 12216          GO TO 1450-CHECK-MAX.
 12217
 12218     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12219     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12220     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12221     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12222     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12223     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12224     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12225     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12226     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12227
 12228     PERFORM 9800-LINK-REM-TERM.
 12229
 12230     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12231     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12232     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12233     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12234     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12235     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12236     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12237     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12238     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12239     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12240     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12241     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12242     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12243     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12244     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12245     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12246     IF PI-COMPANY-ID = 'DCC'
 12247        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12248        MOVE PI-CARRIER          TO ACCT-CARRIER
 12249        MOVE PI-GROUPING         TO ACCT-GROUPING
 12250        MOVE PI-STATE            TO ACCT-STATE
 12251        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12252        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12253        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12254        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12255
 12256
 12257* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 234
* EL156.cbl
 12258*          DATASET ('ERACCT')
 12259*          RIDFLD  (ERACCT-KEY)
 12260*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12261*          GTEQ
 12262*          resp    (WS-RESPONSE)
 12263*       END-EXEC
 12264     MOVE 'ERACCT' TO DFHEIV1
 12265*    MOVE '&"S        G          (  N#00011702' TO DFHEIV0
 12266     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12268     MOVE X'204E233030303131373032' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0,
 12270           DFHEIV1,
 12271           DFHEIV20,
 12272           DFHEIV99,
 12273           ERACCT-KEY,
 12274           DFHEIV99,
 12275           DFHEIV99,
 12276           DFHEIV99
 12277     SET ADDRESS OF ACCOUNT-MASTER TO
 12278         DFHEIV20
 12279     MOVE EIBRESP  TO WS-RESPONSE
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12281        IF WS-RESP-NORMAL
 12282           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12283           and (pi-cert-eff-dt < am-expiration-dt)
 12284           and (pi-cert-eff-dt >= am-effective-dt)
 12285           move am-dcc-product-code to pi-dcc-product-code
 12286        else
 12287           move spaces           to pi-dcc-product-code
 12288        end-if
 12289        if pi-dcc-product-code not = spaces
 12290           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12291           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12292           PERFORM 0900-GET-DDF-limits
 12293                                 THRU 0900-EXIT
 12294           IF PDEF-FOUND
 12295              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12296                 (P1 > +8)
 12297                 OR (PD-PROD-CODE (P1) = 'L')
 12298              END-PERFORM
 12299              IF P1 < +9
 12300                 MOVE PD-MAX-AMT (P1)
 12301                                 TO CP-R-MAX-TOT-BEN
 12302              else
 12303                 move er-1674    to emi-error
 12304                 PERFORM 9900-ERROR-FORMAT
 12305                                 THRU 9900-EXIT
 12306              END-IF
 12307           else
 12308              move er-1672       to emi-error
 12309              PERFORM 9900-ERROR-FORMAT
 12310                                 THRU 9900-EXIT
 12311           END-IF
 12312        end-if
 12313     END-IF
 12314
 12315* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 235
* EL156.cbl
 12316*       PROGRAM  (LINK-REMAMT)
 12317*       COMMAREA (CALCULATION-PASS-AREA)
 12318*       LENGTH   (CP-COMM-LENGTH)
 12319*    END-EXEC.
 12320*    MOVE '."C                   (   #00011742' TO DFHEIV0
 12321     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12323     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 12324     CALL 'kxdfhei1' USING DFHEIV0,
 12325           LINK-REMAMT,
 12326           CALCULATION-PASS-AREA,
 12327           CP-COMM-LENGTH,
 12328           DFHEIV99,
 12329           DFHEIV99,
 12330           DFHEIV99,
 12331           DFHEIV99
 12332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12333
 12334
 12335     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12336
 12337     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12338     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12339
 12340     IF PI-COMPANY-ID = 'BOA' AND
 12341        PI-PMTTYPE    = '2'   AND
 12342        PI-OFFLINE    = 'N'
 12343           GO TO 1441-COMPUTE-BOA-INTEREST.
 12344
 12345     IF PI-COMPANY-ID = 'NCL' AND
 12346        PI-PMTTYPE    = '2'   AND
 12347        PI-OFFLINE    = 'N'
 12348          GO TO 1442-COMPUTE-NCL-INTEREST
 12349       ELSE
 12350          GO TO 1445-CONTINUE.
 12351
 12352 1441-COMPUTE-BOA-INTEREST.
 12353     MOVE +0             TO WS-CALC-INT.
 12354
 12355     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12356     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12357     MOVE +0             TO DC-ELAPSED-MONTHS
 12358                            DC-ELAPSED-DAYS.
 12359     MOVE '1'            TO DC-OPTION-CODE.
 12360     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12361     IF NO-CONVERSION-ERROR
 12362         NEXT SENTENCE
 12363     ELSE
 12364         GO TO 1445-CONTINUE.
 12365
 12366     IF (PI-INT-RATE NOT > ZEROS)  AND
 12367        (DC-ELAPSED-DAYS > +30)
 12368         MOVE ER-3531            TO EMI-ERROR
 12369         MOVE -1                 TO PINTL
 12370         MOVE AL-UNBON           TO PINTA
 12371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12372
 12373     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 236
* EL156.cbl
 12374         GO TO 1445-CONTINUE.
 12375
 12376     IF (PI-INT-RATE NOT > ZEROS)  OR
 12377        (DC-ELAPSED-DAYS NOT > +30)
 12378         MOVE PI-EPYAMT TO PI-CPYAMT
 12379         GO TO 1441-FORMAT-NOTE.
 12380
 12381     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12382                                 *  PI-INT-RATE
 12383                                 *  DC-ELAPSED-DAYS
 12384                                 /  365
 12385                                 /  100.
 12386
 12387     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12388
 12389 1441-FORMAT-NOTE.
 12390
 12391     MOVE SPACES        TO WS-BOANOTE1.
 12392     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12393     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12394     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12395     MOVE AL-UANON      TO NOTE1A.
 12396
 12397     IF WS-CALC-INT > ZEROS
 12398         MOVE SPACES        TO WS-BOANOTE2
 12399         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12400         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12401         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12402         MOVE AL-UANON      TO NOTE2A.
 12403
 12404     GO TO 1445-CONTINUE.
 12405
 12406 1442-COMPUTE-NCL-INTEREST.
 12407     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12408     MOVE PI-STATE               TO WS-ST-ACCESS.
 12409     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12410     MOVE '3'                    TO CNTL-REC-TYPE.
 12411     MOVE +0                     TO CNTL-SEQ-NO.
 12412     MOVE 'STAT'                 TO FILE-SWITCH.
 12413
 12414     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12415
 12416     MOVE +0                 TO WS-CALC-INT.
 12417
 12418     IF ST-STAT-FROM-INCURRED
 12419         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12420       ELSE
 12421     IF ST-STAT-FROM-REPORTED
 12422         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12423       ELSE
 12424         GO TO 1445-CONTINUE.
 12425
 12426     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12427     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12428     MOVE +0                 TO DC-ELAPSED-MONTHS
 12429                                DC-ELAPSED-DAYS.
 12430     MOVE '1'                TO DC-OPTION-CODE.
 12431     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 237
* EL156.cbl
 12432     IF NO-CONVERSION-ERROR
 12433         NEXT SENTENCE
 12434     ELSE
 12435         GO TO 1445-CONTINUE.
 12436
 12437     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12438        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12439         GO TO 1445-CONTINUE.
 12440
 12441     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12442                                 *  CF-ST-STAT-INTEREST.
 12443
 12444     MOVE SPACES              TO WS-NCLNOTE1.
 12445     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12446     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12447     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12448                                 PI-PMTNOTE1
 12449                                 NOTE1I.
 12450     MOVE AL-UANON            TO NOTE1A.
 12451
 12452     IF WS-CALC-INT > ZEROS
 12453         MOVE SPACES          TO WS-NCLNOTE2
 12454         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12455         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12456         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12457                                 PI-PMTNOTE2
 12458                                 NOTE2I
 12459         MOVE AL-UANON        TO NOTE2A.
 12460
 12461     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12462
 12463 1445-CONTINUE.
 12464
 12465     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12466        GO TO 1460-TEST-TYPE.
 12467
 12468     IF CM-O-B-COVERAGE
 12469        GO TO 1460-TEST-TYPE.
 12470
 12471     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12472         GO TO 1450-CHECK-MAX.
 12473
 12474     if (pi-company-id = 'DCC')
 12475        and (pdef-found)
 12476        and (pi-epyamt > pd-max-amt (p1))
 12477        move er-1657             to emi-error
 12478        perform 1490-payment-error
 12479                                 thru 1490-exit
 12480        go to 1460-test-type
 12481     else
 12482        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12483           > PI-EPYAMT)
 12484                         OR
 12485           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12486           < PI-EPYAMT)
 12487           MOVE ER-0594          TO EMI-ERROR
 12488           PERFORM 1490-PAYMENT-ERROR
 12489                                 THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 238
* EL156.cbl
 12490           GO TO 1460-TEST-TYPE
 12491        end-if
 12492     end-if
 12493     .
 12494 1450-CHECK-MAX.
 12495
 12496     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12497        PI-LF-COVERAGE-TYPE = 'P'
 12498         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12499                                   CM-LF-ITD-DEATH-AMT
 12500     ELSE
 12501         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12502                                   CL-TOTAL-PAID-AMT.
 12503
 12504     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12505          MOVE ER-0543           TO EMI-ERROR
 12506          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12507
 12508 1460-TEST-TYPE.
 12509
 12510     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12511        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12512           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12513                                   CM-LF-ALT-BENEFIT-AMT -
 12514                                   CL-TOTAL-PAID-AMT
 12515           IF PI-EPYAMT > WS-LF-BEN-AMT
 12516               MOVE ER-0543      TO EMI-ERROR
 12517               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12518           END-IF
 12519        END-IF
 12520     END-IF
 12521
 12522     IF PI-PMT-APPR-SW = 'G'
 12523       NEXT SENTENCE
 12524     ELSE
 12525       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12526         IF PI-EPYAMT = ZERO
 12527             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12528                 MOVE ER-0494    TO  EMI-ERROR
 12529                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12530                 GO TO 1500-EDIT-EXPENSES
 12531             ELSE
 12532                 NEXT SENTENCE
 12533         ELSE
 12534             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12535                 MOVE ER-0494    TO  EMI-ERROR
 12536                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12537                 GO TO 1500-EDIT-EXPENSES.
 12538
 12539     IF PI-PMTTYPE NOT = '2' OR
 12540        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12541         GO TO 1500-EDIT-EXPENSES.
 12542
 12543     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12544     MOVE ER-0526                TO EMI-ERROR.
 12545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12546
 12547     IF EMI-ERROR-NUMBER (1) = '0526'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 239
* EL156.cbl
 12548        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12549
 12550     IF EMI-ERROR-NUMBER (2) = '0526'
 12551        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12552
 12553     GO TO 1500-EDIT-EXPENSES.
 12554
 12555 1490-PAYMENT-ERROR.
 12556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12557
 12558     IF EMI-MESSAGE-FORMATTED
 12559         MOVE -1                 TO EPYAMTL
 12560         MOVE AL-UNBON           TO EPYAMTA.
 12561
 12562 1490-EXIT.
 12563      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 240
* EL156.cbl
 12565 1500-EDIT-EXPENSES.
 12566     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12567         GO TO 1500-SKIP-ERROR-0556.
 12568
 12569 1500-CONTINUE-ON.
 12570
 12571     IF CM-O-B-COVERAGE
 12572        MOVE ER-0556             TO EMI-ERROR
 12573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12574
 12575 1500-SKIP-ERROR-0556.
 12576     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12577        IF PI-EEXPENS NOT = ZEROS
 12578           MOVE ER-0524          TO EMI-ERROR
 12579           GO TO 1590-EXPENSE-ERROR
 12580        ELSE
 12581           GO TO 1600-EDIT-RESERVES.
 12582
 12583     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12584     MOVE '6'                    TO CNTL-REC-TYPE.
 12585
 12586     IF CONTROL-IS-ACTUAL-CARRIER
 12587         MOVE PI-CARRIER         TO WS-CARR
 12588     ELSE
 12589         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12590
 12591     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12592     MOVE +0                     TO CNTL-SEQ-NO.
 12593     MOVE 'CARR'                 TO FILE-SWITCH.
 12594
 12595     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12596
 12597     IF EXPENSE-CALC-MANUAL
 12598        GO TO 1600-EDIT-RESERVES.
 12599
 12600     IF DOLLARS-PER-PMT
 12601        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12602        GO TO 1600-EDIT-RESERVES.
 12603
 12604     IF DOLLARS-PER-MONTH AND
 12605        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12606       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12607       GO TO 1600-EDIT-RESERVES.
 12608
 12609     IF PERCENT-OF-PAYMENT
 12610        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12611
 12612     GO TO 1600-EDIT-RESERVES.
 12613
 12614 1590-EXPENSE-ERROR.
 12615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12616
 12617     IF EMI-MESSAGE-FORMATTED
 12618        MOVE -1                  TO EEXPENSL
 12619        MOVE AL-UNBON            TO EEXPENSA.
 12620
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 241
* EL156.cbl
 12622 1600-EDIT-RESERVES.
 12623     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12624        IF PI-ERESV = ZEROS
 12625           GO TO 1700-EDIT-EXPENSE-TYPE
 12626        ELSE
 12627           MOVE ER-0525          TO EMI-ERROR
 12628           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12629           GO TO 1700-EDIT-EXPENSE-TYPE.
 12630
 12631     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12632     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12633     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12634
 12635     IF NOT AT-MANUAL-RESERVES-USED
 12636        IF PI-ERESV NOT = ZEROS
 12637           MOVE ER-0518          TO EMI-ERROR
 12638           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12639
 12640     IF AT-MANUAL-RESERVES-USED
 12641        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12642        GO TO 1700-EDIT-EXPENSE-TYPE.
 12643
 12644     IF AT-FUTURE-RESERVES-USED
 12645        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12646
 12647     IF AT-FUTURE-RESERVES-USED
 12648        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12649
 12650     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12651        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12652
 12653     IF AT-IBNR-RESERVES-USED
 12654        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12655
 12656     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12657     GO TO 1700-EDIT-EXPENSE-TYPE.
 12658
 12659 1690-RESERVE-ERROR.
 12660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12661
 12662     IF EMI-MESSAGE-FORMATTED
 12663        MOVE AL-UNBON            TO ERESVA
 12664        MOVE -1                  TO ERESVL.
 12665
 12666 1690-EXIT.
 12667      EXIT.
 12668
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 242
* EL156.cbl
 12670 1700-EDIT-EXPENSE-TYPE.
 12671     IF PI-PMTTYPE NOT = '5' AND '6'
 12672        GO TO 2000-EDIT-DONE.
 12673
 12674     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12675                   '6' OR '7' OR '8' OR '9'
 12676        GO TO 2000-EDIT-DONE.
 12677
 12678 1705-EXPENSE-ERROR.
 12679     MOVE ER-0573                TO EMI-ERROR.
 12680     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12681
 12682     IF EMI-MESSAGE-FORMATTED
 12683        MOVE AL-UABON            TO ETYPEA
 12684        MOVE -1                  TO ETYPEL.
 12685
 12686     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 243
* EL156.cbl
 12688 1950-NOT-FOUND.
 12689     IF FILE-SWITCH = 'MSTR'
 12690        MOVE ER-0204             TO EMI-ERROR.
 12691
 12692     IF FILE-SWITCH = 'CARR'
 12693        MOVE ER-0252             TO EMI-ERROR.
 12694
 12695     IF FILE-SWITCH = 'COMP'
 12696        MOVE ER-0254             TO EMI-ERROR.
 12697
 12698     IF FILE-SWITCH = 'STAT'
 12699        MOVE ER-0149             TO EMI-ERROR.
 12700
 12701     IF FILE-SWITCH = 'PROC'
 12702        MOVE ER-0019             TO EMI-ERROR.
 12703
 12704     IF FILE-SWITCH = 'ACCT'
 12705        MOVE ER-0198             TO EMI-ERROR.
 12706
 12707     IF FILE-SWITCH = 'BENE'
 12708        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12709           MOVE ER-0282          TO EMI-ERROR
 12710        ELSE
 12711           MOVE ER-0283          TO EMI-ERROR.
 12712
 12713     MOVE -1                     TO PMTTYPEL.
 12714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12715
 12716     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12717                                     WS-FORCE-CTR.
 12718
 12719     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12720                                     WS-FATAL-CTR.
 12721
 12722     GO TO 8200-SEND-DATAONLY.
 12723
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 244
* EL156.cbl
 12725 2000-EDIT-DONE.
 12726*********************
 12727     perform 2210-dcc-max-benes thru 2210-exit
 12728     if pi-company-id not = 'DCC'
 12729        IF (WS-SPECIAL-CALC-CD = 'C')
 12730           and (cl-critical-period > 0)
 12731           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12732              IF PI-EPYAMT > ZEROS
 12733                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12734                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12735              ELSE
 12736                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12737                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12738              END-IF
 12739              if ws-benefits-paid > cl-critical-period
 12740                 MOVE ER-0657          TO EMI-ERROR
 12741                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12742              END-IF
 12743           END-IF
 12744        END-IF
 12745     end-if
 12746     IF PI-HOLDTIL NOT = ZEROS
 12747        MOVE PI-HOLDTIL          TO HOLDTILO
 12748        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12749
 12750     IF PI-EPYFROM NOT = ZEROS
 12751        MOVE PI-EPYFROM          TO EPYFROMO
 12752        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12753
 12754     IF PI-EPYTHRU NOT = ZEROS
 12755        MOVE PI-EPYTHRU            TO EPYTHRUO
 12756        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12757        IF PI-USES-PAID-TO
 12758           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12759           MOVE '4'                TO DC-OPTION-CODE
 12760           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12761           IF NO-CONVERSION-ERROR
 12762              MOVE +1              TO DC-ELAPSED-DAYS
 12763              MOVE +0              TO DC-ELAPSED-MONTHS
 12764              MOVE '6'             TO DC-OPTION-CODE
 12765              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12766              IF NO-CONVERSION-ERROR
 12767                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12768
 12769     MOVE PI-EDAYS               TO EDAYSO.
 12770
 12771     IF PI-AIGFROM NOT = ZEROS
 12772        MOVE PI-AIGFROM          TO AIGFROMO
 12773        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12774
 12775     MOVE PI-EPYAMT              TO EPYAMTO.
 12776     MOVE PI-ERESV               TO ERESVO.
 12777     MOVE PI-EEXPENS             TO EEXPENSO.
 12778
 12779     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12780     MOVE SPACES                 TO DC-OPTION-CODE.
 12781     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12782
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 245
* EL156.cbl
 12783     IF DATE-CONVERSION-ERROR
 12784        MOVE SPACES              TO CPYFROMI
 12785     ELSE
 12786        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12787        IF PI-EPYFROM = ZEROS
 12788           MOVE AL-UANON             TO EPYFROMA
 12789           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12790           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12791
 12792     IF PI-USES-PAID-TO
 12793        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12794        MOVE +1                            TO DC-ELAPSED-DAYS
 12795        MOVE +0                            TO DC-ELAPSED-MONTHS
 12796        MOVE '6'                           TO DC-OPTION-CODE
 12797        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12798        IF NO-CONVERSION-ERROR
 12799           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12800           IF PI-EPYTHRU = ZEROS
 12801              MOVE AL-UANON                TO EPYTHRUA
 12802              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12803              MOVE ' '                     TO DC-OPTION-CODE
 12804              MOVE +0                      TO DC-ELAPSED-DAYS
 12805                                              DC-ELAPSED-MONTHS
 12806              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12807              IF NO-CONVERSION-ERROR
 12808                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12809                  GO TO 2001-CONTINUE
 12810              ELSE
 12811                  GO TO 2001-CONTINUE
 12812           ELSE
 12813              GO TO 2001-CONTINUE.
 12814
 12815     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12816     MOVE SPACES                 TO DC-OPTION-CODE.
 12817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12818
 12819     IF DATE-CONVERSION-ERROR
 12820        MOVE SPACES              TO CPYTHRUI
 12821     ELSE
 12822        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12823        IF PI-EPYTHRU = ZEROS
 12824           MOVE AL-UANON TO EPYTHRUA
 12825           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12826           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12827
 12828 2001-CONTINUE.
 12829
 12830     MOVE PI-CDAYS               TO CDAYSO.
 12831
 12832     IF PI-EDAYS = ZEROS
 12833        MOVE AL-UNNON TO EDAYSA
 12834        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12835
 12836     MOVE PI-CPYAMT              TO CPYAMTO.
 12837
 12838     IF PI-EPYAMT = ZEROS
 12839        MOVE AL-UNNON            TO EPYAMTA
 12840        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 246
* EL156.cbl
 12841
 12842     MOVE PI-CRESV               TO CRESVO.
 12843     MOVE PI-CEXPENS             TO CEXPENSO.
 12844
 12845     IF PI-EEXPENS = ZEROS
 12846        MOVE AL-UNNON TO EEXPENSA
 12847        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12848
 12849     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12850        AND (CL-CLAIM-TYPE = 'L')
 12851        AND (PI-OFFLINE NOT EQUAL 'Y')
 12852        IF PI-PMTTYPE = '2' OR '4'
 12853           PERFORM 2200-CALC-INTEREST
 12854                                 THRU 2200-EXIT
 12855        END-IF
 12856     END-IF
 12857     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12858     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12859     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12860
 12861     IF EMI-FATAL-CTR = ZEROS
 12862        MOVE 'B'                 TO PI-PASS-SW.
 12863
 12864     IF NOT EMI-MESSAGE-FORMATTED
 12865         MOVE -1                 TO EPYFROML
 12866     ELSE
 12867         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12868            EMI-ERROR-NUMBER (2) = SPACES
 12869             MOVE -1             TO EPYFROML.
 12870
 12871     GO TO 8200-SEND-DATAONLY.
 12872
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 247
* EL156.cbl
 12874 2200-CALC-INTEREST.
 12875     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12876        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12877        MOVE '4'                 TO DC-OPTION-CODE
 12878        PERFORM 9700-LINK-DATE-CONVERT
 12879        IF DATE-CONVERSION-ERROR
 12880            MOVE LOW-VALUES      TO CP-PRF-DT
 12881        ELSE
 12882           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12883        END-IF
 12884     END-IF
 12885     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12886        IN CLAIM-INT-PASS-AREA
 12887     MOVE CL-CERT-STATE          TO CP-STATE
 12888        IN CLAIM-INT-PASS-AREA
 12889     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12890     MOVE 'LF'                   TO CP-COVERAGE
 12891     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12892     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12893     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12894     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12895     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12896     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12897
 12898* EXEC CICS LINK
 12899*       PROGRAM   ('ELCLMI')
 12900*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12901*       LENGTH    (CP-CLAIM-LENGTH)
 12902*    END-EXEC
 12903     MOVE 'ELCLMI' TO DFHEIV1
 12904*    MOVE '."C                   (   #00012310' TO DFHEIV0
 12905     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12907     MOVE X'2020233030303132333130' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0,
 12909           DFHEIV1,
 12910           CLAIM-INT-PASS-AREA,
 12911           CP-CLAIM-LENGTH,
 12912           DFHEIV99,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99
 12916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12917     MOVE AL-PANOF               TO PINTHA
 12918                                    PINTA
 12919     IF NO-CI-ERROR
 12920        MOVE CP-CLM-INT-AMT      TO PINTO
 12921                                    PI-INT-AMT
 12922        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12923        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12924        MOVE AL-PANOF            TO PINTHA
 12925                                    PINTA
 12926     ELSE
 12927        IF CI-RETURN-CODE = '8'
 12928           MOVE ER-3818          TO EMI-ERROR
 12929           MOVE -1               TO ZINTL
 12930           PERFORM 9900-ERROR-FORMAT
 12931                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 248
* EL156.cbl
 12932           GO TO 2200-EXIT
 12933        ELSE
 12934           MOVE ZEROS            TO PINTO
 12935                                    PI-INT-AMT
 12936                                    PI-INT-DAYS
 12937                                    PI-INT-RATE-USED
 12938        END-IF
 12939     END-IF
 12940     IF PI-INT-AMT NOT = ZEROS
 12941        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12942           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12943           CONTINUE
 12944        ELSE
 12945           MOVE CL-SOC-SEC-NO (1:3)
 12946                                 TO WS-SSN (1:3)
 12947           MOVE CL-SOC-SEC-NO (5:2)
 12948                                 TO WS-SSN (4:2)
 12949           MOVE CL-SOC-SEC-NO (8:4)
 12950                                 TO WS-SSN (6:4)
 12951           IF (WS-SSN NUMERIC)
 12952              AND (WS-SSN NOT = ZEROS)
 12953              CONTINUE
 12954           ELSE
 12955              MOVE ER-2044       TO EMI-ERROR
 12956              PERFORM 9900-ERROR-FORMAT
 12957                                 THRU 9900-EXIT
 12958           END-IF
 12959        END-IF
 12960        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12961        MOVE +51                 TO TRLR-SEQ-NO
 12962
 12963* EXEC CICS READ
 12964*          DATASET  ('ELTRLR')
 12965*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12966*          RIDFLD   (ELTRLR-KEY)
 12967*          RESP     (WS-RESPONSE)
 12968*       END-EXEC
 12969     MOVE 'ELTRLR' TO DFHEIV1
 12970*    MOVE '&"S        E          (  N#00012360' TO DFHEIV0
 12971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12973     MOVE X'204E233030303132333630' TO DFHEIV0(25:11)
 12974     CALL 'kxdfhei1' USING DFHEIV0,
 12975           DFHEIV1,
 12976           DFHEIV20,
 12977           DFHEIV99,
 12978           ELTRLR-KEY,
 12979           DFHEIV99,
 12980           DFHEIV99,
 12981           DFHEIV99
 12982     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12983         DFHEIV20
 12984     MOVE EIBRESP  TO WS-RESPONSE
 12985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12986        IF (NOT WS-RESP-NORMAL)
 12987                    OR
 12988           ((WS-RESP-NORMAL)
 12989           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 249
* EL156.cbl
 12990           OR (AT-CITY-STATE = SPACES)))
 12991           MOVE ER-0874          TO EMI-ERROR
 12992           PERFORM 9900-ERROR-FORMAT
 12993                                 THRU 9900-EXIT
 12994        END-IF
 12995     END-IF
 12996     .
 12997 2200-EXIT.
 12998     EXIT.
 12999 2210-dcc-max-benes.
 13000
 13001     move pi-ah-term             to ws-max-bens
 13002     if cl-critical-period not = zeros and spaces
 13003        move cl-critical-period  to ws-max-bens
 13004     end-if
 13005     move cm-ah-benefit-amt      to ws-monthly-benefit
 13006     if pdef-found
 13007        and (pd-max-amt (p1) not = zeros)
 13008        and (pd-max-amt (p1) < ws-monthly-benefit)
 13009        move pd-max-amt (p1)     to ws-monthly-benefit
 13010     end-if
 13011
 13012     move cl-cert-key-data       to elcrtt-key (2:21)
 13013     move cl-company-cd          to ctrlr-comp-cd
 13014     move cl-cert-no             to ctrlr-cert-no
 13015     move 'B'                    to ctrlr-rec-type
 13016
 13017
 13018* EXEC CICS READ
 13019*       DATASET  ('ELCRTT')
 13020*       set      (address of CERTIFICATE-TRAILERS)
 13021*       RIDFLD   (ELCRTT-KEY)
 13022*       RESP     (WS-RESPONSE)
 13023*    END-EXEC
 13024     MOVE 'ELCRTT' TO DFHEIV1
 13025*    MOVE '&"S        E          (  N#00012397' TO DFHEIV0
 13026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13028     MOVE X'204E233030303132333937' TO DFHEIV0(25:11)
 13029     CALL 'kxdfhei1' USING DFHEIV0,
 13030           DFHEIV1,
 13031           DFHEIV20,
 13032           DFHEIV99,
 13033           ELCRTT-KEY,
 13034           DFHEIV99,
 13035           DFHEIV99,
 13036           DFHEIV99
 13037     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13038         DFHEIV20
 13039     MOVE EIBRESP  TO WS-RESPONSE
 13040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13041     IF not WS-RESP-NORMAL
 13042        go to 2210-exit
 13043     end-if
 13044
 13045*    if instypei = 'P'
 13046*       move +1 to s1
 13047*    else
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 250
* EL156.cbl
 13048*       MOVE +2 to s1
 13049*    end-if
 13050
 13051*    move +1 to s1
 13052*    evaluate cl-claim-type
 13053*       when 'A'
 13054*          move +1 to s2
 13055*       when 'I'
 13056*          move +2 to s2
 13057*       when 'G'
 13058*          move +3 to s2
 13059*       when 'L'
 13060*          move +4 to s2
 13061*       when 'P'
 13062*          move +5 to s2
 13063*    end-evaluate
 13064
 13065     move zeros                  to ws-prev-days-paid
 13066                                    ws-benefits-paid
 13067                                    ws-prev-amt-paid
 13068     perform varying s1 from +1 by +1 until
 13069        (s1 > +24)
 13070        or (cs-claim-type (s1) = spaces)
 13071        if pi-company-id not = 'DCC'
 13072           if cs-claim-type (s1) = cl-claim-type
 13073              compute ws-prev-days-paid =
 13074                 ws-prev-days-paid + cs-days-paid (s1)
 13075              compute ws-prev-amt-paid =
 13076                 ws-prev-amt-paid + cs-total-paid (s1)
 13077           end-if
 13078        else
 13079           if (cs-claim-type (s1) = cl-claim-type)
 13080              and (cs-benefit-period (s1) = cl-benefit-period)
 13081              and (cs-insured-type (s1) = cl-insured-type)
 13082              compute ws-prev-days-paid =
 13083                 ws-prev-days-paid + cs-days-paid (s1)
 13084              compute ws-prev-amt-paid =
 13085                 ws-prev-amt-paid + cs-total-paid (s1)
 13086           end-if
 13087        end-if
 13088     end-perform
 13089     if pi-epyamt > zeros
 13090        compute ws-benefits-paid =
 13091           (ws-prev-amt-paid + pi-epyamt)
 13092           / ws-monthly-benefit
 13093     else
 13094        compute ws-benefits-paid =
 13095           (ws-prev-amt-paid + pi-cpyamt)
 13096           / ws-monthly-benefit
 13097     end-if
 13098     if pi-company-id = 'DCC'
 13099     if cl-claim-type not = 'L' and 'P'
 13100        if ws-benefits-paid > ws-max-bens
 13101           move er-1658          to emi-error
 13102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103        end-if
 13104     end-if
 13105     end-if
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 251
* EL156.cbl
 13106*     if s1 < +25
 13107*        if pi-epyamt > zeros
 13108*           compute ws-benefits-paid =
 13109*              (cs-total-paid (s1) + PI-EPYAMT)
 13110*              / ws-monthly-benefit
 13111*        else
 13112*           compute ws-benefits-paid =
 13113*              (cs-total-paid (s1) + PI-CPYAMT)
 13114*              / ws-monthly-benefit
 13115*        end-if
 13116
 13117*       if ws-benefits-paid > pd-crit-period (p1)
 13118*        if ws-benefits-paid > ws-max-bens
 13119*           move er-1658          to emi-error
 13120*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13121*        end-if
 13122*     end-if
 13123     .
 13124 2210-exit.
 13125     exit.
 13126
 13127 2220-update-elcrtt.
 13128
 13129
 13130* EXEC CICS GETMAIN
 13131*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13132*       LENGTH   (ELCRTT-LENGTH)
 13133*       INITIMG  (GETMAIN-SPACE)
 13134*    END-EXEC
 13135*    MOVE ',"IL                  $   #00012491' TO DFHEIV0
 13136     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13137     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13138     MOVE X'2020233030303132343931' TO DFHEIV0(25:11)
 13139     CALL 'kxdfhei1' USING DFHEIV0,
 13140           DFHEIV20,
 13141           ELCRTT-LENGTH,
 13142           GETMAIN-SPACE
 13143     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13144         DFHEIV20
 13145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13146
 13147     move cl-cert-key-data       to elcrtt-key (2:21)
 13148     move cl-company-cd          to ctrlr-comp-cd
 13149     move cl-cert-no             to ctrlr-cert-no
 13150     move 'B'                    to ctrlr-rec-type
 13151
 13152
 13153* EXEC CICS READ
 13154*       UPDATE
 13155*       DATASET  (ELCRTT-DSID)
 13156*       into     (CERTIFICATE-TRAILERS)
 13157*       RIDFLD   (ELCRTT-KEY)
 13158*       RESP     (WS-RESPONSE)
 13159*    END-EXEC
 13160     MOVE LENGTH OF
 13161      CERTIFICATE-TRAILERS
 13162       TO DFHEIV11
 13163*    MOVE '&"IL       EU         (  N#00012502' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 252
* EL156.cbl
 13164     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13165     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13166     MOVE X'204E233030303132353032' TO DFHEIV0(25:11)
 13167     CALL 'kxdfhei1' USING DFHEIV0,
 13168           ELCRTT-DSID,
 13169           CERTIFICATE-TRAILERS,
 13170           DFHEIV11,
 13171           ELCRTT-KEY,
 13172           DFHEIV99,
 13173           DFHEIV99,
 13174           DFHEIV99
 13175     MOVE EIBRESP  TO WS-RESPONSE
 13176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13177
 13178     IF WS-RESP-NORMAL
 13179        perform 2225-upd-crt-trlr thru 2225-exit
 13180
 13181* EXEC CICS REWRITE
 13182*          DATASET  (ELCRTT-DSID)
 13183*          from     (CERTIFICATE-TRAILERS)
 13184*          RESP     (WS-RESPONSE)
 13185*       END-EXEC
 13186     MOVE LENGTH OF
 13187      CERTIFICATE-TRAILERS
 13188       TO DFHEIV11
 13189*    MOVE '&& L                  %  N#00012512' TO DFHEIV0
 13190     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13191     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13192     MOVE X'204E233030303132353132' TO DFHEIV0(25:11)
 13193     CALL 'kxdfhei1' USING DFHEIV0,
 13194           ELCRTT-DSID,
 13195           CERTIFICATE-TRAILERS,
 13196           DFHEIV11,
 13197           DFHEIV99
 13198     MOVE EIBRESP  TO WS-RESPONSE
 13199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13200     else
 13201        if ws-resp-notfnd
 13202           move 'CS'             to certificate-trailers
 13203           move cl-company-cd    to cs-company-cd
 13204           move cl-cert-key-data to cs-control-primary (2:21)
 13205           move cl-cert-no       to cs-cert-no
 13206           move 'B'              to cs-trailer-type
 13207           perform varying s1 from +1 by +1 until s1 > +24
 13208              move zeros         to cs-benefit-period (s1)
 13209                                    cs-days-paid (s1)
 13210                                    cs-total-paid (s1)
 13211                                    cs-remaining-bens (s1)
 13212           end-perform
 13213           perform 2225-upd-crt-trlr
 13214                                 thru 2225-exit
 13215
 13216* EXEC CICS WRITE
 13217*             DATASET  (ELCRTT-DSID)
 13218*             from     (CERTIFICATE-TRAILERS)
 13219*             RIDFLD   (cs-control-primary)
 13220*             RESP     (WS-RESPONSE)
 13221*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 253
* EL156.cbl
 13222     MOVE LENGTH OF
 13223      CERTIFICATE-TRAILERS
 13224       TO DFHEIV11
 13225*    MOVE '&$ L                  ''  N#00012532' TO DFHEIV0
 13226     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13228     MOVE X'204E233030303132353332' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           ELCRTT-DSID,
 13231           CERTIFICATE-TRAILERS,
 13232           DFHEIV11,
 13233           cs-control-primary,
 13234           DFHEIV99,
 13235           DFHEIV99
 13236     MOVE EIBRESP  TO WS-RESPONSE
 13237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13238        end-if
 13239     END-IF
 13240
 13241     .
 13242 2220-exit.
 13243     exit.
 13244
 13245 2225-upd-crt-trlr.
 13246
 13247*    if instypei = 'P'
 13248*       move +1 to s1
 13249*    else
 13250*       MOVE +2 to s1
 13251*    end-if
 13252
 13253*    move +1 to s1
 13254*    evaluate cl-claim-type
 13255*       when 'A'
 13256*          move +1 to s2
 13257*       when 'I'
 13258*          move +2 to s2
 13259*       when 'G'
 13260*          move +3 to s2
 13261*       when 'L'
 13262*          move +4 to s2
 13263*       when 'P'
 13264*          move +5 to s2
 13265*    end-evaluate
 13266     perform varying s1 from +1 by +1 until
 13267        (s1 > +24)
 13268        or (cl-claim-no = cs-claim-no (s1))
 13269     end-perform
 13270     if s1 < +25
 13271        compute cs-total-paid (s1) =
 13272           cs-total-paid (s1) + at-amount-paid
 13273        compute cs-days-paid (s1) =
 13274           cs-days-paid (s1) +  at-days-in-period
 13275*       compute cs-remaining-bens (s1) =
 13276*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13277        perform 2230-accum-bens-paid thru 2230-exit
 13278     end-if
 13279
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 254
* EL156.cbl
 13280     .
 13281 2225-exit.
 13282     exit.
 13283 2230-accum-bens-paid.
 13284     if cl-claim-type not = 'L' and 'P'
 13285        move pi-ah-term          to ws-max-bens
 13286        if cl-critical-period not = zeros and spaces
 13287           move cl-critical-period
 13288                                 to ws-max-bens
 13289        end-if
 13290     else
 13291        move 01                  to ws-max-bens
 13292     end-if
 13293     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13294     perform varying s2 from +1 by +1 until
 13295        (s2 > +24)
 13296        or (cs-claim-no (s2) = spaces)
 13297        if pi-company-id not = 'DCC'
 13298           if cs-claim-type (s2) = cl-claim-type
 13299              compute ws-tot-days-paid =
 13300                 ws-tot-days-paid + cs-days-paid (s2)
 13301              compute ws-tot-amt-paid =
 13302                 ws-tot-amt-paid + cs-total-paid (s2)
 13303           end-if
 13304        else
 13305           if (cs-benefit-period (s2) = cl-benefit-period)
 13306              and (cs-claim-type (s2) = cl-claim-type)
 13307              and (cs-insured-type (s2) = cl-insured-type)
 13308              compute ws-tot-days-paid =
 13309                 ws-tot-days-paid + cs-days-paid (s2)
 13310              compute ws-tot-amt-paid =
 13311                 ws-tot-amt-paid + cs-total-paid (s2)
 13312           end-if
 13313        end-if
 13314     end-perform
 13315     if cl-claim-type = 'L' and 'P'
 13316        if ws-tot-amt-paid > zeros
 13317           move zeros            to cs-remaining-bens (s1)
 13318        else
 13319           move 01               to cs-remaining-bens (s1)
 13320        end-if
 13321     else
 13322        compute ws-pd-bens rounded =
 13323           ws-tot-amt-paid / pi-ah-benefit-amt
 13324        compute cs-remaining-bens (s1) =
 13325           ws-max-bens - ws-pd-bens
 13326        if cs-remaining-bens (s1) < zeros
 13327           move zeros            to cs-remaining-bens (s1)
 13328        end-if
 13329     end-if
 13330     .
 13331 2230-exit.
 13332     exit.
 13333 3000-MOVE-INPUT-TO-SAVE-AREA.
 13334     IF PMTTYPEL > 0
 13335         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13336
 13337     MOVE SPACES                 TO PI-PROVISIONAL-IND.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 255
* EL156.cbl
 13338
 13339     IF WS-PMTTYPE = '9'
 13340         MOVE 'P'                TO PI-PROVISIONAL-IND
 13341         MOVE '1'                TO WS-PMTTYPE.
 13342
 13343     IF PAYEEL > 0
 13344         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13345         MOVE PAYEEI             TO WS-PAYEE.
 13346
 13347     IF NOTE1L > +0
 13348         MOVE NOTE1I             TO WS-PMTNOTE1
 13349                                    WS-FLI-PMTNOTE
 13350                                    WS-HAN-PMTNOTE.
 13351
 13352     IF NOTE2L > +0
 13353         MOVE NOTE2I             TO WS-PMTNOTE2.
 13354
 13355     IF OFFLINEL > 0
 13356         MOVE OFFLINEI           TO WS-OFFLINE.
 13357
 13358     IF PROOFDTL > 0
 13359         MOVE PROOFDTI            TO DATE-WORK
 13360         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13361         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13362         MOVE '4'                 TO DC-OPTION-CODE
 13363         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13364         IF NO-CONVERSION-ERROR
 13365            MOVE NUM-WORK         TO PROOFDTO
 13366            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13367            MOVE NUM-WORK         TO WS-PROOF-DATE
 13368         ELSE
 13369            MOVE ZEROS            TO WS-PROOF-DATE
 13370         END-IF
 13371     END-IF.
 13372
 13373     IF EOBYNL > +0
 13374         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13375         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13376     END-IF
 13377
 13378     IF CLMFMYNL > +0
 13379         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13380         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13381     END-IF
 13382
 13383     IF SURVYYNL > +0
 13384         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13385         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13386     END-IF
 13387
 13388     IF SPRELYNL > +0
 13389         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13390         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13391     END-IF
 13392*    IF GROUPEDL > +0
 13393*        MOVE GROUPEDI           TO WS-GROUPED.
 13394*
 13395*    IF CASHL > +0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 256
* EL156.cbl
 13396*       MOVE CASHI               TO WS-CASH.
 13397     IF LOANNOL > +0
 13398         MOVE LOANNOI            TO WS-LOAN-NO.
 13399
 13400     IF CHECKNOL > 0
 13401         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13402
 13403     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13404         IF WS-AIG-CREDIT-ENTERED
 13405             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13406             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13407             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13408             MOVE AL-UANON         TO CHECKNOA.
 13409
 13410     IF HOLDTILL > 0
 13411         MOVE HOLDTILI           TO DATE-WORK
 13412         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13413         MOVE NUM-WORK           TO WS-HOLDTIL.
 13414
 13415     IF ZINTL > +0
 13416
 13417* EXEC CICS BIF DEEDIT
 13418*           FIELD   (ZINTI)
 13419*           LENGTH  (07)
 13420*       END-EXEC
 13421     MOVE 07
 13422       TO DFHEIV11
 13423*    MOVE '@"L                   #   #00012716' TO DFHEIV0
 13424     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13425     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13426     MOVE X'2020233030303132373136' TO DFHEIV0(25:11)
 13427     CALL 'kxdfhei1' USING DFHEIV0,
 13428           ZINTI,
 13429           DFHEIV11
 13430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13431        IF ZINTI NOT NUMERIC
 13432           MOVE ER-0419          TO EMI-ERROR
 13433           PERFORM 9900-ERROR-FORMAT
 13434           MOVE AL-UABON         TO ZINTA
 13435           MOVE -1               TO ZINTL
 13436        ELSE
 13437           MOVE ZINTI            TO CP-INT-RATE
 13438                                    WS-INT-RATE
 13439           MOVE CP-INT-RATE      TO ZINTO
 13440           MOVE AL-UNNON         TO ZINTA
 13441        END-IF
 13442     ELSE
 13443        MOVE ZEROS               TO CP-INT-RATE
 13444     END-IF
 13445     IF EPYFROML > 0
 13446         MOVE EPYFROMI           TO DATE-WORK
 13447         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13448         MOVE NUM-WORK           TO WS-EPYFROM.
 13449
 13450     IF AIGFROML > 0
 13451         MOVE AIGFROMI           TO DATE-WORK
 13452         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13453         MOVE NUM-WORK           TO WS-AIGFROM
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 257
* EL156.cbl
 13454     ELSE
 13455         IF (AIGFROMI = LOW-VALUES) AND
 13456            (PI-AIGFROM NOT = ZEROS)
 13457              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13458
 13459     IF EPYTHRUL > +0
 13460        MOVE EPYTHRUI           TO DATE-WORK
 13461        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13462        MOVE NUM-WORK           TO WS-EPYTHRU
 13463        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13464        MOVE '4'                TO DC-OPTION-CODE
 13465        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13466        IF NO-CONVERSION-ERROR
 13467           IF PI-USES-PAID-TO
 13468              MOVE '6'                TO DC-OPTION-CODE
 13469              MOVE -1                 TO DC-ELAPSED-DAYS
 13470              MOVE +0                 TO DC-ELAPSED-MONTHS
 13471              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13472              IF NO-CONVERSION-ERROR
 13473                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13474                 MOVE ' '             TO DC-OPTION-CODE
 13475                 MOVE +0              TO DC-ELAPSED-DAYS
 13476                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13477              IF NO-CONVERSION-ERROR
 13478                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13479
 13480*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13481*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13482     IF EDAYSL > 0
 13483
 13484* EXEC CICS BIF DEEDIT
 13485*            FIELD(EDAYSI)
 13486*            LENGTH(6)
 13487*        END-EXEC
 13488     MOVE 6
 13489       TO DFHEIV11
 13490*    MOVE '@"L                   #   #00012772' TO DFHEIV0
 13491     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13493     MOVE X'2020233030303132373732' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           EDAYSI,
 13496           DFHEIV11
 13497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13498         MOVE EDAYSI             TO WS-DY-WORK
 13499         IF WS-DY-SIGN = SPACES
 13500            MOVE WS-DY-NUM       TO WS-EDAYS
 13501            ADD 0                TO WS-EDAYS
 13502         ELSE
 13503            MOVE EDAYSI          TO WS-EDAYS
 13504            ADD 0                TO WS-EDAYS.
 13505
 13506*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13507*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13508     IF EPYAMTL > 0
 13509
 13510* EXEC CICS BIF DEEDIT
 13511*            FIELD(EPYAMTI)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 258
* EL156.cbl
 13512*            LENGTH(10)
 13513*        END-EXEC
 13514     MOVE 10
 13515       TO DFHEIV11
 13516*    MOVE '@"L                   #   #00012787' TO DFHEIV0
 13517     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13519     MOVE X'2020233030303132373837' TO DFHEIV0(25:11)
 13520     CALL 'kxdfhei1' USING DFHEIV0,
 13521           EPYAMTI,
 13522           DFHEIV11
 13523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13524         MOVE EPYAMTI            TO WS-PY-WORK
 13525         IF WS-PY-SIGN = SPACES
 13526            MOVE WS-PY-NUM       TO WS-EPYAMT
 13527            ADD 0                TO WS-EPYAMT
 13528         ELSE
 13529            MOVE EPYAMTI         TO WS-EPYAMT
 13530            ADD 0                TO WS-EPYAMT.
 13531
 13532     IF ERESVL > 0
 13533
 13534* EXEC CICS BIF DEEDIT
 13535*            FIELD(ERESVI)
 13536*            LENGTH(9)
 13537*        END-EXEC
 13538     MOVE 9
 13539       TO DFHEIV11
 13540*    MOVE '@"L                   #   #00012800' TO DFHEIV0
 13541     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13543     MOVE X'2020233030303132383030' TO DFHEIV0(25:11)
 13544     CALL 'kxdfhei1' USING DFHEIV0,
 13545           ERESVI,
 13546           DFHEIV11
 13547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13548         MOVE ERESVI TO WS-ERESV.
 13549
 13550     IF EEXPENSL > 0
 13551
 13552* EXEC CICS BIF DEEDIT
 13553*            FIELD(EEXPENSI)
 13554*            LENGTH(8)
 13555*        END-EXEC
 13556     MOVE 8
 13557       TO DFHEIV11
 13558*    MOVE '@"L                   #   #00012807' TO DFHEIV0
 13559     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13560     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13561     MOVE X'2020233030303132383037' TO DFHEIV0(25:11)
 13562     CALL 'kxdfhei1' USING DFHEIV0,
 13563           EEXPENSI,
 13564           DFHEIV11
 13565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13566         MOVE EEXPENSI           TO WS-EEXPENS.
 13567
 13568     IF ETYPEL > ZEROS
 13569         MOVE ETYPEI             TO WS-ETYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 259
* EL156.cbl
 13570
 13571     IF PI-COMPANY-ID = 'BOA'
 13572        IF PINTL > ZEROS
 13573
 13574* EXEC CICS BIF DEEDIT
 13575*            FIELD (PINTI)
 13576*            LENGTH(05)
 13577*          END-EXEC
 13578     MOVE 05
 13579       TO DFHEIV11
 13580*    MOVE '@"L                   #   #00012818' TO DFHEIV0
 13581     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13582     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13583     MOVE X'2020233030303132383138' TO DFHEIV0(25:11)
 13584     CALL 'kxdfhei1' USING DFHEIV0,
 13585           PINTI,
 13586           DFHEIV11
 13587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13588           IF PINTI NUMERIC
 13589               MOVE AL-UNNON     TO PINTA
 13590               MOVE PINTI        TO WS-INT-RATE
 13591               MOVE WS-INT-RATE  TO PINTO.
 13592
 13593 3000-EXIT.
 13594     EXIT.
 13595
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 260
* EL156.cbl
 13597 3050-REBUILD-ENTERED.
 13598
 13599     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13600
 13601     IF PI-PROV-PMT
 13602         MOVE '9'           TO PMTTYPEO
 13603     ELSE
 13604         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13605
 13606     MOVE PI-PAYEE          TO PAYEEO.
 13607     MOVE PI-PMTNOTE1       TO NOTE1O.
 13608     MOVE PI-PMTNOTE2       TO NOTE2O.
 13609     MOVE PI-OFFLINE        TO OFFLINEO.
 13610     IF PI-PROOF-DATE NOT = ZEROS
 13611         MOVE PI-PROOF-DATE TO PROOFDTO
 13612         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13613     END-IF.
 13614*    MOVE PI-GROUPED        TO GROUPEDO.
 13615
 13616*    MOVE PI-CASH           TO CASHO.
 13617
 13618     IF PI-INT-RATE > ZEROS
 13619         MOVE PI-INT-RATE   TO PINTO.
 13620
 13621     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13622        IF PI-INT-AMT > ZEROS
 13623           MOVE PI-INT-AMT       TO PINTO
 13624           MOVE AL-PANOF         TO PINTA
 13625                                    PINTHA
 13626        END-IF
 13627     END-IF
 13628     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13629     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13630     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13631     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13632     IF PI-HOLDTIL NOT = ZEROS
 13633        MOVE PI-HOLDTIL          TO HOLDTILO
 13634        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13635
 13636     IF PI-EPYFROM NOT = ZEROS
 13637        MOVE PI-EPYFROM          TO EPYFROMO
 13638        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13639
 13640     IF PI-AIGFROM NOT = ZEROS
 13641        MOVE PI-AIGFROM          TO AIGFROMO
 13642        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13643
 13644     IF PI-EPYTHRU NOT = ZEROS
 13645        MOVE PI-EPYTHRU          TO EPYTHRUO
 13646        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13647        IF PI-USES-PAID-TO
 13648           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13649           MOVE '4'                TO DC-OPTION-CODE
 13650           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13651           IF NO-CONVERSION-ERROR
 13652              MOVE +1 TO DC-ELAPSED-DAYS
 13653              MOVE +0 TO DC-ELAPSED-MONTHS
 13654              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 261
* EL156.cbl
 13655              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13656              IF NO-CONVERSION-ERROR
 13657                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13658
 13659     IF PI-EDAYS NOT = ZEROS
 13660        MOVE PI-EDAYS TO EDAYSO.
 13661
 13662     IF PI-EPYAMT NOT = ZEROS
 13663        MOVE PI-EPYAMT TO EPYAMTO.
 13664
 13665     IF PI-ERESV NOT = ZEROS
 13666        MOVE PI-ERESV TO ERESVO.
 13667
 13668     IF PI-EEXPENS NOT = ZEROS
 13669        MOVE PI-EEXPENS TO EEXPENSO.
 13670
 13671     MOVE PI-ETYPE TO ETYPEO.
 13672
 13673     IF PI-ECHECKNO NOT = SPACES
 13674        MOVE PI-ECHECKNO         TO CHECKNOO
 13675     ELSE
 13676        MOVE PI-CCHECKNO         TO CHECKNOO.
 13677
 13678     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13679     MOVE SPACES                 TO DC-OPTION-CODE.
 13680     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13681
 13682     IF DATE-CONVERSION-ERROR
 13683        MOVE SPACES              TO CPYFROMI
 13684     ELSE
 13685        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13686
 13687     IF PI-USES-PAID-TO
 13688        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13689        MOVE +1                  TO DC-ELAPSED-DAYS
 13690        MOVE +0                  TO DC-ELAPSED-MONTHS
 13691        MOVE '6'                 TO DC-OPTION-CODE
 13692        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13693        IF NO-CONVERSION-ERROR
 13694           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13695           GO TO 3051-CONTINUE.
 13696
 13697     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13698     MOVE SPACES                 TO DC-OPTION-CODE.
 13699     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13700
 13701     IF DATE-CONVERSION-ERROR
 13702        MOVE SPACES              TO CPYTHRUI
 13703     ELSE
 13704        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13705
 13706 3051-CONTINUE.
 13707
 13708     IF PI-CDAYS NOT = ZEROS
 13709        MOVE PI-CDAYS TO CDAYSO.
 13710
 13711     IF PI-CPYAMT NOT = ZEROS
 13712        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 262
* EL156.cbl
 13713
 13714     IF PI-CRESV NOT = ZEROS
 13715        MOVE PI-CRESV TO CRESVO.
 13716
 13717     IF PI-CEXPENS NOT = ZEROS
 13718        MOVE PI-CEXPENS TO CEXPENSO.
 13719
 13720 3059-EXIT.
 13721     EXIT.
 13722
 13723 3100-DEEDIT-DATE.
 13724
 13725* EXEC CICS BIF DEEDIT
 13726*        FIELD(DATE-WORK)
 13727*        LENGTH(8)
 13728*    END-EXEC.
 13729     MOVE 8
 13730       TO DFHEIV11
 13731*    MOVE '@"L                   #   #00012958' TO DFHEIV0
 13732     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13734     MOVE X'2020233030303132393538' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           DATE-WORK,
 13737           DFHEIV11
 13738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13739
 13740
 13741 3100-EXIT.
 13742     EXIT.
 13743
 13744 3200-CALC-AIG-DAYS.
 13745
 13746     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13747
 13748     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13749     MOVE ' '                    TO DC-OPTION-CODE.
 13750     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13751     IF NO-CONVERSION-ERROR
 13752         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13753     ELSE
 13754         GO TO 3290-ERROR.
 13755
 13756     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13757         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13758                                WS-BIN-FROM-DT
 13759     ELSE
 13760         IF CL-TOTAL-PAID-AMT > ZEROS
 13761             IF WS-SV-EPYFROM = LOW-VALUES
 13762                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13763                                        WS-BIN-FROM-DT
 13764             ELSE
 13765                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13766                                        WS-BIN-FROM-DT
 13767         ELSE
 13768             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13769                                        WS-BIN-FROM-DT.
 13770
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 263
* EL156.cbl
 13771 3210-CONTINUE.
 13772
 13773     MOVE ' '                    TO DC-OPTION-CODE.
 13774     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13775     IF DATE-CONVERSION-ERROR
 13776         GO TO 3290-ERROR.
 13777
 13778     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13779
 13780     IF PI-LOAN-DUE-DAY = 31
 13781         MOVE 30              TO WS-PMT-DUE-DA
 13782                                 WS-SAVE-DUE-DA
 13783     ELSE
 13784         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13785                                 WS-SAVE-DUE-DA.
 13786
 13787     IF (PI-LOAN-DUE-DAY > 28) AND
 13788        (WS-PMT-DUE-MO = 2)
 13789         MOVE 'Y'                TO WS-DUE-DAY-SW
 13790         MOVE 28                 TO WS-PMT-DUE-DA.
 13791
 13792     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13793     MOVE '4'                    TO DC-OPTION-CODE.
 13794     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13795     IF NO-CONVERSION-ERROR
 13796         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13797     ELSE
 13798         GO TO 3290-ERROR.
 13799
 13800*--------------------------------------------------------------*
 13801*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13802*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13803*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13804*                                                              *
 13805*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13806*             INCURRED DATE      - 04/15/91                    *
 13807*             PMT DUE DATE       - 04/03/91                    *
 13808*             PMT DUE DATE       - 05/03/91                    *
 13809*--------------------------------------------------------------*
 13810
 13811     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13812        (WS-SV-AIGFROM = LOW-VALUES)
 13813         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13814            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13815             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13816             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13817             IF NO-CONVERSION-ERROR
 13818                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13819                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13820             ELSE
 13821                 GO TO 3290-ERROR.
 13822
 13823     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13824        (WS-SV-AIGFROM = LOW-VALUES)
 13825         GO TO 3205-CONT-CALC-PMT.
 13826
 13827     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13828     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 264
* EL156.cbl
 13829     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13830     IF NO-CONVERSION-ERROR
 13831         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13832     ELSE
 13833         GO TO 3290-ERROR.
 13834
 13835     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13836        (WS-PMT-DUE-DA < WS-FROM-DA)
 13837          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13838          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13839          IF NO-CONVERSION-ERROR
 13840              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13841              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13842          ELSE
 13843              GO TO 3290-ERROR.
 13844
 13845 3205-CONT-CALC-PMT.
 13846
 13847*--------------------------------------------------------------*
 13848*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13849*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13850*--------------------------------------------------------------*
 13851
 13852     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13853        PI-PMTTYPE = '2'
 13854          NEXT SENTENCE
 13855     ELSE
 13856        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13857           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13858             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13859             MOVE ER-3527            TO EMI-ERROR
 13860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13861             MOVE -1                 TO EPYTHRUL
 13862             MOVE AL-UNBON           TO EPYTHRUA
 13863                                        EPYFROMA
 13864             GO TO 3299-EXIT.
 13865
 13866*--------------------------------------------------------------*
 13867*    CALCULATE RETRO ELIMINATION DATE                          *
 13868*--------------------------------------------------------------*
 13869
 13870     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13871         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13872     ELSE
 13873         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13874
 13875     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13876     MOVE +0             TO DC-ELAPSED-MONTHS.
 13877     MOVE '6'            TO DC-OPTION-CODE.
 13878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13879     IF NO-CONVERSION-ERROR
 13880         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13881     ELSE
 13882         GO TO 3290-ERROR.
 13883
 13884 3210-CHECK-PMT-DATE.
 13885
 13886*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 265
* EL156.cbl
 13887*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13888*    THE ENTERED PAY FROM DATE                                 *
 13889*--------------------------------------------------------------*
 13890
 13891     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13892         NEXT SENTENCE
 13893     ELSE
 13894         GO TO 3220-COMPUTE-DAYS.
 13895
 13896     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13897     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13898     IF NO-CONVERSION-ERROR
 13899         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13900         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13901         GO TO 3210-CHECK-PMT-DATE
 13902     ELSE
 13903         GO TO 3290-ERROR.
 13904
 13905 3220-COMPUTE-DAYS.
 13906
 13907     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13908     MOVE ZEROS         TO WS-CDAYS.
 13909     MOVE 'N'           TO WS-ELIMINATION-SW.
 13910
 13911*--------------------------------------------------------------*
 13912*    COMPUTE CALIFORNIA DUE DAYS                               *
 13913*--------------------------------------------------------------*
 13914
 13915     IF CL-TOTAL-PAID-AMT > ZEROS
 13916         MOVE 'Y' TO WS-ELIMINATION-SW
 13917         GO TO 3240-FIRST-PMT-DUE
 13918     ELSE
 13919        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13920            NEXT SENTENCE
 13921        ELSE
 13922            GO TO 3240-FIRST-PMT-DUE.
 13923
 13924 3230-NEXT-PMT-DUE.
 13925
 13926     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13927     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13928     IF NO-CONVERSION-ERROR
 13929         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13930         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13931     ELSE
 13932         GO TO 3290-ERROR.
 13933
 13934 3240-FIRST-PMT-DUE.
 13935
 13936     IF CL-TOTAL-PAID-AMT > ZEROS
 13937         NEXT SENTENCE
 13938     ELSE
 13939        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13940            GO TO 3230-NEXT-PMT-DUE.
 13941
 13942     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13943         GO TO 3250-VERIFY-ELIMINATION.
 13944
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 266
* EL156.cbl
 13945     ADD +30 TO WS-CDAYS.
 13946     MOVE 'Y' TO WS-ELIMINATION-SW.
 13947     GO TO 3230-NEXT-PMT-DUE.
 13948
 13949 3250-VERIFY-ELIMINATION.
 13950
 13951     IF ELIM-SATISFIED
 13952         GO TO 3260-END-CALC.
 13953
 13954     IF PI-PMTTYPE = '1'
 13955         MOVE ZEROS TO WS-CDAYS
 13956         GO TO 3260-END-CALC.
 13957
 13958     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13959         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13960     ELSE
 13961         IF CL-TOTAL-PAID-AMT > ZEROS
 13962             IF WS-SV-EPYFROM = LOW-VALUES
 13963                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13964             ELSE
 13965                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13966         ELSE
 13967             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13968
 13969     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13970     MOVE '1'                    TO DC-OPTION-CODE.
 13971     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13972     IF NO-CONVERSION-ERROR
 13973         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13974     ELSE
 13975         GO TO 3290-ERROR.
 13976
 13977     IF CL-TOTAL-PAID-AMT > ZEROS
 13978         MOVE WS-DAYS-OFF TO WS-CDAYS
 13979     ELSE
 13980         IF PI-BEN-DAYS > WS-DAYS-OFF
 13981             MOVE ZEROS TO WS-CDAYS
 13982         ELSE
 13983             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13984
 13985 3260-END-CALC.
 13986
 13987     MOVE WS-CDAYS TO PI-CDAYS.
 13988
 13989     IF PI-EDAYS = ZEROS
 13990         MOVE PI-CDAYS TO PI-EDAYS
 13991         MOVE AL-UNNON TO EDAYSA.
 13992
 13993     GO TO 3299-EXIT.
 13994
 13995 3290-ERROR.
 13996
 13997     MOVE ER-3528            TO EMI-ERROR.
 13998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13999     MOVE -1                 TO CDAYSL.
 14000     MOVE AL-UNBON           TO CDAYSA.
 14001
 14002 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 267
* EL156.cbl
 14003     EXIT.
 14004
 14005 3300-BUMP-DATE.
 14006
 14007     IF WS-RESTORE-DUE-DAY
 14008         MOVE 'N'              TO WS-DUE-DAY-SW
 14009         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14010         ADD 1                 TO WS-PMT-DUE-MO
 14011         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14012         MOVE '4'              TO DC-OPTION-CODE
 14013         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14014         IF NO-CONVERSION-ERROR
 14015             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14016             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14017             GO TO 3399-EXIT
 14018         ELSE
 14019             MOVE '9'          TO DC-ERROR-CODE
 14020             GO TO 3399-EXIT.
 14021
 14022     IF (WS-PMT-DUE-MO = 1) AND
 14023        (WS-SAVE-DUE-DA > 28)
 14024           MOVE 'Y' TO WS-DUE-DAY-SW.
 14025
 14026     MOVE +0                 TO DC-ELAPSED-DAYS.
 14027     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14028     MOVE '6'                TO DC-OPTION-CODE.
 14029     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14030
 14031 3399-EXIT.
 14032     EXIT.
 14033
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 268
* EL156.cbl
 14035 3400-COMPUTE-EXPIRY.
 14036
 14037     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14038     MOVE +0                    TO DC-ELAPSED-DAYS
 14039                                   DC-ODD-DAYS-OVER.
 14040     MOVE '1'                   TO DC-END-OF-MONTH.
 14041     MOVE '6'                   TO DC-OPTION-CODE.
 14042
 14043     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14044         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14045     ELSE
 14046         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14047
 14048     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14049     IF NO-CONVERSION-ERROR
 14050         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14051     ELSE
 14052         GO TO 3390-CONTINUE.
 14053
 14054     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14055         GO TO 3390-CONTINUE.
 14056
 14057     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14058     MOVE '4'                    TO CNTL-REC-TYPE.
 14059     MOVE +0                     TO CNTL-SEQ-NO.
 14060     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14061     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14062     MOVE 'BENE'                 TO FILE-SWITCH.
 14063
 14064     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14065
 14066     IF NO-BENEFIT-FOUND
 14067         GO TO 3390-CONTINUE.
 14068
 14069     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14070        IF (PI-OFFLINE = 'Y') OR
 14071           (PI-PMTTYPE = '7')
 14072           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14073                                     THRU 9870-EXIT
 14074           IF ERROR-ON-OUTPUT
 14075             MOVE -1                 TO ENTERPFL
 14076             MOVE AL-UANON           TO ENTERPFA
 14077             MOVE MAP-NAMEA          TO MAP-NAME
 14078             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079             GO TO 8200-SEND-DATAONLY.
 14080
 14081     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14082        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14083        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14084          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14085          MOVE +0        TO DC-ELAPSED-DAYS
 14086          MOVE +1        TO DC-ELAPSED-MONTHS
 14087          MOVE 6         TO DC-OPTION-CODE
 14088          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14089          IF NO-CONVERSION-ERROR
 14090              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14091
 14092 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 269
* EL156.cbl
 14093
 14094      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14095         MOVE CM-AH-LOAN-EXPIRE-DT
 14096                                 TO DC-BIN-DATE-1
 14097      ELSE
 14098         MOVE CM-LF-LOAN-EXPIRE-DT
 14099                                 TO DC-BIN-DATE-1
 14100      END-IF
 14101
 14102      MOVE ' '                    TO DC-OPTION-CODE.
 14103      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14104      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14105      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14106
 14107 3499-EXIT.
 14108     EXIT.
 14109
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 270
* EL156.cbl
 14111
 14112 3600-CHECK-VERIFICATION.
 14113
 14114     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14115
 14116     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14117
 14118     IF PI-PAYEE-TYPE = 'I'
 14119        GO TO 3600-READ-TRAILER.
 14120
 14121     IF PI-PAYEE-TYPE = 'B'
 14122        ADD +10                  TO TRLR-SEQ-NO
 14123        GO TO 3600-READ-TRAILER.
 14124
 14125     IF PI-PAYEE-TYPE = 'A'
 14126        ADD +20                  TO TRLR-SEQ-NO
 14127        GO TO 3600-READ-TRAILER.
 14128
 14129     IF PI-PAYEE-TYPE = 'O'
 14130        ADD +50                  TO TRLR-SEQ-NO
 14131        GO TO 3600-READ-TRAILER.
 14132
 14133     IF PI-PAYEE-TYPE = 'Q'
 14134        ADD +60                  TO TRLR-SEQ-NO
 14135        GO TO 3600-READ-TRAILER.
 14136
 14137     IF PI-PAYEE-TYPE = 'P'
 14138        ADD +30                  TO TRLR-SEQ-NO
 14139        GO TO 3600-READ-TRAILER.
 14140
 14141     IF PI-PAYEE-TYPE = 'E'
 14142        ADD +40                  TO TRLR-SEQ-NO.
 14143
 14144 3600-READ-TRAILER.
 14145
 14146
 14147* EXEC CICS HANDLE CONDITION
 14148*         NOTFND(3600-CONTINUE)
 14149*    END-EXEC.
 14150*    MOVE '"$I                   ! - #00013368' TO DFHEIV0
 14151     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14153     MOVE X'2D20233030303133333638' TO DFHEIV0(25:11)
 14154     CALL 'kxdfhei1' USING DFHEIV0
 14155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14156
 14157
 14158     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14159
 14160 3600-CONTINUE.
 14161
 14162     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14163         GO TO 3600-AH-VERIFY
 14164     END-IF.
 14165
 14166     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14167       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14168         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 271
* EL156.cbl
 14169           MOVE ER-7576            TO EMI-ERROR
 14170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14171           MOVE -1                 TO PAYEEL
 14172           MOVE AL-UABON           TO PAYEEA
 14173           GO TO 3600-EXIT
 14174         END-IF
 14175       END-IF
 14176     END-IF.
 14177
 14178     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14179     MOVE 1 TO WS-SUB2
 14180     MOVE SPACES TO WS-PAYEE-NAME
 14181     PERFORM VARYING WS-SUB FROM 1 BY 1
 14182             UNTIL WS-SUB > 30
 14183         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14184            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14185                 WS-PAYEE-NAME-X (WS-SUB2)
 14186            ADD +1 TO WS-SUB2
 14187         END-IF
 14188     END-PERFORM.
 14189
 14190     STRING CL-INSURED-1ST-NAME
 14191            CL-INSURED-MID-INIT
 14192            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14193     MOVE 1 TO WS-SUB2
 14194     MOVE SPACES TO WS-INSURED-NAME
 14195     PERFORM VARYING WS-SUB FROM 1 BY 1
 14196             UNTIL WS-SUB > 30
 14197         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14198            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14199                 WS-INSURED-NAME-X (WS-SUB2)
 14200            ADD +1 TO WS-SUB2
 14201         END-IF
 14202     END-PERFORM.
 14203
 14204     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14205        MOVE ER-7579            TO EMI-ERROR
 14206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14207        MOVE -1                 TO PAYEEL
 14208        MOVE AL-UABON           TO PAYEEA
 14209     END-IF.
 14210
 14211     IF PI-PMTTYPE = '4'  AND
 14212        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14213        PI-PAYEE-TYPE <> 'I'
 14214          MOVE ER-7580          TO EMI-ERROR
 14215          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14216          MOVE -1               TO PAYEEL
 14217          MOVE AL-UABON         TO PAYEEA
 14218     END-IF.
 14219
 14220     GO TO 3600-EXIT.
 14221
 14222 3600-AH-VERIFY.
 14223
 14224     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14225        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14226           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 272
* EL156.cbl
 14227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14228           MOVE -1                 TO PAYEEL
 14229           MOVE AL-UABON           TO PAYEEA
 14230        END-IF
 14231     END-IF.
 14232
 14233
 14234 3600-EXIT.
 14235     EXIT.
 14236
 14237 5000-UPDATE.
 14238
 14239     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14240
 14241     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14242
 14243     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14244        PI-OFFLINE = 'Y'
 14245        NEXT SENTENCE
 14246     ELSE
 14247        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14248
 14249*    IF PI-COMPANY-ID = 'CRI'
 14250*       IF PI-PMTTYPE = '1' OR  '2'
 14251*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14252*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14253*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14254
 14255*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14256*       IF PI-PMTTYPE = '1'
 14257*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14258*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14259
 14260     IF PI-PMTTYPE      = '2' AND
 14261        PI-SPLIT-PMT-SW = 'Y' AND
 14262        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14263          MOVE ER-3530                TO EMI-ERROR
 14264          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14265
 14266     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14267        AND (CL-CLAIM-TYPE = 'L')
 14268        IF PI-PMTTYPE = '2' OR '4'
 14269           IF PI-INT-AMT NOT = ZEROS
 14270              PERFORM 7110-BUILD-PMT-TRLR
 14271                                 THRU 7130-EXIT
 14272           ELSE
 14273              IF PI-PMTTYPE = '2'
 14274                 PERFORM 7140-BUILD-NOTE-TRLR
 14275                                 THRU 7170-EXIT
 14276              END-IF
 14277           END-IF
 14278        END-IF
 14279     END-IF
 14280*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14281*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14282*            MOVE 'N'                 TO  WS-LETTER-SW.
 14283
 14284*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 273
* EL156.cbl
 14285*        IF CL-NO-OF-PMTS-MADE = +1
 14286*                OR
 14287*           PI-PMTTYPE = '2'
 14288*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14289
 14290     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14291
 14292*    IF PI-COMPANY-ID = 'DMD'
 14293*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14294*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14295
 14296
 14297* EXEC CICS REWRITE
 14298*         DATASET('ELMSTR')
 14299*         FROM(CLAIM-MASTER)
 14300*     END-EXEC.
 14301     MOVE LENGTH OF
 14302      CLAIM-MASTER
 14303       TO DFHEIV11
 14304     MOVE 'ELMSTR' TO DFHEIV1
 14305*    MOVE '&& L                  %   #00013510' TO DFHEIV0
 14306     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14307     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14308     MOVE X'2020233030303133353130' TO DFHEIV0(25:11)
 14309     CALL 'kxdfhei1' USING DFHEIV0,
 14310           DFHEIV1,
 14311           CLAIM-MASTER,
 14312           DFHEIV11,
 14313           DFHEIV99
 14314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14315
 14316
 14317     IF WS-LETTER-SW = 'N'
 14318         GO TO 5000-END-UPDATE.
 14319
 14320 5000-GENERATE-AUTO-LETTER.
 14321
 14322
 14323* EXEC CICS LINK
 14324*        PROGRAM    (LINK-1523)
 14325*        COMMAREA   (W-1523-LINKDATA)
 14326*        LENGTH     (W-1523-COMM-LENGTH)
 14327*    END-EXEC.
 14328*    MOVE '."C                   (   #00013520' TO DFHEIV0
 14329     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14331     MOVE X'2020233030303133353230' TO DFHEIV0(25:11)
 14332     CALL 'kxdfhei1' USING DFHEIV0,
 14333           LINK-1523,
 14334           W-1523-LINKDATA,
 14335           W-1523-COMM-LENGTH,
 14336           DFHEIV99,
 14337           DFHEIV99,
 14338           DFHEIV99,
 14339           DFHEIV99
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 274
* EL156.cbl
 14343     IF W-1523-FATAL-ERROR
 14344         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346         MOVE ER-0802                TO  EMI-ERROR
 14347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14348
 14349     IF W-1523-ERROR-CODE = 0191
 14350         MOVE ER-0803                TO  EMI-ERROR
 14351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14352
 14353     IF PI-COMPANY-ID      = 'HAN' AND
 14354        PI-PMTTYPE         = '1'   AND
 14355        PI-3RD-PARTY-SW    = 'Y'   AND
 14356        W-1523-FORM-NUMBER = 'EOB1'
 14357           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14358           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14359           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14360           GO TO 5000-GENERATE-AUTO-LETTER.
 14361
 14362 5000-END-UPDATE.
 14363
 14364     MOVE ER-0000                TO EMI-ERROR.
 14365     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14366     GO TO 7000-SHOW-CLAIM.
 14367
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 275
* EL156.cbl
 14369 5000-MOVE-NAME.
 14370     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14371     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14372     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14373
 14374 5000-EXIT.
 14375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 276
* EL156.cbl
 14377 5300-CREATE-DMO.
 14378
 14379     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14380     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14381     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14382
 14383
 14384* EXEC CICS HANDLE CONDITION
 14385*         NOTFND   (5300-NOTE-NOT-FOUND)
 14386*    END-EXEC.
 14387*    MOVE '"$I                   ! . #00013566' TO DFHEIV0
 14388     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14390     MOVE X'2E20233030303133353636' TO DFHEIV0(25:11)
 14391     CALL 'kxdfhei1' USING DFHEIV0
 14392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14393
 14394
 14395
 14396* EXEC CICS READ
 14397*         DATASET('ERNOTE')
 14398*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14399*         RIDFLD (W-NOTE-KEY)
 14400*    END-EXEC.
 14401     MOVE 'ERNOTE' TO DFHEIV1
 14402*    MOVE '&"S        E          (   #00013570' TO DFHEIV0
 14403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14405     MOVE X'2020233030303133353730' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           DFHEIV1,
 14408           DFHEIV20,
 14409           DFHEIV99,
 14410           W-NOTE-KEY,
 14411           DFHEIV99,
 14412           DFHEIV99,
 14413           DFHEIV99
 14414     SET ADDRESS OF CERTIFICATE-NOTE TO
 14415         DFHEIV20
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14417
 14418
 14419     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14420     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14421     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14422
 14423     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14424         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14425     ELSE
 14426         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14427
 14428     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14429     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14430     MOVE 'DLO006'               TO PGM-NAME.
 14431
 14432
 14433* EXEC CICS LINK
 14434*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 277
* EL156.cbl
 14435*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14436*        LENGTH     (DCT-RCRD-LENGTH)
 14437*    END-EXEC.
 14438*    MOVE '."C                   (   #00013589' TO DFHEIV0
 14439     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14441     MOVE X'2020233030303133353839' TO DFHEIV0(25:11)
 14442     CALL 'kxdfhei1' USING DFHEIV0,
 14443           PGM-NAME,
 14444           DCT-COMMUNICATION-AREA,
 14445           DCT-RCRD-LENGTH,
 14446           DFHEIV99,
 14447           DFHEIV99,
 14448           DFHEIV99,
 14449           DFHEIV99
 14450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14451
 14452
 14453     IF DCT-RETURN-CODE = 'OK'
 14454         GO TO 5300-CONT.
 14455
 14456     IF DCT-RETURN-CODE = '01' OR '02'
 14457         GO TO 5300-EXIT.
 14458
 14459     IF DCT-RETURN-CODE = '03'
 14460         MOVE ER-0951            TO EMI-ERROR
 14461         GO TO 5300-BAD-EXIT.
 14462
 14463     IF DCT-RETURN-CODE = '04'
 14464         MOVE ER-0946            TO EMI-ERROR
 14465         GO TO 5300-BAD-EXIT.
 14466
 14467     IF DCT-RETURN-CODE = '05'
 14468         MOVE ER-0947            TO EMI-ERROR
 14469         GO TO 5300-BAD-EXIT.
 14470
 14471     IF DCT-RETURN-CODE = '06'
 14472         MOVE ER-0921            TO EMI-ERROR
 14473         GO TO 5300-BAD-EXIT.
 14474
 14475     IF DCT-RETURN-CODE = '07'
 14476         MOVE ER-0849            TO EMI-ERROR
 14477         GO TO 5300-BAD-EXIT.
 14478
 14479     IF DCT-RETURN-CODE = '08'
 14480         MOVE ER-0948            TO EMI-ERROR
 14481         GO TO 5300-BAD-EXIT.
 14482
 14483     IF DCT-RETURN-CODE = 'N1'
 14484         MOVE ER-0950            TO EMI-ERROR
 14485         GO TO 5300-BAD-EXIT.
 14486
 14487     IF DCT-RETURN-CODE = 'E1'
 14488         MOVE ER-0974            TO EMI-ERROR
 14489         GO TO 5300-BAD-EXIT.
 14490
 14491     IF DCT-RETURN-CODE = 'E2'
 14492         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 278
* EL156.cbl
 14493         GO TO 5300-BAD-EXIT.
 14494
 14495     IF DCT-RETURN-CODE NOT = 'OK'
 14496         MOVE ER-0949            TO EMI-ERROR
 14497         GO TO 5300-BAD-EXIT.
 14498
 14499 5300-CONT.
 14500
 14501     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14502     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14503     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14504     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14505     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14506     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14507     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14508     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14509
 14510     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14511     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14512     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14513     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14514     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14515
 14516     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14517
 14518     IF PI-PMTTYPE = '2'
 14519         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14520         MOVE '4'                TO DM-CLAIM-STATUS
 14521     ELSE
 14522         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14523         MOVE '2'                TO DM-CLAIM-STATUS.
 14524
 14525     MOVE 'DLO025'               TO PGM-NAME.
 14526
 14527
 14528* EXEC CICS LINK
 14529*        PROGRAM    (PGM-NAME)
 14530*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14531*        LENGTH     (DM-DMO-LENGTH)
 14532*    END-EXEC.
 14533*    MOVE '."C                   (   #00013669' TO DFHEIV0
 14534     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14536     MOVE X'2020233030303133363639' TO DFHEIV0(25:11)
 14537     CALL 'kxdfhei1' USING DFHEIV0,
 14538           PGM-NAME,
 14539           DMO-COMMUNICATION-AREA,
 14540           DM-DMO-LENGTH,
 14541           DFHEIV99,
 14542           DFHEIV99,
 14543           DFHEIV99,
 14544           DFHEIV99
 14545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14546
 14547
 14548     IF DM-RETURN-CODE = 'OK'
 14549         GO TO 5300-EXIT.
 14550
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 279
* EL156.cbl
 14551     IF DM-RETURN-CODE = '01'
 14552         MOVE ER-8051            TO EMI-ERROR
 14553         GO TO 5300-BAD-EXIT.
 14554
 14555     IF DM-RETURN-CODE = '02'
 14556         MOVE ER-8052            TO EMI-ERROR
 14557         GO TO 5300-BAD-EXIT.
 14558
 14559     IF DM-RETURN-CODE = '03'
 14560         MOVE ER-8053            TO EMI-ERROR
 14561         GO TO 5300-BAD-EXIT.
 14562
 14563     IF DM-RETURN-CODE = '04'
 14564         MOVE ER-8054            TO EMI-ERROR
 14565         GO TO 5300-BAD-EXIT.
 14566
 14567     IF DM-RETURN-CODE = '05'
 14568         MOVE ER-8055            TO EMI-ERROR
 14569         GO TO 5300-BAD-EXIT.
 14570
 14571     IF DM-RETURN-CODE = '06'
 14572         MOVE ER-8056            TO EMI-ERROR
 14573         GO TO 5300-BAD-EXIT.
 14574
 14575     IF DM-RETURN-CODE = '07'
 14576         MOVE ER-8057            TO EMI-ERROR
 14577         GO TO 5300-BAD-EXIT.
 14578
 14579     IF DM-RETURN-CODE = '08'
 14580         MOVE ER-8058            TO EMI-ERROR
 14581         GO TO 5300-BAD-EXIT.
 14582
 14583     IF DM-RETURN-CODE = '09'
 14584         MOVE ER-8059            TO EMI-ERROR
 14585         GO TO 5300-BAD-EXIT.
 14586
 14587     IF DM-RETURN-CODE = '10'
 14588         MOVE ER-8060            TO EMI-ERROR
 14589         GO TO 5300-BAD-EXIT.
 14590
 14591     IF DM-RETURN-CODE = '11'
 14592         MOVE ER-8061            TO EMI-ERROR
 14593         GO TO 5300-BAD-EXIT.
 14594
 14595     IF DM-RETURN-CODE = '12'
 14596         MOVE ER-8062            TO EMI-ERROR
 14597         GO TO 5300-BAD-EXIT.
 14598
 14599     IF DM-RETURN-CODE = '13'
 14600         MOVE ER-8063            TO EMI-ERROR
 14601         GO TO 5300-BAD-EXIT.
 14602
 14603     IF DM-RETURN-CODE = '14'
 14604         MOVE ER-8064            TO EMI-ERROR
 14605         GO TO 5300-BAD-EXIT.
 14606
 14607     IF DM-RETURN-CODE = '15'
 14608         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 280
* EL156.cbl
 14609         GO TO 5300-BAD-EXIT.
 14610
 14611     IF DM-RETURN-CODE = '16'
 14612         MOVE ER-8154            TO EMI-ERROR
 14613         GO TO 5300-BAD-EXIT.
 14614
 14615     IF DM-RETURN-CODE = '17'
 14616         MOVE ER-8155            TO EMI-ERROR
 14617         GO TO 5300-BAD-EXIT.
 14618
 14619     IF DM-RETURN-CODE = 'N1'
 14620         MOVE ER-8152            TO EMI-ERROR
 14621         GO TO 5300-BAD-EXIT.
 14622
 14623     IF DM-RETURN-CODE = 'E1'
 14624         MOVE ER-8153            TO EMI-ERROR
 14625         GO TO 5300-BAD-EXIT.
 14626
 14627     MOVE ER-8066            TO EMI-ERROR.
 14628     GO TO 5300-BAD-EXIT.
 14629
 14630 5300-NOTE-NOT-FOUND.
 14631
 14632     MOVE ER-0954                TO EMI-ERROR.
 14633     GO TO 5300-BAD-EXIT.
 14634
 14635 5300-BAD-EXIT.
 14636
 14637* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14638*    MOVE '6"R                   !   #00013763' TO DFHEIV0
 14639     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14641     MOVE X'2020233030303133373633' TO DFHEIV0(25:11)
 14642     CALL 'kxdfhei1' USING DFHEIV0
 14643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14644
 14645     IF MAP-NAME = 'EL156A'
 14646         MOVE -1             TO ENTERPFL
 14647       ELSE
 14648         MOVE LOW-VALUES     TO EL156BI
 14649         MOVE -1             TO ENTPFBL.
 14650
 14651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14652     GO TO 8200-SEND-DATAONLY.
 14653
 14654 5300-EXIT.
 14655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 281
* EL156.cbl
 14657 5350-FORMAT-LAST-NAME-1ST.
 14658*****************************************************************
 14659*             M O V E   N A M E   R O U T I N E                 *
 14660*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14661*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14662*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14663*                  FIELD                   VALUE                *
 14664*           W-NAME-LAST    (CL15)      SMITH                    *
 14665*           W-NAME-FIRST   (CL15)      JOHN                     *
 14666*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14667*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14668*     CONTAIN                                                   *
 14669*                SMITH, JOHN ALLEN                              *
 14670*     OR                                                        *
 14671*                SMITH, JOHN A.                                 *
 14672*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14673*     COPYBOOK, ELCNWA.                                         *
 14674*****************************************************************.
 14675
 14676     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14677     MOVE ZERO                   TO  WS-NAME-SW.
 14678     SET NWA-INDEX               TO +1.
 14679
 14680     IF W-NAME-LAST   = SPACES AND
 14681        W-NAME-MIDDLE = SPACES
 14682         MOVE +1                 TO WS-NAME-SW.
 14683
 14684     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14685     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14686
 14687     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14688     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14689
 14690     SET NWA-INDEX UP BY +1.
 14691
 14692     IF W-NAME-MIDDLE NOT = SPACES
 14693         IF W-NAME-MIDDLE-2 = SPACES
 14694             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14695             SET NWA-INDEX UP BY +1
 14696             MOVE '.'            TO WS-NW (NWA-INDEX)
 14697             SET NWA-INDEX UP BY +2
 14698         ELSE
 14699             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14700             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14701
 14702 5350-EXIT.
 14703     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 282
* EL156.cbl
 14705 5360-MOVE-NAME.
 14706
 14707     IF WS-NAME-SW > +1
 14708         GO TO 5360-EXIT.
 14709
 14710     IF WS-NAME-WORK2 = SPACES
 14711         GO TO 5360-EXIT.
 14712
 14713     SET NWA-INDEX2            TO +1.
 14714     SET NWA-INDEX3            TO +2.
 14715
 14716 5360-MOVE-NAME-CYCLE.
 14717
 14718     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14719
 14720     IF NWA-INDEX < +30
 14721         SET NWA-INDEX UP BY +1
 14722     ELSE
 14723         ADD +2                TO  WS-NAME-SW
 14724         GO TO 5360-EXIT.
 14725
 14726     IF NWA-INDEX2 < +20
 14727         SET NWA-INDEX3 UP BY +1
 14728         SET NWA-INDEX2 UP BY +1.
 14729
 14730     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14731        WS-NW2 (NWA-INDEX3) = SPACES
 14732         IF WS-NAME-SW = ZERO
 14733             MOVE ','            TO  WS-NW (NWA-INDEX)
 14734             SET NWA-INDEX UP BY +2
 14735             MOVE +1             TO  WS-NAME-SW
 14736             GO TO 5360-EXIT
 14737         ELSE
 14738             GO TO 5360-EXIT.
 14739
 14740     GO TO 5360-MOVE-NAME-CYCLE.
 14741
 14742 5360-EXIT.
 14743     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 283
* EL156.cbl
 14745 6000-BUILD-SCREEN-B.
 14746     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14747     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14748     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14749     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14750
 14751     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14752
 14753 6050-BUILD-SCREEN.
 14754     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14755     MOVE LOW-VALUES             TO EL156BI.
 14756     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14757
 14758     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14759
 14760     IF PI-PAYEE-TYPE = 'I'
 14761        GO TO 6060-READ-TRAILER.
 14762
 14763     IF PI-PAYEE-TYPE = 'B'
 14764        ADD +10                  TO TRLR-SEQ-NO
 14765        GO TO 6060-READ-TRAILER.
 14766
 14767     IF PI-PAYEE-TYPE = 'A'
 14768        ADD +20                  TO TRLR-SEQ-NO
 14769        GO TO 6060-READ-TRAILER.
 14770
 14771     IF PI-PAYEE-TYPE = 'O'
 14772        ADD +50                  TO TRLR-SEQ-NO
 14773        GO TO 6060-READ-TRAILER.
 14774
 14775     IF PI-PAYEE-TYPE = 'Q'
 14776        ADD +60                  TO TRLR-SEQ-NO
 14777        GO TO 6060-READ-TRAILER.
 14778
 14779     IF PI-PAYEE-TYPE = 'P'
 14780        ADD +30                  TO TRLR-SEQ-NO
 14781        GO TO 6060-READ-TRAILER.
 14782
 14783     IF PI-PAYEE-TYPE = 'E'
 14784        ADD +40                  TO TRLR-SEQ-NO.
 14785
 14786 6060-READ-TRAILER.
 14787
 14788     IF PI-PAYEE-TYPE    = 'A' AND
 14789        PI-PAYEE-SEQ-NUM = 0
 14790          GO TO 6061-READ-ACCOUNT.
 14791
 14792     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14793        (PI-PAYEE-TYPE    = 'B')             AND
 14794        (PI-PAYEE-SEQ-NUM = 9)
 14795          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14796          IF BENE-FOUND-SW = 'N'
 14797            GO TO 6065-NOT-FOUND
 14798          ELSE
 14799            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14800            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14801            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14802*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 284
* EL156.cbl
 14803            STRING BE-CITY ' ' BE-STATE
 14804               DELIMITED BY '  ' INTO CITYSTBO
 14805            END-STRING
 14806            MOVE BE-ZIP-CODE       TO ZIPBO
 14807            GO TO 6061-READ-ACCOUNT.
 14808
 14809     IF PI-PAYEE-TYPE    = 'B' AND
 14810        PI-PAYEE-SEQ-NUM = 0
 14811          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14812          IF BENE-FOUND-SW = 'N'
 14813            GO TO 6065-NOT-FOUND
 14814          ELSE
 14815            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14816            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14817            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14818*           MOVE BE-CITY-STATE     TO CITYSTBO
 14819            STRING BE-CITY ' ' BE-STATE
 14820               DELIMITED BY '  ' INTO CITYSTBO
 14821            END-STRING
 14822            MOVE BE-ZIP-CODE       TO ZIPBO
 14823            GO TO 6061-READ-ACCOUNT.
 14824
 14825
 14826* EXEC CICS HANDLE CONDITION
 14827*         NOTFND(6065-NOT-FOUND)
 14828*     END-EXEC.
 14829*    MOVE '"$I                   ! / #00013944' TO DFHEIV0
 14830     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14832     MOVE X'2F20233030303133393434' TO DFHEIV0(25:11)
 14833     CALL 'kxdfhei1' USING DFHEIV0
 14834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14835
 14836
 14837     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14838
 14839     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14840     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14841     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14842     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14843*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14844     STRING AT-CITY ' ' AT-STATE
 14845        DELIMITED BY '  ' INTO CITYSTBO
 14846     END-STRING
 14847     MOVE AT-ZIP-CODE            TO ZIPBO.
 14848
 14849 6061-READ-ACCOUNT.
 14850
 14851* EXEC CICS HANDLE CONDITION
 14852*         NOTFND(6068-ACCT-NOT-FND)
 14853*     END-EXEC.
 14854*    MOVE '"$I                   ! 0 #00013961' TO DFHEIV0
 14855     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14857     MOVE X'3020233030303133393631' TO DFHEIV0(25:11)
 14858     CALL 'kxdfhei1' USING DFHEIV0
 14859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14860
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 285
* EL156.cbl
 14861
 14862
 14863* EXEC CICS READ
 14864*         DATASET('ERACCT')
 14865*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14866*         RIDFLD (PI-ACCT-KEY)
 14867*     END-EXEC.
 14868     MOVE 'ERACCT' TO DFHEIV1
 14869*    MOVE '&"S        E          (   #00013965' TO DFHEIV0
 14870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14871     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14872     MOVE X'2020233030303133393635' TO DFHEIV0(25:11)
 14873     CALL 'kxdfhei1' USING DFHEIV0,
 14874           DFHEIV1,
 14875           DFHEIV20,
 14876           DFHEIV99,
 14877           PI-ACCT-KEY,
 14878           DFHEIV99,
 14879           DFHEIV99,
 14880           DFHEIV99
 14881     SET ADDRESS OF ACCOUNT-MASTER TO
 14882         DFHEIV20
 14883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14884
 14885
 14886     MOVE AM-CARRIER             TO ACARRBO.
 14887     MOVE AM-GROUPING            TO GROUPBO.
 14888     MOVE AM-STATE               TO STATEBO.
 14889     MOVE AM-ACCOUNT             TO ACCTBO.
 14890     MOVE AM-NAME                TO ACCTNMBO.
 14891
 14892     IF PI-PAYEE-TYPE = 'A' AND
 14893        PI-PAYEE-SEQ-NUM = 0
 14894          MOVE AM-NAME             TO NAMEBO
 14895                                      PI-PAYEE-NAME
 14896          MOVE AM-ADDRS            TO ADDR1BO
 14897          MOVE SPACES              TO ADDR2BO
 14898*         MOVE AM-CITY             TO CITYSTBO
 14899          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14900             DELIMITED BY '  ' INTO CITYSTBO
 14901          END-STRING
 14902          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14903          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14904          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14905          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14906
 14907     IF CITYSTBO EQUAL SPACES
 14908         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14909         GO TO 6070-FORMAT-DATA
 14910     END-IF.
 14911
 14912     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14913     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14914     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14915     PERFORM VARYING WS-SUB FROM 30 BY -1
 14916          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14917        IF WS-END-SUB = 0  AND
 14918           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 286
* EL156.cbl
 14919              OR LOW-VALUES  OR '.')
 14920            CONTINUE
 14921        ELSE
 14922            IF WS-END-SUB = 0
 14923                MOVE WS-SUB TO WS-END-SUB
 14924            ELSE
 14925                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14926                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14927                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14928                END-IF
 14929            END-IF
 14930        END-IF
 14931        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14932            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14933            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14934        END-IF
 14935     END-PERFORM.
 14936
 14937     IF WS-BEG-SUB > 0
 14938         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14939         IF WS-STATE-LENGTH = 2
 14940             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14941                  TO PI-CHECK-STATE-FOR-AK
 14942         ELSE
 14943             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14944                'ALASKA'
 14945                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14946             ELSE
 14947                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14948             END-IF
 14949         END-IF
 14950     ELSE
 14951         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14952     END-IF.
 14953
 14954     GO TO 6070-FORMAT-DATA.
 14955
 14956 6065-NOT-FOUND.
 14957     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14958     GO TO 6061-READ-ACCOUNT.
 14959
 14960 6068-ACCT-NOT-FND.
 14961     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14962
 14963 6070-FORMAT-DATA.
 14964     IF PI-HOLDTIL = ZEROS
 14965        MOVE SAVE-DATE           TO PAYDTBI
 14966       ELSE
 14967        MOVE PI-HOLDTIL          TO PAYDTBO
 14968        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14969
 14970     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14971     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14972
 14973     IF EIBAID = DFHPF3 OR DFHPF4
 14974        NEXT SENTENCE
 14975     ELSE
 14976       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 287
* EL156.cbl
 14977
 14978     MOVE PI-EPYFROM          TO PYFROMBO.
 14979     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14980
 14981     IF NOT PI-USES-PAID-TO
 14982        MOVE PI-EPYTHRU          TO PYTHRUBO
 14983        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14984     ELSE
 14985        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14986        MOVE '4'              TO DC-OPTION-CODE
 14987        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14988        IF NO-CONVERSION-ERROR
 14989           MOVE +1            TO DC-ELAPSED-DAYS
 14990           MOVE +0            TO DC-ELAPSED-MONTHS
 14991           MOVE '6'           TO DC-OPTION-CODE
 14992           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14993           IF NO-CONVERSION-ERROR
 14994              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14995
 14996     MOVE PI-EDAYS            TO DAYSBO.
 14997     MOVE PI-EPYAMT           TO PAYAMTBO.
 14998     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14999        IF PI-INT-AMT > ZEROS
 15000           MOVE PI-INT-AMT       TO INTAMTBO
 15001        END-IF
 15002     END-IF
 15003     GO TO 6072-SET-TYPE.
 15004
 15005 6071-CONTINUE.
 15006
 15007     IF PI-CPYFROM NOT = LOW-VALUES
 15008        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15009        MOVE SPACES              TO DC-OPTION-CODE
 15010        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15011        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15012
 15013     IF PI-CPYTHRU NOT = LOW-VALUES
 15014        IF NOT PI-USES-PAID-TO
 15015           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15016           MOVE SPACES             TO DC-OPTION-CODE
 15017           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15018           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15019        ELSE
 15020           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15021           MOVE '6'                TO DC-OPTION-CODE
 15022           MOVE +1                 TO DC-ELAPSED-DAYS
 15023           MOVE +0                 TO DC-ELAPSED-MONTHS
 15024           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15025           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15026
 15027     MOVE PI-CDAYS               TO DAYSBO.
 15028     MOVE PI-CPYAMT              TO PAYAMTBO.
 15029     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15030        IF PI-INT-AMT > ZEROS
 15031           MOVE PI-INT-AMT       TO INTAMTBO
 15032        END-IF
 15033     END-IF
 15034     .
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 288
* EL156.cbl
 15035 6072-SET-TYPE.
 15036     IF PI-PMTTYPE = '1'
 15037        MOVE 'PARTIAL'           TO PAYTYPBO.
 15038
 15039     IF PI-PMTTYPE = '2'
 15040        MOVE 'FINAL'             TO PAYTYPBO.
 15041
 15042     IF PI-PMTTYPE = '3'
 15043        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15044
 15045     IF PI-PMTTYPE = '4'
 15046        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15047
 15048     IF PI-PMTTYPE = '5'
 15049        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15050
 15051     IF PI-PMTTYPE = '6'
 15052        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15053
 15054     IF PI-PROV-PMT
 15055        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15056
 15057     IF PI-ECHECKNO NOT = SPACES
 15058        MOVE PI-ECHECKNO         TO CKNUMBO
 15059     ELSE
 15060        MOVE PI-CCHECKNO         TO CKNUMBO.
 15061
 15062     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15063        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15064        MOVE +91                 TO  TRLR-SEQ-NO
 15065
 15066* EXEC CICS READ
 15067*           DATASET  ('ELTRLR')
 15068*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15069*           RIDFLD   (ELTRLR-KEY)
 15070*           RESP     (WS-RESPONSE)
 15071*       END-EXEC
 15072     MOVE 'ELTRLR' TO DFHEIV1
 15073*    MOVE '&"S        E          (  N#00014150' TO DFHEIV0
 15074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15076     MOVE X'204E233030303134313530' TO DFHEIV0(25:11)
 15077     CALL 'kxdfhei1' USING DFHEIV0,
 15078           DFHEIV1,
 15079           DFHEIV20,
 15080           DFHEIV99,
 15081           ELTRLR-KEY,
 15082           DFHEIV99,
 15083           DFHEIV99,
 15084           DFHEIV99
 15085     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15086         DFHEIV20
 15087     MOVE EIBRESP  TO WS-RESPONSE
 15088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15089
 15090        IF WS-RESP-NORMAL
 15091           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15092        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 289
* EL156.cbl
 15093           MOVE SPACES           TO  LOANNBO
 15094        END-IF
 15095     END-IF
 15096
 15097*       MOVE PI-LOAN-NO          TO LOANNBO
 15098
 15099     IF CKNUMBO = SPACES
 15100         MOVE SPACES             TO CKNUMHDO.
 15101
 15102     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15103     MOVE CL-CARRIER             TO CARRBO.
 15104     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15105     MOVE CL-CERT-SFX            TO SUFXBO.
 15106
 15107     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15108        EVALUATE CL-CLAIM-TYPE
 15109           WHEN 'I'
 15110              MOVE '  IU  '      TO CLMTYPBO
 15111           WHEN 'G'
 15112              MOVE ' GAP  '      TO CLMTYPBO
 15113           WHEN OTHER
 15114              MOVE PI-AH-OVERRIDE-L6
 15115                                 TO CLMTYPBO
 15116        END-EVALUATE
 15117        MOVE ZEROS               TO UNDISBO
 15118*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15119        IF PI-PMTTYPE = '5' OR '6'
 15120           GO TO 6073-GET-NOTIFY-DATA
 15121        ELSE
 15122           MOVE PI-DAILY-RATE    TO RATEBO
 15123           GO TO 6073-GET-NOTIFY-DATA.
 15124
 15125     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15126
 15127     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15128        MOVE ZEROS               TO UNDISBO
 15129     ELSE
 15130        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15131
 15132 6073-GET-NOTIFY-DATA.
 15133
 15134     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15135
 15136     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15137         MOVE SPACES             TO  NAMEB2O
 15138                                     ADDR1B2O
 15139                                     ADDR2B2O
 15140                                     CITYST2O
 15141                                     AGTHDGO
 15142         MOVE ZEROS              TO  ZIPB2O
 15143         GO TO 6080-SET-INCURRED.
 15144
 15145     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15146     MOVE +29                    TO  TRLR-SEQ-NO.
 15147
 15148
 15149* EXEC CICS HANDLE CONDITION
 15150*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 290
* EL156.cbl
 15151*    END-EXEC.
 15152*    MOVE '"$I                   ! 1 #00014215' TO DFHEIV0
 15153     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15154     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15155     MOVE X'3120233030303134323135' TO DFHEIV0(25:11)
 15156     CALL 'kxdfhei1' USING DFHEIV0
 15157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15158
 15159
 15160     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15161
 15162     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15163     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15164     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15165*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15166     STRING AT-CITY ' ' AT-STATE
 15167        DELIMITED BY '  ' INTO CITYST2O
 15168     END-STRING
 15169     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15170     GO TO 6080-SET-INCURRED.
 15171
 15172 6074-GET-COMP-DATA.
 15173
 15174     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15175         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15176
 15177     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15178         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15179                                         ADDR1B2O
 15180                                         ADDR2B2O
 15181                                         CITYST2O
 15182         MOVE ZEROS                  TO  ZIPB2O
 15183         GO TO 6080-SET-INCURRED.
 15184
 15185     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15186     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15187     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15188     MOVE AM-GROUPING            TO  COMP-GROUP.
 15189     MOVE 'A'                    TO  COMP-TYPE.
 15190     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15191                                 TO  COMP-FIN-RESP.
 15192
 15193     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15194         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15195                                       'G' OR 'B' or 'S'
 15196             MOVE 'G'            TO  COMP-TYPE
 15197             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15198         ELSE
 15199             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15200                                 TO  COMP-ACCOUNT
 15201     ELSE
 15202         MOVE 'G'                TO  COMP-TYPE
 15203         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15204
 15205     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15206
 15207     IF COMP-REC-FOUND
 15208         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 291
* EL156.cbl
 15209         MOVE CO-ADDR-1          TO  ADDR1B2O
 15210         MOVE CO-ADDR-2          TO  ADDR2B2O
 15211*        MOVE CO-ADDR-3          TO  CITYST2O
 15212         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15213            DELIMITED BY '  ' INTO CITYST2O
 15214         END-STRING
 15215         MOVE CO-ZIP             TO  ZIPB2O
 15216     ELSE
 15217         MOVE 'NO COMP ADDRESS AVAILABLE'
 15218                                 TO  NAMEB2O
 15219                                     ADDR1B2O
 15220                                     ADDR2B2O
 15221                                     CITYST2O
 15222         MOVE ZEROS               TO ZIPB2O.
 15223
 15224 6080-SET-INCURRED.
 15225     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15226     MOVE SPACES                 TO DC-OPTION-CODE.
 15227     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15228     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15229     MOVE PI-PROCESSOR-ID        TO BYBO.
 15230     MOVE MAP-NAMEB              TO MAP-NAME.
 15231     MOVE 'C'                    TO PI-PASS-SW.
 15232     MOVE EIBAID                 TO PI-PFKEY-USED.
 15233     MOVE -1                     TO ENTPFBL.
 15234     GO TO 8100-SEND-INITIAL-MAP.
 15235
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 292
* EL156.cbl
 15237 6100-BUILD-PAYMENT-TRAILER.
 15238
 15239     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15240       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15241         GO TO 6105-STATE-CHECK-NUMBER
 15242     END-IF.
 15243
 15244     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15245     MOVE '6'                    TO CNTL-REC-TYPE.
 15246
 15247     IF CONTROL-IS-ACTUAL-CARRIER
 15248         MOVE PI-CARRIER         TO WS-CARR
 15249     ELSE
 15250         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15251
 15252     IF PI-COMPANY-ID = 'FIA'
 15253         MOVE PI-CARRIER         TO  WS-CARR.
 15254
 15255     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15256     MOVE 0                      TO CNTL-SEQ-NO.
 15257     MOVE 'CARR'                 TO FILE-SWITCH.
 15258
 15259     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15260
 15261     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15262         IF PI-OFFLINE     = 'Y' AND
 15263            PI-ECHECKNO-CR = 'CR'
 15264              GO TO 6110-READ-CONTROL
 15265         ELSE
 15266            IF PI-CASH = 'N'
 15267                GO TO 6110-READ-CONTROL.
 15268
 15269     IF CHECK-NO-MANUAL    OR
 15270        CHECK-NO-AT-PRINT  OR
 15271        PI-OFFLINE = 'Y'
 15272          GO TO 6130-BUILD-TRAILER.
 15273
 15274     IF PI-COMPANY-ID = 'FIA'
 15275         NEXT SENTENCE
 15276     ELSE
 15277         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15278             GO TO 6110-READ-CONTROL.
 15279
 15280     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15281
 15282     IF CHECK-CNT-RESET-VALUE
 15283        MOVE +1                  TO CF-CHECK-COUNTER
 15284     ELSE
 15285        ADD +1                   TO CF-CHECK-COUNTER.
 15286
 15287     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15288
 15289     IF CHECK-NO-CARR-SEQ
 15290        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15291
 15292     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15293
 15294     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 293
* EL156.cbl
 15295     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15296        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15297         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15298         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15299            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15300         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15301                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15302     END-IF.
 15303
 15304     GO TO 6120-REWRITE.
 15305
 15306 6105-STATE-CHECK-NUMBER.
 15307     IF CHECK-NO-MANUAL    OR
 15308        CHECK-NO-AT-PRINT  OR
 15309        PI-OFFLINE = 'Y'
 15310           GO TO 6130-BUILD-TRAILER
 15311     END-IF.
 15312
 15313     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15314     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15315     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15316     MOVE '3'                TO CNTL-REC-TYPE.
 15317     MOVE +0                 TO CNTL-SEQ-NO.
 15318     MOVE 'STAT'             TO FILE-SWITCH.
 15319     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15320
 15321     IF CF-ST-CHECK-CNT-RESET
 15322         MOVE +1             TO CF-ST-CHECK-COUNTER
 15323     ELSE
 15324         ADD +1              TO CF-ST-CHECK-COUNTER
 15325     END-IF.
 15326
 15327     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15328     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15329     GO TO 6120-REWRITE.
 15330
 15331 6110-READ-CONTROL.
 15332     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15333     MOVE '1'                    TO CNTL-REC-TYPE.
 15334     MOVE SPACES                 TO CNTL-ACCESS.
 15335     MOVE 0                      TO CNTL-SEQ-NO.
 15336
 15337     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15338
 15339     IF CO-CHECK-COUNT-RESET
 15340        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15341     ELSE
 15342        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15343
 15344     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15345
 15346     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15347         IF PI-OFFLINE     = 'Y'  AND
 15348            PI-ECHECKNO-CR = 'CR'
 15349              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15350              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15351              MOVE AL-UANON           TO CHECKNOA
 15352              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 294
* EL156.cbl
 15353         ELSE
 15354         IF PI-CASH = 'N'
 15355             MOVE 'N'                TO PI-ECHECKNO-N
 15356             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15357             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15358             MOVE AL-UANON           TO CHECKNOA
 15359             GO TO 6120-REWRITE.
 15360
 15361     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15362
 15363 6120-REWRITE.
 15364
 15365* EXEC CICS REWRITE
 15366*         DATASET('ELCNTL')
 15367*         FROM(CONTROL-FILE)
 15368*     END-EXEC.
 15369     MOVE LENGTH OF
 15370      CONTROL-FILE
 15371       TO DFHEIV11
 15372     MOVE 'ELCNTL' TO DFHEIV1
 15373*    MOVE '&& L                  %   #00014423' TO DFHEIV0
 15374     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15375     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15376     MOVE X'2020233030303134343233' TO DFHEIV0(25:11)
 15377     CALL 'kxdfhei1' USING DFHEIV0,
 15378           DFHEIV1,
 15379           CONTROL-FILE,
 15380           DFHEIV11,
 15381           DFHEIV99
 15382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15383
 15384
 15385     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15386
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 295
* EL156.cbl
 15388 6130-BUILD-TRAILER.
 15389
 15390
 15391* EXEC CICS GETMAIN
 15392*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15393*         LENGTH    (200)
 15394*         INITIMG   (GETMAIN-SPACE)
 15395*     END-EXEC.
 15396     MOVE 200
 15397       TO DFHEIV11
 15398*    MOVE ',"IL                  $   #00014433' TO DFHEIV0
 15399     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15401     MOVE X'2020233030303134343333' TO DFHEIV0(25:11)
 15402     CALL 'kxdfhei1' USING DFHEIV0,
 15403           DFHEIV20,
 15404           DFHEIV11,
 15405           GETMAIN-SPACE
 15406     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15407         DFHEIV20
 15408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15409
 15410
 15411     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15412                                    AT-PREV-PAID-THRU-DT.
 15413     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15414     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15415     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15416     MOVE 'AT'                   TO AT-RECORD-ID.
 15417     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15418
 15419     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15420        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15421           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15422     ELSE
 15423           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15424           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15425
 15426     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15427         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15428             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15429             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15430           ELSE
 15431             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15432             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15433
 15434     MOVE '2'                    TO AT-TRAILER-TYPE.
 15435     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15436                                    AT-PAYMENT-LAST-MAINT-DT.
 15437     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15438                                    AT-PAYMENT-LAST-UPDATED-BY.
 15439     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15440     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15441     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15442     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15443
 15444     IF PI-PMT-APPROVED
 15445        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 296
* EL156.cbl
 15446           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15447
 15448     IF PI-PFKEY-USED = DFHPF5
 15449        GO TO 6140-PF5-ENTERED.
 15450
 15451     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15452     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15453
 15454     IF PI-AIG-SPECIAL-BENEFIT
 15455         IF WS-1ST-SPECIAL-PMT
 15456             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15457             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15458                                        AT-AMOUNT-PAID
 15459         ELSE
 15460             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15461
 15462     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15463
 15464     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15465     MOVE '4'                    TO DC-OPTION-CODE.
 15466     PERFORM 9700-LINK-DATE-CONVERT.
 15467
 15468     IF DATE-CONVERSION-ERROR
 15469        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15470     ELSE
 15471        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15472
 15473     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15474     MOVE '4'                    TO DC-OPTION-CODE.
 15475     PERFORM 9700-LINK-DATE-CONVERT.
 15476
 15477     IF DATE-CONVERSION-ERROR
 15478        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15479     ELSE
 15480        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15481
 15482     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15483     GO TO 6150-FINISH-MOVE.
 15484
 15485 6140-PF5-ENTERED.
 15486     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15487     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15488
 15489     IF PI-AIG-SPECIAL-BENEFIT
 15490         IF WS-1ST-SPECIAL-PMT
 15491             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15492             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15493                                        AT-AMOUNT-PAID
 15494         ELSE
 15495             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15496
 15497     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15498     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15499     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15500
 15501 6150-FINISH-MOVE.
 15502
 15503     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 297
* EL156.cbl
 15504         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15505     ELSE
 15506         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15507
 15508     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15509     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15510
 15511*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15512*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15513
 15514     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15515         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15516
 15517     IF PI-OFFLINE = 'N'
 15518        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15519        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15520     ELSE
 15521        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15522        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15523
 15524     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15525
 15526     IF WS-2ND-SPECIAL-PMT
 15527         MOVE 'Y'                TO AT-CASH-PAYMENT
 15528         MOVE SPACES             TO AT-CHECK-NO
 15529         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15530         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15531         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15532         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15533
 15534     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15535                                    AT-TO-BE-WRITTEN-DT.
 15536
 15537     IF PI-HOLDTIL NOT = ZEROS
 15538        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15539        MOVE '4'                 TO DC-OPTION-CODE
 15540        PERFORM 9700-LINK-DATE-CONVERT
 15541        IF PI-OFFLINE = 'N'
 15542           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15543        ELSE
 15544           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15545
 15546     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15547     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15548                                    AT-CHECK-QUE-SEQUENCE.
 15549
 15550     IF PI-PFKEY-USED = DFHPF4
 15551        MOVE '1'                 TO AT-FORCE-CONTROL.
 15552
 15553     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15554        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15555        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15556        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15557
 15558     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15559                                    AT-VOID-SELECT-DT
 15560                                    AT-VOID-ACCEPT-DT
 15561                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 298
* EL156.cbl
 15562     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15563        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15564        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15565        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15566        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15567     ELSE
 15568        MOVE ZEROS               TO AT-DAILY-RATE
 15569                                    AT-ELIMINATION-DAYS
 15570        MOVE SPACES              TO AT-BENEFIT-TYPE
 15571     END-IF
 15572     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15573     MOVE '4'                    TO DC-OPTION-CODE.
 15574     PERFORM 9700-LINK-DATE-CONVERT.
 15575     IF DATE-CONVERSION-ERROR
 15576         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15577     ELSE
 15578         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15579     END-IF.
 15580     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15581     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15582     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15583     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15584     IF (PI-REAUDIT-NEEDED = 'Y')
 15585        or (pi-max-ext-used = 'Y')
 15586        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15587         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15588         MOVE 'Y' TO WS-NEED-APPROVAL
 15589         GO TO 6170-WRITE
 15590     END-IF.
 15591*******************************************************
 15592     IF NOT PI-PMT-GRADUATED
 15593         GO TO 6170-WRITE.
 15594
 15595     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15596     MOVE '1'                    TO CNTL-REC-TYPE.
 15597     MOVE SPACES                 TO CNTL-ACCESS.
 15598     MOVE +0                     TO CNTL-SEQ-NO.
 15599     MOVE 'COMP'                 TO FILE-SWITCH.
 15600
 15601     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15602
 15603     IF PAID-FOR-LIFE
 15604         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15605             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15606                                     WS-PMT-APPROVAL-SW
 15607             GO TO 6170-WRITE.
 15608
 15609*05999      IF PAID-FOR-AH
 15610     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15611         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15612             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15613                                     WS-PMT-APPROVAL-SW
 15614             GO TO 6170-WRITE.
 15615
 15616     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15617
 15618******A&H Limits are set as a monthly payment.  Calculate the mont
 15619******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 299
* EL156.cbl
 15620     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15621        PI-SAVE-ODD-DAYS-OVER > 0
 15622           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15623                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15624           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15625                                  WS-CALC-PMT-MONTHS
 15626     ELSE
 15627           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15628     END-IF.
 15629*06007      IF ((PAID-FOR-AH) AND
 15630     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15631*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15632        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15633              OR
 15634        ((PAID-FOR-LIFE) AND
 15635        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15636            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15637       ELSE
 15638*06014      IF ((PAID-FOR-AH)  AND
 15639         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15640*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15641           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15642              OR
 15643        ((PAID-FOR-LIFE) AND
 15644        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15645            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15646         ELSE
 15647*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15648           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15649               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15650              OR
 15651          ((PAID-FOR-LIFE) AND
 15652          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15653            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15654       ELSE
 15655           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15656               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15657              OR
 15658          ((PAID-FOR-LIFE) AND
 15659          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15660            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15661       ELSE
 15662            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15663
 15664     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15665        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15666        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15667            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15668        END-IF
 15669     ELSE
 15670     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15671        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15672        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15673            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15674        END-IF
 15675     ELSE
 15676     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15677        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 300
* EL156.cbl
 15678        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15679            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15680        END-IF
 15681     ELSE
 15682     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15683        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15684        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15685            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15686        END-IF
 15687     ELSE
 15688     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15689            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15690
 15691     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15692
 15693     IF NOT PI-PMT-GRADUATED
 15694         GO TO 6170-WRITE.
 15695
 15696
 15697* EXEC CICS HANDLE CONDITION
 15698*        NOTFND   (6170-WRITE)
 15699*    END-EXEC.
 15700*    MOVE '"$I                   ! 2 #00014724' TO DFHEIV0
 15701     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15703     MOVE X'3220233030303134373234' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0
 15705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15706
 15707
 15708     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15709     MOVE '2'                    TO CNTL-REC-TYPE.
 15710     MOVE +0                     TO CNTL-SEQ-NO.
 15711     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15712
 15713
 15714* EXEC CICS READ
 15715*         DATASET  ('ELCNTL')
 15716*         SET      (ADDRESS OF CONTROL-FILE)
 15717*         RIDFLD   (ELCNTL-KEY)
 15718*    END-EXEC.
 15719     MOVE 'ELCNTL' TO DFHEIV1
 15720*    MOVE '&"S        E          (   #00014733' TO DFHEIV0
 15721     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15723     MOVE X'2020233030303134373333' TO DFHEIV0(25:11)
 15724     CALL 'kxdfhei1' USING DFHEIV0,
 15725           DFHEIV1,
 15726           DFHEIV20,
 15727           DFHEIV99,
 15728           ELCNTL-KEY,
 15729           DFHEIV99,
 15730           DFHEIV99,
 15731           DFHEIV99
 15732     SET ADDRESS OF CONTROL-FILE TO
 15733         DFHEIV20
 15734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15735
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 301
* EL156.cbl
 15736
 15737     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15738
 15739     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15740                         OR '4' OR '5'
 15741         NEXT SENTENCE
 15742     ELSE
 15743         MOVE 'Y' TO WS-NEED-APPROVAL
 15744         GO TO 6170-WRITE.
 15745
 15746     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15747         MOVE 'Y' TO WS-NEED-APPROVAL
 15748         IF WS-APPROVAL-LEVEL = '1'
 15749             MOVE '2'        TO  AT-APPROVED-LEVEL
 15750                            WS-SAVE-APPROVED-LEVEL
 15751             GO TO 6170-WRITE
 15752         ELSE
 15753             IF WS-APPROVAL-LEVEL = '2'
 15754                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15755                                WS-SAVE-APPROVED-LEVEL
 15756                 GO TO 6170-WRITE
 15757             ELSE IF WS-APPROVAL-LEVEL = '3'
 15758                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15759                                WS-SAVE-APPROVED-LEVEL
 15760                 GO TO 6170-WRITE
 15761             ELSE IF WS-APPROVAL-LEVEL = '4'
 15762                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15763                                WS-SAVE-APPROVED-LEVEL
 15764                 GO TO 6170-WRITE.
 15765
 15766     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15767                             WS-PMT-APPROVAL-SW.
 15768     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15769                             AT-APPROVAL-LEVEL-REQD.
 15770
 15771*******************************************************
 15772
 15773 6170-WRITE.
 15774
 15775     if pi-company-id = 'DCC'
 15776        PERFORM 0900-GET-DDF-limits
 15777                                 THRU 0900-EXIT
 15778     end-if
 15779     perform 2220-update-elcrtt  thru 2220-exit
 15780     IF PI-COMPANY-ID = 'DMD'
 15781        IF PI-AT-EOB-CODES NOT = SPACES
 15782           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15783           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15784           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15785           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15786           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15787
 15788
 15789* EXEC CICS HANDLE CONDITION
 15790*        DUPREC    (6180-DUPREC)
 15791*    END-EXEC.
 15792*    MOVE '"$%                   ! 3 #00014790' TO DFHEIV0
 15793     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 302
* EL156.cbl
 15794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15795     MOVE X'3320233030303134373930' TO DFHEIV0(25:11)
 15796     CALL 'kxdfhei1' USING DFHEIV0
 15797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15798
 15799
 15800
 15801* EXEC CICS WRITE
 15802*         DATASET       ('ELTRLR')
 15803*         FROM          (ACTIVITY-TRAILERS)
 15804*         RIDFLD        (AT-CONTROL-PRIMARY)
 15805*     END-EXEC.
 15806     MOVE LENGTH OF
 15807      ACTIVITY-TRAILERS
 15808       TO DFHEIV11
 15809     MOVE 'ELTRLR' TO DFHEIV1
 15810*    MOVE '&$ L                  ''   #00014794' TO DFHEIV0
 15811     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15813     MOVE X'2020233030303134373934' TO DFHEIV0(25:11)
 15814     CALL 'kxdfhei1' USING DFHEIV0,
 15815           DFHEIV1,
 15816           ACTIVITY-TRAILERS,
 15817           DFHEIV11,
 15818           AT-CONTROL-PRIMARY,
 15819           DFHEIV99,
 15820           DFHEIV99
 15821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15822
 15823
 15824     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15825        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15826*06088           GO TO 6199-EXIT.
 15827           GO TO 6176-APPROVAL-NOTE.
 15828
 15829
 15830* EXEC CICS GETMAIN
 15831*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15832*         LENGTH    (200)
 15833*         INITIMG   (GETMAIN-SPACE)
 15834*     END-EXEC.
 15835     MOVE 200
 15836       TO DFHEIV11
 15837*    MOVE ',"IL                  $   #00014805' TO DFHEIV0
 15838     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15839     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15840     MOVE X'2020233030303134383035' TO DFHEIV0(25:11)
 15841     CALL 'kxdfhei1' USING DFHEIV0,
 15842           DFHEIV20,
 15843           DFHEIV11,
 15844           GETMAIN-SPACE
 15845     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15846         DFHEIV20
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15851
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 303
* EL156.cbl
 15852     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15853     MOVE 'AT'                   TO AT-RECORD-ID.
 15854     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15855     MOVE '6'                    TO AT-TRAILER-TYPE.
 15856     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15857                                    AT-GEN-INFO-LAST-MAINT-DT
 15858     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15859                                    AT-GEN-INFO-LAST-UPDATED-BY
 15860     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15861
 15862     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15863     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15864     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15865
 15866     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15867
 15868 6175-WRITE.
 15869
 15870
 15871* EXEC CICS HANDLE CONDITION
 15872*        DUPREC    (6190-DUPREC)
 15873*    END-EXEC.
 15874*    MOVE '"$%                   ! 4 #00014831' TO DFHEIV0
 15875     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15877     MOVE X'3420233030303134383331' TO DFHEIV0(25:11)
 15878     CALL 'kxdfhei1' USING DFHEIV0
 15879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15880
 15881
 15882
 15883* EXEC CICS WRITE
 15884*         DATASET     ('ELTRLR')
 15885*         FROM        (ACTIVITY-TRAILERS)
 15886*         RIDFLD      (AT-CONTROL-PRIMARY)
 15887*     END-EXEC.
 15888     MOVE LENGTH OF
 15889      ACTIVITY-TRAILERS
 15890       TO DFHEIV11
 15891     MOVE 'ELTRLR' TO DFHEIV1
 15892*    MOVE '&$ L                  ''   #00014835' TO DFHEIV0
 15893     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15895     MOVE X'2020233030303134383335' TO DFHEIV0(25:11)
 15896     CALL 'kxdfhei1' USING DFHEIV0,
 15897           DFHEIV1,
 15898           ACTIVITY-TRAILERS,
 15899           DFHEIV11,
 15900           AT-CONTROL-PRIMARY,
 15901           DFHEIV99,
 15902           DFHEIV99
 15903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15904
 15905
 15906 6176-APPROVAL-NOTE.
 15907
 15908     IF NOT APPROVAL-NEEDED
 15909         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 304
* EL156.cbl
 15910
 15911
 15912* EXEC CICS GETMAIN
 15913*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15914*        LENGTH    (200)
 15915*        INITIMG   (GETMAIN-SPACE)
 15916*    END-EXEC.
 15917     MOVE 200
 15918       TO DFHEIV11
 15919*    MOVE ',"IL                  $   #00014846' TO DFHEIV0
 15920     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15922     MOVE X'2020233030303134383436' TO DFHEIV0(25:11)
 15923     CALL 'kxdfhei1' USING DFHEIV0,
 15924           DFHEIV20,
 15925           DFHEIV11,
 15926           GETMAIN-SPACE
 15927     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15928         DFHEIV20
 15929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15930
 15931
 15932     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15933
 15934     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15935     MOVE 'AT'               TO AT-RECORD-ID
 15936     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15937     MOVE '6'                TO AT-TRAILER-TYPE
 15938     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15939                                AT-GEN-INFO-LAST-MAINT-DT
 15940     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15941                                AT-GEN-INFO-LAST-UPDATED-BY
 15942     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15943
 15944     IF PI-REAUDIT-NEEDED = 'Y'
 15945         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15946     ELSE
 15947         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15948     END-IF
 15949     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15950         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15951     END-IF
 15952     MOVE SPACES             TO AT-INFO-LINE-2
 15953
 15954     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15955 6177-WRITE.
 15956
 15957
 15958* EXEC CICS HANDLE CONDITION
 15959*        DUPREC    (6185-DUPREC)
 15960*    END-EXEC.
 15961*    MOVE '"$%                   ! 5 #00014877' TO DFHEIV0
 15962     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15964     MOVE X'3520233030303134383737' TO DFHEIV0(25:11)
 15965     CALL 'kxdfhei1' USING DFHEIV0
 15966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15967
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 305
* EL156.cbl
 15968
 15969
 15970* EXEC CICS WRITE
 15971*         DATASET     ('ELTRLR')
 15972*         FROM        (ACTIVITY-TRAILERS)
 15973*         RIDFLD      (AT-CONTROL-PRIMARY)
 15974*     END-EXEC.
 15975     MOVE LENGTH OF
 15976      ACTIVITY-TRAILERS
 15977       TO DFHEIV11
 15978     MOVE 'ELTRLR' TO DFHEIV1
 15979*    MOVE '&$ L                  ''   #00014881' TO DFHEIV0
 15980     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15982     MOVE X'2020233030303134383831' TO DFHEIV0(25:11)
 15983     CALL 'kxdfhei1' USING DFHEIV0,
 15984           DFHEIV1,
 15985           ACTIVITY-TRAILERS,
 15986           DFHEIV11,
 15987           AT-CONTROL-PRIMARY,
 15988           DFHEIV99,
 15989           DFHEIV99
 15990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15991
 15992
 15993
 15994     GO TO 6199-EXIT.
 15995
 15996 6180-DUPREC.
 15997
 15998     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15999     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16000     GO TO 6170-WRITE.
 16001
 16002 6185-DUPREC.
 16003     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16004     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16005     GO TO 6177-WRITE.
 16006
 16007 6190-DUPREC.
 16008     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16009     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16010     GO TO 6175-WRITE.
 16011
 16012 6199-EXIT.
 16013      EXIT.
 16014
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 306
* EL156.cbl
 16016 6200-UPDATE-CLAIM-MSTR.
 16017     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16018     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16019     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16020     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16021
 16022     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16023
 16024     MOVE ZEROS                  TO W-INTEREST.
 16025
 16026     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16027        IF (PI-OFFLINE = 'Y') OR
 16028           (PI-PMTTYPE = '7')
 16029           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16030                                 THRU 9870-EXIT
 16031        END-IF
 16032     END-IF
 16033     IF NOT ERROR-ON-OUTPUT
 16034        CONTINUE
 16035     ELSE
 16036
 16037* EXEC CICS REWRITE
 16038*          DATASET('ELMSTR')
 16039*          FROM(CLAIM-MASTER)
 16040*       END-EXEC
 16041     MOVE LENGTH OF
 16042      CLAIM-MASTER
 16043       TO DFHEIV11
 16044     MOVE 'ELMSTR' TO DFHEIV1
 16045*    MOVE '&& L                  %   #00014930' TO DFHEIV0
 16046     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16047     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16048     MOVE X'2020233030303134393330' TO DFHEIV0(25:11)
 16049     CALL 'kxdfhei1' USING DFHEIV0,
 16050           DFHEIV1,
 16051           CLAIM-MASTER,
 16052           DFHEIV11,
 16053           DFHEIV99
 16054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16055
 16056        MOVE -1                  TO ENTPFBL
 16057        MOVE AL-UANON            TO ENTPFBA
 16058        MOVE MAP-NAMEB           TO MAP-NAME
 16059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16060        GO TO 8200-SEND-DATAONLY
 16061     END-IF
 16062
 16063     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16064
 16065     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16066
 16067     IF PI-AIG-SPECIAL-BENEFIT
 16068         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16069
 16070     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16071
 16072     IF PI-SPECIAL-BEN-SW = 'Y'
 16073         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 307
* EL156.cbl
 16074         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16075
 16076     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16077         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16078     ELSE
 16079         IF PI-PMTTYPE NOT = '4'
 16080            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16081
 16082     IF PI-PMTTYPE = '5' OR '6'
 16083        GO TO  6250-SET-MAINT.
 16084
 16085     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16086                                         CL-LAG-REPORT-CODE.
 16087
 16088     IF CL-ACTIVITY-CODE = 09
 16089         GO TO 6200-CONT-UPDATE.
 16090
 16091     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16092         IF CL-ACTIVITY-CODE = 11
 16093             GO TO 6200-CONT-UPDATE.
 16094
 16095     IF WS-ACT-REC-FOUND-SW = 'N'
 16096         GO TO 6200-CONT-UPDATE.
 16097
 16098     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16099         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16100         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16101         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16102
 16103     IF WS-UPDATE-SW = 'Y'
 16104         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16105                                         CL-NEXT-FOLLOWUP-DT.
 16106
 16107 6200-CONT-UPDATE.
 16108
 16109     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16110       IF CLAIM-IS-CLOSED
 16111         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16112           IF WS-OPEN-CLOSE-SW = '2'
 16113             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16114                                        CL-LAST-CLOSE-DT.
 16115
 16116     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16117        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16118        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16119
 16120     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16121        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16122        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16123        MOVE 'C'                 TO CL-CLAIM-STATUS
 16124        IF PI-PMTTYPE = '2'
 16125           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16126           CONTINUE
 16127        ELSE
 16128           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16129        END-IF
 16130     ELSE
 16131        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 308
* EL156.cbl
 16132           IF PI-PMTTYPE = '2' AND
 16133              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16134              CONTINUE
 16135           ELSE
 16136              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16137           END-IF
 16138        END-IF
 16139     END-IF
 16140
 16141     IF PI-PMTTYPE = '4'
 16142        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16143
 16144     IF PI-COMPANY-ID = 'CVL'
 16145         IF PI-LOAN-UPDATE-SW = 'Y'
 16146             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16147             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16148             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16149             MOVE CL-CERT-STATE      TO  CERT-STATE
 16150             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16151             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16152             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16153             MOVE 'CERT'             TO  FILE-SWITCH
 16154             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16155             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16156             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16157
 16158     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16159        GO TO 6220-USE-COMPUTED.
 16160
 16161     IF (PI-PMTTYPE = '4')  AND
 16162        (PI-EPYAMT < ZEROS)
 16163          COMPUTE CL-NO-OF-DAYS-PAID =
 16164                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16165          IF CL-NO-OF-DAYS-PAID < +0
 16166              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16167          ELSE
 16168              NEXT SENTENCE
 16169     ELSE
 16170          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16171
 16172     IF PI-PROCESSOR-ID = 'FIX '
 16173        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16174           NEXT SENTENCE
 16175        ELSE
 16176           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16177     ELSE
 16178        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16179
 16180     IF PI-PMTTYPE = '4'
 16181        GO TO 6250-SET-MAINT.
 16182
 16183     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16184
 16185     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16186     MOVE '4'                    TO DC-OPTION-CODE.
 16187     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16188     IF DATE-CONVERSION-ERROR
 16189        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 309
* EL156.cbl
 16190     ELSE
 16191        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16192           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16193           IF PI-AIG-SPECIAL-BENEFIT
 16194               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16195           ELSE
 16196               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16197
 16198     GO TO 6250-SET-MAINT.
 16199
 16200 6220-USE-COMPUTED.
 16201
 16202     IF (PI-PMTTYPE = '4')  AND
 16203        (PI-CPYAMT < ZEROS)
 16204          COMPUTE CL-NO-OF-DAYS-PAID =
 16205                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16206          IF CL-NO-OF-DAYS-PAID < +0
 16207              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16208          ELSE
 16209              NEXT SENTENCE
 16210     ELSE
 16211          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16212
 16213     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16214
 16215     IF PI-PMTTYPE = '4'
 16216        GO TO 6250-SET-MAINT.
 16217
 16218     IF PI-AIG-SPECIAL-BENEFIT
 16219         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16220     ELSE
 16221         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16222
 16223     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16224
 16225     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16226        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16227
 16228 6250-SET-MAINT.
 16229     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16230
 16231     IF PI-PROCESSOR-ID = 'FIX '
 16232        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16233           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16234        ELSE
 16235           NEXT SENTENCE
 16236     ELSE
 16237        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16238
 16239     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16240     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16241     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16242
 16243 6299-EXIT.
 16244      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 310
* EL156.cbl
 16246 6300-UPDATE-CERT.
 16247
 16248*  ADD CERTNOTE FOR SC NP+6
 16249     IF PI-COMPANY-ID = 'CID' AND
 16250       (PI-PMTTYPE = '2' OR '3') AND
 16251        CL-CERT-STATE = 'SC'  AND
 16252        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16253           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16254     END-IF.
 16255
 16256     IF PI-COMPANY-ID = 'AHL' AND
 16257       (PI-PMTTYPE = '2' OR '3') AND
 16258        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16259           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16260           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16261     END-IF.
 16262
 16263     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16264     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16265     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16266     MOVE CL-CERT-STATE    TO CERT-STATE.
 16267     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16268     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16269     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16270     MOVE 'CERT'           TO FILE-SWITCH.
 16271
 16272     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16273
 16274     IF CERT-NOTE-ADDED
 16275        IF CM-NOTE-SW = ' '
 16276           MOVE '4'             TO CM-NOTE-SW
 16277        ELSE
 16278           IF CM-NOTE-SW = '1'
 16279               MOVE '5'           TO CM-NOTE-SW
 16280           ELSE
 16281              IF CM-NOTE-SW = '2'
 16282                 MOVE '6'         TO CM-NOTE-SW
 16283              ELSE
 16284                 IF CM-NOTE-SW = '3'
 16285                    MOVE '7'      TO CM-NOTE-SW
 16286                 END-IF
 16287              END-IF
 16288           END-IF
 16289        END-IF
 16290     END-IF.
 16291
 16292     IF PI-COMPANY-ID = 'CVL'
 16293         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16294         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16295
 16296     IF PI-PMTTYPE NOT = '4'
 16297        GO TO 6340-UPDATE-CERT.
 16298
 16299     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16300        IF PI-PFKEY-USED = DFHPF5
 16301           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16302        ELSE
 16303           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 311
* EL156.cbl
 16304
 16305*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16306*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16307*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16308*               PI-LF-COVERAGE-TYPE = 'P'
 16309*                GO TO 6350-REWRITE-CERT.
 16310
 16311     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16312       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16313          PI-LF-COVERAGE-TYPE = 'P'
 16314           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16315                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16316                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16317                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16318                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16319                GO TO 6350-REWRITE-CERT
 16320            ELSE
 16321                GO TO 6350-REWRITE-CERT.
 16322
 16323     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16324         GO TO 6350-REWRITE-CERT.
 16325
 16326     IF NOT CM-AH-LUMP-SUM-DISAB
 16327        GO TO 6380-UNLOCK-CERT.
 16328
 16329     IF PI-PFKEY-USED = DFHPF5
 16330        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16331                                    CM-AH-ITD-AH-PMT
 16332        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16333        GO TO 6350-REWRITE-CERT
 16334     ELSE
 16335        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16336                                    CM-AH-ITD-AH-PMT
 16337        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16338        GO TO 6350-REWRITE-CERT.
 16339
 16340 6340-UPDATE-CERT.
 16341
 16342     IF CL-CLAIM-TYPE = 'L'
 16343         IF PI-PFKEY-USED = DFHPF5
 16344             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16345         ELSE
 16346             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16347
 16348     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16349         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16350             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16351                PI-LF-COVERAGE-TYPE = 'P'
 16352                 GO TO 6350-REWRITE-CERT.
 16353
 16354     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16355       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16356          PI-LF-COVERAGE-TYPE = 'P'
 16357           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16358                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16359                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16360                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16361                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 312
* EL156.cbl
 16362                GO TO 6350-REWRITE-CERT.
 16363
 16364     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16365         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16366            PI-LF-COVERAGE-TYPE NOT = 'P'
 16367             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16368             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16369             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16370             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16371             GO TO 6350-REWRITE-CERT.
 16372
 16373     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16374         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16375         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16376         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16377         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16378         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16379         IF PI-PFKEY-USED = DFHPF5
 16380             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16381                                        CM-AH-ITD-AH-PMT
 16382             GO TO 6350-REWRITE-CERT
 16383         ELSE
 16384             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16385                                        CM-AH-ITD-AH-PMT
 16386             GO TO 6350-REWRITE-CERT.
 16387
 16388 6350-REWRITE-CERT.
 16389
 16390
 16391* EXEC CICS REWRITE
 16392*         DATASET  ('ELCERT')
 16393*         FROM(CERTIFICATE-MASTER)
 16394*     END-EXEC.
 16395     MOVE LENGTH OF
 16396      CERTIFICATE-MASTER
 16397       TO DFHEIV11
 16398     MOVE 'ELCERT' TO DFHEIV1
 16399*    MOVE '&& L                  %   #00015269' TO DFHEIV0
 16400     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16402     MOVE X'2020233030303135323639' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0,
 16404           DFHEIV1,
 16405           CERTIFICATE-MASTER,
 16406           DFHEIV11,
 16407           DFHEIV99
 16408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16409
 16410
 16411     GO TO 6399-EXIT.
 16412
 16413 6380-UNLOCK-CERT.
 16414
 16415* EXEC CICS UNLOCK
 16416*         DATASET  ('ELCERT')
 16417*     END-EXEC.
 16418     MOVE 'ELCERT' TO DFHEIV1
 16419*    MOVE '&*                    #   #00015277' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 313
* EL156.cbl
 16420     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16421     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16422     MOVE X'2020233030303135323737' TO DFHEIV0(25:11)
 16423     CALL 'kxdfhei1' USING DFHEIV0,
 16424           DFHEIV1,
 16425           DFHEIV99
 16426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16427
 16428
 16429 6399-EXIT.
 16430      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 314
* EL156.cbl
 16432 6400-UPDATE-ZERO-TRAILER.
 16433     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16434     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16435
 16436     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16437
 16438     IF PI-EPYAMT NOT = ZEROS
 16439         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16440     ELSE
 16441         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16442
 16443     IF PI-ERESV NOT = ZEROS
 16444        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16445
 16446     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16447        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16448
 16449     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16450        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16451     ELSE
 16452        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16453
 16454     IF PI-PMTTYPE = '5'
 16455        IF PI-EPYAMT = ZEROS
 16456           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16457        ELSE
 16458           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16459
 16460     IF PI-PMTTYPE = '6'
 16461        IF PI-EPYAMT = ZEROS
 16462           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16463        ELSE
 16464           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16465
 16466 6420-CHECK-OPEN-CLOSE.
 16467     IF PI-PMTTYPE = '5' OR '6'
 16468        GO TO 6450-REWRITE.
 16469
 16470     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16471         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16472             IF CLAIM-IS-CLOSED
 16473                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16474                 MOVE 1          TO  SUB-1
 16475                 GO TO 6440-AIG-LOOP.
 16476
 16477     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16478        GO TO 6450-REWRITE.
 16479
 16480     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16481        GO TO 6450-REWRITE.
 16482
 16483     MOVE 1                      TO SUB-1.
 16484
 16485 6430-LOOP.
 16486     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16487        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16488        IF PI-PMTTYPE = '1' OR '4'
 16489           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 315
* EL156.cbl
 16490           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16491           GO TO 6450-REWRITE
 16492        ELSE
 16493           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16494           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16495           GO TO 6450-REWRITE.
 16496
 16497     IF SUB-1 = 6
 16498      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16499      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16500      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16501      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16502      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16503      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16504      GO TO 6430-LOOP.
 16505
 16506     ADD 1                       TO SUB-1.
 16507     GO TO 6430-LOOP.
 16508
 16509
 16510 6440-AIG-LOOP.
 16511
 16512     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16513       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16514       IF WS-OPEN-CLOSE-SW = '1'
 16515         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16516         IF PI-PMTTYPE = '2'
 16517           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16518           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16519         ELSE
 16520           IF PI-PMTTYPE = '3'
 16521             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16522             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16523           ELSE
 16524             IF PI-PMTTYPE = '4'
 16525               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16526               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16527             ELSE
 16528               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16529               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16530       ELSE
 16531         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16532         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16533         GO TO 6450-REWRITE.
 16534
 16535     IF SUB-1 = 6
 16536      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16537      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16538      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16539      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16540      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16541      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16542      GO TO 6440-AIG-LOOP.
 16543
 16544     ADD 1                       TO SUB-1.
 16545     GO TO 6440-AIG-LOOP.
 16546
 16547 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 316
* EL156.cbl
 16548     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16549     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16550     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16551
 16552     IF PI-COMPANY-ID = 'DMD'
 16553         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16554         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16555         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16556         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16557         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16558
 16559
 16560* EXEC CICS REWRITE
 16561*         DATASET  ('ELTRLR')
 16562*         FROM     (ACTIVITY-TRAILERS)
 16563*     END-EXEC.
 16564     MOVE LENGTH OF
 16565      ACTIVITY-TRAILERS
 16566       TO DFHEIV11
 16567     MOVE 'ELTRLR' TO DFHEIV1
 16568*    MOVE '&& L                  %   #00015411' TO DFHEIV0
 16569     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16570     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16571     MOVE X'2020233030303135343131' TO DFHEIV0(25:11)
 16572     CALL 'kxdfhei1' USING DFHEIV0,
 16573           DFHEIV1,
 16574           ACTIVITY-TRAILERS,
 16575           DFHEIV11,
 16576           DFHEIV99
 16577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16578
 16579
 16580 6499-EXIT.
 16581      EXIT.
 16582
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 317
* EL156.cbl
 16584 6500-READ-DLO035.
 16585     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16586     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16587     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16588     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16589
 16590
 16591* EXEC CICS LINK
 16592*        PROGRAM    ('DLO035')
 16593*        COMMAREA   (DLO035-KEY)
 16594*        LENGTH     (DL35-LENGTH)
 16595*    END-EXEC.
 16596     MOVE 'DLO035' TO DFHEIV1
 16597*    MOVE '."C                   (   #00015426' TO DFHEIV0
 16598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16600     MOVE X'2020233030303135343236' TO DFHEIV0(25:11)
 16601     CALL 'kxdfhei1' USING DFHEIV0,
 16602           DFHEIV1,
 16603           DLO035-KEY,
 16604           DL35-LENGTH,
 16605           DFHEIV99,
 16606           DFHEIV99,
 16607           DFHEIV99,
 16608           DFHEIV99
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612     IF DL35-RETURN-CODE = 'OK'
 16613         GO TO 6500-EXIT.
 16614
 16615     IF DL35-RETURN-CODE = '01'
 16616         MOVE ER-7830            TO EMI-ERROR
 16617         GO TO 6500-BAD-EXIT.
 16618
 16619     IF DL35-RETURN-CODE = '02'
 16620         MOVE ER-7831            TO EMI-ERROR
 16621         GO TO 6500-BAD-EXIT.
 16622
 16623     IF DL35-RETURN-CODE = '03'
 16624         MOVE ER-7832            TO EMI-ERROR
 16625         GO TO 6500-BAD-EXIT.
 16626
 16627     IF DL35-RETURN-CODE = '04'
 16628         MOVE ER-7833            TO EMI-ERROR
 16629         GO TO 6500-BAD-EXIT.
 16630
 16631     IF DL35-RETURN-CODE = '05'
 16632         MOVE ER-7834            TO EMI-ERROR
 16633         GO TO 6500-BAD-EXIT.
 16634
 16635     IF DL35-RETURN-CODE = '06'
 16636         MOVE ER-7835            TO EMI-ERROR
 16637         GO TO 6500-BAD-EXIT.
 16638
 16639     IF DL35-RETURN-CODE = '07'
 16640         MOVE ER-7836            TO EMI-ERROR
 16641         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 318
* EL156.cbl
 16642
 16643     IF DL35-RETURN-CODE = 'E1'
 16644         MOVE ER-7837            TO EMI-ERROR
 16645         GO TO 6500-BAD-EXIT.
 16646
 16647     IF DL35-RETURN-CODE NOT = 'OK'
 16648         MOVE ER-7838            TO EMI-ERROR
 16649         GO TO 6500-BAD-EXIT.
 16650
 16651 6500-EXIT.
 16652      EXIT.
 16653
 16654 6500-BAD-EXIT.
 16655
 16656* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16657*    MOVE '6"R                   !   #00015475' TO DFHEIV0
 16658     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16660     MOVE X'2020233030303135343735' TO DFHEIV0(25:11)
 16661     CALL 'kxdfhei1' USING DFHEIV0
 16662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16663
 16664     MOVE -1                 TO PMTTYPEL.
 16665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666     GO TO 8200-SEND-DATAONLY.
 16667
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 319
* EL156.cbl
 16669 6600-UPDATE-DLO035.
 16670     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16671     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16672     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16673     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16674
 16675
 16676* EXEC CICS LINK
 16677*        PROGRAM    ('DLO035')
 16678*        COMMAREA   (DLO035-KEY)
 16679*        LENGTH     (DL35-LENGTH)
 16680*    END-EXEC.
 16681     MOVE 'DLO035' TO DFHEIV1
 16682*    MOVE '."C                   (   #00015487' TO DFHEIV0
 16683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16685     MOVE X'2020233030303135343837' TO DFHEIV0(25:11)
 16686     CALL 'kxdfhei1' USING DFHEIV0,
 16687           DFHEIV1,
 16688           DLO035-KEY,
 16689           DL35-LENGTH,
 16690           DFHEIV99,
 16691           DFHEIV99,
 16692           DFHEIV99,
 16693           DFHEIV99
 16694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16695
 16696
 16697     IF DL35-RETURN-CODE = 'OK'
 16698         GO TO 6600-EXIT.
 16699
 16700     IF DL35-RETURN-CODE = '01'
 16701         MOVE ER-7830            TO EMI-ERROR
 16702         GO TO 6500-BAD-EXIT.
 16703
 16704     IF DL35-RETURN-CODE = '02'
 16705         MOVE ER-7831            TO EMI-ERROR
 16706         GO TO 6500-BAD-EXIT.
 16707
 16708     IF DL35-RETURN-CODE = '03'
 16709         MOVE ER-7832            TO EMI-ERROR
 16710         GO TO 6500-BAD-EXIT.
 16711
 16712     IF DL35-RETURN-CODE = '04'
 16713         MOVE ER-7833            TO EMI-ERROR
 16714         GO TO 6500-BAD-EXIT.
 16715
 16716     IF DL35-RETURN-CODE = '05'
 16717         MOVE ER-7834            TO EMI-ERROR
 16718         GO TO 6500-BAD-EXIT.
 16719
 16720     IF DL35-RETURN-CODE = '06'
 16721         MOVE ER-7835            TO EMI-ERROR
 16722         GO TO 6500-BAD-EXIT.
 16723
 16724     IF DL35-RETURN-CODE = '07'
 16725         MOVE ER-7836            TO EMI-ERROR
 16726         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 320
* EL156.cbl
 16727
 16728     IF DL35-RETURN-CODE = 'E1'
 16729         MOVE ER-7837            TO EMI-ERROR
 16730         GO TO 6500-BAD-EXIT.
 16731
 16732     IF DL35-RETURN-CODE NOT = 'OK'
 16733         MOVE ER-7838            TO EMI-ERROR
 16734         GO TO 6500-BAD-EXIT.
 16735
 16736 6600-EXIT.
 16737      EXIT.
 16738
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 321
* EL156.cbl
 16740 6700-UPDATE-ACTQ.
 16741***************************************************************
 16742*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16743*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16744*    ONE ALREADY THERE.                                       *
 16745***************************************************************
 16746
 16747
 16748* EXEC CICS HANDLE CONDITION
 16749*         NOTFND(6720-BUILD-NEW-RECORD)
 16750*     END-EXEC.
 16751*    MOVE '"$I                   ! 6 #00015543' TO DFHEIV0
 16752     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16754     MOVE X'3620233030303135353433' TO DFHEIV0(25:11)
 16755     CALL 'kxdfhei1' USING DFHEIV0
 16756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16757
 16758
 16759
 16760* EXEC CICS READ
 16761*         DATASET('ELACTQ')
 16762*         RIDFLD (ELMSTR-KEY)
 16763*         SET    (ADDRESS OF ACTIVITY-QUE)
 16764*         UPDATE
 16765*     END-EXEC.
 16766     MOVE 'ELACTQ' TO DFHEIV1
 16767*    MOVE '&"S        EU         (   #00015547' TO DFHEIV0
 16768     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16769     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16770     MOVE X'2020233030303135353437' TO DFHEIV0(25:11)
 16771     CALL 'kxdfhei1' USING DFHEIV0,
 16772           DFHEIV1,
 16773           DFHEIV20,
 16774           DFHEIV99,
 16775           ELMSTR-KEY,
 16776           DFHEIV99,
 16777           DFHEIV99,
 16778           DFHEIV99
 16779     SET ADDRESS OF ACTIVITY-QUE TO
 16780         DFHEIV20
 16781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16782
 16783
 16784     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16785
 16786     IF PI-AIG-SPECIAL-BENEFIT AND
 16787        PI-CASH = 'Y'
 16788         ADD 2                   TO AQ-PAYMENT-COUNTER
 16789     ELSE
 16790         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16791
 16792     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16793         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16794
 16795     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16796
 16797     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 322
* EL156.cbl
 16798         IF WS-PMT-APPROVAL-SW = 'A'
 16799             NEXT SENTENCE
 16800         ELSE
 16801            IF PI-AIG-SPECIAL-BENEFIT AND
 16802               PI-CASH = 'Y'
 16803                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16804                                     WS-PMT-UNAPPROVED-CNT
 16805            ELSE
 16806                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16807                                     WS-PMT-UNAPPROVED-CNT
 16808     ELSE
 16809         IF PI-PMT-APPR-SW = 'Y'
 16810            IF PI-AIG-SPECIAL-BENEFIT AND
 16811               PI-CASH = 'Y'
 16812                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16813                                     WS-PMT-UNAPPROVED-CNT
 16814            ELSE
 16815                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16816                                     WS-PMT-UNAPPROVED-CNT.
 16817
 16818     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16819         MOVE ER-3536 TO EMI-ERROR
 16820         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821
 16822     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16823
 16824
 16825* EXEC CICS REWRITE
 16826*         DATASET('ELACTQ')
 16827*         FROM   (ACTIVITY-QUE)
 16828*     END-EXEC.
 16829     MOVE LENGTH OF
 16830      ACTIVITY-QUE
 16831       TO DFHEIV11
 16832     MOVE 'ELACTQ' TO DFHEIV1
 16833*    MOVE '&& L                  %   #00015594' TO DFHEIV0
 16834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16836     MOVE X'2020233030303135353934' TO DFHEIV0(25:11)
 16837     CALL 'kxdfhei1' USING DFHEIV0,
 16838           DFHEIV1,
 16839           ACTIVITY-QUE,
 16840           DFHEIV11,
 16841           DFHEIV99
 16842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16843
 16844
 16845     GO TO 6799-EXIT.
 16846
 16847 6720-BUILD-NEW-RECORD.
 16848
 16849* EXEC CICS GETMAIN
 16850*         SET    (ADDRESS OF ACTIVITY-QUE)
 16851*         LENGTH (60)
 16852*         INITIMG(GETMAIN-SPACE)
 16853*     END-EXEC.
 16854     MOVE 60
 16855       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 323
* EL156.cbl
 16856*    MOVE ',"IL                  $   #00015602' TO DFHEIV0
 16857     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16858     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16859     MOVE X'2020233030303135363032' TO DFHEIV0(25:11)
 16860     CALL 'kxdfhei1' USING DFHEIV0,
 16861           DFHEIV20,
 16862           DFHEIV11,
 16863           GETMAIN-SPACE
 16864     SET ADDRESS OF ACTIVITY-QUE TO
 16865         DFHEIV20
 16866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16867
 16868
 16869     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16870
 16871     IF PI-AIG-SPECIAL-BENEFIT AND
 16872        PI-CASH = 'Y'
 16873         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16874     ELSE
 16875         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16876
 16877     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16878     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16879     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16880     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16881                                    AQ-FOLLOWUP-DATE.
 16882     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16883     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16884
 16885     IF PI-PMT-GRADUATED
 16886         IF WS-PMT-APPROVAL-SW = 'A'
 16887             NEXT SENTENCE
 16888         ELSE
 16889            IF PI-AIG-SPECIAL-BENEFIT AND
 16890               PI-CASH = 'Y'
 16891                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16892            ELSE
 16893                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16894     ELSE
 16895         IF PI-PMT-APPR-SW = 'Y'
 16896            IF PI-AIG-SPECIAL-BENEFIT AND
 16897               PI-CASH = 'Y'
 16898                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16899            ELSE
 16900                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16901
 16902     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16903         MOVE ER-3536 TO EMI-ERROR
 16904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16905
 16906
 16907* EXEC CICS WRITE
 16908*         DATASET('ELACTQ')
 16909*         RIDFLD (ELMSTR-KEY)
 16910*         FROM   (ACTIVITY-QUE)
 16911*     END-EXEC.
 16912     MOVE LENGTH OF
 16913      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 324
* EL156.cbl
 16914       TO DFHEIV11
 16915     MOVE 'ELACTQ' TO DFHEIV1
 16916*    MOVE '&$ L                  ''   #00015645' TO DFHEIV0
 16917     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16919     MOVE X'2020233030303135363435' TO DFHEIV0(25:11)
 16920     CALL 'kxdfhei1' USING DFHEIV0,
 16921           DFHEIV1,
 16922           ACTIVITY-QUE,
 16923           DFHEIV11,
 16924           ELMSTR-KEY,
 16925           DFHEIV99,
 16926           DFHEIV99
 16927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16928
 16929
 16930 6799-EXIT.
 16931      EXIT.
 16932
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 325
* EL156.cbl
 16934 6800-BUILD-FORM-TRAILER.
 16935
 16936
 16937* EXEC CICS GETMAIN
 16938*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16939*         LENGTH   (200)
 16940*         INITIMG  (GETMAIN-SPACE)
 16941*    END-EXEC.
 16942     MOVE 200
 16943       TO DFHEIV11
 16944*    MOVE ',"IL                  $   #00015657' TO DFHEIV0
 16945     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16947     MOVE X'2020233030303135363537' TO DFHEIV0(25:11)
 16948     CALL 'kxdfhei1' USING DFHEIV0,
 16949           DFHEIV20,
 16950           DFHEIV11,
 16951           GETMAIN-SPACE
 16952     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16953         DFHEIV20
 16954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16955
 16956
 16957     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16958
 16959     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16960     MOVE 'AT'                   TO AT-RECORD-ID.
 16961     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16962
 16963     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16964     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16965                                    AT-FORM-LAST-MAINT-DT
 16966                                    AT-FORM-SEND-ON-DT.
 16967     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16968                                    AT-FORM-LAST-UPDATED-BY.
 16969     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16970     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16971     MOVE '6'                    TO DC-OPTION-CODE.
 16972     MOVE +29                    TO DC-ELAPSED-DAYS.
 16973     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16974     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16975     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16976
 16977     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16978         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16979
 16980     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16981                                    AT-FORM-RE-SEND-DT
 16982                                    AT-EMP-FORM-ANSWERED-DT
 16983                                    AT-PHY-FORM-ANSWERED-DT
 16984                                    AT-EMP-FORM-SEND-ON-DT
 16985                                    AT-PHY-FORM-SEND-ON-DT
 16986                                    AT-FORM-PRINTED-DT
 16987                                    AT-FORM-REPRINT-DT.
 16988     MOVE '2'                    TO AT-FORM-TYPE.
 16989
 16990     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16991     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 326
* EL156.cbl
 16992
 16993     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16994         NEXT SENTENCE
 16995     ELSE
 16996         IF CL-PROG-FORM-TYPE NOT = 'S'
 16997            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16998
 16999
 17000* EXEC CICS WRITE
 17001*         DATASET  ('ELTRLR')
 17002*         FROM     (ACTIVITY-TRAILERS)
 17003*         RIDFLD   (AT-CONTROL-PRIMARY)
 17004*     END-EXEC.
 17005     MOVE LENGTH OF
 17006      ACTIVITY-TRAILERS
 17007       TO DFHEIV11
 17008     MOVE 'ELTRLR' TO DFHEIV1
 17009*    MOVE '&$ L                  ''   #00015705' TO DFHEIV0
 17010     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17011     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17012     MOVE X'2020233030303135373035' TO DFHEIV0(25:11)
 17013     CALL 'kxdfhei1' USING DFHEIV0,
 17014           DFHEIV1,
 17015           ACTIVITY-TRAILERS,
 17016           DFHEIV11,
 17017           AT-CONTROL-PRIMARY,
 17018           DFHEIV99,
 17019           DFHEIV99
 17020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17021
 17022
 17023 6899-EXIT.
 17024      EXIT.
 17025
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 327
* EL156.cbl
 17027 6900-BUILD-ARCHIVE-HEADER.
 17028
 17029     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17030     MOVE '1'                    TO CNTL-REC-TYPE.
 17031     MOVE +0                     TO CNTL-SEQ-NO.
 17032     MOVE SPACES                 TO CNTL-ACCESS.
 17033
 17034
 17035* EXEC CICS READ
 17036*         DATASET  ('ELCNTL')
 17037*         SET      (ADDRESS OF CONTROL-FILE)
 17038*         RIDFLD   (ELCNTL-KEY)
 17039*         UPDATE
 17040*    END-EXEC.
 17041     MOVE 'ELCNTL' TO DFHEIV1
 17042*    MOVE '&"S        EU         (   #00015722' TO DFHEIV0
 17043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17045     MOVE X'2020233030303135373232' TO DFHEIV0(25:11)
 17046     CALL 'kxdfhei1' USING DFHEIV0,
 17047           DFHEIV1,
 17048           DFHEIV20,
 17049           DFHEIV99,
 17050           ELCNTL-KEY,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99
 17054     SET ADDRESS OF CONTROL-FILE TO
 17055         DFHEIV20
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17057
 17058
 17059     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17060     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17061
 17062
 17063* EXEC CICS REWRITE
 17064*         FROM     (CONTROL-FILE)
 17065*         DATASET  ('ELCNTL')
 17066*    END-EXEC.
 17067     MOVE LENGTH OF
 17068      CONTROL-FILE
 17069       TO DFHEIV11
 17070     MOVE 'ELCNTL' TO DFHEIV1
 17071*    MOVE '&& L                  %   #00015732' TO DFHEIV0
 17072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17074     MOVE X'2020233030303135373332' TO DFHEIV0(25:11)
 17075     CALL 'kxdfhei1' USING DFHEIV0,
 17076           DFHEIV1,
 17077           CONTROL-FILE,
 17078           DFHEIV11,
 17079           DFHEIV99
 17080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17081
 17082
 17083
 17084* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 328
* EL156.cbl
 17085*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17086*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17087*    END-EXEC.
 17088*    MOVE '"$$%                  ! 7 #00015737' TO DFHEIV0
 17089     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17091     MOVE X'3720233030303135373337' TO DFHEIV0(25:11)
 17092     CALL 'kxdfhei1' USING DFHEIV0
 17093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17094
 17095
 17096
 17097* EXEC CICS GETMAIN
 17098*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17099*         LENGTH  (ELARCH-LENGTH)
 17100*         INITIMG (GETMAIN-SPACE)
 17101*    END-EXEC.
 17102*    MOVE ',"IL                  $   #00015742' TO DFHEIV0
 17103     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17105     MOVE X'2020233030303135373432' TO DFHEIV0(25:11)
 17106     CALL 'kxdfhei1' USING DFHEIV0,
 17107           DFHEIV20,
 17108           ELARCH-LENGTH,
 17109           GETMAIN-SPACE
 17110     SET ADDRESS OF LETTER-ARCHIVE TO
 17111         DFHEIV20
 17112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17113
 17114
 17115     MOVE 'LA'                   TO LA-RECORD-ID.
 17116     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17117                                    LA-ARCHIVE-NO-A1.
 17118     MOVE '4'                    TO LA-RECORD-TYPE
 17119                                    LA-RECORD-TYPE-A1.
 17120     MOVE +0                     TO LA-LINE-SEQ-NO
 17121                                    LA-LINE-SEQ-NO-A1.
 17122     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17123                                    LA-COMPANY-CD-A1.
 17124     MOVE CL-CARRIER             TO LA4-CARRIER.
 17125     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17126     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17127     MOVE CL-CERT-STATE          TO LA4-STATE.
 17128     MOVE +0                     TO LA4-NO-OF-COPIES.
 17129     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17130     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17131     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17132                                    LA4-INITIAL-PRINT-DATE
 17133                                    LA4-RESEND-PRINT-DATE
 17134                                    LA4-FORM-REM-PRINT-DT.
 17135     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17136     MOVE '2'                    TO LA4-FORM-TYPE.
 17137
 17138
 17139* EXEC CICS WRITE
 17140*         DATASET  ('ELARCH')
 17141*         FROM     (LETTER-ARCHIVE)
 17142*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 329
* EL156.cbl
 17143*    END-EXEC.
 17144     MOVE LENGTH OF
 17145      LETTER-ARCHIVE
 17146       TO DFHEIV11
 17147     MOVE 'ELARCH' TO DFHEIV1
 17148*    MOVE '&$ L                  ''   #00015771' TO DFHEIV0
 17149     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17150     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17151     MOVE X'2020233030303135373731' TO DFHEIV0(25:11)
 17152     CALL 'kxdfhei1' USING DFHEIV0,
 17153           DFHEIV1,
 17154           LETTER-ARCHIVE,
 17155           DFHEIV11,
 17156           LA-CONTROL-PRIMARY,
 17157           DFHEIV99,
 17158           DFHEIV99
 17159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17160
 17161
 17162 6999-EXIT.
 17163      EXIT.
 17164
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 330
* EL156.cbl
 17166 7000-SHOW-CLAIM.
 17167     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17168     MOVE 'A'                    TO PI-PASS-SW.
 17169     MOVE LOW-VALUES             TO PI-CPYFROM
 17170                                    PI-MONTH-END-SAVE
 17171                                    PI-CPYTHRU.
 17172
 17173     MOVE ZEROS                  TO PI-FATAL-COUNT
 17174                                    PI-DAILY-RATE
 17175                                    PI-BEN-DAYS
 17176                                    PI-MANUAL-SW
 17177                                    PI-SAVE-CURSOR
 17178                                    PI-FORCE-COUNT
 17179                                    PI-HOLDTIL
 17180                                    PI-EPYFROM
 17181                                    PI-EPYTHRU
 17182                                    PI-EDAYS
 17183                                    PI-EPYAMT
 17184                                    PI-ERESV
 17185                                    PI-EEXPENS
 17186                                    PI-CDAYS
 17187                                    PI-CPYAMT
 17188                                    PI-CRESV
 17189                                    PI-CEXPENS
 17190                                    PI-INT-RATE
 17191                                    PI-AIGFROM.
 17192     MOVE ZEROS                  TO PI-PROOF-DATE.
 17193     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17194                                    PI-REM-BEN-AMT
 17195                                    PI-MO-BEN-AMT
 17196                                    pi-ah-term.
 17197
 17198     MOVE LOW-VALUES             TO EL156AI.
 17199     MOVE MAP-NAMEA              TO MAP-NAME.
 17200
 17201* EXEC CICS HANDLE CONDITION
 17202*        NOTFND   (7010-BUILD-MAP)
 17203*    END-EXEC.
 17204*    MOVE '"$I                   ! 8 #00015815' TO DFHEIV0
 17205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17207     MOVE X'3820233030303135383135' TO DFHEIV0(25:11)
 17208     CALL 'kxdfhei1' USING DFHEIV0
 17209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17210
 17211
 17212     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17213     MOVE '2'                    TO CNTL-REC-TYPE.
 17214     MOVE +0                     TO CNTL-SEQ-NO.
 17215     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17216
 17217
 17218* EXEC CICS READ
 17219*         DATASET  ('ELCNTL')
 17220*         SET      (ADDRESS OF CONTROL-FILE)
 17221*         RIDFLD   (ELCNTL-KEY)
 17222*    END-EXEC.
 17223     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 331
* EL156.cbl
 17224*    MOVE '&"S        E          (   #00015824' TO DFHEIV0
 17225     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17227     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 17228     CALL 'kxdfhei1' USING DFHEIV0,
 17229           DFHEIV1,
 17230           DFHEIV20,
 17231           DFHEIV99,
 17232           ELCNTL-KEY,
 17233           DFHEIV99,
 17234           DFHEIV99,
 17235           DFHEIV99
 17236     SET ADDRESS OF CONTROL-FILE TO
 17237         DFHEIV20
 17238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17239
 17240
 17241     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17242
 17243     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17244         MOVE AL-UANON      TO SURVYYNA
 17245     END-IF.
 17246
 17247
 17248     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17249     MOVE '1'                    TO CNTL-REC-TYPE.
 17250     MOVE SPACES                 TO CNTL-ACCESS.
 17251     MOVE +0                     TO CNTL-SEQ-NO.
 17252
 17253
 17254* EXEC CICS READ
 17255*         DATASET  ('ELCNTL')
 17256*         SET      (ADDRESS OF CONTROL-FILE)
 17257*         RIDFLD   (ELCNTL-KEY)
 17258*    END-EXEC.
 17259     MOVE 'ELCNTL' TO DFHEIV1
 17260*    MOVE '&"S        E          (   #00015842' TO DFHEIV0
 17261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17263     MOVE X'2020233030303135383432' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0,
 17265           DFHEIV1,
 17266           DFHEIV20,
 17267           DFHEIV99,
 17268           ELCNTL-KEY,
 17269           DFHEIV99,
 17270           DFHEIV99,
 17271           DFHEIV99
 17272     SET ADDRESS OF CONTROL-FILE TO
 17273         DFHEIV20
 17274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17275
 17276
 17277     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17278
 17279 7010-BUILD-MAP.
 17280
 17281
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 332
* EL156.cbl
 17282* EXEC CICS HANDLE CONDITION
 17283*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17284*    END-EXEC.
 17285*    MOVE '"$I                   ! 9 #00015852' TO DFHEIV0
 17286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17288     MOVE X'3920233030303135383532' TO DFHEIV0(25:11)
 17289     CALL 'kxdfhei1' USING DFHEIV0
 17290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17291
 17292
 17293     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17294     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17295     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17296     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17297     MOVE 'MSTR'                 TO FILE-SWITCH.
 17298
 17299     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17300
 17301     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17302     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17303     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17304     MOVE CL-CCN                 TO PI-SV-CCN.
 17305
 17306     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17307     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17308     MOVE CL-CLAIM-NO            TO CLMNOO.
 17309     MOVE CL-CARRIER             TO CARRO.
 17310     MOVE CL-CERT-PRIME          TO CERTNOO.
 17311     MOVE CL-CERT-SFX            TO SUFXO.
 17312
 17313     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17314        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17315        CONTINUE
 17316     ELSE
 17317        MOVE AL-SADOF            TO ZINTHA
 17318                                    ZINTA
 17319                                    PINTHA
 17320                                    PINTA
 17321     END-IF
 17322     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17323     EVALUATE TRUE
 17324     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17325         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17326     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17327         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17328
 17329     WHEN CL-CLAIM-TYPE = 'I'
 17330         MOVE '  IU  '           TO CLMTYPO
 17331     WHEN CL-CLAIM-TYPE = 'G'
 17332         MOVE ' GAP  '           TO CLMTYPO
 17333     END-EVALUATE.
 17334     IF CLAIM-IS-OPEN
 17335         MOVE ' OPEN'            TO CLMSTATO
 17336     ELSE
 17337         MOVE 'CLOSED'           TO CLMSTATO.
 17338
 17339     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 333
* EL156.cbl
 17340
 17341     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17342         MOVE SPACES             TO  PCERTNOO
 17343                                     PSUFXO
 17344                                     PRIMHDGO
 17345                                     SEQUO
 17346         MOVE AL-SADOF           TO  PCERTNOA
 17347                                     PSUFXA
 17348                                     PRIMHDGA
 17349                                     SEQUA
 17350     ELSE
 17351         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17352         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17353         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17354         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17355         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17356         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17357         MOVE AL-SANON               TO  PCERTNOA
 17358                                         PSUFXA
 17359                                         PRIMHDGA
 17360         MOVE AL-SABON               TO  SEQUA.
 17361
 17362     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17363
 17364     IF CL-NO-OF-PMTS-MADE = 0 AND
 17365        CL-TOTAL-PAID-AMT = 0
 17366         NEXT SENTENCE
 17367     ELSE
 17368         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17369             IF NOT PI-USES-PAID-TO
 17370                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17371                 MOVE ' '                 TO DC-OPTION-CODE
 17372                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17373                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17374             ELSE
 17375                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17376                 MOVE '6'                 TO DC-OPTION-CODE
 17377                 MOVE +1                  TO DC-ELAPSED-DAYS
 17378                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17379                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17380                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17381
 17382     IF MAP-NAME = 'EL156A'
 17383        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17384           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17385             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17386           end-if
 17387        end-if
 17388     end-if
 17389     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17390         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17391         MOVE ' '                TO DC-OPTION-CODE
 17392         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17393         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17394
 17395     IF CL-INCURRED-DT NOT = LOW-VALUES
 17396         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17397         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 334
* EL156.cbl
 17398         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17399         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17400
 17401     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17402
 17403     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17404         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17405         MOVE ' '                TO DC-OPTION-CODE
 17406         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17407         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17408
 17409     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17410         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17411         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17412     ELSE
 17413         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17414         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17415
 17416     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17417     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17418     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17419     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17420                                    PI-GROUPING.
 17421     MOVE CL-CERT-STATE          TO CERT-STATE
 17422                                    PI-STATE.
 17423     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17424                                    PI-ACCOUNT.
 17425     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17426     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17427     MOVE 'CERT'                 TO FILE-SWITCH.
 17428
 17429     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17430     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17431        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17432        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17433            MOVE 'N' TO PI-JOINT-INSURED-IND
 17434     ELSE
 17435            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17436     END-IF.
 17437
 17438     perform 7975-read-acct      thru 7975-exit
 17439     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17440     MOVE PI-STATE               TO WS-ST-ACCESS.
 17441     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17442     MOVE '3'                    TO CNTL-REC-TYPE.
 17443     MOVE +0                     TO CNTL-SEQ-NO.
 17444     MOVE 'STAT'                 TO FILE-SWITCH.
 17445
 17446     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17447
 17448     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17449     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17450
 17451     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17452        GO TO 7020-BYPASS-BENEFIT.
 17453
 17454     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17455     MOVE '4'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 335
* EL156.cbl
 17456     MOVE +0                     TO CNTL-SEQ-NO.
 17457     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17458     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17459     MOVE 'BENE'                 TO FILE-SWITCH.
 17460
 17461     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17462
 17463     IF NO-BENEFIT-FOUND
 17464        GO TO 7020-BYPASS-BENEFIT.
 17465
 17466     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17467     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17468     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17469
 17470 7020-BYPASS-BENEFIT.
 17471
 17472*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17473*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17474*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17475
 17476     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17477         GO TO 7021-GO-TO-LIFE.
 17478     move zeros                  to PI-MAX-BENEFIT-AMT
 17479     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17480     move cm-ah-orig-term        to pi-ah-term
 17481     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17482
 17483     IF (PI-COMPANY-ID = 'DCC')
 17484        and (acct-found)
 17485        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17486        PERFORM 0900-GET-DDF-limits
 17487                                 THRU 0900-EXIT
 17488        IF PDEF-FOUND
 17489           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17490              (P1 > +8)
 17491              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17492           END-PERFORM
 17493           IF P1 < +9
 17494              MOVE PD-MAX-AMT (P1)
 17495                                 TO PI-MAX-BENEFIT-AMT
 17496           END-IF
 17497        END-IF
 17498     end-if
 17499     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17500     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17501     if (pi-max-benefit-amt not = zeros)
 17502        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17503        move pi-max-benefit-amt  to beneo
 17504     else
 17505        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17506     end-if
 17507     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17508     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17509                                    CP-ORIGINAL-TERM.
 17510     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17511
 17512*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17513*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 336
* EL156.cbl
 17514*    ELSE
 17515         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17516
 17517     MOVE ' '                    TO DC-OPTION-CODE.
 17518     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17519     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17520
 17521     IF PI-COMPANY-ID = 'DMD'
 17522         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17523         GO TO 7023-BYPASS-REMAINING-TERM.
 17524
 17525     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17526     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17527     GO TO 7022-AROUND-LIFE.
 17528
 17529 7021-GO-TO-LIFE.
 17530
 17531     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17532     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17533     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17534                                    CP-ORIGINAL-TERM.
 17535     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17536     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17537     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17538     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17539
 17540     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17541         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17542     ELSE
 17543         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17544
 17545     MOVE ' '                    TO DC-OPTION-CODE.
 17546     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17547     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17548
 17549 7022-AROUND-LIFE.
 17550
 17551     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17552     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17553     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17554     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17555     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17556     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17557     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17558
 17559     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17560
 17561     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17562        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17563           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17564
 17565     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17566        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17567           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17568
 17569 7023-BYPASS-REMAINING-TERM.
 17570     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17571       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 337
* EL156.cbl
 17572          MOVE ZEROS                  TO BENEO
 17573       ELSE
 17574          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17575          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17576          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17577          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17578          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17579          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17580          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17581          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17582          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17583          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17584          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17585          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17586          IF (PI-COMPANY-ID = 'DCC')
 17587             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17588             PERFORM 0900-GET-DDF-limits
 17589                                 THRU 0900-EXIT
 17590             IF PDEF-FOUND
 17591                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17592                   (P1 > +8)
 17593                   OR (PD-PROD-CODE (P1) = 'L')
 17594                END-PERFORM
 17595                IF P1 < +9
 17596                   MOVE PD-MAX-AMT (P1)
 17597                                 TO CP-R-MAX-TOT-BEN
 17598                END-IF
 17599             END-IF
 17600          END-IF
 17601
 17602* EXEC CICS LINK
 17603*            PROGRAM  (LINK-REMAMT)
 17604*            COMMAREA (CALCULATION-PASS-AREA)
 17605*            LENGTH   (CP-COMM-LENGTH)
 17606*         END-EXEC
 17607*    MOVE '."C                   (   #00016164' TO DFHEIV0
 17608     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17609     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17610     MOVE X'2020233030303136313634' TO DFHEIV0(25:11)
 17611     CALL 'kxdfhei1' USING DFHEIV0,
 17612           LINK-REMAMT,
 17613           CALCULATION-PASS-AREA,
 17614           CP-COMM-LENGTH,
 17615           DFHEIV99,
 17616           DFHEIV99,
 17617           DFHEIV99,
 17618           DFHEIV99
 17619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17620          MOVE CP-REMAINING-AMT       TO BENEO
 17621       end-if
 17622     end-if
 17623     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17624     MOVE +95                    TO TRLR-SEQ-NO
 17625
 17626* EXEC CICS READ
 17627*       DATASET  ('ELTRLR')
 17628*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17629*       RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 338
* EL156.cbl
 17630*       RESP     (WS-RESPONSE)
 17631*    END-EXEC
 17632     MOVE 'ELTRLR' TO DFHEIV1
 17633*    MOVE '&"S        E          (  N#00016174' TO DFHEIV0
 17634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17636     MOVE X'204E233030303136313734' TO DFHEIV0(25:11)
 17637     CALL 'kxdfhei1' USING DFHEIV0,
 17638           DFHEIV1,
 17639           DFHEIV20,
 17640           DFHEIV99,
 17641           ELTRLR-KEY,
 17642           DFHEIV99,
 17643           DFHEIV99,
 17644           DFHEIV99
 17645     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17646         DFHEIV20
 17647     MOVE EIBRESP  TO WS-RESPONSE
 17648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17649
 17650     if ws-resp-normal
 17651        perform varying s1 from +1 by +1 until
 17652           at-note-error-no (s1) = spaces
 17653           move at-note-error-no (s1)
 17654                                 to emi-error
 17655           if at-note-error-no (s1) = '1653'
 17656              evaluate true
 17657                 when cl-claim-type = 'L'
 17658                    move '  LF  '
 17659                                 to emi-claim-type
 17660                 when cl-claim-type = 'I'
 17661                    move '  IU  '
 17662                                 to emi-claim-type
 17663                 when other
 17664                    move '  AH  '
 17665                                 to emi-claim-type
 17666              end-evaluate
 17667           end-if
 17668           PERFORM 9900-ERROR-FORMAT
 17669                                 THRU 9900-EXIT
 17670        end-perform
 17671     end-if
 17672     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17673         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17674            WS-LF-COVERAGE-TYPE = 'P'
 17675             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17676                                        CM-LF-ITD-DEATH-AMT
 17677             MOVE WS-REMAINING-AMT  TO  BENEO.
 17678
 17679     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17680     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17681     MOVE WS-TERMS               TO TERMSO.
 17682
 17683     IF WS-STATUS = '6' OR '7' OR '8'
 17684         MOVE AL-SABOF           TO CRTSTATA.
 17685
 17686     IF WS-STATUS = '1' OR '4'
 17687        IF CP-REMAINING-TERM-3 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 339
* EL156.cbl
 17688           MOVE 'EXPIRED'        TO CRTSTATO
 17689        ELSE
 17690           MOVE 'ACTIVE  '       TO CRTSTATO.
 17691
 17692     IF WS-STATUS = '2'
 17693         MOVE 'PEND    '         TO CRTSTATO.
 17694
 17695     IF WS-STATUS = '3'
 17696         MOVE 'RESTORE '         TO CRTSTATO.
 17697
 17698     IF WS-STATUS = '5'
 17699         MOVE 'REISSUE '         TO CRTSTATO.
 17700
 17701     IF WS-STATUS = '6'
 17702         MOVE 'LMP DIS'          TO CRTSTATO.
 17703
 17704     IF WS-STATUS = '7'
 17705         MOVE 'DEATH'            TO CRTSTATO.
 17706
 17707     IF WS-STATUS = '8'
 17708         MOVE 'CANCEL'           TO CRTSTATO.
 17709
 17710     IF WS-STATUS = '9'
 17711         MOVE 'RE-ONLY '         TO CRTSTATO.
 17712
 17713     IF WS-STATUS = 'V'
 17714         MOVE 'VOID  '           TO CRTSTATO.
 17715
 17716     IF WS-STATUS = 'D'
 17717         MOVE 'DECLINE '         TO CRTSTATO.
 17718
 17719     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17720         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17721         MOVE '5'                TO CNTL-REC-TYPE
 17722     ELSE
 17723         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17724         MOVE '4'                TO CNTL-REC-TYPE.
 17725
 17726     MOVE '** NONE **'           TO COVERO.
 17727     MOVE AL-SABON               TO COVERA.
 17728
 17729     IF PI-COMPANY-ID = 'CVL'
 17730         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17731             MOVE CM-BENEFICIARY TO LOANNOO
 17732             MOVE AL-UANON       TO LOANNOA.
 17733
 17734     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17735        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17736        MOVE +91                 TO  TRLR-SEQ-NO
 17737
 17738* EXEC CICS READ
 17739*           DATASET  ('ELTRLR')
 17740*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17741*           RIDFLD   (ELTRLR-KEY)
 17742*           RESP     (WS-RESPONSE)
 17743*       END-EXEC
 17744     MOVE 'ELTRLR' TO DFHEIV1
 17745*    MOVE '&"S        E          (  N#00016268' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 340
* EL156.cbl
 17746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17748     MOVE X'204E233030303136323638' TO DFHEIV0(25:11)
 17749     CALL 'kxdfhei1' USING DFHEIV0,
 17750           DFHEIV1,
 17751           DFHEIV20,
 17752           DFHEIV99,
 17753           ELTRLR-KEY,
 17754           DFHEIV99,
 17755           DFHEIV99,
 17756           DFHEIV99
 17757     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17758         DFHEIV20
 17759     MOVE EIBRESP  TO WS-RESPONSE
 17760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17761
 17762        IF WS-RESP-NORMAL
 17763           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17764        ELSE
 17765           MOVE SPACES           TO  LOANNOO
 17766        END-IF
 17767*052506
 17768*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17769*052506
 17770     END-IF
 17771
 17772     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17773        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17774
 17775     IF WS-BEN-CD = ZEROS
 17776         GO TO 7050-SHOW-CONTINUE.
 17777
 17778     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17779     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17780     MOVE +0                     TO CNTL-SEQ-NO.
 17781     MOVE 'BENE'                 TO FILE-SWITCH.
 17782
 17783     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17784
 17785     IF BENEFIT-FOUND
 17786         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17787         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17788         MOVE AL-SANON                    TO COVERA.
 17789
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 341
* EL156.cbl
 17791 7050-SHOW-CONTINUE.
 17792
 17793     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17794        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17795            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17796     END-IF
 17797
 17798     IF PI-COMPANY-ID = 'DMD'
 17799         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17800
 17801     MOVE -1                     TO PMTTYPEL.
 17802     GO TO 8100-SEND-INITIAL-MAP.
 17803
 17804 7100-SHOW-RECORD-NOT-FOUND.
 17805     IF FILE-SWITCH = 'MSTR'
 17806         MOVE ER-0204            TO EMI-ERROR.
 17807
 17808     IF FILE-SWITCH = 'CERT'
 17809         MOVE ER-0206            TO EMI-ERROR.
 17810
 17811     IF FILE-SWITCH = 'STAT'
 17812         MOVE ER-0149            TO EMI-ERROR.
 17813
 17814     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17815
 17816     MOVE -1                     TO PMTTYPEL.
 17817     GO TO 8100-SEND-INITIAL-MAP
 17818
 17819     .
 17820 7110-BUILD-PMT-TRLR.
 17821     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17822     MOVE +51                    TO TRLR-SEQ-NO
 17823
 17824* EXEC CICS READ
 17825*        DATASET  ('ELTRLR')
 17826*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17827*        RIDFLD   (ELTRLR-KEY)
 17828*        RESP     (WS-RESPONSE)
 17829*    END-EXEC
 17830     MOVE 'ELTRLR' TO DFHEIV1
 17831*    MOVE '&"S        E          (  N#00016336' TO DFHEIV0
 17832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17834     MOVE X'204E233030303136333336' TO DFHEIV0(25:11)
 17835     CALL 'kxdfhei1' USING DFHEIV0,
 17836           DFHEIV1,
 17837           DFHEIV20,
 17838           DFHEIV99,
 17839           ELTRLR-KEY,
 17840           DFHEIV99,
 17841           DFHEIV99,
 17842           DFHEIV99
 17843     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17844         DFHEIV20
 17845     MOVE EIBRESP  TO WS-RESPONSE
 17846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17847     IF WS-RESP-NORMAL
 17848        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 342
* EL156.cbl
 17849     END-IF
 17850     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17851
 17852* EXEC CICS GETMAIN
 17853*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17854*         LENGTH    (200)
 17855*         INITIMG   (GETMAIN-SPACE)
 17856*     END-EXEC
 17857     MOVE 200
 17858       TO DFHEIV11
 17859*    MOVE ',"IL                  $   #00016346' TO DFHEIV0
 17860     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17862     MOVE X'2020233030303136333436' TO DFHEIV0(25:11)
 17863     CALL 'kxdfhei1' USING DFHEIV0,
 17864           DFHEIV20,
 17865           DFHEIV11,
 17866           GETMAIN-SPACE
 17867     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17868         DFHEIV20
 17869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17870     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17871                                    AT-PREV-PAID-THRU-DT
 17872     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17873     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17874     MOVE 'AT'                   TO AT-RECORD-ID
 17875     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17876     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17877     MOVE '2'                    TO AT-TRAILER-TYPE
 17878     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17879                                    AT-PAYMENT-LAST-MAINT-DT
 17880     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17881                                    AT-PAYMENT-LAST-UPDATED-BY
 17882     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17883     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17884     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17885     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17886     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17887     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17888     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17889     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17890     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17891     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17892     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17893     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17894     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17895     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17896     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17897     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17898                                    AT-TO-BE-WRITTEN-DT
 17899     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17900                                    AT-CHECK-QUE-SEQUENCE
 17901                                    AT-ADDL-RESERVE
 17902     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17903                                    AT-VOID-SELECT-DT
 17904                                    AT-VOID-ACCEPT-DT
 17905                                    AT-VOID-DT
 17906                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 343
* EL156.cbl
 17907                                    AT-INT-PMT-SELECT-DT
 17908     MOVE ZEROS                  TO AT-DAILY-RATE
 17909                                    AT-ELIMINATION-DAYS
 17910     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17911*    EXEC CICS HANDLE CONDITION
 17912*        DUPREC    (7120-DUPREC)
 17913*    END-EXEC
 17914     .
 17915 7115-WRITE-INT-TRLR.
 17916
 17917* EXEC CICS WRITE
 17918*         DATASET       ('ELTRLR')
 17919*         FROM          (ACTIVITY-TRAILERS)
 17920*         RIDFLD        (AT-CONTROL-PRIMARY)
 17921*         RESP          (WS-RESPONSE)
 17922*     END-EXEC
 17923     MOVE LENGTH OF
 17924      ACTIVITY-TRAILERS
 17925       TO DFHEIV11
 17926     MOVE 'ELTRLR' TO DFHEIV1
 17927*    MOVE '&$ L                  ''  N#00016397' TO DFHEIV0
 17928     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17930     MOVE X'204E233030303136333937' TO DFHEIV0(25:11)
 17931     CALL 'kxdfhei1' USING DFHEIV0,
 17932           DFHEIV1,
 17933           ACTIVITY-TRAILERS,
 17934           DFHEIV11,
 17935           AT-CONTROL-PRIMARY,
 17936           DFHEIV99,
 17937           DFHEIV99
 17938     MOVE EIBRESP  TO WS-RESPONSE
 17939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17940      IF WS-RESP-DUPREC
 17941         GO TO 7120-DUPREC
 17942      END-IF
 17943     GO TO 7130-EXIT
 17944     .
 17945 7120-DUPREC.
 17946     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17947     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17948     GO TO 7115-WRITE-INT-TRLR
 17949     .
 17950 7130-EXIT.
 17951      EXIT.
 17952 7140-BUILD-NOTE-TRLR.
 17953
 17954
 17955* EXEC CICS GETMAIN
 17956*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17957*         LENGTH    (200)
 17958*         INITIMG   (GETMAIN-SPACE)
 17959*     END-EXEC
 17960     MOVE 200
 17961       TO DFHEIV11
 17962*    MOVE ',"IL                  $   #00016417' TO DFHEIV0
 17963     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 344
* EL156.cbl
 17965     MOVE X'2020233030303136343137' TO DFHEIV0(25:11)
 17966     CALL 'kxdfhei1' USING DFHEIV0,
 17967           DFHEIV20,
 17968           DFHEIV11,
 17969           GETMAIN-SPACE
 17970     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17971         DFHEIV20
 17972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17973     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17974     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17975     MOVE 'AT'                   TO AT-RECORD-ID
 17976     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17977     MOVE '6'                    TO AT-TRAILER-TYPE
 17978     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17979                                    AT-GEN-INFO-LAST-MAINT-DT
 17980     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17981                                    AT-GEN-INFO-LAST-UPDATED-BY
 17982     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17983     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17984     .
 17985 7150-WRITE.
 17986
 17987* EXEC CICS HANDLE CONDITION
 17988*        DUPREC    (7160-DUPREC)
 17989*    END-EXEC
 17990*    MOVE '"$%                   ! : #00016435' TO DFHEIV0
 17991     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17993     MOVE X'3A20233030303136343335' TO DFHEIV0(25:11)
 17994     CALL 'kxdfhei1' USING DFHEIV0
 17995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17996
 17997* EXEC CICS WRITE
 17998*         DATASET     ('ELTRLR')
 17999*         FROM        (ACTIVITY-TRAILERS)
 18000*         RIDFLD      (AT-CONTROL-PRIMARY)
 18001*         RESP        (WS-RESPONSE)
 18002*     END-EXEC
 18003     MOVE LENGTH OF
 18004      ACTIVITY-TRAILERS
 18005       TO DFHEIV11
 18006     MOVE 'ELTRLR' TO DFHEIV1
 18007*    MOVE '&$ L                  ''  N#00016438' TO DFHEIV0
 18008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18010     MOVE X'204E233030303136343338' TO DFHEIV0(25:11)
 18011     CALL 'kxdfhei1' USING DFHEIV0,
 18012           DFHEIV1,
 18013           ACTIVITY-TRAILERS,
 18014           DFHEIV11,
 18015           AT-CONTROL-PRIMARY,
 18016           DFHEIV99,
 18017           DFHEIV99
 18018     MOVE EIBRESP  TO WS-RESPONSE
 18019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18020      IF WS-RESP-DUPREC
 18021         GO TO 7160-DUPREC
 18022      END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 345
* EL156.cbl
 18023     GO TO 7170-EXIT
 18024     .
 18025 7160-DUPREC.
 18026     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18027     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18028     GO TO 7150-WRITE
 18029     .
 18030 7170-EXIT.
 18031      EXIT.
 18032
 18033 7180-ADD-CERT-NOTE.
 18034*ADD CERT NOTE FOR SC NP+6
 18035
 18036
 18037* EXEC CICS GETMAIN
 18038*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18039*         LENGTH    (150)
 18040*         INITIMG   (GETMAIN-SPACE)
 18041*     END-EXEC.
 18042     MOVE 150
 18043       TO DFHEIV11
 18044*    MOVE ',"IL                  $   #00016460' TO DFHEIV0
 18045     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18047     MOVE X'2020233030303136343630' TO DFHEIV0(25:11)
 18048     CALL 'kxdfhei1' USING DFHEIV0,
 18049           DFHEIV20,
 18050           DFHEIV11,
 18051           GETMAIN-SPACE
 18052     SET ADDRESS OF CERT-NOTE-FILE TO
 18053         DFHEIV20
 18054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18055
 18056
 18057     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18058     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18059     MOVE +1                     TO WRK-NOTE-SEQ.
 18060     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18061     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18062     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18063     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18064     MOVE CL-CERT-STATE          TO CZ-STATE.
 18065     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18066     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18067     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18068     MOVE '2'                    TO CZ-RECORD-TYPE.
 18069     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18070     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18071     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18072     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18073     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18074     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18075     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18076     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18077     IF PI-COMPANY-ID = 'AHL'
 18078        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18079           CONTINUE
 18080        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 346
* EL156.cbl
 18081           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18082              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18083           ELSE
 18084              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18085           END-IF
 18086        END-IF
 18087     END-IF
 18088     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18089     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18090
 18091 7181-WRITE.
 18092
 18093
 18094* EXEC CICS WRITE
 18095*         DATASET     ('ERCNOT')
 18096*         FROM        (CERT-NOTE-FILE)
 18097*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18098*         RESP        (WS-RESPONSE)
 18099*    END-EXEC.
 18100     MOVE LENGTH OF
 18101      CERT-NOTE-FILE
 18102       TO DFHEIV11
 18103     MOVE 'ERCNOT' TO DFHEIV1
 18104*    MOVE '&$ L                  ''  N#00016502' TO DFHEIV0
 18105     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18106     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18107     MOVE X'204E233030303136353032' TO DFHEIV0(25:11)
 18108     CALL 'kxdfhei1' USING DFHEIV0,
 18109           DFHEIV1,
 18110           CERT-NOTE-FILE,
 18111           DFHEIV11,
 18112           CZ-CONTROL-PRIMARY,
 18113           DFHEIV99,
 18114           DFHEIV99
 18115     MOVE EIBRESP  TO WS-RESPONSE
 18116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18117
 18118
 18119     IF WS-RESP-DUPREC
 18120         GO TO 7182-DUPREC
 18121     END-IF.
 18122
 18123     SET CERT-NOTE-ADDED TO TRUE.
 18124
 18125     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18126         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18127     END-IF.
 18128
 18129     GO TO 7189-EXIT.
 18130
 18131 7182-DUPREC.
 18132
 18133     ADD +1                      TO  WRK-NOTE-SEQ.
 18134     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18135     GO TO 7181-WRITE.
 18136
 18137 7189-EXIT.
 18138      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 347
* EL156.cbl
 18139
 18140 7190-ADD-ORIG-NOTE.
 18141
 18142
 18143* EXEC CICS GETMAIN
 18144*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18145*         LENGTH    (150)
 18146*         INITIMG   (GETMAIN-SPACE)
 18147*     END-EXEC.
 18148     MOVE 150
 18149       TO DFHEIV11
 18150*    MOVE ',"IL                  $   #00016532' TO DFHEIV0
 18151     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18152     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18153     MOVE X'2020233030303136353332' TO DFHEIV0(25:11)
 18154     CALL 'kxdfhei1' USING DFHEIV0,
 18155           DFHEIV20,
 18156           DFHEIV11,
 18157           GETMAIN-SPACE
 18158     SET ADDRESS OF CERT-NOTE-FILE TO
 18159         DFHEIV20
 18160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18161
 18162
 18163     ADD +1                      TO WRK-NOTE-SEQ.
 18164     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18165     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18166     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18167     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18168     MOVE CL-CERT-STATE          TO CZ-STATE.
 18169     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18170     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18171     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18172     MOVE '2'                    TO CZ-RECORD-TYPE.
 18173     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18174     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18175     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18176     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18177     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18178     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18179
 18180 7191-WRITE.
 18181
 18182
 18183* EXEC CICS WRITE
 18184*         DATASET     ('ERCNOT')
 18185*         FROM        (CERT-NOTE-FILE)
 18186*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18187*         RESP        (WS-RESPONSE)
 18188*    END-EXEC.
 18189     MOVE LENGTH OF
 18190      CERT-NOTE-FILE
 18191       TO DFHEIV11
 18192     MOVE 'ERCNOT' TO DFHEIV1
 18193*    MOVE '&$ L                  ''  N#00016557' TO DFHEIV0
 18194     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18196     MOVE X'204E233030303136353537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 348
* EL156.cbl
 18197     CALL 'kxdfhei1' USING DFHEIV0,
 18198           DFHEIV1,
 18199           CERT-NOTE-FILE,
 18200           DFHEIV11,
 18201           CZ-CONTROL-PRIMARY,
 18202           DFHEIV99,
 18203           DFHEIV99
 18204     MOVE EIBRESP  TO WS-RESPONSE
 18205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18206
 18207
 18208     IF WS-RESP-DUPREC
 18209         GO TO 7192-DUPREC
 18210     END-IF.
 18211
 18212     GO TO 7199-EXIT.
 18213
 18214 7192-DUPREC.
 18215
 18216     ADD +1                      TO  WRK-NOTE-SEQ.
 18217     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18218     GO TO 7191-WRITE.
 18219
 18220 7199-EXIT.
 18221      EXIT.
 18222 7200-FIND-BENEFIT.
 18223     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18224
 18225
 18226* EXEC CICS HANDLE CONDITION
 18227*        ENDFILE(7200-EXIT)
 18228*        NOTFND(7200-EXIT)
 18229*    END-EXEC.
 18230*    MOVE '"$''I                  ! ; #00016581' TO DFHEIV0
 18231     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18233     MOVE X'3B20233030303136353831' TO DFHEIV0(25:11)
 18234     CALL 'kxdfhei1' USING DFHEIV0
 18235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18236
 18237
 18238
 18239* EXEC CICS READ
 18240*        DATASET('ELCNTL')
 18241*        SET(ADDRESS OF CONTROL-FILE)
 18242*        RIDFLD(ELCNTL-KEY)
 18243*        GTEQ
 18244*    END-EXEC.
 18245     MOVE 'ELCNTL' TO DFHEIV1
 18246*    MOVE '&"S        G          (   #00016586' TO DFHEIV0
 18247     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18249     MOVE X'2020233030303136353836' TO DFHEIV0(25:11)
 18250     CALL 'kxdfhei1' USING DFHEIV0,
 18251           DFHEIV1,
 18252           DFHEIV20,
 18253           DFHEIV99,
 18254           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 349
* EL156.cbl
 18255           DFHEIV99,
 18256           DFHEIV99,
 18257           DFHEIV99
 18258     SET ADDRESS OF CONTROL-FILE TO
 18259         DFHEIV20
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
 18262
 18263     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18264        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18265           GO TO 7200-EXIT.
 18266
 18267     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18268         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18269            ((SUB-1 > 8) OR
 18270            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18271
 18272     IF SUB-1 NOT = 9
 18273         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18274
 18275     GO TO 7200-EXIT.
 18276
 18277 7200-BENEFIT-DUMMY.
 18278
 18279 7200-DUMMY-EXIT.
 18280     EXIT.
 18281
 18282 7200-EXIT.
 18283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 350
* EL156.cbl
 18285*052506
 18286*052506 7250-FIND-LETTER-TRLR.
 18287*052506     EXEC CICS HANDLE CONDITION
 18288*052506         ENDFILE  (7250-END)
 18289*052506         NOTFND   (7250-END)
 18290*052506     END-EXEC.
 18291*052506
 18292*052506     EXEC CICS STARTBR
 18293*052506         DATASET   ('ELTRLR')
 18294*052506         RIDFLD    (ELTRLR-KEY)
 18295*052506         GTEQ
 18296*052506     END-EXEC.
 18297*052506
 18298*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18299*052506
 18300*052506 7250-FIND-LOOP.
 18301*052506     EXEC CICS READNEXT
 18302*052506         DATASET   ('ELTRLR')
 18303*052506         RIDFLD    (ELTRLR-KEY)
 18304*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18305*052506     END-EXEC.
 18306*052506
 18307*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18308*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18309*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18310*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18311*052506        GO TO 7250-END
 18312*052506     END-IF.
 18313*052506
 18314*052506     IF AT-TRAILER-TYPE NOT = '4'
 18315*052506         GO TO 7250-FIND-LOOP
 18316*052506     END-IF.
 18317*052506
 18318*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18319*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18320*052506     END-IF.
 18321*052506
 18322*052506     GO TO 7250-FIND-LOOP.
 18323*052506
 18324*052506 7250-END.
 18325*052506
 18326*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18327*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18328*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18329*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18330*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18331*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18332*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18333*052506     END-IF.
 18334*052506
 18335*052506     EXEC CICS ENDBR
 18336*052506          DATASET    ('ELTRLR')
 18337*052506     END-EXEC.
 18338*052506
 18339*052506 7250-EXIT.
 18340*052506     EXIT.
 18341*052506     EJECT
 18342*052506
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 351
* EL156.cbl
 18343 7300-CHECK-AUTO-ACTIVITY.
 18344
 18345     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18346         NEXT SENTENCE
 18347     ELSE
 18348         GO TO 7399-EXIT.
 18349
 18350     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18351
 18352     IF WS-ACT-REC-FOUND-SW = 'N'
 18353         GO TO 7399-EXIT.
 18354
 18355     IF PI-ACTIVITY-CODE = 09
 18356         GO TO 7300-CONT-AUTO-ACTIVITY.
 18357
 18358     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18359        (PI-ACTIVITY-CODE = 11)
 18360         GO TO 7300-CONT-AUTO-ACTIVITY.
 18361
 18362     IF PI-PROVISIONAL-IND = 'P'
 18363         IF PI-PMTTYPE = '1'
 18364             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18365                 MOVE 'N'    TO  PI-RESET-SW
 18366                 GO TO 7399-EXIT.
 18367
 18368     IF PI-PMTTYPE = '1'
 18369         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18370             MOVE 'N'        TO  PI-RESET-SW
 18371             GO TO 7399-EXIT.
 18372
 18373     IF PI-PMTTYPE = '2' OR '3'
 18374         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18375             MOVE 'N'        TO  PI-RESET-SW
 18376             GO TO 7399-EXIT.
 18377
 18378     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18379         IF PI-PROVISIONAL-IND = 'P'
 18380             NEXT SENTENCE
 18381         ELSE
 18382             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18383
 18384 7300-CONT-AUTO-ACTIVITY.
 18385
 18386     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18387         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18388         MOVE '4'            TO DC-OPTION-CODE
 18389         MOVE +0             TO DC-ELAPSED-DAYS
 18390                                DC-ELAPSED-MONTHS
 18391         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18392         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18393         IF PI-USES-PAID-TO
 18394             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18395             IF NO-CONVERSION-ERROR
 18396                 MOVE +1     TO DC-ELAPSED-DAYS
 18397                 MOVE +0     TO DC-ELAPSED-MONTHS
 18398                 MOVE '6'    TO DC-OPTION-CODE
 18399                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18400                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 352
* EL156.cbl
 18401                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18402
 18403     IF PI-PFKEY-USED = DFHPF5
 18404         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18405         IF PI-USES-PAID-TO
 18406             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18407             MOVE +1                  TO DC-ELAPSED-DAYS
 18408             MOVE +0                  TO DC-ELAPSED-MONTHS
 18409             MOVE '6'                 TO DC-OPTION-CODE
 18410             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18411             IF NO-CONVERSION-ERROR
 18412                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18413
 18414     IF WS-CHK-THRU-DT < PI-EXP-DT
 18415         NEXT SENTENCE
 18416     ELSE
 18417         MOVE 03                     TO  WS-ACTIVITY-CODE
 18418         GO TO 7390-PROCESS-ACTIVITY.
 18419
 18420     IF PI-PROV-PMT
 18421         MOVE 09                     TO  WS-ACTIVITY-CODE
 18422     ELSE
 18423        IF PI-PMTTYPE = '1'
 18424            MOVE 02                  TO  WS-ACTIVITY-CODE
 18425        ELSE
 18426        IF PI-PMTTYPE = '2' OR '3'
 18427            MOVE 07                  TO  WS-ACTIVITY-CODE
 18428        ELSE
 18429        IF PI-PMTTYPE = '4'
 18430            MOVE 00                  TO  WS-ACTIVITY-CODE
 18431        ELSE
 18432            MOVE 'N'                 TO  PI-RESET-SW
 18433            GO TO 7399-EXIT.
 18434
 18435 7390-PROCESS-ACTIVITY.
 18436
 18437     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18438
 18439 7399-EXIT.
 18440     EXIT.
 18441
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 353
* EL156.cbl
 18443 7400-CHECK-AUTO-ACTIVITY.
 18444
 18445
 18446* EXEC CICS HANDLE CONDITION
 18447*        NOTFND   (7400-NOT-FOUND)
 18448*    END-EXEC.
 18449*    MOVE '"$I                   ! < #00016775' TO DFHEIV0
 18450     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18452     MOVE X'3C20233030303136373735' TO DFHEIV0(25:11)
 18453     CALL 'kxdfhei1' USING DFHEIV0
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18455
 18456
 18457     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18458     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18459     MOVE SPACES                 TO  CNTL-ACCESS.
 18460     MOVE +0                     TO  CNTL-SEQ-NO.
 18461
 18462
 18463* EXEC CICS READ
 18464*        DATASET   ('ELCNTL')
 18465*        RIDFLD    (ELCNTL-KEY)
 18466*        SET       (ADDRESS OF CONTROL-FILE)
 18467*    END-EXEC.
 18468     MOVE 'ELCNTL' TO DFHEIV1
 18469*    MOVE '&"S        E          (   #00016784' TO DFHEIV0
 18470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18472     MOVE X'2020233030303136373834' TO DFHEIV0(25:11)
 18473     CALL 'kxdfhei1' USING DFHEIV0,
 18474           DFHEIV1,
 18475           DFHEIV20,
 18476           DFHEIV99,
 18477           ELCNTL-KEY,
 18478           DFHEIV99,
 18479           DFHEIV99,
 18480           DFHEIV99
 18481     SET ADDRESS OF CONTROL-FILE TO
 18482         DFHEIV20
 18483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18484
 18485
 18486     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18487     GO TO 7400-EXIT.
 18488
 18489 7400-NOT-FOUND.
 18490     MOVE 'N'                        TO  PI-RESET-SW
 18491                                         WS-LETTER-SW
 18492                                         WS-ACT-REC-FOUND-SW.
 18493
 18494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18495
 18496 7400-EXIT.
 18497     EXIT.
 18498
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 354
* EL156.cbl
 18500 7450-FORMAT-AUTO-LETTER.
 18501
 18502     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18503         MOVE 'Y'                    TO PI-RESET-SW
 18504         GO TO 7450-CONTINUE-PROCESS.
 18505
 18506     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18507
 18508     IF SUB > 9
 18509         SUBTRACT 9 FROM SUB
 18510         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18511     ELSE
 18512         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18513
 18514 7450-CONTINUE-PROCESS.
 18515
 18516     IF WS-ACTIVITY-CODE = ZEROS
 18517         MOVE 'N'                    TO  WS-LETTER-SW
 18518         GO TO 7450-EXIT.
 18519
 18520     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18521
 18522     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18523         MOVE 'N'                    TO  PI-RESET-SW
 18524                                         WS-LETTER-SW
 18525         GO TO 7450-EXIT.
 18526
 18527     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18528         MOVE 'N'                    TO  WS-LETTER-SW
 18529         GO TO 7450-EXIT.
 18530
 18531     MOVE 'Y'                        TO  WS-LETTER-SW.
 18532     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18533     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18534
 18535     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18536
 18537     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18538         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18539         MOVE '6'                    TO  DC-OPTION-CODE
 18540         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18541         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18542         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18543         IF NO-CONVERSION-ERROR
 18544             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18545         ELSE
 18546              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18547
 18548     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18549         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18550         MOVE '6'                    TO  DC-OPTION-CODE
 18551         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18552         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18553         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18554         IF NO-CONVERSION-ERROR
 18555             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18556         ELSE
 18557             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 355
* EL156.cbl
 18558
 18559 7450-EXIT.
 18560     EXIT.
 18561
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 356
* EL156.cbl
 18563 7500-RESET-AUTO-ACTIVITY.
 18564
 18565     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18566     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18567     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18568     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18569     MOVE +100                   TO  TRLR-SEQ-NO.
 18570
 18571 7500-STARTBR-TRLR.
 18572
 18573
 18574* EXEC CICS HANDLE CONDITION
 18575*        ENDFILE  (7590-END)
 18576*        NOTFND   (7590-END)
 18577*    END-EXEC.
 18578*    MOVE '"$''I                  ! = #00016877' TO DFHEIV0
 18579     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18581     MOVE X'3D20233030303136383737' TO DFHEIV0(25:11)
 18582     CALL 'kxdfhei1' USING DFHEIV0
 18583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18584
 18585
 18586
 18587* EXEC CICS STARTBR
 18588*        DATASET   ('ELTRLR')
 18589*        RIDFLD    (ELTRLR-KEY)
 18590*        GTEQ
 18591*    END-EXEC.
 18592     MOVE 'ELTRLR' TO DFHEIV1
 18593     MOVE 0
 18594       TO DFHEIV11
 18595*    MOVE '&,         G          &   #00016882' TO DFHEIV0
 18596     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18597     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18598     MOVE X'2020233030303136383832' TO DFHEIV0(25:11)
 18599     CALL 'kxdfhei1' USING DFHEIV0,
 18600           DFHEIV1,
 18601           ELTRLR-KEY,
 18602           DFHEIV99,
 18603           DFHEIV11,
 18604           DFHEIV99
 18605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18606
 18607
 18608     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18609
 18610 7500-READ-NEXT.
 18611
 18612
 18613* EXEC CICS READNEXT
 18614*        DATASET   ('ELTRLR')
 18615*        RIDFLD    (ELTRLR-KEY)
 18616*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18617*    END-EXEC.
 18618     MOVE 'ELTRLR' TO DFHEIV1
 18619     MOVE 0
 18620       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 357
* EL156.cbl
 18621*    MOVE '&.S                   )   #00016892' TO DFHEIV0
 18622     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18624     MOVE X'2020233030303136383932' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0,
 18626           DFHEIV1,
 18627           DFHEIV20,
 18628           DFHEIV99,
 18629           ELTRLR-KEY,
 18630           DFHEIV99,
 18631           DFHEIV11,
 18632           DFHEIV99,
 18633           DFHEIV99
 18634     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18635         DFHEIV20
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638
 18639     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18640        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18641        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18642        PI-CERT-NO    NOT = TRLR-CERT-NO
 18643         GO TO 7590-END.
 18644
 18645     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18646         GO TO 7500-READ-NEXT.
 18647
 18648     IF AT-TRAILER-TYPE NOT = '4'
 18649         GO TO 7500-READ-NEXT.
 18650
 18651     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18652         GO TO 7500-READ-NEXT.
 18653
 18654     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18655        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18656         GO TO 7500-READ-NEXT.
 18657
 18658     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18659        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18660        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18661         GO TO 7500-READ-NEXT.
 18662
 18663     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18664                         AND
 18665        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18666                         AND
 18667        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18668            GO TO 7500-READ-NEXT.
 18669
 18670     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18671
 18672
 18673* EXEC CICS ENDBR
 18674*        DATASET   ('ELTRLR')
 18675*    END-EXEC.
 18676     MOVE 'ELTRLR' TO DFHEIV1
 18677     MOVE 0
 18678       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 358
* EL156.cbl
 18679*    MOVE '&2                    $   #00016931' TO DFHEIV0
 18680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18682     MOVE X'2020233030303136393331' TO DFHEIV0(25:11)
 18683     CALL 'kxdfhei1' USING DFHEIV0,
 18684           DFHEIV1,
 18685           DFHEIV11,
 18686           DFHEIV99
 18687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18688
 18689
 18690     MOVE 'N'                        TO  WS-BROWSE-SW.
 18691
 18692
 18693* EXEC CICS READ
 18694*        DATASET   ('ELTRLR')
 18695*        RIDFLD    (ELTRLR-KEY)
 18696*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18697*        UPDATE
 18698*    END-EXEC.
 18699     MOVE 'ELTRLR' TO DFHEIV1
 18700*    MOVE '&"S        EU         (   #00016937' TO DFHEIV0
 18701     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18702     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18703     MOVE X'2020233030303136393337' TO DFHEIV0(25:11)
 18704     CALL 'kxdfhei1' USING DFHEIV0,
 18705           DFHEIV1,
 18706           DFHEIV20,
 18707           DFHEIV99,
 18708           ELTRLR-KEY,
 18709           DFHEIV99,
 18710           DFHEIV99,
 18711           DFHEIV99
 18712     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18713         DFHEIV20
 18714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18715
 18716
 18717     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18718
 18719     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18720         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18721     ELSE
 18722         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18723             NEXT SENTENCE
 18724         ELSE
 18725             GO TO 7500-REWRITE-TRLR.
 18726
 18727     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18728
 18729     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18730     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18731     MOVE '1'                        TO  ARCH-REC-TYPE.
 18732     MOVE +0                         TO  ARCH-SEQ.
 18733
 18734     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18735
 18736 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 359
* EL156.cbl
 18737
 18738
 18739* EXEC CICS REWRITE
 18740*        DATASET   ('ELTRLR')
 18741*        FROM      (ACTIVITY-TRAILERS)
 18742*    END-EXEC.
 18743     MOVE LENGTH OF
 18744      ACTIVITY-TRAILERS
 18745       TO DFHEIV11
 18746     MOVE 'ELTRLR' TO DFHEIV1
 18747*    MOVE '&& L                  %   #00016965' TO DFHEIV0
 18748     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18750     MOVE X'2020233030303136393635' TO DFHEIV0(25:11)
 18751     CALL 'kxdfhei1' USING DFHEIV0,
 18752           DFHEIV1,
 18753           ACTIVITY-TRAILERS,
 18754           DFHEIV11,
 18755           DFHEIV99
 18756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18757
 18758
 18759     GO TO 7500-STARTBR-TRLR.
 18760
 18761 7590-END.
 18762
 18763     IF WS-BROWSE-SW = 'Y'
 18764         MOVE 'N'                    TO  WS-BROWSE-SW
 18765
 18766* EXEC CICS ENDBR
 18767*            DATASET   ('ELTRLR')
 18768*        END-EXEC.
 18769     MOVE 'ELTRLR' TO DFHEIV1
 18770     MOVE 0
 18771       TO DFHEIV11
 18772*    MOVE '&2                    $   #00016976' TO DFHEIV0
 18773     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18774     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18775     MOVE X'2020233030303136393736' TO DFHEIV0(25:11)
 18776     CALL 'kxdfhei1' USING DFHEIV0,
 18777           DFHEIV1,
 18778           DFHEIV11,
 18779           DFHEIV99
 18780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18781
 18782
 18783 7599-EXIT.
 18784     EXIT.
 18785
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 360
* EL156.cbl
 18787 7600-READ-ARCH-UPDATE.
 18788
 18789
 18790* EXEC CICS HANDLE CONDITION
 18791*        NOTFND   (7699-EXIT)
 18792*    END-EXEC.
 18793*    MOVE '"$I                   ! > #00016986' TO DFHEIV0
 18794     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18796     MOVE X'3E20233030303136393836' TO DFHEIV0(25:11)
 18797     CALL 'kxdfhei1' USING DFHEIV0
 18798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18799
 18800
 18801
 18802* EXEC CICS READ
 18803*        DATASET   ('ELARCH')
 18804*        RIDFLD    (ELARCH-KEY)
 18805*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18806*        UPDATE
 18807*    END-EXEC.
 18808     MOVE 'ELARCH' TO DFHEIV1
 18809*    MOVE '&"S        EU         (   #00016990' TO DFHEIV0
 18810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18812     MOVE X'2020233030303136393930' TO DFHEIV0(25:11)
 18813     CALL 'kxdfhei1' USING DFHEIV0,
 18814           DFHEIV1,
 18815           DFHEIV20,
 18816           DFHEIV99,
 18817           ELARCH-KEY,
 18818           DFHEIV99,
 18819           DFHEIV99,
 18820           DFHEIV99
 18821     SET ADDRESS OF LETTER-ARCHIVE TO
 18822         DFHEIV20
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18824
 18825
 18826     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18827
 18828
 18829* EXEC CICS REWRITE
 18830*        DATASET   ('ELARCH')
 18831*        FROM      (LETTER-ARCHIVE)
 18832*    END-EXEC.
 18833     MOVE LENGTH OF
 18834      LETTER-ARCHIVE
 18835       TO DFHEIV11
 18836     MOVE 'ELARCH' TO DFHEIV1
 18837*    MOVE '&& L                  %   #00016999' TO DFHEIV0
 18838     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18839     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18840     MOVE X'2020233030303136393939' TO DFHEIV0(25:11)
 18841     CALL 'kxdfhei1' USING DFHEIV0,
 18842           DFHEIV1,
 18843           LETTER-ARCHIVE,
 18844           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 361
* EL156.cbl
 18845           DFHEIV99
 18846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18847
 18848
 18849 7699-EXIT.
 18850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 362
* EL156.cbl
 18852 7700-GET-DCT.
 18853
 18854     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18855     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18856     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18857     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18858                                    PI-MAX-BENEFIT-AMT
 18859                                    PI-MAX-BENEFIT-PYMT
 18860                                    PI-MIN-PAYMENT-AMT
 18861                                    PI-TIME-OF-LOSS-BAL.
 18862
 18863
 18864* EXEC CICS HANDLE CONDITION
 18865*         NOTFND (5300-NOTE-NOT-FOUND)
 18866*     END-EXEC.
 18867*    MOVE '"$I                   ! ? #00017018' TO DFHEIV0
 18868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18870     MOVE X'3F20233030303137303138' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0
 18872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18873
 18874
 18875
 18876* EXEC CICS READ
 18877*         DATASET('ERNOTE')
 18878*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18879*         RIDFLD (W-NOTE-KEY)
 18880*     END-EXEC.
 18881     MOVE 'ERNOTE' TO DFHEIV1
 18882*    MOVE '&"S        E          (   #00017022' TO DFHEIV0
 18883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18885     MOVE X'2020233030303137303232' TO DFHEIV0(25:11)
 18886     CALL 'kxdfhei1' USING DFHEIV0,
 18887           DFHEIV1,
 18888           DFHEIV20,
 18889           DFHEIV99,
 18890           W-NOTE-KEY,
 18891           DFHEIV99,
 18892           DFHEIV99,
 18893           DFHEIV99
 18894     SET ADDRESS OF CERTIFICATE-NOTE TO
 18895         DFHEIV20
 18896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18897
 18898
 18899     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18900     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18901     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18902     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18903     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18904
 18905     IF PI-PAYEE-TYPE NOT = 'B'
 18906         GO TO 7700-EXIT.
 18907
 18908     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18909     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 363
* EL156.cbl
 18910     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18911
 18912     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18913         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18914     ELSE
 18915         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18916
 18917     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18918     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18919     MOVE 'DLO006'               TO PGM-NAME.
 18920
 18921
 18922* EXEC CICS LINK
 18923*        PROGRAM    (PGM-NAME)
 18924*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18925*        LENGTH     (DCT-RCRD-LENGTH)
 18926*    END-EXEC.
 18927*    MOVE '."C                   (   #00017050' TO DFHEIV0
 18928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18930     MOVE X'2020233030303137303530' TO DFHEIV0(25:11)
 18931     CALL 'kxdfhei1' USING DFHEIV0,
 18932           PGM-NAME,
 18933           DCT-COMMUNICATION-AREA,
 18934           DCT-RCRD-LENGTH,
 18935           DFHEIV99,
 18936           DFHEIV99,
 18937           DFHEIV99,
 18938           DFHEIV99
 18939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18940
 18941
 18942     IF DCT-RETURN-CODE = 'OK'
 18943         GO TO 7700-CONT.
 18944
 18945     IF DCT-RETURN-CODE = '01' OR '02'
 18946         GO TO 7700-SET-TO-YES.
 18947
 18948     IF DCT-RETURN-CODE = '03'
 18949
 18950* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18951*    MOVE '6"R                   !   #00017063' TO DFHEIV0
 18952     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18954     MOVE X'2020233030303137303633' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18957         MOVE ER-0951            TO EMI-ERROR
 18958         MOVE -1                 TO PMTTYPEL
 18959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18960         GO TO 8200-SEND-DATAONLY.
 18961
 18962     IF DCT-RETURN-CODE = '04'
 18963
 18964* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18965*    MOVE '6"R                   !   #00017070' TO DFHEIV0
 18966     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 364
* EL156.cbl
 18968     MOVE X'2020233030303137303730' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0
 18970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18971         MOVE ER-0946            TO EMI-ERROR
 18972         MOVE -1                 TO PMTTYPEL
 18973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18974         GO TO 8200-SEND-DATAONLY.
 18975
 18976     IF DCT-RETURN-CODE = '05'
 18977
 18978* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18979*    MOVE '6"R                   !   #00017077' TO DFHEIV0
 18980     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303137303737' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0
 18984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18985         MOVE ER-0947            TO EMI-ERROR
 18986         MOVE -1                 TO PMTTYPEL
 18987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18988         GO TO 8200-SEND-DATAONLY.
 18989
 18990     IF DCT-RETURN-CODE = '06'
 18991
 18992* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18993*    MOVE '6"R                   !   #00017084' TO DFHEIV0
 18994     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18996     MOVE X'2020233030303137303834' TO DFHEIV0(25:11)
 18997     CALL 'kxdfhei1' USING DFHEIV0
 18998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18999         MOVE ER-0921            TO EMI-ERROR
 19000         MOVE -1                 TO PMTTYPEL
 19001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19002         GO TO 8200-SEND-DATAONLY.
 19003
 19004     IF DCT-RETURN-CODE = '07'
 19005
 19006* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19007*    MOVE '6"R                   !   #00017091' TO DFHEIV0
 19008     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19010     MOVE X'2020233030303137303931' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0
 19012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19013         MOVE ER-0919            TO EMI-ERROR
 19014         MOVE -1                 TO PMTTYPEL
 19015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19016         GO TO 8200-SEND-DATAONLY.
 19017
 19018     IF DCT-RETURN-CODE = '08'
 19019
 19020* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19021*    MOVE '6"R                   !   #00017098' TO DFHEIV0
 19022     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303137303938' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 365
* EL156.cbl
 19026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19027         MOVE ER-0948            TO EMI-ERROR
 19028         MOVE -1                 TO PMTTYPEL
 19029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19030         GO TO 8200-SEND-DATAONLY.
 19031
 19032     IF DCT-RETURN-CODE = 'N1'
 19033
 19034* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19035*    MOVE '6"R                   !   #00017105' TO DFHEIV0
 19036     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19038     MOVE X'2020233030303137313035' TO DFHEIV0(25:11)
 19039     CALL 'kxdfhei1' USING DFHEIV0
 19040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19041         MOVE ER-0950            TO EMI-ERROR
 19042         MOVE -1                 TO PMTTYPEL
 19043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19044         GO TO 8200-SEND-DATAONLY.
 19045
 19046     IF DCT-RETURN-CODE = 'E1'
 19047
 19048* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19049*    MOVE '6"R                   !   #00017112' TO DFHEIV0
 19050     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19052     MOVE X'2020233030303137313132' TO DFHEIV0(25:11)
 19053     CALL 'kxdfhei1' USING DFHEIV0
 19054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19055         MOVE ER-0974            TO EMI-ERROR
 19056         MOVE -1                 TO PMTTYPEL
 19057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19058         GO TO 8200-SEND-DATAONLY.
 19059
 19060     IF DCT-RETURN-CODE = 'E2'
 19061
 19062* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19063*    MOVE '6"R                   !   #00017119' TO DFHEIV0
 19064     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19066     MOVE X'2020233030303137313139' TO DFHEIV0(25:11)
 19067     CALL 'kxdfhei1' USING DFHEIV0
 19068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19069         MOVE ER-0975            TO EMI-ERROR
 19070         MOVE -1                 TO PMTTYPEL
 19071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19072         GO TO 8200-SEND-DATAONLY.
 19073
 19074     IF DCT-RETURN-CODE NOT = 'OK'
 19075
 19076* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19077*    MOVE '6"R                   !   #00017126' TO DFHEIV0
 19078     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19080     MOVE X'2020233030303137313236' TO DFHEIV0(25:11)
 19081     CALL 'kxdfhei1' USING DFHEIV0
 19082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19083         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 366
* EL156.cbl
 19084         MOVE -1                 TO PMTTYPEL
 19085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19086         GO TO 8200-SEND-DATAONLY.
 19087
 19088 7700-CONT.
 19089
 19090*    MOVE 'N'                    TO CASHO.
 19091*    MOVE +1                     TO CASHL.
 19092*    MOVE AL-UANON               TO CASHA.
 19093
 19094     IF PI-OFFLINE = 'Y'
 19095         GO TO 7700-EXIT.
 19096
 19097     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19098     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19099     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19100     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19101     MOVE +7                     TO CHECKNOL.
 19102     MOVE AL-UANON               TO CHECKNOA.
 19103     GO TO 7700-EXIT.
 19104
 19105 7700-SET-TO-YES.
 19106
 19107*    MOVE 'Y'                    TO CASHO.
 19108*    MOVE +1                     TO CASHL.
 19109*    MOVE AL-UANON               TO CASHA.
 19110
 19111 7700-EXIT.
 19112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 367
* EL156.cbl
 19114 7800-READ-COMP-MSTR.
 19115
 19116
 19117* EXEC CICS HANDLE CONDITION
 19118*        NOTFND   (7800-COMP-NOTFND)
 19119*    END-EXEC.
 19120*    MOVE '"$I                   ! @ #00017160' TO DFHEIV0
 19121     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19123     MOVE X'4020233030303137313630' TO DFHEIV0(25:11)
 19124     CALL 'kxdfhei1' USING DFHEIV0
 19125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19126
 19127
 19128
 19129* EXEC CICS READ
 19130*        DATASET   ('ERCOMP')
 19131*        RIDFLD    (ERCOMP-KEY)
 19132*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19133*    END-EXEC.
 19134     MOVE 'ERCOMP' TO DFHEIV1
 19135*    MOVE '&"S        E          (   #00017164' TO DFHEIV0
 19136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19138     MOVE X'2020233030303137313634' TO DFHEIV0(25:11)
 19139     CALL 'kxdfhei1' USING DFHEIV0,
 19140           DFHEIV1,
 19141           DFHEIV20,
 19142           DFHEIV99,
 19143           ERCOMP-KEY,
 19144           DFHEIV99,
 19145           DFHEIV99,
 19146           DFHEIV99
 19147     SET ADDRESS OF COMPENSATION-MASTER TO
 19148         DFHEIV20
 19149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19150
 19151
 19152     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19153     GO TO 7800-COMP-EXIT.
 19154
 19155 7800-COMP-NOTFND.
 19156     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19157
 19158 7800-COMP-EXIT.
 19159     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 368
* EL156.cbl
 19161 7900-READ-CLAIM.
 19162
 19163* EXEC CICS READ
 19164*        DATASET  ('ELMSTR')
 19165*        SET      (ADDRESS OF CLAIM-MASTER)
 19166*        RIDFLD   (ELMSTR-KEY)
 19167*    END-EXEC.
 19168     MOVE 'ELMSTR' TO DFHEIV1
 19169*    MOVE '&"S        E          (   #00017180' TO DFHEIV0
 19170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303137313830' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0,
 19174           DFHEIV1,
 19175           DFHEIV20,
 19176           DFHEIV99,
 19177           ELMSTR-KEY,
 19178           DFHEIV99,
 19179           DFHEIV99,
 19180           DFHEIV99
 19181     SET ADDRESS OF CLAIM-MASTER TO
 19182         DFHEIV20
 19183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19184
 19185
 19186 7900-EXIT.
 19187      EXIT.
 19188
 19189 7910-READ-CLAIM-UPDATE.
 19190
 19191* EXEC CICS READ
 19192*        DATASET  ('ELMSTR')
 19193*        SET      (ADDRESS OF CLAIM-MASTER)
 19194*        RIDFLD   (ELMSTR-KEY)
 19195*        UPDATE
 19196*    END-EXEC.
 19197     MOVE 'ELMSTR' TO DFHEIV1
 19198*    MOVE '&"S        EU         (   #00017190' TO DFHEIV0
 19199     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19200     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303137313930' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0,
 19203           DFHEIV1,
 19204           DFHEIV20,
 19205           DFHEIV99,
 19206           ELMSTR-KEY,
 19207           DFHEIV99,
 19208           DFHEIV99,
 19209           DFHEIV99
 19210     SET ADDRESS OF CLAIM-MASTER TO
 19211         DFHEIV20
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 7910-EXIT.
 19216      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 369
* EL156.cbl
 19218 7920-READ-BENE.
 19219     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19220     MOVE 'B'                TO BENE-RECORD-TYPE.
 19221     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19222
 19223     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19224        IF PI-PAYEE-TYPE    = 'B' AND
 19225           PI-PAYEE-SEQ-NUM = 9
 19226             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19227             MOVE WS-A-BENE           TO BENE-NUMBER.
 19228
 19229
 19230* EXEC CICS HANDLE CONDITION
 19231*        NOTFND   (7920-NOT-FOUND)
 19232*    END-EXEC.
 19233*    MOVE '"$I                   ! A #00017211' TO DFHEIV0
 19234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19236     MOVE X'4120233030303137323131' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0
 19238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19239
 19240
 19241
 19242* EXEC CICS READ
 19243*        DATASET  ('ELBENE')
 19244*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19245*        RIDFLD   (ELBENE-KEY)
 19246*    END-EXEC.
 19247     MOVE 'ELBENE' TO DFHEIV1
 19248*    MOVE '&"S        E          (   #00017215' TO DFHEIV0
 19249     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19251     MOVE X'2020233030303137323135' TO DFHEIV0(25:11)
 19252     CALL 'kxdfhei1' USING DFHEIV0,
 19253           DFHEIV1,
 19254           DFHEIV20,
 19255           DFHEIV99,
 19256           ELBENE-KEY,
 19257           DFHEIV99,
 19258           DFHEIV99,
 19259           DFHEIV99
 19260     SET ADDRESS OF BENEFICIARY-MASTER TO
 19261         DFHEIV20
 19262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19263
 19264
 19265     MOVE 'Y' TO BENE-FOUND-SW.
 19266     GO TO 7920-EXIT.
 19267
 19268 7920-NOT-FOUND.
 19269     MOVE 'N'                    TO BENE-FOUND-SW.
 19270
 19271 7920-EXIT.
 19272      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 370
* EL156.cbl
 19274 7930-READ-CONTROL.
 19275
 19276* EXEC CICS READ
 19277*        DATASET  ('ELCNTL')
 19278*        SET      (ADDRESS OF CONTROL-FILE)
 19279*        RIDFLD   (ELCNTL-KEY)
 19280*    END-EXEC.
 19281     MOVE 'ELCNTL' TO DFHEIV1
 19282*    MOVE '&"S        E          (   #00017231' TO DFHEIV0
 19283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19285     MOVE X'2020233030303137323331' TO DFHEIV0(25:11)
 19286     CALL 'kxdfhei1' USING DFHEIV0,
 19287           DFHEIV1,
 19288           DFHEIV20,
 19289           DFHEIV99,
 19290           ELCNTL-KEY,
 19291           DFHEIV99,
 19292           DFHEIV99,
 19293           DFHEIV99
 19294     SET ADDRESS OF CONTROL-FILE TO
 19295         DFHEIV20
 19296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19297
 19298
 19299 7930-EXIT.
 19300      EXIT.
 19301
 19302 7940-READ-CONTROL-UPDATE.
 19303
 19304* EXEC CICS READ
 19305*        DATASET  ('ELCNTL')
 19306*        SET      (ADDRESS OF CONTROL-FILE)
 19307*        RIDFLD   (ELCNTL-KEY)
 19308*        UPDATE
 19309*    END-EXEC.
 19310     MOVE 'ELCNTL' TO DFHEIV1
 19311*    MOVE '&"S        EU         (   #00017241' TO DFHEIV0
 19312     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19313     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303137323431' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           DFHEIV1,
 19317           DFHEIV20,
 19318           DFHEIV99,
 19319           ELCNTL-KEY,
 19320           DFHEIV99,
 19321           DFHEIV99,
 19322           DFHEIV99
 19323     SET ADDRESS OF CONTROL-FILE TO
 19324         DFHEIV20
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19326
 19327
 19328 7940-EXIT.
 19329      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 371
* EL156.cbl
 19331 7950-READ-TRAILER.
 19332
 19333* EXEC CICS READ
 19334*        DATASET  ('ELTRLR')
 19335*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19336*        RIDFLD   (ELTRLR-KEY)
 19337*    END-EXEC.
 19338     MOVE 'ELTRLR' TO DFHEIV1
 19339*    MOVE '&"S        E          (   #00017252' TO DFHEIV0
 19340     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19341     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19342     MOVE X'2020233030303137323532' TO DFHEIV0(25:11)
 19343     CALL 'kxdfhei1' USING DFHEIV0,
 19344           DFHEIV1,
 19345           DFHEIV20,
 19346           DFHEIV99,
 19347           ELTRLR-KEY,
 19348           DFHEIV99,
 19349           DFHEIV99,
 19350           DFHEIV99
 19351     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19352         DFHEIV20
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19354
 19355
 19356 7950-EXIT.
 19357      EXIT.
 19358
 19359 7960-READ-TRAILER-UPDATE.
 19360
 19361* EXEC CICS READ
 19362*        DATASET  ('ELTRLR')
 19363*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19364*        RIDFLD   (ELTRLR-KEY)
 19365*        UPDATE
 19366*    END-EXEC.
 19367     MOVE 'ELTRLR' TO DFHEIV1
 19368*    MOVE '&"S        EU         (   #00017262' TO DFHEIV0
 19369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19370     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19371     MOVE X'2020233030303137323632' TO DFHEIV0(25:11)
 19372     CALL 'kxdfhei1' USING DFHEIV0,
 19373           DFHEIV1,
 19374           DFHEIV20,
 19375           DFHEIV99,
 19376           ELTRLR-KEY,
 19377           DFHEIV99,
 19378           DFHEIV99,
 19379           DFHEIV99
 19380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19381         DFHEIV20
 19382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19383
 19384
 19385 7960-EXIT.
 19386      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 372
* EL156.cbl
 19388 7970-READ-CERT.
 19389
 19390* EXEC CICS READ
 19391*        DATASET  ('ELCERT')
 19392*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19393*        RIDFLD   (ELCERT-KEY)
 19394*    END-EXEC.
 19395     MOVE 'ELCERT' TO DFHEIV1
 19396*    MOVE '&"S        E          (   #00017273' TO DFHEIV0
 19397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19399     MOVE X'2020233030303137323733' TO DFHEIV0(25:11)
 19400     CALL 'kxdfhei1' USING DFHEIV0,
 19401           DFHEIV1,
 19402           DFHEIV20,
 19403           DFHEIV99,
 19404           ELCERT-KEY,
 19405           DFHEIV99,
 19406           DFHEIV99,
 19407           DFHEIV99
 19408     SET ADDRESS OF CERTIFICATE-MASTER TO
 19409         DFHEIV20
 19410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19411
 19412
 19413 7970-EXIT.
 19414      EXIT.
 19415 7975-read-acct.
 19416
 19417     move spaces              to WS-ACCT-RECORD-SW
 19418                                 pi-dcc-product-code
 19419
 19420     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19421     MOVE PI-CARRIER          TO ACCT-CARRIER
 19422     MOVE PI-GROUPING         TO ACCT-GROUPING
 19423     MOVE PI-STATE            TO ACCT-STATE
 19424     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19425     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19426     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19427     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19428
 19429
 19430* EXEC CICS READ
 19431*       DATASET ('ERACCT')
 19432*       RIDFLD  (ERACCT-KEY)
 19433*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19434*       GTEQ
 19435*       resp    (WS-RESPONSE)
 19436*    END-EXEC
 19437     MOVE 'ERACCT' TO DFHEIV1
 19438*    MOVE '&"S        G          (  N#00017295' TO DFHEIV0
 19439     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19441     MOVE X'204E233030303137323935' TO DFHEIV0(25:11)
 19442     CALL 'kxdfhei1' USING DFHEIV0,
 19443           DFHEIV1,
 19444           DFHEIV20,
 19445           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 373
* EL156.cbl
 19446           ERACCT-KEY,
 19447           DFHEIV99,
 19448           DFHEIV99,
 19449           DFHEIV99
 19450     SET ADDRESS OF ACCOUNT-MASTER TO
 19451         DFHEIV20
 19452     MOVE EIBRESP  TO WS-RESPONSE
 19453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19454     IF WS-RESP-NORMAL
 19455        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19456        and pi-cert-eff-dt < am-expiration-dt
 19457        and pi-cert-eff-dt >= am-effective-dt
 19458        move am-dcc-product-code to pi-dcc-product-code
 19459        set acct-found to true
 19460     end-if
 19461
 19462     .
 19463 7975-exit.
 19464     exit.
 19465 7980-READ-CERT-UPDATE.
 19466
 19467* EXEC CICS READ
 19468*        DATASET  ('ELCERT')
 19469*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19470*        RIDFLD   (ELCERT-KEY)
 19471*        UPDATE
 19472*    END-EXEC.
 19473     MOVE 'ELCERT' TO DFHEIV1
 19474*    MOVE '&"S        EU         (   #00017314' TO DFHEIV0
 19475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19476     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19477     MOVE X'2020233030303137333134' TO DFHEIV0(25:11)
 19478     CALL 'kxdfhei1' USING DFHEIV0,
 19479           DFHEIV1,
 19480           DFHEIV20,
 19481           DFHEIV99,
 19482           ELCERT-KEY,
 19483           DFHEIV99,
 19484           DFHEIV99,
 19485           DFHEIV99
 19486     SET ADDRESS OF CERTIFICATE-MASTER TO
 19487         DFHEIV20
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19489
 19490
 19491 7980-EXIT.
 19492      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 374
* EL156.cbl
 19494 8000-LOAD-ERROR-MESSAGES.
 19495     IF PI-PASS-SW = 'C'
 19496        MOVE EMI-LINE1           TO ERMSG1BO
 19497     ELSE
 19498        MOVE EMI-LINE1           TO ERRMSG1O
 19499        MOVE EMI-LINE2           TO ERRMSG2O.
 19500
 19501 8000-EXIT.
 19502     EXIT.
 19503
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 375
* EL156.cbl
 19505
 19506 8010-DMD-ERROR-CHECKS.
 19507     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19508
 19509     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19510         GO TO 8051-ISSUE-ERROR.
 19511
 19512     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19513     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19514     MOVE '3'                    TO DC-OPTION-CODE.
 19515     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19516     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19517         GO TO 8051-ISSUE-ERROR.
 19518
 19519     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19520       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19521                           OR
 19522          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19523           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19524             MOVE ER-0851         TO EMI-ERROR
 19525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19526       END-IF
 19527       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19528             MOVE ER-8147         TO EMI-ERROR
 19529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19530
 19531     GO TO 8090-EXIT.
 19532
 19533 8051-ISSUE-ERROR.
 19534     MOVE ER-8146            TO EMI-ERROR.
 19535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19536     GO TO 8090-EXIT.
 19537
 19538 8090-EXIT.
 19539      EXIT.
 19540
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 376
* EL156.cbl
 19542 8100-SEND-INITIAL-MAP.
 19543
 19544     MOVE SAVE-DATE              TO RUNDTEAO.
 19545     MOVE EIBTIME                TO TIME-IN.
 19546     MOVE TIME-OUT               TO RUNTIMAO.
 19547     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19548
 19549     IF MAP-NAME = 'EL156A'
 19550        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19551           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19552        END-IF
 19553     END-IF
 19554*    IF MAP-NAME = 'EL156A'
 19555*       IF PI-COMPANY-ID = 'CRI'
 19556*          NEXT SENTENCE
 19557*       ELSE
 19558*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19559
 19560     IF MAP-NAME = 'EL156A'
 19561        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19562           NEXT SENTENCE
 19563        ELSE
 19564           MOVE AL-SADOF TO  PINTA    PINTHA.
 19565
 19566     IF MAP-NAME = 'EL156A'
 19567        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19568            NEXT SENTENCE
 19569        ELSE
 19570           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19571
 19572*    IF MAP-NAME = 'EL156A'
 19573*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19574*          NEXT SENTENCE
 19575*       ELSE
 19576*          MOVE AL-SADOF TO CASHHA CASHA.
 19577
 19578     IF MAP-NAME = 'EL156A'
 19579        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19580           NEXT SENTENCE
 19581        ELSE
 19582           MOVE AL-SADOF        TO  LOANHA
 19583                                    LOANNOA.
 19584
 19585     IF MAP-NAME = 'EL156A'
 19586        MOVE -1                 TO  ENTERPFL
 19587        IF PI-USES-PAID-TO
 19588           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19589           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19590           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19591        ELSE
 19592           NEXT SENTENCE
 19593     ELSE
 19594        IF MAP-NAME = 'EL156B'
 19595           IF PI-USES-PAID-TO
 19596              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19597              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19598
 19599
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 377
* EL156.cbl
 19600* EXEC CICS SEND
 19601*        MAP   (MAP-NAME)
 19602*        MAPSET(MAPSET-NAME)
 19603*        FROM  (EL156AI)
 19604*        ERASE
 19605*        CURSOR
 19606*    END-EXEC.
 19607     MOVE LENGTH OF
 19608      EL156AI
 19609       TO DFHEIV12
 19610     MOVE -1
 19611       TO DFHEIV11
 19612*    MOVE '8$     CT  E    H L F ,   #00017429' TO DFHEIV0
 19613     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19614     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19615     MOVE X'2020233030303137343239' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0,
 19617           MAP-NAME,
 19618           EL156AI,
 19619           DFHEIV12,
 19620           MAPSET-NAME,
 19621           DFHEIV99,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV11,
 19625           DFHEIV99,
 19626           DFHEIV99,
 19627           DFHEIV99
 19628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19629
 19630
 19631     GO TO 9100-RETURN-TRAN.
 19632
 19633 8200-SEND-DATAONLY.
 19634
 19635     IF FIRST-ENTRY = 'Y'
 19636         GO TO 8100-SEND-INITIAL-MAP.
 19637
 19638     IF RETURNED-FROM-B = 'Y'
 19639         GO TO 8100-SEND-INITIAL-MAP.
 19640
 19641     MOVE SAVE-DATE              TO RUNDTEAO.
 19642     MOVE EIBTIME                TO TIME-IN.
 19643     MOVE TIME-OUT               TO RUNTIMAO.
 19644
 19645     IF EIBAID = DFHPF11
 19646        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19648        MOVE 'EL001   '          TO RETURNED-FROM
 19649        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19650        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19651        GO TO 8100-SEND-INITIAL-MAP.
 19652
 19653     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19654
 19655     IF MAP-NAME =  'EL156A'
 19656        MOVE -1                 TO  ENTERPFL
 19657        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 378
* EL156.cbl
 19658           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19659           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19660           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19661        ELSE
 19662           NEXT SENTENCE
 19663     ELSE
 19664        IF MAP-NAME = 'EL156B'
 19665           IF PI-USES-PAID-TO
 19666              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19667              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19668
 19669     IF MAP-NAME =  'EL156A'
 19670        IF PI-COMPANY-ID = 'BOA'
 19671            IF PI-INT-RATE NUMERIC
 19672                MOVE PI-INT-RATE TO PINTO.
 19673     IF MAP-NAME = 'EL156A'
 19674        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19675           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19676*          MOVE 'Y'              TO EOBYNO
 19677        END-IF
 19678     END-IF
 19679
 19680
 19681* EXEC CICS SEND
 19682*        MAP   (MAP-NAME)
 19683*        MAPSET(MAPSET-NAME)
 19684*        FROM  (EL156AI)
 19685*        DATAONLY
 19686*        CURSOR
 19687*    END-EXEC.
 19688     MOVE LENGTH OF
 19689      EL156AI
 19690       TO DFHEIV12
 19691     MOVE -1
 19692       TO DFHEIV11
 19693*    MOVE '8$D    CT       H L F ,   #00017486' TO DFHEIV0
 19694     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19695     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19696     MOVE X'2020233030303137343836' TO DFHEIV0(25:11)
 19697     CALL 'kxdfhei1' USING DFHEIV0,
 19698           MAP-NAME,
 19699           EL156AI,
 19700           DFHEIV12,
 19701           MAPSET-NAME,
 19702           DFHEIV99,
 19703           DFHEIV99,
 19704           DFHEIV99,
 19705           DFHEIV11,
 19706           DFHEIV99,
 19707           DFHEIV99,
 19708           DFHEIV99
 19709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19710
 19711
 19712     GO TO 9100-RETURN-TRAN.
 19713
 19714 8300-SEND-TEXT.
 19715
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 379
* EL156.cbl
 19716* EXEC CICS SEND TEXT
 19717*        FROM(LOGOFF-TEXT)
 19718*        LENGTH(LOGOFF-LENGTH)
 19719*        ERASE
 19720*        FREEKB
 19721*    END-EXEC.
 19722*    MOVE '8&      T  E F  H   F -   #00017497' TO DFHEIV0
 19723     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19724     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19725     MOVE X'2020233030303137343937' TO DFHEIV0(25:11)
 19726     CALL 'kxdfhei1' USING DFHEIV0,
 19727           LOGOFF-TEXT,
 19728           LOGOFF-LENGTH,
 19729           DFHEIV99,
 19730           DFHEIV99,
 19731           DFHEIV99,
 19732           DFHEIV99,
 19733           DFHEIV99,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99,
 19737           DFHEIV99,
 19738           DFHEIV99
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742
 19743* EXEC CICS RETURN
 19744*    END-EXEC.
 19745*    MOVE '.(                    ''   #00017504' TO DFHEIV0
 19746     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19747     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19748     MOVE X'2020233030303137353034' TO DFHEIV0(25:11)
 19749     CALL 'kxdfhei1' USING DFHEIV0,
 19750           DFHEIV99,
 19751           DFHEIV99,
 19752           DFHEIV99,
 19753           DFHEIV99,
 19754           DFHEIV99,
 19755           DFHEIV99
 19756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19757
 19758
 19759 8500-FILE-NOTOPEN.
 19760     IF FILE-SWITCH = 'MSTR'
 19761         MOVE ER-0154            TO EMI-ERROR.
 19762     IF FILE-SWITCH = 'TRLR'
 19763         MOVE ER-0172            TO EMI-ERROR.
 19764     IF FILE-SWITCH = 'CERT'
 19765         MOVE ER-0169            TO EMI-ERROR.
 19766     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19767                      'PROC' OR 'STAT'
 19768         MOVE ER-0042            TO EMI-ERROR.
 19769     IF FILE-SWITCH = 'ACTQ'
 19770         MOVE ER-0338            TO EMI-ERROR.
 19771     IF FILE-SWITCH = 'ACCT'
 19772         MOVE ER-0168            TO EMI-ERROR.
 19773
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 380
* EL156.cbl
 19774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19775     MOVE -1                     TO PMTTYPEL.
 19776
 19777     IF FIRST-ENTRY = 'Y'
 19778         GO TO 8100-SEND-INITIAL-MAP.
 19779
 19780     GO TO 8200-SEND-DATAONLY.
 19781
 19782 8600-PGRM-NOT-FOUND.
 19783
 19784     MOVE ER-0923                TO EMI-ERROR.
 19785     MOVE -1                     TO ENTPFBL.
 19786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19787
 19788     IF FIRST-ENTRY = 'Y'
 19789         GO TO 8100-SEND-INITIAL-MAP
 19790     ELSE
 19791         GO TO 8200-SEND-DATAONLY.
 19792
 19793 8800-UNAUTHORIZED-ACCESS.
 19794     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19795     GO TO 8300-SEND-TEXT.
 19796
 19797 8810-PF23.
 19798     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19799     MOVE XCTL-005               TO PGM-NAME.
 19800     GO TO 9300-XCTL.
 19801
 19802 8820-PF7-8.
 19803     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19804     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19805                                    PI-SAVED-PROGRAM-2
 19806                                    PI-SAVED-PROGRAM-3
 19807                                    PI-SAVED-PROGRAM-4
 19808                                    PI-SAVED-PROGRAM-5
 19809                                    PI-SAVED-PROGRAM-6
 19810                                    PI-RETURN-TO-PROGRAM.
 19811     IF EIBAID = DFHPF8
 19812        MOVE XCTL-132            TO PGM-NAME
 19813     ELSE
 19814        MOVE XCTL-130            TO PGM-NAME.
 19815
 19816     GO TO 9300-XCTL.
 19817
 19818 9100-RETURN-TRAN.
 19819     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19820     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19821
 19822
 19823* EXEC CICS RETURN
 19824*        TRANSID(TRANS-ID)
 19825*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19826*        LENGTH(PI-COMM-LENGTH)
 19827*    END-EXEC.
 19828*    MOVE '.(CT                  ''   #00017570' TO DFHEIV0
 19829     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19831     MOVE X'2020233030303137353730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 381
* EL156.cbl
 19832     CALL 'kxdfhei1' USING DFHEIV0,
 19833           TRANS-ID,
 19834           PROGRAM-INTERFACE-BLOCK,
 19835           PI-COMM-LENGTH,
 19836           DFHEIV99,
 19837           DFHEIV99,
 19838           DFHEIV99
 19839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19840
 19841
 19842 9200-RETURN-MAIN-MENU.
 19843     MOVE XCTL-126               TO PGM-NAME.
 19844     GO TO 9300-XCTL.
 19845
 19846 9300-XCTL.
 19847
 19848* EXEC CICS XCTL
 19849*        PROGRAM(PGM-NAME)
 19850*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19851*        LENGTH(PI-COMM-LENGTH)
 19852*    END-EXEC.
 19853*    MOVE '.$C                   %   #00017581' TO DFHEIV0
 19854     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19855     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19856     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19857     CALL 'kxdfhei1' USING DFHEIV0,
 19858           PGM-NAME,
 19859           PROGRAM-INTERFACE-BLOCK,
 19860           PI-COMM-LENGTH,
 19861           DFHEIV99
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864
 19865 9400-CLEAR.
 19866     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19867     GO TO 9300-XCTL.
 19868
 19869 9500-PF12.
 19870     MOVE XCTL-010               TO PGM-NAME.
 19871     GO TO 9300-XCTL.
 19872
 19873 9700-LINK-DATE-CONVERT.
 19874     MOVE LINK-ELDATCV           TO PGM-NAME.
 19875
 19876* EXEC CICS LINK
 19877*        PROGRAM   (PGM-NAME)
 19878*        COMMAREA  (DATE-CONVERSION-DATA)
 19879*        LENGTH    (DC-COMM-LENGTH)
 19880*    END-EXEC.
 19881*    MOVE '."C                   (   #00017597' TO DFHEIV0
 19882     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19884     MOVE X'2020233030303137353937' TO DFHEIV0(25:11)
 19885     CALL 'kxdfhei1' USING DFHEIV0,
 19886           PGM-NAME,
 19887           DATE-CONVERSION-DATA,
 19888           DC-COMM-LENGTH,
 19889           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 382
* EL156.cbl
 19890           DFHEIV99,
 19891           DFHEIV99,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896 9700-EXIT.
 19897     EXIT.
 19898
 19899 9800-LINK-REM-TERM.
 19900     MOVE LINK-REMTERM TO PGM-NAME.
 19901
 19902
 19903* EXEC CICS LINK
 19904*        PROGRAM   (PGM-NAME)
 19905*        COMMAREA  (CALCULATION-PASS-AREA)
 19906*        LENGTH    (CP-COMM-LENGTH)
 19907*    END-EXEC.
 19908*    MOVE '."C                   (   #00017609' TO DFHEIV0
 19909     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19911     MOVE X'2020233030303137363039' TO DFHEIV0(25:11)
 19912     CALL 'kxdfhei1' USING DFHEIV0,
 19913           PGM-NAME,
 19914           CALCULATION-PASS-AREA,
 19915           CP-COMM-LENGTH,
 19916           DFHEIV99,
 19917           DFHEIV99,
 19918           DFHEIV99,
 19919           DFHEIV99
 19920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19921
 19922
 19923 9800-EXIT.
 19924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 383
* EL156.cbl
 19926 9830-DMD-REMAINING-TERM.
 19927
 19928     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19929         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19930
 19931     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19932                              CM-PMT-EXTENSION-DAYS.
 19933
 19934     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19935                                  CL-NO-OF-DAYS-PAID.
 19936
 19937     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19938         GIVING W-REM REMAINDER W-REM-DAYS.
 19939
 19940     MOVE W-REM                  TO WST-REM.
 19941
 19942     IF W-REM-DAYS > ZEROS
 19943         MOVE '/'                TO WST-SLASH
 19944         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19945     ELSE
 19946         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19947
 19948 9830-EXIT.
 19949     EXIT.
 19950
 19951 9870-OUTPUT-ACTIVITY-RECORD.
 19952
 19953
 19954* EXEC CICS GETMAIN
 19955*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19956*         LENGTH(25)
 19957*         INITIMG(WS-BLANK)
 19958*    END-EXEC.
 19959     MOVE 25
 19960       TO DFHEIV11
 19961*    MOVE ',"IL                  $   #00017645' TO DFHEIV0
 19962     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19963     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19964     MOVE X'2020233030303137363435' TO DFHEIV0(25:11)
 19965     CALL 'kxdfhei1' USING DFHEIV0,
 19966           DFHEIV20,
 19967           DFHEIV11,
 19968           WS-BLANK
 19969     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19970         DFHEIV20
 19971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19972
 19973
 19974     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19975     MOVE ELMSTR-KEY             TO DA-KEY.
 19976     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19977
 19978     IF PI-PMTTYPE EQUAL '7'
 19979         MOVE 'V'                TO DA-RECORD-TYPE
 19980     ELSE
 19981         MOVE 'P'                TO DA-RECORD-TYPE.
 19982
 19983
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 384
* EL156.cbl
 19984* EXEC CICS HANDLE CONDITION
 19985*         NOTOPEN(9870-NOTOPEN)
 19986*         DUPREC(9870-EXIT)
 19987*    END-EXEC.
 19988*    MOVE '"$J%                  ! B #00017660' TO DFHEIV0
 19989     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19991     MOVE X'4220233030303137363630' TO DFHEIV0(25:11)
 19992     CALL 'kxdfhei1' USING DFHEIV0
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19994
 19995
 19996
 19997* EXEC CICS WRITE
 19998*         DATASET('DLYACTV')
 19999*         RIDFLD(DA-KEY)
 20000*         FROM(DAILY-ACTIVITY-RECORD)
 20001*         LENGTH(25)
 20002*    END-EXEC.
 20003     MOVE 'DLYACTV' TO DFHEIV1
 20004     MOVE 25
 20005       TO DFHEIV11
 20006*    MOVE '&$ L                  ''   #00017665' TO DFHEIV0
 20007     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20009     MOVE X'2020233030303137363635' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0,
 20011           DFHEIV1,
 20012           DAILY-ACTIVITY-RECORD,
 20013           DFHEIV11,
 20014           DA-KEY,
 20015           DFHEIV99,
 20016           DFHEIV99
 20017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20018
 20019     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20020     GO TO 9870-EXIT.
 20021
 20022 9870-NOTOPEN.
 20023
 20024     MOVE '2955'                 TO EMI-ERROR.
 20025     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20026
 20027 9870-EXIT.
 20028     EXIT.
 20029
 20030 9900-ERROR-FORMAT.
 20031
 20032     IF EMI-ERROR = ER-0923
 20033         MOVE PGM-NAME           TO W-CALLED-NAME.
 20034
 20035     MOVE LINK-001      TO PGM-NAME.
 20036     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20037
 20038
 20039* EXEC CICS LINK
 20040*        PROGRAM (PGM-NAME)
 20041*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 385
* EL156.cbl
 20042*        LENGTH  (EMI-COMM-LENGTH)
 20043*    END-EXEC.
 20044*    MOVE '."C                   (   #00017690' TO DFHEIV0
 20045     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20047     MOVE X'2020233030303137363930' TO DFHEIV0(25:11)
 20048     CALL 'kxdfhei1' USING DFHEIV0,
 20049           PGM-NAME,
 20050           ERROR-MESSAGE-INTERFACE-BLOCK,
 20051           EMI-COMM-LENGTH,
 20052           DFHEIV99,
 20053           DFHEIV99,
 20054           DFHEIV99,
 20055           DFHEIV99
 20056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20057
 20058
 20059     IF EMI-ERROR = ER-0923
 20060         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20061
 20062 9900-EXIT.
 20063     EXIT.
 20064
 20065 9990-ABEND.
 20066     MOVE LINK-004               TO PGM-NAME.
 20067     MOVE DFHEIBLK               TO EMI-LINE1.
 20068
 20069* EXEC CICS LINK
 20070*        PROGRAM   (PGM-NAME)
 20071*        COMMAREA  (EMI-LINE1)
 20072*        LENGTH    (64)
 20073*    END-EXEC.
 20074     MOVE 64
 20075       TO DFHEIV11
 20076*    MOVE '."C                   (   #00017705' TO DFHEIV0
 20077     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20079     MOVE X'2020233030303137373035' TO DFHEIV0(25:11)
 20080     CALL 'kxdfhei1' USING DFHEIV0,
 20081           PGM-NAME,
 20082           EMI-LINE1,
 20083           DFHEIV11,
 20084           DFHEIV99,
 20085           DFHEIV99,
 20086           DFHEIV99,
 20087           DFHEIV99
 20088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20089
 20090
 20091     MOVE 'EL156A'               TO  MAP-NAME.
 20092     MOVE LOW-VALUES             TO  EL156AO.
 20093     GO TO 8100-SEND-INITIAL-MAP.
 20094
 20095 9995-SECURITY-VIOLATION.
 20096*    COPY ELCSCTP.
 20097******************************************************************
 20098*                                                                *
 20099*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 386
* EL156.cbl
 20100*                            VMOD=2.001                          *
 20101*                                                                *
 20102*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20103******************************************************************
 20104
 20105
 20106     MOVE EIBDATE          TO SM-JUL-DATE.
 20107     MOVE EIBTRMID         TO SM-TERMID.
 20108     MOVE THIS-PGM         TO SM-PGM.
 20109     MOVE EIBTIME          TO TIME-IN.
 20110     MOVE TIME-OUT         TO SM-TIME.
 20111     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20112
 20113
 20114* EXEC CICS LINK
 20115*         PROGRAM  ('EL003')
 20116*         COMMAREA (SECURITY-MESSAGE)
 20117*         LENGTH   (80)
 20118*    END-EXEC.
 20119     MOVE 'EL003' TO DFHEIV1
 20120     MOVE 80
 20121       TO DFHEIV11
 20122*    MOVE '."C                   (   #00017733' TO DFHEIV0
 20123     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20125     MOVE X'2020233030303137373333' TO DFHEIV0(25:11)
 20126     CALL 'kxdfhei1' USING DFHEIV0,
 20127           DFHEIV1,
 20128           SECURITY-MESSAGE,
 20129           DFHEIV11,
 20130           DFHEIV99,
 20131           DFHEIV99,
 20132           DFHEIV99,
 20133           DFHEIV99
 20134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20135
 20136
 20137******************************************************************
 20138
 20139
 20140
 20141 9999-DFHBACK SECTION.
 20142     MOVE '9%                    "   ' TO DFHEIV0
 20143     MOVE 'EL156' TO DFHEIV1
 20144     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20145     GOBACK.
 20146 9999-DFHEXIT.
 20147     IF DFHEIGDJ EQUAL 0001
 20148         NEXT SENTENCE
 20149     ELSE IF DFHEIGDJ EQUAL 2
 20150         GO TO 9990-ABEND,
 20151               8600-PGRM-NOT-FOUND,
 20152               0400-FIRST-TIME,
 20153               6180-DUPREC,
 20154               9990-ABEND
 20155         DEPENDING ON DFHEIGDI
 20156     ELSE IF DFHEIGDJ EQUAL 3
 20157         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 387
* EL156.cbl
 20158               0380-CLAIM-END-FILE
 20159         DEPENDING ON DFHEIGDI
 20160     ELSE IF DFHEIGDJ EQUAL 4
 20161         GO TO 0380-CLAIM-END-FILE,
 20162               0380-CLAIM-END-FILE
 20163         DEPENDING ON DFHEIGDI
 20164     ELSE IF DFHEIGDJ EQUAL 5
 20165         GO TO 0800-EXIT
 20166         DEPENDING ON DFHEIGDI
 20167     ELSE IF DFHEIGDJ EQUAL 6
 20168         GO TO 1950-NOT-FOUND,
 20169               1950-NOT-FOUND
 20170         DEPENDING ON DFHEIGDI
 20171     ELSE IF DFHEIGDJ EQUAL 7
 20172         GO TO 1950-NOT-FOUND
 20173         DEPENDING ON DFHEIGDI
 20174     ELSE IF DFHEIGDJ EQUAL 8
 20175         GO TO 1950-NOT-FOUND,
 20176               1950-NOT-FOUND
 20177         DEPENDING ON DFHEIGDI
 20178     ELSE IF DFHEIGDJ EQUAL 9
 20179         GO TO 1166-END-CHECK,
 20180               1166-END-CHECK
 20181         DEPENDING ON DFHEIGDI
 20182     ELSE IF DFHEIGDJ EQUAL 10
 20183         GO TO 1950-NOT-FOUND,
 20184               1950-NOT-FOUND
 20185         DEPENDING ON DFHEIGDI
 20186     ELSE IF DFHEIGDJ EQUAL 11
 20187         GO TO 1950-NOT-FOUND,
 20188               1950-NOT-FOUND
 20189         DEPENDING ON DFHEIGDI
 20190     ELSE IF DFHEIGDJ EQUAL 12
 20191         GO TO 1950-NOT-FOUND
 20192         DEPENDING ON DFHEIGDI
 20193     ELSE IF DFHEIGDJ EQUAL 13
 20194         GO TO 3600-CONTINUE
 20195         DEPENDING ON DFHEIGDI
 20196     ELSE IF DFHEIGDJ EQUAL 14
 20197         GO TO 5300-NOTE-NOT-FOUND
 20198         DEPENDING ON DFHEIGDI
 20199     ELSE IF DFHEIGDJ EQUAL 15
 20200         GO TO 6065-NOT-FOUND
 20201         DEPENDING ON DFHEIGDI
 20202     ELSE IF DFHEIGDJ EQUAL 16
 20203         GO TO 6068-ACCT-NOT-FND
 20204         DEPENDING ON DFHEIGDI
 20205     ELSE IF DFHEIGDJ EQUAL 17
 20206         GO TO 6074-GET-COMP-DATA
 20207         DEPENDING ON DFHEIGDI
 20208     ELSE IF DFHEIGDJ EQUAL 18
 20209         GO TO 6170-WRITE
 20210         DEPENDING ON DFHEIGDI
 20211     ELSE IF DFHEIGDJ EQUAL 19
 20212         GO TO 6180-DUPREC
 20213         DEPENDING ON DFHEIGDI
 20214     ELSE IF DFHEIGDJ EQUAL 20
 20215         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 388
* EL156.cbl
 20216         DEPENDING ON DFHEIGDI
 20217     ELSE IF DFHEIGDJ EQUAL 21
 20218         GO TO 6185-DUPREC
 20219         DEPENDING ON DFHEIGDI
 20220     ELSE IF DFHEIGDJ EQUAL 22
 20221         GO TO 6720-BUILD-NEW-RECORD
 20222         DEPENDING ON DFHEIGDI
 20223     ELSE IF DFHEIGDJ EQUAL 23
 20224         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20225               6900-BUILD-ARCHIVE-HEADER
 20226         DEPENDING ON DFHEIGDI
 20227     ELSE IF DFHEIGDJ EQUAL 24
 20228         GO TO 7010-BUILD-MAP
 20229         DEPENDING ON DFHEIGDI
 20230     ELSE IF DFHEIGDJ EQUAL 25
 20231         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20232         DEPENDING ON DFHEIGDI
 20233     ELSE IF DFHEIGDJ EQUAL 26
 20234         GO TO 7160-DUPREC
 20235         DEPENDING ON DFHEIGDI
 20236     ELSE IF DFHEIGDJ EQUAL 27
 20237         GO TO 7200-EXIT,
 20238               7200-EXIT
 20239         DEPENDING ON DFHEIGDI
 20240     ELSE IF DFHEIGDJ EQUAL 28
 20241         GO TO 7400-NOT-FOUND
 20242         DEPENDING ON DFHEIGDI
 20243     ELSE IF DFHEIGDJ EQUAL 29
 20244         GO TO 7590-END,
 20245               7590-END
 20246         DEPENDING ON DFHEIGDI
 20247     ELSE IF DFHEIGDJ EQUAL 30
 20248         GO TO 7699-EXIT
 20249         DEPENDING ON DFHEIGDI
 20250     ELSE IF DFHEIGDJ EQUAL 31
 20251         GO TO 5300-NOTE-NOT-FOUND
 20252         DEPENDING ON DFHEIGDI
 20253     ELSE IF DFHEIGDJ EQUAL 32
 20254         GO TO 7800-COMP-NOTFND
 20255         DEPENDING ON DFHEIGDI
 20256     ELSE IF DFHEIGDJ EQUAL 33
 20257         GO TO 7920-NOT-FOUND
 20258         DEPENDING ON DFHEIGDI
 20259     ELSE IF DFHEIGDJ EQUAL 34
 20260         GO TO 9870-NOTOPEN,
 20261               9870-EXIT
 20262         DEPENDING ON DFHEIGDI.
 20263     MOVE '9%                    "   ' TO DFHEIV0
 20264     MOVE 'EL156' TO DFHEIV1
 20265     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20266     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12180     Code:       75003
