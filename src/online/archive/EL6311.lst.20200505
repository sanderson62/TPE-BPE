* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88******************************************************************
    89
    90 ENVIRONMENT DIVISION.
    91
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   4
* EL6311.cbl
    93 DATA DIVISION.
    94 WORKING-STORAGE SECTION.
    95 01  DFH-START PIC X(04).
    96 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    97 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    98 77  FILLER  PIC X(32)  VALUE '********************************'.
    99 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   100 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   101 77  A1                          PIC S999 COMP-3 VALUE +0.
   102 77  N1                          PIC S999 COMP-3 VALUE +0.
   103 77  N2                          PIC S999 COMP-3 VALUE +0.
   104 77  N3                          PIC S999 COMP-3 VALUE +0.
   105 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   106 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   107 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   108     88  REVERSAL                    VALUE 'Y'.
   109 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   110 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   111 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   112 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   113 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   114     88  ERMAIL-FOUND                 VALUE 'Y'.
   115 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   116 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   117 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   118 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   119     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   120 77  ws-stop-sw                  pic x value ' '.
   121     88  i-say-stop                 value 'Y'.
   122 77  ws-check-sw                 pic x value ' '.
   123     88  i-have-checks              value 'Y'.
   124 77  ws-proc-check-sw            pic x value ' '.
   125     88  i-have-processed-checks    value 'Y'.
   126 77  ws-any-check-sw             pic x value ' '.
   127     88  i-have-a-check-period      value 'Y'.
   128 77  ws-chek-browse-sw           pic x value ' '.
   129 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   130 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   131 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   132 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   133 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   134 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   135 77  ws-elcrtt-update-sw         pic x value ' '.
   136     88  update-elcrtt              value 'Y'.
   137 01  P pointer.
   138 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   139 01  var-ptr pointer.
   140 01  env-var-len                 pic 9(4)  binary.
   141 01  rc                          pic 9(9)  binary.
   142 01  WS-KIXSYS.
   143     05  WS-KIX-FIL1             PIC X(10).
   144     05  WS-KIX-APPS             PIC X(10).
   145     05  WS-KIX-ENV              PIC X(10).
   146     05  WS-KIX-MYENV            PIC X(10).
   147     05  WS-KIX-SYS              PIC X(10).
   148*    COPY ELCSCTM.
   149******************************************************************
   150*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   5
* EL6311.cbl
   151*                                                                *
   152*                            ELCSCTM                             *
   153*                            VMOD=2.001                          *
   154*                                                                *
   155*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   156*                                                                *
   157******************************************************************
   158 01  SECURITY-MESSAGE.
   159     12  FILLER                          PIC X(30)
   160            VALUE '** LOGIC SECURITY VIOLATION -'.
   161     12  SM-READ                         PIC X(6).
   162     12  FILLER                          PIC X(5)
   163            VALUE ' PGM='.
   164     12  SM-PGM                          PIC X(6).
   165     12  FILLER                          PIC X(5)
   166            VALUE ' OPR='.
   167     12  SM-PROCESSOR-ID                 PIC X(4).
   168     12  FILLER                          PIC X(6)
   169            VALUE ' TERM='.
   170     12  SM-TERMID                       PIC X(4).
   171     12  FILLER                          PIC XX   VALUE SPACE.
   172     12  SM-JUL-DATE                     PIC 9(5).
   173     12  FILLER                          PIC X    VALUE SPACE.
   174     12  SM-TIME                         PIC 99.99.
   175
   176
   177*    COPY ELCSCRTY.
   178******************************************************************
   179*                                                                *
   180*                                                                *
   181*                            ELCSCRTY                            *
   182*                            VMOD=2.001                          *
   183*                                                                *
   184*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   185*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   186*        SAVED IN PI-SECURITY-ADDRESS.                           *
   187*                                                                *
   188******************************************************************
   189 01  SECURITY-CONTROL.
   190     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   191     12  FILLER                       PIC XX    VALUE 'SC'.
   192     12  SC-CREDIT-CODES.
   193         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   194             20  SC-CREDIT-DISPLAY    PIC X.
   195             20  SC-CREDIT-UPDATE     PIC X.
   196     12  SC-CLAIMS-CODES.
   197         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   198             20  SC-CLAIMS-DISPLAY    PIC X.
   199             20  SC-CLAIMS-UPDATE     PIC X.
   200
   201 01  WS-VA-NO-COMM-MESS.
   202     12  FILLER                  PIC X(41) VALUE
   203        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   204 01  WS-OC-MESSAGE.
   205     12  FILLER                  PIC X(43) VALUE
   206        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   207     12  WS-OC-DIS-AMT           PIC -----9.99.
   208     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   6
* EL6311.cbl
   209     12  WS-OC-DATE              PIC X(10).
   210 01  WS-DATE-AREA.
   211     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   212     12  WS-CURRENT-DT.
   213         16  FILLER              PIC X(6)    VALUE SPACES.
   214         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   215     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   216     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   217     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   218
   219 01  STANDARD-AREAS.
   220     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   221     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   222     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   223     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   224     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   225     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   226     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   227     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   228     12  PGM-NAME                PIC X(8).
   229     12  TIME-IN                 PIC S9(7).
   230     12  TIME-OUT-R  REDEFINES TIME-IN.
   231         16  FILLER              PIC X.
   232         16  TIME-OUT            PIC 99V99.
   233         16  FILLER              PIC XX.
   234     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   235     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   236     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   237     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   238     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   239     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   240     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   241     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   242     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   243     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   244     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   245     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   246     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   247     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   248     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   249     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   250     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   251     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   252     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   253     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   254     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   255     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   256     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   257     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   258     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   259     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   260     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   261     12  FILE-ID                 PIC X(8).
   262     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   263     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   264     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   265     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   266     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   7
* EL6311.cbl
   267     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   268     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   269     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   270     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   271     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   272     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   273     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   274     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   275     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   276     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   277
   278 01  WS-PASS-AREA.
   279     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   280     05  WS-PASS-VADS-REC    PIC X(350).
   281*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   282*                                COPY ELCZREC.
   283******************************************************************
   284*                                                                *
   285*                                                                *
   286*                            ELCZREC.                            *
   287*                                                                *
   288*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   289*                                                                *
   290******************************************************************
   291*-----------------------------------------------------------------
   292*                   C H A N G E   L O G
   293*
   294* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   295*-----------------------------------------------------------------
   296*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   297* EFFECTIVE    NUMBER
   298*-----------------------------------------------------------------
   299* 122011    2011022800001  AJRA  NEW FILE
   300* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   301* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   302* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   303* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   304*-----------------------------------------------------------------
   305 01  W-Z-CONTROL-DATA.
   306     05  W-NUMBER-OF-COPIES      PIC  9.
   307     05  FILLER                  PIC  X.
   308     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   309     05  FILLER                  PIC  X.
   310     05  W-DAYS-TO-RESEND        PIC  999.
   311     05  FILLER                  PIC  X.
   312     05  W-FORM-TO-RESEND        PIC  X(4).
   313     05  W-ADD-BAR-CODE          PIC  X.
   314     05  W-PROMPT-LETTER         PIC  X.
   315     05  W-HAS-RETURN-ENV        PIC  X.
   316     05  W-ENCLOSURE-CD          PIC  XXX.
   317     05  W-SIG-FLAG-DEFAULT      PIC  X.
   318     05  W-AUTO-CLOSE-IND        PIC  X.
   319     05  FILLER                  PIC  X.
   320     05  W-LETTER-TO-BENE        PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-LETTER-TO-ACCT        PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   8
* EL6311.cbl
   325     05  FILLER                  PIC  X.
   326     05  W-PRINT-CERTIFICATE     PIC  X.
   327     05  FILLER                  PIC  X.
   328     05  W-REFUND-REQUIRED       PIC  X.
   329     05  FILLER                  PIC  X.
   330     05  W-ONBASE-CODE           PIC  XX.
   331     05  FILLER                  PIC  X.
   332     05  W-ACCT-SUMM             PIC  X.
   333     05  FILLER                  PIC  X.
   334     05  W-CSO-SUMM              PIC  X.
   335     05  FILLER                  PIC  X.
   336     05  W-REASONS-REQUIRED      PIC  X.
   337     05  FILLER                  PIC  X(29).
   338******************************************************************
   339*                                                                *
   340*              A C C E S S   K E Y S                             *
   341*                                                                *
   342******************************************************************
   343
   344 01  ACCESS-KEYS.
   345     12  ERPYAJ-KEY.
   346         16  ERPYAJ-COMPANY-CD       PIC X.
   347         16  ERPYAJ-CARRIER          PIC X.
   348         16  ERPYAJ-GROUPING         PIC X(6).
   349         16  ERPYAJ-FIN-RESP         PIC X(10).
   350         16  ERPYAJ-ACCOUNT          PIC X(10).
   351         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   352         16  ERPYAJ-TYPE             PIC X.
   353     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   354     12  ELCERT-KEY.
   355         16  ELCERT-COMPANY-CD       PIC X.
   356         16  ELCERT-CARRIER          PIC X.
   357         16  ELCERT-GROUPING         PIC X(6).
   358         16  ELCERT-STATE            PIC XX.
   359         16  ELCERT-ACCOUNT          PIC X(10).
   360         16  ELCERT-CERT-EFF-DT      PIC XX.
   361         16  ELCERT-CERT-NO.
   362             20  ELCERT-CERT-PRIME   PIC X(10).
   363             20  ELCERT-CERT-SFX     PIC X.
   364
   365     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   366     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   367     12  ELCRTO-KEY.
   368         16  ELCRTO-COMPANY-CD       PIC X.
   369         16  ELCRTO-CARRIER          PIC X.
   370         16  ELCRTO-GROUPING         PIC X(6).
   371         16  ELCRTO-STATE            PIC XX.
   372         16  ELCRTO-ACCOUNT          PIC X(10).
   373         16  ELCRTO-CERT-EFF-DT      PIC XX.
   374         16  ELCRTO-CERT-NO.
   375             20  ELCRTO-CERT-PRIME   PIC X(10).
   376             20  ELCRTO-CERT-SFX     PIC X.
   377         16  ELCRTO-RECORD-TYPE      PIC X.
   378         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   379
   380     12  ELCRTT-KEY.
   381         16  ELCRTT-PRIMARY          PIC X(33).
   382         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   9
* EL6311.cbl
   383     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   384     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   385
   386     12  ERPNDB-KEY.
   387         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   388         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   389         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   390         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   391             ERPNDB-BATCH-SEQ-NO     PIC XX.
   392         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   393
   394     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   395     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   396     12  ERCHEK-KEY.
   397         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   398         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   399         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   400         16  CHEK-STATE              PIC XX      VALUE SPACES.
   401         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   402         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   403         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   404         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   405         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   406     12  ELLETR-KEY.
   407         16  LETR-COMPANY-CD     PIC X.
   408         16  LETR-LETTER-ID      PIC X(4).
   409         16  LETR-FILLER         PIC X(8).
   410         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   411     12  ERPNDM-KEY.
   412         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   413         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   414         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   415         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   416
   417*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   418     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   419*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   420     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   421
   422     12  ERPNDB-ALT-KEY.
   423         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   424         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   425         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   426         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   427         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   428         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   429         16  ERPNDB-CERT-NO.
   430             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   431             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   432         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   433         16  ERPNDB-RECORD-TYPE      PIC X.
   434
   435      12  ERPNDB-CSR-KEY.
   436          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   437          20  ERPNDB-CSR-ID                PIC X(4).
   438          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   439          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   440          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  10
* EL6311.cbl
   441
   442     12  ERNOTE-KEY.
   443         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   444         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   445         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   446         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   447         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   448         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   449         16  ERNOTE-CERT-NO.
   450             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   451             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   452
   453     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   454     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   455
   456     12  ERCNOT-KEY.
   457         16  ERCNOT-PART-KEY.
   458             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   459             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   460             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   461             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   462             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   463             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   464             20  ERCNOT-CERT-NO.
   465                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   466                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   467         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   468         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   469
   470     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   471     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   472
   473     12  ERMAIL-KEY.
   474         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   475         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   476         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   477         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   478         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   479         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   480         16  ERMAIL-CERT-NO.
   481             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   482             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   483
   484     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   485     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   486
   487     12  ERRQST-KEY.
   488         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   489         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   490
   491     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   492     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   493
   494     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   495
   496     12  ERLOFC-KEY.
   497         16  ERLOFC-COMPANY-CD          PIC  X.
   498         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  11
* EL6311.cbl
   499         16  ERLOFC-GROUPING            PIC  X(6).
   500         16  ERLOFC-STATE               PIC  XX.
   501         16  ERLOFC-ACCOUNT             PIC  X(10).
   502         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   503*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   504
   505     12  ERACCT-KEY.
   506         16  ERACCT-COMPANY-CD          PIC  X.
   507         16  ERACCT-CARRIER             PIC  X.
   508         16  ERACCT-GROUPING            PIC  X(6).
   509         16  ERACCT-STATE               PIC  XX.
   510         16  ERACCT-ACCOUNT             PIC  X(10).
   511         16  ERACCT-EXP-DT.
   512             20  ERACCT-DT              PIC  XX.
   513             20  ERACCT-FILL            PIC  X(4).
   514     12  ERACNT-KEY.
   515         16  ERACNT-COMPANY-CD          PIC  X.
   516         16  ERACNT-CARRIER             PIC  X.
   517         16  ERACNT-GROUPING            PIC  X(6).
   518         16  ERACNT-STATE               PIC  XX.
   519         16  ERACNT-ACCOUNT             PIC  X(10).
   520         16  ERACNT-REC-TYPE            PIC  X.
   521         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   522     12  ERENDT-KEY.
   523         16  ENDT-COMPANY-CD       PIC X.
   524         16  ENDT-CARRIER          PIC X.
   525         16  ENDT-GROUPING         PIC X(6).
   526         16  ENDT-STATE            PIC XX.
   527         16  ENDT-ACCOUNT          PIC X(10).
   528         16  ENDT-CERT-EFF-DT      PIC XX.
   529         16  ENDT-CERT-PRIME       PIC X(10).
   530         16  ENDT-CERT-SFX         PIC X.
   531         16  ENDT-RECORD-TYPE      PIC X.
   532         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   533
   534 01  WS-ELMSTR-WORK.
   535     12  ELMSTR-KEY.
   536         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   537         16  MSTR-CERT-NO.
   538             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   539             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   540     12  W-CLAIM-KEY.
   541         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   542         16  W-CL-CERT-NO.
   543             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   544             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   545      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   546 01  CANCEL-GEN-PASS-AREA.
   547     05  CG-OPTION-CODE          PIC X.
   548         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   549         88  CG-FLAT-CANCEL        VALUE '1'.
   550         88  CG-CANCEL             VALUE '2'.
   551         88  CG-CANCEL-REISSUE     VALUE '3'.
   552     05  CG-ERROR-CODE           PIC 99.
   553         88  CG-SUCCESS            VALUE 00.
   554         88  CG-DATE-ERROR         VALUE 01.
   555         88  CG-CERT-NOT-FOUND     VALUE 02.
   556         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  12
* EL6311.cbl
   557         88  CG-OPTION-ERROR       VALUE 05.
   558         88  CG-PREV-CAN           VALUE 06.
   559         88  CG-INVALID-DATA       VALUE 07.
   560         88  CG-NO-ACCT-MSTR       VALUE 08.
   561         88  CG-SFX-A-EXIST        VALUE 09.
   562         88  CG-MISC-ERROR         VALUE 99.
   563     05  CG-COMPANY-ID           PIC XXX.
   564     05  CG-PROC-ID              PIC XXXX.
   565     05  CG-CURRENT-DT           PIC XX.
   566     05  CG-MONTH-END-DT         PIC XX.
   567     05  CG-CERT-KEY.
   568         10  CG-CERT-COMPANY-CD  PIC X.
   569         10  CG-CERT-CARRIER     PIC X.
   570         10  CG-CERT-GROUP       PIC X(6).
   571         10  CG-CERT-STATE       PIC XX.
   572         10  CG-CERT-ACCOUNT     PIC X(10).
   573         10  CG-CERT-EFF-DT      PIC XX.
   574         10  CG-CERT-CERT-NO     PIC X(11).
   575     05  CG-LF-CAN-DATA.
   576         10  CG-LF-CAN-DT        PIC XX.
   577         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   578     05  CG-AH-CAN-DATA.
   579         10  CG-AH-CAN-DT        PIC XX.
   580         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   581     05  CG-CERT-PROFILE-DATA.
   582         10  CG-INS-LNAME        PIC X(15).
   583         10  CG-INS-FNAME        PIC X(10).
   584         10  CG-INS-MID-INIT     PIC X.
   585         10  CG-INS-AGE          PIC 99.
   586         10  CG-JNT-LNAME        PIC X(15).
   587         10  CG-JNT-FNAME        PIC X(10).
   588         10  CG-JNT-MID-INIT     PIC X.
   589         10  CG-JNT-AGE          PIC 99.
   590     05  CG-LF-ISS-DATA.
   591         10  CG-LF-BENCD         PIC XX.
   592         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   593         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   594     05  CG-AH-ISS-DATA.
   595         10  CG-AH-BENCD         PIC XX.
   596         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   597     05  CG-BATCH-NO             PIC X(6).
   598     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   599     05  FILLER                  PIC X(306).
   600******************************************************************
   601*                                                                *
   602*            G E N E R A L   W O R K   A R E A                   *
   603*                                                                *
   604******************************************************************
   605
   606 01  WORK-AREA.
   607     12  WS-RESPONSE             PIC S9(8)   COMP.
   608         88  RESP-NORMAL           VALUE +0.
   609         88  resp-file-notfnd      value +12.
   610         88  RESP-NOTFND           VALUE +13.
   611         88  resp-duprec           value +14.
   612         88  resp-dupkey           value +15.
   613         88  resp-invreq           value +16.
   614         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  13
* EL6311.cbl
   615         88  RESP-ENDFILE          VALUE +20.
   616         88  resp-lengtherr        value +22.
   617     12  DEEDIT-FIELD            PIC X(15).
   618     12  FILLER          REDEFINES DEEDIT-FIELD.
   619         16  FILLER              PIC X(4).
   620         16  DEEDIT-FIELD-X11    PIC X(11).
   621     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   622                                 PIC S9(15).
   623     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   624                                 PIC S9(13)V99.
   625     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   626                                 PIC S9(11)V9999.
   627     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   628     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   629     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   630         16  WS-CALC-TERM-WHOLE  PIC S999.
   631         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   632
   633     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   634     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   635         16  WS-HR-MINS          PIC 99V99.
   636         16  FILLER              PIC XX.
   637
   638     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   639     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   640
   641     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   642     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   643
   644     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   645     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   646     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   647     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   648     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   649     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   650     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   651
   652     12  QID.
   653         16  QID-TERM            PIC X(4).
   654         16  FILLER              PIC X(4)    VALUE '607B'.
   655
   656     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   657         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   658
   659     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   660         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   661
   662     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   663         88 WS-MODE-CODE-VALID     VALUE ' '
   664                                         'W'     *> Weekly
   665                                         'B'     *> Bi-weekly
   666                                         'S'     *> Semi-monthly
   667                                         'M'     *> Monthly (Def)
   668                                         'Q'     *> Quarterly
   669                                         'N'     *> Bi-Monthly??
   670                                         'T'     *> Semi-annual
   671                                         'A'.    *> Annual Pay
   672
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  14
* EL6311.cbl
   673     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   674
   675     12  WS-NUMERIC-SW           PIC X.
   676        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   677
   678     12  WS-EDIT-CSO-FIELD.
   679         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   680                                 PIC X.
   681     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   682     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   683        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   684        88  CALLED-FROM-6315          VALUE '5'.
   685
   686     12  WS-SAVE-INPUT-FIELDS.
   687         16  WS-BAGE             PIC 99       VALUE ZERO.
   688*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   689         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   690         16  FILLER REDEFINES WS-BAPR.
   691             20  WS-APR-WHOLE-NUM    PIC 99.
   692             20  WS-APR-DEC          PIC 9999.
   693         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   694         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   695
   696         16  WS-B-COVERAGE OCCURS 2 TIMES.
   697             20  WS-TERM-IN-DAYS-SW  PIC X.
   698                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   699             20  WS-BTERM        PIC 999       COMP-3.
   700             20  WS-BALT-TERM    PIC 999       COMP-3.
   701             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   702             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   703             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   704             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   705             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   706             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   707
   708         16  WS-C-FIELDS COMP-3.
   709             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   710             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   711             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   712
   713         16  WS-D-FIELDS COMP-3.
   714             20  WS-DRISS        PIC S9(5)    VALUE +0.
   715             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   716             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   717             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   718             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   719             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   720
   721     12  WS-SAVE-BIRTH-DATE.
   722         16  FILLER              PIC X(4)   VALUE SPACES.
   723         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   724
   725     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   726     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   727     12  FILLER REDEFINES WS-WORK-BIN-RED.
   728         16  FILLER              PIC X(02).
   729         16  WS-WORK-BIN-DT      PIC X(02).
   730     12  WS-SW-1                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  15
* EL6311.cbl
   731     12  WS-SW-2                 PIC X     VALUE SPACE.
   732     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   733         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   734     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   735         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   736
   737     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   738     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   739     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   740     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   741     12  WS-CONVERTED-CANCEL-DATES.
   742         16  WS-CONVERTED-CANDT1                  PIC XX.
   743         16  WS-CONVERTED-CANDT2                  PIC XX.
   744
   745     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   746
   747     12  WS-REC-FOUND-SW         PIC X.
   748         88  RECORD-NOT-FOUND    VALUE 'N'.
   749
   750     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   751         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   752         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   753
   754     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   755         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   756         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   757
   758     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   759         88  BROWSE-STARTED      VALUE 'Y'.
   760
   761     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   762         88  FIRST-TIME          VALUE 'Y'.
   763
   764     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   765         88  FIRST-ENTRY         VALUE 'Y'.
   766
   767     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   768         88  REC-BILLED          VALUE 'Y'.
   769
   770     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   771         88  NO-CURSOR-SET       VALUE +0.
   772         88  CURSOR-SET          VALUE +1.
   773
   774     12  WS-ERR-SW               PIC X.
   775         88  STD-ERRORS          VALUE 'S'.
   776         88  TRN-ERRORS          VALUE 'T'.
   777
   778     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   779         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   780
   781     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   782         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   783
   784     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   785         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   786
   787     12  WS-ERR-CODE.
   788         16  FILLER              PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  16
* EL6311.cbl
   789         16  WS-ERROR-SUB        PIC 99.
   790
   791     12  WS-DATE-WORK.
   792         16  WS-WORK-MM          PIC XX.
   793         16  WS-WORK-DD          PIC XX.
   794         16  WS-WORK-YY          PIC XX.
   795
   796     12  WS-MM-YY.
   797         16  WS-MM               PIC XX.
   798         16  FILLER              PIC X     VALUE '/'.
   799         16  WS-YY               PIC XX.
   800
   801     12  WS-CERT-EFF-DT          PIC XX.
   802
   803     12  WS-MEMBER-NO            PIC X(12).
   804     12  FILLER  REDEFINES  WS-MEMBER-NO.
   805         16  WS-MEMBER-NO-1-8    PIC 9(8).
   806         16  FILLER              PIC X(4).
   807
   808     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   809
   810     12  WS-ERPNDB-ALT-KEY.
   811         16  WS-PB-COMPANY-CD-A1         PIC X.
   812         16  WS-PB-CARRIER               PIC X.
   813         16  WS-PB-GROUPING              PIC X(6).
   814         16  WS-PB-STATE                 PIC XX.
   815         16  WS-PB-ACCOUNT               PIC X(10).
   816         16  WS-PB-CERT-EFF-DT           PIC XX.
   817         16  WS-PB-CERT-NO.
   818             20  WS-PB-CERT-PRIME        PIC X(10).
   819             20  WS-PB-CERT-SFX          PIC X.
   820         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   821         16  WS-PB-RECORD-TYPE           PIC X.
   822
   823     12  WS-SHOW-SAVE-AREAS.
   824         16  WS-NEW-CERT-NO.
   825             20  WS-NEW-PRIME    PIC X(10).
   826             20  WS-NEW-SUFFIX   PIC X.
   827         16  WS-NEW-CERT-EFF-DT  PIC XX.
   828         16  WS-NEW-RECORD-TYPE  PIC X.
   829         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   830             88   SHOW-RECORD            VALUE 'Y'.
   831
   832     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   833
   834     12  WS-BATCH-NO.
   835         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   836         16  FILLER              PIC X(5) VALUE SPACES.
   837
   838     12  WS-FIRST-NAME.
   839         16  WS-1ST-INIT         PIC X.
   840         16  FILLER              PIC X(9).
   841
   842     12  WS-INITIALS.
   843         16  WS-INITIAL-1        PIC X.
   844         16  WS-INITIAL-2        PIC X.
   845
   846     12  WS-C-HDG.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  17
* EL6311.cbl
   847         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   848         16  FILLER              PIC X(4) VALUE '-REF'.
   849
   850     12  WS-D-PREM-HDG.
   851         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   852         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   853
   854     12  WS-D-REFUND-HDG.
   855         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   856         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   857
   858     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   859
   860     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   861     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   862     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   863     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   864     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   865     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   866     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   867
   868     12  WS-01-CANCEL-ERR        PIC X(25)
   869         VALUE 'CANCEL DATE ERROR'.
   870     12  WS-02-CANCEL-ERR        PIC X(25)
   871         VALUE 'CERT NOT FOUND'.
   872     12  WS-04-CANCEL-ERR        PIC X(25)
   873         VALUE 'CANCEL AMOUNT ERROR'.
   874     12  WS-05-CANCEL-ERR        PIC X(25)
   875         VALUE 'CANCEL OPTION ERROR'.
   876     12  WS-06-CANCEL-ERR        PIC X(25)
   877         VALUE 'PREVIOUSLY CANCELLED'.
   878     12  WS-07-CANCEL-ERR        PIC X(25)
   879         VALUE 'INVALID DATA'.
   880     12  WS-08-CANCEL-ERR        PIC X(25)
   881         VALUE 'NO ACCOUNT MASTER'.
   882     12  WS-09-CANCEL-ERR        PIC X(25)
   883         VALUE 'SUFFIX ALREADY EXISTS'.
   884     12  WS-99-CANCEL-ERR        PIC X(25)
   885         VALUE 'MISC CANCEL ERROR'.
   886
   887     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   888     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   889
   890     12  WS-AGE-FIELDS.
   891         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   892         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   893         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   894         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   895
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  18
* EL6311.cbl
   897
   898******************************************************************
   899*                                                                *
   900*                 B A T C H   T O T A L S                        *
   901*                                                                *
   902******************************************************************
   903
   904     12  WS-BATCH-RECORD.
   905         16  FILLER                       PIC X(10).
   906         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   907         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   908         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   909         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   910         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   911         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   912         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   913         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   914         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   915         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   916         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   917         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   918         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   919         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   920         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   921         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   922         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   923         16  WS-ACCOUNT-NAME              PIC X(30).
   924         16  FILLER                       PIC X.
   925         16  WS-REFERENCE                 PIC X(12).
   926         16  FILLER                       PIC X(197).
   927
   928     12  WS-BATCH-TOTALS.
   929         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   930         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   932         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   933         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   934         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   935         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   936         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   937         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   938         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   939         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   940         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   941         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   946         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   947         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   948
   949     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   950
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  19
* EL6311.cbl
   952
   953******************************************************************
   954*                                                                *
   955*                E R R O R   M E S S A G E S                     *
   956*                                                                *
   957******************************************************************
   958
   959 01  ERROR-MESSAGES.
   960     12  ER-0004                 PIC  9(4) VALUE 0004.
   961     12  ER-0008                 PIC  9(4) VALUE 0008.
   962     12  ER-0023                 PIC  9(4) VALUE 0023.
   963     12  ER-0029                 PIC  9(4) VALUE 0029.
   964     12  ER-0033                 PIC  9(4) VALUE 0033.
   965     12  ER-0070                 PIC  9(4) VALUE 0070.
   966     12  ER-0220                 PIC  9(4) VALUE 0220.
   967     12  ER-0248                 PIC  9(4) VALUE 0248.
   968     12  ER-0280                 PIC  9(4) VALUE 0280.
   969     12  ER-0348                 PIC  9(4) VALUE 0348.
   970     12  ER-0582                 PIC  9(4) VALUE 0582.
   971     12  ER-0877                 PIC  9(4) VALUE 0877.
   972     12  ER-1236                 PIC  9(4) VALUE 1236.
   973     12  ER-1570                 PIC  9(4) VALUE 1570.
   974     12  ER-1575                 PIC  9(4) VALUE 1575.
   975     12  ER-1577                 PIC  9(4) VALUE 1577.
   976     12  ER-1584                 PIC  9(4) VALUE 1584.
   977     12  ER-1585                 PIC  9(4) VALUE 1585.
   978     12  ER-1609                 PIC  9(4) VALUE 1609.
   979     12  er-1762                 pic  9(4) value 1762.
   980     12  ER-1819                 PIC  9(4) VALUE 1819.
   981     12  ER-2077                 PIC  9(4) VALUE 2077.
   982     12  ER-2129                 PIC  9(4) VALUE 2129.
   983     12  ER-2188                 PIC  9(4) VALUE 2188.
   984     12  ER-2192                 PIC  9(4) VALUE 2192.
   985     12  ER-2196                 PIC  9(4) VALUE 2196.
   986     12  ER-2197                 PIC  9(4) VALUE 2197.
   987     12  ER-2198                 PIC  9(4) VALUE 2198.
   988     12  ER-2200                 PIC  9(4) VALUE 2200.
   989     12  ER-2212                 PIC  9(4) VALUE 2212.
   990     12  ER-2218                 PIC  9(4) VALUE 2218.
   991     12  ER-2220                 PIC  9(4) VALUE 2220.
   992     12  ER-2222                 PIC  9(4) VALUE 2222.
   993     12  ER-2223                 PIC  9(4) VALUE 2223.
   994     12  ER-2224                 PIC  9(4) VALUE 2224.
   995     12  ER-2225                 PIC  9(4) VALUE 2225.
   996     12  ER-2226                 PIC  9(4) VALUE 2226.
   997     12  ER-2227                 PIC  9(4) VALUE 2227.
   998     12  ER-2228                 PIC  9(4) VALUE 2228.
   999     12  ER-2240                 PIC  9(4) VALUE 2240.
  1000     12  ER-2241                 PIC  9(4) VALUE 2241.
  1001     12  ER-2242                 PIC  9(4) VALUE 2242.
  1002     12  ER-2243                 PIC  9(4) VALUE 2243.
  1003     12  ER-2244                 PIC  9(4) VALUE 2244.
  1004     12  ER-2245                 PIC  9(4) VALUE 2245.
  1005     12  ER-2246                 PIC  9(4) VALUE 2246.
  1006     12  ER-2247                 PIC  9(4) VALUE 2247.
  1007     12  ER-2251                 PIC  9(4) VALUE 2251.
  1008     12  ER-2252                 PIC  9(4) VALUE 2252.
  1009     12  ER-2253                 PIC  9(4) VALUE 2253.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  20
* EL6311.cbl
  1010     12  ER-2254                 PIC  9(4) VALUE 2254.
  1011     12  ER-2255                 PIC  9(4) VALUE 2255.
  1012     12  ER-2256                 PIC  9(4) VALUE 2256.
  1013     12  ER-2257                 PIC  9(4) VALUE 2257.
  1014     12  ER-2258                 PIC  9(4) VALUE 2258.
  1015     12  ER-2259                 PIC  9(4) VALUE 2259.
  1016     12  ER-2260                 PIC  9(4) VALUE 2260.
  1017     12  ER-2261                 PIC  9(4) VALUE 2261.
  1018     12  ER-2287                 PIC  9(4) VALUE 2287.
  1019     12  ER-2336                 PIC  9(4) VALUE 2336.
  1020     12  ER-2337                 PIC  9(4) VALUE 2337.
  1021     12  ER-2437                 PIC  9(4) VALUE 2437.
  1022     12  ER-2471                 PIC  9(4) VALUE 2471.
  1023     12  ER-2530                 PIC  9(4) VALUE 2530.
  1024     12  ER-2531                 PIC  9(4) VALUE 2531.
  1025     12  ER-2532                 PIC  9(4) VALUE 2532.
  1026     12  ER-2533                 PIC  9(4) VALUE 2533.
  1027     12  ER-2547                 PIC  9(4) VALUE 2547.
  1028     12  ER-2591                 PIC  9(4) VALUE 2591.
  1029     12  ER-2592                 PIC  9(4) VALUE 2592.
  1030     12  ER-2593                 PIC  9(4) VALUE 2593.
  1031     12  ER-2600                 PIC  9(4) VALUE 2600.
  1032     12  ER-2601                 PIC  9(4) VALUE 2601.
  1033     12  ER-2604                 PIC  9(4) VALUE 2604.
  1034     12  ER-2605                 PIC  9(4) VALUE 2605.
  1035     12  ER-2606                 PIC  9(4) VALUE 2606.
  1036     12  ER-2607                 PIC  9(4) VALUE 2607.
  1037     12  ER-2622                 PIC  9(4) VALUE 2622.
  1038     12  ER-2625                 PIC  9(4) VALUE 2625.
  1039     12  ER-2626                 PIC  9(4) VALUE 2626.
  1040     12  ER-2627                 PIC  9(4) VALUE 2627.
  1041     12  ER-2628                 PIC  9(4) VALUE 2628.
  1042     12  ER-2629                 PIC  9(4) VALUE 2629.
  1043     12  ER-2630                 PIC  9(4) VALUE 2630.
  1044     12  ER-2631                 PIC  9(4) VALUE 2631.
  1045     12  ER-2632                 PIC  9(4) VALUE 2632.
  1046     12  ER-2633                 PIC  9(4) VALUE 2633.
  1047     12  ER-2634                 PIC  9(4) VALUE 2634.
  1048     12  ER-2635                 PIC  9(4) VALUE 2635.
  1049     12  ER-2636                 PIC  9(4) VALUE 2636.
  1050     12  ER-2639                 PIC  9(4) VALUE 2639.
  1051     12  ER-2640                 PIC  9(4) VALUE 2640.
  1052     12  ER-2647                 PIC  9(4) VALUE 2647.
  1053     12  ER-2648                 PIC  9(4) VALUE 2648.
  1054     12  ER-2649                 PIC  9(4) VALUE 2649.
  1055     12  ER-2650                 PIC  9(4) VALUE 2650.
  1056     12  ER-2651                 PIC  9(4) VALUE 2651.
  1057     12  ER-2653                 PIC  9(4) VALUE 2653.
  1058     12  ER-2654                 PIC  9(4) VALUE 2654.
  1059     12  ER-2655                 PIC  9(4) VALUE 2655.
  1060     12  ER-2656                 PIC  9(4) VALUE 2656.
  1061     12  ER-2657                 PIC  9(4) VALUE 2657.
  1062     12  ER-2660                 PIC  9(4) VALUE 2660.
  1063     12  ER-2661                 PIC  9(4) VALUE 2661.
  1064     12  ER-2662                 PIC  9(4) VALUE 2662.
  1065     12  ER-2663                 PIC  9(4) VALUE 2663.
  1066     12  ER-2664                 PIC  9(4) VALUE 2664.
  1067     12  ER-2667                 PIC  9(4) VALUE 2667.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  21
* EL6311.cbl
  1068     12  ER-2668                 PIC  9(4) VALUE 2668.
  1069     12  ER-2669                 PIC  9(4) VALUE 2669.
  1070     12  ER-2670                 PIC  9(4) VALUE 2670.
  1071     12  ER-2671                 PIC  9(4) VALUE 2671.
  1072     12  ER-2672                 PIC  9(4) VALUE 2672.
  1073     12  ER-2673                 PIC  9(4) VALUE 2673.
  1074     12  ER-2677                 PIC  9(4) VALUE 2677.
  1075     12  ER-2678                 PIC  9(4) VALUE 2678.
  1076     12  ER-2679                 PIC  9(4) VALUE 2679.
  1077     12  ER-2680                 PIC  9(4) VALUE 2680.
  1078     12  ER-2681                 PIC  9(4) VALUE 2681.
  1079     12  ER-2682                 PIC  9(4) VALUE 2682.
  1080     12  ER-2683                 PIC  9(4) VALUE 2683.
  1081     12  ER-2684                 PIC  9(4) VALUE 2684.
  1082     12  ER-2686                 PIC  9(4) VALUE 2686.
  1083     12  ER-2689                 PIC  9(4) VALUE 2689.
  1084     12  ER-2690                 PIC  9(4) VALUE 2690.
  1085     12  ER-2693                 PIC  9(4) VALUE 2693.
  1086     12  ER-2695                 PIC  9(4) VALUE 2695.
  1087     12  ER-2701                 PIC  9(4) VALUE 2701.
  1088     12  ER-2720                 PIC  9(4) VALUE 2720.
  1089     12  ER-2709                 PIC  9(4) VALUE 2709.
  1090     12  ER-2704                 PIC  9(4) VALUE 2704.
  1091     12  ER-2725                 PIC  9(4) VALUE 2725.
  1092     12  ER-2726                 PIC  9(4) VALUE 2726.
  1093     12  ER-2728                 PIC  9(4) VALUE 2728.
  1094     12  ER-2729                 PIC  9(4) VALUE 2729.
  1095     12  ER-2731                 PIC  9(4) VALUE 2731.
  1096     12  ER-2732                 PIC  9(4) VALUE 2732.
  1097     12  ER-2733                 PIC  9(4) VALUE 2733.
  1098     12  ER-2735                 PIC  9(4) VALUE 2735.
  1099     12  ER-2738                 PIC  9(4) VALUE 2738.
  1100     12  ER-2742                 PIC  9(4) VALUE 2742.
  1101     12  ER-2743                 PIC  9(4) VALUE 2743.
  1102     12  ER-2744                 PIC  9(4) VALUE 2744.
  1103     12  ER-2747                 PIC  9(4) VALUE 2747.
  1104     12  ER-2749                 PIC  9(4) VALUE 2749.
  1105     12  ER-2753                 PIC  9(4) VALUE 2753.
  1106     12  ER-2755                 PIC  9(4) VALUE 2755.
  1107     12  ER-2757                 PIC  9(4) VALUE 2757.
  1108     12  ER-2771                 PIC  9(4) VALUE 2771.
  1109     12  ER-2774                 PIC  9(4) VALUE 2774.
  1110     12  ER-2775                 PIC  9(4) VALUE 2775.
  1111     12  ER-2776                 PIC  9(4) VALUE 2776.
  1112     12  ER-2777                 PIC  9(4) VALUE 2777.
  1113     12  ER-2794                 PIC  9(4) VALUE 2794.
  1114     12  ER-2799                 PIC  9(4) VALUE 2799.
  1115     12  ER-2900                 PIC  9(4) VALUE 2900.
  1116     12  ER-2902                 PIC  9(4) VALUE 2902.
  1117     12  ER-2945                 PIC  9(4) VALUE 2945.
  1118     12  ER-3000                 PIC  9(4) VALUE 3000.
  1119     12  ER-3006                 PIC  9(4) VALUE 3006.
  1120     12  ER-3054                 PIC  9(4) VALUE 3054.
  1121     12  er-3070                 pic  9(4) value 3070.
  1122     12  ER-3224                 PIC  9(4) VALUE 3224.
  1123     12  ER-3269                 PIC  9(4) VALUE 3269.
  1124     12  er-3444                 pic  9(4) value 3444.
  1125     12  er-3446                 pic  9(4) value 3446.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  22
* EL6311.cbl
  1126     12  er-3447                 pic  9(4) value 3447.
  1127     12  er-3448                 pic  9(4) value 3448.
  1128     12  er-3449                 pic  9(4) value 3449.
  1129     12  ER-3456                 PIC  9(4) VALUE 3456.
  1130     12  ER-3457                 PIC  9(4) VALUE 3457.
  1131     12  ER-3458                 PIC  9(4) VALUE 3458.
  1132     12  ER-3504                 PIC  9(4) VALUE 3504.
  1133     12  ER-3513                 PIC  9(4) VALUE 3513.
  1134     12  ER-3831                 PIC  9(4) VALUE 3831.
  1135     12  ER-3834                 PIC  9(4) VALUE 3834.
  1136     12  ER-3835                 PIC  9(4) VALUE 3835.
  1137     12  ER-4005                 PIC  9(4) VALUE 4005.
  1138     12  ER-7144                 PIC  9(4) VALUE 7144.
  1139     12  ER-7401                 PIC  9(4) VALUE 7401.
  1140     12  ER-7402                 PIC  9(4) VALUE 7402.
  1141     12  ER-7403                 PIC  9(4) VALUE 7403.
  1142     12  ER-7404                 PIC  9(4) VALUE 7404.
  1143     12  ER-7423                 PIC  9(4) VALUE 7423.
  1144     12  ER-7424                 PIC  9(4) VALUE 7424.
  1145     12  ER-7433                 PIC  9(4) VALUE 7433.
  1146     12  ER-7450                 PIC  9(4) VALUE 7450.
  1147     12  ER-7451                 PIC  9(4) VALUE 7451.
  1148     12  ER-7530                 PIC  9(4) VALUE 7530.
  1149     12  ER-7573                 PIC  9(4) VALUE 7573.
  1150     12  ER-7631                 PIC  9(4) VALUE 7631.
  1151     12  ER-7632                 PIC  9(4) VALUE 7632.
  1152     12  ER-7633                 PIC  9(4) VALUE 7633.
  1153     12  ER-7537                 PIC  9(4) VALUE 7537.
  1154     12  ER-7538                 PIC  9(4) VALUE 7538.
  1155     12  ER-7574                 PIC  9(4) VALUE 7574.
  1156     12  ER-7997                 PIC  9(4) VALUE 7997.
  1157     12  ER-7998                 PIC  9(4) VALUE 7998.
  1158     12  ER-8148                 PIC  9(4) VALUE 8148.
  1159     12  ER-9063                 PIC  9(4) VALUE 9063.
  1160     12  ER-9076                 PIC  9(4) VALUE 9076.
  1161     12  ER-9618                 PIC  9(4) VALUE 9618.
  1162     12  ER-9841                 PIC  9(4) VALUE 9841.
  1163
  1164*                                COPY ELCTEXT.
  1165******************************************************************
  1166*                                                                *
  1167*                                                                *
  1168*                            ELCTEXT.                            *
  1169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1170*                            VMOD=2.008                          *
  1171*                                                                *
  1172*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1173*                                     FORM LETTERS,              *
  1174*                                     CERT FORM DISPLAY.
  1175*                                                                *
  1176*   FILE TYPE = VSAM,KSDS                                        *
  1177*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1178*                                                                *
  1179*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1180*       ALTERNATE INDEX = NONE                                   *
  1181*                                                                *
  1182*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1183*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  23
* EL6311.cbl
  1184*                                                                *
  1185*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1186*       ALTERNATE INDEX = NONE                                   *
  1187*                                                                *
  1188*   LOG = NO                                                     *
  1189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1190******************************************************************
  1191 01  TEXT-FILES.
  1192     12  TEXT-FILE-ID                PIC XX.
  1193         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1194         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1195         88  HELP-FILE-TEXT             VALUE 'TH'.
  1196
  1197     12  TX-CONTROL-PRIMARY.
  1198         16  TX-COMPANY-CD           PIC X.
  1199             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1200         16  TX-ACCESS-CD-GENL       PIC X(12).
  1201
  1202         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1203             20  TX-LETTER-NO        PIC X(4).
  1204             20  FILLER              PIC X(8).
  1205
  1206         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1207             20  TX-FORM-NO          PIC X(12).
  1208
  1209         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1210             20  TX-HELP-TYPE        PIC X.
  1211                 88  HELP-FOR-GENERAL   VALUE ' '.
  1212                 88  HELP-BY-SCREEN     VALUE 'S'.
  1213                 88  HELP-BY-ERROR      VALUE 'E'.
  1214             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1215                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1216             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1217                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1218             20  FILLER              PIC X(4).
  1219
  1220         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1221
  1222     12  TX-PROCESS-CONTROL          PIC XX.
  1223         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1224
  1225     12  TX-TEXT-LINE                PIC X(70).
  1226
  1227     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1228         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1229         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1230         88  TX-VALID-FORM-SQUEEZE-VALUE
  1231                                        VALUE 'Y' ' '.
  1232
  1233     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1234         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1235         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1236         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1237         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1238         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1239         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1240         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1241                                              'K' 'N' ' '
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  24
* EL6311.cbl
  1242                                              'Z'.
  1243
  1244     12  TX-ARCHIVE-SW               PIC X.
  1245         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1246         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1247         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1248
  1249     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1250     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1251
  1252     12  TX-BSR-CODE                 PIC X.
  1253         88  TX-BSR-LETTER              VALUE 'B'.
  1254         88  TX-NON-BSR-LETTER          VALUE ' '.
  1255
  1256     12  FILLER                      PIC X.
  1257*****************************************************************
  1258*                                COPY ELCCRTO.
  1259******************************************************************
  1260*                                                                *
  1261*                            ELCCRTO.                            *
  1262*                                                                *
  1263*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1264*                                                                *
  1265*   FILE TYPE = VSAM,KSDS                                        *
  1266*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1267*                                                                *
  1268*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1269*                                                                *
  1270*   LOG = YES                                                    *
  1271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1272******************************************************************
  1273*                   C H A N G E   L O G
  1274*
  1275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1276*-----------------------------------------------------------------
  1277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1278* EFFECTIVE    NUMBER
  1279*-----------------------------------------------------------------
  1280* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1281* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1282* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1283* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1284* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1285******************************************************************
  1286 01  ORIGINAL-CERTIFICATE.
  1287     12  OC-RECORD-ID                      PIC XX.
  1288         88  VALID-OC-ID                      VALUE 'OC'.
  1289     12  OC-CONTROL-PRIMARY.
  1290         16  OC-COMPANY-CD                 PIC X.
  1291         16  OC-CARRIER                    PIC X.
  1292         16  OC-GROUPING                   PIC X(6).
  1293         16  OC-STATE                      PIC XX.
  1294         16  OC-ACCOUNT                    PIC X(10).
  1295         16  OC-CERT-EFF-DT                PIC XX.
  1296         16  OC-CERT-NO.
  1297             20  OC-CERT-PRIME             PIC X(10).
  1298             20  OC-CERT-SFX               PIC X.
  1299         16  OC-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  25
* EL6311.cbl
  1300         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1301     12  OC-LAST-MAINT-DT                  PIC XX.
  1302     12  OC-LAST-MAINT-BY                  PIC X(4).
  1303     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1304     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1305     12  FILLER                            PIC X(49).
  1306     12  OC-ORIG-REC.
  1307         16  OC-INS-LAST-NAME              PIC X(15).
  1308         16  OC-INS-FIRST-NAME             PIC X(10).
  1309         16  OC-INS-MIDDLE-INIT            PIC X.
  1310         16  OC-INS-AGE                    PIC S999     COMP-3.
  1311         16  OC-JNT-LAST-NAME              PIC X(15).
  1312         16  OC-JNT-FIRST-NAME             PIC X(10).
  1313         16  OC-JNT-MIDDLE-INIT            PIC X.
  1314         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1315         16  OC-LF-BENCD                   PIC XX.
  1316         16  OC-LF-TERM                    PIC S999      COMP-3.
  1317         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1318         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1319         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1320         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1321         16  OC-LF-EXP-DT                  PIC XX.
  1322         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1323         16  OC-LF-CANCEL-DT               PIC XX.
  1324         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1325         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1326         16  OC-AH-BENCD                   PIC XX.
  1327         16  OC-AH-TERM                    PIC S999      COMP-3.
  1328         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1329         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1330         16  OC-AH-EXP-DT                  PIC XX.
  1331         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1332         16  OC-AH-CP                      PIC 99.
  1333         16  OC-AH-CANCEL-DT               PIC XX.
  1334         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1335         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1336         16  OC-CRED-BENE-NAME             PIC X(25).
  1337         16  OC-1ST-PMT-DT                 PIC XX.
  1338         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1339         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1340         16  OC-ISSUE-TRAN-IND             PIC X.
  1341         16  OC-CANCEL-TRAN-IND            PIC X.
  1342         16  FILLER                        PIC X(211).
  1343
  1344     12  FILLER                            PIC X(50).
  1345******************************************************************
  1346*                                COPY ERCACCT.
  1347******************************************************************
  1348*                                                                *
  1349*                                                                *
  1350*                            ERCACCT                             *
  1351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1352*                            VMOD=2.031                          *
  1353*                                                                *
  1354*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1355*                                                                *
  1356*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1357*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  26
* EL6311.cbl
  1358*                                                                *
  1359*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1360*                                                                *
  1361*   FILE TYPE = VSAM,KSDS                                        *
  1362*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1363*                                                                *
  1364*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1365*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1366*                                                                *
  1367*   LOG = NO                                                     *
  1368*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1369*                                                                *
  1370*                                                                *
  1371******************************************************************
  1372*                   C H A N G E   L O G
  1373*
  1374* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1375*-----------------------------------------------------------------
  1376*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1377* EFFECTIVE    NUMBER
  1378*-----------------------------------------------------------------
  1379* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1380* 092705    2005050300006  PEMA  ADD SPP LEASES
  1381* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1382* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1383* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1384* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1385* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1386* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1387******************************************************************
  1388
  1389 01  ACCOUNT-MASTER.
  1390     12  AM-RECORD-ID                      PIC XX.
  1391         88  VALID-AM-ID                      VALUE 'AM'.
  1392
  1393     12  AM-CONTROL-PRIMARY.
  1394         16  AM-COMPANY-CD                 PIC X.
  1395         16  AM-MSTR-CNTRL.
  1396             20  AM-CONTROL-A.
  1397                 24  AM-CARRIER            PIC X.
  1398                 24  AM-GROUPING.
  1399                     28 AM-GROUPING-PREFIX PIC XXX.
  1400                     28 AM-GROUPING-PRIME  PIC XXX.
  1401                 24  AM-STATE              PIC XX.
  1402                 24  AM-ACCOUNT.
  1403                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1404                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1405             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1406                                           PIC X(19).
  1407             20  AM-CNTRL-B.
  1408                 24  AM-EXPIRATION-DT      PIC XX.
  1409                 24  FILLER                PIC X(4).
  1410             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1411                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1412
  1413     12  AM-CONTROL-BY-VAR-GRP.
  1414         16  AM-COMPANY-CD-A1              PIC X.
  1415         16  AM-VG-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  27
* EL6311.cbl
  1416         16  AM-VG-GROUPING                PIC X(6).
  1417         16  AM-VG-STATE                   PIC XX.
  1418         16  AM-VG-ACCOUNT                 PIC X(10).
  1419         16  AM-VG-DATE.
  1420             20  AM-VG-EXPIRATION-DT       PIC XX.
  1421             20  FILLER                    PIC X(4).
  1422         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1423                                           PIC 9(11)      COMP-3.
  1424     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1425         16  FILLER                        PIC X(10).
  1426         16  AM-VG-KEY3.
  1427             20  AM-VG3-ACCOUNT            PIC X(10).
  1428             20  AM-VG3-EXP-DT             PIC XX.
  1429         16  FILLER                        PIC X(4).
  1430     12  AM-MAINT-INFORMATION.
  1431         16  AM-LAST-MAINT-DT              PIC XX.
  1432         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1433         16  AM-LAST-MAINT-USER            PIC X(4).
  1434         16  FILLER                        PIC XX.
  1435
  1436     12  AM-EFFECTIVE-DT                   PIC XX.
  1437     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1438
  1439     12  AM-PREV-DATES  COMP-3.
  1440         16  AM-PREV-EXP-DT                PIC 9(11).
  1441         16  AM-PREV-EFF-DT                PIC 9(11).
  1442
  1443     12  AM-REPORT-CODE-1                  PIC X(10).
  1444     12  AM-REPORT-CODE-2                  PIC X(10).
  1445
  1446     12  AM-CITY-CODE                      PIC X(4).
  1447     12  AM-COUNTY-PARISH                  PIC X(6).
  1448
  1449     12  AM-NAME                           PIC X(30).
  1450     12  AM-PERSON                         PIC X(30).
  1451     12  AM-ADDRS                          PIC X(30).
  1452     12  AM-CITY.
  1453         16  AM-ADDR-CITY                  PIC X(28).
  1454         16  AM-ADDR-STATE                 PIC XX.
  1455     12  AM-ZIP.
  1456         16  AM-ZIP-PRIME.
  1457             20  AM-ZIP-PRI-1ST            PIC X.
  1458                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1459             20  FILLER                    PIC X(4).
  1460         16  AM-ZIP-PLUS4                  PIC X(4).
  1461     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1462         16  AM-CAN-POSTAL-1               PIC XXX.
  1463         16  AM-CAN-POSTAL-2               PIC XXX.
  1464         16  FILLER                        PIC XXX.
  1465     12  AM-TEL-NO.
  1466         16  AM-AREA-CODE                  PIC 999.
  1467         16  AM-TEL-PRE                    PIC 999.
  1468         16  AM-TEL-NBR                    PIC 9(4).
  1469     12  AM-TEL-LOC                        PIC X.
  1470         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1471         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1472
  1473     12  AM-COMM-STRUCTURE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  28
* EL6311.cbl
  1474         16  AM-DEFN-1.
  1475             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1476                 24  AM-AGT.
  1477                     28  AM-AGT-PREFIX     PIC X(4).
  1478                     28  AM-AGT-PRIME      PIC X(6).
  1479                 24  AM-COM-TYP            PIC X.
  1480                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1481                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1482                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1483                 24  AM-RECALC-LV-INDIC    PIC X.
  1484                 24  AM-RETRO-LV-INDIC     PIC X.
  1485                 24  AM-GL-CODES           PIC X.
  1486                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1487                 24  FILLER                PIC X(01).
  1488         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1489             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1490                 24  FILLER                PIC X(11).
  1491                 24  AM-L-COMA             PIC XXX.
  1492                 24  AM-J-COMA             PIC XXX.
  1493                 24  AM-A-COMA             PIC XXX.
  1494                 24  FILLER                PIC X(6).
  1495
  1496     12  AM-COMM-CHANGE-STATUS             PIC X.
  1497         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1498
  1499     12  AM-CSR-CODE                       PIC X(4).
  1500
  1501     12  AM-BILLING-STATUS                 PIC X.
  1502         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1503         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1504     12  AM-AUTO-REFUND-SW                 PIC X.
  1505         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1506         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1507     12  AM-GPCD                           PIC 99.
  1508     12  AM-IG                             PIC X.
  1509         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1510         88  AM-HAS-GROUP                     VALUE '2'.
  1511     12  AM-STATUS                         PIC X.
  1512         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1513         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1514         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1515         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1516         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1517         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1518         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1519         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1520         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1521         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1522     12  AM-REMIT-TO                       PIC 99.
  1523     12  AM-ID-NO                          PIC X(11).
  1524
  1525     12  AM-CAL-TABLE                      PIC XX.
  1526     12  AM-LF-DEVIATION                   PIC XXX.
  1527     12  AM-AH-DEVIATION                   PIC XXX.
  1528     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1529     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1530     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1531     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  29
* EL6311.cbl
  1532     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1533     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1534
  1535     12  AM-USER-FIELDS.
  1536         16  AM-FLD-1                      PIC XX.
  1537         16  AM-FLD-2                      PIC XX.
  1538         16  AM-FLD-3                      PIC XX.
  1539         16  AM-FLD-4                      PIC XX.
  1540         16  AM-FLD-5                      PIC XX.
  1541
  1542     12  AM-1ST-PROD-DATE.
  1543         16  AM-1ST-PROD-YR                PIC XX.
  1544         16  AM-1ST-PROD-MO                PIC XX.
  1545         16  AM-1ST-PROD-DA                PIC XX.
  1546     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1547     12  AM-CERTS-PURGED-DATE.
  1548         16  AM-PUR-YR                     PIC XX.
  1549         16  AM-PUR-MO                     PIC XX.
  1550         16  AM-PUR-DA                     PIC XX.
  1551     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1552     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1553     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1554     12  AM-INACTIVE-DATE.
  1555         16  AM-INA-MO                     PIC 99.
  1556         16  AM-INA-DA                     PIC 99.
  1557         16  AM-INA-YR                     PIC 99.
  1558     12  AM-AR-HI-CERT-DATE                PIC XX.
  1559
  1560     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1561     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1562
  1563     12  AM-OB-PAYMENT-MODE                PIC X.
  1564         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1565         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1566         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1567         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1568
  1569     12  AM-AH-ONLY-INDICATOR              PIC X.
  1570         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1571         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1572
  1573     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1574
  1575     12  AM-OVER-SHORT.
  1576         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1577         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1578
  1579     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1580     12  AM-DCC-CLP-STATE                  PIC XX.
  1581
  1582     12  AM-RECALC-COMM                    PIC X.
  1583     12  AM-RECALC-REIN                    PIC X.
  1584
  1585     12  AM-REI-TABLE                      PIC XXX.
  1586     12  AM-REI-ET-LF                      PIC X.
  1587     12  AM-REI-ET-AH                      PIC X.
  1588     12  AM-REI-PE-LF                      PIC X.
  1589     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  30
* EL6311.cbl
  1590     12  AM-REI-PRT-ST                     PIC X.
  1591     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1592     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1593     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1594     12  AM-REI-GROUP-A                    PIC X(6).
  1595     12  AM-REI-MORT                       PIC X(4).
  1596     12  AM-REI-PRT-OW                     PIC X.
  1597     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1598     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1599     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1600     12  AM-REI-GROUP-B                    PIC X(6).
  1601
  1602     12  AM-TRUST-TYPE                     PIC X(2).
  1603
  1604     12  AM-EMPLOYER-STMT-USED             PIC X.
  1605     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1606
  1607     12  AM-STD-AH-TYPE                    PIC XX.
  1608     12  AM-EARN-METHODS.
  1609         16  AM-EARN-METHOD-R              PIC X.
  1610             88 AM-REF-RL-R78                 VALUE 'R'.
  1611             88 AM-REF-RL-PR                  VALUE 'P'.
  1612             88 AM-REF-RL-MEAN                VALUE 'M'.
  1613             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1614         16  AM-EARN-METHOD-L              PIC X.
  1615             88 AM-REF-LL-R78                 VALUE 'R'.
  1616             88 AM-REF-LL-PR                  VALUE 'P'.
  1617             88 AM-REF-LL-MEAN                VALUE 'M'.
  1618             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1619         16  AM-EARN-METHOD-A              PIC X.
  1620             88 AM-REF-AH-R78                 VALUE 'R'.
  1621             88 AM-REF-AH-PR                  VALUE 'P'.
  1622             88 AM-REF-AH-MEAN                VALUE 'M'.
  1623             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1624             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1625             88 AM-REF-AH-NET                 VALUE 'N'.
  1626
  1627     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1628     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1629     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1630
  1631     12  AM-RET-Y-N                        PIC X.
  1632     12  AM-RET-P-E                        PIC X.
  1633     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1634     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1635     12  AM-RET-GRP                        PIC X(6).
  1636     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1637         16  AM-POOL-PRIME                 PIC XXX.
  1638         16  AM-POOL-SUB                   PIC XXX.
  1639     12  AM-RETRO-EARNINGS.
  1640         16  AM-RET-EARN-R                 PIC X.
  1641         16  AM-RET-EARN-L                 PIC X.
  1642         16  AM-RET-EARN-A                 PIC X.
  1643     12  AM-RET-ST-TAX-USE                 PIC X.
  1644         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1645         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1646     12  AM-RETRO-BEG-EARNINGS.
  1647         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  31
* EL6311.cbl
  1648         16  AM-RET-BEG-EARN-L             PIC X.
  1649         16  AM-RET-BEG-EARN-A             PIC X.
  1650     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1651     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1652
  1653     12  AM-USER-SELECT-OPTIONS.
  1654         16  AM-USER-SELECT-1              PIC X(10).
  1655         16  AM-USER-SELECT-2              PIC X(10).
  1656         16  AM-USER-SELECT-3              PIC X(10).
  1657         16  AM-USER-SELECT-4              PIC X(10).
  1658         16  AM-USER-SELECT-5              PIC X(10).
  1659
  1660     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1661
  1662     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1663
  1664     12  AM-RPT045A-SWITCH                 PIC X.
  1665         88  RPT045A-OFF                   VALUE 'N'.
  1666
  1667     12  AM-INSURANCE-LIMITS.
  1668         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1669         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1670
  1671     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1672         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1673
  1674     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1675         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1676         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1677
  1678     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1679
  1680     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1681     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1682     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1683     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1684     12  AM-DCC-UEF-STATE                  PIC XX.
  1685     12  FILLER                            PIC XXX.
  1686     12  AM-REPORT-CODE-3                  PIC X(10).
  1687*    12  FILLER                            PIC X(22).
  1688
  1689     12  AM-RESERVE-DATE.
  1690         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1691         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1692         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1693
  1694     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1695     12  AM-NOTIFICATION-TYPES.
  1696         16  AM-NOTIF-OF-LETTERS           PIC X.
  1697         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1698         16  AM-NOTIF-OF-REPORTS           PIC X.
  1699         16  AM-NOTIF-OF-STATUS            PIC X.
  1700
  1701     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1702         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1703         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1704         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1705         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  32
* EL6311.cbl
  1706
  1707     12  AM-BENEFIT-CONTROLS.
  1708         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1709             20  AM-BENEFIT-CODE           PIC XX.
  1710             20  AM-BENEFIT-TYPE           PIC X.
  1711             20  AM-BENEFIT-REVISION       PIC XXX.
  1712             20  AM-BENEFIT-REM-TERM       PIC X.
  1713             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1714             20  FILLER                    PIC XX.
  1715         16  FILLER                        PIC X(80).
  1716
  1717     12  AM-TRANSFER-DATA.
  1718         16  AM-TRANSFERRED-FROM.
  1719             20  AM-TRNFROM-CARRIER        PIC X.
  1720             20  AM-TRNFROM-GROUPING.
  1721                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1722                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1723             20  AM-TRNFROM-STATE          PIC XX.
  1724             20  AM-TRNFROM-ACCOUNT.
  1725                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1726                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1727             20  AM-TRNFROM-DTE            PIC XX.
  1728         16  AM-TRANSFERRED-TO.
  1729             20  AM-TRNTO-CARRIER          PIC X.
  1730             20  AM-TRNTO-GROUPING.
  1731                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1732                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1733             20  AM-TRNTO-STATE            PIC XX.
  1734             20  AM-TRNTO-ACCOUNT.
  1735                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1736                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1737             20  AM-TRNTO-DTE              PIC XX.
  1738         16  FILLER                        PIC X(10).
  1739
  1740     12  AM-SAVED-REMIT-TO                 PIC 99.
  1741
  1742     12  AM-COMM-STRUCTURE-SAVED.
  1743         16  AM-DEFN-1-SAVED.
  1744             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1745                 24  AM-AGT-SV             PIC X(10).
  1746                 24  AM-COM-TYP-SV         PIC X.
  1747                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1748                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1749                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1750                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1751                 24  FILLER                PIC X.
  1752                 24  AM-GL-CODES-SV        PIC X.
  1753                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1754                 24  FILLER                PIC X.
  1755         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1756             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1757                 24  FILLER                PIC X(11).
  1758                 24  AM-L-COMA-SV          PIC XXX.
  1759                 24  AM-J-COMA-SV          PIC XXX.
  1760                 24  AM-A-COMA-SV          PIC XXX.
  1761                 24  FILLER                PIC X(6).
  1762
  1763     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  33
* EL6311.cbl
  1764         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1765            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1766            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1767            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1768
  1769     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1770     12  FILLER                            PIC X(120).
  1771
  1772     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1773         16  AM-CONTROL-NAME               PIC X(30).
  1774         16  AM-EXECUTIVE-ONE.
  1775             20  AM-EXEC1-NAME             PIC X(15).
  1776             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1777                                                          COMP-3.
  1778             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1779                                                          COMP-3.
  1780         16  AM-EXECUTIVE-TWO.
  1781             20  AM-EXEC2-NAME             PIC X(15).
  1782             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1783                                                          COMP-3.
  1784             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1785                                                          COMP-3.
  1786
  1787     12  AM-RETRO-ADDITIONAL-DATA.
  1788         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1789         16  AM-RETRO-PREM-P-E             PIC X.
  1790         16  AM-RETRO-CLMS-P-I             PIC X.
  1791         16  AM-RETRO-RET-BRACKET-LF.
  1792             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1793                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1794                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1795             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1796                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1797                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1798             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1799                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1800                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1801         16  AM-RETRO-RET-BRACKET-AH.
  1802             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1803                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1804                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1805                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1806             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1807                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1808                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1809             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1810                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1811                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1812
  1813     12  AM-COMMENTS.
  1814         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1815
  1816     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1817         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1818         16  AM-FLI-BILLING-CODE           PIC X.
  1819         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1820         16  AM-FLI-UNITED-IDENT           PIC X.
  1821         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  34
* EL6311.cbl
  1822             20  AM-FLI-BANK-NO            PIC X(5).
  1823             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1824             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1825             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1826         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1827             20  AM-FLI-AGT                PIC X(9).
  1828             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1829             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1830         16  FILLER                        PIC X(102).
  1831
  1832     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1833         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1834             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1835             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1836             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1837             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1838             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1839         16  FILLER                          PIC X(10).
  1840******************************************************************
  1841*                                copy ERCACNT.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCACNT.                            *
  1846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1847*                            VMOD=2.002                          *
  1848*                                                                *
  1849*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1850*                                                                *
  1851*   FILE TYPE = VSAM,KSDS                                        *
  1852*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1853*                                                                *
  1854*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1855*       ALTERNATE INDEX = NONE                                   *
  1856*                                                                *
  1857*                                                                *
  1858*   LOG = YES                                                    *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860******************************************************************
  1861*                   C H A N G E   L O G
  1862*
  1863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1864*-----------------------------------------------------------------
  1865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1866* EFFECTIVE    NUMBER
  1867*-----------------------------------------------------------------
  1868* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1869*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1870******************************************************************
  1871 01  NOTE-FILE.
  1872     12  NT-FILE-ID                  PIC XX.
  1873         88  VALID-NOTE-ID              VALUE 'NT'.
  1874
  1875     12  NT-CONTROL-PRIMARY.
  1876         16  NT-COMPANY-CD           PIC X.
  1877         16  NT-ACCT-NOTE-KEY.
  1878             18  NT-CARRIER              PIC X.
  1879             18  NT-GROUPING             PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  35
* EL6311.cbl
  1880             18  NT-STATE                PIC XX.
  1881             18  NT-ACCOUNT              PIC X(10).
  1882         16  NT-RECORD-TYPE          PIC X.
  1883              88  ACCT-NOTE          VALUE '1'.
  1884              88  ACCT-BRANCH-LOC    VALUE '2'.
  1885              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1886         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1887
  1888     12  NT-LAST-MAINT-DT            PIC XX.
  1889     12  NT-LAST-MAINT-BY            PIC X(4).
  1890     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1891
  1892*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1893*     SEQUENCE NUMBERS
  1894     12  NT-NOTE-INFORMATION.
  1895         16  NT-NOTE-LINE            PIC X(60).
  1896         16  FILLER                  PIC X(25).
  1897*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1898     12  NT-LOCATION-INFORMATION REDEFINES
  1899                         NT-NOTE-INFORMATION.
  1900         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1901         16  FILLER                  PIC X(25).
  1902* Account special indicator is record type '2', sequence 3
  1903     12  filler REDEFINES NT-NOTE-INFORMATION.
  1904         16  nt-account-special      PIC X.
  1905         16  FILLER                  PIC X(84).
  1906*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1907*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1908*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1909*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1910*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1911*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1912*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1913     12  NT-SHIPPING-INFORMATION REDEFINES
  1914                         NT-NOTE-INFORMATION.
  1915         16  NT-SHIPPING-LINE        PIC X(60).
  1916         16  NT-SHIP-STATE           PIC XX.
  1917         16  NT-SHIP-ZIP             PIC X(10).
  1918         16  FILLER                  PIC X(13).
  1919*****************************************************************
  1920*                                COPY ELCVADS.
  1921******************************************************************
  1922*                                                                *
  1923*                                                                *
  1924*                            ELCVADS.                            *
  1925*                                                                *
  1926*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1927*   ELVADS                  LENGTH = 350                         *
  1928******************************************************************
  1929******************************************************************
  1930*                   C H A N G E   L O G
  1931*
  1932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1933*-----------------------------------------------------------------
  1934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1935* EFFECTIVE    NUMBER
  1936*-----------------------------------------------------------------
  1937* 100111    2011022800001  AJRA  NAPERSOFT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  36
* EL6311.cbl
  1938******************************************************************
  1939
  1940 01  VIRGINIA-DISCLOSURE.
  1941     12  VD-COMPANY-CD              PIC X.
  1942     12  VD-CARRIER                 PIC X.
  1943     12  VD-GROUPING.
  1944         20  VD-GROUPING-PREFIX     PIC XXX.
  1945         20  VD-GROUPING-PRIME      PIC XXX.
  1946     12  VD-STATE                   PIC XX.
  1947     12  VD-ACCOUNT.
  1948         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1949         20  VD-ACCOUNT-PRIME       PIC X(6).
  1950     12  VD-CERT-EFF-DT             PIC XX.
  1951     12  VD-CERT-NO.
  1952         20  VD-CERT-PRIME          PIC X(10).
  1953         20  VD-CERT-SFX            PIC X.
  1954     12  VD-ENTRY-BATCH             PIC X(6).
  1955     12  VD-CSR-ID                  PIC X(4).
  1956     12  VD-NAME.
  1957         20  VD-INSURED-LAST-NAME   PIC X(15).
  1958         20  VD-INSURED-FIRST-NAME.
  1959             24  VD-INSURED-1ST-INIT PIC X.
  1960             24  FILLER             PIC X(9).
  1961         20  VD-INSURED-MIDDLE-INIT PIC X.
  1962     12  VD-JOINT-INSURED.
  1963         20 VD-JOINT-LAST-NAME      PIC X(15).
  1964         20 VD-JOINT-FIRST-NAME.
  1965            24  VD-JOINT-FIRST-INIT PIC X.
  1966            24  FILLER              PIC X(9).
  1967         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1968     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1969     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1970     12  VD-INSURED-CITY-STATE.
  1971         20  VD-INSURED-CITY        PIC X(28).
  1972         20  VD-INSURED-STATE       PIC XX.
  1973     12  VD-INSURED-ZIP-CODE.
  1974         20  VD-INSURED-ZIP-PRIME.
  1975             24  VD-INSURED-ZIP-1   PIC X.
  1976                 88  VD-CANADIAN-POST-CODE
  1977                                       VALUE 'A' THRU 'Z'.
  1978             24  FILLER             PIC X(4).
  1979         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1980     12  VD-BENEFICIARY-NAME        PIC X(30).
  1981     12  VD-ACCOUNT-NAME            PIC X(30).
  1982     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1983     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1984     12  VD-1ST-PMT-DT              PIC XX.
  1985     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1986         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1987         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1988                                             '90' THRU '99'.
  1989     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1990                                    PIC XX.
  1991     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1992     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1993     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1994     12  VD-LF-TERM                 PIC S999   COMP-3.
  1995     12  VD-AH-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  37
* EL6311.cbl
  1996         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1997         88  VD-INVALID-AH             VALUE '  ' '00'
  1998                                             '90' THRU '99'.
  1999     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2000     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2001     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2002     12  VD-AH-TERM                 PIC S999   COMP-3.
  2003     12  VD-LETTER-ID               PIC X(4).
  2004     12  VD-PROC-ID                 PIC X(4).
  2005     12  VD-COMP-ID                 PIC X(3).
  2006     12  VD-CURRENT-DATE            PIC XX.
  2007     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2008     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2009     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  38
* EL6311.cbl
  2011*    COPY ELCDATE.
  2012******************************************************************
  2013*                                                                *
  2014*                                                                *
  2015*                            ELCDATE.                            *
  2016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2017*                            VMOD=2.003
  2018*                                                                *
  2019*                                                                *
  2020*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2021*                 LENGTH = 200                                   *
  2022******************************************************************
  2023
  2024 01  DATE-CONVERSION-DATA.
  2025     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2026     12  DC-OPTION-CODE                PIC X.
  2027         88  BIN-TO-GREG                VALUE ' '.
  2028         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2029         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2030         88  YMD-GREG-TO-BIN            VALUE '3'.
  2031         88  MDY-GREG-TO-BIN            VALUE '4'.
  2032         88  JULIAN-TO-BIN              VALUE '5'.
  2033         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2034         88  FIND-CENTURY               VALUE '7'.
  2035         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2036         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2037         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2038         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2039         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2040         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2041         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2042         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2043         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2044         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2045         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2046         88  BIN-3-TO-GREG              VALUE 'I'.
  2047         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2048         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2049         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2050         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2051         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2052         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2053         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2054         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2055         88  THREE-CHARACTER-BIN
  2056                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2057         88  GREGORIAN-TO-BIN
  2058                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2059         88  BIN-TO-GREGORIAN
  2060                  VALUES ' ' '1' 'I' '8' 'G'.
  2061         88  JULIAN-TO-BINARY
  2062                  VALUES '5' 'C' 'E' 'F'.
  2063     12  DC-ERROR-CODE                 PIC X.
  2064         88  NO-CONVERSION-ERROR        VALUE ' '.
  2065         88  DATE-CONVERSION-ERROR
  2066                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2067         88  DATE-IS-ZERO               VALUE '1'.
  2068         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  39
* EL6311.cbl
  2069         88  DATE-IS-INVALID            VALUE '3'.
  2070         88  DATE1-GREATER-DATE2        VALUE '4'.
  2071         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2072         88  DATE-INVALID-OPTION        VALUE '9'.
  2073         88  INVALID-CENTURY            VALUE 'A'.
  2074         88  ONLY-CENTURY               VALUE 'B'.
  2075         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2076         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2077     12  DC-END-OF-MONTH               PIC X.
  2078         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2079     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2080         88  USE-NORMAL-PROCESS         VALUE ' '.
  2081         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2082         88  ADJUST-UP-100-YRS          VALUE '2'.
  2083     12  FILLER                        PIC X.
  2084     12  DC-CONVERSION-DATES.
  2085         16  DC-BIN-DATE-1             PIC XX.
  2086         16  DC-BIN-DATE-2             PIC XX.
  2087         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2088         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2089                       DC-GREG-DATE-1-EDIT.
  2090             20  DC-EDIT1-MONTH        PIC 99.
  2091             20  SLASH1-1              PIC X.
  2092             20  DC-EDIT1-DAY          PIC 99.
  2093             20  SLASH1-2              PIC X.
  2094             20  DC-EDIT1-YEAR         PIC 99.
  2095         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2096         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2097                     DC-GREG-DATE-2-EDIT.
  2098             20  DC-EDIT2-MONTH        PIC 99.
  2099             20  SLASH2-1              PIC X.
  2100             20  DC-EDIT2-DAY          PIC 99.
  2101             20  SLASH2-2              PIC X.
  2102             20  DC-EDIT2-YEAR         PIC 99.
  2103         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2104         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2105                     DC-GREG-DATE-1-YMD.
  2106             20  DC-YMD-YEAR           PIC 99.
  2107             20  DC-YMD-MONTH          PIC 99.
  2108             20  DC-YMD-DAY            PIC 99.
  2109         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2110         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2111                      DC-GREG-DATE-1-MDY.
  2112             20  DC-MDY-MONTH          PIC 99.
  2113             20  DC-MDY-DAY            PIC 99.
  2114             20  DC-MDY-YEAR           PIC 99.
  2115         16  DC-GREG-DATE-1-ALPHA.
  2116             20  DC-ALPHA-MONTH        PIC X(10).
  2117             20  DC-ALPHA-DAY          PIC 99.
  2118             20  FILLER                PIC XX.
  2119             20  DC-ALPHA-CENTURY.
  2120                 24 DC-ALPHA-CEN-N     PIC 99.
  2121             20  DC-ALPHA-YEAR         PIC 99.
  2122         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2123         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2124         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2125         16  DC-JULIAN-DATE            PIC 9(05).
  2126         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  40
* EL6311.cbl
  2127                                       PIC 9(05).
  2128         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2129             20  DC-JULIAN-YEAR        PIC 99.
  2130             20  DC-JULIAN-DAYS        PIC 999.
  2131         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2132         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2133         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2134     12  DATE-CONVERSION-VARIBLES.
  2135         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2136         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2137             20  FILLER                PIC 9(3).
  2138             20  HOLD-CEN-1-CCYY.
  2139                 24  HOLD-CEN-1-CC     PIC 99.
  2140                 24  HOLD-CEN-1-YY     PIC 99.
  2141             20  HOLD-CEN-1-MO         PIC 99.
  2142             20  HOLD-CEN-1-DA         PIC 99.
  2143         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2144             20  HOLD-CEN-1-R-MO       PIC 99.
  2145             20  HOLD-CEN-1-R-DA       PIC 99.
  2146             20  HOLD-CEN-1-R-CCYY.
  2147                 24  HOLD-CEN-1-R-CC   PIC 99.
  2148                 24  HOLD-CEN-1-R-YY   PIC 99.
  2149             20  FILLER                PIC 9(3).
  2150         16  HOLD-CENTURY-1-X.
  2151             20  FILLER                PIC X(3)  VALUE SPACES.
  2152             20  HOLD-CEN-1-X-CCYY.
  2153                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2154                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2155             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2156             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2157         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2158             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2159             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2160             20  HOLD-CEN-1-R-X-CCYY.
  2161                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2162                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2163             20  FILLER                PIC XXX.
  2164         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2165         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2166         16  DC-JULIAN-DATE-1          PIC 9(07).
  2167         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2168             20  DC-JULIAN-1-CCYY.
  2169                 24  DC-JULIAN-1-CC    PIC 99.
  2170                 24  DC-JULIAN-1-YR    PIC 99.
  2171             20  DC-JULIAN-DA-1        PIC 999.
  2172         16  DC-JULIAN-DATE-2          PIC 9(07).
  2173         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2174             20  DC-JULIAN-2-CCYY.
  2175                 24  DC-JULIAN-2-CC    PIC 99.
  2176                 24  DC-JULIAN-2-YR    PIC 99.
  2177             20  DC-JULIAN-DA-2        PIC 999.
  2178         16  DC-GREG-DATE-A-EDIT.
  2179             20  DC-EDITA-MONTH        PIC 99.
  2180             20  SLASHA-1              PIC X VALUE '/'.
  2181             20  DC-EDITA-DAY          PIC 99.
  2182             20  SLASHA-2              PIC X VALUE '/'.
  2183             20  DC-EDITA-CCYY.
  2184                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  41
* EL6311.cbl
  2185                 24  DC-EDITA-YEAR     PIC 99.
  2186         16  DC-GREG-DATE-B-EDIT.
  2187             20  DC-EDITB-MONTH        PIC 99.
  2188             20  SLASHB-1              PIC X VALUE '/'.
  2189             20  DC-EDITB-DAY          PIC 99.
  2190             20  SLASHB-2              PIC X VALUE '/'.
  2191             20  DC-EDITB-CCYY.
  2192                 24  DC-EDITB-CENT     PIC 99.
  2193                 24  DC-EDITB-YEAR     PIC 99.
  2194         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2195         16  DC-GREG-DATE-CYMD-R REDEFINES
  2196                              DC-GREG-DATE-CYMD.
  2197             20  DC-CYMD-CEN           PIC 99.
  2198             20  DC-CYMD-YEAR          PIC 99.
  2199             20  DC-CYMD-MONTH         PIC 99.
  2200             20  DC-CYMD-DAY           PIC 99.
  2201         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2202         16  DC-GREG-DATE-MDCY-R REDEFINES
  2203                              DC-GREG-DATE-MDCY.
  2204             20  DC-MDCY-MONTH         PIC 99.
  2205             20  DC-MDCY-DAY           PIC 99.
  2206             20  DC-MDCY-CEN           PIC 99.
  2207             20  DC-MDCY-YEAR          PIC 99.
  2208    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2209        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2210    12  DC-EL310-DATE                  PIC X(21).
  2211    12  FILLER                         PIC X(28).
  2212
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  42
* EL6311.cbl
  2214*    COPY ELCLOGOF.
  2215******************************************************************
  2216*                                                                *
  2217*                                                                *
  2218*                            ELCLOGOF.                           *
  2219*                            VMOD=2.001                          *
  2220*                                                                *
  2221*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2222*                                                                *
  2223******************************************************************
  2224 01  CLASIC-LOGOFF.
  2225     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2226     12  LOGOFF-TEXT.
  2227         16  FILLER          PIC X(5)    VALUE SPACES.
  2228         16  LOGOFF-MSG.
  2229             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2230             20  FILLER      PIC X       VALUE SPACES.
  2231             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2232         16  FILLER          PIC X(80)
  2233           VALUE '* YOU ARE NOW LOGGED OFF'.
  2234         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2235         16  FILLER          PIC X       VALUE QUOTE.
  2236         16  LOGOFF-SYS-MSG  PIC X(17)
  2237           VALUE 'S CLAS-IC SYSTEM '.
  2238     12  TEXT-MESSAGES.
  2239         16  UNACCESS-MSG    PIC X(29)
  2240             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2241         16  PGMIDERR-MSG    PIC X(17)
  2242             VALUE 'PROGRAM NOT FOUND'.
  2243
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  43
* EL6311.cbl
  2245*    COPY ELCATTR.
  2246******************************************************************
  2247*                                                                *
  2248*                            ELCATTR.                            *
  2249*                            VMOD=2.001                          *
  2250*                                                                *
  2251*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2252*                                                                *
  2253*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2254*                                                                *
  2255*                   POS 1   P=PROTECTED                          *
  2256*                           U=UNPROTECTED                        *
  2257*                           S=ASKIP                              *
  2258*                   POS 2   A=ALPHA/NUMERIC                      *
  2259*                           N=NUMERIC                            *
  2260*                   POS 3   N=NORMAL                             *
  2261*                           B=BRIGHT                             *
  2262*                           D=DARK                               *
  2263*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2264*                           OF=MODIFIED DATA TAG OFF             *
  2265*                                                                *
  2266*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2267******************************************************************
  2268 01  ATTRIBUTE-LIST.
  2269     12  AL-PABOF            PIC X       VALUE 'Y'.
  2270     12  AL-PABON            PIC X       VALUE 'Z'.
  2271     12  AL-PADOF            PIC X       VALUE '%'.
  2272     12  AL-PADON            PIC X       VALUE '_'.
  2273     12  AL-PANOF            PIC X       VALUE '-'.
  2274     12  AL-PANON            PIC X       VALUE '/'.
  2275     12  AL-SABOF            PIC X       VALUE '8'.
  2276     12  AL-SABON            PIC X       VALUE '9'.
  2277     12  AL-SADOF            PIC X       VALUE '@'.
  2278     12  AL-SADON            PIC X       VALUE QUOTE.
  2279     12  AL-SANOF            PIC X       VALUE '0'.
  2280     12  AL-SANON            PIC X       VALUE '1'.
  2281     12  AL-UABOF            PIC X       VALUE 'H'.
  2282     12  AL-UABON            PIC X       VALUE 'I'.
  2283     12  AL-UADOF            PIC X       VALUE '<'.
  2284     12  AL-UADON            PIC X       VALUE '('.
  2285     12  AL-UANOF            PIC X       VALUE ' '.
  2286     12  AL-UANON            PIC X       VALUE 'A'.
  2287     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2288     12  AL-UNBON            PIC X       VALUE 'R'.
  2289     12  AL-UNDOF            PIC X       VALUE '*'.
  2290     12  AL-UNDON            PIC X       VALUE ')'.
  2291     12  AL-UNNOF            PIC X       VALUE '&'.
  2292     12  AL-UNNON            PIC X       VALUE 'J'.
  2293
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  44
* EL6311.cbl
  2295*    COPY ELCEMIB.
  2296******************************************************************
  2297*                                                                *
  2298*                                                                *
  2299*                            ELCEMIB.                            *
  2300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2301*                            VMOD=2.005                          *
  2302*                                                                *
  2303*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2304*                                                                *
  2305******************************************************************
  2306 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2307     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2308     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2309     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2310     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2311     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2312     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2313     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2314     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2315     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2316         88  EMI-NO-ERRORS                    VALUE '1'.
  2317         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2318         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2319     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2320         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2321     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2322         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2323         88  EMI-AREA1-FULL                   VALUE '2'.
  2324     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2325         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2326         88  EMI-AREA2-FULL                   VALUE '2'.
  2327     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2328         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2329         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2330         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2331         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2332         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2333     12  EMI-ERROR-LINES.
  2334         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2335         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2336         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2337         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2338             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2339                 24  EMI-ERR-NUM         PIC X(4).
  2340                 24  EMI-FILLER          PIC X.
  2341                 24  EMI-SEV             PIC X.
  2342                 24  FILLER              PIC X.
  2343             20  FILLER                  PIC X(02).
  2344     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2345         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2346             20  EMI-ERROR-NUMBER    PIC X(4).
  2347             20  EMI-FILL            PIC X.
  2348             20  EMI-SEVERITY        PIC X.
  2349             20  FILLER              PIC X.
  2350             20  EMI-ERROR-TEXT.
  2351                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2352                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  45
* EL6311.cbl
  2353     12  EMI-SEVERITY-SAVE           PIC X.
  2354         88  EMI-NOTE                    VALUE 'N'.
  2355         88  EMI-WARNING                 VALUE 'W'.
  2356         88  EMI-FORCABLE                VALUE 'F'.
  2357         88  EMI-FATAL                   VALUE 'X'.
  2358     12  EMI-MESSAGE-FLAG            PIC X.
  2359         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2360         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2361     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2362     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2363         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2364         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2365         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2366     12  emi-claim-no                pic x(7).
  2367     12  emi-claim-type              pic x(6).
  2368     12  FILLER                      PIC X(124)  VALUE SPACES.
  2369     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2370     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2371     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2372     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2373
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  46
* EL6311.cbl
  2375*    COPY ELCINTF.
  2376******************************************************************
  2377*                                                                *
  2378*                                                                *
  2379*                            ELCINTF.                            *
  2380*                            VMOD=2.017                          *
  2381*                                                                *
  2382*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2383*                                                                *
  2384*       LENGTH = 1024                                            *
  2385*                                                                *
  2386******************************************************************
  2387*                   C H A N G E   L O G
  2388*
  2389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2390*-----------------------------------------------------------------
  2391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2392* EFFECTIVE    NUMBER
  2393*-----------------------------------------------------------------
  2394* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2395******************************************************************
  2396 01  PROGRAM-INTERFACE-BLOCK.
  2397     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2398     12  PI-CALLING-PROGRAM              PIC X(8).
  2399     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2400     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2401     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2402     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2403     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2404     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2405     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2406     12  PI-COMPANY-ID                   PIC XXX.
  2407     12  PI-COMPANY-CD                   PIC X.
  2408
  2409     12  PI-COMPANY-PASSWORD             PIC X(8).
  2410
  2411     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2412
  2413     12  PI-CONTROL-IN-PROGRESS.
  2414         16  PI-CARRIER                  PIC X.
  2415         16  PI-GROUPING                 PIC X(6).
  2416         16  PI-STATE                    PIC XX.
  2417         16  PI-ACCOUNT                  PIC X(10).
  2418         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2419                                         PIC X(10).
  2420         16  PI-CLAIM-CERT-GRP.
  2421             20  PI-CLAIM-NO             PIC X(7).
  2422             20  PI-CERT-NO.
  2423                 25  PI-CERT-PRIME       PIC X(10).
  2424                 25  PI-CERT-SFX         PIC X.
  2425             20  PI-CERT-EFF-DT          PIC XX.
  2426         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2427             20  PI-PLAN-CODE            PIC X(2).
  2428             20  PI-REVISION-NUMBER      PIC X(3).
  2429             20  PI-PLAN-EFF-DT          PIC X(2).
  2430             20  PI-PLAN-EXP-DT          PIC X(2).
  2431             20  FILLER                  PIC X(11).
  2432         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  47
* EL6311.cbl
  2433             20  PI-OE-REFERENCE-1.
  2434                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2435                 25  PI-OE-REF-1-SUFF    PIC XX.
  2436
  2437     12  PI-SESSION-IN-PROGRESS          PIC X.
  2438         88  CLAIM-SESSION                   VALUE '1'.
  2439         88  CREDIT-SESSION                  VALUE '2'.
  2440         88  WARRANTY-SESSION                VALUE '3'.
  2441         88  MORTGAGE-SESSION                VALUE '4'.
  2442         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2443
  2444
  2445*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2446
  2447     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2448     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2449
  2450     12  PI-CREDIT-USER                  PIC X.
  2451         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2452         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2453
  2454     12  PI-CLAIM-USER                   PIC X.
  2455         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2456         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2457
  2458     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2459         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2460         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2461         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2462         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2463         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2464
  2465     12  PI-PROCESSOR-ID                 PIC X(4).
  2466
  2467     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2468
  2469     12  PI-MEMBER-CAPTION               PIC X(10).
  2470
  2471     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2472         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2473
  2474     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2475     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2476     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2477     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2478
  2479     12  PI-AH-OVERRIDE-L1               PIC X.
  2480     12  PI-AH-OVERRIDE-L2               PIC XX.
  2481     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2482     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2483
  2484     12  PI-NEW-SYSTEM                   PIC X(2).
  2485
  2486     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2487     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2488         88  PI-USES-PAID-TO                 VALUE '1'.
  2489     12  PI-CRDTCRD-SYSTEM.
  2490         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  48
* EL6311.cbl
  2491             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2492             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2493         16  PI-CC-MONTH-END-DT          PIC XX.
  2494     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2495
  2496     12  PI-OE-REFERENCE-2.
  2497         16  PI-OE-REF-2-PRIME           PIC X(10).
  2498         16  PI-OE-REF-2-SUFF            PIC X.
  2499
  2500     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2501
  2502     12  PI-LANGUAGE-TYPE                PIC X.
  2503             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2504             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2505             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2506
  2507     12  PI-POLICY-LINKAGE-IND           PIC X.
  2508         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2509         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2510                                                   LOW-VALUES.
  2511
  2512     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2513     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2514         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2515         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2516
  2517     12  PI-PROCESSOR-CSR-IND            PIC X.
  2518         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2519         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2520
  2521     12  FILLER                          PIC X(3).
  2522
  2523     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2524
  2525     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2526         PI-SYSTEM-LEVEL.
  2527
  2528         16  PI-ENTRY-CODES.
  2529             20  PI-ENTRY-CD-1           PIC X.
  2530             20  PI-ENTRY-CD-2           PIC X.
  2531
  2532         16  PI-RETURN-CODES.
  2533             20  PI-RETURN-CD-1          PIC X.
  2534             20  PI-RETURN-CD-2          PIC X.
  2535
  2536         16  PI-UPDATE-STATUS-SAVE.
  2537             20  PI-UPDATE-BY            PIC X(4).
  2538             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2539
  2540         16  PI-LOWER-CASE-LETTERS       PIC X.
  2541             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2542
  2543*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2544*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2545*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2546
  2547         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2548             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  49
* EL6311.cbl
  2549             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2550             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2551             88  ACCNT-CNTL                  VALUE '3'.
  2552             88  CARR-ACCNT-CNTL             VALUE '4'.
  2553
  2554         16  PI-PROCESSOR-CAP-LIST.
  2555             20  PI-SYSTEM-CONTROLS.
  2556                24 PI-SYSTEM-DISPLAY     PIC X.
  2557                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2558                24 PI-SYSTEM-MODIFY      PIC X.
  2559                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2560             20  FILLER                  PIC XX.
  2561             20  PI-DISPLAY-CAP          PIC X.
  2562                 88  DISPLAY-CAP             VALUE 'Y'.
  2563             20  PI-MODIFY-CAP           PIC X.
  2564                 88  MODIFY-CAP              VALUE 'Y'.
  2565             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2566                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2567             20  PI-FORCE-CAP            PIC X.
  2568                 88  FORCE-CAP               VALUE 'Y'.
  2569
  2570         16  PI-PROGRAM-CONTROLS.
  2571             20  PI-PGM-PRINT-OPT        PIC X.
  2572             20  PI-PGM-FORMAT-OPT       PIC X.
  2573             20  PI-PGM-PROCESS-OPT      PIC X.
  2574             20  PI-PGM-TOTALS-OPT       PIC X.
  2575
  2576         16  PI-HELP-INTERFACE.
  2577             20  PI-LAST-ERROR-NO        PIC X(4).
  2578             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2579
  2580         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2581             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2582
  2583         16  PI-CR-CONTROL-IN-PROGRESS.
  2584             20  PI-CR-CARRIER           PIC X.
  2585             20  PI-CR-GROUPING          PIC X(6).
  2586             20  PI-CR-STATE             PIC XX.
  2587             20  PI-CR-ACCOUNT           PIC X(10).
  2588             20  PI-CR-FIN-RESP          PIC X(10).
  2589             20  PI-CR-TYPE              PIC X.
  2590
  2591         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2592
  2593         16  PI-CR-MONTH-END-DT          PIC XX.
  2594
  2595         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2596             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2597             88  PI-ZERO-CARRIER             VALUE '1'.
  2598             88  PI-ZERO-GROUPING            VALUE '2'.
  2599             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2600
  2601         16  PI-CARRIER-SECURITY         PIC X.
  2602             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2603
  2604         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2605             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2606             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  50
* EL6311.cbl
  2607
  2608         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2609             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2610                                         INDEXED BY PI-ACCESS-NDX
  2611                                         PIC X.
  2612
  2613         16  PI-GA-BILLING-CONTROL       PIC X.
  2614             88  PI-GA-BILLING               VALUE '1'.
  2615
  2616         16  PI-MAIL-PROCESSING          PIC X.
  2617             88  PI-MAIL-YES                 VALUE 'Y'.
  2618
  2619         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2620
  2621         16  PI-AR-SYSTEM.
  2622             20  PI-AR-PROCESSING-CNTL   PIC X.
  2623                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2624             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2625             20  PI-AR-MONTH-END-DT      PIC XX.
  2626
  2627         16  PI-MP-SYSTEM.
  2628             20  PI-MORTGAGE-USER            PIC X.
  2629                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2630                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2631             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2632                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2633                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2634                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2635                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2636                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2637             20  PI-MP-MONTH-END-DT          PIC XX.
  2638             20  PI-MP-REFERENCE-NO.
  2639                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2640                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2641
  2642         16  PI-LABEL-CONTROL            PIC X(01).
  2643             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2644             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2645
  2646         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2647             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2648
  2649         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2650             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2651             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2652
  2653         16  FILLER                      PIC X(14).
  2654
  2655     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2656******************************************************************
  2657
  2658     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2659*    COPY ELC631PI.
  2660******************************************************************
  2661*                                                                *
  2662*                                                                *
  2663*                            ELC631PI                            *
  2664*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  51
* EL6311.cbl
  2665*                                                                *
  2666*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2667*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2668*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2669*                                                                *
  2670*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2671*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2672*    BETWEEN PROGRAMS.                                           *
  2673*                                                                *
  2674*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2675*                                                                *
  2676*               EL631 - EL6311 - EL6312 - EL6313                 *
  2677*                                                                *
  2678******************************************************************
  2679*                   C H A N G E   L O G
  2680*
  2681* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2682*-----------------------------------------------------------------
  2683*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2684* EFFECTIVE    NUMBER
  2685*-----------------------------------------------------------------
  2686* 021414    2003053000001  PEMA  changes for auto chk request
  2687******************************************************************
  2688
  2689         16  PI-631-DATA.
  2690             20  PI-ERPNDB-KEY.
  2691                 24  PI-PB-COMPANY-CD     PIC X.
  2692                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2693                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2694                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2695
  2696             20  PI-ERPNDB-ALT-KEY.
  2697                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2698                 24  PI-PB-CARRIER        PIC X.
  2699                 24  PI-PB-GROUPING       PIC X(6).
  2700                 24  PI-PB-STATE          PIC XX.
  2701                 24  PI-PB-ACCOUNT        PIC X(10).
  2702                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2703                 24  PI-PB-CERT-NO.
  2704                     28  PI-PB-CERT-PRIME PIC X(10).
  2705                     28  PI-PB-CERT-SFX   PIC X.
  2706                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2707                 24  PI-PB-RECORD-TYPE    PIC X.
  2708
  2709             20  PI-ERPNDB-CSR-KEY.
  2710                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2711                 24  PI-PB-CSR-ID             PIC X(4).
  2712                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2713                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2714                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2715
  2716             20  PI-BROWSE-TYPE               PIC X.
  2717                 88  PI-FILE-BROWSE             VALUE ' '.
  2718                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2719                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2720                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2721                 88  PI-CSR-BROWSE              VALUE '4'.
  2722
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  52
* EL6311.cbl
  2723             20  PI-MAINT-FUNCTION            PIC X.
  2724                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2725                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2726                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2727                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2728                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2729                 88  PI-PF5-FUNCTION            VALUE '5'.
  2730                 88  PI-PF6-FUNCTION            VALUE '6'.
  2731
  2732             20  PI-FILE-SWITCHES.
  2733                 24  PI-ALL-ISSUES-SW         PIC X.
  2734                     88  ALL-ISSUES             VALUE 'Y'.
  2735                 24  PI-ALL-CANCELS-SW        PIC X.
  2736                     88  ALL-CANCELS            VALUE 'Y'.
  2737                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2738                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2739                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2740                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2741                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2742                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2743                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2744                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2745                 24  PI-HOLD-REC-SW           PIC X.
  2746                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2747                 24  PI-CHANGE-REC-SW         PIC X.
  2748                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2749                 24  PI-CHK-REQ-REC-SW        PIC X.
  2750                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2751                 24  PI-ISSUE-WARNING-SW      PIC X.
  2752                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2753                 24  PI-CANCEL-WARNING-SW     PIC X.
  2754                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2755             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2756                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2757             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2758                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2759
  2760             20  PI-MAP-NAME                  PIC X(8).
  2761
  2762             20  PI-CURSOR                    PIC S9(4) COMP.
  2763
  2764             20  PI-PREV-ALT-KEY              PIC X(36).
  2765             20  PI-PREV-CSR-KEY              PIC X(15).
  2766             20  PI-PREV-KEY.
  2767                 24  PI-PREV-COMPANY-CD       PIC X.
  2768                 24  PI-PREV-BATCH            PIC X(6).
  2769                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2770                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2771             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2772             20  PI-BROWSE-SW                 PIC X.
  2773                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2774                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2775             20  PI-SV-CARRIER                PIC X.
  2776             20  PI-SV-GROUPING               PIC X(6).
  2777             20  PI-SV-STATE                  PIC XX.
  2778             20  PI-EDIT-SW                   PIC X.
  2779             20  PI-DISPLAY-SW                PIC XX.
  2780                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  53
* EL6311.cbl
  2781                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2782             20  PI-CRITERIA-DATA             PIC X(350).
  2783             20  PI-BMODE                     PIC X.
  2784             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2785             20  PI-BPMTS                     PIC S999     COMP-3.
  2786             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2787             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2788             20  PI-CSR-SESSION-SW            PIC X.
  2789                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2790             20  PI-ERRORS-SW                 PIC X.
  2791                 88  FATAL-ERRORS               VALUE 'X'.
  2792*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2793             20  pi-unforced-sw               pic x.
  2794                 88  unforced-errors            value 'X'.
  2795             20  FILLER                       PIC X(4).
  2796
  2797        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2798        16  FILLER             PIC X(92).
  2799
  2800 01  W-LETTER-COMMUNICATION-AREAS.
  2801*    COPY ELC1042.
  2802******************************************************************
  2803*                                                                *
  2804*                                                                *
  2805*                           ELC1042                              *
  2806*                            VMOD=2.002                          *
  2807*                                                                *
  2808*    NOTE                                                        *
  2809*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2810*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2811*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2812*        TO THESE PROGRAMS.                                      *
  2813*                                                                *
  2814*    NOTE                                                        *
  2815*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2816*        USE ONLY!                                               *
  2817*                                                                *
  2818******************************************************************
  2819
  2820         16  PI-1042-WA.
  2821             20  PI-ACTION       PIC  X(01).
  2822                 88 PI-SHOW-MODE           VALUE '1'.
  2823                 88 PI-CLEAR-MODE          VALUE '2'.
  2824                 88 PI-CREATE-MODE         VALUE '3'.
  2825             20  PI-COMM-CONTROL PIC  X(12).
  2826             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2827             20  PI-EOF-SW       PIC  X(01).
  2828                 88  PI-FILE-EOF           VALUE 'Y'.
  2829             20  PI-FILETYP      PIC  X(01).
  2830             20  PI-FORM-SQUEEZE-CONTROL
  2831                                 PIC  X(01).
  2832                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2833                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2834             20  PI-LAST-CONTROL PIC  X(12).
  2835             20  PI-TEMP-STOR-ITEMS
  2836                                 PIC S9(04) COMP.
  2837             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2838             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  54
* EL6311.cbl
  2839                 88 ANY-UPDATES            VALUE 1.
  2840             20  PI-104-SCREEN-SENT-IND
  2841                                 PIC  X(01).
  2842                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2843                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2844             20  PI-1042-SCREEN-SENT-IND
  2845                                 PIC  X(01).
  2846                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2847                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2848             20  PI-1042-ARCHIVE-IND
  2849                                 PIC  X(01).
  2850                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2851             20  FILLER          PIC  X(29).
  2852*    COPY ELC689PI.
  2853******************************************************************
  2854*                                                                *
  2855*                            ELC689PI                            *
  2856*                            VMOD=2.003                          *
  2857*                                                                *
  2858*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2859*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2860*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2861*                                                                *
  2862*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2863*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2864*    BETWEEN PROGRAMS.                                           *
  2865*                                                                *
  2866*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2867*                                                                *
  2868*               EL631 - EL689  - EL6891 - EL6892                 *
  2869*                                                                *
  2870******************************************************************
  2871*                   C H A N G E   L O G
  2872*
  2873* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2874*-----------------------------------------------------------------
  2875*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2876* EFFECTIVE    NUMBER
  2877*-----------------------------------------------------------------
  2878* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2879* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2880* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2881******************************************************************
  2882
  2883
  2884         16  PI-689-WORK-AREA.
  2885             20  PI-689-ALT-PRINTER-ID
  2886                                 PIC  X(04).
  2887             20  PI-689-ARCHIVE-NUMBER
  2888                                 PIC  9(08).
  2889             20  PI-689-ARCHIVE-SW
  2890                                 PIC  X(01).
  2891                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2892             20  PI-689-DATA-SOURCE
  2893                                 PIC  X(01).
  2894                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2895                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2896                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  55
* EL6311.cbl
  2897                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2898                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2899             20  PI-689-ERROR-IND
  2900                                 PIC  X(01).
  2901                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2902             20  PI-689-ERROR    PIC  9(04).
  2903                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2904                 88  PI-689-FATAL-ERROR
  2905                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2906                            0042 0047 0051 0066 0067 0070
  2907                            0168 0169 0174 0175 0176 0177 0179
  2908                            0180 0181 0182 0184 0185 0189 0190
  2909                            0191
  2910                            0215 0279 0280
  2911                            0412 0413 0454
  2912                            0533 0537
  2913                            2055 2114 2208 2209 2216 2232 2369
  2914                            2398 2433 2908 2999
  2915                            3000 3770 3771 3775
  2916                            7250 7365 7367 7368 7369 7370 7371
  2917                            7272 7373 7374 7376 7377 7378 7379
  2918                            7381 7388 7390 7393 7395 7396 7398
  2919                            9095 9096 9281 9298 9299 9320 9327
  2920                            9426 9427.
  2921                 88  PI-689-STOP-ERROR
  2922                     VALUES 0004 0008 0013 0023 0029 0033
  2923                            0042 0047 0066 0067 0070
  2924                            0168 0169 0174 0175 0176 0177
  2925                            0181 0182 0184 0185 0189 0190
  2926                            0279 0280
  2927                            0412 0413 0454
  2928                            2055 2208 2209 2216 2232
  2929                            2398 2999
  2930                            3000 3770 3771 3775
  2931                            7250 7365 7369 7370 7371
  2932                            7272 7373 7374 7376 7377 7378 7379
  2933                            7381 7388 7390 7393 7396 7398
  2934                            9095 9096 9299 9320 9426.
  2935             20  PI-689-FOLLOW-UP-DATE
  2936                                 PIC  X(02).
  2937             20  PI-689-FORM-NUMBER
  2938                                 PIC  X(04).
  2939             20  PI-689-LABEL-SOURCE
  2940                                 PIC X(01).
  2941                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2942                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2943                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2944                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2945                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2946                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2947                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2948             20  PI-689-NUMBER-COPIES
  2949                                 PIC  9(01).
  2950             20  PI-689-NUMBER-LABEL-LINES
  2951                                 PIC  9(01).
  2952             20  PI-689-NUMBER-TEXT-RECORDS
  2953                                 PIC  9(03).
  2954             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  56
* EL6311.cbl
  2955                                 PIC  X(01).
  2956                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2957                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2958                 88  PI-689-PRINT-LATER     VALUE '3'.
  2959                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2960             20  PI-689-PRINT-RESTRICTION
  2961                                 PIC  X(01).
  2962                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2963                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2964                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2965             20  PI-689-PRINT-SW PIC  X(01).
  2966                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2967             20  PI-689-RESEND-DATE-1
  2968                                 PIC  X(02).
  2969             20  PI-689-RESEND-LETR-1
  2970                                 PIC X(4).
  2971             20  PI-689-TEMP-STOR-ID
  2972                                 PIC  X(08).
  2973             20  PI-689-USE-SCREEN-IND
  2974                                 PIC  X(01).
  2975                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2976             20  PI-689-ARCH-POINTER
  2977                                 PIC S9(08) COMP.
  2978                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2979             20  PI-689-ARCT-POINTER
  2980                                 PIC S9(08) COMP.
  2981                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2982             20  PI-689-VARIABLE-DATA-GRP.
  2983                 24  PI-689-VARIABLE-DATA-1
  2984                                 PIC  X(30).
  2985                 24  PI-689-VARIABLE-DATA-2
  2986                                 PIC  X(30).
  2987                 24  PI-689-VARIABLE-DATA-3
  2988                                 PIC  X(30).
  2989                 24  PI-689-VARIABLE-DATA-4
  2990                                 PIC  X(30).
  2991
  2992         16  PI-689-KEY-DATA-FIELDS.
  2993             20  PI-689-ACCOUNT  PIC  X(10).
  2994             20  PI-689-CARRIER  PIC  X(01).
  2995             20  PI-689-CERT-NO.
  2996                 24  PI-689-CERT-PRIME
  2997                                 PIC  X(10).
  2998                 24  PI-689-CERT-SFX
  2999                                 PIC  X(01).
  3000             20  PI-689-CHG-SEQ-NO
  3001                                 PIC S9(04)    COMP.
  3002             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3003                                 PIC  X(02).
  3004             20  PI-689-ENTRY-BATCH
  3005                                 PIC  X(06).
  3006             20  PI-689-EFF-DATE PIC  X(02).
  3007             20  PI-689-EXP-DATE PIC  X(02).
  3008             20  PI-689-GROUPING PIC  X(06).
  3009             20  PI-689-RESP-PERSON
  3010                                 PIC  X(10).
  3011             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3012             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  57
* EL6311.cbl
  3013                                 PIC  X(04).
  3014             20  PI-689-STATE    PIC  X(02).
  3015             20  PI-689-TYPE     PIC  X(01).
  3016             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3017             20  PI-689-ALT-SEQ-NO
  3018                                 PIC S9(04)    COMP.
  3019         16  PI-689-DATE-EDIT    PIC  X(08).
  3020         16  PI-689-FOLLOW-UP-EDIT
  3021                                 PIC  X(08).
  3022         16  PI-689-RESEND1-EDIT PIC  X(08).
  3023         16  PI-689-SEQ-EDIT     PIC  X(08).
  3024         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3025         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3026             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3027         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3028         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  58
* EL6311.cbl
  3030
  3031 01  WS-EL6315-PASS-AREA.
  3032        16  PI-6315-ISS-CAN-SW      PIC X.
  3033        16  FILLER                  PIC X(120).
  3034        16  PI-RES-REF-CLM-TYPE     PIC X.
  3035        16  FILLER                  PIC X.
  3036        16  PI-6315-PASS-AREA.
  3037            20 FILLER               PIC X(236).
  3038            20 PI-6315-FINALIZED    PIC X.
  3039            20 FILLER               PIC X(280).
  3040
  3041 01  WS-EL6316-PASS-AREA.
  3042        16  PI-ISS-CAN-SW           PIC X.
  3043        16  FILLER                  PIC X(121).
  3044        16  PI-CLM-RESC-IND         PIC X.
  3045        16  PI-6316-PASS-AREA.
  3046            20 FILLER               PIC X(236).
  3047            20 PI-6316-FINALIZED    PIC X.
  3048            20 FILLER               PIC X(280).
  3049
  3050******************************************************************
  3051*                                                                *
  3052*         P A S S   A R E A   F O R   E D I T                    *
  3053*                                                                *
  3054******************************************************************
  3055
  3056 01  PASSED-RECORD.
  3057     12  RECORD-SAVE                  PIC X(585).
  3058* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3059*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3060*                    BY  WK-CURRENT-DATE.
  3061******************************************************************
  3062*                                                                *
  3063*                                                                *
  3064*                             ELC50W1                            *
  3065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3066*                            VMOD=2.004                          *
  3067*                                                                *
  3068*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3069*                                                                *
  3070*                                                                *
  3071******************************************************************
  3072
  3073     12  WK-WORK-AREA.
  3074         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3075         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3076         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3077         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3078         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3079         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3080         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3081         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3082         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3083         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3084         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3085         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3086         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3087         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  59
* EL6311.cbl
  3088         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3089         16  WK-CREDIT-EDIT-CONTROLS.
  3090             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3091             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3092             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3093             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3094             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3095             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3096         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3097         16  WK-SAVE-REIN-DATA.
  3098             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3099             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3100             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3101         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3102             88  ENTRY-FROM-EL6311       VALUE '6'.
  3103         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3104         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3105     12  WK-RECORD-ADDRESSES.
  3106         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3107         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3108         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3109         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3110         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3111         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3112         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3113         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3114     12  WK-OVER-SHORT-AREA.
  3115         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3116         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3117         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3118             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3119         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  60
* EL6311.cbl
  3121
  3122*    COPY ELCEDITC.
  3123******************************************************************
  3124*                                                                *
  3125*                                                                *
  3126*                            ELCEDITC                            *
  3127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3128*                            VMOD=2.012                          *
  3129*                                                                *
  3130*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3131*                     EL6313, EL050 AND EL517.                   *
  3132*                                                                *
  3133******************************************************************
  3134******************************************************************
  3135*                   C H A N G E   L O G
  3136*
  3137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3138*-----------------------------------------------------------------
  3139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3140* EFFECTIVE    NUMBER
  3141*-----------------------------------------------------------------
  3142* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3143******************************************************************
  3144
  3145     12  EDIT-CRITERIA-DATA.
  3146         16  EC-CO-MONTH-END-DT       PIC XX.
  3147         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3148         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3149         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3150         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3151         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3152         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3153         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3154         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3155         16  EC-CO-REM-TERM-CALC      PIC X.
  3156               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3157               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3158               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3159               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3160
  3161         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3162               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3163               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3164               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3165               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3166               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3167               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3168               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3169               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3170               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3171               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3172
  3173         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3174               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3175               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3176               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3177               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3178               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  61
* EL6311.cbl
  3179               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3180               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3181               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3182
  3183         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3184                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3185                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3186
  3187         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3188                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3189                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3190                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3191                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3192                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3193                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3194                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3195                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3196
  3197         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3198               88  EC-BR-REDUCING                   VALUE 'R'.
  3199               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3200
  3201         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3202         16  EC-BR-LF-DESC             PIC X(10).
  3203         16  EC-BR-AH-DESC             PIC X(10).
  3204         16  EC-BR-LF-COMMENT          PIC X(10).
  3205         16  EC-BR-AH-COMMENT          PIC X(10).
  3206
  3207         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3208               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3209               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3210               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3211               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3212
  3213         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3214               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3215               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3216               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3217               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3218
  3219         16  EC-BR-LF-REFUND-CALC      PIC X.
  3220                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3221                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3222                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3223                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3224                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3225                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3226                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3227
  3228         16  EC-BR-AH-REFUND-CALC      PIC X.
  3229                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3230                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3231                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3232                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3233                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3234                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3235                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3236                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  62
* EL6311.cbl
  3237
  3238         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3239                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3240                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3241                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3242
  3243         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3244                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3245                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3246                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3247
  3248         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3249         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3250         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3251         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3252
  3253         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3254         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3255                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3256                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3257                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3258                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3259
  3260         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3261               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3262               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3263               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3264               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3265               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3266
  3267         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3268               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3269               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3270               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3271               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3272               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3273
  3274         16  EC-ST-LF-REFUND-CALC      PIC X.
  3275                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3276                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3277                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3278                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3279                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3280                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3281                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3282                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3283
  3284         16  EC-ST-AH-REFUND-CALC      PIC X.
  3285                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3286                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3287                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3288                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3289                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3290                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3291                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3292                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3293
  3294         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  63
* EL6311.cbl
  3295         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3296         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3297         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3298         16  EC-AM-EXPIRATION-DT       PIC XX.
  3299         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3300         16  EC-AM-CLASS-CD            PIC XX.
  3301         16  EC-AM-LF-DEVIATION        PIC XXX.
  3302         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3303         16  EC-AM-AH-DEVIATION        PIC XXX.
  3304         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3305         16  EC-AM-PHONE-NO            PIC X(10).
  3306
  3307         16  EC-AM-LF-REFUND-CALC      PIC X.
  3308                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3309                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3310                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3311                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3312                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3313                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3314                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3315
  3316         16  EC-AM-AH-REFUND-CALC      PIC X.
  3317                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3318                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3319                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3320                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3321                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3322                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3323                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3324
  3325         16  EC-AM-BEN-I-G-CD          PIC X.
  3326                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3327                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3328                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3329
  3330         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3331         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3332         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3333         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3334         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3335         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3336         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3337         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3338         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3339
  3340         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3341         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3342         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3343         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3344         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3345         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3346         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3347         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3348         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3349         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3350         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3351         16  EC-RT-LF-NSP-ST           PIC XX.
  3352         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  64
* EL6311.cbl
  3353         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3354         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3355
  3356         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3357             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3358                                             'M' '5' '9' '2'.
  3359             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3360             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3361             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3362             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3363             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3364             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3365             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3366             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3367             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3368             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3369
  3370         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3371             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3372                                             'M' '5' '9' '2'.
  3373             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3374             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3375             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3376             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3377             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3378             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3379             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3380             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3381             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3382             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3383
  3384         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3385         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3386         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3387         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3388         16  EC-CM-DEATH-DT            PIC XX.
  3389
  3390*DMD CUSTOM CODING FIELDS BELOW
  3391*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3392         16  EC-BR-DMD-RATING-SW       PIC X.
  3393                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3394                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3395                 88  NO-DMD-RATING               VALUE 'N'.
  3396
  3397         16  EC-NEW-CERT               PIC X(11).
  3398         16  EC-NEW-STATE              PIC XX.
  3399         16  FILLER                    PIC X.
  3400*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3401         16  OVER-SHORT-EDIT-FIELDS.
  3402             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3403             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3404             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3405             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3406             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3407             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3408             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3409             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3410             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  65
* EL6311.cbl
  3411         16  FILLER                    PIC X(71).
  3412
  3413******************************************************************
  3414
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  66
* EL6311.cbl
  3416
  3417*    COPY ELCJPFX.
  3418******************************************************************
  3419*                                                                *
  3420*                                                                *
  3421*                            ELCJPFX.                            *
  3422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3423*                            VMOD=2.002                          *
  3424*                                                                *
  3425*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3426*                                                                *
  3427*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3428*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3429*        ELCNTL - CONTROL FILE                                   *
  3430*        ELMSTR - CLAIM MASTERS                                  *
  3431*        ELTRLR - ACTIVITY TRAILERS                              *
  3432*        ELCHKQ - CHECK QUE                                      *
  3433******************************************************************
  3434 01  JOURNAL-RECORD.
  3435     12  jp-date                     pic s9(5) comp-3.
  3436     12  jp-time                     pic s9(7) comp-3.
  3437     12  JP-USER-ID                  PIC X(4).
  3438     12  JP-FILE-ID                  PIC X(8).
  3439     12  JP-PROGRAM-ID               PIC X(8).
  3440     12  JP-RECORD-TYPE              PIC X.
  3441         88 JP-ADD              VALUE 'A'.
  3442         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3443         88 JP-AFTER-CHANGE     VALUE 'C'.
  3444         88 JP-DELETE           VALUE 'D'.
  3445         88 JP-GENERIC-DELETE   VALUE 'G'.
  3446         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3447         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3448     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3449     12  JP-RECORD-AREA
  3450
  3451
  3452                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  67
* EL6311.cbl
  3454*    COPY ELCAID.
  3455******************************************************************
  3456*                                                                *
  3457*                            ELCAID.                             *
  3458*                            VMOD=2.001                          *
  3459*                                                                *
  3460*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3461*                                                                *
  3462*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3463*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3464******************************************************************
  3465
  3466 01  DFHAID.
  3467   02  DFHNULL   PIC  X  VALUE  ' '.
  3468   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3469   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3470   02  DFHPEN    PIC  X  VALUE  '='.
  3471   02  DFHOPID   PIC  X  VALUE  'W'.
  3472   02  DFHPA1    PIC  X  VALUE  '%'.
  3473   02  DFHPA2    PIC  X  VALUE  '>'.
  3474   02  DFHPA3    PIC  X  VALUE  ','.
  3475   02  DFHPF1    PIC  X  VALUE  '1'.
  3476   02  DFHPF2    PIC  X  VALUE  '2'.
  3477   02  DFHPF3    PIC  X  VALUE  '3'.
  3478   02  DFHPF4    PIC  X  VALUE  '4'.
  3479   02  DFHPF5    PIC  X  VALUE  '5'.
  3480   02  DFHPF6    PIC  X  VALUE  '6'.
  3481   02  DFHPF7    PIC  X  VALUE  '7'.
  3482   02  DFHPF8    PIC  X  VALUE  '8'.
  3483   02  DFHPF9    PIC  X  VALUE  '9'.
  3484   02  DFHPF10   PIC  X  VALUE  ':'.
  3485   02  DFHPF11   PIC  X  VALUE  '#'.
  3486   02  DFHPF12   PIC  X  VALUE  '@'.
  3487   02  DFHPF13   PIC  X  VALUE  'A'.
  3488   02  DFHPF14   PIC  X  VALUE  'B'.
  3489   02  DFHPF15   PIC  X  VALUE  'C'.
  3490   02  DFHPF16   PIC  X  VALUE  'D'.
  3491   02  DFHPF17   PIC  X  VALUE  'E'.
  3492   02  DFHPF18   PIC  X  VALUE  'F'.
  3493   02  DFHPF19   PIC  X  VALUE  'G'.
  3494   02  DFHPF20   PIC  X  VALUE  'H'.
  3495   02  DFHPF21   PIC  X  VALUE  'I'.
  3496*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3497   02  DFHPF22   PIC  X  VALUE  '['.
  3498   02  DFHPF23   PIC  X  VALUE  '.'.
  3499   02  DFHPF24   PIC  X  VALUE  '<'.
  3500   02  DFHMSRE   PIC  X  VALUE  'X'.
  3501   02  DFHSTRF   PIC  X  VALUE  'h'.
  3502   02  DFHTRIG   PIC  X  VALUE  '"'.
  3503
  3504 01  FILLER    REDEFINES DFHAID.
  3505     12  FILLER              PIC X(8).
  3506     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3507
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  68
* EL6311.cbl
  3509*    COPY EL6311S.
  3510 01  EL631BI.
  3511     05  FILLER            PIC  X(0012).
  3512*    -------------------------------
  3513     05  BDATEL PIC S9(0004) COMP.
  3514     05  BDATEF PIC  X(0001).
  3515     05  FILLER REDEFINES BDATEF.
  3516         10  BDATEA PIC  X(0001).
  3517     05  BDATEI PIC  X(0008).
  3518*    -------------------------------
  3519     05  BTIMEL PIC S9(0004) COMP.
  3520     05  BTIMEF PIC  X(0001).
  3521     05  FILLER REDEFINES BTIMEF.
  3522         10  BTIMEA PIC  X(0001).
  3523     05  BTIMEI PIC  X(0005).
  3524*    -------------------------------
  3525     05  BHEADL PIC S9(0004) COMP.
  3526     05  BHEADF PIC  X(0001).
  3527     05  FILLER REDEFINES BHEADF.
  3528         10  BHEADA PIC  X(0001).
  3529     05  BHEADI PIC  X(0038).
  3530*    -------------------------------
  3531     05  BNCERTLL PIC S9(0004) COMP.
  3532     05  BNCERTLF PIC  X(0001).
  3533     05  FILLER REDEFINES BNCERTLF.
  3534         10  BNCERTLA PIC  X(0001).
  3535     05  BNCERTLI PIC  X(0008).
  3536*    -------------------------------
  3537     05  BNCERTL PIC S9(0004) COMP.
  3538     05  BNCERTF PIC  X(0001).
  3539     05  FILLER REDEFINES BNCERTF.
  3540         10  BNCERTA PIC  X(0001).
  3541     05  BNCERTI PIC  X(0011).
  3542*    -------------------------------
  3543     05  BNSTATLL PIC S9(0004) COMP.
  3544     05  BNSTATLF PIC  X(0001).
  3545     05  FILLER REDEFINES BNSTATLF.
  3546         10  BNSTATLA PIC  X(0001).
  3547     05  BNSTATLI PIC  X(0009).
  3548*    -------------------------------
  3549     05  BNSTATL PIC S9(0004) COMP.
  3550     05  BNSTATF PIC  X(0001).
  3551     05  FILLER REDEFINES BNSTATF.
  3552         10  BNSTATA PIC  X(0001).
  3553     05  BNSTATI PIC  X(0002).
  3554*    -------------------------------
  3555     05  BCHGTL PIC S9(0004) COMP.
  3556     05  BCHGTF PIC  X(0001).
  3557     05  FILLER REDEFINES BCHGTF.
  3558         10  BCHGTA PIC  X(0001).
  3559     05  BCHGTI PIC  X(0004).
  3560*    -------------------------------
  3561     05  BCHGL PIC S9(0004) COMP.
  3562     05  BCHGF PIC  X(0001).
  3563     05  FILLER REDEFINES BCHGF.
  3564         10  BCHGA PIC  X(0001).
  3565     05  BCHGI PIC  X(0004).
  3566*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  69
* EL6311.cbl
  3567     05  BCOMPIDL PIC S9(0004) COMP.
  3568     05  BCOMPIDF PIC  X(0001).
  3569     05  FILLER REDEFINES BCOMPIDF.
  3570         10  BCOMPIDA PIC  X(0001).
  3571     05  BCOMPIDI PIC  X(0003).
  3572*    -------------------------------
  3573     05  BREGIONL PIC S9(0004) COMP.
  3574     05  BREGIONF PIC  X(0001).
  3575     05  FILLER REDEFINES BREGIONF.
  3576         10  BREGIONA PIC  X(0001).
  3577     05  BREGIONI PIC  X(0006).
  3578*    -------------------------------
  3579     05  BUSERL PIC S9(0004) COMP.
  3580     05  BUSERF PIC  X(0001).
  3581     05  FILLER REDEFINES BUSERF.
  3582         10  BUSERA PIC  X(0001).
  3583     05  BUSERI PIC  X(0004).
  3584*    -------------------------------
  3585     05  BMAINTL PIC S9(0004) COMP.
  3586     05  BMAINTF PIC  X(0001).
  3587     05  FILLER REDEFINES BMAINTF.
  3588         10  BMAINTA PIC  X(0001).
  3589     05  BMAINTI PIC  X(0001).
  3590*    -------------------------------
  3591     05  BMANTBYL PIC S9(0004) COMP.
  3592     05  BMANTBYF PIC  X(0001).
  3593     05  FILLER REDEFINES BMANTBYF.
  3594         10  BMANTBYA PIC  X(0001).
  3595     05  BMANTBYI PIC  X(0004).
  3596*    -------------------------------
  3597     05  BCHGHDGL PIC S9(0004) COMP.
  3598     05  BCHGHDGF PIC  X(0001).
  3599     05  FILLER REDEFINES BCHGHDGF.
  3600         10  BCHGHDGA PIC  X(0001).
  3601     05  BCHGHDGI PIC  X(0003).
  3602*    -------------------------------
  3603     05  BMANTDTL PIC S9(0004) COMP.
  3604     05  BMANTDTF PIC  X(0001).
  3605     05  FILLER REDEFINES BMANTDTF.
  3606         10  BMANTDTA PIC  X(0001).
  3607     05  BMANTDTI PIC  X(0008).
  3608*    -------------------------------
  3609     05  BMANTATL PIC S9(0004) COMP.
  3610     05  BMANTATF PIC  X(0001).
  3611     05  FILLER REDEFINES BMANTATF.
  3612         10  BMANTATA PIC  X(0001).
  3613     05  BMANTATI PIC  X(0005).
  3614*    -------------------------------
  3615     05  BCSRL PIC S9(0004) COMP.
  3616     05  BCSRF PIC  X(0001).
  3617     05  FILLER REDEFINES BCSRF.
  3618         10  BCSRA PIC  X(0001).
  3619     05  BCSRI PIC  X(0004).
  3620*    -------------------------------
  3621     05  BBATCHL PIC S9(0004) COMP.
  3622     05  BBATCHF PIC  X(0001).
  3623     05  FILLER REDEFINES BBATCHF.
  3624         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  70
* EL6311.cbl
  3625     05  BBATCHI PIC  X(0006).
  3626*    -------------------------------
  3627     05  BSEQL PIC S9(0004) COMP.
  3628     05  BSEQF PIC  X(0001).
  3629     05  FILLER REDEFINES BSEQF.
  3630         10  BSEQA PIC  X(0001).
  3631     05  BSEQI PIC  X(0004).
  3632*    -------------------------------
  3633     05  BMOENDTL PIC S9(0004) COMP.
  3634     05  BMOENDTF PIC  X(0001).
  3635     05  FILLER REDEFINES BMOENDTF.
  3636         10  BMOENDTA PIC  X(0001).
  3637     05  BMOENDTI PIC  X(0008).
  3638*    -------------------------------
  3639     05  BCARRL PIC S9(0004) COMP.
  3640     05  BCARRF PIC  X(0001).
  3641     05  FILLER REDEFINES BCARRF.
  3642         10  BCARRA PIC  X(0001).
  3643     05  BCARRI PIC  X(0001).
  3644*    -------------------------------
  3645     05  BGROUPL PIC S9(0004) COMP.
  3646     05  BGROUPF PIC  X(0001).
  3647     05  FILLER REDEFINES BGROUPF.
  3648         10  BGROUPA PIC  X(0001).
  3649     05  BGROUPI PIC  X(0006).
  3650*    -------------------------------
  3651     05  BSTATEL PIC S9(0004) COMP.
  3652     05  BSTATEF PIC  X(0001).
  3653     05  FILLER REDEFINES BSTATEF.
  3654         10  BSTATEA PIC  X(0001).
  3655     05  BSTATEI PIC  X(0002).
  3656*    -------------------------------
  3657     05  BACCTL PIC S9(0004) COMP.
  3658     05  BACCTF PIC  X(0001).
  3659     05  FILLER REDEFINES BACCTF.
  3660         10  BACCTA PIC  X(0001).
  3661     05  BACCTI PIC  X(0010).
  3662*    -------------------------------
  3663     05  BVINHL PIC S9(0004) COMP.
  3664     05  BVINHF PIC  X(0001).
  3665     05  FILLER REDEFINES BVINHF.
  3666         10  BVINHA PIC  X(0001).
  3667     05  BVINHI PIC  X(0004).
  3668*    -------------------------------
  3669     05  BVINL PIC S9(0004) COMP.
  3670     05  BVINF PIC  X(0001).
  3671     05  FILLER REDEFINES BVINF.
  3672         10  BVINA PIC  X(0001).
  3673     05  BVINI PIC  X(0017).
  3674*    -------------------------------
  3675     05  BREFHDGL PIC S9(0004) COMP.
  3676     05  BREFHDGF PIC  X(0001).
  3677     05  FILLER REDEFINES BREFHDGF.
  3678         10  BREFHDGA PIC  X(0001).
  3679     05  BREFHDGI PIC  X(0004).
  3680*    -------------------------------
  3681     05  BREFL PIC S9(0004) COMP.
  3682     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  71
* EL6311.cbl
  3683     05  FILLER REDEFINES BREFF.
  3684         10  BREFA PIC  X(0001).
  3685     05  BREFI PIC  X(0012).
  3686*    -------------------------------
  3687     05  LETRREQL PIC S9(0004) COMP.
  3688     05  LETRREQF PIC  X(0001).
  3689     05  FILLER REDEFINES LETRREQF.
  3690         10  LETRREQA PIC  X(0001).
  3691     05  LETRREQI PIC  X(0001).
  3692*    -------------------------------
  3693     05  BAGEDEFL PIC S9(0004) COMP.
  3694     05  BAGEDEFF PIC  X(0001).
  3695     05  FILLER REDEFINES BAGEDEFF.
  3696         10  BAGEDEFA PIC  X(0001).
  3697     05  BAGEDEFI PIC  X(0004).
  3698*    -------------------------------
  3699     05  BCERTNOL PIC S9(0004) COMP.
  3700     05  BCERTNOF PIC  X(0001).
  3701     05  FILLER REDEFINES BCERTNOF.
  3702         10  BCERTNOA PIC  X(0001).
  3703     05  BCERTNOI PIC  X(0010).
  3704*    -------------------------------
  3705     05  BSUFIXL PIC S9(0004) COMP.
  3706     05  BSUFIXF PIC  X(0001).
  3707     05  FILLER REDEFINES BSUFIXF.
  3708         10  BSUFIXA PIC  X(0001).
  3709     05  BSUFIXI PIC  X(0001).
  3710*    -------------------------------
  3711     05  BEFFDTL PIC S9(0004) COMP.
  3712     05  BEFFDTF PIC  X(0001).
  3713     05  FILLER REDEFINES BEFFDTF.
  3714         10  BEFFDTA PIC  X(0001).
  3715     05  BEFFDTI PIC  X(0008).
  3716*    -------------------------------
  3717     05  BLSTNML PIC S9(0004) COMP.
  3718     05  BLSTNMF PIC  X(0001).
  3719     05  FILLER REDEFINES BLSTNMF.
  3720         10  BLSTNMA PIC  X(0001).
  3721     05  BLSTNMI PIC  X(0015).
  3722*    -------------------------------
  3723     05  B1STNML PIC S9(0004) COMP.
  3724     05  B1STNMF PIC  X(0001).
  3725     05  FILLER REDEFINES B1STNMF.
  3726         10  B1STNMA PIC  X(0001).
  3727     05  B1STNMI PIC  X(0010).
  3728*    -------------------------------
  3729     05  BINITL PIC S9(0004) COMP.
  3730     05  BINITF PIC  X(0001).
  3731     05  FILLER REDEFINES BINITF.
  3732         10  BINITA PIC  X(0001).
  3733     05  BINITI PIC  X(0001).
  3734*    -------------------------------
  3735     05  BSEXL PIC S9(0004) COMP.
  3736     05  BSEXF PIC  X(0001).
  3737     05  FILLER REDEFINES BSEXF.
  3738         10  BSEXA PIC  X(0001).
  3739     05  BSEXI PIC  X(0001).
  3740*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  72
* EL6311.cbl
  3741     05  BAGEL PIC S9(0004) COMP.
  3742     05  BAGEF PIC  X(0001).
  3743     05  FILLER REDEFINES BAGEF.
  3744         10  BAGEA PIC  X(0001).
  3745     05  BAGEI PIC  X(0002).
  3746*    -------------------------------
  3747     05  BBIRTHL PIC S9(0004) COMP.
  3748     05  BBIRTHF PIC  X(0001).
  3749     05  FILLER REDEFINES BBIRTHF.
  3750         10  BBIRTHA PIC  X(0001).
  3751     05  BBIRTHI PIC  X(0008).
  3752*    -------------------------------
  3753     05  B1STPMTL PIC S9(0004) COMP.
  3754     05  B1STPMTF PIC  X(0001).
  3755     05  FILLER REDEFINES B1STPMTF.
  3756         10  B1STPMTA PIC  X(0001).
  3757     05  B1STPMTI PIC  X(0008).
  3758*    -------------------------------
  3759     05  BDAYSL PIC S9(0004) COMP.
  3760     05  BDAYSF PIC  X(0001).
  3761     05  FILLER REDEFINES BDAYSF.
  3762         10  BDAYSA PIC  X(0001).
  3763     05  BDAYSI PIC  X(0003).
  3764*    -------------------------------
  3765     05  BLNTRML PIC S9(0004) COMP.
  3766     05  BLNTRMF PIC  X(0001).
  3767     05  FILLER REDEFINES BLNTRMF.
  3768         10  BLNTRMA PIC  X(0001).
  3769     05  BLNTRMI PIC  X(0003).
  3770*    -------------------------------
  3771     05  BLNOFCRL PIC S9(0004) COMP.
  3772     05  BLNOFCRF PIC  X(0001).
  3773     05  FILLER REDEFINES BLNOFCRF.
  3774         10  BLNOFCRA PIC  X(0001).
  3775     05  BLNOFCRI PIC  X(0005).
  3776*    -------------------------------
  3777     05  BMODEL PIC S9(0004) COMP.
  3778     05  BMODEF PIC  X(0001).
  3779     05  FILLER REDEFINES BMODEF.
  3780         10  BMODEA PIC  X(0001).
  3781     05  BMODEI PIC  X(0001).
  3782*    -------------------------------
  3783     05  BFREQL PIC S9(0004) COMP.
  3784     05  BFREQF PIC  X(0001).
  3785     05  FILLER REDEFINES BFREQF.
  3786         10  BFREQA PIC  X(0001).
  3787     05  BFREQI PIC  X(0002).
  3788*    -------------------------------
  3789     05  BPMTSL PIC S9(0004) COMP.
  3790     05  BPMTSF PIC  X(0001).
  3791     05  FILLER REDEFINES BPMTSF.
  3792         10  BPMTSA PIC  X(0001).
  3793     05  BPMTSI PIC  999.
  3794*    -------------------------------
  3795     05  BPMTAMTL PIC S9(0004) COMP.
  3796     05  BPMTAMTF PIC  X(0001).
  3797     05  FILLER REDEFINES BPMTAMTF.
  3798         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  73
* EL6311.cbl
  3799     05  BPMTAMTI PIC  9(7)V99.
  3800*    -------------------------------
  3801     05  BAPRL PIC S9(0004) COMP.
  3802     05  BAPRF PIC  X(0001).
  3803     05  FILLER REDEFINES BAPRF.
  3804         10  BAPRA PIC  X(0001).
  3805     05  BAPRI PIC  X(7).
  3806*    -------------------------------
  3807     05  BLIVESL PIC S9(0004) COMP.
  3808     05  BLIVESF PIC  X(0001).
  3809     05  FILLER REDEFINES BLIVESF.
  3810         10  BLIVESA PIC  X(0001).
  3811     05  BLIVESI PIC  X(0009).
  3812*    -------------------------------
  3813     05  BMEMCAPL PIC S9(0004) COMP.
  3814     05  BMEMCAPF PIC  X(0001).
  3815     05  FILLER REDEFINES BMEMCAPF.
  3816         10  BMEMCAPA PIC  X(0001).
  3817     05  BMEMCAPI PIC  X(0011).
  3818*    -------------------------------
  3819     05  BORIGHDL PIC S9(0004) COMP.
  3820     05  BORIGHDF PIC  X(0001).
  3821     05  FILLER REDEFINES BORIGHDF.
  3822         10  BORIGHDA PIC  X(0001).
  3823     05  BORIGHDI PIC  X(0009).
  3824*    -------------------------------
  3825     05  DMDBILL PIC S9(0004) COMP.
  3826     05  DMDBILF PIC  X(0001).
  3827     05  FILLER REDEFINES DMDBILF.
  3828         10  DMDBILA PIC  X(0001).
  3829     05  DMDBILI PIC  X(0006).
  3830*    -------------------------------
  3831     05  BFORCEL PIC S9(0004) COMP.
  3832     05  BFORCEF PIC  X(0001).
  3833     05  FILLER REDEFINES BFORCEF.
  3834         10  BFORCEA PIC  X(0001).
  3835     05  BFORCEI PIC  X(0001).
  3836*    -------------------------------
  3837     05  BENTRYL PIC S9(0004) COMP.
  3838     05  BENTRYF PIC  X(0001).
  3839     05  FILLER REDEFINES BENTRYF.
  3840         10  BENTRYA PIC  X(0001).
  3841     05  BENTRYI PIC  X(0001).
  3842*    -------------------------------
  3843     05  BREINL PIC S9(0004) COMP.
  3844     05  BREINF PIC  X(0001).
  3845     05  FILLER REDEFINES BREINF.
  3846         10  BREINA PIC  X(0001).
  3847     05  BREINI PIC  X(0001).
  3848*    -------------------------------
  3849     05  BBILCDL PIC S9(0004) COMP.
  3850     05  BBILCDF PIC  X(0001).
  3851     05  FILLER REDEFINES BBILCDF.
  3852         10  BBILCDA PIC  X(0001).
  3853     05  BBILCDI PIC  X(0001).
  3854*    -------------------------------
  3855     05  BUNWRITL PIC S9(0004) COMP.
  3856     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  74
* EL6311.cbl
  3857     05  FILLER REDEFINES BUNWRITF.
  3858         10  BUNWRITA PIC  X(0001).
  3859     05  BUNWRITI PIC  X(0001).
  3860*    -------------------------------
  3861     05  BSKPCDL PIC S9(0004) COMP.
  3862     05  BSKPCDF PIC  X(0001).
  3863     05  FILLER REDEFINES BSKPCDF.
  3864         10  BSKPCDA PIC  X(0001).
  3865     05  BSKPCDI PIC  X(0001).
  3866*    -------------------------------
  3867     05  BINDGRPL PIC S9(0004) COMP.
  3868     05  BINDGRPF PIC  X(0001).
  3869     05  FILLER REDEFINES BINDGRPF.
  3870         10  BINDGRPA PIC  X(0001).
  3871     05  BINDGRPI PIC  X(0001).
  3872*    -------------------------------
  3873     05  BSIGL PIC S9(0004) COMP.
  3874     05  BSIGF PIC  X(0001).
  3875     05  FILLER REDEFINES BSIGF.
  3876         10  BSIGA PIC  X(0001).
  3877     05  BSIGI PIC  X(0001).
  3878*    -------------------------------
  3879     05  BRTCLSL PIC S9(0004) COMP.
  3880     05  BRTCLSF PIC  X(0001).
  3881     05  FILLER REDEFINES BRTCLSF.
  3882         10  BRTCLSA PIC  X(0001).
  3883     05  BRTCLSI PIC  X(0002).
  3884*    -------------------------------
  3885     05  BCHGCNTL PIC S9(0004) COMP.
  3886     05  BCHGCNTF PIC  X(0001).
  3887     05  FILLER REDEFINES BCHGCNTF.
  3888         10  BCHGCNTA PIC  X(0001).
  3889     05  BCHGCNTI PIC  X(0003).
  3890*    -------------------------------
  3891     05  BMEMBERL PIC S9(0004) COMP.
  3892     05  BMEMBERF PIC  X(0001).
  3893     05  FILLER REDEFINES BMEMBERF.
  3894         10  BMEMBERA PIC  X(0001).
  3895     05  BMEMBERI PIC  X(0012).
  3896*    -------------------------------
  3897     05  BORGNOL PIC S9(0004) COMP.
  3898     05  BORGNOF PIC  X(0001).
  3899     05  FILLER REDEFINES BORGNOF.
  3900         10  BORGNOA PIC  X(0001).
  3901     05  BORGNOI PIC  X(0006).
  3902*    -------------------------------
  3903     05  BORGSEQL PIC S9(0004) COMP.
  3904     05  BORGSEQF PIC  X(0001).
  3905     05  FILLER REDEFINES BORGSEQF.
  3906         10  BORGSEQA PIC  X(0001).
  3907     05  BORGSEQI PIC  X(0004).
  3908*    -------------------------------
  3909     05  BBILLEDL PIC S9(0004) COMP.
  3910     05  BBILLEDF PIC  X(0001).
  3911     05  FILLER REDEFINES BBILLEDF.
  3912         10  BBILLEDA PIC  X(0001).
  3913     05  BBILLEDI PIC  9(9).
  3914*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  75
* EL6311.cbl
  3915     05  BKIND1L PIC S9(0004) COMP.
  3916     05  BKIND1F PIC  X(0001).
  3917     05  FILLER REDEFINES BKIND1F.
  3918         10  BKIND1A PIC  X(0001).
  3919     05  BKIND1I PIC  X(0002).
  3920*    -------------------------------
  3921     05  BTYPE1L PIC S9(0004) COMP.
  3922     05  BTYPE1F PIC  X(0001).
  3923     05  FILLER REDEFINES BTYPE1F.
  3924         10  BTYPE1A PIC  X(0001).
  3925     05  BTYPE1I PIC  X(0003).
  3926*    -------------------------------
  3927     05  BTERM1L PIC S9(0004) COMP.
  3928     05  BTERM1F PIC  X(0001).
  3929     05  FILLER REDEFINES BTERM1F.
  3930         10  BTERM1A PIC  X(0001).
  3931     05  BTERM1I PIC  X(0003).
  3932*    -------------------------------
  3933     05  BBEN1L PIC S9(0004) COMP.
  3934     05  BBEN1F PIC  X(0001).
  3935     05  FILLER REDEFINES BBEN1F.
  3936         10  BBEN1A PIC  X(0001).
  3937     05  BBEN1I PIC  X(0012).
  3938*    -------------------------------
  3939     05  BPREM1L PIC S9(0004) COMP.
  3940     05  BPREM1F PIC  X(0001).
  3941     05  FILLER REDEFINES BPREM1F.
  3942         10  BPREM1A PIC  X(0001).
  3943     05  BPREM1I PIC  X(0011).
  3944*    -------------------------------
  3945     05  BEXPIR1L PIC S9(0004) COMP.
  3946     05  BEXPIR1F PIC  X(0001).
  3947     05  FILLER REDEFINES BEXPIR1F.
  3948         10  BEXPIR1A PIC  X(0001).
  3949     05  BEXPIR1I PIC  X(0008).
  3950*    -------------------------------
  3951     05  BCP1L PIC S9(0004) COMP.
  3952     05  BCP1F PIC  X(0001).
  3953     05  FILLER REDEFINES BCP1F.
  3954         10  BCP1A PIC  X(0001).
  3955     05  BCP1I PIC  X(0002).
  3956*    -------------------------------
  3957     05  BALTBN1L PIC S9(0004) COMP.
  3958     05  BALTBN1F PIC  X(0001).
  3959     05  FILLER REDEFINES BALTBN1F.
  3960         10  BALTBN1A PIC  X(0001).
  3961     05  BALTBN1I PIC  X(0012).
  3962*    -------------------------------
  3963     05  BALTPR1L PIC S9(0004) COMP.
  3964     05  BALTPR1F PIC  X(0001).
  3965     05  FILLER REDEFINES BALTPR1F.
  3966         10  BALTPR1A PIC  X(0001).
  3967     05  BALTPR1I PIC  X(0011).
  3968*    -------------------------------
  3969     05  BBNCD1L PIC S9(0004) COMP.
  3970     05  BBNCD1F PIC  X(0001).
  3971     05  FILLER REDEFINES BBNCD1F.
  3972         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  76
* EL6311.cbl
  3973     05  BBNCD1I PIC  X(0003).
  3974*    -------------------------------
  3975     05  BCPRM1L PIC S9(0004) COMP.
  3976     05  BCPRM1F PIC  X(0001).
  3977     05  FILLER REDEFINES BCPRM1F.
  3978         10  BCPRM1A PIC  X(0001).
  3979     05  BCPRM1I PIC  X(0011).
  3980*    -------------------------------
  3981     05  BCAPRM1L PIC S9(0004) COMP.
  3982     05  BCAPRM1F PIC  X(0001).
  3983     05  FILLER REDEFINES BCAPRM1F.
  3984         10  BCAPRM1A PIC  X(0001).
  3985     05  BCAPRM1I PIC  X(0011).
  3986*    -------------------------------
  3987     05  BENABR1L PIC S9(0004) COMP.
  3988     05  BENABR1F PIC  X(0001).
  3989     05  FILLER REDEFINES BENABR1F.
  3990         10  BENABR1A PIC  X(0001).
  3991     05  BENABR1I PIC  X(0005).
  3992*    -------------------------------
  3993     05  BDIFF1L PIC S9(0004) COMP.
  3994     05  BDIFF1F PIC  X(0001).
  3995     05  FILLER REDEFINES BDIFF1F.
  3996         10  BDIFF1A PIC  X(0001).
  3997     05  BDIFF1I PIC  X(0011).
  3998*    -------------------------------
  3999     05  BBILIT1L PIC S9(0004) COMP.
  4000     05  BBILIT1F PIC  X(0001).
  4001     05  FILLER REDEFINES BBILIT1F.
  4002         10  BBILIT1A PIC  X(0001).
  4003     05  BBILIT1I PIC  X(0008).
  4004*    -------------------------------
  4005     05  BADIFF1L PIC S9(0004) COMP.
  4006     05  BADIFF1F PIC  X(0001).
  4007     05  FILLER REDEFINES BADIFF1F.
  4008         10  BADIFF1A PIC  X(0001).
  4009     05  BADIFF1I PIC  X(0011).
  4010*    -------------------------------
  4011     05  BKIND2L PIC S9(0004) COMP.
  4012     05  BKIND2F PIC  X(0001).
  4013     05  FILLER REDEFINES BKIND2F.
  4014         10  BKIND2A PIC  X(0001).
  4015     05  BKIND2I PIC  X(0002).
  4016*    -------------------------------
  4017     05  BTYPE2L PIC S9(0004) COMP.
  4018     05  BTYPE2F PIC  X(0001).
  4019     05  FILLER REDEFINES BTYPE2F.
  4020         10  BTYPE2A PIC  X(0001).
  4021     05  BTYPE2I PIC  X(0003).
  4022*    -------------------------------
  4023     05  BTERM2L PIC S9(0004) COMP.
  4024     05  BTERM2F PIC  X(0001).
  4025     05  FILLER REDEFINES BTERM2F.
  4026         10  BTERM2A PIC  X(0001).
  4027     05  BTERM2I PIC  X(0003).
  4028*    -------------------------------
  4029     05  BBEN2L PIC S9(0004) COMP.
  4030     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  77
* EL6311.cbl
  4031     05  FILLER REDEFINES BBEN2F.
  4032         10  BBEN2A PIC  X(0001).
  4033     05  BBEN2I PIC  X(0012).
  4034*    -------------------------------
  4035     05  BPREM2L PIC S9(0004) COMP.
  4036     05  BPREM2F PIC  X(0001).
  4037     05  FILLER REDEFINES BPREM2F.
  4038         10  BPREM2A PIC  X(0001).
  4039     05  BPREM2I PIC  X(0011).
  4040*    -------------------------------
  4041     05  BEXPIR2L PIC S9(0004) COMP.
  4042     05  BEXPIR2F PIC  X(0001).
  4043     05  FILLER REDEFINES BEXPIR2F.
  4044         10  BEXPIR2A PIC  X(0001).
  4045     05  BEXPIR2I PIC  X(0008).
  4046*    -------------------------------
  4047     05  BCP2L PIC S9(0004) COMP.
  4048     05  BCP2F PIC  X(0001).
  4049     05  FILLER REDEFINES BCP2F.
  4050         10  BCP2A PIC  X(0001).
  4051     05  BCP2I PIC  X(0002).
  4052*    -------------------------------
  4053     05  BALTBN2L PIC S9(0004) COMP.
  4054     05  BALTBN2F PIC  X(0001).
  4055     05  FILLER REDEFINES BALTBN2F.
  4056         10  BALTBN2A PIC  X(0001).
  4057     05  BALTBN2I PIC  X(0012).
  4058*    -------------------------------
  4059     05  BALTPR2L PIC S9(0004) COMP.
  4060     05  BALTPR2F PIC  X(0001).
  4061     05  FILLER REDEFINES BALTPR2F.
  4062         10  BALTPR2A PIC  X(0001).
  4063     05  BALTPR2I PIC  X(0011).
  4064*    -------------------------------
  4065     05  BBNCD2L PIC S9(0004) COMP.
  4066     05  BBNCD2F PIC  X(0001).
  4067     05  FILLER REDEFINES BBNCD2F.
  4068         10  BBNCD2A PIC  X(0001).
  4069     05  BBNCD2I PIC  X(0003).
  4070*    -------------------------------
  4071     05  BCPRM2L PIC S9(0004) COMP.
  4072     05  BCPRM2F PIC  X(0001).
  4073     05  FILLER REDEFINES BCPRM2F.
  4074         10  BCPRM2A PIC  X(0001).
  4075     05  BCPRM2I PIC  X(0011).
  4076*    -------------------------------
  4077     05  BCAPRM2L PIC S9(0004) COMP.
  4078     05  BCAPRM2F PIC  X(0001).
  4079     05  FILLER REDEFINES BCAPRM2F.
  4080         10  BCAPRM2A PIC  X(0001).
  4081     05  BCAPRM2I PIC  X(0011).
  4082*    -------------------------------
  4083     05  BENABR2L PIC S9(0004) COMP.
  4084     05  BENABR2F PIC  X(0001).
  4085     05  FILLER REDEFINES BENABR2F.
  4086         10  BENABR2A PIC  X(0001).
  4087     05  BENABR2I PIC  X(0005).
  4088*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  78
* EL6311.cbl
  4089     05  BDIFF2L PIC S9(0004) COMP.
  4090     05  BDIFF2F PIC  X(0001).
  4091     05  FILLER REDEFINES BDIFF2F.
  4092         10  BDIFF2A PIC  X(0001).
  4093     05  BDIFF2I PIC  X(0011).
  4094*    -------------------------------
  4095     05  BBILIT2L PIC S9(0004) COMP.
  4096     05  BBILIT2F PIC  X(0001).
  4097     05  FILLER REDEFINES BBILIT2F.
  4098         10  BBILIT2A PIC  X(0001).
  4099     05  BBILIT2I PIC  X(0008).
  4100*    -------------------------------
  4101     05  BADIFF2L PIC S9(0004) COMP.
  4102     05  BADIFF2F PIC  X(0001).
  4103     05  FILLER REDEFINES BADIFF2F.
  4104         10  BADIFF2A PIC  X(0001).
  4105     05  BADIFF2I PIC  X(0011).
  4106*    -------------------------------
  4107     05  BERMSG1L PIC S9(0004) COMP.
  4108     05  BERMSG1F PIC  X(0001).
  4109     05  FILLER REDEFINES BERMSG1F.
  4110         10  BERMSG1A PIC  X(0001).
  4111     05  BERMSG1I PIC  X(0078).
  4112*    -------------------------------
  4113     05  BERMSG2L PIC S9(0004) COMP.
  4114     05  BERMSG2F PIC  X(0001).
  4115     05  FILLER REDEFINES BERMSG2F.
  4116         10  BERMSG2A PIC  X(0001).
  4117     05  BERMSG2I PIC  X(0078).
  4118*    -------------------------------
  4119     05  BERMSG3L PIC S9(0004) COMP.
  4120     05  BERMSG3F PIC  X(0001).
  4121     05  FILLER REDEFINES BERMSG3F.
  4122         10  BERMSG3A PIC  X(0001).
  4123     05  BERMSG3I PIC  X(0078).
  4124*    -------------------------------
  4125     05  BPFENTRL PIC S9(0004) COMP.
  4126     05  BPFENTRF PIC  X(0001).
  4127     05  FILLER REDEFINES BPFENTRF.
  4128         10  BPFENTRA PIC  X(0001).
  4129     05  BPFENTRI PIC  9(2).
  4130*    -------------------------------
  4131     05  BPF5HDRL PIC S9(0004) COMP.
  4132     05  BPF5HDRF PIC  X(0001).
  4133     05  FILLER REDEFINES BPF5HDRF.
  4134         10  BPF5HDRA PIC  X(0001).
  4135     05  BPF5HDRI PIC  X(0005).
  4136*    -------------------------------
  4137     05  BPF4HDRL PIC S9(0004) COMP.
  4138     05  BPF4HDRF PIC  X(0001).
  4139     05  FILLER REDEFINES BPF4HDRF.
  4140         10  BPF4HDRA PIC  X(0001).
  4141     05  BPF4HDRI PIC  X(0013).
  4142*    -------------------------------
  4143     05  BF15HDRL PIC S9(0004) COMP.
  4144     05  BF15HDRF PIC  X(0001).
  4145     05  FILLER REDEFINES BF15HDRF.
  4146         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  79
* EL6311.cbl
  4147     05  BF15HDRI PIC  X(0010).
  4148 01  EL631BO REDEFINES EL631BI.
  4149     05  FILLER            PIC  X(0012).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BDATEO PIC  X(0008).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BTIMEO PIC  99.99.
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BHEADO PIC  X(0038).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BNCERTLO PIC  X(0008).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BNCERTO PIC  X(0011).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BNSTATLO PIC  X(0009).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BNSTATO PIC  X(0002).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BCHGTO PIC  X(0004).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BCHGO PIC  ZZZ9.
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BCOMPIDO PIC  X(0003).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BREGIONO PIC  X(0006).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BUSERO PIC  X(0004).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BMAINTO PIC  X(0001).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BMANTBYO PIC  X(0004).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BCHGHDGO PIC  X(0003).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BMANTDTO PIC  X(0008).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BMANTATO PIC  99.99.
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BCSRO PIC  X(0004).
  4204*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  80
* EL6311.cbl
  4205     05  FILLER            PIC  X(0003).
  4206     05  BBATCHO PIC  X(0006).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BSEQO PIC  X(0004).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BMOENDTO PIC  X(0008).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BCARRO PIC  X(0001).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BGROUPO PIC  X(0006).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BSTATEO PIC  X(0002).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BACCTO PIC  X(0010).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BVINHO PIC  X(0004).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BVINO PIC  X(0017).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BREFHDGO PIC  X(0004).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BREFO PIC  X(0012).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  LETRREQO PIC  X(0001).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BAGEDEFO PIC  X(0004).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BCERTNOO PIC  X(0010).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BSUFIXO PIC  X(0001).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BEFFDTO PIC  X(0008).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BLSTNMO PIC  X(0015).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  B1STNMO PIC  X(0010).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BINITO PIC  X(0001).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  81
* EL6311.cbl
  4263     05  BSEXO PIC  X(0001).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BAGEO PIC  X(0002).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BBIRTHO PIC  X(0008).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  B1STPMTO PIC  X(0008).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BDAYSO PIC  X(0003).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BLNTRMO PIC  X(0003).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BLNOFCRO PIC  X(0005).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BMODEO PIC  X(0001).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BFREQO PIC  X(0002).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BPMTSO PIC  X(0003).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BPMTAMTO PIC  ZZZZZ9.99.
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BAPRO PIC  99.9999.
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BMEMCAPO PIC  X(0011).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BORIGHDO PIC  X(0009).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  DMDBILO PIC  X(0006).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BFORCEO PIC  X(0001).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BENTRYO PIC  X(0001).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BREINO PIC  X(0001).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  82
* EL6311.cbl
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BUNWRITO PIC  X(0001).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BSKPCDO PIC  X(0001).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BINDGRPO PIC  X(0001).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BSIGO PIC  X(0001).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BRTCLSO PIC  X(0002).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BCHGCNTO PIC  X(0003).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BMEMBERO PIC  X(0012).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BORGNOO PIC  X(0006).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  BORGSEQO PIC  X(0004).
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  BKIND1O PIC  X(0002).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  BTYPE1O PIC  X(0003).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  BTERM1O PIC  X(0003).
  4360*    -------------------------------
  4361     05  FILLER            PIC  X(0003).
  4362     05  BBEN1O PIC  X(0012).
  4363*    -------------------------------
  4364     05  FILLER            PIC  X(0003).
  4365     05  BPREM1O PIC  X(0011).
  4366*    -------------------------------
  4367     05  FILLER            PIC  X(0003).
  4368     05  BEXPIR1O PIC  X(0008).
  4369*    -------------------------------
  4370     05  FILLER            PIC  X(0003).
  4371     05  BCP1O PIC  X(0002).
  4372*    -------------------------------
  4373     05  FILLER            PIC  X(0003).
  4374     05  BALTBN1O PIC  X(0012).
  4375*    -------------------------------
  4376     05  FILLER            PIC  X(0003).
  4377     05  BALTPR1O PIC  X(0011).
  4378*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  83
* EL6311.cbl
  4379     05  FILLER            PIC  X(0003).
  4380     05  BBNCD1O PIC  X(0003).
  4381*    -------------------------------
  4382     05  FILLER            PIC  X(0003).
  4383     05  BCPRM1O PIC  X(0011).
  4384*    -------------------------------
  4385     05  FILLER            PIC  X(0003).
  4386     05  BCAPRM1O PIC  X(0011).
  4387*    -------------------------------
  4388     05  FILLER            PIC  X(0003).
  4389     05  BENABR1O PIC  X(0005).
  4390*    -------------------------------
  4391     05  FILLER            PIC  X(0003).
  4392     05  BDIFF1O PIC  X(0011).
  4393*    -------------------------------
  4394     05  FILLER            PIC  X(0003).
  4395     05  BBILIT1O PIC  X(0008).
  4396*    -------------------------------
  4397     05  FILLER            PIC  X(0003).
  4398     05  BADIFF1O PIC  X(0011).
  4399*    -------------------------------
  4400     05  FILLER            PIC  X(0003).
  4401     05  BKIND2O PIC  X(0002).
  4402*    -------------------------------
  4403     05  FILLER            PIC  X(0003).
  4404     05  BTYPE2O PIC  X(0003).
  4405*    -------------------------------
  4406     05  FILLER            PIC  X(0003).
  4407     05  BTERM2O PIC  X(0003).
  4408*    -------------------------------
  4409     05  FILLER            PIC  X(0003).
  4410     05  BBEN2O PIC  X(0012).
  4411*    -------------------------------
  4412     05  FILLER            PIC  X(0003).
  4413     05  BPREM2O PIC  X(0011).
  4414*    -------------------------------
  4415     05  FILLER            PIC  X(0003).
  4416     05  BEXPIR2O PIC  X(0008).
  4417*    -------------------------------
  4418     05  FILLER            PIC  X(0003).
  4419     05  BCP2O PIC  X(0002).
  4420*    -------------------------------
  4421     05  FILLER            PIC  X(0003).
  4422     05  BALTBN2O PIC  X(0012).
  4423*    -------------------------------
  4424     05  FILLER            PIC  X(0003).
  4425     05  BALTPR2O PIC  X(0011).
  4426*    -------------------------------
  4427     05  FILLER            PIC  X(0003).
  4428     05  BBNCD2O PIC  X(0003).
  4429*    -------------------------------
  4430     05  FILLER            PIC  X(0003).
  4431     05  BCPRM2O PIC  X(0011).
  4432*    -------------------------------
  4433     05  FILLER            PIC  X(0003).
  4434     05  BCAPRM2O PIC  X(0011).
  4435*    -------------------------------
  4436     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  84
* EL6311.cbl
  4437     05  BENABR2O PIC  X(0005).
  4438*    -------------------------------
  4439     05  FILLER            PIC  X(0003).
  4440     05  BDIFF2O PIC  X(0011).
  4441*    -------------------------------
  4442     05  FILLER            PIC  X(0003).
  4443     05  BBILIT2O PIC  X(0008).
  4444*    -------------------------------
  4445     05  FILLER            PIC  X(0003).
  4446     05  BADIFF2O PIC  X(0011).
  4447*    -------------------------------
  4448     05  FILLER            PIC  X(0003).
  4449     05  BERMSG1O PIC  X(0078).
  4450*    -------------------------------
  4451     05  FILLER            PIC  X(0003).
  4452     05  BERMSG2O PIC  X(0078).
  4453*    -------------------------------
  4454     05  FILLER            PIC  X(0003).
  4455     05  BERMSG3O PIC  X(0078).
  4456*    -------------------------------
  4457     05  FILLER            PIC  X(0003).
  4458     05  BPFENTRO PIC  X(0002).
  4459*    -------------------------------
  4460     05  FILLER            PIC  X(0003).
  4461     05  BPF5HDRO PIC  X(0005).
  4462*    -------------------------------
  4463     05  FILLER            PIC  X(0003).
  4464     05  BPF4HDRO PIC  X(0013).
  4465*    -------------------------------
  4466     05  FILLER            PIC  X(0003).
  4467     05  BF15HDRO PIC  X(0010).
  4468*    -------------------------------
  4469 01  EL631CI REDEFINES EL631BI.
  4470     05  FILLER            PIC  X(0012).
  4471*    -------------------------------
  4472     05  CDATEL PIC S9(0004) COMP.
  4473     05  CDATEF PIC  X(0001).
  4474     05  FILLER REDEFINES CDATEF.
  4475         10  CDATEA PIC  X(0001).
  4476     05  CDATEI PIC  X(0008).
  4477*    -------------------------------
  4478     05  CTIMEL PIC S9(0004) COMP.
  4479     05  CTIMEF PIC  X(0001).
  4480     05  FILLER REDEFINES CTIMEF.
  4481         10  CTIMEA PIC  X(0001).
  4482     05  CTIMEI PIC  X(0005).
  4483*    -------------------------------
  4484     05  CHEADL PIC S9(0004) COMP.
  4485     05  CHEADF PIC  X(0001).
  4486     05  FILLER REDEFINES CHEADF.
  4487         10  CHEADA PIC  X(0001).
  4488     05  CHEADI PIC  X(0038).
  4489*    -------------------------------
  4490     05  CCHGTL PIC S9(0004) COMP.
  4491     05  CCHGTF PIC  X(0001).
  4492     05  FILLER REDEFINES CCHGTF.
  4493         10  CCHGTA PIC  X(0001).
  4494     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  85
* EL6311.cbl
  4495*    -------------------------------
  4496     05  CCHGL PIC S9(0004) COMP.
  4497     05  CCHGF PIC  X(0001).
  4498     05  FILLER REDEFINES CCHGF.
  4499         10  CCHGA PIC  X(0001).
  4500     05  CCHGI PIC  X(0004).
  4501*    -------------------------------
  4502     05  CMAINTL PIC S9(0004) COMP.
  4503     05  CMAINTF PIC  X(0001).
  4504     05  FILLER REDEFINES CMAINTF.
  4505         10  CMAINTA PIC  X(0001).
  4506     05  CMAINTI PIC  X(0001).
  4507*    -------------------------------
  4508     05  CMANTBYL PIC S9(0004) COMP.
  4509     05  CMANTBYF PIC  X(0001).
  4510     05  FILLER REDEFINES CMANTBYF.
  4511         10  CMANTBYA PIC  X(0001).
  4512     05  CMANTBYI PIC  X(0004).
  4513*    -------------------------------
  4514     05  CCHGHDGL PIC S9(0004) COMP.
  4515     05  CCHGHDGF PIC  X(0001).
  4516     05  FILLER REDEFINES CCHGHDGF.
  4517         10  CCHGHDGA PIC  X(0001).
  4518     05  CCHGHDGI PIC  X(0003).
  4519*    -------------------------------
  4520     05  CMANTDTL PIC S9(0004) COMP.
  4521     05  CMANTDTF PIC  X(0001).
  4522     05  FILLER REDEFINES CMANTDTF.
  4523         10  CMANTDTA PIC  X(0001).
  4524     05  CMANTDTI PIC  X(0008).
  4525*    -------------------------------
  4526     05  CMANTATL PIC S9(0004) COMP.
  4527     05  CMANTATF PIC  X(0001).
  4528     05  FILLER REDEFINES CMANTATF.
  4529         10  CMANTATA PIC  X(0001).
  4530     05  CMANTATI PIC  X(0005).
  4531*    -------------------------------
  4532     05  CCSRL PIC S9(0004) COMP.
  4533     05  CCSRF PIC  X(0001).
  4534     05  FILLER REDEFINES CCSRF.
  4535         10  CCSRA PIC  X(0001).
  4536     05  CCSRI PIC  X(0004).
  4537*    -------------------------------
  4538     05  CBATCHL PIC S9(0004) COMP.
  4539     05  CBATCHF PIC  X(0001).
  4540     05  FILLER REDEFINES CBATCHF.
  4541         10  CBATCHA PIC  X(0001).
  4542     05  CBATCHI PIC  X(0006).
  4543*    -------------------------------
  4544     05  CSEQL PIC S9(0004) COMP.
  4545     05  CSEQF PIC  X(0001).
  4546     05  FILLER REDEFINES CSEQF.
  4547         10  CSEQA PIC  X(0001).
  4548     05  CSEQI PIC  X(0004).
  4549*    -------------------------------
  4550     05  CMOENDTL PIC S9(0004) COMP.
  4551     05  CMOENDTF PIC  X(0001).
  4552     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  86
* EL6311.cbl
  4553         10  CMOENDTA PIC  X(0001).
  4554     05  CMOENDTI PIC  X(0008).
  4555*    -------------------------------
  4556     05  CCARRL PIC S9(0004) COMP.
  4557     05  CCARRF PIC  X(0001).
  4558     05  FILLER REDEFINES CCARRF.
  4559         10  CCARRA PIC  X(0001).
  4560     05  CCARRI PIC  X(0001).
  4561*    -------------------------------
  4562     05  CGROUPL PIC S9(0004) COMP.
  4563     05  CGROUPF PIC  X(0001).
  4564     05  FILLER REDEFINES CGROUPF.
  4565         10  CGROUPA PIC  X(0001).
  4566     05  CGROUPI PIC  X(0006).
  4567*    -------------------------------
  4568     05  CSTATEL PIC S9(0004) COMP.
  4569     05  CSTATEF PIC  X(0001).
  4570     05  FILLER REDEFINES CSTATEF.
  4571         10  CSTATEA PIC  X(0001).
  4572     05  CSTATEI PIC  X(0002).
  4573*    -------------------------------
  4574     05  CACCTL PIC S9(0004) COMP.
  4575     05  CACCTF PIC  X(0001).
  4576     05  FILLER REDEFINES CACCTF.
  4577         10  CACCTA PIC  X(0001).
  4578     05  CACCTI PIC  X(0010).
  4579*    -------------------------------
  4580     05  CORIGHDL PIC S9(0004) COMP.
  4581     05  CORIGHDF PIC  X(0001).
  4582     05  FILLER REDEFINES CORIGHDF.
  4583         10  CORIGHDA PIC  X(0001).
  4584     05  CORIGHDI PIC  X(0011).
  4585*    -------------------------------
  4586     05  CORGNOL PIC S9(0004) COMP.
  4587     05  CORGNOF PIC  X(0001).
  4588     05  FILLER REDEFINES CORGNOF.
  4589         10  CORGNOA PIC  X(0001).
  4590     05  CORGNOI PIC  X(0006).
  4591*    -------------------------------
  4592     05  CORGSEQL PIC S9(0004) COMP.
  4593     05  CORGSEQF PIC  X(0001).
  4594     05  FILLER REDEFINES CORGSEQF.
  4595         10  CORGSEQA PIC  X(0001).
  4596     05  CORGSEQI PIC  X(0004).
  4597*    -------------------------------
  4598     05  CREFHDGL PIC S9(0004) COMP.
  4599     05  CREFHDGF PIC  X(0001).
  4600     05  FILLER REDEFINES CREFHDGF.
  4601         10  CREFHDGA PIC  X(0001).
  4602     05  CREFHDGI PIC  X(0010).
  4603*    -------------------------------
  4604     05  CREFL PIC S9(0004) COMP.
  4605     05  CREFF PIC  X(0001).
  4606     05  FILLER REDEFINES CREFF.
  4607         10  CREFA PIC  X(0001).
  4608     05  CREFI PIC  X(0012).
  4609*    -------------------------------
  4610     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  87
* EL6311.cbl
  4611     05  CNHINTF PIC  X(0001).
  4612     05  FILLER REDEFINES CNHINTF.
  4613         10  CNHINTA PIC  X(0001).
  4614     05  CNHINTI PIC  9(7)V99.
  4615*    -------------------------------
  4616     05  CCERTNOL PIC S9(0004) COMP.
  4617     05  CCERTNOF PIC  X(0001).
  4618     05  FILLER REDEFINES CCERTNOF.
  4619         10  CCERTNOA PIC  X(0001).
  4620     05  CCERTNOI PIC  X(0010).
  4621*    -------------------------------
  4622     05  CSUFIXL PIC S9(0004) COMP.
  4623     05  CSUFIXF PIC  X(0001).
  4624     05  FILLER REDEFINES CSUFIXF.
  4625         10  CSUFIXA PIC  X(0001).
  4626     05  CSUFIXI PIC  X(0001).
  4627*    -------------------------------
  4628     05  CEFFDTL PIC S9(0004) COMP.
  4629     05  CEFFDTF PIC  X(0001).
  4630     05  FILLER REDEFINES CEFFDTF.
  4631         10  CEFFDTA PIC  X(0001).
  4632     05  CEFFDTI PIC  X(0008).
  4633*    -------------------------------
  4634     05  CLSTNML PIC S9(0004) COMP.
  4635     05  CLSTNMF PIC  X(0001).
  4636     05  FILLER REDEFINES CLSTNMF.
  4637         10  CLSTNMA PIC  X(0001).
  4638     05  CLSTNMI PIC  X(0015).
  4639*    -------------------------------
  4640     05  CINAMEL PIC S9(0004) COMP.
  4641     05  CINAMEF PIC  X(0001).
  4642     05  FILLER REDEFINES CINAMEF.
  4643         10  CINAMEA PIC  X(0001).
  4644     05  CINAMEI PIC  X(0015).
  4645*    -------------------------------
  4646     05  CINITSL PIC S9(0004) COMP.
  4647     05  CINITSF PIC  X(0001).
  4648     05  FILLER REDEFINES CINITSF.
  4649         10  CINITSA PIC  X(0001).
  4650     05  CINITSI PIC  X(0010).
  4651*    -------------------------------
  4652     05  CCANREAL PIC S9(0004) COMP.
  4653     05  CCANREAF PIC  X(0001).
  4654     05  FILLER REDEFINES CCANREAF.
  4655         10  CCANREAA PIC  X(0001).
  4656     05  CCANREAI PIC  X(0001).
  4657*    -------------------------------
  4658     05  ACTSPCL PIC S9(0004) COMP.
  4659     05  ACTSPCF PIC  X(0001).
  4660     05  FILLER REDEFINES ACTSPCF.
  4661         10  ACTSPCA PIC  X(0001).
  4662     05  ACTSPCI PIC  X(0001).
  4663*    -------------------------------
  4664     05  CKIND1L PIC S9(0004) COMP.
  4665     05  CKIND1F PIC  X(0001).
  4666     05  FILLER REDEFINES CKIND1F.
  4667         10  CKIND1A PIC  X(0001).
  4668     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  88
* EL6311.cbl
  4669*    -------------------------------
  4670     05  CCANDT1L PIC S9(0004) COMP.
  4671     05  CCANDT1F PIC  X(0001).
  4672     05  FILLER REDEFINES CCANDT1F.
  4673         10  CCANDT1A PIC  X(0001).
  4674     05  CCANDT1I PIC  X(0008).
  4675*    -------------------------------
  4676     05  CREFND1L PIC S9(0004) COMP.
  4677     05  CREFND1F PIC  X(0001).
  4678     05  FILLER REDEFINES CREFND1F.
  4679         10  CREFND1A PIC  X(0001).
  4680     05  CREFND1I PIC  S9(9)V99.
  4681*    -------------------------------
  4682     05  CMTHD1L PIC S9(0004) COMP.
  4683     05  CMTHD1F PIC  X(0001).
  4684     05  FILLER REDEFINES CMTHD1F.
  4685         10  CMTHD1A PIC  X(0001).
  4686     05  CMTHD1I PIC  X(0001).
  4687*    -------------------------------
  4688     05  CKIND2L PIC S9(0004) COMP.
  4689     05  CKIND2F PIC  X(0001).
  4690     05  FILLER REDEFINES CKIND2F.
  4691         10  CKIND2A PIC  X(0001).
  4692     05  CKIND2I PIC  X(0002).
  4693*    -------------------------------
  4694     05  CCANDT2L PIC S9(0004) COMP.
  4695     05  CCANDT2F PIC  X(0001).
  4696     05  FILLER REDEFINES CCANDT2F.
  4697         10  CCANDT2A PIC  X(0001).
  4698     05  CCANDT2I PIC  X(0008).
  4699*    -------------------------------
  4700     05  CREFND2L PIC S9(0004) COMP.
  4701     05  CREFND2F PIC  X(0001).
  4702     05  FILLER REDEFINES CREFND2F.
  4703         10  CREFND2A PIC  X(0001).
  4704     05  CREFND2I PIC  S9(9)V99.
  4705*    -------------------------------
  4706     05  CMTHD2L PIC S9(0004) COMP.
  4707     05  CMTHD2F PIC  X(0001).
  4708     05  FILLER REDEFINES CMTHD2F.
  4709         10  CMTHD2A PIC  X(0001).
  4710     05  CMTHD2I PIC  X(0001).
  4711*    -------------------------------
  4712     05  CLIVESL PIC S9(0004) COMP.
  4713     05  CLIVESF PIC  X(0001).
  4714     05  FILLER REDEFINES CLIVESF.
  4715         10  CLIVESA PIC  X(0001).
  4716     05  CLIVESI PIC  X(0003).
  4717*    -------------------------------
  4718     05  CFORCEL PIC S9(0004) COMP.
  4719     05  CFORCEF PIC  X(0001).
  4720     05  FILLER REDEFINES CFORCEF.
  4721         10  CFORCEA PIC  X(0001).
  4722     05  CFORCEI PIC  X(0001).
  4723*    -------------------------------
  4724     05  CBILCDL PIC S9(0004) COMP.
  4725     05  CBILCDF PIC  X(0001).
  4726     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  89
* EL6311.cbl
  4727         10  CBILCDA PIC  X(0001).
  4728     05  CBILCDI PIC  X(0001).
  4729*    -------------------------------
  4730     05  CCRFND1L PIC S9(0004) COMP.
  4731     05  CCRFND1F PIC  X(0001).
  4732     05  FILLER REDEFINES CCRFND1F.
  4733         10  CCRFND1A PIC  X(0001).
  4734     05  CCRFND1I PIC  X(0011).
  4735*    -------------------------------
  4736     05  CCRFND2L PIC S9(0004) COMP.
  4737     05  CCRFND2F PIC  X(0001).
  4738     05  FILLER REDEFINES CCRFND2F.
  4739         10  CCRFND2A PIC  X(0001).
  4740     05  CCRFND2I PIC  X(0011).
  4741*    -------------------------------
  4742     05  CBILIT1L PIC S9(0004) COMP.
  4743     05  CBILIT1F PIC  X(0001).
  4744     05  FILLER REDEFINES CBILIT1F.
  4745         10  CBILIT1A PIC  X(0001).
  4746     05  CBILIT1I PIC  X(0008).
  4747*    -------------------------------
  4748     05  CDRFND1L PIC S9(0004) COMP.
  4749     05  CDRFND1F PIC  X(0001).
  4750     05  FILLER REDEFINES CDRFND1F.
  4751         10  CDRFND1A PIC  X(0001).
  4752     05  CDRFND1I PIC  X(0011).
  4753*    -------------------------------
  4754     05  CBILIT2L PIC S9(0004) COMP.
  4755     05  CBILIT2F PIC  X(0001).
  4756     05  FILLER REDEFINES CBILIT2F.
  4757         10  CBILIT2A PIC  X(0001).
  4758     05  CBILIT2I PIC  X(0008).
  4759*    -------------------------------
  4760     05  CDRFND2L PIC S9(0004) COMP.
  4761     05  CDRFND2F PIC  X(0001).
  4762     05  FILLER REDEFINES CDRFND2F.
  4763         10  CDRFND2A PIC  X(0001).
  4764     05  CDRFND2I PIC  X(0011).
  4765*    -------------------------------
  4766     05  CCANTXTL PIC S9(0004) COMP.
  4767     05  CCANTXTF PIC  X(0001).
  4768     05  FILLER REDEFINES CCANTXTF.
  4769         10  CCANTXTA PIC  X(0001).
  4770     05  CCANTXTI PIC  X(0005).
  4771*    -------------------------------
  4772     05  CCANFEEL PIC S9(0004) COMP.
  4773     05  CCANFEEF PIC  X(0001).
  4774     05  FILLER REDEFINES CCANFEEF.
  4775         10  CCANFEEA PIC  X(0001).
  4776     05  CCANFEEI PIC  X(0002).
  4777*    -------------------------------
  4778     05  CTERM1L PIC S9(0004) COMP.
  4779     05  CTERM1F PIC  X(0001).
  4780     05  FILLER REDEFINES CTERM1F.
  4781         10  CTERM1A PIC  X(0001).
  4782     05  CTERM1I PIC  X(0003).
  4783*    -------------------------------
  4784     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  90
* EL6311.cbl
  4785     05  CRTERM1F PIC  X(0001).
  4786     05  FILLER REDEFINES CRTERM1F.
  4787         10  CRTERM1A PIC  X(0001).
  4788     05  CRTERM1I PIC  X(0003).
  4789*    -------------------------------
  4790     05  CPREM1L PIC S9(0004) COMP.
  4791     05  CPREM1F PIC  X(0001).
  4792     05  FILLER REDEFINES CPREM1F.
  4793         10  CPREM1A PIC  X(0001).
  4794     05  CPREM1I PIC  X(0011).
  4795*    -------------------------------
  4796     05  CTERM2L PIC S9(0004) COMP.
  4797     05  CTERM2F PIC  X(0001).
  4798     05  FILLER REDEFINES CTERM2F.
  4799         10  CTERM2A PIC  X(0001).
  4800     05  CTERM2I PIC  X(0003).
  4801*    -------------------------------
  4802     05  CRTERM2L PIC S9(0004) COMP.
  4803     05  CRTERM2F PIC  X(0001).
  4804     05  FILLER REDEFINES CRTERM2F.
  4805         10  CRTERM2A PIC  X(0001).
  4806     05  CRTERM2I PIC  X(0003).
  4807*    -------------------------------
  4808     05  CPREM2L PIC S9(0004) COMP.
  4809     05  CPREM2F PIC  X(0001).
  4810     05  FILLER REDEFINES CPREM2F.
  4811         10  CPREM2A PIC  X(0001).
  4812     05  CPREM2I PIC  X(0011).
  4813*    -------------------------------
  4814     05  CENTRDTL PIC S9(0004) COMP.
  4815     05  CENTRDTF PIC  X(0001).
  4816     05  FILLER REDEFINES CENTRDTF.
  4817         10  CENTRDTA PIC  X(0001).
  4818     05  CENTRDTI PIC  X(0008).
  4819*    -------------------------------
  4820     05  CPAYEEL PIC S9(0004) COMP.
  4821     05  CPAYEEF PIC  X(0001).
  4822     05  FILLER REDEFINES CPAYEEF.
  4823         10  CPAYEEA PIC  X(0001).
  4824     05  CPAYEEI PIC  X(0006).
  4825*    -------------------------------
  4826     05  CRFNDSWL PIC S9(0004) COMP.
  4827     05  CRFNDSWF PIC  X(0001).
  4828     05  FILLER REDEFINES CRFNDSWF.
  4829         10  CRFNDSWA PIC  X(0001).
  4830     05  CRFNDSWI PIC  X(0003).
  4831*    -------------------------------
  4832     05  CLFHDGL PIC S9(0004) COMP.
  4833     05  CLFHDGF PIC  X(0001).
  4834     05  FILLER REDEFINES CLFHDGF.
  4835         10  CLFHDGA PIC  X(0001).
  4836     05  CLFHDGI PIC  X(0006).
  4837*    -------------------------------
  4838     05  CAHHDGL PIC S9(0004) COMP.
  4839     05  CAHHDGF PIC  X(0001).
  4840     05  FILLER REDEFINES CAHHDGF.
  4841         10  CAHHDGA PIC  X(0001).
  4842     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  91
* EL6311.cbl
  4843*    -------------------------------
  4844     05  CENTDTL PIC S9(0004) COMP.
  4845     05  CENTDTF PIC  X(0001).
  4846     05  FILLER REDEFINES CENTDTF.
  4847         10  CENTDTA PIC  X(0001).
  4848     05  CENTDTI PIC  X(0008).
  4849*    -------------------------------
  4850     05  CENTBYL PIC S9(0004) COMP.
  4851     05  CENTBYF PIC  X(0001).
  4852     05  FILLER REDEFINES CENTBYF.
  4853         10  CENTBYA PIC  X(0001).
  4854     05  CENTBYI PIC  X(0004).
  4855*    -------------------------------
  4856     05  CCHGCNTL PIC S9(0004) COMP.
  4857     05  CCHGCNTF PIC  X(0001).
  4858     05  FILLER REDEFINES CCHGCNTF.
  4859         10  CCHGCNTA PIC  X(0001).
  4860     05  CCHGCNTI PIC  X(0003).
  4861*    -------------------------------
  4862     05  CLFREFNL PIC S9(0004) COMP.
  4863     05  CLFREFNF PIC  X(0001).
  4864     05  FILLER REDEFINES CLFREFNF.
  4865         10  CLFREFNA PIC  X(0001).
  4866     05  CLFREFNI PIC  X(0006).
  4867*    -------------------------------
  4868     05  CAHREFNL PIC S9(0004) COMP.
  4869     05  CAHREFNF PIC  X(0001).
  4870     05  FILLER REDEFINES CAHREFNF.
  4871         10  CAHREFNA PIC  X(0001).
  4872     05  CAHREFNI PIC  X(0006).
  4873*    -------------------------------
  4874     05  CREINCDL PIC S9(0004) COMP.
  4875     05  CREINCDF PIC  X(0001).
  4876     05  FILLER REDEFINES CREINCDF.
  4877         10  CREINCDA PIC  X(0001).
  4878     05  CREINCDI PIC  X(0003).
  4879*    -------------------------------
  4880     05  CAEFFDTL PIC S9(0004) COMP.
  4881     05  CAEFFDTF PIC  X(0001).
  4882     05  FILLER REDEFINES CAEFFDTF.
  4883         10  CAEFFDTA PIC  X(0001).
  4884     05  CAEFFDTI PIC  X(0008).
  4885*    -------------------------------
  4886     05  CAEXPDTL PIC S9(0004) COMP.
  4887     05  CAEXPDTF PIC  X(0001).
  4888     05  FILLER REDEFINES CAEXPDTF.
  4889         10  CAEXPDTA PIC  X(0001).
  4890     05  CAEXPDTI PIC  X(0008).
  4891*    -------------------------------
  4892     05  COMMLFL PIC S9(0004) COMP.
  4893     05  COMMLFF PIC  X(0001).
  4894     05  FILLER REDEFINES COMMLFF.
  4895         10  COMMLFA PIC  X(0001).
  4896     05  COMMLFI PIC  X(0006).
  4897*    -------------------------------
  4898     05  COMMAHL PIC S9(0004) COMP.
  4899     05  COMMAHF PIC  X(0001).
  4900     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  92
* EL6311.cbl
  4901         10  COMMAHA PIC  X(0001).
  4902     05  COMMAHI PIC  X(0006).
  4903*    -------------------------------
  4904     05  CERMSG1L PIC S9(0004) COMP.
  4905     05  CERMSG1F PIC  X(0001).
  4906     05  FILLER REDEFINES CERMSG1F.
  4907         10  CERMSG1A PIC  X(0001).
  4908     05  CERMSG1I PIC  X(0078).
  4909*    -------------------------------
  4910     05  CERMSG2L PIC S9(0004) COMP.
  4911     05  CERMSG2F PIC  X(0001).
  4912     05  FILLER REDEFINES CERMSG2F.
  4913         10  CERMSG2A PIC  X(0001).
  4914     05  CERMSG2I PIC  X(0078).
  4915*    -------------------------------
  4916     05  CERMSG3L PIC S9(0004) COMP.
  4917     05  CERMSG3F PIC  X(0001).
  4918     05  FILLER REDEFINES CERMSG3F.
  4919         10  CERMSG3A PIC  X(0001).
  4920     05  CERMSG3I PIC  X(0078).
  4921*    -------------------------------
  4922     05  CPFENTRL PIC S9(0004) COMP.
  4923     05  CPFENTRF PIC  X(0001).
  4924     05  FILLER REDEFINES CPFENTRF.
  4925         10  CPFENTRA PIC  X(0001).
  4926     05  CPFENTRI PIC  9(2).
  4927*    -------------------------------
  4928     05  CPF5HDRL PIC S9(0004) COMP.
  4929     05  CPF5HDRF PIC  X(0001).
  4930     05  FILLER REDEFINES CPF5HDRF.
  4931         10  CPF5HDRA PIC  X(0001).
  4932     05  CPF5HDRI PIC  X(0005).
  4933*    -------------------------------
  4934     05  CPF4HDRL PIC S9(0004) COMP.
  4935     05  CPF4HDRF PIC  X(0001).
  4936     05  FILLER REDEFINES CPF4HDRF.
  4937         10  CPF4HDRA PIC  X(0001).
  4938     05  CPF4HDRI PIC  X(0013).
  4939*    -------------------------------
  4940     05  CF15HDRL PIC S9(0004) COMP.
  4941     05  CF15HDRF PIC  X(0001).
  4942     05  FILLER REDEFINES CF15HDRF.
  4943         10  CF15HDRA PIC  X(0001).
  4944     05  CF15HDRI PIC  X(0022).
  4945 01  EL631CO REDEFINES EL631BI.
  4946     05  FILLER            PIC  X(0012).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CDATEO PIC  X(0008).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CTIMEO PIC  99.99.
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CHEADO PIC  X(0038).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  93
* EL6311.cbl
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CCHGO PIC  ZZZ9.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CMAINTO PIC  X(0001).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CMANTBYO PIC  X(0004).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CCHGHDGO PIC  X(0003).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CMANTDTO PIC  X(0008).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CMANTATO PIC  99.99.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CCSRO PIC  X(0004).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CBATCHO PIC  X(0006).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CSEQO PIC  X(0004).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CMOENDTO PIC  X(0008).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CCARRO PIC  X(0001).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CGROUPO PIC  X(0006).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CSTATEO PIC  X(0002).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CACCTO PIC  X(0010).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CORIGHDO PIC  X(0011).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CORGNOO PIC  X(0006).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CORGSEQO PIC  X(0004).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CREFHDGO PIC  X(0010).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CREFO PIC  X(0012).
  5016*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  94
* EL6311.cbl
  5017     05  FILLER            PIC  X(0003).
  5018     05  CNHINTO PIC  ZZZZZ9.99.
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CCERTNOO PIC  X(0010).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CSUFIXO PIC  X(0001).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CEFFDTO PIC  X(0008).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CLSTNMO PIC  X(0015).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CINAMEO PIC  X(0015).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CINITSO PIC  X(0010).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CCANREAO PIC  X(0001).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  ACTSPCO PIC  X(0001).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CKIND1O PIC  X(0002).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CCANDT1O PIC  X(0008).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CREFND1O PIC  Z(7).99-.
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CMTHD1O PIC  X(0001).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CKIND2O PIC  X(0002).
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CCANDT2O PIC  X(0008).
  5061*    -------------------------------
  5062     05  FILLER            PIC  X(0003).
  5063     05  CREFND2O PIC  Z(7).99-.
  5064*    -------------------------------
  5065     05  FILLER            PIC  X(0003).
  5066     05  CMTHD2O PIC  X(0001).
  5067*    -------------------------------
  5068     05  FILLER            PIC  X(0003).
  5069     05  CLIVESO PIC  X(0003).
  5070*    -------------------------------
  5071     05  FILLER            PIC  X(0003).
  5072     05  CFORCEO PIC  X(0001).
  5073*    -------------------------------
  5074     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  95
* EL6311.cbl
  5075     05  CBILCDO PIC  X(0001).
  5076*    -------------------------------
  5077     05  FILLER            PIC  X(0003).
  5078     05  CCRFND1O PIC  Z(7).99-.
  5079*    -------------------------------
  5080     05  FILLER            PIC  X(0003).
  5081     05  CCRFND2O PIC  Z(7).99-.
  5082*    -------------------------------
  5083     05  FILLER            PIC  X(0003).
  5084     05  CBILIT1O PIC  X(0008).
  5085*    -------------------------------
  5086     05  FILLER            PIC  X(0003).
  5087     05  CDRFND1O PIC  Z(7).99-.
  5088*    -------------------------------
  5089     05  FILLER            PIC  X(0003).
  5090     05  CBILIT2O PIC  X(0008).
  5091*    -------------------------------
  5092     05  FILLER            PIC  X(0003).
  5093     05  CDRFND2O PIC  Z(7).99-.
  5094*    -------------------------------
  5095     05  FILLER            PIC  X(0003).
  5096     05  CCANTXTO PIC  X(0005).
  5097*    -------------------------------
  5098     05  FILLER            PIC  X(0003).
  5099     05  CCANFEEO PIC  Z9.
  5100*    -------------------------------
  5101     05  FILLER            PIC  X(0003).
  5102     05  CTERM1O PIC  ZZ9.
  5103*    -------------------------------
  5104     05  FILLER            PIC  X(0003).
  5105     05  CRTERM1O PIC  ZZ9.
  5106*    -------------------------------
  5107     05  FILLER            PIC  X(0003).
  5108     05  CPREM1O PIC  ZZZZZZ9.99-.
  5109*    -------------------------------
  5110     05  FILLER            PIC  X(0003).
  5111     05  CTERM2O PIC  ZZ9.
  5112*    -------------------------------
  5113     05  FILLER            PIC  X(0003).
  5114     05  CRTERM2O PIC  ZZ9.
  5115*    -------------------------------
  5116     05  FILLER            PIC  X(0003).
  5117     05  CPREM2O PIC  ZZZZZZ9.99-.
  5118*    -------------------------------
  5119     05  FILLER            PIC  X(0003).
  5120     05  CENTRDTO PIC  X(0008).
  5121*    -------------------------------
  5122     05  FILLER            PIC  X(0003).
  5123     05  CPAYEEO PIC  X(0006).
  5124*    -------------------------------
  5125     05  FILLER            PIC  X(0003).
  5126     05  CRFNDSWO PIC  X(0003).
  5127*    -------------------------------
  5128     05  FILLER            PIC  X(0003).
  5129     05  CLFHDGO PIC  X(0006).
  5130*    -------------------------------
  5131     05  FILLER            PIC  X(0003).
  5132     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  96
* EL6311.cbl
  5133*    -------------------------------
  5134     05  FILLER            PIC  X(0003).
  5135     05  CENTDTO PIC  X(0008).
  5136*    -------------------------------
  5137     05  FILLER            PIC  X(0003).
  5138     05  CENTBYO PIC  X(0004).
  5139*    -------------------------------
  5140     05  FILLER            PIC  X(0003).
  5141     05  CCHGCNTO PIC  X(0003).
  5142*    -------------------------------
  5143     05  FILLER            PIC  X(0003).
  5144     05  CLFREFNO PIC  X(0006).
  5145*    -------------------------------
  5146     05  FILLER            PIC  X(0003).
  5147     05  CAHREFNO PIC  X(0006).
  5148*    -------------------------------
  5149     05  FILLER            PIC  X(0003).
  5150     05  CREINCDO PIC  X(0003).
  5151*    -------------------------------
  5152     05  FILLER            PIC  X(0003).
  5153     05  CAEFFDTO PIC  X(0008).
  5154*    -------------------------------
  5155     05  FILLER            PIC  X(0003).
  5156     05  CAEXPDTO PIC  X(0008).
  5157*    -------------------------------
  5158     05  FILLER            PIC  X(0003).
  5159     05  COMMLFO PIC  .99999.
  5160*    -------------------------------
  5161     05  FILLER            PIC  X(0003).
  5162     05  COMMAHO PIC  .99999.
  5163*    -------------------------------
  5164     05  FILLER            PIC  X(0003).
  5165     05  CERMSG1O PIC  X(0078).
  5166*    -------------------------------
  5167     05  FILLER            PIC  X(0003).
  5168     05  CERMSG2O PIC  X(0078).
  5169*    -------------------------------
  5170     05  FILLER            PIC  X(0003).
  5171     05  CERMSG3O PIC  X(0078).
  5172*    -------------------------------
  5173     05  FILLER            PIC  X(0003).
  5174     05  CPFENTRO PIC  X(0002).
  5175*    -------------------------------
  5176     05  FILLER            PIC  X(0003).
  5177     05  CPF5HDRO PIC  X(0005).
  5178*    -------------------------------
  5179     05  FILLER            PIC  X(0003).
  5180     05  CPF4HDRO PIC  X(0013).
  5181*    -------------------------------
  5182     05  FILLER            PIC  X(0003).
  5183     05  CF15HDRO PIC  X(0022).
  5184*    -------------------------------
  5185 01  EL631DI REDEFINES EL631BI.
  5186     05  FILLER            PIC  X(0012).
  5187*    -------------------------------
  5188     05  DDATEL PIC S9(0004) COMP.
  5189     05  DDATEF PIC  X(0001).
  5190     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  97
* EL6311.cbl
  5191         10  DDATEA PIC  X(0001).
  5192     05  DDATEI PIC  X(0008).
  5193*    -------------------------------
  5194     05  DTIMEL PIC S9(0004) COMP.
  5195     05  DTIMEF PIC  X(0001).
  5196     05  FILLER REDEFINES DTIMEF.
  5197         10  DTIMEA PIC  X(0001).
  5198     05  DTIMEI PIC  X(0005).
  5199*    -------------------------------
  5200     05  DHEADL PIC S9(0004) COMP.
  5201     05  DHEADF PIC  X(0001).
  5202     05  FILLER REDEFINES DHEADF.
  5203         10  DHEADA PIC  X(0001).
  5204     05  DHEADI PIC  X(0038).
  5205*    -------------------------------
  5206     05  DLDATEL PIC S9(0004) COMP.
  5207     05  DLDATEF PIC  X(0001).
  5208     05  FILLER REDEFINES DLDATEF.
  5209         10  DLDATEA PIC  X(0001).
  5210     05  DLDATEI PIC  X(0010).
  5211*    -------------------------------
  5212     05  DBATCHL PIC S9(0004) COMP.
  5213     05  DBATCHF PIC  X(0001).
  5214     05  FILLER REDEFINES DBATCHF.
  5215         10  DBATCHA PIC  X(0001).
  5216     05  DBATCHI PIC  X(0011).
  5217*    -------------------------------
  5218     05  DACCTNML PIC S9(0004) COMP.
  5219     05  DACCTNMF PIC  X(0001).
  5220     05  FILLER REDEFINES DACCTNMF.
  5221         10  DACCTNMA PIC  X(0001).
  5222     05  DACCTNMI PIC  X(0030).
  5223*    -------------------------------
  5224     05  DPROCDTL PIC S9(0004) COMP.
  5225     05  DPROCDTF PIC  X(0001).
  5226     05  FILLER REDEFINES DPROCDTF.
  5227         10  DPROCDTA PIC  X(0001).
  5228     05  DPROCDTI PIC  X(0008).
  5229*    -------------------------------
  5230     05  DINPUTL PIC S9(0004) COMP.
  5231     05  DINPUTF PIC  X(0001).
  5232     05  FILLER REDEFINES DINPUTF.
  5233         10  DINPUTA PIC  X(0001).
  5234     05  DINPUTI PIC  X(0008).
  5235*    -------------------------------
  5236     05  DMAINDTL PIC S9(0004) COMP.
  5237     05  DMAINDTF PIC  X(0001).
  5238     05  FILLER REDEFINES DMAINDTF.
  5239         10  DMAINDTA PIC  X(0001).
  5240     05  DMAINDTI PIC  X(0008).
  5241*    -------------------------------
  5242     05  DCARRL PIC S9(0004) COMP.
  5243     05  DCARRF PIC  X(0001).
  5244     05  FILLER REDEFINES DCARRF.
  5245         10  DCARRA PIC  X(0001).
  5246     05  DCARRI PIC  X(0001).
  5247*    -------------------------------
  5248     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  98
* EL6311.cbl
  5249     05  DGROUPF PIC  X(0001).
  5250     05  FILLER REDEFINES DGROUPF.
  5251         10  DGROUPA PIC  X(0001).
  5252     05  DGROUPI PIC  X(0006).
  5253*    -------------------------------
  5254     05  DSTATEL PIC S9(0004) COMP.
  5255     05  DSTATEF PIC  X(0001).
  5256     05  FILLER REDEFINES DSTATEF.
  5257         10  DSTATEA PIC  X(0001).
  5258     05  DSTATEI PIC  X(0002).
  5259*    -------------------------------
  5260     05  DACCTL PIC S9(0004) COMP.
  5261     05  DACCTF PIC  X(0001).
  5262     05  FILLER REDEFINES DACCTF.
  5263         10  DACCTA PIC  X(0001).
  5264     05  DACCTI PIC  X(0010).
  5265*    -------------------------------
  5266     05  DRECVDTL PIC S9(0004) COMP.
  5267     05  DRECVDTF PIC  X(0001).
  5268     05  FILLER REDEFINES DRECVDTF.
  5269         10  DRECVDTA PIC  X(0001).
  5270     05  DRECVDTI PIC  X(0008).
  5271*    -------------------------------
  5272     05  DCSRL PIC S9(0004) COMP.
  5273     05  DCSRF PIC  X(0001).
  5274     05  FILLER REDEFINES DCSRF.
  5275         10  DCSRA PIC  X(0001).
  5276     05  DCSRI PIC  X(0004).
  5277*    -------------------------------
  5278     05  DREFHDGL PIC S9(0004) COMP.
  5279     05  DREFHDGF PIC  X(0001).
  5280     05  FILLER REDEFINES DREFHDGF.
  5281         10  DREFHDGA PIC  X(0001).
  5282     05  DREFHDGI PIC  X(0010).
  5283*    -------------------------------
  5284     05  DREFL PIC S9(0004) COMP.
  5285     05  DREFF PIC  X(0001).
  5286     05  FILLER REDEFINES DREFF.
  5287         10  DREFA PIC  X(0001).
  5288     05  DREFI PIC  X(0012).
  5289*    -------------------------------
  5290     05  DLFPHDGL PIC S9(0004) COMP.
  5291     05  DLFPHDGF PIC  X(0001).
  5292     05  FILLER REDEFINES DLFPHDGF.
  5293         10  DLFPHDGA PIC  X(0001).
  5294     05  DLFPHDGI PIC  X(0010).
  5295*    -------------------------------
  5296     05  DAHPHDGL PIC S9(0004) COMP.
  5297     05  DAHPHDGF PIC  X(0001).
  5298     05  FILLER REDEFINES DAHPHDGF.
  5299         10  DAHPHDGA PIC  X(0001).
  5300     05  DAHPHDGI PIC  X(0010).
  5301*    -------------------------------
  5302     05  DLFRHDGL PIC S9(0004) COMP.
  5303     05  DLFRHDGF PIC  X(0001).
  5304     05  FILLER REDEFINES DLFRHDGF.
  5305         10  DLFRHDGA PIC  X(0001).
  5306     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  99
* EL6311.cbl
  5307*    -------------------------------
  5308     05  DAHRHDGL PIC S9(0004) COMP.
  5309     05  DAHRHDGF PIC  X(0001).
  5310     05  FILLER REDEFINES DAHRHDGF.
  5311         10  DAHRHDGA PIC  X(0001).
  5312     05  DAHRHDGI PIC  X(0009).
  5313*    -------------------------------
  5314     05  DRISSL PIC S9(0004) COMP.
  5315     05  DRISSF PIC  X(0001).
  5316     05  FILLER REDEFINES DRISSF.
  5317         10  DRISSA PIC  X(0001).
  5318     05  DRISSI PIC  X(0005).
  5319*    -------------------------------
  5320     05  DRLFPRML PIC S9(0004) COMP.
  5321     05  DRLFPRMF PIC  X(0001).
  5322     05  FILLER REDEFINES DRLFPRMF.
  5323         10  DRLFPRMA PIC  X(0001).
  5324     05  DRLFPRMI PIC  S9(9)V99.
  5325*    -------------------------------
  5326     05  DRAHPRML PIC S9(0004) COMP.
  5327     05  DRAHPRMF PIC  X(0001).
  5328     05  FILLER REDEFINES DRAHPRMF.
  5329         10  DRAHPRMA PIC  X(0001).
  5330     05  DRAHPRMI PIC  S9(9)V99.
  5331*    -------------------------------
  5332     05  DRCANCL PIC S9(0004) COMP.
  5333     05  DRCANCF PIC  X(0001).
  5334     05  FILLER REDEFINES DRCANCF.
  5335         10  DRCANCA PIC  X(0001).
  5336     05  DRCANCI PIC  X(0005).
  5337*    -------------------------------
  5338     05  DRLFRFDL PIC S9(0004) COMP.
  5339     05  DRLFRFDF PIC  X(0001).
  5340     05  FILLER REDEFINES DRLFRFDF.
  5341         10  DRLFRFDA PIC  X(0001).
  5342     05  DRLFRFDI PIC  S9(9)V99.
  5343*    -------------------------------
  5344     05  DRAHRFDL PIC S9(0004) COMP.
  5345     05  DRAHRFDF PIC  X(0001).
  5346     05  FILLER REDEFINES DRAHRFDF.
  5347         10  DRAHRFDA PIC  X(0001).
  5348     05  DRAHRFDI PIC  S9(9)V99.
  5349*    -------------------------------
  5350     05  DEISSL PIC S9(0004) COMP.
  5351     05  DEISSF PIC  X(0001).
  5352     05  FILLER REDEFINES DEISSF.
  5353         10  DEISSA PIC  X(0001).
  5354     05  DEISSI PIC  X(0005).
  5355*    -------------------------------
  5356     05  DELFPRML PIC S9(0004) COMP.
  5357     05  DELFPRMF PIC  X(0001).
  5358     05  FILLER REDEFINES DELFPRMF.
  5359         10  DELFPRMA PIC  X(0001).
  5360     05  DELFPRMI PIC  X(0011).
  5361*    -------------------------------
  5362     05  DEAHPRML PIC S9(0004) COMP.
  5363     05  DEAHPRMF PIC  X(0001).
  5364     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 100
* EL6311.cbl
  5365         10  DEAHPRMA PIC  X(0001).
  5366     05  DEAHPRMI PIC  X(0011).
  5367*    -------------------------------
  5368     05  DECANCL PIC S9(0004) COMP.
  5369     05  DECANCF PIC  X(0001).
  5370     05  FILLER REDEFINES DECANCF.
  5371         10  DECANCA PIC  X(0001).
  5372     05  DECANCI PIC  X(0005).
  5373*    -------------------------------
  5374     05  DELFRFDL PIC S9(0004) COMP.
  5375     05  DELFRFDF PIC  X(0001).
  5376     05  FILLER REDEFINES DELFRFDF.
  5377         10  DELFRFDA PIC  X(0001).
  5378     05  DELFRFDI PIC  X(0011).
  5379*    -------------------------------
  5380     05  DEAHRFDL PIC S9(0004) COMP.
  5381     05  DEAHRFDF PIC  X(0001).
  5382     05  FILLER REDEFINES DEAHRFDF.
  5383         10  DEAHRFDA PIC  X(0001).
  5384     05  DEAHRFDI PIC  X(0011).
  5385*    -------------------------------
  5386     05  DCISSL PIC S9(0004) COMP.
  5387     05  DCISSF PIC  X(0001).
  5388     05  FILLER REDEFINES DCISSF.
  5389         10  DCISSA PIC  X(0001).
  5390     05  DCISSI PIC  X(0005).
  5391*    -------------------------------
  5392     05  DCLFPRML PIC S9(0004) COMP.
  5393     05  DCLFPRMF PIC  X(0001).
  5394     05  FILLER REDEFINES DCLFPRMF.
  5395         10  DCLFPRMA PIC  X(0001).
  5396     05  DCLFPRMI PIC  X(0011).
  5397*    -------------------------------
  5398     05  DCAHPRML PIC S9(0004) COMP.
  5399     05  DCAHPRMF PIC  X(0001).
  5400     05  FILLER REDEFINES DCAHPRMF.
  5401         10  DCAHPRMA PIC  X(0001).
  5402     05  DCAHPRMI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DCCANCL PIC S9(0004) COMP.
  5405     05  DCCANCF PIC  X(0001).
  5406     05  FILLER REDEFINES DCCANCF.
  5407         10  DCCANCA PIC  X(0001).
  5408     05  DCCANCI PIC  X(0005).
  5409*    -------------------------------
  5410     05  DCLFRFDL PIC S9(0004) COMP.
  5411     05  DCLFRFDF PIC  X(0001).
  5412     05  FILLER REDEFINES DCLFRFDF.
  5413         10  DCLFRFDA PIC  X(0001).
  5414     05  DCLFRFDI PIC  X(0011).
  5415*    -------------------------------
  5416     05  DCAHRFDL PIC S9(0004) COMP.
  5417     05  DCAHRFDF PIC  X(0001).
  5418     05  FILLER REDEFINES DCAHRFDF.
  5419         10  DCAHRFDA PIC  X(0001).
  5420     05  DCAHRFDI PIC  X(0011).
  5421*    -------------------------------
  5422     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 101
* EL6311.cbl
  5423     05  DOISSF PIC  X(0001).
  5424     05  FILLER REDEFINES DOISSF.
  5425         10  DOISSA PIC  X(0001).
  5426     05  DOISSI PIC  X(0005).
  5427*    -------------------------------
  5428     05  DOLFPRML PIC S9(0004) COMP.
  5429     05  DOLFPRMF PIC  X(0001).
  5430     05  FILLER REDEFINES DOLFPRMF.
  5431         10  DOLFPRMA PIC  X(0001).
  5432     05  DOLFPRMI PIC  X(0011).
  5433*    -------------------------------
  5434     05  DOAHPRML PIC S9(0004) COMP.
  5435     05  DOAHPRMF PIC  X(0001).
  5436     05  FILLER REDEFINES DOAHPRMF.
  5437         10  DOAHPRMA PIC  X(0001).
  5438     05  DOAHPRMI PIC  X(0011).
  5439*    -------------------------------
  5440     05  DOCANCL PIC S9(0004) COMP.
  5441     05  DOCANCF PIC  X(0001).
  5442     05  FILLER REDEFINES DOCANCF.
  5443         10  DOCANCA PIC  X(0001).
  5444     05  DOCANCI PIC  X(0005).
  5445*    -------------------------------
  5446     05  DOLFRFDL PIC S9(0004) COMP.
  5447     05  DOLFRFDF PIC  X(0001).
  5448     05  FILLER REDEFINES DOLFRFDF.
  5449         10  DOLFRFDA PIC  X(0001).
  5450     05  DOLFRFDI PIC  X(0011).
  5451*    -------------------------------
  5452     05  DOAHRFDL PIC S9(0004) COMP.
  5453     05  DOAHRFDF PIC  X(0001).
  5454     05  FILLER REDEFINES DOAHRFDF.
  5455         10  DOAHRFDA PIC  X(0001).
  5456     05  DOAHRFDI PIC  X(0011).
  5457*    -------------------------------
  5458     05  DITOTALL PIC S9(0004) COMP.
  5459     05  DITOTALF PIC  X(0001).
  5460     05  FILLER REDEFINES DITOTALF.
  5461         10  DITOTALA PIC  X(0001).
  5462     05  DITOTALI PIC  X(0005).
  5463*    -------------------------------
  5464     05  DIFATALL PIC S9(0004) COMP.
  5465     05  DIFATALF PIC  X(0001).
  5466     05  FILLER REDEFINES DIFATALF.
  5467         10  DIFATALA PIC  X(0001).
  5468     05  DIFATALI PIC  X(0005).
  5469*    -------------------------------
  5470     05  DIFORCEL PIC S9(0004) COMP.
  5471     05  DIFORCEF PIC  X(0001).
  5472     05  FILLER REDEFINES DIFORCEF.
  5473         10  DIFORCEA PIC  X(0001).
  5474     05  DIFORCEI PIC  X(0005).
  5475*    -------------------------------
  5476     05  DIHOLDL PIC S9(0004) COMP.
  5477     05  DIHOLDF PIC  X(0001).
  5478     05  FILLER REDEFINES DIHOLDF.
  5479         10  DIHOLDA PIC  X(0001).
  5480     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 102
* EL6311.cbl
  5481*    -------------------------------
  5482     05  DIAVAILL PIC S9(0004) COMP.
  5483     05  DIAVAILF PIC  X(0001).
  5484     05  FILLER REDEFINES DIAVAILF.
  5485         10  DIAVAILA PIC  X(0001).
  5486     05  DIAVAILI PIC  X(0005).
  5487*    -------------------------------
  5488     05  DIGPREML PIC S9(0004) COMP.
  5489     05  DIGPREMF PIC  X(0001).
  5490     05  FILLER REDEFINES DIGPREMF.
  5491         10  DIGPREMA PIC  X(0001).
  5492     05  DIGPREMI PIC  X(0011).
  5493*    -------------------------------
  5494     05  DIBPREML PIC S9(0004) COMP.
  5495     05  DIBPREMF PIC  X(0001).
  5496     05  FILLER REDEFINES DIBPREMF.
  5497         10  DIBPREMA PIC  X(0001).
  5498     05  DIBPREMI PIC  X(0011).
  5499*    -------------------------------
  5500     05  DCTOTALL PIC S9(0004) COMP.
  5501     05  DCTOTALF PIC  X(0001).
  5502     05  FILLER REDEFINES DCTOTALF.
  5503         10  DCTOTALA PIC  X(0001).
  5504     05  DCTOTALI PIC  X(0005).
  5505*    -------------------------------
  5506     05  DCFATALL PIC S9(0004) COMP.
  5507     05  DCFATALF PIC  X(0001).
  5508     05  FILLER REDEFINES DCFATALF.
  5509         10  DCFATALA PIC  X(0001).
  5510     05  DCFATALI PIC  X(0005).
  5511*    -------------------------------
  5512     05  DCFORCEL PIC S9(0004) COMP.
  5513     05  DCFORCEF PIC  X(0001).
  5514     05  FILLER REDEFINES DCFORCEF.
  5515         10  DCFORCEA PIC  X(0001).
  5516     05  DCFORCEI PIC  X(0005).
  5517*    -------------------------------
  5518     05  DCHOLDL PIC S9(0004) COMP.
  5519     05  DCHOLDF PIC  X(0001).
  5520     05  FILLER REDEFINES DCHOLDF.
  5521         10  DCHOLDA PIC  X(0001).
  5522     05  DCHOLDI PIC  X(0005).
  5523*    -------------------------------
  5524     05  DCAVAILL PIC S9(0004) COMP.
  5525     05  DCAVAILF PIC  X(0001).
  5526     05  FILLER REDEFINES DCAVAILF.
  5527         10  DCAVAILA PIC  X(0001).
  5528     05  DCAVAILI PIC  X(0005).
  5529*    -------------------------------
  5530     05  DCGPREML PIC S9(0004) COMP.
  5531     05  DCGPREMF PIC  X(0001).
  5532     05  FILLER REDEFINES DCGPREMF.
  5533         10  DCGPREMA PIC  X(0001).
  5534     05  DCGPREMI PIC  X(0011).
  5535*    -------------------------------
  5536     05  DCBPREML PIC S9(0004) COMP.
  5537     05  DCBPREMF PIC  X(0001).
  5538     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 103
* EL6311.cbl
  5539         10  DCBPREMA PIC  X(0001).
  5540     05  DCBPREMI PIC  X(0011).
  5541*    -------------------------------
  5542     05  DNTOTALL PIC S9(0004) COMP.
  5543     05  DNTOTALF PIC  X(0001).
  5544     05  FILLER REDEFINES DNTOTALF.
  5545         10  DNTOTALA PIC  X(0001).
  5546     05  DNTOTALI PIC  X(0005).
  5547*    -------------------------------
  5548     05  DNFATALL PIC S9(0004) COMP.
  5549     05  DNFATALF PIC  X(0001).
  5550     05  FILLER REDEFINES DNFATALF.
  5551         10  DNFATALA PIC  X(0001).
  5552     05  DNFATALI PIC  X(0005).
  5553*    -------------------------------
  5554     05  DNFORCEL PIC S9(0004) COMP.
  5555     05  DNFORCEF PIC  X(0001).
  5556     05  FILLER REDEFINES DNFORCEF.
  5557         10  DNFORCEA PIC  X(0001).
  5558     05  DNFORCEI PIC  X(0005).
  5559*    -------------------------------
  5560     05  DNHOLDL PIC S9(0004) COMP.
  5561     05  DNHOLDF PIC  X(0001).
  5562     05  FILLER REDEFINES DNHOLDF.
  5563         10  DNHOLDA PIC  X(0001).
  5564     05  DNHOLDI PIC  X(0005).
  5565*    -------------------------------
  5566     05  DNAVAILL PIC S9(0004) COMP.
  5567     05  DNAVAILF PIC  X(0001).
  5568     05  FILLER REDEFINES DNAVAILF.
  5569         10  DNAVAILA PIC  X(0001).
  5570     05  DNAVAILI PIC  X(0005).
  5571*    -------------------------------
  5572     05  DNGPREML PIC S9(0004) COMP.
  5573     05  DNGPREMF PIC  X(0001).
  5574     05  FILLER REDEFINES DNGPREMF.
  5575         10  DNGPREMA PIC  X(0001).
  5576     05  DNGPREMI PIC  X(0011).
  5577*    -------------------------------
  5578     05  DNBPREML PIC S9(0004) COMP.
  5579     05  DNBPREMF PIC  X(0001).
  5580     05  FILLER REDEFINES DNBPREMF.
  5581         10  DNBPREMA PIC  X(0001).
  5582     05  DNBPREMI PIC  X(0011).
  5583*    -------------------------------
  5584     05  DERMSGL PIC S9(0004) COMP.
  5585     05  DERMSGF PIC  X(0001).
  5586     05  FILLER REDEFINES DERMSGF.
  5587         10  DERMSGA PIC  X(0001).
  5588     05  DERMSGI PIC  X(0075).
  5589*    -------------------------------
  5590     05  DPFENTRL PIC S9(0004) COMP.
  5591     05  DPFENTRF PIC  X(0001).
  5592     05  FILLER REDEFINES DPFENTRF.
  5593         10  DPFENTRA PIC  X(0001).
  5594     05  DPFENTRI PIC  9(2).
  5595 01  EL631DO REDEFINES EL631BI.
  5596     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 104
* EL6311.cbl
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DDATEO PIC  X(0008).
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DTIMEO PIC  99.99.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DHEADO PIC  X(0038).
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DLDATEO PIC  X(0010).
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DBATCHO PIC  X(0011).
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DACCTNMO PIC  X(0030).
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DPROCDTO PIC  X(0008).
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DINPUTO PIC  X(0008).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DMAINDTO PIC  X(0008).
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DCARRO PIC  X(0001).
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DGROUPO PIC  X(0006).
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DSTATEO PIC  X(0002).
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DACCTO PIC  X(0010).
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DRECVDTO PIC  X(0008).
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DCSRO PIC  X(0004).
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DREFHDGO PIC  X(0010).
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DREFO PIC  X(0012).
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DLFPHDGO PIC  X(0010).
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DAHPHDGO PIC  X(0010).
  5654*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 105
* EL6311.cbl
  5655     05  FILLER            PIC  X(0003).
  5656     05  DLFRHDGO PIC  X(0009).
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DAHRHDGO PIC  X(0009).
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DRISSO PIC  ZZ99-.
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DRCANCO PIC  ZZ99-.
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5678*    -------------------------------
  5679     05  FILLER            PIC  X(0003).
  5680     05  DEISSO PIC  ZZ99-.
  5681*    -------------------------------
  5682     05  FILLER            PIC  X(0003).
  5683     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5684*    -------------------------------
  5685     05  FILLER            PIC  X(0003).
  5686     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5687*    -------------------------------
  5688     05  FILLER            PIC  X(0003).
  5689     05  DECANCO PIC  ZZ99-.
  5690*    -------------------------------
  5691     05  FILLER            PIC  X(0003).
  5692     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5693*    -------------------------------
  5694     05  FILLER            PIC  X(0003).
  5695     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5696*    -------------------------------
  5697     05  FILLER            PIC  X(0003).
  5698     05  DCISSO PIC  ZZ99-.
  5699*    -------------------------------
  5700     05  FILLER            PIC  X(0003).
  5701     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5702*    -------------------------------
  5703     05  FILLER            PIC  X(0003).
  5704     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5705*    -------------------------------
  5706     05  FILLER            PIC  X(0003).
  5707     05  DCCANCO PIC  ZZ99-.
  5708*    -------------------------------
  5709     05  FILLER            PIC  X(0003).
  5710     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5711*    -------------------------------
  5712     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 106
* EL6311.cbl
  5713     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5714*    -------------------------------
  5715     05  FILLER            PIC  X(0003).
  5716     05  DOISSO PIC  ZZ99-.
  5717*    -------------------------------
  5718     05  FILLER            PIC  X(0003).
  5719     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5720*    -------------------------------
  5721     05  FILLER            PIC  X(0003).
  5722     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5723*    -------------------------------
  5724     05  FILLER            PIC  X(0003).
  5725     05  DOCANCO PIC  ZZ99-.
  5726*    -------------------------------
  5727     05  FILLER            PIC  X(0003).
  5728     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5729*    -------------------------------
  5730     05  FILLER            PIC  X(0003).
  5731     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5732*    -------------------------------
  5733     05  FILLER            PIC  X(0003).
  5734     05  DITOTALO PIC  ZZZ99.
  5735*    -------------------------------
  5736     05  FILLER            PIC  X(0003).
  5737     05  DIFATALO PIC  ZZZ99.
  5738*    -------------------------------
  5739     05  FILLER            PIC  X(0003).
  5740     05  DIFORCEO PIC  ZZZ99.
  5741*    -------------------------------
  5742     05  FILLER            PIC  X(0003).
  5743     05  DIHOLDO PIC  ZZZ99.
  5744*    -------------------------------
  5745     05  FILLER            PIC  X(0003).
  5746     05  DIAVAILO PIC  ZZZ99.
  5747*    -------------------------------
  5748     05  FILLER            PIC  X(0003).
  5749     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5750*    -------------------------------
  5751     05  FILLER            PIC  X(0003).
  5752     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5753*    -------------------------------
  5754     05  FILLER            PIC  X(0003).
  5755     05  DCTOTALO PIC  ZZZ99.
  5756*    -------------------------------
  5757     05  FILLER            PIC  X(0003).
  5758     05  DCFATALO PIC  ZZZ99.
  5759*    -------------------------------
  5760     05  FILLER            PIC  X(0003).
  5761     05  DCFORCEO PIC  ZZZ99.
  5762*    -------------------------------
  5763     05  FILLER            PIC  X(0003).
  5764     05  DCHOLDO PIC  ZZZ99.
  5765*    -------------------------------
  5766     05  FILLER            PIC  X(0003).
  5767     05  DCAVAILO PIC  ZZZ99.
  5768*    -------------------------------
  5769     05  FILLER            PIC  X(0003).
  5770     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 107
* EL6311.cbl
  5771*    -------------------------------
  5772     05  FILLER            PIC  X(0003).
  5773     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5774*    -------------------------------
  5775     05  FILLER            PIC  X(0003).
  5776     05  DNTOTALO PIC  ---99.
  5777*    -------------------------------
  5778     05  FILLER            PIC  X(0003).
  5779     05  DNFATALO PIC  ---99.
  5780*    -------------------------------
  5781     05  FILLER            PIC  X(0003).
  5782     05  DNFORCEO PIC  ---99.
  5783*    -------------------------------
  5784     05  FILLER            PIC  X(0003).
  5785     05  DNHOLDO PIC  ---99.
  5786*    -------------------------------
  5787     05  FILLER            PIC  X(0003).
  5788     05  DNAVAILO PIC  ---99.
  5789*    -------------------------------
  5790     05  FILLER            PIC  X(0003).
  5791     05  DNGPREMO PIC  -------9.99.
  5792*    -------------------------------
  5793     05  FILLER            PIC  X(0003).
  5794     05  DNBPREMO PIC  -------9.99.
  5795*    -------------------------------
  5796     05  FILLER            PIC  X(0003).
  5797     05  DERMSGO PIC  X(0075).
  5798*    -------------------------------
  5799     05  FILLER            PIC  X(0003).
  5800     05  DPFENTRO PIC  X(0002).
  5801*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 108
* EL6311.cbl
  5803 01  MAP-B REDEFINES EL631BI.
  5804     12  FILLER                  PIC X(595).
  5805*    12  FILLER                  PIC X(591).
  5806*    12  FILLER                  PIC X(512).
  5807*    12  FILLER                  PIC X(510).
  5808     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5809         16  BKIND-LEN               PIC S9(4)  COMP.
  5810         16  BKIND-ATTRB             PIC X.
  5811         16  BKIND                   PIC XX.
  5812         16  BTYPE-LEN               PIC S9(4)  COMP.
  5813         16  BTYPE-ATTRB             PIC X.
  5814         16  BTYPE                   PIC X(3).
  5815         16  BTERM-LEN               PIC S9(4)  COMP.
  5816         16  BTERM-ATTRB             PIC X.
  5817         16  BTERMI                  PIC 999.
  5818         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5819         16  BBEN-LEN                PIC S9(4)  COMP.
  5820         16  BBEN-ATTRB              PIC X.
  5821         16  BBENI                   PIC 9(10)V99.
  5822*        16  BBENI                   PIC 9(12).
  5823         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5824         16  BPREM-LEN               PIC S9(4)  COMP.
  5825         16  BPREM-ATTRB             PIC X.
  5826         16  BPREMI                  PIC S9(9)V99.
  5827*        16  BPREMI                  PIC 9(11).
  5828         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5829         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5830         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5831         16  BEXPIRE-ATTRB           PIC X.
  5832         16  BEXPIRE                 PIC X(8).
  5833         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5834         16  BCRIT-PERD-ATTRB        PIC X.
  5835         16  BCRIT-PERDI             PIC 99.
  5836         16  BCRIT-PERDO REDEFINES
  5837                         BCRIT-PERDI PIC ZZ.
  5838         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5839         16  BALT-BEN-ATTRB          PIC X.
  5840         16  BALT-BENI               PIC 9(10)V99.
  5841*        16  BALT-BENI               PIC 9(12).
  5842         16  BALT-BENO REDEFINES
  5843                           BALT-BENI PIC Z(9).ZZ.
  5844         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5845         16  BALT-PREM-ATTRB         PIC X.
  5846         16  BALT-PREMI              PIC 9(9)V99.
  5847*        16  BALT-PREMI              PIC 9(11).
  5848         16  BALT-PREMO REDEFINES
  5849                          BALT-PREMI PIC Z(7).ZZ-.
  5850         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5851         16  BBEN-CD-ATTRB           PIC X.
  5852         16  BBEN-CD                 PIC XXX.
  5853         16  BCPREM-LEN              PIC S9(4)  COMP.
  5854         16  BCPREM-ATTRB            PIC X.
  5855         16  BCPREMI                 PIC S9(9)V99.
  5856*        16  BCPREMI                 PIC X(11).
  5857         16  BCPREMO REDEFINES BCPREMI
  5858                                     PIC Z(7).99-.
  5859         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5860         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 109
* EL6311.cbl
  5861         16  BCALT-PREM              PIC Z(7).99-.
  5862         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5863         16  BBEN-ABBR-ATTRB         PIC X.
  5864         16  BBEN-ABBR               PIC X(5).
  5865         16  BDIFF-LEN               PIC S9(4)  COMP.
  5866         16  BDIFF-ATTRB             PIC X.
  5867         16  BDIFFO                  PIC Z(7).99-.
  5868         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5869         16  BBILL-LIT-ATTRB         PIC X.
  5870         16  BBILL-LIT               PIC X(8).
  5871         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5872         16  BDALT-PREM-ATTRB        PIC X.
  5873         16  BDALT-PREM              PIC Z(7).99-.
  5874
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 110
* EL6311.cbl
  5876
  5877****************************************************************
  5878*
  5879* Copyright (c) 2007-2013 Dell Inc.
  5880* All rights reserved.
  5881*
  5882****************************************************************
  5883 01  DFHEIV.
  5884   02  DFHEIV0               PIC X(35).
  5885   02  DFHEIV1               PIC X(08).
  5886   02  DFHEIV2               PIC X(08).
  5887   02  DFHEIV3               PIC X(08).
  5888   02  DFHEIV4               PIC X(06).
  5889   02  DFHEIV5               PIC X(04).
  5890   02  DFHEIV6               PIC X(04).
  5891   02  DFHEIV7               PIC X(02).
  5892   02  DFHEIV8               PIC X(02).
  5893   02  DFHEIV9               PIC X(01).
  5894   02  DFHEIV10              PIC S9(7) COMP-3.
  5895   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5896   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5897   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5898   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5899   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5900   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5901   02  DFHEIV17              PIC X(04).
  5902   02  DFHEIV18              PIC X(04).
  5903   02  DFHEIV19              PIC X(04).
  5904   02  DFHEIV20              USAGE IS POINTER.
  5905   02  DFHEIV21              USAGE IS POINTER.
  5906   02  DFHEIV22              USAGE IS POINTER.
  5907   02  DFHEIV23              USAGE IS POINTER.
  5908   02  DFHEIV24              USAGE IS POINTER.
  5909   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5910   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5911   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5912   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5913   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5914   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5915   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5916   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5917   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5918   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5919   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5920   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5921   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5922   02  FILLER                PIC X(02).
  5923   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5924   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5925   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5926   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5927   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5928   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5929   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5930 LINKAGE  SECTION.
  5931*****************************************************************
  5932*                                                               *
  5933* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 111
* EL6311.cbl
  5934* All rights reserved.                                          *
  5935*                                                               *
  5936*****************************************************************
  5937 01  dfheiblk.
  5938     02  eibtime          pic s9(7) comp-3.
  5939     02  eibdate          pic s9(7) comp-3.
  5940     02  eibtrnid         pic x(4).
  5941     02  eibtaskn         pic s9(7) comp-3.
  5942     02  eibtrmid         pic x(4).
  5943     02  dfheigdi         pic s9(4) comp.
  5944     02  eibcposn         pic s9(4) comp.
  5945     02  eibcalen         pic s9(4) comp.
  5946     02  eibaid           pic x(1).
  5947     02  eibfiller1       pic x(1).
  5948     02  eibfn            pic x(2).
  5949     02  eibfiller2       pic x(2).
  5950     02  eibrcode         pic x(6).
  5951     02  eibfiller3       pic x(2).
  5952     02  eibds            pic x(8).
  5953     02  eibreqid         pic x(8).
  5954     02  eibrsrce         pic x(8).
  5955     02  eibsync          pic x(1).
  5956     02  eibfree          pic x(1).
  5957     02  eibrecv          pic x(1).
  5958     02  eibsend          pic x(1).
  5959     02  eibatt           pic x(1).
  5960     02  eibeoc           pic x(1).
  5961     02  eibfmh           pic x(1).
  5962     02  eibcompl         pic x(1).
  5963     02  eibsig           pic x(1).
  5964     02  eibconf          pic x(1).
  5965     02  eiberr           pic x(1).
  5966     02  eibrldbk         pic x(1).
  5967     02  eiberrcd         pic x(4).
  5968     02  eibsynrb         pic x(1).
  5969     02  eibnodat         pic x(1).
  5970     02  eibfiller5       pic x(2).
  5971     02  eibresp          pic s9(8) comp.
  5972     02  eibresp2         pic s9(8) comp.
  5973     02  dfheigdj         pic s9(4) comp.
  5974     02  dfheigdk         pic s9(4) comp.
  5975 01  DFHCOMMAREA                 PIC X(1300).
  5976*                                COPY ERCPNDB.
  5977******************************************************************
  5978*                                                                *
  5979*                                                                *
  5980*                            ERCPNDB.                            *
  5981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5982*                            VMOD=2.025                          *
  5983*                                                                *
  5984*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5985*                                                                *
  5986******************************************************************
  5987*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5988*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5989******************************************************************
  5990*                                                                *
  5991*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 112
* EL6311.cbl
  5992*   FILE TYPE = VSAM,KSDS                                        *
  5993*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5994*                                                                *
  5995*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5996*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5997*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5998*                                                 RKP=13,LEN=36  *
  5999*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6000*                                      AND CHG-SEQ.)             *
  6001*                                                RKP=49,LEN=11   *
  6002*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6003*                                      AND CHG-SEQ.)             *
  6004*                                                RKP=60,LEN=15   *
  6005*                                                                *
  6006*   LOG = NO                                                     *
  6007*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6008******************************************************************
  6009******************************************************************
  6010*                   C H A N G E   L O G
  6011*
  6012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6013*-----------------------------------------------------------------
  6014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6015* EFFECTIVE    NUMBER
  6016*-----------------------------------------------------------------
  6017* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6018* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6019* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6020* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6021* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6022* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6023* 032306                   PEMA  ADD BOW LOAN NUMBER
  6024* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6025* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6026* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6027* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6028* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6029* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6030* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6031* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6032* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6033* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6034* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6035* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6036* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6037******************************************************************
  6038
  6039 01  PENDING-BUSINESS.
  6040     12  PB-RECORD-ID                     PIC XX.
  6041         88  VALID-PB-ID                        VALUE 'PB'.
  6042
  6043     12  PB-CONTROL-PRIMARY.
  6044         16  PB-COMPANY-CD                PIC X.
  6045         16  PB-ENTRY-BATCH               PIC X(6).
  6046         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6047         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6048
  6049     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 113
* EL6311.cbl
  6050         16  PB-COMPANY-CD-A1             PIC X.
  6051         16  PB-CARRIER                   PIC X.
  6052         16  PB-GROUPING.
  6053             20  PB-GROUPING-PREFIX       PIC XXX.
  6054             20  PB-GROUPING-PRIME        PIC XXX.
  6055         16  PB-STATE                     PIC XX.
  6056         16  PB-ACCOUNT.
  6057             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6058             20  PB-ACCOUNT-PRIME         PIC X(6).
  6059         16  PB-CERT-EFF-DT               PIC XX.
  6060         16  PB-CERT-NO.
  6061             20  PB-CERT-PRIME            PIC X(10).
  6062             20  PB-CERT-SFX              PIC X.
  6063         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6064
  6065         16  PB-RECORD-TYPE               PIC X.
  6066             88  PB-MAILING-DATA                VALUE '0'.
  6067             88  PB-ISSUE                       VALUE '1'.
  6068             88  PB-CANCELLATION                VALUE '2'.
  6069             88  PB-BATCH-TRAILER               VALUE '9'.
  6070
  6071     12  PB-CONTROL-BY-ORIG-BATCH.
  6072         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6073         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6074         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6075         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6076
  6077     12  PB-CONTROL-BY-CSR.
  6078         16  PB-CSR-COMPANY-CD            PIC X.
  6079         16  PB-CSR-ID                    PIC X(4).
  6080         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6081         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6082         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6083******************************************************************
  6084*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6085******************************************************************
  6086
  6087     12  PB-LAST-MAINT-DT                 PIC XX.
  6088     12  PB-LAST-MAINT-BY                 PIC X(4).
  6089     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6090
  6091     12  PB-RECORD-BODY                   PIC X(375).
  6092
  6093     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6094         16  PB-CERT-ORIGIN               PIC X.
  6095             88  CLASIC-CREATED-CERT         VALUE '1'.
  6096         16  PB-I-NAME.
  6097             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6098             20  PB-I-INSURED-FIRST-NAME.
  6099                 24  PB-I-INSURED-1ST-INIT PIC X.
  6100                 24  FILLER                PIC X(9).
  6101             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6102         16  PB-I-AGE                     PIC S99   COMP-3.
  6103         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6104         16  PB-I-BIRTHDAY                PIC XX.
  6105         16  PB-I-INSURED-SEX             PIC X.
  6106             88  PB-SEX-MALE     VALUE 'M'.
  6107             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 114
* EL6311.cbl
  6108
  6109         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6110         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6111         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6112         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6113         16  PB-I-SKIP-CODE               PIC X.
  6114             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6115             88  PB-SKIP-JULY              VALUE '1'.
  6116             88  PB-SKIP-AUGUST            VALUE '2'.
  6117             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6118             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6119             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6120             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6121             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6122             88  PB-SKIP-JUNE              VALUE '8'.
  6123             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6124             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6125             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6126         16  PB-I-TERM-TYPE               PIC X.
  6127             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6128             88  PB-PAID-WEEKLY            VALUE 'W'.
  6129             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6130             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6131             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6132         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6133         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6134         16  PB-I-DATA-ENTRY-SW           PIC X.
  6135             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6136             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6137             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6138             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6139         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6140         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6141*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6142         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6143         16  PB-I-LETTER-REQD             PIC X.
  6144
  6145         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6146             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6147             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6148                                                   '90' THRU '99'.
  6149         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6150                                          PIC XX.
  6151         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6152         16  PB-I-AMOUNT-FINANCED REDEFINES
  6153                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6154         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6155         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6156                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6157         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6158         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6159         16  PB-I-CLP-AMOUNT REDEFINES
  6160                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6161         16  PB-I-LF-CALC-FLAG            PIC X.
  6162             88 PB-COMP-LF-PREM               VALUE '?'.
  6163         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6164         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6165         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 115
* EL6311.cbl
  6166         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6167         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6168         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6169         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6170         16  PB-I-LF-ABBR                 PIC XXX.
  6171         16  PB-I-LF-INPUT-CD             PIC XX.
  6172
  6173         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6174             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6175             88  PB-INVALID-AH               VALUE '  ' '00'
  6176                                                   '90' THRU '99'.
  6177         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6178         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6179         16  PB-I-AH-CALC-FLAG            PIC X.
  6180             88 PB-COMP-AH-PREM                  VALUE '?'.
  6181         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6182         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6183         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6184         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6185         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6186         16  PB-I-AH-ABBR                 PIC XXX.
  6187         16  PB-I-AH-INPUT-CD             PIC XXX.
  6188
  6189         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6190         16  PB-I-REIN-TABLE              PIC XXX.
  6191         16  PB-I-BUSINESS-TYPE           PIC 99.
  6192         16  PB-I-INDV-GRP-CD             PIC X.
  6193         16  PB-I-MORT-CODE.
  6194             20  PB-I-TABLE               PIC X.
  6195             20  PB-I-INTEREST            PIC XX.
  6196             20  PB-I-MORT-TYP            PIC X.
  6197         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6198         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6199         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6200         16  PB-I-INDV-GRP-OVRD           PIC X.
  6201         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6202         16  PB-I-SIG-SW                  PIC X.
  6203             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6204         16  PB-I-RATE-CLASS              PIC XX.
  6205         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6206         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6207         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6208         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6209         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6210         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6211         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6212         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6213         16  PB-I-OB-FLAG                 PIC X.
  6214             88  PB-I-OB                      VALUE 'B'.
  6215             88  PB-I-SUMMARY                 VALUE 'Z'.
  6216         16  PB-I-ENTRY-STATUS            PIC X.
  6217             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6218                                              'M' '5' '9' '2'.
  6219             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6220             88  PB-I-POLICY-PENDING          VALUE '2'.
  6221             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6222             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6223             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 116
* EL6311.cbl
  6224             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6225             88  PB-I-REIN-ONLY               VALUE '9'.
  6226             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6227             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6228             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6229             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6230         16  PB-I-INT-CODE                PIC X.
  6231             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6232             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6233         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6234         16  PB-I-SOC-SEC-NO              PIC X(11).
  6235         16  PB-I-MEMBER-NO               PIC X(12).
  6236         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6237*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6238         16  PB-I-OLD-LOF                 PIC XXX.
  6239         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6240         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6241         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6242         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6243         16  PB-I-LIFE-INDICATOR          PIC X.
  6244             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6245         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6246         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6247                                          PIC S9(5)V99    COMP-3.
  6248         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6249             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6250             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6251         16  PB-I-1ST-PMT-DT              PIC XX.
  6252         16  PB-I-JOINT-INSURED.
  6253             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6254             20 PB-I-JOINT-FIRST-NAME.
  6255                24  PB-I-JOINT-FIRST-INIT PIC X.
  6256                24  FILLER                PIC X(9).
  6257             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6258*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6259         16  PB-I-BENEFICIARY-NAME.
  6260             20  PB-I-BANK-NUMBER         PIC X(10).
  6261             20  FILLER                   PIC X(15).
  6262         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6263         16  PB-I-REFERENCE               PIC X(12).
  6264         16  FILLER REDEFINES PB-I-REFERENCE.
  6265             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6266             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6267             20  PB-I-CLP-STATE           PIC XX.
  6268         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6269             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6270             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6271             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6272         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6273         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6274         16  PB-I-RESIDENT-STATE          PIC XX.
  6275         16  PB-I-RATE-CODE               PIC X(4).
  6276         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6277         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6278         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6279         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6280         16  PB-I-BANK-NOCHRGB            PIC 99.
  6281         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 117
* EL6311.cbl
  6282         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6283
  6284     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6285         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6286             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6287         16  PB-C-CANCEL-ORIGIN           PIC X.
  6288             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6289         16  PB-C-LF-CANCEL-DT            PIC XX.
  6290         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6291         16  PB-C-LF-CALC-REQ             PIC X.
  6292             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6293         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6294         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6295         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6296             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6297         16  PB-C-AH-CANCEL-DT            PIC XX.
  6298         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6299         16  PB-C-AH-CALC-REQ             PIC X.
  6300             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6301         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6302         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6303         16  PB-C-LAST-NAME               PIC X(15).
  6304         16  PB-C-REFUND-SW               PIC X.
  6305             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6306             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6307         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6308         16  PB-C-PAYEE-CODE              PIC X(6).
  6309         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6310         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6311         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6312         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6313         16  PB-C-REFERENCE               PIC X(12).
  6314         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6315         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6316         16  PB-C-POST-CARD-IND           PIC X.
  6317         16  PB-C-CANCEL-REASON           PIC X.
  6318         16  PB-C-REF-INTERFACE-SW        PIC X.
  6319         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6320         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6321         16  FILLER                       PIC X(01).
  6322*        16  FILLER                       PIC X(18).
  6323         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6324*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6325         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6326         16  PB-CANCELED-CERT-DATA.
  6327             20  PB-CI-INSURED-NAME.
  6328                 24  PB-CI-LAST-NAME      PIC X(15).
  6329                 24  PB-CI-INITIALS       PIC XX.
  6330             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6331             20  PB-CI-INSURED-SEX        PIC X.
  6332             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6333             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6334             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6335             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6336             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6337             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6338             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6339             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 118
* EL6311.cbl
  6340             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6341             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6342             20  PB-CI-RATE-CLASS         PIC XX.
  6343             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6344             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6345             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6346             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6347             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6348             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6349             20  PB-CI-LF-ABBR            PIC X(3).
  6350             20  PB-CI-AH-ABBR            PIC X(3).
  6351             20  PB-CI-OB-FLAG            PIC X.
  6352                 88  PB-CI-OB                VALUE 'B'.
  6353             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6354                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6355                                           'M' '4' '5' '9' '2'.
  6356                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6357                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6358                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6359                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6360                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6361                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6362                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6363                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6364                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6365                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6366                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6367                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6368                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6369             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6370                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6371                                           'M' '4' '5' '9' '2'.
  6372                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6373                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6374                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6375                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6376                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6377                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6378                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6379                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6380                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6381                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6382                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6383                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6384                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6385             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6386             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6387             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6388             20  PB-CI-MEMBER-NO          PIC X(12).
  6389             20  PB-CI-INT-CODE           PIC X.
  6390                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6391                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6392             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6393             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6394             20  PB-CI-COMP-EXCP-SW       PIC X.
  6395                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6396                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6397             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 119
* EL6311.cbl
  6398             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6399             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6400             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6401             20  PB-CI-DEATH-DT           PIC XX.
  6402             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6403             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6404             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6405             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6406             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6407             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6408             20  PB-CI-ENTRY-DT              PIC XX.
  6409             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6410             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6411             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6412             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6413             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6414             20  PB-CI-OLD-LOF               PIC XXX.
  6415*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6416             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6417             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6418             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6419             20  PB-CI-INDV-GRP-CD           PIC X.
  6420             20  PB-CI-BENEFICIARY-NAME.
  6421                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6422                 24  FILLER                  PIC X(15).
  6423             20  PB-CI-NOTE-SW               PIC X.
  6424             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6425             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6426             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6427             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6428             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6429             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6430             20  PB-CI-FIRST-NAME            PIC X(10).
  6431             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6432
  6433         16  FILLER                       PIC X(13).
  6434*032306  16  FILLER                       PIC X(27).
  6435*        16  FILLER                       PIC X(46).
  6436
  6437     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6438         16  FILLER                       PIC X(10).
  6439         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6440         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6441         16  PB-M-INSURED-MID-INIT        PIC X.
  6442         16  PB-M-INSURED-AGE             PIC 99.
  6443         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6444         16  PB-M-INSURED-SEX             PIC X.
  6445         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6446         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6447         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6448         16  PB-M-INSURED-CITY-STATE.
  6449             20  PB-M-INSURED-CITY        PIC X(28).
  6450             20  PB-M-INSURED-STATE       PIC XX.
  6451         16  PB-M-INSURED-ZIP-CODE.
  6452             20  PB-M-INSURED-ZIP-PRIME.
  6453                 24  PB-M-INSURED-ZIP-1   PIC X.
  6454                     88  PB-M-CANADIAN-POST-CODE
  6455                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 120
* EL6311.cbl
  6456                 24  FILLER               PIC X(4).
  6457             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6458         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6459                                        PB-M-INSURED-ZIP-CODE.
  6460             20  PM-M-INS-CAN-POST1       PIC XXX.
  6461             20  PM-M-INS-CAN-POST2       PIC XXX.
  6462             20  FILLER                   PIC XXX.
  6463         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6464         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6465         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6466         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6467         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6468         16  PB-M-CRED-BENE-CITYST.
  6469             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6470             20  PB-M-CRED-BENE-STATE     PIC XX.
  6471         16  FILLER                       PIC X(92).
  6472
  6473     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6474         16  FILLER                       PIC X(10).
  6475         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6476         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6477         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6478         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6479         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6480         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6481         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6482         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6483         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6484         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6485         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6486         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6487         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6488         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6489         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6490         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6491         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6492         16  PB-ACCOUNT-NAME              PIC X(30).
  6493         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6494         16  PB-REFERENCE                 PIC X(12).
  6495         16  PB-B-RECEIVED-DT             PIC XX.
  6496         16  FILLER                       PIC X(234).
  6497
  6498     12  PB-RECORD-STATUS.
  6499         16  PB-CREDIT-SELECT-DT          PIC XX.
  6500         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6501         16  PB-BILLED-DT                 PIC XX.
  6502         16  PB-BILLING-STATUS            PIC X.
  6503             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6504             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6505             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6506         16  PB-RECORD-BILL               PIC X.
  6507             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6508             88  PB-RECORD-RETURNED           VALUE 'R'.
  6509             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6510             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6511             88  PB-OVERRIDE-AH               VALUE 'A'.
  6512             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6513         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 121
* EL6311.cbl
  6514             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6515             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6516             88  PB-REISSUED-CERT             VALUE 'E'.
  6517             88  PB-CASH-CERT                 VALUE 'C'.
  6518             88  PB-MONTHLY-CERT              VALUE 'M'.
  6519             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6520             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6521             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6522         16  PB-FORCE-CODE                PIC X.
  6523             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6524             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6525             88  PB-CANCEL-FORCE              VALUE '8'.
  6526             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6527             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6528             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6529             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6530             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6531             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6532             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6533             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6534         16  PB-FATAL-FLAG                PIC X.
  6535             88  PB-FATAL-ERRORS              VALUE 'X'.
  6536         16  PB-FORCE-ER-CD               PIC X.
  6537             88  PB-FORCE-ERRORS              VALUE 'F'.
  6538             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6539         16  PB-WARN-ER-CD                PIC X.
  6540             88  PB-WARNING-ERRORS            VALUE 'W'.
  6541         16  FILLER                       PIC X.
  6542         16  PB-OUT-BAL-CD                PIC X.
  6543             88  PB-OUT-OF-BAL                VALUE 'O'.
  6544         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6545         16  PB-AH-OVERRIDE-L1            PIC X.
  6546         16  PB-INPUT-DT                  PIC XX.
  6547         16  PB-INPUT-BY                  PIC X(4).
  6548         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6549         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6550         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6551         16  PB-LF-EARNING-METHOD         PIC X.
  6552         16  PB-AH-EARNING-METHOD         PIC X.
  6553         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6554         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6555         16  PB-REIN-CD                   PIC XXX.
  6556         16  PB-LF-REFUND-TYPE            PIC X.
  6557         16  PB-AH-REFUND-TYPE            PIC X.
  6558         16  PB-ACCT-EFF-DT               PIC XX.
  6559         16  PB-ACCT-EXP-DT               PIC XX.
  6560         16  PB-COMPANY-ID                PIC X(3).
  6561         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6562         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6563         16  PB-SV-CARRIER                PIC X.
  6564         16  PB-SV-GROUPING               PIC X(6).
  6565         16  PB-SV-STATE                  PIC XX.
  6566         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6567         16  PB-GA-BILLING-INFO.
  6568             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6569                                          PIC XX.
  6570         16  PB-SV-REMIT-TO  REDEFINES
  6571             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 122
* EL6311.cbl
  6572         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6573         16  PB-I-LOAN-OFFICER            PIC X(5).
  6574         16  PB-I-VIN                     PIC X(17).
  6575
  6576         16  FILLER                       PIC X(04).
  6577         16  IMNET-BYPASS-SW              PIC X.
  6578
  6579******************************************************************
  6580*                COMMON EDIT ERRORS                              *
  6581******************************************************************
  6582
  6583     12  PB-COMMON-ERRORS.
  6584         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6585                                           PIC S9(4)     COMP.
  6586
  6587******************************************************************
  6588*                                COPY ELCCERT.
  6589******************************************************************
  6590*                                                                *
  6591*                            ELCCERT.                            *
  6592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6593*                            VMOD=2.013                          *
  6594*                                                                *
  6595*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6596*                                                                *
  6597*   FILE TYPE = VSAM,KSDS                                        *
  6598*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6599*                                                                *
  6600*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6601*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6602*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6603*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6604*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6605*                                                                *
  6606*   LOG = YES                                                    *
  6607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6608******************************************************************
  6609*                   C H A N G E   L O G
  6610*
  6611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6612*-----------------------------------------------------------------
  6613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6614* EFFECTIVE    NUMBER
  6615*-----------------------------------------------------------------
  6616* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6617* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6618* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6619* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6620* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6621* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6623* 032612  CR2011110200001  PEMA  AHL CHANGES
  6624* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6625* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6626* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6627******************************************************************
  6628
  6629 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 123
* EL6311.cbl
  6630     12  CM-RECORD-ID                      PIC XX.
  6631         88  VALID-CM-ID                      VALUE 'CM'.
  6632
  6633     12  CM-CONTROL-PRIMARY.
  6634         16  CM-COMPANY-CD                 PIC X.
  6635         16  CM-CARRIER                    PIC X.
  6636         16  CM-GROUPING.
  6637             20  CM-GROUPING-PREFIX        PIC X(3).
  6638             20  CM-GROUPING-PRIME         PIC X(3).
  6639         16  CM-STATE                      PIC XX.
  6640         16  CM-ACCOUNT.
  6641             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6642             20  CM-ACCOUNT-PRIME          PIC X(6).
  6643         16  CM-CERT-EFF-DT                PIC XX.
  6644         16  CM-CERT-NO.
  6645             20  CM-CERT-PRIME             PIC X(10).
  6646             20  CM-CERT-SFX               PIC X.
  6647
  6648     12  CM-CONTROL-BY-NAME.
  6649         16  CM-COMPANY-CD-A1              PIC X.
  6650         16  CM-INSURED-LAST-NAME          PIC X(15).
  6651         16  CM-INSURED-INITIALS.
  6652             20  CM-INSURED-INITIAL1       PIC X.
  6653             20  CM-INSURED-INITIAL2       PIC X.
  6654
  6655     12  CM-CONTROL-BY-SSN.
  6656         16  CM-COMPANY-CD-A2              PIC X.
  6657         16  CM-SOC-SEC-NO.
  6658             20  CM-SSN-STATE              PIC XX.
  6659             20  CM-SSN-ACCOUNT            PIC X(6).
  6660             20  CM-SSN-LN3.
  6661                 25  CM-INSURED-INITIALS-A2.
  6662                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6663                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6664                 25 CM-PART-LAST-NAME-A2         PIC X.
  6665
  6666     12  CM-CONTROL-BY-CERT-NO.
  6667         16  CM-COMPANY-CD-A4              PIC X.
  6668         16  CM-CERT-NO-A4                 PIC X(11).
  6669
  6670     12  CM-CONTROL-BY-MEMB.
  6671         16  CM-COMPANY-CD-A5              PIC X.
  6672         16  CM-MEMBER-NO.
  6673             20  CM-MEMB-STATE             PIC XX.
  6674             20  CM-MEMB-ACCOUNT           PIC X(6).
  6675             20  CM-MEMB-LN4.
  6676                 25  CM-INSURED-INITIALS-A5.
  6677                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6678                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6679                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6680
  6681     12  CM-INSURED-PROFILE-DATA.
  6682         16  CM-INSURED-FIRST-NAME.
  6683             20  CM-INSURED-1ST-INIT       PIC X.
  6684             20  FILLER                    PIC X(9).
  6685         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6686         16  CM-INSURED-SEX                PIC X.
  6687             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 124
* EL6311.cbl
  6688             88  CM-SEX-FEMAL                 VALUE 'F'.
  6689         16  CM-INSURED-JOINT-AGE          PIC 99.
  6690         16  CM-JOINT-INSURED-NAME.
  6691             20  CM-JT-LAST-NAME           PIC X(15).
  6692             20  CM-JT-FIRST-NAME.
  6693                 24  CM-JT-1ST-INIT        PIC X.
  6694                 24  FILLER                PIC X(9).
  6695             20  CM-JT-INITIAL             PIC X.
  6696
  6697     12  CM-LIFE-DATA.
  6698         16  CM-LF-BENEFIT-CD              PIC XX.
  6699         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6700         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6701         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6702         16  CM-LF-DEV-CODE                PIC XXX.
  6703         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6704         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6705         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6706         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6707         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6708         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6709         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6710         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6711         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6712         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6713         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6714         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6715         16  cm-temp-epiq                  pic xx.
  6716             88  EPIQ-CLASS                  value 'EQ'.
  6717*        16  FILLER                        PIC XX.
  6718
  6719     12  CM-AH-DATA.
  6720         16  CM-AH-BENEFIT-CD              PIC XX.
  6721         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6722         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6723         16  CM-AH-DEV-CODE                PIC XXX.
  6724         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6725         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6726         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6727         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6728         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6729         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6730         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6731         16  CM-AH-PAID-THRU-DT            PIC XX.
  6732             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6733         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6734         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6735         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6736         16  FILLER                        PIC X.
  6737
  6738     12  CM-LOAN-INFORMATION.
  6739         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6740         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6741                                           PIC S9(5)V99  COMP-3.
  6742         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6743         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6744         16  CM-PAY-FREQUENCY              PIC S99.
  6745         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 125
* EL6311.cbl
  6746         16  CM-RATE-CLASS                 PIC XX.
  6747         16  CM-BENEFICIARY                PIC X(25).
  6748         16  CM-POLICY-FORM-NO             PIC X(12).
  6749         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6750         16  CM-LAST-ADD-ON-DT             PIC XX.
  6751         16  CM-DEDUCTIBLE-AMOUNTS.
  6752             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6753             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6754         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6755             20  CM-RESIDENT-STATE         PIC XX.
  6756             20  CM-RATE-CODE              PIC X(4).
  6757             20  FILLER                    PIC XX.
  6758         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6759             20  CM-LOAN-OFFICER           PIC X(5).
  6760             20  FILLER                    PIC XXX.
  6761         16  CM-CSR-CODE                   PIC XXX.
  6762         16  CM-UNDERWRITING-CODE          PIC X.
  6763             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6764         16  CM-POST-CARD-IND              PIC X.
  6765         16  CM-REF-INTERFACE-SW           PIC X.
  6766         16  CM-PREMIUM-TYPE               PIC X.
  6767             88  CM-SING-PRM                  VALUE '1'.
  6768             88  CM-O-B-COVERAGE              VALUE '2'.
  6769             88  CM-OPEN-END                  VALUE '3'.
  6770         16  CM-IND-GRP-TYPE               PIC X.
  6771             88  CM-INDIVIDUAL                VALUE 'I'.
  6772             88  CM-GROUP                     VALUE 'G'.
  6773         16  CM-SKIP-CODE                  PIC X.
  6774             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6775             88  SKIP-JULY                    VALUE '1'.
  6776             88  SKIP-AUGUST                  VALUE '2'.
  6777             88  SKIP-SEPTEMBER               VALUE '3'.
  6778             88  SKIP-JULY-AUG                VALUE '4'.
  6779             88  SKIP-AUG-SEPT                VALUE '5'.
  6780             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6781             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6782             88  SKIP-JUNE                    VALUE '8'.
  6783             88  SKIP-JUNE-JULY               VALUE '9'.
  6784             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6785             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6786         16  CM-PAYMENT-MODE               PIC X.
  6787             88  PAY-MONTHLY                  VALUE SPACE.
  6788             88  PAY-WEEKLY                   VALUE '1'.
  6789             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6790             88  PAY-BI-WEEKLY                VALUE '3'.
  6791             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6792         16  CM-LOAN-NUMBER                PIC X(8).
  6793         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6794         16  CM-OLD-LOF                    PIC XXX.
  6795*        16  CM-LOAN-OFFICER               PIC XXX.
  6796         16  CM-REIN-TABLE                 PIC XXX.
  6797         16  CM-SPECIAL-REIN-CODE          PIC X.
  6798         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6799         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6800         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6801
  6802     12  CM-STATUS-DATA.
  6803         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 126
* EL6311.cbl
  6804         16  CM-ENTRY-DT                   PIC XX.
  6805
  6806         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6807         16  CM-LF-CANCEL-DT               PIC XX.
  6808         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6809
  6810         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6811         16  CM-LF-DEATH-DT                PIC XX.
  6812         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6813
  6814         16  CM-LF-CURRENT-STATUS          PIC X.
  6815             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6816                                                'M' '4' '5' '9'.
  6817             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6818             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6819             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6820             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6821             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6822             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6823             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6824             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6825             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6826             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6827             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6828             88  CM-LF-DECLINED               VALUE 'D'.
  6829             88  CM-LF-VOIDED                 VALUE 'V'.
  6830
  6831         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6832         16  CM-AH-CANCEL-DT               PIC XX.
  6833         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6834
  6835         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6836         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6837         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6838
  6839         16  CM-AH-CURRENT-STATUS          PIC X.
  6840             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6841                                                'M' '4' '5' '9'.
  6842             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6843             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6844             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6845             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6846             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6847             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6848             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6849             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6850             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6851             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6852             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6853             88  CM-AH-DECLINED               VALUE 'D'.
  6854             88  CM-AH-VOIDED                 VALUE 'V'.
  6855
  6856         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6857             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6858             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6859             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6860         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6861
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 127
* EL6311.cbl
  6862         16  CM-ENTRY-BATCH                PIC X(6).
  6863         16  CM-LF-EXIT-BATCH              PIC X(6).
  6864         16  CM-AH-EXIT-BATCH              PIC X(6).
  6865         16  CM-LAST-MONTH-END             PIC XX.
  6866
  6867     12  CM-NOTE-SW                        PIC X.
  6868         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6869         88  CERT-NOTES-PRESENT               VALUE '1'.
  6870         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6871         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6872         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6873         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6874         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6875         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6876     12  CM-COMP-EXCP-SW                   PIC X.
  6877         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6878         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6879     12  CM-INSURED-ADDRESS-SW             PIC X.
  6880         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6881         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6882
  6883*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6884     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6885     12  FILLER                            PIC X.
  6886
  6887*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6888     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6889     12  FILLER                            PIC X.
  6890*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6891     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6892
  6893     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6894         88  CERT-ADDED-BATCH                 VALUE ' '.
  6895         88  CERT-ADDED-ONLINE                VALUE '1'.
  6896         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6897         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6898         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6899     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6900         88  CERT-AS-LOADED                   VALUE ' '.
  6901         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6902         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6903         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6904         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6905         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6906         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6907         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6908
  6909     12  CM-ACCOUNT-COMM-PCTS.
  6910         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6911         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6912
  6913     12  CM-USER-FIELD                     PIC X.
  6914     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6915     12  CM-CLP-STATE                      PIC XX.
  6916     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6917     12  CM-USER-RESERVED                  PIC XXX.
  6918     12  FILLER REDEFINES CM-USER-RESERVED.
  6919         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 128
* EL6311.cbl
  6920         16  F                             PIC X.
  6921******************************************************************
  6922*                                COPY ERCNOTE.
  6923******************************************************************
  6924*                                                                *
  6925*                                                                *
  6926*                            ERCNOTE                             *
  6927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6928*                            VMOD=2.003                          *
  6929*                                                                *
  6930*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6931*                                                                *
  6932*        FILE TYPE= VSAM,KSDS                                    *
  6933*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6934*                                                                *
  6935*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6936*                                                                *
  6937*        LOG = YES                                               *
  6938*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6939*                                                                *
  6940******************************************************************
  6941*                   C H A N G E   L O G
  6942*
  6943* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6944*-----------------------------------------------------------------
  6945*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6946* EFFECTIVE    NUMBER
  6947*-----------------------------------------------------------------
  6948* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6949*                                FILE WILL CONTAIN BILLING NOTES O
  6950******************************************************************
  6951
  6952 01  CERTIFICATE-NOTE.
  6953     12  CN-RECORD-ID                PIC  XX.
  6954         88  VALID-CN-ID                  VALUE 'CN'.
  6955
  6956     12  CN-CONTROL-PRIMARY.
  6957         16  CN-COMPANY-CD           PIC X.
  6958         16  CN-CARRIER              PIC X.
  6959         16  CN-GROUPING.
  6960             20 CN-GROUPING-PREFIX   PIC XXX.
  6961             20 CN-GROUPING-PRIME    PIC XXX.
  6962         16  CN-STATE                PIC XX.
  6963         16  CN-ACCOUNT.
  6964             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6965             20 CN-ACCOUNT-PRIME     PIC X(6).
  6966         16  CN-CERT-EFF-DT          PIC XX.
  6967         16  CN-CERT-NO.
  6968             20  CN-CERT-PRIME       PIC X(10).
  6969             20  CN-CERT-SFX         PIC X.
  6970
  6971     12  CN-BILLING-START-LINE-NO    PIC 99.
  6972     12  CN-BILLING-END-LINE-NO      PIC 99.
  6973
  6974     12  CN-LINES.
  6975         16  CN-LINE OCCURS 10       PIC X(77).
  6976
  6977     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 129
* EL6311.cbl
  6978     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6979     12  CN-LAST-MAINT-USER          PIC X(4).
  6980     12  FILLER                      PIC X(6).
  6981******************************************************************
  6982*                                COPY ERCPNDM.
  6983******************************************************************
  6984*                                                                *
  6985*                                                                *
  6986*                            ERCPNDM                             *
  6987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6988*                            VMOD=2.003                          *
  6989*                                                                *
  6990*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6991*                                                                *
  6992*   FILE TYPE = VSAM,KSDS                                        *
  6993*   RECORD SIZE = 374   RECFORM = FIX                            *
  6994*                                                                *
  6995*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6996*   ALTERNATE PATH    = NOT USED                                 *
  6997*                                                                *
  6998*   LOG = YES                                                    *
  6999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7000******************************************************************
  7001*                   C H A N G E   L O G
  7002*
  7003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7004*-----------------------------------------------------------------
  7005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7006* EFFECTIVE    NUMBER
  7007*-----------------------------------------------------------------
  7008* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7009* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7010* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7011* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7012******************************************************************
  7013
  7014 01  PENDING-MAILING-DATA.
  7015     12  PM-RECORD-ID                      PIC XX.
  7016         88  VALID-MA-ID                       VALUE 'PM'.
  7017
  7018     12  PM-CONTROL-PRIMARY.
  7019         16  PM-COMPANY-CD                 PIC X.
  7020         16  PM-ENTRY-BATCH                PIC X(6).
  7021         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7022         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7023
  7024     12  FILLER                            PIC X(14).
  7025
  7026     12  PM-ACCESS-CONTROL.
  7027         16  PM-SOURCE-SYSTEM              PIC XX.
  7028             88  PM-FROM-CREDIT                VALUE 'CR'.
  7029             88  PM-FROM-VSI                   VALUE 'VS'.
  7030             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7031             88  PM-FROM-OTHER                 VALUE 'OT'.
  7032         16  PM-RECORD-ADD-DT              PIC XX.
  7033         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7034         16  PM-LAST-MAINT-DT              PIC XX.
  7035         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 130
* EL6311.cbl
  7036         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7037
  7038     12  PM-PROFILE-INFO.
  7039         16  PM-QUALIFY-CODE-1             PIC XX.
  7040         16  PM-QUALIFY-CODE-2             PIC XX.
  7041         16  PM-QUALIFY-CODE-3             PIC XX.
  7042         16  PM-QUALIFY-CODE-4             PIC XX.
  7043         16  PM-QUALIFY-CODE-5             PIC XX.
  7044
  7045         16  PM-INSURED-LAST-NAME          PIC X(15).
  7046         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7047         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7048         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7049         16  PM-INSURED-BIRTH-DT           PIC XX.
  7050         16  PM-INSURED-SEX                PIC X.
  7051             88  PM-SEX-MALE                   VALUE 'M'.
  7052             88  PM-SEX-FEMALE                 VALUE 'F'.
  7053         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7054
  7055         16  PM-ADDRESS-CORRECTED          PIC X.
  7056         16  PM-JOINT-BIRTH-DT             PIC XX.
  7057*        16  FILLER                        PIC X(12).
  7058
  7059         16  PM-ADDRESS-LINE-1             PIC X(30).
  7060         16  PM-ADDRESS-LINE-2             PIC X(30).
  7061         16  PM-CITY-STATE.
  7062             20  PM-CITY                   PIC X(28).
  7063             20  PM-STATE                  PIC XX.
  7064         16  PM-ZIP.
  7065             20  PM-ZIP-CODE.
  7066                 24  PM-ZIP-1              PIC X.
  7067                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7068                 24  FILLER                PIC X(4).
  7069             20  PM-ZIP-PLUS4              PIC X(4).
  7070         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7071             20  PM-CAN-POST1              PIC XXX.
  7072             20  PM-CAN-POST2              PIC XXX.
  7073             20  FILLER                    PIC XXX.
  7074
  7075         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7076         16  pm-city-st-zip-verified       pic x.
  7077         16  FILLER                        PIC XX.
  7078
  7079     12  PM-CRED-BENE-INFO.
  7080         16  PM-CRED-BENE-NAME             PIC X(25).
  7081         16  PM-CRED-BENE-ADDR             PIC X(30).
  7082         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7083         16  PM-CRED-BENE-CTYST.
  7084             20  PM-CRED-BENE-CITY         PIC X(28).
  7085             20  PM-CRED-BENE-STATE        PIC XX.
  7086         16  PM-CRED-BENE-ZIP.
  7087             20  PM-CB-ZIP-CODE.
  7088                 24  PM-CB-ZIP-1           PIC X.
  7089                     88  PM-CB-CANADIAN-POST-CODE
  7090                                  VALUE 'A' THRU 'Z'.
  7091                 24  FILLER                PIC X(4).
  7092             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7093         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 131
* EL6311.cbl
  7094             20  PM-CB-CAN-POST1           PIC XXX.
  7095             20  PM-CB-CAN-POST2           PIC XXX.
  7096             20  FILLER                    PIC XXX.
  7097     12  PM-POST-CARD-MAIL-DATA.
  7098         16  PM-MAIL-DATA OCCURS 7.
  7099             20  PM-MAIL-TYPE              PIC X.
  7100                 88  PM-12MO-MAILING           VALUE '1'.
  7101                 88  PM-EXP-MAILING            VALUE '2'.
  7102             20  PM-MAIL-STATUS            PIC X.
  7103                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7104                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7105                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7106             20  PM-MAIL-DATE              PIC XX.
  7107     12  FILLER                            PIC XX.
  7108     12  FILLER                            PIC X(12).
  7109*    12  FILLER                            PIC X(30).
  7110
  7111******************************************************************
  7112*                                COPY ERCMAIL.
  7113******************************************************************
  7114*                                                                *
  7115*                                                                *
  7116*                            ERCMAIL                             *
  7117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7118*                            VMOD=2.003                          *
  7119*                                                                *
  7120*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7121*                                                                *
  7122*   FILE TYPE = VSAM,KSDS                                        *
  7123*   RECORD SIZE = 374   RECFORM = FIX                            *
  7124*                                                                *
  7125*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7126*   ALTERNATE PATH    = NOT USED                                 *
  7127*                                                                *
  7128*   LOG = YES                                                    *
  7129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7130******************************************************************
  7131*                   C H A N G E   L O G
  7132*
  7133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7134*-----------------------------------------------------------------
  7135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7136* EFFECTIVE    NUMBER
  7137*-----------------------------------------------------------------
  7138* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7139* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7140* 111108                   PEMA  ADD CRED BENE ADDR2
  7141******************************************************************
  7142
  7143 01  MAILING-DATA.
  7144     12  MA-RECORD-ID                      PIC XX.
  7145         88  VALID-MA-ID                       VALUE 'MA'.
  7146
  7147     12  MA-CONTROL-PRIMARY.
  7148         16  MA-COMPANY-CD                 PIC X.
  7149         16  MA-CARRIER                    PIC X.
  7150         16  MA-GROUPING.
  7151             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 132
* EL6311.cbl
  7152             20  MA-GROUPING-PRIME         PIC XXX.
  7153         16  MA-STATE                      PIC XX.
  7154         16  MA-ACCOUNT.
  7155             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7156             20  MA-ACCOUNT-PRIME          PIC X(6).
  7157         16  MA-CERT-EFF-DT                PIC XX.
  7158         16  MA-CERT-NO.
  7159             20  MA-CERT-PRIME             PIC X(10).
  7160             20  MA-CERT-SFX               PIC X.
  7161
  7162     12  FILLER                            PIC XX.
  7163
  7164     12  MA-ACCESS-CONTROL.
  7165         16  MA-SOURCE-SYSTEM              PIC XX.
  7166             88  MA-FROM-CREDIT                VALUE 'CR'.
  7167             88  MA-FROM-VSI                   VALUE 'VS'.
  7168             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7169             88  MA-FROM-OTHER                 VALUE 'OT'.
  7170         16  MA-RECORD-ADD-DT              PIC XX.
  7171         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7172         16  MA-LAST-MAINT-DT              PIC XX.
  7173         16  MA-LAST-MAINT-BY              PIC XXXX.
  7174         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7175
  7176     12  MA-PROFILE-INFO.
  7177         16  MA-QUALIFY-CODE-1             PIC XX.
  7178         16  MA-QUALIFY-CODE-2             PIC XX.
  7179         16  MA-QUALIFY-CODE-3             PIC XX.
  7180         16  MA-QUALIFY-CODE-4             PIC XX.
  7181         16  MA-QUALIFY-CODE-5             PIC XX.
  7182
  7183         16  MA-INSURED-LAST-NAME          PIC X(15).
  7184         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7185         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7186         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7187         16  MA-INSURED-BIRTH-DT           PIC XX.
  7188         16  MA-INSURED-SEX                PIC X.
  7189             88  MA-SEX-MALE                   VALUE 'M'.
  7190             88  MA-SEX-FEMALE                 VALUE 'F'.
  7191         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7192
  7193         16  MA-ADDRESS-CORRECTED          PIC X.
  7194         16  MA-JOINT-BIRTH-DT             PIC XX.
  7195*        16  FILLER                        PIC X(12).
  7196
  7197         16  MA-ADDRESS-LINE-1             PIC X(30).
  7198         16  MA-ADDRESS-LINE-2             PIC X(30).
  7199         16  MA-CITY-STATE.
  7200             20  MA-CITY                   PIC X(28).
  7201             20  MA-ADDR-STATE             PIC XX.
  7202         16  MA-ZIP.
  7203             20  MA-ZIP-CODE.
  7204                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7205                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7206                 24  FILLER                PIC X(4).
  7207             20  MA-ZIP-PLUS4              PIC X(4).
  7208         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7209             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 133
* EL6311.cbl
  7210             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7211             20  FILLER                    PIC X(3).
  7212
  7213         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7214
  7215         16  FILLER                        PIC XXX.
  7216*        16  FILLER                        PIC X(10).
  7217
  7218     12  MA-CRED-BENE-INFO.
  7219         16  MA-CRED-BENE-NAME                 PIC X(25).
  7220         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7221         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7222         16  MA-CRED-BENE-CTYST.
  7223             20  MA-CRED-BENE-CITY             PIC X(28).
  7224             20  MA-CRED-BENE-STATE            PIC XX.
  7225         16  MA-CRED-BENE-ZIP.
  7226             20  MA-CB-ZIP-CODE.
  7227                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7228                     88  MA-CB-CANADIAN-POST-CODE
  7229                                           VALUE 'A' THRU 'Z'.
  7230                 24  FILLER                    PIC X(4).
  7231             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7232         16  MA-CB-CANADIAN-POSTAL-CODE
  7233                            REDEFINES MA-CRED-BENE-ZIP.
  7234             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7235             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7236             20  FILLER                        PIC X(3).
  7237     12  MA-POST-CARD-MAIL-DATA.
  7238         16  MA-MAIL-DATA OCCURS 7.
  7239             20  MA-MAIL-TYPE              PIC X.
  7240                 88  MA-12MO-MAILING           VALUE '1'.
  7241                 88  MA-EXP-MAILING            VALUE '2'.
  7242             20  MA-MAIL-STATUS            PIC X.
  7243                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7244                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7245                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7246             20  MA-MAIL-DATE              PIC XX.
  7247     12  FILLER                            PIC XX.
  7248     12  FILLER                            PIC XX.
  7249*    12  FILLER                            PIC X(30).
  7250******************************************************************
  7251*                                COPY ERCRQST.
  7252******************************************************************
  7253*                                                                *
  7254*                                                                *
  7255*                            ERCRQST.                            *
  7256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7257*                            VMOD=2.002                          *
  7258*                                                                *
  7259*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7260*                                                                *
  7261*   FILE TYPE = VSAM,KSDS                                        *
  7262*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7263*                                                                *
  7264*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7265*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7266*                                   ACCOUNT, REF, BATCH)         *
  7267*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 134
* EL6311.cbl
  7268*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7269*                                   ACCOUNT, REF, BATCH)         *
  7270*                                                RKP=47, LEN=46  *
  7271*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7272*                                   BATCH)                       *
  7273*                                                RKP=93, LEN=24  *
  7274*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7275*                                   REF, BATCH)                  *
  7276*                                                RKP=117, LEN=35 *
  7277*   LOG = NO                                                     *
  7278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7279******************************************************************
  7280
  7281 01  AR-REQUEST-RECORD.
  7282     12  RQ-RECORD-ID                     PIC XX.
  7283         88  VALID-RQ-ID                        VALUE 'RQ'.
  7284
  7285     12  RQ-CONTROL-PRIMARY.
  7286         16  RQ-COMPANY-CD                PIC X.
  7287         16  RQ-ENTRY-BATCH               PIC X(6).
  7288
  7289     12  RQ-CONTROL-BY-ACCT-REF.
  7290         16  RQ-COMPANY-CD-A1             PIC X.
  7291         16  RQ-CARRIER-A1                PIC X.
  7292         16  RQ-GROUPING-A1               PIC X(6).
  7293         16  RQ-STATE-A1                  PIC XX.
  7294         16  RQ-ACCOUNT-A1                PIC X(10).
  7295         16  RQ-REFERENCE-A1              PIC X(12).
  7296         16  RQ-BATCH-A1                  PIC X(6).
  7297
  7298     12  RQ-CONTROL-BY-FIN-RESP.
  7299         16  RQ-COMPANY-CD-A2             PIC X.
  7300         16  RQ-CARRIER-A2                PIC X.
  7301         16  RQ-GROUPING-A2               PIC X(6).
  7302         16  RQ-FIN-RESP-A2               PIC X(10).
  7303         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7304         16  RQ-REFERENCE-A2              PIC X(12).
  7305         16  RQ-BATCH-A2                  PIC X(6).
  7306
  7307     12  RQ-CONTROL-BY-ACCT-AGENT.
  7308         16  RQ-COMPANY-CD-A3             PIC X.
  7309         16  RQ-CARRIER-A3                PIC X.
  7310         16  RQ-GROUPING-A3               PIC X(6).
  7311         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7312         16  RQ-BATCH-A3                  PIC X(6).
  7313
  7314     12  RQ-CONTROL-BY-SUMMARY.
  7315         16  RQ-COMPANY-CD-A4             PIC X.
  7316         16  RQ-SUMMARY-CODE              PIC X(6).
  7317         16  RQ-ACCOUNT-A4                PIC X(10).
  7318         16  RQ-REFERENCE-A4              PIC X(12).
  7319         16  RQ-BATCH-A4                  PIC X(6).
  7320
  7321     12  RQ-REQUEST-METHOD                PIC X.
  7322         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7323         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7324         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7325         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 135
* EL6311.cbl
  7326     12  FILLER                           PIC X.
  7327     12  RQ-STATUS                        PIC X.
  7328         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7329         88  RQ-RESUBMIT                      VALUE 'R'.
  7330     12  RQ-PROCESSOR-ID                  PIC X(4).
  7331     12  RQ-ENTRY-DT                      PIC XX.
  7332     12  RQ-MO-END-DT                     PIC XX.
  7333     12  RQ-REQUEST-DT                    PIC XX.
  7334     12  RQ-STMT-DT                       PIC XX.
  7335     12  RQ-REVERSAL-DT                   PIC XX.
  7336     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7337     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7338
  7339     12  FILLER                           PIC X(27).
  7340
  7341******************************************************************
  7342
  7343*                                COPY ERCLOFC.
  7344******************************************************************
  7345*                                                                *
  7346*                                                                *
  7347*                            ERCLOFC                             *
  7348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7349*                            VMOD=2.003                          *
  7350*                                                                *
  7351*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7352*                                                                *
  7353*   FILE TYPE = VSAM,KSDS                                        *
  7354*   RECORD SIZE = 670   RECFORM = FIX                            *
  7355*                                                                *
  7356*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7357*                                                                *
  7358*   LOG = YES                                                    *
  7359*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7360*                                                                *
  7361******************************************************************
  7362
  7363 01  LOAN-OFFICER-MASTER.
  7364     12  LO-RECORD-ID                PIC XX.
  7365         88  VALID-LO-ID                VALUE 'LO'.
  7366
  7367     12  LO-CONTROL-PRIMARY.
  7368         16  LO-COMPANY-CD           PIC X.
  7369         16  LO-CARRIER              PIC X.
  7370         16  LO-GROUPING.
  7371             20  LO-GROUPING-PREFIX  PIC XXX.
  7372             20  LO-GROUPING-PRIME   PIC XXX.
  7373         16  LO-STATE                PIC XX.
  7374         16  LO-ACCOUNT.
  7375             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7376             20  LO-ACCOUNT-PRIME    PIC X(6).
  7377         16  LO-OFFICER-CODE         PIC X(5).
  7378
  7379     12  LO-OFFICER-NAME             PIC X(30).
  7380
  7381     12  LO-LAST-MAINT-DT            PIC XX.
  7382     12  LO-LAST-USER                PIC X(4).
  7383     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 136
* EL6311.cbl
  7384
  7385     12  LO-COMP-CONTROL             PIC X.
  7386             88  LO-SHOW-COMP           VALUE 'Y'.
  7387             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7388     12  LO-DETAIL-CONTROL           PIC X.
  7389             88  LO-PRINT-DETAIL        VALUE 'D'.
  7390             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7391
  7392     12  LO-SV-CARRIER               PIC X.
  7393     12  LO-SV-GROUPING              PIC X(6).
  7394     12  LO-SV-STATE                 PIC XX.
  7395
  7396     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7397     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7398
  7399     12  LO-OFFICER-INFO.
  7400         16  FILLER OCCURS 12 TIMES.
  7401             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7402             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7403             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7404             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7405             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7406             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7407             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7408             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7409     12  FILLER                      PIC X(198).
  7410******************************************************************
  7411*                                COPY ERCPYAJ.
  7412******************************************************************
  7413*                                                                *
  7414*                            ERCPYAJ                             *
  7415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7416*                            VMOD=2.015                          *
  7417*                                                                *
  7418*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7419*                                                                *
  7420*                                                                *
  7421*   FILE TYPE = VSAM,KSDS                                        *
  7422*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7423*                                                                *
  7424*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7425*       ALTERNATE PATHS = NONE                                   *
  7426*                                                                *
  7427*   LOG = YES                                                    *
  7428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7429******************************************************************
  7430******************************************************************
  7431*                   C H A N G E   L O G
  7432*
  7433* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7434*-----------------------------------------------------------------
  7435*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7436* EFFECTIVE    NUMBER
  7437*-----------------------------------------------------------------
  7438* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7439* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7440******************************************************************
  7441
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 137
* EL6311.cbl
  7442 01  PENDING-PAY-ADJ.
  7443     12  PY-RECORD-ID                     PIC XX.
  7444         88  VALID-PY-ID                        VALUE 'PY'.
  7445
  7446     12  PY-CONTROL-PRIMARY.
  7447         16  PY-COMPANY-CD                PIC X.
  7448         16  PY-CARRIER                   PIC X.
  7449         16  PY-GROUPING                  PIC X(6).
  7450         16  PY-FIN-RESP                  PIC X(10).
  7451         16  PY-ACCOUNT                   PIC X(10).
  7452         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7453                                          PIC X(10).
  7454         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7455         16  PY-RECORD-TYPE               PIC X.
  7456             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7457             88  PY-DEPOSIT                   VALUE 'D'.
  7458             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7459             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7460             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7461             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7462             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7463             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7464             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7465             88  PY-FICA-ENTRY                VALUE 'F'.
  7466             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7467             88  PY-POLICY-FEE                VALUE 'W'.
  7468             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7469
  7470     12  PY-PYMT-TYPE                     PIC X.
  7471             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7472             88  PY-REINS-PYMT                VALUE 'R'.
  7473             88  PY-EXP-PYMT                  VALUE 'E'.
  7474
  7475     12  PY-BIL-INV                       PIC X(6).
  7476     12  PY-REF-NO                        PIC X(12).
  7477
  7478     12  PY-LAST-MAINT-DT                 PIC XX.
  7479     12  PY-LAST-MAINT-BY                 PIC X(4).
  7480     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7481
  7482     12  PY-PYADJ-RECORD.
  7483         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7484         16  PY-ENTRY-COMMENT             PIC X(30).
  7485         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7486             20  PY-GL-ACCOUNT            PIC X(10).
  7487             20  PY-GL-STATE              PIC X(02).
  7488             20  PY-GL-CANC-SW            PIC X(01).
  7489                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7490                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7491             20  PY-GL-COMMENT            PIC X(10).
  7492             20  FILLER      REDEFINES PY-GL-COMMENT.
  7493                 24  PY-GL-CHECK-NO       PIC 9(06).
  7494                 24  FILLER               PIC X(04).
  7495             20  FILLER                   PIC X(07).
  7496         16  PY-SAVE-ACCOUNT              PIC X(10).
  7497         16  PY-SAVE-TYPE                 PIC X(01).
  7498
  7499         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 138
* EL6311.cbl
  7500             20  PY-LETTER OCCURS 3 TIMES
  7501                           INDEXED BY PY-LET-NDX
  7502                                          PIC X(04).
  7503
  7504         16  PY-ERCOMP-TYPE               PIC X.
  7505             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7506             88  PY-GA-TYPE                   VALUE 'G'.
  7507             88  PY-BANK-TYPE                 VALUE 'B'.
  7508         16  FILLER                       PIC X(05).
  7509
  7510     12  PY-RECORD-STATUS.
  7511         16  PY-CREDIT-SELECT-DT          PIC XX.
  7512         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7513         16  PY-BILLED-DATE               PIC XX.
  7514         16  PY-REPORTED-DT               PIC XX.
  7515         16  PY-PMT-APPLIED               PIC X.
  7516             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7517             88  PY-GA-PMT                    VALUE 'G'.
  7518             88  PY-OVWRITE-PMT               VALUE 'O'.
  7519             88  PY-NON-AR-PMT                VALUE 'N'.
  7520         16  FILLER                       PIC X(5).
  7521         16  PY-INPUT-DT                  PIC XX.
  7522         16  PY-CHECK-NUMBER              PIC X(6).
  7523         16  PY-VOID-SW                   PIC X.
  7524             88  PY-CHECK-VOIDED              VALUE 'V'.
  7525         16  PY-CHECK-ORIGIN-SW           PIC X.
  7526             88  PY-BILLING-CHECK             VALUE 'B'.
  7527             88  PY-REFUND-CHECK              VALUE 'R'.
  7528             88  PY-GA-CHECK                  VALUE 'G'.
  7529             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7530             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7531         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7532         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7533         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7534         16  PY-BILL-FLAG                 PIC X.
  7535             88  PY-BILLED                    VALUE 'B'.
  7536         16  PY-AR-FLAG                   PIC X.
  7537             88  PY-AR-CYCLE                  VALUE 'C'.
  7538             88  PY-AR-MONTH-END              VALUE 'M'.
  7539         16  PY-AR-DATE                   PIC XX.
  7540
  7541     12  PY-GL-CODES.
  7542         16  PY-GL-DB                     PIC X(14).
  7543         16  PY-GL-CR                     PIC X(14).
  7544         16  PY-GL-FLAG                   PIC X.
  7545         16  PY-GL-DATE                   PIC XX.
  7546
  7547     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7548     12  FILLER                           PIC X(3).
  7549******************************************************************
  7550*                                COPY ERCCNOT.
  7551******************************************************************
  7552*                                                                *
  7553*                            ERCCNOT                             *
  7554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7555*                            VMOD=2.003                          *
  7556*                                                                *
  7557*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 139
* EL6311.cbl
  7558*                                                                *
  7559*        FILE TYPE= VSAM,KSDS                                    *
  7560*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7561*                                                                *
  7562*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7563*                                                                *
  7564*        LOG = YES                                               *
  7565*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7566*                                                                *
  7567******************************************************************
  7568*                   C H A N G E   L O G
  7569*
  7570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7571*-----------------------------------------------------------------
  7572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7573* EFFECTIVE    NUMBER
  7574*-----------------------------------------------------------------
  7575* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7576******************************************************************
  7577
  7578 01  CERT-NOTE-FILE.
  7579     12  CZ-RECORD-ID                PIC  XX.
  7580         88  VALID-CZ-ID                  VALUE 'CZ'.
  7581
  7582     12  CZ-CONTROL-PRIMARY.
  7583         16  CZ-COMPANY-CD           PIC X.
  7584         16  CZ-CARRIER              PIC X.
  7585         16  CZ-GROUPING.
  7586             20 CZ-GROUPING-PREFIX   PIC XXX.
  7587             20 CZ-GROUPING-PRIME    PIC XXX.
  7588         16  CZ-STATE                PIC XX.
  7589         16  CZ-ACCOUNT.
  7590             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7591             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7592         16  CZ-CERT-EFF-DT          PIC XX.
  7593         16  CZ-CERT-NO.
  7594             20  CZ-CERT-PRIME       PIC X(10).
  7595             20  CZ-CERT-SFX         PIC X.
  7596         16  CZ-RECORD-TYPE          PIC X.
  7597             88  CERT-NOTE           VALUE '1'.
  7598             88  CLAIM-CERT-NOTE     VALUE '2'.
  7599         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7600
  7601     12  CZ-LAST-MAINT-DT            PIC XX.
  7602     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7603     12  CZ-LAST-MAINT-USER          PIC X(4).
  7604
  7605     12  CZ-NOTE-INFORMATION.
  7606         16  CZ-NOTE                 PIC X(63).
  7607         16  FILLER                  PIC X(39).
  7608******************************************************************
  7609*                                COPY ELCMSTR.
  7610******************************************************************
  7611*                                                                *
  7612*                            ELCMSTR.                            *
  7613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7614*                            VMOD=2.012                          *
  7615*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 140
* EL6311.cbl
  7616*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7617*                                                                *
  7618*   FILE TYPE = VSAM,KSDS                                        *
  7619*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7620*                                                                *
  7621*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7622*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7623*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7624*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7625*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7626*                                                 RKP=75,LEN=21  *
  7627*                                                                *
  7628*   **** NOTE ****                                               *
  7629*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7630*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7631*                                                                *
  7632*   LOG = YES                                                    *
  7633*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7634******************************************************************
  7635*                   C H A N G E   L O G
  7636*
  7637* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7638*-----------------------------------------------------------------
  7639*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7640* EFFECTIVE    NUMBER
  7641*-----------------------------------------------------------------
  7642* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7643* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7644* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7645* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7646* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7647* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7648* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7649******************************************************************
  7650 01  CLAIM-MASTER.
  7651     12  CL-RECORD-ID                PIC XX.
  7652         88  VALID-CL-ID         VALUE 'CL'.
  7653
  7654     12  CL-CONTROL-PRIMARY.
  7655         16  CL-COMPANY-CD           PIC X.
  7656         16  CL-CARRIER              PIC X.
  7657         16  CL-CLAIM-NO             PIC X(7).
  7658         16  CL-CERT-NO.
  7659             20  CL-CERT-PRIME       PIC X(10).
  7660             20  CL-CERT-SFX         PIC X.
  7661
  7662     12  CL-CONTROL-BY-NAME.
  7663         16  CL-COMPANY-CD-A1        PIC X.
  7664         16  CL-INSURED-LAST-NAME    PIC X(15).
  7665         16  CL-INSURED-NAME.
  7666             20  CL-INSURED-1ST-NAME PIC X(12).
  7667             20  CL-INSURED-MID-INIT PIC X.
  7668
  7669     12  CL-CONTROL-BY-SSN.
  7670         16  CL-COMPANY-CD-A2        PIC X.
  7671         16  CL-SOC-SEC-NO.
  7672             20  CL-SSN-STATE        PIC XX.
  7673             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 141
* EL6311.cbl
  7674             20  CL-SSN-LN3          PIC X(3).
  7675
  7676     12  CL-CONTROL-BY-CERT-NO.
  7677         16  CL-COMPANY-CD-A4        PIC X.
  7678         16  CL-CERT-NO-A4.
  7679             20  CL-CERT-A4-PRIME    PIC X(10).
  7680             20  CL-CERT-A4-SFX      PIC X.
  7681
  7682     12  CL-CONTROL-BY-CCN.
  7683         16  CL-COMPANY-CD-A5        PIC X.
  7684         16  CL-CCN-A5.
  7685             20  CL-CCN.
  7686                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7687                 24  CL-CCN-PRIME-A5 PIC X(12).
  7688             20  CL-CCN-FILLER-A5    PIC X(4).
  7689
  7690     12  CL-INSURED-PROFILE-DATA.
  7691         16  CL-INSURED-BIRTH-DT     PIC XX.
  7692         16  CL-INSURED-SEX-CD       PIC X.
  7693             88  INSURED-IS-MALE        VALUE 'M'.
  7694             88  INSURED-IS-FEMALE      VALUE 'F'.
  7695             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7696         16  CL-INSURED-OCC-CD       PIC X(6).
  7697         16  FILLER                  PIC X(5).
  7698
  7699     12  CL-PROCESSING-INFO.
  7700         16  CL-PROCESSOR-ID         PIC X(4).
  7701         16  CL-CLAIM-STATUS         PIC X.
  7702             88  CLAIM-IS-OPEN          VALUE 'O'.
  7703             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7704         16  CL-CLAIM-TYPE           PIC X.
  7705*            88  AH-CLAIM               VALUE 'A'.
  7706*            88  LIFE-CLAIM             VALUE 'L'.
  7707*            88  PROPERTY-CLAIM         VALUE 'P'.
  7708*            88  IUI-CLAIM              VALUE 'I'.
  7709*            88  GAP-CLAIM              VALUE 'G'.
  7710*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7711*            88  OTHER-CLAIM            VALUE 'O'.
  7712         16  CL-CLAIM-PREM-TYPE      PIC X.
  7713             88  SINGLE-PREMIUM         VALUE '1'.
  7714             88  O-B-COVERAGE           VALUE '2'.
  7715             88  OPEN-END-COVERAGE      VALUE '3'.
  7716         16  CL-INCURRED-DT          PIC XX.
  7717         16  CL-REPORTED-DT          PIC XX.
  7718         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7719         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7720         16  CL-LAST-PMT-DT          PIC XX.
  7721         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7722         16  CL-PAID-THRU-DT         PIC XX.
  7723         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7724         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7725         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7726         16  CL-PMT-CALC-METHOD      PIC X.
  7727             88  CL-360-DAY-YR          VALUE '1'.
  7728             88  CL-365-DAY-YR          VALUE '2'.
  7729             88  CL-FULL-MONTHS         VALUE '3'.
  7730         16  CL-CAUSE-CD             PIC X(6).
  7731
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 142
* EL6311.cbl
  7732         16  CL-PRIME-CERT-NO.
  7733             20  CL-PRIME-CERT-PRIME PIC X(10).
  7734             20  CL-PRIME-CERT-SFX   PIC X.
  7735
  7736         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7737             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7738             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7739
  7740         16  CL-MICROFILM-NO         PIC X(10).
  7741         16  FILLER REDEFINES CL-MICROFILM-NO.
  7742             20  CL-BENEFIT-PERIOD   PIC 99.
  7743             20  FILLER              PIC X(8).
  7744         16  CL-PROG-FORM-TYPE       PIC X.
  7745         16  CL-LAST-ADD-ON-DT       PIC XX.
  7746
  7747         16  CL-LAST-REOPEN-DT       PIC XX.
  7748         16  CL-LAST-CLOSE-DT        PIC XX.
  7749         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7750             88  FINAL-PAID             VALUE '1'.
  7751             88  CLAIM-DENIED           VALUE '2'.
  7752             88  AUTO-CLOSE             VALUE '3'.
  7753             88  MANUAL-CLOSE           VALUE '4'.
  7754             88  BENEFITS-CHANGED       VALUE 'C'.
  7755             88  SETUP-ERRORS           VALUE 'E'.
  7756         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7757         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7758         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7759             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7760         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7761         16  FILLER                  PIC X.
  7762
  7763     12  CL-CERTIFICATE-DATA.
  7764         16  CL-CERT-ORIGIN          PIC X.
  7765             88  CERT-WAS-ONLINE        VALUE '1'.
  7766             88  CERT-WAS-CREATED       VALUE '2'.
  7767             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7768         16  CL-CERT-KEY-DATA.
  7769             20  CL-CERT-CARRIER     PIC X.
  7770             20  CL-CERT-GROUPING    PIC X(6).
  7771             20  CL-CERT-STATE       PIC XX.
  7772             20  CL-CERT-ACCOUNT.
  7773                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7774                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7775             20  CL-CERT-EFF-DT      PIC XX.
  7776
  7777     12  CL-STATUS-CONTROLS.
  7778         16  CL-PRIORITY-CD          PIC X.
  7779             88  CONFIDENTIAL-DATA      VALUE '8'.
  7780             88  HIGHEST-PRIORITY       VALUE '9'.
  7781         16  CL-SUPV-ATTN-CD         PIC X.
  7782             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7783             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7784         16  CL-PURGED-DT            PIC XX.
  7785         16  CL-RESTORED-DT          PIC XX.
  7786         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7787         16  CL-NEXT-RESEND-DT       PIC XX.
  7788         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7789         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 143
* EL6311.cbl
  7790*        16  FILLER                  PIC XX.
  7791         16  CL-LAST-MAINT-DT        PIC XX.
  7792         16  CL-LAST-MAINT-USER      PIC X(4).
  7793         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7794         16  CL-LAST-MAINT-TYPE      PIC X.
  7795             88  CLAIM-SET-UP           VALUE ' '.
  7796             88  PAYMENT-MADE           VALUE '1'.
  7797             88  LETTER-SENT            VALUE '2'.
  7798             88  MASTER-WAS-ALTERED     VALUE '3'.
  7799             88  MASTER-WAS-RESTORED    VALUE '4'.
  7800             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7801             88  FILE-CONVERTED         VALUE '6'.
  7802             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7803             88  ERROR-CORRECTION       VALUE 'E'.
  7804         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7805         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7806         16  CL-BENEFICIARY          PIC X(10).
  7807         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7808         16  CL-DENIAL-TYPE          PIC X.
  7809             88  CL-TYPE-DENIAL          VALUE '1'.
  7810             88  CL-TYPE-RESCISSION      VALUE '2'.
  7811             88  CL-TYPE-REFORMATION     VALUE '3'.
  7812             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7813             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7814         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7815         16  filler                  pic x(3).
  7816*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7817*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7818*        16  CL-RTW-DT               PIC XX.
  7819
  7820     12  CL-TRAILER-CONTROLS.
  7821         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7822             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7823             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7824             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7825         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7826         16  FILLER                  PIC XX.
  7827         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7828         16  CL-ADDRESS-TRAILER-CNT.
  7829             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7830                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7831             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7832                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7833             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7834                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7835             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7836                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7837             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7838                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7839             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7840                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7841             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7842                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7843
  7844     12  CL-CV-REFERENCE-NO.
  7845         16  CL-CV-REFNO-PRIME       PIC X(18).
  7846         16  CL-CV-REFNO-SFX         PIC XX.
  7847
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 144
* EL6311.cbl
  7848     12  CL-FILE-LOCATION            PIC X(4).
  7849
  7850     12  CL-PROCESS-ERRORS.
  7851         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7852             88  NO-FATAL-ERRORS        VALUE ZERO.
  7853         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7854             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7855
  7856     12  CL-PRODUCT-CD               PIC X.
  7857
  7858     12  CL-CURRENT-KEY-DATA.
  7859         16  CL-CURRENT-CARRIER      PIC X.
  7860         16  CL-CURRENT-GROUPING     PIC X(6).
  7861         16  CL-CURRENT-STATE        PIC XX.
  7862         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7863
  7864     12  CL-ASSOCIATES               PIC X.
  7865         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7866         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7867         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7868         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7869
  7870     12  CL-ACTIVITY-CODE            PIC 99.
  7871     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7872     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7873
  7874     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7875     12  CL-LAG-REPORT-CODE          PIC 9.
  7876     12  CL-LOAN-TYPE                PIC XX.
  7877     12  CL-LEGAL-STATE              PIC XX.
  7878
  7879     12  CL-YESNOSW                  PIC X.
  7880     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7881         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7882         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7883         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7884     12  cl-insured-type             pic x.
  7885         88  cl-claim-on-primary         value 'P'.
  7886         88  cl-claim-on-co-borrower     value 'C'.
  7887     12  cl-benefit-expiration-dt    PIC XX.
  7888*                                COPY ERCENDT.
  7889******************************************************************
  7890*                                                                *
  7891*                                                                *
  7892*                            ERCENDT.                            *
  7893*                            VMOD=2.001                          *
  7894*                                                                *
  7895*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7896*                                                                *
  7897*   FILE TYPE = VSAM,KSDS                                        *
  7898*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7899*                                                                *
  7900*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7901*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7902*                                                                *
  7903*   LOG = NO                                                     *
  7904*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7905******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 145
* EL6311.cbl
  7906*-----------------------------------------------------------------
  7907*                   C H A N G E   L O G
  7908*
  7909* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7910*-----------------------------------------------------------------
  7911*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7912* EFFECTIVE    NUMBER
  7913*-----------------------------------------------------------------
  7914* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7915*                                WITH OPEN CLAIMS
  7916* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7917* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7918* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7919* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7920*-----------------------------------------------------------------
  7921 01  ENDORSEMENT-RECORD.
  7922     12  EN-RECORD-ID                PIC XX.
  7923         88  VALID-EN-ID                VALUE 'EN'.
  7924     12  EN-CONTROL-PRIMARY.
  7925         16  EN-COMPANY-CD           PIC X.
  7926         16  EN-CARRIER              PIC X.
  7927         16  EN-GROUPING             PIC X(6).
  7928         16  EN-STATE                PIC XX.
  7929         16  EN-ACCOUNT              PIC X(10).
  7930         16  EN-CERT-EFF-DT          PIC XX.
  7931         16  EN-CERT-NO.
  7932             20  EN-CERT-PRIME       PIC X(10).
  7933             20  EN-CERT-SFX         PIC X.
  7934         16  EN-REC-TYPE             PIC X.
  7935             88  EN-ISSUE               VALUE 'I'.
  7936             88  EN-CANCELLATION        VALUE 'C'.
  7937         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7938     12  EN-CONTROL-BY-ARCH-NO.
  7939         16  EN-COMPANY-CD-A1              PIC X.
  7940         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7941     12  EN-LAST-MAINT-DT            PIC XX.
  7942     12  EN-LAST-MAINT-BY            PIC X(4).
  7943     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7944     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7945     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7946         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7947         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7948         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7949         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7950         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7951         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7952         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7953         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7954         16  EN-LF-ORIG-BENCD        PIC XX.
  7955         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7956         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7957         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7958         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7959         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7960         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7961*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7962         16  EN-ORIG-CRED-BENE       PIC X(25).
  7963         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 146
* EL6311.cbl
  7964         16  FILLER                  PIC X.
  7965         16  EN-AH-ORIG-BENCD        PIC XX.
  7966         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7967         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7968         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7969         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7970*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7971*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7972         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7973         16  F                       PIC X(09).
  7974         16  EN-AH-ORIG-CP           PIC 99.
  7975         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7976         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7977         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7978         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7979         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7980         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7981         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7982         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7983         16  EN-LF-NEW-BENCD         PIC XX.
  7984         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7985         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7986         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7987         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7988         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7989         16  EN-LF-NEW-EXP-DT        PIC XX.
  7990         16  EN-NEW-CRED-BENE        PIC X(25).
  7991         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7992         16  FILLER                  PIC X.
  7993         16  EN-AH-NEW-BENCD         PIC XX.
  7994         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7995         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7996         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7997         16  EN-AH-NEW-EXP-DT        PIC XX.
  7998*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7999*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8000*        16  F                       PIC X(12).
  8001         16  EN-AH-NEW-CP            PIC 99.
  8002         16  EN-SIG-SW               PIC X.
  8003         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8004         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8005         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8006         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8007         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8008         16  FILLER                  PIC X(33).
  8009     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8010         16  EN-LF-ORIG-REF-DT       PIC XX.
  8011         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8012         16  EN-AH-ORIG-REF-DT       PIC XX.
  8013         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8014         16  EN-LF-NEW-REF-DT        PIC XX.
  8015         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8016         16  EN-AH-NEW-REF-DT        PIC XX.
  8017         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8018         16  EN-FLAG-CERT            PIC X.
  8019         16  EN-INS-LAST-NAME        PIC X(15).
  8020         16  EN-INS-FIRST-NAME       PIC X(10).
  8021         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 147
* EL6311.cbl
  8022         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8023         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8024         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8025         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8026         16  FILLER                  PIC X(262).
  8027     12  EN-MONEY-SW             PIC X.
  8028     12  EN-HEALTH-APP           PIC X.
  8029     12  EN-VOUCHER-SW           PIC X.
  8030     12  EN-PAYEE                PIC X(14).
  8031     12  EN-INPUT-DT             PIC XX.
  8032     12  EN-PROCESS-DT           PIC XX.
  8033     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8034     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8035     12  EN-REASON-CODES.
  8036         16  F OCCURS 12.
  8037             20  EN-REASON-CODE  PIC X(4).
  8038     12  EN-TEMPLATE-USED        PIC X(8).
  8039     12  EN-DOCU-TYPE            PIC X.
  8040         88  EN-VERI-DOCU          VALUE 'V'.
  8041         88  EN-GCE-DOCU           VALUE 'G'.
  8042         88  EN-CANC-DOCU          VALUE 'C'.
  8043     12  EN-COMMENTS1            PIC X(13).
  8044     12  EN-COMMENTS2            PIC X(70).
  8045     12  EN-COMM-CHGBK           PIC X.
  8046         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8047         88  EN-CHG-ACCT           VALUE 'Y'.
  8048     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8049     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8050     12  EN-BATCH-NUMBER         PIC X(6).
  8051     12  EN-ACCT-SUMM            PIC X.
  8052     12  EN-CSO-SUMM             PIC X.
  8053     12  en-check-type           pic x.
  8054     12  FILLER                  PIC X(12).
  8055******************************************************************
  8056*                                COPY ELCCRTT.
  8057******************************************************************
  8058*                                                                *
  8059*                            ELCCRTT.                            *
  8060*                                                                *
  8061*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8062*                                                                *
  8063*   FILE TYPE = VSAM,KSDS                                        *
  8064*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8065*                                                                *
  8066*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8067*                                                                *
  8068*   LOG = YES                                                    *
  8069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8070******************************************************************
  8071*                   C H A N G E   L O G
  8072*
  8073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8074*-----------------------------------------------------------------
  8075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8076* EFFECTIVE    NUMBER
  8077*-----------------------------------------------------------------
  8078* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8079* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 148
* EL6311.cbl
  8080* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8081* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8082* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8083* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8084* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8085* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8086* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8087* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8088* 091318  CR2018073000001  PEMA  ADD Refund methods
  8089* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8090******************************************************************
  8091
  8092 01  CERTIFICATE-TRAILERS.
  8093     12  CS-RECORD-ID                      PIC XX.
  8094         88  VALID-CS-ID                      VALUE 'CS'.
  8095
  8096     12  CS-CONTROL-PRIMARY.
  8097         16  CS-COMPANY-CD                 PIC X.
  8098         16  CS-CARRIER                    PIC X.
  8099         16  CS-GROUPING                   PIC X(6).
  8100         16  CS-STATE                      PIC XX.
  8101         16  CS-ACCOUNT                    PIC X(10).
  8102         16  CS-CERT-EFF-DT                PIC XX.
  8103         16  CS-CERT-NO.
  8104             20  CS-CERT-PRIME             PIC X(10).
  8105             20  CS-CERT-SFX               PIC X.
  8106         16  CS-TRAILER-TYPE               PIC X.
  8107             88  COMM-TRLR           VALUE 'A'.
  8108             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8109             88  CERT-DATA-TRLR      VALUE 'C'.
  8110
  8111     12  CS-DATA-AREA                      PIC X(516).
  8112
  8113     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8114         16  CS-BANK-COMMISSION-AREA.
  8115             20  CS-BANK-COMMS       OCCURS 10.
  8116                 24  CS-AGT                PIC X(10).
  8117                 24  CS-COM-TYP            PIC X.
  8118                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8119                 24  CS-RECALC-LV-INDIC    PIC X.
  8120                 24  FILLER                PIC X(10).
  8121         16  FILLER                        PIC X(256).
  8122
  8123     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8124****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8125         16  CS-MB-CLAIM-DATA OCCURS 24.
  8126             20  CS-CLAIM-NO               PIC X(7).
  8127             20  CS-CLAIM-TYPE             PIC X.
  8128                 88  CS-AH-CLM               VALUE 'A'.
  8129                 88  CS-IU-CLM               VALUE 'I'.
  8130                 88  CS-GP-CLM               VALUE 'G'.
  8131                 88  CS-LF-CLM               VALUE 'L'.
  8132                 88  CS-PR-CLM               VALUE 'P'.
  8133                 88  CS-FL-CLM               VALUE 'F'.
  8134                 88  CS-OT-CLM               VALUE 'O'.
  8135             20  CS-INSURED-TYPE           PIC X.
  8136                 88  CS-PRIM-INSURED          VALUE 'P'.
  8137                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 149
* EL6311.cbl
  8138             20  CS-BENEFIT-PERIOD         PIC 99.
  8139             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8140             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8141             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8142         16  FILLER                        PIC X(12).
  8143     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8144         16  CS-VIN-NUMBER                 PIC X(17).
  8145         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8146         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8147         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8148         16  cs-agent-name.
  8149             20  cs-agent-fname            pic x(20).
  8150             20  cs-agent-mi               pic x.
  8151             20  cs-agent-lname            pic x(25).
  8152         16  cs-license-no                 pic x(15).
  8153         16  cs-npn-number                 pic x(10).
  8154         16  cs-agent-edit-status          pic x.
  8155             88  cs-ae-refer-to-manager      value 'M'.
  8156             88  cs-ae-cover-sheet           value 'C'.
  8157             88  cs-ae-sig-form              value 'S'.
  8158             88  cs-ae-verified              value 'V'.
  8159             88  cs-unidentified-signature   value 'U'.
  8160             88  cs-cert-returned            value 'R'.
  8161             88  cs-accept-no-commission     value 'N'.
  8162         16  cs-year                       pic 9999.
  8163         16  cs-make                       pic x(20).
  8164         16  cs-model                      pic x(20).
  8165         16  cs-future                     pic x(20).
  8166         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8167         16  cs-claim-verification-status  pic x.
  8168             88  cs-clm-ver-eligible         value 'A'.
  8169             88  cs-clm-ver-partial-elig     value 'B'.
  8170             88  cs-clm-ver-not-eligible     value 'C'.
  8171             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8172             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8173             88  cs-clm-ver-ND-CERT          value 'F'.
  8174             88  cs-clm-ver-spec-other       value 'G'.
  8175             88  cs-clam-ver-pratial-corrected
  8176                                             value 'H'.
  8177             88  cs-clm-ver-no-matches       value 'I'.
  8178             88  cs-clm-ver-not-elig-corrected
  8179                                             value 'J'.
  8180             88  cs-clm-ver-needs-review     value 'R'.
  8181             88  cs-clm-ver-sent-to-claims   value 'W'.
  8182         16  CS-LF-REFUND-METHOD           PIC X.
  8183         16  CS-AH-REFUND-METHOD           PIC X.
  8184         16  FILLER                        PIC X(353). *> was 420
  8185*        16  FILLER                        PIC X(496).
  8186*                                COPY ERCCHEK.
  8187******************************************************************
  8188*                                                                *
  8189*                                                                *
  8190*                            ERCCHEK                             *
  8191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8192*                            VMOD=2.008                          *
  8193*                                                                *
  8194*   FILE DESCRIPTION = CHECK RECORDS                             *
  8195*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 150
* EL6311.cbl
  8196*   FILE TYPE = VSAM,KSDS                                        *
  8197*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8198*                                                                *
  8199*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8200*       ALTERNATE INDEX = NONE                                   *
  8201*                                                                *
  8202*   LOG = YES                                                    *
  8203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8204******************************************************************
  8205*                   C H A N G E   L O G
  8206*
  8207* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8208*-----------------------------------------------------------------
  8209*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8210* EFFECTIVE    NUMBER
  8211*-----------------------------------------------------------------
  8212* 021414    2003053000001  PEMA  changes for auto chk request
  8213******************************************************************
  8214 01  CHECK-RECORDS.
  8215     12  CH-RECORD-ID                      PIC XX.
  8216         88  VALID-CH-ID                      VALUE 'CH'.
  8217
  8218     12  CH-CONTROL-PRIMARY.
  8219         16  CH-COMPANY-CD                 PIC X.
  8220         16  CH-CARRIER                    PIC X.
  8221         16  CH-GROUPING                   PIC X(6).
  8222         16  CH-STATE                      PIC XX.
  8223         16  CH-ACCOUNT                    PIC X(10).
  8224         16  CH-CERT-EFF-DT                PIC XX.
  8225         16  CH-CERT-NO.
  8226             20  CH-CERT-PRIME             PIC X(10).
  8227             20  CH-CERT-SFX               PIC X.
  8228         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8229
  8230     12  CH-RECORDED-DT                    PIC XX.
  8231     12  CH-RECORDED-BY                    PIC X(4).
  8232     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8233
  8234     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8235     12  CH-CHECK-NO                       PIC X(7).
  8236     12  CH-REASON-FOR-CHECK               PIC X(25).
  8237     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8238     12  FILLER                            PIC X.
  8239
  8240     12  CH-PAYEE-INFO.
  8241         16  CH-PAYEE-NAME-1               PIC X(30).
  8242         16  CH-PAYEE-NAME-2               PIC X(30).
  8243         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8244         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8245         16  CH-PAYEE-CITY-ST.
  8246             20  CH-PAYEE-CITY             PIC X(28).
  8247             20  CH-PAYEE-STATE            PIC XX.
  8248         16  CH-PAYEE-ZIP-CODE.
  8249             20  CH-PAYEE-ZIP.
  8250                 24  CH-ZIP-PRI-1ST        PIC X.
  8251                     88  CH-CANADIAN-POST-CODE
  8252                                           VALUES 'A' THRU 'Z'.
  8253                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 151
* EL6311.cbl
  8254             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8255         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8256             20  CH-CAN-POSTAL-1           PIC XXX.
  8257             20  CH-CAN-POSTAL-2           PIC XXX.
  8258             20  FILLER                    PIC XXX.
  8259
  8260     12  CH-CHECK-STUB-TEXT.
  8261         16  CH-STUB-LINE-1                PIC X(30).
  8262         16  CH-TEXT-LINE-1                PIC X(50).
  8263         16  CH-TEXT-LINE-2                PIC X(50).
  8264         16  CH-TEXT-LINE-3                PIC X(40).
  8265     12  CH-RETURN-TO                      PIC X(30).
  8266
  8267     12  CH-COMPENSATION-CONTROL.
  8268         16  CH-COMP-CARRIER               PIC X.
  8269         16  CH-COMP-GROUPING              PIC X(6).
  8270         16  CH-COMP-FIN-RESP              PIC X(10).
  8271         16  CH-COMP-ACCOUNT               PIC X(10).
  8272
  8273     12  CH-CREDIT-SELECT-DT               PIC XX.
  8274     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8275     12  CH-PAYEE-CODE                     PIC X(6).
  8276
  8277     12  CH-VOID-DATA.
  8278         20  CH-VOID-DT                    PIC XX.
  8279         20  CH-VOID-BY                    PIC X(4).
  8280         20  CH-VOID-REASON                PIC X(25).
  8281
  8282     12  CH-APPROVAL-DATA.
  8283         20  CH-APPROVAL-DT                PIC XX.
  8284         20  CH-APPROVAL-STATUS            PIC X.
  8285             88  CH-IN-LIMBO                  VALUE ' '.
  8286             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8287             88  CH-APPROVED                  VALUE 'A'.
  8288             88  CH-DENIED                    VALUE 'D'.
  8289         20  CH-APPROVED-BY                PIC XXXX.
  8290     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8291             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8292     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8293
  8294     12  ch-released-dt                    pic xx.
  8295     12  ch-check-cashed-dt                pic xx.
  8296     12  FILLER                            PIC X.
  8297*    12  CH-CHECK-REFERENCE                PIC X(12).
  8298     12  CH-CHECK-ORIGIN-SW                PIC X.
  8299             88  CH-REFUND-CHECK              VALUE 'R'.
  8300             88  CH-MAINT-CHECK               VALUE 'M'.
  8301
  8302     12  CH-CANC-DT                        PIC XX.
  8303     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8304     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8305
  8306     12  CH-INSURED-NAME                   PIC X(28).
  8307
  8308     12  ch-released-by                    pic x(4).
  8309     12  ch-csr                            pic x(4).
  8310     12  ch-deduct-commission              pic x.
  8311         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 152
* EL6311.cbl
  8312         88  ch-do-not-deduct-comm           value 'N'.
  8313
  8314     12  FILLER                            PIC X(11).
  8315*    12  CH-LETTER-TABLE.
  8316*        16  CH-LETTERS OCCURS 3 TIMES
  8317*                       INDEXED BY CH-LT-NDX
  8318*                                          PIC X(04).
  8319
  8320     12  FILLER                            PIC X(07).
  8321
  8322 01  var                         pic x(30).
  8323 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8324                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8325                          PENDING-MAILING-DATA MAILING-DATA
  8326                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8327                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8328                          CLAIM-MASTER ENDORSEMENT-RECORD
  8329                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8330                          VAR.
  8331 0000-DFHEXIT SECTION.
  8332     MOVE '9#                    $   ' TO DFHEIV0.
  8333     MOVE 'EL6311' TO DFHEIV1.
  8334     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8335
  8336     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8337     MOVE EIBTRMID               TO QID-TERM.
  8338     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8339     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8340     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8341     MOVE 2                      TO EMI-SWITCH2.
  8342
  8343     move spaces to ws-kix-myenv
  8344     set P to address of KIXSYS
  8345     CALL "getenv" using by value P returning var-ptr
  8346     if var-ptr = null then
  8347        display ' kixsys not set '
  8348     else
  8349        set address of var to var-ptr
  8350        move 0 to env-var-len
  8351        inspect var tallying env-var-len
  8352          for characters before X'00'
  8353        unstring var (1:env-var-len) delimited by '/'
  8354           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8355              WS-KIX-SYS
  8356        end-unstring
  8357     end-if
  8358     perform varying a1 from +1 by +1 until a1 > +10
  8359        if ws-kix-myenv (a1:1) = low-values or high-values
  8360           display ' found low or hi val '
  8361           move spaces to ws-kix-myenv (a1:1)
  8362        end-if
  8363     end-perform
  8364*    display ' env *' ws-kix-myenv '*'
  8365     IF EIBCALEN = 0
  8366         GO TO 8800-UNAUTHORIZED-ACCESS.
  8367
  8368     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8369     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 153
* EL6311.cbl
  8370     PERFORM 9700-DATE-LINK.
  8371     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8372     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8373
  8374     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8375     MOVE SPACE                  TO DC-OPTION-CODE.
  8376     PERFORM 9700-DATE-LINK.
  8377     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8378     MOVE LOW-VALUES             TO EL631BI.
  8379
  8380
  8381* EXEC CICS HANDLE CONDITION
  8382*        PGMIDERR  (9600-PGMID-ERROR)
  8383*        ERROR     (9990-ABEND)
  8384*        INVREQ    (9990-ABEND)
  8385*        QIDERR    (0010-MAIN-LOGIC)
  8386*    END-EXEC.
  8387*    MOVE '"$L.8N                ! " #00008376' TO DFHEIV0
  8388     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8390     MOVE X'2220233030303038333736' TO DFHEIV0(25:11)
  8391     CALL 'kxdfhei1' USING DFHEIV0
  8392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8393
  8394
  8395     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8396         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8397             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8398             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8399             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8400             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8401             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8402             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8403             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8404             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8405
  8406             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8407                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8408
  8409             ELSE
  8410                 NEXT SENTENCE
  8411
  8412         ELSE
  8413             IF PI-CALLING-PROGRAM = 'EL6315'
  8414                SET CALLED-FROM-6315 TO TRUE
  8415             END-IF
  8416             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8417             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8418             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8419             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8420             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8421             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8422             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8423             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8424             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8425             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8426             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8427             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 154
* EL6311.cbl
  8428     ELSE
  8429         GO TO 0020-MAIN-LOGIC.
  8430
  8431 0010-MAIN-LOGIC.
  8432     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8433                                    WS-FIRST-ENTRY-SW.
  8434
  8435     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8436
  8437     MOVE LOW-VALUES             TO EC-NEW-CERT
  8438                                    EC-NEW-STATE.
  8439
  8440     IF PI-DISPLAY-ORIGINAL-BATCH
  8441         NEXT SENTENCE
  8442     ELSE
  8443         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8444             GO TO 5000-BROWSE-BATCH-HEADERS.
  8445
  8446     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8447         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8448
  8449     IF PI-CSR-BROWSE
  8450        GO TO 4200-BROWSE-CSR-FORWARD.
  8451
  8452     IF PI-FILE-BROWSE
  8453         GO TO 4300-BROWSE-FILE-FORWARD.
  8454
  8455     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8456
  8457 0020-MAIN-LOGIC.
  8458     IF EIBAID = DFHCLEAR
  8459         GO TO 9400-CLEAR.
  8460
  8461     MOVE LOW-VALUES             TO EC-NEW-CERT
  8462                                    EC-NEW-STATE.
  8463
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 155
* EL6311.cbl
  8465
  8466******************************************************************
  8467*                                                                *
  8468*              R E C E I V E   M A P                             *
  8469*                                                                *
  8470******************************************************************
  8471
  8472 0200-RECEIVE.
  8473     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8474         MOVE ER-0008            TO EMI-ERROR
  8475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8476         IF PI-MAP-NAME = EL631B
  8477             MOVE -1                 TO BMAINTL
  8478             GO TO 8200-SEND-DATAONLY
  8479         ELSE
  8480             IF PI-MAP-NAME = EL631C
  8481                 MOVE -1                 TO CMAINTL
  8482                 GO TO 8200-SEND-DATAONLY
  8483             ELSE
  8484                 IF PI-MAP-NAME = EL631D
  8485                     MOVE -1                 TO DPFENTRL
  8486                     GO TO 8200-SEND-DATAONLY.
  8487
  8488
  8489* EXEC CICS RECEIVE
  8490*        MAP      (PI-MAP-NAME)
  8491*        MAPSET   (MAPSET-EL6311S)
  8492*        INTO     (EL631BI)
  8493*    END-EXEC.
  8494     MOVE LENGTH OF
  8495      EL631BI
  8496       TO DFHEIV11
  8497*    MOVE '8"T I  L              ''   #00008476' TO DFHEIV0
  8498     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8500     MOVE X'2020233030303038343736' TO DFHEIV0(25:11)
  8501     CALL 'kxdfhei1' USING DFHEIV0,
  8502           PI-MAP-NAME,
  8503           EL631BI,
  8504           DFHEIV11,
  8505           MAPSET-EL6311S,
  8506           DFHEIV99,
  8507           DFHEIV99
  8508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8509
  8510
  8511******************************************************************
  8512*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8513******************************************************************
  8514
  8515     IF BTYPE-LEN (1) EQUAL +3
  8516        IF BTYPE (1) EQUAL ALL ' '
  8517            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8518
  8519     IF BTYPE-LEN (2) EQUAL +3
  8520        IF BTYPE (2) EQUAL ALL ' '
  8521            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8522
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 156
* EL6311.cbl
  8523     INSPECT EL631BI CONVERTING '_' TO ' '.
  8524
  8525     IF PI-MAP-NAME = EL631B
  8526         IF BPFENTRL GREATER THAN ZEROS
  8527             IF EIBAID NOT = DFHENTER
  8528                 MOVE ER-0004       TO EMI-ERROR
  8529                 MOVE -1            TO BPFENTRL
  8530                 MOVE AL-UNBOF      TO BPFENTRA
  8531                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8532                 GO TO 8200-SEND-DATAONLY
  8533             ELSE
  8534                 IF BPFENTRI NUMERIC AND
  8535                   (BPFENTRI GREATER 0 AND LESS 25)
  8536                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8537                 ELSE
  8538                     MOVE ER-0029  TO EMI-ERROR
  8539                     MOVE AL-UNBON TO BPFENTRA
  8540                     MOVE -1       TO BPFENTRL
  8541                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8542                     GO TO 8200-SEND-DATAONLY
  8543         ELSE
  8544             NEXT SENTENCE
  8545     ELSE
  8546         IF PI-MAP-NAME = EL631C
  8547            IF CPFENTRL GREATER THAN ZEROS
  8548                IF EIBAID NOT = DFHENTER
  8549                 MOVE ER-0004         TO EMI-ERROR
  8550                 MOVE -1              TO CPFENTRL
  8551                 MOVE AL-UNBOF        TO CPFENTRA
  8552                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8553                 GO TO 8200-SEND-DATAONLY
  8554             ELSE
  8555                 IF CPFENTRI NUMERIC AND
  8556                   (CPFENTRI GREATER 0 AND LESS 25)
  8557                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8558                 ELSE
  8559                     MOVE ER-0029      TO EMI-ERROR
  8560                     MOVE AL-UNBON     TO CPFENTRA
  8561                     MOVE -1           TO CPFENTRL
  8562                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8563                     GO TO 8200-SEND-DATAONLY
  8564         ELSE
  8565             NEXT SENTENCE
  8566     ELSE
  8567     IF PI-MAP-NAME = EL631D
  8568         IF DPFENTRL GREATER THAN ZEROS
  8569             IF EIBAID NOT = DFHENTER
  8570                 MOVE ER-0004         TO EMI-ERROR
  8571                 MOVE -1              TO DPFENTRL
  8572                 MOVE AL-UNBOF        TO DPFENTRA
  8573                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8574                 GO TO 8200-SEND-DATAONLY
  8575             ELSE
  8576                 IF DPFENTRI NUMERIC AND
  8577                   (DPFENTRI GREATER 0 AND LESS 25)
  8578                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8579                 ELSE
  8580                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 157
* EL6311.cbl
  8581                     MOVE AL-UNBON     TO DPFENTRA
  8582                     MOVE -1           TO DPFENTRL
  8583                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8584                     GO TO 8200-SEND-DATAONLY.
  8585
  8586     IF EIBAID = DFHPF23
  8587         GO TO 8810-PF23.
  8588
  8589     IF EIBAID = DFHPF24
  8590         GO TO 9200-RETURN-MAIN-MENU.
  8591
  8592     IF EIBAID = DFHPF12
  8593         GO TO 9500-PF12.
  8594
  8595     IF PI-MAP-NAME = EL631B
  8596        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8597
  8598     IF PI-MAP-NAME = EL631C
  8599        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8600
  8601     IF PI-MAP-NAME = EL631D
  8602        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8603
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 158
* EL6311.cbl
  8605
  8606******************************************************************
  8607*                                                                *
  8608*      ISSUE SCREEN PF KEY CHECKING                              *
  8609*                                                                *
  8610******************************************************************
  8611
  8612******************************************************************
  8613*                                                                *
  8614*      PF KEY FUNCTIONS:                                         *
  8615*                                                                *
  8616*      PF1  = BROWSE FORWARD                                     *
  8617*      PF2  = BROWSE BACKWARD                                    *
  8618*      PF3  = CERTIFICATE LOOKUP                                 *
  8619*      PF4  = DISPLAY BATCH HEADER                               *
  8620*      PF5  = ADD ISSUE  SCREEN                                  *
  8621*      PF6  = ADD CANCEL SCREEN                                  *
  8622*      PF7  = CERTIFICATE DISPLAY                                *
  8623*      PF8  = CERTIFICATE NOTES                                  *
  8624*      PF9  = EDIT CONTROL                                       *
  8625*      PF10 = DISPLAY LETTER SCREEN                              *
  8626*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8627*      PF12 = HELP SCREEN                                        *
  8628*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8629*      PF14 = ACCOUNT MASTER                                     *
  8630*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8631*      PF16 = DISPLAY LETTER REVIEW                              *
  8632*                                                                *
  8633******************************************************************
  8634
  8635 0300-CHECK-ISSUE-PF-KEYS.
  8636     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8637        MOVE ER-2337            TO EMI-ERROR
  8638        MOVE -1                  TO BMAINTL
  8639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8640        GO TO 8200-SEND-DATAONLY.
  8641
  8642     IF EIBAID = DFHPF1
  8643        MOVE '0'                TO PI-EDIT-SW
  8644        IF PI-PRIMARY-BROWSE
  8645           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8646        ELSE
  8647           IF PI-PRIMARY-WITH-SELECT
  8648              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8649           ELSE
  8650              IF PI-FILE-BROWSE
  8651                 GO TO 4300-BROWSE-FILE-FORWARD
  8652              ELSE
  8653                 IF PI-CSR-BROWSE
  8654                    GO TO 4200-BROWSE-CSR-FORWARD
  8655                 ELSE
  8656                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8657
  8658     IF EIBAID = DFHPF2
  8659        MOVE '0'                TO PI-EDIT-SW
  8660        IF PI-PRIMARY-BROWSE
  8661           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8662        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 159
* EL6311.cbl
  8663           IF PI-PRIMARY-WITH-SELECT
  8664              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8665           ELSE
  8666              IF PI-FILE-BROWSE
  8667                 GO TO 4800-BROWSE-FILE-BACKWARD
  8668              ELSE
  8669                 IF PI-CSR-BROWSE
  8670                    GO TO 4900-BROWSE-CSR-BACKWARD
  8671                 ELSE
  8672                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8673
  8674     IF EIBAID = DFHPF3
  8675        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8676        MOVE XCTL-EL127         TO PGM-NAME
  8677        GO TO 9300-XCTL.
  8678
  8679     IF (EIBAID = DFHPF15 OR DFHPF6)
  8680        AND (CSR-EDIT-SESSION)
  8681*       AND (FATAL-OR-UNFORCED)
  8682*       AND (FATAL-ERRORS)
  8683        and (pi-6311-fatal-ctr <> +0)
  8684        MOVE ER-1819             TO EMI-ERROR
  8685        MOVE -1                  TO BMAINTL
  8686        MOVE AL-UANON            TO BMAINTA
  8687        PERFORM 9900-ERROR-FORMAT
  8688                                 THRU 9900-EXIT
  8689        GO TO 8200-SEND-DATAONLY
  8690     END-IF
  8691     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8692      OR (EIBAID = DFHPF10)
  8693        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8694        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8695        IF (RESP-NORMAL)
  8696           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8697              AM-CONTROL-PRIMARY (1:20))
  8698            IF AM-NAME NOT GREATER THAN SPACES OR
  8699               AM-ADDRS NOT GREATER THAN SPACES  OR
  8700               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8701               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8702               AM-ZIP NOT GREATER THAN SPACES
  8703               MOVE ER-3834             TO EMI-ERROR
  8704               MOVE -1                  TO BMAINTL
  8705               MOVE AL-UANON            TO BMAINTA
  8706               PERFORM 9900-ERROR-FORMAT
  8707                                 THRU 9900-EXIT
  8708               GO TO 8200-SEND-DATAONLY
  8709            END-IF
  8710        ELSE
  8711           MOVE ER-1609             TO EMI-ERROR
  8712           MOVE -1                  TO BMAINTL
  8713           MOVE AL-UANON            TO BMAINTA
  8714           PERFORM 9900-ERROR-FORMAT
  8715                                THRU 9900-EXIT
  8716           GO TO 8200-SEND-DATAONLY
  8717        END-IF
  8718
  8719        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8720        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 160
* EL6311.cbl
  8721        IF (ERMAIL-FOUND)
  8722            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8723               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8724               MA-CITY NOT GREATER THAN SPACES OR
  8725               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8726               MA-ZIP-CODE NOT GREATER THAN SPACES
  8727               MOVE ER-3835             TO EMI-ERROR
  8728               MOVE -1                  TO BMAINTL
  8729               MOVE AL-UANON            TO BMAINTA
  8730               PERFORM 9900-ERROR-FORMAT
  8731                                 THRU 9900-EXIT
  8732               GO TO 8200-SEND-DATAONLY
  8733            END-IF
  8734        ELSE
  8735           MOVE ER-3000             TO EMI-ERROR
  8736           MOVE -1                  TO BMAINTL
  8737           MOVE AL-UANON            TO BMAINTA
  8738           PERFORM 9900-ERROR-FORMAT
  8739                                THRU 9900-EXIT
  8740           GO TO 8200-SEND-DATAONLY
  8741        END-IF
  8742
  8743     END-IF
  8744     IF (EIBAID = DFHPF15)
  8745        AND (CSR-EDIT-SESSION)
  8746        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8747        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8748        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8749        MOVE PI-SV-STATE         TO PI-STATE
  8750        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8751        MOVE BCERTNOI            TO PI-CERT-PRIME
  8752        MOVE BSUFIXI             TO PI-CERT-SFX
  8753        MOVE BEFFDTI             TO DEEDIT-FIELD
  8754        PERFORM 8600-DEEDIT
  8755        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8756        MOVE '4'                 TO DC-OPTION-CODE
  8757        PERFORM 9700-DATE-LINK
  8758        IF DATE-CONVERSION-ERROR
  8759           MOVE ER-0348          TO EMI-ERROR
  8760           MOVE -1               TO BEFFDTL
  8761           MOVE AL-UABON         TO BEFFDTA
  8762           PERFORM 9900-ERROR-FORMAT
  8763                                 THRU 9900-EXIT
  8764           GO TO 8200-SEND-DATAONLY
  8765        ELSE
  8766           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8767           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8768           MOVE XCTL-EL6315      TO PGM-NAME
  8769           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8770           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8771           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8772           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8773           GO TO 9300-XCTL
  8774        END-IF
  8775     END-IF
  8776
  8777     IF EIBAID = DFHPF4
  8778        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 161
* EL6311.cbl
  8779        IF PI-DISPLAY-ORIGINAL-BATCH
  8780           NEXT SENTENCE
  8781        ELSE
  8782           GO TO 7200-DISPLAY-BATCHES.
  8783
  8784     IF EIBAID = DFHPF5
  8785        MOVE ER-0029                TO EMI-ERROR
  8786        MOVE -1                     TO BPFENTRL
  8787        MOVE AL-UNBON               TO BPFENTRA
  8788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8789        GO TO 8200-SEND-DATAONLY.
  8790*        MOVE '0'                TO PI-EDIT-SW
  8791*        IF PI-DISPLAY-ORIGINAL-BATCH
  8792*           NEXT SENTENCE
  8793*        ELSE
  8794*           MOVE EL631B              TO PI-MAP-NAME
  8795*           MOVE LOW-VALUES          TO EL631BI
  8796*           MOVE 'A'                 TO BMAINTO
  8797*           MOVE AL-UANON            TO BMAINTA
  8798*           MOVE -1                  TO BMAINTL
  8799*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8800*           GO TO 8100-SEND-INITIAL-MAP.
  8801
  8802     IF EIBAID = DFHPF6
  8803        IF NOT CSR-EDIT-SESSION
  8804           MOVE ER-0029                TO EMI-ERROR
  8805           MOVE -1                     TO BPFENTRL
  8806           MOVE AL-UNBON               TO BPFENTRA
  8807           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8808           GO TO 8200-SEND-DATAONLY
  8809*           MOVE '0'              TO PI-EDIT-SW
  8810*           IF PI-DISPLAY-ORIGINAL-BATCH
  8811*              NEXT SENTENCE
  8812*           ELSE
  8813*              MOVE EL631C        TO PI-MAP-NAME
  8814*              MOVE LOW-VALUES    TO EL631CI
  8815*              MOVE 'A'           TO CMAINTO
  8816*              MOVE AL-UANON      TO CMAINTA
  8817*              MOVE -1            TO CMAINTL
  8818*              MOVE '6'           TO PI-MAINT-FUNCTION
  8819*              GO TO 8100-SEND-INITIAL-MAP
  8820*           END-IF
  8821        ELSE
  8822           PERFORM 5100-PROCESS-POL-RESC
  8823                                 THRU 5100-EXIT
  8824           MOVE  PI-PREV-CONTROL-PRIMARY
  8825                                 TO ERPNDB-KEY
  8826
  8827* EXEC CICS READ
  8828*              SET     (ADDRESS OF PENDING-BUSINESS)
  8829*              DATASET (FILE-ID-ERPNDB)
  8830*              RIDFLD  (ERPNDB-KEY)
  8831*          END-EXEC
  8832*    MOVE '&"S        E          (   #00008797' TO DFHEIV0
  8833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038373937' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 162
* EL6311.cbl
  8837           FILE-ID-ERPNDB,
  8838           DFHEIV20,
  8839           DFHEIV99,
  8840           ERPNDB-KEY,
  8841           DFHEIV99,
  8842           DFHEIV99,
  8843           DFHEIV99
  8844     SET ADDRESS OF PENDING-BUSINESS TO
  8845         DFHEIV20
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8847           PERFORM 9800-LINK-PENDING-EDIT
  8848                                 THRU 9800-EXIT
  8849           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8850           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8851                                    PI-PREV-SEQ-NO
  8852           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8853*                                    WS-CANCEL-LETTER-SW
  8854                                    PI-ALL-ISSUES-SW
  8855                                    PI-ALL-CANCELS-SW
  8856           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8857        END-IF
  8858     END-IF
  8859     IF EIBAID = DFHPF7
  8860        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8861        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8862        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8863        MOVE PI-SV-STATE            TO PI-STATE
  8864        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8865        MOVE BCERTNOI               TO PI-CERT-PRIME
  8866        MOVE BSUFIXI                TO PI-CERT-SFX
  8867        MOVE BEFFDTI                TO DEEDIT-FIELD
  8868        PERFORM 8600-DEEDIT
  8869        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8870        MOVE '4'                    TO DC-OPTION-CODE
  8871        PERFORM 9700-DATE-LINK
  8872        IF DATE-CONVERSION-ERROR
  8873           MOVE ER-0348            TO EMI-ERROR
  8874           MOVE -1                  TO BEFFDTL
  8875           MOVE AL-UABON            TO BEFFDTA
  8876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8877           GO TO 8200-SEND-DATAONLY
  8878        ELSE
  8879           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8880           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8881           MOVE XCTL-EL1273        TO PGM-NAME
  8882           GO TO 9300-XCTL.
  8883
  8884     IF EIBAID = DFHPF8
  8885        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8886        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8887        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8888        MOVE PI-SV-STATE            TO PI-STATE
  8889        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8890        MOVE BCERTNOI               TO PI-CERT-PRIME
  8891        MOVE BSUFIXI                TO PI-CERT-SFX
  8892        MOVE BEFFDTI                TO DEEDIT-FIELD
  8893        PERFORM 8600-DEEDIT
  8894        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 163
* EL6311.cbl
  8895        MOVE '4'                    TO DC-OPTION-CODE
  8896        PERFORM 9700-DATE-LINK
  8897        IF DATE-CONVERSION-ERROR
  8898           MOVE ER-0348            TO EMI-ERROR
  8899           MOVE -1                  TO BEFFDTL
  8900           MOVE AL-UABON            TO BEFFDTA
  8901           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8902           GO TO 8200-SEND-DATAONLY
  8903        ELSE
  8904           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8905           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8906           IF PI-COMPANY-ID = 'DMD'
  8907               MOVE XCTL-EL401DMD      TO PGM-NAME
  8908             ELSE
  8909               MOVE XCTL-EL1279        TO PGM-NAME
  8910           END-IF
  8911           GO TO 9300-XCTL.
  8912
  8913     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8914        MOVE XCTL-EL6312         TO PGM-NAME
  8915
  8916* EXEC CICS XCTL
  8917*           PROGRAM   (PGM-NAME)
  8918*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8919*           LENGTH    (WS-COMM-LENGTH)
  8920*       END-EXEC
  8921*    MOVE '.$C                   %   #00008870' TO DFHEIV0
  8922     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8923     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8924     MOVE X'2020233030303038383730' TO DFHEIV0(25:11)
  8925     CALL 'kxdfhei1' USING DFHEIV0,
  8926           PGM-NAME,
  8927           PROGRAM-INTERFACE-BLOCK,
  8928           WS-COMM-LENGTH,
  8929           DFHEIV99
  8930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8931     ELSE
  8932        MOVE '0'                 TO  PI-EDIT-SW.
  8933
  8934     IF  EIBAID = DFHPF10
  8935         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8936         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8937         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8938                                    PI-1042-WA
  8939         MOVE 4                  TO PI-689-DATA-SOURCE
  8940         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8941         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8942         MOVE PI-SV-STATE        TO PI-689-STATE
  8943         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8944         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8945         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8946         MOVE PI-PB-ALT-CHG-SEQ-NO
  8947                                 TO PI-689-ALT-SEQ-NO
  8948         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8949         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8950         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8951         MOVE +0                 TO PI-689-CONTROL
  8952         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 164
* EL6311.cbl
  8953                                    PI-689-EXP-DATE
  8954                                    PI-689-RESP-PERSON
  8955                                    PI-689-TYPE
  8956                                    PI-689-FOLLOW-UP-EDIT
  8957                                    PI-689-RESEND1-EDIT
  8958                                    PI-689-SEQ-EDIT
  8959                                    PI-689-BCSEQ-EDIT
  8960                                    PI-689-LBL-OVERRIDE
  8961         MOVE W-LETTER-COMMUNICATION-AREAS
  8962                                 TO PI-PROGRAM-WORK-AREA
  8963         MOVE XCTL-EL689         TO PGM-NAME
  8964         GO TO 9300-XCTL.
  8965
  8966     IF  EIBAID = DFHPF16
  8967         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8968         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8969         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8970                                    PI-1042-WA
  8971         MOVE 4                  TO PI-689-DATA-SOURCE
  8972         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8973         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8974         MOVE PI-SV-STATE        TO PI-689-STATE
  8975         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8976         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8977         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8978         MOVE PI-PB-ALT-CHG-SEQ-NO
  8979                                 TO PI-689-ALT-SEQ-NO
  8980         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8981         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8982         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8983         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8984         MOVE W-LETTER-COMMUNICATION-AREAS
  8985                                 TO PI-PROGRAM-WORK-AREA
  8986         MOVE XCTL-EL690         TO PGM-NAME
  8987         GO TO 9300-XCTL.
  8988
  8989     IF EIBAID = DFHPF13
  8990         MOVE XCTL-EL6313        TO PGM-NAME
  8991         GO TO 9300-XCTL.
  8992
  8993     IF EIBAID = DFHPF17
  8994        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8995        IF (PB-I-LOAN-APR numeric)
  8996           and (pb-i-loan-apr < 99.9999)
  8997           AND (PB-I-BENEFICIARY-NAME NOT
  8998              = SPACES AND LOW-VALUES)
  8999
  9000           MOVE LINK-ELVADS          TO PGM-NAME
  9001
  9002* EXEC CICS LINK
  9003*              PROGRAM    (PGM-NAME)
  9004*              COMMAREA   (WS-PASS-AREA)
  9005*              LENGTH     (WS-PASS-AREA-LENGTH)
  9006*          END-EXEC
  9007*    MOVE '."C                   (   #00008945' TO DFHEIV0
  9008     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9010     MOVE X'2020233030303038393435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 165
* EL6311.cbl
  9011     CALL 'kxdfhei1' USING DFHEIV0,
  9012           PGM-NAME,
  9013           WS-PASS-AREA,
  9014           WS-PASS-AREA-LENGTH,
  9015           DFHEIV99,
  9016           DFHEIV99,
  9017           DFHEIV99,
  9018           DFHEIV99
  9019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9020
  9021           MOVE 0000             TO EMI-ERROR
  9022           MOVE -1               TO BMAINTL
  9023           PERFORM 9900-ERROR-FORMAT
  9024                                 THRU 9900-EXIT
  9025           GO TO 8200-SEND-DATAONLY
  9026        ELSE
  9027           MOVE ER-0877            TO EMI-ERROR
  9028           MOVE -1                  TO BEFFDTL
  9029           MOVE AL-UABON            TO BEFFDTA
  9030           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031           GO TO 8200-SEND-DATAONLY
  9032        END-IF
  9033     END-IF
  9034     IF EIBAID = DFHPF14
  9035        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9036        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9037        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9038        MOVE PI-SV-STATE            TO PI-CR-STATE
  9039        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9040        MOVE SPACE                  TO PI-EDIT-SW
  9041        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9042        MOVE XCTL-EL650             TO PGM-NAME
  9043        GO TO 9300-XCTL.
  9044
  9045     IF EIBAID = DFHPF15
  9046        IF PI-COMPANY-ID  =  'HER'
  9047            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9048            MOVE XCTL-EL680         TO PGM-NAME
  9049            GO TO 9300-XCTL.
  9050
  9051     IF EIBAID = DFHENTER OR DFHPF11
  9052        GO TO 1000-ISSUE-MAINLINE.
  9053
  9054     MOVE ER-0029                TO EMI-ERROR
  9055     MOVE -1                     TO BPFENTRL
  9056     MOVE AL-UNBON               TO BPFENTRA
  9057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9058     GO TO 8200-SEND-DATAONLY.
  9059
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 166
* EL6311.cbl
  9061
  9062******************************************************************
  9063*                                                                *
  9064*      CANCEL SCREEN PF KEY CHECKING                             *
  9065*                                                                *
  9066******************************************************************
  9067
  9068******************************************************************
  9069*                                                                *
  9070*      PF KEY FUNCTIONS:                                         *
  9071*                                                                *
  9072*      PF1  = BROWSE FORWARD                                     *
  9073*      PF2  = BROWSE BACKWARD                                    *
  9074*      PF3  = CERTIFICATE LOOKUP                                 *
  9075*      PF4  = DISPLAY BATCH HEADER                               *
  9076*      PF5  = ADD ISSUE SCREEN                                   *
  9077*      PF6  = ADD CANCEL SCREEN                                  *
  9078*      PF7  = CERTIFICATE DISPLAY                                *
  9079*      PF8  = CERTIFICATE NOTES                                  *
  9080*      PF9  = EDIT CONTROL                                       *
  9081*      PF10 = DISPLAY LETTER SCREEN                              *
  9082*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9083*      PF12 = DISPLAY HELP SCREEN                                *
  9084*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9085*      PF14 = ACCOUNT MASTER                                     *
  9086*      PF16 = LETTER REVIEW                                      *
  9087*                                                                *
  9088******************************************************************
  9089
  9090 0400-CHECK-CANCEL-PF-KEYS.
  9091     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9092        MOVE ER-2337             TO EMI-ERROR
  9093        MOVE -1                  TO CMAINTL
  9094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9095        GO TO 8200-SEND-DATAONLY.
  9096
  9097     IF EIBAID = DFHPF1
  9098        MOVE '0'                TO PI-EDIT-SW
  9099        IF PI-PRIMARY-BROWSE
  9100           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9101        ELSE
  9102           IF PI-PRIMARY-WITH-SELECT
  9103              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9104           ELSE
  9105              IF PI-FILE-BROWSE
  9106                 GO TO 4300-BROWSE-FILE-FORWARD
  9107              ELSE
  9108                 IF PI-CSR-BROWSE
  9109                    GO TO 4200-BROWSE-CSR-FORWARD
  9110                 ELSE
  9111                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9112
  9113     IF EIBAID = DFHPF2
  9114        MOVE '0'                TO PI-EDIT-SW
  9115        IF PI-PRIMARY-BROWSE
  9116           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9117        ELSE
  9118           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 167
* EL6311.cbl
  9119              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9120           ELSE
  9121              IF PI-FILE-BROWSE
  9122                 GO TO 4800-BROWSE-FILE-BACKWARD
  9123              ELSE
  9124                 IF PI-CSR-BROWSE
  9125                    GO TO 4900-BROWSE-CSR-BACKWARD
  9126                 ELSE
  9127                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9128
  9129     IF EIBAID = DFHPF3
  9130        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9131        MOVE XCTL-EL127         TO PGM-NAME
  9132        GO TO 9300-XCTL.
  9133
  9134     IF (EIBAID = DFHPF15 OR DFHPF17)
  9135        AND (CSR-EDIT-SESSION)
  9136*       AND (FATAL-OR-UNFORCED)
  9137        AND (FATAL-ERRORS)
  9138        MOVE ER-1819             TO EMI-ERROR
  9139        MOVE -1                  TO CMAINTL
  9140        MOVE AL-UANON            TO CMAINTA
  9141        PERFORM 9900-ERROR-FORMAT
  9142                                 THRU 9900-EXIT
  9143        GO TO 8200-SEND-DATAONLY
  9144     END-IF
  9145     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9146       AND (CSR-EDIT-SESSION)
  9147        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9148        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9149        IF (RESP-NORMAL)
  9150           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9151              AM-CONTROL-PRIMARY (1:20))
  9152            IF AM-NAME NOT GREATER THAN SPACES OR
  9153               AM-ADDRS NOT GREATER THAN SPACES  OR
  9154               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9155               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9156               AM-ZIP NOT GREATER THAN SPACES
  9157               MOVE ER-3834             TO EMI-ERROR
  9158               MOVE -1                  TO BMAINTL
  9159               MOVE AL-UANON            TO BMAINTA
  9160               PERFORM 9900-ERROR-FORMAT
  9161                                 THRU 9900-EXIT
  9162               GO TO 8200-SEND-DATAONLY
  9163            END-IF
  9164        ELSE
  9165           MOVE ER-1609             TO EMI-ERROR
  9166           MOVE -1                  TO BMAINTL
  9167           MOVE AL-UANON            TO BMAINTA
  9168           PERFORM 9900-ERROR-FORMAT
  9169                                THRU 9900-EXIT
  9170           GO TO 8200-SEND-DATAONLY
  9171        END-IF
  9172
  9173        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9174        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9175        IF (ERMAIL-FOUND)
  9176            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 168
* EL6311.cbl
  9177               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9178               MA-CITY NOT GREATER THAN SPACES OR
  9179               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9180               MA-ZIP-CODE NOT GREATER THAN SPACES
  9181               MOVE ER-3835             TO EMI-ERROR
  9182               MOVE -1                  TO BMAINTL
  9183               MOVE AL-UANON            TO BMAINTA
  9184               PERFORM 9900-ERROR-FORMAT
  9185                                 THRU 9900-EXIT
  9186               GO TO 8200-SEND-DATAONLY
  9187            END-IF
  9188        ELSE
  9189           MOVE ER-3000             TO EMI-ERROR
  9190           MOVE -1                  TO BMAINTL
  9191           MOVE AL-UANON            TO BMAINTA
  9192           PERFORM 9900-ERROR-FORMAT
  9193                                THRU 9900-EXIT
  9194           GO TO 8200-SEND-DATAONLY
  9195        END-IF
  9196
  9197     END-IF
  9198     IF (EIBAID = DFHPF15 OR DFHPF17)
  9199        AND (CSR-EDIT-SESSION)
  9200        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9201        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9202        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9203        MOVE PI-SV-STATE         TO PI-STATE
  9204        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9205        MOVE CCERTNOI            TO PI-CERT-PRIME
  9206        MOVE CSUFIXI             TO PI-CERT-SFX
  9207        MOVE CEFFDTI             TO DEEDIT-FIELD
  9208        PERFORM 8600-DEEDIT
  9209        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9210        MOVE '4'                 TO DC-OPTION-CODE
  9211        PERFORM 9700-DATE-LINK
  9212        IF DATE-CONVERSION-ERROR
  9213           MOVE ER-0348          TO EMI-ERROR
  9214           MOVE -1               TO CEFFDTL
  9215           MOVE AL-UABON         TO CEFFDTA
  9216           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9217           GO TO 8200-SEND-DATAONLY
  9218        ELSE
  9219           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9220           PERFORM 6000-CREATE-TEMP-STORAGE
  9221                                 THRU 6000-EXIT
  9222           IF EIBAID = DFHPF17
  9223               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9224                                  THRU 6400-EXIT
  9225               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9226                                 '2' AND '3' AND '4'
  9227                  MOVE ER-3831     TO  EMI-ERROR
  9228                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9229                  GO TO 8200-SEND-DATAONLY
  9230               END-IF
  9231               MOVE 'Y'          TO PI-CLM-RESC-IND
  9232           ELSE
  9233               MOVE 'N'          TO PI-CLM-RESC-IND
  9234           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 169
* EL6311.cbl
  9235           MOVE XCTL-EL6316      TO PGM-NAME
  9236           MOVE '2'              TO PI-ISS-CAN-SW
  9237           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9238           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9239           GO TO 9300-XCTL
  9240        END-IF
  9241     END-IF
  9242
  9243     IF EIBAID = DFHPF4
  9244        MOVE '0'                TO PI-EDIT-SW
  9245        IF PI-DISPLAY-ORIGINAL-BATCH
  9246           NEXT SENTENCE
  9247        ELSE
  9248           GO TO 7200-DISPLAY-BATCHES.
  9249
  9250     IF EIBAID = DFHPF5
  9251        MOVE ER-0029                TO EMI-ERROR
  9252        MOVE -1                     TO BPFENTRL
  9253        MOVE AL-UNBON               TO BPFENTRA
  9254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9255        GO TO 8200-SEND-DATAONLY.
  9256*        MOVE '0'                TO PI-EDIT-SW
  9257*        IF PI-DISPLAY-ORIGINAL-BATCH
  9258*           NEXT SENTENCE
  9259*        ELSE
  9260*           MOVE EL631B              TO PI-MAP-NAME
  9261*           MOVE LOW-VALUES          TO EL631BI
  9262*           MOVE 'A'                 TO BMAINTO
  9263*           MOVE AL-UANON            TO BMAINTA
  9264*           MOVE -1                  TO BMAINTL
  9265*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9266*           GO TO 8100-SEND-INITIAL-MAP.
  9267
  9268     IF EIBAID = DFHPF6
  9269        MOVE ER-0029                TO EMI-ERROR
  9270        MOVE -1                     TO BPFENTRL
  9271        MOVE AL-UNBON               TO BPFENTRA
  9272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273        GO TO 8200-SEND-DATAONLY.
  9274*        MOVE '0'                TO PI-EDIT-SW
  9275*        IF PI-DISPLAY-ORIGINAL-BATCH
  9276*           NEXT SENTENCE
  9277*        ELSE
  9278*           MOVE EL631C              TO PI-MAP-NAME
  9279*           MOVE LOW-VALUES          TO EL631CI
  9280*           MOVE 'A'                 TO CMAINTO
  9281*           MOVE AL-UANON            TO CMAINTA
  9282*           MOVE -1                  TO CMAINTL
  9283*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9284*           GO TO 8100-SEND-INITIAL-MAP.
  9285
  9286     IF EIBAID = DFHPF7
  9287        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9288        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9289        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9290        MOVE PI-SV-STATE            TO PI-STATE
  9291        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9292        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 170
* EL6311.cbl
  9293        MOVE CSUFIXI                TO PI-CERT-SFX
  9294        MOVE CEFFDTI                TO DEEDIT-FIELD
  9295        PERFORM 8600-DEEDIT
  9296        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9297        MOVE '4'                    TO DC-OPTION-CODE
  9298        PERFORM 9700-DATE-LINK
  9299        IF DATE-CONVERSION-ERROR
  9300           MOVE ER-0348            TO EMI-ERROR
  9301           MOVE -1                  TO BEFFDTL
  9302           MOVE AL-UABON            TO BEFFDTA
  9303           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9304           GO TO 8200-SEND-DATAONLY
  9305        ELSE
  9306           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9307           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9308           MOVE XCTL-EL1273        TO PGM-NAME
  9309           GO TO 9300-XCTL.
  9310
  9311     IF EIBAID = DFHPF8
  9312        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9313        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9314        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9315        MOVE PI-SV-STATE            TO PI-STATE
  9316        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9317        MOVE CCERTNOI               TO PI-CERT-PRIME
  9318        MOVE CSUFIXI                TO PI-CERT-SFX
  9319        MOVE CEFFDTI                TO DEEDIT-FIELD
  9320        PERFORM 8600-DEEDIT
  9321        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9322        MOVE '4'                    TO DC-OPTION-CODE
  9323        PERFORM 9700-DATE-LINK
  9324        IF DATE-CONVERSION-ERROR
  9325           MOVE ER-0348             TO EMI-ERROR
  9326           MOVE -1                  TO BEFFDTL
  9327           MOVE AL-UABON            TO BEFFDTA
  9328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9329           GO TO 8200-SEND-DATAONLY
  9330        ELSE
  9331           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9332           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9333           IF PI-COMPANY-ID = 'DMD'
  9334               MOVE XCTL-EL401DMD      TO PGM-NAME
  9335             ELSE
  9336               MOVE XCTL-EL1279        TO PGM-NAME
  9337           END-IF
  9338           GO TO 9300-XCTL.
  9339
  9340     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9341        MOVE XCTL-EL6312     TO PGM-NAME
  9342
  9343* EXEC CICS XCTL
  9344*           PROGRAM  (PGM-NAME)
  9345*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9346*           LENGTH   (WS-COMM-LENGTH)
  9347*       END-EXEC
  9348*    MOVE '.$C                   %   #00009272' TO DFHEIV0
  9349     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 171
* EL6311.cbl
  9351     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
  9352     CALL 'kxdfhei1' USING DFHEIV0,
  9353           PGM-NAME,
  9354           PROGRAM-INTERFACE-BLOCK,
  9355           WS-COMM-LENGTH,
  9356           DFHEIV99
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9358     ELSE
  9359        MOVE '0'                 TO  PI-EDIT-SW.
  9360
  9361     IF EIBAID = DFHPF10
  9362         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9363         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9364         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9365         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9366                                    PI-1042-WA
  9367         MOVE 4                  TO PI-689-DATA-SOURCE
  9368         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9369         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9370         MOVE PI-SV-STATE        TO PI-689-STATE
  9371         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9372         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9373         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9374         MOVE PI-PB-ALT-CHG-SEQ-NO
  9375                                 TO PI-689-ALT-SEQ-NO
  9376         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9377         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9378         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9379         MOVE +0                 TO PI-689-CONTROL
  9380         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9381                                    PI-689-EXP-DATE
  9382                                    PI-689-RESP-PERSON
  9383                                    PI-689-TYPE
  9384                                    PI-689-FOLLOW-UP-EDIT
  9385                                    PI-689-RESEND1-EDIT
  9386                                    PI-689-SEQ-EDIT
  9387                                    PI-689-BCSEQ-EDIT
  9388                                    PI-689-LBL-OVERRIDE
  9389         MOVE W-LETTER-COMMUNICATION-AREAS
  9390                                 TO PI-PROGRAM-WORK-AREA
  9391         MOVE XCTL-EL689         TO PGM-NAME
  9392         GO TO 9300-XCTL.
  9393
  9394     IF  EIBAID = DFHPF16
  9395         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9396         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9397         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9398                                    PI-1042-WA
  9399         MOVE 4                  TO PI-689-DATA-SOURCE
  9400         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9401         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9402         MOVE PI-SV-STATE        TO PI-689-STATE
  9403         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9404         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9405         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9406         MOVE PI-PB-ALT-CHG-SEQ-NO
  9407                                 TO PI-689-ALT-SEQ-NO
  9408         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 172
* EL6311.cbl
  9409         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9410         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9411         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9412         MOVE W-LETTER-COMMUNICATION-AREAS
  9413                                 TO PI-PROGRAM-WORK-AREA
  9414         MOVE XCTL-EL690         TO PGM-NAME
  9415         GO TO 9300-XCTL.
  9416     IF (EIBAID = DFHPF13)
  9417        if (not fatal-errors)
  9418           and (not unforced-errors)
  9419           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9420           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9421           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9422           MOVE PI-SV-STATE      TO PI-STATE
  9423           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9424           MOVE CCERTNOI         TO PI-CERT-PRIME
  9425           MOVE CSUFIXI          TO PI-CERT-SFX
  9426           MOVE CEFFDTI          TO DEEDIT-FIELD
  9427           PERFORM 8600-DEEDIT
  9428           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9429           MOVE '4'              TO DC-OPTION-CODE
  9430           PERFORM 9700-DATE-LINK
  9431           IF DATE-CONVERSION-ERROR
  9432              MOVE ER-0348       TO EMI-ERROR
  9433              MOVE -1            TO CEFFDTL
  9434              MOVE AL-UABON      TO CEFFDTA
  9435              PERFORM 9900-ERROR-FORMAT
  9436                                 THRU 9900-EXIT
  9437              GO TO 8200-SEND-DATAONLY
  9438           ELSE
  9439              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9440              MOVE AL-UANON      TO CEFFDTA
  9441              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9442              PERFORM 6000-CREATE-TEMP-STORAGE
  9443                                 THRU 6000-EXIT
  9444              MOVE XCTL-EL677    TO PGM-NAME
  9445              GO TO 9300-XCTL
  9446           end-if
  9447        else
  9448           MOVE ER-3444          TO EMI-ERROR
  9449           MOVE -1               TO CPFENTRL
  9450           MOVE AL-UNBON         TO CPFENTRA
  9451           PERFORM 9900-ERROR-FORMAT
  9452                                 THRU 9900-EXIT
  9453           GO TO 8200-SEND-DATAONLY
  9454        end-if
  9455     end-if
  9456
  9457     IF EIBAID = DFHPF14
  9458        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9459        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9460        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9461        MOVE PI-SV-STATE            TO PI-CR-STATE
  9462        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9463        MOVE SPACE                  TO PI-EDIT-SW
  9464        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9465        MOVE XCTL-EL650             TO PGM-NAME
  9466        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 173
* EL6311.cbl
  9467
  9468     IF EIBAID = DFHENTER OR DFHPF11
  9469        GO TO 2000-CANCEL-MAINLINE.
  9470
  9471     MOVE ER-0029                TO EMI-ERROR.
  9472     MOVE -1                     TO CPFENTRL.
  9473     MOVE AL-UNBON               TO CPFENTRA.
  9474     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9475     GO TO 8200-SEND-DATAONLY.
  9476
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 174
* EL6311.cbl
  9478
  9479******************************************************************
  9480*                                                                *
  9481*      BATCH SCREEN PF KEY CHECKING                              *
  9482*                                                                *
  9483******************************************************************
  9484
  9485******************************************************************
  9486*                                                                *
  9487*      PF KEY FUNCTIONS:                                         *
  9488*                                                                *
  9489*      PF1 = BROWSE FORWARD                                      *
  9490*      PF2 = BROWSE BACKWARD                                     *
  9491*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9492*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9493*                                                                *
  9494*                                                                *
  9495******************************************************************
  9496
  9497 0500-CHECK-BATCH-PF-KEYS.
  9498     IF EIBAID = DFHPF1
  9499        MOVE '0'                TO PI-EDIT-SW
  9500        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9501           GO TO 5000-BROWSE-BATCH-HEADERS
  9502        ELSE
  9503           IF PI-GOOD-BROWSE
  9504              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9505                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9506              ELSE
  9507                 IF PI-FILE-BROWSE
  9508                    GO TO 4300-BROWSE-FILE-FORWARD
  9509                 ELSE
  9510                    IF PI-CSR-BROWSE
  9511                       GO TO 4200-BROWSE-CSR-FORWARD
  9512                    ELSE
  9513                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9514           ELSE
  9515              GO TO 0800-BROWSE-ERROR.
  9516
  9517     IF EIBAID = DFHPF2
  9518        MOVE '0'                TO PI-EDIT-SW
  9519        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9520           GO TO 5500-BROWSE-BATCH-BACKWARD
  9521        ELSE
  9522           IF PI-GOOD-BROWSE
  9523              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9524                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9525              ELSE
  9526                 IF PI-FILE-BROWSE
  9527                    GO TO 4800-BROWSE-FILE-BACKWARD
  9528                 ELSE
  9529                    IF PI-CSR-BROWSE
  9530                       GO TO 4900-BROWSE-CSR-BACKWARD
  9531                    ELSE
  9532                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9533           ELSE
  9534              GO TO 0800-BROWSE-ERROR.
  9535
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 175
* EL6311.cbl
  9536     IF EIBAID = DFHPF3
  9537        GO TO 3000-BATCH-MAINLINE.
  9538
  9539     IF  EIBAID = DFHPF4
  9540        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9541        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9542        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9543        MOVE PI-SV-STATE            TO PI-CR-STATE
  9544        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9545                                       PI-CR-FIN-RESP
  9546        MOVE 'A'                    TO PI-CR-TYPE
  9547        MOVE SPACE                  TO PI-EDIT-SW
  9548        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9549        MOVE XCTL-EL640             TO PGM-NAME
  9550        GO TO 9300-XCTL.
  9551
  9552     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9553       AND
  9554        (EIBAID = DFHENTER)
  9555           GO TO 3500-EDIT-BATCH-DATA.
  9556
  9557     IF EIBAID = DFHENTER
  9558        GO TO 3500-EDIT-BATCH-DATA.
  9559
  9560     MOVE ER-0029             TO EMI-ERROR.
  9561     MOVE -1                  TO DPFENTRL.
  9562     MOVE AL-UNBON            TO DPFENTRA.
  9563     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9564     GO TO 8200-SEND-DATAONLY.
  9565
  9566 0800-BROWSE-ERROR.
  9567     MOVE ER-2258                TO EMI-ERROR.
  9568     MOVE -1                     TO DPFENTRL.
  9569     MOVE AL-UNBON               TO DPFENTRA.
  9570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9571     GO TO 8200-SEND-DATAONLY.
  9572
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 176
* EL6311.cbl
  9574
  9575******************************************************************
  9576*                                                                *
  9577*                I S S U E   M A I N L I N E                     *
  9578*                                                                *
  9579******************************************************************
  9580
  9581 1000-ISSUE-MAINLINE.
  9582     IF PI-DISPLAY-ORIGINAL-BATCH
  9583        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9584           MOVE ER-0023             TO EMI-ERROR
  9585           MOVE -1                  TO BMAINTL
  9586           MOVE AL-UABON            TO BMAINTA
  9587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9588           GO TO 8200-SEND-DATAONLY
  9589        ELSE
  9590           NEXT SENTENCE
  9591     ELSE
  9592        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9593           MOVE ER-0023             TO EMI-ERROR
  9594           MOVE -1                  TO BMAINTL
  9595           MOVE AL-UABON            TO BMAINTA
  9596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9597           GO TO 8200-SEND-DATAONLY.
  9598
  9599     IF BMAINTI = 'S'
  9600        GO TO 1100-SHOW-REQUEST.
  9601
  9602     IF NOT MODIFY-CAP
  9603         MOVE 'UPDATE'       TO SM-READ
  9604         PERFORM 9995-SECURITY-VIOLATION
  9605         MOVE ER-0070        TO EMI-ERROR
  9606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9607         GO TO 8100-SEND-INITIAL-MAP.
  9608
  9609     IF BMAINTL GREATER THAN ZEROS
  9610        IF PI-PF5-FUNCTION
  9611           IF BMAINTI NOT = 'A'
  9612              MOVE AL-UABON  TO BMAINTA
  9613              MOVE -1        TO BMAINTL
  9614              MOVE ER-2260   TO EMI-ERROR
  9615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9616              GO TO 8200-SEND-DATAONLY.
  9617
  9618     IF BCERTNOL = ZEROS
  9619       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9620         NEXT SENTENCE
  9621     ELSE
  9622         IF BCERTNOL NOT = ZEROS
  9623             MOVE AL-UANON       TO BCERTNOA
  9624         ELSE
  9625             MOVE -1             TO BCERTNOL
  9626             MOVE  1             TO SET-CURSOR-SW
  9627             MOVE ER-2218        TO EMI-ERROR
  9628             MOVE AL-UABON       TO BCERTNOA
  9629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630
  9631     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 177
* EL6311.cbl
  9632         MOVE AL-UANON       TO BSUFIXA
  9633     ELSE
  9634         MOVE AL-SANOF       TO BSUFIXA.
  9635
  9636
  9637* EXEC CICS READ
  9638*        DATASET (FILE-ID-ERPNDB)
  9639*        INTO    (PENDING-BUSINESS)
  9640*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9641*    END-EXEC.
  9642     MOVE LENGTH OF
  9643      PENDING-BUSINESS
  9644       TO DFHEIV11
  9645*    MOVE '&"IL       E          (   #00009555' TO DFHEIV0
  9646     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9648     MOVE X'2020233030303039353535' TO DFHEIV0(25:11)
  9649     CALL 'kxdfhei1' USING DFHEIV0,
  9650           FILE-ID-ERPNDB,
  9651           PENDING-BUSINESS,
  9652           DFHEIV11,
  9653           PI-PREV-CONTROL-PRIMARY,
  9654           DFHEIV99,
  9655           DFHEIV99,
  9656           DFHEIV99
  9657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9658
  9659
  9660     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9661        NEXT SENTENCE
  9662     ELSE
  9663        IF BEFFDTL NOT = ZEROS
  9664           MOVE AL-UNNON             TO BEFFDTA
  9665           MOVE BEFFDTI              TO DEEDIT-FIELD
  9666           PERFORM 8600-DEEDIT
  9667           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9668           MOVE 4                    TO DC-OPTION-CODE
  9669           PERFORM 9700-DATE-LINK
  9670           IF NO-CONVERSION-ERROR
  9671              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9672              ELSE
  9673              MOVE -1                TO BEFFDTL
  9674              MOVE  1                TO SET-CURSOR-SW
  9675              MOVE ER-2226           TO EMI-ERROR
  9676              MOVE AL-UNBON          TO BEFFDTA
  9677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9678           ELSE
  9679              MOVE -1                TO BEFFDTL
  9680              MOVE  1                TO SET-CURSOR-SW
  9681              MOVE ER-2220           TO EMI-ERROR
  9682              MOVE AL-UNBON          TO BEFFDTA
  9683              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9684
  9685     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9686
  9687     IF BCERTNOL NOT = ZEROS
  9688        MOVE BCERTNOI                TO WS-NEW-PRIME
  9689     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 178
* EL6311.cbl
  9690        MOVE SPACES                  TO WS-NEW-PRIME.
  9691
  9692     IF BSUFIXL NOT = ZEROS
  9693        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9694     ELSE
  9695        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9696
  9697     IF BEFFDTL NOT = ZEROS
  9698        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9699     ELSE
  9700        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9701
  9702     IF BMAINTI = 'A' OR 'K' OR 'S'
  9703        NEXT SENTENCE
  9704     ELSE
  9705        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9706        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9707           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9708           WS-PB-RECORD-TYPE NOT = '1'
  9709           IF BMAINTI = 'C'
  9710               MOVE ER-2287          TO EMI-ERROR
  9711               MOVE -1               TO BCERTNOL
  9712               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9713               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9714               GO TO 8200-SEND-DATAONLY
  9715             ELSE
  9716               MOVE ER-2260          TO EMI-ERROR
  9717               MOVE -1               TO BCERTNOL
  9718               MOVE AL-UABON         TO BCERTNOA
  9719               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9720               GO TO 8200-SEND-DATAONLY.
  9721
  9722     IF BMAINTI = 'D'
  9723         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9724
  9725*    IF BMICRNOL  NOT =  ZEROS
  9726*        IF BMICRNOI  NUMERIC
  9727*            MOVE AL-UNNON       TO  BMICRNOA
  9728*        ELSE
  9729*            MOVE -1             TO  BMICRNOL
  9730*            MOVE 1              TO  SET-CURSOR-SW
  9731*            MOVE AL-UNBON       TO  BMICRNOA
  9732*            MOVE ER-2701        TO  EMI-ERROR
  9733*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9734     IF BVINL NOT = ZEROS
  9735        MOVE AL-UANON            TO BVINA
  9736     END-IF
  9737
  9738     IF LETRREQL   GREATER THAN ZEROS
  9739        IF LETRREQI = 'Y'
  9740          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9741           CONTINUE
  9742        ELSE
  9743        IF LETRREQI = 'N'
  9744          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9745           CONTINUE
  9746        ELSE
  9747           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 179
* EL6311.cbl
  9748           MOVE ER-1585          TO EMI-ERROR
  9749           MOVE AL-UABON         TO LETRREQA
  9750           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9751        END-IF
  9752     END-IF.
  9753     IF B1STNML NOT = ZEROS
  9754         MOVE AL-UANON                TO B1STNMA.
  9755
  9756     IF BINITL  NOT = ZEROS
  9757        MOVE AL-UANON                TO BINITA.
  9758
  9759     IF BSEXL NOT = ZEROS
  9760        IF BSEXI = 'M' OR 'F'
  9761           MOVE AL-UANON             TO BSEXA
  9762        ELSE
  9763           MOVE -1               TO BSEXL
  9764           MOVE ER-2629          TO EMI-ERROR
  9765           MOVE AL-UABON         TO BSEXA
  9766           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9767
  9768     IF BAGEL NOT = ZEROS
  9769         IF BAGEI NUMERIC
  9770             MOVE BAGEI              TO WS-BAGE
  9771             MOVE AL-UNNON           TO BAGEA
  9772         ELSE
  9773             MOVE -1                 TO BAGEL
  9774             MOVE  1                 TO SET-CURSOR-SW
  9775             MOVE ER-2223            TO EMI-ERROR
  9776             MOVE AL-UNBON           TO BAGEA
  9777             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9778
  9779     IF BLSTNML NOT = ZERO  OR
  9780        B1STNML NOT = ZERO  OR
  9781        BINITL NOT = ZERO
  9782         IF BAGEL = ZEROS
  9783             MOVE -1                 TO BAGEL
  9784             MOVE  1                 TO SET-CURSOR-SW
  9785             MOVE ER-3269            TO EMI-ERROR
  9786             MOVE AL-UNBON           TO BAGEA
  9787             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9788         END-IF
  9789     END-IF.
  9790
  9791     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9792
  9793     IF (BBIRTHL GREATER THAN +0) AND
  9794        (BBIRTHI NOT EQUAL SPACES)
  9795        NEXT SENTENCE
  9796     ELSE
  9797        GO TO 1010-CHECK-AGE.
  9798
  9799     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9800     PERFORM 8600-DEEDIT.
  9801     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9802     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9803     MOVE AL-UNNON               TO BBIRTHA.
  9804     MOVE '4'                    TO DC-OPTION-CODE.
  9805     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 180
* EL6311.cbl
  9806     IF DATE-CONVERSION-ERROR
  9807        MOVE -1                  TO BBIRTHL
  9808        MOVE  1                  TO SET-CURSOR-SW
  9809        MOVE ER-2228             TO EMI-ERROR
  9810        MOVE AL-UNBON            TO BBIRTHA
  9811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9812        GO TO 1010-CHECK-AGE.
  9813
  9814     IF (NO-CONVERSION-ERROR) AND
  9815        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9816        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9817        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9818        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9819                                    WS-CONVERTED-BIRTH
  9820        MOVE AL-UANON            TO BBIRTHA
  9821     ELSE
  9822        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9823        MOVE AL-UANON            TO BBIRTHA.
  9824
  9825 1010-CHECK-AGE.
  9826
  9827*    IF BAGEL = ZERO
  9828*       IF BBIRTHL GREATER THAN ZERO
  9829*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9830
  9831     IF B1STPMTL NOT = ZEROS
  9832        IF B1STPMTI = SPACES
  9833           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9834        ELSE
  9835           MOVE B1STPMTI             TO DEEDIT-FIELD
  9836           PERFORM 8600-DEEDIT
  9837           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9838           MOVE AL-UNNON             TO B1STPMTA
  9839           MOVE 4                    TO DC-OPTION-CODE
  9840           PERFORM 9700-DATE-LINK
  9841           IF NO-CONVERSION-ERROR
  9842              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9843              MOVE AL-UANON          TO B1STPMTA
  9844           ELSE
  9845              MOVE -1                TO B1STPMTL
  9846              MOVE  1                TO SET-CURSOR-SW
  9847              MOVE ER-2200           TO EMI-ERROR
  9848              MOVE AL-UNBON          TO B1STPMTA
  9849              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9850
  9851     IF BDAYSL NOT = ZEROS
  9852         IF BDAYSI NUMERIC
  9853             MOVE AL-UNNON           TO BDAYSA
  9854         ELSE
  9855             MOVE -1                 TO BDAYSL
  9856             MOVE ER-2530            TO EMI-ERROR
  9857             MOVE AL-UNBON           TO BDAYSA
  9858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9859
  9860     IF BLNTRML NOT = ZEROS
  9861         IF BLNTRMI NUMERIC
  9862             MOVE AL-UNNON       TO BLNTRMA
  9863         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 181
* EL6311.cbl
  9864             MOVE -1             TO BLNTRML
  9865             MOVE ER-2533        TO EMI-ERROR
  9866             MOVE AL-UNBON       TO BLNTRMA
  9867             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9868
  9869**   IF PI-COMPANY-ID = 'DMD'
  9870     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9871        NEXT SENTENCE
  9872     ELSE
  9873         IF BLNOFCRL NOT = ZEROS
  9874            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9875            IF LOAN-OFFICER-FOUND
  9876                MOVE AL-UANON        TO BLNOFCRA
  9877             ELSE
  9878                 MOVE SPACE          TO WS-LOAN-OFFICER
  9879                 MOVE -1             TO BLNOFCRL
  9880                 MOVE  1             TO SET-CURSOR-SW
  9881                 MOVE ER-3006        TO EMI-ERROR
  9882                 MOVE AL-UNBON       TO BLNOFCRA
  9883                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9884
  9885     IF BFREQL NOT = ZEROS
  9886         IF BFREQI NUMERIC
  9887             MOVE AL-UNNON       TO BFREQA
  9888         ELSE
  9889             MOVE -1             TO BFREQL
  9890             MOVE  1             TO SET-CURSOR-SW
  9891             MOVE ER-2223        TO EMI-ERROR
  9892             MOVE AL-UNBON       TO BFREQA
  9893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9894
  9895     IF BMODEL NOT = ZEROS
  9896         MOVE BMODEI             TO WS-MODE-CODE
  9897                                    PI-BMODE
  9898         IF WS-MODE-CODE-VALID
  9899             MOVE AL-UANON       TO BMODEA
  9900         ELSE
  9901             MOVE -1             TO BMODEL
  9902             MOVE ER-2591        TO EMI-ERROR
  9903             MOVE AL-UABON       TO BMODEA
  9904             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9905
  9906     IF BPMTSL NOT = ZEROS
  9907         IF BPMTSI NUMERIC
  9908             MOVE AL-UNNON           TO BPMTSA
  9909             MOVE BPMTSI             TO PI-BPMTS
  9910         ELSE
  9911             MOVE -1                 TO BPMTSL
  9912             MOVE ER-2592            TO EMI-ERROR
  9913             MOVE AL-UNBON           TO BPMTSA
  9914             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9915
  9916     IF BPMTAMTL NOT = ZEROS
  9917
  9918* EXEC CICS BIF DEEDIT
  9919*            FIELD  (BPMTAMTI)
  9920*            LENGTH (9)
  9921*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 182
* EL6311.cbl
  9922     MOVE 9
  9923       TO DFHEIV11
  9924*    MOVE '@"L                   #   #00009818' TO DFHEIV0
  9925     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9926     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9927     MOVE X'2020233030303039383138' TO DFHEIV0(25:11)
  9928     CALL 'kxdfhei1' USING DFHEIV0,
  9929           BPMTAMTI,
  9930           DFHEIV11
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9932        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9933*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9934*        PERFORM 8600-DEEDIT
  9935*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9936
  9937*    IF BAPRL NOT = ZEROS
  9938*        EXEC CICS BIF DEEDIT
  9939*            FIELD  (BAPRI)
  9940*            LENGTH (7)
  9941*        END-EXEC
  9942*        MOVE BAPRI              TO WS-BAPR.
  9943
  9944     IF BAPRL > 0
  9945        MOVE +0                  TO  WS-BAPR
  9946        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9947           (WS-SUB > 7)
  9948           OR (BAPRI (WS-SUB:1) NUMERIC)
  9949           OR (BAPRI (WS-SUB:1) = '.')
  9950        END-PERFORM
  9951        IF WS-SUB > 7
  9952           MOVE ER-2471       TO EMI-ERROR
  9953           MOVE -1            TO BAPRL
  9954           MOVE AL-UNBON      TO BAPRA
  9955           PERFORM 9900-ERROR-FORMAT
  9956                                 THRU 9900-EXIT
  9957        ELSE
  9958           IF BAPRI (WS-SUB:1) NUMERIC
  9959              MOVE WS-SUB           TO WS-BEG
  9960              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9961                 (WS-SUB > 7)
  9962                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9963              END-PERFORM
  9964              COMPUTE WS-END = WS-SUB - WS-BEG
  9965              MOVE BAPRI (WS-BEG:WS-END)
  9966                                 TO WS-APR-WHOLE-NUM
  9967           END-IF
  9968           IF BAPRI (WS-SUB:1) = '.'
  9969              COMPUTE WS-BEG = WS-SUB + 1
  9970              IF (WS-BEG < 8)
  9971                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9972                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9973                    (WS-SUB > 7)
  9974                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9975                 END-PERFORM
  9976                 COMPUTE WS-END = WS-SUB - WS-BEG
  9977                 MOVE BAPRI (WS-BEG:WS-END)
  9978                                 TO WS-APR-DEC (1:WS-END)
  9979              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 183
* EL6311.cbl
  9980           END-IF
  9981           MOVE AL-UNNON      TO BAPRA
  9982           MOVE WS-BAPR       TO BAPRO
  9983        END-IF
  9984     END-IF
  9985*     IF BAPRL NOT = ZEROS
  9986*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9987*        PERFORM 8600-DEEDIT
  9988*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9989
  9990     IF BLIVESL NOT = ZEROS
  9991        MOVE BLIVESI             TO DEEDIT-FIELD
  9992        PERFORM 8600-DEEDIT
  9993        IF DEEDIT-FIELD-V0 NUMERIC
  9994           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9995           MOVE AL-UNNON         TO BLIVESA
  9996        ELSE
  9997           MOVE -1               TO BLIVESL
  9998           MOVE AL-UNBON         TO BLIVESA
  9999           MOVE ER-2223          TO EMI-ERROR
 10000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10001
 10002*DMD CUSTOM CODING*************START
 10003*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10004     IF PI-COMPANY-ID NOT = 'DMD'
 10005         MOVE ZEROS               TO BBILLEDL
 10006         GO TO 1010-EDIT-CONT.
 10007
 10008     IF BBILLEDL NOT = ZEROS
 10009        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10010        MOVE 'Y'                 TO WS-NUMERIC-SW
 10011        MOVE +1                  TO WS-CSO-SUB
 10012        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10013        IF CSO-NUMERIC-FIELD
 10014
 10015* EXEC CICS BIF DEEDIT
 10016*              FIELD  (BBILLEDI)
 10017*              LENGTH (9)
 10018*          END-EXEC
 10019     MOVE 9
 10020       TO DFHEIV11
 10021*    MOVE '@"L                   #   #00009904' TO DFHEIV0
 10022     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303039393034' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           BBILLEDI,
 10027           DFHEIV11
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10029           MOVE BBILLEDI         TO WS-BILLED
 10030           MOVE AL-UNNON         TO BBILLEDA
 10031        ELSE
 10032           MOVE -1               TO BBILLEDL
 10033           MOVE AL-UNBON         TO BBILLEDA
 10034           MOVE ER-2547          TO EMI-ERROR
 10035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10036     ELSE
 10037        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 184
* EL6311.cbl
 10038           MOVE -1               TO BBILLEDL
 10039           MOVE AL-UNBON         TO BBILLEDA
 10040           MOVE ER-8148          TO EMI-ERROR
 10041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10042
 10043 1010-EDIT-CONT.
 10044
 10045     IF BFORCEL  NOT = ZEROS
 10046         IF FORCE-CAP
 10047            MOVE AL-UANON            TO BFORCEA
 10048         ELSE
 10049            MOVE ER-2945             TO EMI-ERROR
 10050            MOVE AL-UABON            TO BFORCEA
 10051            MOVE -1                  TO BFORCEL
 10052            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10053
 10054     if (bforcel not = zeros)
 10055        and (bforcei = 'L')
 10056        and (not csr-edit-session)
 10057        and (emi-error <> er-2945)
 10058        MOVE ER-2670             TO EMI-ERROR
 10059        MOVE AL-UABON            TO BFORCEA
 10060        MOVE -1                  TO BFORCEL
 10061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10062     end-if
 10063     IF BENTRYL NOT = ZEROS
 10064        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10065                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10066           MOVE ER-2224              TO EMI-ERROR
 10067           MOVE AL-UABON             TO BENTRYA
 10068           MOVE -1                   TO BENTRYL
 10069           MOVE  1                   TO SET-CURSOR-SW
 10070           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10071        ELSE
 10072           MOVE AL-UANON             TO BENTRYA.
 10073
 10074     IF BUNWRITL NOT = ZEROS
 10075        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10076           MOVE ER-7574              TO EMI-ERROR
 10077           MOVE AL-UABON             TO BUNWRITA
 10078           MOVE -1                   TO BUNWRITL
 10079           MOVE  1                   TO SET-CURSOR-SW
 10080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10081        ELSE
 10082           MOVE AL-UANON             TO BUNWRITA.
 10083
 10084     IF BREINL  NOT = ZEROS
 10085         MOVE AL-UANON               TO BREINA.
 10086
 10087     IF BBILCDL NOT = ZEROS
 10088        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10089                             AND 'A' AND 'B' AND 'E'
 10090           MOVE ER-2225              TO EMI-ERROR
 10091           MOVE AL-UABON             TO BBILCDA
 10092           MOVE -1                   TO BBILCDL
 10093           MOVE  1                   TO SET-CURSOR-SW
 10094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10095        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 185
* EL6311.cbl
 10096           MOVE AL-UANON             TO BBILCDA.
 10097
 10098     IF BSKPCDL NOT = ZEROS
 10099         MOVE AL-UANON               TO BSKPCDA.
 10100
 10101     IF BINDGRPL NOT = ZEROS
 10102         MOVE AL-UANON               TO BINDGRPA.
 10103
 10104     IF BSIGL   NOT = ZEROS
 10105         MOVE AL-UANON               TO BSIGA.
 10106
 10107     IF BRTCLSL NOT = ZEROS
 10108         MOVE AL-UANON               TO BRTCLSA.
 10109
 10110     IF BMEMBERL NOT = ZEROS
 10111         MOVE AL-UANON               TO BMEMBERA.
 10112
 10113     MOVE +0                         TO WS-SUB1.
 10114
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 186
* EL6311.cbl
 10116
 10117******************************************************************
 10118*                                                                *
 10119*           E D I T   I S S U E   C O V E R A G E S              *
 10120*                                                                *
 10121******************************************************************
 10122
 10123 1020-EDIT-COVERAGES.
 10124     ADD +1                      TO WS-SUB1.
 10125
 10126     IF WS-SUB1 GREATER +2
 10127        GO TO 1025-EDIT-CONTINUE
 10128     END-IF
 10129
 10130     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10131       IF (BMODEL   GREATER ZERO  OR
 10132            BPMTSL   GREATER ZERO  OR
 10133            BPMTAMTL GREATER ZERO)
 10134          AND
 10135            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10136               GO TO 1021-CONT-EDIT.
 10137
 10138     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10139        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10140        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10141        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10142        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10143        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10144        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10145        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10146        NEXT SENTENCE
 10147         ELSE
 10148            GO TO 1020-EDIT-COVERAGES.
 10149
 10150 1021-CONT-EDIT.
 10151
 10152     IF BMAINTI = 'A'
 10153        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10154           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10155        ELSE
 10156           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10157           MOVE ER-7404          TO EMI-ERROR
 10158           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10160     ELSE
 10161        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10162           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10163
 10164     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10165        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10166        PERFORM 8600-DEEDIT
 10167        IF DEEDIT-FIELD-V0 NUMERIC
 10168           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10169        ELSE
 10170           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10171
 10172     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10173*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 187
* EL6311.cbl
 10174        IF BMODEL  GREATER THAN ZEROS  AND
 10175           BPMTSL  GREATER THAN ZEROS
 10176           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10177
 10178     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10179         IF BMODEL   GREATER THAN ZEROS  OR
 10180            BPMTSL   GREATER THAN ZEROS  OR
 10181            BPMTAMTL GREATER THAN ZEROS
 10182             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10183
 10184     IF BMAINTI = ('C' OR 'K')
 10185        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10186           NEXT SENTENCE
 10187        ELSE
 10188           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10189           PERFORM 8600-DEEDIT
 10190           IF DEEDIT-FIELD-V0 NUMERIC
 10191              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10192              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10193                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10194              ELSE
 10195                    MOVE ER-2241      TO EMI-ERROR
 10196                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10197                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10198                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10199           ELSE
 10200              MOVE ER-2223          TO EMI-ERROR
 10201              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10202              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10203              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10204     ELSE
 10205        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10206            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10207            PERFORM 8600-DEEDIT
 10208            IF DEEDIT-FIELD-V0      NUMERIC
 10209               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10210                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10211                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10212               ELSE
 10213                  MOVE ER-2241         TO EMI-ERROR
 10214                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10215                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10216                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10217            ELSE
 10218              MOVE ER-2223             TO EMI-ERROR
 10219              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10220              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10221              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10222        ELSE
 10223            MOVE ER-2240               TO EMI-ERROR
 10224            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10225            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10226*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10227*        IF BMODEL  GREATER THAN ZEROS  AND
 10228*           BPMTSL  GREATER THAN ZEROS
 10229*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10230
 10231     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 188
* EL6311.cbl
 10232        AND BMAINTI = ('C' OR 'K')
 10233           NEXT SENTENCE
 10234     ELSE
 10235        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10236           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10237
 10238* EXEC CICS BIF DEEDIT
 10239*              FIELD  (BBENI (WS-SUB1))
 10240*              LENGTH (12)
 10241*          END-EXEC
 10242     MOVE 12
 10243       TO DFHEIV11
 10244*    MOVE '@"L                   #   #00010116' TO DFHEIV0
 10245     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10247     MOVE X'2020233030303130313136' TO DFHEIV0(25:11)
 10248     CALL 'kxdfhei1' USING DFHEIV0,
 10249           BBENI(WS-SUB1),
 10250           DFHEIV11
 10251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10252           IF BBENI (WS-SUB1)  NUMERIC
 10253              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10254                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10255*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10256*          PERFORM 8600-DEEDIT
 10257*          IF DEEDIT-FIELD-V2  NUMERIC
 10258*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10259*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10260              ELSE
 10261                 MOVE ER-7632    TO EMI-ERROR
 10262                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10263                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10265           ELSE
 10266              MOVE ER-2223         TO EMI-ERROR
 10267              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10268              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10269              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10270        ELSE
 10271           MOVE ER-7632    TO EMI-ERROR
 10272           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10273           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10274           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10275
 10276     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10277        AND (BMAINTI = ('C' OR 'K'))
 10278        CONTINUE
 10279     ELSE
 10280        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10281           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10282           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10283              FOR ALL '.'
 10284           IF WS-TALLY > 1
 10285              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10286                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10287              END-PERFORM
 10288              IF A1 < 9
 10289                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 189
* EL6311.cbl
 10290                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10291              END-IF
 10292           ELSE
 10293              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10294                (A1 > 11)
 10295                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10296                  LOW-VALUES OR SPACES)
 10297              END-PERFORM
 10298              IF A1 > 1 AND < 12
 10299                 MOVE SPACES
 10300                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10301              END-IF
 10302           END-IF
 10303
 10304* EXEC CICS BIF DEEDIT
 10305*              FIELD  (BPREMI (WS-SUB1))
 10306*              LENGTH (11)
 10307*          END-EXEC
 10308     MOVE 11
 10309       TO DFHEIV11
 10310*    MOVE '@"L                   #   #00010171' TO DFHEIV0
 10311     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10312     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10313     MOVE X'2020233030303130313731' TO DFHEIV0(25:11)
 10314     CALL 'kxdfhei1' USING DFHEIV0,
 10315           BPREMI(WS-SUB1),
 10316           DFHEIV11
 10317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10318           IF BPREMI (WS-SUB1) NUMERIC
 10319              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10320                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10321*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10322*          PERFORM 8600-DEEDIT
 10323*          IF DEEDIT-FIELD-V2  NUMERIC
 10324*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10325*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10326              ELSE
 10327                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10328                    MOVE ER-7633    TO EMI-ERROR
 10329                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10330                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10331                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10332                 END-IF
 10333              END-IF
 10334           ELSE
 10335              MOVE ER-2223         TO EMI-ERROR
 10336              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10337              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10339           END-IF
 10340        ELSE
 10341           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10342              MOVE ER-7633         TO EMI-ERROR
 10343              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10344              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10346           END-IF
 10347        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 190
* EL6311.cbl
 10348     END-IF
 10349
 10350     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10351        NEXT SENTENCE
 10352     ELSE
 10353        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10354
 10355* EXEC CICS BIF DEEDIT
 10356*           FIELD  (BCPREMI (WS-SUB1))
 10357*           LENGTH (11)
 10358*       END-EXEC
 10359     MOVE 11
 10360       TO DFHEIV11
 10361*    MOVE '@"L                   #   #00010211' TO DFHEIV0
 10362     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10363     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10364     MOVE X'2020233030303130323131' TO DFHEIV0(25:11)
 10365     CALL 'kxdfhei1' USING DFHEIV0,
 10366           BCPREMI(WS-SUB1),
 10367           DFHEIV11
 10368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10369        IF BCPREMI (WS-SUB1) NUMERIC
 10370           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10371*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10372*       PERFORM 8600-DEEDIT
 10373*       IF DEEDIT-FIELD-V2  NUMERIC
 10374*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10375        ELSE
 10376           MOVE ER-2223         TO EMI-ERROR
 10377           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10378           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10379           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380
 10381     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10382        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10383        PERFORM 8600-DEEDIT
 10384        IF DEEDIT-FIELD-V0 NUMERIC
 10385           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10386           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10387         ELSE
 10388           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10389           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10390           MOVE ER-2223              TO EMI-ERROR
 10391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10392
 10393     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10394        IF BEXPIRE   (WS-SUB1) = SPACES
 10395           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10396        ELSE
 10397           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10398           PERFORM 8600-DEEDIT
 10399           IF DEEDIT-FIELD-V0        NUMERIC
 10400              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10401              MOVE 4                TO DC-OPTION-CODE
 10402              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10403              PERFORM 9700-DATE-LINK
 10404              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10405                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 191
* EL6311.cbl
 10406              IF NO-CONVERSION-ERROR
 10407                 NEXT SENTENCE
 10408              ELSE
 10409                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10410                 MOVE ER-2531    TO EMI-ERROR
 10411                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10412                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10413           ELSE
 10414             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10415             MOVE ER-2532        TO EMI-ERROR
 10416             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10418
 10419     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10420        NEXT SENTENCE
 10421     ELSE
 10422
 10423* EXEC CICS BIF DEEDIT
 10424*           FIELD  (BALT-BENI (WS-SUB1))
 10425*           LENGTH (12)
 10426*       END-EXEC
 10427     MOVE 12
 10428       TO DFHEIV11
 10429*    MOVE '@"L                   #   #00010268' TO DFHEIV0
 10430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10432     MOVE X'2020233030303130323638' TO DFHEIV0(25:11)
 10433     CALL 'kxdfhei1' USING DFHEIV0,
 10434           BALT-BENI(WS-SUB1),
 10435           DFHEIV11
 10436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10437        IF BALT-BENI (WS-SUB1) NUMERIC
 10438           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10439*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10440*       PERFORM 8600-DEEDIT
 10441*       IF DEEDIT-FIELD-V0 NUMERIC
 10442*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10443        ELSE
 10444           MOVE ER-2223         TO EMI-ERROR
 10445           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10446           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10447           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10448
 10449     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10450        NEXT SENTENCE
 10451     ELSE
 10452
 10453* EXEC CICS BIF DEEDIT
 10454*           FIELD  (BALT-PREMI (WS-SUB1))
 10455*           LENGTH (11)
 10456*       END-EXEC
 10457     MOVE 11
 10458       TO DFHEIV11
 10459*    MOVE '@"L                   #   #00010287' TO DFHEIV0
 10460     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10462     MOVE X'2020233030303130323837' TO DFHEIV0(25:11)
 10463     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 192
* EL6311.cbl
 10464           BALT-PREMI(WS-SUB1),
 10465           DFHEIV11
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10467        IF BALT-PREMI (WS-SUB1) NUMERIC
 10468           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10469*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10470*       PERFORM 8600-DEEDIT
 10471*       IF DEEDIT-FIELD-V0 NUMERIC
 10472*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10473        ELSE
 10474           MOVE ER-2223         TO EMI-ERROR
 10475           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10476           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10477           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10478
 10479      GO TO 1020-EDIT-COVERAGES.
 10480     .
 10481 1025-edit-continue.
 10482     IF PI-COMPANY-ID  =  'DMD'
 10483        MOVE LOW-VALUES             TO BNCERTI
 10484                                       BNSTATI.
 10485
 10486     IF EMI-ERROR = ZEROS
 10487         NEXT SENTENCE
 10488     ELSE
 10489         GO TO 8200-SEND-DATAONLY.
 10490
 10491     IF BMAINTI = 'A'
 10492         GO TO 1200-ADD-ISSUE-ROUTINE.
 10493
 10494     IF BMAINTI = 'C'
 10495         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10496
 10497     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10498
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 193
* EL6311.cbl
 10500
 10501 1030-EDIT-FOR-NUMERICS.
 10502     IF WS-CSO-SUB EQUAL 10
 10503        GO TO 1030-EDIT-EXIT.
 10504
 10505     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10506        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10507        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10508           ADD +1               TO WS-CSO-SUB
 10509           GO TO 1030-EDIT-FOR-NUMERICS.
 10510
 10511     MOVE 'N'                   TO WS-NUMERIC-SW.
 10512
 10513 1030-EDIT-EXIT.
 10514******************************************************************
 10515*                                                                *
 10516*                 C A L C U L A T E   A G E                      *
 10517*                                                                *
 10518******************************************************************
 10519
 10520
 10521 1095-CALC-AGE.
 10522
 10523     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10524     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10525     MOVE 1                  TO DC-OPTION-CODE.
 10526     PERFORM 9700-DATE-LINK
 10527     IF NO-CONVERSION-ERROR
 10528         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10529         MOVE WS-BAGE            TO BAGEI
 10530         MOVE +2                 TO BAGEL
 10531         MOVE AL-UNNON TO BAGEA.
 10532
 10533 1099-EXIT.
 10534     EXIT.
 10535
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 194
* EL6311.cbl
 10537
 10538******************************************************************
 10539*                                                                *
 10540*                   S H O W   I S S U E                          *
 10541*                                                                *
 10542******************************************************************
 10543
 10544 1100-SHOW-REQUEST.
 10545     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10546
 10547     IF BCERTNOL = ZEROS AND
 10548        BEFFDTL  = ZEROS
 10549        MOVE -1                  TO BMAINTL
 10550        GO TO 8200-SEND-DATAONLY.
 10551
 10552     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10553
 10554     IF BSUFIXL NOT = ZEROS
 10555        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10556     ELSE
 10557        MOVE SPACE               TO WS-NEW-SUFFIX.
 10558
 10559     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10560     PERFORM 8600-DEEDIT.
 10561     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10562     MOVE '4'                    TO DC-OPTION-CODE.
 10563     PERFORM 9700-DATE-LINK.
 10564     IF DATE-CONVERSION-ERROR
 10565        MOVE ER-0348             TO EMI-ERROR
 10566        MOVE -1                  TO BEFFDTL
 10567        MOVE AL-UABON            TO BEFFDTA
 10568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10569        GO TO 8200-SEND-DATAONLY
 10570     ELSE
 10571        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10572        MOVE AL-UANON            TO BEFFDTA
 10573        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10574
 10575     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10576
 10577     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10578        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10579          MOVE 'Y'                    TO WS-SHOW-SW
 10580          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10581             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10582           ELSE
 10583             IF PI-FILE-BROWSE
 10584                GO TO 4300-BROWSE-FILE-FORWARD
 10585              ELSE
 10586                IF PI-CSR-BROWSE
 10587                   GO TO 4200-BROWSE-CSR-FORWARD
 10588                ELSE
 10589                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10590        ELSE
 10591           GO TO 3900-RE-DISPLAY-RECORD.
 10592
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 195
* EL6311.cbl
 10594
 10595******************************************************************
 10596*                                                                *
 10597*            A D D   I S S U E   R O U T I N E                   *
 10598*                                                                *
 10599******************************************************************
 10600
 10601***************************************************************
 10602*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10603*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10604*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10605*     4. LINK TO THE EDIT ROUTINE.                            *
 10606*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10607*     6. WRITE THE NEW ISSUE RECORD.                          *
 10608*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10609*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10610*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10611*        ELSE                                                 *
 10612*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10613***************************************************************
 10614
 10615 1200-ADD-ISSUE-ROUTINE.
 10616     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10617
 10618
 10619* EXEC CICS GETMAIN
 10620*        SET     (ADDRESS OF PENDING-BUSINESS)
 10621*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10622*    END-EXEC.
 10623*    MOVE '," L                  $   #00010442' TO DFHEIV0
 10624     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10626     MOVE X'2020233030303130343432' TO DFHEIV0(25:11)
 10627     CALL 'kxdfhei1' USING DFHEIV0,
 10628           DFHEIV20,
 10629           ERPNDB-RECORD-LENGTH,
 10630           DFHEIV99
 10631     SET ADDRESS OF PENDING-BUSINESS TO
 10632         DFHEIV20
 10633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10634
 10635
 10636
 10637* EXEC CICS HANDLE CONDITION
 10638*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10639*    END-EXEC.
 10640*    MOVE '"$I                   ! # #00010447' TO DFHEIV0
 10641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10643     MOVE X'2320233030303130343437' TO DFHEIV0(25:11)
 10644     CALL 'kxdfhei1' USING DFHEIV0
 10645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10646
 10647
 10648     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10649     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10650     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10651
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 196
* EL6311.cbl
 10652
 10653* EXEC CICS READ
 10654*        INTO    (PENDING-BUSINESS)
 10655*        DATASET (FILE-ID-ERPNDB)
 10656*        RIDFLD  (ERPNDB-KEY)
 10657*    END-EXEC.
 10658     MOVE LENGTH OF
 10659      PENDING-BUSINESS
 10660       TO DFHEIV11
 10661*    MOVE '&"IL       E          (   #00010455' TO DFHEIV0
 10662     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10664     MOVE X'2020233030303130343535' TO DFHEIV0(25:11)
 10665     CALL 'kxdfhei1' USING DFHEIV0,
 10666           FILE-ID-ERPNDB,
 10667           PENDING-BUSINESS,
 10668           DFHEIV11,
 10669           ERPNDB-KEY,
 10670           DFHEIV99,
 10671           DFHEIV99,
 10672           DFHEIV99
 10673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10674
 10675
 10676     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10677
 10678     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10679     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10680     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10681     MOVE SPACES                 TO PENDING-BUSINESS.
 10682     MOVE 'PB'                   TO PB-RECORD-ID.
 10683     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10684     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10685     MOVE SPACES                 TO PB-CERT-SFX.
 10686     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10687     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10688                                    PB-ALT-CHG-SEQ-NO.
 10689
 10690     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10691     MOVE '1'                    TO PB-RECORD-TYPE.
 10692
 10693     IF BSUFIXL NOT = ZEROS
 10694        MOVE BSUFIXI             TO PB-CERT-SFX.
 10695
 10696     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10697
 10698     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10699     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10700
 10701     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10702                                    PB-I-LF-PREM-CALC
 10703                                    PB-I-LF-ALT-PREM-CALC
 10704                                    PB-I-LF-RATE
 10705                                    PB-I-LF-ALT-RATE
 10706                                    PB-I-LF-REI-RATE
 10707                                    PB-I-LF-ALT-REI-RATE
 10708                                    PB-I-RATE-DEV-PCT-LF
 10709                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 197
* EL6311.cbl
 10710                                    PB-I-AH-RATE
 10711                                    PB-I-AH-REI-RATE
 10712                                    PB-I-AH-RATE-TRM
 10713                                    PB-I-RATE-DEV-PCT-AH
 10714                                    PB-I-BUSINESS-TYPE
 10715                                    PB-I-LIFE-COMMISSION
 10716                                    PB-I-JOINT-COMMISSION
 10717                                    PB-I-JOINT-AGE
 10718                                    PB-I-AH-COMMISSION
 10719                                    PB-I-CURR-SEQ
 10720                                    PB-CHG-COUNT
 10721                                    PB-LF-BILLED-AMTS
 10722                                    PB-AH-BILLED-AMTS
 10723                                    PB-CALC-TOLERANCE
 10724                                    PB-I-EXTENTION-DAYS
 10725*                                   PB-I-MICROFILM-NO
 10726                                    PB-I-TERM-IN-DAYS.
 10727
 10728     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10729                                    PB-I-LF-EXPIRE-DT
 10730                                    PB-I-AH-EXPIRE-DT
 10731                                    PB-BILLED-DT
 10732                                    PB-ACCT-EFF-DT
 10733                                    PB-ACCT-EXP-DT
 10734                                    PB-I-1ST-PMT-DT.
 10735
 10736     MOVE 'X'                    TO PB-FATAL-FLAG.
 10737
 10738     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10739
 10740     IF BLSTNML GREATER THAN ZEROS
 10741         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10742
 10743*    IF BMICRNOL  GREATER  ZEROS
 10744*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10745*    ELSE
 10746*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10747     IF BVINL > ZEROS
 10748        MOVE BVINI               TO PB-I-VIN
 10749     END-IF
 10750     IF B1STNML GREATER THAN ZEROS
 10751         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10752
 10753     IF BINITL  GREATER THAN ZEROS
 10754         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10755
 10756     IF BBIRTHL GREATER THAN ZERO
 10757         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10758     ELSE
 10759         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10760
 10761     IF B1STPMTL GREATER THAN ZERO
 10762         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10763     ELSE
 10764         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10765
 10766     IF BAGEL    GREATER THAN ZEROS
 10767         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 198
* EL6311.cbl
 10768        ELSE
 10769         MOVE ZEROS              TO PB-I-AGE.
 10770
 10771     IF BSEXL    GREATER THAN ZEROS
 10772         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10773
 10774     IF BTERM-LEN (1) GREATER THAN ZEROS
 10775        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10776     ELSE
 10777        MOVE ZEROS               TO PB-I-LF-TERM.
 10778
 10779     IF BTERM-LEN (2) GREATER THAN ZEROS
 10780        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10781     ELSE
 10782        MOVE ZEROS               TO PB-I-AH-TERM.
 10783
 10784     IF BLNTRML       GREATER THAN ZEROS
 10785         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10786        ELSE
 10787         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10788
 10789     IF BFREQL        GREATER THAN ZEROS
 10790         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10791        ELSE
 10792         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10793
 10794     IF BSKPCDL       GREATER THAN ZEROS
 10795         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10796
 10797     IF BMODEL        GREATER THAN ZEROS
 10798         MOVE BMODEI             TO PB-I-TERM-TYPE
 10799                                    PI-BMODE.
 10800
 10801     IF BPMTSL        GREATER THAN ZEROS
 10802         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10803                                    PI-BPMTS
 10804        ELSE
 10805         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10806                                    PI-BPMTS.
 10807
 10808     IF BPMTAMTL      GREATER THAN ZEROS
 10809         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10810        ELSE
 10811         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10812
 10813     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10814        IF BTYPE  (1)   NOT = ZEROS
 10815           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10816                                    PI-BTYPE (1)
 10817           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10818           MOVE SPACES           TO PB-I-LF-ABBR
 10819        ELSE
 10820           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10821                                    PB-I-LF-ABBR
 10822           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10823     ELSE
 10824        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10825                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 199
* EL6311.cbl
 10826        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10827
 10828     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10829         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10830     ELSE
 10831         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10832
 10833     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10834         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10835     ELSE
 10836         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10837
 10838     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10839         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10840            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10841            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10842         ELSE
 10843            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10844*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10845*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10846         END-IF
 10847     ELSE
 10848         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10849
 10850     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10851         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10852
 10853     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10854         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10855         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10856     ELSE
 10857         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10858
 10859     IF  BALT-PREM-LEN     (2) > ZEROS
 10860         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10861     ELSE
 10862         MOVE ZEROS            TO PB-I-TOT-FEES.
 10863
 10864     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10865        IF BTYPE      (2)   NOT = ZEROS
 10866           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10867                                  PI-BTYPE (2)
 10868           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10869           MOVE SPACES         TO PB-I-AH-ABBR
 10870        ELSE
 10871           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10872                                  PB-I-AH-ABBR
 10873           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10874     ELSE
 10875        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10876                                  PB-I-AH-ABBR
 10877        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10878
 10879     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10880         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10881     ELSE
 10882         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10883
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 200
* EL6311.cbl
 10884     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10885         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10886            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10887            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10888         ELSE
 10889            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10890*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10891*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10892         END-IF
 10893     ELSE
 10894         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10895
 10896     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10897         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10898
 10899     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10900        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10901     ELSE
 10902        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10903
 10904     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10905        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10906     ELSE
 10907        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10908
 10909     IF BINDGRPL  GREATER THAN ZEROS
 10910         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10911
 10912     IF BRTCLSL   GREATER THAN ZEROS
 10913         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10914
 10915     IF BSIGL     GREATER THAN ZEROS
 10916         MOVE BSIGI              TO PB-I-SIG-SW.
 10917     IF BAPRL > ZEROS
 10918         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10919     ELSE
 10920        if pi-company-id = 'CID'
 10921           move +99.9999         to pb-i-loan-apr
 10922        else
 10923           MOVE ZEROS            TO PB-I-LOAN-APR
 10924        end-if
 10925     end-if
 10926     IF BMEMBERL  GREATER THAN ZEROS
 10927         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10928
 10929     IF BLNOFCRL  GREATER THAN ZEROS
 10930         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10931
 10932     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10933        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10934     ELSE
 10935        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10936
 10937     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10938        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10939     ELSE
 10940        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10941
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 201
* EL6311.cbl
 10942     IF BDAYSL   GREATER THAN ZEROS
 10943        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10944                                    PB-I-EXTENTION-DAYS
 10945     ELSE
 10946        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10947                                    PB-I-EXTENTION-DAYS.
 10948
 10949     IF BDAYSL GREATER THAN ZEROS
 10950        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10951
 10952     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10953        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10954           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10955
 10956     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10957        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10958           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10959
 10960     IF B1STPMTL GREATER THAN ZEROS
 10961        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10962
 10963     IF PB-EXT-DAYS-PROCESSING
 10964        IF PB-I-EXTENTION-DAYS = ZEROS
 10965           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10966
 10967     IF PB-EXPIRE-DT-PROCESSING
 10968        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10969           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10970             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10971
 10972     IF PB-1ST-PMT-DT-PROCESSING
 10973        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10974           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10975
 10976     IF BREINL GREATER THAN ZEROS
 10977        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10978
 10979     IF BENTRYL NOT = ZEROS
 10980        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10981        IF PI-COMPANY-ID = 'CID'
 10982           AND (PB-BATCH-ENTRY = 'P')
 10983           AND (PB-STATE = 'VA')
 10984           PERFORM 1500-UPDATE-ERNOTE
 10985                                 THRU 1500-EXIT
 10986        END-IF
 10987     END-IF
 10988     IF BUNWRITL NOT = ZEROS
 10989        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10990
 10991     IF BFORCEL NOT = ZEROS
 10992        MOVE BFORCEI             TO PB-FORCE-CODE.
 10993
 10994     IF BBILCDL NOT = ZEROS
 10995        MOVE BBILCDI             TO PB-RECORD-BILL.
 10996
 10997     IF BLIVESL GREATER THAN ZEROS
 10998        MOVE WS-BLIVES           TO PB-I-LIVES
 10999     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 202
* EL6311.cbl
 11000        MOVE ZEROS               TO PB-I-LIVES.
 11001
 11002     IF BBILLEDL GREATER THAN ZEROS
 11003        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11004     ELSE
 11005        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11006
 11007*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11008
 11009 1260-WRITE-PB-RECORD.
 11010     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11011                                    PB-INPUT-BY.
 11012     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11013     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11014                                    PB-INPUT-DT.
 11015
 11016     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11017     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11018                                    PB-CONTROL-BY-ORIG-BATCH.
 11019
 11020
 11021     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11022     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11023     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11024     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11025     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11026
 11027     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11028
 11029     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11030
 11031     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11032     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11033     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11034
 11035     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11036     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11037
 11038 1275-WRITE-PENDING-BUSINESS.
 11039     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11040     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11041     MOVE 'A'                    TO JP-RECORD-TYPE.
 11042     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11043
 11044
 11045* EXEC CICS HANDLE CONDITION
 11046*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11047*    END-EXEC.
 11048*    MOVE '"$%                   ! $ #00010829' TO DFHEIV0
 11049     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11051     MOVE X'2420233030303130383239' TO DFHEIV0(25:11)
 11052     CALL 'kxdfhei1' USING DFHEIV0
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11054
 11055
 11056
 11057* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 203
* EL6311.cbl
 11058*        DATASET (FILE-ID-ERPNDB)
 11059*        FROM    (PENDING-BUSINESS)
 11060*        RIDFLD  (PB-CONTROL-PRIMARY)
 11061*    END-EXEC.
 11062     MOVE LENGTH OF
 11063      PENDING-BUSINESS
 11064       TO DFHEIV11
 11065*    MOVE '&$ L                  ''   #00010833' TO DFHEIV0
 11066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11068     MOVE X'2020233030303130383333' TO DFHEIV0(25:11)
 11069     CALL 'kxdfhei1' USING DFHEIV0,
 11070           FILE-ID-ERPNDB,
 11071           PENDING-BUSINESS,
 11072           DFHEIV11,
 11073           PB-CONTROL-PRIMARY,
 11074           DFHEIV99,
 11075           DFHEIV99
 11076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11077
 11078
 11079     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11080
 11081     PERFORM 8400-LOG-JOURNAL-RECORD.
 11082
 11083******************************************************************
 11084*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11085******************************************************************
 11086     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11087     MOVE ' '                    TO WS-ERMAIL-SW
 11088
 11089* EXEC CICS READ
 11090*       DATASET   (FILE-ID-ERMAIL)
 11091*       SET       (ADDRESS OF MAILING-DATA)
 11092*       RIDFLD    (ERMAIL-KEY)
 11093*       RESP      (WS-RESPONSE)
 11094*    END-EXEC
 11095*    MOVE '&"S        E          (  N#00010849' TO DFHEIV0
 11096     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11098     MOVE X'204E233030303130383439' TO DFHEIV0(25:11)
 11099     CALL 'kxdfhei1' USING DFHEIV0,
 11100           FILE-ID-ERMAIL,
 11101           DFHEIV20,
 11102           DFHEIV99,
 11103           ERMAIL-KEY,
 11104           DFHEIV99,
 11105           DFHEIV99,
 11106           DFHEIV99
 11107     SET ADDRESS OF MAILING-DATA TO
 11108         DFHEIV20
 11109     MOVE EIBRESP  TO WS-RESPONSE
 11110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11111     IF RESP-NORMAL
 11112        SET ERMAIL-FOUND TO TRUE
 11113     END-IF
 11114
 11115     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 204
* EL6311.cbl
 11116     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11117     MOVE 'OC'                   TO OC-RECORD-ID
 11118     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11119                                 TO OC-CONTROL-PRIMARY (1:33)
 11120     MOVE 'I'                    TO OC-RECORD-TYPE
 11121     MOVE +4096                  TO OC-KEY-SEQ-NO
 11122     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11123     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11124     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11125     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11126     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11127     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11128     MOVE PB-I-AGE               TO OC-INS-AGE
 11129     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11130     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11131     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11132     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11133     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11134     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11135     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11136     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11137     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11138     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11139     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11140     IF PB-I-JOINT-COMMISSION > +0
 11141         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11142     ELSE
 11143         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11144     END-IF
 11145     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11146     MOVE +0                     TO OC-LF-CANCEL-AMT
 11147                                    OC-LF-ITD-CANCEL-AMT
 11148     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11149     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11150     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11151     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11152     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11153     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11154     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11155     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11156     MOVE +0                     TO OC-AH-CANCEL-AMT
 11157                                    OC-AH-ITD-CANCEL-AMT
 11158     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11159     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11160     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11161     IF ERMAIL-FOUND
 11162        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11163     END-IF
 11164     IF NOT CERT-TRL-REC-NOT-FOUND
 11165        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11166                           OC-INS-AGE-DEFAULT-FLAG
 11167        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11168                           OC-JNT-AGE-DEFAULT-FLAG
 11169     END-IF
 11170     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11171     .
 11172 1275-WRITE-ELCRTO.
 11173
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 205
* EL6311.cbl
 11174* EXEC CICS WRITE
 11175*       DATASET   ('ELCRTO')
 11176*       FROM      (ORIGINAL-CERTIFICATE)
 11177*       RIDFLD    (OC-CONTROL-PRIMARY)
 11178*       RESP      (WS-RESPONSE)
 11179*    END-EXEC
 11180     MOVE LENGTH OF
 11181      ORIGINAL-CERTIFICATE
 11182       TO DFHEIV11
 11183     MOVE 'ELCRTO' TO DFHEIV1
 11184*    MOVE '&$ L                  ''  N#00010917' TO DFHEIV0
 11185     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11187     MOVE X'204E233030303130393137' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0,
 11189           DFHEIV1,
 11190           ORIGINAL-CERTIFICATE,
 11191           DFHEIV11,
 11192           OC-CONTROL-PRIMARY,
 11193           DFHEIV99,
 11194           DFHEIV99
 11195     MOVE EIBRESP  TO WS-RESPONSE
 11196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11197*    display ' just wrote 1275 ' ws-response
 11198     IF RESP-DUPKEY
 11199        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11200        GO TO 1275-WRITE-ELCRTO
 11201     ELSE
 11202        IF NOT RESP-NORMAL
 11203           MOVE -1               TO BMAINTL
 11204           MOVE ER-7450          TO EMI-ERROR
 11205           PERFORM 9900-ERROR-FORMAT
 11206                                 THRU 9900-EXIT
 11207           GO TO 8200-SEND-DATAONLY
 11208        END-IF
 11209     END-IF
 11210******************************************************************
 11211*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11212******************************************************************
 11213
 11214
 11215* EXEC CICS READ
 11216*        INTO    (PENDING-BUSINESS)
 11217*        DATASET (FILE-ID-ERPNDB)
 11218*        RIDFLD  (ERPNDB-KEY)
 11219*        UPDATE
 11220*    END-EXEC.
 11221     MOVE LENGTH OF
 11222      PENDING-BUSINESS
 11223       TO DFHEIV11
 11224*    MOVE '&"IL       EU         (   #00010940' TO DFHEIV0
 11225     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11226     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11227     MOVE X'2020233030303130393430' TO DFHEIV0(25:11)
 11228     CALL 'kxdfhei1' USING DFHEIV0,
 11229           FILE-ID-ERPNDB,
 11230           PENDING-BUSINESS,
 11231           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 206
* EL6311.cbl
 11232           ERPNDB-KEY,
 11233           DFHEIV99,
 11234           DFHEIV99,
 11235           DFHEIV99
 11236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11237
 11238
 11239     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11240     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11241     MOVE 'B'                    TO JP-RECORD-TYPE.
 11242     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11243
 11244     PERFORM 8400-LOG-JOURNAL-RECORD.
 11245
 11246     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11247
 11248
 11249* EXEC CICS REWRITE
 11250*        DATASET (FILE-ID-ERPNDB)
 11251*        FROM    (PENDING-BUSINESS)
 11252*    END-EXEC.
 11253     MOVE LENGTH OF
 11254      PENDING-BUSINESS
 11255       TO DFHEIV11
 11256*    MOVE '&& L                  %   #00010956' TO DFHEIV0
 11257     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11258     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11259     MOVE X'2020233030303130393536' TO DFHEIV0(25:11)
 11260     CALL 'kxdfhei1' USING DFHEIV0,
 11261           FILE-ID-ERPNDB,
 11262           PENDING-BUSINESS,
 11263           DFHEIV11,
 11264           DFHEIV99
 11265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11266
 11267
 11268     MOVE 'C'                    TO JP-RECORD-TYPE.
 11269     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11270
 11271     PERFORM 8400-LOG-JOURNAL-RECORD.
 11272
 11273     IF WS-ERRORS-PRESENT
 11274         GO TO 3900-RE-DISPLAY-RECORD.
 11275
 11276     MOVE ZEROS                  TO EMI-ERROR.
 11277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11278     MOVE LOW-VALUES             TO EL631BI.
 11279     MOVE  -1                    TO BMAINTL.
 11280     GO TO 8100-SEND-INITIAL-MAP.
 11281
 11282 1280-BATCH-HDR-NOT-FOUND.
 11283     MOVE -1                     TO BMAINTL.
 11284     MOVE ER-7450                TO EMI-ERROR.
 11285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11286     GO TO 8200-SEND-DATAONLY.
 11287
 11288 1290-DUPLICATE-ALT-INDEX.
 11289
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 207
* EL6311.cbl
 11290******************************************************************
 11291*                                                                *
 11292*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11293*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11294*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11295*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11296*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11297*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11298*                                                                *
 11299******************************************************************
 11300
 11301     IF LCP-ONCTR-01 =  0
 11302         ADD 1 TO LCP-ONCTR-01
 11303        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11304
 11305     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11306
 11307     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11308         NEXT SENTENCE
 11309     ELSE
 11310         ADD +1 TO PB-BATCH-SEQ-NO
 11311                   PB-CSR-BATCH-SEQ-NO
 11312         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11313         GO TO 1275-WRITE-PENDING-BUSINESS.
 11314
 11315     MOVE -1                     TO BCERTNOL.
 11316     MOVE AL-UABON               TO BCERTNOA.
 11317     MOVE AL-UNBON               TO BEFFDTA.
 11318
 11319     MOVE 1                      TO EMI-SUB
 11320                                    EMI-SWITCH1
 11321                                    EMI-SWITCH-AREA-1
 11322                                    EMI-SWITCH-AREA-2.
 11323
 11324     MOVE SPACES                 TO EMI-ERROR-LINES.
 11325
 11326
 11327* EXEC CICS SYNCPOINT ROLLBACK
 11328*    END-EXEC.
 11329*    MOVE '6"R                   !   #00011019' TO DFHEIV0
 11330     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11332     MOVE X'2020233030303131303139' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0
 11334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11335
 11336
 11337     MOVE ER-2247                TO EMI-ERROR.
 11338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11339     GO TO 8200-SEND-DATAONLY.
 11340
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 208
* EL6311.cbl
 11342
 11343
 11344 1295-READ-CERT-TRAILER.
 11345
 11346
 11347* EXEC CICS GETMAIN
 11348*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11349*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11350*        INITIMG (GETMAIN-SPACE)
 11351*    END-EXEC
 11352*    MOVE ',"IL                  $   #00011031' TO DFHEIV0
 11353     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11355     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0,
 11357           DFHEIV20,
 11358           ELCRTT-RECORD-LENGTH,
 11359           GETMAIN-SPACE
 11360     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11361         DFHEIV20
 11362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11363
 11364     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11365     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11366     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11367
 11368
 11369* EXEC CICS HANDLE CONDITION
 11370*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11371*    END-EXEC.
 11372*    MOVE '"$I                   ! % #00011041' TO DFHEIV0
 11373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11375     MOVE X'2520233030303131303431' TO DFHEIV0(25:11)
 11376     CALL 'kxdfhei1' USING DFHEIV0
 11377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11378
 11379
 11380
 11381* EXEC CICS READ
 11382*        DATASET  (CRTT-ID)
 11383*        RIDFLD   (ELCRTT-KEY)
 11384*        INTO     (CERTIFICATE-TRAILERS)
 11385*    END-EXEC.
 11386     MOVE LENGTH OF
 11387      CERTIFICATE-TRAILERS
 11388       TO DFHEIV11
 11389*    MOVE '&"IL       E          (   #00011045' TO DFHEIV0
 11390     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11392     MOVE X'2020233030303131303435' TO DFHEIV0(25:11)
 11393     CALL 'kxdfhei1' USING DFHEIV0,
 11394           CRTT-ID,
 11395           CERTIFICATE-TRAILERS,
 11396           DFHEIV11,
 11397           ELCRTT-KEY,
 11398           DFHEIV99,
 11399           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 209
* EL6311.cbl
 11400           DFHEIV99
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404     GO TO 1295-EXIT.
 11405
 11406 1295-CERT-TRL-REC-NOTFND.
 11407     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11408
 11409 1295-EXIT.
 11410     EXIT.
 11411
 11412******************************************************************
 11413*                                                                *
 11414*          C H A N G E   I S S U E   R O U T I N E               *
 11415*                                                                *
 11416******************************************************************
 11417
 11418***************************************************************
 11419*                                                             *
 11420*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11421*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11422*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11423*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11424*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11425*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11426*     5. LINK TO THE EDIT ROUTINE.                            *
 11427*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11428*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11429*              THE EDIT ROUTINE.                              *
 11430*     7. REWRITE THE NEW ISSUE                                *
 11431*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11432*                                                             *
 11433***************************************************************
 11434
 11435 1300-CHANGE-ISSUE-ROUTINE.
 11436     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11437
 11438     IF BCHGL NOT = ZEROS
 11439        MOVE ER-2196             TO EMI-ERROR
 11440        MOVE AL-UABON            TO BMAINTA
 11441        MOVE -1                  TO BMAINTL
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 8200-SEND-DATAONLY.
 11444
 11445     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11446
 11447     IF BSUFIXL NOT = ZEROS
 11448        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11449     ELSE
 11450        MOVE SPACE               TO WS-NEW-SUFFIX.
 11451
 11452     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11453     PERFORM 8600-DEEDIT.
 11454     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11455     MOVE '4'                    TO DC-OPTION-CODE.
 11456     PERFORM 9700-DATE-LINK.
 11457     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 210
* EL6311.cbl
 11458        MOVE ER-0348             TO EMI-ERROR
 11459        MOVE -1                  TO BEFFDTL
 11460        MOVE AL-UABON            TO BEFFDTA
 11461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11462        GO TO 8200-SEND-DATAONLY
 11463     ELSE
 11464        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11465        MOVE AL-UANON            TO BEFFDTA
 11466        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11467
 11468 1325-PROCESS-ISSUE-CHANGES.
 11469
 11470* EXEC CICS HANDLE CONDITION
 11471*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11472*    END-EXEC.
 11473*    MOVE '"$I                   ! & #00011116' TO DFHEIV0
 11474     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11476     MOVE X'2620233030303131313136' TO DFHEIV0(25:11)
 11477     CALL 'kxdfhei1' USING DFHEIV0
 11478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11479
 11480
 11481     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11482     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11483     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11484
 11485
 11486* EXEC CICS GETMAIN
 11487*        SET      (ADDRESS OF PENDING-BUSINESS)
 11488*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11489*        INITIMG  (GETMAIN-SPACE)
 11490*     END-EXEC.
 11491*    MOVE ',"IL                  $   #00011124' TO DFHEIV0
 11492     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11493     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11494     MOVE X'2020233030303131313234' TO DFHEIV0(25:11)
 11495     CALL 'kxdfhei1' USING DFHEIV0,
 11496           DFHEIV20,
 11497           ERPNDB-RECORD-LENGTH,
 11498           GETMAIN-SPACE
 11499     SET ADDRESS OF PENDING-BUSINESS TO
 11500         DFHEIV20
 11501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11502
 11503
 11504
 11505* EXEC CICS READ
 11506*        INTO    (PENDING-BUSINESS)
 11507*        DATASET (FILE-ID-ERPNDB)
 11508*        RIDFLD  (ERPNDB-KEY)
 11509*    END-EXEC.
 11510     MOVE LENGTH OF
 11511      PENDING-BUSINESS
 11512       TO DFHEIV11
 11513*    MOVE '&"IL       E          (   #00011130' TO DFHEIV0
 11514     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 211
* EL6311.cbl
 11516     MOVE X'2020233030303131313330' TO DFHEIV0(25:11)
 11517     CALL 'kxdfhei1' USING DFHEIV0,
 11518           FILE-ID-ERPNDB,
 11519           PENDING-BUSINESS,
 11520           DFHEIV11,
 11521           ERPNDB-KEY,
 11522           DFHEIV99,
 11523           DFHEIV99,
 11524           DFHEIV99
 11525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11526
 11527
 11528     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11529
 11530
 11531* EXEC CICS HANDLE CONDITION
 11532*         NOTFND     (1385-REC-NOT-FOUND)
 11533*    END-EXEC.
 11534*    MOVE '"$I                   ! '' #00011138' TO DFHEIV0
 11535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11537     MOVE X'2720233030303131313338' TO DFHEIV0(25:11)
 11538     CALL 'kxdfhei1' USING DFHEIV0
 11539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11540
 11541
 11542**********************************************************
 11543*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11544*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11545**********************************************************
 11546
 11547
 11548* EXEC CICS READ
 11549*        DATASET (FILE-ID-ERPNDB)
 11550*        INTO    (PENDING-BUSINESS)
 11551*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11552*    END-EXEC.
 11553     MOVE LENGTH OF
 11554      PENDING-BUSINESS
 11555       TO DFHEIV11
 11556*    MOVE '&"IL       E          (   #00011147' TO DFHEIV0
 11557     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11559     MOVE X'2020233030303131313437' TO DFHEIV0(25:11)
 11560     CALL 'kxdfhei1' USING DFHEIV0,
 11561           FILE-ID-ERPNDB,
 11562           PENDING-BUSINESS,
 11563           DFHEIV11,
 11564           PI-PREV-CONTROL-PRIMARY,
 11565           DFHEIV99,
 11566           DFHEIV99,
 11567           DFHEIV99
 11568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11569
 11570
 11571********** DO NOT ALLOW CHANGES IF THRU A/R
 11572     IF BMAINTI = 'C'
 11573         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 212
* EL6311.cbl
 11574             MOVE ER-4005          TO EMI-ERROR
 11575             MOVE -1               TO BMAINTL
 11576             MOVE AL-UABON         TO BMAINTA
 11577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578             GO TO 8200-SEND-DATAONLY.
 11579**********
 11580     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11581
 11582     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11583        MOVE -1                 TO BMAINTL
 11584        MOVE ER-2197            TO EMI-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 8200-SEND-DATAONLY.
 11587
 11588     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11589        MOVE ER-2196             TO EMI-ERROR
 11590        MOVE AL-UABON            TO BMAINTA
 11591        MOVE -1                  TO BMAINTL
 11592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11593        GO TO 8200-SEND-DATAONLY.
 11594
 11595     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11596
 11597     IF PB-BILLED-DT = LOW-VALUES AND
 11598        PB-CHG-COUNT = ZEROS
 11599        NEXT SENTENCE
 11600     ELSE
 11601        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11602            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11603           OR
 11604           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11605            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11606           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11607     move zeros                  to ws-check-amts
 11608     move ' '                    to ws-stop-sw
 11609                                    ws-check-sw
 11610                                    ws-proc-check-sw
 11611                                    ws-any-check-sw
 11612                                    ws-chek-browse-sw
 11613
 11614     perform 2500-browse-checks  thru 2500-exit
 11615
 11616     if i-have-processed-checks
 11617        or i-have-checks
 11618        continue
 11619     else
 11620        go to 1330-continue
 11621     end-if
 11622
 11623     compute ws-tot-orig-prem =
 11624        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11625        pb-i-lf-alt-premium-amt
 11626
 11627     if bprem1l <> zeros
 11628        MOVE AL-UNNON            TO bprem1a
 11629        move ws-bprem (1)        to ws-new-iss-total
 11630     else
 11631        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 213
* EL6311.cbl
 11632     end-if
 11633     display ' new iss totala ' ws-new-iss-total
 11634
 11635     if baltpr1l <> zeros
 11636        MOVE AL-UNNON            TO baltpr1a
 11637        compute ws-new-iss-total =
 11638           ws-new-iss-total + ws-balt-prem(1)
 11639     else
 11640        compute ws-new-iss-total =
 11641           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11642     end-if
 11643
 11644     if bprem2l <> zeros
 11645        MOVE AL-UNNON            TO bprem2a
 11646        compute ws-new-iss-total = ws-new-iss-total +
 11647           ws-bprem (2)
 11648     else
 11649        compute ws-new-iss-total = ws-new-iss-total +
 11650           pb-i-ah-premium-amt
 11651     end-if
 11652
 11653     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11654        if ((bprem1l <> zeros)
 11655           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11656                      or
 11657           ((bprem2l <> zeros)
 11658           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11659           move er-3456          to emi-error
 11660           perform 9900-error-format
 11661                                 thru 9900-exit
 11662           go to 1330-continue
 11663        end-if
 11664     end-if
 11665
 11666     if ws-new-iss-total > ws-tot-orig-prem
 11667        move er-3458             to emi-error
 11668        perform 9900-error-format thru 9900-exit
 11669        move al-uabon            to bmainta
 11670        move -1                  to bmaintl
 11671        go to 8200-send-dataonly
 11672     end-if
 11673
 11674     if ws-new-iss-total < ws-tot-orig-prem
 11675        move er-3457             to emi-error
 11676        move al-uabon            to bprem1a
 11677                                    bprem2a
 11678        move +0 to bprem1l bprem2l
 11679        perform 9900-error-format thru 9900-exit
 11680        move -1                  to bmaintl
 11681        go to 1330-continue
 11682     end-if
 11683
 11684     .
 11685 1330-continue.
 11686
 11687
 11688* EXEC CICS READ
 11689*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 214
* EL6311.cbl
 11690*        INTO    (PENDING-BUSINESS)
 11691*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11692*        UPDATE
 11693*    END-EXEC.
 11694     MOVE LENGTH OF
 11695      PENDING-BUSINESS
 11696       TO DFHEIV11
 11697*    MOVE '&"IL       EU         (   #00011269' TO DFHEIV0
 11698     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11700     MOVE X'2020233030303131323639' TO DFHEIV0(25:11)
 11701     CALL 'kxdfhei1' USING DFHEIV0,
 11702           FILE-ID-ERPNDB,
 11703           PENDING-BUSINESS,
 11704           DFHEIV11,
 11705           PI-PREV-CONTROL-PRIMARY,
 11706           DFHEIV99,
 11707           DFHEIV99,
 11708           DFHEIV99
 11709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11710
 11711
 11712     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11713     MOVE 'B'                    TO JP-RECORD-TYPE
 11714     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11715     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11716
 11717     PERFORM 8400-LOG-JOURNAL-RECORD.
 11718
 11719     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11720        PB-CHG-COUNT NOT = ZEROS
 11721        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11722            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11723           OR
 11724           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11725            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11726            MOVE LOW-VALUES             TO PB-BILLED-DT
 11727            ADD +1                      TO PB-CHG-COUNT.
 11728
 11729     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11730     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11731     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11732     MOVE '5'                    TO DC-OPTION-CODE.
 11733     PERFORM 9700-DATE-LINK
 11734     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11735
 11736*    IF BMICRNOL  GREATER  ZEROS
 11737*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11738
 11739     IF BVINL > ZEROS
 11740        MOVE BVINI               TO PB-I-VIN
 11741     END-IF
 11742     IF (BFORCEL NOT = ZEROS)
 11743        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11744        AND (BFORCEI = ' ')
 11745        AND (PB-FORCE-CODE = 'O')
 11746        COMPUTE PB-I-AH-PREMIUM-AMT =
 11747           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 215
* EL6311.cbl
 11748        PERFORM 1800-REMOVE-CERT-NOTES
 11749                                 THRU 1800-EXIT
 11750        PERFORM 1900-DELETE-ERPYAJ
 11751                                 THRU 1900-EXIT
 11752        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11753     END-IF
 11754     IF (BFORCEL NOT = ZEROS)
 11755        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11756        AND (BFORCEI = 'O')
 11757        AND (PB-FORCE-CODE NOT = 'O')
 11758        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11759           PB-I-AH-PREM-CALC
 11760        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11761        MOVE SPACE               TO DC-OPTION-CODE
 11762        PERFORM 9700-DATE-LINK
 11763        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11764        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11765        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11766        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11767        PERFORM 1500-UPDATE-ERNOTE
 11768                                 THRU 1500-EXIT
 11769        PERFORM 1600-UPDATE-ERPYAJ
 11770                                 THRU 1600-EXIT
 11771     END-IF
 11772     IF BLSTNML  GREATER THAN ZEROS
 11773         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11774
 11775     IF B1STNML  GREATER THAN ZEROS
 11776         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11777
 11778     IF BINITL   GREATER THAN ZEROS
 11779         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11780
 11781     IF BBIRTHL  GREATER THAN ZERO
 11782         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11783
 11784     IF B1STPMTL GREATER THAN ZERO
 11785         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11786
 11787     IF BAGEL    GREATER THAN ZEROS
 11788         MOVE BAGEI              TO PB-I-AGE.
 11789
 11790     MOVE 'N'                    TO WS-INS-AGE-SET
 11791                                    WS-JNT-AGE-SET.
 11792     IF BAGEL    GREATER THAN ZEROS
 11793        MOVE 'Y'                TO WS-INS-AGE-SET
 11794        IF BAGEI = ZERO AND
 11795             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11796           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11797           MOVE 'AGE*'          TO BAGEDEFO
 11798        ELSE
 11799           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11800           MOVE 'AGE '          TO BAGEDEFO
 11801        END-IF
 11802        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11803     END-IF.
 11804
 11805     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 216
* EL6311.cbl
 11806         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11807
 11808     IF LETRREQL   GREATER THAN ZEROS
 11809        MOVE LETRREQI TO PB-I-LETTER-REQD
 11810     END-IF.
 11811
 11812     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11813        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11814
 11815     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11816        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11817
 11818     IF BLNTRML  GREATER THAN ZEROS
 11819         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11820
 11821     IF BFREQL   GREATER THAN ZEROS
 11822         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11823
 11824     IF BSKPCDL  GREATER THAN ZEROS
 11825         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11826
 11827     IF BMODEL   GREATER THAN ZEROS
 11828         MOVE BMODEI             TO PB-I-TERM-TYPE
 11829                                    PI-BMODE.
 11830
 11831     IF BPMTSL   GREATER THAN ZEROS
 11832         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11833                                    PI-BPMTS.
 11834
 11835     IF BPMTAMTL GREATER THAN ZEROS
 11836         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11837
 11838     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11839         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11840
 11841     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11842         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11843
 11844     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11845
 11846     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11847         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11848            SUBTRACT PB-I-LF-PREMIUM-AMT
 11849                     FROM WS-B-LF-ISS-PRM-ENTERED
 11850            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11851            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11852            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11853         ELSE
 11854            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11855*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11856*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11857         END-IF
 11858     END-IF.
 11859
 11860     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11861            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11862                     FROM WS-B-LF-ISS-PRM-ENTERED
 11863         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 217
* EL6311.cbl
 11864         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11865
 11866     IF  BALT-PREM-LEN     (2)  > ZEROS
 11867         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11868
 11869     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11870         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11871
 11872     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11873         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11874            SUBTRACT PB-I-AH-PREMIUM-AMT
 11875                     FROM WS-B-AH-ISS-PRM-ENTERED
 11876            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11877            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11878            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11879         ELSE
 11880            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11881*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11882*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11883         END-IF
 11884     END-IF
 11885
 11886     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11887        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11888
 11889     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11890        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11891
 11892     IF BINDGRPL            GREATER THAN ZEROS
 11893         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11894
 11895     IF BRTCLSL             GREATER THAN ZEROS
 11896         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11897
 11898     IF BSIGL               GREATER THAN ZEROS
 11899         MOVE BSIGI              TO PB-I-SIG-SW.
 11900
 11901     IF BAPRL               GREATER THAN ZEROS
 11902         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11903
 11904     IF BMEMBERL            GREATER THAN ZEROS
 11905         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11906
 11907     IF BLNOFCRL            GREATER THAN ZEROS
 11908         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11909
 11910     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11911        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11912
 11913     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11914        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11915
 11916     IF BDAYSL              GREATER THAN ZEROS
 11917        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11918                                    PB-I-EXTENTION-DAYS.
 11919
 11920     IF BDAYSL GREATER THAN ZEROS
 11921        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 218
* EL6311.cbl
 11922
 11923     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11924        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11925           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11926
 11927     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11928        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11929           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11930
 11931     IF B1STPMTL GREATER THAN ZEROS
 11932        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11933
 11934     IF PB-EXT-DAYS-PROCESSING
 11935        IF PB-I-EXTENTION-DAYS = ZEROS
 11936           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11937
 11938     IF PB-EXPIRE-DT-PROCESSING
 11939        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11940           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11941             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11942
 11943     IF PB-1ST-PMT-DT-PROCESSING
 11944        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11945           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11946
 11947     IF BREINL GREATER THAN ZEROS
 11948        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11949
 11950     IF BFORCEL NOT = ZEROS
 11951        MOVE BFORCEI             TO PB-FORCE-CODE.
 11952     IF (BENTRYL NOT = ZEROS)
 11953        AND (PB-COMPANY-ID = 'CID')
 11954        AND (PB-STATE = 'VA')
 11955        AND (BENTRYI NOT = 'P')
 11956        AND (PB-BATCH-ENTRY = 'P')
 11957        PERFORM 1800-REMOVE-CERT-NOTES
 11958                                 THRU 1800-EXIT
 11959     END-IF
 11960     IF BENTRYL NOT = ZEROS
 11961        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11962        IF PI-COMPANY-ID = 'CID'
 11963           AND (PB-BATCH-ENTRY = 'P')
 11964           AND (PB-STATE = 'VA')
 11965           PERFORM 1500-UPDATE-ERNOTE
 11966                                 THRU 1500-EXIT
 11967        END-IF
 11968     END-IF
 11969
 11970     IF BUNWRITL NOT = ZEROS
 11971        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11972
 11973     IF BBILCDL NOT = ZEROS
 11974        MOVE BBILCDI             TO PB-RECORD-BILL.
 11975
 11976     IF BLIVESL GREATER THAN ZEROS
 11977        MOVE WS-BLIVES           TO PB-I-LIVES.
 11978
 11979
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 219
* EL6311.cbl
 11980*DMD CUSTOM CODING*************START
 11981     IF PI-COMPANY-ID NOT = 'DMD'
 11982         MOVE ZEROS               TO BBILLEDL.
 11983*DMD CUSTOM CODING*************END
 11984
 11985     IF BBILLEDL GREATER THAN ZEROS
 11986        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11987
 11988
 11989*****************************************************************
 11990*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11991*****************************************************************
 11992
 11993     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11994        IF BTYPE  (1)   = ZEROS OR SPACES
 11995           IF REMOVE-LF-COVERAGE
 11996               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11997                                        PI-BTYPE (1)
 11998               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11999                                        WS-B-LF-ISS-PRM-ENTERED
 12000               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12001                                        WS-B-LF-ISS-PRM-ENTERED
 12002               SUBTRACT PB-I-LF-PREM-CALC FROM
 12003                                        WS-B-LF-ISS-PRM-COMPUTED
 12004               MOVE ZEROS            TO PB-I-LF-TERM
 12005                                        PB-I-LF-BENEFIT-AMT
 12006                                        PB-I-LF-PREMIUM-AMT
 12007                                        PB-I-LF-BENEFIT-CD
 12008                                        PB-I-LF-PREM-CALC
 12009                                        PB-I-LF-CRIT-PER
 12010                                        PB-I-LF-ALT-BENEFIT-AMT
 12011                                        PB-I-LF-ALT-PREMIUM-AMT
 12012               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12013           ELSE
 12014               NEXT SENTENCE
 12015        ELSE
 12016           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12017                                    PI-BTYPE (1).
 12018     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12019        IF BTYPE  (2)   = ZEROS OR SPACES
 12020           IF  REMOVE-AH-COVERAGE
 12021               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12022                                        PI-BTYPE (2)
 12023               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12024                                        WS-B-AH-ISS-PRM-ENTERED
 12025               SUBTRACT PB-I-AH-PREM-CALC FROM
 12026                                        WS-B-AH-ISS-PRM-COMPUTED
 12027               MOVE ZEROS            TO PB-I-AH-TERM
 12028                                        PB-I-AH-BENEFIT-AMT
 12029                                        PB-I-AH-PREMIUM-AMT
 12030                                        PB-I-AH-BENEFIT-CD
 12031                                        PB-I-AH-PREM-CALC
 12032                                        PB-I-AH-CRIT-PER
 12033               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12034           ELSE
 12035               NEXT SENTENCE
 12036        ELSE
 12037           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 220
* EL6311.cbl
 12038                                    PI-BTYPE (2).
 12039 1360-REWRITE-PB-RECORD.
 12040     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12041
 12042     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12043     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12044
 12045     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12046
 12047     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12048     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12049
 12050     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12051         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12052
 12053     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12054         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12055
 12056     IF CSR-EDIT-SESSION
 12057        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12058     END-IF.
 12059
 12060     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12061
 12062     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12063
 12064     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12065
 12066     IF ARCHIVE-LETTER-RELEASED
 12067        MOVE 'C' TO PB-I-LETTER-REQD
 12068        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12069        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12070     END-IF
 12071
 12072     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12073     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12074     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12075
 12076     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12077     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12078
 12079 1375-REWRITE-PB-RECORD.
 12080     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12081     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12082     MOVE 'C'                    TO JP-RECORD-TYPE.
 12083     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12084
 12085
 12086* EXEC CICS REWRITE
 12087*        DATASET (FILE-ID-ERPNDB)
 12088*        FROM    (PENDING-BUSINESS)
 12089*    END-EXEC.
 12090     MOVE LENGTH OF
 12091      PENDING-BUSINESS
 12092       TO DFHEIV11
 12093*    MOVE '&& L                  %   #00011649' TO DFHEIV0
 12094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 221
* EL6311.cbl
 12096     MOVE X'2020233030303131363439' TO DFHEIV0(25:11)
 12097     CALL 'kxdfhei1' USING DFHEIV0,
 12098           FILE-ID-ERPNDB,
 12099           PENDING-BUSINESS,
 12100           DFHEIV11,
 12101           DFHEIV99
 12102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12103
 12104
 12105     PERFORM 8400-LOG-JOURNAL-RECORD.
 12106******************************************************************
 12107*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12108******************************************************************
 12109     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12110     MOVE ' '                    TO WS-ERMAIL-SW
 12111
 12112* EXEC CICS READ
 12113*       DATASET   (FILE-ID-ERMAIL)
 12114*       SET       (ADDRESS OF MAILING-DATA)
 12115*       RIDFLD    (ERMAIL-KEY)
 12116*       RESP      (WS-RESPONSE)
 12117*    END-EXEC
 12118*    MOVE '&"S        E          (  N#00011660' TO DFHEIV0
 12119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12121     MOVE X'204E233030303131363630' TO DFHEIV0(25:11)
 12122     CALL 'kxdfhei1' USING DFHEIV0,
 12123           FILE-ID-ERMAIL,
 12124           DFHEIV20,
 12125           DFHEIV99,
 12126           ERMAIL-KEY,
 12127           DFHEIV99,
 12128           DFHEIV99,
 12129           DFHEIV99
 12130     SET ADDRESS OF MAILING-DATA TO
 12131         DFHEIV20
 12132     MOVE EIBRESP  TO WS-RESPONSE
 12133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12134     IF RESP-NORMAL
 12135        SET ERMAIL-FOUND TO TRUE
 12136     END-IF
 12137
 12138     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12139     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12140                                 TO ELCRTO-KEY
 12141     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12142     MOVE +0                     TO ELCRTO-SEQ-NO
 12143
 12144* EXEC CICS READ
 12145*       DATASET   ('ELCRTO')
 12146*       INTO      (ORIGINAL-CERTIFICATE)
 12147*       RIDFLD    (ELCRTO-KEY)
 12148*       GTEQ
 12149*       RESP      (WS-RESPONSE)
 12150*    END-EXEC
 12151     MOVE LENGTH OF
 12152      ORIGINAL-CERTIFICATE
 12153       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 222
* EL6311.cbl
 12154     MOVE 'ELCRTO' TO DFHEIV1
 12155*    MOVE '&"IL       G          (  N#00011675' TO DFHEIV0
 12156     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12158     MOVE X'204E233030303131363735' TO DFHEIV0(25:11)
 12159     CALL 'kxdfhei1' USING DFHEIV0,
 12160           DFHEIV1,
 12161           ORIGINAL-CERTIFICATE,
 12162           DFHEIV11,
 12163           ELCRTO-KEY,
 12164           DFHEIV99,
 12165           DFHEIV99,
 12166           DFHEIV99
 12167     MOVE EIBRESP  TO WS-RESPONSE
 12168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12169*    display ' just read gteq ' ws-response
 12170     IF RESP-NORMAL
 12171        AND (OC-CONTROL-PRIMARY (1:33) =
 12172                 PB-CONTROL-BY-ACCOUNT (1:33))
 12173        AND (OC-RECORD-TYPE = 'I')
 12174        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12175           display ' csr edit session ' PI-CSR-SESSION-SW
 12176           IF NOT CSR-EDIT-SESSION
 12177
 12178* EXEC CICS READ
 12179*                DATASET   ('ELCRTO')
 12180*                INTO      (ORIGINAL-CERTIFICATE)
 12181*                RIDFLD    (OC-CONTROL-PRIMARY)
 12182*                UPDATE
 12183*                RESP      (WS-RESPONSE)
 12184*             END-EXEC
 12185     MOVE LENGTH OF
 12186      ORIGINAL-CERTIFICATE
 12187       TO DFHEIV11
 12188     MOVE 'ELCRTO' TO DFHEIV1
 12189*    MOVE '&"IL       EU         (  N#00011692' TO DFHEIV0
 12190     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12191     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12192     MOVE X'204E233030303131363932' TO DFHEIV0(25:11)
 12193     CALL 'kxdfhei1' USING DFHEIV0,
 12194           DFHEIV1,
 12195           ORIGINAL-CERTIFICATE,
 12196           DFHEIV11,
 12197           OC-CONTROL-PRIMARY,
 12198           DFHEIV99,
 12199           DFHEIV99,
 12200           DFHEIV99
 12201     MOVE EIBRESP  TO WS-RESPONSE
 12202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12203              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12204              IF RESP-NORMAL
 12205                 display ' good read upd '
 12206                 MOVE PB-I-INSURED-LAST-NAME TO
 12207                         OC-INS-LAST-NAME
 12208                 MOVE PB-I-INSURED-FIRST-NAME TO
 12209                         OC-INS-FIRST-NAME
 12210                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12211                         OC-INS-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 223
* EL6311.cbl
 12212                 MOVE PB-I-AGE         TO OC-INS-AGE
 12213                 MOVE PB-I-JOINT-LAST-NAME   TO
 12214                         OC-JNT-LAST-NAME
 12215                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12216                         OC-JNT-FIRST-NAME
 12217                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12218                         OC-JNT-MIDDLE-INIT
 12219                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12220                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12221                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12222                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12223                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12224                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12225                         OC-LF-ALT-BEN-AMT
 12226                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12227                         OC-LF-ALT-PRM-AMT
 12228                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12229                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12230                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12231                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12232                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12233                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12234                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12235                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12236                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12237                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12238                 IF OC-CANCEL-TRAN-IND = 'N'
 12239                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12240                    MOVE +0            TO OC-LF-CANCEL-AMT
 12241                                          OC-LF-ITD-CANCEL-AMT
 12242                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12243                    MOVE +0            TO OC-AH-CANCEL-AMT
 12244                                          OC-AH-ITD-CANCEL-AMT
 12245                 END-IF
 12246                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12247                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12248                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12249                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12250                 IF ERMAIL-FOUND
 12251                    MOVE MA-CRED-BENE-NAME
 12252                                 TO OC-CRED-BENE-NAME
 12253                 END-IF
 12254                 IF NOT CERT-TRL-REC-NOT-FOUND
 12255                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12256                           OC-INS-AGE-DEFAULT-FLAG
 12257                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12258                           OC-JNT-AGE-DEFAULT-FLAG
 12259                 END-IF
 12260
 12261* EXEC CICS REWRITE
 12262*                   DATASET   ('ELCRTO')
 12263*                   FROM      (ORIGINAL-CERTIFICATE)
 12264*                   RESP      (WS-RESPONSE)
 12265*                END-EXEC
 12266     MOVE LENGTH OF
 12267      ORIGINAL-CERTIFICATE
 12268       TO DFHEIV11
 12269     MOVE 'ELCRTO' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 224
* EL6311.cbl
 12270*    MOVE '&& L                  %  N#00011756' TO DFHEIV0
 12271     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12272     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12273     MOVE X'204E233030303131373536' TO DFHEIV0(25:11)
 12274     CALL 'kxdfhei1' USING DFHEIV0,
 12275           DFHEIV1,
 12276           ORIGINAL-CERTIFICATE,
 12277           DFHEIV11,
 12278           DFHEIV99
 12279     MOVE EIBRESP  TO WS-RESPONSE
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12281                 display ' just rewrote ' ws-response
 12282              END-IF
 12283           END-IF
 12284        ELSE
 12285           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12286           MOVE 'OC'             TO OC-RECORD-ID
 12287           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12288           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12289           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12290           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12291           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12292           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12293           MOVE PB-I-AGE         TO OC-INS-AGE
 12294           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12295           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12296           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12297           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12298           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12299           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12300           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12301           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12302           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12303           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12304           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12305           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12306           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12307           MOVE +0               TO OC-LF-CANCEL-AMT
 12308                                    OC-LF-ITD-CANCEL-AMT
 12309           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12310           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12311           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12312           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12313           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12314           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12315           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12316           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12317           MOVE +0               TO OC-AH-CANCEL-AMT
 12318                                    OC-AH-ITD-CANCEL-AMT
 12319           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12320           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12321           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12322           IF ERMAIL-FOUND
 12323              MOVE MA-CRED-BENE-NAME
 12324                                 TO OC-CRED-BENE-NAME
 12325           END-IF
 12326           IF NOT CERT-TRL-REC-NOT-FOUND
 12327              MOVE CS-INS-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 225
* EL6311.cbl
 12328                           OC-INS-AGE-DEFAULT-FLAG
 12329              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12330                           OC-JNT-AGE-DEFAULT-FLAG
 12331           END-IF
 12332           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12333
 12334* EXEC CICS WRITE
 12335*             DATASET   ('ELCRTO')
 12336*             FROM      (ORIGINAL-CERTIFICATE)
 12337*             RIDFLD    (OC-CONTROL-PRIMARY)
 12338*             RESP      (WS-RESPONSE)
 12339*          END-EXEC
 12340     MOVE LENGTH OF
 12341      ORIGINAL-CERTIFICATE
 12342       TO DFHEIV11
 12343     MOVE 'ELCRTO' TO DFHEIV1
 12344*    MOVE '&$ L                  ''  N#00011813' TO DFHEIV0
 12345     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12347     MOVE X'204E233030303131383133' TO DFHEIV0(25:11)
 12348     CALL 'kxdfhei1' USING DFHEIV0,
 12349           DFHEIV1,
 12350           ORIGINAL-CERTIFICATE,
 12351           DFHEIV11,
 12352           OC-CONTROL-PRIMARY,
 12353           DFHEIV99,
 12354           DFHEIV99
 12355     MOVE EIBRESP  TO WS-RESPONSE
 12356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12357        END-IF
 12358     ELSE
 12359        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12360        MOVE 'OC'                TO OC-RECORD-ID
 12361        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12362                                 TO OC-CONTROL-PRIMARY (1:33)
 12363        MOVE 'I'                 TO OC-RECORD-TYPE
 12364        MOVE +4096               TO OC-KEY-SEQ-NO
 12365        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12366        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12367        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12368        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12369        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12370        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12371        MOVE PB-I-AGE            TO OC-INS-AGE
 12372        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12373        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12374        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12375        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12376        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12377        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12378        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12379        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12380        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12381        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12382        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12383        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12384        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12385        MOVE +0                  TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 226
* EL6311.cbl
 12386                                    OC-LF-ITD-CANCEL-AMT
 12387        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12388        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12389        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12390        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12391        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12392        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12393        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12394        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12395        MOVE +0                  TO OC-AH-CANCEL-AMT
 12396                                    OC-AH-ITD-CANCEL-AMT
 12397        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12398        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12399        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12400        IF ERMAIL-FOUND
 12401           MOVE MA-CRED-BENE-NAME
 12402                                 TO OC-CRED-BENE-NAME
 12403        END-IF
 12404        IF NOT CERT-TRL-REC-NOT-FOUND
 12405           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12406                           OC-INS-AGE-DEFAULT-FLAG
 12407           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12408                           OC-JNT-AGE-DEFAULT-FLAG
 12409        END-IF
 12410        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12411
 12412* EXEC CICS WRITE
 12413*          DATASET   ('ELCRTO')
 12414*          FROM      (ORIGINAL-CERTIFICATE)
 12415*          RIDFLD    (OC-CONTROL-PRIMARY)
 12416*          RESP      (WS-RESPONSE)
 12417*       END-EXEC
 12418     MOVE LENGTH OF
 12419      ORIGINAL-CERTIFICATE
 12420       TO DFHEIV11
 12421     MOVE 'ELCRTO' TO DFHEIV1
 12422*    MOVE '&$ L                  ''  N#00011873' TO DFHEIV0
 12423     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12425     MOVE X'204E233030303131383733' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0,
 12427           DFHEIV1,
 12428           ORIGINAL-CERTIFICATE,
 12429           DFHEIV11,
 12430           OC-CONTROL-PRIMARY,
 12431           DFHEIV99,
 12432           DFHEIV99
 12433     MOVE EIBRESP  TO WS-RESPONSE
 12434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12435     END-IF
 12436******************************************************************
 12437*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12438******************************************************************
 12439
 12440     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12441     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12442
 12443
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 227
* EL6311.cbl
 12444* EXEC CICS READ
 12445*        INTO    (PENDING-BUSINESS)
 12446*        DATASET (FILE-ID-ERPNDB)
 12447*        RIDFLD  (ERPNDB-KEY)
 12448*        UPDATE
 12449*    END-EXEC.
 12450     MOVE LENGTH OF
 12451      PENDING-BUSINESS
 12452       TO DFHEIV11
 12453*    MOVE '&"IL       EU         (   #00011887' TO DFHEIV0
 12454     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12455     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12456     MOVE X'2020233030303131383837' TO DFHEIV0(25:11)
 12457     CALL 'kxdfhei1' USING DFHEIV0,
 12458           FILE-ID-ERPNDB,
 12459           PENDING-BUSINESS,
 12460           DFHEIV11,
 12461           ERPNDB-KEY,
 12462           DFHEIV99,
 12463           DFHEIV99,
 12464           DFHEIV99
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12469     MOVE 'B'                    TO JP-RECORD-TYPE.
 12470     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12471
 12472     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12473
 12474     PERFORM 8400-LOG-JOURNAL-RECORD.
 12475
 12476     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12477
 12478     MOVE 'C'                    TO JP-RECORD-TYPE.
 12479     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12480
 12481
 12482* EXEC CICS REWRITE
 12483*        DATASET    (FILE-ID-ERPNDB)
 12484*        FROM       (PENDING-BUSINESS)
 12485*    END-EXEC.
 12486     MOVE LENGTH OF
 12487      PENDING-BUSINESS
 12488       TO DFHEIV11
 12489*    MOVE '&& L                  %   #00011907' TO DFHEIV0
 12490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303131393037' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           FILE-ID-ERPNDB,
 12495           PENDING-BUSINESS,
 12496           DFHEIV11,
 12497           DFHEIV99
 12498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12499
 12500
 12501     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 228
* EL6311.cbl
 12502
 12503     IF WS-ERRORS-PRESENT
 12504        GO TO 3900-RE-DISPLAY-RECORD.
 12505
 12506     MOVE ZEROS                  TO EMI-ERROR.
 12507     MOVE -1                     TO BMAINTL.
 12508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12509     GO TO 3900-RE-DISPLAY-RECORD.
 12510
 12511 1380-BATCH-HDR-NOT-FOUND.
 12512     MOVE -1                     TO BMAINTL.
 12513     MOVE ER-7450                TO EMI-ERROR.
 12514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12515     GO TO 8200-SEND-DATAONLY.
 12516
 12517 1385-REC-NOT-FOUND.
 12518     MOVE -1                     TO BMAINTL.
 12519     MOVE ER-7451                TO EMI-ERROR.
 12520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12521     GO TO 8200-SEND-DATAONLY.
 12522
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 229
* EL6311.cbl
 12524
 12525 1386-UPDATE-AGE-FLAGS.
 12526
 12527
 12528* EXEC CICS GETMAIN
 12529*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12530*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12531*        INITIMG (GETMAIN-SPACE)
 12532*    END-EXEC
 12533*    MOVE ',"IL                  $   #00011938' TO DFHEIV0
 12534     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12536     MOVE X'2020233030303131393338' TO DFHEIV0(25:11)
 12537     CALL 'kxdfhei1' USING DFHEIV0,
 12538           DFHEIV20,
 12539           ELCRTT-RECORD-LENGTH,
 12540           GETMAIN-SPACE
 12541     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12542         DFHEIV20
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12544
 12545
 12546* EXEC CICS HANDLE CONDITION
 12547*        NOTFND   (1386-NOTFND)
 12548*    END-EXEC.
 12549*    MOVE '"$I                   ! ( #00011944' TO DFHEIV0
 12550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12552     MOVE X'2820233030303131393434' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0
 12554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12555
 12556
 12557     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12558     MOVE 'C'                TO ELCRTT-REC-TYPE
 12559
 12560
 12561* EXEC CICS READ
 12562*        UPDATE
 12563*        DATASET  (CRTT-ID)
 12564*        RIDFLD   (ELCRTT-KEY)
 12565*        INTO     (CERTIFICATE-TRAILERS)
 12566*    END-EXEC.
 12567     MOVE LENGTH OF
 12568      CERTIFICATE-TRAILERS
 12569       TO DFHEIV11
 12570*    MOVE '&"IL       EU         (   #00011951' TO DFHEIV0
 12571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12572     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12573     MOVE X'2020233030303131393531' TO DFHEIV0(25:11)
 12574     CALL 'kxdfhei1' USING DFHEIV0,
 12575           CRTT-ID,
 12576           CERTIFICATE-TRAILERS,
 12577           DFHEIV11,
 12578           ELCRTT-KEY,
 12579           DFHEIV99,
 12580           DFHEIV99,
 12581           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 230
* EL6311.cbl
 12582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12583
 12584
 12585     IF WS-INS-AGE-SET = 'Y'
 12586        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12587     END-IF
 12588     IF WS-JNT-AGE-SET = 'Y'
 12589        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12590     END-IF
 12591
 12592
 12593* EXEC CICS REWRITE
 12594*       DATASET  (CRTT-ID)
 12595*       FROM     (CERTIFICATE-TRAILERS)
 12596*    END-EXEC.
 12597     MOVE LENGTH OF
 12598      CERTIFICATE-TRAILERS
 12599       TO DFHEIV11
 12600*    MOVE '&& L                  %   #00011965' TO DFHEIV0
 12601     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12602     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12603     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 12604     CALL 'kxdfhei1' USING DFHEIV0,
 12605           CRTT-ID,
 12606           CERTIFICATE-TRAILERS,
 12607           DFHEIV11,
 12608           DFHEIV99
 12609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12610
 12611
 12612     GO TO 1386-EXIT.
 12613
 12614 1386-NOTFND.
 12615
 12616     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12617     MOVE 'CS'         TO CS-RECORD-ID.
 12618     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12619     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12620     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12621     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12622     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12623
 12624* EXEC CICS WRITE
 12625*       DATASET  (CRTT-ID)
 12626*       RIDFLD   (ELCRTT-KEY)
 12627*       FROM     (CERTIFICATE-TRAILERS)
 12628*    END-EXEC.
 12629     MOVE LENGTH OF
 12630      CERTIFICATE-TRAILERS
 12631       TO DFHEIV11
 12632*    MOVE '&$ L                  ''   #00011981' TO DFHEIV0
 12633     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12635     MOVE X'2020233030303131393831' TO DFHEIV0(25:11)
 12636     CALL 'kxdfhei1' USING DFHEIV0,
 12637           CRTT-ID,
 12638           CERTIFICATE-TRAILERS,
 12639           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 231
* EL6311.cbl
 12640           ELCRTT-KEY,
 12641           DFHEIV99,
 12642           DFHEIV99
 12643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12644
 12645
 12646 1386-EXIT.
 12647     EXIT.
 12648
 12649 1390-UPDATE-ERPNDM.
 12650
 12651
 12652* EXEC CICS HANDLE CONDITION
 12653*        NOTFND (1399-EXIT)
 12654*    END-EXEC.
 12655*    MOVE '"$I                   ! ) #00011992' TO DFHEIV0
 12656     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12658     MOVE X'2920233030303131393932' TO DFHEIV0(25:11)
 12659     CALL 'kxdfhei1' USING DFHEIV0
 12660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12661
 12662
 12663     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12664
 12665
 12666* EXEC CICS READ
 12667*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12668*        DATASET (FILE-ID-ERPNDM)
 12669*        RIDFLD  (ERPNDM-KEY)
 12670*        UPDATE
 12671*    END-EXEC.
 12672*    MOVE '&"S        EU         (   #00011998' TO DFHEIV0
 12673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12674     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12675     MOVE X'2020233030303131393938' TO DFHEIV0(25:11)
 12676     CALL 'kxdfhei1' USING DFHEIV0,
 12677           FILE-ID-ERPNDM,
 12678           DFHEIV20,
 12679           DFHEIV99,
 12680           ERPNDM-KEY,
 12681           DFHEIV99,
 12682           DFHEIV99,
 12683           DFHEIV99
 12684     SET ADDRESS OF PENDING-MAILING-DATA TO
 12685         DFHEIV20
 12686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12687
 12688
 12689     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12690     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12691     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12692
 12693     IF BLSTNML GREATER THAN ZEROS
 12694         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12695
 12696     IF B1STNML GREATER  THAN ZEROS
 12697         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 232
* EL6311.cbl
 12698
 12699     IF BINITL GREATER THAN ZEROS
 12700         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12701
 12702     IF BAGEL GREATER THAN ZEROS
 12703         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12704
 12705     IF BBIRTHL GREATER THAN ZEROS
 12706         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12707
 12708     IF BSEXL GREATER THAN ZEROS
 12709         MOVE  BSEXI             TO PM-INSURED-SEX.
 12710
 12711
 12712* EXEC CICS REWRITE
 12713*        DATASET (FILE-ID-ERPNDM)
 12714*        FROM    (PENDING-MAILING-DATA)
 12715*    END-EXEC.
 12716     MOVE LENGTH OF
 12717      PENDING-MAILING-DATA
 12718       TO DFHEIV11
 12719*    MOVE '&& L                  %   #00012027' TO DFHEIV0
 12720     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12721     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12722     MOVE X'2020233030303132303237' TO DFHEIV0(25:11)
 12723     CALL 'kxdfhei1' USING DFHEIV0,
 12724           FILE-ID-ERPNDM,
 12725           PENDING-MAILING-DATA,
 12726           DFHEIV11,
 12727           DFHEIV99
 12728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12729
 12730
 12731 1399-EXIT.
 12732     EXIT.
 12733 139A-SET-LETTER-REQD.
 12734*  COMPARE BEFORE AND AFTER CHANGE
 12735     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12736        GO TO 139A-EXIT
 12737     END-IF
 12738
 12739*  READ ELCRTO
 12740     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12741                                 TO ELCRTO-KEY
 12742     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12743     MOVE +0                     TO ELCRTO-SEQ-NO
 12744
 12745
 12746* EXEC CICS READ
 12747*       DATASET   ('ELCRTO')
 12748*       INTO      (ORIGINAL-CERTIFICATE)
 12749*       RIDFLD    (ELCRTO-KEY)
 12750*       GTEQ
 12751*       RESP      (WS-RESPONSE)
 12752*    END-EXEC
 12753     MOVE LENGTH OF
 12754      ORIGINAL-CERTIFICATE
 12755       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 233
* EL6311.cbl
 12756     MOVE 'ELCRTO' TO DFHEIV1
 12757*    MOVE '&"IL       G          (  N#00012046' TO DFHEIV0
 12758     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12760     MOVE X'204E233030303132303436' TO DFHEIV0(25:11)
 12761     CALL 'kxdfhei1' USING DFHEIV0,
 12762           DFHEIV1,
 12763           ORIGINAL-CERTIFICATE,
 12764           DFHEIV11,
 12765           ELCRTO-KEY,
 12766           DFHEIV99,
 12767           DFHEIV99,
 12768           DFHEIV99
 12769     MOVE EIBRESP  TO WS-RESPONSE
 12770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12771
 12772*    display ' just read gteq ' ws-response
 12773     IF RESP-NORMAL
 12774        AND (OC-CONTROL-PRIMARY (1:33) =
 12775                 PB-CONTROL-BY-ACCOUNT (1:33))
 12776        AND (OC-RECORD-TYPE = 'I')
 12777*      compare individual fields
 12778        IF LETRREQL   GREATER THAN ZEROS
 12779           CONTINUE
 12780        ELSE
 12781        IF OC-CERT-NO = PB-CERT-NO
 12782          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12783          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12784          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12785          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12786          AND OC-INS-AGE = PB-I-AGE
 12787          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12788          AND OC-LF-TERM = PB-I-LF-TERM
 12789          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12790          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12791          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12792          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12793          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12794          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12795          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12796          AND PB-I-AH-TERM           = OC-AH-TERM
 12797          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12798          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12799          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12800          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12801          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12802           MOVE SPACE TO PB-I-LETTER-REQD
 12803        ELSE
 12804           MOVE 'Y' TO PB-I-LETTER-REQD
 12805        END-IF
 12806     END-IF.
 12807
 12808 139A-EXIT.
 12809     EXIT.
 12810
 12811******************************************************************
 12812*                                                                *
 12813*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 234
* EL6311.cbl
 12814*                                                                *
 12815******************************************************************
 12816
 12817 1400-DELETE-ISSUE-ROUTINE.
 12818     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12819
 12820     IF BCHGL NOT = ZEROS
 12821        MOVE ER-2196             TO EMI-ERROR
 12822        MOVE AL-UABON            TO BMAINTA
 12823        MOVE -1                  TO BMAINTL
 12824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12825        GO TO 8200-SEND-DATAONLY.
 12826
 12827
 12828* EXEC CICS HANDLE CONDITION
 12829*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12830*    END-EXEC.
 12831*    MOVE '"$I                   ! * #00012109' TO DFHEIV0
 12832     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12834     MOVE X'2A20233030303132313039' TO DFHEIV0(25:11)
 12835     CALL 'kxdfhei1' USING DFHEIV0
 12836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12837
 12838
 12839     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12840     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12841     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12842
 12843
 12844* EXEC CICS READ
 12845*        SET     (ADDRESS OF PENDING-BUSINESS)
 12846*        DATASET (FILE-ID-ERPNDB)
 12847*        RIDFLD  (ERPNDB-KEY)
 12848*    END-EXEC.
 12849*    MOVE '&"S        E          (   #00012117' TO DFHEIV0
 12850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12852     MOVE X'2020233030303132313137' TO DFHEIV0(25:11)
 12853     CALL 'kxdfhei1' USING DFHEIV0,
 12854           FILE-ID-ERPNDB,
 12855           DFHEIV20,
 12856           DFHEIV99,
 12857           ERPNDB-KEY,
 12858           DFHEIV99,
 12859           DFHEIV99,
 12860           DFHEIV99
 12861     SET ADDRESS OF PENDING-BUSINESS TO
 12862         DFHEIV20
 12863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12864
 12865
 12866     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12867
 12868     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12869
 12870     IF BSUFIXL NOT = ZEROS
 12871        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 235
* EL6311.cbl
 12872     ELSE
 12873        MOVE SPACE               TO WS-NEW-SUFFIX.
 12874
 12875     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12876     PERFORM 8600-DEEDIT.
 12877     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12878     MOVE '4'                    TO DC-OPTION-CODE.
 12879     PERFORM 9700-DATE-LINK.
 12880     IF DATE-CONVERSION-ERROR
 12881        MOVE ER-0348             TO EMI-ERROR
 12882        MOVE -1                  TO BEFFDTL
 12883        MOVE AL-UABON            TO BEFFDTA
 12884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12885        GO TO 8200-SEND-DATAONLY
 12886     ELSE
 12887        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12888        MOVE AL-UANON            TO BEFFDTA
 12889        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12890
 12891
 12892* EXEC CICS HANDLE CONDITION
 12893*         NOTFND    (1490-RECORD-NOT-FOUND)
 12894*    END-EXEC.
 12895*    MOVE '"$I                   ! + #00012148' TO DFHEIV0
 12896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12898     MOVE X'2B20233030303132313438' TO DFHEIV0(25:11)
 12899     CALL 'kxdfhei1' USING DFHEIV0
 12900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12901
 12902
 12903
 12904* EXEC CICS READ
 12905*        SET     (ADDRESS OF PENDING-BUSINESS)
 12906*        DATASET (FILE-ID-ERPNDB)
 12907*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12908*        UPDATE
 12909*    END-EXEC.
 12910*    MOVE '&"S        EU         (   #00012152' TO DFHEIV0
 12911     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12912     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12913     MOVE X'2020233030303132313532' TO DFHEIV0(25:11)
 12914     CALL 'kxdfhei1' USING DFHEIV0,
 12915           FILE-ID-ERPNDB,
 12916           DFHEIV20,
 12917           DFHEIV99,
 12918           PI-PREV-CONTROL-PRIMARY,
 12919           DFHEIV99,
 12920           DFHEIV99,
 12921           DFHEIV99
 12922     SET ADDRESS OF PENDING-BUSINESS TO
 12923         DFHEIV20
 12924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12925
 12926
 12927     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12928        MOVE -1                 TO BMAINTL
 12929        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 236
* EL6311.cbl
 12930        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12931        GO TO 8200-SEND-DATAONLY.
 12932
 12933     IF PB-BILLED-DT NOT = LOW-VALUES
 12934        MOVE -1                 TO BMAINTL
 12935        MOVE ER-2129            TO EMI-ERROR
 12936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12937        GO TO 8200-SEND-DATAONLY.
 12938
 12939     IF PB-CHG-COUNT NOT = ZEROS
 12940        MOVE ER-2336            TO EMI-ERROR
 12941        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12942        MOVE AL-UABON            TO BMAINTA
 12943        MOVE -1                  TO BMAINTL
 12944        GO TO 8200-SEND-DATAONLY.
 12945
 12946     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12947        PB-CHG-COUNT NOT = ZEROS
 12948        MOVE ER-2196             TO EMI-ERROR
 12949        MOVE AL-UABON            TO BMAINTA
 12950        MOVE -1                  TO BMAINTL
 12951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12952        GO TO 8200-SEND-DATAONLY.
 12953******************************************************************
 12954*                                                                *
 12955*       Determine if there have been any checks created          *
 12956*                                                                *
 12957******************************************************************
 12958
 12959     perform 2500-browse-checks  thru 2500-exit
 12960
 12961     if i-have-processed-checks
 12962        or i-have-checks
 12963        or i-have-a-check-period
 12964        move er-3446             to emi-error
 12965        perform 9900-error-format thru 9900-exit
 12966        move al-uabon            to bmainta
 12967        move -1                  to bmaintl
 12968        go to 8200-send-dataonly
 12969     end-if
 12970******************************************************************
 12971*                                                                *
 12972*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12973*                                                                *
 12974******************************************************************
 12975     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12976     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12977     MOVE +0                     TO ELCRTO-SEQ-NO
 12978
 12979* EXEC CICS READ
 12980*       DATASET   ('ELCRTO')
 12981*       INTO      (ORIGINAL-CERTIFICATE)
 12982*       RIDFLD    (ELCRTO-KEY)
 12983*       GTEQ
 12984*       RESP      (WS-RESPONSE)
 12985*    END-EXEC
 12986     MOVE LENGTH OF
 12987      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 237
* EL6311.cbl
 12988       TO DFHEIV11
 12989     MOVE 'ELCRTO' TO DFHEIV1
 12990*    MOVE '&"IL       G          (  N#00012210' TO DFHEIV0
 12991     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12993     MOVE X'204E233030303132323130' TO DFHEIV0(25:11)
 12994     CALL 'kxdfhei1' USING DFHEIV0,
 12995           DFHEIV1,
 12996           ORIGINAL-CERTIFICATE,
 12997           DFHEIV11,
 12998           ELCRTO-KEY,
 12999           DFHEIV99,
 13000           DFHEIV99,
 13001           DFHEIV99
 13002     MOVE EIBRESP  TO WS-RESPONSE
 13003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13004     IF RESP-NORMAL
 13005        AND (OC-CONTROL-PRIMARY (1:33) =
 13006                 PB-CONTROL-BY-ACCOUNT (1:33))
 13007        AND (OC-RECORD-TYPE = 'I')
 13008
 13009* EXEC CICS READ
 13010*          DATASET   ('ELCRTO')
 13011*          INTO      (ORIGINAL-CERTIFICATE)
 13012*          RIDFLD    (ELCRTO-KEY)
 13013*          UPDATE
 13014*          RESP      (WS-RESPONSE)
 13015*       END-EXEC
 13016     MOVE LENGTH OF
 13017      ORIGINAL-CERTIFICATE
 13018       TO DFHEIV11
 13019     MOVE 'ELCRTO' TO DFHEIV1
 13020*    MOVE '&"IL       EU         (  N#00012221' TO DFHEIV0
 13021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13022     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13023     MOVE X'204E233030303132323231' TO DFHEIV0(25:11)
 13024     CALL 'kxdfhei1' USING DFHEIV0,
 13025           DFHEIV1,
 13026           ORIGINAL-CERTIFICATE,
 13027           DFHEIV11,
 13028           ELCRTO-KEY,
 13029           DFHEIV99,
 13030           DFHEIV99,
 13031           DFHEIV99
 13032     MOVE EIBRESP  TO WS-RESPONSE
 13033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13034        IF RESP-NORMAL
 13035
 13036* EXEC CICS DELETE
 13037*             DATASET   ('ELCRTO')
 13038*          END-EXEC
 13039     MOVE 'ELCRTO' TO DFHEIV1
 13040*    MOVE '&(                    &   #00012229' TO DFHEIV0
 13041     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13043     MOVE X'2020233030303132323239' TO DFHEIV0(25:11)
 13044     CALL 'kxdfhei1' USING DFHEIV0,
 13045           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 238
* EL6311.cbl
 13046           DFHEIV99,
 13047           DFHEIV99,
 13048           DFHEIV99,
 13049           DFHEIV99
 13050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13051        END-IF
 13052     END-IF
 13053******************************************************************
 13054*                                                                *
 13055*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13056*                                                                *
 13057******************************************************************
 13058
 13059* EXEC CICS HANDLE CONDITION
 13060*        NOTFND    (1405-DELETE-CERTIFICATE)
 13061*    END-EXEC.
 13062*    MOVE '"$I                   ! , #00012239' TO DFHEIV0
 13063     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13065     MOVE X'2C20233030303132323339' TO DFHEIV0(25:11)
 13066     CALL 'kxdfhei1' USING DFHEIV0
 13067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13068
 13069
 13070
 13071* EXEC CICS READ
 13072*        EQUAL
 13073*        DATASET   (FILE-ID-ERPNDM)
 13074*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13075*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13076*        UPDATE
 13077*    END-EXEC.
 13078*    MOVE '&"S        EU         (   #00012243' TO DFHEIV0
 13079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13080     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13081     MOVE X'2020233030303132323433' TO DFHEIV0(25:11)
 13082     CALL 'kxdfhei1' USING DFHEIV0,
 13083           FILE-ID-ERPNDM,
 13084           DFHEIV20,
 13085           DFHEIV99,
 13086           PI-PREV-CONTROL-PRIMARY,
 13087           DFHEIV99,
 13088           DFHEIV99,
 13089           DFHEIV99
 13090     SET ADDRESS OF PENDING-MAILING-DATA TO
 13091         DFHEIV20
 13092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13093
 13094
 13095     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13096     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13097     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13098
 13099     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13100
 13101
 13102* EXEC CICS DELETE
 13103*        DATASET   (FILE-ID-ERPNDM)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 239
* EL6311.cbl
 13104*    END-EXEC.
 13105*    MOVE '&(                    &   #00012257' TO DFHEIV0
 13106     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13107     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13108     MOVE X'2020233030303132323537' TO DFHEIV0(25:11)
 13109     CALL 'kxdfhei1' USING DFHEIV0,
 13110           FILE-ID-ERPNDM,
 13111           DFHEIV99,
 13112           DFHEIV99,
 13113           DFHEIV99,
 13114           DFHEIV99
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13116
 13117
 13118******************************************************************
 13119*                PROCESS   CERTIFICATE                           *
 13120******************************************************************
 13121
 13122 1405-DELETE-CERTIFICATE.
 13123
 13124* EXEC CICS HANDLE CONDITION
 13125*         NOTFND  (1420-CONTINUE-DELETE)
 13126*    END-EXEC.
 13127*    MOVE '"$I                   ! - #00012266' TO DFHEIV0
 13128     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13130     MOVE X'2D20233030303132323636' TO DFHEIV0(25:11)
 13131     CALL 'kxdfhei1' USING DFHEIV0
 13132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13133
 13134
 13135     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13136     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13137     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13138     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13139
 13140
 13141* EXEC CICS READ
 13142*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13143*        DATASET (FILE-ID-ELCERT)
 13144*        RIDFLD  (ELCERT-KEY)
 13145*        UPDATE
 13146*    END-EXEC.
 13147*    MOVE '&"S        EU         (   #00012275' TO DFHEIV0
 13148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13149     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13150     MOVE X'2020233030303132323735' TO DFHEIV0(25:11)
 13151     CALL 'kxdfhei1' USING DFHEIV0,
 13152           FILE-ID-ELCERT,
 13153           DFHEIV20,
 13154           DFHEIV99,
 13155           ELCERT-KEY,
 13156           DFHEIV99,
 13157           DFHEIV99,
 13158           DFHEIV99
 13159     SET ADDRESS OF CERTIFICATE-MASTER TO
 13160         DFHEIV20
 13161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 240
* EL6311.cbl
 13162
 13163
 13164     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13165
 13166     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13167     MOVE 'B'                    TO JP-RECORD-TYPE
 13168     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13169
 13170     PERFORM 8400-LOG-JOURNAL-RECORD.
 13171
 13172     IF CERT-NOTES-ARE-NOT-PRESENT
 13173        MOVE ' '                 TO WS-CERT-NOTE-SW
 13174     ELSE
 13175        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13176
 13177     IF INSURED-ADDR-PRESENT
 13178        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13179
 13180******************************************************************
 13181******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13182******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13183******************************************************************
 13184******************************************************************
 13185
 13186     IF CERT-ADDED-BATCH AND
 13187        (NOT NO-CLAIM-ATTACHED
 13188         OR
 13189         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13190        GO TO 1410-REWRITE-CERT.
 13191
 13192******************************************************************
 13193******************************************************************
 13194
 13195     IF CERT-ADDED-BATCH  AND
 13196        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13197        GO TO 1410-REWRITE-CERT.
 13198
 13199     IF NO-CLAIM-ATTACHED
 13200        NEXT SENTENCE
 13201     ELSE
 13202        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13203        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13204        GO TO 1410-REWRITE-CERT.
 13205
 13206     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13207     MOVE 'D'                      TO JP-RECORD-TYPE.
 13208     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13209
 13210
 13211* EXEC CICS DELETE
 13212*         DATASET    (FILE-ID-ELCERT)
 13213*    END-EXEC.
 13214*    MOVE '&(                    &   #00012328' TO DFHEIV0
 13215     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13217     MOVE X'2020233030303132333238' TO DFHEIV0(25:11)
 13218     CALL 'kxdfhei1' USING DFHEIV0,
 13219           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 241
* EL6311.cbl
 13220           DFHEIV99,
 13221           DFHEIV99,
 13222           DFHEIV99,
 13223           DFHEIV99
 13224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13225
 13226
 13227     PERFORM 8400-LOG-JOURNAL-RECORD.
 13228
 13229******************************************************************
 13230*                                                                *
 13231*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13232*                                                                *
 13233******************************************************************
 13234
 13235     IF  CERT-NOTES-ARE-PRESENT
 13236         NEXT SENTENCE
 13237     ELSE
 13238         GO TO 1407-DELETE-MAILING.
 13239
 13240
 13241* EXEC CICS HANDLE CONDITION
 13242*         NOTFND  (1406-DELETE-ERNOTE)
 13243*    END-EXEC.
 13244*    MOVE '"$I                   ! . #00012345' TO DFHEIV0
 13245     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13247     MOVE X'2E20233030303132333435' TO DFHEIV0(25:11)
 13248     CALL 'kxdfhei1' USING DFHEIV0
 13249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13250
 13251
 13252     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13253     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13254     MOVE 0                     TO ERCNOT-SEQUENCE.
 13255
 13256 1406-DELETE-ERCNOT-LOOP.
 13257
 13258
 13259* EXEC CICS READ
 13260*        GTEQ
 13261*        DATASET   (FILE-ID-ERCNOT)
 13262*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13263*        RIDFLD    (ERCNOT-KEY)
 13264*    END-EXEC.
 13265*    MOVE '&"S        G          (   #00012355' TO DFHEIV0
 13266     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13268     MOVE X'2020233030303132333535' TO DFHEIV0(25:11)
 13269     CALL 'kxdfhei1' USING DFHEIV0,
 13270           FILE-ID-ERCNOT,
 13271           DFHEIV20,
 13272           DFHEIV99,
 13273           ERCNOT-KEY,
 13274           DFHEIV99,
 13275           DFHEIV99,
 13276           DFHEIV99
 13277     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 242
* EL6311.cbl
 13278         DFHEIV20
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13280
 13281
 13282     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13283     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13284         GO TO 1406-DELETE-ERNOTE
 13285     END-IF.
 13286
 13287     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13288     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13289     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13290
 13291     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13292
 13293
 13294* EXEC CICS DELETE
 13295*        DATASET   (FILE-ID-ERCNOT)
 13296*        RIDFLD    (ERCNOT-KEY)
 13297*        END-EXEC.
 13298*    MOVE '&(  R                 &   #00012373' TO DFHEIV0
 13299     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13301     MOVE X'2020233030303132333733' TO DFHEIV0(25:11)
 13302     CALL 'kxdfhei1' USING DFHEIV0,
 13303           FILE-ID-ERCNOT,
 13304           ERCNOT-KEY,
 13305           DFHEIV99,
 13306           DFHEIV99,
 13307           DFHEIV99
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13309
 13310
 13311     PERFORM 8400-LOG-JOURNAL-RECORD.
 13312
 13313     GO TO 1406-DELETE-ERCNOT-LOOP.
 13314
 13315 1406-DELETE-ERNOTE.
 13316
 13317
 13318* EXEC CICS HANDLE CONDITION
 13319*         NOTFND  (1407-DELETE-MAILING)
 13320*    END-EXEC.
 13321*    MOVE '"$I                   ! / #00012384' TO DFHEIV0
 13322     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13324     MOVE X'2F20233030303132333834' TO DFHEIV0(25:11)
 13325     CALL 'kxdfhei1' USING DFHEIV0
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13327
 13328
 13329
 13330* EXEC CICS READ
 13331*        EQUAL
 13332*        DATASET   (FILE-ID-ERNOTE)
 13333*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13334*        RIDFLD    (ELCERT-KEY)
 13335*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 243
* EL6311.cbl
 13336*    END-EXEC.
 13337*    MOVE '&"S        EU         (   #00012388' TO DFHEIV0
 13338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13340     MOVE X'2020233030303132333838' TO DFHEIV0(25:11)
 13341     CALL 'kxdfhei1' USING DFHEIV0,
 13342           FILE-ID-ERNOTE,
 13343           DFHEIV20,
 13344           DFHEIV99,
 13345           ELCERT-KEY,
 13346           DFHEIV99,
 13347           DFHEIV99,
 13348           DFHEIV99
 13349     SET ADDRESS OF CERTIFICATE-NOTE TO
 13350         DFHEIV20
 13351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13352
 13353
 13354     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13355     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13356     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13357
 13358     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13359
 13360
 13361* EXEC CICS DELETE
 13362*        DATASET   (FILE-ID-ERNOTE)
 13363*        END-EXEC.
 13364*    MOVE '&(                    &   #00012402' TO DFHEIV0
 13365     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13366     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13367     MOVE X'2020233030303132343032' TO DFHEIV0(25:11)
 13368     CALL 'kxdfhei1' USING DFHEIV0,
 13369           FILE-ID-ERNOTE,
 13370           DFHEIV99,
 13371           DFHEIV99,
 13372           DFHEIV99,
 13373           DFHEIV99
 13374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13375
 13376
 13377     PERFORM 8400-LOG-JOURNAL-RECORD.
 13378
 13379******************************************************************
 13380*                                                                *
 13381*                DELETE MAILING ADDRESS RECORDS                  *
 13382*                                                                *
 13383******************************************************************
 13384
 13385 1407-DELETE-MAILING.
 13386     IF CERT-ADDRESS-PRESENT
 13387        NEXT SENTENCE
 13388     ELSE
 13389        GO TO 1420-CONTINUE-DELETE.
 13390
 13391
 13392* EXEC CICS HANDLE CONDITION
 13393*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 244
* EL6311.cbl
 13394*    END-EXEC.
 13395*    MOVE '"$I                   ! 0 #00012420' TO DFHEIV0
 13396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13398     MOVE X'3020233030303132343230' TO DFHEIV0(25:11)
 13399     CALL 'kxdfhei1' USING DFHEIV0
 13400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13401
 13402
 13403
 13404* EXEC CICS READ
 13405*        EQUAL
 13406*        DATASET   (FILE-ID-ERMAIL)
 13407*        SET       (ADDRESS OF MAILING-DATA)
 13408*        RIDFLD    (ELCERT-KEY)
 13409*        UPDATE
 13410*    END-EXEC.
 13411*    MOVE '&"S        EU         (   #00012424' TO DFHEIV0
 13412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13413     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303132343234' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           FILE-ID-ERMAIL,
 13417           DFHEIV20,
 13418           DFHEIV99,
 13419           ELCERT-KEY,
 13420           DFHEIV99,
 13421           DFHEIV99,
 13422           DFHEIV99
 13423     SET ADDRESS OF MAILING-DATA TO
 13424         DFHEIV20
 13425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13426
 13427
 13428     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13429     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13430     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13431
 13432     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13433
 13434
 13435* EXEC CICS DELETE
 13436*        DATASET   (FILE-ID-ERMAIL)
 13437*    END-EXEC.
 13438*    MOVE '&(                    &   #00012438' TO DFHEIV0
 13439     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13441     MOVE X'2020233030303132343338' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           FILE-ID-ERMAIL,
 13444           DFHEIV99,
 13445           DFHEIV99,
 13446           DFHEIV99,
 13447           DFHEIV99
 13448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13449
 13450
 13451     GO TO 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 245
* EL6311.cbl
 13452
 13453 1410-REWRITE-CERT.
 13454     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13455     MOVE 'C'                      TO JP-RECORD-TYPE.
 13456     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13457     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13458
 13459
 13460* EXEC CICS REWRITE
 13461*         DATASET    (FILE-ID-ELCERT)
 13462*         FROM       (CERTIFICATE-MASTER)
 13463*         END-EXEC.
 13464     MOVE LENGTH OF
 13465      CERTIFICATE-MASTER
 13466       TO DFHEIV11
 13467*    MOVE '&& L                  %   #00012450' TO DFHEIV0
 13468     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13469     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13470     MOVE X'2020233030303132343530' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           FILE-ID-ELCERT,
 13473           CERTIFICATE-MASTER,
 13474           DFHEIV11,
 13475           DFHEIV99
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13477
 13478
 13479     PERFORM 8400-LOG-JOURNAL-RECORD.
 13480
 13481 1420-CONTINUE-DELETE.
 13482     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13483     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13484
 13485     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13486     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13487
 13488     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13489
 13490 1450-DELETE-PB-RECORD.
 13491     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13492     MOVE 'D'                      TO JP-RECORD-TYPE
 13493     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13494
 13495
 13496* EXEC CICS DELETE
 13497*        DATASET    (FILE-ID-ERPNDB)
 13498*    END-EXEC.
 13499*    MOVE '&(                    &   #00012471' TO DFHEIV0
 13500     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13501     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13502     MOVE X'2020233030303132343731' TO DFHEIV0(25:11)
 13503     CALL 'kxdfhei1' USING DFHEIV0,
 13504           FILE-ID-ERPNDB,
 13505           DFHEIV99,
 13506           DFHEIV99,
 13507           DFHEIV99,
 13508           DFHEIV99
 13509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 246
* EL6311.cbl
 13510
 13511
 13512     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13513
 13514     PERFORM 8400-LOG-JOURNAL-RECORD.
 13515
 13516     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13517     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13518     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13519
 13520
 13521* EXEC CICS HANDLE CONDITION
 13522*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13523*    END-EXEC.
 13524*    MOVE '"$I                   ! 1 #00012483' TO DFHEIV0
 13525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13527     MOVE X'3120233030303132343833' TO DFHEIV0(25:11)
 13528     CALL 'kxdfhei1' USING DFHEIV0
 13529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13530
 13531
 13532
 13533* EXEC CICS READ
 13534*        SET     (ADDRESS OF PENDING-BUSINESS)
 13535*        DATASET (FILE-ID-ERPNDB)
 13536*        RIDFLD  (ERPNDB-KEY)
 13537*        UPDATE
 13538*    END-EXEC.
 13539*    MOVE '&"S        EU         (   #00012487' TO DFHEIV0
 13540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13541     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13542     MOVE X'2020233030303132343837' TO DFHEIV0(25:11)
 13543     CALL 'kxdfhei1' USING DFHEIV0,
 13544           FILE-ID-ERPNDB,
 13545           DFHEIV20,
 13546           DFHEIV99,
 13547           ERPNDB-KEY,
 13548           DFHEIV99,
 13549           DFHEIV99,
 13550           DFHEIV99
 13551     SET ADDRESS OF PENDING-BUSINESS TO
 13552         DFHEIV20
 13553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13554
 13555
 13556     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13557
 13558     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13559
 13560     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13561        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13562        MOVE 'D'                   TO JP-RECORD-TYPE
 13563        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13564
 13565* EXEC CICS DELETE
 13566*            DATASET    (FILE-ID-ERPNDB)
 13567*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 247
* EL6311.cbl
 13568*    MOVE '&(                    &   #00012502' TO DFHEIV0
 13569     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13571     MOVE X'2020233030303132353032' TO DFHEIV0(25:11)
 13572     CALL 'kxdfhei1' USING DFHEIV0,
 13573           FILE-ID-ERPNDB,
 13574           DFHEIV99,
 13575           DFHEIV99,
 13576           DFHEIV99,
 13577           DFHEIV99
 13578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13579        PERFORM 8400-LOG-JOURNAL-RECORD
 13580     ELSE
 13581        MOVE 'B'                 TO JP-RECORD-TYPE
 13582        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13583        PERFORM 8400-LOG-JOURNAL-RECORD
 13584        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13585        MOVE 'C'                 TO JP-RECORD-TYPE
 13586        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13587
 13588* EXEC CICS REWRITE
 13589*            DATASET    (FILE-ID-ERPNDB)
 13590*            FROM       (PENDING-BUSINESS)
 13591*       END-EXEC
 13592     MOVE LENGTH OF
 13593      PENDING-BUSINESS
 13594       TO DFHEIV11
 13595*    MOVE '&& L                  %   #00012513' TO DFHEIV0
 13596     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13597     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13598     MOVE X'2020233030303132353133' TO DFHEIV0(25:11)
 13599     CALL 'kxdfhei1' USING DFHEIV0,
 13600           FILE-ID-ERPNDB,
 13601           PENDING-BUSINESS,
 13602           DFHEIV11,
 13603           DFHEIV99
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13605        PERFORM 8400-LOG-JOURNAL-RECORD.
 13606
 13607******************************************************************
 13608*                                                                *
 13609*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13610*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13611*                                                                *
 13612******************************************************************
 13613
 13614     IF NOT PI-AR-PROCESSING
 13615        GO TO 1475-DELETE-FINISHED.
 13616
 13617     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13618        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13619        NEXT SENTENCE
 13620     ELSE
 13621        GO TO 1475-DELETE-FINISHED.
 13622
 13623
 13624* EXEC CICS HANDLE CONDITION
 13625*         NOTFND    (1475-DELETE-FINISHED)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 248
* EL6311.cbl
 13626*         END-EXEC.
 13627*    MOVE '"$I                   ! 2 #00012535' TO DFHEIV0
 13628     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13630     MOVE X'3220233030303132353335' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0
 13632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13633
 13634
 13635     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13636     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13637
 13638
 13639* EXEC CICS READ
 13640*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13641*        DATASET (FILE-ID-ERRQST)
 13642*        RIDFLD  (ERRQST-KEY)
 13643*        UPDATE
 13644*    END-EXEC.
 13645*    MOVE '&"S        EU         (   #00012542' TO DFHEIV0
 13646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13648     MOVE X'2020233030303132353432' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           FILE-ID-ERRQST,
 13651           DFHEIV20,
 13652           DFHEIV99,
 13653           ERRQST-KEY,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99
 13657     SET ADDRESS OF AR-REQUEST-RECORD TO
 13658         DFHEIV20
 13659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13660
 13661
 13662     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13663
 13664     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13665
 13666     MOVE 'D'                      TO JP-RECORD-TYPE.
 13667     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13668
 13669
 13670* EXEC CICS DELETE
 13671*         DATASET    (FILE-ID-ERRQST)
 13672*    END-EXEC.
 13673*    MOVE '&(                    &   #00012556' TO DFHEIV0
 13674     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13675     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13676     MOVE X'2020233030303132353536' TO DFHEIV0(25:11)
 13677     CALL 'kxdfhei1' USING DFHEIV0,
 13678           FILE-ID-ERRQST,
 13679           DFHEIV99,
 13680           DFHEIV99,
 13681           DFHEIV99,
 13682           DFHEIV99
 13683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 249
* EL6311.cbl
 13684
 13685
 13686     PERFORM 8400-LOG-JOURNAL-RECORD.
 13687
 13688 1475-DELETE-FINISHED.
 13689     MOVE ZEROS                  TO EMI-ERROR.
 13690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13691     MOVE LOW-VALUES             TO EL631BI.
 13692     MOVE -1                     TO BMAINTL.
 13693     GO TO 8100-SEND-INITIAL-MAP.
 13694
 13695 1480-BATCH-HDR-NOT-FOUND.
 13696     MOVE -1                     TO BMAINTL.
 13697     MOVE ER-7450                TO EMI-ERROR.
 13698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13699     GO TO 8200-SEND-DATAONLY.
 13700
 13701 1490-RECORD-NOT-FOUND.
 13702     MOVE -1                     TO BMAINTL.
 13703     MOVE ER-7451                TO EMI-ERROR.
 13704     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13705     GO TO 8200-SEND-DATAONLY.
 13706
 13707******************************************************************
 13708*            O V E R   C H A R G E   P R O C E S S I N G         *
 13709******************************************************************
 13710 1500-UPDATE-ERNOTE.
 13711     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13712     MOVE 'A'                    TO WS-NOTE-SW
 13713     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13714     .
 13715 1500-EXIT.
 13716     EXIT.
 13717 1510-ADD-ERNOTE-REC.
 13718
 13719* EXEC CICS GETMAIN
 13720*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13721*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13722*        INITIMG (GETMAIN-SPACE)
 13723*    END-EXEC
 13724*    MOVE ',"IL                  $   #00012592' TO DFHEIV0
 13725     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13727     MOVE X'2020233030303132353932' TO DFHEIV0(25:11)
 13728     CALL 'kxdfhei1' USING DFHEIV0,
 13729           DFHEIV20,
 13730           ERNOTE-RECORD-LENGTH,
 13731           GETMAIN-SPACE
 13732     SET ADDRESS OF CERTIFICATE-NOTE TO
 13733         DFHEIV20
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13735     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13736                                 TO ERNOTE-KEY
 13737
 13738* EXEC CICS READ
 13739*       DATASET    (FILE-ID-ERNOTE)
 13740*       RIDFLD     (ERNOTE-KEY)
 13741*       INTO       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 250
* EL6311.cbl
 13742*       RESP       (WS-RESPONSE)
 13743*       UPDATE
 13744*    END-EXEC
 13745     MOVE LENGTH OF
 13746      CERTIFICATE-NOTE
 13747       TO DFHEIV11
 13748*    MOVE '&"IL       EU         (  N#00012599' TO DFHEIV0
 13749     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13751     MOVE X'204E233030303132353939' TO DFHEIV0(25:11)
 13752     CALL 'kxdfhei1' USING DFHEIV0,
 13753           FILE-ID-ERNOTE,
 13754           CERTIFICATE-NOTE,
 13755           DFHEIV11,
 13756           ERNOTE-KEY,
 13757           DFHEIV99,
 13758           DFHEIV99,
 13759           DFHEIV99
 13760     MOVE EIBRESP  TO WS-RESPONSE
 13761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13762     IF RESP-NORMAL
 13763        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13764           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13765        END-IF
 13766        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13767           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13768        END-IF
 13769        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13770           (N1 > +10)
 13771           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13772           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13773        END-PERFORM
 13774        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13775          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13776
 13777* EXEC CICS UNLOCK
 13778*            DATASET    (FILE-ID-ERNOTE)
 13779*          END-EXEC
 13780*    MOVE '&*                    #   #00012620' TO DFHEIV0
 13781     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303132363230' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           FILE-ID-ERNOTE,
 13786           DFHEIV99
 13787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13788        ELSE
 13789          PERFORM VARYING N1 FROM +1 BY +1
 13790           UNTIL (N1 > +10)
 13791           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13792          END-PERFORM
 13793          IF (N1 < +11)
 13794            IF N1 >= CN-BILLING-START-LINE-NO AND
 13795              N1 <= CN-BILLING-END-LINE-NO
 13796              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13797                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13798              ELSE
 13799                 MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 251
* EL6311.cbl
 13800                                    TO CN-LINE (N1)
 13801              END-IF
 13802            ELSE
 13803              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13804               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13805                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13806                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13807                ELSE
 13808                  MOVE WS-VA-NO-COMM-MESS
 13809                                    TO CN-LINE (N1)
 13810                END-IF
 13811                MOVE N1             TO CN-BILLING-END-LINE-NO
 13812              ELSE
 13813                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13814                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13815                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13816                  ELSE
 13817                     MOVE WS-VA-NO-COMM-MESS
 13818                                    TO CN-LINE (N1)
 13819                  END-IF
 13820                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13821                                      CN-BILLING-START-LINE-NO
 13822                ELSE
 13823                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13824                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13825                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13826                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13827                     ELSE
 13828                       MOVE WS-VA-NO-COMM-MESS
 13829                                    TO CN-LINE (N1)
 13830                     END-IF
 13831                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13832                  ELSE
 13833                     PERFORM 1700-SQUEEZE-IT-IN
 13834                                 THRU 1700-EXIT
 13835                  END-IF
 13836                END-IF
 13837              END-IF
 13838            END-IF
 13839            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13840            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13841            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13842
 13843* EXEC CICS REWRITE
 13844*              DATASET    (FILE-ID-ERNOTE)
 13845*              FROM       (CERTIFICATE-NOTE)
 13846*              RESP       (WS-RESPONSE)
 13847*           END-EXEC
 13848     MOVE LENGTH OF
 13849      CERTIFICATE-NOTE
 13850       TO DFHEIV11
 13851*    MOVE '&& L                  %  N#00012677' TO DFHEIV0
 13852     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13853     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13854     MOVE X'204E233030303132363737' TO DFHEIV0(25:11)
 13855     CALL 'kxdfhei1' USING DFHEIV0,
 13856           FILE-ID-ERNOTE,
 13857           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 252
* EL6311.cbl
 13858           DFHEIV11,
 13859           DFHEIV99
 13860     MOVE EIBRESP  TO WS-RESPONSE
 13861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13862          END-IF
 13863        END-IF
 13864     ELSE
 13865        MOVE SPACES              TO CERTIFICATE-NOTE
 13866        MOVE 'CN'                TO CN-RECORD-ID
 13867        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13868                                 TO CN-CONTROL-PRIMARY
 13869                                    ERNOTE-KEY
 13870        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13871                                    CN-BILLING-END-LINE-NO
 13872        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13873           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13874        ELSE
 13875           MOVE WS-VA-NO-COMM-MESS
 13876                                 TO CN-LINE (1)
 13877        END-IF
 13878        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13879        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13880        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13881
 13882* EXEC CICS WRITE
 13883*          DATASET    (FILE-ID-ERNOTE)
 13884*          FROM       (CERTIFICATE-NOTE)
 13885*          RIDFLD     (ERNOTE-KEY)
 13886*          RESP       (WS-RESPONSE)
 13887*       END-EXEC
 13888     MOVE LENGTH OF
 13889      CERTIFICATE-NOTE
 13890       TO DFHEIV11
 13891*    MOVE '&$ L                  ''  N#00012701' TO DFHEIV0
 13892     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13894     MOVE X'204E233030303132373031' TO DFHEIV0(25:11)
 13895     CALL 'kxdfhei1' USING DFHEIV0,
 13896           FILE-ID-ERNOTE,
 13897           CERTIFICATE-NOTE,
 13898           DFHEIV11,
 13899           ERNOTE-KEY,
 13900           DFHEIV99,
 13901           DFHEIV99
 13902     MOVE EIBRESP  TO WS-RESPONSE
 13903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13904     END-IF
 13905     .
 13906 1510-EXIT.
 13907     EXIT.
 13908 1520-UPDATE-ELCERT.
 13909     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13910                                 TO ELCERT-KEY
 13911
 13912* EXEC CICS READ
 13913*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13914*        DATASET (FILE-ID-ELCERT)
 13915*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 253
* EL6311.cbl
 13916*        UPDATE
 13917*        RESP    (WS-RESPONSE)
 13918*    END-EXEC
 13919*    MOVE '&"S        EU         (  N#00012714' TO DFHEIV0
 13920     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13921     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13922     MOVE X'204E233030303132373134' TO DFHEIV0(25:11)
 13923     CALL 'kxdfhei1' USING DFHEIV0,
 13924           FILE-ID-ELCERT,
 13925           DFHEIV20,
 13926           DFHEIV99,
 13927           ELCERT-KEY,
 13928           DFHEIV99,
 13929           DFHEIV99,
 13930           DFHEIV99
 13931     SET ADDRESS OF CERTIFICATE-MASTER TO
 13932         DFHEIV20
 13933     MOVE EIBRESP  TO WS-RESPONSE
 13934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13935     IF RESP-NORMAL
 13936        IF WS-NOTE-SW = 'A'
 13937           IF CM-NOTE-SW = ' '
 13938              MOVE '2'             TO CM-NOTE-SW
 13939           ELSE
 13940             IF CM-NOTE-SW = '1'
 13941                MOVE '3'           TO CM-NOTE-SW
 13942             ELSE
 13943               IF CM-NOTE-SW = '4'
 13944                  MOVE '6'         TO CM-NOTE-SW
 13945               ELSE
 13946                 IF CM-NOTE-SW = '5'
 13947                    MOVE '7'       TO CM-NOTE-SW
 13948                 END-IF
 13949               END-IF
 13950             END-IF
 13951           END-IF
 13952        ELSE
 13953           IF CM-NOTE-SW = '2'
 13954              MOVE ' '             TO CM-NOTE-SW
 13955           ELSE
 13956             IF CM-NOTE-SW = '3'
 13957                MOVE '1'           TO CM-NOTE-SW
 13958             ELSE
 13959               IF CM-NOTE-SW = '6'
 13960                  MOVE '4'         TO CM-NOTE-SW
 13961               ELSE
 13962                 IF CM-NOTE-SW = '7'
 13963                    MOVE '5'       TO CM-NOTE-SW
 13964                 END-IF
 13965               END-IF
 13966             END-IF
 13967           END-IF
 13968        END-IF
 13969
 13970* EXEC CICS REWRITE
 13971*          DATASET    (FILE-ID-ELCERT)
 13972*          FROM       (CERTIFICATE-MASTER)
 13973*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 254
* EL6311.cbl
 13974*       END-EXEC
 13975     MOVE LENGTH OF
 13976      CERTIFICATE-MASTER
 13977       TO DFHEIV11
 13978*    MOVE '&& L                  %  N#00012755' TO DFHEIV0
 13979     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13980     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13981     MOVE X'204E233030303132373535' TO DFHEIV0(25:11)
 13982     CALL 'kxdfhei1' USING DFHEIV0,
 13983           FILE-ID-ELCERT,
 13984           CERTIFICATE-MASTER,
 13985           DFHEIV11,
 13986           DFHEIV99
 13987     MOVE EIBRESP  TO WS-RESPONSE
 13988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13989        IF RESP-NORMAL
 13990           CONTINUE
 13991        ELSE
 13992           MOVE WS-RESPONSE TO EMI-ERROR
 13993           PERFORM 9900-ERROR-FORMAT
 13994                                 THRU 9900-EXIT
 13995           GO TO 8200-SEND-DATAONLY
 13996        END-IF
 13997     ELSE
 13998        MOVE -1                  TO BMAINTL
 13999        MOVE 0249                TO EMI-ERROR
 14000        PERFORM 9900-ERROR-FORMAT
 14001                                 THRU 9900-EXIT
 14002        GO TO 8200-SEND-DATAONLY
 14003     END-IF
 14004     .
 14005 1520-EXIT.
 14006     EXIT.
 14007 1600-UPDATE-ERPYAJ.
 14008     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14009                                 THRU 1610-EXIT
 14010     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14011                                 THRU 1620-EXIT
 14012     .
 14013 1600-EXIT.
 14014     EXIT.
 14015 1610-ADD-ERPYAJ-BANK-REC.
 14016
 14017* EXEC CICS GETMAIN
 14018*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14019*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14020*        INITIMG (GETMAIN-SPACE)
 14021*    END-EXEC
 14022*    MOVE ',"IL                  $   #00012787' TO DFHEIV0
 14023     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14025     MOVE X'2020233030303132373837' TO DFHEIV0(25:11)
 14026     CALL 'kxdfhei1' USING DFHEIV0,
 14027           DFHEIV20,
 14028           ERPYAJ-RECORD-LENGTH,
 14029           GETMAIN-SPACE
 14030     SET ADDRESS OF PENDING-PAY-ADJ TO
 14031         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 255
* EL6311.cbl
 14032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14033     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14034     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14035     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14036     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14037     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14038     MOVE +10                    TO ERPYAJ-SEQ-NO
 14039     MOVE 'R'                    TO ERPYAJ-TYPE
 14040     IF REVERSAL
 14041        MOVE 'C'                 TO ERPYAJ-TYPE
 14042     END-IF
 14043     MOVE SPACES                 TO PENDING-PAY-ADJ
 14044     MOVE 'PY'                   TO PY-RECORD-ID
 14045     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14046     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14047     IF REVERSAL
 14048        MOVE PB-I-DCC-OVER-CHG-AMT
 14049                                 TO PY-ENTRY-AMT
 14050     END-IF
 14051     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14052                                    PY-INPUT-DT
 14053*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14054*                                   PY-INPUT-DT
 14055     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14056     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14057     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14058     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14059     IF PB-CARRIER = '2'
 14060        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14061     ELSE
 14062        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14063     END-IF
 14064     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14065                                    PY-BILLED-DATE
 14066                                    PY-AR-DATE
 14067                                    PY-REPORTED-DT
 14068                                    PY-CHECK-WRITTEN-DT
 14069     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14070                                    PY-CHECK-QUE-SEQUENCE
 14071     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14072     PERFORM WITH TEST AFTER
 14073        UNTIL (NOT RESP-DUPKEY)
 14074           AND (NOT RESP-DUPREC)
 14075
 14076* EXEC CICS WRITE
 14077*          DATASET    (FILE-ID-ERPYAJ)
 14078*          FROM       (PENDING-PAY-ADJ)
 14079*          RIDFLD     (ERPYAJ-KEY)
 14080*          RESP       (WS-RESPONSE)
 14081*       END-EXEC
 14082     MOVE LENGTH OF
 14083      PENDING-PAY-ADJ
 14084       TO DFHEIV11
 14085*    MOVE '&$ L                  ''  N#00012834' TO DFHEIV0
 14086     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14088     MOVE X'204E233030303132383334' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 256
* EL6311.cbl
 14090           FILE-ID-ERPYAJ,
 14091           PENDING-PAY-ADJ,
 14092           DFHEIV11,
 14093           ERPYAJ-KEY,
 14094           DFHEIV99,
 14095           DFHEIV99
 14096     MOVE EIBRESP  TO WS-RESPONSE
 14097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14098        IF RESP-DUPKEY OR RESP-DUPREC
 14099           ADD +1                TO ERPYAJ-SEQ-NO
 14100           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14101        END-IF
 14102     END-PERFORM
 14103     .
 14104 1610-EXIT.
 14105     EXIT.
 14106 1620-ADD-ERPYAJ-DLR-REC.
 14107     MOVE 'C'                    TO ERPYAJ-TYPE
 14108     IF REVERSAL
 14109        MOVE 'R'                 TO ERPYAJ-TYPE
 14110     END-IF
 14111     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14112                                    ERPYAJ-ACCOUNT
 14113     ADD +1                      TO ERPYAJ-SEQ-NO
 14114     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14115     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14116     IF PB-CARRIER = '2'
 14117        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14118     ELSE
 14119        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14120     END-IF
 14121     PERFORM WITH TEST AFTER
 14122        UNTIL (NOT RESP-DUPKEY)
 14123           AND (NOT RESP-DUPREC)
 14124
 14125* EXEC CICS WRITE
 14126*          DATASET    (FILE-ID-ERPYAJ)
 14127*          FROM       (PENDING-PAY-ADJ)
 14128*          RIDFLD     (ERPYAJ-KEY)
 14129*          RESP       (WS-RESPONSE)
 14130*       END-EXEC
 14131     MOVE LENGTH OF
 14132      PENDING-PAY-ADJ
 14133       TO DFHEIV11
 14134*    MOVE '&$ L                  ''  N#00012866' TO DFHEIV0
 14135     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14136     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14137     MOVE X'204E233030303132383636' TO DFHEIV0(25:11)
 14138     CALL 'kxdfhei1' USING DFHEIV0,
 14139           FILE-ID-ERPYAJ,
 14140           PENDING-PAY-ADJ,
 14141           DFHEIV11,
 14142           ERPYAJ-KEY,
 14143           DFHEIV99,
 14144           DFHEIV99
 14145     MOVE EIBRESP  TO WS-RESPONSE
 14146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14147        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 257
* EL6311.cbl
 14148           ADD +1                TO ERPYAJ-SEQ-NO
 14149           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14150        END-IF
 14151     END-PERFORM
 14152     .
 14153 1620-EXIT.
 14154     EXIT.
 14155 1700-SQUEEZE-IT-IN.
 14156     IF (N1 > CN-BILLING-END-LINE-NO)
 14157        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14158           N1 = +1
 14159           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14160           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14161              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14162                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14163              ELSE
 14164                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14165              END-IF
 14166              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14167              MOVE +2 TO N1
 14168           END-IF
 14169        END-PERFORM
 14170     ELSE
 14171        IF (N1 < CN-BILLING-START-LINE-NO)
 14172           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14173              N1 = +10
 14174              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14175              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14176                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14177                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14178                 ELSE
 14179                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14180                 END-IF
 14181                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14182                 MOVE +9 TO N1
 14183              END-IF
 14184           END-PERFORM
 14185        END-IF
 14186     END-IF
 14187     .
 14188 1700-EXIT.
 14189     EXIT.
 14190 1800-REMOVE-CERT-NOTES.
 14191     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14192                                 TO ERNOTE-KEY
 14193
 14194* EXEC CICS READ
 14195*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14196*       DATASET    (FILE-ID-ERNOTE)
 14197*       RIDFLD     (ERNOTE-KEY)
 14198*       RESP       (WS-RESPONSE)
 14199*       UPDATE
 14200*    END-EXEC
 14201*    MOVE '&"S        EU         (  N#00012918' TO DFHEIV0
 14202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14203     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14204     MOVE X'204E233030303132393138' TO DFHEIV0(25:11)
 14205     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 258
* EL6311.cbl
 14206           FILE-ID-ERNOTE,
 14207           DFHEIV20,
 14208           DFHEIV99,
 14209           ERNOTE-KEY,
 14210           DFHEIV99,
 14211           DFHEIV99,
 14212           DFHEIV99
 14213     SET ADDRESS OF CERTIFICATE-NOTE TO
 14214         DFHEIV20
 14215     MOVE EIBRESP  TO WS-RESPONSE
 14216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14217     IF RESP-NORMAL
 14218        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14219           (N1 > +10)
 14220           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14221           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14222        END-PERFORM
 14223        IF N1 < +11
 14224           MOVE SPACES              TO CN-LINE (N1)
 14225           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14226              N1 <= CN-BILLING-END-LINE-NO
 14227              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14228              IF CN-BILLING-END-LINE-NO <
 14229                               CN-BILLING-START-LINE-NO
 14230                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14231                                     CN-BILLING-START-LINE-NO
 14232              END-IF
 14233              PERFORM 1820-SQUEEZE-ERNOTE
 14234                                  THRU 1820-EXIT
 14235           END-IF
 14236           IF CN-LINES = SPACES
 14237
 14238* EXEC CICS DELETE
 14239*                DATASET    (FILE-ID-ERNOTE)
 14240*                RESP       (WS-RESPONSE)
 14241*             END-EXEC
 14242*    MOVE '&(                    &  N#00012945' TO DFHEIV0
 14243     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14244     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14245     MOVE X'204E233030303132393435' TO DFHEIV0(25:11)
 14246     CALL 'kxdfhei1' USING DFHEIV0,
 14247           FILE-ID-ERNOTE,
 14248           DFHEIV99,
 14249           DFHEIV99,
 14250           DFHEIV99,
 14251           DFHEIV99
 14252     MOVE EIBRESP  TO WS-RESPONSE
 14253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14254              IF RESP-NORMAL
 14255                 MOVE 'D'        TO WS-NOTE-SW
 14256                 PERFORM 1520-UPDATE-ELCERT
 14257                                 THRU 1520-EXIT
 14258              END-IF
 14259           ELSE
 14260
 14261* EXEC CICS REWRITE
 14262*                DATASET    (FILE-ID-ERNOTE)
 14263*                FROM       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 259
* EL6311.cbl
 14264*                RESP       (WS-RESPONSE)
 14265*             END-EXEC
 14266     MOVE LENGTH OF
 14267      CERTIFICATE-NOTE
 14268       TO DFHEIV11
 14269*    MOVE '&& L                  %  N#00012955' TO DFHEIV0
 14270     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14271     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14272     MOVE X'204E233030303132393535' TO DFHEIV0(25:11)
 14273     CALL 'kxdfhei1' USING DFHEIV0,
 14274           FILE-ID-ERNOTE,
 14275           CERTIFICATE-NOTE,
 14276           DFHEIV11,
 14277           DFHEIV99
 14278     MOVE EIBRESP  TO WS-RESPONSE
 14279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14280           END-IF
 14281        END-IF
 14282     END-IF
 14283     .
 14284 1800-EXIT.
 14285     EXIT.
 14286 1820-SQUEEZE-ERNOTE.
 14287     MOVE CN-BILLING-START-LINE-NO TO N2
 14288     IF N2 = 0
 14289         MOVE +1                 TO N2
 14290     END-IF
 14291     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14292        (N1 > +9)
 14293        IF CN-LINE (N1) = SPACES
 14294           MOVE CN-LINE (N1 + +1)
 14295                                 TO CN-LINE (N1)
 14296           MOVE SPACES           TO CN-LINE (N1 + +1)
 14297        END-IF
 14298     END-PERFORM
 14299     .
 14300 1820-EXIT.
 14301     EXIT.
 14302 1900-DELETE-ERPYAJ.
 14303     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14304     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14305     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14306     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14307     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14308     MOVE +10                    TO ERPYAJ-SEQ-NO
 14309     MOVE 'R'                    TO ERPYAJ-TYPE
 14310     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14311
 14312* EXEC CICS STARTBR
 14313*       DATASET    (FILE-ID-ERPYAJ)
 14314*       RIDFLD     (ERPYAJ-KEY)
 14315*       RESP       (WS-RESPONSE)
 14316*    END-EXEC
 14317     MOVE 0
 14318       TO DFHEIV11
 14319*    MOVE '&,         G          &  N#00012991' TO DFHEIV0
 14320     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14321     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 260
* EL6311.cbl
 14322     MOVE X'204E233030303132393931' TO DFHEIV0(25:11)
 14323     CALL 'kxdfhei1' USING DFHEIV0,
 14324           FILE-ID-ERPYAJ,
 14325           ERPYAJ-KEY,
 14326           DFHEIV99,
 14327           DFHEIV11,
 14328           DFHEIV99
 14329     MOVE EIBRESP  TO WS-RESPONSE
 14330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14331     IF RESP-NORMAL
 14332        CONTINUE
 14333     ELSE
 14334        GO TO 1900-GET-DEALER
 14335     END-IF
 14336     .
 14337 1900-READNEXT-ERPYAJ-B.
 14338*  GET THE BANK ERPYAJ RECORD
 14339
 14340* EXEC CICS READNEXT
 14341*       DATASET    (FILE-ID-ERPYAJ)
 14342*       RIDFLD     (ERPYAJ-KEY)
 14343*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14344*       RESP       (WS-RESPONSE)
 14345*    END-EXEC
 14346     MOVE 0
 14347       TO DFHEIV11
 14348*    MOVE '&.S                   )  N#00013004' TO DFHEIV0
 14349     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14350     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14351     MOVE X'204E233030303133303034' TO DFHEIV0(25:11)
 14352     CALL 'kxdfhei1' USING DFHEIV0,
 14353           FILE-ID-ERPYAJ,
 14354           DFHEIV20,
 14355           DFHEIV99,
 14356           ERPYAJ-KEY,
 14357           DFHEIV99,
 14358           DFHEIV11,
 14359           DFHEIV99,
 14360           DFHEIV99
 14361     SET ADDRESS OF PENDING-PAY-ADJ TO
 14362         DFHEIV20
 14363     MOVE EIBRESP  TO WS-RESPONSE
 14364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14365     IF RESP-NORMAL
 14366        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14367           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14368              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14369                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14370
 14371* EXEC CICS READ
 14372*                   DATASET    (FILE-ID-ERPYAJ)
 14373*                   RIDFLD     (ERPYAJ-KEY)
 14374*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14375*                   RESP       (WS-RESPONSE)
 14376*                   UPDATE
 14377*                END-EXEC
 14378*    MOVE '&"S        EU         (  N#00013015' TO DFHEIV0
 14379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 261
* EL6311.cbl
 14380     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14381     MOVE X'204E233030303133303135' TO DFHEIV0(25:11)
 14382     CALL 'kxdfhei1' USING DFHEIV0,
 14383           FILE-ID-ERPYAJ,
 14384           DFHEIV20,
 14385           DFHEIV99,
 14386           ERPYAJ-KEY,
 14387           DFHEIV99,
 14388           DFHEIV99,
 14389           DFHEIV99
 14390     SET ADDRESS OF PENDING-PAY-ADJ TO
 14391         DFHEIV20
 14392     MOVE EIBRESP  TO WS-RESPONSE
 14393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14394                 IF RESP-NORMAL
 14395
 14396* EXEC CICS DELETE
 14397*                      DATASET   (FILE-ID-ERPYAJ)
 14398*                      RESP      (WS-RESPONSE)
 14399*                   END-EXEC
 14400*    MOVE '&(                    &  N#00013023' TO DFHEIV0
 14401     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14402     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14403     MOVE X'204E233030303133303233' TO DFHEIV0(25:11)
 14404     CALL 'kxdfhei1' USING DFHEIV0,
 14405           FILE-ID-ERPYAJ,
 14406           DFHEIV99,
 14407           DFHEIV99,
 14408           DFHEIV99,
 14409           DFHEIV99
 14410     MOVE EIBRESP  TO WS-RESPONSE
 14411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14412                 END-IF
 14413              ELSE
 14414                 SET REVERSAL    TO TRUE
 14415                 PERFORM 1600-UPDATE-ERPYAJ
 14416                                 THRU 1600-EXIT
 14417                 GO TO 1900-EXIT
 14418              END-IF
 14419           ELSE
 14420              GO TO 1900-READNEXT-ERPYAJ-B
 14421           END-IF
 14422        END-IF
 14423
 14424* EXEC CICS ENDBR
 14425*          DATASET   (FILE-ID-ERPYAJ)
 14426*       END-EXEC
 14427     MOVE 0
 14428       TO DFHEIV11
 14429*    MOVE '&2                    $   #00013038' TO DFHEIV0
 14430     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14431     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14432     MOVE X'2020233030303133303338' TO DFHEIV0(25:11)
 14433     CALL 'kxdfhei1' USING DFHEIV0,
 14434           FILE-ID-ERPYAJ,
 14435           DFHEIV11,
 14436           DFHEIV99
 14437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 262
* EL6311.cbl
 14438     END-IF
 14439     .
 14440 1900-GET-DEALER.
 14441     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14442     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14443     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14444     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14445     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14446     MOVE +10                    TO ERPYAJ-SEQ-NO
 14447     MOVE 'C'                    TO ERPYAJ-TYPE
 14448     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14449
 14450* EXEC CICS STARTBR
 14451*       DATASET    (FILE-ID-ERPYAJ)
 14452*       RIDFLD     (ERPYAJ-KEY)
 14453*       RESP       (WS-RESPONSE)
 14454*    END-EXEC
 14455     MOVE 0
 14456       TO DFHEIV11
 14457*    MOVE '&,         G          &  N#00013052' TO DFHEIV0
 14458     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14460     MOVE X'204E233030303133303532' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           FILE-ID-ERPYAJ,
 14463           ERPYAJ-KEY,
 14464           DFHEIV99,
 14465           DFHEIV11,
 14466           DFHEIV99
 14467     MOVE EIBRESP  TO WS-RESPONSE
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14469     IF RESP-NORMAL
 14470        CONTINUE
 14471     ELSE
 14472        GO TO 1900-EXIT
 14473     END-IF
 14474     .
 14475 1900-READNEXT-ERPYAJ-D.
 14476*  GET THE DEALER ERPYAJ RECORD
 14477
 14478* EXEC CICS READNEXT
 14479*       DATASET    (FILE-ID-ERPYAJ)
 14480*       RIDFLD     (ERPYAJ-KEY)
 14481*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14482*       RESP       (WS-RESPONSE)
 14483*    END-EXEC
 14484     MOVE 0
 14485       TO DFHEIV11
 14486*    MOVE '&.S                   )  N#00013065' TO DFHEIV0
 14487     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14488     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14489     MOVE X'204E233030303133303635' TO DFHEIV0(25:11)
 14490     CALL 'kxdfhei1' USING DFHEIV0,
 14491           FILE-ID-ERPYAJ,
 14492           DFHEIV20,
 14493           DFHEIV99,
 14494           ERPYAJ-KEY,
 14495           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 263
* EL6311.cbl
 14496           DFHEIV11,
 14497           DFHEIV99,
 14498           DFHEIV99
 14499     SET ADDRESS OF PENDING-PAY-ADJ TO
 14500         DFHEIV20
 14501     MOVE EIBRESP  TO WS-RESPONSE
 14502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14503     IF RESP-NORMAL
 14504        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14505           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14506              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14507                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14508
 14509* EXEC CICS READ
 14510*                   DATASET    (FILE-ID-ERPYAJ)
 14511*                   RIDFLD     (ERPYAJ-KEY)
 14512*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14513*                   RESP       (WS-RESPONSE)
 14514*                   UPDATE
 14515*                END-EXEC
 14516*    MOVE '&"S        EU         (  N#00013076' TO DFHEIV0
 14517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14518     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14519     MOVE X'204E233030303133303736' TO DFHEIV0(25:11)
 14520     CALL 'kxdfhei1' USING DFHEIV0,
 14521           FILE-ID-ERPYAJ,
 14522           DFHEIV20,
 14523           DFHEIV99,
 14524           ERPYAJ-KEY,
 14525           DFHEIV99,
 14526           DFHEIV99,
 14527           DFHEIV99
 14528     SET ADDRESS OF PENDING-PAY-ADJ TO
 14529         DFHEIV20
 14530     MOVE EIBRESP  TO WS-RESPONSE
 14531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14532                 IF RESP-NORMAL
 14533
 14534* EXEC CICS DELETE
 14535*                      DATASET   (FILE-ID-ERPYAJ)
 14536*                      RESP      (WS-RESPONSE)
 14537*                   END-EXEC
 14538*    MOVE '&(                    &  N#00013084' TO DFHEIV0
 14539     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14540     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14541     MOVE X'204E233030303133303834' TO DFHEIV0(25:11)
 14542     CALL 'kxdfhei1' USING DFHEIV0,
 14543           FILE-ID-ERPYAJ,
 14544           DFHEIV99,
 14545           DFHEIV99,
 14546           DFHEIV99,
 14547           DFHEIV99
 14548     MOVE EIBRESP  TO WS-RESPONSE
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14550                 END-IF
 14551              ELSE
 14552                 SET REVERSAL    TO TRUE
 14553              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 264
* EL6311.cbl
 14554           ELSE
 14555              GO TO 1900-READNEXT-ERPYAJ-D
 14556           END-IF
 14557        END-IF
 14558
 14559* EXEC CICS ENDBR
 14560*          DATASET   (FILE-ID-ERPYAJ)
 14561*       END-EXEC
 14562     MOVE 0
 14563       TO DFHEIV11
 14564*    MOVE '&2                    $   #00013096' TO DFHEIV0
 14565     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14566     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14567     MOVE X'2020233030303133303936' TO DFHEIV0(25:11)
 14568     CALL 'kxdfhei1' USING DFHEIV0,
 14569           FILE-ID-ERPYAJ,
 14570           DFHEIV11,
 14571           DFHEIV99
 14572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14573     END-IF
 14574     .
 14575 1900-EXIT.
 14576     EXIT.
 14577******************************************************************
 14578*            C A N C E L   M A I N L I N E                       *
 14579******************************************************************
 14580
 14581 2000-CANCEL-MAINLINE.
 14582     IF PI-DISPLAY-ORIGINAL-BATCH
 14583        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14584           MOVE ER-0023             TO EMI-ERROR
 14585           MOVE -1                  TO CMAINTL
 14586           MOVE AL-UABON            TO CMAINTA
 14587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14588           GO TO 8200-SEND-DATAONLY
 14589        ELSE
 14590           NEXT SENTENCE
 14591     ELSE
 14592        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14593           MOVE ER-0023             TO EMI-ERROR
 14594           MOVE -1                  TO CMAINTL
 14595           MOVE AL-UABON            TO CMAINTA
 14596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14597           GO TO 8200-SEND-DATAONLY.
 14598
 14599     IF CMAINTI = 'S'
 14600        GO TO 2100-SHOW-REQUEST.
 14601
 14602     IF NOT MODIFY-CAP
 14603         MOVE 'UPDATE'       TO SM-READ
 14604         PERFORM 9995-SECURITY-VIOLATION
 14605         MOVE ER-0070        TO EMI-ERROR
 14606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14607         GO TO 8100-SEND-INITIAL-MAP.
 14608
 14609     IF CMAINTL GREATER THAN ZEROS
 14610        IF PI-PF6-FUNCTION
 14611           IF CMAINTI NOT = 'A'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 265
* EL6311.cbl
 14612              MOVE AL-UABON  TO CMAINTA
 14613              MOVE -1        TO CMAINTL
 14614              MOVE ER-2260   TO EMI-ERROR
 14615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14616              GO TO 8200-SEND-DATAONLY.
 14617
 14618     IF CCERTNOL = ZEROS
 14619       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14620         NEXT SENTENCE
 14621     ELSE
 14622         IF CCERTNOL NOT = ZEROS
 14623             MOVE AL-UANON       TO CCERTNOA
 14624         ELSE
 14625             MOVE -1             TO CCERTNOL
 14626             MOVE  1             TO SET-CURSOR-SW
 14627             MOVE ER-2218       TO EMI-ERROR
 14628             MOVE AL-UABON       TO CCERTNOA
 14629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14630
 14631     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14632        NEXT SENTENCE
 14633     ELSE
 14634        IF CEFFDTL NOT = ZEROS
 14635           MOVE AL-UNNON         TO CEFFDTA
 14636           MOVE CEFFDTI TO DEEDIT-FIELD
 14637           PERFORM 8600-DEEDIT
 14638           MOVE 4                TO DC-OPTION-CODE
 14639           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14640           PERFORM 9700-DATE-LINK
 14641           IF NO-CONVERSION-ERROR
 14642              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14643              ELSE
 14644              MOVE -1            TO CEFFDTL
 14645              MOVE  1            TO SET-CURSOR-SW
 14646              MOVE ER-2226      TO EMI-ERROR
 14647              MOVE AL-UNBON      TO CEFFDTA
 14648              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14649          ELSE
 14650          MOVE -1                 TO CEFFDTL
 14651          MOVE  1                 TO SET-CURSOR-SW
 14652          MOVE ER-2220            TO EMI-ERROR
 14653          MOVE AL-UNBON           TO CEFFDTA
 14654          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14655
 14656     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14657
 14658     IF CCERTNOL NOT = ZEROS
 14659        MOVE CCERTNOI                TO WS-NEW-PRIME
 14660     ELSE
 14661        MOVE SPACES                  TO WS-NEW-PRIME.
 14662
 14663     IF CSUFIXL NOT = ZEROS
 14664        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14665     ELSE
 14666        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14667
 14668     IF CEFFDTL NOT = ZEROS
 14669        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 266
* EL6311.cbl
 14670     ELSE
 14671        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14672
 14673     IF CMAINTI = 'A' OR 'K' OR 'S'
 14674        NEXT SENTENCE
 14675     ELSE
 14676        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14677        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14678           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14679           WS-PB-RECORD-TYPE NOT = '2'
 14680           IF CMAINTI = 'C'
 14681              MOVE ER-2287          TO EMI-ERROR
 14682              MOVE -1               TO CCERTNOL
 14683              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14685              GO TO 8200-SEND-DATAONLY
 14686             ELSE
 14687              MOVE ER-2260          TO EMI-ERROR
 14688              MOVE -1               TO CCERTNOL
 14689              MOVE AL-UABON         TO CCERTNOA
 14690              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14691              GO TO 8200-SEND-DATAONLY.
 14692
 14693     IF CMAINTI = 'D'
 14694        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14695
 14696     IF CLSTNML GREATER THAN ZEROS
 14697         MOVE AL-UANON           TO CLSTNMA.
 14698
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 267
* EL6311.cbl
 14700
 14701******************************************************************
 14702*                                                                *
 14703*           E D I T   C A N C E L   C O V E R A G E S            *
 14704*                                                                *
 14705******************************************************************
 14706
 14707 2015-EDIT-COVERAGES.
 14708     IF CCANDT1L      GREATER THAN ZEROS OR
 14709        CREFND1L      GREATER THAN ZEROS OR
 14710        CCANDT2L      GREATER THAN ZEROS OR
 14711        CREFND2L      GREATER THAN ZEROS OR
 14712        CMTHD1L       GREATER THAN ZEROS OR
 14713        CMTHD2L       GREATER THAN ZEROS OR
 14714        CLIVESL       GREATER THAN ZEROS OR
 14715        CPAYEEL       GREATER THAN ZEROS OR
 14716        CFORCEL       GREATER THAN ZEROS OR
 14717        CBILCDL       GREATER THAN ZEROS OR
 14718        CCANREAL      GREATER THAN ZEROS
 14719            NEXT SENTENCE
 14720         ELSE
 14721            GO TO 2030-EDIT-COMPLETE.
 14722
 14723     IF CCANDT1L = ZEROS
 14724        AND (CMAINTI = 'C' OR 'K')
 14725        NEXT SENTENCE
 14726     ELSE
 14727        IF CCANDT1L      GREATER THAN ZEROS
 14728            MOVE AL-UNNON            TO CCANDT1A
 14729            IF CCANDT1I = SPACES
 14730               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14731            ELSE
 14732               MOVE CCANDT1I            TO DEEDIT-FIELD
 14733               PERFORM 8600-DEEDIT
 14734               IF DEEDIT-FIELD-V0   NUMERIC
 14735                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14736                  MOVE 4                TO DC-OPTION-CODE
 14737                  PERFORM 9700-DATE-LINK
 14738                  IF NO-CONVERSION-ERROR
 14739                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14740                  ELSE
 14741                      MOVE -1        TO CCANDT1L
 14742                      MOVE ER-2227   TO EMI-ERROR
 14743                      MOVE AL-UNBON  TO CCANDT1A
 14744                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14745               ELSE
 14746                  MOVE -1         TO CCANDT1L
 14747                  MOVE ER-2223    TO EMI-ERROR
 14748                  MOVE AL-UNBON   TO CCANDT1A
 14749                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14750        ELSE
 14751            IF CREFND1L GREATER THAN ZEROS
 14752               MOVE -1             TO CCANDT1L
 14753               MOVE ER-2222        TO EMI-ERROR
 14754               MOVE AL-UNBOF       TO CCANDT1A
 14755               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14756
 14757     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 268
* EL6311.cbl
 14758        AND (CMAINTI = 'C' OR 'K')
 14759         NEXT SENTENCE
 14760     ELSE
 14761         IF CREFND1L NOT = ZEROS
 14762            MOVE AL-UNNON        TO CREFND1A
 14763
 14764* EXEC CICS BIF DEEDIT
 14765*               FIELD  (CREFND1I)
 14766*               LENGTH (11)
 14767*           END-EXEC
 14768     MOVE 11
 14769       TO DFHEIV11
 14770*    MOVE '@"L                   #   #00013289' TO DFHEIV0
 14771     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14772     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14773     MOVE X'2020233030303133323839' TO DFHEIV0(25:11)
 14774     CALL 'kxdfhei1' USING DFHEIV0,
 14775           CREFND1I,
 14776           DFHEIV11
 14777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14778            MOVE CREFND1I        TO WS-CREFND1
 14779*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14780*           PERFORM 8600-DEEDIT
 14781*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14782            IF WS-CREFND1  = ZEROS
 14783               AND CMAINTI = 'A'
 14784             MOVE ER-2437        TO EMI-ERROR
 14785             MOVE -1             TO CREFND1L
 14786             MOVE AL-UNBON       TO CREFND1A
 14787             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14788
 14789     IF CCANREAL > +0
 14790        MOVE AL-UANON            TO CCANREAA
 14791        IF CCANREAI = 'R' OR ' '
 14792           CONTINUE
 14793        ELSE
 14794           MOVE ER-9841        TO EMI-ERROR
 14795           MOVE -1             TO CCANREAL
 14796           MOVE AL-UABON       TO CCANREAA
 14797           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14798        END-IF
 14799     END-IF
 14800     IF CMTHD1L EQUAL +0
 14801        NEXT SENTENCE
 14802     ELSE
 14803        IF CMTHD1L NOT = +0
 14804           MOVE AL-UNNON        TO CMTHD1A
 14805           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14806                         OR '5' OR '6' OR '8' OR '9'
 14807                         OR 'R' OR ' '
 14808              NEXT SENTENCE
 14809           ELSE
 14810              MOVE ER-0582        TO EMI-ERROR
 14811              MOVE -1             TO CMTHD1L
 14812              MOVE AL-UNBON       TO CMTHD1A
 14813              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14814
 14815     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 269
* EL6311.cbl
 14816        AND (CMAINTI = 'C' OR 'K')
 14817         NEXT SENTENCE
 14818     ELSE
 14819         IF CCANDT2L  GREATER THAN ZEROS
 14820             MOVE AL-UNNON       TO CCANDT2A
 14821             IF CCANDT2I = SPACES
 14822                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14823             ELSE
 14824                MOVE CCANDT2I       TO DEEDIT-FIELD
 14825                PERFORM 8600-DEEDIT
 14826                IF DEEDIT-FIELD-V0   NUMERIC
 14827                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14828                   MOVE 4                TO DC-OPTION-CODE
 14829                   PERFORM 9700-DATE-LINK
 14830                   IF NO-CONVERSION-ERROR
 14831                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14832                   ELSE
 14833                      MOVE -1       TO CCANDT2L
 14834                      MOVE ER-2227  TO EMI-ERROR
 14835                      MOVE AL-UNBON TO CCANDT2A
 14836                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14837                ELSE
 14838                   MOVE -1         TO CCANDT2L
 14839                   MOVE ER-2223    TO EMI-ERROR
 14840                   MOVE AL-UNBON   TO CCANDT2A
 14841                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14842         ELSE
 14843            IF CREFND2L GREATER THAN ZEROS
 14844               MOVE -1             TO CCANDT2L
 14845               MOVE ER-2222        TO EMI-ERROR
 14846               MOVE AL-UNBOF       TO CCANDT2A
 14847               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14848
 14849     IF CREFND2L = ZEROS
 14850        AND (CMAINTI = 'C' OR 'K')
 14851         NEXT SENTENCE
 14852     ELSE
 14853         IF CREFND2L NOT = ZEROS
 14854            MOVE AL-UNNON        TO CREFND2A
 14855
 14856* EXEC CICS BIF DEEDIT
 14857*               FIELD  (CREFND2I)
 14858*               LENGTH (11)
 14859*           END-EXEC
 14860     MOVE 11
 14861       TO DFHEIV11
 14862*    MOVE '@"L                   #   #00013370' TO DFHEIV0
 14863     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14864     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14865     MOVE X'2020233030303133333730' TO DFHEIV0(25:11)
 14866     CALL 'kxdfhei1' USING DFHEIV0,
 14867           CREFND2I,
 14868           DFHEIV11
 14869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14870            MOVE CREFND2I        TO WS-CREFND2
 14871*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14872*           PERFORM 8600-DEEDIT
 14873*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 270
* EL6311.cbl
 14874            IF WS-CREFND2  = ZEROS
 14875               AND CMAINTI = 'A'
 14876             MOVE ER-2437        TO EMI-ERROR
 14877             MOVE -1             TO CREFND2L
 14878             MOVE AL-UNBON       TO CREFND2A
 14879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14880
 14881     IF CMTHD2L EQUAL +0
 14882        NEXT SENTENCE
 14883     ELSE
 14884        IF CMTHD2L NOT = +0
 14885           MOVE AL-UNNON        TO CMTHD2A
 14886           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14887                         OR '5' OR '6' OR '8' OR '9'
 14888                         OR ' ' OR 'R'
 14889              NEXT SENTENCE
 14890           ELSE
 14891              MOVE ER-0582        TO EMI-ERROR
 14892              MOVE -1             TO CMTHD2L
 14893              MOVE AL-UNBON       TO CMTHD2A
 14894              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14895
 14896     IF CLIVESL GREATER THAN ZEROS
 14897         MOVE CLIVESI            TO DEEDIT-FIELD
 14898         PERFORM 8600-DEEDIT
 14899         IF DEEDIT-FIELD-V0 NUMERIC
 14900             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14901             MOVE AL-UNNON       TO CLIVESA
 14902         ELSE
 14903             MOVE -1             TO CLIVESL
 14904             MOVE AL-UNBON       TO CLIVESA
 14905             MOVE ER-2223        TO EMI-ERROR
 14906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14907
 14908     IF CFORCEL  NOT = ZEROS
 14909         IF FORCE-CAP
 14910            MOVE AL-UANON            TO CFORCEA
 14911         ELSE
 14912            MOVE ER-2945             TO EMI-ERROR
 14913            MOVE AL-UABON            TO CFORCEA
 14914            MOVE -1                  TO CFORCEL
 14915            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14916
 14917     IF CPAYEEL GREATER THAN ZEROS
 14918        MOVE AL-UANON            TO CPAYEEA.
 14919
 14920     IF CBILCDL NOT = ZEROS
 14921        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14922                             AND 'A' AND 'B' AND 'E'
 14923           MOVE ER-2225              TO EMI-ERROR
 14924           MOVE AL-UABON             TO CBILCDA
 14925           MOVE -1                   TO CBILCDL
 14926           MOVE  1                   TO SET-CURSOR-SW
 14927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14928        ELSE
 14929           MOVE AL-UANON             TO CBILCDA.
 14930
 14931 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 271
* EL6311.cbl
 14932     IF EMI-ERROR = ZEROS
 14933         NEXT SENTENCE
 14934     ELSE
 14935         GO TO 8200-SEND-DATAONLY.
 14936
 14937     IF CMAINTI = 'A'
 14938        GO TO 2200-ADD-CANCEL-ROUTINE.
 14939
 14940     IF CMAINTI = 'C'
 14941        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14942
 14943     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14944
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 272
* EL6311.cbl
 14946
 14947******************************************************************
 14948*                                                                *
 14949*                   S H O W   C A N C E L                        *
 14950*                                                                *
 14951******************************************************************
 14952
 14953 2100-SHOW-REQUEST.
 14954     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14955
 14956     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14957        MOVE -1                  TO CMAINTL
 14958        GO TO 8200-SEND-DATAONLY.
 14959
 14960     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14961
 14962     IF CSUFIXL NOT = ZEROS
 14963        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14964       ELSE
 14965        MOVE SPACE            TO WS-NEW-SUFFIX.
 14966
 14967     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14968     PERFORM 8600-DEEDIT.
 14969     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14970     MOVE '4'                    TO DC-OPTION-CODE.
 14971     PERFORM 9700-DATE-LINK.
 14972     IF DATE-CONVERSION-ERROR
 14973        MOVE ER-0348             TO EMI-ERROR
 14974        MOVE -1                  TO CEFFDTL
 14975        MOVE AL-UABON            TO CEFFDTA
 14976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14977        GO TO 8200-SEND-DATAONLY
 14978     ELSE
 14979        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14980        MOVE AL-UANON            TO CEFFDTA
 14981        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14982
 14983     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14984
 14985     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14986        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14987        MOVE 'Y'                    TO WS-SHOW-SW
 14988        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14989           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14990        ELSE
 14991           IF PI-FILE-BROWSE
 14992              GO TO 4300-BROWSE-FILE-FORWARD
 14993           ELSE
 14994              IF PI-CSR-BROWSE
 14995                 GO TO 4200-BROWSE-CSR-FORWARD
 14996              ELSE
 14997                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14998     ELSE
 14999        GO TO 3900-RE-DISPLAY-RECORD.
 15000
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 273
* EL6311.cbl
 15002
 15003
 15004******************************************************************
 15005*                                                                *
 15006*            A D D   C A N C E L   R O U T I N E                 *
 15007*                                                                *
 15008******************************************************************
 15009
 15010 2200-ADD-CANCEL-ROUTINE.
 15011     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15012
 15013
 15014* EXEC CICS GETMAIN
 15015*        SET     (ADDRESS OF PENDING-BUSINESS)
 15016*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15017*    END-EXEC.
 15018*    MOVE '," L                  $   #00013517' TO DFHEIV0
 15019     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15020     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15021     MOVE X'2020233030303133353137' TO DFHEIV0(25:11)
 15022     CALL 'kxdfhei1' USING DFHEIV0,
 15023           DFHEIV20,
 15024           ERPNDB-RECORD-LENGTH,
 15025           DFHEIV99
 15026     SET ADDRESS OF PENDING-BUSINESS TO
 15027         DFHEIV20
 15028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15029
 15030
 15031
 15032* EXEC CICS HANDLE CONDITION
 15033*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15034*    END-EXEC.
 15035*    MOVE '"$I                   ! 3 #00013522' TO DFHEIV0
 15036     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15038     MOVE X'3320233030303133353232' TO DFHEIV0(25:11)
 15039     CALL 'kxdfhei1' USING DFHEIV0
 15040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15041
 15042
 15043     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15044     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15045     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15046
 15047
 15048* EXEC CICS READ
 15049*        INTO    (PENDING-BUSINESS)
 15050*        DATASET (FILE-ID-ERPNDB)
 15051*        RIDFLD  (ERPNDB-KEY)
 15052*    END-EXEC.
 15053     MOVE LENGTH OF
 15054      PENDING-BUSINESS
 15055       TO DFHEIV11
 15056*    MOVE '&"IL       E          (   #00013530' TO DFHEIV0
 15057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15059     MOVE X'2020233030303133353330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 274
* EL6311.cbl
 15060     CALL 'kxdfhei1' USING DFHEIV0,
 15061           FILE-ID-ERPNDB,
 15062           PENDING-BUSINESS,
 15063           DFHEIV11,
 15064           ERPNDB-KEY,
 15065           DFHEIV99,
 15066           DFHEIV99,
 15067           DFHEIV99
 15068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15069
 15070
 15071     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15072
 15073     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15074     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15075     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15076     MOVE SPACES                 TO PENDING-BUSINESS.
 15077     MOVE 'PB'                   TO PB-RECORD-ID.
 15078     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15079     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15080     MOVE SPACES                 TO PB-CERT-SFX.
 15081     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15082     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15083                                    PB-ALT-CHG-SEQ-NO.
 15084
 15085     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15086     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15087     MOVE '2'                    TO PB-RECORD-TYPE.
 15088
 15089     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15090     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15091
 15092
 15093     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15094                                    PB-ALT-CHG-SEQ-NO
 15095                                    PB-C-LF-REF-CALC
 15096                                    PB-C-AH-REF-CALC
 15097                                    PB-C-LF-RFND-CLP
 15098                                    PB-C-AH-RFND-CLP
 15099                                    PB-CI-INSURED-AGE
 15100                                    PB-CI-LF-TERM
 15101                                    PB-CI-AH-TERM
 15102                                    PB-CI-LF-BENEFIT-CD
 15103                                    PB-CI-LF-BENEFIT-AMT
 15104                                    PB-CI-LF-ALT-BENEFIT-AMT
 15105                                    PB-CI-LF-PREMIUM-AMT
 15106                                    PB-CI-LF-ALT-PREMIUM-AMT
 15107                                    PB-CI-AH-BENEFIT-CD
 15108                                    PB-CI-AH-BENEFIT-AMT
 15109                                    PB-CI-AH-PREMIUM-AMT
 15110                                    PB-CI-PAY-FREQUENCY
 15111                                    PB-CI-LOAN-APR
 15112                                    PB-CI-LOAN-TERM
 15113                                    PB-CI-LIFE-COMMISSION
 15114                                    PB-CI-AH-COMMISSION
 15115                                    PB-CI-CURR-SEQ
 15116                                    PB-CI-AH-CANCEL-AMT
 15117                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 275
* EL6311.cbl
 15118                                    PB-CI-RATE-DEV-PCT-LF
 15119                                    PB-CI-RATE-DEV-PCT-AH
 15120                                    PB-CI-EXTENTION-DAYS
 15121                                    PB-CI-TERM-IN-DAYS
 15122                                    PB-CI-LIVES
 15123                                    PB-CI-LF-CRIT-PER
 15124                                    PB-CI-AH-CRIT-PER
 15125                                    PB-C-LF-REM-TERM
 15126                                    PB-C-AH-REM-TERM
 15127                                    PB-CHG-COUNT
 15128                                    PB-LF-BILLED-AMTS
 15129                                    PB-AH-BILLED-AMTS
 15130                                    PB-C-INT-ON-REFS
 15131*                                   PB-C-MICROFILM-NO
 15132                                    PB-CALC-TOLERANCE.
 15133
 15134     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15135                                    PB-CI-AH-SETTLEMENT-DT
 15136                                    PB-CI-DEATH-DT
 15137                                    PB-CI-LF-PRIOR-CANCEL-DT
 15138                                    PB-CI-AH-PRIOR-CANCEL-DT
 15139                                    PB-CI-ENTRY-DT
 15140                                    PB-CI-LF-EXPIRE-DT
 15141                                    PB-CI-AH-EXPIRE-DT
 15142                                    PB-CI-LOAN-1ST-PMT-DT
 15143                                    PB-C-LF-CANCEL-DT
 15144                                    PB-C-AH-CANCEL-DT
 15145                                    PB-CREDIT-ACCEPT-DT
 15146                                    PB-BILLED-DT
 15147                                    PB-ACCT-EFF-DT
 15148                                    PB-ACCT-EXP-DT.
 15149
 15150     MOVE 'X'                    TO PB-FATAL-FLAG.
 15151
 15152     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15153
 15154     IF CSUFIXL     GREATER THAN ZEROS
 15155        MOVE CSUFIXI             TO PB-CERT-SFX.
 15156
 15157*    IF CMICRNOL  GREATER  ZEROS
 15158*        IF CMICRNOI  NUMERIC
 15159*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15160*            MOVE AL-UNNON       TO  CMICRNOA
 15161*        ELSE
 15162*            MOVE -1             TO  CMICRNOL
 15163*            MOVE AL-UNBON       TO  CMICRNOA
 15164*            MOVE ER-2701        TO  EMI-ERROR
 15165*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15166
 15167     IF CLSTNML     GREATER THAN ZEROS
 15168        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15169
 15170     IF CCANREAL > ZEROS
 15171        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15172     END-IF
 15173     IF CCANDT1L    GREATER THAN ZEROS
 15174        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15175
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 276
* EL6311.cbl
 15176     IF CCANDT2L    GREATER THAN ZEROS
 15177        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15178
 15179     IF CMTHD1L    GREATER THAN +0
 15180        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15181
 15182     IF CMTHD2L    GREATER THAN +0
 15183        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15184
 15185     IF CREFND1L    GREATER THAN ZEROS
 15186        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15187        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15188     ELSE
 15189        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15190
 15191     IF CREFND2L    GREATER THAN ZEROS
 15192        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15193        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15194     ELSE
 15195        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15196
 15197     IF CLIVESL     GREATER THAN ZEROS
 15198        MOVE WS-CLIVES           TO PB-C-LIVES
 15199     ELSE
 15200        MOVE ZEROS               TO PB-C-LIVES.
 15201
 15202     IF CPAYEEL     GREATER THAN ZEROS
 15203        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15204
 15205     IF CFORCEL     GREATER THAN ZEROS
 15206        MOVE CFORCEI             TO PB-FORCE-CODE.
 15207
 15208     IF CBILCDL     GREATER THAN ZEROS
 15209        MOVE CBILCDI             TO PB-RECORD-BILL.
 15210
 15211*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15212
 15213 2260-WRITE-PB-RECORD.
 15214     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15215                                    PB-INPUT-BY.
 15216     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15217     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15218                                    PB-INPUT-DT.
 15219
 15220     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15221     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15222                                    PB-CONTROL-BY-ORIG-BATCH.
 15223
 15224     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15225     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15226     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15227     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15228     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15229
 15230     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15231
 15232     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15233
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 277
* EL6311.cbl
 15234     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15235     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15236     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15237
 15238     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15239     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15240
 15241 2275-WRITE-PENDING-BUSINESS.
 15242     MOVE 'A'                    TO JP-RECORD-TYPE.
 15243     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15244     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15245     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15246
 15247
 15248* EXEC CICS HANDLE CONDITION
 15249*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15250*    END-EXEC.
 15251*    MOVE '"$%                   ! 4 #00013712' TO DFHEIV0
 15252     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15254     MOVE X'3420233030303133373132' TO DFHEIV0(25:11)
 15255     CALL 'kxdfhei1' USING DFHEIV0
 15256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15257
 15258
 15259
 15260* EXEC CICS WRITE
 15261*        DATASET (FILE-ID-ERPNDB)
 15262*        FROM    (PENDING-BUSINESS)
 15263*        RIDFLD  (PB-CONTROL-PRIMARY)
 15264*    END-EXEC.
 15265     MOVE LENGTH OF
 15266      PENDING-BUSINESS
 15267       TO DFHEIV11
 15268*    MOVE '&$ L                  ''   #00013716' TO DFHEIV0
 15269     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15271     MOVE X'2020233030303133373136' TO DFHEIV0(25:11)
 15272     CALL 'kxdfhei1' USING DFHEIV0,
 15273           FILE-ID-ERPNDB,
 15274           PENDING-BUSINESS,
 15275           DFHEIV11,
 15276           PB-CONTROL-PRIMARY,
 15277           DFHEIV99,
 15278           DFHEIV99
 15279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15280
 15281
 15282     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15283
 15284     PERFORM 8400-LOG-JOURNAL-RECORD.
 15285
 15286******************************************************************
 15287*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15288******************************************************************
 15289
 15290     display ' made it to add orig CANCEL cert '
 15291     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 278
* EL6311.cbl
 15292     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15293     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15294     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15295
 15296
 15297* EXEC CICS READ
 15298*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15299*        DATASET (FILE-ID-ELCERT)
 15300*        RIDFLD  (ELCERT-KEY)
 15301*        RESP    (WS-RESPONSE)
 15302*    END-EXEC.
 15303*    MOVE '&"S        E          (  N#00013736' TO DFHEIV0
 15304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15306     MOVE X'204E233030303133373336' TO DFHEIV0(25:11)
 15307     CALL 'kxdfhei1' USING DFHEIV0,
 15308           FILE-ID-ELCERT,
 15309           DFHEIV20,
 15310           DFHEIV99,
 15311           ELCERT-KEY,
 15312           DFHEIV99,
 15313           DFHEIV99,
 15314           DFHEIV99
 15315     SET ADDRESS OF CERTIFICATE-MASTER TO
 15316         DFHEIV20
 15317     MOVE EIBRESP  TO WS-RESPONSE
 15318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15319
 15320
 15321     IF NOT RESP-NORMAL
 15322        GO TO 2276-BYPASS-CRTO
 15323     END-IF
 15324
 15325     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15326     MOVE ' '                    TO WS-ERMAIL-SW
 15327
 15328
 15329* EXEC CICS READ
 15330*       DATASET   (FILE-ID-ERMAIL)
 15331*       SET       (ADDRESS OF MAILING-DATA)
 15332*       RIDFLD    (ERMAIL-KEY)
 15333*       RESP      (WS-RESPONSE)
 15334*    END-EXEC
 15335*    MOVE '&"S        E          (  N#00013750' TO DFHEIV0
 15336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15338     MOVE X'204E233030303133373530' TO DFHEIV0(25:11)
 15339     CALL 'kxdfhei1' USING DFHEIV0,
 15340           FILE-ID-ERMAIL,
 15341           DFHEIV20,
 15342           DFHEIV99,
 15343           ERMAIL-KEY,
 15344           DFHEIV99,
 15345           DFHEIV99,
 15346           DFHEIV99
 15347     SET ADDRESS OF MAILING-DATA TO
 15348         DFHEIV20
 15349     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 279
* EL6311.cbl
 15350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15351
 15352     IF RESP-NORMAL
 15353        SET ERMAIL-FOUND TO TRUE
 15354     END-IF
 15355
 15356     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15357
 15358     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15359     MOVE 'OC'                   TO OC-RECORD-ID
 15360     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15361                                 TO OC-CONTROL-PRIMARY (1:33)
 15362     MOVE 'I'                    TO OC-RECORD-TYPE
 15363     MOVE +4096                  TO OC-KEY-SEQ-NO
 15364     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15365     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15366     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15367
 15368     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15369     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15370     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15371     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15372     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15373     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15374     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15375     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15376     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15377     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15378     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15379     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15380     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15381     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15382     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15383     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15384     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15385     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15386     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15387     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15388     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15389     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15390     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15391     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15392     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15393     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15394     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15395     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15396     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15397     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15398     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15399     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15400
 15401     IF ERMAIL-FOUND
 15402        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15403     END-IF
 15404     IF NOT CERT-TRL-REC-NOT-FOUND
 15405        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15406                           OC-INS-AGE-DEFAULT-FLAG
 15407        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 280
* EL6311.cbl
 15408                           OC-JNT-AGE-DEFAULT-FLAG
 15409     END-IF
 15410     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15411     .
 15412 2275-WRITE-ELCRTO.
 15413
 15414
 15415* EXEC CICS WRITE
 15416*       DATASET   ('ELCRTO')
 15417*       FROM      (ORIGINAL-CERTIFICATE)
 15418*       RIDFLD    (OC-CONTROL-PRIMARY)
 15419*       RESP      (WS-RESPONSE)
 15420*    END-EXEC
 15421     MOVE LENGTH OF
 15422      ORIGINAL-CERTIFICATE
 15423       TO DFHEIV11
 15424     MOVE 'ELCRTO' TO DFHEIV1
 15425*    MOVE '&$ L                  ''  N#00013819' TO DFHEIV0
 15426     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15428     MOVE X'204E233030303133383139' TO DFHEIV0(25:11)
 15429     CALL 'kxdfhei1' USING DFHEIV0,
 15430           DFHEIV1,
 15431           ORIGINAL-CERTIFICATE,
 15432           DFHEIV11,
 15433           OC-CONTROL-PRIMARY,
 15434           DFHEIV99,
 15435           DFHEIV99
 15436     MOVE EIBRESP  TO WS-RESPONSE
 15437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15438
 15439     display ' just wrote 2275 ' ws-response
 15440     IF RESP-DUPKEY
 15441        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15442        GO TO 2275-WRITE-ELCRTO
 15443     ELSE
 15444        IF NOT RESP-NORMAL
 15445           MOVE -1               TO BMAINTL
 15446           MOVE ER-7450          TO EMI-ERROR
 15447           PERFORM 9900-ERROR-FORMAT
 15448                                 THRU 9900-EXIT
 15449           GO TO 8200-SEND-DATAONLY
 15450        END-IF
 15451     END-IF.
 15452
 15453 2276-BYPASS-CRTO.
 15454******************************************************************
 15455*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15456******************************************************************
 15457
 15458
 15459* EXEC CICS READ
 15460*        INTO    (PENDING-BUSINESS)
 15461*        DATASET (FILE-ID-ERPNDB)
 15462*        RIDFLD  (ERPNDB-KEY)
 15463*        UPDATE
 15464*    END-EXEC.
 15465     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 281
* EL6311.cbl
 15466      PENDING-BUSINESS
 15467       TO DFHEIV11
 15468*    MOVE '&"IL       EU         (   #00013845' TO DFHEIV0
 15469     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15470     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15471     MOVE X'2020233030303133383435' TO DFHEIV0(25:11)
 15472     CALL 'kxdfhei1' USING DFHEIV0,
 15473           FILE-ID-ERPNDB,
 15474           PENDING-BUSINESS,
 15475           DFHEIV11,
 15476           ERPNDB-KEY,
 15477           DFHEIV99,
 15478           DFHEIV99,
 15479           DFHEIV99
 15480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15481
 15482
 15483     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15484     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15485     MOVE 'B'                    TO JP-RECORD-TYPE.
 15486     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15487
 15488     PERFORM 8400-LOG-JOURNAL-RECORD.
 15489
 15490     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15491
 15492
 15493* EXEC CICS REWRITE
 15494*        DATASET (FILE-ID-ERPNDB)
 15495*        FROM    (PENDING-BUSINESS)
 15496*    END-EXEC.
 15497     MOVE LENGTH OF
 15498      PENDING-BUSINESS
 15499       TO DFHEIV11
 15500*    MOVE '&& L                  %   #00013861' TO DFHEIV0
 15501     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15502     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15503     MOVE X'2020233030303133383631' TO DFHEIV0(25:11)
 15504     CALL 'kxdfhei1' USING DFHEIV0,
 15505           FILE-ID-ERPNDB,
 15506           PENDING-BUSINESS,
 15507           DFHEIV11,
 15508           DFHEIV99
 15509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15510
 15511
 15512     MOVE 'C'                    TO JP-RECORD-TYPE.
 15513     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15514
 15515     PERFORM 8400-LOG-JOURNAL-RECORD.
 15516
 15517     IF WS-ERRORS-PRESENT
 15518        GO TO 3900-RE-DISPLAY-RECORD.
 15519
 15520     MOVE ZEROS                  TO EMI-ERROR.
 15521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15522     MOVE LOW-VALUES             TO EL631CI.
 15523     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 282
* EL6311.cbl
 15524     GO TO 8100-SEND-INITIAL-MAP.
 15525
 15526 2280-BATCH-HDR-NOT-FOUND.
 15527     MOVE -1                     TO BMAINTL.
 15528     MOVE ER-7450                TO EMI-ERROR.
 15529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15530     GO TO 8200-SEND-DATAONLY.
 15531
 15532 2290-DUPLICATE-ALT-INDEX.
 15533
 15534******************************************************************
 15535*                                                                *
 15536*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15537*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15538*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15539*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15540*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15541*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15542*                                                                *
 15543******************************************************************
 15544
 15545     IF LCP-ONCTR-02 =  0
 15546         ADD 1 TO LCP-ONCTR-02
 15547        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15548
 15549     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15550
 15551     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15552         NEXT SENTENCE
 15553     ELSE
 15554         ADD +1 TO PB-BATCH-SEQ-NO
 15555                   PB-CSR-BATCH-SEQ-NO
 15556         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15557         GO TO 2275-WRITE-PENDING-BUSINESS.
 15558
 15559     MOVE -1                     TO CCERTNOL.
 15560     MOVE AL-UABON               TO CCERTNOA.
 15561     MOVE AL-UNBON               TO CEFFDTA.
 15562
 15563     MOVE 1                      TO EMI-SUB
 15564                                    EMI-SWITCH1
 15565                                    EMI-SWITCH-AREA-1
 15566                                    EMI-SWITCH-AREA-2.
 15567
 15568     MOVE SPACES                 TO EMI-ERROR-LINES.
 15569
 15570
 15571* EXEC CICS SYNCPOINT ROLLBACK
 15572*    END-EXEC.
 15573*    MOVE '6"R                   !   #00013924' TO DFHEIV0
 15574     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15576     MOVE X'2020233030303133393234' TO DFHEIV0(25:11)
 15577     CALL 'kxdfhei1' USING DFHEIV0
 15578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15579
 15580
 15581     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 283
* EL6311.cbl
 15582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15583     GO TO 8200-SEND-DATAONLY.
 15584
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 284
* EL6311.cbl
 15586
 15587******************************************************************
 15588*                                                                *
 15589*          C H A N G E   C A N C E L   R O U T I N E             *
 15590*                                                                *
 15591******************************************************************
 15592
 15593***************************************************************
 15594*                                                             *
 15595*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15596*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15597*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15598*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15599*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15600*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15601*     5. LINK TO THE EDIT ROUTINE.                            *
 15602*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15603*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15604*              THE EDIT ROUTINE.                              *
 15605*     7. REWRITE THE NEW ISSUE                                *
 15606*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15607*                                                             *
 15608***************************************************************
 15609 2300-CHANGE-CANCEL-ROUTINE.
 15610     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15611
 15612     IF CCHGL NOT = ZEROS
 15613        MOVE ER-2196             TO EMI-ERROR
 15614        MOVE AL-UABON            TO CMAINTA
 15615        MOVE -1                  TO CMAINTL
 15616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15617        GO TO 8200-SEND-DATAONLY.
 15618
 15619     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15620
 15621     IF CSUFIXL NOT = ZEROS
 15622        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15623     ELSE
 15624        MOVE SPACE               TO WS-NEW-SUFFIX.
 15625
 15626     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15627     PERFORM 8600-DEEDIT.
 15628     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15629     MOVE '4'                    TO DC-OPTION-CODE.
 15630
 15631     PERFORM 9700-DATE-LINK.
 15632
 15633     IF DATE-CONVERSION-ERROR
 15634        MOVE ER-0348             TO EMI-ERROR
 15635        MOVE -1                  TO CEFFDTL
 15636        MOVE AL-UABON            TO CEFFDTA
 15637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15638        GO TO 8200-SEND-DATAONLY
 15639     ELSE
 15640        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15641        MOVE AL-UANON            TO CEFFDTA
 15642        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15643
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 285
* EL6311.cbl
 15644 2325-PROCESS-CANCEL-CHANGES.
 15645
 15646* EXEC CICS HANDLE CONDITION
 15647*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15648*    END-EXEC.
 15649*    MOVE '"$I                   ! 5 #00013991' TO DFHEIV0
 15650     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15652     MOVE X'3520233030303133393931' TO DFHEIV0(25:11)
 15653     CALL 'kxdfhei1' USING DFHEIV0
 15654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15655
 15656
 15657     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15658     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15659     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15660
 15661
 15662* EXEC CICS GETMAIN
 15663*        SET      (ADDRESS OF PENDING-BUSINESS)
 15664*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15665*        INITIMG  (GETMAIN-SPACE)
 15666*     END-EXEC.
 15667*    MOVE ',"IL                  $   #00013999' TO DFHEIV0
 15668     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15669     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15670     MOVE X'2020233030303133393939' TO DFHEIV0(25:11)
 15671     CALL 'kxdfhei1' USING DFHEIV0,
 15672           DFHEIV20,
 15673           ERPNDB-RECORD-LENGTH,
 15674           GETMAIN-SPACE
 15675     SET ADDRESS OF PENDING-BUSINESS TO
 15676         DFHEIV20
 15677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15678
 15679
 15680
 15681* EXEC CICS READ
 15682*        INTO    (PENDING-BUSINESS)
 15683*        DATASET (FILE-ID-ERPNDB)
 15684*        RIDFLD  (ERPNDB-KEY)
 15685*    END-EXEC.
 15686     MOVE LENGTH OF
 15687      PENDING-BUSINESS
 15688       TO DFHEIV11
 15689*    MOVE '&"IL       E          (   #00014005' TO DFHEIV0
 15690     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15692     MOVE X'2020233030303134303035' TO DFHEIV0(25:11)
 15693     CALL 'kxdfhei1' USING DFHEIV0,
 15694           FILE-ID-ERPNDB,
 15695           PENDING-BUSINESS,
 15696           DFHEIV11,
 15697           ERPNDB-KEY,
 15698           DFHEIV99,
 15699           DFHEIV99,
 15700           DFHEIV99
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 286
* EL6311.cbl
 15702
 15703
 15704     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15705
 15706
 15707* EXEC CICS HANDLE CONDITION
 15708*         NOTFND     (2385-REC-NOT-FOUND)
 15709*    END-EXEC.
 15710*    MOVE '"$I                   ! 6 #00014013' TO DFHEIV0
 15711     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15713     MOVE X'3620233030303134303133' TO DFHEIV0(25:11)
 15714     CALL 'kxdfhei1' USING DFHEIV0
 15715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15716
 15717
 15718**********************************************************
 15719*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15720*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15721**********************************************************
 15722
 15723
 15724* EXEC CICS READ
 15725*        DATASET (FILE-ID-ERPNDB)
 15726*        INTO    (PENDING-BUSINESS)
 15727*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15728*    END-EXEC.
 15729     MOVE LENGTH OF
 15730      PENDING-BUSINESS
 15731       TO DFHEIV11
 15732*    MOVE '&"IL       E          (   #00014022' TO DFHEIV0
 15733     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15735     MOVE X'2020233030303134303232' TO DFHEIV0(25:11)
 15736     CALL 'kxdfhei1' USING DFHEIV0,
 15737           FILE-ID-ERPNDB,
 15738           PENDING-BUSINESS,
 15739           DFHEIV11,
 15740           PI-PREV-CONTROL-PRIMARY,
 15741           DFHEIV99,
 15742           DFHEIV99,
 15743           DFHEIV99
 15744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15745
 15746
 15747********** DO NOT ALLOW CHANGES IF THRU A/R
 15748     IF BMAINTI = 'C'
 15749         IF PB-EL860-INTERNAL-PROCESS
 15750             MOVE ER-4005          TO EMI-ERROR
 15751             MOVE -1               TO BMAINTL
 15752             MOVE AL-UABON         TO BMAINTA
 15753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15754             GO TO 8200-SEND-DATAONLY.
 15755**********
 15756
 15757     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15758        MOVE -1                 TO CMAINTL
 15759        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 287
* EL6311.cbl
 15760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15761        GO TO 8200-SEND-DATAONLY.
 15762
 15763     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15764        MOVE ER-2196             TO EMI-ERROR
 15765        MOVE AL-UABON            TO CMAINTA
 15766        MOVE -1                  TO CMAINTL
 15767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15768        GO TO 8200-SEND-DATAONLY.
 15769     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15770
 15771     IF PB-BILLED-DT = LOW-VALUES AND
 15772        PB-CHG-COUNT = ZEROS
 15773        NEXT SENTENCE
 15774     ELSE
 15775        IF (CREFND1L GREATER THAN ZEROS AND
 15776            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15777           OR
 15778           (CREFND2L GREATER THAN ZEROS AND
 15779            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15780           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15781     if ((crefnd1l <> zeros)
 15782        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15783                      or
 15784        ((crefnd2l <> zeros)
 15785        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15786        continue
 15787     else
 15788        go to 2330-continue-change
 15789     end-if
 15790
 15791     move zeros                  to ws-check-amts
 15792     move ' '                    to ws-stop-sw
 15793                                    ws-check-sw
 15794                                    ws-any-check-sw
 15795                                    ws-proc-check-sw
 15796                                    ws-chek-browse-sw
 15797
 15798     perform 2500-browse-checks  thru 2500-exit
 15799
 15800     if i-have-processed-checks
 15801        or i-have-checks
 15802        continue
 15803     else
 15804        go to 2330-continue-change
 15805     end-if
 15806
 15807     if crefnd1l <> zeros
 15808        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15809        move ws-crefnd1 to ws-new-ref-total
 15810     else
 15811        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15812     end-if
 15813     if crefnd2l <> zeros
 15814        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15815        compute ws-new-ref-total = ws-new-ref-total +
 15816           ws-crefnd2
 15817     else
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 288
* EL6311.cbl
 15818        compute ws-new-ref-total = ws-new-ref-total +
 15819           pb-c-ah-cancel-amt
 15820     end-if
 15821
 15822     if zeros = (ws-lf-diff + ws-ah-diff)
 15823        move er-3449             to emi-error
 15824        perform 9900-error-format thru 9900-exit
 15825        go to 2330-continue-change
 15826     end-if
 15827
 15828     if (ws-new-ref-total < ws-check-amts)
 15829        and (pb-c-refund-sw = 'Y')
 15830        move er-3447             to emi-error
 15831        perform 9900-error-format thru 9900-exit
 15832        move al-uabon            to cmainta
 15833        move -1                  to cmaintl
 15834        go to 8200-send-dataonly
 15835     end-if
 15836
 15837     if (ws-new-ref-total > ws-check-amts)
 15838        and (ws-check-amts not = zeros)
 15839        move er-3448             to emi-error
 15840        move al-uabon            to crefnd1a
 15841                                    crefnd2a
 15842        perform 9900-error-format thru 9900-exit
 15843     end-if
 15844
 15845*     if (ws-lf-diff + ws-ah-diff) < zeros
 15846*        move er-3447             to emi-error
 15847*        perform 9900-error-format thru 9900-exit
 15848*        move al-uabon            to cmainta
 15849*        move -1                  to cmaintl
 15850*        go to 8200-send-dataonly
 15851*     end-if
 15852     .
 15853 2330-continue-change.
 15854
 15855
 15856* EXEC CICS READ
 15857*        DATASET (FILE-ID-ERPNDB)
 15858*        INTO    (PENDING-BUSINESS)
 15859*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15860*        UPDATE
 15861*    END-EXEC.
 15862     MOVE LENGTH OF
 15863      PENDING-BUSINESS
 15864       TO DFHEIV11
 15865*    MOVE '&"IL       EU         (   #00014136' TO DFHEIV0
 15866     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15868     MOVE X'2020233030303134313336' TO DFHEIV0(25:11)
 15869     CALL 'kxdfhei1' USING DFHEIV0,
 15870           FILE-ID-ERPNDB,
 15871           PENDING-BUSINESS,
 15872           DFHEIV11,
 15873           PI-PREV-CONTROL-PRIMARY,
 15874           DFHEIV99,
 15875           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 289
* EL6311.cbl
 15876           DFHEIV99
 15877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15878
 15879
 15880     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15881     MOVE 'B'                    TO JP-RECORD-TYPE
 15882     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15883     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15884
 15885     PERFORM 8400-LOG-JOURNAL-RECORD.
 15886
 15887     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15888          PB-CHG-COUNT NOT = ZEROS
 15889        IF (CREFND1L GREATER THAN ZEROS AND
 15890            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15891           OR
 15892           (CREFND2L GREATER THAN ZEROS AND
 15893            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15894            ADD +1                      TO PB-CHG-COUNT
 15895            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15896
 15897*    IF CMICRNOL  GREATER  ZEROS
 15898*        IF CMICRNOI  NUMERIC
 15899*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15900*            MOVE AL-UNNON       TO  CMICRNOA
 15901*        ELSE
 15902*            MOVE -1             TO  CMICRNOL
 15903*            MOVE AL-UNBON       TO  CMICRNOA
 15904*            MOVE ER-2701        TO  EMI-ERROR
 15905*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15906
 15907     IF CSUFIXL GREATER THAN ZEROS
 15908        MOVE CSUFIXI             TO PB-CERT-SFX.
 15909
 15910     IF CLSTNML GREATER THAN ZEROS
 15911         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15912
 15913     IF CCANREAL > ZEROS
 15914        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15915     END-IF
 15916     IF CCANDT1L    GREATER THAN ZEROS
 15917        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15918
 15919     IF CCANDT2L    GREATER THAN ZEROS
 15920        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15921
 15922     IF CMTHD1L    GREATER THAN +0
 15923        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15924
 15925     IF CMTHD2L    GREATER THAN +0
 15926        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15927
 15928     IF CREFND1L    GREATER THAN ZEROS
 15929        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15930        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15931        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15932        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15933
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 290
* EL6311.cbl
 15934     IF CREFND2L    GREATER THAN ZEROS
 15935        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15936        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15937        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15938        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15939
 15940     IF CLIVESL     GREATER THAN ZEROS
 15941        MOVE WS-CLIVES           TO PB-C-LIVES.
 15942
 15943     IF CPAYEEL     GREATER THAN ZEROS
 15944        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15945
 15946     IF CFORCEL     GREATER THAN ZEROS
 15947        MOVE CFORCEI             TO PB-FORCE-CODE.
 15948
 15949     IF CBILCDL     GREATER THAN ZEROS
 15950        MOVE CBILCDI             TO PB-RECORD-BILL.
 15951
 15952 2360-REWRITE-PB-RECORD.
 15953     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15954     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15955     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15956     MOVE 'C'                    TO JP-RECORD-TYPE.
 15957     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15958     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15959     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15960
 15961     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15962
 15963     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15964     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15965
 15966     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15967
 15968     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15969
 15970     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15971     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15972     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15973
 15974     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15975     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15976
 15977 2375-REWRITE-PENDING-BUSINESS.
 15978     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15979     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15980     MOVE 'C'                    TO JP-RECORD-TYPE.
 15981     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15982
 15983
 15984* EXEC CICS REWRITE
 15985*        DATASET (FILE-ID-ERPNDB)
 15986*        FROM    (PENDING-BUSINESS)
 15987*    END-EXEC.
 15988     MOVE LENGTH OF
 15989      PENDING-BUSINESS
 15990       TO DFHEIV11
 15991*    MOVE '&& L                  %   #00014246' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 291
* EL6311.cbl
 15992     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15993     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15994     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 15995     CALL 'kxdfhei1' USING DFHEIV0,
 15996           FILE-ID-ERPNDB,
 15997           PENDING-BUSINESS,
 15998           DFHEIV11,
 15999           DFHEIV99
 16000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16001
 16002
 16003     PERFORM 8400-LOG-JOURNAL-RECORD.
 16004
 16005******************************************************************
 16006*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16007******************************************************************
 16008
 16009     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16010     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16011     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16012     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16013
 16014
 16015* EXEC CICS READ
 16016*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16017*        DATASET (FILE-ID-ELCERT)
 16018*        RIDFLD  (ELCERT-KEY)
 16019*        RESP    (WS-RESPONSE)
 16020*    END-EXEC.
 16021*    MOVE '&"S        E          (  N#00014262' TO DFHEIV0
 16022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16024     MOVE X'204E233030303134323632' TO DFHEIV0(25:11)
 16025     CALL 'kxdfhei1' USING DFHEIV0,
 16026           FILE-ID-ELCERT,
 16027           DFHEIV20,
 16028           DFHEIV99,
 16029           ELCERT-KEY,
 16030           DFHEIV99,
 16031           DFHEIV99,
 16032           DFHEIV99
 16033     SET ADDRESS OF CERTIFICATE-MASTER TO
 16034         DFHEIV20
 16035     MOVE EIBRESP  TO WS-RESPONSE
 16036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16037
 16038
 16039     IF NOT RESP-NORMAL
 16040        GO TO 2376-BYPASS-CRTO
 16041     END-IF
 16042
 16043
 16044     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16045     MOVE ' '                    TO WS-ERMAIL-SW
 16046
 16047
 16048* EXEC CICS READ
 16049*       DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 292
* EL6311.cbl
 16050*       SET       (ADDRESS OF MAILING-DATA)
 16051*       RIDFLD    (ERMAIL-KEY)
 16052*       RESP      (WS-RESPONSE)
 16053*    END-EXEC
 16054*    MOVE '&"S        E          (  N#00014277' TO DFHEIV0
 16055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16057     MOVE X'204E233030303134323737' TO DFHEIV0(25:11)
 16058     CALL 'kxdfhei1' USING DFHEIV0,
 16059           FILE-ID-ERMAIL,
 16060           DFHEIV20,
 16061           DFHEIV99,
 16062           ERMAIL-KEY,
 16063           DFHEIV99,
 16064           DFHEIV99,
 16065           DFHEIV99
 16066     SET ADDRESS OF MAILING-DATA TO
 16067         DFHEIV20
 16068     MOVE EIBRESP  TO WS-RESPONSE
 16069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16070
 16071     IF RESP-NORMAL
 16072        SET ERMAIL-FOUND TO TRUE
 16073     END-IF
 16074
 16075     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16076
 16077     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16078                                 TO ELCRTO-KEY
 16079     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16080     MOVE +0                     TO ELCRTO-SEQ-NO
 16081
 16082
 16083* EXEC CICS READ
 16084*       DATASET   ('ELCRTO')
 16085*       INTO      (ORIGINAL-CERTIFICATE)
 16086*       RIDFLD    (ELCRTO-KEY)
 16087*       GTEQ
 16088*       RESP      (WS-RESPONSE)
 16089*    END-EXEC
 16090     MOVE LENGTH OF
 16091      ORIGINAL-CERTIFICATE
 16092       TO DFHEIV11
 16093     MOVE 'ELCRTO' TO DFHEIV1
 16094*    MOVE '&"IL       G          (  N#00014295' TO DFHEIV0
 16095     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16097     MOVE X'204E233030303134323935' TO DFHEIV0(25:11)
 16098     CALL 'kxdfhei1' USING DFHEIV0,
 16099           DFHEIV1,
 16100           ORIGINAL-CERTIFICATE,
 16101           DFHEIV11,
 16102           ELCRTO-KEY,
 16103           DFHEIV99,
 16104           DFHEIV99,
 16105           DFHEIV99
 16106     MOVE EIBRESP  TO WS-RESPONSE
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 293
* EL6311.cbl
 16108
 16109     IF RESP-NORMAL
 16110        AND (OC-CONTROL-PRIMARY (1:33) =
 16111                 PB-CONTROL-BY-ACCOUNT (1:33))
 16112        AND (OC-RECORD-TYPE = 'I')
 16113        display ' resp norm, key =, type i '
 16114        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16115           display ' end proc blank '
 16116           display ' csr edit session ' PI-CSR-SESSION-SW
 16117           IF NOT CSR-EDIT-SESSION
 16118
 16119* EXEC CICS READ
 16120*                DATASET   ('ELCRTO')
 16121*                INTO      (ORIGINAL-CERTIFICATE)
 16122*                RIDFLD    (OC-CONTROL-PRIMARY)
 16123*                UPDATE
 16124*                RESP      (WS-RESPONSE)
 16125*             END-EXEC
 16126     MOVE LENGTH OF
 16127      ORIGINAL-CERTIFICATE
 16128       TO DFHEIV11
 16129     MOVE 'ELCRTO' TO DFHEIV1
 16130*    MOVE '&"IL       EU         (  N#00014312' TO DFHEIV0
 16131     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16132     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16133     MOVE X'204E233030303134333132' TO DFHEIV0(25:11)
 16134     CALL 'kxdfhei1' USING DFHEIV0,
 16135           DFHEIV1,
 16136           ORIGINAL-CERTIFICATE,
 16137           DFHEIV11,
 16138           OC-CONTROL-PRIMARY,
 16139           DFHEIV99,
 16140           DFHEIV99,
 16141           DFHEIV99
 16142     MOVE EIBRESP  TO WS-RESPONSE
 16143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16144              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16145              IF RESP-NORMAL
 16146                 display ' good read upd '
 16147                 IF OC-ISSUE-TRAN-IND = 'N'
 16148                    MOVE CM-INSURED-LAST-NAME   TO
 16149                         OC-INS-LAST-NAME
 16150                    MOVE CM-INSURED-FIRST-NAME  TO
 16151                         OC-INS-FIRST-NAME
 16152                    MOVE CM-INSURED-INITIAL2    TO
 16153                         OC-INS-MIDDLE-INIT
 16154                    MOVE CM-INSURED-ISSUE-AGE   TO
 16155                         OC-INS-AGE
 16156                    MOVE CM-JT-LAST-NAME        TO
 16157                         OC-JNT-LAST-NAME
 16158                    MOVE CM-JT-FIRST-NAME       TO
 16159                         OC-JNT-FIRST-NAME
 16160                    MOVE CM-JT-INITIAL          TO
 16161                         OC-JNT-MIDDLE-INIT
 16162                    MOVE CM-INSURED-JOINT-AGE   TO
 16163                         OC-JNT-AGE
 16164                    MOVE CM-LF-BENEFIT-CD       TO
 16165                         OC-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 294
* EL6311.cbl
 16166                    MOVE CM-LF-ORIG-TERM        TO
 16167                         OC-LF-TERM
 16168                    MOVE CM-LF-BENEFIT-AMT      TO
 16169                         OC-LF-BEN-AMT
 16170                    MOVE CM-LF-PREMIUM-AMT      TO
 16171                         OC-LF-PRM-AMT
 16172                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16173                         OC-LF-ALT-BEN-AMT
 16174                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16175                         OC-LF-ALT-PRM-AMT
 16176                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16177                         OC-LF-EXP-DT
 16178                    MOVE CM-LIFE-COMM-PCT       TO
 16179                         OC-LF-COMM-PCT
 16180                    MOVE CM-AH-BENEFIT-CD       TO
 16181                         OC-AH-BENCD
 16182                    MOVE CM-AH-ORIG-TERM        TO
 16183                         OC-AH-TERM
 16184                    MOVE CM-AH-BENEFIT-AMT      TO
 16185                         OC-AH-BEN-AMT
 16186                    MOVE CM-AH-PREMIUM-AMT      TO
 16187                         OC-AH-PRM-AMT
 16188                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16189                         OC-AH-EXP-DT
 16190                    MOVE CM-AH-COMM-PCT         TO
 16191                         OC-AH-COMM-PCT
 16192                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16193                         OC-AH-CP
 16194                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16195                         OC-1ST-PMT-DT
 16196                 END-IF
 16197                 MOVE PB-C-LF-CANCEL-DT      TO
 16198                         OC-LF-CANCEL-DT
 16199                 MOVE PB-C-LF-CANCEL-AMT     TO
 16200                         OC-LF-CANCEL-AMT
 16201                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16202                         OC-LF-ITD-CANCEL-AMT
 16203                 MOVE PB-C-AH-CANCEL-DT      TO
 16204                         OC-AH-CANCEL-DT
 16205                 MOVE PB-C-AH-CANCEL-AMT     TO
 16206                         OC-AH-CANCEL-AMT
 16207                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16208                         OC-AH-ITD-CANCEL-AMT
 16209                 MOVE 'Y'                    TO
 16210                         OC-CANCEL-TRAN-IND
 16211                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16212                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16213                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16214                 IF ERMAIL-FOUND
 16215                    MOVE MA-CRED-BENE-NAME
 16216                                 TO OC-CRED-BENE-NAME
 16217                 END-IF
 16218                 IF NOT CERT-TRL-REC-NOT-FOUND
 16219                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16220                           OC-INS-AGE-DEFAULT-FLAG
 16221                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16222                           OC-JNT-AGE-DEFAULT-FLAG
 16223                 END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 295
* EL6311.cbl
 16224
 16225* EXEC CICS REWRITE
 16226*                   DATASET   ('ELCRTO')
 16227*                   FROM      (ORIGINAL-CERTIFICATE)
 16228*                   RESP      (WS-RESPONSE)
 16229*                END-EXEC
 16230     MOVE LENGTH OF
 16231      ORIGINAL-CERTIFICATE
 16232       TO DFHEIV11
 16233     MOVE 'ELCRTO' TO DFHEIV1
 16234*    MOVE '&& L                  %  N#00014399' TO DFHEIV0
 16235     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16236     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16237     MOVE X'204E233030303134333939' TO DFHEIV0(25:11)
 16238     CALL 'kxdfhei1' USING DFHEIV0,
 16239           DFHEIV1,
 16240           ORIGINAL-CERTIFICATE,
 16241           DFHEIV11,
 16242           DFHEIV99
 16243     MOVE EIBRESP  TO WS-RESPONSE
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16245                 display ' just rewrote ' ws-response
 16246              END-IF
 16247           END-IF
 16248        ELSE
 16249           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16250           MOVE 'OC'             TO OC-RECORD-ID
 16251           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16252           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16253           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16254           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16255           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16256           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16257           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16258           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16259           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16260           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16261           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16262           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16263           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16264           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16265           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16266           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16267           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16268           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16269           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16270           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16271           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16272           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16273           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16274           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16275           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16276           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16277           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16278           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16279           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16280           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16281           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 296
* EL6311.cbl
 16282           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16283           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16284           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16285           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16286           IF ERMAIL-FOUND
 16287              MOVE MA-CRED-BENE-NAME
 16288                                 TO OC-CRED-BENE-NAME
 16289           END-IF
 16290           IF NOT CERT-TRL-REC-NOT-FOUND
 16291              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16292                           OC-INS-AGE-DEFAULT-FLAG
 16293              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16294                           OC-JNT-AGE-DEFAULT-FLAG
 16295           END-IF
 16296           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16297
 16298* EXEC CICS WRITE
 16299*             DATASET   ('ELCRTO')
 16300*             FROM      (ORIGINAL-CERTIFICATE)
 16301*             RIDFLD    (OC-CONTROL-PRIMARY)
 16302*             RESP      (WS-RESPONSE)
 16303*          END-EXEC
 16304     MOVE LENGTH OF
 16305      ORIGINAL-CERTIFICATE
 16306       TO DFHEIV11
 16307     MOVE 'ELCRTO' TO DFHEIV1
 16308*    MOVE '&$ L                  ''  N#00014456' TO DFHEIV0
 16309     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16311     MOVE X'204E233030303134343536' TO DFHEIV0(25:11)
 16312     CALL 'kxdfhei1' USING DFHEIV0,
 16313           DFHEIV1,
 16314           ORIGINAL-CERTIFICATE,
 16315           DFHEIV11,
 16316           OC-CONTROL-PRIMARY,
 16317           DFHEIV99,
 16318           DFHEIV99
 16319     MOVE EIBRESP  TO WS-RESPONSE
 16320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16321        END-IF
 16322     ELSE
 16323        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16324        MOVE 'OC'                TO OC-RECORD-ID
 16325        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16326                                 TO OC-CONTROL-PRIMARY (1:33)
 16327        MOVE 'I'                 TO OC-RECORD-TYPE
 16328        MOVE +4096               TO OC-KEY-SEQ-NO
 16329        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16330        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16331        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16332        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16333        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16334        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16335        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16336        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16337        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16338        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16339        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 297
* EL6311.cbl
 16340        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16341        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16342        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16343        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16344        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16345        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16346        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16347        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16348        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16349        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16350        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16351        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16352        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16353        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16354        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16355        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16356        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16357        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16358        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16359        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16360        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16361        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16362        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16363        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16364        IF ERMAIL-FOUND
 16365           MOVE MA-CRED-BENE-NAME
 16366                                 TO OC-CRED-BENE-NAME
 16367        END-IF
 16368        IF NOT CERT-TRL-REC-NOT-FOUND
 16369           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16370                           OC-INS-AGE-DEFAULT-FLAG
 16371           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16372                           OC-JNT-AGE-DEFAULT-FLAG
 16373        END-IF
 16374        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16375
 16376
 16377* EXEC CICS WRITE
 16378*          DATASET   ('ELCRTO')
 16379*          FROM      (ORIGINAL-CERTIFICATE)
 16380*          RIDFLD    (OC-CONTROL-PRIMARY)
 16381*          RESP      (WS-RESPONSE)
 16382*       END-EXEC
 16383     MOVE LENGTH OF
 16384      ORIGINAL-CERTIFICATE
 16385       TO DFHEIV11
 16386     MOVE 'ELCRTO' TO DFHEIV1
 16387*    MOVE '&$ L                  ''  N#00014517' TO DFHEIV0
 16388     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16390     MOVE X'204E233030303134353137' TO DFHEIV0(25:11)
 16391     CALL 'kxdfhei1' USING DFHEIV0,
 16392           DFHEIV1,
 16393           ORIGINAL-CERTIFICATE,
 16394           DFHEIV11,
 16395           OC-CONTROL-PRIMARY,
 16396           DFHEIV99,
 16397           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 298
* EL6311.cbl
 16398     MOVE EIBRESP  TO WS-RESPONSE
 16399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16400     END-IF.
 16401
 16402 2376-BYPASS-CRTO.
 16403******************************************************************
 16404*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16405******************************************************************
 16406
 16407
 16408* EXEC CICS HANDLE CONDITION
 16409*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16410*    END-EXEC.
 16411*    MOVE '"$I                   ! 7 #00014530' TO DFHEIV0
 16412     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16414     MOVE X'3720233030303134353330' TO DFHEIV0(25:11)
 16415     CALL 'kxdfhei1' USING DFHEIV0
 16416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16417
 16418
 16419
 16420* EXEC CICS READ
 16421*        INTO    (PENDING-BUSINESS)
 16422*        DATASET (FILE-ID-ERPNDB)
 16423*        RIDFLD  (ERPNDB-KEY)
 16424*        UPDATE
 16425*    END-EXEC.
 16426     MOVE LENGTH OF
 16427      PENDING-BUSINESS
 16428       TO DFHEIV11
 16429*    MOVE '&"IL       EU         (   #00014534' TO DFHEIV0
 16430     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16432     MOVE X'2020233030303134353334' TO DFHEIV0(25:11)
 16433     CALL 'kxdfhei1' USING DFHEIV0,
 16434           FILE-ID-ERPNDB,
 16435           PENDING-BUSINESS,
 16436           DFHEIV11,
 16437           ERPNDB-KEY,
 16438           DFHEIV99,
 16439           DFHEIV99,
 16440           DFHEIV99
 16441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16442
 16443
 16444     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16445     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16446     MOVE 'B'                    TO JP-RECORD-TYPE.
 16447     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16448
 16449     PERFORM 8400-LOG-JOURNAL-RECORD.
 16450
 16451     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16452
 16453
 16454* EXEC CICS REWRITE
 16455*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 299
* EL6311.cbl
 16456*        FROM    (PENDING-BUSINESS)
 16457*    END-EXEC.
 16458     MOVE LENGTH OF
 16459      PENDING-BUSINESS
 16460       TO DFHEIV11
 16461*    MOVE '&& L                  %   #00014550' TO DFHEIV0
 16462     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16463     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16464     MOVE X'2020233030303134353530' TO DFHEIV0(25:11)
 16465     CALL 'kxdfhei1' USING DFHEIV0,
 16466           FILE-ID-ERPNDB,
 16467           PENDING-BUSINESS,
 16468           DFHEIV11,
 16469           DFHEIV99
 16470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16471
 16472
 16473     MOVE 'C'                    TO JP-RECORD-TYPE.
 16474     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16475
 16476     PERFORM 8400-LOG-JOURNAL-RECORD.
 16477
 16478     IF WS-ERRORS-PRESENT
 16479         GO TO 3900-RE-DISPLAY-RECORD.
 16480
 16481     MOVE ZEROS                  TO EMI-ERROR
 16482     MOVE -1                     TO CMAINTL
 16483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16484     GO TO 3900-RE-DISPLAY-RECORD.
 16485
 16486 2380-BATCH-HDR-NOT-FOUND.
 16487     MOVE -1                     TO BMAINTL.
 16488     MOVE ER-7450                TO EMI-ERROR.
 16489     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16490     GO TO 8200-SEND-DATAONLY.
 16491
 16492 2385-REC-NOT-FOUND.
 16493     MOVE -1                     TO BMAINTL.
 16494     MOVE ER-7451                TO EMI-ERROR.
 16495     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496     GO TO 8200-SEND-DATAONLY.
 16497
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 300
* EL6311.cbl
 16499
 16500******************************************************************
 16501*                                                                *
 16502*          D E L E T E   C A N C E L   R O U T I N E             *
 16503*                                                                *
 16504******************************************************************
 16505
 16506 2400-DELETE-CANCEL-ROUTINE.
 16507     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16508
 16509     IF CCHGL NOT = ZEROS
 16510        MOVE ER-2196             TO EMI-ERROR
 16511        MOVE AL-UABON            TO CMAINTA
 16512        MOVE -1                  TO CMAINTL
 16513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16514        GO TO 8200-SEND-DATAONLY.
 16515
 16516
 16517* EXEC CICS HANDLE CONDITION
 16518*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16519*    END-EXEC.
 16520*    MOVE '"$I                   ! 8 #00014598' TO DFHEIV0
 16521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16523     MOVE X'3820233030303134353938' TO DFHEIV0(25:11)
 16524     CALL 'kxdfhei1' USING DFHEIV0
 16525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16526
 16527
 16528     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16529     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16530     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16531
 16532
 16533* EXEC CICS READ
 16534*        SET     (ADDRESS OF PENDING-BUSINESS)
 16535*        DATASET (FILE-ID-ERPNDB)
 16536*        RIDFLD  (ERPNDB-KEY)
 16537*    END-EXEC.
 16538*    MOVE '&"S        E          (   #00014606' TO DFHEIV0
 16539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16541     MOVE X'2020233030303134363036' TO DFHEIV0(25:11)
 16542     CALL 'kxdfhei1' USING DFHEIV0,
 16543           FILE-ID-ERPNDB,
 16544           DFHEIV20,
 16545           DFHEIV99,
 16546           ERPNDB-KEY,
 16547           DFHEIV99,
 16548           DFHEIV99,
 16549           DFHEIV99
 16550     SET ADDRESS OF PENDING-BUSINESS TO
 16551         DFHEIV20
 16552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16553
 16554
 16555     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16556
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 301
* EL6311.cbl
 16557     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16558
 16559     IF CSUFIXL NOT = ZEROS
 16560        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16561     ELSE
 16562        MOVE SPACE               TO WS-NEW-SUFFIX.
 16563
 16564     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16565
 16566     PERFORM 8600-DEEDIT.
 16567     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16568     MOVE '4'                    TO DC-OPTION-CODE.
 16569     PERFORM 9700-DATE-LINK.
 16570
 16571     IF DATE-CONVERSION-ERROR
 16572        MOVE ER-0348             TO EMI-ERROR
 16573        MOVE -1                  TO CEFFDTL
 16574        MOVE AL-UABON            TO CEFFDTA
 16575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16576        GO TO 8200-SEND-DATAONLY
 16577     ELSE
 16578        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16579        MOVE AL-UANON            TO CEFFDTA
 16580        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16581
 16582
 16583* EXEC CICS HANDLE CONDITION
 16584*         NOTFND    (2490-RECORD-NOT-FOUND)
 16585*    END-EXEC.
 16586*    MOVE '"$I                   ! 9 #00014639' TO DFHEIV0
 16587     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16589     MOVE X'3920233030303134363339' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0
 16591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16592
 16593
 16594
 16595* EXEC CICS READ
 16596*        SET     (ADDRESS OF PENDING-BUSINESS)
 16597*        DATASET (FILE-ID-ERPNDB)
 16598*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16599*        UPDATE
 16600*    END-EXEC.
 16601*    MOVE '&"S        EU         (   #00014643' TO DFHEIV0
 16602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16604     MOVE X'2020233030303134363433' TO DFHEIV0(25:11)
 16605     CALL 'kxdfhei1' USING DFHEIV0,
 16606           FILE-ID-ERPNDB,
 16607           DFHEIV20,
 16608           DFHEIV99,
 16609           PI-PREV-CONTROL-PRIMARY,
 16610           DFHEIV99,
 16611           DFHEIV99,
 16612           DFHEIV99
 16613     SET ADDRESS OF PENDING-BUSINESS TO
 16614         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 302
* EL6311.cbl
 16615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16616
 16617
 16618     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16619        MOVE -1                 TO CMAINTL
 16620        MOVE ER-2197            TO EMI-ERROR
 16621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16622        GO TO 8200-SEND-DATAONLY.
 16623
 16624     IF PB-BILLED-DT NOT = LOW-VALUES
 16625        MOVE -1                 TO CMAINTL
 16626        MOVE ER-2129            TO EMI-ERROR
 16627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16628        GO TO 8200-SEND-DATAONLY.
 16629
 16630     IF PB-CHG-COUNT NOT = ZEROS
 16631        MOVE ER-2336            TO EMI-ERROR
 16632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633        MOVE AL-UABON            TO CMAINTA
 16634        MOVE -1                  TO CMAINTL
 16635        GO TO 8200-SEND-DATAONLY.
 16636
 16637     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16638        PB-CHG-COUNT NOT = ZEROS
 16639        MOVE ER-2196             TO EMI-ERROR
 16640        MOVE AL-UABON            TO CMAINTA
 16641        MOVE -1                  TO CMAINTL
 16642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16643        GO TO 8200-SEND-DATAONLY.
 16644
 16645     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16646        MOVE ER-2900 TO EMI-ERROR
 16647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16648        MOVE AL-UABON         TO CMAINTA
 16649        MOVE -1               TO CMAINTL
 16650        GO TO 8200-SEND-DATAONLY.
 16651     move ' '                    to ws-stop-sw
 16652                                    ws-check-sw
 16653                                    ws-any-check-sw
 16654                                    ws-proc-check-sw
 16655                                    ws-chek-browse-sw
 16656
 16657     perform 2500-browse-checks  thru 2500-exit
 16658     if (i-have-processed-checks)
 16659        and (pb-c-refund-sw = 'Y')
 16660        move er-3446             to emi-error
 16661        perform 9900-error-format thru 9900-exit
 16662        move al-uabon            to cmainta
 16663        move -1                  to cmaintl
 16664        go to 8200-send-dataonly
 16665     end-if
 16666
 16667* EXEC CICS HANDLE CONDITION
 16668*         NOTFND  (2475-CONTINUE-DELETE)
 16669*    END-EXEC
 16670*    MOVE '"$I                   ! : #00014698' TO DFHEIV0
 16671     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 303
* EL6311.cbl
 16673     MOVE X'3A20233030303134363938' TO DFHEIV0(25:11)
 16674     CALL 'kxdfhei1' USING DFHEIV0
 16675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16676
 16677     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16678     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16679     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16680     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16681
 16682
 16683* EXEC CICS READ
 16684*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16685*        DATASET (FILE-ID-ELCERT)
 16686*        RIDFLD  (ELCERT-KEY)
 16687*        UPDATE
 16688*    END-EXEC.
 16689*    MOVE '&"S        EU         (   #00014707' TO DFHEIV0
 16690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16691     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16692     MOVE X'2020233030303134373037' TO DFHEIV0(25:11)
 16693     CALL 'kxdfhei1' USING DFHEIV0,
 16694           FILE-ID-ELCERT,
 16695           DFHEIV20,
 16696           DFHEIV99,
 16697           ELCERT-KEY,
 16698           DFHEIV99,
 16699           DFHEIV99,
 16700           DFHEIV99
 16701     SET ADDRESS OF CERTIFICATE-MASTER TO
 16702         DFHEIV20
 16703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16704
 16705
 16706     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16707
 16708     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16709     MOVE 'B'                    TO JP-RECORD-TYPE.
 16710     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16711     PERFORM 8400-LOG-JOURNAL-RECORD.
 16712
 16713     IF PB-CI-LIVES NOT NUMERIC
 16714         MOVE ZERO                    TO PB-CI-LIVES.
 16715
 16716     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16717        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16718           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16719           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16720           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16721                                            CM-LF-CANCEL-DT
 16722           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16723        ELSE
 16724           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16725           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16726           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16727           MOVE PB-CI-LIVES              TO CM-LIVES.
 16728
 16729     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16730        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 304
* EL6311.cbl
 16731           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16732               MOVE CM-LF-STATUS-AT-CANCEL
 16733                                        TO CM-LF-CURRENT-STATUS
 16734               MOVE SPACE
 16735                                        TO CM-LF-STATUS-AT-CANCEL
 16736           ELSE
 16737               MOVE PB-CI-LF-POLICY-STATUS
 16738                                        TO CM-LF-CURRENT-STATUS
 16739        ELSE
 16740           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16741
 16742
 16743     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16744        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16745           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16746           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16747           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16748                                            CM-AH-CANCEL-DT
 16749           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16750        ELSE
 16751           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16752           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16753           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16754           MOVE PB-CI-LIVES              TO CM-LIVES.
 16755
 16756     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16757        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16758           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16759               MOVE CM-AH-STATUS-AT-CANCEL
 16760                                        TO CM-AH-CURRENT-STATUS
 16761               MOVE SPACE
 16762                                        TO CM-AH-STATUS-AT-CANCEL
 16763           ELSE
 16764               MOVE PB-CI-AH-POLICY-STATUS
 16765                                        TO CM-AH-CURRENT-STATUS
 16766        ELSE
 16767           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16768
 16769 2450-REWRITE-CERT.
 16770     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16771     MOVE 'C'                      TO JP-RECORD-TYPE.
 16772     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16773
 16774
 16775* EXEC CICS REWRITE
 16776*        DATASET  (FILE-ID-ELCERT)
 16777*        FROM     (CERTIFICATE-MASTER)
 16778*    END-EXEC.
 16779     MOVE LENGTH OF
 16780      CERTIFICATE-MASTER
 16781       TO DFHEIV11
 16782*    MOVE '&& L                  %   #00014782' TO DFHEIV0
 16783     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16784     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16785     MOVE X'2020233030303134373832' TO DFHEIV0(25:11)
 16786     CALL 'kxdfhei1' USING DFHEIV0,
 16787           FILE-ID-ELCERT,
 16788           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 305
* EL6311.cbl
 16789           DFHEIV11,
 16790           DFHEIV99
 16791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16792
 16793
 16794     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16795
 16796     PERFORM 8400-LOG-JOURNAL-RECORD.
 16797
 16798     move ' '                    to ws-stop-sw
 16799                                    ws-any-check-sw
 16800                                    ws-proc-check-sw
 16801                                    ws-chek-browse-sw
 16802
 16803     if i-have-checks
 16804        perform until i-say-stop
 16805           perform 2510-startbr-erchek
 16806                                 thru 2510-exit
 16807           if resp-normal
 16808              perform 2520-readnext-erchek
 16809                                 thru 2520-exit
 16810           end-if
 16811           if (not resp-normal)
 16812              or (pb-control-by-account (1:33) not =
 16813                 ch-control-primary (1:33))
 16814                 set i-say-stop to true
 16815           else
 16816              perform 2530-readupd-erchek
 16817                                 thru 2530-exit
 16818              if resp-normal
 16819                 perform 2540-delete-erchek
 16820                                 thru 2540-exit
 16821              end-if
 16822              if ws-chek-browse-sw = 'Y'
 16823                 perform 2525-endbr-erchek
 16824                                 thru 2525-exit
 16825                 move ' '        to ws-chek-browse-sw
 16826              end-if
 16827           end-if
 16828        end-perform
 16829     end-if
 16830
 16831     if ws-chek-browse-sw = 'Y'
 16832        perform 2525-endbr-erchek thru 2525-exit
 16833     end-if
 16834     .
 16835 2475-CONTINUE-DELETE.
 16836     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16837     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16838
 16839     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16840     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16841
 16842     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16843
 16844     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16845     MOVE 'D'                    TO JP-RECORD-TYPE
 16846     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 306
* EL6311.cbl
 16847
 16848
 16849* EXEC CICS DELETE
 16850*        DATASET    (FILE-ID-ERPNDB)
 16851*    END-EXEC.
 16852*    MOVE '&(                    &   #00014841' TO DFHEIV0
 16853     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16854     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16855     MOVE X'2020233030303134383431' TO DFHEIV0(25:11)
 16856     CALL 'kxdfhei1' USING DFHEIV0,
 16857           FILE-ID-ERPNDB,
 16858           DFHEIV99,
 16859           DFHEIV99,
 16860           DFHEIV99,
 16861           DFHEIV99
 16862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16863
 16864
 16865     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16866
 16867     PERFORM 8400-LOG-JOURNAL-RECORD.
 16868
 16869     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16870     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16871
 16872
 16873* EXEC CICS HANDLE CONDITION
 16874*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16875*    END-EXEC.
 16876*    MOVE '"$I                   ! ; #00014852' TO DFHEIV0
 16877     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16879     MOVE X'3B20233030303134383532' TO DFHEIV0(25:11)
 16880     CALL 'kxdfhei1' USING DFHEIV0
 16881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16882
 16883
 16884
 16885* EXEC CICS READ
 16886*        SET     (ADDRESS OF PENDING-BUSINESS)
 16887*        DATASET (FILE-ID-ERPNDB)
 16888*        RIDFLD  (ERPNDB-KEY)
 16889*        UPDATE
 16890*    END-EXEC.
 16891*    MOVE '&"S        EU         (   #00014856' TO DFHEIV0
 16892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16893     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16894     MOVE X'2020233030303134383536' TO DFHEIV0(25:11)
 16895     CALL 'kxdfhei1' USING DFHEIV0,
 16896           FILE-ID-ERPNDB,
 16897           DFHEIV20,
 16898           DFHEIV99,
 16899           ERPNDB-KEY,
 16900           DFHEIV99,
 16901           DFHEIV99,
 16902           DFHEIV99
 16903     SET ADDRESS OF PENDING-BUSINESS TO
 16904         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 307
* EL6311.cbl
 16905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16906
 16907
 16908     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16909     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16910
 16911     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16912        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16913        MOVE 'D'                 TO JP-RECORD-TYPE
 16914        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16915
 16916* EXEC CICS DELETE
 16917*            DATASET    (FILE-ID-ERPNDB)
 16918*       END-EXEC
 16919*    MOVE '&(                    &   #00014870' TO DFHEIV0
 16920     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16922     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0,
 16924           FILE-ID-ERPNDB,
 16925           DFHEIV99,
 16926           DFHEIV99,
 16927           DFHEIV99,
 16928           DFHEIV99
 16929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16930        PERFORM 8400-LOG-JOURNAL-RECORD
 16931     ELSE
 16932        MOVE 'B'                 TO JP-RECORD-TYPE
 16933        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16934        PERFORM 8400-LOG-JOURNAL-RECORD
 16935        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16936        MOVE 'C'                 TO JP-RECORD-TYPE
 16937        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16938
 16939* EXEC CICS REWRITE
 16940*            DATASET    (FILE-ID-ERPNDB)
 16941*            FROM       (PENDING-BUSINESS)
 16942*       END-EXEC
 16943     MOVE LENGTH OF
 16944      PENDING-BUSINESS
 16945       TO DFHEIV11
 16946*    MOVE '&& L                  %   #00014881' TO DFHEIV0
 16947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16949     MOVE X'2020233030303134383831' TO DFHEIV0(25:11)
 16950     CALL 'kxdfhei1' USING DFHEIV0,
 16951           FILE-ID-ERPNDB,
 16952           PENDING-BUSINESS,
 16953           DFHEIV11,
 16954           DFHEIV99
 16955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16956        PERFORM 8400-LOG-JOURNAL-RECORD.
 16957
 16958******************************************************************
 16959*                                                                *
 16960*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16961*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16962*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 308
* EL6311.cbl
 16963******************************************************************
 16964
 16965     IF NOT PI-AR-PROCESSING
 16966        GO TO 2480-DELETE-FINISHED.
 16967
 16968     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16969        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16970        NEXT SENTENCE
 16971     ELSE
 16972        GO TO 2480-DELETE-FINISHED.
 16973
 16974
 16975* EXEC CICS HANDLE CONDITION
 16976*         NOTFND    (2480-DELETE-FINISHED)
 16977*    END-EXEC.
 16978*    MOVE '"$I                   ! < #00014903' TO DFHEIV0
 16979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16981     MOVE X'3C20233030303134393033' TO DFHEIV0(25:11)
 16982     CALL 'kxdfhei1' USING DFHEIV0
 16983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16984
 16985
 16986     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16987     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16988
 16989
 16990* EXEC CICS READ
 16991*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16992*        DATASET (FILE-ID-ERRQST)
 16993*        RIDFLD  (ERRQST-KEY)
 16994*        UPDATE
 16995*    END-EXEC.
 16996*    MOVE '&"S        EU         (   #00014910' TO DFHEIV0
 16997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16998     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16999     MOVE X'2020233030303134393130' TO DFHEIV0(25:11)
 17000     CALL 'kxdfhei1' USING DFHEIV0,
 17001           FILE-ID-ERRQST,
 17002           DFHEIV20,
 17003           DFHEIV99,
 17004           ERRQST-KEY,
 17005           DFHEIV99,
 17006           DFHEIV99,
 17007           DFHEIV99
 17008     SET ADDRESS OF AR-REQUEST-RECORD TO
 17009         DFHEIV20
 17010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17011
 17012
 17013     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17014
 17015     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17016
 17017     MOVE 'D'                      TO JP-RECORD-TYPE.
 17018     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17019
 17020
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 309
* EL6311.cbl
 17021* EXEC CICS DELETE
 17022*         DATASET    (FILE-ID-ERRQST)
 17023*    END-EXEC.
 17024*    MOVE '&(                    &   #00014924' TO DFHEIV0
 17025     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17027     MOVE X'2020233030303134393234' TO DFHEIV0(25:11)
 17028     CALL 'kxdfhei1' USING DFHEIV0,
 17029           FILE-ID-ERRQST,
 17030           DFHEIV99,
 17031           DFHEIV99,
 17032           DFHEIV99,
 17033           DFHEIV99
 17034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17035
 17036
 17037     PERFORM 8400-LOG-JOURNAL-RECORD.
 17038
 17039 2480-DELETE-FINISHED.
 17040     MOVE ZEROS                  TO EMI-ERROR.
 17041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17042     MOVE LOW-VALUES             TO EL631CI.
 17043     MOVE -1                     TO CMAINTL.
 17044     GO TO 8100-SEND-INITIAL-MAP.
 17045
 17046 2485-BATCH-HDR-NOT-FOUND.
 17047     MOVE -1                     TO CMAINTL
 17048     MOVE AL-UABON               TO CMAINTA.
 17049     MOVE ER-7450                TO EMI-ERROR.
 17050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17051     GO TO 8200-SEND-DATAONLY.
 17052
 17053 2490-RECORD-NOT-FOUND.
 17054     MOVE -1                     TO CMAINTL
 17055     MOVE AL-UABON               TO CMAINTA.
 17056     MOVE ER-7451                TO EMI-ERROR.
 17057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17058     GO TO 8200-SEND-DATAONLY.
 17059***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17060***                                                            ***
 17061***     2500  B R O W S E   C H E C K S                        ***
 17062***  We perform this routine from 2 different places.          ***
 17063***  1. If the user changes the refund amount on a cancel, we  ***
 17064***    want to.........                                        ***
 17065***    a. determine if prior checks have been processed        ***
 17066***    b. If the amt is larger, display message instructing    ***
 17067***     them to create another check to make up the difference.***
 17068***    c. If the amt is less, do not allow the change and      ***
 17069***     display a FATAL error suggesting they deal with check  ***
 17070***     records befor continuing.                              ***
 17071***  2. If the user wants to delete a cancel record we......   ***
 17072***    a. browse through all the checks and if there is a      ***
 17073***     processed check, send FATAL message.                   ***
 17074***    b. If there is a non-released check, then delete that   ***
 17075***     check after you delete the pending cancel record.      ***
 17076***                                                            ***
 17077***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 17078
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 310
* EL6311.cbl
 17079 2500-browse-checks.
 17080
 17081     perform 2510-startbr-erchek thru 2510-exit
 17082
 17083     if not resp-normal
 17084        go to 2500-exit
 17085     end-if
 17086
 17087     perform until i-say-stop
 17088        perform 2520-readnext-erchek
 17089                                 thru 2520-exit
 17090        if (not resp-normal)
 17091           or (pb-control-by-account (1:33) not =
 17092              ch-control-primary (1:33))
 17093              set i-say-stop to true
 17094        else
 17095           set i-have-a-check-period to true
 17096           if (ch-approval-status) = ' '
 17097              and (ch-void-dt = low-values)
 17098              and (ch-released-dt = low-values)
 17099              set i-have-checks to true
 17100           else
 17101              if ch-void-dt = low-values
 17102                 set i-have-processed-checks to true
 17103              end-if
 17104           end-if
 17105           if (ch-credit-accept-dt = low-values)
 17106              and (ch-void-dt = low-values)
 17107              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17108              if (ch-check-origin-sw not = 'R')
 17109                 and (pb-record-type = '2')
 17110                 continue
 17111              else
 17112                 compute ws-check-amts =
 17113                    ws-check-amts + ch-amount-paid
 17114              end-if
 17115           end-if
 17116        end-if
 17117     end-perform
 17118
 17119     if ws-chek-browse-sw = 'Y'
 17120        perform 2525-endbr-erchek thru 2525-exit
 17121     end-if
 17122
 17123    .
 17124 2500-exit.
 17125     exit.
 17126
 17127 2510-startbr-erchek.
 17128
 17129     move pb-control-by-account  to erchek-key
 17130     move +0                     to chek-record-seq
 17131
 17132
 17133* exec cics startbr
 17134*       dataset   ('ERCHEK')
 17135*       ridfld    (erchek-key)
 17136*       gteq
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 311
* EL6311.cbl
 17137*       resp      (ws-response)
 17138*    end-exec
 17139     MOVE 'ERCHEK' TO DFHEIV1
 17140     MOVE 0
 17141       TO DFHEIV11
 17142*    MOVE '&,         G          &  N#00015023' TO DFHEIV0
 17143     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17144     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17145     MOVE X'204E233030303135303233' TO DFHEIV0(25:11)
 17146     CALL 'kxdfhei1' USING DFHEIV0,
 17147           DFHEIV1,
 17148           erchek-key,
 17149           DFHEIV99,
 17150           DFHEIV11,
 17151           DFHEIV99
 17152     MOVE EIBRESP  TO ws-response
 17153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17154
 17155     IF RESP-NORMAL
 17156        move 'Y'                 to ws-chek-browse-sw
 17157     end-if
 17158
 17159     .
 17160 2510-exit.
 17161     exit.
 17162
 17163 2520-readnext-erchek.
 17164
 17165
 17166* EXEC CICS READNEXT
 17167*       SET     (ADDRESS OF CHECK-RECORDS)
 17168*       DATASET ('ERCHEK')
 17169*       RIDFLD  (ERCHEK-KEY)
 17170*       RESP    (WS-RESPONSE)
 17171*    END-EXEC
 17172     MOVE 'ERCHEK' TO DFHEIV1
 17173     MOVE 0
 17174       TO DFHEIV11
 17175*    MOVE '&.S                   )  N#00015040' TO DFHEIV0
 17176     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17177     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17178     MOVE X'204E233030303135303430' TO DFHEIV0(25:11)
 17179     CALL 'kxdfhei1' USING DFHEIV0,
 17180           DFHEIV1,
 17181           DFHEIV20,
 17182           DFHEIV99,
 17183           ERCHEK-KEY,
 17184           DFHEIV99,
 17185           DFHEIV11,
 17186           DFHEIV99,
 17187           DFHEIV99
 17188     SET ADDRESS OF CHECK-RECORDS TO
 17189         DFHEIV20
 17190     MOVE EIBRESP  TO WS-RESPONSE
 17191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17192
 17193     .
 17194 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 312
* EL6311.cbl
 17195     exit.
 17196
 17197 2525-endbr-erchek.
 17198
 17199
 17200* exec cics endbr
 17201*       dataset  ('ERCHEK')
 17202*    end-exec
 17203     MOVE 'ERCHEK' TO DFHEIV1
 17204     MOVE 0
 17205       TO DFHEIV11
 17206*    MOVE '&2                    $   #00015053' TO DFHEIV0
 17207     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17209     MOVE X'2020233030303135303533' TO DFHEIV0(25:11)
 17210     CALL 'kxdfhei1' USING DFHEIV0,
 17211           DFHEIV1,
 17212           DFHEIV11,
 17213           DFHEIV99
 17214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17215
 17216     .
 17217 2525-exit.
 17218     exit.
 17219
 17220 2530-readupd-erchek.
 17221
 17222
 17223* EXEC CICS READ
 17224*       UPDATE
 17225*       SET     (ADDRESS OF CHECK-RECORDS)
 17226*       DATASET ('ERCHEK')
 17227*       RIDFLD  (ERCHEK-KEY)
 17228*       RESP    (WS-RESPONSE)
 17229*    END-EXEC
 17230     MOVE 'ERCHEK' TO DFHEIV1
 17231*    MOVE '&"S        EU         (  N#00015063' TO DFHEIV0
 17232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17233     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17234     MOVE X'204E233030303135303633' TO DFHEIV0(25:11)
 17235     CALL 'kxdfhei1' USING DFHEIV0,
 17236           DFHEIV1,
 17237           DFHEIV20,
 17238           DFHEIV99,
 17239           ERCHEK-KEY,
 17240           DFHEIV99,
 17241           DFHEIV99,
 17242           DFHEIV99
 17243     SET ADDRESS OF CHECK-RECORDS TO
 17244         DFHEIV20
 17245     MOVE EIBRESP  TO WS-RESPONSE
 17246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17247
 17248     .
 17249 2530-exit.
 17250     exit.
 17251
 17252 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 313
* EL6311.cbl
 17253
 17254
 17255* EXEC CICS DELETE
 17256*       DATASET ('ERCHEK')
 17257*       RESP    (WS-RESPONSE)
 17258*    END-EXEC
 17259     MOVE 'ERCHEK' TO DFHEIV1
 17260*    MOVE '&(                    &  N#00015077' TO DFHEIV0
 17261     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17263     MOVE X'204E233030303135303737' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0,
 17265           DFHEIV1,
 17266           DFHEIV99,
 17267           DFHEIV99,
 17268           DFHEIV99,
 17269           DFHEIV99
 17270     MOVE EIBRESP  TO WS-RESPONSE
 17271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17272
 17273     .
 17274 2540-exit.
 17275     exit.
 17276***************************************************************
 17277*                                                             *
 17278*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17279*                                                             *
 17280***************************************************************
 17281
 17282***************************************************************
 17283*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17284*     AN ALREADY BILLED RECORD.                               *
 17285***************************************************************
 17286
 17287 2700-BUILD-CORRECTION-RECORD.
 17288     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17289     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17290     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17291     MOVE '5'                    TO DC-OPTION-CODE.
 17292     PERFORM 9700-DATE-LINK.
 17293     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17294
 17295     IF PB-CHG-COUNT = ZEROS
 17296        MOVE +1                  TO WS-SEQ-SAVE
 17297     ELSE
 17298        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17299
 17300     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17301     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17302
 17303     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17304
 17305     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17306     MOVE 'A'                    TO JP-RECORD-TYPE.
 17307     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17308
 17309
 17310* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 314
* EL6311.cbl
 17311*        DATASET    (FILE-ID-ERPNDB)
 17312*        FROM       (PENDING-BUSINESS)
 17313*        RIDFLD     (PB-CONTROL-PRIMARY)
 17314*    END-EXEC.
 17315     MOVE LENGTH OF
 17316      PENDING-BUSINESS
 17317       TO DFHEIV11
 17318*    MOVE '&$ L                  ''   #00015118' TO DFHEIV0
 17319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17321     MOVE X'2020233030303135313138' TO DFHEIV0(25:11)
 17322     CALL 'kxdfhei1' USING DFHEIV0,
 17323           FILE-ID-ERPNDB,
 17324           PENDING-BUSINESS,
 17325           DFHEIV11,
 17326           PB-CONTROL-PRIMARY,
 17327           DFHEIV99,
 17328           DFHEIV99
 17329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17330
 17331
 17332     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17333
 17334     PERFORM 8400-LOG-JOURNAL-RECORD.
 17335
 17336 2799-EXIT.
 17337      EXIT.
 17338
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 315
* EL6311.cbl
 17340
 17341******************************************************************
 17342*                                                                *
 17343*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17344*                                                                *
 17345******************************************************************
 17346
 17347 2800-REWRITE-ISSUE-CERT-KEY.
 17348     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17349
 17350     IF  BCERTNOL GREATER THAN ZEROS
 17351         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17352
 17353     IF  BSUFIXL  GREATER THAN ZEROS
 17354         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17355
 17356     IF  BEFFDTL  GREATER THAN ZEROS
 17357         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17358
 17359 2810-READ-BY-ACCOUNT.
 17360
 17361* EXEC CICS HANDLE CONDITION
 17362*         NOTFND    (2820-PROCESS-REWRITE)
 17363*    END-EXEC.
 17364*    MOVE '"$I                   ! = #00015152' TO DFHEIV0
 17365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17367     MOVE X'3D20233030303135313532' TO DFHEIV0(25:11)
 17368     CALL 'kxdfhei1' USING DFHEIV0
 17369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17370
 17371
 17372***  read pndb using new key
 17373
 17374* EXEC CICS READ
 17375*        SET     (ADDRESS OF PENDING-BUSINESS)
 17376*        DATASET (FILE-ID-ERPNDB2)
 17377*        RIDFLD  (ERPNDB-ALT-KEY)
 17378*    END-EXEC.
 17379*    MOVE '&"S        E          (   #00015157' TO DFHEIV0
 17380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17382     MOVE X'2020233030303135313537' TO DFHEIV0(25:11)
 17383     CALL 'kxdfhei1' USING DFHEIV0,
 17384           FILE-ID-ERPNDB2,
 17385           DFHEIV20,
 17386           DFHEIV99,
 17387           ERPNDB-ALT-KEY,
 17388           DFHEIV99,
 17389           DFHEIV99,
 17390           DFHEIV99
 17391     SET ADDRESS OF PENDING-BUSINESS TO
 17392         DFHEIV20
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17394
 17395
 17396     GO TO 2890-DUPLICATE-RECORD.
 17397
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 316
* EL6311.cbl
 17398  2820-PROCESS-REWRITE.
 17399
 17400* EXEC CICS HANDLE CONDITION
 17401*         NOTFND    (2885-RECORD-MISSING)
 17402*    END-EXEC.
 17403*    MOVE '"$I                   ! > #00015166' TO DFHEIV0
 17404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17406     MOVE X'3E20233030303135313636' TO DFHEIV0(25:11)
 17407     CALL 'kxdfhei1' USING DFHEIV0
 17408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17409
 17410
 17411     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17412
 17413***  read pndb using original key
 17414
 17415* EXEC CICS READ
 17416*        SET     (ADDRESS OF PENDING-BUSINESS)
 17417*        DATASET (FILE-ID-ERPNDB)
 17418*        RIDFLD  (ERPNDB-KEY)
 17419*        UPDATE
 17420*    END-EXEC.
 17421*    MOVE '&"S        EU         (   #00015173' TO DFHEIV0
 17422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17423     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17424     MOVE X'2020233030303135313733' TO DFHEIV0(25:11)
 17425     CALL 'kxdfhei1' USING DFHEIV0,
 17426           FILE-ID-ERPNDB,
 17427           DFHEIV20,
 17428           DFHEIV99,
 17429           ERPNDB-KEY,
 17430           DFHEIV99,
 17431           DFHEIV99,
 17432           DFHEIV99
 17433     SET ADDRESS OF PENDING-BUSINESS TO
 17434         DFHEIV20
 17435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17436
 17437
 17438     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17439     MOVE 'D'                    TO JP-RECORD-TYPE.
 17440     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17441     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17442
 17443     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17444
 17445     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17446     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17447     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17448
 17449***  delete pndb using original key
 17450
 17451* EXEC CICS DELETE
 17452*        DATASET    (FILE-ID-ERPNDB)
 17453*    END-EXEC.
 17454*    MOVE '&(                    &   #00015192' TO DFHEIV0
 17455     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 317
* EL6311.cbl
 17456     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17457     MOVE X'2020233030303135313932' TO DFHEIV0(25:11)
 17458     CALL 'kxdfhei1' USING DFHEIV0,
 17459           FILE-ID-ERPNDB,
 17460           DFHEIV99,
 17461           DFHEIV99,
 17462           DFHEIV99,
 17463           DFHEIV99
 17464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17465
 17466
 17467     PERFORM 8400-LOG-JOURNAL-RECORD.
 17468
 17469
 17470* EXEC CICS GETMAIN
 17471*        SET      (ADDRESS OF PENDING-BUSINESS)
 17472*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17473*        INITIMG  (GETMAIN-SPACE)
 17474*    END-EXEC.
 17475*    MOVE ',"IL                  $   #00015198' TO DFHEIV0
 17476     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17478     MOVE X'2020233030303135313938' TO DFHEIV0(25:11)
 17479     CALL 'kxdfhei1' USING DFHEIV0,
 17480           DFHEIV20,
 17481           ERPNDB-RECORD-LENGTH,
 17482           GETMAIN-SPACE
 17483     SET ADDRESS OF PENDING-BUSINESS TO
 17484         DFHEIV20
 17485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17486
 17487
 17488***  pending-business now has original record
 17489     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17490
 17491
 17492* EXEC CICS HANDLE CONDITION
 17493*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17494*    END-EXEC.
 17495*    MOVE '"$I                   ! ? #00015207' TO DFHEIV0
 17496     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17498     MOVE X'3F20233030303135323037' TO DFHEIV0(25:11)
 17499     CALL 'kxdfhei1' USING DFHEIV0
 17500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17501
 17502
 17503***  read elcert using original key
 17504
 17505* EXEC CICS READ
 17506*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17507*        DATASET (FILE-ID-ELCERT)
 17508*        RIDFLD  (ELCERT-KEY)
 17509*        UPDATE
 17510*    END-EXEC.
 17511*    MOVE '&"S        EU         (   #00015212' TO DFHEIV0
 17512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17513     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 318
* EL6311.cbl
 17514     MOVE X'2020233030303135323132' TO DFHEIV0(25:11)
 17515     CALL 'kxdfhei1' USING DFHEIV0,
 17516           FILE-ID-ELCERT,
 17517           DFHEIV20,
 17518           DFHEIV99,
 17519           ELCERT-KEY,
 17520           DFHEIV99,
 17521           DFHEIV99,
 17522           DFHEIV99
 17523     SET ADDRESS OF CERTIFICATE-MASTER TO
 17524         DFHEIV20
 17525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17526
 17527
 17528     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17529     MOVE 'B'                    TO JP-RECORD-TYPE
 17530     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17531     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17532
 17533     IF INSURED-ADDR-PRESENT
 17534        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17535
 17536     IF CERT-NOTES-ARE-NOT-PRESENT
 17537        MOVE SPACE               TO WS-CERT-NOTE-SW
 17538     ELSE
 17539        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17540
 17541     IF CERT-ADDED-BATCH      OR
 17542        CERT-AND-CLAIM-ONLINE OR
 17543        CERT-WAS-CREATED-FOR-CLAIM
 17544        NEXT SENTENCE
 17545     ELSE
 17546        GO TO 2825-DELETE-CERTIFICATE.
 17547
 17548     PERFORM 8400-LOG-JOURNAL-RECORD.
 17549
 17550*********************************************************
 17551** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17552     IF CERT-ADDED-BATCH
 17553         GO TO 2822-REWRITE-ELCERT.
 17554*********************************************************
 17555
 17556     IF NO-CLAIM-ATTACHED
 17557        NEXT SENTENCE
 17558     ELSE
 17559        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17560        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17561
 17562 2822-REWRITE-ELCERT.
 17563     MOVE 'C'                    TO JP-RECORD-TYPE
 17564     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17565
 17566     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17567
 17568
 17569* EXEC CICS REWRITE
 17570*         DATASET    (FILE-ID-ELCERT)
 17571*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 319
* EL6311.cbl
 17572*    END-EXEC.
 17573     MOVE LENGTH OF
 17574      CERTIFICATE-MASTER
 17575       TO DFHEIV11
 17576*    MOVE '&& L                  %   #00015259' TO DFHEIV0
 17577     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17579     MOVE X'2020233030303135323539' TO DFHEIV0(25:11)
 17580     CALL 'kxdfhei1' USING DFHEIV0,
 17581           FILE-ID-ELCERT,
 17582           CERTIFICATE-MASTER,
 17583           DFHEIV11,
 17584           DFHEIV99
 17585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17586
 17587
 17588     PERFORM 8400-LOG-JOURNAL-RECORD.
 17589
 17590     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17591
 17592 2825-DELETE-CERTIFICATE.
 17593     MOVE 'D'                      TO JP-RECORD-TYPE.
 17594     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17595
 17596     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17597
 17598
 17599* EXEC CICS DELETE
 17600*         DATASET    (FILE-ID-ELCERT)
 17601*    END-EXEC.
 17602*    MOVE '&(                    &   #00015274' TO DFHEIV0
 17603     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17605     MOVE X'2020233030303135323734' TO DFHEIV0(25:11)
 17606     CALL 'kxdfhei1' USING DFHEIV0,
 17607           FILE-ID-ELCERT,
 17608           DFHEIV99,
 17609           DFHEIV99,
 17610           DFHEIV99,
 17611           DFHEIV99
 17612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17613
 17614
 17615     PERFORM 8400-LOG-JOURNAL-RECORD.
 17616
 17617******************************************************************
 17618*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17619******************************************************************
 17620
 17621     IF CERT-NOTES-ARE-PRESENT
 17622        NEXT SENTENCE
 17623     ELSE
 17624        GO TO 2827-DELETE-MAILING.
 17625
 17626
 17627* EXEC CICS HANDLE CONDITION
 17628*         NOTFND  (2827-DELETE-MAILING)
 17629*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 320
* EL6311.cbl
 17630*    MOVE '"$I                   ! @ #00015289' TO DFHEIV0
 17631     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17633     MOVE X'4020233030303135323839' TO DFHEIV0(25:11)
 17634     CALL 'kxdfhei1' USING DFHEIV0
 17635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17636
 17637
 17638
 17639* EXEC CICS READ
 17640*        EQUAL
 17641*        DATASET   (FILE-ID-ERNOTE)
 17642*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17643*        RIDFLD    (ELCERT-KEY)
 17644*        UPDATE
 17645*    END-EXEC.
 17646*    MOVE '&"S        EU         (   #00015293' TO DFHEIV0
 17647     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17648     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17649     MOVE X'2020233030303135323933' TO DFHEIV0(25:11)
 17650     CALL 'kxdfhei1' USING DFHEIV0,
 17651           FILE-ID-ERNOTE,
 17652           DFHEIV20,
 17653           DFHEIV99,
 17654           ELCERT-KEY,
 17655           DFHEIV99,
 17656           DFHEIV99,
 17657           DFHEIV99
 17658     SET ADDRESS OF CERTIFICATE-NOTE TO
 17659         DFHEIV20
 17660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17661
 17662
 17663     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17664     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17665     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17666
 17667     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17668
 17669
 17670* EXEC CICS DELETE
 17671*        DATASET   (FILE-ID-ERNOTE)
 17672*    END-EXEC.
 17673*    MOVE '&(                    &   #00015307' TO DFHEIV0
 17674     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17675     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17676     MOVE X'2020233030303135333037' TO DFHEIV0(25:11)
 17677     CALL 'kxdfhei1' USING DFHEIV0,
 17678           FILE-ID-ERNOTE,
 17679           DFHEIV99,
 17680           DFHEIV99,
 17681           DFHEIV99,
 17682           DFHEIV99
 17683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17684
 17685
 17686     PERFORM 8400-LOG-JOURNAL-RECORD.
 17687
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 321
* EL6311.cbl
 17688******************************************************************
 17689*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17690******************************************************************
 17691
 17692 2827-DELETE-MAILING.
 17693     IF CERT-ADDRESS-PRESENT
 17694        NEXT SENTENCE
 17695     ELSE
 17696        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17697
 17698
 17699* EXEC CICS HANDLE CONDITION
 17700*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17701*    END-EXEC.
 17702*    MOVE '"$I                   ! A #00015323' TO DFHEIV0
 17703     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17705     MOVE X'4120233030303135333233' TO DFHEIV0(25:11)
 17706     CALL 'kxdfhei1' USING DFHEIV0
 17707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17708
 17709
 17710     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17711
 17712
 17713* EXEC CICS READ
 17714*        EQUAL
 17715*        DATASET   (FILE-ID-ERMAIL)
 17716*        SET       (ADDRESS OF MAILING-DATA)
 17717*        RIDFLD    (ERMAIL-KEY)
 17718*        UPDATE
 17719*    END-EXEC.
 17720*    MOVE '&"S        EU         (   #00015329' TO DFHEIV0
 17721     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17722     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17723     MOVE X'2020233030303135333239' TO DFHEIV0(25:11)
 17724     CALL 'kxdfhei1' USING DFHEIV0,
 17725           FILE-ID-ERMAIL,
 17726           DFHEIV20,
 17727           DFHEIV99,
 17728           ERMAIL-KEY,
 17729           DFHEIV99,
 17730           DFHEIV99,
 17731           DFHEIV99
 17732     SET ADDRESS OF MAILING-DATA TO
 17733         DFHEIV20
 17734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17735
 17736
 17737     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17738     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17739     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17740
 17741     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17742
 17743
 17744* EXEC CICS DELETE
 17745*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 322
* EL6311.cbl
 17746*    END-EXEC.
 17747*    MOVE '&(                    &   #00015343' TO DFHEIV0
 17748     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17750     MOVE X'2020233030303135333433' TO DFHEIV0(25:11)
 17751     CALL 'kxdfhei1' USING DFHEIV0,
 17752           FILE-ID-ERMAIL,
 17753           DFHEIV99,
 17754           DFHEIV99,
 17755           DFHEIV99,
 17756           DFHEIV99
 17757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17758
 17759
 17760     PERFORM 8400-LOG-JOURNAL-RECORD.
 17761
 17762 2830-BUILD-NEW-ISSUE-RECORD.
 17763     MOVE SPACES                 TO ELCERT-KEY.
 17764
 17765     IF  BCERTNOL GREATER THAN ZEROS
 17766         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17767
 17768     IF  BSUFIXL  GREATER THAN ZEROS
 17769         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17770
 17771     IF BEFFDTL GREATER THAN ZEROS
 17772        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17773
 17774 2870-WRITE-PENDING-BUSINESS.
 17775     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17776     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17777     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17778     MOVE '5'                    TO DC-OPTION-CODE.
 17779     PERFORM 9700-DATE-LINK.
 17780     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17781
 17782     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17783
 17784     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17785     MOVE 'A'                    TO JP-RECORD-TYPE.
 17786     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17787
 17788
 17789* EXEC CICS WRITE
 17790*        DATASET  (FILE-ID-ERPNDB)
 17791*        FROM     (PENDING-BUSINESS)
 17792*        RIDFLD   (PB-CONTROL-PRIMARY)
 17793*    END-EXEC.
 17794     MOVE LENGTH OF
 17795      PENDING-BUSINESS
 17796       TO DFHEIV11
 17797*    MOVE '&$ L                  ''   #00015375' TO DFHEIV0
 17798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17800     MOVE X'2020233030303135333735' TO DFHEIV0(25:11)
 17801     CALL 'kxdfhei1' USING DFHEIV0,
 17802           FILE-ID-ERPNDB,
 17803           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 323
* EL6311.cbl
 17804           DFHEIV11,
 17805           PB-CONTROL-PRIMARY,
 17806           DFHEIV99,
 17807           DFHEIV99
 17808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17809
 17810
 17811     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17812
 17813     PERFORM 8400-LOG-JOURNAL-RECORD.
 17814
 17815     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17816
 17817 2885-RECORD-MISSING.
 17818     MOVE -1                     TO BMAINTL
 17819     MOVE AL-UABON               TO BMAINTA
 17820     MOVE ER-2902                TO EMI-ERROR.
 17821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17822     GO TO 8200-SEND-DATAONLY.
 17823
 17824 2890-DUPLICATE-RECORD.
 17825     MOVE -1                     TO BMAINTL.
 17826     MOVE AL-UABON               TO BCERTNOA.
 17827     MOVE AL-UNBON               TO BEFFDTA.
 17828     MOVE SPACE                  TO BMAINTI.
 17829
 17830     MOVE 1                      TO EMI-SUB
 17831                                    EMI-SWITCH1
 17832                                    EMI-SWITCH-AREA-1
 17833                                    EMI-SWITCH-AREA-2.
 17834
 17835     MOVE SPACES                 TO EMI-ERROR-LINES.
 17836
 17837
 17838* EXEC CICS SYNCPOINT ROLLBACK
 17839*    END-EXEC.
 17840*    MOVE '6"R                   !   #00015407' TO DFHEIV0
 17841     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17843     MOVE X'2020233030303135343037' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17846
 17847
 17848     MOVE ER-2247                TO EMI-ERROR.
 17849     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17850     GO TO 8200-SEND-DATAONLY.
 17851
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 324
* EL6311.cbl
 17853
 17854******************************************************************
 17855*                                                                *
 17856*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17857*                                                                *
 17858******************************************************************
 17859
 17860 2900-REWRITE-CAN-CERT-KEY.
 17861     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17862
 17863     IF  CCERTNOL GREATER THAN ZEROS
 17864         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17865
 17866     IF  CSUFIXL  GREATER THAN ZEROS
 17867         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17868
 17869     IF  CEFFDTL  GREATER THAN ZEROS
 17870         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17871
 17872 2910-READ-BY-ACCOUNT.
 17873
 17874* EXEC CICS HANDLE CONDITION
 17875*         NOTFND    (2920-PROCESS-REWRITE)
 17876*    END-EXEC.
 17877*    MOVE '"$I                   ! B #00015435' TO DFHEIV0
 17878     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17880     MOVE X'4220233030303135343335' TO DFHEIV0(25:11)
 17881     CALL 'kxdfhei1' USING DFHEIV0
 17882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17883
 17884
 17885
 17886* EXEC CICS READ
 17887*        SET     (ADDRESS OF PENDING-BUSINESS)
 17888*        DATASET (FILE-ID-ERPNDB2)
 17889*        RIDFLD  (ERPNDB-ALT-KEY)
 17890*    END-EXEC.
 17891*    MOVE '&"S        E          (   #00015439' TO DFHEIV0
 17892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17894     MOVE X'2020233030303135343339' TO DFHEIV0(25:11)
 17895     CALL 'kxdfhei1' USING DFHEIV0,
 17896           FILE-ID-ERPNDB2,
 17897           DFHEIV20,
 17898           DFHEIV99,
 17899           ERPNDB-ALT-KEY,
 17900           DFHEIV99,
 17901           DFHEIV99,
 17902           DFHEIV99
 17903     SET ADDRESS OF PENDING-BUSINESS TO
 17904         DFHEIV20
 17905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17906
 17907
 17908     GO TO 2990-DUPLICATE-RECORD.
 17909
 17910  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 325
* EL6311.cbl
 17911
 17912* EXEC CICS HANDLE CONDITION
 17913*         NOTFND    (2985-RECORD-MISSING)
 17914*    END-EXEC.
 17915*    MOVE '"$I                   ! C #00015448' TO DFHEIV0
 17916     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17918     MOVE X'4320233030303135343438' TO DFHEIV0(25:11)
 17919     CALL 'kxdfhei1' USING DFHEIV0
 17920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17921
 17922
 17923     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17924
 17925
 17926* EXEC CICS READ
 17927*        SET     (ADDRESS OF PENDING-BUSINESS)
 17928*        DATASET (FILE-ID-ERPNDB)
 17929*        RIDFLD  (ERPNDB-KEY)
 17930*        UPDATE
 17931*    END-EXEC.
 17932*    MOVE '&"S        EU         (   #00015454' TO DFHEIV0
 17933     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17934     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17935     MOVE X'2020233030303135343534' TO DFHEIV0(25:11)
 17936     CALL 'kxdfhei1' USING DFHEIV0,
 17937           FILE-ID-ERPNDB,
 17938           DFHEIV20,
 17939           DFHEIV99,
 17940           ERPNDB-KEY,
 17941           DFHEIV99,
 17942           DFHEIV99,
 17943           DFHEIV99
 17944     SET ADDRESS OF PENDING-BUSINESS TO
 17945         DFHEIV20
 17946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17947
 17948
 17949     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17950     MOVE 'D'                    TO JP-RECORD-TYPE.
 17951     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17952     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17953
 17954     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17955
 17956     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17957     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17958     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17959
 17960
 17961* EXEC CICS DELETE
 17962*        DATASET    (FILE-ID-ERPNDB)
 17963*    END-EXEC.
 17964*    MOVE '&(                    &   #00015472' TO DFHEIV0
 17965     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17967     MOVE X'2020233030303135343732' TO DFHEIV0(25:11)
 17968     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 326
* EL6311.cbl
 17969           FILE-ID-ERPNDB,
 17970           DFHEIV99,
 17971           DFHEIV99,
 17972           DFHEIV99,
 17973           DFHEIV99
 17974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17975
 17976
 17977     PERFORM 8400-LOG-JOURNAL-RECORD.
 17978
 17979
 17980* EXEC CICS GETMAIN
 17981*        SET      (ADDRESS OF PENDING-BUSINESS)
 17982*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17983*        INITIMG  (GETMAIN-SPACE)
 17984*    END-EXEC.
 17985*    MOVE ',"IL                  $   #00015478' TO DFHEIV0
 17986     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17987     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17988     MOVE X'2020233030303135343738' TO DFHEIV0(25:11)
 17989     CALL 'kxdfhei1' USING DFHEIV0,
 17990           DFHEIV20,
 17991           ERPNDB-RECORD-LENGTH,
 17992           GETMAIN-SPACE
 17993     SET ADDRESS OF PENDING-BUSINESS TO
 17994         DFHEIV20
 17995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17996
 17997
 17998     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17999
 18000 2950-PROCESS-CANCELS.
 18001
 18002
 18003* EXEC CICS HANDLE CONDITION
 18004*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 18005*    END-EXEC.
 18006*    MOVE '"$I                   ! D #00015488' TO DFHEIV0
 18007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18009     MOVE X'4420233030303135343838' TO DFHEIV0(25:11)
 18010     CALL 'kxdfhei1' USING DFHEIV0
 18011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18012
 18013
 18014
 18015* EXEC CICS READ
 18016*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 18017*        DATASET (FILE-ID-ELCERT)
 18018*        RIDFLD  (ELCERT-KEY)
 18019*        UPDATE
 18020*    END-EXEC.
 18021*    MOVE '&"S        EU         (   #00015492' TO DFHEIV0
 18022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18023     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18024     MOVE X'2020233030303135343932' TO DFHEIV0(25:11)
 18025     CALL 'kxdfhei1' USING DFHEIV0,
 18026           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 327
* EL6311.cbl
 18027           DFHEIV20,
 18028           DFHEIV99,
 18029           ELCERT-KEY,
 18030           DFHEIV99,
 18031           DFHEIV99,
 18032           DFHEIV99
 18033     SET ADDRESS OF CERTIFICATE-MASTER TO
 18034         DFHEIV20
 18035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18036
 18037
 18038     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18039
 18040     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 18041     MOVE 'B'                      TO JP-RECORD-TYPE.
 18042     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18043     PERFORM 8400-LOG-JOURNAL-RECORD.
 18044
 18045     IF PB-CI-LIVES NOT NUMERIC
 18046         MOVE ZERO                    TO PB-CI-LIVES.
 18047
 18048     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18049        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18050        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 18051        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 18052                                         CM-LF-CANCEL-DT
 18053     ELSE
 18054        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18055        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 18056        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 18057        MOVE PB-CI-LIVES              TO CM-LIVES.
 18058
 18059     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18060        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18061            MOVE CM-LF-STATUS-AT-CANCEL
 18062                                     TO CM-LF-CURRENT-STATUS
 18063            MOVE SPACE
 18064                                     TO CM-LF-STATUS-AT-CANCEL
 18065        ELSE
 18066            MOVE PB-CI-LF-POLICY-STATUS
 18067                                     TO CM-LF-CURRENT-STATUS
 18068     ELSE
 18069        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 18070
 18071     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18072        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18073        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 18074        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 18075                                         CM-AH-CANCEL-DT
 18076     ELSE
 18077        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18078        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 18079        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 18080        MOVE PB-CI-LIVES              TO CM-LIVES.
 18081
 18082     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18083        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18084            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 328
* EL6311.cbl
 18085                                     TO CM-AH-CURRENT-STATUS
 18086            MOVE SPACE
 18087                                     TO CM-AH-STATUS-AT-CANCEL
 18088        ELSE
 18089            MOVE PB-CI-AH-POLICY-STATUS
 18090                                     TO CM-AH-CURRENT-STATUS
 18091     ELSE
 18092        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 18093
 18094 2975-REWRITE-CERT.
 18095     MOVE 'C'                      TO JP-RECORD-TYPE.
 18096     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18097
 18098
 18099* EXEC CICS REWRITE
 18100*        DATASET    (FILE-ID-ELCERT)
 18101*        FROM       (CERTIFICATE-MASTER)
 18102*    END-EXEC.
 18103     MOVE LENGTH OF
 18104      CERTIFICATE-MASTER
 18105       TO DFHEIV11
 18106*    MOVE '&& L                  %   #00015559' TO DFHEIV0
 18107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18109     MOVE X'2020233030303135353539' TO DFHEIV0(25:11)
 18110     CALL 'kxdfhei1' USING DFHEIV0,
 18111           FILE-ID-ELCERT,
 18112           CERTIFICATE-MASTER,
 18113           DFHEIV11,
 18114           DFHEIV99
 18115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18116
 18117
 18118     PERFORM 8400-LOG-JOURNAL-RECORD.
 18119
 18120 2960-BUILD-NEW-CANCEL-RECORD.
 18121     IF  CCERTNOL GREATER THAN ZEROS
 18122         MOVE CCERTNOI            TO PB-CERT-PRIME.
 18123
 18124     IF  CSUFIXL  GREATER THAN ZEROS
 18125         MOVE CSUFIXI             TO PB-CERT-SFX.
 18126
 18127     IF  CEFFDTL  GREATER  THAN ZEROS
 18128         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 18129
 18130 2970-WRITE-PENDING-BUSINESS.
 18131     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 18132     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 18133     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 18134     MOVE '5'                    TO DC-OPTION-CODE.
 18135     PERFORM 9700-DATE-LINK.
 18136     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 18137
 18138     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 18139
 18140     MOVE SPACES                 TO PB-CI-INSURED-NAME
 18141                                    PB-CI-INSURED-SEX
 18142                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 329
* EL6311.cbl
 18143                                    PB-CI-AH-BENEFIT-CD
 18144                                    PB-CI-RATE-CLASS
 18145                                    PB-CI-RATE-DEV-LF
 18146                                    PB-CI-RATE-DEV-AH
 18147                                    PB-CI-LF-ABBR
 18148                                    PB-CI-AH-ABBR
 18149                                    PB-CI-OB-FLAG
 18150                                    PB-CI-LF-POLICY-STATUS
 18151                                    PB-CI-AH-POLICY-STATUS
 18152                                    PB-CI-INDV-GRP-CD
 18153                                    PB-CI-BENEFICIARY-NAME
 18154                                    PB-CI-NOTE-SW
 18155                                    PB-CI-SOC-SEC-NO
 18156                                    PB-CI-MEMBER-NO
 18157                                    PB-CI-INT-CODE
 18158                                    PB-CI-COMP-EXCP-SW
 18159                                    PB-CI-ENTRY-STATUS
 18160                                    PB-CI-CREDIT-INTERFACE-SW-1
 18161                                    PB-CI-CREDIT-INTERFACE-SW-2
 18162                                    PB-CI-ENTRY-BATCH.
 18163
 18164     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18165                                    PB-CI-AH-SETTLEMENT-DT
 18166                                    PB-CI-DEATH-DT
 18167                                    PB-CI-LF-PRIOR-CANCEL-DT
 18168                                    PB-CI-AH-PRIOR-CANCEL-DT
 18169                                    PB-CI-LOAN-1ST-PMT-DT
 18170                                    PB-CI-ENTRY-DT
 18171                                    PB-CI-LF-EXPIRE-DT
 18172                                    PB-CI-AH-EXPIRE-DT.
 18173
 18174     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18175                                    PB-CI-LF-TERM
 18176                                    PB-CI-LF-BENEFIT-AMT
 18177                                    PB-CI-LF-ALT-BENEFIT-AMT
 18178                                    PB-CI-LF-PREMIUM-AMT
 18179                                    PB-CI-LF-ALT-PREMIUM-AMT
 18180                                    PB-CI-AH-TERM
 18181                                    PB-CI-AH-BENEFIT-AMT
 18182                                    PB-CI-AH-PREMIUM-AMT
 18183                                    PB-CI-RATE-DEV-PCT-LF
 18184                                    PB-CI-RATE-DEV-PCT-AH
 18185                                    PB-CI-LIFE-COMMISSION
 18186                                    PB-CI-AH-COMMISSION
 18187                                    PB-CI-PAY-FREQUENCY
 18188                                    PB-CI-LOAN-APR
 18189                                    PB-CI-LOAN-TERM
 18190                                    PB-CI-CURR-SEQ
 18191                                    PB-CI-AH-CANCEL-AMT
 18192                                    PB-CI-LF-CANCEL-AMT
 18193                                    PB-CI-EXTENTION-DAYS
 18194                                    PB-CI-TERM-IN-DAYS
 18195                                    PB-CI-LOAN-OFFICER
 18196                                    PB-CI-LIVES
 18197                                    PB-CI-LF-CRIT-PER
 18198                                    PB-CI-AH-CRIT-PER
 18199                                    PB-C-LF-REM-TERM
 18200                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 330
* EL6311.cbl
 18201
 18202     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18203     MOVE 'A'                    TO JP-RECORD-TYPE.
 18204     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18205
 18206
 18207* EXEC CICS HANDLE CONDITION
 18208*        DUPREC   (2990-DUPLICATE-RECORD)
 18209*    END-EXEC.
 18210*    MOVE '"$%                   ! E #00015652' TO DFHEIV0
 18211     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18213     MOVE X'4520233030303135363532' TO DFHEIV0(25:11)
 18214     CALL 'kxdfhei1' USING DFHEIV0
 18215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18216
 18217
 18218
 18219* EXEC CICS WRITE
 18220*        DATASET  (FILE-ID-ERPNDB)
 18221*        FROM     (PENDING-BUSINESS)
 18222*        RIDFLD   (PB-CONTROL-PRIMARY)
 18223*    END-EXEC.
 18224     MOVE LENGTH OF
 18225      PENDING-BUSINESS
 18226       TO DFHEIV11
 18227*    MOVE '&$ L                  ''   #00015656' TO DFHEIV0
 18228     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18230     MOVE X'2020233030303135363536' TO DFHEIV0(25:11)
 18231     CALL 'kxdfhei1' USING DFHEIV0,
 18232           FILE-ID-ERPNDB,
 18233           PENDING-BUSINESS,
 18234           DFHEIV11,
 18235           PB-CONTROL-PRIMARY,
 18236           DFHEIV99,
 18237           DFHEIV99
 18238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18239
 18240
 18241     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18242
 18243     PERFORM 8400-LOG-JOURNAL-RECORD.
 18244
 18245     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18246
 18247 2985-RECORD-MISSING.
 18248     MOVE -1                     TO CMAINTL
 18249     MOVE AL-UABON               TO CMAINTA.
 18250
 18251     MOVE ER-2902                TO EMI-ERROR.
 18252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18253     GO TO 8200-SEND-DATAONLY.
 18254
 18255 2990-DUPLICATE-RECORD.
 18256     MOVE SPACE                  TO CMAINTI.
 18257     MOVE -1                     TO CMAINTL.
 18258     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 331
* EL6311.cbl
 18259     MOVE AL-UNBON               TO CEFFDTA.
 18260
 18261     MOVE 1                      TO EMI-SUB
 18262                                    EMI-SWITCH1
 18263                                    EMI-SWITCH-AREA-1
 18264                                    EMI-SWITCH-AREA-2.
 18265     MOVE SPACES                 TO EMI-ERROR-LINES.
 18266
 18267
 18268* EXEC CICS SYNCPOINT ROLLBACK
 18269*    END-EXEC.
 18270*    MOVE '6"R                   !   #00015688' TO DFHEIV0
 18271     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18273     MOVE X'2020233030303135363838' TO DFHEIV0(25:11)
 18274     CALL 'kxdfhei1' USING DFHEIV0
 18275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18276
 18277
 18278     MOVE ER-2247                TO EMI-ERROR.
 18279     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18280     GO TO 8200-SEND-DATAONLY.
 18281
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 332
* EL6311.cbl
 18283
 18284***************************************************************
 18285*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18286*     PREMIUM FOR A SINGLE BATCH.                             *
 18287*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18288***************************************************************
 18289
 18290 3000-BATCH-MAINLINE.
 18291     IF PI-PREV-KEY NOT = SPACES
 18292         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18293     ELSE
 18294         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18295
 18296     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18297
 18298 3010-READNEXT.
 18299
 18300* EXEC CICS READ
 18301*         DATASET    (FILE-ID-ERPNDB)
 18302*         SET        (ADDRESS OF PENDING-BUSINESS)
 18303*         RIDFLD     (ERPNDB-KEY)
 18304*         GTEQ
 18305*    END-EXEC.
 18306*    MOVE '&"S        G          (   #00015712' TO DFHEIV0
 18307     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18309     MOVE X'2020233030303135373132' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0,
 18311           FILE-ID-ERPNDB,
 18312           DFHEIV20,
 18313           DFHEIV99,
 18314           ERPNDB-KEY,
 18315           DFHEIV99,
 18316           DFHEIV99,
 18317           DFHEIV99
 18318     SET ADDRESS OF PENDING-BUSINESS TO
 18319         DFHEIV20
 18320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18321
 18322
 18323     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18324        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18325          GO TO 3030-END-BATCH.
 18326
 18327     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18328
 18329     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18330        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18331          GO TO 3020-BUMP-SEQ.
 18332
 18333     IF PB-ISSUE
 18334        ADD +1                   TO WS-ISS-TOTAL-CNT
 18335        IF PB-FATAL-ERRORS
 18336           ADD +1                      TO WS-ISS-FATAL-CNT
 18337           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18338           GO TO 3020-BUMP-SEQ
 18339        ELSE
 18340           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 333
* EL6311.cbl
 18341              ADD +1                      TO WS-ISS-FORCE-CNT
 18342              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18343              GO TO 3020-BUMP-SEQ
 18344           ELSE
 18345              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18346                 ADD +1                      TO WS-ISS-HOLD-CNT
 18347                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18348                 GO TO 3020-BUMP-SEQ
 18349              ELSE
 18350                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18351                     THRU  3299-EXIT
 18352                 GO TO 3020-BUMP-SEQ.
 18353
 18354     IF PB-CANCELLATION
 18355        ADD +1                   TO WS-CAN-TOTAL-CNT
 18356        IF PB-FATAL-ERRORS
 18357           ADD +1                 TO WS-CAN-FATAL-CNT
 18358           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18359           GO TO 3020-BUMP-SEQ
 18360        ELSE
 18361           IF PB-UNFORCED-ERRORS
 18362              ADD +1                 TO WS-CAN-FORCE-CNT
 18363              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18364              GO TO 3020-BUMP-SEQ
 18365           ELSE
 18366              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18367                 ADD +1                 TO WS-CAN-HOLD-CNT
 18368                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18369                 GO TO 3020-BUMP-SEQ
 18370              ELSE
 18371                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18372                     THRU  3499-EXIT
 18373                 GO TO 3020-BUMP-SEQ.
 18374
 18375     IF PB-BATCH-TRAILER
 18376         GO TO 3030-END-BATCH.
 18377
 18378 3020-BUMP-SEQ.
 18379     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18380     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18381     GO TO 3010-READNEXT.
 18382
 18383 3030-END-BATCH.
 18384     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18385     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18386     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18387     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18388
 18389     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18390                                          - WS-ISS-FORCE-CNT
 18391                                          - WS-ISS-HOLD-CNT).
 18392
 18393     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18394     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18395
 18396     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18397     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18398     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 334
* EL6311.cbl
 18399     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18400     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18401                                          - WS-CAN-FORCE-CNT
 18402                                          - WS-CAN-HOLD-CNT).
 18403     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18404     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18405
 18406     COMPUTE WS-NET-TOTAL-CNT
 18407         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18408     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18409     COMPUTE WS-NET-FATAL-CNT
 18410         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18411     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18412     COMPUTE WS-NET-FORCE-CNT
 18413         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18414     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18415     COMPUTE WS-NET-HOLD-CNT
 18416         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18417     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18418
 18419     COMPUTE WS-NET-AVAIL-CNT
 18420          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18421                              - WS-ISS-FORCE-CNT
 18422                              - WS-ISS-HOLD-CNT)
 18423          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18424                              - WS-CAN-FORCE-CNT
 18425                              - WS-CAN-HOLD-CNT).
 18426     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18427
 18428     COMPUTE WS-NET-GOOD-PREM
 18429         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18430     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18431     COMPUTE WS-NET-BAD-PREM
 18432         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18433     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18434
 18435     MOVE 0000                   TO EMI-ERROR.
 18436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18437     MOVE -1                     TO DPFENTRL.
 18438     GO TO 8200-SEND-DATAONLY.
 18439
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 335
* EL6311.cbl
 18441
 18442******************************************************************
 18443*                                                                *
 18444*           A D D    B A D   I S S U E   P R E M I U M           *
 18445*                                                                *
 18446******************************************************************
 18447
 18448 3100-ADD-BAD-ISSUE-PREM.
 18449     IF PB-OVERRIDE-LIFE
 18450       OR PB-OVERRIDE-BOTH
 18451           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18452           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18453       ELSE
 18454           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18455           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18456
 18457     IF PB-OVERRIDE-AH
 18458       OR PB-OVERRIDE-BOTH
 18459           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18460       ELSE
 18461           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18462
 18463 3199-EXIT.
 18464     EXIT.
 18465
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 336
* EL6311.cbl
 18467
 18468******************************************************************
 18469*                                                                *
 18470*       A D D   G O O D   I S S U E   P R E M I U M              *
 18471*                                                                *
 18472******************************************************************
 18473
 18474 3200-ADD-GOOD-ISSUE-PREM.
 18475     IF PB-OVERRIDE-LIFE
 18476       OR PB-OVERRIDE-BOTH
 18477           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18478           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18479       ELSE
 18480           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18481           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18482
 18483     IF PB-OVERRIDE-AH
 18484       OR PB-OVERRIDE-BOTH
 18485           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18486       ELSE
 18487           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18488
 18489 3299-EXIT.
 18490     EXIT.
 18491
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 337
* EL6311.cbl
 18493
 18494
 18495******************************************************************
 18496*                                                                *
 18497*        A D D   B A D   C A N C E L   P R E M I U M             *
 18498*                                                                *
 18499******************************************************************
 18500
 18501 3300-ADD-BAD-CANCEL-PREM.
 18502     IF PB-OVERRIDE-LIFE
 18503       OR PB-OVERRIDE-BOTH
 18504           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18505       ELSE
 18506           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18507
 18508     IF PB-OVERRIDE-AH
 18509       OR PB-OVERRIDE-BOTH
 18510           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18511       ELSE
 18512           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18513
 18514 3399-EXIT.
 18515     EXIT.
 18516
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 338
* EL6311.cbl
 18518
 18519******************************************************************
 18520*                                                                *
 18521*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18522*                                                                *
 18523******************************************************************
 18524
 18525 3400-ADD-GOOD-CANCEL-PREM.
 18526     IF PB-OVERRIDE-LIFE
 18527       OR PB-OVERRIDE-BOTH
 18528           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18529       ELSE
 18530           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18531
 18532     IF PB-OVERRIDE-AH
 18533       OR PB-OVERRIDE-BOTH
 18534           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18535       ELSE
 18536           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18537
 18538 3499-EXIT.
 18539     EXIT.
 18540
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 339
* EL6311.cbl
 18542
 18543******************************************************************
 18544*                                                                *
 18545*           E D I T   B A T C H   D A T A                        *
 18546*                                                                *
 18547******************************************************************
 18548
 18549 3500-EDIT-BATCH-DATA.
 18550     IF PI-PREV-KEY NOT = SPACES
 18551        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18552     ELSE
 18553        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18554
 18555     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18556     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18557
 18558
 18559* EXEC CICS HANDLE CONDITION
 18560*         NOTFND      (3590-NOT-FOUND)
 18561*    END-EXEC.
 18562*    MOVE '"$I                   ! F #00015954' TO DFHEIV0
 18563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18565     MOVE X'4620233030303135393534' TO DFHEIV0(25:11)
 18566     CALL 'kxdfhei1' USING DFHEIV0
 18567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18568
 18569
 18570     IF DRISSL   GREATER THAN ZEROS OR
 18571        DRISSL   GREATER THAN ZEROS OR
 18572        DRLFPRML GREATER THAN ZEROS OR
 18573        DRAHPRML GREATER THAN ZEROS OR
 18574        DRCANCL  GREATER THAN ZEROS OR
 18575        DRLFRFDL GREATER THAN ZEROS OR
 18576        DRAHRFDL GREATER THAN ZEROS
 18577              NEXT SENTENCE
 18578          ELSE
 18579              MOVE ER-3224    TO EMI-ERROR
 18580              MOVE -1         TO DPFENTRL
 18581              MOVE AL-UNBON   TO DPFENTRA
 18582              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18583              GO TO 8200-SEND-DATAONLY.
 18584
 18585     IF NOT MODIFY-CAP
 18586         MOVE 'UPDATE'       TO SM-READ
 18587         PERFORM 9995-SECURITY-VIOLATION
 18588         MOVE ER-0070        TO EMI-ERROR
 18589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18590         GO TO 8100-SEND-INITIAL-MAP.
 18591
 18592        IF DRISSL GREATER THAN ZEROS
 18593           MOVE AL-UNNON         TO DRISSA
 18594           MOVE DRISSI           TO DEEDIT-FIELD
 18595           PERFORM 8600-DEEDIT
 18596           IF DEEDIT-FIELD-V0  NUMERIC
 18597              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18598           ELSE
 18599              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 340
* EL6311.cbl
 18600              MOVE -1         TO DRISSL
 18601              MOVE AL-UNBON   TO DRISSA
 18602              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18603
 18604        IF DRLFPRML GREATER THAN ZEROS
 18605           MOVE AL-UNNON         TO DRLFPRMA
 18606
 18607* EXEC CICS BIF DEEDIT
 18608*              FIELD  (DRLFPRMI)
 18609*              LENGTH (11)
 18610*          END-EXEC
 18611     MOVE 11
 18612       TO DFHEIV11
 18613*    MOVE '@"L                   #   #00015994' TO DFHEIV0
 18614     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18615     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18616     MOVE X'2020233030303135393934' TO DFHEIV0(25:11)
 18617     CALL 'kxdfhei1' USING DFHEIV0,
 18618           DRLFPRMI,
 18619           DFHEIV11
 18620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18621           IF DRLFPRMI NUMERIC
 18622              MOVE DRLFPRMI   TO WS-DRLFPRM
 18623*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18624*          PERFORM 8600-DEEDIT
 18625*          IF DEEDIT-FIELD-V2  NUMERIC
 18626*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18627           ELSE
 18628              MOVE ER-2223    TO EMI-ERROR
 18629              MOVE -1         TO DRLFPRML
 18630              MOVE AL-UNBON   TO DRLFPRMA
 18631              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18632
 18633        IF DRAHPRML GREATER THAN ZEROS
 18634           MOVE AL-UNNON         TO DRAHPRMA
 18635
 18636* EXEC CICS BIF DEEDIT
 18637*              FIELD  (DRAHPRMI)
 18638*              LENGTH (11)
 18639*          END-EXEC
 18640     MOVE 11
 18641       TO DFHEIV11
 18642*    MOVE '@"L                   #   #00016012' TO DFHEIV0
 18643     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18644     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18645     MOVE X'2020233030303136303132' TO DFHEIV0(25:11)
 18646     CALL 'kxdfhei1' USING DFHEIV0,
 18647           DRAHPRMI,
 18648           DFHEIV11
 18649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18650           IF DRAHPRMI NUMERIC
 18651              MOVE DRAHPRMI   TO WS-DRAHPRM
 18652*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18653*          PERFORM 8600-DEEDIT
 18654*          IF DEEDIT-FIELD-V2  NUMERIC
 18655*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18656           ELSE
 18657              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 341
* EL6311.cbl
 18658              MOVE -1         TO DRAHPRML
 18659              MOVE AL-UNBON   TO DRAHPRMA
 18660              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18661
 18662        IF DRCANCL GREATER THAN ZEROS
 18663           MOVE AL-UNNON         TO DRCANCA
 18664           MOVE DRCANCI          TO DEEDIT-FIELD
 18665           PERFORM 8600-DEEDIT
 18666           IF DEEDIT-FIELD-V0  NUMERIC
 18667              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18668           ELSE
 18669              MOVE ER-2223    TO EMI-ERROR
 18670              MOVE -1         TO DRCANCL
 18671              MOVE AL-UNBON   TO DRCANCL
 18672              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18673
 18674        IF DRLFRFDL GREATER THAN ZEROS
 18675           MOVE AL-UNNON         TO DRLFRFDA
 18676
 18677* EXEC CICS BIF DEEDIT
 18678*              FIELD  (DRLFRFDI)
 18679*              LENGTH (11)
 18680*          END-EXEC
 18681     MOVE 11
 18682       TO DFHEIV11
 18683*    MOVE '@"L                   #   #00016042' TO DFHEIV0
 18684     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18685     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18686     MOVE X'2020233030303136303432' TO DFHEIV0(25:11)
 18687     CALL 'kxdfhei1' USING DFHEIV0,
 18688           DRLFRFDI,
 18689           DFHEIV11
 18690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18691           IF DRLFRFDI NUMERIC
 18692              MOVE DRLFRFDI   TO WS-DRLFRFD
 18693*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18694*          PERFORM 8600-DEEDIT
 18695*          IF DEEDIT-FIELD-V2  NUMERIC
 18696*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18697           ELSE
 18698              MOVE ER-2223    TO EMI-ERROR
 18699              MOVE -1         TO DRLFRFDL
 18700              MOVE AL-UNBON   TO DRLFRFDA
 18701              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18702
 18703        IF DRAHRFDL GREATER THAN ZEROS
 18704           MOVE AL-UNNON         TO DRAHRFDA
 18705
 18706* EXEC CICS BIF DEEDIT
 18707*              FIELD  (DRAHRFDI)
 18708*              LENGTH (11)
 18709*          END-EXEC
 18710     MOVE 11
 18711       TO DFHEIV11
 18712*    MOVE '@"L                   #   #00016060' TO DFHEIV0
 18713     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18714     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18715     MOVE X'2020233030303136303630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 342
* EL6311.cbl
 18716     CALL 'kxdfhei1' USING DFHEIV0,
 18717           DRAHRFDI,
 18718           DFHEIV11
 18719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18720           IF DRAHRFDI NUMERIC
 18721              MOVE DRAHRFDI   TO WS-DRAHRFD
 18722*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18723*          PERFORM 8600-DEEDIT
 18724*          IF DEEDIT-FIELD-V2  NUMERIC
 18725*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18726           ELSE
 18727              MOVE ER-2223    TO EMI-ERROR
 18728              MOVE -1         TO DRAHRFDL
 18729              MOVE AL-UNBON   TO DRAHRFDA
 18730              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18731
 18732     IF EMI-ERROR = ZEROS
 18733        GO 3600-UPDATE-BATCH-HEADER.
 18734
 18735     GO TO 8200-SEND-DATAONLY.
 18736
 18737 3590-NOT-FOUND.
 18738     MOVE ER-2192                TO EMI-ERROR.
 18739     MOVE -1                     TO DPFENTRL.
 18740     MOVE AL-UNBON               TO DPFENTRA.
 18741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18742     GO TO 8200-SEND-DATAONLY.
 18743
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 343
* EL6311.cbl
 18745
 18746******************************************************************
 18747*                                                                *
 18748*           U P D A T E   B A T C H   H E A D E R                *
 18749*                                                                *
 18750******************************************************************
 18751
 18752 3600-UPDATE-BATCH-HEADER.
 18753
 18754* EXEC CICS HANDLE CONDITION
 18755*         NOTFND      (3690-NOT-FOUND)
 18756*    END-EXEC.
 18757*    MOVE '"$I                   ! G #00016097' TO DFHEIV0
 18758     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18760     MOVE X'4720233030303136303937' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765
 18766* EXEC CICS READ
 18767*        DATASET (FILE-ID-ERPNDB)
 18768*        RIDFLD  (ERPNDB-KEY)
 18769*        SET     (ADDRESS OF PENDING-BUSINESS)
 18770*        UPDATE
 18771*    END-EXEC.
 18772*    MOVE '&"S        EU         (   #00016101' TO DFHEIV0
 18773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18774     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18775     MOVE X'2020233030303136313031' TO DFHEIV0(25:11)
 18776     CALL 'kxdfhei1' USING DFHEIV0,
 18777           FILE-ID-ERPNDB,
 18778           DFHEIV20,
 18779           DFHEIV99,
 18780           ERPNDB-KEY,
 18781           DFHEIV99,
 18782           DFHEIV99,
 18783           DFHEIV99
 18784     SET ADDRESS OF PENDING-BUSINESS TO
 18785         DFHEIV20
 18786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18787
 18788
 18789     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18790     MOVE 'B'                    TO JP-RECORD-TYPE.
 18791     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18792
 18793     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18794
 18795     PERFORM 8400-LOG-JOURNAL-RECORD.
 18796
 18797     IF DRISSL GREATER THAN ZEROS
 18798        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18799
 18800     IF DRCANCL GREATER THAN ZEROS
 18801        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18802
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 344
* EL6311.cbl
 18803
 18804     IF DRLFPRML GREATER THAN ZEROS
 18805        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18806
 18807     IF DRAHPRML GREATER THAN ZEROS
 18808        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18809
 18810     IF DRLFRFDL GREATER THAN ZEROS
 18811        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18812
 18813     IF DRAHRFDL GREATER THAN ZEROS
 18814        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18815
 18816 3670-REWRITE-BATCH-HEADER.
 18817     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18818        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18819        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18820        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18821        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18822        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18823        MOVE SPACE               TO PB-OUT-BAL-CD
 18824     ELSE
 18825        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18826
 18827     MOVE 'C'                    TO JP-RECORD-TYPE.
 18828     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18829
 18830
 18831* EXEC CICS REWRITE
 18832*         DATASET      (FILE-ID-ERPNDB)
 18833*         FROM         (PENDING-BUSINESS)
 18834*    END-EXEC.
 18835     MOVE LENGTH OF
 18836      PENDING-BUSINESS
 18837       TO DFHEIV11
 18838*    MOVE '&& L                  %   #00016149' TO DFHEIV0
 18839     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18840     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18841     MOVE X'2020233030303136313439' TO DFHEIV0(25:11)
 18842     CALL 'kxdfhei1' USING DFHEIV0,
 18843           FILE-ID-ERPNDB,
 18844           PENDING-BUSINESS,
 18845           DFHEIV11,
 18846           DFHEIV99
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850     PERFORM 8400-LOG-JOURNAL-RECORD.
 18851
 18852     GO TO 7200-DISPLAY-BATCHES.
 18853
 18854 3690-NOT-FOUND.
 18855     MOVE ER-2192                TO EMI-ERROR.
 18856     MOVE -1                     TO DPFENTRL.
 18857     MOVE AL-UNBON               TO DPFENTRA.
 18858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18859     GO TO 8200-SEND-DATAONLY.
 18860
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 345
* EL6311.cbl
 18862
 18863******************************************************************
 18864*                                                                *
 18865*           R E - D I S P L A Y   R E C O R D                    *
 18866*                                                                *
 18867******************************************************************
 18868
 18869 3900-RE-DISPLAY-RECORD.
 18870
 18871* EXEC CICS HANDLE CONDITION
 18872*         NOTFND   (3990-NOT-FOUND)
 18873*    END-EXEC.
 18874*    MOVE '"$I                   ! H #00016174' TO DFHEIV0
 18875     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18877     MOVE X'4820233030303136313734' TO DFHEIV0(25:11)
 18878     CALL 'kxdfhei1' USING DFHEIV0
 18879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18880
 18881
 18882     IF PI-DISPLAY-ORIGINAL-BATCH
 18883         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18884     ELSE
 18885         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18886
 18887
 18888* EXEC CICS READ
 18889*         DATASET   (FILE-ID)
 18890*         RIDFLD    (PI-PREV-KEY)
 18891*         SET       (ADDRESS OF PENDING-BUSINESS)
 18892*    END-EXEC.
 18893*    MOVE '&"S        E          (   #00016183' TO DFHEIV0
 18894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18896     MOVE X'2020233030303136313833' TO DFHEIV0(25:11)
 18897     CALL 'kxdfhei1' USING DFHEIV0,
 18898           FILE-ID,
 18899           DFHEIV20,
 18900           DFHEIV99,
 18901           PI-PREV-KEY,
 18902           DFHEIV99,
 18903           DFHEIV99,
 18904           DFHEIV99
 18905     SET ADDRESS OF PENDING-BUSINESS TO
 18906         DFHEIV20
 18907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18908
 18909
 18910     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18911
 18912     IF PB-ISSUE
 18913         GO TO 7000-DISPLAY-ISSUES.
 18914
 18915     IF PB-CANCELLATION
 18916         GO TO 7100-DISPLAY-CANCELS.
 18917
 18918     IF PB-BATCH-TRAILER
 18919         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 346
* EL6311.cbl
 18920
 18921 3990-NOT-FOUND.
 18922     MOVE LOW-VALUES             TO EL631BI.
 18923
 18924     IF PI-MAP-NAME = EL631B
 18925         MOVE -1                  TO BMAINTL
 18926     ELSE
 18927         MOVE -1                  TO CMAINTL.
 18928
 18929     GO TO 8100-SEND-INITIAL-MAP.
 18930
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 347
* EL6311.cbl
 18932
 18933***************************************************************
 18934*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18935*                                                             *
 18936*      1. START BROWSE WITH                                   *
 18937*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18938*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18939*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18940*                                                             *
 18941*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18942*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18943*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18944*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18945*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18946*               AND IS IT TO BE DISPLAYED.                    *
 18947*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18948*               DISPLAYED.                                    *
 18949*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18950*               DISPLAYED.                                    *
 18951*                                                             *
 18952*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18953*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18954***************************************************************
 18955
 18956 4000-BROWSE-DETAIL-FORWARD.
 18957     IF FIRST-TIME
 18958        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18959     ELSE
 18960        IF SHOW-RECORD
 18961           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18962           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18963           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18964           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18965           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18966        ELSE
 18967           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18968
 18969
 18970* EXEC CICS HANDLE CONDITION
 18971*         NOTFND   (4050-END-RECORDS)
 18972*         ENDFILE  (4050-END-RECORDS)
 18973*    END-EXEC.
 18974*    MOVE '"$I''                  ! I #00016248' TO DFHEIV0
 18975     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18977     MOVE X'4920233030303136323438' TO DFHEIV0(25:11)
 18978     CALL 'kxdfhei1' USING DFHEIV0
 18979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18980
 18981
 18982
 18983* EXEC CICS STARTBR
 18984*         DATASET   (FILE-ID-ERPNDB2)
 18985*         RIDFLD    (ERPNDB-ALT-KEY)
 18986*    END-EXEC.
 18987     MOVE 0
 18988       TO DFHEIV11
 18989*    MOVE '&,         G          &   #00016253' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 348
* EL6311.cbl
 18990     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18991     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18992     MOVE X'2020233030303136323533' TO DFHEIV0(25:11)
 18993     CALL 'kxdfhei1' USING DFHEIV0,
 18994           FILE-ID-ERPNDB2,
 18995           ERPNDB-ALT-KEY,
 18996           DFHEIV99,
 18997           DFHEIV11,
 18998           DFHEIV99
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19000
 19001
 19002     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19003
 19004     IF FIRST-TIME OR SHOW-RECORD
 19005        MOVE SPACE               TO WS-FIRST-TIME-SW
 19006        GO TO 4005-READ-NEXT-RECORD.
 19007
 19008
 19009* EXEC CICS READNEXT
 19010*         DATASET    (FILE-ID-ERPNDB2)
 19011*         SET        (ADDRESS OF PENDING-BUSINESS)
 19012*         RIDFLD     (ERPNDB-ALT-KEY)
 19013*    END-EXEC.
 19014     MOVE 0
 19015       TO DFHEIV11
 19016*    MOVE '&.S                   )   #00016264' TO DFHEIV0
 19017     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19018     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19019     MOVE X'2020233030303136323634' TO DFHEIV0(25:11)
 19020     CALL 'kxdfhei1' USING DFHEIV0,
 19021           FILE-ID-ERPNDB2,
 19022           DFHEIV20,
 19023           DFHEIV99,
 19024           ERPNDB-ALT-KEY,
 19025           DFHEIV99,
 19026           DFHEIV11,
 19027           DFHEIV99,
 19028           DFHEIV99
 19029     SET ADDRESS OF PENDING-BUSINESS TO
 19030         DFHEIV20
 19031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19032
 19033
 19034 4005-READ-NEXT-RECORD.
 19035
 19036* EXEC CICS READNEXT
 19037*         DATASET    (FILE-ID-ERPNDB2)
 19038*         SET        (ADDRESS OF PENDING-BUSINESS)
 19039*         RIDFLD     (ERPNDB-ALT-KEY)
 19040*    END-EXEC.
 19041     MOVE 0
 19042       TO DFHEIV11
 19043*    MOVE '&.S                   )   #00016271' TO DFHEIV0
 19044     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303136323731' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 349
* EL6311.cbl
 19048           FILE-ID-ERPNDB2,
 19049           DFHEIV20,
 19050           DFHEIV99,
 19051           ERPNDB-ALT-KEY,
 19052           DFHEIV99,
 19053           DFHEIV11,
 19054           DFHEIV99,
 19055           DFHEIV99
 19056     SET ADDRESS OF PENDING-BUSINESS TO
 19057         DFHEIV20
 19058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19059
 19060
 19061     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19062
 19063     IF WS-BATCH-PREFIX = '#CL'
 19064        GO TO 4005-READ-NEXT-RECORD.
 19065
 19066     IF SHOW-RECORD
 19067        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 19068           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 19069           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 19070           PB-STATE         NOT = PI-PB-STATE          OR
 19071           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 19072           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 19073           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 19074           GO TO 4050-END-RECORDS
 19075        ELSE
 19076           GO TO 4010-CHECK-REC-TYPE.
 19077
 19078     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 19079        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 19080        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 19081        PB-STATE            NOT = PI-PB-STATE          OR
 19082        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 19083        GO TO 4050-END-RECORDS.
 19084
 19085     IF PB-BATCH-TRAILER
 19086        GO TO 4005-READ-NEXT-RECORD.
 19087
 19088     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19089        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19090           GO TO 4005-READ-NEXT-RECORD
 19091        ELSE
 19092           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19093              GO TO 4010-CHECK-REC-TYPE
 19094           ELSE
 19095              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19096                 GO TO 4010-CHECK-REC-TYPE
 19097              ELSE
 19098                 GO TO 4005-READ-NEXT-RECORD.
 19099
 19100     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19101        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19102           GO TO 4005-READ-NEXT-RECORD.
 19103
 19104 4010-CHECK-REC-TYPE.
 19105     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 350
* EL6311.cbl
 19106         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19107             NEXT SENTENCE
 19108         ELSE
 19109             GO TO 4005-READ-NEXT-RECORD.
 19110
 19111     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19112         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19113             NEXT SENTENCE
 19114        ELSE
 19115             GO TO 4005-READ-NEXT-RECORD.
 19116
 19117     IF NOT DISPLAY-CHANGE-RECORDS AND
 19118            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19119        GO TO 4005-READ-NEXT-RECORD.
 19120
 19121     IF DISPLAY-HOLD-RECORDS AND
 19122        NOT PB-RECORD-ON-HOLD
 19123          GO TO 4005-READ-NEXT-RECORD.
 19124
 19125     IF PB-ISSUE
 19126        IF DISPLAY-CHK-REQ-RECORDS
 19127            GO TO 4005-READ-NEXT-RECORD.
 19128
 19129     IF PB-ISSUE
 19130        IF ISSUE-WITH-WARNING
 19131           IF PB-WARNING-ERRORS
 19132              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19133                  GO TO 4005-READ-NEXT-RECORD
 19134              ELSE
 19135                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19136                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19137                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19138                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19139                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19140                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19141                 GO TO 7000-DISPLAY-ISSUES
 19142           ELSE
 19143              GO TO 4005-READ-NEXT-RECORD.
 19144
 19145     IF PB-ISSUE
 19146        IF (ISSUES-IN-ERROR AND
 19147            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19148            ALL-ISSUES
 19149            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19150            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19151            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19152            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19153            MOVE PB-SV-STATE            TO PI-SV-STATE
 19154            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19155            GO TO 7000-DISPLAY-ISSUES
 19156        ELSE
 19157            GO TO 4005-READ-NEXT-RECORD.
 19158
 19159     IF PB-CANCELLATION
 19160        IF DISPLAY-CHK-REQ-RECORDS
 19161           IF PB-C-REFUND-REQUESTED
 19162              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19163              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 351
* EL6311.cbl
 19164              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19165              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19166              MOVE PB-SV-STATE            TO PI-SV-STATE
 19167              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19168              GO TO 7100-DISPLAY-CANCELS
 19169           ELSE
 19170               GO TO 4005-READ-NEXT-RECORD.
 19171
 19172     IF PB-CANCELLATION
 19173        IF CANCEL-WITH-WARNING
 19174           IF PB-WARNING-ERRORS
 19175              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19176                  GO TO 4005-READ-NEXT-RECORD
 19177              ELSE
 19178                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19179                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19180                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19181                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19182                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19183                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19184                 GO TO 7100-DISPLAY-CANCELS
 19185           ELSE
 19186              GO TO 4005-READ-NEXT-RECORD.
 19187
 19188     IF PB-CANCELLATION
 19189        IF (CANCEL-IN-ERROR  AND
 19190            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19191            ALL-CANCELS
 19192            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19193            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19194            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19195            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19196            MOVE PB-SV-STATE            TO PI-SV-STATE
 19197            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19198            GO TO 7100-DISPLAY-CANCELS.
 19199
 19200     GO TO 4005-READ-NEXT-RECORD.
 19201
 19202 4050-END-RECORDS.
 19203******************************************************************
 19204*                                                                *
 19205*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19206*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19207*         PROGRAM.                                               *
 19208*                                                                *
 19209******************************************************************
 19210
 19211     IF BROWSE-STARTED
 19212        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19213
 19214* EXEC CICS ENDBR
 19215*            DATASET  (FILE-ID-ERPNDB2)
 19216*       END-EXEC.
 19217     MOVE 0
 19218       TO DFHEIV11
 19219*    MOVE '&2                    $   #00016429' TO DFHEIV0
 19220     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 352
* EL6311.cbl
 19222     MOVE X'2020233030303136343239' TO DFHEIV0(25:11)
 19223     CALL 'kxdfhei1' USING DFHEIV0,
 19224           FILE-ID-ERPNDB2,
 19225           DFHEIV11,
 19226           DFHEIV99
 19227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19228
 19229
 19230     IF  EIBTRNID NOT = TRANS-EXB1
 19231         IF PENDING-BUS-RECS-FOUND
 19232             NEXT SENTENCE
 19233           ELSE
 19234             MOVE '9'            TO PI-BROWSE-SW
 19235             GO TO 9400-CLEAR.
 19236
 19237     IF SHOW-RECORD
 19238        MOVE ER-2253            TO EMI-ERROR
 19239       ELSE
 19240        MOVE ER-2254            TO EMI-ERROR.
 19241
 19242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19243
 19244     IF PI-MAP-NAME = SPACES
 19245        MOVE -1                  TO DPFENTRL
 19246        MOVE EL631D               TO PI-MAP-NAME
 19247        GO TO 8100-SEND-INITIAL-MAP.
 19248
 19249     IF PI-MAP-NAME = EL631B
 19250        MOVE -1                  TO BMAINTL
 19251     ELSE
 19252        IF PI-MAP-NAME = EL631C
 19253           MOVE -1               TO CMAINTL
 19254        ELSE
 19255           MOVE -1               TO DPFENTRL.
 19256
 19257     GO TO 8200-SEND-DATAONLY.
 19258
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 353
* EL6311.cbl
 19260
 19261***************************************************************
 19262*                                                             *
 19263*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19264*                                                             *
 19265*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19266*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19267*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19268*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19269*                                                             *
 19270*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19271*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19272*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19273*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19274*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19275*                AND IS IT TO BE DISPLAYED.                   *
 19276*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19277*                DISPLAYED.                                   *
 19278*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19279*                DISPLAYED.                                   *
 19280*                                                             *
 19281*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19282*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19283*                                                             *
 19284*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19285*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19286*                THEY ARE NOT TO BE DISPLAYED.                *
 19287*                                                             *
 19288***************************************************************
 19289
 19290 4100-BROWSE-PRIMARY-FORWARD.
 19291     IF FIRST-TIME  OR SHOW-RECORD
 19292        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19293        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19294        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19295     ELSE
 19296        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19297        IF ERPNDB-BATCH-SEQ-NO = +9999
 19298           GO TO 4150-END-BATCH
 19299        ELSE
 19300           IF DISPLAY-CHANGE-RECORDS
 19301              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19302           ELSE
 19303              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19304              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19305
 19306     IF FIRST-TIME
 19307         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19308            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19309              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19310
 19311
 19312* EXEC CICS HANDLE CONDITION
 19313*         ENDFILE  (4150-END-BATCH)
 19314*    END-EXEC.
 19315*    MOVE '"$''                   ! J #00016514' TO DFHEIV0
 19316     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 354
* EL6311.cbl
 19318     MOVE X'4A20233030303136353134' TO DFHEIV0(25:11)
 19319     CALL 'kxdfhei1' USING DFHEIV0
 19320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19321
 19322
 19323 4105-READ-NEXT.
 19324
 19325* EXEC CICS HANDLE CONDITION
 19326*         NOTFND    (4150-END-BATCH)
 19327*    END-EXEC.
 19328*    MOVE '"$I                   ! K #00016519' TO DFHEIV0
 19329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19331     MOVE X'4B20233030303136353139' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0
 19333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19334
 19335
 19336     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19337
 19338     IF PI-DISPLAY-ORIGINAL-BATCH
 19339        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19340     ELSE
 19341        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19342
 19343
 19344* EXEC CICS READ
 19345*         DATASET   (FILE-ID)
 19346*         SET       (ADDRESS OF PENDING-BUSINESS)
 19347*         RIDFLD    (ERPNDB-KEY)
 19348*         GTEQ
 19349*    END-EXEC.
 19350*    MOVE '&"S        G          (   #00016530' TO DFHEIV0
 19351     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303136353330' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0,
 19355           FILE-ID,
 19356           DFHEIV20,
 19357           DFHEIV99,
 19358           ERPNDB-KEY,
 19359           DFHEIV99,
 19360           DFHEIV99,
 19361           DFHEIV99
 19362     SET ADDRESS OF PENDING-BUSINESS TO
 19363         DFHEIV20
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19365
 19366
 19367     IF PI-DISPLAY-ORIGINAL-BATCH
 19368        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19369           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19370           GO TO 4150-END-BATCH
 19371        ELSE
 19372           IF PB-BATCH-TRAILER
 19373              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19374              GO TO 4105-READ-NEXT
 19375           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 355
* EL6311.cbl
 19376              NEXT SENTENCE
 19377     ELSE
 19378        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19379           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19380           GO TO 4150-END-BATCH.
 19381
 19382     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19383
 19384     IF WS-BATCH-PREFIX = '#CL'
 19385         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19386         GO TO 4105-READ-NEXT.
 19387
 19388     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19389     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19390     MOVE PB-STATE               TO PI-PB-STATE.
 19391     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19392
 19393     IF PB-BATCH-TRAILER
 19394        IF SHOW-RECORD
 19395           GO TO 4150-END-BATCH
 19396        ELSE
 19397           MOVE ER-2251         TO EMI-ERROR
 19398           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19399           MOVE 1               TO PI-BROWSE-TYPE
 19400           GO TO 7200-DISPLAY-BATCHES.
 19401
 19402     IF SHOW-RECORD
 19403           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19404              GO TO 4110-BUMP-SEQ
 19405           ELSE
 19406              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19407                 GO TO 4110-BUMP-SEQ
 19408              ELSE
 19409                 GO TO 4107-CHECK-REC-TYPE.
 19410
 19411     IF NOT  PI-PRIMARY-WITH-SELECT
 19412        GO TO 4107-CHECK-REC-TYPE.
 19413
 19414     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19415        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19416           GO TO 4110-BUMP-SEQ
 19417        ELSE
 19418           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19419              GO TO 4107-CHECK-REC-TYPE
 19420           ELSE
 19421              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19422                 GO TO 4107-CHECK-REC-TYPE
 19423              ELSE
 19424                 GO TO 4110-BUMP-SEQ.
 19425
 19426     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19427        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19428           GO TO 4110-BUMP-SEQ.
 19429
 19430 4107-CHECK-REC-TYPE.
 19431     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19432         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19433             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 356
* EL6311.cbl
 19434           ELSE
 19435             GO TO 4110-BUMP-SEQ.
 19436
 19437     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19438         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19439             NEXT SENTENCE
 19440           ELSE
 19441             GO TO 4110-BUMP-SEQ.
 19442
 19443     IF NOT DISPLAY-CHANGE-RECORDS AND
 19444        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19445           GO TO 4110-BUMP-SEQ.
 19446
 19447     IF DISPLAY-HOLD-RECORDS AND
 19448        NOT PB-RECORD-ON-HOLD
 19449          GO TO 4110-BUMP-SEQ.
 19450
 19451     IF PB-ISSUE
 19452        IF DISPLAY-CHK-REQ-RECORDS
 19453            GO TO 4110-BUMP-SEQ.
 19454
 19455     IF PB-ISSUE
 19456        IF ISSUE-WITH-WARNING
 19457           IF PB-WARNING-ERRORS
 19458              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19459                  GO TO 4110-BUMP-SEQ
 19460              ELSE
 19461                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19462                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19463                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19464                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19465                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19466                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19467                 GO TO 7000-DISPLAY-ISSUES
 19468        ELSE
 19469            GO TO 4110-BUMP-SEQ.
 19470
 19471     IF PB-ISSUE
 19472        IF (ISSUES-IN-ERROR AND
 19473            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19474            ALL-ISSUES
 19475            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19476            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19477            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19478            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19479            MOVE PB-SV-STATE            TO PI-SV-STATE
 19480            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19481            GO TO 7000-DISPLAY-ISSUES
 19482        ELSE
 19483            GO TO 4110-BUMP-SEQ.
 19484
 19485     IF PB-CANCELLATION
 19486        IF DISPLAY-CHK-REQ-RECORDS
 19487           IF PB-C-REFUND-REQUESTED
 19488              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19489              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19490              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19491              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 357
* EL6311.cbl
 19492              MOVE PB-SV-STATE            TO PI-SV-STATE
 19493              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19494              GO TO 7100-DISPLAY-CANCELS
 19495           ELSE
 19496              GO TO 4110-BUMP-SEQ.
 19497
 19498     IF PB-CANCELLATION
 19499        IF CANCEL-WITH-WARNING
 19500           IF PB-WARNING-ERRORS
 19501              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19502                  GO TO 4110-BUMP-SEQ
 19503              ELSE
 19504                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19505                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19506                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19507                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19508                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19509                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19510                 GO TO 7100-DISPLAY-CANCELS
 19511           ELSE
 19512              GO TO 4110-BUMP-SEQ.
 19513
 19514     IF PB-CANCELLATION
 19515        IF (CANCEL-IN-ERROR  AND
 19516            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19517            ALL-CANCELS
 19518            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19519            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19520            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19521            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19522            MOVE PB-SV-STATE            TO PI-SV-STATE
 19523            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19524            GO TO 7100-DISPLAY-CANCELS.
 19525
 19526 4110-BUMP-SEQ.
 19527     IF NOT DISPLAY-CHANGE-RECORDS
 19528        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19529        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19530     ELSE
 19531        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19532           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19533           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19534        ELSE
 19535           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19536           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19537
 19538     GO TO 4105-READ-NEXT.
 19539
 19540 4150-END-BATCH.
 19541******************************************************************
 19542*                                                                *
 19543*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19544*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19545*         PROGRAM.                                               *
 19546*                                                                *
 19547******************************************************************
 19548
 19549     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 358
* EL6311.cbl
 19550         IF PENDING-BUS-RECS-FOUND
 19551             NEXT SENTENCE
 19552           ELSE
 19553             MOVE '9'            TO PI-BROWSE-SW
 19554             GO TO 9400-CLEAR.
 19555
 19556     IF SHOW-RECORD
 19557        MOVE ER-2253             TO EMI-ERROR
 19558     ELSE
 19559        MOVE ER-2251             TO EMI-ERROR.
 19560
 19561     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19562
 19563     IF PI-MAP-NAME = SPACES
 19564        MOVE -1                  TO BMAINTL
 19565        MOVE EL631B              TO PI-MAP-NAME
 19566        GO TO 8100-SEND-INITIAL-MAP.
 19567
 19568     IF PI-MAP-NAME = EL631B
 19569        MOVE -1                  TO BMAINTL
 19570     ELSE
 19571        IF PI-MAP-NAME = EL631C
 19572           MOVE -1               TO CMAINTL
 19573        ELSE
 19574           MOVE -1               TO DPFENTRL.
 19575
 19576     GO TO 8200-SEND-DATAONLY.
 19577
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 359
* EL6311.cbl
 19579
 19580***************************************************************
 19581*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19582*                                                             *
 19583*      1. START BROWSE WITH                                   *
 19584*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19585*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19586*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19587*                                                             *
 19588*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19589*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19590*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19591*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19592*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19593*               AND IS IT TO BE DISPLAYED.                    *
 19594*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19595*               DISPLAYED.                                    *
 19596*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19597*               DISPLAYED.                                    *
 19598*                                                             *
 19599*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19600*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19601***************************************************************
 19602
 19603 4200-BROWSE-CSR-FORWARD.
 19604
 19605     IF FIRST-TIME
 19606        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19607     ELSE
 19608        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19609
 19610
 19611* EXEC CICS HANDLE CONDITION
 19612*         NOTFND   (4250-END-RECORDS)
 19613*         ENDFILE  (4250-END-RECORDS)
 19614*    END-EXEC.
 19615*    MOVE '"$I''                  ! L #00016780' TO DFHEIV0
 19616     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19618     MOVE X'4C20233030303136373830' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19621
 19622
 19623
 19624* EXEC CICS STARTBR
 19625*         DATASET   (FILE-ID-ERPNDB4)
 19626*         RIDFLD    (ERPNDB-CSR-KEY)
 19627*    END-EXEC.
 19628     MOVE 0
 19629       TO DFHEIV11
 19630*    MOVE '&,         G          &   #00016785' TO DFHEIV0
 19631     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19632     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19633     MOVE X'2020233030303136373835' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0,
 19635           FILE-ID-ERPNDB4,
 19636           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 360
* EL6311.cbl
 19637           DFHEIV99,
 19638           DFHEIV11,
 19639           DFHEIV99
 19640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19641
 19642
 19643     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19644
 19645     IF FIRST-TIME
 19646        MOVE SPACE               TO WS-FIRST-TIME-SW
 19647        GO TO 4205-READ-NEXT-RECORD.
 19648
 19649
 19650* EXEC CICS READNEXT
 19651*         DATASET    (FILE-ID-ERPNDB4)
 19652*         SET        (ADDRESS OF PENDING-BUSINESS)
 19653*         RIDFLD     (ERPNDB-CSR-KEY)
 19654*    END-EXEC.
 19655     MOVE 0
 19656       TO DFHEIV11
 19657*    MOVE '&.S                   )   #00016796' TO DFHEIV0
 19658     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19659     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19660     MOVE X'2020233030303136373936' TO DFHEIV0(25:11)
 19661     CALL 'kxdfhei1' USING DFHEIV0,
 19662           FILE-ID-ERPNDB4,
 19663           DFHEIV20,
 19664           DFHEIV99,
 19665           ERPNDB-CSR-KEY,
 19666           DFHEIV99,
 19667           DFHEIV11,
 19668           DFHEIV99,
 19669           DFHEIV99
 19670     SET ADDRESS OF PENDING-BUSINESS TO
 19671         DFHEIV20
 19672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19673
 19674
 19675 4205-READ-NEXT-RECORD.
 19676
 19677
 19678* EXEC CICS READNEXT
 19679*         DATASET    (FILE-ID-ERPNDB4)
 19680*         SET        (ADDRESS OF PENDING-BUSINESS)
 19681*         RIDFLD     (ERPNDB-CSR-KEY)
 19682*    END-EXEC.
 19683     MOVE 0
 19684       TO DFHEIV11
 19685*    MOVE '&.S                   )   #00016804' TO DFHEIV0
 19686     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19688     MOVE X'2020233030303136383034' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0,
 19690           FILE-ID-ERPNDB4,
 19691           DFHEIV20,
 19692           DFHEIV99,
 19693           ERPNDB-CSR-KEY,
 19694           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 361
* EL6311.cbl
 19695           DFHEIV11,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     SET ADDRESS OF PENDING-BUSINESS TO
 19699         DFHEIV20
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19704
 19705     IF WS-BATCH-PREFIX = '#CL'
 19706        GO TO 4205-READ-NEXT-RECORD.
 19707
 19708     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19709        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19710        GO TO 4250-END-RECORDS.
 19711
 19712     IF PB-BATCH-TRAILER
 19713        GO TO 4205-READ-NEXT-RECORD.
 19714
 19715     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19716        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19717           GO TO 4205-READ-NEXT-RECORD
 19718        ELSE
 19719           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19720              GO TO 4210-CHECK-REC-TYPE
 19721           ELSE
 19722              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19723                 GO TO 4210-CHECK-REC-TYPE
 19724              ELSE
 19725                 GO TO 4205-READ-NEXT-RECORD.
 19726
 19727     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19728        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19729           GO TO 4205-READ-NEXT-RECORD.
 19730
 19731 4210-CHECK-REC-TYPE.
 19732     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19733         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19734             NEXT SENTENCE
 19735         ELSE
 19736             GO TO 4205-READ-NEXT-RECORD.
 19737
 19738     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19739         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19740             NEXT SENTENCE
 19741        ELSE
 19742             GO TO 4205-READ-NEXT-RECORD.
 19743
 19744     IF NOT DISPLAY-CHANGE-RECORDS AND
 19745            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19746        GO TO 4205-READ-NEXT-RECORD.
 19747
 19748     IF DISPLAY-HOLD-RECORDS AND
 19749        NOT PB-RECORD-ON-HOLD
 19750          GO TO 4205-READ-NEXT-RECORD.
 19751
 19752     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 362
* EL6311.cbl
 19753        IF DISPLAY-CHK-REQ-RECORDS
 19754            GO TO 4205-READ-NEXT-RECORD.
 19755
 19756     IF PB-ISSUE
 19757        IF ISSUE-WITH-WARNING
 19758           IF PB-WARNING-ERRORS
 19759              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19760                  GO TO 4205-READ-NEXT-RECORD
 19761              ELSE
 19762                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19763                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19764                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19765                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19766                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19767                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19768                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19769                 GO TO 7000-DISPLAY-ISSUES
 19770           ELSE
 19771              GO TO 4205-READ-NEXT-RECORD.
 19772
 19773     IF PB-ISSUE
 19774        IF (ISSUES-IN-ERROR AND
 19775            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19776            ALL-ISSUES
 19777            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19778            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19779            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19780            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19781            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19782            MOVE PB-SV-STATE            TO PI-SV-STATE
 19783            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19784            GO TO 7000-DISPLAY-ISSUES
 19785        ELSE
 19786            GO TO 4205-READ-NEXT-RECORD.
 19787
 19788     IF PB-CANCELLATION
 19789        IF DISPLAY-CHK-REQ-RECORDS
 19790           IF PB-C-REFUND-REQUESTED
 19791              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19792              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19793              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19794              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19795              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19796              MOVE PB-SV-STATE            TO PI-SV-STATE
 19797              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19798              GO TO 7100-DISPLAY-CANCELS
 19799           ELSE
 19800               GO TO 4205-READ-NEXT-RECORD.
 19801
 19802     IF PB-CANCELLATION
 19803        IF CANCEL-WITH-WARNING
 19804           IF PB-WARNING-ERRORS
 19805              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19806                  GO TO 4205-READ-NEXT-RECORD
 19807              ELSE
 19808                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19809                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19810                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 363
* EL6311.cbl
 19811                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19812                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19813                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19814                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19815                 GO TO 7100-DISPLAY-CANCELS
 19816           ELSE
 19817              GO TO 4205-READ-NEXT-RECORD.
 19818
 19819     IF PB-CANCELLATION
 19820        IF (CANCEL-IN-ERROR  AND
 19821            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19822            ALL-CANCELS
 19823            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19824            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19825            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19826            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19827            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19828            MOVE PB-SV-STATE            TO PI-SV-STATE
 19829            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19830            GO TO 7100-DISPLAY-CANCELS.
 19831
 19832     GO TO 4205-READ-NEXT-RECORD.
 19833
 19834 4250-END-RECORDS.
 19835******************************************************************
 19836*                                                                *
 19837*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19838*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19839*         PROGRAM.                                               *
 19840*                                                                *
 19841******************************************************************
 19842
 19843     IF BROWSE-STARTED
 19844        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19845
 19846* EXEC CICS ENDBR
 19847*            DATASET  (FILE-ID-ERPNDB4)
 19848*       END-EXEC.
 19849     MOVE 0
 19850       TO DFHEIV11
 19851*    MOVE '&2                    $   #00016952' TO DFHEIV0
 19852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19854     MOVE X'2020233030303136393532' TO DFHEIV0(25:11)
 19855     CALL 'kxdfhei1' USING DFHEIV0,
 19856           FILE-ID-ERPNDB4,
 19857           DFHEIV11,
 19858           DFHEIV99
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19860
 19861
 19862     IF  EIBTRNID NOT = TRANS-EXB1
 19863         IF PENDING-BUS-RECS-FOUND
 19864             NEXT SENTENCE
 19865           ELSE
 19866             MOVE '9'            TO PI-BROWSE-SW
 19867             GO TO 9400-CLEAR.
 19868
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 364
* EL6311.cbl
 19869     IF SHOW-RECORD
 19870        MOVE ER-2253            TO EMI-ERROR
 19871       ELSE
 19872        MOVE ER-2254            TO EMI-ERROR.
 19873
 19874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19875
 19876     IF PI-MAP-NAME = SPACES
 19877        MOVE -1                  TO DPFENTRL
 19878        MOVE EL631D               TO PI-MAP-NAME
 19879        GO TO 8100-SEND-INITIAL-MAP.
 19880
 19881     IF PI-MAP-NAME = EL631B
 19882        MOVE -1                  TO BMAINTL
 19883     ELSE
 19884        IF PI-MAP-NAME = EL631C
 19885           MOVE -1               TO CMAINTL
 19886        ELSE
 19887           MOVE -1               TO DPFENTRL.
 19888
 19889     GO TO 8200-SEND-DATAONLY.
 19890
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 365
* EL6311.cbl
 19892
 19893***************************************************************
 19894*                                                             *
 19895*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19896*                                                             *
 19897*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19898*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19899*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19900*                                                             *
 19901*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19902*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19903*          A. IS IT WITHIN THE SAME COMPANY                   *
 19904*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19905*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19906*                AND IS IT TO BE DISPLAYED.                   *
 19907*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19908*                DISPLAYED.                                   *
 19909*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19910*                DISPLAYED.                                   *
 19911*                                                             *
 19912*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19913*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19914*                                                             *
 19915*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19916*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19917*                THEY ARE NOT TO BE DISPLAYED.                *
 19918*                                                             *
 19919***************************************************************
 19920
 19921 4300-BROWSE-FILE-FORWARD.
 19922     IF FIRST-TIME OR SHOW-RECORD
 19923        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19924        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19925        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19926     ELSE
 19927        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19928        IF ERPNDB-BATCH-SEQ-NO = +9999
 19929           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19930        ELSE
 19931           IF DISPLAY-CHANGE-RECORDS
 19932              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19933           ELSE
 19934              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19935              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19936
 19937
 19938* EXEC CICS HANDLE CONDITION
 19939*         ENDFILE  (4350-END-BATCH)
 19940*         NOTFND   (4350-END-BATCH)
 19941*    END-EXEC.
 19942*    MOVE '"$''I                  ! M #00017031' TO DFHEIV0
 19943     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19945     MOVE X'4D20233030303137303331' TO DFHEIV0(25:11)
 19946     CALL 'kxdfhei1' USING DFHEIV0
 19947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19948
 19949
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 366
* EL6311.cbl
 19950 4305-READ-NEXT.
 19951     IF PI-DISPLAY-ORIGINAL-BATCH
 19952        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19953     ELSE
 19954        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19955
 19956
 19957* EXEC CICS READ
 19958*         DATASET   (FILE-ID)
 19959*         SET       (ADDRESS OF PENDING-BUSINESS)
 19960*         RIDFLD    (ERPNDB-KEY)
 19961*         GTEQ
 19962*    END-EXEC.
 19963*    MOVE '&"S        G          (   #00017042' TO DFHEIV0
 19964     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19966     MOVE X'2020233030303137303432' TO DFHEIV0(25:11)
 19967     CALL 'kxdfhei1' USING DFHEIV0,
 19968           FILE-ID,
 19969           DFHEIV20,
 19970           DFHEIV99,
 19971           ERPNDB-KEY,
 19972           DFHEIV99,
 19973           DFHEIV99,
 19974           DFHEIV99
 19975     SET ADDRESS OF PENDING-BUSINESS TO
 19976         DFHEIV20
 19977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19978
 19979
 19980     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19981        GO TO 4350-END-BATCH.
 19982
 19983     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19984                                    WS-BATCH-NO.
 19985
 19986     IF  WS-BATCH-PREFIX = '#CL'
 19987         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19988         GO TO 4305-READ-NEXT.
 19989
 19990     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19991     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19992     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19993     MOVE PB-STATE               TO PI-PB-STATE.
 19994     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19995
 19996     IF PB-BATCH-TRAILER
 19997        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19998        GO TO 4305-READ-NEXT.
 19999
 20000     IF SHOW-RECORD
 20001           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 20002              GO TO 4310-BUMP-SEQ
 20003           ELSE
 20004              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20005                 GO TO 4310-BUMP-SEQ
 20006              ELSE
 20007                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 367
* EL6311.cbl
 20008
 20009     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20010        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20011           GO TO 4310-BUMP-SEQ
 20012        ELSE
 20013           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20014              GO TO 4307-CHECK-REC-TYPE
 20015           ELSE
 20016              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20017                 GO TO 4307-CHECK-REC-TYPE
 20018              ELSE
 20019                 GO TO 4310-BUMP-SEQ.
 20020
 20021     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20022        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20023           GO TO 4310-BUMP-SEQ.
 20024
 20025 4307-CHECK-REC-TYPE.
 20026     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20027         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20028             NEXT SENTENCE
 20029         ELSE
 20030             GO TO 4310-BUMP-SEQ.
 20031
 20032     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20033         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20034             NEXT SENTENCE
 20035        ELSE
 20036             GO TO 4310-BUMP-SEQ.
 20037
 20038     IF NOT DISPLAY-CHANGE-RECORDS AND
 20039            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20040        GO TO 4310-BUMP-SEQ.
 20041
 20042     IF DISPLAY-HOLD-RECORDS AND
 20043        NOT PB-RECORD-ON-HOLD
 20044          GO TO 4310-BUMP-SEQ.
 20045
 20046     IF PB-ISSUE
 20047        IF DISPLAY-CHK-REQ-RECORDS
 20048           GO TO 4310-BUMP-SEQ.
 20049
 20050     IF PB-ISSUE
 20051        IF ISSUE-WITH-WARNING
 20052           IF PB-WARNING-ERRORS
 20053              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20054                  GO TO 4310-BUMP-SEQ
 20055              ELSE
 20056                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20057                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20058                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20059                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20060                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20061                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20062                 GO TO 7000-DISPLAY-ISSUES
 20063           ELSE
 20064              GO TO 4310-BUMP-SEQ.
 20065
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 368
* EL6311.cbl
 20066     IF PB-ISSUE
 20067        IF (ISSUES-IN-ERROR AND
 20068            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20069            ALL-ISSUES
 20070            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20071            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20072            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20073            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20074            MOVE PB-SV-STATE            TO PI-SV-STATE
 20075            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20076            GO TO 7000-DISPLAY-ISSUES
 20077        ELSE
 20078            GO TO 4310-BUMP-SEQ.
 20079
 20080     IF PB-CANCELLATION
 20081        IF DISPLAY-CHK-REQ-RECORDS
 20082           IF PB-C-REFUND-REQUESTED
 20083              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20084              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20085              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20086              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20087              MOVE PB-SV-STATE            TO PI-SV-STATE
 20088              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20089              GO TO 7100-DISPLAY-CANCELS
 20090           ELSE
 20091              GO TO 4310-BUMP-SEQ.
 20092
 20093     IF PB-CANCELLATION
 20094        IF CANCEL-WITH-WARNING
 20095           IF PB-WARNING-ERRORS
 20096              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20097                  GO TO 4310-BUMP-SEQ
 20098              ELSE
 20099                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20100                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20101                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20102                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20103                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20104                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20105                 GO TO 7100-DISPLAY-CANCELS
 20106           ELSE
 20107              GO TO 4310-BUMP-SEQ.
 20108
 20109     IF PB-CANCELLATION
 20110        IF (CANCEL-IN-ERROR  AND
 20111            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20112            ALL-CANCELS
 20113            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20114            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20115            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20116            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20117            MOVE PB-SV-STATE            TO PI-SV-STATE
 20118            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20119            GO TO 7100-DISPLAY-CANCELS.
 20120
 20121 4310-BUMP-SEQ.
 20122     IF NOT DISPLAY-CHANGE-RECORDS
 20123        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 369
* EL6311.cbl
 20124        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 20125     ELSE
 20126        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 20127           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 20128           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 20129        ELSE
 20130           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 20131           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 20132
 20133     GO TO 4305-READ-NEXT.
 20134
 20135 4350-END-BATCH.
 20136
 20137******************************************************************
 20138*                                                                *
 20139*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20140*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 20141*         PROGRAM.                                               *
 20142*                                                                *
 20143******************************************************************
 20144
 20145     IF  EIBTRNID NOT = TRANS-EXB1
 20146         IF PENDING-BUS-RECS-FOUND
 20147             NEXT SENTENCE
 20148           ELSE
 20149             MOVE '9'            TO PI-BROWSE-SW
 20150             GO TO 9400-CLEAR.
 20151
 20152     IF SHOW-RECORD
 20153        MOVE ER-2253            TO EMI-ERROR
 20154     ELSE
 20155        MOVE ER-2251            TO EMI-ERROR.
 20156
 20157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20158
 20159     IF PI-MAP-NAME = SPACES
 20160        MOVE -1                  TO BMAINTL
 20161        MOVE EL631B               TO PI-MAP-NAME
 20162        GO TO 8100-SEND-INITIAL-MAP.
 20163
 20164     IF PI-MAP-NAME = EL631B
 20165        MOVE -1                  TO BMAINTL
 20166     ELSE
 20167        IF PI-MAP-NAME = EL631C
 20168           MOVE -1               TO CMAINTL
 20169        ELSE
 20170           MOVE -1               TO DPFENTRL.
 20171
 20172     GO TO 8200-SEND-DATAONLY.
 20173
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 370
* EL6311.cbl
 20175
 20176******************************************************************
 20177*                                                                *
 20178*        B R O W S E   D E T A I L   B A C K W A R D             *
 20179*                                                                *
 20180******************************************************************
 20181
 20182 4500-BROWSE-DETAIL-BACKWARD.
 20183
 20184     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20185
 20186
 20187* EXEC CICS HANDLE CONDITION
 20188*         NOTFND   (4570-NOT-FOUND)
 20189*         ENDFILE  (4550-END-RECORDS)
 20190*    END-EXEC
 20191*    MOVE '"$I''                  ! N #00017255' TO DFHEIV0
 20192     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20194     MOVE X'4E20233030303137323535' TO DFHEIV0(25:11)
 20195     CALL 'kxdfhei1' USING DFHEIV0
 20196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20197
 20198
 20199* EXEC CICS STARTBR
 20200*         DATASET   (FILE-ID-ERPNDB2)
 20201*         RIDFLD    (ERPNDB-ALT-KEY)
 20202*    END-EXEC.
 20203     MOVE 0
 20204       TO DFHEIV11
 20205*    MOVE '&,         G          &   #00017260' TO DFHEIV0
 20206     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20208     MOVE X'2020233030303137323630' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0,
 20210           FILE-ID-ERPNDB2,
 20211           ERPNDB-ALT-KEY,
 20212           DFHEIV99,
 20213           DFHEIV11,
 20214           DFHEIV99
 20215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20216
 20217
 20218     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20219                                    WS-FIRST-TIME-SW.
 20220
 20221 4505-READ-PREV-RECORD.
 20222
 20223* EXEC CICS READPREV
 20224*         DATASET    (FILE-ID-ERPNDB2)
 20225*         SET        (ADDRESS OF PENDING-BUSINESS)
 20226*         RIDFLD     (ERPNDB-ALT-KEY)
 20227*    END-EXEC.
 20228     MOVE 0
 20229       TO DFHEIV11
 20230*    MOVE '&0S                   )   #00017269' TO DFHEIV0
 20231     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20232     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 371
* EL6311.cbl
 20233     MOVE X'2020233030303137323639' TO DFHEIV0(25:11)
 20234     CALL 'kxdfhei1' USING DFHEIV0,
 20235           FILE-ID-ERPNDB2,
 20236           DFHEIV20,
 20237           DFHEIV99,
 20238           ERPNDB-ALT-KEY,
 20239           DFHEIV99,
 20240           DFHEIV11,
 20241           DFHEIV99,
 20242           DFHEIV99
 20243     SET ADDRESS OF PENDING-BUSINESS TO
 20244         DFHEIV20
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20249
 20250     IF WS-BATCH-PREFIX = '#CL'
 20251         GO TO 4505-READ-PREV-RECORD.
 20252
 20253     IF FIRST-TIME
 20254         MOVE SPACE               TO WS-FIRST-TIME-SW
 20255         GO TO 4505-READ-PREV-RECORD.
 20256
 20257     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20258        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20259        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20260        PB-STATE         NOT = PI-PB-STATE    OR
 20261        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20262          GO TO 4550-END-RECORDS.
 20263
 20264
 20265     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20266
 20267     IF PB-BATCH-TRAILER
 20268        GO TO 4505-READ-PREV-RECORD.
 20269
 20270     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20271
 20272     IF  WS-BATCH-PREFIX = '#CL'
 20273         GO TO 4505-READ-PREV-RECORD.
 20274
 20275     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20276        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20277           GO TO 4505-READ-PREV-RECORD
 20278        ELSE
 20279           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20280              GO TO 4510-CHECK-REC-TYPE
 20281           ELSE
 20282              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20283                 GO TO 4510-CHECK-REC-TYPE
 20284              ELSE
 20285                 GO TO 4505-READ-PREV-RECORD.
 20286
 20287     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20288        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20289           GO TO 4505-READ-PREV-RECORD.
 20290
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 372
* EL6311.cbl
 20291 4510-CHECK-REC-TYPE.
 20292     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20293         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20294             NEXT SENTENCE
 20295         ELSE
 20296             GO TO 4505-READ-PREV-RECORD.
 20297
 20298     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20299         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20300             NEXT SENTENCE
 20301        ELSE
 20302             GO TO 4505-READ-PREV-RECORD.
 20303
 20304     IF NOT DISPLAY-CHANGE-RECORDS AND
 20305            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20306        GO TO 4505-READ-PREV-RECORD.
 20307
 20308     IF DISPLAY-HOLD-RECORDS AND
 20309        NOT PB-RECORD-ON-HOLD
 20310          GO TO 4505-READ-PREV-RECORD.
 20311
 20312     IF PB-ISSUE
 20313        IF DISPLAY-CHK-REQ-RECORDS
 20314           GO TO 4505-READ-PREV-RECORD.
 20315
 20316     IF PB-ISSUE
 20317        IF ISSUE-WITH-WARNING
 20318           IF PB-WARNING-ERRORS
 20319              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20320                  GO TO 4505-READ-PREV-RECORD
 20321              ELSE
 20322                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20323                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20324                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20325                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20326                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20327                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20328                 GO TO 7000-DISPLAY-ISSUES
 20329           ELSE
 20330              GO TO 4505-READ-PREV-RECORD.
 20331
 20332     IF PB-ISSUE
 20333        IF (ISSUES-IN-ERROR AND
 20334            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20335            ALL-ISSUES
 20336            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20337            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20338            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20339            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20340            MOVE PB-SV-STATE            TO PI-SV-STATE
 20341            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20342            GO TO 7000-DISPLAY-ISSUES
 20343        ELSE
 20344            GO TO 4505-READ-PREV-RECORD.
 20345
 20346     IF PB-CANCELLATION
 20347        IF DISPLAY-CHK-REQ-RECORDS
 20348           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 373
* EL6311.cbl
 20349              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20350              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20351              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20352              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20353              MOVE PB-SV-STATE            TO PI-SV-STATE
 20354              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20355              GO TO 7100-DISPLAY-CANCELS
 20356           ELSE
 20357              GO TO 4505-READ-PREV-RECORD.
 20358
 20359     IF PB-CANCELLATION
 20360        IF CANCEL-WITH-WARNING
 20361           IF PB-WARNING-ERRORS
 20362              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20363                  GO TO 4505-READ-PREV-RECORD
 20364              ELSE
 20365                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20366                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20367                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20368                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20369                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20370                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20371                 GO TO 7100-DISPLAY-CANCELS
 20372           ELSE
 20373              GO TO 4505-READ-PREV-RECORD.
 20374
 20375     IF PB-CANCELLATION
 20376        IF (CANCEL-IN-ERROR  AND
 20377            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20378            ALL-CANCELS
 20379            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20380            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20381            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20382            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20383            MOVE PB-SV-STATE            TO PI-SV-STATE
 20384            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20385            GO TO 7100-DISPLAY-CANCELS.
 20386
 20387     GO TO 4505-READ-PREV-RECORD.
 20388
 20389 4550-END-RECORDS.
 20390     IF PI-MAP-NAME = EL631B
 20391        MOVE -1                  TO BMAINTL
 20392     ELSE
 20393        IF PI-MAP-NAME = EL631C
 20394           MOVE -1               TO CMAINTL
 20395        ELSE
 20396           MOVE -1               TO DPFENTRL.
 20397
 20398     MOVE ER-2255               TO EMI-ERROR.
 20399     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20400     GO TO 8200-SEND-DATAONLY.
 20401
 20402 4570-NOT-FOUND.
 20403
 20404******************************************************************
 20405*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20406******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 374
* EL6311.cbl
 20407
 20408
 20409* EXEC CICS RESETBR
 20410*         DATASET    (FILE-ID-ERPNDB2)
 20411*         RIDFLD     (ERPNDB-ALT-KEY)
 20412*    END-EXEC.
 20413     MOVE 0
 20414       TO DFHEIV11
 20415*    MOVE '&4         G          &   #00017435' TO DFHEIV0
 20416     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20418     MOVE X'2020233030303137343335' TO DFHEIV0(25:11)
 20419     CALL 'kxdfhei1' USING DFHEIV0,
 20420           FILE-ID-ERPNDB2,
 20421           ERPNDB-ALT-KEY,
 20422           DFHEIV99,
 20423           DFHEIV11,
 20424           DFHEIV99
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428
 20429* EXEC CICS READNEXT
 20430*         DATASET    (FILE-ID-ERPNDB2)
 20431*         SET        (ADDRESS OF PENDING-BUSINESS)
 20432*         RIDFLD     (ERPNDB-ALT-KEY)
 20433*    END-EXEC.
 20434     MOVE 0
 20435       TO DFHEIV11
 20436*    MOVE '&.S                   )   #00017440' TO DFHEIV0
 20437     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20438     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20439     MOVE X'2020233030303137343430' TO DFHEIV0(25:11)
 20440     CALL 'kxdfhei1' USING DFHEIV0,
 20441           FILE-ID-ERPNDB2,
 20442           DFHEIV20,
 20443           DFHEIV99,
 20444           ERPNDB-ALT-KEY,
 20445           DFHEIV99,
 20446           DFHEIV11,
 20447           DFHEIV99,
 20448           DFHEIV99
 20449     SET ADDRESS OF PENDING-BUSINESS TO
 20450         DFHEIV20
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454
 20455* EXEC CICS READPREV
 20456*         DATASET    (FILE-ID-ERPNDB2)
 20457*         SET        (ADDRESS OF PENDING-BUSINESS)
 20458*         RIDFLD     (ERPNDB-ALT-KEY)
 20459*    END-EXEC.
 20460     MOVE 0
 20461       TO DFHEIV11
 20462*    MOVE '&0S                   )   #00017446' TO DFHEIV0
 20463     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20464     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 375
* EL6311.cbl
 20465     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 20466     CALL 'kxdfhei1' USING DFHEIV0,
 20467           FILE-ID-ERPNDB2,
 20468           DFHEIV20,
 20469           DFHEIV99,
 20470           ERPNDB-ALT-KEY,
 20471           DFHEIV99,
 20472           DFHEIV11,
 20473           DFHEIV99,
 20474           DFHEIV99
 20475     SET ADDRESS OF PENDING-BUSINESS TO
 20476         DFHEIV20
 20477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20478
 20479
 20480 4580-READ-PREV-RECORD.
 20481
 20482* EXEC CICS READPREV
 20483*         DATASET    (FILE-ID-ERPNDB2)
 20484*         SET        (ADDRESS OF PENDING-BUSINESS)
 20485*         RIDFLD     (ERPNDB-ALT-KEY)
 20486*    END-EXEC.
 20487     MOVE 0
 20488       TO DFHEIV11
 20489*    MOVE '&0S                   )   #00017453' TO DFHEIV0
 20490     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20491     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20492     MOVE X'2020233030303137343533' TO DFHEIV0(25:11)
 20493     CALL 'kxdfhei1' USING DFHEIV0,
 20494           FILE-ID-ERPNDB2,
 20495           DFHEIV20,
 20496           DFHEIV99,
 20497           ERPNDB-ALT-KEY,
 20498           DFHEIV99,
 20499           DFHEIV11,
 20500           DFHEIV99,
 20501           DFHEIV99
 20502     SET ADDRESS OF PENDING-BUSINESS TO
 20503         DFHEIV20
 20504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20505
 20506
 20507     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20508
 20509     IF WS-BATCH-PREFIX = '#CL'
 20510        GO TO 4580-READ-PREV-RECORD.
 20511
 20512     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20513     GO TO 4505-READ-PREV-RECORD.
 20514
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 376
* EL6311.cbl
 20516
 20517******************************************************************
 20518*                                                                *
 20519*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20520*                                                                *
 20521******************************************************************
 20522
 20523 4600-BROWSE-PRIMARY-BACKWARD.
 20524        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20525
 20526     IF ERPNDB-BATCH-SEQ-NO = +9999
 20527        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20528
 20529        IF ERPNDB-BATCH-SEQ-NO = +0000
 20530           GO TO 4650-END-BATCH
 20531        ELSE
 20532           IF PI-MAP-NAME NOT = EL631D
 20533              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20534                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20535              ELSE
 20536                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20537                 IF DISPLAY-CHANGE-RECORDS
 20538                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20539                 ELSE
 20540                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20541
 20542
 20543* EXEC CICS HANDLE CONDITION
 20544*         NOTFND    (4680-NOT-FOUND)
 20545*         ENDFILE   (4680-NOT-FOUND)
 20546*    END-EXEC.
 20547*    MOVE '"$I''                  ! O #00017494' TO DFHEIV0
 20548     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20550     MOVE X'4F20233030303137343934' TO DFHEIV0(25:11)
 20551     CALL 'kxdfhei1' USING DFHEIV0
 20552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20553
 20554
 20555 4605-READ-NEXT.
 20556     IF ERPNDB-BATCH-SEQ-NO = +0000
 20557        GO TO 4650-END-BATCH.
 20558
 20559     IF PI-DISPLAY-ORIGINAL-BATCH
 20560        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20561     ELSE
 20562        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20563
 20564
 20565* EXEC CICS READ
 20566*         DATASET   (FILE-ID)
 20567*         SET       (ADDRESS OF PENDING-BUSINESS)
 20568*         RIDFLD    (ERPNDB-KEY)
 20569*    END-EXEC.
 20570*    MOVE '&"S        E          (   #00017508' TO DFHEIV0
 20571     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20573     MOVE X'2020233030303137353038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 377
* EL6311.cbl
 20574     CALL 'kxdfhei1' USING DFHEIV0,
 20575           FILE-ID,
 20576           DFHEIV20,
 20577           DFHEIV99,
 20578           ERPNDB-KEY,
 20579           DFHEIV99,
 20580           DFHEIV99,
 20581           DFHEIV99
 20582     SET ADDRESS OF PENDING-BUSINESS TO
 20583         DFHEIV20
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587     IF NOT  PI-PRIMARY-WITH-SELECT
 20588        GO TO 4607-CHECK-REC-TYPE.
 20589
 20590     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20591
 20592     IF  WS-BATCH-PREFIX = '#CL'
 20593         GO TO 4610-BUMP-SEQ.
 20594
 20595     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20596        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20597           GO TO 4610-BUMP-SEQ
 20598        ELSE
 20599           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20600              GO TO 4607-CHECK-REC-TYPE
 20601           ELSE
 20602              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20603                 GO TO 4607-CHECK-REC-TYPE
 20604              ELSE
 20605                 GO TO 4610-BUMP-SEQ.
 20606
 20607     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20608        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20609           GO TO 4610-BUMP-SEQ.
 20610
 20611 4607-CHECK-REC-TYPE.
 20612     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20613         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20614             NEXT SENTENCE
 20615         ELSE
 20616             GO TO 4610-BUMP-SEQ.
 20617
 20618     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20619         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20620             NEXT SENTENCE
 20621        ELSE
 20622             GO TO 4610-BUMP-SEQ.
 20623
 20624     IF NOT DISPLAY-CHANGE-RECORDS AND
 20625            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20626        GO TO 4610-BUMP-SEQ.
 20627
 20628     IF DISPLAY-HOLD-RECORDS AND
 20629        NOT PB-RECORD-ON-HOLD
 20630          GO TO 4610-BUMP-SEQ.
 20631
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 378
* EL6311.cbl
 20632     IF PB-ISSUE
 20633        IF DISPLAY-CHK-REQ-RECORDS
 20634           GO TO 4610-BUMP-SEQ.
 20635
 20636     IF PB-ISSUE
 20637        IF ISSUE-WITH-WARNING
 20638           IF PB-WARNING-ERRORS
 20639              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20640                  GO TO 4610-BUMP-SEQ
 20641              ELSE
 20642                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20643                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20644                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20645                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20646                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20647                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20648                 GO TO 7000-DISPLAY-ISSUES
 20649           ELSE
 20650              GO TO 4610-BUMP-SEQ.
 20651
 20652     IF PB-ISSUE
 20653        IF (ISSUES-IN-ERROR AND
 20654            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20655            ALL-ISSUES
 20656            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20657            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20658            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20659            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20660            MOVE PB-SV-STATE            TO PI-SV-STATE
 20661            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20662            GO TO 7000-DISPLAY-ISSUES
 20663        ELSE
 20664            GO TO 4610-BUMP-SEQ.
 20665
 20666     IF PB-CANCELLATION
 20667        IF DISPLAY-CHK-REQ-RECORDS
 20668           IF PB-C-REFUND-REQUESTED
 20669              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20670              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20671              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20672              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20673              MOVE PB-SV-STATE            TO PI-SV-STATE
 20674              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20675              GO TO 7100-DISPLAY-CANCELS
 20676           ELSE
 20677              GO TO 4610-BUMP-SEQ.
 20678
 20679     IF PB-CANCELLATION
 20680        IF CANCEL-WITH-WARNING
 20681           IF PB-WARNING-ERRORS
 20682              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20683                  GO TO 4610-BUMP-SEQ
 20684              ELSE
 20685                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20686                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20687                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20688                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20689                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 379
* EL6311.cbl
 20690                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20691                 GO TO 7100-DISPLAY-CANCELS
 20692           ELSE
 20693              GO TO 4610-BUMP-SEQ.
 20694
 20695     IF PB-CANCELLATION
 20696        IF (CANCEL-IN-ERROR  AND
 20697            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20698            ALL-CANCELS
 20699            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20700            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20701            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20702            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20703            MOVE PB-SV-STATE            TO PI-SV-STATE
 20704            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20705            GO TO 7100-DISPLAY-CANCELS.
 20706
 20707 4610-BUMP-SEQ.
 20708     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20709        GO TO 4650-END-BATCH.
 20710
 20711     IF DISPLAY-CHANGE-RECORDS
 20712        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20713           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20714        ELSE
 20715           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20716           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20717        ELSE
 20718           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20719           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20720
 20721        GO TO 4605-READ-NEXT.
 20722
 20723 4650-END-BATCH.
 20724     IF PI-MAP-NAME = EL631B
 20725        MOVE -1                  TO BMAINTL
 20726     ELSE
 20727        IF PI-MAP-NAME = EL631C
 20728           MOVE -1               TO CMAINTL
 20729        ELSE
 20730           MOVE -1               TO DPFENTRL.
 20731
 20732     MOVE ER-2252               TO EMI-ERROR.
 20733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20734     GO TO 8200-SEND-DATAONLY.
 20735
 20736 4680-NOT-FOUND.
 20737     IF DISPLAY-CHANGE-RECORDS
 20738        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20739           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20740        ELSE
 20741           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20742           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20743     ELSE
 20744        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20745
 20746     GO TO 4605-READ-NEXT.
 20747
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 380
* EL6311.cbl
 20749
 20750******************************************************************
 20751*                                                                *
 20752*        B R O W S E   F I L E   B A C K W A R D S               *
 20753*                                                                *
 20754******************************************************************
 20755
 20756 4800-BROWSE-FILE-BACKWARD.
 20757
 20758* EXEC CICS HANDLE CONDITION
 20759*         NOTFND   (4860-NOT-FOUND)
 20760*         ENDFILE  (4850-END-RECORDS)
 20761*    END-EXEC.
 20762*    MOVE '"$I''                  ! P #00017684' TO DFHEIV0
 20763     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20765     MOVE X'5020233030303137363834' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0
 20767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20768
 20769
 20770     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20771
 20772     IF PI-DISPLAY-ORIGINAL-BATCH
 20773        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20774     ELSE
 20775        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20776
 20777
 20778* EXEC CICS STARTBR
 20779*         DATASET   (FILE-ID)
 20780*         RIDFLD    (ERPNDB-KEY)
 20781*    END-EXEC.
 20782     MOVE 0
 20783       TO DFHEIV11
 20784*    MOVE '&,         G          &   #00017696' TO DFHEIV0
 20785     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20786     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20787     MOVE X'2020233030303137363936' TO DFHEIV0(25:11)
 20788     CALL 'kxdfhei1' USING DFHEIV0,
 20789           FILE-ID,
 20790           ERPNDB-KEY,
 20791           DFHEIV99,
 20792           DFHEIV11,
 20793           DFHEIV99
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20798
 20799
 20800* EXEC CICS READPREV
 20801*         DATASET    (FILE-ID-ERPNDB)
 20802*         SET        (ADDRESS OF PENDING-BUSINESS)
 20803*         RIDFLD     (ERPNDB-KEY)
 20804*    END-EXEC.
 20805     MOVE 0
 20806       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 381
* EL6311.cbl
 20807*    MOVE '&0S                   )   #00017703' TO DFHEIV0
 20808     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20809     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20810     MOVE X'2020233030303137373033' TO DFHEIV0(25:11)
 20811     CALL 'kxdfhei1' USING DFHEIV0,
 20812           FILE-ID-ERPNDB,
 20813           DFHEIV20,
 20814           DFHEIV99,
 20815           ERPNDB-KEY,
 20816           DFHEIV99,
 20817           DFHEIV11,
 20818           DFHEIV99,
 20819           DFHEIV99
 20820     SET ADDRESS OF PENDING-BUSINESS TO
 20821         DFHEIV20
 20822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20823
 20824
 20825 4810-READ-PREV-RECORD.
 20826
 20827* EXEC CICS READPREV
 20828*         DATASET    (FILE-ID-ERPNDB)
 20829*         SET        (ADDRESS OF PENDING-BUSINESS)
 20830*         RIDFLD     (ERPNDB-KEY)
 20831*    END-EXEC.
 20832     MOVE 0
 20833       TO DFHEIV11
 20834*    MOVE '&0S                   )   #00017710' TO DFHEIV0
 20835     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20836     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20837     MOVE X'2020233030303137373130' TO DFHEIV0(25:11)
 20838     CALL 'kxdfhei1' USING DFHEIV0,
 20839           FILE-ID-ERPNDB,
 20840           DFHEIV20,
 20841           DFHEIV99,
 20842           ERPNDB-KEY,
 20843           DFHEIV99,
 20844           DFHEIV11,
 20845           DFHEIV99,
 20846           DFHEIV99
 20847     SET ADDRESS OF PENDING-BUSINESS TO
 20848         DFHEIV20
 20849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20850
 20851
 20852     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20853        GO TO 4850-END-RECORDS.
 20854
 20855     IF PB-BATCH-TRAILER
 20856        GO TO 4810-READ-PREV-RECORD.
 20857
 20858     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20859
 20860     IF  WS-BATCH-PREFIX = '#CL'
 20861         GO TO 4810-READ-PREV-RECORD.
 20862
 20863     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20864        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 382
* EL6311.cbl
 20865           GO TO 4810-READ-PREV-RECORD
 20866        ELSE
 20867           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20868              GO TO 4820-CHECK-REC-TYPE
 20869           ELSE
 20870              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20871                 GO TO 4820-CHECK-REC-TYPE
 20872              ELSE
 20873                 GO TO 4810-READ-PREV-RECORD.
 20874
 20875     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20876        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20877           GO TO 4810-READ-PREV-RECORD.
 20878
 20879 4820-CHECK-REC-TYPE.
 20880     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20881         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20882             NEXT SENTENCE
 20883         ELSE
 20884             GO TO 4810-READ-PREV-RECORD.
 20885
 20886     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20887         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20888             NEXT SENTENCE
 20889        ELSE
 20890             GO TO 4810-READ-PREV-RECORD.
 20891
 20892     IF NOT DISPLAY-CHANGE-RECORDS AND
 20893            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20894        GO TO 4810-READ-PREV-RECORD.
 20895
 20896     IF DISPLAY-HOLD-RECORDS AND
 20897        NOT PB-RECORD-ON-HOLD
 20898          GO TO 4810-READ-PREV-RECORD.
 20899
 20900     IF PB-ISSUE
 20901        IF DISPLAY-CHK-REQ-RECORDS
 20902           GO TO 4810-READ-PREV-RECORD.
 20903
 20904     IF PB-ISSUE
 20905        IF ISSUE-WITH-WARNING
 20906           IF PB-WARNING-ERRORS
 20907              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20908                  GO TO 4810-READ-PREV-RECORD
 20909              ELSE
 20910                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20911                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20912                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20913                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20914                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20915                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20916                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20917                 GO TO 7000-DISPLAY-ISSUES
 20918           ELSE
 20919              GO TO 4810-READ-PREV-RECORD.
 20920
 20921     IF PB-ISSUE
 20922        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 383
* EL6311.cbl
 20923            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20924            ALL-ISSUES
 20925            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20926            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20927            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20928            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20929            MOVE PB-SV-STATE            TO PI-SV-STATE
 20930            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20931            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20932            GO TO 7000-DISPLAY-ISSUES
 20933        ELSE
 20934            GO TO 4810-READ-PREV-RECORD.
 20935
 20936     IF PB-CANCELLATION
 20937        IF DISPLAY-CHK-REQ-RECORDS
 20938           IF PB-C-REFUND-REQUESTED
 20939              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20940              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20941              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20942              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20943              MOVE PB-SV-STATE            TO PI-SV-STATE
 20944              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20945              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20946              GO TO 7100-DISPLAY-CANCELS
 20947           ELSE
 20948              GO TO 4810-READ-PREV-RECORD.
 20949
 20950     IF PB-CANCELLATION
 20951        IF CANCEL-WITH-WARNING
 20952           IF PB-WARNING-ERRORS
 20953              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20954                  GO TO 4810-READ-PREV-RECORD
 20955              ELSE
 20956                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20957                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20958                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20959                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20960                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20961                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20962                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20963                 GO TO 7100-DISPLAY-CANCELS
 20964           ELSE
 20965              GO TO 4810-READ-PREV-RECORD.
 20966
 20967     IF PB-CANCELLATION
 20968        IF (CANCEL-IN-ERROR  AND
 20969            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20970            ALL-CANCELS
 20971            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20972            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20973            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20974            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20975            MOVE PB-SV-STATE            TO PI-SV-STATE
 20976            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20977            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20978            GO TO 7100-DISPLAY-CANCELS.
 20979
 20980     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 384
* EL6311.cbl
 20981
 20982 4850-END-RECORDS.
 20983     MOVE ER-2252                TO EMI-ERROR.
 20984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20985
 20986     IF PI-MAP-NAME = EL631B
 20987        MOVE -1                  TO BPFENTRL
 20988     ELSE
 20989        MOVE -1                  TO CPFENTRL.
 20990
 20991     GO TO 8200-SEND-DATAONLY.
 20992
 20993 4860-NOT-FOUND.
 20994
 20995******************************************************************
 20996*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20997******************************************************************
 20998
 20999
 21000* EXEC CICS RESETBR
 21001*         DATASET    (FILE-ID-ERPNDB)
 21002*         RIDFLD     (ERPNDB-KEY)
 21003*     END-EXEC.
 21004     MOVE 0
 21005       TO DFHEIV11
 21006*    MOVE '&4         G          &   #00017863' TO DFHEIV0
 21007     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21009     MOVE X'2020233030303137383633' TO DFHEIV0(25:11)
 21010     CALL 'kxdfhei1' USING DFHEIV0,
 21011           FILE-ID-ERPNDB,
 21012           ERPNDB-KEY,
 21013           DFHEIV99,
 21014           DFHEIV11,
 21015           DFHEIV99
 21016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21017
 21018
 21019
 21020* EXEC CICS READNEXT
 21021*         DATASET    (FILE-ID-ERPNDB)
 21022*         SET        (ADDRESS OF PENDING-BUSINESS)
 21023*         RIDFLD     (ERPNDB-KEY)
 21024*    END-EXEC.
 21025     MOVE 0
 21026       TO DFHEIV11
 21027*    MOVE '&.S                   )   #00017868' TO DFHEIV0
 21028     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21030     MOVE X'2020233030303137383638' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           FILE-ID-ERPNDB,
 21033           DFHEIV20,
 21034           DFHEIV99,
 21035           ERPNDB-KEY,
 21036           DFHEIV99,
 21037           DFHEIV11,
 21038           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 385
* EL6311.cbl
 21039           DFHEIV99
 21040     SET ADDRESS OF PENDING-BUSINESS TO
 21041         DFHEIV20
 21042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21043
 21044
 21045
 21046* EXEC CICS READPREV
 21047*         DATASET    (FILE-ID-ERPNDB)
 21048*         SET        (ADDRESS OF PENDING-BUSINESS)
 21049*         RIDFLD     (ERPNDB-KEY)
 21050*    END-EXEC.
 21051     MOVE 0
 21052       TO DFHEIV11
 21053*    MOVE '&0S                   )   #00017874' TO DFHEIV0
 21054     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303137383734' TO DFHEIV0(25:11)
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           FILE-ID-ERPNDB,
 21059           DFHEIV20,
 21060           DFHEIV99,
 21061           ERPNDB-KEY,
 21062           DFHEIV99,
 21063           DFHEIV11,
 21064           DFHEIV99,
 21065           DFHEIV99
 21066     SET ADDRESS OF PENDING-BUSINESS TO
 21067         DFHEIV20
 21068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21069
 21070
 21071     GO TO 4810-READ-PREV-RECORD.
 21072
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 386
* EL6311.cbl
 21074
 21075******************************************************************
 21076*                                                                *
 21077*           B R O W S E   C S R   B A C K W A R D                *
 21078*                                                                *
 21079******************************************************************
 21080
 21081 4900-BROWSE-CSR-BACKWARD.
 21082
 21083     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 21084
 21085
 21086* EXEC CICS HANDLE CONDITION
 21087*         NOTFND   (4970-NOT-FOUND)
 21088*         ENDFILE  (4950-END-RECORDS)
 21089*    END-EXEC
 21090*    MOVE '"$I''                  ! Q #00017894' TO DFHEIV0
 21091     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21093     MOVE X'5120233030303137383934' TO DFHEIV0(25:11)
 21094     CALL 'kxdfhei1' USING DFHEIV0
 21095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21096
 21097
 21098* EXEC CICS STARTBR
 21099*         DATASET   (FILE-ID-ERPNDB4)
 21100*         RIDFLD    (ERPNDB-CSR-KEY)
 21101*    END-EXEC.
 21102     MOVE 0
 21103       TO DFHEIV11
 21104*    MOVE '&,         G          &   #00017899' TO DFHEIV0
 21105     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21107     MOVE X'2020233030303137383939' TO DFHEIV0(25:11)
 21108     CALL 'kxdfhei1' USING DFHEIV0,
 21109           FILE-ID-ERPNDB4,
 21110           ERPNDB-CSR-KEY,
 21111           DFHEIV99,
 21112           DFHEIV11,
 21113           DFHEIV99
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 21118                                    WS-FIRST-TIME-SW.
 21119
 21120 4905-READ-PREV-RECORD.
 21121
 21122* EXEC CICS READPREV
 21123*         DATASET    (FILE-ID-ERPNDB4)
 21124*         SET        (ADDRESS OF PENDING-BUSINESS)
 21125*         RIDFLD     (ERPNDB-CSR-KEY)
 21126*    END-EXEC.
 21127     MOVE 0
 21128       TO DFHEIV11
 21129*    MOVE '&0S                   )   #00017908' TO DFHEIV0
 21130     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 387
* EL6311.cbl
 21132     MOVE X'2020233030303137393038' TO DFHEIV0(25:11)
 21133     CALL 'kxdfhei1' USING DFHEIV0,
 21134           FILE-ID-ERPNDB4,
 21135           DFHEIV20,
 21136           DFHEIV99,
 21137           ERPNDB-CSR-KEY,
 21138           DFHEIV99,
 21139           DFHEIV11,
 21140           DFHEIV99,
 21141           DFHEIV99
 21142     SET ADDRESS OF PENDING-BUSINESS TO
 21143         DFHEIV20
 21144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21145
 21146
 21147     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21148
 21149     IF WS-BATCH-PREFIX = '#CL'
 21150         GO TO 4905-READ-PREV-RECORD.
 21151
 21152     IF FIRST-TIME
 21153         MOVE SPACE               TO WS-FIRST-TIME-SW
 21154         GO TO 4905-READ-PREV-RECORD.
 21155
 21156     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 21157        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21158        GO TO 4950-END-RECORDS.
 21159
 21160     IF PB-BATCH-TRAILER
 21161        GO TO 4905-READ-PREV-RECORD.
 21162
 21163     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21164
 21165     IF  WS-BATCH-PREFIX = '#CL'
 21166         GO TO 4905-READ-PREV-RECORD.
 21167
 21168     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21169        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21170           GO TO 4905-READ-PREV-RECORD
 21171        ELSE
 21172           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21173              GO TO 4910-CHECK-REC-TYPE
 21174           ELSE
 21175              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21176                 GO TO 4910-CHECK-REC-TYPE
 21177              ELSE
 21178                 GO TO 4905-READ-PREV-RECORD.
 21179
 21180     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21181        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21182           GO TO 4905-READ-PREV-RECORD.
 21183
 21184 4910-CHECK-REC-TYPE.
 21185     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21186         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21187             NEXT SENTENCE
 21188         ELSE
 21189             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 388
* EL6311.cbl
 21190
 21191     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21192         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21193             NEXT SENTENCE
 21194        ELSE
 21195             GO TO 4905-READ-PREV-RECORD.
 21196
 21197     IF NOT DISPLAY-CHANGE-RECORDS AND
 21198            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21199        GO TO 4905-READ-PREV-RECORD.
 21200
 21201     IF DISPLAY-HOLD-RECORDS AND
 21202        NOT PB-RECORD-ON-HOLD
 21203          GO TO 4905-READ-PREV-RECORD.
 21204
 21205     IF PB-ISSUE
 21206        IF DISPLAY-CHK-REQ-RECORDS
 21207           GO TO 4905-READ-PREV-RECORD.
 21208
 21209     IF PB-ISSUE
 21210        IF ISSUE-WITH-WARNING
 21211           IF PB-WARNING-ERRORS
 21212              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21213                  GO TO 4505-READ-PREV-RECORD
 21214              ELSE
 21215                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21216                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21217                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21218                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21219                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21220                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21221                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21222                 GO TO 7000-DISPLAY-ISSUES
 21223           ELSE
 21224              GO TO 4905-READ-PREV-RECORD.
 21225
 21226     IF PB-ISSUE
 21227        IF (ISSUES-IN-ERROR AND
 21228            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21229            ALL-ISSUES
 21230            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21231            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21232            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21233            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21234            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21235            MOVE PB-SV-STATE            TO PI-SV-STATE
 21236            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21237            GO TO 7000-DISPLAY-ISSUES
 21238        ELSE
 21239            GO TO 4905-READ-PREV-RECORD.
 21240
 21241     IF PB-CANCELLATION
 21242        IF DISPLAY-CHK-REQ-RECORDS
 21243           IF PB-C-REFUND-REQUESTED
 21244              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21245              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21246              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21247              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 389
* EL6311.cbl
 21248              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21249              MOVE PB-SV-STATE            TO PI-SV-STATE
 21250              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21251              GO TO 7100-DISPLAY-CANCELS
 21252           ELSE
 21253              GO TO 4905-READ-PREV-RECORD.
 21254
 21255     IF PB-CANCELLATION
 21256        IF CANCEL-WITH-WARNING
 21257           IF PB-WARNING-ERRORS
 21258              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21259                  GO TO 4505-READ-PREV-RECORD
 21260              ELSE
 21261                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21262                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21263                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21264                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21265                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21266                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21267                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21268                 GO TO 7100-DISPLAY-CANCELS
 21269           ELSE
 21270              GO TO 4905-READ-PREV-RECORD.
 21271
 21272     IF PB-CANCELLATION
 21273        IF (CANCEL-IN-ERROR  AND
 21274            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21275            ALL-CANCELS
 21276            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21277            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21278            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21279            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21280            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21281            MOVE PB-SV-STATE            TO PI-SV-STATE
 21282            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21283            GO TO 7100-DISPLAY-CANCELS.
 21284
 21285     GO TO 4905-READ-PREV-RECORD.
 21286
 21287 4950-END-RECORDS.
 21288     IF PI-MAP-NAME = EL631B
 21289        MOVE -1                  TO BMAINTL
 21290     ELSE
 21291        IF PI-MAP-NAME = EL631C
 21292           MOVE -1               TO CMAINTL
 21293        ELSE
 21294           MOVE -1               TO DPFENTRL.
 21295
 21296     MOVE ER-2255               TO EMI-ERROR.
 21297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21298     GO TO 8200-SEND-DATAONLY.
 21299
 21300 4970-NOT-FOUND.
 21301
 21302******************************************************************
 21303*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21304******************************************************************
 21305
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 390
* EL6311.cbl
 21306
 21307* EXEC CICS RESETBR
 21308*         DATASET    (FILE-ID-ERPNDB4)
 21309*         RIDFLD     (ERPNDB-CSR-KEY)
 21310*    END-EXEC.
 21311     MOVE 0
 21312       TO DFHEIV11
 21313*    MOVE '&4         G          &   #00018073' TO DFHEIV0
 21314     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21315     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21316     MOVE X'2020233030303138303733' TO DFHEIV0(25:11)
 21317     CALL 'kxdfhei1' USING DFHEIV0,
 21318           FILE-ID-ERPNDB4,
 21319           ERPNDB-CSR-KEY,
 21320           DFHEIV99,
 21321           DFHEIV11,
 21322           DFHEIV99
 21323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21324
 21325
 21326
 21327* EXEC CICS READNEXT
 21328*         DATASET    (FILE-ID-ERPNDB4)
 21329*         SET        (ADDRESS OF PENDING-BUSINESS)
 21330*         RIDFLD     (ERPNDB-CSR-KEY)
 21331*    END-EXEC.
 21332     MOVE 0
 21333       TO DFHEIV11
 21334*    MOVE '&.S                   )   #00018078' TO DFHEIV0
 21335     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21336     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21337     MOVE X'2020233030303138303738' TO DFHEIV0(25:11)
 21338     CALL 'kxdfhei1' USING DFHEIV0,
 21339           FILE-ID-ERPNDB4,
 21340           DFHEIV20,
 21341           DFHEIV99,
 21342           ERPNDB-CSR-KEY,
 21343           DFHEIV99,
 21344           DFHEIV11,
 21345           DFHEIV99,
 21346           DFHEIV99
 21347     SET ADDRESS OF PENDING-BUSINESS TO
 21348         DFHEIV20
 21349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21350
 21351
 21352
 21353* EXEC CICS READPREV
 21354*         DATASET    (FILE-ID-ERPNDB4)
 21355*         SET        (ADDRESS OF PENDING-BUSINESS)
 21356*         RIDFLD     (ERPNDB-CSR-KEY)
 21357*    END-EXEC.
 21358     MOVE 0
 21359       TO DFHEIV11
 21360*    MOVE '&0S                   )   #00018084' TO DFHEIV0
 21361     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21362     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21363     MOVE X'2020233030303138303834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 391
* EL6311.cbl
 21364     CALL 'kxdfhei1' USING DFHEIV0,
 21365           FILE-ID-ERPNDB4,
 21366           DFHEIV20,
 21367           DFHEIV99,
 21368           ERPNDB-CSR-KEY,
 21369           DFHEIV99,
 21370           DFHEIV11,
 21371           DFHEIV99,
 21372           DFHEIV99
 21373     SET ADDRESS OF PENDING-BUSINESS TO
 21374         DFHEIV20
 21375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21376
 21377
 21378 4980-READ-PREV-RECORD.
 21379
 21380* EXEC CICS READPREV
 21381*         DATASET    (FILE-ID-ERPNDB4)
 21382*         SET        (ADDRESS OF PENDING-BUSINESS)
 21383*         RIDFLD     (ERPNDB-CSR-KEY)
 21384*    END-EXEC.
 21385     MOVE 0
 21386       TO DFHEIV11
 21387*    MOVE '&0S                   )   #00018091' TO DFHEIV0
 21388     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21390     MOVE X'2020233030303138303931' TO DFHEIV0(25:11)
 21391     CALL 'kxdfhei1' USING DFHEIV0,
 21392           FILE-ID-ERPNDB4,
 21393           DFHEIV20,
 21394           DFHEIV99,
 21395           ERPNDB-CSR-KEY,
 21396           DFHEIV99,
 21397           DFHEIV11,
 21398           DFHEIV99,
 21399           DFHEIV99
 21400     SET ADDRESS OF PENDING-BUSINESS TO
 21401         DFHEIV20
 21402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21403
 21404
 21405     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21406
 21407     IF WS-BATCH-PREFIX = '#CL'
 21408        GO TO 4980-READ-PREV-RECORD.
 21409
 21410     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21411     GO TO 4905-READ-PREV-RECORD.
 21412
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 392
* EL6311.cbl
 21414
 21415
 21416******************************************************************
 21417*                                                                *
 21418*        B R O W S E   B A T C H   H E A D E R S                 *
 21419*                                                                *
 21420******************************************************************
 21421
 21422 5000-BROWSE-BATCH-HEADERS.
 21423
 21424     IF EIBTRNID NOT = TRANS-EXB1
 21425        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21426        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21427        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21428        GO TO 5010-READ-NEXT-RECORD.
 21429
 21430     IF EIBAID = DFHPF4
 21431        MOVE '0'                TO PI-EDIT-SW
 21432        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21433        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21434        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21435        GO TO 5010-READ-NEXT-RECORD.
 21436
 21437     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21438     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21439     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21440
 21441
 21442* EXEC CICS HANDLE CONDITION
 21443*         ENDFILE  (5050-NOT-FOUND)
 21444*    END-EXEC.
 21445*    MOVE '"$''                   ! R #00018133' TO DFHEIV0
 21446     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21448     MOVE X'5220233030303138313333' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0
 21450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21451
 21452
 21453 5010-READ-NEXT-RECORD.
 21454
 21455* EXEC CICS HANDLE CONDITION
 21456*         NOTFND    (5050-NOT-FOUND)
 21457*    END-EXEC.
 21458*    MOVE '"$I                   ! S #00018138' TO DFHEIV0
 21459     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21461     MOVE X'5320233030303138313338' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0
 21463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21464
 21465
 21466
 21467* EXEC CICS READ
 21468*         DATASET   (FILE-ID-ERPNDB)
 21469*         SET       (ADDRESS OF PENDING-BUSINESS)
 21470*         RIDFLD    (ERPNDB-KEY)
 21471*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 393
* EL6311.cbl
 21472*    END-EXEC.
 21473*    MOVE '&"S        G          (   #00018142' TO DFHEIV0
 21474     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21476     MOVE X'2020233030303138313432' TO DFHEIV0(25:11)
 21477     CALL 'kxdfhei1' USING DFHEIV0,
 21478           FILE-ID-ERPNDB,
 21479           DFHEIV20,
 21480           DFHEIV99,
 21481           ERPNDB-KEY,
 21482           DFHEIV99,
 21483           DFHEIV99,
 21484           DFHEIV99
 21485     SET ADDRESS OF PENDING-BUSINESS TO
 21486         DFHEIV20
 21487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21488
 21489
 21490     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21491         GO TO 5050-NOT-FOUND.
 21492
 21493     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21494
 21495     IF WS-BATCH-PREFIX = '#CL'
 21496         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21497         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21498         GO TO 5010-READ-NEXT-RECORD.
 21499
 21500     IF NOT PB-BATCH-TRAILER
 21501         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21502         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21503         GO TO 5010-READ-NEXT-RECORD.
 21504
 21505     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21506         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21507             NEXT SENTENCE
 21508         ELSE
 21509             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21510             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21511             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21512             GO TO 5010-READ-NEXT-RECORD.
 21513
 21514     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21515         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21516             NEXT SENTENCE
 21517        ELSE
 21518             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21519             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21520             GO TO 5010-READ-NEXT-RECORD.
 21521
 21522     IF EIBAID = DFHPF4
 21523        MOVE '0'                TO PI-EDIT-SW
 21524        GO TO 7200-DISPLAY-BATCHES.
 21525
 21526     IF PI-CSR-BROWSE
 21527        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21528           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21529           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 394
* EL6311.cbl
 21530           GO TO 5010-READ-NEXT-RECORD.
 21531
 21532     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21533       IF PI-PB-CARRIER    = SPACES AND
 21534          PI-PB-GROUPING   = SPACES AND
 21535          PI-PB-STATE      = SPACES AND
 21536          PI-PB-ACCOUNT    = SPACES
 21537            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21538            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21539            GO TO 7200-DISPLAY-BATCHES
 21540         ELSE
 21541           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21542              PI-PB-GROUPING   = PB-GROUPING AND
 21543              PI-PB-STATE      = PB-STATE    AND
 21544              PI-PB-ACCOUNT    = PB-ACCOUNT
 21545              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21546              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21547              GO TO 7200-DISPLAY-BATCHES.
 21548
 21549     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21550     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21551
 21552
 21553* EXEC CICS HANDLE CONDITION
 21554*         NOTFND    (5050-NOT-FOUND)
 21555*    END-EXEC.
 21556*    MOVE '"$I                   ! T #00018211' TO DFHEIV0
 21557     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21559     MOVE X'5420233030303138323131' TO DFHEIV0(25:11)
 21560     CALL 'kxdfhei1' USING DFHEIV0
 21561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21562
 21563
 21564
 21565* EXEC CICS READ
 21566*         DATASET   (FILE-ID-ERPNDB)
 21567*         SET       (ADDRESS OF PENDING-BUSINESS)
 21568*         RIDFLD    (ERPNDB-KEY)
 21569*         GTEQ
 21570*    END-EXEC.
 21571*    MOVE '&"S        G          (   #00018215' TO DFHEIV0
 21572     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21574     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 21575     CALL 'kxdfhei1' USING DFHEIV0,
 21576           FILE-ID-ERPNDB,
 21577           DFHEIV20,
 21578           DFHEIV99,
 21579           ERPNDB-KEY,
 21580           DFHEIV99,
 21581           DFHEIV99,
 21582           DFHEIV99
 21583     SET ADDRESS OF PENDING-BUSINESS TO
 21584         DFHEIV20
 21585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21586
 21587
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 395
* EL6311.cbl
 21588     GO TO 5010-READ-NEXT-RECORD.
 21589
 21590 5050-NOT-FOUND.
 21591
 21592******************************************************************
 21593*                                                                *
 21594*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21595*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21596*         PROGRAM.                                               *
 21597*                                                                *
 21598******************************************************************
 21599
 21600     IF EIBTRNID NOT = TRANS-EXB1
 21601        IF PENDING-BUS-RECS-FOUND
 21602            NEXT SENTENCE
 21603          ELSE
 21604            MOVE '9'            TO PI-BROWSE-SW
 21605            GO TO 9400-CLEAR.
 21606
 21607     MOVE ER-2256                TO EMI-ERROR.
 21608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21609
 21610     IF PI-MAP-NAME = SPACES
 21611        MOVE EL631D              TO PI-MAP-NAME
 21612        MOVE -1                  TO DPFENTRL
 21613        GO TO 8100-SEND-INITIAL-MAP.
 21614
 21615     IF PI-MAP-NAME = EL631B
 21616        MOVE -1                  TO BMAINTL
 21617     ELSE
 21618        IF PI-MAP-NAME = EL631C
 21619           MOVE -1               TO CMAINTL
 21620        ELSE
 21621           MOVE -1               TO DPFENTRL
 21622           GO TO 8200-SEND-DATAONLY.
 21623
 21624     GO TO 8100-SEND-INITIAL-MAP.
 21625
 21626     .
 21627 5100-PROCESS-POL-RESC.
 21628     MOVE ZEROS                  TO CG-LF-BENCD
 21629                                    CG-AH-BENCD
 21630                                    CG-LF-CAN-AMT
 21631                                    CG-AH-CAN-AMT
 21632     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21633                                    CG-AH-CAN-DT
 21634     MOVE SPACES                 TO CG-BATCH-NO
 21635     MOVE '4'                    TO CG-OPTION-CODE
 21636     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21637     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21638     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21639     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21640     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21641     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21642     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21643     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21644     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21645     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 396
* EL6311.cbl
 21646     MOVE PI-PREV-ALT-KEY (1:33)
 21647                                 TO CG-CERT-KEY
 21648     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21649     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21650                                    CG-AH-CAN-AMT
 21651     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21652                                    CG-AH-CAN-DT
 21653     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21654     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21655      display 'about to cancel ' cg-cert-key
 21656
 21657* EXEC CICS LINK
 21658*        PROGRAM  ('ELCANC')
 21659*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21660*    END-EXEC
 21661     MOVE LENGTH OF
 21662      CANCEL-GEN-PASS-AREA
 21663       TO DFHEIV11
 21664     MOVE 'ELCANC' TO DFHEIV1
 21665*    MOVE '."C                   (   #00018290' TO DFHEIV0
 21666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21668     MOVE X'2020233030303138323930' TO DFHEIV0(25:11)
 21669     CALL 'kxdfhei1' USING DFHEIV0,
 21670           DFHEIV1,
 21671           CANCEL-GEN-PASS-AREA,
 21672           DFHEIV11,
 21673           DFHEIV99,
 21674           DFHEIV99,
 21675           DFHEIV99,
 21676           DFHEIV99
 21677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21678     IF CG-SUCCESS
 21679        CONTINUE
 21680     ELSE
 21681        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21682        MOVE '3'                 TO EMI-SWITCH1
 21683        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21684        EVALUATE TRUE
 21685           WHEN CG-DATE-ERROR
 21686             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21687           WHEN CG-CERT-NOT-FOUND
 21688             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21689           WHEN CG-AMOUNT-ERROR
 21690             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21691           WHEN CG-OPTION-ERROR
 21692             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21693           WHEN CG-PREV-CAN
 21694             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21695           WHEN CG-INVALID-DATA
 21696             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21697           WHEN CG-NO-ACCT-MSTR
 21698             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21699           WHEN CG-SFX-A-EXIST
 21700             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21701           WHEN CG-MISC-ERROR
 21702             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21703           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 397
* EL6311.cbl
 21704             MOVE ' ERROR - ELCANC - RETURN '
 21705                                 TO EMI-ERROR-TEXT (1) (12:25)
 21706        END-EVALUATE
 21707        GO TO 8200-SEND-DATAONLY
 21708     END-IF
 21709
 21710* EXEC CICS GETMAIN
 21711*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21712*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21713*        INITIMG (GETMAIN-SPACE)
 21714*    END-EXEC
 21715*    MOVE ',"IL                  $   #00018325' TO DFHEIV0
 21716     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21717     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21718     MOVE X'2020233030303138333235' TO DFHEIV0(25:11)
 21719     CALL 'kxdfhei1' USING DFHEIV0,
 21720           DFHEIV20,
 21721           ELCRTT-RECORD-LENGTH,
 21722           GETMAIN-SPACE
 21723     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21724         DFHEIV20
 21725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21726
 21727     move ' '                    to ws-elcrtt-update-sw
 21728     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21729     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21730
 21731
 21732* EXEC CICS READ
 21733*        UPDATE
 21734*        DATASET  (CRTT-ID)
 21735*        RIDFLD   (ELCRTT-KEY)
 21736*        INTO     (CERTIFICATE-TRAILERS)
 21737*        resp     (ws-response)
 21738*    END-EXEC
 21739     MOVE LENGTH OF
 21740      CERTIFICATE-TRAILERS
 21741       TO DFHEIV11
 21742*    MOVE '&"IL       EU         (  N#00018335' TO DFHEIV0
 21743     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21744     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21745     MOVE X'204E233030303138333335' TO DFHEIV0(25:11)
 21746     CALL 'kxdfhei1' USING DFHEIV0,
 21747           CRTT-ID,
 21748           CERTIFICATE-TRAILERS,
 21749           DFHEIV11,
 21750           ELCRTT-KEY,
 21751           DFHEIV99,
 21752           DFHEIV99,
 21753           DFHEIV99
 21754     MOVE EIBRESP  TO ws-response
 21755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21756
 21757     if resp-normal
 21758        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21759                  'E' or 'F' or 'G'
 21760           move 'J'              to cs-claim-verification-status
 21761           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 398
* EL6311.cbl
 21762        end-if
 21763        if update-elcrtt
 21764
 21765* EXEC CICS REWRITE
 21766*             DATASET    (crtt-ID)
 21767*             FROM       (CERTIFICATE-TRAILERS)
 21768*          END-EXEC
 21769     MOVE LENGTH OF
 21770      CERTIFICATE-TRAILERS
 21771       TO DFHEIV11
 21772*    MOVE '&& L                  %   #00018350' TO DFHEIV0
 21773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21775     MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
 21776     CALL 'kxdfhei1' USING DFHEIV0,
 21777           crtt-ID,
 21778           CERTIFICATE-TRAILERS,
 21779           DFHEIV11,
 21780           DFHEIV99
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21782        else
 21783
 21784* exec cics unlock
 21785*             dataset    (crtt-ID)
 21786*          end-exec
 21787*    MOVE '&*                    #   #00018355' TO DFHEIV0
 21788     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21789     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21790     MOVE X'2020233030303138333535' TO DFHEIV0(25:11)
 21791     CALL 'kxdfhei1' USING DFHEIV0,
 21792           crtt-ID,
 21793           DFHEIV99
 21794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21795        end-if
 21796     end-if
 21797     .
 21798 5100-EXIT.
 21799     EXIT.
 21800
 21801******************************************************************
 21802*                                                                *
 21803*        B R O W S E   B A T C H   B A C K W A R D S             *
 21804*                                                                *
 21805******************************************************************
 21806
 21807 5500-BROWSE-BATCH-BACKWARD.
 21808
 21809* EXEC CICS HANDLE CONDITION
 21810*         NOTFND   (5550-END-RECORDS)
 21811*         ENDFILE  (5550-END-RECORDS)
 21812*    END-EXEC.
 21813*    MOVE '"$I''                  ! U #00018371' TO DFHEIV0
 21814     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21816     MOVE X'5520233030303138333731' TO DFHEIV0(25:11)
 21817     CALL 'kxdfhei1' USING DFHEIV0
 21818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21819
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 399
* EL6311.cbl
 21820
 21821 5505-START-BROWSE.
 21822     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21823     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21824     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21825
 21826
 21827* EXEC CICS STARTBR
 21828*         DATASET   (FILE-ID-ERPNDB)
 21829*         RIDFLD    (ERPNDB-ALT-KEY)
 21830*    END-EXEC.
 21831     MOVE 0
 21832       TO DFHEIV11
 21833*    MOVE '&,         G          &   #00018381' TO DFHEIV0
 21834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21836     MOVE X'2020233030303138333831' TO DFHEIV0(25:11)
 21837     CALL 'kxdfhei1' USING DFHEIV0,
 21838           FILE-ID-ERPNDB,
 21839           ERPNDB-ALT-KEY,
 21840           DFHEIV99,
 21841           DFHEIV11,
 21842           DFHEIV99
 21843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21844
 21845
 21846     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21847
 21848
 21849* EXEC CICS READNEXT
 21850*         DATASET    (FILE-ID-ERPNDB)
 21851*         SET        (ADDRESS OF PENDING-BUSINESS)
 21852*         RIDFLD     (ERPNDB-KEY)
 21853*    END-EXEC.
 21854     MOVE 0
 21855       TO DFHEIV11
 21856*    MOVE '&.S                   )   #00018388' TO DFHEIV0
 21857     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21858     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21859     MOVE X'2020233030303138333838' TO DFHEIV0(25:11)
 21860     CALL 'kxdfhei1' USING DFHEIV0,
 21861           FILE-ID-ERPNDB,
 21862           DFHEIV20,
 21863           DFHEIV99,
 21864           ERPNDB-KEY,
 21865           DFHEIV99,
 21866           DFHEIV11,
 21867           DFHEIV99,
 21868           DFHEIV99
 21869     SET ADDRESS OF PENDING-BUSINESS TO
 21870         DFHEIV20
 21871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21872
 21873
 21874
 21875* EXEC CICS READPREV
 21876*         DATASET    (FILE-ID-ERPNDB)
 21877*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 400
* EL6311.cbl
 21878*         RIDFLD     (ERPNDB-KEY)
 21879*    END-EXEC.
 21880     MOVE 0
 21881       TO DFHEIV11
 21882*    MOVE '&0S                   )   #00018394' TO DFHEIV0
 21883     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21884     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21885     MOVE X'2020233030303138333934' TO DFHEIV0(25:11)
 21886     CALL 'kxdfhei1' USING DFHEIV0,
 21887           FILE-ID-ERPNDB,
 21888           DFHEIV20,
 21889           DFHEIV99,
 21890           ERPNDB-KEY,
 21891           DFHEIV99,
 21892           DFHEIV11,
 21893           DFHEIV99,
 21894           DFHEIV99
 21895     SET ADDRESS OF PENDING-BUSINESS TO
 21896         DFHEIV20
 21897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21898
 21899
 21900
 21901* EXEC CICS READPREV
 21902*         DATASET    (FILE-ID-ERPNDB)
 21903*         SET        (ADDRESS OF PENDING-BUSINESS)
 21904*         RIDFLD     (ERPNDB-KEY)
 21905*    END-EXEC.
 21906     MOVE 0
 21907       TO DFHEIV11
 21908*    MOVE '&0S                   )   #00018400' TO DFHEIV0
 21909     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21911     MOVE X'2020233030303138343030' TO DFHEIV0(25:11)
 21912     CALL 'kxdfhei1' USING DFHEIV0,
 21913           FILE-ID-ERPNDB,
 21914           DFHEIV20,
 21915           DFHEIV99,
 21916           ERPNDB-KEY,
 21917           DFHEIV99,
 21918           DFHEIV11,
 21919           DFHEIV99,
 21920           DFHEIV99
 21921     SET ADDRESS OF PENDING-BUSINESS TO
 21922         DFHEIV20
 21923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21924
 21925
 21926     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21927        GO TO 5550-END-RECORDS.
 21928
 21929     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21930
 21931     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21932
 21933     IF  WS-BATCH-PREFIX = '#CL'
 21934             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21935
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 401
* EL6311.cbl
 21936* EXEC CICS ENDBR
 21937*                 DATASET  (FILE-ID-ERPNDB)
 21938*            END-EXEC
 21939     MOVE 0
 21940       TO DFHEIV11
 21941*    MOVE '&2                    $   #00018415' TO DFHEIV0
 21942     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21944     MOVE X'2020233030303138343135' TO DFHEIV0(25:11)
 21945     CALL 'kxdfhei1' USING DFHEIV0,
 21946           FILE-ID-ERPNDB,
 21947           DFHEIV11,
 21948           DFHEIV99
 21949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21950         GO TO 5505-START-BROWSE.
 21951
 21952     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21953         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21954             NEXT SENTENCE
 21955         ELSE
 21956             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21957
 21958* EXEC CICS ENDBR
 21959*                 DATASET  (FILE-ID-ERPNDB)
 21960*            END-EXEC
 21961     MOVE 0
 21962       TO DFHEIV11
 21963*    MOVE '&2                    $   #00018425' TO DFHEIV0
 21964     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21965     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21966     MOVE X'2020233030303138343235' TO DFHEIV0(25:11)
 21967     CALL 'kxdfhei1' USING DFHEIV0,
 21968           FILE-ID-ERPNDB,
 21969           DFHEIV11,
 21970           DFHEIV99
 21971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21972             GO TO 5505-START-BROWSE.
 21973
 21974
 21975     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21976         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21977             NEXT SENTENCE
 21978        ELSE
 21979             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21980
 21981* EXEC CICS ENDBR
 21982*                 DATASET  (FILE-ID-ERPNDB)
 21983*            END-EXEC
 21984     MOVE 0
 21985       TO DFHEIV11
 21986*    MOVE '&2                    $   #00018436' TO DFHEIV0
 21987     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21988     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21989     MOVE X'2020233030303138343336' TO DFHEIV0(25:11)
 21990     CALL 'kxdfhei1' USING DFHEIV0,
 21991           FILE-ID-ERPNDB,
 21992           DFHEIV11,
 21993           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 402
* EL6311.cbl
 21994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21995             GO TO 5505-START-BROWSE.
 21996
 21997     IF NOT PB-BATCH-TRAILER
 21998        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21999
 22000* EXEC CICS ENDBR
 22001*            DATASET  (FILE-ID-ERPNDB)
 22002*       END-EXEC
 22003     MOVE 0
 22004       TO DFHEIV11
 22005*    MOVE '&2                    $   #00018443' TO DFHEIV0
 22006     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22007     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22008     MOVE X'2020233030303138343433' TO DFHEIV0(25:11)
 22009     CALL 'kxdfhei1' USING DFHEIV0,
 22010           FILE-ID-ERPNDB,
 22011           DFHEIV11,
 22012           DFHEIV99
 22013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22014        GO TO 5505-START-BROWSE.
 22015
 22016     IF PI-CSR-BROWSE
 22017        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 22018           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 22019
 22020* EXEC CICS ENDBR
 22021*               DATASET  (FILE-ID-ERPNDB)
 22022*          END-EXEC
 22023     MOVE 0
 22024       TO DFHEIV11
 22025*    MOVE '&2                    $   #00018451' TO DFHEIV0
 22026     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22028     MOVE X'2020233030303138343531' TO DFHEIV0(25:11)
 22029     CALL 'kxdfhei1' USING DFHEIV0,
 22030           FILE-ID-ERPNDB,
 22031           DFHEIV11,
 22032           DFHEIV99
 22033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22034           GO TO 5505-START-BROWSE.
 22035
 22036     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 22037        IF PI-PB-CARRIER    = SPACES AND
 22038           PI-PB-GROUPING   = SPACES AND
 22039           PI-PB-STATE      = SPACES AND
 22040           PI-PB-ACCOUNT    = SPACES
 22041             GO TO 7200-DISPLAY-BATCHES
 22042          ELSE
 22043            IF PI-PB-CARRIER    = PB-CARRIER  AND
 22044               PI-PB-GROUPING   = PB-GROUPING AND
 22045               PI-PB-STATE      = PB-STATE    AND
 22046               PI-PB-ACCOUNT    = PB-ACCOUNT
 22047                 GO TO 7200-DISPLAY-BATCHES.
 22048
 22049     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 22050
 22051
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 403
* EL6311.cbl
 22052* EXEC CICS ENDBR
 22053*         DATASET  (FILE-ID-ERPNDB)
 22054*    END-EXEC.
 22055     MOVE 0
 22056       TO DFHEIV11
 22057*    MOVE '&2                    $   #00018471' TO DFHEIV0
 22058     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22060     MOVE X'2020233030303138343731' TO DFHEIV0(25:11)
 22061     CALL 'kxdfhei1' USING DFHEIV0,
 22062           FILE-ID-ERPNDB,
 22063           DFHEIV11,
 22064           DFHEIV99
 22065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22066
 22067
 22068     GO TO 5505-START-BROWSE.
 22069
 22070 5550-END-RECORDS.
 22071     MOVE ER-2257                TO EMI-ERROR.
 22072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22073     MOVE -1                     TO DPFENTRL.
 22074
 22075     GO TO 8200-SEND-DATAONLY.
 22076
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 404
* EL6311.cbl
 22078
 22079******************************************************************
 22080*                                                                *
 22081*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 22082*                                                                *
 22083******************************************************************
 22084
 22085 6000-CREATE-TEMP-STORAGE.
 22086
 22087
 22088* EXEC CICS HANDLE CONDITION
 22089*        QIDERR  (6050-QID-ERROR)
 22090*    END-EXEC.
 22091*    MOVE '"$N                   ! V #00018494' TO DFHEIV0
 22092     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22094     MOVE X'5620233030303138343934' TO DFHEIV0(25:11)
 22095     CALL 'kxdfhei1' USING DFHEIV0
 22096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22097
 22098
 22099
 22100* EXEC CICS WRITEQ TS
 22101*        QUEUE    (QID)
 22102*        FROM     (PROGRAM-INTERFACE-BLOCK)
 22103*        LENGTH   (WS-COMM-LENGTH)
 22104*        ITEM     (W-ONE)
 22105*    END-EXEC.
 22106*    MOVE '*" I   L              ''   #00018498' TO DFHEIV0
 22107     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 22108     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22109     MOVE X'2020233030303138343938' TO DFHEIV0(25:11)
 22110     CALL 'kxdfhei1' USING DFHEIV0,
 22111           QID,
 22112           PROGRAM-INTERFACE-BLOCK,
 22113           WS-COMM-LENGTH,
 22114           W-ONE,
 22115           DFHEIV99,
 22116           DFHEIV99
 22117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22118
 22119
 22120 6000-EXIT.
 22121      EXIT.
 22122
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 405
* EL6311.cbl
 22124
 22125******************************************************************
 22126*                                                                *
 22127*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 22128*                                                                *
 22129******************************************************************
 22130
 22131 6050-RECOVER-TEMP-STORAGE.
 22132     IF PGM-NAME = XCTL-EL6312
 22133        GO TO 6050-EXIT.
 22134
 22135     IF PGM-NAME = XCTL-EL6313
 22136        GO TO 6050-EXIT.
 22137
 22138     IF PGM-NAME = XCTL-EL6315
 22139         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 22140     END-IF
 22141
 22142     IF PGM-NAME = XCTL-EL6316
 22143         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 22144     END-IF
 22145
 22146
 22147* EXEC CICS HANDLE CONDITION
 22148*        QIDERR  (6050-QID-ERROR)
 22149*    END-EXEC.
 22150*    MOVE '"$N                   ! W #00018531' TO DFHEIV0
 22151     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22153     MOVE X'5720233030303138353331' TO DFHEIV0(25:11)
 22154     CALL 'kxdfhei1' USING DFHEIV0
 22155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22156
 22157
 22158
 22159* EXEC CICS READQ TS
 22160*         QUEUE   (QID)
 22161*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22162*         LENGTH  (WS-COMM-LENGTH)
 22163*         ITEM    (W-ONE)
 22164*     END-EXEC.
 22165*    MOVE '*$II   L              ''   #00018535' TO DFHEIV0
 22166     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22168     MOVE X'2020233030303138353335' TO DFHEIV0(25:11)
 22169     CALL 'kxdfhei1' USING DFHEIV0,
 22170           QID,
 22171           PROGRAM-INTERFACE-BLOCK,
 22172           WS-COMM-LENGTH,
 22173           W-ONE,
 22174           DFHEIV99,
 22175           DFHEIV99
 22176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22177
 22178
 22179 6050-DELETE-TEMP-STORAGE.
 22180
 22181
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 406
* EL6311.cbl
 22182* EXEC CICS DELETEQ TS
 22183*        QUEUE   (QID)
 22184*    END-EXEC.
 22185*    MOVE '*&                    #   #00018544' TO DFHEIV0
 22186     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22187     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22188     MOVE X'2020233030303138353434' TO DFHEIV0(25:11)
 22189     CALL 'kxdfhei1' USING DFHEIV0,
 22190           QID,
 22191           DFHEIV99
 22192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22193
 22194
 22195     GO TO 6050-EXIT.
 22196
 22197 6050-QID-ERROR.
 22198     MOVE ER-0033                TO EMI-ERROR
 22199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22200
 22201 6050-EXIT.
 22202      EXIT.
 22203
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 407
* EL6311.cbl
 22205
 22206******************************************************************
 22207*                                                                *
 22208*            T E R M   C O N V E R S I O N                       *
 22209*                                                                *
 22210******************************************************************
 22211
 22212 6100-TERM-CONVERSION.
 22213
 22214     IF PI-BPMTS = ZERO
 22215         GO TO 6199-EXIT.
 22216
 22217     IF PI-BMODE = ' ' OR 'M'
 22218         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22219         GO TO 6105-ROUND-TERM.
 22220
 22221     IF PI-BMODE = 'S'
 22222         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22223         GO TO 6105-ROUND-TERM.
 22224
 22225     IF PI-BMODE = 'W'
 22226         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22227         GO TO 6105-ROUND-TERM.
 22228
 22229     IF PI-BMODE = 'B'
 22230         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22231         GO TO 6105-ROUND-TERM.
 22232
 22233     IF PI-BMODE = 'T'
 22234         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22235
 22236 6105-ROUND-TERM.
 22237
 22238     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22239         ADD +1                  TO WS-CALC-TERM-WHOLE
 22240         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22241
 22242     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22243         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22244
 22245     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22246         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22247                                      WS-BTERM    (WS-SUB1)
 22248         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22249
 22250     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22251         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22252             MOVE -1               TO BMODEL
 22253             MOVE ER-2593          TO EMI-ERROR
 22254             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22255             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22256
 22257 6124-CHECK-BENEFIT.
 22258
 22259     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22260        GO TO 6126-COMPUTE-BENEFIT.
 22261
 22262     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 408
* EL6311.cbl
 22263
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 409
* EL6311.cbl
 22265******************************************************************
 22266**         COMPUTE TERM AND BENEFIT
 22267******************************************************************
 22268 6125-COMPUTE-TERM-BENEFIT.
 22269
 22270     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22271        PI-BPMTAMT = ZERO
 22272         GO TO 6199-EXIT.
 22273
 22274     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22275                                     WS-BTERM  (WS-SUB1).
 22276     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22277
 22278 6126-COMPUTE-BENEFIT.
 22279
 22280     IF PI-BMODE = 'M' OR  ' '
 22281         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22282
 22283     IF PI-BMODE = 'W'
 22284         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22285
 22286     IF PI-BMODE = 'S'
 22287         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22288
 22289     IF PI-BMODE = 'B'
 22290         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22291
 22292     IF PI-BMODE = 'T'
 22293         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22294
 22295     IF WS-SUB1 = +1
 22296        COMPUTE WS-BBEN (WS-SUB1) =
 22297                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22298
 22299     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22300     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22301     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22302
 22303 6199-EXIT.
 22304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 410
* EL6311.cbl
 22306
 22307******************************************************************
 22308*                                                                *
 22309*             D I S P L A Y   I S S U E S                        *
 22310*                                                                *
 22311******************************************************************
 22312
 22313 6200-CREATE-VADS.
 22314     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22315     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22316     MOVE SPACES                 TO WS-PASS-VADS-REC
 22317
 22318* EXEC CICS GETMAIN
 22319*       SET      (ADDRESS OF PENDING-BUSINESS)
 22320*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22321*       INITIMG  (GETMAIN-SPACE)
 22322*       RESP     (WS-RESPONSE)
 22323*    END-EXEC
 22324*    MOVE ',"IL                  $  N#00018670' TO DFHEIV0
 22325     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22327     MOVE X'204E233030303138363730' TO DFHEIV0(25:11)
 22328     CALL 'kxdfhei1' USING DFHEIV0,
 22329           DFHEIV20,
 22330           ERPNDB-RECORD-LENGTH,
 22331           GETMAIN-SPACE
 22332     SET ADDRESS OF PENDING-BUSINESS TO
 22333         DFHEIV20
 22334     MOVE EIBRESP  TO WS-RESPONSE
 22335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22336
 22337* EXEC CICS READ
 22338*       INTO    (PENDING-BUSINESS)
 22339*       DATASET (FILE-ID-ERPNDB)
 22340*       RIDFLD  (ERPNDB-KEY)
 22341*       RESP    (WS-RESPONSE)
 22342*    END-EXEC
 22343     MOVE LENGTH OF
 22344      PENDING-BUSINESS
 22345       TO DFHEIV11
 22346*    MOVE '&"IL       E          (  N#00018676' TO DFHEIV0
 22347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22349     MOVE X'204E233030303138363736' TO DFHEIV0(25:11)
 22350     CALL 'kxdfhei1' USING DFHEIV0,
 22351           FILE-ID-ERPNDB,
 22352           PENDING-BUSINESS,
 22353           DFHEIV11,
 22354           ERPNDB-KEY,
 22355           DFHEIV99,
 22356           DFHEIV99,
 22357           DFHEIV99
 22358     MOVE EIBRESP  TO WS-RESPONSE
 22359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22360     IF RESP-NORMAL
 22361        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22362        IF (RESP-NORMAL)
 22363           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 411
* EL6311.cbl
 22364              AM-CONTROL-PRIMARY (1:20))
 22365           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22366        ELSE
 22367           MOVE 'ACCOUNT NOT FOUND'
 22368                                 TO VD-ACCOUNT-NAME
 22369        END-IF
 22370        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22371                                    TO M1
 22372        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22373        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22374           (A2 > M1)
 22375           OR (WS-WORK-FIELD (A2:1) = '*')
 22376           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22377           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22378        END-PERFORM
 22379        IF A2 > M1
 22380           CONTINUE
 22381        ELSE
 22382           MOVE WS-WORK-FIELD (1:A2 - 1)
 22383                                    TO VD-ACCOUNT-NAME
 22384        END-IF
 22385        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22386        MOVE PB-CARRIER          TO VD-CARRIER
 22387        MOVE PB-GROUPING         TO VD-GROUPING
 22388        MOVE PB-STATE            TO VD-STATE
 22389        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22390        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22391        MOVE PB-CERT-NO          TO VD-CERT-NO
 22392        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22393        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22394        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22395        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22396        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22397        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22398        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22399        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22400        MOVE PB-CSR-ID           TO VD-CSR-ID
 22401        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22402        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22403        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22404        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22405        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22406        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22407        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22408        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22409        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22410        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22411        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22412        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22413        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22414     END-IF
 22415     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22416
 22417
 22418* EXEC CICS GETMAIN
 22419*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22420*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22421*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 412
* EL6311.cbl
 22422*       RESP     (WS-RESPONSE)
 22423*    END-EXEC
 22424*    MOVE ',"IL                  $  N#00018739' TO DFHEIV0
 22425     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22427     MOVE X'204E233030303138373339' TO DFHEIV0(25:11)
 22428     CALL 'kxdfhei1' USING DFHEIV0,
 22429           DFHEIV20,
 22430           ERPNDM-RECORD-LENGTH,
 22431           GETMAIN-SPACE
 22432     SET ADDRESS OF PENDING-MAILING-DATA TO
 22433         DFHEIV20
 22434     MOVE EIBRESP  TO WS-RESPONSE
 22435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22436
 22437
 22438* EXEC CICS READ
 22439*       INTO    (PENDING-MAILING-DATA)
 22440*       DATASET (FILE-ID-ERPNDM)
 22441*       RIDFLD  (ERPNDM-KEY)
 22442*       RESP    (WS-RESPONSE)
 22443*    END-EXEC
 22444     MOVE LENGTH OF
 22445      PENDING-MAILING-DATA
 22446       TO DFHEIV11
 22447*    MOVE '&"IL       E          (  N#00018746' TO DFHEIV0
 22448     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22450     MOVE X'204E233030303138373436' TO DFHEIV0(25:11)
 22451     CALL 'kxdfhei1' USING DFHEIV0,
 22452           FILE-ID-ERPNDM,
 22453           PENDING-MAILING-DATA,
 22454           DFHEIV11,
 22455           ERPNDM-KEY,
 22456           DFHEIV99,
 22457           DFHEIV99,
 22458           DFHEIV99
 22459     MOVE EIBRESP  TO WS-RESPONSE
 22460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22461
 22462     IF RESP-NORMAL
 22463        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22464        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22465        MOVE PM-CITY              TO VD-INSURED-CITY
 22466        MOVE PM-STATE             TO VD-INSURED-STATE
 22467        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22468     END-IF
 22469
 22470     MOVE 'VAC1'                  TO VD-LETTER-ID
 22471     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22472     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22473     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22474     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22475     MOVE +0                      TO VD-ARCHIVE-NO
 22476     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22477     .
 22478 6200-EXIT.
 22479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 413
* EL6311.cbl
 22480 6210-READ-ERACCT.
 22481     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22482     MOVE LOW-VALUES             TO ERACCT-FILL
 22483
 22484* EXEC CICS READ
 22485*         DATASET   ('ERACCT')
 22486*         INTO      (ACCOUNT-MASTER)
 22487*         RIDFLD    (ERACCT-KEY)
 22488*         GTEQ
 22489*         RESP      (WS-RESPONSE)
 22490*    END-EXEC
 22491     MOVE LENGTH OF
 22492      ACCOUNT-MASTER
 22493       TO DFHEIV11
 22494     MOVE 'ERACCT' TO DFHEIV1
 22495*    MOVE '&"IL       G          (  N#00018774' TO DFHEIV0
 22496     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22498     MOVE X'204E233030303138373734' TO DFHEIV0(25:11)
 22499     CALL 'kxdfhei1' USING DFHEIV0,
 22500           DFHEIV1,
 22501           ACCOUNT-MASTER,
 22502           DFHEIV11,
 22503           ERACCT-KEY,
 22504           DFHEIV99,
 22505           DFHEIV99,
 22506           DFHEIV99
 22507     MOVE EIBRESP  TO WS-RESPONSE
 22508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22509     .
 22510 6210-EXIT.
 22511     EXIT.
 22512
 22513 6220-READ-ERMAIL.
 22514
 22515     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22516     MOVE ' '                    TO WS-ERMAIL-SW
 22517
 22518
 22519* EXEC CICS READ
 22520*       DATASET   (FILE-ID-ERMAIL)
 22521*       SET       (ADDRESS OF MAILING-DATA)
 22522*       RIDFLD    (ERMAIL-KEY)
 22523*       RESP      (WS-RESPONSE)
 22524*    END-EXEC
 22525*    MOVE '&"S        E          (  N#00018790' TO DFHEIV0
 22526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22528     MOVE X'204E233030303138373930' TO DFHEIV0(25:11)
 22529     CALL 'kxdfhei1' USING DFHEIV0,
 22530           FILE-ID-ERMAIL,
 22531           DFHEIV20,
 22532           DFHEIV99,
 22533           ERMAIL-KEY,
 22534           DFHEIV99,
 22535           DFHEIV99,
 22536           DFHEIV99
 22537     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 414
* EL6311.cbl
 22538         DFHEIV20
 22539     MOVE EIBRESP  TO WS-RESPONSE
 22540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22541
 22542     IF RESP-NORMAL
 22543        SET ERMAIL-FOUND TO TRUE
 22544     END-IF
 22545     .
 22546 6220-EXIT.
 22547     EXIT.
 22548
 22549 6400-CHECK-FOR-RES-REF-CLAIM.
 22550     display 'made it to 6400- for ' pi-cert-no
 22551     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22552
 22553     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22554                                    W-CL-COMP-CD.
 22555     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22556                                    W-CL-CERT-NO.
 22557     MOVE SPACES                 TO MSTR-CERT-SFX.
 22558
 22559
 22560* EXEC CICS HANDLE CONDITION
 22561*        NOTFND  (6400-CONTINUE)
 22562*        ENDFILE (6400-CONTINUE)
 22563*    END-EXEC.
 22564*    MOVE '"$I''                  ! X #00018814' TO DFHEIV0
 22565     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22567     MOVE X'5820233030303138383134' TO DFHEIV0(25:11)
 22568     CALL 'kxdfhei1' USING DFHEIV0
 22569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22570
 22571
 22572
 22573* EXEC CICS IGNORE CONDITION
 22574*        DUPKEY
 22575*    END-EXEC.
 22576*    MOVE '"*$                   !   #00018819' TO DFHEIV0
 22577     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22579     MOVE X'2020233030303138383139' TO DFHEIV0(25:11)
 22580     CALL 'kxdfhei1' USING DFHEIV0
 22581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22582
 22583
 22584
 22585* EXEC CICS STARTBR
 22586*        DATASET   (CLMS-ID)
 22587*        RIDFLD    (ELMSTR-KEY)
 22588*        GENERIC   EQUAL
 22589*        KEYLENGTH (ELMSTR-LENGTH)
 22590*    END-EXEC.
 22591     MOVE 0
 22592       TO DFHEIV11
 22593*    MOVE '&,   KG    E          &   #00018823' TO DFHEIV0
 22594     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 415
* EL6311.cbl
 22596     MOVE X'2020233030303138383233' TO DFHEIV0(25:11)
 22597     CALL 'kxdfhei1' USING DFHEIV0,
 22598           CLMS-ID,
 22599           ELMSTR-KEY,
 22600           ELMSTR-LENGTH,
 22601           DFHEIV11,
 22602           DFHEIV99
 22603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22604
 22605
 22606     display 'browse started'
 22607     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22608
 22609 6400-NEXT-CLAIM.
 22610
 22611
 22612* EXEC CICS READNEXT
 22613*        DATASET   (CLMS-ID)
 22614*        RIDFLD    (ELMSTR-KEY)
 22615*        SET       (ADDRESS OF CLAIM-MASTER)
 22616*    END-EXEC.
 22617     MOVE 0
 22618       TO DFHEIV11
 22619*    MOVE '&.S                   )   #00018835' TO DFHEIV0
 22620     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22621     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22622     MOVE X'2020233030303138383335' TO DFHEIV0(25:11)
 22623     CALL 'kxdfhei1' USING DFHEIV0,
 22624           CLMS-ID,
 22625           DFHEIV20,
 22626           DFHEIV99,
 22627           ELMSTR-KEY,
 22628           DFHEIV99,
 22629           DFHEIV11,
 22630           DFHEIV99,
 22631           DFHEIV99
 22632     SET ADDRESS OF CLAIM-MASTER TO
 22633         DFHEIV20
 22634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22635
 22636
 22637     display 'read claim for ' mstr-cert-no
 22638     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22639        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22640         GO TO 6400-CONTINUE
 22641     END-IF.
 22642
 22643     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22644        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22645        PI-STATE       NOT = CL-CERT-STATE     OR
 22646        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22647        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22648         GO TO 6400-NEXT-CLAIM
 22649     END-IF.
 22650
 22651     display 'found claim ' cl-claim-no
 22652        ' with denial type ' cl-denial-type
 22653     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 416
* EL6311.cbl
 22654         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22655         GO TO 6400-CONTINUE
 22656     END-IF.
 22657
 22658     GO TO 6400-NEXT-CLAIM.
 22659
 22660 6400-CONTINUE.
 22661
 22662     IF WS-BROWSE-STARTED-SW = 'Y'
 22663
 22664* EXEC CICS ENDBR
 22665*            DATASET   (CLMS-ID)
 22666*        END-EXEC
 22667     MOVE 0
 22668       TO DFHEIV11
 22669*    MOVE '&2                    $   #00018867' TO DFHEIV0
 22670     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22672     MOVE X'2020233030303138383637' TO DFHEIV0(25:11)
 22673     CALL 'kxdfhei1' USING DFHEIV0,
 22674           CLMS-ID,
 22675           DFHEIV11,
 22676           DFHEIV99
 22677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22678         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22679     END-IF.
 22680
 22681 6400-EXIT.
 22682     EXIT.
 22683
 22684 7000-DISPLAY-ISSUES.
 22685
 22686     IF PI-DISPLAY-ORIGINAL-BATCH
 22687        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22688        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22689     ELSE
 22690        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22691
 22692     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22693
 22694     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22695     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22696
 22697     MOVE LOW-VALUES                 TO EL631BI.
 22698     MOVE ZEROS                      TO PI-BPMTAMT
 22699                                        PI-BPMTS.
 22700     MOVE SPACE                      TO PI-BMODE
 22701                                        PI-BTYPE (1)
 22702                                        PI-BTYPE (2).
 22703     MOVE EL631B                     TO PI-MAP-NAME.
 22704     MOVE 'Y'                        TO PI-BROWSE-SW.
 22705     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22706                                        PI-HIGH-SEQ-NO.
 22707
 22708     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22709        MOVE AL-SABOF                TO BCHGTA
 22710        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22711        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 417
* EL6311.cbl
 22712     ELSE
 22713        MOVE AL-SADOF                TO BCHGTA
 22714                                        BCHGA
 22715        MOVE PB-CHG-COUNT            TO BCHGO.
 22716
 22717     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22718     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22719     MOVE WS-HR-MINS                 TO BMANTATO.
 22720
 22721     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22722        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22723        MOVE SPACE                   TO DC-OPTION-CODE
 22724        PERFORM 9700-DATE-LINK
 22725        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22726        MOVE 'INACTIVE'              TO BMOENDTO
 22727     ELSE
 22728        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22729        MOVE SPACE                   TO DC-OPTION-CODE
 22730        PERFORM 9700-DATE-LINK
 22731        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22732        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22733        MOVE SPACE                   TO DC-OPTION-CODE
 22734        PERFORM 9700-DATE-LINK
 22735        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22736
 22737*    MOVE PB-I-REFERENCE             TO BREFO.
 22738
 22739*    IF PI-COMPANY-ID EQUAL 'HER'
 22740*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22741*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22742*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22743*                MOVE WS-MEMBER-NO-1-8
 22744*                                TO  BMICRNOO.
 22745
 22746*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22747*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22748*            MOVE PB-I-MICROFILM-NO
 22749*                                TO  BMICRNOO.
 22750     IF PB-I-VIN NOT = SPACES
 22751        MOVE PB-I-VIN            TO BVINO
 22752     END-IF
 22753     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22754
 22755
 22756     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22757     MOVE PB-CERT-SFX                TO BSUFIXO.
 22758     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22759     MOVE SPACE                      TO DC-OPTION-CODE.
 22760     PERFORM 9700-DATE-LINK.
 22761     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22762
 22763     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22764     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22765     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22766     MOVE PB-I-INSURED-SEX           TO BSEXO
 22767
 22768     IF PB-I-AGE NOT = ZEROS
 22769         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 418
* EL6311.cbl
 22770
 22771     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22772                                 TO ELCERT-KEY
 22773     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22774     IF NOT CERT-TRL-REC-NOT-FOUND
 22775         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22776             MOVE 'AGE*'             TO BAGEDEFO
 22777         ELSE
 22778             MOVE 'AGE '             TO BAGEDEFO
 22779         END-IF
 22780     ELSE
 22781         MOVE 'AGE '             TO BAGEDEFO
 22782     END-IF
 22783
 22784     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22785         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22786         MOVE SPACE                  TO DC-OPTION-CODE
 22787         PERFORM 9700-DATE-LINK
 22788         IF NO-CONVERSION-ERROR
 22789            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22790
 22791     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22792         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22793         MOVE SPACE                  TO DC-OPTION-CODE
 22794         PERFORM 9700-DATE-LINK
 22795         IF NO-CONVERSION-ERROR
 22796            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22797
 22798     IF PB-I-EXTENTION-DAYS NUMERIC
 22799        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22800           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22801        ELSE
 22802           IF PB-I-TERM-IN-DAYS NUMERIC
 22803              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22804                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22805
 22806     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22807        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22808
 22809     MOVE PB-FORCE-CODE              TO BFORCEO.
 22810     MOVE PB-I-TERM-TYPE             TO BMODEO
 22811                                        PI-BMODE.
 22812
 22813     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22814        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22815
 22816     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22817         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22818                                        PI-BPMTS.
 22819
 22820     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22821         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22822           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22823                                        PI-BPMTAMT.
 22824
 22825     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22826     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22827     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 419
* EL6311.cbl
 22828     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22829     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22830     MOVE PB-I-SIG-SW                TO BSIGO.
 22831     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22832     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22833     MOVE PB-RECORD-BILL             TO BBILCDO.
 22834     MOVE PB-FORCE-CODE              TO BFORCEO.
 22835
 22836     IF (PB-I-LIVES NUMERIC)
 22837        AND (PB-I-LIVES > ZEROS)
 22838        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22839        IF (RESP-NORMAL)
 22840           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22841           CONTINUE
 22842        ELSE
 22843           MOVE PB-I-LIVES       TO BLIVESO
 22844        END-IF
 22845     END-IF
 22846
 22847     IF PB-I-NUM-BILLED NUMERIC AND
 22848        PB-I-NUM-BILLED GREATER THAN ZEROS
 22849        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22850*    ELSE
 22851*       MOVE ZEROS                   TO BBILLEDO.
 22852
 22853     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22854
 22855     IF PB-I-LOAN-APR NOT = +99.9999
 22856        MOVE PB-I-LOAN-APR           TO BAPRO.
 22857
 22858     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22859        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22860
 22861     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22862        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22863           MOVE AL-SANOF                TO BORIGHDA
 22864           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22865           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22866
 22867     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22868
 22869     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22870        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22871
 22872     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22873        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22874                                        PI-BTYPE (1).
 22875
 22876     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22877        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22878
 22879     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22880        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22881
 22882     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22883        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22884
 22885     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 420
* EL6311.cbl
 22886        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22887
 22888     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22889        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22890
 22891     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22892         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22893         MOVE SPACE                  TO DC-OPTION-CODE
 22894         PERFORM 9700-DATE-LINK
 22895         IF NO-CONVERSION-ERROR
 22896            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22897
 22898     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22899        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22900        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22901        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22902        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22903                 GIVING BDIFFO (1)
 22904     ELSE
 22905        MOVE SPACES                  TO BBEN-CD     (1)
 22906                                        BBEN-ABBR   (1).
 22907
 22908     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22909        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22910        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22911                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22912
 22913     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22914       IF PB-RECORD-ON-HOLD
 22915          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22916
 22917     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22918       IF PB-RECORD-RETURNED
 22919          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22920
 22921     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22922        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22923             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22924
 22925     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22926
 22927     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22928        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22929
 22930     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22931        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22932                                        PI-BTYPE (2).
 22933
 22934     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22935        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22936
 22937     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22938        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22939
 22940     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22941        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22942
 22943     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 421
* EL6311.cbl
 22944        MOVE ZEROS               TO PB-I-TOT-FEES
 22945     END-IF
 22946     IF PB-I-TOT-FEES > ZEROS
 22947        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22948
 22949     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22950         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22951         MOVE SPACE                  TO DC-OPTION-CODE
 22952         PERFORM 9700-DATE-LINK
 22953         IF NO-CONVERSION-ERROR
 22954            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22955
 22956     IF PB-I-TOT-FEES > ZEROS
 22957        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22958        SUBTRACT PB-I-TOT-FEES FROM
 22959                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22960
 22961     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22962        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22963        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22964        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22965        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22966                 GIVING BDIFFO (2)
 22967     ELSE
 22968        MOVE SPACES                  TO BBEN-CD     (2)
 22969                                        BBEN-ABBR   (2).
 22970
 22971     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22972       IF PB-RECORD-ON-HOLD
 22973          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22974
 22975     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22976       IF PB-RECORD-RETURNED
 22977          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22978
 22979     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22980        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22981             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22982
 22983     MOVE PB-CSR-ID                  TO BCSRO.
 22984
 22985     IF PI-COMPANY-ID  =  'DMD'
 22986        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22987            NEXT SENTENCE
 22988        ELSE
 22989            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22990               MOVE 'NEW CERT'       TO BNCERTLI
 22991               MOVE EC-NEW-CERT      TO BNCERTO.
 22992
 22993     IF PI-COMPANY-ID  =  'DMD'
 22994        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22995            NEXT SENTENCE
 22996        ELSE
 22997           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22998               MOVE 'NEW STATE'      TO BNSTATLI
 22999               MOVE EC-NEW-STATE     TO BNSTATO.
 23000
 23001 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 422
* EL6311.cbl
 23002     MOVE 'C'                        TO BMAINTI.
 23003     MOVE AL-UANON                   TO BMAINTA.
 23004
 23005     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23006        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23007
 23008     IF ARCHIVE-LETTER-RELEASED
 23009        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 23010     END-IF
 23011     IF PI-6315-FINALIZED = 'Y'   AND
 23012        PB-UNFORCED-ERRORS
 23013          MOVE -1                TO BFORCEL
 23014          MOVE  1                TO SET-CURSOR-SW
 23015     END-IF
 23016
 23017     IF NO-CURSOR-SET
 23018        MOVE -1                      TO BMAINTL.
 23019
 23020     GO TO 8100-SEND-INITIAL-MAP.
 23021
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 423
* EL6311.cbl
 23023
 23024 7050-UPDATE-PENDING.
 23025
 23026* EXEC CICS READ
 23027*        DATASET (FILE-ID-ERPNDB)
 23028*        INTO    (PENDING-BUSINESS)
 23029*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 23030*        UPDATE
 23031*    END-EXEC.
 23032     MOVE LENGTH OF
 23033      PENDING-BUSINESS
 23034       TO DFHEIV11
 23035*    MOVE '&"IL       EU         (   #00019217' TO DFHEIV0
 23036     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23038     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
 23039     CALL 'kxdfhei1' USING DFHEIV0,
 23040           FILE-ID-ERPNDB,
 23041           PENDING-BUSINESS,
 23042           DFHEIV11,
 23043           PI-PREV-CONTROL-PRIMARY,
 23044           DFHEIV99,
 23045           DFHEIV99,
 23046           DFHEIV99
 23047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23048
 23049
 23050     MOVE 'C' TO PB-I-LETTER-REQD
 23051     MOVE PB-I-LETTER-REQD       TO LETRREQO
 23052     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 23053     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 23054     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 23055     MOVE '5'                    TO DC-OPTION-CODE.
 23056     PERFORM 9700-DATE-LINK
 23057     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 23058
 23059
 23060* EXEC CICS REWRITE
 23061*        DATASET (FILE-ID-ERPNDB)
 23062*        FROM    (PENDING-BUSINESS)
 23063*    END-EXEC.
 23064     MOVE LENGTH OF
 23065      PENDING-BUSINESS
 23066       TO DFHEIV11
 23067*    MOVE '&& L                  %   #00019233' TO DFHEIV0
 23068     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23069     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23070     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 23071     CALL 'kxdfhei1' USING DFHEIV0,
 23072           FILE-ID-ERPNDB,
 23073           PENDING-BUSINESS,
 23074           DFHEIV11,
 23075           DFHEIV99
 23076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23077
 23078
 23079 7050-EXIT.
 23080      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 424
* EL6311.cbl
 23081
 23082******************************************************************
 23083*                                                                *
 23084*             D I S P L A Y   C A N C E L S                      *
 23085*                                                                *
 23086******************************************************************
 23087
 23088 7100-DISPLAY-CANCELS.
 23089     IF PI-DISPLAY-ORIGINAL-BATCH
 23090        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 23091        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 23092     ELSE
 23093        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 23094
 23095     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 23096
 23097     MOVE 'Y'                        TO WS-DISPLAY-SW.
 23098     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 23099
 23100     MOVE LOW-VALUES                 TO EL631CI.
 23101     MOVE EL631C                     TO PI-MAP-NAME.
 23102     MOVE 'Y'                        TO PI-BROWSE-SW.
 23103     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 23104                                        PI-HIGH-SEQ-NO.
 23105
 23106     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 23107        MOVE AL-SABOF                TO CCHGTA
 23108        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 23109        MOVE AL-SANON                TO CCHGA
 23110      ELSE
 23111        MOVE AL-SADOF                TO CCHGTA
 23112                                        CCHGA
 23113        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 23114
 23115*    MOVE PB-C-REFERENCE             TO CREFO.
 23116
 23117*    IF PB-C-MICROFILM-NO IS NUMERIC
 23118*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 23119*          MOVE PB-C-MICROFILM-NO
 23120*                                TO CMICRNOO
 23121*          MOVE AL-UNNON         TO CMICRNOA
 23122*       END-IF
 23123*    END-IF
 23124     IF PB-C-INT-ON-REFS NUMERIC
 23125        IF PB-C-INT-ON-REFS NOT = ZEROS
 23126           MOVE PB-C-INT-ON-REFS
 23127                                 TO CNHINTO
 23128           MOVE AL-SANOF         TO CNHINTA
 23129        END-IF
 23130     END-IF
 23131     MOVE PB-CERT-PRIME              TO CCERTNOO.
 23132     MOVE PB-CERT-SFX                TO CSUFIXO.
 23133     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 23134     MOVE SPACE                      TO DC-OPTION-CODE.
 23135     PERFORM 9700-DATE-LINK.
 23136     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 23137
 23138     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 425
* EL6311.cbl
 23139        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 23140        MOVE SPACE                   TO DC-OPTION-CODE
 23141        PERFORM 9700-DATE-LINK
 23142        IF NO-CONVERSION-ERROR
 23143           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 23144
 23145     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 23146        NEXT SENTENCE
 23147     ELSE
 23148        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 23149
 23150     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 23151        NEXT SENTENCE
 23152     ELSE
 23153        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 23154
 23155     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 23156        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 23157        MOVE SPACE                   TO DC-OPTION-CODE
 23158        PERFORM 9700-DATE-LINK
 23159        IF NO-CONVERSION-ERROR
 23160           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 23161
 23162     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23163         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 23164
 23165     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23166         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 23167
 23168     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 23169        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 23170        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 23171                 GIVING CDRFND1O.
 23172
 23173     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 23174        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 23175        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 23176                 GIVING CDRFND2O.
 23177
 23178     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23179       IF PB-RECORD-ON-HOLD
 23180          MOVE 'ON HOLD'             TO CBILIT1O.
 23181
 23182     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23183       IF PB-RECORD-RETURNED
 23184          MOVE 'RETURNED'            TO CBILIT1O.
 23185
 23186     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23187        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 23188             MOVE 'OVERRIDE'         TO CBILIT1O.
 23189
 23190     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23191       IF PB-RECORD-ON-HOLD
 23192          MOVE 'ON HOLD'             TO CBILIT2O.
 23193
 23194     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23195       IF PB-RECORD-RETURNED
 23196          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 426
* EL6311.cbl
 23197
 23198     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23199        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 23200             MOVE 'OVERRIDE'         TO CBILIT2O.
 23201
 23202     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 23203     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 23204     MOVE PB-FORCE-CODE              TO CFORCEO.
 23205     MOVE PB-RECORD-BILL             TO CBILCDO.
 23206     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 23207     MOVE SPACES                     TO CINITSO.
 23208     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 23209         MOVE PB-CI-FIRST-NAME       TO CINITSO
 23210     ELSE
 23211         MOVE PB-CI-INITIALS         TO CINITSO
 23212     END-IF.
 23213
 23214     IF PB-CI-CANCEL-FEE NUMERIC
 23215        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23216        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23217     ELSE
 23218        MOVE ZEROES                  TO W-CANCEL-FEE.
 23219
 23220     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23221
 23222     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23223        ADD PB-CI-LF-PREMIUM-AMT
 23224             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23225
 23226     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23227        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23228
 23229     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23230     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23231     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23232     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23233
 23234     IF PB-C-LIVES NUMERIC
 23235        MOVE PB-C-LIVES              TO CLIVESO.
 23236
 23237     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23238        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23239
 23240     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23241        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23242        MOVE SPACE                   TO DC-OPTION-CODE
 23243        PERFORM 9700-DATE-LINK
 23244        IF NO-CONVERSION-ERROR
 23245           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23246
 23247     IF  PB-C-REFUND-CREATED
 23248         MOVE 'YES'                  TO CRFNDSWO
 23249     ELSE
 23250         IF PB-C-REFUND-REQUESTED
 23251            MOVE 'REQ'               TO CRFNDSWO
 23252         ELSE
 23253            MOVE 'NO'                TO CRFNDSWO.
 23254
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 427
* EL6311.cbl
 23255     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23256     MOVE SPACE                      TO DC-OPTION-CODE.
 23257     PERFORM 9700-DATE-LINK.
 23258     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23259     MOVE PB-INPUT-BY                TO CENTBYO.
 23260
 23261     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23262        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23263        MOVE SPACE                   TO DC-OPTION-CODE
 23264        PERFORM 9700-DATE-LINK
 23265        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23266        MOVE 'INACTIVE'              TO CMOENDTO
 23267     ELSE
 23268        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23269        MOVE SPACE                   TO DC-OPTION-CODE
 23270        PERFORM 9700-DATE-LINK
 23271        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23272        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23273        MOVE SPACE                   TO DC-OPTION-CODE
 23274        PERFORM 9700-DATE-LINK
 23275        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23276
 23277     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23278
 23279     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23280     MOVE WS-HR-MINS                 TO CMANTATO.
 23281
 23282     EVALUATE PB-LF-REFUND-TYPE
 23283        WHEN '1'
 23284           MOVE 'RULE78'            TO CLFREFNO
 23285        WHEN '2'
 23286           MOVE 'PRORAT'            TO CLFREFNO
 23287        WHEN '3'
 23288           MOVE 'CALIF'             TO CLFREFNO
 23289        WHEN '4'
 23290           MOVE 'IRREG'             TO CLFREFNO
 23291        WHEN '5'
 23292           MOVE 'NETPAY'            TO CLFREFNO
 23293        WHEN '6'
 23294           MOVE 'ATCP'              TO CLFREFNO
 23295        WHEN '7'
 23296           MOVE 'UTAH'              TO CLFREFNO
 23297        WHEN '8'
 23298           MOVE 'MEAN'              TO CLFREFNO
 23299        WHEN '9'
 23300           MOVE 'SUM '              TO CLFREFNO
 23301        WHEN 'B'
 23302           MOVE 'BALN'              TO CLFREFNO
 23303     END-EVALUATE.
 23304
 23305     EVALUATE TRUE
 23306        WHEN PB-AH-REFUND-TYPE =  '1'
 23307           MOVE 'RULE78'            TO CAHREFNO
 23308        WHEN PB-AH-REFUND-TYPE =  '2'
 23309           MOVE 'PRORAT'            TO CAHREFNO
 23310        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23311           MOVE 'CALIF'             TO CAHREFNO
 23312        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 428
* EL6311.cbl
 23313           MOVE 'IRREG'             TO CAHREFNO
 23314        WHEN PB-AH-REFUND-TYPE =  '5'
 23315           MOVE 'NETPAY'            TO CAHREFNO
 23316        WHEN PB-AH-REFUND-TYPE =  '6'
 23317           MOVE 'ATCP'              TO CAHREFNO
 23318        WHEN PB-AH-REFUND-TYPE =  '7'
 23319           MOVE 'UTAH'              TO CAHREFNO
 23320        WHEN PB-AH-REFUND-TYPE =  '8'
 23321           MOVE 'MEAN'              TO CAHREFNO
 23322        WHEN PB-AH-REFUND-TYPE =  '9'
 23323           MOVE 'SUM '              TO CAHREFNO
 23324        WHEN PB-AH-REFUND-TYPE =  'B'
 23325           MOVE 'BALN'              TO CAHREFNO
 23326     END-EVALUATE.
 23327
 23328     MOVE PB-REIN-CD                 TO CREINCDO.
 23329
 23330     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23331        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23332        MOVE SPACE                   TO DC-OPTION-CODE
 23333        PERFORM 9700-DATE-LINK
 23334        IF NO-CONVERSION-ERROR
 23335           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23336
 23337     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23338        MOVE 999999                  TO WS-EXP-DT-EDIT
 23339        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23340        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23341     ELSE
 23342        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23343           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23344           MOVE SPACE                   TO DC-OPTION-CODE
 23345           PERFORM 9700-DATE-LINK
 23346           IF NO-CONVERSION-ERROR
 23347              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23348
 23349     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23350        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23351           MOVE AL-SANOF                TO CORIGHDA
 23352           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23353           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23354
 23355     MOVE PB-CSR-ID              TO CCSRO.
 23356
 23357     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23358     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23359     MOVE 'N'                    TO ACTSPCO
 23360     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23361     MOVE '2'                    TO ERACNT-REC-TYPE
 23362     MOVE +3                     TO ERACNT-SEQ-NO
 23363
 23364
 23365* EXEC CICS READ
 23366*         DATASET   ('ERACNT')
 23367*         INTO      (NOTE-FILE)
 23368*         RIDFLD    (ERACNT-KEY)
 23369*         RESP      (WS-RESPONSE)
 23370*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 429
* EL6311.cbl
 23371     MOVE LENGTH OF
 23372      NOTE-FILE
 23373       TO DFHEIV11
 23374     MOVE 'ERACNT' TO DFHEIV1
 23375*    MOVE '&"IL       E          (  N#00019523' TO DFHEIV0
 23376     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23378     MOVE X'204E233030303139353233' TO DFHEIV0(25:11)
 23379     CALL 'kxdfhei1' USING DFHEIV0,
 23380           DFHEIV1,
 23381           NOTE-FILE,
 23382           DFHEIV11,
 23383           ERACNT-KEY,
 23384           DFHEIV99,
 23385           DFHEIV99,
 23386           DFHEIV99
 23387     MOVE EIBRESP  TO WS-RESPONSE
 23388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23389
 23390     IF RESP-NORMAL
 23391        IF NT-account-special = 'Y'
 23392           MOVE 'Y'              TO actspcO
 23393           MOVE ER-1762          TO EMI-ERROR
 23394           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23395        END-IF
 23396     END-IF
 23397     MOVE 'C'                    TO CMAINTI.
 23398     MOVE AL-UANON               TO CMAINTA.
 23399
 23400     IF PI-6316-FINALIZED = 'Y'  AND
 23401        PB-UNFORCED-ERRORS
 23402          MOVE -1                TO CFORCEL
 23403          MOVE  1                TO SET-CURSOR-SW
 23404     END-IF
 23405
 23406     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23407        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23408
 23409     IF NO-CURSOR-SET
 23410        MOVE -1                  TO CMAINTL.
 23411
 23412     GO TO 8100-SEND-INITIAL-MAP.
 23413
 23414
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 430
* EL6311.cbl
 23416***************************************************************
 23417*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23418*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23419***************************************************************
 23420
 23421 7200-DISPLAY-BATCHES.
 23422     MOVE EL631D                 TO PI-MAP-NAME.
 23423     MOVE LOW-VALUES             TO EL631DI.
 23424
 23425     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23426
 23427
 23428* EXEC CICS HANDLE CONDITION
 23429*         NOTFND   (3690-NOT-FOUND)
 23430*    END-EXEC.
 23431*    MOVE '"$I                   ! Y #00019567' TO DFHEIV0
 23432     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23434     MOVE X'5920233030303139353637' TO DFHEIV0(25:11)
 23435     CALL 'kxdfhei1' USING DFHEIV0
 23436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23437
 23438
 23439     IF PI-DISPLAY-SCREEN
 23440        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23441     ELSE
 23442        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23443
 23444     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23445     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23446
 23447
 23448* EXEC CICS READ
 23449*         DATASET   (FILE-ID-ERPNDB)
 23450*         RIDFLD    (ERPNDB-KEY)
 23451*         SET       (ADDRESS OF PENDING-BUSINESS)
 23452*    END-EXEC.
 23453*    MOVE '&"S        E          (   #00019579' TO DFHEIV0
 23454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23456     MOVE X'2020233030303139353739' TO DFHEIV0(25:11)
 23457     CALL 'kxdfhei1' USING DFHEIV0,
 23458           FILE-ID-ERPNDB,
 23459           DFHEIV20,
 23460           DFHEIV99,
 23461           ERPNDB-KEY,
 23462           DFHEIV99,
 23463           DFHEIV99,
 23464           DFHEIV99
 23465     SET ADDRESS OF PENDING-BUSINESS TO
 23466         DFHEIV20
 23467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23468
 23469
 23470     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23471     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23472     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23473     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 431
* EL6311.cbl
 23474     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23475
 23476     MOVE EL631D                 TO PI-MAP-NAME.
 23477     MOVE LOW-VALUES             TO EL631DI.
 23478     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23479
 23480*    IF PI-AR-PROCESSING
 23481*       MOVE PB-REFERENCE        TO DREFO.
 23482
 23483     MOVE PB-CSR-ID              TO DCSRO.
 23484
 23485     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23486        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23487        MOVE SPACE               TO DC-OPTION-CODE
 23488        PERFORM 9700-DATE-LINK
 23489        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23490        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23491        MOVE 'INACTIVE'          TO DLDATEO
 23492     ELSE
 23493        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23494        MOVE SPACE               TO DC-OPTION-CODE
 23495        PERFORM 9700-DATE-LINK
 23496        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23497
 23498     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23499     MOVE SPACE                  TO DC-OPTION-CODE.
 23500     PERFORM 9700-DATE-LINK.
 23501     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23502
 23503     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23504        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23505     ELSE
 23506        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23507        MOVE SPACE               TO DC-OPTION-CODE
 23508        PERFORM 9700-DATE-LINK
 23509        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23510
 23511     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23512     MOVE SPACE                  TO DC-OPTION-CODE.
 23513     PERFORM 9700-DATE-LINK.
 23514     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23515
 23516     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23517     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23518
 23519     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23520        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23521                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23522
 23523     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23524     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23525     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23526
 23527     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23528        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23529                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23530
 23531     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 432
* EL6311.cbl
 23532     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23533     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23534
 23535     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23536        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23537                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23538
 23539     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23540     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23541
 23542     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23543        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23544                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23545
 23546     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23547     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23548     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23549
 23550     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23551        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23552                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23553
 23554     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23555     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23556     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23557
 23558     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23559        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23560                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23561
 23562     MOVE -1                     TO DPFENTRL.
 23563     GO TO 8100-SEND-INITIAL-MAP.
 23564
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 433
* EL6311.cbl
 23566
 23567***************************************************************
 23568*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23569*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23570*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23571*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23572*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23573*     ARE THEN SET ACCORDINGLY.                               *
 23574*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23575*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23576*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23577***************************************************************
 23578
 23579******************************************************************
 23580*                                                                *
 23581*            E R R O R   A N A L Y S I S                         *
 23582*                                                                *
 23583******************************************************************
 23584
 23585******************************************************************
 23586*                                                                *
 23587*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23588*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23589*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23590*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23591*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23592*                                                                *
 23593*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23594*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23595*                                                                *
 23596******************************************************************
 23597
 23598 7300-FORMAT-ERRORS.
 23599     MOVE ' '                    TO PI-ERRORS-SW
 23600     IF PB-COMMON-ERRORS = LOW-VALUES
 23601        IF PB-FATAL-ERRORS
 23602           MOVE ER-2695          TO EMI-ERROR
 23603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23604           GO TO 7399-EXIT.
 23605
 23606     MOVE +0                     TO WS-SUB4
 23607     move +0                     to pi-6311-fatal-ctr
 23608     .
 23609 7310-ERROR-LOOP.
 23610
 23611     ADD +1                      TO WS-SUB4.
 23612
 23613     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23614        GO TO 7350-SET-ERROR-FLAGS.
 23615
 23616     IF PI-COMPANY-ID = 'UCL'
 23617         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23618             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23619             MOVE ' '                   TO DC-OPTION-CODE
 23620             PERFORM 9700-DATE-LINK
 23621             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23622
 23623     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 434
* EL6311.cbl
 23624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23625     if (emi-fatal)
 23626        and (emi-error not = 1753 and 1754 and 1757 and
 23627                             1758 and 1759 and 1760)
 23628        add +1                   to pi-6311-fatal-ctr
 23629     end-if
 23630     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23631
 23632     GO TO 7310-ERROR-LOOP.
 23633
 23634
 23635 7350-SET-ERROR-FLAGS.
 23636
 23637     IF EMI-FATAL-CTR NOT = ZEROS
 23638        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23639        MOVE 'X'                 TO PB-FATAL-FLAG
 23640                                    PI-ERRORS-SW
 23641        GO TO 7355-SET-ERROR-FLAGS.
 23642
 23643     move ' ' to pi-unforced-sw
 23644     IF EMI-FORCABLE-CTR NOT = ZEROS
 23645        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23646        IF PB-ISSUE
 23647           IF PB-ISSUE-FORCE
 23648              MOVE 'F'           TO PB-FORCE-ER-CD
 23649              MOVE ER-2600       TO EMI-ERROR
 23650              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23651             ELSE
 23652              MOVE 'X'           TO PB-FORCE-ER-CD
 23653*                                   PI-ERRORS-SW
 23654          ELSE
 23655           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23656              MOVE 'F'           TO PB-FORCE-ER-CD
 23657                                    pi-unforced-sw
 23658              MOVE ER-2600       TO EMI-ERROR
 23659              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23660             ELSE
 23661              MOVE 'X'           TO PB-FORCE-ER-CD
 23662                                    pi-unforced-sw.
 23663*                                   PI-ERRORS-SW.
 23664
 23665     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23666     IF PB-ISSUE
 23667         MOVE 'I'                TO ENDT-RECORD-TYPE
 23668     ELSE
 23669         MOVE 'C'                TO ENDT-RECORD-TYPE
 23670     END-IF
 23671     MOVE +0                     TO ENDT-SEQ-NO
 23672
 23673
 23674* EXEC CICS READ
 23675*        DATASET   (FILE-ID-ERENDT)
 23676*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23677*        RIDFLD    (ERENDT-KEY)
 23678*        RESP      (WS-RESPONSE)
 23679*        GTEQ
 23680*    END-EXEC
 23681*    MOVE '&"S        G          (  N#00019788' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 435
* EL6311.cbl
 23682     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23684     MOVE X'204E233030303139373838' TO DFHEIV0(25:11)
 23685     CALL 'kxdfhei1' USING DFHEIV0,
 23686           FILE-ID-ERENDT,
 23687           DFHEIV20,
 23688           DFHEIV99,
 23689           ERENDT-KEY,
 23690           DFHEIV99,
 23691           DFHEIV99,
 23692           DFHEIV99
 23693     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23694         DFHEIV20
 23695     MOVE EIBRESP  TO WS-RESPONSE
 23696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23697
 23698     IF RESP-NORMAL
 23699        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23700        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23701            MOVE ER-0280          TO EMI-ERROR
 23702            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23703            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23704            IF CALLED-FROM-6315
 23705               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23706            END-IF
 23707            EVALUATE TRUE
 23708              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23709                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23710              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23711                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23712              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23713                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23714            END-EVALUATE
 23715        END-IF
 23716     END-IF
 23717
 23718
 23719
 23720     IF FIRST-ENTRY OR
 23721        EIBAID = DFHPF1 OR DFHPF2
 23722        MOVE '0'                TO PI-EDIT-SW
 23723        GO TO 7399-EXIT.
 23724
 23725 7355-SET-ERROR-FLAGS.
 23726
 23727     IF EMI-WARNING-CTR NOT = ZEROS
 23728        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23729        MOVE 'W'                 TO PB-WARN-ER-CD.
 23730
 23731     IF PB-UNFORCED-ERRORS OR
 23732        PB-FATAL-ERRORS    OR
 23733        PB-RECORD-ON-HOLD  OR
 23734        PB-RECORD-RETURNED OR
 23735        PB-CANCELLATION
 23736          NEXT SENTENCE
 23737        ELSE
 23738          GO TO 7399-EXIT.
 23739
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 436
* EL6311.cbl
 23740
 23741* EXEC CICS  HANDLE CONDITION
 23742*           NOTFND   (7399-EXIT)
 23743*    END-EXEC.
 23744*    MOVE '"$I                   ! Z #00019838' TO DFHEIV0
 23745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23747     MOVE X'5A20233030303139383338' TO DFHEIV0(25:11)
 23748     CALL 'kxdfhei1' USING DFHEIV0
 23749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23750
 23751
 23752     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23753     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23754     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23755     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23756
 23757
 23758* EXEC CICS READ
 23759*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23760*        DATASET (FILE-ID-ELCERT)
 23761*        RIDFLD  (ELCERT-KEY)
 23762*        UPDATE
 23763*    END-EXEC.
 23764*    MOVE '&"S        EU         (   #00019847' TO DFHEIV0
 23765     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23766     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23767     MOVE X'2020233030303139383437' TO DFHEIV0(25:11)
 23768     CALL 'kxdfhei1' USING DFHEIV0,
 23769           FILE-ID-ELCERT,
 23770           DFHEIV20,
 23771           DFHEIV99,
 23772           ELCERT-KEY,
 23773           DFHEIV99,
 23774           DFHEIV99,
 23775           DFHEIV99
 23776     SET ADDRESS OF CERTIFICATE-MASTER TO
 23777         DFHEIV20
 23778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23779
 23780
 23781
 23782     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23783     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23784
 23785     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23786        GO TO 7360-REWRITE-CERT-MASTER.
 23787
 23788     IF PB-ISSUE
 23789        IF PB-RECORD-RETURNED
 23790            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23791            GO TO 7360-REWRITE-CERT-MASTER
 23792        ELSE
 23793            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23794            GO TO 7360-REWRITE-CERT-MASTER.
 23795
 23796     IF PB-RECORD-RETURNED
 23797         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 437
* EL6311.cbl
 23798         GO TO 7360-REWRITE-CERT-MASTER.
 23799
 23800     IF (PB-C-LF-CANCEL-VOIDED)
 23801        or (pb-c-ah-cancel-voided)
 23802        IF (PB-UNFORCED-ERRORS OR
 23803            PB-FATAL-ERRORS    OR
 23804            PB-RECORD-ON-HOLD)
 23805            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23806            GO TO 7360-REWRITE-CERT-MASTER
 23807        ELSE
 23808            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23809            GO TO 7360-REWRITE-CERT-MASTER.
 23810
 23811     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23812                            OR PB-RECORD-ON-HOLD)
 23813        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23814     ELSE
 23815        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23816
 23817 7360-REWRITE-CERT-MASTER.
 23818
 23819     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23820        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23821
 23822* EXEC CICS UNLOCK
 23823*            DATASET    (FILE-ID-ELCERT)
 23824*       END-EXEC
 23825*    MOVE '&*                    #   #00019894' TO DFHEIV0
 23826     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23827     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23828     MOVE X'2020233030303139383934' TO DFHEIV0(25:11)
 23829     CALL 'kxdfhei1' USING DFHEIV0,
 23830           FILE-ID-ELCERT,
 23831           DFHEIV99
 23832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23833        GO TO 7399-EXIT.
 23834
 23835
 23836* EXEC CICS REWRITE
 23837*         DATASET    (FILE-ID-ELCERT)
 23838*         FROM       (CERTIFICATE-MASTER)
 23839*    END-EXEC.
 23840     MOVE LENGTH OF
 23841      CERTIFICATE-MASTER
 23842       TO DFHEIV11
 23843*    MOVE '&& L                  %   #00019899' TO DFHEIV0
 23844     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23845     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23846     MOVE X'2020233030303139383939' TO DFHEIV0(25:11)
 23847     CALL 'kxdfhei1' USING DFHEIV0,
 23848           FILE-ID-ELCERT,
 23849           CERTIFICATE-MASTER,
 23850           DFHEIV11,
 23851           DFHEIV99
 23852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23853
 23854
 23855 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 438
* EL6311.cbl
 23856      EXIT.
 23857
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 439
* EL6311.cbl
 23859
 23860*************************************************************
 23861*                                                           *
 23862*              S E T   A T T R I B U T E S                  *
 23863*                                                           *
 23864*************************************************************
 23865
 23866 7400-SET-ATTRIBUTES.
 23867
 23868     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23869        GO TO 7499-EXIT.
 23870
 23871**2601**
 23872
 23873     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23874        IF PB-ISSUE
 23875           MOVE AL-UABON         TO BEFFDTA
 23876           GO TO 7499-EXIT
 23877         ELSE
 23878           MOVE AL-UABON         TO CEFFDTA
 23879           GO TO 7499-EXIT.
 23880
 23881**2604**
 23882
 23883     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23884        IF PB-ISSUE
 23885           MOVE AL-UABON         TO BTYPE1A
 23886           MOVE -1               TO BTYPE1L
 23887           MOVE  1               TO SET-CURSOR-SW
 23888           GO TO 7499-EXIT.
 23889
 23890**2605**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23893        IF PB-ISSUE
 23894           MOVE AL-UABON         TO BTYPE2A
 23895           MOVE -1               TO BTYPE2L
 23896           MOVE  1               TO SET-CURSOR-SW
 23897           GO TO 7499-EXIT.
 23898
 23899**2606**
 23900
 23901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23902        IF PB-ISSUE
 23903           MOVE AL-UABON         TO BSIGA
 23904           MOVE -1               TO BSIGL
 23905           MOVE  1               TO SET-CURSOR-SW
 23906           GO TO 7499-EXIT.
 23907
 23908**2607**
 23909
 23910     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23911        IF PB-ISSUE
 23912           MOVE AL-UABON         TO BSIGA
 23913           MOVE -1               TO BSIGL
 23914           MOVE  1               TO SET-CURSOR-SW
 23915           GO TO 7499-EXIT.
 23916
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 440
* EL6311.cbl
 23917**2615**
 23918
 23919     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23920        IF PB-ISSUE
 23921           MOVE AL-UABOF         TO BREINA
 23922           MOVE -1               TO BREINL
 23923           GO TO 7499-EXIT.
 23924
 23925**2622**
 23926
 23927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23928        IF PB-ISSUE
 23929           MOVE AL-UABON         TO BEFFDTA
 23930           GO TO 7499-EXIT
 23931        ELSE
 23932           MOVE AL-UABON         TO CEFFDTA
 23933           GO TO 7499-EXIT.
 23934
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 441
* EL6311.cbl
 23936
 23937*************************************************************
 23938*                                                           *
 23939*              I S S U E   E R R O R S                      *
 23940*                                                           *
 23941*************************************************************
 23942
 23943 7420-ISSUE-ERRORS.
 23944
 23945     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23946        MOVE -1                  TO LETRREQL
 23947        MOVE AL-UABOF            TO LETRREQA
 23948        MOVE  1                  TO SET-CURSOR-SW
 23949        GO TO 7499-EXIT.
 23950
 23951     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23952        MOVE AL-UABOF            TO LETRREQA
 23953        GO TO 7499-EXIT.
 23954
 23955**2626**
 23956
 23957     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23958        MOVE AL-UABON            TO BCERTNOA
 23959        GO TO 7499-EXIT.
 23960
 23961**2627**
 23962
 23963     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23964        MOVE AL-UNBON            TO BAGEA
 23965        MOVE -1                  TO BAGEL
 23966        MOVE  1                  TO SET-CURSOR-SW
 23967        GO TO 7499-EXIT.
 23968
 23969**2628**
 23970
 23971     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23972        MOVE AL-UNBON            TO BAGEA
 23973        MOVE -1                  TO BAGEL
 23974        MOVE  1                  TO SET-CURSOR-SW
 23975        GO TO 7499-EXIT.
 23976
 23977**2629**
 23978
 23979     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23980        MOVE AL-UABON            TO BSEXA
 23981        MOVE -1                  TO BSEXL
 23982        MOVE  1                  TO SET-CURSOR-SW
 23983        GO TO 7499-EXIT.
 23984
 23985**2630**
 23986
 23987     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23988        MOVE -1                  TO BTYPE1L
 23989        MOVE  1                  TO SET-CURSOR-SW
 23990        GO TO 7499-EXIT.
 23991
 23992**2631**
 23993
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 442
* EL6311.cbl
 23994     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23995        MOVE -1                  TO BTYPE1L
 23996        MOVE  1                  TO SET-CURSOR-SW
 23997        GO TO 7499-EXIT.
 23998
 23999**2632**
 24000
 24001     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 24002        MOVE AL-UNBON            TO BBEN1A
 24003        MOVE -1                  TO BBEN1L
 24004        MOVE  1                  TO SET-CURSOR-SW
 24005        GO TO 7499-EXIT.
 24006
 24007**2633**
 24008
 24009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 24010        MOVE AL-UNBON            TO BPREM1A
 24011        MOVE -1                  TO BPREM1L
 24012        MOVE  1                  TO SET-CURSOR-SW
 24013        GO TO 7499-EXIT.
 24014
 24015**2634**
 24016
 24017     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 24018        MOVE -1                  TO BTYPE2L
 24019        MOVE  1                  TO SET-CURSOR-SW
 24020        GO TO 7499-EXIT.
 24021
 24022**2635**
 24023
 24024     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 24025        MOVE AL-UNBON            TO BBEN2A
 24026        MOVE -1                  TO BBEN2L
 24027        MOVE  1                  TO SET-CURSOR-SW
 24028        GO TO 7499-EXIT.
 24029
 24030**2636**
 24031
 24032     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 24033        MOVE AL-UNBON            TO BPREM2A
 24034        MOVE -1                  TO BPREM2L
 24035        MOVE  1                  TO SET-CURSOR-SW
 24036        GO TO 7499-EXIT.
 24037
 24038**2639**
 24039
 24040     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 24041        MOVE AL-UNBON            TO BBEN1A
 24042        MOVE -1                  TO BBEN1L
 24043        MOVE  1                  TO SET-CURSOR-SW
 24044        GO TO 7499-EXIT.
 24045
 24046**2640**
 24047
 24048     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 24049        MOVE AL-UNBON            TO BBEN2A
 24050        MOVE -1                  TO BBEN2L
 24051        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 443
* EL6311.cbl
 24052        GO TO 7499-EXIT.
 24053
 24054**2647**
 24055
 24056     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 24057        MOVE AL-UNBON            TO BTERM1A
 24058        MOVE -1                  TO BTERM1L
 24059        MOVE  1                  TO SET-CURSOR-SW
 24060        GO TO 7499-EXIT.
 24061
 24062**2648**
 24063
 24064     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 24065              or er-3070
 24066        MOVE AL-UNBON            TO BLNTRMA
 24067        MOVE -1                  TO BLNTRML
 24068        MOVE  1                  TO SET-CURSOR-SW
 24069        GO TO 7499-EXIT.
 24070
 24071**2649**
 24072
 24073     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24074        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24075            MOVE AL-UNBON            TO BPREM1A
 24076            MOVE -1                  TO BPREM1L
 24077            MOVE  1                  TO SET-CURSOR-SW
 24078            GO TO 7499-EXIT
 24079     ELSE
 24080        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24081           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24082            MOVE AL-UNBON            TO BPREM2A
 24083            MOVE -1                  TO BPREM2L
 24084            MOVE  1                  TO SET-CURSOR-SW
 24085            GO TO 7499-EXIT.
 24086
 24087**2650**
 24088
 24089     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 24090        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24091            MOVE AL-UNBON        TO BPREM1A
 24092            MOVE -1              TO BPREM1L
 24093            MOVE  1              TO SET-CURSOR-SW
 24094            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24095                MOVE AL-UNBON        TO BPREM2A
 24096                MOVE -1              TO BPREM2L
 24097                MOVE  1              TO SET-CURSOR-SW
 24098                GO TO 7499-EXIT
 24099            ELSE
 24100                GO TO 7499-EXIT
 24101        ELSE
 24102            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24103                MOVE AL-UNBON        TO BPREM2A
 24104                MOVE -1              TO BPREM2L
 24105                MOVE  1              TO SET-CURSOR-SW
 24106                GO TO 7499-EXIT
 24107            ELSE
 24108                GO TO 7499-EXIT.
 24109
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 444
* EL6311.cbl
 24110**2651**
 24111
 24112     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 24113        MOVE AL-UABON            TO BSIGA
 24114        MOVE -1                  TO BSIGL
 24115        MOVE  1                  TO SET-CURSOR-SW
 24116        GO TO 7499-EXIT.
 24117
 24118**2653**
 24119
 24120     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 24121        MOVE AL-UABON            TO BFREQA
 24122        MOVE -1                  TO BFREQL
 24123        MOVE  1                  TO SET-CURSOR-SW
 24124        GO TO 7499-EXIT.
 24125
 24126**2654**
 24127
 24128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 24129        MOVE AL-UABON            TO BFREQA
 24130        MOVE -1                  TO BFREQL
 24131        MOVE  1                  TO SET-CURSOR-SW
 24132        GO TO 7499-EXIT.
 24133
 24134**2655**
 24135
 24136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 24137        MOVE AL-UABON            TO BFREQA
 24138        MOVE -1                  TO BFREQL
 24139        MOVE  1                  TO SET-CURSOR-SW
 24140        GO TO 7499-EXIT.
 24141
 24142**2656**
 24143
 24144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 24145        MOVE AL-UNBON            TO BAPRA
 24146        MOVE -1                  TO BAPRL
 24147        MOVE  1                  TO SET-CURSOR-SW
 24148        GO TO 7499-EXIT.
 24149
 24150**2657**
 24151
 24152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24153        MOVE AL-UNBON            TO BAPRA
 24154        MOVE -1                  TO BAPRL
 24155        MOVE  1                  TO SET-CURSOR-SW
 24156        GO TO 7499-EXIT.
 24157
 24158**2658**
 24159
 24160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24161        MOVE AL-UNBON            TO BTERM2A
 24162        MOVE -1                  TO BTERM2L
 24163        MOVE  1                  TO SET-CURSOR-SW
 24164        GO TO 7499-EXIT.
 24165
 24166**2660**
 24167
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 445
* EL6311.cbl
 24168     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 24169        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 24170        MOVE -1                  TO BLSTNML
 24171        MOVE  1                  TO SET-CURSOR-SW
 24172        GO TO 7499-EXIT.
 24173
 24174
 24175**2662**
 24176
 24177     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 24178        MOVE AL-UNBON            TO BAGEA
 24179        MOVE -1                  TO BAGEL
 24180        MOVE  1                  TO SET-CURSOR-SW
 24181        GO TO 7499-EXIT.
 24182
 24183**2663**
 24184
 24185     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 24186        MOVE AL-UNBON            TO BAGEA
 24187        MOVE -1                  TO BAGEL
 24188        MOVE  1                  TO SET-CURSOR-SW
 24189        GO TO 7499-EXIT.
 24190
 24191**2664**
 24192
 24193     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 24194        MOVE AL-UABON            TO BREINA
 24195        MOVE -1                  TO BREINL
 24196        MOVE  1                  TO SET-CURSOR-SW
 24197        GO TO 7499-EXIT.
 24198
 24199**2667**
 24200
 24201     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 24202        MOVE AL-UNBON            TO BBEN2A
 24203        MOVE -1                  TO BBEN2L
 24204        MOVE  1                  TO SET-CURSOR-SW
 24205        GO TO 7499-EXIT.
 24206
 24207**2668**
 24208
 24209     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 24210        MOVE AL-UABON            TO BEFFDTA
 24211        GO TO 7499-EXIT.
 24212
 24213**2669**
 24214
 24215     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 24216       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 24217       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 24218        MOVE AL-UNBON            TO BAGEA
 24219        MOVE -1                  TO BAGEL
 24220        MOVE  1                  TO SET-CURSOR-SW
 24221        GO TO 7499-EXIT.
 24222
 24223**2670**
 24224
 24225     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 446
* EL6311.cbl
 24226        MOVE AL-UABON            TO BFORCEA
 24227        MOVE -1                  TO BFORCEL
 24228        MOVE  1                  TO SET-CURSOR-SW
 24229        GO TO 7499-EXIT.
 24230
 24231**2671**
 24232
 24233     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24234        MOVE AL-UABON            TO BEFFDTA
 24235        GO TO 7499-EXIT.
 24236
 24237**2672**
 24238
 24239     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24240        MOVE AL-UABON            TO BEFFDTA
 24241        GO TO 7499-EXIT.
 24242
 24243**2673**
 24244
 24245     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24246        MOVE AL-UABON            TO BEFFDTA
 24247        GO TO 7499-EXIT.
 24248
 24249**2674**
 24250
 24251     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24252        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24253        MOVE -1                  TO BTYPE1L
 24254        MOVE  1                  TO SET-CURSOR-SW
 24255        GO TO 7499-EXIT.
 24256
 24257**2677**
 24258
 24259     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24260        MOVE AL-UNBON            TO BTERM1A
 24261        MOVE -1                  TO BTERM1L
 24262        MOVE  1                  TO SET-CURSOR-SW
 24263        GO TO 7499-EXIT.
 24264
 24265**2678**
 24266
 24267     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24268        MOVE AL-UNBON            TO BTERM2A
 24269        MOVE -1                  TO BTERM2L
 24270        MOVE  1                  TO SET-CURSOR-SW
 24271        GO TO 7499-EXIT.
 24272
 24273**2679**
 24274
 24275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24276        MOVE AL-UABON            TO BTYPE1A
 24277        MOVE -1                  TO BTYPE1L
 24278        MOVE  1                  TO SET-CURSOR-SW
 24279        GO TO 7499-EXIT.
 24280
 24281**2680**
 24282
 24283     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 447
* EL6311.cbl
 24284        MOVE AL-UABOF            TO B1STPMTA
 24285        MOVE -1                  TO B1STPMTL
 24286        MOVE  1                  TO SET-CURSOR-SW
 24287        GO TO 7499-EXIT.
 24288
 24289**2681**
 24290
 24291     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24292        MOVE AL-UABON            TO BDAYSA
 24293        MOVE -1                  TO BDAYSL
 24294        MOVE  1                  TO SET-CURSOR-SW
 24295        GO TO 7499-EXIT.
 24296
 24297**2682**
 24298
 24299     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24300        MOVE AL-UABON            TO BTERM1A
 24301        MOVE -1                  TO BTERM1L
 24302        MOVE  1                  TO SET-CURSOR-SW
 24303        GO TO 7499-EXIT.
 24304
 24305**2683**
 24306
 24307     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24308        MOVE AL-UABON            TO BSKPCDA
 24309        MOVE -1                  TO BSKPCDL
 24310        MOVE  1                  TO SET-CURSOR-SW
 24311        GO TO 7499-EXIT.
 24312
 24313**2684**
 24314
 24315     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24316        MOVE AL-UABON            TO BTYPE2A
 24317        MOVE -1                  TO BTYPE2L
 24318        MOVE  1                  TO SET-CURSOR-SW
 24319        GO TO 7499-EXIT.
 24320
 24321**2686**
 24322
 24323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24324        MOVE AL-UABON            TO BTYPE2A
 24325        MOVE -1                  TO BTYPE2L
 24326        MOVE  1                  TO SET-CURSOR-SW
 24327        GO TO 7499-EXIT.
 24328
 24329**2689**
 24330
 24331     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24332        MOVE AL-UABON            TO BSIGA
 24333        MOVE -1                  TO BSIGL
 24334        MOVE  1                  TO SET-CURSOR-SW
 24335        GO TO 7499-EXIT.
 24336
 24337**2690**
 24338
 24339     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24340        MOVE AL-UABOF            TO BLNOFCRA
 24341        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 448
* EL6311.cbl
 24342        MOVE  1                  TO SET-CURSOR-SW
 24343        GO TO 7499-EXIT.
 24344
 24345**2693**
 24346
 24347     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24348        MOVE AL-UABOF            TO BLNOFCRA
 24349        MOVE AL-UNBON            TO BBEN1A
 24350        MOVE -1                  TO BBEN1L
 24351        MOVE  1                  TO SET-CURSOR-SW
 24352        GO TO 7499-EXIT.
 24353
 24354**2720**
 24355
 24356     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24357        MOVE AL-UNBON            TO BBEN1A
 24358        MOVE -1                  TO BBEN1L
 24359        MOVE  1                  TO SET-CURSOR-SW
 24360        GO TO 7499-EXIT.
 24361
 24362**2709**
 24363
 24364*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24365*       MOVE AL-UNBON            TO BBEN1A
 24366*       MOVE -1                  TO BBEN1L
 24367*       MOVE  1                  TO SET-CURSOR-SW
 24368*       GO TO 7499-EXIT.
 24369
 24370*************************************************************
 24371*                                                           *
 24372*            C A N C E L   E R R O R S                      *
 24373*                                                           *
 24374*************************************************************
 24375
 24376**2726**
 24377
 24378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24379        MOVE AL-UABON            TO CCERTNOA
 24380        GO TO 7499-EXIT.
 24381
 24382**2728**
 24383
 24384     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24385        MOVE AL-UABON            TO CCERTNOA
 24386        GO TO 7499-EXIT.
 24387
 24388**2729**
 24389
 24390     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24391        MOVE AL-UABON            TO CCERTNOA
 24392        GO TO 7499-EXIT.
 24393
 24394**2730**
 24395
 24396     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24397        MOVE AL-UABON            TO CCERTNOA
 24398        GO TO 7499-EXIT.
 24399
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 449
* EL6311.cbl
 24400**2731**
 24401
 24402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24403        MOVE AL-UABON            TO CCANDT1A
 24404        MOVE -1                  TO CCANDT1L
 24405        MOVE  1                  TO SET-CURSOR-SW
 24406        GO TO 7499-EXIT.
 24407
 24408**2732**
 24409
 24410     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24411        MOVE AL-UABON            TO CCANDT1A
 24412        MOVE -1                  TO CCANDT1L
 24413        MOVE  1                  TO SET-CURSOR-SW
 24414        GO TO 7499-EXIT.
 24415
 24416**2733**
 24417
 24418     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24419        MOVE AL-UABON            TO CCANDT1A
 24420        MOVE -1                  TO CCANDT1L
 24421        MOVE  1                  TO SET-CURSOR-SW
 24422        GO TO 7499-EXIT.
 24423
 24424**2734**
 24425
 24426     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24427        MOVE AL-UNBON            TO CREFND1A
 24428        MOVE -1                  TO CREFND1L
 24429        MOVE  1                  TO SET-CURSOR-SW
 24430        GO TO 7499-EXIT.
 24431
 24432**2735**
 24433
 24434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24435        MOVE AL-UABON            TO CCANDT2A
 24436        MOVE -1                  TO CCANDT2L
 24437        MOVE  1                  TO SET-CURSOR-SW
 24438        GO TO 7499-EXIT.
 24439
 24440**2736**
 24441
 24442     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24443        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24444            MOVE AL-UNBON        TO CREFND1A
 24445            MOVE -1              TO CREFND1L
 24446            MOVE  1              TO SET-CURSOR-SW
 24447            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24448                MOVE AL-UNBON        TO CREFND2A
 24449                MOVE -1              TO CREFND2L
 24450                MOVE  1              TO SET-CURSOR-SW
 24451                GO TO 7499-EXIT
 24452            ELSE
 24453                GO TO 7499-EXIT
 24454        ELSE
 24455            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24456                MOVE AL-UNBON        TO CREFND2A
 24457                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 450
* EL6311.cbl
 24458                MOVE  1              TO SET-CURSOR-SW
 24459                GO TO 7499-EXIT
 24460            ELSE
 24461                GO TO 7499-EXIT.
 24462
 24463**2738**
 24464
 24465     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24466        MOVE -1                  TO CREFND2L
 24467        MOVE  1                  TO SET-CURSOR-SW
 24468        GO TO 7499-EXIT.
 24469
 24470**2739**
 24471
 24472     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24473        MOVE -1                  TO CREFND1L
 24474        MOVE  1                  TO SET-CURSOR-SW
 24475        GO TO 7499-EXIT.
 24476
 24477**2741**
 24478
 24479     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24480        MOVE -1                  TO CREFND1L
 24481        MOVE  1                  TO SET-CURSOR-SW
 24482        GO TO 7499-EXIT.
 24483
 24484**2743**
 24485
 24486     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24487        MOVE AL-UNBON            TO CCANDT1A
 24488        MOVE -1                  TO CCANDT1L
 24489        MOVE  1                  TO SET-CURSOR-SW
 24490        GO TO 7499-EXIT.
 24491
 24492**2744**
 24493
 24494     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24495        MOVE AL-UNBON            TO CCANDT2A
 24496        MOVE -1                  TO CCANDT2L
 24497        MOVE  1                  TO SET-CURSOR-SW
 24498        GO TO 7499-EXIT.
 24499
 24500**2747**
 24501
 24502     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24503        MOVE AL-UABON            TO CLSTNMA
 24504        MOVE -1                  TO CLSTNML
 24505        MOVE  1                  TO SET-CURSOR-SW
 24506        GO TO 7499-EXIT.
 24507
 24508**2749**
 24509
 24510     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24511        MOVE AL-UABON            TO CFORCEA
 24512        MOVE -1                  TO CFORCEL
 24513        MOVE  1                  TO SET-CURSOR-SW
 24514        GO TO 7499-EXIT.
 24515
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 451
* EL6311.cbl
 24516**2753**
 24517
 24518     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24519        MOVE AL-UNBON            TO CCANDT1A
 24520        MOVE -1                  TO CCANDT1L
 24521        MOVE  1                  TO SET-CURSOR-SW
 24522        GO TO 7499-EXIT.
 24523
 24524**2755**
 24525
 24526     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24527        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24528            MOVE AL-UNBON        TO CREFND1A
 24529            MOVE -1              TO CREFND1L
 24530            MOVE  1              TO SET-CURSOR-SW
 24531            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24532                MOVE AL-UNBON        TO CREFND2A
 24533                MOVE -1              TO CREFND2L
 24534                MOVE  1              TO SET-CURSOR-SW
 24535                GO TO 7499-EXIT
 24536            ELSE
 24537                GO TO 7499-EXIT
 24538        ELSE
 24539            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24540                MOVE AL-UNBON        TO CREFND2A
 24541                MOVE -1              TO CREFND2L
 24542                MOVE  1              TO SET-CURSOR-SW
 24543            ELSE
 24544                GO TO 7499-EXIT.
 24545
 24546**2757**
 24547
 24548     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24549        MOVE AL-UNBON            TO CLIVESA
 24550        MOVE -1                  TO CLIVESL
 24551        MOVE  1                  TO SET-CURSOR-SW
 24552        GO TO 7499-EXIT.
 24553
 24554**2771**
 24555
 24556     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24557        MOVE AL-UABON            TO CCANDT2A
 24558        MOVE -1                  TO CCANDT2L
 24559        MOVE  1                  TO SET-CURSOR-SW
 24560        GO TO 7499-EXIT.
 24561
 24562**2774**
 24563
 24564     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24565        MOVE AL-UABON            TO CCANDT1A
 24566        MOVE -1                  TO CCANDT1L
 24567        MOVE  1                  TO SET-CURSOR-SW
 24568        GO TO 7499-EXIT.
 24569
 24570**2775**
 24571
 24572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24573        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 452
* EL6311.cbl
 24574        MOVE -1                  TO CCANDT2L
 24575        MOVE  1                  TO SET-CURSOR-SW
 24576        GO TO 7499-EXIT.
 24577
 24578**2776**
 24579
 24580     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24581        MOVE AL-UABON            TO CCANDT1A
 24582        MOVE -1                  TO CCANDT1L
 24583        MOVE  1                  TO SET-CURSOR-SW
 24584        GO TO 7499-EXIT.
 24585
 24586
 24587**2777**
 24588
 24589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24590        MOVE AL-UABON            TO CCANDT2A
 24591        MOVE -1                  TO CCANDT2L
 24592        MOVE  1                  TO SET-CURSOR-SW
 24593        GO TO 7499-EXIT.
 24594
 24595**2794**
 24596
 24597     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24598        MOVE AL-UABON            TO CFORCEA
 24599        MOVE -1                  TO CFORCEL
 24600        MOVE  1                  TO SET-CURSOR-SW
 24601        GO TO 7499-EXIT.
 24602
 24603**2799**
 24604
 24605     IF PI-COMPANY-ID = 'UCL'
 24606         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24607             MOVE AL-UNBON            TO BEFFDTA
 24608             MOVE -1                  TO BEFFDTL
 24609             MOVE  1                  TO SET-CURSOR-SW
 24610             GO TO 7499-EXIT.
 24611
 24612 7499-EXIT.
 24613      EXIT.
 24614
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 453
* EL6311.cbl
 24616
 24617 7500-READ-ERLOFC.
 24618     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24619                                     ERLOFC-KEY.
 24620
 24621     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24622
 24623     IF ST-ACCNT-CNTL
 24624         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24625
 24626     IF CARR-GROUP-ST-ACCNT-CNTL
 24627         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24628         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24629         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24630
 24631     IF CARR-ST-ACCNT-CNTL
 24632         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24633         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24634
 24635     IF CARR-ACCNT-CNTL
 24636         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24637
 24638     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24639
 24640     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24641
 24642
 24643* EXEC CICS HANDLE CONDITION
 24644*        NOTFND   (7550-OFFICER-NOTFND)
 24645*    END-EXEC.
 24646*    MOVE '"$I                   ! [ #00020691' TO DFHEIV0
 24647     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24649     MOVE X'5B20233030303230363931' TO DFHEIV0(25:11)
 24650     CALL 'kxdfhei1' USING DFHEIV0
 24651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24652
 24653
 24654
 24655* EXEC CICS READ
 24656*        DATASET   (FILE-ID-ERLOFC)
 24657*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24658*        RIDFLD    (ERLOFC-KEY)
 24659*        EQUAL
 24660*    END-EXEC.
 24661*    MOVE '&"S        E          (   #00020695' TO DFHEIV0
 24662     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24664     MOVE X'2020233030303230363935' TO DFHEIV0(25:11)
 24665     CALL 'kxdfhei1' USING DFHEIV0,
 24666           FILE-ID-ERLOFC,
 24667           DFHEIV20,
 24668           DFHEIV99,
 24669           ERLOFC-KEY,
 24670           DFHEIV99,
 24671           DFHEIV99,
 24672           DFHEIV99
 24673     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 454
* EL6311.cbl
 24674         DFHEIV20
 24675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24676
 24677
 24678     GO TO 7599-EXIT.
 24679
 24680 7550-OFFICER-NOTFND.
 24681     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24682
 24683 7599-EXIT.
 24684      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 455
* EL6311.cbl
 24686******************************************************************
 24687*                                                                *
 24688*            S  E N D    I N I T I A L   M A P                   *
 24689*                                                                *
 24690******************************************************************
 24691
 24692 8100-SEND-INITIAL-MAP.
 24693     MOVE EIBTIME                TO TIME-IN.
 24694
 24695     IF EIBAID = DFHPF11
 24696        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24698
 24699
 24700     IF PI-COMPANY-ID = CLIENT-GIC
 24701        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24702                                       BCPREM-ATTRB (2).
 24703
 24704     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24705                         CLIENT-PEM OR
 24706                         CLIENT-CSO)
 24707        AND PI-DISPLAY-ORIGINAL-BATCH
 24708          IF PI-MAP-NAME = EL631B
 24709             MOVE AL-SADOF               TO BPF5HDRA
 24710                                            BPF4HDRA
 24711          ELSE
 24712             IF PI-MAP-NAME = EL631C
 24713                MOVE AL-SADOF            TO CPF5HDRA
 24714                                            CPF4HDRA.
 24715
 24716     IF PI-MAP-NAME = EL631B
 24717        MOVE AL-SADOF               TO BPF5HDRA
 24718     ELSE
 24719        MOVE AL-SADOF               TO CPF5HDRA
 24720     END-IF
 24721
 24722*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24723     IF PI-MAP-NAME = EL631B
 24724          IF PI-COMPANY-ID NOT = 'DMD'
 24725             MOVE AL-SANOF            TO BBILLEDA
 24726             MOVE AL-SADOF            TO DMDBILA.
 24727*DMD CUSTOM CODING*************END
 24728
 24729     IF PI-PROCESSOR-ID = 'LGXX'
 24730        IF PI-MAP-NAME = EL631B
 24731           MOVE AL-SABOF                    TO BREFHDGA
 24732           MOVE AL-SANOF                    TO BREFA
 24733        ELSE
 24734           IF PI-MAP-NAME = EL631C
 24735              MOVE AL-SABOF                 TO CREFHDGA
 24736              MOVE AL-SANOF                 TO CREFA.
 24737
 24738     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24739        continue
 24740     ELSE
 24741        IF PI-MAP-NAME = EL631C
 24742           MOVE AL-SADOF         TO CCANTXTA
 24743                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 456
* EL6311.cbl
 24744        end-if
 24745     end-if
 24746     IF PI-MAP-NAME = EL631D
 24747        IF PI-AR-PROCESSING
 24748           MOVE AL-SANOF            TO DREFHDGA
 24749        ELSE
 24750           MOVE AL-SADOF            TO DREFHDGA.
 24751
 24752     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24753        AND (PI-MAP-NAME = EL631B)
 24754        MOVE AL-SADOF            TO BVINHA
 24755                                    BVINA
 24756     END-IF
 24757     IF PI-MAP-NAME = EL631B
 24758        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24759        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24760                                 TO BREGIONO
 24761        MOVE PI-PROCESSOR-ID     TO BUSERO
 24762        IF CSR-EDIT-SESSION
 24763           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24764                                 TO BHEADO
 24765           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24766        ELSE
 24767           MOVE AL-SADOF         TO BF15HDRA
 24768           MOVE '4=B-HDR      '  TO BPF4HDRO
 24769        END-IF
 24770        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24771        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24772        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24773        MOVE WS-CURRENT-DT          TO BDATEO
 24774        MOVE TIME-OUT               TO BTIMEO
 24775        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24776        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24777        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24778        IF   WS-DISPLAY-SCREEN
 24779             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24780             MOVE PB-SV-CARRIER     TO BCARRO
 24781             MOVE PB-SV-GROUPING    TO BGROUPO
 24782             MOVE PB-SV-STATE       TO BSTATEO
 24783             MOVE PB-ACCOUNT        TO BACCTO
 24784        ELSE
 24785             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24786     ELSE
 24787        IF PI-MAP-NAME = EL631C
 24788           MOVE '4=B-HDR      '     TO CPF4HDRO
 24789           IF CSR-EDIT-SESSION
 24790              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24791                                 TO CHEADO
 24792           ELSE
 24793              MOVE AL-SADOF      TO CF15HDRA
 24794           END-IF
 24795           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24796           MOVE WS-CURRENT-DT          TO CDATEO
 24797           MOVE TIME-OUT               TO CTIMEO
 24798           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24799           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24800           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24801           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 457
* EL6311.cbl
 24802           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24803           MOVE WS-C-HDG               TO CAHHDGO
 24804           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24805           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24806           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24807           IF   WS-DISPLAY-SCREEN
 24808                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24809                MOVE PB-SV-CARRIER     TO CCARRO
 24810                MOVE PB-SV-GROUPING    TO CGROUPO
 24811                MOVE PB-SV-STATE       TO CSTATEO
 24812                MOVE PB-ACCOUNT        TO CACCTO
 24813           ELSE
 24814                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24815        ELSE
 24816           MOVE WS-CURRENT-DT          TO DDATEO
 24817           MOVE TIME-OUT               TO DTIMEO
 24818           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24819                                          WS-REFUND-HDG-OVERRIDE
 24820           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24821           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24822           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24823                                          WS-REFUND-HDG-OVERRIDE
 24824           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24825           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24826           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24827           IF CSR-EDIT-SESSION
 24828              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24829                                 TO DHEADO
 24830           END-IF
 24831           IF  WS-DISPLAY-SCREEN
 24832               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24833               MOVE PB-CARRIER         TO DCARRO
 24834               MOVE PB-GROUPING        TO DGROUPO
 24835               MOVE PB-STATE           TO DSTATEO
 24836               MOVE PB-ACCOUNT         TO DACCTO
 24837               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24838           ELSE
 24839               MOVE EL631D             TO PI-MAP-NAME
 24840               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24841               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24842
 24843     MOVE SPACE                        TO WS-DISPLAY-SW.
 24844
 24845
 24846* EXEC CICS SEND
 24847*        MAP      (PI-MAP-NAME)
 24848*        MAPSET   (MAPSET-EL6311S)
 24849*        FROM     (EL631BI)
 24850*        ERASE
 24851*        CURSOR
 24852*    END-EXEC.
 24853     MOVE LENGTH OF
 24854      EL631BI
 24855       TO DFHEIV12
 24856     MOVE -1
 24857       TO DFHEIV11
 24858*    MOVE '8$     CT  E    H L F ,   #00020869' TO DFHEIV0
 24859     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 458
* EL6311.cbl
 24860     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24861     MOVE X'2020233030303230383639' TO DFHEIV0(25:11)
 24862     CALL 'kxdfhei1' USING DFHEIV0,
 24863           PI-MAP-NAME,
 24864           EL631BI,
 24865           DFHEIV12,
 24866           MAPSET-EL6311S,
 24867           DFHEIV99,
 24868           DFHEIV99,
 24869           DFHEIV99,
 24870           DFHEIV11,
 24871           DFHEIV99,
 24872           DFHEIV99,
 24873           DFHEIV99
 24874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24875
 24876
 24877     GO TO 9100-RETURN-TRAN.
 24878
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 459
* EL6311.cbl
 24880
 24881******************************************************************
 24882*                                                                *
 24883*              S E N D    D A T A O N L Y                        *
 24884*                                                                *
 24885******************************************************************
 24886
 24887 8200-SEND-DATAONLY.
 24888     MOVE EIBTIME                TO TIME-IN.
 24889
 24890     IF PI-COMPANY-ID = CLIENT-GIC
 24891        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24892                                       BCPREM-ATTRB (2).
 24893
 24894     IF PI-MAP-NAME = EL631B
 24895        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24896        MOVE WS-CURRENT-DT          TO BDATEO
 24897        MOVE TIME-OUT               TO BTIMEO
 24898        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24899        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24900        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24901        MOVE SPACES                 TO BPFENTRO
 24902        MOVE AL-UANOF               TO BPFENTRA
 24903
 24904*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24905        IF PI-COMPANY-ID NOT = 'DMD'
 24906             MOVE AL-SANOF            TO BBILLEDA
 24907             MOVE AL-SADOF            TO DMDBILA
 24908         ELSE
 24909            NEXT SENTENCE
 24910*DMD CUSTOM CODING*************END
 24911     ELSE
 24912        IF PI-MAP-NAME = EL631C
 24913           MOVE WS-CURRENT-DT          TO CDATEO
 24914           MOVE TIME-OUT               TO CTIMEO
 24915           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24916           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24917           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24918           MOVE SPACES                 TO CPFENTRO
 24919           MOVE AL-UANOF               TO CPFENTRA
 24920        ELSE
 24921           MOVE WS-CURRENT-DT          TO DDATEO
 24922           MOVE TIME-OUT               TO DTIMEO
 24923           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24924
 24925
 24926* EXEC CICS SEND
 24927*        MAP      (PI-MAP-NAME)
 24928*        MAPSET   (MAPSET-EL6311S)
 24929*        FROM     (EL631BI)
 24930*        DATAONLY
 24931*        CURSOR
 24932*    END-EXEC.
 24933     MOVE LENGTH OF
 24934      EL631BI
 24935       TO DFHEIV12
 24936     MOVE -1
 24937       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 460
* EL6311.cbl
 24938*    MOVE '8$D    CT       H L F ,   #00020925' TO DFHEIV0
 24939     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24940     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24941     MOVE X'2020233030303230393235' TO DFHEIV0(25:11)
 24942     CALL 'kxdfhei1' USING DFHEIV0,
 24943           PI-MAP-NAME,
 24944           EL631BI,
 24945           DFHEIV12,
 24946           MAPSET-EL6311S,
 24947           DFHEIV99,
 24948           DFHEIV99,
 24949           DFHEIV99,
 24950           DFHEIV11,
 24951           DFHEIV99,
 24952           DFHEIV99,
 24953           DFHEIV99
 24954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24955
 24956
 24957     GO TO 9100-RETURN-TRAN.
 24958
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 461
* EL6311.cbl
 24960
 24961******************************************************************
 24962*                                                                *
 24963*           U T I L I T Y   R O U T I N E S                      *
 24964*                                                                *
 24965******************************************************************
 24966
 24967 8300-SEND-TEXT.
 24968
 24969* EXEC CICS SEND TEXT
 24970*        FROM     (LOGOFF-TEXT)
 24971*        LENGTH   (LOGOFF-LENGTH)
 24972*        ERASE
 24973*        FREEKB
 24974*    END-EXEC.
 24975*    MOVE '8&      T  E F  H   F -   #00020944' TO DFHEIV0
 24976     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24977     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24978     MOVE X'2020233030303230393434' TO DFHEIV0(25:11)
 24979     CALL 'kxdfhei1' USING DFHEIV0,
 24980           LOGOFF-TEXT,
 24981           LOGOFF-LENGTH,
 24982           DFHEIV99,
 24983           DFHEIV99,
 24984           DFHEIV99,
 24985           DFHEIV99,
 24986           DFHEIV99,
 24987           DFHEIV99,
 24988           DFHEIV99,
 24989           DFHEIV99,
 24990           DFHEIV99,
 24991           DFHEIV99
 24992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24993
 24994
 24995
 24996* EXEC CICS RETURN
 24997*    END-EXEC.
 24998*    MOVE '.(                    ''   #00020951' TO DFHEIV0
 24999     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 25000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25001     MOVE X'2020233030303230393531' TO DFHEIV0(25:11)
 25002     CALL 'kxdfhei1' USING DFHEIV0,
 25003           DFHEIV99,
 25004           DFHEIV99,
 25005           DFHEIV99,
 25006           DFHEIV99,
 25007           DFHEIV99,
 25008           DFHEIV99
 25009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25010
 25011
 25012 8400-LOG-JOURNAL-RECORD.
 25013     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 25014     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 25015
 25016*    EXEC CICS JOURNAL
 25017*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 462
* EL6311.cbl
 25018*        JTYPEID     ('EL')
 25019*        FROM        (JOURNAL-RECORD)
 25020*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 25021*    END-EXEC.
 25022
 25023 8600-DEEDIT.
 25024
 25025* EXEC CICS BIF DEEDIT
 25026*         FIELD   (DEEDIT-FIELD)
 25027*         LENGTH  (15)
 25028*    END-EXEC.
 25029     MOVE 15
 25030       TO DFHEIV11
 25031*    MOVE '@"L                   #   #00020966' TO DFHEIV0
 25032     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 25033     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 25034     MOVE X'2020233030303230393636' TO DFHEIV0(25:11)
 25035     CALL 'kxdfhei1' USING DFHEIV0,
 25036           DEEDIT-FIELD,
 25037           DFHEIV11
 25038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25039
 25040
 25041 8800-UNAUTHORIZED-ACCESS.
 25042     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 25043     GO TO 8300-SEND-TEXT.
 25044
 25045 8810-PF23.
 25046     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 25047     MOVE XCTL-EL005             TO PGM-NAME.
 25048     GO TO 9300-XCTL.
 25049
 25050 9100-RETURN-TRAN.
 25051     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 25052
 25053     IF  PI-MAP-NAME =  EL631B
 25054         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 25055
 25056     IF  PI-MAP-NAME =  EL631C
 25057         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 25058
 25059     IF  PI-MAP-NAME =  EL631D
 25060         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 25061
 25062
 25063* EXEC CICS RETURN
 25064*        TRANSID    (TRANS-EXB1)
 25065*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25066*        LENGTH     (1300)
 25067*    END-EXEC.
 25068     MOVE 1300
 25069       TO DFHEIV11
 25070*    MOVE '.(CT                  ''   #00020992' TO DFHEIV0
 25071     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 25072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25073     MOVE X'2020233030303230393932' TO DFHEIV0(25:11)
 25074     CALL 'kxdfhei1' USING DFHEIV0,
 25075           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 463
* EL6311.cbl
 25076           PROGRAM-INTERFACE-BLOCK,
 25077           DFHEIV11,
 25078           DFHEIV99,
 25079           DFHEIV99,
 25080           DFHEIV99
 25081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25082
 25083
 25084 9200-RETURN-MAIN-MENU.
 25085     MOVE XCTL-EL626             TO PGM-NAME.
 25086     GO TO 9300-XCTL.
 25087
 25088 9300-XCTL.
 25089
 25090* EXEC CICS XCTL
 25091*        PROGRAM    (PGM-NAME)
 25092*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25093*        LENGTH     (PI-COMM-LENGTH)
 25094*    END-EXEC.
 25095*    MOVE '.$C                   %   #00021003' TO DFHEIV0
 25096     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 25097     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 25098     MOVE X'2020233030303231303033' TO DFHEIV0(25:11)
 25099     CALL 'kxdfhei1' USING DFHEIV0,
 25100           PGM-NAME,
 25101           PROGRAM-INTERFACE-BLOCK,
 25102           PI-COMM-LENGTH,
 25103           DFHEIV99
 25104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25105
 25106
 25107 9400-CLEAR.
 25108     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 25109     GO TO 9300-XCTL.
 25110
 25111 9500-PF12.
 25112     MOVE XCTL-EL010             TO PGM-NAME.
 25113     GO TO 9300-XCTL.
 25114
 25115 9600-PGMID-ERROR.
 25116
 25117* EXEC CICS HANDLE CONDITION
 25118*        PGMIDERR    (8300-SEND-TEXT)
 25119*    END-EXEC.
 25120*    MOVE '"$L                   ! \ #00021018' TO DFHEIV0
 25121     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 25122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 25123     MOVE X'5C20233030303231303138' TO DFHEIV0(25:11)
 25124     CALL 'kxdfhei1' USING DFHEIV0
 25125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25126
 25127
 25128     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 25129     MOVE ' '                    TO PI-ENTRY-CD-1.
 25130     MOVE XCTL-EL005             TO PGM-NAME.
 25131     MOVE PGM-NAME               TO LOGOFF-PGM.
 25132     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 25133     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 464
* EL6311.cbl
 25134
 25135 9700-DATE-LINK.
 25136     MOVE LINK-ELDATCV           TO PGM-NAME.
 25137
 25138* EXEC CICS LINK
 25139*        PROGRAM    (PGM-NAME)
 25140*        COMMAREA   (DATE-CONVERSION-DATA)
 25141*        LENGTH     (DC-COMM-LENGTH)
 25142*    END-EXEC.
 25143*    MOVE '."C                   (   #00021031' TO DFHEIV0
 25144     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25146     MOVE X'2020233030303231303331' TO DFHEIV0(25:11)
 25147     CALL 'kxdfhei1' USING DFHEIV0,
 25148           PGM-NAME,
 25149           DATE-CONVERSION-DATA,
 25150           DC-COMM-LENGTH,
 25151           DFHEIV99,
 25152           DFHEIV99,
 25153           DFHEIV99,
 25154           DFHEIV99
 25155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25156
 25157
 25158 9800-LINK-PENDING-EDIT.
 25159     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 25160     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 25161
 25162     MOVE LINK-EL050             TO PGM-NAME
 25163     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 25164     MOVE ZEROS                  TO WK-CO-MAX-CAP
 25165                                    WK-CO-TOL-CLAIM
 25166                                    WK-CO-TOL-PREM
 25167                                    WK-CO-TOL-REFUND
 25168                                    WK-CO-TOL-PREM-PCT
 25169                                    WK-CO-TOL-REFUND-PCT
 25170                                    WK-REFUND-OVS-AMT
 25171                                    WK-REFUND-OVS-PCT
 25172                                    WK-ACCT-ADDR
 25173                                    WK-LIFE-EDIT-ADDR
 25174                                    WK-AH-EDIT-ADDR
 25175                                    WK-LIFE-BEN-ADDR
 25176                                    WK-AH-BEN-ADDR
 25177                                    WK-STATE-ADDR
 25178                                    WK-PLAN-ADDR
 25179                                    WK-FORM-ADDR
 25180     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 25181
 25182     MOVE '6'                    TO WK-ENTRY-SW.
 25183
 25184     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 25185
 25186     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 25187                                    EC-AM-EXPIRATION-DT
 25188                                    EC-AM-EFFECTIVE-DT
 25189                                    EC-CM-LF-CANCEL-DT
 25190                                    EC-CM-AH-CANCEL-DT
 25191                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 465
* EL6311.cbl
 25192
 25193     MOVE ZEROS                  TO EC-CO-TOL-PREM
 25194                                    EC-CO-TOL-REFUND
 25195                                    EC-CO-MIN-AGE
 25196                                    EC-CO-MIN-PREMIUM
 25197                                    EC-CO-MIN-TERM
 25198                                    EC-CO-MAX-TERM
 25199                                    EC-ST-TOL-PREM
 25200                                    EC-ST-TOL-REFUND
 25201                                    EC-AM-LF-TOL-PREM
 25202                                    EC-AM-AH-TOL-PREM
 25203                                    EC-AM-LF-MAX-ATT-AGE
 25204                                    EC-AM-LF-MAX-AGE
 25205                                    EC-AM-LF-MAX-TERM
 25206                                    EC-AM-LF-MAX-TOT-BEN
 25207                                    EC-AM-AH-MAX-ATT-AGE
 25208                                    EC-AM-AH-MAX-AGE
 25209                                    EC-AM-AH-MAX-TERM
 25210                                    EC-AM-AH-MAX-TOT-BEN
 25211                                    EC-AM-AH-MAX-MON-BEN
 25212                                    EC-RT-LF-MAX-ATT-AGE
 25213                                    EC-RT-LF-MAX-AGE
 25214                                    EC-RT-LF-MAX-TERM
 25215                                    EC-RT-LF-MAX-TOT-BEN
 25216                                    EC-RT-AH-MAX-ATT-AGE
 25217                                    EC-RT-AH-MAX-AGE
 25218                                    EC-RT-AH-MAX-TERM
 25219                                    EC-RT-AH-MAX-TOT-BEN
 25220                                    EC-RT-AH-MAX-MON-BEN
 25221                                    EC-RT-AH-RATE
 25222                                    EC-RT-LF-RATE
 25223                                    EC-RT-LF-NSP-RATE
 25224                                    EC-RT-AH-NSP-RATE
 25225                                    EC-CM-LF-PRIOR-REFUND
 25226                                    EC-CM-AH-PRIOR-REFUND.
 25227
 25228     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 25229                                    EC-ST-TOL-PREM-PCT
 25230                                    EC-AM-LF-TOL-REFUND
 25231                                    EC-AM-LF-DEV-PERCENT
 25232                                    EC-CO-TOL-REFUND-PCT
 25233                                    EC-ST-TOL-REFUND-PCT
 25234                                    EC-AM-AH-TOL-REFUND
 25235                                    EC-AM-AH-DEV-PERCENT.
 25236
 25237
 25238* EXEC CICS LINK
 25239*         PROGRAM   (PGM-NAME)
 25240*         COMMAREA  (PASSED-RECORD)
 25241*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25242*    END-EXEC.
 25243*    MOVE '."C                   (   #00021116' TO DFHEIV0
 25244     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25246     MOVE X'2020233030303231313136' TO DFHEIV0(25:11)
 25247     CALL 'kxdfhei1' USING DFHEIV0,
 25248           PGM-NAME,
 25249           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 466
* EL6311.cbl
 25250           WS-EDIT-PASS-LENGTH,
 25251           DFHEIV99,
 25252           DFHEIV99,
 25253           DFHEIV99,
 25254           DFHEIV99
 25255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25256
 25257
 25258     MOVE '1'                    TO PI-EDIT-SW.
 25259     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25260
 25261     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25262
 25263     IF PI-COMPANY-ID = 'UCL'
 25264         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25265
 25266     IF VALID-PB-ID
 25267        GO TO 9800-EXIT.
 25268
 25269     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25270
 25271     IF PI-MAP-NAME = EL631B
 25272        MOVE -1                  TO BMAINTL
 25273       ELSE
 25274        MOVE -1                  TO CMAINTL.
 25275
 25276     GO TO 8200-SEND-DATAONLY.
 25277
 25278 9800-EXIT.
 25279      EXIT.
 25280
 25281 9900-ERROR-FORMAT.
 25282
 25283     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25284
 25285     IF NOT EMI-ERRORS-COMPLETE
 25286         MOVE LINK-EL001         TO PGM-NAME
 25287
 25288* EXEC CICS LINK
 25289*            PROGRAM    (PGM-NAME)
 25290*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25291*            LENGTH     (EMI-COMM-LENGTH)
 25292*        END-EXEC.
 25293*    MOVE '."C                   (   #00021151' TO DFHEIV0
 25294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25296     MOVE X'2020233030303231313531' TO DFHEIV0(25:11)
 25297     CALL 'kxdfhei1' USING DFHEIV0,
 25298           PGM-NAME,
 25299           ERROR-MESSAGE-INTERFACE-BLOCK,
 25300           EMI-COMM-LENGTH,
 25301           DFHEIV99,
 25302           DFHEIV99,
 25303           DFHEIV99,
 25304           DFHEIV99
 25305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25306
 25307
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 467
* EL6311.cbl
 25308 9900-EXIT.
 25309     EXIT.
 25310
 25311 9990-ABEND.
 25312     MOVE LINK-EL004             TO PGM-NAME.
 25313     MOVE DFHEIBLK               TO EMI-LINE1.
 25314
 25315* EXEC CICS LINK
 25316*        PROGRAM   (PGM-NAME)
 25317*        COMMAREA  (EMI-LINE1)
 25318*        LENGTH    (72)
 25319*    END-EXEC.
 25320     MOVE 72
 25321       TO DFHEIV11
 25322*    MOVE '."C                   (   #00021163' TO DFHEIV0
 25323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25325     MOVE X'2020233030303231313633' TO DFHEIV0(25:11)
 25326     CALL 'kxdfhei1' USING DFHEIV0,
 25327           PGM-NAME,
 25328           EMI-LINE1,
 25329           DFHEIV11,
 25330           DFHEIV99,
 25331           DFHEIV99,
 25332           DFHEIV99,
 25333           DFHEIV99
 25334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25335
 25336
 25337     IF PI-MAP-NAME = EL631B
 25338        MOVE -1                  TO BMAINTL
 25339       ELSE
 25340        MOVE -1                  TO CMAINTL.
 25341
 25342     IF EIBTRNID NOT = TRANS-EXB1
 25343        GO TO 8100-SEND-INITIAL-MAP
 25344       ELSE
 25345        GO TO 8200-SEND-DATAONLY.
 25346
 25347 9995-SECURITY-VIOLATION.
 25348*                            COPY ELCSCTP.
 25349******************************************************************
 25350*                                                                *
 25351*                            ELCSCTP                             *
 25352*                            VMOD=2.001                          *
 25353*                                                                *
 25354*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25355******************************************************************
 25356
 25357
 25358     MOVE EIBDATE          TO SM-JUL-DATE.
 25359     MOVE EIBTRMID         TO SM-TERMID.
 25360     MOVE THIS-PGM         TO SM-PGM.
 25361     MOVE EIBTIME          TO TIME-IN.
 25362     MOVE TIME-OUT         TO SM-TIME.
 25363     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25364
 25365
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 468
* EL6311.cbl
 25366* EXEC CICS LINK
 25367*         PROGRAM  ('EL003')
 25368*         COMMAREA (SECURITY-MESSAGE)
 25369*         LENGTH   (80)
 25370*    END-EXEC.
 25371     MOVE 'EL003' TO DFHEIV1
 25372     MOVE 80
 25373       TO DFHEIV11
 25374*    MOVE '."C                   (   #00021197' TO DFHEIV0
 25375     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25377     MOVE X'2020233030303231313937' TO DFHEIV0(25:11)
 25378     CALL 'kxdfhei1' USING DFHEIV0,
 25379           DFHEIV1,
 25380           SECURITY-MESSAGE,
 25381           DFHEIV11,
 25382           DFHEIV99,
 25383           DFHEIV99,
 25384           DFHEIV99,
 25385           DFHEIV99
 25386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25387
 25388
 25389******************************************************************
 25390
 25391
 25392 9999-DFHBACK SECTION.
 25393     MOVE '9%                    "   ' TO DFHEIV0
 25394     MOVE 'EL6311' TO DFHEIV1
 25395     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25396     GOBACK.
 25397 9999-DFHEXIT.
 25398     IF DFHEIGDJ EQUAL 0001
 25399         NEXT SENTENCE
 25400     ELSE IF DFHEIGDJ EQUAL 2
 25401         GO TO 9600-PGMID-ERROR,
 25402               9990-ABEND,
 25403               9990-ABEND,
 25404               0010-MAIN-LOGIC
 25405         DEPENDING ON DFHEIGDI
 25406     ELSE IF DFHEIGDJ EQUAL 3
 25407         GO TO 1280-BATCH-HDR-NOT-FOUND
 25408         DEPENDING ON DFHEIGDI
 25409     ELSE IF DFHEIGDJ EQUAL 4
 25410         GO TO 1290-DUPLICATE-ALT-INDEX
 25411         DEPENDING ON DFHEIGDI
 25412     ELSE IF DFHEIGDJ EQUAL 5
 25413         GO TO 1295-CERT-TRL-REC-NOTFND
 25414         DEPENDING ON DFHEIGDI
 25415     ELSE IF DFHEIGDJ EQUAL 6
 25416         GO TO 1380-BATCH-HDR-NOT-FOUND
 25417         DEPENDING ON DFHEIGDI
 25418     ELSE IF DFHEIGDJ EQUAL 7
 25419         GO TO 1385-REC-NOT-FOUND
 25420         DEPENDING ON DFHEIGDI
 25421     ELSE IF DFHEIGDJ EQUAL 8
 25422         GO TO 1386-NOTFND
 25423         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 469
* EL6311.cbl
 25424     ELSE IF DFHEIGDJ EQUAL 9
 25425         GO TO 1399-EXIT
 25426         DEPENDING ON DFHEIGDI
 25427     ELSE IF DFHEIGDJ EQUAL 10
 25428         GO TO 1480-BATCH-HDR-NOT-FOUND
 25429         DEPENDING ON DFHEIGDI
 25430     ELSE IF DFHEIGDJ EQUAL 11
 25431         GO TO 1490-RECORD-NOT-FOUND
 25432         DEPENDING ON DFHEIGDI
 25433     ELSE IF DFHEIGDJ EQUAL 12
 25434         GO TO 1405-DELETE-CERTIFICATE
 25435         DEPENDING ON DFHEIGDI
 25436     ELSE IF DFHEIGDJ EQUAL 13
 25437         GO TO 1420-CONTINUE-DELETE
 25438         DEPENDING ON DFHEIGDI
 25439     ELSE IF DFHEIGDJ EQUAL 14
 25440         GO TO 1406-DELETE-ERNOTE
 25441         DEPENDING ON DFHEIGDI
 25442     ELSE IF DFHEIGDJ EQUAL 15
 25443         GO TO 1407-DELETE-MAILING
 25444         DEPENDING ON DFHEIGDI
 25445     ELSE IF DFHEIGDJ EQUAL 16
 25446         GO TO 1420-CONTINUE-DELETE
 25447         DEPENDING ON DFHEIGDI
 25448     ELSE IF DFHEIGDJ EQUAL 17
 25449         GO TO 1480-BATCH-HDR-NOT-FOUND
 25450         DEPENDING ON DFHEIGDI
 25451     ELSE IF DFHEIGDJ EQUAL 18
 25452         GO TO 1475-DELETE-FINISHED
 25453         DEPENDING ON DFHEIGDI
 25454     ELSE IF DFHEIGDJ EQUAL 19
 25455         GO TO 2280-BATCH-HDR-NOT-FOUND
 25456         DEPENDING ON DFHEIGDI
 25457     ELSE IF DFHEIGDJ EQUAL 20
 25458         GO TO 2290-DUPLICATE-ALT-INDEX
 25459         DEPENDING ON DFHEIGDI
 25460     ELSE IF DFHEIGDJ EQUAL 21
 25461         GO TO 2380-BATCH-HDR-NOT-FOUND
 25462         DEPENDING ON DFHEIGDI
 25463     ELSE IF DFHEIGDJ EQUAL 22
 25464         GO TO 2385-REC-NOT-FOUND
 25465         DEPENDING ON DFHEIGDI
 25466     ELSE IF DFHEIGDJ EQUAL 23
 25467         GO TO 2380-BATCH-HDR-NOT-FOUND
 25468         DEPENDING ON DFHEIGDI
 25469     ELSE IF DFHEIGDJ EQUAL 24
 25470         GO TO 2485-BATCH-HDR-NOT-FOUND
 25471         DEPENDING ON DFHEIGDI
 25472     ELSE IF DFHEIGDJ EQUAL 25
 25473         GO TO 2490-RECORD-NOT-FOUND
 25474         DEPENDING ON DFHEIGDI
 25475     ELSE IF DFHEIGDJ EQUAL 26
 25476         GO TO 2475-CONTINUE-DELETE
 25477         DEPENDING ON DFHEIGDI
 25478     ELSE IF DFHEIGDJ EQUAL 27
 25479         GO TO 2485-BATCH-HDR-NOT-FOUND
 25480         DEPENDING ON DFHEIGDI
 25481     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 470
* EL6311.cbl
 25482         GO TO 2480-DELETE-FINISHED
 25483         DEPENDING ON DFHEIGDI
 25484     ELSE IF DFHEIGDJ EQUAL 29
 25485         GO TO 2820-PROCESS-REWRITE
 25486         DEPENDING ON DFHEIGDI
 25487     ELSE IF DFHEIGDJ EQUAL 30
 25488         GO TO 2885-RECORD-MISSING
 25489         DEPENDING ON DFHEIGDI
 25490     ELSE IF DFHEIGDJ EQUAL 31
 25491         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25492         DEPENDING ON DFHEIGDI
 25493     ELSE IF DFHEIGDJ EQUAL 32
 25494         GO TO 2827-DELETE-MAILING
 25495         DEPENDING ON DFHEIGDI
 25496     ELSE IF DFHEIGDJ EQUAL 33
 25497         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25498         DEPENDING ON DFHEIGDI
 25499     ELSE IF DFHEIGDJ EQUAL 34
 25500         GO TO 2920-PROCESS-REWRITE
 25501         DEPENDING ON DFHEIGDI
 25502     ELSE IF DFHEIGDJ EQUAL 35
 25503         GO TO 2985-RECORD-MISSING
 25504         DEPENDING ON DFHEIGDI
 25505     ELSE IF DFHEIGDJ EQUAL 36
 25506         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25507         DEPENDING ON DFHEIGDI
 25508     ELSE IF DFHEIGDJ EQUAL 37
 25509         GO TO 2990-DUPLICATE-RECORD
 25510         DEPENDING ON DFHEIGDI
 25511     ELSE IF DFHEIGDJ EQUAL 38
 25512         GO TO 3590-NOT-FOUND
 25513         DEPENDING ON DFHEIGDI
 25514     ELSE IF DFHEIGDJ EQUAL 39
 25515         GO TO 3690-NOT-FOUND
 25516         DEPENDING ON DFHEIGDI
 25517     ELSE IF DFHEIGDJ EQUAL 40
 25518         GO TO 3990-NOT-FOUND
 25519         DEPENDING ON DFHEIGDI
 25520     ELSE IF DFHEIGDJ EQUAL 41
 25521         GO TO 4050-END-RECORDS,
 25522               4050-END-RECORDS
 25523         DEPENDING ON DFHEIGDI
 25524     ELSE IF DFHEIGDJ EQUAL 42
 25525         GO TO 4150-END-BATCH
 25526         DEPENDING ON DFHEIGDI
 25527     ELSE IF DFHEIGDJ EQUAL 43
 25528         GO TO 4150-END-BATCH
 25529         DEPENDING ON DFHEIGDI
 25530     ELSE IF DFHEIGDJ EQUAL 44
 25531         GO TO 4250-END-RECORDS,
 25532               4250-END-RECORDS
 25533         DEPENDING ON DFHEIGDI
 25534     ELSE IF DFHEIGDJ EQUAL 45
 25535         GO TO 4350-END-BATCH,
 25536               4350-END-BATCH
 25537         DEPENDING ON DFHEIGDI
 25538     ELSE IF DFHEIGDJ EQUAL 46
 25539         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 471
* EL6311.cbl
 25540               4550-END-RECORDS
 25541         DEPENDING ON DFHEIGDI
 25542     ELSE IF DFHEIGDJ EQUAL 47
 25543         GO TO 4680-NOT-FOUND,
 25544               4680-NOT-FOUND
 25545         DEPENDING ON DFHEIGDI
 25546     ELSE IF DFHEIGDJ EQUAL 48
 25547         GO TO 4860-NOT-FOUND,
 25548               4850-END-RECORDS
 25549         DEPENDING ON DFHEIGDI
 25550     ELSE IF DFHEIGDJ EQUAL 49
 25551         GO TO 4970-NOT-FOUND,
 25552               4950-END-RECORDS
 25553         DEPENDING ON DFHEIGDI
 25554     ELSE IF DFHEIGDJ EQUAL 50
 25555         GO TO 5050-NOT-FOUND
 25556         DEPENDING ON DFHEIGDI
 25557     ELSE IF DFHEIGDJ EQUAL 51
 25558         GO TO 5050-NOT-FOUND
 25559         DEPENDING ON DFHEIGDI
 25560     ELSE IF DFHEIGDJ EQUAL 52
 25561         GO TO 5050-NOT-FOUND
 25562         DEPENDING ON DFHEIGDI
 25563     ELSE IF DFHEIGDJ EQUAL 53
 25564         GO TO 5550-END-RECORDS,
 25565               5550-END-RECORDS
 25566         DEPENDING ON DFHEIGDI
 25567     ELSE IF DFHEIGDJ EQUAL 54
 25568         GO TO 6050-QID-ERROR
 25569         DEPENDING ON DFHEIGDI
 25570     ELSE IF DFHEIGDJ EQUAL 55
 25571         GO TO 6050-QID-ERROR
 25572         DEPENDING ON DFHEIGDI
 25573     ELSE IF DFHEIGDJ EQUAL 56
 25574         GO TO 6400-CONTINUE,
 25575               6400-CONTINUE
 25576         DEPENDING ON DFHEIGDI
 25577     ELSE IF DFHEIGDJ EQUAL 57
 25578         GO TO 3690-NOT-FOUND
 25579         DEPENDING ON DFHEIGDI
 25580     ELSE IF DFHEIGDJ EQUAL 58
 25581         GO TO 7399-EXIT
 25582         DEPENDING ON DFHEIGDI
 25583     ELSE IF DFHEIGDJ EQUAL 59
 25584         GO TO 7550-OFFICER-NOTFND
 25585         DEPENDING ON DFHEIGDI
 25586     ELSE IF DFHEIGDJ EQUAL 60
 25587         GO TO 8300-SEND-TEXT
 25588         DEPENDING ON DFHEIGDI.
 25589     MOVE '9%                    "   ' TO DFHEIV0
 25590     MOVE 'EL6311' TO DFHEIV1
 25591     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25592     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16372     Code:      101425
