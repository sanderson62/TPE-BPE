* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   154*-----------------------------------------------------------------
   155
   156 01  WORK-AREAS.
   157
   158*****************************************************************
   159*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   160*****************************************************************
   161
   162     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   163     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   164     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   165     12  WS-NAME-EDIT-WORK-AREA.
   166         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   167         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   168             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   169         16  WS-WORK-NAME.
   170             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   171             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   172             20  FILLER           PIC X(10)     VALUE SPACES.
   173         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   174             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   175
   176*****************************************************************
   177*        END OF WORKING STORAGE FOR CLIENT-MON                  *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   5
* EL050.cbl
   178*****************************************************************
   179
   180     12  WS-ERRESC-KEY.
   181         16 WS-ERRESC-SEARCH-KEY.
   182             20  WS-ERRESC-COMPANY-CD PIC  X.
   183             20  WS-ERRESC-CARRIER    PIC  X.
   184             20  WS-ERRESC-GROUP      PIC X(6).
   185             20  WS-ERRESC-STATE      PIC XX.
   186             20  WS-ERRESC-ACCOUNT    PIC X(10).
   187         16 WS-ERRESC-RESIDUAL-KEY.
   188             20  WS-ERRESC-AGENT      PIC X(10).
   189             20  WS-ERRESC-RES-STATE  PIC XX.
   190             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   191*                                          YYYYMMDD
   192     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   193     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   194
   195*RESIDENT STATE TAX MASTER(ERRESS)
   196*
   197     12  WS-ERRESS-KEY.
   198         16  WS-ERRESS-COMPANY-CD      PIC  X.
   199         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   200         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   201         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   202*                                          YYYYMMDD
   203
   204     12  WS-CONTRACT-DATE              PIC 9(8).
   205*                                          YYYYMMDD
   206     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   207     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   208         16 WS-YEAR-YY                 PIC   9999.
   209         16 FILLER                     PIC 9(4).
   210*                                          YYYYMMDD
   211     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   212     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   213     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   214     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   215
   216     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   217         88  DPRB-1ST-TIME                      VALUE ' '.
   218
   219*****************************************************************
   220*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   221*****************************************************************
   222
   223     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   224     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   225     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   226     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   227     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   228     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   229     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   230     12  ws-st-agent-sig-edit    pic x          value spaces.
   231     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   232     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   235         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   6
* EL050.cbl
   236         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   237     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   238         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   239         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   240     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   241
   242     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   243     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   244
   245     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   246     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   259     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   260     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   276     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   277     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   278     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   279     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   281     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   282     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   283     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   284     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   293     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   7
* EL050.cbl
   294     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   295     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   296     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   297     12  WS-2671-SW               PIC X         VALUE SPACE.
   298     12  WS-2672-SW               PIC X         VALUE SPACE.
   299     12  ws-9813-sw               pic x         value spaces.
   300     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   301         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   302     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   303         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   304     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   305
   306     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   307         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   308         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   309         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   310         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   311
   312     12  WS-CREDIT-EDIT-CONTROLS.
   313         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   314         16  WS-MIN-AGE           PIC 99                VALUE  0.
   315         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   316         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   317         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   318         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   319
   320     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   321     12  WS-AGE-FIELDS.
   322         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   323         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   324         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   325         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   326
   327     12  WS-SAVE-ALLOWABLE-BENEFIT.
   328         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   329         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   330         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   331         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   332         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   333         16  FILLER                      PIC XX.
   334
   335     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   336     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   337     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   338     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   339     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   341     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   342     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   343     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   344     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   345
   346     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   347     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   348     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   349     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   350     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   351     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   8
* EL050.cbl
   352     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   353     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   354         88  WS-REDUCING              VALUE 'R'.
   355         88  WS-LEVEL                 VALUE 'L' 'P'.
   356     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   357
   358     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   359     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   360     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   361     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   362     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   363     12  ws-ah-max-bens           pic 99        value zeros.
   364     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   365     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   366     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   367     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   368
   369     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   370     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   371     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   372     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   373     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   374     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   375     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   376     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   377     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   378     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   379     12  WS-ACCT-SIG-SW.
   380         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   381         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   382     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   383     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   384     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   388     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   389     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  WS-INITIALS.
   392         16  WS-INIT-1            PIC X         VALUE SPACES.
   393         16  WS-INIT-2            PIC X         VALUE SPACES.
   394
   395     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   396     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   397     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   398     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   399     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   400*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   401     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   408     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   409     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page   9
* EL050.cbl
   410     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   411     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   412     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   413     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   414     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423******** FLA
   424     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   426     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   427     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   428     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   429********
   430     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   431     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   432     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   433     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   434     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   435     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   436     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   437     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   438     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   439     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   440
   441     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   442         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   443                                         '0' THRU '9'.
   444
   445     12  NUMBER-OF-MONTHS.
   446         16  SK-MO OCCURS 12 TIMES PIC X.
   447
   448     12  WS-WORK-DATE.
   449         16  WS-YEAR            PIC 99    VALUE 00.
   450         16  WS-MONTH           PIC 99    VALUE 00.
   451         16  WS-DAY             PIC 99    VALUE 00.
   452
   453     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   454     12  WS-WORK-CRIT-DEV       REDEFINES
   455         WS-WORK-LF-CRIT-PER    PIC X(03).
   456
   457     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   458     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   459
   460     12  WS-WORK-DATE-FROM.
   461         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X  VALUE SPACE.
   463         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   466
   467     12  WS-WORK-DATE-THRU.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  10
* EL050.cbl
   468         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   469         16  FILLER             PIC X         VALUE SPACE.
   470         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   471         16  FILLER             PIC X         VALUE SPACE.
   472         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   473
   474     12  WS-LF-INPUT-CD.
   475         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   476         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   477
   478     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   479     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   480         16  WS-AH-INPUT-CD-1   PIC X.
   481         16  WS-AH-INPUT-CD-2-3 PIC XX.
   482
   483     12  WS-SWITCHES.
   484         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   485         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   486             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   487         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   488             88  BANK-ACCT-FOUND          VALUE 'Y'.
   489         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   490             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   491         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   492             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   493         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   494             88  COMP-MASTER-FOUND        VALUE 'Y'.
   495         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   496             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   497         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   498             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   499         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   500             88  STAT-MASTER-FOUND        VALUE 'Y'.
   501         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   502             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   503         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   504             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   505         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   506             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   507         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   508             88  FORM-MASTER-FOUND        VALUE 'Y'.
   509         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   510             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   511         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   512             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   513         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   514             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   515         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   516             88  NO-BENEFIT-FOUND         VALUE 'N'.
   517         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   518             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   519         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   520             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   521         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   522             88  AH-BENEFIT-FOUND         VALUE ' '.
   523             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   524         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   525             88  LF-BENEFIT-FOUND         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  11
* EL050.cbl
   526             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   527         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   528             88  NO-STATE-RECORD          VALUE '1'.
   529         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   530             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   531         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   532             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   533         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   534             88  CERT-WAS-FOUND           VALUE ' '.
   535             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   536         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   537             88  BROWSE-STARTED           VALUE 'Y'.
   538         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   539             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   540         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   541             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   542         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   543             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   544         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   545             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   546         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   547             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   548         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   549             88  APP-CERT-USED            VALUE 'Y' 'A'.
   550         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   551             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   552             88  FIRST-TIME-THROUGH       VALUE '1'.
   553             88  CTBL-NOT-FOUND           VALUE '2'.
   554
   555         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   556             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   557
   558         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   559             88  DLO-ERROR-FOUND          VALUE 'Y'.
   560
   561********FLA
   562     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   563     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   564********
   565     12  RC-SW-1                  PIC X           VALUE '0'.
   566     12  RC-SW-2                  PIC X           VALUE '0'.
   567     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   568     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   569     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   576     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   577     12  LIT-SPACES               PIC X           VALUE SPACES.
   578     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   579     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   580     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   581     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   582     12  erpndm-unlock-sw         pic x           value spaces.
   583         88  need-to-unlock-erpndm  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  12
* EL050.cbl
   584     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   585     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   586     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   587         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   588         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   589     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   590         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   591
   592 01  WS-EXTRA-PERIODS-BY-STATE.
   593     12  WS-INT-PERIODS          PIC 9.
   594     12  WS-EXTRA-PMTS           PIC 9.
   595 01  ws-net-only-state           pic x value 'N'.
   596 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   597     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   598     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   599 01  WS-CRI-SSN-WORK-AREA.
   600     05  WS-CRI-SOC-SEC-NO.
   601         10  WS-SS-REPT-CD       PIC X(5).
   602         10  WS-SS-LAST-NAME     PIC X(5).
   603         10  WS-SS-INITIAL       PIC X.
   604
   605     05  WS-CRI-REPORT-CODE.
   606         10  FILLER              PIC X(5).
   607         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   608
   609     05  WS-CRI-LAST-NAME.
   610         10  WS-CRI-NAME-MOVE    PIC X(5).
   611         10  FILLER              PIC X(10).
   612
   613 01  ws-state-commission-caps.
   614     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   615     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   616     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   617     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   618     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   619     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   620     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   621     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   622     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   623     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   624     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   625     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   626     05  ws-st-cap-limit-to      pic x.
   627     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   628     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   629     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   630     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   631     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   632     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   633     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   634     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   635     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   636     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   637     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   638     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   639 01  WS-NUM-TABLE                PIC X(26)  VALUE
   640     '12345678012345070923456789'.
   641 01  FILLER REDEFINES WS-NUM-TABLE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  13
* EL050.cbl
   642     05  WS-NUM OCCURS 26        PIC 9.
   643 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   644 01  V1                          PIC S999 COMP-3.
   645 01  V2                          PIC S999 COMP-3.
   646 01  V3                          PIC S999 COMP-3.
   647 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   648 01  FILLER REDEFINES WS-WORK-VIN.
   649     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   650 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   651 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   652 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   653 01  WS-HEX-WORK.
   654     05  FILLER                  PIC X  VALUE LOW-VALUES.
   655     05  WS-HEX-BYTE             PIC X.
   656 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   657 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   658 01  WS-WORK-HIN-ROW-B.
   659     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   660
   661 01  ws-benefit-cd-chg-sw      pic x value spaces.
   662     88  benefit-code-chg           value 'Y'.
   663 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   664 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   665     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   666 01  WS-ROW-D-TABLE.
   667     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   668
   669 01  WS-HIN-TABLE-B.
   670     05  F                       PIC XX VALUE 'A2'.
   671     05  F                       PIC XX VALUE 'B3'.
   672     05  F                       PIC XX VALUE 'C4'.
   673     05  F                       PIC XX VALUE 'D5'.
   674     05  F                       PIC XX VALUE 'E6'.
   675     05  F                       PIC XX VALUE 'F7'.
   676     05  F                       PIC XX VALUE 'G8'.
   677     05  F                       PIC XX VALUE 'H9'.
   678     05  F                       PIC XX VALUE 'I1'.
   679     05  F                       PIC XX VALUE 'J2'.
   680     05  F                       PIC XX VALUE 'K3'.
   681     05  F                       PIC XX VALUE 'L4'.
   682     05  F                       PIC XX VALUE 'M5'.
   683     05  F                       PIC XX VALUE 'N6'.
   684     05  F                       PIC XX VALUE 'O0'.
   685     05  F                       PIC XX VALUE 'P7'.
   686     05  F                       PIC XX VALUE 'Q0'.
   687     05  F                       PIC XX VALUE 'R8'.
   688     05  F                       PIC XX VALUE 'S9'.
   689     05  F                       PIC XX VALUE 'T2'.
   690     05  F                       PIC XX VALUE 'U3'.
   691     05  F                       PIC XX VALUE 'V4'.
   692     05  F                       PIC XX VALUE 'W5'.
   693     05  F                       PIC XX VALUE 'X6'.
   694     05  F                       PIC XX VALUE 'Y7'.
   695     05  F                       PIC XX VALUE 'Z8'.
   696 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   697     05  WS-VAL-IN               PIC X.
   698     05  WS-VAL-OUT              PIC 9.
   699 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  14
* EL050.cbl
   700 01  WS-COMPARE-BINARY-DATES.
   701     05  WS-971231                PIC XX VALUE X'92FF'.
   702     05  WS-931231                PIC XX VALUE X'8CFF'.
   703     05  WS-791231                PIC XX VALUE X'77FF'.
   704     05  WS-771001                PIC XX VALUE X'74A1'.
   705     05  WS-820301                PIC XX VALUE X'7B41'.
   706     05  WS-831031                PIC XX VALUE X'7DBF'.
   707     05  WS-831231                PIC XX VALUE X'7DFF'.
   708     05  WS-810831                PIC XX VALUE X'7A7F'.
   709     05  WS-830901                PIC XX VALUE X'7D81'.
   710
   711 01  FILE-ACCESS-IDS.
   712     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   713     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   714     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   715     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   716     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   717     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   718     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   719     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   720     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   721     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   722     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   723     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   724     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   725     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   726     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   727     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   728     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   729 01  DD-IU-SW                    PIC X   VALUE ' '.
   730     88  DD-IU-PRESENT                 VALUE 'Y'.
   731
   732 01  ACCESS-KEYS.
   733     12  ELMSTR-KEY.
   734         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   735         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   736     12  W-CLAIM-KEY.
   737         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   738         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   739
   740     12  ELCNTL-KEY.
   741         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   742         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   743         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   744         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   745
   746     12  ELCERT-KEY.
   747         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   748         16  CERT-CARRIER         PIC X       VALUE SPACE.
   749         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   750         16  CERT-STATE           PIC XX      VALUE SPACES.
   751         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   752         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   753         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   754
   755     12  ELCERT2-KEY.
   756         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   757         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  15
* EL050.cbl
   758
   759     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   760
   761     12  ELCERT-SAVE.
   762         16  FILLER                      PIC XX    VALUE SPACES.
   763
   764         16  WCS-CONTROL-PRIMARY.
   765             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   766             20  WCS-CARRIER             PIC X     VALUE SPACE.
   767             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   768             20  WCS-STATE               PIC XX    VALUE SPACES.
   769             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   770             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   771             20  WCS-CERT-NO.
   772                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   773                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   774
   775         16  CS-CONTROL-BY-NAME.
   776             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   777             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   778             20  CS-INSURED-INITIALS.
   779                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   780                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   781
   782         16  CS-CONTROL-BY-SSN.
   783             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   784             20  CS-SOC-SEC-NO.
   785                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   786                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   787                 24  CS-SSN-LN3.
   788                     28 CS-INSURED-INITIALS-A2   PIC XX
   789                                     VALUE SPACES.
   790                     28 CS-PART-LAST-NAME-A2     PIC X
   791                                     VALUE SPACE.
   792
   793         16  CS-CONTROL-BY-CERT-NO.
   794             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   795             20  CS-CERT-NO-A4           PIC X(11)
   796                                     VALUE SPACES.
   797
   798         16  CS-CONTROL-BY-MEMB.
   799             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   800             20  CS-MEMBER-NO.
   801                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   802                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   803                 24  CS-MEMB-LN4.
   804                     28 CS-INSURED-INITIALS-A5   PIC XX
   805                                      VALUE SPACES.
   806                     28 CS-PART-LAST-NAME-A5     PIC XX
   807                                      VALUE SPACES.
   808
   809         16  FILLER              PIC X(360) VALUE SPACES.
   810
   811     12  ERACCT-KEY.
   812         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   813         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   814         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   815         16  ACCT-STATE           PIC X(02) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  16
* EL050.cbl
   816         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   817         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   818
   819     12  ERCOMP-KEY.
   820         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   821         16  COMP-CARRIER         PIC X     VALUE SPACES.
   822         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   823         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   824         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   825         16  COMP-TYPE            PIC X     VALUE SPACES.
   826
   827     12  ERLOFC-KEY.
   828         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   829         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   830         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   831         16  LOFC-STATE           PIC XX    VALUE SPACES.
   832         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   833         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   834
   835     12  WS-ELCRTT-KEY.
   836         16  WS-ELCRTT-PRIMARY       PIC X(33).
   837         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   838
   839     12  ERBXRF-KEY.
   840         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   841         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   842         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   843         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   844
   845     12  ERAGTC-KEY.
   846         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   847         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   848         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   849         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   850         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   851         16  AGTC-TYPE            PIC X     VALUE SPACES.
   852
   853     12  ERPLAN-KEY.
   854         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   855         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   856         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   857         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   858         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   859         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   860         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   861         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   862
   863     12  ERFORM-KEY.
   864         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   865         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   866         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   867         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   868
   869     12  ERREIN-KEY.
   870         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   871         16  REIN-TYPE            PIC X     VALUE SPACES.
   872         16  REIN-TABLE-CO.
   873             20  REIN-CODE-1      PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  17
* EL050.cbl
   874             20  REIN-CODE-2      PIC X     VALUE SPACE.
   875             20  REIN-CODE-3      PIC X     VALUE SPACE.
   876         16  FILLER               PIC X(3)  VALUE SPACES.
   877
   878     12  ERCTBL-KEY.
   879         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   880         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   881         16  CTBL-CNTRL-2.
   882             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   883             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   884
   885     12  ELCRTO-KEY.
   886         16  ELCRTO-COMPANY-CD       PIC X.
   887         16  ELCRTO-CARRIER          PIC X.
   888         16  ELCRTO-GROUPING         PIC X(6).
   889         16  ELCRTO-STATE            PIC XX.
   890         16  ELCRTO-ACCOUNT          PIC X(10).
   891         16  ELCRTO-CERT-EFF-DT      PIC XX.
   892         16  ELCRTO-CERT-NO.
   893             20  ELCRTO-CERT-PRIME   PIC X(10).
   894             20  ELCRTO-CERT-SFX     PIC X.
   895         16  ELCRTO-RECORD-TYPE      PIC X.
   896         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   897
   898
   899     12  WS-ACCESS.
   900         16  FILLER               PIC XX    VALUE SPACES.
   901         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   902
   903     12  WS-CARR-ACCESS.
   904         16  FILLER               PIC X(3)  VALUE SPACES.
   905         16  WS-CARR              PIC X     VALUE SPACE.
   906*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   907*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   908     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   909         88  WS-DMD-LF-RATING   VALUE 'Y'.
   910         88  WS-DMD-AH-RATING   VALUE 'Y'.
   911         88  WS-DMD-NO-RATING   VALUE 'N'.
   912
   913     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   914         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   915                                         'NJ' 'NL'
   916                                         'PJ' 'PL'
   917                                         'SJ' 'SL'.
   918     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   919         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   920                                         'NI' 'NJ' 'NL' 'NU'
   921                                         'PJ' 'PL' 'PI' 'PU'
   922                                         'SI' 'SJ' 'SL' 'SU'
   923                                         'MX' 'MY' 'MZ'.
   924 01  ERPDEF-KEY-SAVE             PIC X(18).
   925 01  ERPDEF-KEY.
   926     12  ERPDEF-COMPANY-CD       PIC X.
   927     12  ERPDEF-STATE            PIC XX.
   928     12  ERPDEF-PROD-CD          PIC XXX.
   929     12  F                       PIC X(7).
   930     12  ERPDEF-BEN-TYPE         PIC X.
   931     12  ERPDEF-BEN-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  18
* EL050.cbl
   932     12  ERPDEF-EXP-DT           PIC XX.
   933
   934 01  ELSTAT-KEY-SAVE             PIC X(20).
   935 01  ELSTAT-KEY.
   936     12  ELSTAT-COMPANY-ID       PIC XXX.
   937     12  ELSTAT-CARRIER          PIC X.
   938     12  ELSTAT-GROUP            PIC X(6).
   939     12  ELSTAT-STATE            PIC XX.
   940     12  ELSTAT-EXP-DT           PIC 9(8).
   941 01  WS-ERROR-VALUES.
   942     12  ER-1570                     PIC S9(4)   VALUE +1570.
   943     12  ER-1571                     PIC S9(4)   VALUE +1571.
   944     12  er-1572                     pic s9(4)   value +1572.
   945     12  er-1573                     pic s9(4)   value +1573.
   946     12  er-1574                     pic s9(4)   value +1574.
   947     12  ER-1575                     PIC S9(4)   VALUE +1575.
   948     12  er-1576                     pic s9(4)   value +1576.
   949     12  er-1583                     pic s9(4)   value +1583.
   950     12  er-1743                     pic s9(4)   value +1743.
   951     12  er-1744                     pic s9(4)   value +1744.
   952     12  er-1745                     pic s9(4)   value +1745.
   953     12  er-1746                     pic s9(4)   value +1746.
   954     12  er-1747                     pic s9(4)   value +1747.
   955     12  er-1748                     pic s9(4)   value +1748.
   956     12  ER-1891                     PIC S9(4)   VALUE +1891.
   957     12  ER-1892                     PIC S9(4)   VALUE +1892.
   958     12  ER-1893                     PIC S9(4)   VALUE +1893.
   959     12  ER-1894                     PIC S9(4)   VALUE +1894.
   960     12  ER-1895                     PIC S9(4)   VALUE +1895.
   961     12  ER-1896                     PIC S9(4)   VALUE +1896.
   962     12  ER-1897                     PIC S9(4)   VALUE +1897.
   963     12  ER-1898                     PIC S9(4)   VALUE +1898.
   964     12  ER-1899                     PIC S9(4)   VALUE +1899.
   965     12  ER-1900                     PIC S9(4)   VALUE +1900.
   966     12  ER-1901                     PIC S9(4)   VALUE +1901.
   967     12  ER-1902                     PIC S9(4)   VALUE +1902.
   968     12  ER-1903                     PIC S9(4)   VALUE +1903.
   969     12  ER-1904                     PIC S9(4)   VALUE +1904.
   970     12  ER-1905                     PIC S9(4)   VALUE +1905.
   971     12  ER-1906                     PIC S9(4)   VALUE +1906.
   972     12  ER-1907                     PIC S9(4)   VALUE +1907.
   973     12  ER-1909                     PIC S9(4)   VALUE +1909.
   974     12  ER-1910                     PIC S9(4)   VALUE +1910.
   975     12  ER-1911                     PIC S9(4)   VALUE +1911.
   976     12  ER-1912                     PIC S9(4)   VALUE +1912.
   977     12  ER-1913                     PIC S9(4)   VALUE +1913.
   978     12  ER-1914                     PIC S9(4)   VALUE +1914.
   979     12  ER-1915                     PIC S9(4)   VALUE +1915.
   980     12  ER-1916                     PIC S9(4)   VALUE +1916.
   981     12  ER-1917                     PIC S9(4)   VALUE +1917.
   982     12  ER-1918                     PIC S9(4)   VALUE +1918.
   983     12  ER-1919                     PIC S9(4)   VALUE +1919.
   984     12  ER-1920                     PIC S9(4)   VALUE +1920.
   985     12  ER-1921                     PIC S9(4)   VALUE +1921.
   986     12  ER-1922                     PIC S9(4)   VALUE +1922.
   987     12  ER-1923                     PIC S9(4)   VALUE +1923.
   988     12  ER-1924                     PIC S9(4)   VALUE +1924.
   989     12  ER-1925                     PIC S9(4)   VALUE +1925.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  19
* EL050.cbl
   990     12  ER-1926                     PIC S9(4)   VALUE +1926.
   991     12  ER-1927                     PIC S9(4)   VALUE +1927.
   992     12  ER-1955                     PIC s9(4)   VALUE +1955.
   993     12  ER-1956                     PIC s9(4)   VALUE +1956.
   994     12  ER-1957                     PIC s9(4)   VALUE +1957.
   995     12  ER-1958                     PIC s9(4)   VALUE +1958.
   996     12  ER-1959                     PIC s9(4)   VALUE +1959.
   997     12  ER-1960                     PIC s9(4)   VALUE +1960.
   998     12  ER-1961                     PIC s9(4)   VALUE +1961.
   999     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1000     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1001     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1002     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1003     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1004     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1005     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1006     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1007     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1008     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1009     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1010     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1011     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1012     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1013     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1014     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1015     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1016     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1017     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1018     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1019     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1020     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1021     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1022     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1023     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1024     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1025     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1026     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1027     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1028     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1029     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1030     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1031     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1032     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1033     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1034     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1035     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1036     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1037     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1038     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1039     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1040     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1041     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1042     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1043     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1044     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1045     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1046     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1047     12  ER-2645                     PIC S9(4)   VALUE +2645.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  20
* EL050.cbl
  1048     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1049     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1050     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1051     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1052     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1053     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1054     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1055     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1056     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1057     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1058     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1059     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1060     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1061     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1062     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1063     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1064     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1065     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1066     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1067     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1068     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1069     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1070     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1071     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1072     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1073     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1074     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1075     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1076     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1077     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1078     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1079     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1080     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1081     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1082     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1083     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1084     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1085     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1086     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1087     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1088     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1089     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1090     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1091     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1092     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1093     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1094     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1095     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1096     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1097     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1098     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1099     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1100     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1101     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1102     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1103     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1104     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1105     12  ER-2703                     PIC S9(4)   VALUE +2703.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  21
* EL050.cbl
  1106     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1107     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1108     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1109     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1110     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1111     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1112     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1113     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1114     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1115     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1116     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1117     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1118     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1119     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1120     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1121     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1122     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1123     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1124     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1125     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1126     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1127     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1128     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1129     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1130     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1131     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1132     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1133     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1134     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1135     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1136     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1137     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1138     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1139     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1140     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1141     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1142     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1143     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1144     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1145     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1146     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1147     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1148     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1149     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1150     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1151     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1152     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1153     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1154     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1155     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1156     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1157     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1158     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1159     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1160     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1161     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1162     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1163     12  ER-2771                     PIC S9(4)   VALUE +2771.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  22
* EL050.cbl
  1164     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1165     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1166     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1167     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1168     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1169     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1170     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1171     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1172     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1173     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1174     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1175     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1176     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1177     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1178     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1179     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1180     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1181     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1182     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1183     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1184     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1185     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1186     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1187     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1188     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1189     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1190     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1191     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1192     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1193     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1194     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1195     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1196     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1197     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1198     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1199     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1200     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1201     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1202     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1203     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1204     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1205     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1206     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1207     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1208     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1209     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1210     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1211     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1212     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1213     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1214     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1215     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1216     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1217     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1218     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1219     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1220     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1221     12  ER-3780                     PIC S9(4)   VALUE +3780.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  23
* EL050.cbl
  1222     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1223     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1224     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1225     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1226     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1227     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1228     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1229     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1230     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1231     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1232     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1233     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1234     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1235     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1236     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1237     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1238     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1239     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1240     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1241     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1242     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1243     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1244     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1245     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1246     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1247     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1248     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1249     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1250     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1251     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1252     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1253     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1254     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1255     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1256     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1257     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1258     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1259     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1260     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1261     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1262     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1263     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1264     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1265     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1266     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1267     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1268     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1269     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1270     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1271     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1272     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1273     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1274     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1275     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1276     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1277     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1278     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1279     12  ER-8092                     PIC S9(4)   VALUE +8092.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  24
* EL050.cbl
  1280     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1281     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1282     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1283     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1284     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1285     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1286     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1287     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1288     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1289     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1290     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1291     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1292     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1293     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1294     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1295     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1296     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1297     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1298     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1299     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1300     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1301     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1302     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1303     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1304     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1305     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1306     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1307     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1308     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1309     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1310     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1311     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1312     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1313     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1314     12  er-9823                     pic s9(4)   value +9823.
  1315     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1316******************************************************************
  1317***************   END OF ELC50WS     ****************************
  1318******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  25
* EL050.cbl
  1321 01  WORKING-STORAGE-WORK-AREAS.
  1322     12  WS-RESPONSE             PIC S9(8)  COMP.
  1323         88  WS-RESP-NORMAL           VALUE +00.
  1324         88  WS-RESP-ERROR            VALUE +01.
  1325         88  WS-RESP-NOTFND           VALUE +13.
  1326         88  WS-RESP-DUPREC           VALUE +14.
  1327         88  WS-RESP-ENDFILE          VALUE +20.
  1328     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1329     12  WORK-AREAS.
  1330         16  WK-CONV-GREG.
  1331             24  WCG-CENT             PIC XX.
  1332             24  WCG-REST             PIC X(4).
  1333         16  WORK-GREGORIAN-DATE.
  1334             24  WK-GREG-CENT         PIC XX.
  1335             24  WK-GREG-DATE-YYMMDD.
  1336                 28  WK-GREG-YYMM     PIC X(4).
  1337                 28  WK-GREG-DD       PIC XX.
  1338
  1339         16  WORK-SELECT-DATE.
  1340             24  WK-SELECT-CENT            PIC XX.
  1341             24  WK-SELECT-DATE-YYMMDD.
  1342                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1343                 28  FILLER                PIC XX.
  1344
  1345         16  WK-FORM-NO.
  1346             24  WK-FORM-BANK-ID       PIC X(5).
  1347             24  WK-FORM-UNDRWRTR      PIC X(1).
  1348             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1349
  1350         16  WK-MEMBER-NO.
  1351             24  WK-MEMBER-1-6        PIC X(6).
  1352             24  WK-MEMBER-7-12       PIC X(6).
  1353
  1354         16  WK-FULL-CERT-NO.
  1355             24  WK-CERT-POS-1-2      PIC X(2).
  1356             24  WK-CERT-POS-3        PIC X(1).
  1357             24  WK-CERT-POS-4        PIC X(1).
  1358             24  WK-CERT-POS-5-6      PIC X(2).
  1359             24  WK-CERT-POS-7        PIC X(1).
  1360             24  WK-CERT-POS-8-11     PIC X(4).
  1361
  1362         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1363             88  VALID-RATE-CODE        VALUE 'Y'.
  1364             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1365
  1366         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1367         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1368         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1369         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1370         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1371         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1372         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1373         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1374         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1375         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1376
  1377* DLO001
  1378 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  26
* EL050.cbl
  1379     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1380     12  DMPF-RETURN-CODE          PIC XX.
  1381         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1383         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1384         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1385         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1386         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1387
  1388* DLO002
  1389 01  WS-DLO-INTERNAL-POLICY-FORM.
  1390     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1391     12  DIPF-RETURN-CODE          PIC XX.
  1392         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1393         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1394         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1395         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1396         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1397         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1398
  1399* DLO003
  1400 01  WS-DLO-VALID-BANK-ID.
  1401     12  DVBI-BANK-ID              PIC X(5).
  1402     12  DVBI-BANK-ID-TYPE         PIC X.
  1403         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1404         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1405         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1406         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1407         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1408     12  DVBI-RETURN-CODE          PIC XX.
  1409         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1410         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1411         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1412         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1413         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1414         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1415         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1416         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1417         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1418
  1419* DLO007
  1420 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1421     12  DCUA-RES-STATE            PIC XX.
  1422     12  DCUA-BEN-TYPE             PIC XX.
  1423     12  DCUA-SYS-IDENT            PIC X.
  1424         88  DCUA-CLAIM                        VALUE 'C'.
  1425         88  DCUA-PREMIUM                      VALUE 'P'.
  1426     12  DCUA-COVERAGE-RULE        PIC X.
  1427     12  DCUA-CLIENT-ID            PIC X(10).
  1428     12  DCUA-EFF-DATE             PIC X(8).
  1429     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1430     12  DCUA-RETURN-CODE          PIC XX.
  1431         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1432     12  DCUA-CERT-NUMBER          PIC X(11).
  1433     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1434     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1435
  1436* DLO011
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  27
* EL050.cbl
  1437 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1438     12  DPRB-RATE-CODE            PIC X(4).
  1439     12  DPRB-COVERAGE-CATEG       PIC X.
  1440     12  DPRB-RETURN-CODE          PIC XX.
  1441         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1442         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1443         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1444         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1445         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1446         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1447         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1448         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1449         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1450     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1451     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1452     12  DPRB-BEN-TYPE             PIC XX.
  1453
  1454* DLO017
  1455 01  WS-DLO-VALID-RATE-CODE.
  1456     12  DVRC-RATE-CODE            PIC X(4).
  1457     12  DVRC-RETURN-CODE          PIC XX.
  1458         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1459         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1460         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1461         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1462         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1463         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1464
  1465* DLO019
  1466 01  WS-DLO-ORIG-COV-CAT.
  1467     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1468     12  DOCC-RETURN-CODE          PIC XX.
  1469     12  DOCC-ORIG-COV-CAT         PIC X.
  1470     12  DOCC-UNDERWITER           PIC XX.
  1471     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1472     12  DOCC-FILLER               PIC X(6).
  1473
  1474* DLO021
  1475 01  WS-DLO-VALID-LOAN-OFFICER.
  1476     12  DVLO-LOAN-OFFICER.
  1477         16  DVLO-BILL-TYPE        PIC X.
  1478         16  DVLO-BILL-SOURCE      PIC X.
  1479         16  DVLO-BATCH-TYPE       PIC X.
  1480     12  DVLO-RETURN-CODE          PIC XX.
  1481         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1482         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1483         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1484         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1485         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1486         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1487
  1488* DLO022
  1489 01  WS-DLO-VALID-STATE-CODE.
  1490     12  DVSC-STATE-CODE           PIC XX.
  1491     12  DVSC-RETURN-CODE          PIC XX.
  1492         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1493
  1494* DLO023
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  28
* EL050.cbl
  1495 01  WS-DLO-VALID-CODE-VALUES.
  1496     12  DVCV-SYSTEM-ID            PIC XX.
  1497         88  DVCV-CLAIMS                       VALUE 'CL'.
  1498         88  DVCV-CREDIT                       VALUE 'CR'.
  1499     12  DVCV-RECORD-TYPE          PIC XX.
  1500         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1501         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1502         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1503         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1504         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1505         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1506         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1507         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1508     12  DVCV-RECORD-KEY           PIC X(6).
  1509     12  DVCV-RETURN-CODE          PIC XX.
  1510         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1511         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1512         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1513         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1514         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1515         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1516         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1517     12  DVCV-CODE-DESC            PIC X(60).
  1518     12  DVCV-GEN-DESC-1           PIC X(20).
  1519     12  DVCV-GEN-DESC-2           PIC X(20).
  1520     12  DVCV-GEN-DESC-3           PIC X(20).
  1521
  1522 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1523 01  hldi-pass-area.
  1524     03  PA-VIN                  PIC X(17).
  1525     03  PA-ErrorCode            PIC X(10).
  1526     03  PA-ErrorDesc            PIC X(30).
  1527     03  PA-ModelYear            PIC 9(7).
  1528     03  PA-MakeName             PIC X(50).
  1529     03  PA-ModelName            PIC X(50).
  1530     03  PA-SeriesName           PIC X(50).
  1531 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1532 01  zipcd-pass-area.
  1533     03  PA-zip                  PIC X(5).
  1534     03  PA-ErrorCode-zip        PIC X(10).
  1535     03  PA-city                 PIC x(50).
  1536     03  PA-state                PIC Xx.
  1537****  this is for aggregate report.
  1538****  Length is erpndb + 100 of passed-key-area
  1539 01  ws-passed-key-length        pic s9(4) comp value +587.
  1540 01  ws-pass-to-pemaggo.
  1541     05  ws-passed-erpndb        pic x(585).
  1542     05  ws-exceed-limit-yn      pic x.
  1543     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  29
* EL050.cbl
  1545*    COPY ERCBXRF.
  1546******************************************************************
  1547*                                                                *
  1548*                                                                *
  1549*                            ERCBXRF                             *
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565
  1566 01  BANK-CROSS-REFERENCE.
  1567     12  BK-RECORD-ID                PIC XX.
  1568         88  VALID-BK-ID             VALUE 'BK'.
  1569
  1570     12  BK-CONTROL-PRIMARY.
  1571         16  BK-COMPANY-CD           PIC X.
  1572         16  BK-CARRIER              PIC X.
  1573         16  BK-GROUPING             PIC X(6).
  1574         16  BK-BANK-NO              PIC X(10).
  1575
  1576     12  BK-MAINT-INFORMATION.
  1577         16  BK-LAST-MAINT-DT        PIC XX.
  1578         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1579         16  BK-LAST-MAINT-USER      PIC X(4).
  1580         16  FILLER                  PIC X(9).
  1581
  1582     12  FILLER                      PIC X(37).
  1583
  1584     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1585
  1586     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1587                            DEPENDING ON BK-BANK-POINTER-CNT.
  1588         16  BK-AM-ACCOUNT           PIC X(10).
  1589         16  BK-AM-EXP-DT            PIC XX.
  1590         16  BK-AM-EFF-DT            PIC XX.
  1591         16  BK-AM-STATE             PIC XX.
  1592         16  FILLER                  PIC X(20).
  1593
  1594******************************************************************
  1595
  1596*    COPY ERCCOMP.
  1597******************************************************************
  1598*                                                                *
  1599*                                                                *
  1600*                            ERCCOMP                             *
  1601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1602*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  30
* EL050.cbl
  1603*                                                                *
  1604*   ONLINE CREDIT SYSTEM                                         *
  1605*                                                                *
  1606*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1607*                                                                *
  1608*   FILE TYPE = VSAM,KSDS                                        *
  1609*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1610*                                                                *
  1611*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1612*       ALTERNATE PATH = NONE                                    *
  1613*                                                                *
  1614*   LOG = NO                                                     *
  1615*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1616*                                                                *
  1617******************************************************************
  1618*                   C H A N G E   L O G
  1619*
  1620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1621*-----------------------------------------------------------------
  1622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1623* EFFECTIVE    NUMBER
  1624*-----------------------------------------------------------------
  1625* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1626* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1627* 092205    2005050300006  PEMA  ADD LEASE FEE
  1628* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1629* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1630* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1631* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1632* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1633* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1634******************************************************************
  1635
  1636 01  COMPENSATION-MASTER.
  1637     12  CO-RECORD-ID                          PIC XX.
  1638         88  VALID-CO-ID                          VALUE 'CO'.
  1639
  1640     12  CO-CONTROL-PRIMARY.
  1641         16  CO-COMPANY-CD                     PIC X.
  1642         16  CO-CONTROL.
  1643             20  CO-CTL-1.
  1644                 24  CO-CARR-GROUP.
  1645                     28  CO-CARRIER            PIC X.
  1646                     28  CO-GROUPING.
  1647                         32  CO-GROUP-PREFIX   PIC XXX.
  1648                         32  CO-GROUP-PRIME    PIC XXX.
  1649                 24  CO-RESP-NO.
  1650                     28  CO-RESP-PREFIX        PIC X(4).
  1651                     28  CO-RESP-PRIME         PIC X(6).
  1652             20  CO-CTL-2.
  1653                 24  CO-ACCOUNT.
  1654                     28  CO-ACCT-PREFIX        PIC X(4).
  1655                     28  CO-ACCT-PRIME         PIC X(6).
  1656         16  CO-TYPE                           PIC X.
  1657             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1658             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1659             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1660
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  31
* EL050.cbl
  1661     12  CO-MAINT-INFORMATION.
  1662         16  CO-LAST-MAINT-DT                  PIC XX.
  1663         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1664         16  CO-LAST-MAINT-USER                PIC X(4).
  1665     12  FILLER                                PIC XX.
  1666     12  CO-STMT-TYPE                          PIC XXX.
  1667     12  CO-COMP-TYPE                          PIC X.
  1668         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1669     12  CO-STMT-OWNER                         PIC X(4).
  1670     12  CO-BALANCE-CONTROL                    PIC X.
  1671         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1672         88  CO-NO-BALANCE                        VALUE 'N'.
  1673
  1674     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1675         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1676         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1677         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1678
  1679     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1680         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1681         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1682
  1683     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1684     12  CO-GA-DIRECT-DEP                      PIC X.
  1685     12  CO-FUTURE-SPACE                       PIC X.
  1686         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1687
  1688     12  CO-ACCT-NAME                          PIC X(30).
  1689     12  CO-MAIL-NAME                          PIC X(30).
  1690     12  CO-ADDR-1                             PIC X(30).
  1691     12  CO-ADDR-2                             PIC X(30).
  1692     12  CO-ADDR-3.
  1693         16  CO-ADDR-CITY                      PIC X(27).
  1694         16  CO-ADDR-STATE                     PIC XX.
  1695     12  CO-CSO-1099                           PIC X.
  1696     12  CO-ZIP.
  1697         16  CO-ZIP-PRIME.
  1698             20  CO-ZIP-PRI-1ST                PIC X.
  1699                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1700             20  FILLER                        PIC X(4).
  1701         16  CO-ZIP-PLUS4                      PIC X(4).
  1702     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1703         16  CO-CAN-POSTAL-1                   PIC XXX.
  1704         16  CO-CAN-POSTAL-2                   PIC XXX.
  1705         16  FILLER                            PIC XXX.
  1706     12  CO-SOC-SEC                            PIC X(13).
  1707     12  CO-TELEPHONE.
  1708         16  CO-AREA-CODE                      PIC XXX.
  1709         16  CO-PREFIX                         PIC XXX.
  1710         16  CO-PHONE                          PIC X(4).
  1711
  1712     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1713
  1714     12  CO-AR-BAL-LEVEL                       PIC X.
  1715         88  CO-AR-REF-LVL                        VALUE '1'.
  1716         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1717         88  CO-AR-BILL-LVL                       VALUE '2'.
  1718         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  32
* EL050.cbl
  1719         88  CO-AR-FR-LVL                         VALUE '4'.
  1720
  1721     12  CO-AR-NORMAL-PRINT                    PIC X.
  1722         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1723         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1724
  1725     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1726
  1727     12  CO-AR-REPORTING                       PIC X.
  1728         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1729         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1730
  1731     12  CO-AR-PULL-CHECK                      PIC X.
  1732         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1733         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1734
  1735     12  CO-AR-BALANCE-PRINT                   PIC X.
  1736         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1737
  1738     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1739         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1740         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1741         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1742
  1743     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1744
  1745     12  CO-USER-CODE                          PIC X.
  1746     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1747
  1748******************************************************************
  1749*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1750*    THE LAST MONTH END RUN.
  1751******************************************************************
  1752
  1753     12  CO-LAST-ACTIVITY-DATE.
  1754         16  CO-ACT-YEAR                       PIC 99.
  1755         16  CO-ACT-MONTH                      PIC 99.
  1756         16  CO-ACT-DAY                        PIC 99.
  1757
  1758     12  CO-LAST-STMT-DT.
  1759         16  CO-LAST-STMT-YEAR                 PIC 99.
  1760         16  CO-LAST-STMT-MONTH                PIC 99.
  1761         16  CO-LAST-STMT-DAY                  PIC 99.
  1762
  1763     12  CO-MO-END-TOTALS.
  1764         16  CO-MONTHLY-TOTALS.
  1765             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1766             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1767             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1768             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1769             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1770
  1771         16  CO-AGING-TOTALS.
  1772             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1773             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1774             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1775             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1776
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  33
* EL050.cbl
  1777         16  CO-YTD-TOTALS.
  1778             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1779             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1780
  1781         16  CO-OVER-UNDER-TOTALS.
  1782             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1783             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1784
  1785     12  CO-MISCELLANEOUS-TOTALS.
  1786         16  CO-FICA-TOTALS.
  1787             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1788             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1789
  1790         16  CO-CLAIM-TOTALS.
  1791             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1792             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1793
  1794******************************************************************
  1795*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1796*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1797******************************************************************
  1798
  1799     12  CO-CURRENT-TOTALS.
  1800         16  CO-CURRENT-LAST-STMT-DT.
  1801             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1802             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1803             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1804
  1805         16  CO-CURRENT-MONTHLY-TOTALS.
  1806             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1808             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1809             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1810             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1811
  1812         16  CO-CURRENT-AGING-TOTALS.
  1813             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1815             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1816             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1817
  1818         16  CO-CURRENT-YTD-TOTALS.
  1819             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1820             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1821
  1822     12  CO-PAID-COMM-TOTALS.
  1823         16  CO-YTD-PAID-COMMS.
  1824             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1825             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1826
  1827     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1828         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1829         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1830
  1831     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1832         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1833         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1834         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  34
* EL050.cbl
  1835         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1836         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1837         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1838         88  CO-FINAL-LETTER                  VALUE 'F'.
  1839         88  CO-RECONCILING                   VALUE 'R'.
  1840         88  CO-PHONE-CALL                    VALUE 'P'.
  1841         88  CO-LEGAL                         VALUE 'L'.
  1842         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1843         88  CO-WRITE-OFF                     VALUE 'W'.
  1844         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1845
  1846     12  CO-CSR-CODE                       PIC X(4).
  1847
  1848     12  CO-GA-STATUS-INFO.
  1849         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1850         16  CO-GA-TERMINATION-DT          PIC XX.
  1851         16  CO-GA-STATUS-CODE             PIC X.
  1852             88  CO-GA-ACTIVE                 VALUE 'A'.
  1853             88  CO-GA-INACTIVE               VALUE 'I'.
  1854             88  CO-GA-PENDING                VALUE 'P'.
  1855         16  CO-GA-COMMENTS.
  1856             20  CO-GA-COMMENT-1           PIC X(40).
  1857             20  CO-GA-COMMENT-2           PIC X(40).
  1858             20  CO-GA-COMMENT-3           PIC X(40).
  1859             20  CO-GA-COMMENT-4           PIC X(40).
  1860
  1861     12  CO-RPTCD2                         PIC X(10).
  1862     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1863         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1864         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1865
  1866     12  CO-TYPE-AGENT                     PIC X(01).
  1867         88  CO-CORPORATION                   VALUE 'C'.
  1868         88  CO-PARTNERSHIP                   VALUE 'P'.
  1869         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1870         88  CO-TRUST                         VALUE 'T'.
  1871         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1872
  1873     12  CO-FAXNO.
  1874         16  CO-FAX-AREA-CODE                  PIC XXX.
  1875         16  CO-FAX-PREFIX                     PIC XXX.
  1876         16  CO-FAX-PHONE                      PIC X(4).
  1877
  1878     12  CO-BANK-INFORMATION.
  1879         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1880         16  CO-BANK-TRANSIT-NON REDEFINES
  1881             CO-BANK-TRANSIT-NO                PIC 9(8).
  1882
  1883         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1884     12  CO-MISC-DEDUCT-INFO REDEFINES
  1885                  CO-BANK-INFORMATION.
  1886         16  CO-MD-GL-ACCT                     PIC X(10).
  1887         16  CO-MD-DIV                         PIC XX.
  1888         16  CO-MD-CENTER                      PIC X(4).
  1889         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1890         16  CO-CREATE-AP-CHECK                PIC X.
  1891         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1892         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  35
* EL050.cbl
  1893     12  CO-ACH-STATUS                         PIC X.
  1894         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1895         88  CO-ACH-PENDING                        VALUE 'P'.
  1896
  1897     12  CO-BILL-SW                            PIC X.
  1898     12  CO-CONTROL-NAME                       PIC X(30).
  1899     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1900     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1901     12  CO-CLP-STATE                          PIC XX.
  1902     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1903     12  CO-SPP-REFUND-EDIT                    PIC X.
  1904
  1905******************************************************************
  1906
  1907*    COPY ERCAGTC.
  1908******************************************************************
  1909*                                                                *
  1910*                                                                *
  1911*                            ERCAGTC                             *
  1912*                            VMOD=2.001                          *
  1913*                                                                *
  1914*   ONLINE CREDIT SYSTEM                                         *
  1915*                                                                *
  1916*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1917*                                                                *
  1918*   FILE TYPE = VSAM,KSDS                                        *
  1919*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1920*                                                                *
  1921*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1922*       ALTERNATE PATH = NONE                                    *
  1923*                                                                *
  1924*   LOG = NO                                                     *
  1925*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1926*                                                                *
  1927******************************************************************
  1928*                   C H A N G E   L O G
  1929*
  1930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1931*-----------------------------------------------------------------
  1932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1933* EFFECTIVE    NUMBER
  1934*-----------------------------------------------------------------
  1935* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1936* 111004                         NEW FILE AND COPYBOOK
  1937* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1938******************************************************************
  1939 01  AGENT-COMMISSIONS.
  1940     12  AG-RECORD-ID                          PIC XX.
  1941         88  VALID-CO-ID                          VALUE 'AG'.
  1942     12  AG-CONTROL-PRIMARY.
  1943         16  AG-COMPANY-CD                     PIC X.
  1944         16  AG-CONTROL.
  1945             20  AG-CTL-1.
  1946                 24  AG-CARR-GROUP.
  1947                     28  AG-CARRIER            PIC X.
  1948                     28  AG-GROUPING           PIC X(6).
  1949                 24  AG-BANK                   PIC X(10).
  1950             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  36
* EL050.cbl
  1951                 24  AG-EXP-DT                 PIC XX.
  1952         16  AG-TYPE                           PIC X.
  1953             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1954             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1955     12  AG-MAINT-INFORMATION.
  1956         16  AG-LAST-MAINT-DT                  PIC XX.
  1957         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1958         16  AG-LAST-MAINT-USER                PIC X(4).
  1959         16  FILLER                            PIC X(10).
  1960     12  AG-EFF-DT                             PIC XX.
  1961     12  AG-COMM-STRUCTURE.
  1962         16  AG-AGT-COMMS OCCURS 10.
  1963             20  AG-AGT                PIC X(10).
  1964             20  AG-COM-TYP            PIC X.
  1965             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1966             20  AG-RECALC-LV-INDIC    PIC X.
  1967             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1968             20  AG-LRCALC-LV-INDIC    PIC X.
  1969             20  FILLER                PIC X(05).
  1970     12  FILLER                  PIC X(145).
  1971******************************************************************
  1972*    COPY ERCRESS.
  1973******************************************************************
  1974*                                                                *
  1975*                            ERCRESS                             *
  1976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1977*                            VMOD=2.002                          *
  1978*                                                                *
  1979*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1980*                                                                *
  1981*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1982*   VSAM RESIDENT STATE TAX MASTER                              *
  1983*                                                                *
  1984*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1985*                                                                *
  1986*   FILE TYPE = VSAM,KSDS                                        *
  1987*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1988*                                                                *
  1989*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1990*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1991*                                                                *
  1992*   LOG = NO                                                     *
  1993*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1994*                                                                *
  1995*                                                                *
  1996******************************************************************
  1997
  1998 01  RESIDENT-STATE-TAX-MASTER.
  1999
  2000     10  ERRESS-PRIMARY-KEY.
  2001         15  RES-COMPANY-CD        PIC X.
  2002         15  RES-RESIDENT-STATE    PIC XX.
  2003         15  RES-COVERAGE-CATEGORY PIC X.
  2004         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2005*                                      YYYYMMDD
  2006*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2007
  2008     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  37
* EL050.cbl
  2009
  2010         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2011         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2012         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2013         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2014
  2015     10 RES-RECALC-SW              PIC   X.
  2016         88 RECALC                VALUE 'Y'.
  2017         88 NO-RECALC             VALUE 'N'.
  2018     10  RES-MAINT-BY              PIC X(4).
  2019     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2020     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2021*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  38
* EL050.cbl
  2023*    COPY ERCRESC.
  2024******************************************************************
  2025*                                                                *
  2026*                            ERCRESC                             *
  2027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2028*                            VMOD=2.003                          *
  2029*                                                                *
  2030*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2031*                                                                *
  2032*   FILE TYPE = VSAM,KSDS                                        *
  2033*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2034*                                                                *
  2035*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2036*       ALTERNATE PATH1 = NONE                                   *
  2037*                                                                *
  2038*   LOG = NO                                                     *
  2039*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2040*                                                                *
  2041******************************************************************
  2042
  2043 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2044
  2045     10  ERRESC-RECORD-KEY.
  2046         15  RESC-COMPANY-CD           PIC   X.
  2047         15  RESC-CARRIER              PIC   X.
  2048         15  RESC-GROUP                PIC   X(6).
  2049         15  RESC-STATE                PIC   XX.
  2050         15  RESC-ACCOUNT              PIC   X(10).
  2051         15  RESC-AGENT                PIC   X(10).
  2052         15  RESC-RESIDENT-STATE       PIC   XX.
  2053         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2054*                                           YYYYMMDD
  2055     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2056
  2057     10  RESC-COMM-RECORD-DATA.
  2058         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2059             20 RESC-COVERAGE-CAT      PIC    X.
  2060             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2061             20 RESC-COMMISSION-TAB REDEFINES
  2062                RESC-COMMISSION-PER    PIC  XXX.
  2063
  2064     10  RESC-MAINT-BY                 PIC X(4).
  2065     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2066     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2067*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  39
* EL050.cbl
  2069*    COPY ERCPLAN.
  2070******************************************************************
  2071*                                                                *
  2072*                                                                *
  2073*                            ERCPLAN                             *
  2074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2075*                            VMOD=2.003                          *
  2076*                                                                *
  2077*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2078*                                                                *
  2079*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2080*   PLAN MASTER                                                  *
  2081*                                                                *
  2082*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2083*                                                                *
  2084*   FILE TYPE = VSAM,KSDS                                        *
  2085*   RECORD SIZE = 420   RECFORM = FIX                            *
  2086*                                                                *
  2087*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2088*       ALTERNATE PATH1 = N/A                                    *
  2089*                                                                *
  2090*   LOG = NO                                                     *
  2091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2092*                                                                *
  2093*                                                                *
  2094******************************************************************
  2095
  2096 01  PLAN-MASTER.
  2097     12  PL-RECORD-ID                      PIC XX.
  2098         88  VALID-PL-ID                      VALUE 'PL'.
  2099
  2100     12  PL-CONTROL-PRIMARY.
  2101         16  PL-COMPANY-CD                 PIC X.
  2102         16  PL-MSTR-CNTRL.
  2103             20  PL-CONTROL-A.
  2104                 24  PL-CARRIER            PIC X.
  2105                 24  PL-GROUPING           PIC X(6).
  2106                 24  PL-STATE              PIC XX.
  2107                 24  PL-ACCOUNT            PIC X(10).
  2108             20  PL-BENEFIT-TYPE           PIC X.
  2109             20  PL-BENEFIT-CODE           PIC XX.
  2110             20  PL-REVISION-NO            PIC X(3).
  2111
  2112     12  PL-CONTROL-BY-VAR-GRP.
  2113         16  PL-COMPANY-CD-A1              PIC X.
  2114         16  PL-VG-CARRIER                 PIC X.
  2115         16  PL-VG-GROUPING                PIC X(6).
  2116         16  PL-VG-STATE                   PIC XX.
  2117         16  PL-VG-ACCOUNT                 PIC X(10).
  2118         16  PL-BENEFIT-TYPE-A1            PIC X.
  2119         16  PL-BENEFIT-CODE-A1            PIC XX.
  2120         16  PL-REVISION-NO-A1             PIC 999.
  2121
  2122     12  PL-MAINT-INFORMATION.
  2123         16  PL-LAST-MAINT-DT              PIC XX.
  2124         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2125         16  PL-LAST-MAINT-USER            PIC X(4).
  2126         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  40
* EL050.cbl
  2127
  2128     12  PL-LIABILITY-LIMITS.
  2129         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2130         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2131             20  PL-LM-AGE                 PIC S99        COMP-3.
  2132             20  PL-LM-DUR                 PIC S999       COMP-3.
  2133             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2134             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2135
  2136     12  FILLER                            PIC X(30).
  2137
  2138     12  PL-GL-ACCOUNT-NOS.
  2139         16  PL-PREMIUM-GL                 PIC X(8).
  2140         16  PL-COMM-GL                    PIC X(8).
  2141         16  PL-CLAIM-GL                   PIC X(8).
  2142     12  FILLER                            PIC X(24).
  2143     12  PL-TOLERANCES.
  2144         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2145         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2146         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2147         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2148         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2149         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2150     12  PL-OVER-SHORT.
  2151         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2152         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2153     12  FILLER                            PIC X(24).
  2154     12  PLAN-MISC.
  2155         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2156         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2157         16  PL-IG                         PIC X.
  2158         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2159         16  PL-POLICY-FORM                PIC X(12).
  2160         16  PL-EDIT-FOR-FORM              PIC X(01).
  2161         16  PL-DEV-CODE                   PIC XXX.
  2162         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2163         16  PL-CALC-METHOD                PIC X.
  2164         16  PL-BENEFIT-GROUP              PIC X(05).
  2165         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2166
  2167         16  FILLER                        PIC X(99).
  2168******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  41
* EL050.cbl
  2170*    COPY ELCCERT.
  2171******************************************************************
  2172*                                                                *
  2173*                            ELCCERT.                            *
  2174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2175*                            VMOD=2.013                          *
  2176*                                                                *
  2177*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2178*                                                                *
  2179*   FILE TYPE = VSAM,KSDS                                        *
  2180*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2181*                                                                *
  2182*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2183*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2184*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2185*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2186*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2187*                                                                *
  2188*   LOG = YES                                                    *
  2189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2190******************************************************************
  2191*                   C H A N G E   L O G
  2192*
  2193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2194*-----------------------------------------------------------------
  2195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2196* EFFECTIVE    NUMBER
  2197*-----------------------------------------------------------------
  2198* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2199* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2200* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2201* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2202* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2203* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2204* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2205* 032612  CR2011110200001  PEMA  AHL CHANGES
  2206* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2207* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2208******************************************************************
  2209
  2210 01  CERTIFICATE-MASTER.
  2211     12  CM-RECORD-ID                      PIC XX.
  2212         88  VALID-CM-ID                      VALUE 'CM'.
  2213
  2214     12  CM-CONTROL-PRIMARY.
  2215         16  CM-COMPANY-CD                 PIC X.
  2216         16  CM-CARRIER                    PIC X.
  2217         16  CM-GROUPING.
  2218             20  CM-GROUPING-PREFIX        PIC X(3).
  2219             20  CM-GROUPING-PRIME         PIC X(3).
  2220         16  CM-STATE                      PIC XX.
  2221         16  CM-ACCOUNT.
  2222             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2223             20  CM-ACCOUNT-PRIME          PIC X(6).
  2224         16  CM-CERT-EFF-DT                PIC XX.
  2225         16  CM-CERT-NO.
  2226             20  CM-CERT-PRIME             PIC X(10).
  2227             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  42
* EL050.cbl
  2228
  2229     12  CM-CONTROL-BY-NAME.
  2230         16  CM-COMPANY-CD-A1              PIC X.
  2231         16  CM-INSURED-LAST-NAME          PIC X(15).
  2232         16  CM-INSURED-INITIALS.
  2233             20  CM-INSURED-INITIAL1       PIC X.
  2234             20  CM-INSURED-INITIAL2       PIC X.
  2235
  2236     12  CM-CONTROL-BY-SSN.
  2237         16  CM-COMPANY-CD-A2              PIC X.
  2238         16  CM-SOC-SEC-NO.
  2239             20  CM-SSN-STATE              PIC XX.
  2240             20  CM-SSN-ACCOUNT            PIC X(6).
  2241             20  CM-SSN-LN3.
  2242                 25  CM-INSURED-INITIALS-A2.
  2243                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2244                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2245                 25 CM-PART-LAST-NAME-A2         PIC X.
  2246
  2247     12  CM-CONTROL-BY-CERT-NO.
  2248         16  CM-COMPANY-CD-A4              PIC X.
  2249         16  CM-CERT-NO-A4                 PIC X(11).
  2250
  2251     12  CM-CONTROL-BY-MEMB.
  2252         16  CM-COMPANY-CD-A5              PIC X.
  2253         16  CM-MEMBER-NO.
  2254             20  CM-MEMB-STATE             PIC XX.
  2255             20  CM-MEMB-ACCOUNT           PIC X(6).
  2256             20  CM-MEMB-LN4.
  2257                 25  CM-INSURED-INITIALS-A5.
  2258                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2259                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2260                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2261
  2262     12  CM-INSURED-PROFILE-DATA.
  2263         16  CM-INSURED-FIRST-NAME.
  2264             20  CM-INSURED-1ST-INIT       PIC X.
  2265             20  FILLER                    PIC X(9).
  2266         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2267         16  CM-INSURED-SEX                PIC X.
  2268             88  CM-SEX-MALE                  VALUE 'M'.
  2269             88  CM-SEX-FEMAL                 VALUE 'F'.
  2270         16  CM-INSURED-JOINT-AGE          PIC 99.
  2271         16  CM-JOINT-INSURED-NAME.
  2272             20  CM-JT-LAST-NAME           PIC X(15).
  2273             20  CM-JT-FIRST-NAME.
  2274                 24  CM-JT-1ST-INIT        PIC X.
  2275                 24  FILLER                PIC X(9).
  2276             20  CM-JT-INITIAL             PIC X.
  2277
  2278     12  CM-LIFE-DATA.
  2279         16  CM-LF-BENEFIT-CD              PIC XX.
  2280         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2281         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2282         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2283         16  CM-LF-DEV-CODE                PIC XXX.
  2284         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2285         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  43
* EL050.cbl
  2286         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2287         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2288         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2289         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2290         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2292         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2293         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2294         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2295         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2296         16  cm-temp-epiq                  pic xx.
  2297             88  EPIQ-CLASS                  value 'EQ'.
  2298*        16  FILLER                        PIC XX.
  2299
  2300     12  CM-AH-DATA.
  2301         16  CM-AH-BENEFIT-CD              PIC XX.
  2302         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2303         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2304         16  CM-AH-DEV-CODE                PIC XXX.
  2305         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2306         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2307         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2308         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2309         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2310         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2311         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2312         16  CM-AH-PAID-THRU-DT            PIC XX.
  2313             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2314         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2315         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2316         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2317         16  FILLER                        PIC X.
  2318
  2319     12  CM-LOAN-INFORMATION.
  2320         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2321         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2322                                           PIC S9(5)V99  COMP-3.
  2323         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2324         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2325         16  CM-PAY-FREQUENCY              PIC S99.
  2326         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2327         16  CM-RATE-CLASS                 PIC XX.
  2328         16  CM-BENEFICIARY                PIC X(25).
  2329         16  CM-POLICY-FORM-NO             PIC X(12).
  2330         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2331         16  CM-LAST-ADD-ON-DT             PIC XX.
  2332         16  CM-DEDUCTIBLE-AMOUNTS.
  2333             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2334             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2335         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2336             20  CM-RESIDENT-STATE         PIC XX.
  2337             20  CM-RATE-CODE              PIC X(4).
  2338             20  FILLER                    PIC XX.
  2339         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2340             20  CM-LOAN-OFFICER           PIC X(5).
  2341             20  FILLER                    PIC XXX.
  2342         16  CM-CSR-CODE                   PIC XXX.
  2343         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  44
* EL050.cbl
  2344             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2345         16  CM-POST-CARD-IND              PIC X.
  2346         16  CM-NH-INTERFACE-SW            PIC X.
  2347         16  CM-PREMIUM-TYPE               PIC X.
  2348             88  CM-SING-PRM                  VALUE '1'.
  2349             88  CM-O-B-COVERAGE              VALUE '2'.
  2350             88  CM-OPEN-END                  VALUE '3'.
  2351         16  CM-IND-GRP-TYPE               PIC X.
  2352             88  CM-INDIVIDUAL                VALUE 'I'.
  2353             88  CM-GROUP                     VALUE 'G'.
  2354         16  CM-SKIP-CODE                  PIC X.
  2355             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2356             88  SKIP-JULY                    VALUE '1'.
  2357             88  SKIP-AUGUST                  VALUE '2'.
  2358             88  SKIP-SEPTEMBER               VALUE '3'.
  2359             88  SKIP-JULY-AUG                VALUE '4'.
  2360             88  SKIP-AUG-SEPT                VALUE '5'.
  2361             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2362             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2363             88  SKIP-JUNE                    VALUE '8'.
  2364             88  SKIP-JUNE-JULY               VALUE '9'.
  2365             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2366             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2367         16  CM-PAYMENT-MODE               PIC X.
  2368             88  PAY-MONTHLY                  VALUE SPACE.
  2369             88  PAY-WEEKLY                   VALUE '1'.
  2370             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2371             88  PAY-BI-WEEKLY                VALUE '3'.
  2372             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2373         16  CM-LOAN-NUMBER                PIC X(8).
  2374         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2375         16  CM-OLD-LOF                    PIC XXX.
  2376*        16  CM-LOAN-OFFICER               PIC XXX.
  2377         16  CM-REIN-TABLE                 PIC XXX.
  2378         16  CM-SPECIAL-REIN-CODE          PIC X.
  2379         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2380         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2381         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2382
  2383     12  CM-STATUS-DATA.
  2384         16  CM-ENTRY-STATUS               PIC X.
  2385         16  CM-ENTRY-DT                   PIC XX.
  2386
  2387         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2388         16  CM-LF-CANCEL-DT               PIC XX.
  2389         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2390
  2391         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2392         16  CM-LF-DEATH-DT                PIC XX.
  2393         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2394
  2395         16  CM-LF-CURRENT-STATUS          PIC X.
  2396             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2397                                                'M' '4' '5' '9'.
  2398             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2399             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2400             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2401             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  45
* EL050.cbl
  2402             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2403             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2404             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2405             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2406             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2407             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2408             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2409             88  CM-LF-DECLINED               VALUE 'D'.
  2410             88  CM-LF-VOIDED                 VALUE 'V'.
  2411
  2412         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2413         16  CM-AH-CANCEL-DT               PIC XX.
  2414         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2415
  2416         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2417         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2418         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2419
  2420         16  CM-AH-CURRENT-STATUS          PIC X.
  2421             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2422                                                'M' '4' '5' '9'.
  2423             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2424             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2425             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2426             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2427             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2428             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2429             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2430             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2431             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2432             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2433             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2434             88  CM-AH-DECLINED               VALUE 'D'.
  2435             88  CM-AH-VOIDED                 VALUE 'V'.
  2436
  2437         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2438             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2439             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2440             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2441         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2442
  2443         16  CM-ENTRY-BATCH                PIC X(6).
  2444         16  CM-LF-EXIT-BATCH              PIC X(6).
  2445         16  CM-AH-EXIT-BATCH              PIC X(6).
  2446         16  CM-LAST-MONTH-END             PIC XX.
  2447
  2448     12  CM-NOTE-SW                        PIC X.
  2449         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2450         88  CERT-NOTES-PRESENT               VALUE '1'.
  2451         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2452         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2453         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2454         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2455         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2456         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2457     12  CM-COMP-EXCP-SW                   PIC X.
  2458         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2459         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  46
* EL050.cbl
  2460     12  CM-INSURED-ADDRESS-SW             PIC X.
  2461         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2462         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2463
  2464*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2465     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2466     12  FILLER                            PIC X.
  2467
  2468*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2469     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2470     12  FILLER                            PIC X.
  2471*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2472     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2473
  2474     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2475         88  CERT-ADDED-BATCH                 VALUE ' '.
  2476         88  CERT-ADDED-ONLINE                VALUE '1'.
  2477         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2478         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2479         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2480     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2481         88  CERT-AS-LOADED                   VALUE ' '.
  2482         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2483         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2484         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2485         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2486         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2487         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2488         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2489
  2490     12  CM-ACCOUNT-COMM-PCTS.
  2491         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2492         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2493
  2494     12  CM-USER-FIELD                     PIC X.
  2495     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2496     12  CM-CLP-STATE                      PIC XX.
  2497     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2498     12  CM-USER-RESERVED                  PIC XXX.
  2499     12  FILLER REDEFINES CM-USER-RESERVED.
  2500         16  CM-AH-CLASS-CD                PIC XX.
  2501         16  F                             PIC X.
  2502******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  47
* EL050.cbl
  2504*    COPY ERCMAIL.
  2505******************************************************************
  2506*                                                                *
  2507*                                                                *
  2508*                            ERCMAIL                             *
  2509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2510*                            VMOD=2.003                          *
  2511*                                                                *
  2512*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2513*                                                                *
  2514*   FILE TYPE = VSAM,KSDS                                        *
  2515*   RECORD SIZE = 374   RECFORM = FIX                            *
  2516*                                                                *
  2517*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2518*   ALTERNATE PATH    = NOT USED                                 *
  2519*                                                                *
  2520*   LOG = YES                                                    *
  2521*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2522******************************************************************
  2523*                   C H A N G E   L O G
  2524*
  2525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2526*-----------------------------------------------------------------
  2527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2528* EFFECTIVE    NUMBER
  2529*-----------------------------------------------------------------
  2530* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2531* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2532* 111108                   PEMA  ADD CRED BENE ADDR2
  2533******************************************************************
  2534
  2535 01  MAILING-DATA.
  2536     12  MA-RECORD-ID                      PIC XX.
  2537         88  VALID-MA-ID                       VALUE 'MA'.
  2538
  2539     12  MA-CONTROL-PRIMARY.
  2540         16  MA-COMPANY-CD                 PIC X.
  2541         16  MA-CARRIER                    PIC X.
  2542         16  MA-GROUPING.
  2543             20  MA-GROUPING-PREFIX        PIC XXX.
  2544             20  MA-GROUPING-PRIME         PIC XXX.
  2545         16  MA-STATE                      PIC XX.
  2546         16  MA-ACCOUNT.
  2547             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2548             20  MA-ACCOUNT-PRIME          PIC X(6).
  2549         16  MA-CERT-EFF-DT                PIC XX.
  2550         16  MA-CERT-NO.
  2551             20  MA-CERT-PRIME             PIC X(10).
  2552             20  MA-CERT-SFX               PIC X.
  2553
  2554     12  FILLER                            PIC XX.
  2555
  2556     12  MA-ACCESS-CONTROL.
  2557         16  MA-SOURCE-SYSTEM              PIC XX.
  2558             88  MA-FROM-CREDIT                VALUE 'CR'.
  2559             88  MA-FROM-VSI                   VALUE 'VS'.
  2560             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2561             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  48
* EL050.cbl
  2562         16  MA-RECORD-ADD-DT              PIC XX.
  2563         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2564         16  MA-LAST-MAINT-DT              PIC XX.
  2565         16  MA-LAST-MAINT-BY              PIC XXXX.
  2566         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2567
  2568     12  MA-PROFILE-INFO.
  2569         16  MA-QUALIFY-CODE-1             PIC XX.
  2570         16  MA-QUALIFY-CODE-2             PIC XX.
  2571         16  MA-QUALIFY-CODE-3             PIC XX.
  2572         16  MA-QUALIFY-CODE-4             PIC XX.
  2573         16  MA-QUALIFY-CODE-5             PIC XX.
  2574
  2575         16  MA-INSURED-LAST-NAME          PIC X(15).
  2576         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2577         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2578         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2579         16  MA-INSURED-BIRTH-DT           PIC XX.
  2580         16  MA-INSURED-SEX                PIC X.
  2581             88  MA-SEX-MALE                   VALUE 'M'.
  2582             88  MA-SEX-FEMALE                 VALUE 'F'.
  2583         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2584
  2585         16  MA-ADDRESS-CORRECTED          PIC X.
  2586         16  MA-JOINT-BIRTH-DT             PIC XX.
  2587*        16  FILLER                        PIC X(12).
  2588
  2589         16  MA-ADDRESS-LINE-1             PIC X(30).
  2590         16  MA-ADDRESS-LINE-2             PIC X(30).
  2591         16  MA-CITY-STATE.
  2592             20  MA-CITY                   PIC X(28).
  2593             20  MA-ADDR-STATE             PIC XX.
  2594         16  MA-ZIP.
  2595             20  MA-ZIP-CODE.
  2596                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2597                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2598                 24  FILLER                PIC X(4).
  2599             20  MA-ZIP-PLUS4              PIC X(4).
  2600         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2601             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2602             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2603             20  FILLER                    PIC X(3).
  2604
  2605         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2606
  2607         16  FILLER                        PIC XXX.
  2608*        16  FILLER                        PIC X(10).
  2609
  2610     12  MA-CRED-BENE-INFO.
  2611         16  MA-CRED-BENE-NAME                 PIC X(25).
  2612         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2613         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2614         16  MA-CRED-BENE-CTYST.
  2615             20  MA-CRED-BENE-CITY             PIC X(28).
  2616             20  MA-CRED-BENE-STATE            PIC XX.
  2617         16  MA-CRED-BENE-ZIP.
  2618             20  MA-CB-ZIP-CODE.
  2619                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  49
* EL050.cbl
  2620                     88  MA-CB-CANADIAN-POST-CODE
  2621                                           VALUE 'A' THRU 'Z'.
  2622                 24  FILLER                    PIC X(4).
  2623             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2624         16  MA-CB-CANADIAN-POSTAL-CODE
  2625                            REDEFINES MA-CRED-BENE-ZIP.
  2626             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2627             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2628             20  FILLER                        PIC X(3).
  2629     12  MA-POST-CARD-MAIL-DATA.
  2630         16  MA-MAIL-DATA OCCURS 7.
  2631             20  MA-MAIL-TYPE              PIC X.
  2632                 88  MA-12MO-MAILING           VALUE '1'.
  2633                 88  MA-EXP-MAILING            VALUE '2'.
  2634             20  MA-MAIL-STATUS            PIC X.
  2635                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2636                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2637                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2638             20  MA-MAIL-DATE              PIC XX.
  2639     12  FILLER                            PIC XX.
  2640     12  FILLER                            PIC XX.
  2641*    12  FILLER                            PIC X(30).
  2642******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  50
* EL050.cbl
  2644*    COPY ERCPNDM.
  2645******************************************************************
  2646*                                                                *
  2647*                                                                *
  2648*                            ERCPNDM                             *
  2649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2650*                            VMOD=2.003                          *
  2651*                                                                *
  2652*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2653*                                                                *
  2654*   FILE TYPE = VSAM,KSDS                                        *
  2655*   RECORD SIZE = 374   RECFORM = FIX                            *
  2656*                                                                *
  2657*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2658*   ALTERNATE PATH    = NOT USED                                 *
  2659*                                                                *
  2660*   LOG = YES                                                    *
  2661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2662******************************************************************
  2663*                   C H A N G E   L O G
  2664*
  2665* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2666*-----------------------------------------------------------------
  2667*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2668* EFFECTIVE    NUMBER
  2669*-----------------------------------------------------------------
  2670* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2671* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2672* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2673* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2674******************************************************************
  2675
  2676 01  PENDING-MAILING-DATA.
  2677     12  PM-RECORD-ID                      PIC XX.
  2678         88  VALID-MA-ID                       VALUE 'PM'.
  2679
  2680     12  PM-CONTROL-PRIMARY.
  2681         16  PM-COMPANY-CD                 PIC X.
  2682         16  PM-ENTRY-BATCH                PIC X(6).
  2683         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2684         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2685
  2686     12  FILLER                            PIC X(14).
  2687
  2688     12  PM-ACCESS-CONTROL.
  2689         16  PM-SOURCE-SYSTEM              PIC XX.
  2690             88  PM-FROM-CREDIT                VALUE 'CR'.
  2691             88  PM-FROM-VSI                   VALUE 'VS'.
  2692             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2693             88  PM-FROM-OTHER                 VALUE 'OT'.
  2694         16  PM-RECORD-ADD-DT              PIC XX.
  2695         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2696         16  PM-LAST-MAINT-DT              PIC XX.
  2697         16  PM-LAST-MAINT-BY              PIC XXXX.
  2698         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2699
  2700     12  PM-PROFILE-INFO.
  2701         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  51
* EL050.cbl
  2702         16  PM-QUALIFY-CODE-2             PIC XX.
  2703         16  PM-QUALIFY-CODE-3             PIC XX.
  2704         16  PM-QUALIFY-CODE-4             PIC XX.
  2705         16  PM-QUALIFY-CODE-5             PIC XX.
  2706
  2707         16  PM-INSURED-LAST-NAME          PIC X(15).
  2708         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2709         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2710         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2711         16  PM-INSURED-BIRTH-DT           PIC XX.
  2712         16  PM-INSURED-SEX                PIC X.
  2713             88  PM-SEX-MALE                   VALUE 'M'.
  2714             88  PM-SEX-FEMALE                 VALUE 'F'.
  2715         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2716
  2717         16  PM-ADDRESS-CORRECTED          PIC X.
  2718         16  PM-JOINT-BIRTH-DT             PIC XX.
  2719*        16  FILLER                        PIC X(12).
  2720
  2721         16  PM-ADDRESS-LINE-1             PIC X(30).
  2722         16  PM-ADDRESS-LINE-2             PIC X(30).
  2723         16  PM-CITY-STATE.
  2724             20  PM-CITY                   PIC X(28).
  2725             20  PM-STATE                  PIC XX.
  2726         16  PM-ZIP.
  2727             20  PM-ZIP-CODE.
  2728                 24  PM-ZIP-1              PIC X.
  2729                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2730                 24  FILLER                PIC X(4).
  2731             20  PM-ZIP-PLUS4              PIC X(4).
  2732         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2733             20  PM-CAN-POST1              PIC XXX.
  2734             20  PM-CAN-POST2              PIC XXX.
  2735             20  FILLER                    PIC XXX.
  2736
  2737         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2738         16  pm-city-st-zip-verified       pic x.
  2739         16  FILLER                        PIC XX.
  2740
  2741     12  PM-CRED-BENE-INFO.
  2742         16  PM-CRED-BENE-NAME             PIC X(25).
  2743         16  PM-CRED-BENE-ADDR             PIC X(30).
  2744         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2745         16  PM-CRED-BENE-CTYST.
  2746             20  PM-CRED-BENE-CITY         PIC X(28).
  2747             20  PM-CRED-BENE-STATE        PIC XX.
  2748         16  PM-CRED-BENE-ZIP.
  2749             20  PM-CB-ZIP-CODE.
  2750                 24  PM-CB-ZIP-1           PIC X.
  2751                     88  PM-CB-CANADIAN-POST-CODE
  2752                                  VALUE 'A' THRU 'Z'.
  2753                 24  FILLER                PIC X(4).
  2754             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2755         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2756             20  PM-CB-CAN-POST1           PIC XXX.
  2757             20  PM-CB-CAN-POST2           PIC XXX.
  2758             20  FILLER                    PIC XXX.
  2759     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  52
* EL050.cbl
  2760         16  PM-MAIL-DATA OCCURS 7.
  2761             20  PM-MAIL-TYPE              PIC X.
  2762                 88  PM-12MO-MAILING           VALUE '1'.
  2763                 88  PM-EXP-MAILING            VALUE '2'.
  2764             20  PM-MAIL-STATUS            PIC X.
  2765                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2766                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2767                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2768             20  PM-MAIL-DATE              PIC XX.
  2769     12  FILLER                            PIC XX.
  2770     12  FILLER                            PIC X(12).
  2771*    12  FILLER                            PIC X(30).
  2772
  2773******************************************************************
  2774*                                COPY ERCLOFC.
  2775******************************************************************
  2776*                                                                *
  2777*                                                                *
  2778*                            ERCLOFC                             *
  2779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2780*                            VMOD=2.003                          *
  2781*                                                                *
  2782*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2783*                                                                *
  2784*   FILE TYPE = VSAM,KSDS                                        *
  2785*   RECORD SIZE = 670   RECFORM = FIX                            *
  2786*                                                                *
  2787*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2788*                                                                *
  2789*   LOG = YES                                                    *
  2790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2791*                                                                *
  2792******************************************************************
  2793
  2794 01  LOAN-OFFICER-MASTER.
  2795     12  LO-RECORD-ID                PIC XX.
  2796         88  VALID-LO-ID                VALUE 'LO'.
  2797
  2798     12  LO-CONTROL-PRIMARY.
  2799         16  LO-COMPANY-CD           PIC X.
  2800         16  LO-CARRIER              PIC X.
  2801         16  LO-GROUPING.
  2802             20  LO-GROUPING-PREFIX  PIC XXX.
  2803             20  LO-GROUPING-PRIME   PIC XXX.
  2804         16  LO-STATE                PIC XX.
  2805         16  LO-ACCOUNT.
  2806             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2807             20  LO-ACCOUNT-PRIME    PIC X(6).
  2808         16  LO-OFFICER-CODE         PIC X(5).
  2809
  2810     12  LO-OFFICER-NAME             PIC X(30).
  2811
  2812     12  LO-LAST-MAINT-DT            PIC XX.
  2813     12  LO-LAST-USER                PIC X(4).
  2814     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2815
  2816     12  LO-COMP-CONTROL             PIC X.
  2817             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  53
* EL050.cbl
  2818             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2819     12  LO-DETAIL-CONTROL           PIC X.
  2820             88  LO-PRINT-DETAIL        VALUE 'D'.
  2821             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2822
  2823     12  LO-SV-CARRIER               PIC X.
  2824     12  LO-SV-GROUPING              PIC X(6).
  2825     12  LO-SV-STATE                 PIC XX.
  2826
  2827     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2828     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2829
  2830     12  LO-OFFICER-INFO.
  2831         16  FILLER OCCURS 12 TIMES.
  2832             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2833             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2834             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2835             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2836             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2837             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2838             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2839             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2840     12  FILLER                      PIC X(198).
  2841******************************************************************
  2842*                                COPY ERCPDEF.
  2843******************************************************************
  2844*                                                                *
  2845*                                                                *
  2846*                            ERCPDEF.                            *
  2847*                                                                *
  2848*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2849*                                                                *
  2850*    FILE TYPE = VSAM,KSDS                                       *
  2851*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2852*                                                                *
  2853*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2854*                                                                *
  2855*    LOG = YES                                                   *
  2856*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2857******************************************************************
  2858*                   C H A N G E   L O G
  2859*
  2860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2861*-----------------------------------------------------------------
  2862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2863* EFFECTIVE    NUMBER
  2864*-----------------------------------------------------------------
  2865* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2866* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2867* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2868******************************************************************
  2869 01  PRODUCT-MASTER.
  2870    12  PD-RECORD-ID                 PIC X(02).
  2871        88  VALID-PD-ID                  VALUE 'PD'.
  2872    12  PD-CONTROL-PRIMARY.
  2873        16  PD-COMPANY-CD            PIC X.
  2874        16  PD-STATE                 PIC XX.
  2875        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  54
* EL050.cbl
  2876        16  PD-FILLER                PIC X(7).
  2877        16  PD-BEN-TYPE              PIC X.
  2878        16  PD-BEN-CODE              PIC XX.
  2879        16  PD-PROD-EXP-DT           PIC XX.
  2880    12  FILLER                       PIC X(50).
  2881    12  PD-PRODUCT-DATA OCCURS 8.
  2882        16  PD-PROD-CODE             PIC X.
  2883            88  PD-PROD-LIFE           VALUE 'L'.
  2884            88  PD-PROD-PROP           VALUE 'P'.
  2885            88  PD-PROD-AH             VALUE 'A'.
  2886            88  PD-PROD-IU             VALUE 'I'.
  2887            88  PD-PROD-GAP            VALUE 'G'.
  2888            88  PD-PROD-FAML           VALUE 'F'.
  2889        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2890        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2891        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2892        16  PD-MAX-TERM              PIC S999        COMP-3.
  2893        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2894        16  FILLER                   PIC X.
  2895        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2896        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2897        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2898        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2899        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2900        16  PD-REC-CRIT-PERIOD       PIC 99.
  2901        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2902            20  PD-RECURRING-YN      PIC X.
  2903            20  FILLER               PIC X.
  2904        16  PD-RTW-MOS               PIC 99.
  2905        16  PD-MAX-EXTENSION         PIC 99.
  2906        16  pd-ben-pct               pic sv999 comp-3.
  2907*       16  FILLER                   PIC XX.
  2908    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2909    12  PD-TERM-LIMITS OCCURS 15.
  2910        16  PD-LOW-TERM              PIC S999        COMP-3.
  2911        16  PD-HI-TERM               PIC S999        COMP-3.
  2912*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2913    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2914        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2915        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2916    12  PD-EARN-FACTORS.
  2917        16  FILLER OCCURS 15.
  2918            20  FILLER OCCURS 15.
  2919                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2920    12  PD-PRODUCT-DESC              PIC X(80).
  2921    12  PD-TRUNCATED                 PIC X.
  2922    12  FILLER                       PIC X(59).
  2923    12  PD-MAINT-INFORMATION.
  2924        16  PD-LAST-MAINT-DT         PIC X(02).
  2925        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2926        16  PD-LAST-MAINT-BY         PIC X(04).
  2927*                                COPY ELCSTATE.
  2928******************************************************************
  2929*                                                                *
  2930*                                                                *
  2931*                            ELCSTATE.                           *
  2932*                                                                *
  2933*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  55
* EL050.cbl
  2934*                                                                *
  2935*   FILE TYPE = VSAM,KSDS                                        *
  2936*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2937*                                                                *
  2938*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2939*       ALTERNATE INDEX = NONE                                   *
  2940*                                                                *
  2941*   LOG = YES                                                    *
  2942*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2943******************************************************************
  2944*                   C H A N G E   L O G
  2945*
  2946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2947*-----------------------------------------------------------------
  2948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2949* EFFECTIVE    NUMBER
  2950*-----------------------------------------------------------------
  2951* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2952******************************************************************
  2953*
  2954 01  STATE-FILE.
  2955     12  SF-RECORD-ID                       PIC XX.
  2956         88  VALID-CF-ID                        VALUE 'SF'.
  2957     12  SF-CONTROL-PRIMARY.
  2958         16  SF-COMPANY-ID                  PIC XXX.
  2959         16  SF-CARRIER-CODE                PIC X.
  2960         16  SF-GROUPING                    PIC X(6).
  2961         16  SF-STATE-CODE                  PIC XX.
  2962         16  SF-EXPIRE-DATE                 PIC 9(8).
  2963****************************************************************
  2964*             STATE CONTROLS
  2965****************************************************************
  2966     12  SF-LAST-MAINT-DT                   PIC XX.
  2967     12  SF-LAST-MAINT-BY                   PIC X(4).
  2968     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2969     12  SF-STATE-RT-CONTROLS.
  2970         16  SF-ST-RT-CALC                  PIC X.
  2971     12  SF-ST-TAX-CONTROLS.
  2972         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2973         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2974         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2975     12  SF-ST-REFUND-OPTIONS.
  2976         16  SF-ST-RF-LR-CALC               PIC X.
  2977         16  SF-ST-RF-LL-CALC               PIC X.
  2978         16  SF-ST-RF-LN-CALC               PIC X.
  2979         16  SF-ST-RF-AH-CALC               PIC X.
  2980         16  SF-ST-RF-CP-CALC               PIC X.
  2981     12  SF-ST-UNEARN-PREM-OPTIONS.
  2982         16  SF-ST-LUEP-R78                 PIC X.
  2983         16  SF-ST-LUEP-PRO                 PIC X.
  2984         16  SF-ST-LUEP-ST                  PIC X.
  2985         16  SF-ST-LUEP-DOM                 PIC X.
  2986         16  SF-ST-AUEP-R78                 PIC X.
  2987         16  SF-ST-AUEP-PRO                 PIC X.
  2988         16  SF-ST-AUEP-ST                  PIC X.
  2989         16  SF-ST-AUEP-DOM                 PIC X.
  2990         16  SF-ST-CUEP-R78                 PIC X.
  2991         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  56
* EL050.cbl
  2992         16  SF-ST-CUEP-ST                  PIC X.
  2993         16  SF-ST-CUEP-DOM                 PIC X.
  2994     12  SF-ST-EARN-PREM-OPTIONS.
  2995         16  SF-ST-LEP-R78                  PIC X.
  2996         16  SF-ST-LEP-PRO                  PIC X.
  2997         16  SF-ST-LEP-ST                   PIC X.
  2998         16  SF-ST-LEP-DOM                  PIC X.
  2999         16  SF-ST-AEP-R78                  PIC X.
  3000         16  SF-ST-AEP-PRO                  PIC X.
  3001         16  SF-ST-AEP-ST                   PIC X.
  3002         16  SF-ST-AEP-DOM                  PIC X.
  3003         16  SF-ST-CEP-R78                  PIC X.
  3004         16  SF-ST-CEP-PRO                  PIC X.
  3005         16  SF-ST-CEP-ST                   PIC X.
  3006         16  SF-ST-CEP-DOM                  PIC X.
  3007     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  57
* EL050.cbl
  3009*    COPY ELCCRTT.
  3010******************************************************************
  3011*                                                                *
  3012*                            ELCCRTT.                            *
  3013*                                                                *
  3014*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3015*                                                                *
  3016*   FILE TYPE = VSAM,KSDS                                        *
  3017*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3018*                                                                *
  3019*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3020*                                                                *
  3021*   LOG = YES                                                    *
  3022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3023******************************************************************
  3024*                   C H A N G E   L O G
  3025*
  3026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3027*-----------------------------------------------------------------
  3028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3029* EFFECTIVE    NUMBER
  3030*-----------------------------------------------------------------
  3031* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3032* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3033* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3034* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3035* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3037* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3038* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3039* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3040******************************************************************
  3041
  3042 01  CERTIFICATE-TRAILERS.
  3043     12  CS-RECORD-ID                      PIC XX.
  3044         88  VALID-CS-ID                      VALUE 'CS'.
  3045
  3046     12  CS-CONTROL-PRIMARY.
  3047         16  CS-COMPANY-CD                 PIC X.
  3048         16  CS-CARRIER                    PIC X.
  3049         16  CS-GROUPING                   PIC X(6).
  3050         16  CS-STATE                      PIC XX.
  3051         16  CS-ACCOUNT                    PIC X(10).
  3052         16  CS-CERT-EFF-DT                PIC XX.
  3053         16  CS-CERT-NO.
  3054             20  CS-CERT-PRIME             PIC X(10).
  3055             20  CS-CERT-SFX               PIC X.
  3056         16  CS-TRAILER-TYPE               PIC X.
  3057             88  COMM-TRLR           VALUE 'A'.
  3058             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3059             88  CERT-DATA-TRLR      VALUE 'C'.
  3060
  3061     12  CS-DATA-AREA                      PIC X(516).
  3062
  3063     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3064         16  CS-BANK-COMMISSION-AREA.
  3065             20  CS-BANK-COMMS       OCCURS 10.
  3066                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  58
* EL050.cbl
  3067                 24  CS-COM-TYP            PIC X.
  3068                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3069                 24  CS-RECALC-LV-INDIC    PIC X.
  3070                 24  FILLER                PIC X(10).
  3071         16  FILLER                        PIC X(256).
  3072
  3073     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3074****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3075         16  CS-MB-CLAIM-DATA OCCURS 24.
  3076             20  CS-CLAIM-NO               PIC X(7).
  3077             20  CS-CLAIM-TYPE             PIC X.
  3078                 88  CS-AH-CLM               VALUE 'A'.
  3079                 88  CS-IU-CLM               VALUE 'I'.
  3080                 88  CS-GP-CLM               VALUE 'G'.
  3081                 88  CS-LF-CLM               VALUE 'L'.
  3082                 88  CS-PR-CLM               VALUE 'P'.
  3083                 88  CS-FL-CLM               VALUE 'F'.
  3084             20  CS-INSURED-TYPE           PIC X.
  3085                 88  CS-PRIM-INSURED          VALUE 'P'.
  3086                 88  CS-CO-BORROWER           VALUE 'C'.
  3087             20  CS-BENEFIT-PERIOD         PIC 99.
  3088             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3089             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3090             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3091         16  FILLER                        PIC X(12).
  3092     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3093         16  CS-VIN-NUMBER                 PIC X(17).
  3094         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3095         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3096         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3097         16  cs-agent-name.
  3098             20  cs-agent-fname            pic x(20).
  3099             20  cs-agent-mi               pic x.
  3100             20  cs-agent-lname            pic x(25).
  3101         16  cs-license-no                 pic x(15).
  3102         16  cs-npn-number                 pic x(10).
  3103         16  cs-agent-edit-status          pic x.
  3104             88  cs-ae-refer-to-manager      value 'M'.
  3105             88  cs-ae-cover-sheet           value 'C'.
  3106             88  cs-ae-sig-form              value 'S'.
  3107             88  cs-ae-verified              value 'V'.
  3108             88  cs-unidentified-signature   value 'U'.
  3109             88  cs-cert-returned            value 'R'.
  3110             88  cs-accept-no-commission     value 'N'.
  3111         16  cs-year                       pic 9999.
  3112         16  cs-make                       pic x(20).
  3113         16  cs-model                      pic x(20).
  3114         16  cs-future                     pic x(20).
  3115         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3116         16  FILLER                        PIC X(356). *> was 420
  3117*        16  FILLER                        PIC X(496).
  3118*    COPY ELCCRTO.
  3119******************************************************************
  3120*                                                                *
  3121*                            ELCCRTO.                            *
  3122*                                                                *
  3123*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3124*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  59
* EL050.cbl
  3125*   FILE TYPE = VSAM,KSDS                                        *
  3126*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3127*                                                                *
  3128*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3129*                                                                *
  3130*   LOG = YES                                                    *
  3131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3132******************************************************************
  3133*                   C H A N G E   L O G
  3134*
  3135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3136*-----------------------------------------------------------------
  3137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3138* EFFECTIVE    NUMBER
  3139*-----------------------------------------------------------------
  3140* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3141* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3142* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3143* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3144* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3145******************************************************************
  3146 01  ORIGINAL-CERTIFICATE.
  3147     12  OC-RECORD-ID                      PIC XX.
  3148         88  VALID-OC-ID                      VALUE 'OC'.
  3149     12  OC-CONTROL-PRIMARY.
  3150         16  OC-COMPANY-CD                 PIC X.
  3151         16  OC-CARRIER                    PIC X.
  3152         16  OC-GROUPING                   PIC X(6).
  3153         16  OC-STATE                      PIC XX.
  3154         16  OC-ACCOUNT                    PIC X(10).
  3155         16  OC-CERT-EFF-DT                PIC XX.
  3156         16  OC-CERT-NO.
  3157             20  OC-CERT-PRIME             PIC X(10).
  3158             20  OC-CERT-SFX               PIC X.
  3159         16  OC-RECORD-TYPE                PIC X.
  3160         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3161     12  OC-LAST-MAINT-DT                  PIC XX.
  3162     12  OC-LAST-MAINT-BY                  PIC X(4).
  3163     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3164     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3165     12  FILLER                            PIC X(49).
  3166     12  OC-ORIG-REC.
  3167         16  OC-INS-LAST-NAME              PIC X(15).
  3168         16  OC-INS-FIRST-NAME             PIC X(10).
  3169         16  OC-INS-MIDDLE-INIT            PIC X.
  3170         16  OC-INS-AGE                    PIC S999     COMP-3.
  3171         16  OC-JNT-LAST-NAME              PIC X(15).
  3172         16  OC-JNT-FIRST-NAME             PIC X(10).
  3173         16  OC-JNT-MIDDLE-INIT            PIC X.
  3174         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3175         16  OC-LF-BENCD                   PIC XX.
  3176         16  OC-LF-TERM                    PIC S999      COMP-3.
  3177         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3178         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3179         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3180         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3181         16  OC-LF-EXP-DT                  PIC XX.
  3182         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  60
* EL050.cbl
  3183         16  OC-LF-CANCEL-DT               PIC XX.
  3184         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3185         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3186         16  OC-AH-BENCD                   PIC XX.
  3187         16  OC-AH-TERM                    PIC S999      COMP-3.
  3188         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3189         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3190         16  OC-AH-EXP-DT                  PIC XX.
  3191         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3192         16  OC-AH-CP                      PIC 99.
  3193         16  OC-AH-CANCEL-DT               PIC XX.
  3194         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3195         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3196         16  OC-CRED-BENE-NAME             PIC X(25).
  3197         16  OC-1ST-PMT-DT                 PIC XX.
  3198         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3199         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3200         16  OC-ISSUE-TRAN-IND             PIC X.
  3201         16  OC-CANCEL-TRAN-IND            PIC X.
  3202         16  FILLER                        PIC X(211).
  3203
  3204     12  FILLER                            PIC X(50).
  3205******************************************************************
  3206
  3207*    COPY ELCDATE.
  3208******************************************************************
  3209*                                                                *
  3210*                                                                *
  3211*                            ELCDATE.                            *
  3212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3213*                            VMOD=2.003
  3214*                                                                *
  3215*                                                                *
  3216*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3217*                 LENGTH = 200                                   *
  3218******************************************************************
  3219
  3220 01  DATE-CONVERSION-DATA.
  3221     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3222     12  DC-OPTION-CODE                PIC X.
  3223         88  BIN-TO-GREG                VALUE ' '.
  3224         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3225         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3226         88  YMD-GREG-TO-BIN            VALUE '3'.
  3227         88  MDY-GREG-TO-BIN            VALUE '4'.
  3228         88  JULIAN-TO-BIN              VALUE '5'.
  3229         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3230         88  FIND-CENTURY               VALUE '7'.
  3231         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3232         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3233         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3234         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3235         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3236         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3237         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3238         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3239         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3240         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  61
* EL050.cbl
  3241         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3242         88  BIN-3-TO-GREG              VALUE 'I'.
  3243         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3244         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3245         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3246         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3247         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3248         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3249         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3250         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3251         88  THREE-CHARACTER-BIN
  3252                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3253         88  GREGORIAN-TO-BIN
  3254                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3255         88  BIN-TO-GREGORIAN
  3256                  VALUES ' ' '1' 'I' '8' 'G'.
  3257         88  JULIAN-TO-BINARY
  3258                  VALUES '5' 'C' 'E' 'F'.
  3259     12  DC-ERROR-CODE                 PIC X.
  3260         88  NO-CONVERSION-ERROR        VALUE ' '.
  3261         88  DATE-CONVERSION-ERROR
  3262                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3263         88  DATE-IS-ZERO               VALUE '1'.
  3264         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3265         88  DATE-IS-INVALID            VALUE '3'.
  3266         88  DATE1-GREATER-DATE2        VALUE '4'.
  3267         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3268         88  DATE-INVALID-OPTION        VALUE '9'.
  3269         88  INVALID-CENTURY            VALUE 'A'.
  3270         88  ONLY-CENTURY               VALUE 'B'.
  3271         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3272         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3273     12  DC-END-OF-MONTH               PIC X.
  3274         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3275     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3276         88  USE-NORMAL-PROCESS         VALUE ' '.
  3277         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3278         88  ADJUST-UP-100-YRS          VALUE '2'.
  3279     12  FILLER                        PIC X.
  3280     12  DC-CONVERSION-DATES.
  3281         16  DC-BIN-DATE-1             PIC XX.
  3282         16  DC-BIN-DATE-2             PIC XX.
  3283         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3284         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3285                       DC-GREG-DATE-1-EDIT.
  3286             20  DC-EDIT1-MONTH        PIC 99.
  3287             20  SLASH1-1              PIC X.
  3288             20  DC-EDIT1-DAY          PIC 99.
  3289             20  SLASH1-2              PIC X.
  3290             20  DC-EDIT1-YEAR         PIC 99.
  3291         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3292         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3293                     DC-GREG-DATE-2-EDIT.
  3294             20  DC-EDIT2-MONTH        PIC 99.
  3295             20  SLASH2-1              PIC X.
  3296             20  DC-EDIT2-DAY          PIC 99.
  3297             20  SLASH2-2              PIC X.
  3298             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  62
* EL050.cbl
  3299         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3300         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3301                     DC-GREG-DATE-1-YMD.
  3302             20  DC-YMD-YEAR           PIC 99.
  3303             20  DC-YMD-MONTH          PIC 99.
  3304             20  DC-YMD-DAY            PIC 99.
  3305         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3306         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3307                      DC-GREG-DATE-1-MDY.
  3308             20  DC-MDY-MONTH          PIC 99.
  3309             20  DC-MDY-DAY            PIC 99.
  3310             20  DC-MDY-YEAR           PIC 99.
  3311         16  DC-GREG-DATE-1-ALPHA.
  3312             20  DC-ALPHA-MONTH        PIC X(10).
  3313             20  DC-ALPHA-DAY          PIC 99.
  3314             20  FILLER                PIC XX.
  3315             20  DC-ALPHA-CENTURY.
  3316                 24 DC-ALPHA-CEN-N     PIC 99.
  3317             20  DC-ALPHA-YEAR         PIC 99.
  3318         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3319         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3320         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3321         16  DC-JULIAN-DATE            PIC 9(05).
  3322         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3323                                       PIC 9(05).
  3324         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3325             20  DC-JULIAN-YEAR        PIC 99.
  3326             20  DC-JULIAN-DAYS        PIC 999.
  3327         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3328         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3329         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3330     12  DATE-CONVERSION-VARIBLES.
  3331         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3332         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3333             20  FILLER                PIC 9(3).
  3334             20  HOLD-CEN-1-CCYY.
  3335                 24  HOLD-CEN-1-CC     PIC 99.
  3336                 24  HOLD-CEN-1-YY     PIC 99.
  3337             20  HOLD-CEN-1-MO         PIC 99.
  3338             20  HOLD-CEN-1-DA         PIC 99.
  3339         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3340             20  HOLD-CEN-1-R-MO       PIC 99.
  3341             20  HOLD-CEN-1-R-DA       PIC 99.
  3342             20  HOLD-CEN-1-R-CCYY.
  3343                 24  HOLD-CEN-1-R-CC   PIC 99.
  3344                 24  HOLD-CEN-1-R-YY   PIC 99.
  3345             20  FILLER                PIC 9(3).
  3346         16  HOLD-CENTURY-1-X.
  3347             20  FILLER                PIC X(3)  VALUE SPACES.
  3348             20  HOLD-CEN-1-X-CCYY.
  3349                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3350                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3351             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3352             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3353         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3354             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3355             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3356             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  63
* EL050.cbl
  3357                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3358                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3359             20  FILLER                PIC XXX.
  3360         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3361         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3362         16  DC-JULIAN-DATE-1          PIC 9(07).
  3363         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3364             20  DC-JULIAN-1-CCYY.
  3365                 24  DC-JULIAN-1-CC    PIC 99.
  3366                 24  DC-JULIAN-1-YR    PIC 99.
  3367             20  DC-JULIAN-DA-1        PIC 999.
  3368         16  DC-JULIAN-DATE-2          PIC 9(07).
  3369         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3370             20  DC-JULIAN-2-CCYY.
  3371                 24  DC-JULIAN-2-CC    PIC 99.
  3372                 24  DC-JULIAN-2-YR    PIC 99.
  3373             20  DC-JULIAN-DA-2        PIC 999.
  3374         16  DC-GREG-DATE-A-EDIT.
  3375             20  DC-EDITA-MONTH        PIC 99.
  3376             20  SLASHA-1              PIC X VALUE '/'.
  3377             20  DC-EDITA-DAY          PIC 99.
  3378             20  SLASHA-2              PIC X VALUE '/'.
  3379             20  DC-EDITA-CCYY.
  3380                 24  DC-EDITA-CENT     PIC 99.
  3381                 24  DC-EDITA-YEAR     PIC 99.
  3382         16  DC-GREG-DATE-B-EDIT.
  3383             20  DC-EDITB-MONTH        PIC 99.
  3384             20  SLASHB-1              PIC X VALUE '/'.
  3385             20  DC-EDITB-DAY          PIC 99.
  3386             20  SLASHB-2              PIC X VALUE '/'.
  3387             20  DC-EDITB-CCYY.
  3388                 24  DC-EDITB-CENT     PIC 99.
  3389                 24  DC-EDITB-YEAR     PIC 99.
  3390         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3391         16  DC-GREG-DATE-CYMD-R REDEFINES
  3392                              DC-GREG-DATE-CYMD.
  3393             20  DC-CYMD-CEN           PIC 99.
  3394             20  DC-CYMD-YEAR          PIC 99.
  3395             20  DC-CYMD-MONTH         PIC 99.
  3396             20  DC-CYMD-DAY           PIC 99.
  3397         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3398         16  DC-GREG-DATE-MDCY-R REDEFINES
  3399                              DC-GREG-DATE-MDCY.
  3400             20  DC-MDCY-MONTH         PIC 99.
  3401             20  DC-MDCY-DAY           PIC 99.
  3402             20  DC-MDCY-CEN           PIC 99.
  3403             20  DC-MDCY-YEAR          PIC 99.
  3404    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3405        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3406    12  DC-EL310-DATE                  PIC X(21).
  3407    12  FILLER                         PIC X(28).
  3408
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  64
* EL050.cbl
  3410*    COPY ELCCALC.
  3411******************************************************************
  3412*                                                                *
  3413*                           ELCCALC.                            *
  3414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3415*                            VMOD=2.025                          *
  3416*                                                                *
  3417*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3418*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3419*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3420*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3421*                                                                *
  3422*  PASSED TO ELRTRM                                              *
  3423*  -----------------                                             *
  3424*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3425*  ORIGINAL TERM                                                 *
  3426*  BEGINNING DATE                                                *
  3427*  ENDING DATE                                                   *
  3428*  COMPANY I.D.                                                  *
  3429*  ACCOUNT MASTER USER FIELD                                     *
  3430*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3431*  FREE LOOK DAYS                                                *
  3432*                                                                *
  3433*  RETURNED FROM ELRTRM                                          *
  3434*  ---------------------                                         *
  3435*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3436*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3437*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3438*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3439*----------------------------------------------------------------*
  3440*  PASSED TO ELRAMT                                              *
  3441*  ----------------                                              *
  3442*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3443*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3444*  ORIGINAL AMOUNT                                               *
  3445*  ALTERNATE BENEFIT (BALLON)                                    *
  3446*  A.P.R. - NET PAY ONLY                                         *
  3447*  METHOD
  3448*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3449*  COMPANY I.D.                                                  *
  3450*  BENEFIT TYPE                                                  *
  3451*                                                                *
  3452*  RETURNED FROM ELRAMT                                          *
  3453*  --------------------                                          *
  3454*  REMAINING AMOUNT 1 - CURRENT                                  *
  3455*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3456*  REMAINING AMOUNT FACTOR
  3457*----------------------------------------------------------------*
  3458*  PASSED TO ELRESV                                              *
  3459*  -----------------                                             *
  3460*  CERTIFICATE EFFECTIVE DATE                                    *
  3461*  VALUATION DATE                                                *
  3462*  PAID THRU DATE                                                *
  3463*  BENEFIT                                                       *
  3464*  INCURRED DATE                                                 *
  3465*  REPORTED DATE                                                 *
  3466*  ISSUE AGE                                                     *
  3467*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  65
* EL050.cbl
  3468*  CDT PERCENT                                                   *
  3469*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3470* *CLAIM TYPE (LIFE, A/H)                                        *
  3471* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3472* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3473*                                                                *
  3474*  RETURNED FROM ELRESV                                          *
  3475*  --------------------                                          *
  3476*  CDT TABLE USED                                                *
  3477*  CDT FACTOR USED                                               *
  3478*  PAY TO CURRENT RESERVE                                        *
  3479*  I.B.N.R. - A/H ONLY                                           *
  3480*  FUTURE (ACCRUED) AH ONLY                                      *
  3481*----------------------------------------------------------------*
  3482*  PASSED TO ELRATE                                              *
  3483*  ----------------                                              *
  3484*  CERT ISSUE DATE                                               *
  3485*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3486*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3487*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3488*  STATE CODE (CLIENT DEFINED)                                   *
  3489*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3490*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3491*  DEVIATION CODE                                                *
  3492*  ISSUE AGE                                                     *
  3493*  ORIGINAL BENEFIT AMOUNT                                       *
  3494*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3495*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3496*  BENEFIT KIND (LIFE OR A/H)                                    *
  3497*  A.P.R.                                                        *
  3498*  METHOD
  3499*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3500*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3501*  COMPANY I.D. (3 CHARACTER)                                    *
  3502*  BENEFIT CODE                                                  *
  3503*  BENEFIT OVERRIDE CODE                                         *
  3504*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3505*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3506*  JOINT INDICATOR (CSL ONLY)                                    *
  3507*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3508*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3509*                                                                *
  3510*  RETURNED FROM ELRATE                                          *
  3511*  --------------------                                          *
  3512*  CALCULATED PREMIUM                                            *
  3513*  PREMIUM RATE                                                  *
  3514*  MORTALITY CODE                                                *
  3515*  MAX ATTAINED AGE                                              *
  3516*  MAX AGE                                                       *
  3517*  MAX TERM                                                      *
  3518*  MAX MONTHLY BENEFIT                                           *
  3519*  MAX TOTAL BENIFIT                                             *
  3520*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3521*----------------------------------------------------------------*
  3522*  PASSED TO ELRFND                                              *
  3523*  ----------------                                              *
  3524*  CERT ISSUE DATE                                               *
  3525*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  66
* EL050.cbl
  3526*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3528*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3529*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3530*  STATE CODE (CLIENT DEFINED)                                   *
  3531*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3532*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3533*  DEVIATION CODE                                                *
  3534*  ISSUE AGE                                                     *
  3535*  ORIGINAL BENEFIT AMOUNT                                       *
  3536*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3537*  PROCESS TYPE (CANCEL)                                         *
  3538*  BENEFIT KIND (LIFE OR A/H)                                    *
  3539*  A.P.R.                                                        *
  3540*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3541*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3542*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3543*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3544*  COMPANY I.D. (3 CHARACTER)                                    *
  3545*  BENEFIT CODE                                                  *
  3546*  BENEFIT OVERRIDE CODE                                         *
  3547*                                                                *
  3548*  RETURNED FROM ELRFND                                          *
  3549*  --------------------                                          *
  3550*  CALCULATED REFUND                                             *
  3551*----------------------------------------------------------------*
  3552*  PASSED TO ELEARN                                              *
  3553*  ----------------                                              *
  3554*  CERT ISSUE DATE                                               *
  3555*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3556*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3557*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3558*  STATE CODE (CLIENT DEFINED)                                   *
  3559*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3560*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3561*  DEVIATION CODE                                                *
  3562*  ISSUE AGE                                                     *
  3563*  ORIGINAL BENEFIT AMOUNT                                       *
  3564*  BENEFIT KIND (LIFE OR A/H)                                    *
  3565*  A.P.R.                                                        *
  3566*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3567*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3568*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3569*  COMPANY I.D. (3 CHARACTER)                                    *
  3570*  BENEFIT CODE                                                  *
  3571*  BENEFIT OVERRIDE CODE                                         *
  3572*                                                                *
  3573*  RETURNED FROM ELEARN                                          *
  3574*  --------------------                                          *
  3575*  INDICATED  EARNINGS                                           *
  3576*----------------------------------------------------------------*
  3577*                 LENGTH = 450                                   *
  3578*                                                                *
  3579******************************************************************
  3580******************************************************************
  3581*                   C H A N G E   L O G
  3582*
  3583* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  67
* EL050.cbl
  3584*-----------------------------------------------------------------
  3585*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3586* EFFECTIVE    NUMBER
  3587*-----------------------------------------------------------------
  3588* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3589* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3590* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3591* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3592* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3593* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3594* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3595* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3596* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3597* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3598* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3599******************************************************************
  3600
  3601 01  CALCULATION-PASS-AREA.
  3602     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3603                                     COMP.
  3604
  3605     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3606       88  NO-CP-ERROR                             VALUE ZERO.
  3607       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3608                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3609       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3610       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3611       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3612       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3613       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3614       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3615       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3616       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3617       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3618       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3619       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3620       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3621       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3622       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3623       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3624       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3625       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3626
  3627     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3628       88  NO-CP-ERROR-2                           VALUE ZERO.
  3629***********************  INPUT AREAS ****************************
  3630
  3631     12  CP-CALCULATION-AREA.
  3632         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3633         16  CP-CERT-EFF-DT        PIC XX.
  3634         16  CP-VALUATION-DT       PIC XX.
  3635         16  CP-PAID-THRU-DT       PIC XX.
  3636         16  CP-BENEFIT-TYPE       PIC X.
  3637           88  CP-AH                               VALUE 'A' 'D'
  3638                                                   'I' 'U'.
  3639           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3640           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3641         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  68
* EL050.cbl
  3642         16  CP-REPORTED-DT        PIC XX.
  3643         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3644         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3645         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-CDT-METHOD         PIC X.
  3650           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3651           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3652           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3653         16  CP-CLAIM-TYPE         PIC X.
  3654           88  CP-AH-CLAIM                         VALUE 'A'.
  3655           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3656         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3667                                     COMP-3.
  3668         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3669                                     COMP-3.
  3670         16  CP-REM-TERM-METHOD    PIC X.
  3671           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3672           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3673           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3674           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3675           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3676           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3677           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3678         16  CP-EARNING-METHOD     PIC X.
  3679           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3680           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3681           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3682           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3683           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3684           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3685           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3686           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3687           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3688           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3689           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3690           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3691           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3692           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3693         16  CP-PROCESS-TYPE       PIC X.
  3694           88  CP-CLAIM                            VALUE '1'.
  3695           88  CP-CANCEL                           VALUE '2'.
  3696           88  CP-ISSUE                            VALUE '3'.
  3697         16  CP-SPECIAL-CALC-CD    PIC X.
  3698           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3699           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  69
* EL050.cbl
  3700           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3701           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3702           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3703           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3704           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3705           88  CP-FARM-PLAN                    VALUE 'F'.
  3706           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3707           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3708           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3709           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3710           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3711           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3712           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3713           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3714           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3715           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3716                                                     'W' 'X'.
  3717           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3718           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3719           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3720           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3721           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3722           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3723           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3724           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3725           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3726           88  CP-CSL-METH-1                   VALUE '5'.
  3727           88  CP-CSL-METH-2                   VALUE '6'.
  3728           88  CP-CSL-METH-3                   VALUE '7'.
  3729           88  CP-CSL-METH-4                   VALUE '8'.
  3730
  3731         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3734         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3735         16  CP-STATE              PIC XX          VALUE SPACE.
  3736         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3737         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3738           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3739               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3740         16  CP-R78-OPTION         PIC X.
  3741           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3742           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3743
  3744         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3745         16  CP-IBNR-RESERVE-SW    PIC X.
  3746         16  CP-CLAIM-STATUS       PIC X.
  3747         16  CP-RATE-FILE          PIC X.
  3748         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3749                                     COMP-3.
  3750
  3751         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3752         16  CP-AH-OVERRIDE-CODE   PIC X.
  3753
  3754         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3757                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  70
* EL050.cbl
  3758         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3765                                  PIC S9(7)V99 COMP-3.
  3766
  3767         16  CP-PAID-FROM-DATE     PIC X(02).
  3768         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3769         16  CP-EXT-DAYS-CALC      PIC X.
  3770           88  CP-EXT-NO-CHG                   VALUE ' '.
  3771           88  CP-EXT-CHG-LF                   VALUE '1'.
  3772           88  CP-EXT-CHG-AH                   VALUE '2'.
  3773           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3774         16  CP-DOMICILE-STATE     PIC XX.
  3775         16  CP-CARRIER            PIC X.
  3776         16  CP-REIN-FLAG          PIC X.
  3777         16  CP-REM-TRM-CALC-OPTION PIC X.
  3778           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3779                      '2' '3' '4' '5'.
  3780           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3781           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3782           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3783           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3784           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3785           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3786           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3787           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3788         16  CP-SIG-SWITCH         PIC X.
  3789         16  CP-RATING-METHOD      PIC X.
  3790           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3791           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3792           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3793           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3794           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3795           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3796           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3797           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3798           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3799         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3800                                     COMP-3.
  3801         16  CP-BEN-CATEGORY       PIC X.
  3802         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3803         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3804                                   PIC S99V9(5) COMP-3.
  3805         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3806         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3807                                   PIC S99V9(5) COMP-3.
  3808         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3809         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3810         16  CP-EXPIRE-DT          PIC XX.
  3811         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3812         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3813         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3814         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3815         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  71
* EL050.cbl
  3816             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3817             88  CP-CALC-CLP              VALUE 'C'.
  3818         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3819         16  CP-CANCEL-REASON      PIC X.
  3820         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3821         16  CP-PMT-MODE           PIC X.
  3822         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3823         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3824         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3825         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3826         16  FILLER                PIC X.
  3827
  3828***************    OUTPUT FROM ELRESV   ************************
  3829
  3830         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3831
  3832         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  FILLER                PIC X(09).
  3841***************    OUTPUT FROM ELRTRM   *************************
  3842
  3843         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3850                                     COMP-3.
  3851         16  FILLER                PIC X(12).
  3852
  3853***************    OUTPUT FROM ELRAMT   *************************
  3854
  3855         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3858                                     COMP-3.
  3859         16  FILLER                PIC X(12).
  3860
  3861***************    OUTPUT FROM ELRATE   *************************
  3862
  3863         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-MORTALITY-CODE     PIC X(4).
  3868         16  CP-RATE-EDIT-FLAG     PIC X.
  3869             88  CP-RATES-NEED-APR                  VALUE '1'.
  3870         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3871                                     COMP-3.
  3872         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3873         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  72
* EL050.cbl
  3874         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3875                                   PIC S9(7)V99 COMP-3.
  3876         16  FILLER                PIC X(07).
  3877
  3878***************    OUTPUT FROM ELRFND   *************************
  3879
  3880         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-REFUND-TYPE-USED   PIC X.
  3883           88  CP-R-AS-R78                         VALUE '1'.
  3884           88  CP-R-AS-PRORATA                     VALUE '2'.
  3885           88  CP-R-AS-CALIF                       VALUE '3'.
  3886           88  CP-R-AS-TEXAS                       VALUE '4'.
  3887           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3888           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3889           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3890           88  CP-R-AS-MEAN                        VALUE '8'.
  3891           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3892           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3893           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3894           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3895           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3896           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3897         16  FILLER                PIC X(12).
  3898
  3899***************    OUTPUT FROM ELEARN   *************************
  3900
  3901         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3902                                     COMP-3.
  3903         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-EARNING-TYPE-USED  PIC X.
  3914           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3915           88  CP-E-AS-R78                         VALUE '1'.
  3916           88  CP-E-AS-PRORATA                     VALUE '2'.
  3917           88  CP-E-AS-TEXAS                       VALUE '4'.
  3918           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3919           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3920           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3921           88  CP-E-AS-MEAN                        VALUE '8'.
  3922           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3923         16  FILLER                PIC X(12).
  3924
  3925***************    OUTPUT FROM ELPMNT   *************************
  3926
  3927         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3928                                     COMP-3.
  3929         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3930                                     COMP-3.
  3931         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  73
* EL050.cbl
  3932
  3933***************   MISC WORK AREAS    *****************************
  3934         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3945                                     COMP-3.
  3946         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3947             88  OPEN-RATE-FILE                   VALUE 'O'.
  3948             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3949             88  IO-ERROR                         VALUE 'E'.
  3950
  3951         16  CP-FIRST-PAY-DATE     PIC XX.
  3952
  3953         16  CP-JOINT-INDICATOR    PIC X.
  3954
  3955         16  CP-RESERVE-REMAINING-TERM
  3956                                   PIC S9(4)V9    VALUE ZERO
  3957                                     COMP-3.
  3958
  3959         16  CP-INSURED-BIRTH-DT   PIC XX.
  3960
  3961         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3962                                     COMP-3.
  3963
  3964         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3965                                     COMP-3.
  3966
  3967         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3968                                     COMP-3.
  3969
  3970         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3971                                     COMP-3.
  3972
  3973         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3974                                     COMP-3.
  3975
  3976         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3977                                     COMP-3.
  3978
  3979         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3980                                     COMP-3.
  3981
  3982         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3983             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3984
  3985         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3986                                     COMP-3.
  3987         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3988                                     COMP-3.
  3989         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  74
* EL050.cbl
  3990         16  cp-extra-periods      pic 9 value zeros.
  3991         16  cp-net-only-state     pic x value spaces.
  3992         16  FILLER                PIC X(13).
  3993******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  75
* EL050.cbl
  3995******************************************************************
  3996*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3997*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3998*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3999*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4000*** MODIFICATION.                                              ***
  4001*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4002*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4003******************************************************************
  4004*    COPY ERCPNDB.
  4005******************************************************************
  4006*                                                                *
  4007*                                                                *
  4008*                            ERCPNDB.                            *
  4009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4010*                            VMOD=2.025                          *
  4011*                                                                *
  4012*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4013*                                                                *
  4014******************************************************************
  4015*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4016*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4017******************************************************************
  4018*                                                                *
  4019*                                                                *
  4020*   FILE TYPE = VSAM,KSDS                                        *
  4021*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4022*                                                                *
  4023*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4024*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4025*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4026*                                                 RKP=13,LEN=36  *
  4027*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4028*                                      AND CHG-SEQ.)             *
  4029*                                                RKP=49,LEN=11   *
  4030*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4031*                                      AND CHG-SEQ.)             *
  4032*                                                RKP=60,LEN=15   *
  4033*                                                                *
  4034*   LOG = NO                                                     *
  4035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4036******************************************************************
  4037******************************************************************
  4038*                   C H A N G E   L O G
  4039*
  4040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4041*-----------------------------------------------------------------
  4042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4043* EFFECTIVE    NUMBER
  4044*-----------------------------------------------------------------
  4045* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4046* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4047* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4048* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4049* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4050* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4051* 032306                   PEMA  ADD BOW LOAN NUMBER
  4052* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  76
* EL050.cbl
  4053* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4054* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4055* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4056* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4057* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4058* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4059* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4060* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4061* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4062* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4063******************************************************************
  4064
  4065 01  PENDING-BUSINESS.
  4066     12  PB-RECORD-ID                     PIC XX.
  4067         88  VALID-PB-ID                        VALUE 'PB'.
  4068
  4069     12  PB-CONTROL-PRIMARY.
  4070         16  PB-COMPANY-CD                PIC X.
  4071         16  PB-ENTRY-BATCH               PIC X(6).
  4072         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4073         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4074
  4075     12  PB-CONTROL-BY-ACCOUNT.
  4076         16  PB-COMPANY-CD-A1             PIC X.
  4077         16  PB-CARRIER                   PIC X.
  4078         16  PB-GROUPING.
  4079             20  PB-GROUPING-PREFIX       PIC XXX.
  4080             20  PB-GROUPING-PRIME        PIC XXX.
  4081         16  PB-STATE                     PIC XX.
  4082         16  PB-ACCOUNT.
  4083             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4084             20  PB-ACCOUNT-PRIME         PIC X(6).
  4085         16  PB-CERT-EFF-DT               PIC XX.
  4086         16  PB-CERT-NO.
  4087             20  PB-CERT-PRIME            PIC X(10).
  4088             20  PB-CERT-SFX              PIC X.
  4089         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4090
  4091         16  PB-RECORD-TYPE               PIC X.
  4092             88  PB-MAILING-DATA                VALUE '0'.
  4093             88  PB-ISSUE                       VALUE '1'.
  4094             88  PB-CANCELLATION                VALUE '2'.
  4095             88  PB-BATCH-TRAILER               VALUE '9'.
  4096
  4097     12  PB-CONTROL-BY-ORIG-BATCH.
  4098         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4099         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4100         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4101         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4102
  4103     12  PB-CONTROL-BY-CSR.
  4104         16  PB-CSR-COMPANY-CD            PIC X.
  4105         16  PB-CSR-ID                    PIC X(4).
  4106         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4107         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4108         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4109******************************************************************
  4110*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  77
* EL050.cbl
  4111******************************************************************
  4112
  4113     12  PB-LAST-MAINT-DT                 PIC XX.
  4114     12  PB-LAST-MAINT-BY                 PIC X(4).
  4115     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4116
  4117     12  PB-RECORD-BODY                   PIC X(375).
  4118
  4119     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4120         16  PB-CERT-ORIGIN               PIC X.
  4121             88  CLASIC-CREATED-CERT         VALUE '1'.
  4122         16  PB-I-NAME.
  4123             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4124             20  PB-I-INSURED-FIRST-NAME.
  4125                 24  PB-I-INSURED-1ST-INIT PIC X.
  4126                 24  FILLER                PIC X(9).
  4127             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4128         16  PB-I-AGE                     PIC S99   COMP-3.
  4129         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4130         16  PB-I-BIRTHDAY                PIC XX.
  4131         16  PB-I-INSURED-SEX             PIC X.
  4132             88  PB-SEX-MALE     VALUE 'M'.
  4133             88  PB-SEX-FEMALE   VALUE 'F'.
  4134
  4135         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4136         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4137         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4138         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4139         16  PB-I-SKIP-CODE               PIC X.
  4140             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4141             88  PB-SKIP-JULY              VALUE '1'.
  4142             88  PB-SKIP-AUGUST            VALUE '2'.
  4143             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4144             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4145             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4146             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4147             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4148             88  PB-SKIP-JUNE              VALUE '8'.
  4149             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4150             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4151             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4152         16  PB-I-TERM-TYPE               PIC X.
  4153             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4154             88  PB-PAID-WEEKLY            VALUE 'W'.
  4155             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4156             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4157             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4158         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4159         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4160         16  PB-I-DATA-ENTRY-SW           PIC X.
  4161             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4162             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4163             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4164             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4165         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4166         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4167*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4168         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  78
* EL050.cbl
  4169         16  FILLER                       PIC X.
  4170
  4171         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4172             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4173             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4174                                                   '90' THRU '99'.
  4175         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4176                                          PIC XX.
  4177         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4178         16  PB-I-AMOUNT-FINANCED REDEFINES
  4179                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4180         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4181         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4182                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4183         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4184         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4185         16  PB-I-CLP-AMOUNT REDEFINES
  4186                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4187         16  PB-I-LF-CALC-FLAG            PIC X.
  4188             88 PB-COMP-LF-PREM               VALUE '?'.
  4189         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4190         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4191         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4192         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4193         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4194         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4195         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4196         16  PB-I-LF-ABBR                 PIC XXX.
  4197         16  PB-I-LF-INPUT-CD             PIC XX.
  4198
  4199         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4200             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4201             88  PB-INVALID-AH               VALUE '  ' '00'
  4202                                                   '90' THRU '99'.
  4203         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4204         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4205         16  PB-I-AH-CALC-FLAG            PIC X.
  4206             88 PB-COMP-AH-PREM                  VALUE '?'.
  4207         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4208         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4209         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4210         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4211         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4212         16  PB-I-AH-ABBR                 PIC XXX.
  4213         16  PB-I-AH-INPUT-CD             PIC XXX.
  4214
  4215         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4216         16  PB-I-REIN-TABLE              PIC XXX.
  4217         16  PB-I-BUSINESS-TYPE           PIC 99.
  4218         16  PB-I-INDV-GRP-CD             PIC X.
  4219         16  PB-I-MORT-CODE.
  4220             20  PB-I-TABLE               PIC X.
  4221             20  PB-I-INTEREST            PIC XX.
  4222             20  PB-I-MORT-TYP            PIC X.
  4223         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4224         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4225         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4226         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  79
* EL050.cbl
  4227         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4228         16  PB-I-SIG-SW                  PIC X.
  4229             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4230         16  PB-I-RATE-CLASS              PIC XX.
  4231         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4232         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4233         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4234         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4235         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4236         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4237         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4238         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4239         16  PB-I-OB-FLAG                 PIC X.
  4240             88  PB-I-OB                      VALUE 'B'.
  4241             88  PB-I-SUMMARY                 VALUE 'Z'.
  4242         16  PB-I-ENTRY-STATUS            PIC X.
  4243             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4244                                              'M' '5' '9' '2'.
  4245             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4246             88  PB-I-POLICY-PENDING          VALUE '2'.
  4247             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4248             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4249             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4250             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4251             88  PB-I-REIN-ONLY               VALUE '9'.
  4252             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4253             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4254             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4255             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4256         16  PB-I-INT-CODE                PIC X.
  4257             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4258             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4259         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4260         16  PB-I-SOC-SEC-NO              PIC X(11).
  4261         16  PB-I-MEMBER-NO               PIC X(12).
  4262         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4263*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4264         16  PB-I-OLD-LOF                 PIC XXX.
  4265         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4266         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4267         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4268         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4269         16  PB-I-LIFE-INDICATOR          PIC X.
  4270             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4271         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4272         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4273                                          PIC S9(5)V99    COMP-3.
  4274         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4275             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4276             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4277         16  PB-I-1ST-PMT-DT              PIC XX.
  4278         16  PB-I-JOINT-INSURED.
  4279             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4280             20 PB-I-JOINT-FIRST-NAME.
  4281                24  PB-I-JOINT-FIRST-INIT PIC X.
  4282                24  FILLER                PIC X(9).
  4283             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4284*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  80
* EL050.cbl
  4285         16  PB-I-BENEFICIARY-NAME.
  4286             20  PB-I-BANK-NUMBER         PIC X(10).
  4287             20  FILLER                   PIC X(15).
  4288         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4289         16  PB-I-REFERENCE               PIC X(12).
  4290         16  FILLER REDEFINES PB-I-REFERENCE.
  4291             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4292             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4293             20  PB-I-CLP-STATE           PIC XX.
  4294         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4295             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4296             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4297             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4298         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4299         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4300         16  PB-I-RESIDENT-STATE          PIC XX.
  4301         16  PB-I-RATE-CODE               PIC X(4).
  4302         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4303         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4304         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4305         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4306         16  PB-I-BANK-NOCHRGB            PIC 99.
  4307         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4308         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4309
  4310     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4311         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4312             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4313         16  PB-C-CANCEL-ORIGIN           PIC X.
  4314             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4315         16  PB-C-LF-CANCEL-DT            PIC XX.
  4316         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4317         16  PB-C-LF-CALC-REQ             PIC X.
  4318             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4319         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4320         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4321         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4322             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4323         16  PB-C-AH-CANCEL-DT            PIC XX.
  4324         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4325         16  PB-C-AH-CALC-REQ             PIC X.
  4326             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4327         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4328         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4329         16  PB-C-LAST-NAME               PIC X(15).
  4330         16  PB-C-REFUND-SW               PIC X.
  4331             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4332             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4333         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4334         16  PB-C-PAYEE-CODE              PIC X(6).
  4335         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4336         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4337         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4338         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4339         16  PB-C-REFERENCE               PIC X(12).
  4340         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4341         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4342         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  81
* EL050.cbl
  4343         16  PB-C-CANCEL-REASON           PIC X.
  4344         16  PB-C-REF-INTERFACE-SW        PIC X.
  4345         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4346         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4347         16  FILLER                       PIC X(01).
  4348*        16  FILLER                       PIC X(18).
  4349         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4350*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4351         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4352         16  PB-CANCELED-CERT-DATA.
  4353             20  PB-CI-INSURED-NAME.
  4354                 24  PB-CI-LAST-NAME      PIC X(15).
  4355                 24  PB-CI-INITIALS       PIC XX.
  4356             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4357             20  PB-CI-INSURED-SEX        PIC X.
  4358             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4359             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4360             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4361             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4362             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4365             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4366             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4367             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4368             20  PB-CI-RATE-CLASS         PIC XX.
  4369             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4370             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4371             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4372             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4373             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4374             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4375             20  PB-CI-LF-ABBR            PIC X(3).
  4376             20  PB-CI-AH-ABBR            PIC X(3).
  4377             20  PB-CI-OB-FLAG            PIC X.
  4378                 88  PB-CI-OB                VALUE 'B'.
  4379             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4380                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4381                                           'M' '4' '5' '9' '2'.
  4382                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4383                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4384                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4385                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4386                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4387                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4388                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4389                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4390                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4391                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4392                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4393                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4394                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4395             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4396                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4397                                           'M' '4' '5' '9' '2'.
  4398                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4399                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4400                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  82
* EL050.cbl
  4401                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4402                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4403                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4404                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4405                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4406                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4407                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4408                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4409                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4410                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4411             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4412             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4413             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4414             20  PB-CI-MEMBER-NO          PIC X(12).
  4415             20  PB-CI-INT-CODE           PIC X.
  4416                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4417                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4418             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4419             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4420             20  PB-CI-COMP-EXCP-SW       PIC X.
  4421                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4422                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4423             20  PB-CI-ENTRY-STATUS       PIC X.
  4424             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4425             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4426             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4427             20  PB-CI-DEATH-DT           PIC XX.
  4428             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4429             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4430             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4431             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4432             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4433             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4434             20  PB-CI-ENTRY-DT              PIC XX.
  4435             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4436             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4437             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4438             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4439             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4440             20  PB-CI-OLD-LOF               PIC XXX.
  4441*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4442             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4443             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4444             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4445             20  PB-CI-INDV-GRP-CD           PIC X.
  4446             20  PB-CI-BENEFICIARY-NAME.
  4447                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4448                 24  FILLER                  PIC X(15).
  4449             20  PB-CI-NOTE-SW               PIC X.
  4450             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4451             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4452             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4453             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4454             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4455             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4456             20  PB-CI-FIRST-NAME            PIC X(10).
  4457             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4458
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  83
* EL050.cbl
  4459         16  FILLER                       PIC X(13).
  4460*032306  16  FILLER                       PIC X(27).
  4461*        16  FILLER                       PIC X(46).
  4462
  4463     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4464         16  FILLER                       PIC X(10).
  4465         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4466         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4467         16  PB-M-INSURED-MID-INIT        PIC X.
  4468         16  PB-M-INSURED-AGE             PIC 99.
  4469         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4470         16  PB-M-INSURED-SEX             PIC X.
  4471         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4472         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4473         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4474         16  PB-M-INSURED-CITY-STATE.
  4475             20  PB-M-INSURED-CITY        PIC X(28).
  4476             20  PB-M-INSURED-STATE       PIC XX.
  4477         16  PB-M-INSURED-ZIP-CODE.
  4478             20  PB-M-INSURED-ZIP-PRIME.
  4479                 24  PB-M-INSURED-ZIP-1   PIC X.
  4480                     88  PB-M-CANADIAN-POST-CODE
  4481                                             VALUE 'A' THRU 'Z'.
  4482                 24  FILLER               PIC X(4).
  4483             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4484         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4485                                        PB-M-INSURED-ZIP-CODE.
  4486             20  PM-M-INS-CAN-POST1       PIC XXX.
  4487             20  PM-M-INS-CAN-POST2       PIC XXX.
  4488             20  FILLER                   PIC XXX.
  4489         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4490         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4491         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4492         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4493         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4494         16  PB-M-CRED-BENE-CITYST.
  4495             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4496             20  PB-M-CRED-BENE-STATE     PIC XX.
  4497         16  FILLER                       PIC X(92).
  4498
  4499     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4500         16  FILLER                       PIC X(10).
  4501         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4503         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4504         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4506         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4507         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4509         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4510         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4512         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4513         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4514         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4515         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4516         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  84
* EL050.cbl
  4517         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4518         16  PB-ACCOUNT-NAME              PIC X(30).
  4519         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4520         16  PB-REFERENCE                 PIC X(12).
  4521         16  PB-B-RECEIVED-DT             PIC XX.
  4522         16  FILLER                       PIC X(234).
  4523
  4524     12  PB-RECORD-STATUS.
  4525         16  PB-CREDIT-SELECT-DT          PIC XX.
  4526         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4527         16  PB-BILLED-DT                 PIC XX.
  4528         16  PB-BILLING-STATUS            PIC X.
  4529             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4530             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4531             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4532         16  PB-RECORD-BILL               PIC X.
  4533             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4534             88  PB-RECORD-RETURNED           VALUE 'R'.
  4535             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4536             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4537             88  PB-OVERRIDE-AH               VALUE 'A'.
  4538             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4539         16  PB-BATCH-ENTRY               PIC X.
  4540             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4541             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4542             88  PB-REISSUED-CERT             VALUE 'E'.
  4543             88  PB-CASH-CERT                 VALUE 'C'.
  4544             88  PB-MONTHLY-CERT              VALUE 'M'.
  4545             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4546             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4547             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4548         16  PB-FORCE-CODE                PIC X.
  4549             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4550             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4551             88  PB-CANCEL-FORCE              VALUE '8'.
  4552             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4553             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4554             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4555             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4556             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4557             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4558             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4559             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4560         16  PB-FATAL-FLAG                PIC X.
  4561             88  PB-FATAL-ERRORS              VALUE 'X'.
  4562         16  PB-FORCE-ER-CD               PIC X.
  4563             88  PB-FORCE-ERRORS              VALUE 'F'.
  4564             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4565         16  PB-WARN-ER-CD                PIC X.
  4566             88  PB-WARNING-ERRORS            VALUE 'W'.
  4567         16  FILLER                       PIC X.
  4568         16  PB-OUT-BAL-CD                PIC X.
  4569             88  PB-OUT-OF-BAL                VALUE 'O'.
  4570         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4571         16  PB-AH-OVERRIDE-L1            PIC X.
  4572         16  PB-INPUT-DT                  PIC XX.
  4573         16  PB-INPUT-BY                  PIC X(4).
  4574         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  85
* EL050.cbl
  4575         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4576         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4577         16  PB-LF-EARNING-METHOD         PIC X.
  4578         16  PB-AH-EARNING-METHOD         PIC X.
  4579         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4580         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4581         16  PB-REIN-CD                   PIC XXX.
  4582         16  PB-LF-REFUND-TYPE            PIC X.
  4583         16  PB-AH-REFUND-TYPE            PIC X.
  4584         16  PB-ACCT-EFF-DT               PIC XX.
  4585         16  PB-ACCT-EXP-DT               PIC XX.
  4586         16  PB-COMPANY-ID                PIC X(3).
  4587         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4588         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4589         16  PB-SV-CARRIER                PIC X.
  4590         16  PB-SV-GROUPING               PIC X(6).
  4591         16  PB-SV-STATE                  PIC XX.
  4592         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4593         16  PB-GA-BILLING-INFO.
  4594             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4595                                          PIC XX.
  4596         16  PB-SV-REMIT-TO  REDEFINES
  4597             PB-GA-BILLING-INFO           PIC X(10).
  4598         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4599         16  PB-I-LOAN-OFFICER            PIC X(5).
  4600         16  PB-I-VIN                     PIC X(17).
  4601
  4602         16  FILLER                       PIC X(04).
  4603         16  IMNET-BYPASS-SW              PIC X.
  4604
  4605******************************************************************
  4606*                COMMON EDIT ERRORS                              *
  4607******************************************************************
  4608
  4609     12  PB-COMMON-ERRORS.
  4610         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4611                                           PIC S9(4)     COMP.
  4612
  4613******************************************************************
  4614
  4615* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4616*    COPY ELC50W1.
  4617******************************************************************
  4618*                                                                *
  4619*                                                                *
  4620*                             ELC50W1                            *
  4621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4622*                            VMOD=2.004                          *
  4623*                                                                *
  4624*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4625*                                                                *
  4626*                                                                *
  4627******************************************************************
  4628
  4629     12  WK-WORK-AREA.
  4630         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4631         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4632         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  86
* EL050.cbl
  4633         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4634         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4635         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4636         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4637         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4638         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4639         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4640         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4641         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4642         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4643         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4644         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4645         16  WK-CREDIT-EDIT-CONTROLS.
  4646             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4647             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4648             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4649             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4650             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4651             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4652         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4653         16  WK-SAVE-REIN-DATA.
  4654             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4655             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4656             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4657         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4658             88  ENTRY-FROM-EL6311       VALUE '6'.
  4659         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4660         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4661     12  WK-RECORD-ADDRESSES.
  4662         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4663         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4664         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4665         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4666         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4667         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4668         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4669         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4670     12  WK-OVER-SHORT-AREA.
  4671         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4672         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4673         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4674             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4675         16  FILLER                   PIC X(5) VALUE SPACES.
  4676
  4677*    COPY ELCEDITC.
  4678******************************************************************
  4679*                                                                *
  4680*                                                                *
  4681*                            ELCEDITC                            *
  4682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4683*                            VMOD=2.012                          *
  4684*                                                                *
  4685*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4686*                     EL6313, EL050 AND EL517.                   *
  4687*                                                                *
  4688******************************************************************
  4689******************************************************************
  4690*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  87
* EL050.cbl
  4691*
  4692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4693*-----------------------------------------------------------------
  4694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4695* EFFECTIVE    NUMBER
  4696*-----------------------------------------------------------------
  4697* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4698******************************************************************
  4699
  4700     12  EDIT-CRITERIA-DATA.
  4701         16  EC-CO-MONTH-END-DT       PIC XX.
  4702         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4703         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4704         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4705         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4706         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4707         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4708         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4709         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4710         16  EC-CO-REM-TERM-CALC      PIC X.
  4711               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4712               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4713               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4714               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4715
  4716         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4717               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4718               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4719               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4720               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4721               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4722               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4723               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4724               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4725               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4726               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4727
  4728         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4729               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4730               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4731               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4732               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4733               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4734               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4735               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4736               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4737
  4738         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4739                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4740                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4741
  4742         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4743                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4744                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4745                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4746                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4747                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4748                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  88
* EL050.cbl
  4749                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4750                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4751
  4752         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4753               88  EC-BR-REDUCING                   VALUE 'R'.
  4754               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4755
  4756         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4757         16  EC-BR-LF-DESC             PIC X(10).
  4758         16  EC-BR-AH-DESC             PIC X(10).
  4759         16  EC-BR-LF-COMMENT          PIC X(10).
  4760         16  EC-BR-AH-COMMENT          PIC X(10).
  4761
  4762         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4763               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4764               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4765               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4766               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4767
  4768         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4769               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4773
  4774         16  EC-BR-LF-REFUND-CALC      PIC X.
  4775                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4776                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4777                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4778                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4779                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4780                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4781                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4782
  4783         16  EC-BR-AH-REFUND-CALC      PIC X.
  4784                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4785                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4786                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4787                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4788                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4789                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4790                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4791                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4792
  4793         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4794                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4795                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4796                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4797
  4798         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4799                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4800                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4801                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4802
  4803         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4804         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4805         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4806         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  89
* EL050.cbl
  4807
  4808         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4809         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4810                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4811                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4812                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4813                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4814
  4815         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4816               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4817               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4818               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4819               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4820               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4821
  4822         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4823               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4824               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4825               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4826               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4827               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4828
  4829         16  EC-ST-LF-REFUND-CALC      PIC X.
  4830                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4831                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4832                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4833                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4834                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4835                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4836                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4837                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4838
  4839         16  EC-ST-AH-REFUND-CALC      PIC X.
  4840                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4841                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4842                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4843                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4844                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4845                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4846                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4847                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4848
  4849         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4850         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4851         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4852         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4853         16  EC-AM-EXPIRATION-DT       PIC XX.
  4854         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4855         16  EC-AM-CLASS-CD            PIC XX.
  4856         16  EC-AM-LF-DEVIATION        PIC XXX.
  4857         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4858         16  EC-AM-AH-DEVIATION        PIC XXX.
  4859         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4860         16  EC-AM-PHONE-NO            PIC X(10).
  4861
  4862         16  EC-AM-LF-REFUND-CALC      PIC X.
  4863                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4864                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  90
* EL050.cbl
  4865                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4866                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4867                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4868                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4869                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4870
  4871         16  EC-AM-AH-REFUND-CALC      PIC X.
  4872                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4873                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4874                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4875                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4876                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4877                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4878                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4879
  4880         16  EC-AM-BEN-I-G-CD          PIC X.
  4881                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4882                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4883                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4884
  4885         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4886         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4887         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4888         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4889         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4890         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4891         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4892         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4893         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4894
  4895         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4896         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4897         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4898         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4899         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4900         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4901         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4902         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4903         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4904         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4905         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4906         16  EC-RT-LF-NSP-ST           PIC XX.
  4907         16  EC-RT-AH-NSP-ST           PIC XX.
  4908         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4909         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4910
  4911         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4912             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4913                                             'M' '5' '9' '2'.
  4914             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4915             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4916             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4917             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4918             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4919             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4920             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4921             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4922             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  91
* EL050.cbl
  4923             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4924
  4925         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4926             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4927                                             'M' '5' '9' '2'.
  4928             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4929             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4930             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4931             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4932             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4933             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4934             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4935             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4936             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4937             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4938
  4939         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4940         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4941         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4942         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4943         16  EC-CM-DEATH-DT            PIC XX.
  4944
  4945*DMD CUSTOM CODING FIELDS BELOW
  4946*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4947         16  EC-BR-DMD-RATING-SW       PIC X.
  4948                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4949                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4950                 88  NO-DMD-RATING               VALUE 'N'.
  4951
  4952         16  EC-NEW-CERT               PIC X(11).
  4953         16  EC-NEW-STATE              PIC XX.
  4954         16  FILLER                    PIC X.
  4955*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4956         16  OVER-SHORT-EDIT-FIELDS.
  4957             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4958             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4959             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4960             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4961             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4962             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4963             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4964             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4965             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4966         16  FILLER                    PIC X(71).
  4967******************************************************************
  4968
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  92
* EL050.cbl
  4970*    COPY ELCDIFRD.
  4971******************************************************************
  4972*                                                                *
  4973*                                                                *
  4974*                            ELCDIFRD.                           *
  4975*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4976*                            VMOD=2.004                          *
  4977*                                                                *
  4978*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4979*                                                                *
  4980******************************************************************
  4981*
  4982  01  WS-DIFFERENCE-CALCULATION.
  4983        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4984        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4985        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4986        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4987        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4988        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4989        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4990        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4991        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4992        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4993        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4994
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  93
* EL050.cbl
  4996****************************************************************
  4997*
  4998* Copyright (c) 2007-2013 Dell Inc.
  4999* All rights reserved.
  5000*
  5001****************************************************************
  5002 01  DFHEIV.
  5003   02  DFHEIV0               PIC X(35).
  5004   02  DFHEIV1               PIC X(08).
  5005   02  DFHEIV2               PIC X(08).
  5006   02  DFHEIV3               PIC X(08).
  5007   02  DFHEIV4               PIC X(06).
  5008   02  DFHEIV5               PIC X(04).
  5009   02  DFHEIV6               PIC X(04).
  5010   02  DFHEIV7               PIC X(02).
  5011   02  DFHEIV8               PIC X(02).
  5012   02  DFHEIV9               PIC X(01).
  5013   02  DFHEIV10              PIC S9(7) COMP-3.
  5014   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5015   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5016   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5017   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5018   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5019   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5020   02  DFHEIV17              PIC X(04).
  5021   02  DFHEIV18              PIC X(04).
  5022   02  DFHEIV19              PIC X(04).
  5023   02  DFHEIV20              USAGE IS POINTER.
  5024   02  DFHEIV21              USAGE IS POINTER.
  5025   02  DFHEIV22              USAGE IS POINTER.
  5026   02  DFHEIV23              USAGE IS POINTER.
  5027   02  DFHEIV24              USAGE IS POINTER.
  5028   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5029   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5030   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5031   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5032   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5033   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5034   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5035   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5036   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5037   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5038   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5039   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5040   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5041   02  FILLER                PIC X(02).
  5042   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5043   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5044   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5045   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5046   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5047   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5048   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5049 LINKAGE  SECTION.
  5050*****************************************************************
  5051*                                                               *
  5052* Copyright (c) 2007-2013 Dell Inc.                             *
  5053* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  94
* EL050.cbl
  5054*                                                               *
  5055*****************************************************************
  5056 01  dfheiblk.
  5057     02  eibtime          pic s9(7) comp-3.
  5058     02  eibdate          pic s9(7) comp-3.
  5059     02  eibtrnid         pic x(4).
  5060     02  eibtaskn         pic s9(7) comp-3.
  5061     02  eibtrmid         pic x(4).
  5062     02  dfheigdi         pic s9(4) comp.
  5063     02  eibcposn         pic s9(4) comp.
  5064     02  eibcalen         pic s9(4) comp.
  5065     02  eibaid           pic x(1).
  5066     02  eibfiller1       pic x(1).
  5067     02  eibfn            pic x(2).
  5068     02  eibfiller2       pic x(2).
  5069     02  eibrcode         pic x(6).
  5070     02  eibfiller3       pic x(2).
  5071     02  eibds            pic x(8).
  5072     02  eibreqid         pic x(8).
  5073     02  eibrsrce         pic x(8).
  5074     02  eibsync          pic x(1).
  5075     02  eibfree          pic x(1).
  5076     02  eibrecv          pic x(1).
  5077     02  eibsend          pic x(1).
  5078     02  eibatt           pic x(1).
  5079     02  eibeoc           pic x(1).
  5080     02  eibfmh           pic x(1).
  5081     02  eibcompl         pic x(1).
  5082     02  eibsig           pic x(1).
  5083     02  eibconf          pic x(1).
  5084     02  eiberr           pic x(1).
  5085     02  eibrldbk         pic x(1).
  5086     02  eiberrcd         pic x(4).
  5087     02  eibsynrb         pic x(1).
  5088     02  eibnodat         pic x(1).
  5089     02  eibfiller5       pic x(2).
  5090     02  eibresp          pic s9(8) comp.
  5091     02  eibresp2         pic s9(8) comp.
  5092     02  dfheigdj         pic s9(4) comp.
  5093     02  dfheigdk         pic s9(4) comp.
  5094
  5095 01  DFHCOMMAREA                   PIC X(1036).
  5096
  5097*01 PARMLIST .
  5098*    02  FILLER                    PIC S9(8)   COMP.
  5099*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5100*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5101*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5102*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5103*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5104*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5105*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5106
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  95
* EL050.cbl
  5108*    COPY ELCCNTL.
  5109******************************************************************
  5110*                                                                *
  5111*                                                                *
  5112*                            ELCCNTL.                            *
  5113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5114*                            VMOD=2.059                          *
  5115*                                                                *
  5116*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5117*                                                                *
  5118*   FILE TYPE = VSAM,KSDS                                        *
  5119*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5120*                                                                *
  5121*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5122*       ALTERNATE INDEX = NONE                                   *
  5123*                                                                *
  5124*   LOG = YES                                                    *
  5125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5126******************************************************************
  5127*                   C H A N G E   L O G
  5128*
  5129* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5130*-----------------------------------------------------------------
  5131*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5132* EFFECTIVE    NUMBER
  5133*-----------------------------------------------------------------
  5134* 082503                   PEMA  ADD BENEFIT GROUP
  5135* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5136* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5137* 092705    2005050300006  PEMA  ADD SPP LEASES
  5138* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5139* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5140* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5141* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5142* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5143* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5144* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5145* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5146* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5147* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5148* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5149******************************************************************
  5150*
  5151 01  CONTROL-FILE.
  5152     12  CF-RECORD-ID                       PIC XX.
  5153         88  VALID-CF-ID                        VALUE 'CF'.
  5154
  5155     12  CF-CONTROL-PRIMARY.
  5156         16  CF-COMPANY-ID                  PIC XXX.
  5157         16  CF-RECORD-TYPE                 PIC X.
  5158             88  CF-COMPANY-MASTER              VALUE '1'.
  5159             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5160             88  CF-STATE-MASTER                VALUE '3'.
  5161             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5162             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5163             88  CF-CARRIER-MASTER              VALUE '6'.
  5164             88  CF-MORTALITY-MASTER            VALUE '7'.
  5165             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  96
* EL050.cbl
  5166             88  CF-TERMINAL-MASTER             VALUE '9'.
  5167             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5168             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5169             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5170             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5171             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5172             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5173             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5174             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5175             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5176         16  CF-ACCESS-CD-GENL              PIC X(4).
  5177         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5178             20  CF-PROCESSOR               PIC X(4).
  5179         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5180             20  CF-STATE-CODE              PIC XX.
  5181             20  FILLER                     PIC XX.
  5182         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5183             20  FILLER                     PIC XX.
  5184             20  CF-HI-BEN-IN-REC           PIC XX.
  5185         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5186             20  FILLER                     PIC XXX.
  5187             20  CF-CARRIER-CNTL            PIC X.
  5188         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5189             20  FILLER                     PIC XX.
  5190             20  CF-HI-TYPE-IN-REC          PIC 99.
  5191         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5192             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5193                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5194             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5195             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5196         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5197             20  FILLER                     PIC X.
  5198             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5199         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5200             20  FILLER                     PIC XX.
  5201             20  CF-MORTGAGE-PLAN           PIC XX.
  5202         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5203
  5204     12  CF-LAST-MAINT-DT                   PIC XX.
  5205     12  CF-LAST-MAINT-BY                   PIC X(4).
  5206     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5207
  5208     12  CF-RECORD-BODY                     PIC X(728).
  5209
  5210
  5211****************************************************************
  5212*             COMPANY MASTER RECORD                            *
  5213****************************************************************
  5214
  5215     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5216         16  CF-COMPANY-ADDRESS.
  5217             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5218             20  CF-CL-IN-CARE-OF           PIC X(30).
  5219             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5220             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5221             20  CF-CL-CITY-STATE           PIC X(30).
  5222             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5223             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  97
* EL050.cbl
  5224         16  CF-COMPANY-CD                  PIC X.
  5225         16  CF-COMPANY-PASSWORD            PIC X(8).
  5226         16  CF-SECURITY-OPTION             PIC X.
  5227             88  ALL-SECURITY                   VALUE '1'.
  5228             88  COMPANY-VERIFY                 VALUE '2'.
  5229             88  PROCESSOR-VERIFY               VALUE '3'.
  5230             88  NO-SECURITY                    VALUE '4'.
  5231             88  ALL-BUT-TERM                   VALUE '5'.
  5232         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5233             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5234         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5235             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5236         16  CF-INFORCE-LOCATION            PIC X.
  5237             88  CERTS-ARE-ONLINE               VALUE '1'.
  5238             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5239             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5240         16  CF-LOWER-CASE-LETTERS          PIC X.
  5241         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5242             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5243             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5244             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5245             88  CF-ACCNT-CNTL                  VALUE '3'.
  5246             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5247
  5248         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5249         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5250
  5251         16  CF-LGX-CREDIT-USER             PIC X.
  5252             88  CO-IS-NOT-USER                 VALUE 'N'.
  5253             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5254
  5255         16 CF-CREDIT-CALC-CODES.
  5256             20  CF-CR-REM-TERM-CALC PIC X.
  5257               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5258               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5259               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5260               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5261               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5262               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5263               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5264             20  CF-CR-R78-METHOD           PIC X.
  5265               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5266               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5267
  5268         16  CF-CLAIM-CONTROL-COUNTS.
  5269             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5270                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5271
  5272             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5273                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5274
  5275             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5276                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5277
  5278             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5279                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5280
  5281         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  98
* EL050.cbl
  5282
  5283         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5284             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5285             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5286             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5287             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5288                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5289                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5290             20  CF-CO-PREM-REJECT-SW       PIC X.
  5291                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5292                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5293             20  CF-CO-REF-REJECT-SW        PIC X.
  5294                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5295                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5296
  5297         16  CF-CO-REPORTING-DT             PIC XX.
  5298         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5299         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5300           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5301           88  CF-CO-MONTH-END                  VALUE '1'.
  5302
  5303         16  CF-LGX-CLAIM-USER              PIC X.
  5304             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5306
  5307         16  CF-CREDIT-EDIT-CONTROLS.
  5308             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5309             20  CF-MIN-AGE                 PIC 99.
  5310             20  CF-DEFAULT-AGE             PIC 99.
  5311             20  CF-MIN-TERM                PIC S999      COMP-3.
  5312             20  CF-MAX-TERM                PIC S999      COMP-3.
  5313             20  CF-DEFAULT-SEX             PIC X.
  5314             20  CF-JOINT-AGE-INPUT         PIC X.
  5315                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5316             20  CF-BIRTH-DATE-INPUT        PIC X.
  5317                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5318             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5319                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5320                 88  CF-ZERO-CARRIER            VALUE '1'.
  5321                 88  CF-ZERO-GROUPING           VALUE '2'.
  5322                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5323             20  CF-EDIT-SW                 PIC X.
  5324                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5325             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5326             20  CF-CR-PR-METHOD            PIC X.
  5327               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5328               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5329             20  FILLER                     PIC X.
  5330
  5331         16  CF-CREDIT-MISC-CONTROLS.
  5332             20  CF-REIN-TABLE-SW           PIC X.
  5333                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5334             20  CF-COMP-TABLE-SW           PIC X.
  5335                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5336             20  CF-EXPERIENCE-RETENTION-AGE
  5337                                            PIC S9        COMP-3.
  5338             20  CF-CONVERSION-DT           PIC XX.
  5339             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page  99
* EL050.cbl
  5340             20  CF-RUN-FREQUENCY-SW        PIC X.
  5341                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5342                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5343
  5344             20  CF-CR-CHECK-NO-CONTROL.
  5345                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5346                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5347                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5348                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5349                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5350                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5351
  5352                 24  CF-CR-CHECK-COUNT       REDEFINES
  5353                     CF-CR-CHECK-COUNTER      PIC X(4).
  5354
  5355                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5356                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5357
  5358                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5359                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5360                 24  CF-MAIL-PROCESSING       PIC X.
  5361                     88  MAIL-PROCESSING          VALUE 'Y'.
  5362
  5363         16  CF-MISC-SYSTEM-CONTROL.
  5364             20  CF-SYSTEM-C                 PIC X.
  5365                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5366             20  CF-SYSTEM-D                 PIC X.
  5367                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5368             20  CF-SOC-SEC-NO-SW            PIC X.
  5369                 88  SOC-SEC-NO-USED             VALUE '1'.
  5370             20  CF-MEMBER-NO-SW             PIC X.
  5371                 88  MEMBER-NO-USED              VALUE '1'.
  5372             20  CF-TAX-ID-NUMBER            PIC X(11).
  5373             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5374             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5375                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5376                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5377                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5378                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5379             20  CF-SYSTEM-E                 PIC X.
  5380                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5381
  5382         16  CF-LGX-LIFE-USER               PIC X.
  5383             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5384             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5385
  5386         16  CF-CR-MONTH-END-DT             PIC XX.
  5387
  5388         16  CF-FILE-MAINT-DATES.
  5389             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5390                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5391             20  CF-LAST-BATCH       REDEFINES
  5392                 CF-LAST-BATCH-NO               PIC X(4).
  5393             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5394             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5395             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5396             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5397             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 100
* EL050.cbl
  5398             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5399             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5400             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5401             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5402             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5403
  5404         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5405         16  FILLER                         PIC X.
  5406
  5407         16  CF-ALT-MORT-CODE               PIC X(4).
  5408         16  CF-MEMBER-CAPTION              PIC X(10).
  5409
  5410         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5411             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5412             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5413             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5414             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5415             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5416
  5417         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5418
  5419         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5420         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5421         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5422         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5423
  5424         16  CF-AH-OVERRIDE-L1              PIC X.
  5425         16  CF-AH-OVERRIDE-L2              PIC XX.
  5426         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5427         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5428
  5429         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5430         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5431
  5432         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5433         16  CF-AR-LAST-EL860-DT            PIC XX.
  5434         16  CF-MP-MONTH-END-DT             PIC XX.
  5435
  5436         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5437         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5438             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5439
  5440         16  CF-AR-MONTH-END-DT             PIC XX.
  5441
  5442         16  CF-CRDTCRD-USER                PIC X.
  5443             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5444             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5445
  5446         16  CF-CC-MONTH-END-DT             PIC XX.
  5447
  5448         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5449
  5450         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5451             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5452             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5453             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5454         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5455         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 101
* EL050.cbl
  5456         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5457         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5458             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5459             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5460         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5461         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5462         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5463             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5464         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5465
  5466         16  CF-CL-ZIP-CODE.
  5467             20  CF-CL-ZIP-PRIME.
  5468                 24  CF-CL-ZIP-1ST          PIC X.
  5469                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5470                 24  FILLER                 PIC X(4).
  5471             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5472         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5473             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5474             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5475             20  FILLER                     PIC XXX.
  5476
  5477         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5478         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5479         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5480         16  CF-CO-OPTION-START-DATE        PIC XX.
  5481         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5482           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5483                                                      '3' '4'.
  5484           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5485           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5486           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5487           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5488           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5489           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5490
  5491         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5492
  5493         16  CF-PAYMENT-APPROVAL-LEVELS.
  5494             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5495             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5496             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5497             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5498             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5499             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5500
  5501         16  CF-END-USER-REPORTING-USER     PIC X.
  5502             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5503             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5504
  5505         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5506             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5507             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5508
  5509         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5510
  5511         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5512         16  FILLER                         PIC X.
  5513
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 102
* EL050.cbl
  5514         16  CF-CREDIT-ARCHIVE-CNTL.
  5515             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5516             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5517             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5518
  5519         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5520
  5521         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5522             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5523             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5524
  5525         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5526             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5527             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5528
  5529         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5530
  5531         16  CF-CO-ACH-ID-CODE              PIC  X.
  5532             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5533             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5534             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5535         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5536         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5537         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5538         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5539         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5540         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5541         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5542         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5543         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5544                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5545         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5546                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5547
  5548         16  CF-CO-OVER-SHORT.
  5549             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5550             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5551
  5552*         16  FILLER                         PIC X(102).
  5553         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5554             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5555             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5556
  5557         16  CF-AH-APPROVAL-DAYS.
  5558             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5559             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5560             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5561             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5562
  5563         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5564
  5565         16  CF-APPROV-LEV-5.
  5566             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5567             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5568             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5569
  5570         16  FILLER                         PIC X(68).
  5571****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 103
* EL050.cbl
  5572*             PROCESSOR/USER RECORD                            *
  5573****************************************************************
  5574
  5575     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5576         16  CF-PROCESSOR-NAME              PIC X(30).
  5577         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5578         16  CF-PROCESSOR-TITLE             PIC X(26).
  5579         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5580                 88  MESSAGE-YES                VALUE 'Y'.
  5581                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5582
  5583*****************************************************
  5584****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5585****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5586****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5587****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5588*****************************************************
  5589
  5590         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5591             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5592             20  CF-APPLICATION-FORCE       PIC X.
  5593             20  CF-INDIVIDUAL-APP.
  5594                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5595                     28  CF-BROWSE-APP      PIC X.
  5596                     28  CF-UPDATE-APP      PIC X.
  5597
  5598         16  CF-CURRENT-TERM-ON             PIC X(4).
  5599         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5600             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5601             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5602             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5603             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5604             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5605             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5606             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5607         16  CF-PROCESSOR-CARRIER           PIC X.
  5608             88  NO-CARRIER-SECURITY            VALUE ' '.
  5609         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5610             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5611         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5612             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5613         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5614             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5615
  5616         16  CF-PROC-SYS-ACCESS-SW.
  5617             20  CF-PROC-CREDIT-CLAIMS-SW.
  5618                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5619                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5620                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5621                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5622             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5623                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5624                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5625             20  CF-PROC-LIFE-GNRLDGR-SW.
  5626                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5627                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5628                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5629                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 104
* EL050.cbl
  5630             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5631                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5632                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5633         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5634             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5635             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5636         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5637
  5638         16  CF-APPROVAL-LEVEL                  PIC X.
  5639             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5640             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5641             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5642             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5643             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5644
  5645         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5646
  5647         16  CF-LANGUAGE-TYPE                   PIC X.
  5648             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5649             88  CF-LANG-IS-FR                      VALUE 'F'.
  5650
  5651         16  CF-CSR-IND                         PIC X.
  5652         16  FILLER                             PIC X(239).
  5653
  5654****************************************************************
  5655*             PROCESSOR/REMINDERS RECORD                       *
  5656****************************************************************
  5657
  5658     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5659         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5660             20  CF-START-REMIND-DT         PIC XX.
  5661             20  CF-END-REMIND-DT           PIC XX.
  5662             20  CF-REMINDER-TEXT           PIC X(50).
  5663         16  FILLER                         PIC X(296).
  5664
  5665
  5666****************************************************************
  5667*             STATE MASTER RECORD                              *
  5668****************************************************************
  5669
  5670     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5671         16  CF-STATE-ABBREVIATION          PIC XX.
  5672         16  CF-STATE-NAME                  PIC X(25).
  5673         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5674         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5675             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5676             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5677             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5678             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5679                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5680                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5681             20  CF-ST-PREM-REJECT-SW       PIC X.
  5682                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5683                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5684             20  CF-ST-REF-REJECT-SW        PIC X.
  5685                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5686                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5687         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 105
* EL050.cbl
  5688         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5689         16  CF-ST-REFUND-RULES.
  5690             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5691             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5692             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5693         16  CF-ST-FST-PMT-EXTENSION.
  5694             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5695             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5696                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5697                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5698                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5699                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5700         16  CF-ST-STATE-CALL.
  5701             20  CF-ST-CALL-UNEARNED        PIC X.
  5702             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5703             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5704         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5705             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5706             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5707         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5708         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5709         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5710         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5711         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5712         16  FILLER                         PIC X.
  5713         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5714             20  CF-ST-BENEFIT-CD           PIC XX.
  5715             20  CF-ST-BENEFIT-KIND         PIC X.
  5716                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5717                 88  CF-ST-AH-KIND              VALUE 'A'.
  5718             20  CF-ST-REM-TERM-CALC        PIC X.
  5719                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5720                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5721                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5722                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5723                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5724                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5725                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5726                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5727
  5728             20  CF-ST-REFUND-CALC          PIC X.
  5729                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5730                 88  ST-REFD-BY-R78             VALUE '1'.
  5731                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5732                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5733                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5734                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5735                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5736                 88  ST-REFD-UTAH               VALUE '7'.
  5737                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5738                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5739                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5740
  5741             20  CF-ST-EARNING-CALC         PIC X.
  5742                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5743                 88  ST-EARN-BY-R78             VALUE '1'.
  5744                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5745                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 106
* EL050.cbl
  5746                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5747                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5748                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5749                 88  ST-EARN-MEAN               VALUE '8'.
  5750                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5751
  5752             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5753                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5754                 88  ST-OVRD-BY-R78             VALUE '1'.
  5755                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5756                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5757                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5758                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5759                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5760                 88  ST-OVRD-MEAN               VALUE '8'.
  5761                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5762             20  cf-st-extra-periods        pic 9.
  5763*            20  FILLER                     PIC X.
  5764
  5765         16  CF-ST-COMMISSION-CAPS.
  5766             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5767             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5768             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5769             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5770         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5771                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5772                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5773                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5774
  5775         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5776
  5777         16  CF-ST-STATUTORY-INTEREST.
  5778             20  CF-ST-STAT-DATE-FROM       PIC X.
  5779                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5780                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5781             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5782             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5783             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5784             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5785             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5786
  5787         16  CF-ST-OVER-SHORT.
  5788             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5789             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5790
  5791         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5792
  5793         16  CF-ST-RT-CALC                  PIC X.
  5794
  5795         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5796         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5797         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5798         16  CF-ST-RF-LR-CALC               PIC X.
  5799         16  CF-ST-RF-LL-CALC               PIC X.
  5800         16  CF-ST-RF-LN-CALC               PIC X.
  5801         16  CF-ST-RF-AH-CALC               PIC X.
  5802         16  CF-ST-RF-CP-CALC               PIC X.
  5803*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 107
* EL050.cbl
  5804*CIDMOD         16  FILLER                         PIC X(192).
  5805         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5806             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5807         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5808         16  CF-ST-VFY-2ND-BENE             PIC X.
  5809         16  CF-ST-CAUSAL-STATE             PIC X.
  5810         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5811         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5812         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5813             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5814         16  CF-ST-NET-ONLY-STATE           PIC X.
  5815             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5816         16  cf-commission-cap-required     pic x.
  5817         16  CF-ST-GA-COMMISSION-CAPS.
  5818             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5819             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5820             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5821             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5822         16  CF-ST-TOT-COMMISSION-CAPS.
  5823             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5824             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5825             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5826             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5827         16  FILLER                         PIC X(156).
  5828
  5829****************************************************************
  5830*             BENEFIT MASTER RECORD                            *
  5831****************************************************************
  5832
  5833     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5834         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5835             20  CF-BENEFIT-CODE            PIC XX.
  5836             20  CF-BENEFIT-NUMERIC  REDEFINES
  5837                 CF-BENEFIT-CODE            PIC XX.
  5838             20  CF-BENEFIT-ALPHA           PIC XXX.
  5839             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5840             20  CF-BENEFIT-COMMENT         PIC X(10).
  5841
  5842             20  CF-LF-COVERAGE-TYPE        PIC X.
  5843                 88  CF-REDUCING                VALUE 'R'.
  5844                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5845
  5846             20  CF-SPECIAL-CALC-CD         PIC X.
  5847                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5848                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5849                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5850                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5851                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5852                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5853                 88  CF-FARM-PLAN               VALUE 'F'.
  5854                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5855                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5856                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5857                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5858                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5859                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5860                 88  CF-PRUDENTIAL              VALUE 'P'.
  5861                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 108
* EL050.cbl
  5862                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5863                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5864                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5865                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5866                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5867
  5868             20  CF-JOINT-INDICATOR         PIC X.
  5869                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5870
  5871*            20  FILLER                     PIC X(12).
  5872             20  cf-maximum-benefits        pic s999 comp-3.
  5873             20  FILLER                     PIC X(09).
  5874             20  CF-BENEFIT-CATEGORY        PIC X.
  5875             20  CF-LOAN-TYPE               PIC X(8).
  5876
  5877             20  CF-CO-REM-TERM-CALC        PIC X.
  5878                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5879                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5880                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5881                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5882                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5883
  5884             20  CF-CO-EARNINGS-CALC        PIC X.
  5885                 88  CO-EARN-BY-R78             VALUE '1'.
  5886                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5887                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5888                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5889                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5890                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5891                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5892                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5893
  5894             20  CF-CO-REFUND-CALC          PIC X.
  5895                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5896                 88  CO-REFD-BY-R78             VALUE '1'.
  5897                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5898                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5899                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5900                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5901                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5902                 88  CO-REFD-MEAN               VALUE '8'.
  5903                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5904                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5905                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5906
  5907             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5908                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5909                 88  CO-OVRD-BY-R78             VALUE '1'.
  5910                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5911                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5912                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5913                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5914                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5915                 88  CO-OVRD-MEAN               VALUE '8'.
  5916                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5917
  5918             20  CF-CO-BEN-I-G-CD           PIC X.
  5919                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 109
* EL050.cbl
  5920                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5921                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5922
  5923         16  FILLER                         PIC X(304).
  5924
  5925
  5926****************************************************************
  5927*             CARRIER MASTER RECORD                            *
  5928****************************************************************
  5929
  5930     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5931         16  CF-ADDRESS-DATA.
  5932             20  CF-MAIL-TO-NAME            PIC X(30).
  5933             20  CF-IN-CARE-OF              PIC X(30).
  5934             20  CF-ADDRESS-LINE-1          PIC X(30).
  5935             20  CF-ADDRESS-LINE-2          PIC X(30).
  5936             20  CF-CITY-STATE              PIC X(30).
  5937             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5938             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5939
  5940         16  CF-CLAIM-NO-CONTROL.
  5941             20  CF-CLAIM-NO-METHOD         PIC X.
  5942                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5943                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5944                 88  CLAIM-NO-SEQ               VALUE '3'.
  5945                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5946             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5947                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5948                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5949                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5950
  5951         16  CF-CHECK-NO-CONTROL.
  5952             20  CF-CHECK-NO-METHOD         PIC X.
  5953                 88  CHECK-NO-MANUAL            VALUE '1'.
  5954                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5955                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5956                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5957             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5958                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5959
  5960         16  CF-DOMICILE-STATE              PIC XX.
  5961
  5962         16  CF-EXPENSE-CONTROLS.
  5963             20  CF-EXPENSE-METHOD          PIC X.
  5964                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5965                 88  DOLLARS-PER-PMT            VALUE '2'.
  5966                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5967                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5968             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5969             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5970
  5971         16  CF-CORRESPONDENCE-CONTROL.
  5972             20  CF-LETTER-RESEND-OPT       PIC X.
  5973                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5974                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5975             20  FILLER                     PIC X(4).
  5976
  5977         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 110
* EL050.cbl
  5978             20  CF-MANUAL-SW               PIC X.
  5979                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5980             20  CF-FUTURE-SW               PIC X.
  5981                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5982             20  CF-PTC-SW                  PIC X.
  5983                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5984             20  CF-IBNR-SW                 PIC X.
  5985                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5986             20  CF-PTC-LF-SW               PIC X.
  5987                 88  CF-LF-PTC-USED             VALUE '1'.
  5988             20  CF-CDT-ACCESS-METHOD       PIC X.
  5989                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5990                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5991                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5992             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5993
  5994         16  CF-CLAIM-CALC-METHOD           PIC X.
  5995             88  360-PLUS-MONTHS                VALUE '1'.
  5996             88  365-PLUS-MONTHS                VALUE '2'.
  5997             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5998             88  360-DAILY                      VALUE '4'.
  5999             88  365-DAILY                      VALUE '5'.
  6000
  6001         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6002         16  FILLER                         PIC X(11).
  6003
  6004         16  CF-LIMIT-AMOUNTS.
  6005             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6006             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6007             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6008             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6009             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6010             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6011             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6012             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6013             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6014             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6015
  6016         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6017         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6018         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6019
  6020         16  CF-ZIP-CODE.
  6021             20  CF-ZIP-PRIME.
  6022                 24  CF-ZIP-1ST             PIC X.
  6023                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6024                 24  FILLER                 PIC X(4).
  6025             20  CF-ZIP-PLUS4               PIC X(4).
  6026         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6027             20  CF-CAN-POSTAL-1            PIC XXX.
  6028             20  CF-CAN-POSTAL-2            PIC XXX.
  6029             20  FILLER                     PIC XXX.
  6030
  6031         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6032         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6033         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6034
  6035         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 111
* EL050.cbl
  6036             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6037             88  CF-NO-RATING                   VALUE 'N'.
  6038
  6039         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6040
  6041         16  CF-CARRIER-OVER-SHORT.
  6042             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6043             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6044
  6045         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6046         16  CF-SECPAY-SWITCH               PIC X.
  6047             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6048             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6049         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6050         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6051         16  FILLER                         PIC X(444).
  6052*        16  FILLER                         PIC X(452).
  6053
  6054
  6055****************************************************************
  6056*             MORTALITY MASTER RECORD                          *
  6057****************************************************************
  6058
  6059     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6060         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6061                                INDEXED BY CF-MORT-NDX.
  6062             20  CF-MORT-TABLE              PIC X(5).
  6063             20  CF-MORT-TABLE-TYPE         PIC X.
  6064                 88  CF-MORT-JOINT              VALUE 'J'.
  6065                 88  CF-MORT-SINGLE             VALUE 'S'.
  6066                 88  CF-MORT-COMBINED           VALUE 'C'.
  6067                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6068                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6069             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6070             20  CF-MORT-AGE-METHOD         PIC XX.
  6071                 88  CF-AGE-LAST                VALUE 'AL'.
  6072                 88  CF-AGE-NEAR                VALUE 'AN'.
  6073             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6074             20  CF-MORT-ADJUSTMENT-DIRECTION
  6075                                            PIC X.
  6076                 88  CF-MINUS                   VALUE '-'.
  6077                 88  CF-PLUS                    VALUE '+'.
  6078             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6079             20  CF-MORT-JOINT-CODE         PIC X.
  6080                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6081             20  CF-MORT-PC-Q               PIC X.
  6082                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6083             20  CF-MORT-TABLE-CODE         PIC X(4).
  6084             20  CF-MORT-COMMENTS           PIC X(15).
  6085             20  FILLER                     PIC X(14).
  6086
  6087         16  FILLER                         PIC X(251).
  6088
  6089
  6090****************************************************************
  6091*             BUSSINESS TYPE MASTER RECORD                     *
  6092****************************************************************
  6093
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 112
* EL050.cbl
  6094     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6095* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6096* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6097* AND RECORD 05 IS TYPES 81-99
  6098         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6099             20  CF-BUSINESS-TITLE          PIC  X(19).
  6100             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6101                                            PIC S9V9(4) COMP-3.
  6102             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6103             20  FILLER                     PIC  X.
  6104         16  FILLER                         PIC  X(248).
  6105
  6106
  6107****************************************************************
  6108*             TERMINAL MASTER RECORD                           *
  6109****************************************************************
  6110
  6111     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6112
  6113         16  CF-COMPANY-TERMINALS.
  6114             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6115                                  PIC X(4).
  6116         16  FILLER               PIC X(248).
  6117
  6118
  6119****************************************************************
  6120*             LIFE EDIT MASTER RECORD                          *
  6121****************************************************************
  6122
  6123     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6124         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6125             20  CF-LIFE-CODE-IN            PIC XX.
  6126             20  CF-LIFE-CODE-OUT           PIC XX.
  6127         16  FILLER                         PIC X(248).
  6128
  6129
  6130****************************************************************
  6131*             AH EDIT MASTER RECORD                            *
  6132****************************************************************
  6133
  6134     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6135         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6136             20  CF-AH-CODE-IN              PIC XXX.
  6137             20  CF-AH-CODE-OUT             PIC XX.
  6138         16  FILLER                         PIC X(248).
  6139
  6140
  6141****************************************************************
  6142*             CREDIBILITY TABLES                               *
  6143****************************************************************
  6144
  6145     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6146         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6147                             INDEXED BY CF-CRDB-NDX.
  6148             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6149             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6150             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6151         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 113
* EL050.cbl
  6152
  6153
  6154****************************************************************
  6155*             REPORT CUSTOMIZATION RECORD                      *
  6156****************************************************************
  6157
  6158     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6159         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6160             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6161             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6162             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6163**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6164****       A T-TRANSFER.                                   ****
  6165             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6166
  6167         16  FILLER                         PIC XX.
  6168
  6169         16  CF-CARRIER-CNTL-OPT.
  6170             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6171                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6172                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6173             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6174                                            PIC X.
  6175         16  CF-GROUP-CNTL-OPT.
  6176             20  CF-GROUP-OPT-SEQ           PIC 9.
  6177                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6178                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6179             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6180                                            PIC X(6).
  6181         16  CF-STATE-CNTL-OPT.
  6182             20  CF-STATE-OPT-SEQ           PIC 9.
  6183                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6184                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6185             20  CF-STATE-SELECT OCCURS 3 TIMES
  6186                                            PIC XX.
  6187         16  CF-ACCOUNT-CNTL-OPT.
  6188             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6189                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6190                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6191             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6192                                            PIC X(10).
  6193         16  CF-BUS-TYP-CNTL-OPT.
  6194             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6195                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6196                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6197             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6198                                            PIC XX.
  6199         16  CF-LF-TYP-CNTL-OPT.
  6200             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6201                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6202                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6203             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6204                                            PIC XX.
  6205         16  CF-AH-TYP-CNTL-OPT.
  6206             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6207                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6208                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6209             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 114
* EL050.cbl
  6210                                            PIC XX.
  6211         16  CF-REPTCD1-CNTL-OPT.
  6212             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6213                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6214                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6215             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6216                                            PIC X(10).
  6217         16  CF-REPTCD2-CNTL-OPT.
  6218             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6219                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6220                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6221             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6222                                            PIC X(10).
  6223         16  CF-USER1-CNTL-OPT.
  6224             20  CF-USER1-OPT-SEQ           PIC 9.
  6225                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6226                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6227             20  CF-USER1-SELECT OCCURS 3 TIMES
  6228                                            PIC X(10).
  6229         16  CF-USER2-CNTL-OPT.
  6230             20  CF-USER2-OPT-SEQ           PIC 9.
  6231                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6232                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6233             20  CF-USER2-SELECT OCCURS 3 TIMES
  6234                                            PIC X(10).
  6235         16  CF-USER3-CNTL-OPT.
  6236             20  CF-USER3-OPT-SEQ           PIC 9.
  6237                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6238                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6239             20  CF-USER3-SELECT OCCURS 3 TIMES
  6240                                            PIC X(10).
  6241         16  CF-USER4-CNTL-OPT.
  6242             20  CF-USER4-OPT-SEQ           PIC 9.
  6243                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6244                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6245             20  CF-USER4-SELECT OCCURS 3 TIMES
  6246                                            PIC X(10).
  6247         16  CF-USER5-CNTL-OPT.
  6248             20  CF-USER5-OPT-SEQ           PIC 9.
  6249                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6250                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6251             20  CF-USER5-SELECT OCCURS 3 TIMES
  6252                                            PIC X(10).
  6253         16  CF-REINS-CNTL-OPT.
  6254             20  CF-REINS-OPT-SEQ           PIC 9.
  6255                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6256                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6257             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6258                 24  CF-REINS-PRIME         PIC XXX.
  6259                 24  CF-REINS-SUB           PIC XXX.
  6260
  6261         16  CF-AGENT-CNTL-OPT.
  6262             20  CF-AGENT-OPT-SEQ           PIC 9.
  6263                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6264                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6265             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6266                                            PIC X(10).
  6267
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 115
* EL050.cbl
  6268         16  FILLER                         PIC X(43).
  6269
  6270         16  CF-LOSS-RATIO-SELECT.
  6271             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6272             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6273         16  CF-ENTRY-DATE-SELECT.
  6274             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6275             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6276         16  CF-EFFECTIVE-DATE-SELECT.
  6277             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6278             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6279
  6280         16  CF-EXCEPTION-LIST-IND          PIC X.
  6281             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6282
  6283         16  FILLER                         PIC X(318).
  6284
  6285****************************************************************
  6286*                  EXCEPTION REPORTING RECORD                  *
  6287****************************************************************
  6288
  6289     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6290         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6291             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6292
  6293         16  CF-COMBINED-LIFE-AH-OPT.
  6294             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6295             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6296             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6297             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6298
  6299         16  CF-LIFE-OPT.
  6300             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6301             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6302             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6303             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6304             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6305             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6306             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6307             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6308             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6309             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6310
  6311         16  CF-AH-OPT.
  6312             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6313             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6314             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6315             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6316             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6317             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6318             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6319             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6320             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6321             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6322
  6323         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6324             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6325             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 116
* EL050.cbl
  6326             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6327
  6328         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6329
  6330         16  FILLER                         PIC X(673).
  6331
  6332
  6333****************************************************************
  6334*             MORTGAGE SYSTEM PLAN RECORD                      *
  6335****************************************************************
  6336
  6337     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6338         16  CF-PLAN-TYPE                   PIC X.
  6339             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6340             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6341             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6342         16  CF-PLAN-ABBREV                 PIC XXX.
  6343         16  CF-PLAN-DESCRIPT               PIC X(10).
  6344         16  CF-PLAN-NOTES                  PIC X(20).
  6345         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6346         16  CF-PLAN-UNDERWRITING.
  6347             20  CF-PLAN-TERM-DATA.
  6348                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6349                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6350             20  CF-PLAN-AGE-DATA.
  6351                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6352                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6353                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6354             20  CF-PLAN-BENEFIT-DATA.
  6355                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6356                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6357                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6358                                            PIC S9(7)V99  COMP-3.
  6359         16  CF-PLAN-POLICY-FORMS.
  6360             20  CF-POLICY-FORM             PIC X(12).
  6361             20  CF-MASTER-APPLICATION      PIC X(12).
  6362             20  CF-MASTER-POLICY           PIC X(12).
  6363         16  CF-PLAN-RATING.
  6364             20  CF-RATE-CODE               PIC X(5).
  6365             20  CF-SEX-RATING              PIC X.
  6366                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6367                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6368             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6369             20  CF-SUB-STD-TYPE            PIC X.
  6370                 88  CF-PCT-OF-PREM            VALUE '1'.
  6371                 88  CF-PCT-OF-BENE            VALUE '2'.
  6372         16  CF-PLAN-PREM-TOLERANCES.
  6373             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6374             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6375         16  CF-PLAN-PYMT-TOLERANCES.
  6376             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6377             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6378         16  CF-PLAN-MISC-DATA.
  6379             20  FILLER                     PIC X.
  6380             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6381             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6382         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6383         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 117
* EL050.cbl
  6384             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6385                                                     '1'.
  6386             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6387                                                     '2'.
  6388         16  CF-MIB-SEARCH-SW               PIC X.
  6389             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6390             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6391             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6392             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6393         16  CF-ALPHA-SEARCH-SW             PIC X.
  6394             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6395             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6396             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6397             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6398             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6399             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6400             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6401             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6402             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6403             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6404                                                     'A' 'B' 'C'
  6405                                                     'X' 'Y' 'Z'.
  6406         16  CF-EFF-DT-RULE-SW              PIC X.
  6407             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6408             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6409             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6410             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6411             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6412         16  FILLER                         PIC X(4).
  6413         16  CF-HEALTH-QUESTIONS            PIC X.
  6414             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6415         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6416         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6417         16  CF-PLAN-SNGL-JNT               PIC X.
  6418             88  CF-COMBINED-PLAN              VALUE 'C'.
  6419             88  CF-JNT-PLAN                   VALUE 'J'.
  6420             88  CF-SNGL-PLAN                  VALUE 'S'.
  6421         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6422         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6423         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6424         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6425         16  CF-RERATE-CNTL                 PIC  X.
  6426             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6427             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6428             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6429             88  CF-AUTO-RECALC                 VALUE '4'.
  6430         16  CF-BENEFIT-TYPE                PIC  X.
  6431             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6432             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6433         16  CF-POLICY-FEE                  PIC S999V99
  6434                                                    COMP-3.
  6435         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6436         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6437         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6438         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6439         16  FILLER                         PIC  X(32).
  6440         16  CF-TERMINATION-FORM            PIC  X(04).
  6441         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 118
* EL050.cbl
  6442         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6443                                                       COMP-3.
  6444         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6445         16  CF-ISSUE-LETTER                PIC  X(4).
  6446         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6447         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6448             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6449             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6450         16  CF-MP-REFUND-CALC              PIC X.
  6451             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6452             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6453             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6454             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6455             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6456             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6457             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6458             88  CF-MP-REFD-MEAN                VALUE '8'.
  6459         16  CF-ALT-RATE-CODE               PIC  X(5).
  6460
  6461
  6462         16  FILLER                         PIC X(498).
  6463****************************************************************
  6464*             MORTGAGE COMPANY MASTER RECORD                   *
  6465****************************************************************
  6466
  6467     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6468         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6469         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6470             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6471             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6472             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6473             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6474             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6475
  6476         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6477         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6478         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6479         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6480         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6481
  6482         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6483             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6484         16  CF-MP-RECON-USE-IND            PIC X(1).
  6485             88  CF-MP-USE-RECON             VALUE 'Y'.
  6486         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6487             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6488         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6489             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6490             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6491         16  FILLER                         PIC X(1).
  6492         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6493             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6494         16  CF-MORTG-MIB-VERSION           PIC X.
  6495             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6496             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6497             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6498         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6499             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 119
* EL050.cbl
  6500                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6501             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6502                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6503             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6504                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6505             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6506                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6507             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6508                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6509             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6510                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6511         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6512         16  FILLER                         PIC X(7).
  6513         16  CF-MORTG-DESTINATION-SYMBOL.
  6514             20  CF-MORTG-MIB-COMM          PIC X(5).
  6515             20  CF-MORTG-MIB-TERM          PIC X(5).
  6516         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6517             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6518         16  FILLER                         PIC X(03).
  6519         16  CF-MP-CHECK-NO-CONTROL.
  6520             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6521                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6522                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6523                                                ' ' LOW-VALUES.
  6524                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6525                                               VALUE '3'.
  6526         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6527         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6528         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6529             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6530                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6531             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6532                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6533             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6534                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6535             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6536                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6537             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6538                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6539             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6540                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6541         16  CF-MORTG-BILLING-AREA.
  6542             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6543                                            PIC X.
  6544         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6545         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6546         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6547         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6548             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6549             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6550         16  FILLER                         PIC X.
  6551         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6552             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6553             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6554         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6555         16  FILLER                         PIC X(8).
  6556         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6557         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 120
* EL050.cbl
  6558         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6559         16  CF-ACH-COMPANY-ID.
  6560             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6561                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6562                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6563                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6564             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6565         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6566             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6567         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6568             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6569             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6570         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6571         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6572         16  FILLER                         PIC X(536).
  6573
  6574****************************************************************
  6575*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6576****************************************************************
  6577
  6578     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6579         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6580             20  CF-FEMALE-HEIGHT.
  6581                 24  CF-FEMALE-FT           PIC 99.
  6582                 24  CF-FEMALE-IN           PIC 99.
  6583             20  CF-FEMALE-MIN-WT           PIC 999.
  6584             20  CF-FEMALE-MAX-WT           PIC 999.
  6585         16  FILLER                         PIC X(428).
  6586
  6587     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6588         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6589             20  CF-MALE-HEIGHT.
  6590                 24  CF-MALE-FT             PIC 99.
  6591                 24  CF-MALE-IN             PIC 99.
  6592             20  CF-MALE-MIN-WT             PIC 999.
  6593             20  CF-MALE-MAX-WT             PIC 999.
  6594         16  FILLER                         PIC X(428).
  6595******************************************************************
  6596*             AUTOMATIC ACTIVITY RECORD                          *
  6597******************************************************************
  6598     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6599         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6600             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6601             20  CF-SYS-LETTER-ID           PIC X(04).
  6602             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6603             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6604             20  CF-SYS-RESET-SW            PIC X(01).
  6605             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6606             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6607
  6608         16  FILLER                         PIC X(50).
  6609
  6610         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6611             20  CF-USER-ACTIVE-SW          PIC X(01).
  6612             20  CF-USER-LETTER-ID          PIC X(04).
  6613             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6614             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6615             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 121
* EL050.cbl
  6616             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6617             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6618             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6619
  6620         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 122
* EL050.cbl
  6622*    COPY ERCACCT.
  6623******************************************************************
  6624*                                                                *
  6625*                                                                *
  6626*                            ERCACCT                             *
  6627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6628*                            VMOD=2.031                          *
  6629*                                                                *
  6630*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6631*                                                                *
  6632*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6633*   VSAM ACCOUNT MASTER FILES.                                   *
  6634*                                                                *
  6635*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6636*                                                                *
  6637*   FILE TYPE = VSAM,KSDS                                        *
  6638*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6639*                                                                *
  6640*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6641*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6642*                                                                *
  6643*   LOG = NO                                                     *
  6644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6645*                                                                *
  6646*                                                                *
  6647******************************************************************
  6648*                   C H A N G E   L O G
  6649*
  6650* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6651*-----------------------------------------------------------------
  6652*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6653* EFFECTIVE    NUMBER
  6654*-----------------------------------------------------------------
  6655* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6656* 092705    2005050300006  PEMA  ADD SPP LEASES
  6657* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6658* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6659* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6660* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6661* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6662* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6663******************************************************************
  6664
  6665 01  ACCOUNT-MASTER.
  6666     12  AM-RECORD-ID                      PIC XX.
  6667         88  VALID-AM-ID                      VALUE 'AM'.
  6668
  6669     12  AM-CONTROL-PRIMARY.
  6670         16  AM-COMPANY-CD                 PIC X.
  6671         16  AM-MSTR-CNTRL.
  6672             20  AM-CONTROL-A.
  6673                 24  AM-CARRIER            PIC X.
  6674                 24  AM-GROUPING.
  6675                     28 AM-GROUPING-PREFIX PIC XXX.
  6676                     28 AM-GROUPING-PRIME  PIC XXX.
  6677                 24  AM-STATE              PIC XX.
  6678                 24  AM-ACCOUNT.
  6679                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 123
* EL050.cbl
  6680                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6681             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6682                                           PIC X(19).
  6683             20  AM-CNTRL-B.
  6684                 24  AM-EXPIRATION-DT      PIC XX.
  6685                 24  FILLER                PIC X(4).
  6686             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6687                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6688
  6689     12  AM-CONTROL-BY-VAR-GRP.
  6690         16  AM-COMPANY-CD-A1              PIC X.
  6691         16  AM-VG-CARRIER                 PIC X.
  6692         16  AM-VG-GROUPING                PIC X(6).
  6693         16  AM-VG-STATE                   PIC XX.
  6694         16  AM-VG-ACCOUNT                 PIC X(10).
  6695         16  AM-VG-DATE.
  6696             20  AM-VG-EXPIRATION-DT       PIC XX.
  6697             20  FILLER                    PIC X(4).
  6698         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6699                                           PIC 9(11)      COMP-3.
  6700     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6701         16  FILLER                        PIC X(10).
  6702         16  AM-VG-KEY3.
  6703             20  AM-VG3-ACCOUNT            PIC X(10).
  6704             20  AM-VG3-EXP-DT             PIC XX.
  6705         16  FILLER                        PIC X(4).
  6706     12  AM-MAINT-INFORMATION.
  6707         16  AM-LAST-MAINT-DT              PIC XX.
  6708         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6709         16  AM-LAST-MAINT-USER            PIC X(4).
  6710         16  FILLER                        PIC XX.
  6711
  6712     12  AM-EFFECTIVE-DT                   PIC XX.
  6713     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6714
  6715     12  AM-PREV-DATES  COMP-3.
  6716         16  AM-PREV-EXP-DT                PIC 9(11).
  6717         16  AM-PREV-EFF-DT                PIC 9(11).
  6718
  6719     12  AM-REPORT-CODE-1                  PIC X(10).
  6720     12  AM-REPORT-CODE-2                  PIC X(10).
  6721
  6722     12  AM-CITY-CODE                      PIC X(4).
  6723     12  AM-COUNTY-PARISH                  PIC X(6).
  6724
  6725     12  AM-NAME                           PIC X(30).
  6726     12  AM-PERSON                         PIC X(30).
  6727     12  AM-ADDRS                          PIC X(30).
  6728     12  AM-CITY.
  6729         16  AM-ADDR-CITY                  PIC X(28).
  6730         16  AM-ADDR-STATE                 PIC XX.
  6731     12  AM-ZIP.
  6732         16  AM-ZIP-PRIME.
  6733             20  AM-ZIP-PRI-1ST            PIC X.
  6734                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6735             20  FILLER                    PIC X(4).
  6736         16  AM-ZIP-PLUS4                  PIC X(4).
  6737     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 124
* EL050.cbl
  6738         16  AM-CAN-POSTAL-1               PIC XXX.
  6739         16  AM-CAN-POSTAL-2               PIC XXX.
  6740         16  FILLER                        PIC XXX.
  6741     12  AM-TEL-NO.
  6742         16  AM-AREA-CODE                  PIC 999.
  6743         16  AM-TEL-PRE                    PIC 999.
  6744         16  AM-TEL-NBR                    PIC 9(4).
  6745     12  AM-TEL-LOC                        PIC X.
  6746         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6747         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6748
  6749     12  AM-COMM-STRUCTURE.
  6750         16  AM-DEFN-1.
  6751             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6752                 24  AM-AGT.
  6753                     28  AM-AGT-PREFIX     PIC X(4).
  6754                     28  AM-AGT-PRIME      PIC X(6).
  6755                 24  AM-COM-TYP            PIC X.
  6756                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6757                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6758                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6759                 24  AM-RECALC-LV-INDIC    PIC X.
  6760                 24  AM-RETRO-LV-INDIC     PIC X.
  6761                 24  AM-GL-CODES           PIC X.
  6762                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6763                 24  FILLER                PIC X(01).
  6764         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6765             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6766                 24  FILLER                PIC X(11).
  6767                 24  AM-L-COMA             PIC XXX.
  6768                 24  AM-J-COMA             PIC XXX.
  6769                 24  AM-A-COMA             PIC XXX.
  6770                 24  FILLER                PIC X(6).
  6771
  6772     12  AM-COMM-CHANGE-STATUS             PIC X.
  6773         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6774
  6775     12  AM-CSR-CODE                       PIC X(4).
  6776
  6777     12  AM-BILLING-STATUS                 PIC X.
  6778         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6779         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6780     12  AM-AUTO-REFUND-SW                 PIC X.
  6781         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6782         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6783     12  AM-GPCD                           PIC 99.
  6784     12  AM-IG                             PIC X.
  6785         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6786         88  AM-HAS-GROUP                     VALUE '2'.
  6787     12  AM-STATUS                         PIC X.
  6788         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6789         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6790         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6791         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6792         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6793         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6794         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6795         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 125
* EL050.cbl
  6796         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6797         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6798     12  AM-REMIT-TO                       PIC 99.
  6799     12  AM-ID-NO                          PIC X(11).
  6800
  6801     12  AM-CAL-TABLE                      PIC XX.
  6802     12  AM-LF-DEVIATION                   PIC XXX.
  6803     12  AM-AH-DEVIATION                   PIC XXX.
  6804     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6805     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6806     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6807     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6808     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6809     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6810
  6811     12  AM-USER-FIELDS.
  6812         16  AM-FLD-1                      PIC XX.
  6813         16  AM-FLD-2                      PIC XX.
  6814         16  AM-FLD-3                      PIC XX.
  6815         16  AM-FLD-4                      PIC XX.
  6816         16  AM-FLD-5                      PIC XX.
  6817
  6818     12  AM-1ST-PROD-DATE.
  6819         16  AM-1ST-PROD-YR                PIC XX.
  6820         16  AM-1ST-PROD-MO                PIC XX.
  6821         16  AM-1ST-PROD-DA                PIC XX.
  6822     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6823     12  AM-CERTS-PURGED-DATE.
  6824         16  AM-PUR-YR                     PIC XX.
  6825         16  AM-PUR-MO                     PIC XX.
  6826         16  AM-PUR-DA                     PIC XX.
  6827     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6828     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6829     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6830     12  AM-INACTIVE-DATE.
  6831         16  AM-INA-MO                     PIC 99.
  6832         16  AM-INA-DA                     PIC 99.
  6833         16  AM-INA-YR                     PIC 99.
  6834     12  AM-AR-HI-CERT-DATE                PIC XX.
  6835
  6836     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6837     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6838
  6839     12  AM-OB-PAYMENT-MODE                PIC X.
  6840         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6841         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6842         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6843         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6844
  6845     12  AM-AH-ONLY-INDICATOR              PIC X.
  6846         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6847         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6848
  6849     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6850
  6851     12  AM-OVER-SHORT.
  6852         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6853         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 126
* EL050.cbl
  6854
  6855     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6856     12  AM-DCC-CLP-STATE                  PIC XX.
  6857
  6858     12  AM-RECALC-COMM                    PIC X.
  6859     12  AM-RECALC-REIN                    PIC X.
  6860
  6861     12  AM-REI-TABLE                      PIC XXX.
  6862     12  AM-REI-ET-LF                      PIC X.
  6863     12  AM-REI-ET-AH                      PIC X.
  6864     12  AM-REI-PE-LF                      PIC X.
  6865     12  AM-REI-PE-AH                      PIC X.
  6866     12  AM-REI-PRT-ST                     PIC X.
  6867     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6868     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6869     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6870     12  AM-REI-GROUP-A                    PIC X(6).
  6871     12  AM-REI-MORT                       PIC X(4).
  6872     12  AM-REI-PRT-OW                     PIC X.
  6873     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6875     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6876     12  AM-REI-GROUP-B                    PIC X(6).
  6877
  6878     12  AM-TRUST-TYPE                     PIC X(2).
  6879
  6880     12  AM-EMPLOYER-STMT-USED             PIC X.
  6881     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6882
  6883     12  AM-STD-AH-TYPE                    PIC XX.
  6884     12  AM-EARN-METHODS.
  6885         16  AM-EARN-METHOD-R              PIC X.
  6886             88 AM-REF-RL-R78                 VALUE 'R'.
  6887             88 AM-REF-RL-PR                  VALUE 'P'.
  6888             88 AM-REF-RL-MEAN                VALUE 'M'.
  6889             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6890         16  AM-EARN-METHOD-L              PIC X.
  6891             88 AM-REF-LL-R78                 VALUE 'R'.
  6892             88 AM-REF-LL-PR                  VALUE 'P'.
  6893             88 AM-REF-LL-MEAN                VALUE 'M'.
  6894             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6895         16  AM-EARN-METHOD-A              PIC X.
  6896             88 AM-REF-AH-R78                 VALUE 'R'.
  6897             88 AM-REF-AH-PR                  VALUE 'P'.
  6898             88 AM-REF-AH-MEAN                VALUE 'M'.
  6899             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6900             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6901             88 AM-REF-AH-NET                 VALUE 'N'.
  6902
  6903     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6904     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6905     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6906
  6907     12  AM-RET-Y-N                        PIC X.
  6908     12  AM-RET-P-E                        PIC X.
  6909     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6910     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6911     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 127
* EL050.cbl
  6912     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6913         16  AM-POOL-PRIME                 PIC XXX.
  6914         16  AM-POOL-SUB                   PIC XXX.
  6915     12  AM-RETRO-EARNINGS.
  6916         16  AM-RET-EARN-R                 PIC X.
  6917         16  AM-RET-EARN-L                 PIC X.
  6918         16  AM-RET-EARN-A                 PIC X.
  6919     12  AM-RET-ST-TAX-USE                 PIC X.
  6920         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6921         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6922     12  AM-RETRO-BEG-EARNINGS.
  6923         16  AM-RET-BEG-EARN-R             PIC X.
  6924         16  AM-RET-BEG-EARN-L             PIC X.
  6925         16  AM-RET-BEG-EARN-A             PIC X.
  6926     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6927     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6928
  6929     12  AM-USER-SELECT-OPTIONS.
  6930         16  AM-USER-SELECT-1              PIC X(10).
  6931         16  AM-USER-SELECT-2              PIC X(10).
  6932         16  AM-USER-SELECT-3              PIC X(10).
  6933         16  AM-USER-SELECT-4              PIC X(10).
  6934         16  AM-USER-SELECT-5              PIC X(10).
  6935
  6936     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6937
  6938     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6939
  6940     12  AM-RPT045A-SWITCH                 PIC X.
  6941         88  RPT045A-OFF                   VALUE 'N'.
  6942
  6943     12  AM-INSURANCE-LIMITS.
  6944         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6945         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6946
  6947     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6948         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6949
  6950     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6951         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6952         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6953
  6954     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6955
  6956     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6957     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6958     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6959     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6960     12  AM-DCC-UEF-STATE                  PIC XX.
  6961     12  FILLER                            PIC XXX.
  6962     12  AM-REPORT-CODE-3                  PIC X(10).
  6963*    12  FILLER                            PIC X(22).
  6964
  6965     12  AM-RESERVE-DATE.
  6966         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6967         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6968         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6969
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 128
* EL050.cbl
  6970     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6971     12  AM-NOTIFICATION-TYPES.
  6972         16  AM-NOTIF-OF-LETTERS           PIC X.
  6973         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6974         16  AM-NOTIF-OF-REPORTS           PIC X.
  6975         16  AM-NOTIF-OF-STATUS            PIC X.
  6976
  6977     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6978         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6979         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6980         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6981         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6982
  6983     12  AM-BENEFIT-CONTROLS.
  6984         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6985             20  AM-BENEFIT-CODE           PIC XX.
  6986             20  AM-BENEFIT-TYPE           PIC X.
  6987             20  AM-BENEFIT-REVISION       PIC XXX.
  6988             20  AM-BENEFIT-REM-TERM       PIC X.
  6989             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6990             20  FILLER                    PIC XX.
  6991         16  FILLER                        PIC X(80).
  6992
  6993     12  AM-TRANSFER-DATA.
  6994         16  AM-TRANSFERRED-FROM.
  6995             20  AM-TRNFROM-CARRIER        PIC X.
  6996             20  AM-TRNFROM-GROUPING.
  6997                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6998                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6999             20  AM-TRNFROM-STATE          PIC XX.
  7000             20  AM-TRNFROM-ACCOUNT.
  7001                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7002                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7003             20  AM-TRNFROM-DTE            PIC XX.
  7004         16  AM-TRANSFERRED-TO.
  7005             20  AM-TRNTO-CARRIER          PIC X.
  7006             20  AM-TRNTO-GROUPING.
  7007                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7008                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7009             20  AM-TRNTO-STATE            PIC XX.
  7010             20  AM-TRNTO-ACCOUNT.
  7011                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7012                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7013             20  AM-TRNTO-DTE              PIC XX.
  7014         16  FILLER                        PIC X(10).
  7015
  7016     12  AM-SAVED-REMIT-TO                 PIC 99.
  7017
  7018     12  AM-COMM-STRUCTURE-SAVED.
  7019         16  AM-DEFN-1-SAVED.
  7020             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7021                 24  AM-AGT-SV             PIC X(10).
  7022                 24  AM-COM-TYP-SV         PIC X.
  7023                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7024                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7025                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7026                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7027                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 129
* EL050.cbl
  7028                 24  AM-GL-CODES-SV        PIC X.
  7029                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7030                 24  FILLER                PIC X.
  7031         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7032             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7033                 24  FILLER                PIC X(11).
  7034                 24  AM-L-COMA-SV          PIC XXX.
  7035                 24  AM-J-COMA-SV          PIC XXX.
  7036                 24  AM-A-COMA-SV          PIC XXX.
  7037                 24  FILLER                PIC X(6).
  7038
  7039     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7040         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7041            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7042            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7043            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7044
  7045     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7046     12  FILLER                            PIC X(120).
  7047
  7048     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7049         16  AM-CONTROL-NAME               PIC X(30).
  7050         16  AM-EXECUTIVE-ONE.
  7051             20  AM-EXEC1-NAME             PIC X(15).
  7052             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7053                                                          COMP-3.
  7054             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7055                                                          COMP-3.
  7056         16  AM-EXECUTIVE-TWO.
  7057             20  AM-EXEC2-NAME             PIC X(15).
  7058             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7061                                                          COMP-3.
  7062
  7063     12  AM-RETRO-ADDITIONAL-DATA.
  7064         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7065         16  AM-RETRO-PREM-P-E             PIC X.
  7066         16  AM-RETRO-CLMS-P-I             PIC X.
  7067         16  AM-RETRO-RET-BRACKET-LF.
  7068             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7069                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7070                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7071             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7072                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7073                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7074             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7075                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7076                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7077         16  AM-RETRO-RET-BRACKET-AH.
  7078             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7079                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7080                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7081                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7082             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7083                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7084                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7085             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 130
* EL050.cbl
  7086                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7087                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7088
  7089     12  AM-COMMENTS.
  7090         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7091
  7092     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7093         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7094         16  AM-FLI-BILLING-CODE           PIC X.
  7095         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7096         16  AM-FLI-UNITED-IDENT           PIC X.
  7097         16  AM-FLI-INTEREST-LOST-DATA.
  7098             20  AM-FLI-BANK-NO            PIC X(5).
  7099             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7100             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7101             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7102         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7103             20  AM-FLI-AGT                PIC X(9).
  7104             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7105             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7106         16  FILLER                        PIC X(102).
  7107
  7108     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7109         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7110             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7111             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7112             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7113             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7114             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7115         16  FILLER                          PIC X(10).
  7116******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 131
* EL050.cbl
  7118*    COPY ERCREIN.
  7119******************************************************************
  7120*                                                                *
  7121*                            ERCREIN                             *
  7122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7123*                            VMOD=2.010                          *
  7124*                                                                *
  7125*   ONLINE CREDIT SYSTEM                                         *
  7126*                                                                *
  7127*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7128*                                                                *
  7129*   FILE TYPE = VSAM,KSDS                                        *
  7130*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7131*                                                                *
  7132*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7133*       ALTERNATE PATH = NONE                                    *
  7134*                                                                *
  7135*   LOG = NO                                                     *
  7136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7137*                                                                *
  7138******************************************************************
  7139*                   C H A N G E   L O G
  7140*
  7141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7142*-----------------------------------------------------------------
  7143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7144* EFFECTIVE    NUMBER
  7145*-----------------------------------------------------------------
  7146* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7147* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7148******************************************************************
  7149 01  REINSURANCE-RECORD.
  7150     12  RE-RECORD-ID                      PIC XX.
  7151         88  VALID-RE-ID                      VALUE 'RE'.
  7152
  7153     12  RE-CONTROL-PRIMARY.
  7154         16  RE-COMPANY-CD                 PIC X.
  7155         16  RE-KEY.
  7156             20  RE-CODE                   PIC X.
  7157                 88  RE-TABLE-RECORD          VALUE 'A'.
  7158                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7159             20  RE-TABLE                  PIC XXX.
  7160             20  FILLER                    PIC XXX.
  7161         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7162             20  FILLER                    PIC X.
  7163             20  RE-COMPANY.
  7164                 24  RE-COMP-PRIME         PIC XXX.
  7165                 24  RE-COMP-SUB           PIC XXX.
  7166
  7167     12  RE-MAINT-INFORMATION.
  7168         16  RE-LAST-MAINT-DT              PIC XX.
  7169         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7170         16  RE-LAST-MAINT-USER            PIC X(4).
  7171         16  FILLER                        PIC X(10).
  7172
  7173     12  RE-TABLE-DATA.
  7174         16  RE-100-COMP                   PIC 99.
  7175
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 132
* EL050.cbl
  7176         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7177             20  RE-REI-COMP-NO.
  7178                 24  RE-REI-COMP           PIC XXX.
  7179                 24  RE-REI-COMP-SUB       PIC XXX.
  7180             20  RE-LF-QC                  PIC X.
  7181             20  RE-AH-QC                  PIC X.
  7182             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7183             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7184             20  RE-LFAGE-LO               PIC 99.
  7185             20  RE-LFAGE-HI               PIC 99.
  7186             20  RE-AHAGE-LO               PIC 99.
  7187             20  RE-AHAGE-HI               PIC 99.
  7188             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7189             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7190             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7191             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7192             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7193             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7194             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7195             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7196             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7197             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7198             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7199             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7200             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7201             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7202             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7203             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7204             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7205             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7206             20  RE-LF-BEN-CODE            PIC X.
  7207             20  RE-AH-BEN-CODE            PIC X.
  7208             20  RE-INTERACTIVE            PIC X.
  7209             20  RE-REMAINING              PIC X.
  7210             20  RE-LF-RUNOFF-SW           PIC X.
  7211             20  RE-AH-RUNOFF-SW           PIC X.
  7212             20  FILLER                    PIC X(19).
  7213
  7214         16  RE-COMP-INFO-END              PIC X(6).
  7215         16  RE-NSP-ST-CD-LF               PIC XX.
  7216         16  RE-NSP-ST-CD-AH               PIC XX.
  7217         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7218             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7219
  7220         16  FILLER                        PIC X(27).
  7221
  7222     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7223         16  RE-NAME                       PIC X(30).
  7224         16  RE-LF-PE                      PIC X.
  7225         16  RE-AH-PE                      PIC X.
  7226         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7227         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7228         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7229         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7230         16  RE-PRT-ST                     PIC X.
  7231         16  RE-PRT-OW                     PIC X.
  7232         16  RE-MORT-CODE                  PIC X(4).
  7233         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 133
* EL050.cbl
  7234         16  RE-ZERO-LF-FEE                PIC X.
  7235         16  RE-ZERO-AH-FEE                PIC X.
  7236         16  RE-CEDE-NAME                  PIC X(30).
  7237         16  RE-LF-COMM                    PIC X.
  7238         16  RE-AH-COMM                    PIC X.
  7239         16  RE-LF-TAX                     PIC X.
  7240         16  RE-AH-TAX                     PIC X.
  7241         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7242         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7243         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7244
  7245         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7246             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7247
  7248         16  RE-LF-CEDING-FEE-BRACKETS.
  7249             20  RE-LF-FEE-METHOD          PIC X.
  7250                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7251                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7252                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7253                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7254             20  RE-LF-FEE-BASIS           PIC X.
  7255                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7256                 88  RE-LF-NET-CEDED               VALUE '2'.
  7257                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7258                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7259                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7260                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7261                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7262                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7263             20  FILLER                    PIC XXX.
  7264             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7265                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7266                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7267
  7268         16  RE-AH-CEDING-FEE-BRACKETS.
  7269             20  RE-AH-FEE-METHOD          PIC X.
  7270                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7271                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7272                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7273                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7274             20  RE-AH-FEE-BASIS           PIC X.
  7275                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7276                 88  RE-AH-NET-CEDED               VALUE '2'.
  7277                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7278                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7279                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7280                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7281                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7282                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7283             20  FILLER                    PIC XXX.
  7284             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7285                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7286                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7287
  7288         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7289
  7290         16  RE-OLD-CEDING-STMT            PIC X.
  7291
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 134
* EL050.cbl
  7292         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7293         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7294         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7295         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7296         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7297         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7298         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7299         16  RE-MORT-SW                    PIC X.
  7300         16  RE-CEDING-TYPE-FLAG           PIC X.
  7301             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7302             88  RE-CEDED                          VALUE 'C'.
  7303             88  RE-ASSUMED                        VALUE 'A'.
  7304             88  RE-PHANTOM                        VALUE 'P'.
  7305
  7306         16  RE-CEDING-STMT-OPT-A          PIC X.
  7307             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7308         16  RE-CEDING-STMT-OPT-B          PIC X.
  7309             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7310         16  RE-CEDING-STMT-OPT-C          PIC X.
  7311             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7312         16  RE-CEDING-STMT-OPT-D          PIC X.
  7313             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7314         16  RE-CEDING-STMT-OPT-E          PIC X.
  7315             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7316
  7317         16  RE-PRT-CRSV                   PIC X.
  7318
  7319         16  RE-GL-CENTER                  PIC X(4).
  7320
  7321         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7322
  7323         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7324
  7325         16  RE-EARN-STOP-CODE             PIC X.
  7326             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7327             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7328
  7329         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7330             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7331
  7332         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7333         16  FILLER                        PIC X(2281).
  7334
  7335         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7336
  7337******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 135
* EL050.cbl
  7339*    COPY ERCCTBL.
  7340******************************************************************
  7341*                                                                *
  7342*                                                                *
  7343*                            ERCCTBL                             *
  7344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7345*                            VMOD=2.003
  7346*                                                                *
  7347*   ONLINE CREDIT SYSTEM                                         *
  7348*                                                                *
  7349*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7350*                                                                *
  7351*   FILE TYPE = VSAM,KSDS                                        *
  7352*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7353*                                                                *
  7354*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7355*       ALTERNATE PATH = NONE                                    *
  7356*                                                                *
  7357*   LOG = NO                                                     *
  7358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7359*                                                                *
  7360*                                                                *
  7361******************************************************************
  7362
  7363 01  COMM-TABLE-RECORD.
  7364     12  CT-RECORD-ID                      PIC XX.
  7365         88  VALID-CT-ID                      VALUE 'CT'.
  7366
  7367     12  CT-CONTROL-PRIMARY.
  7368         16  CT-COMPANY-CD                 PIC X.
  7369         16  CT-TABLE                      PIC XXX.
  7370         16  CT-CNTRL-2.
  7371             20  CT-BEN-TYPE               PIC X.
  7372             20  CT-BEN-CODE               PIC XX.
  7373
  7374     12  CT-MAINT-INFORMATION.
  7375         16  CT-LAST-MAINT-DT              PIC XX.
  7376         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7377         16  CT-LAST-MAINT-USER            PIC X(4).
  7378         16  FILLER                        PIC X(31).
  7379
  7380     12  CT-LIMITS.
  7381         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7382
  7383         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7384
  7385         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7386
  7387     12  CT-RATES.
  7388         16  CT-RTX          OCCURS 27 TIMES.
  7389             20  CT-RT                     PIC SV9(5)     COMP-3.
  7390             20  CT-RT-R   REDEFINES
  7391                 CT-RT                     PIC XXX.
  7392
  7393     12  FILLER                            PIC  X(42).
  7394
  7395******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 136
* EL050.cbl
  7397*    COPY ERCFORM.
  7398******************************************************************
  7399*                                                                *
  7400*                                                                *
  7401*                            ERCFORM.                            *
  7402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7403*                            VMOD=2.003                          *
  7404*                                                                *
  7405*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7406*                                                                *
  7407*    FILE TYPE = VSAM,KSDS                                       *
  7408*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7409*                                                                *
  7410*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7411*                                                                *
  7412*    LOG = YES                                                   *
  7413*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7414******************************************************************
  7415 01  FORM-MASTER.
  7416    12  FO-RECORD-ID                 PIC X(02).
  7417        88  VALID-FO-ID                  VALUE 'FO'.
  7418
  7419    12  FO-CONTROL-PRIMARY.
  7420        16  FO-COMPANY-CD            PIC X(01).
  7421        16  FO-STATE                 PIC X(02).
  7422        16  FO-FORM-ID               PIC X(12).
  7423        16  FO-FORM-EXP-DT           PIC X(02).
  7424
  7425    12  FO-POLICY-FORM-DATA.
  7426        16  FO-IND-GRP-CD            PIC X(01).
  7427        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7428        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7429        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7430        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7431        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7432        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7433        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7434        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7435        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7436        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7437        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7438        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7439        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7440        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7441        16  FO-APP-CERT-USE-CD       PIC X(01).
  7442
  7443    12  FILLER                       PIC X(29).
  7444
  7445    12  FO-FORM-PLAN-TABLE.
  7446        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7447            20  FO-PLAN-TYPE         PIC X(01).
  7448            20  FO-PLAN-ID           PIC X(02).
  7449            20  FO-PLAN-TERM         PIC 9(03).
  7450            20  FO-PLAN-REFUND-METHOD
  7451                                     PIC X.
  7452
  7453    12  FILLER                       PIC X(30).
  7454
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 137
* EL050.cbl
  7455    12  FO-COMMENTS-AREA.
  7456        16  FO-COMMENT-LINE-1        PIC X(78).
  7457
  7458    12  FILLER                       PIC X(20).
  7459
  7460    12  FO-MAINT-INFORMATION.
  7461        16  FO-LAST-MAINT-DT         PIC X(02).
  7462        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7463        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 138
* EL050.cbl
  7465*    COPY ELCMSTR.
  7466******************************************************************
  7467*                                                                *
  7468*                            ELCMSTR.                            *
  7469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7470*                            VMOD=2.012                          *
  7471*                                                                *
  7472*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7473*                                                                *
  7474*   FILE TYPE = VSAM,KSDS                                        *
  7475*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7476*                                                                *
  7477*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7478*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7479*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7480*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7481*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7482*                                                 RKP=75,LEN=21  *
  7483*                                                                *
  7484*   **** NOTE ****                                               *
  7485*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7486*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7487*                                                                *
  7488*   LOG = YES                                                    *
  7489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7490******************************************************************
  7491*                   C H A N G E   L O G
  7492*
  7493* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7494*-----------------------------------------------------------------
  7495*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7496* EFFECTIVE    NUMBER
  7497*-----------------------------------------------------------------
  7498* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7499* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7500* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7501* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7502* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7503* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7504******************************************************************
  7505 01  CLAIM-MASTER.
  7506     12  CL-RECORD-ID                PIC XX.
  7507         88  VALID-CL-ID         VALUE 'CL'.
  7508
  7509     12  CL-CONTROL-PRIMARY.
  7510         16  CL-COMPANY-CD           PIC X.
  7511         16  CL-CARRIER              PIC X.
  7512         16  CL-CLAIM-NO             PIC X(7).
  7513         16  CL-CERT-NO.
  7514             20  CL-CERT-PRIME       PIC X(10).
  7515             20  CL-CERT-SFX         PIC X.
  7516
  7517     12  CL-CONTROL-BY-NAME.
  7518         16  CL-COMPANY-CD-A1        PIC X.
  7519         16  CL-INSURED-LAST-NAME    PIC X(15).
  7520         16  CL-INSURED-NAME.
  7521             20  CL-INSURED-1ST-NAME PIC X(12).
  7522             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 139
* EL050.cbl
  7523
  7524     12  CL-CONTROL-BY-SSN.
  7525         16  CL-COMPANY-CD-A2        PIC X.
  7526         16  CL-SOC-SEC-NO.
  7527             20  CL-SSN-STATE        PIC XX.
  7528             20  CL-SSN-ACCOUNT      PIC X(6).
  7529             20  CL-SSN-LN3          PIC X(3).
  7530
  7531     12  CL-CONTROL-BY-CERT-NO.
  7532         16  CL-COMPANY-CD-A4        PIC X.
  7533         16  CL-CERT-NO-A4.
  7534             20  CL-CERT-A4-PRIME    PIC X(10).
  7535             20  CL-CERT-A4-SFX      PIC X.
  7536
  7537     12  CL-CONTROL-BY-CCN.
  7538         16  CL-COMPANY-CD-A5        PIC X.
  7539         16  CL-CCN-A5.
  7540             20  CL-CCN.
  7541                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7542                 24  CL-CCN-PRIME-A5 PIC X(12).
  7543             20  CL-CCN-FILLER-A5    PIC X(4).
  7544
  7545     12  CL-INSURED-PROFILE-DATA.
  7546         16  CL-INSURED-BIRTH-DT     PIC XX.
  7547         16  CL-INSURED-SEX-CD       PIC X.
  7548             88  INSURED-IS-MALE        VALUE 'M'.
  7549             88  INSURED-IS-FEMALE      VALUE 'F'.
  7550             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7551         16  CL-INSURED-OCC-CD       PIC X(6).
  7552         16  FILLER                  PIC X(5).
  7553
  7554     12  CL-PROCESSING-INFO.
  7555         16  CL-PROCESSOR-ID         PIC X(4).
  7556         16  CL-CLAIM-STATUS         PIC X.
  7557             88  CLAIM-IS-OPEN          VALUE 'O'.
  7558             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7559         16  CL-CLAIM-TYPE           PIC X.
  7560*            88  AH-CLAIM               VALUE 'A'.
  7561*            88  LIFE-CLAIM             VALUE 'L'.
  7562*            88  PROPERTY-CLAIM         VALUE 'P'.
  7563*            88  IUI-CLAIM              VALUE 'I'.
  7564*            88  GAP-CLAIM              VALUE 'G'.
  7565*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7566         16  CL-CLAIM-PREM-TYPE      PIC X.
  7567             88  SINGLE-PREMIUM         VALUE '1'.
  7568             88  O-B-COVERAGE           VALUE '2'.
  7569             88  OPEN-END-COVERAGE      VALUE '3'.
  7570         16  CL-INCURRED-DT          PIC XX.
  7571         16  CL-REPORTED-DT          PIC XX.
  7572         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7573         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7574         16  CL-LAST-PMT-DT          PIC XX.
  7575         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7576         16  CL-PAID-THRU-DT         PIC XX.
  7577         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7578         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7579         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7580         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 140
* EL050.cbl
  7581             88  CL-360-DAY-YR          VALUE '1'.
  7582             88  CL-365-DAY-YR          VALUE '2'.
  7583             88  CL-FULL-MONTHS         VALUE '3'.
  7584         16  CL-CAUSE-CD             PIC X(6).
  7585
  7586         16  CL-PRIME-CERT-NO.
  7587             20  CL-PRIME-CERT-PRIME PIC X(10).
  7588             20  CL-PRIME-CERT-SFX   PIC X.
  7589
  7590         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7591             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7592             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7593
  7594         16  CL-MICROFILM-NO         PIC X(10).
  7595         16  FILLER REDEFINES CL-MICROFILM-NO.
  7596             20  CL-BENEFIT-PERIOD   PIC 99.
  7597             20  FILLER              PIC X(8).
  7598         16  CL-PROG-FORM-TYPE       PIC X.
  7599         16  CL-LAST-ADD-ON-DT       PIC XX.
  7600
  7601         16  CL-LAST-REOPEN-DT       PIC XX.
  7602         16  CL-LAST-CLOSE-DT        PIC XX.
  7603         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7604             88  FINAL-PAID             VALUE '1'.
  7605             88  CLAIM-DENIED           VALUE '2'.
  7606             88  AUTO-CLOSE             VALUE '3'.
  7607             88  MANUAL-CLOSE           VALUE '4'.
  7608             88  BENEFITS-CHANGED       VALUE 'C'.
  7609             88  SETUP-ERRORS           VALUE 'E'.
  7610         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7611         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7612         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7613             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7614         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7615         16  FILLER                  PIC X.
  7616
  7617     12  CL-CERTIFICATE-DATA.
  7618         16  CL-CERT-ORIGIN          PIC X.
  7619             88  CERT-WAS-ONLINE        VALUE '1'.
  7620             88  CERT-WAS-CREATED       VALUE '2'.
  7621             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7622         16  CL-CERT-KEY-DATA.
  7623             20  CL-CERT-CARRIER     PIC X.
  7624             20  CL-CERT-GROUPING    PIC X(6).
  7625             20  CL-CERT-STATE       PIC XX.
  7626             20  CL-CERT-ACCOUNT.
  7627                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7628                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7629             20  CL-CERT-EFF-DT      PIC XX.
  7630
  7631     12  CL-STATUS-CONTROLS.
  7632         16  CL-PRIORITY-CD          PIC X.
  7633             88  CONFIDENTIAL-DATA      VALUE '8'.
  7634             88  HIGHEST-PRIORITY       VALUE '9'.
  7635         16  CL-SUPV-ATTN-CD         PIC X.
  7636             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7637             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7638         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 141
* EL050.cbl
  7639         16  CL-RESTORED-DT          PIC XX.
  7640         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7641         16  CL-NEXT-RESEND-DT       PIC XX.
  7642         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7643         16  CL-CRITICAL-PERIOD      PIC 99.
  7644*        16  FILLER                  PIC XX.
  7645         16  CL-LAST-MAINT-DT        PIC XX.
  7646         16  CL-LAST-MAINT-USER      PIC X(4).
  7647         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7648         16  CL-LAST-MAINT-TYPE      PIC X.
  7649             88  CLAIM-SET-UP           VALUE ' '.
  7650             88  PAYMENT-MADE           VALUE '1'.
  7651             88  LETTER-SENT            VALUE '2'.
  7652             88  MASTER-WAS-ALTERED     VALUE '3'.
  7653             88  MASTER-WAS-RESTORED    VALUE '4'.
  7654             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7655             88  FILE-CONVERTED         VALUE '6'.
  7656             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7657             88  ERROR-CORRECTION       VALUE 'E'.
  7658         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7659         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7660         16  CL-BENEFICIARY          PIC X(10).
  7661         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7662         16  CL-DENIAL-TYPE          PIC X.
  7663             88  CL-TYPE-DENIAL          VALUE '1'.
  7664             88  CL-TYPE-RESCISSION      VALUE '2'.
  7665             88  CL-TYPE-REFORMATION     VALUE '3'.
  7666             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7667             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7668         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7669         16  filler                  pic x(3).
  7670*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7671*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7672*        16  CL-RTW-DT               PIC XX.
  7673
  7674     12  CL-TRAILER-CONTROLS.
  7675         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7676             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7677             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7678             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7679         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7680         16  FILLER                  PIC XX.
  7681         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7682         16  CL-ADDRESS-TRAILER-CNT.
  7683             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7684                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7685             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7686                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7687             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7688                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7689             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7690                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7691             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7692                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7693             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7694                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7695             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7696                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 142
* EL050.cbl
  7697
  7698     12  CL-CV-REFERENCE-NO.
  7699         16  CL-CV-REFNO-PRIME       PIC X(18).
  7700         16  CL-CV-REFNO-SFX         PIC XX.
  7701
  7702     12  CL-FILE-LOCATION            PIC X(4).
  7703
  7704     12  CL-PROCESS-ERRORS.
  7705         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7706             88  NO-FATAL-ERRORS        VALUE ZERO.
  7707         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7708             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7709
  7710     12  CL-PRODUCT-CD               PIC X.
  7711
  7712     12  CL-CURRENT-KEY-DATA.
  7713         16  CL-CURRENT-CARRIER      PIC X.
  7714         16  CL-CURRENT-GROUPING     PIC X(6).
  7715         16  CL-CURRENT-STATE        PIC XX.
  7716         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7717
  7718     12  CL-ASSOCIATES               PIC X.
  7719         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7720         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7721         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7722         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7723
  7724     12  CL-ACTIVITY-CODE            PIC 99.
  7725     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7726     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7727
  7728     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7729     12  CL-LAG-REPORT-CODE          PIC 9.
  7730     12  CL-LOAN-TYPE                PIC XX.
  7731     12  CL-LEGAL-STATE              PIC XX.
  7732
  7733     12  CL-YESNOSW                  PIC X.
  7734     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7735         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7736         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7737         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7738     12  cl-insured-type             pic x.
  7739         88  cl-claim-on-primary         value 'P'.
  7740         88  cl-claim-on-co-borrower     value 'C'.
  7741     12  cl-benefit-expiration-dt    PIC XX.
  7742
  7743 01  PLAN-RECORDS.
  7744     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7745     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7746
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 143
* EL050.cbl
  7748 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7749                          ACCOUNT-MASTER REINSURANCE-RECORD
  7750                          COMM-TABLE-RECORD FORM-MASTER
  7751                          CLAIM-MASTER PLAN-RECORDS.
  7752 0000-DFHEXIT SECTION.
  7753     MOVE '9#                    $   ' TO DFHEIV0.
  7754     MOVE 'EL050' TO DFHEIV1.
  7755     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7756
  7757     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7758
  7759
  7760* EXEC CICS  HANDLE CONDITION
  7761*           ERROR    (9300-ABEND)
  7762*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7763*    END-EXEC.
  7764*    MOVE '"$.J                  ! " #00007755' TO DFHEIV0
  7765     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7767     MOVE X'2220233030303037373535' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7770
  7771
  7772 0000-COPY-PROCEDURE-DIV.
  7773*                          COPY ELC50PD.
  7774******************************************************************
  7775*                                                                *
  7776*                            ELC50PD                             *
  7777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7778*                            VMOD=2.188                          *
  7779*                                                                *
  7780******************************************************************
  7781*                   C H A N G E   L O G
  7782*
  7783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7784*-----------------------------------------------------------------
  7785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7786* EFFECTIVE    NUMBER
  7787*-----------------------------------------------------------------
  7788* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7789* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7790* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7791*                             2709 AND 2718
  7792* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7793* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7794* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7795* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7796* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7797*                                IS OPEN OR CNC DT < PD THRU
  7798* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7799* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7800* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7801* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7802* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7803* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7804* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7805* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 144
* EL050.cbl
  7806* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7807* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7808* 020906                   PEMA  EXPAND LOAN OFFICER
  7809* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7810* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7811* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7812* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7813* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7814* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7815* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7816* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7817* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7818* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7819* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7820* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7821* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7822* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7823* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7824* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7825* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7826* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7827* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7828* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7829* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7830* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7831* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7832* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7833* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7834*                                UPDATE VIN ON CERT TRAILER
  7835* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7836* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7837* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7838* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7839* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7840* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7841* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7842* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7843* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7844* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7845* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7846* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7847* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7848* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7849* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7850* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7851* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7852* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7853* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7854* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7855* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7856* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7857* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7858* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7859* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7860* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7861* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7862* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7863* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 145
* EL050.cbl
  7864* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7865* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7866* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7867* 032912  CR2011110200001  PEMA  AHL CHANGES
  7868* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7869* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7870* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7871* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7872* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7873* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7874* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7875* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7876* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7877* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7878* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7879* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7880* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7881* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7882* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7883* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7884* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7885* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7886* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7887* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7888* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7889* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7890* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7891* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7892* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7893* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7894* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7895*                                CERT #, ADD 2898 FORCIBLE ERROR
  7896* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7897* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7898* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7899* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7900* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7901* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7902* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7903* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7904* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7905* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7906* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7907* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7908* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7909* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7910* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7911* 100617  CR2017062000003  PEMA  New comm cap edits
  7912* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7913* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7914* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7915******************************************************************
  7916************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7917******************************************************************
  7918
  7919     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7920
  7921     MOVE SPACES                 TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 146
* EL050.cbl
  7922                                    PB-FORCE-ER-CD
  7923                                    PB-WARN-ER-CD
  7924                                    PB-OUT-BAL-CD.
  7925
  7926     MOVE SPACE                  TO WS-IG-OVRD-AH
  7927                                    WS-IG-OVRD-LF
  7928                                    WS-IG-OVRD-AM
  7929                                    WS-IG-OVRD
  7930                                    WS-IG-OVRD-AH-PL
  7931                                    WS-IG-OVRD-LF-PL
  7932                                    WS-IG-OVRD-AH-BEN
  7933                                    WS-IG-OVRD-LF-BEN.
  7934
  7935******************************************************************
  7936*************       INITIALIZE COMMON ERRORS       ***************
  7937******************************************************************
  7938
  7939     MOVE +0                     TO PB-NO-OF-ERRORS.
  7940     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7941
  7942******************************************************************
  7943
  7944     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7945     SET JULIAN-TO-BIN           TO TRUE.
  7946*    MOVE 5                      TO DC-OPTION-CODE.
  7947     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7948     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7949
  7950     MOVE ZERO                   TO  SUB4.
  7951
  7952 0040-INITIALIZE-GA-BILL-DT.
  7953
  7954     ADD +1                      TO  SUB4.
  7955
  7956     IF  SUB4 GREATER THAN +5
  7957         GO TO 0050-CHECK-CNTL-FOUND.
  7958
  7959     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7960         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7961
  7962     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7963
  7964 0050-CHECK-CNTL-FOUND.
  7965
  7966     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7967        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7968                                         WS-AH-REM-TERM-CALC
  7969                                         EC-CO-REM-TERM-CALC
  7970        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7971        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7972        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7973                                         WS-TOL-AH-CLAIM
  7974        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7975                                         WS-TOL-AH-PREM
  7976                                         EC-CO-TOL-PREM
  7977        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7978                                         WS-TOL-AH-REFUND
  7979                                         EC-CO-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 147
* EL050.cbl
  7980        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7981                                         WS-AH-REFUND-OVS-AMT
  7982                                         EC-CO-OVR-SHT-AMT
  7983        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7984                                         WS-TOL-AH-PREM-PCT
  7985                                         EC-CO-TOL-PREM-PCT
  7986        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7987                                         WS-TOL-AH-REFUND-PCT
  7988                                         EC-CO-TOL-REFUND-PCT
  7989        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7990                                         WS-AH-REFUND-OVS-PCT
  7991                                         EC-CO-OVR-SHT-PCT
  7992        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7993        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7994        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7995        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7996        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7997        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7998        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7999        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8000        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8001        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8002        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8003        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8004                                         EC-CO-MONTH-END-DT
  8005        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8006          GO TO 0100-READ-ACCT.
  8007
  8008     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8009     MOVE SPACES                 TO CNTL-ACCESS.
  8010     MOVE '1'                    TO CNTL-REC-TYPE.
  8011     MOVE +0                     TO CNTL-SEQ-NO.
  8012
  8013     MOVE '1' TO RC-SW-1.
  8014     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8015     IF NOT CF-COMPANY-MASTER
  8016         MOVE ZEROS             TO WK-CO-TOL-PREM
  8017                                   WK-CO-TOL-CLAIM
  8018                                   WK-CO-TOL-REFUND
  8019                                   WK-REFUND-OVS-AMT
  8020                                   WK-REFUND-OVS-PCT
  8021                                   WK-CO-TOL-PREM-PCT
  8022                                   WK-CO-TOL-REFUND-PCT
  8023                                   WK-DEFAULT-APR
  8024                                   WK-CO-MAX-CAP
  8025        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8026                                   WK-CR-R78-METHOD
  8027                                   WK-CO-REF-REJECT-SW
  8028                                   WK-CO-PREM-REJECT-SW
  8029                                   WK-REM-TRM-CALC-OPTION
  8030                                   WK-BIRTH-DATE-INPUT
  8031                                   WK-JOINT-AGE-INPUT
  8032        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8033        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8034        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8035        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8036          GO TO 0099-COMPANY-NOT-FOUND.
  8037
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 148
* EL050.cbl
  8038     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8039        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8040     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8041        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8042     IF CF-CO-TOL-CAP NOT NUMERIC
  8043        MOVE +0                    TO CF-CO-TOL-CAP.
  8044     IF CF-DEFAULT-APR NOT NUMERIC
  8045        MOVE +0                    TO CF-DEFAULT-APR.
  8046
  8047     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8048     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8049     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8050     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8051     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8052     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8053     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8054     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8055     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8056     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8057     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8058     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8059
  8060     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8061          CF-CO-OVR-SHT-AMT > +0
  8062        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8063
  8064     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8065          CF-CO-OVR-SHT-PCT > +0
  8066        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8067
  8068     IF CF-VALID-REM-TRM-OPTION
  8069         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8070     ELSE
  8071         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8072
  8073     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8074     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8075     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8076     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8077
  8078     GO TO 0050-CHECK-CNTL-FOUND.
  8079
  8080 0099-COMPANY-NOT-FOUND.
  8081
  8082     MOVE ER-2616                TO WS-ERROR.
  8083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8084
  8085 0100-READ-ACCT.
  8086
  8087     MOVE SPACES                 TO DATE-RANGE-SW.
  8088
  8089     IF WK-ACCT-ADDR = ZEROS
  8090        GO TO 0102-ACCT-GETMAIN.
  8091
  8092     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8093     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8094     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8095
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 149
* EL050.cbl
  8096     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8097        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8098        GO TO 0105-READ-ACCT
  8099     END-IF
  8100
  8101     IF PB-CARRIER NOT = SPACES
  8102        IF PB-CARRIER NOT = AM-VG-CARRIER
  8103           GO TO 0105-READ-ACCT.
  8104
  8105     IF PB-STATE NOT = SPACES
  8106        IF PB-STATE NOT = AM-VG-STATE
  8107           GO TO 0105-READ-ACCT.
  8108
  8109     IF PB-GROUPING NOT = SPACES
  8110        IF PB-GROUPING NOT = AM-VG-GROUPING
  8111           GO TO 0105-READ-ACCT.
  8112
  8113     MOVE 'X'                 TO DATE-RANGE-SW.
  8114
  8115     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8116        MOVE 'X'                 TO DATE-RANGE-SW
  8117        GO TO 0105-READ-ACCT.
  8118
  8119     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8120        GO TO 0105-READ-ACCT.
  8121
  8122     GO TO 0180-ACCOUNT-FOUND.
  8123
  8124 0102-ACCT-GETMAIN.
  8125     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8126     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8127
  8128 0105-READ-ACCT.
  8129     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8130     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8131     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8132     MOVE PB-STATE               TO ACCT-STATE.
  8133     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8134     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8135
  8136     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8137
  8138     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8139
  8140 0110-FIND-ACCT-TOLERANCES-LOOP.
  8141     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8142
  8143     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8144        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8145        GO TO 0199-ACCT-NOT-FOUND
  8146     END-IF
  8147     IF PB-CARRIER NOT = SPACES
  8148        IF PB-CARRIER NOT = AM-VG-CARRIER
  8149           GO TO 0199-ACCT-NOT-FOUND.
  8150
  8151     IF PB-STATE NOT = SPACES
  8152        IF PB-STATE NOT = AM-VG-STATE
  8153           GO TO 0199-ACCT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 150
* EL050.cbl
  8154
  8155     IF PB-GROUPING NOT = SPACES
  8156        IF PB-GROUPING NOT = AM-VG-GROUPING
  8157           GO TO 0199-ACCT-NOT-FOUND.
  8158
  8159     MOVE 'X'                    TO DATE-RANGE-SW.
  8160
  8161     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8162        MOVE 'X'                 TO DATE-RANGE-SW
  8163        GO TO 0199-ACCT-NOT-FOUND.
  8164
  8165     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8166        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8167
  8168 0180-ACCOUNT-FOUND.
  8169     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8170     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8171     MOVE AM-STATE               TO PB-SV-STATE.
  8172     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8173
  8174     IF AM-CANCEL-FEE  NOT NUMERIC
  8175        MOVE ZEROS TO AM-CANCEL-FEE.
  8176
  8177     IF AM-MAX-MON-BEN NOT NUMERIC
  8178        MOVE ZEROS TO AM-MAX-MON-BEN.
  8179
  8180     IF AM-MAX-TOT-BEN NOT NUMERIC
  8181        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8182
  8183     IF AM-CLP-TOL-PCT NOT NUMERIC
  8184        MOVE +0                  TO AM-CLP-TOL-PCT
  8185     END-IF
  8186     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8187        MOVE +0                  TO AM-SPP-LEASE-COMM
  8188     END-IF
  8189     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8190        MOVE ER-2611             TO   WS-ERROR
  8191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8192
  8193     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8194        MOVE ER-2621             TO   WS-ERROR
  8195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8196
  8197     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8198        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8199        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8200        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8201         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8202
  8203     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8204     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8205     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8206     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8207     IF AM-CLP-TOL-PCT NOT = ZEROS
  8208        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8209     END-IF
  8210     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8211        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 151
* EL050.cbl
  8212     END-IF
  8213*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8214*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8215*                                   WS-ADMIN-FEES
  8216*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8217*          (SUB5 > +10)
  8218*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8219*             AND (AM-A-COM (SUB5) NUMERIC)
  8220*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8221*                + (AM-A-COM (SUB5) * 1000)
  8222*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8223*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8224*                + (AM-A-COM (SUB5) * 1000)
  8225*             END-IF
  8226*             IF AM-COM-TYP (SUB5) = 'N'
  8227*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8228*                + (AM-A-COM (SUB5) * 1000)
  8229*             END-IF
  8230*          END-IF
  8231*       END-PERFORM
  8232*    END-IF
  8233     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8234        AND (PB-ISSUE)
  8235        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8236                                    ws-cred-union-fees
  8237        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8238           (SUB5 > +10)
  8239           MOVE +0 TO WS-WK-RATE
  8240           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8241                                   'O' OR 'S')
  8242              IF (AM-A-COM (SUB5) NUMERIC)
  8243                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8244                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8245              ELSE
  8246                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8247                 IF PB-ISSUE
  8248                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8249                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8250                 ELSE
  8251                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8252                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8253                 END-IF
  8254                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8255                 MOVE ZEROS             TO WS-SUB1
  8256                                           WS-COMMISSION
  8257                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8258                 MOVE '0530'               TO CTBL-SW
  8259                 MOVE ' '                  TO WS-CTBL-READ-SW
  8260                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8261                 IF FIRST-TIME-THROUGH
  8262                    MOVE 'AA'              TO CTBL-BEN-CODE
  8263                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8264                 END-IF
  8265                 IF CTBL-TABLE-FOUND
  8266                    IF PB-ISSUE
  8267                       COMPUTE WS-COMM-CK-AMT =
  8268                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8269                    ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 152
* EL050.cbl
  8270                       COMPUTE WS-COMM-CK-AMT =
  8271                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8272                    END-IF
  8273                    PERFORM 8800-GET-COMP-RATE
  8274                              THRU 8800-EXIT
  8275                 END-IF
  8276              END-IF
  8277              if am-com-typ (sub5) = 'O' or 'S'
  8278                 compute ws-cred-union-fees rounded =
  8279                    ws-cred-union-fees +
  8280                    (pb-i-ah-premium-amt * ws-wk-rate)
  8281              else
  8282                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8283                + (WS-WK-RATE * 1000)
  8284              end-if
  8285           END-IF
  8286        END-PERFORM
  8287     END-IF
  8288     IF PB-COMPANY-ID EQUAL 'CRI'
  8289         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8290
  8291     IF PB-COMPANY-ID EQUAL 'NCL'
  8292         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8293     END-IF
  8294
  8295     GO TO 0200-READ-CERT.
  8296
  8297 0199-ACCT-NOT-FOUND.
  8298
  8299     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8300
  8301     IF DATE-RANGE-SW NOT = SPACES
  8302        MOVE ER-2601             TO WS-ERROR
  8303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8304     ELSE
  8305        MOVE ER-2619             TO WS-ERROR
  8306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8307
  8308     GO TO 9990-RETURN.
  8309
  8310 0200-READ-CERT.
  8311
  8312     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8313     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8314     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8315     MOVE PB-SV-STATE            TO CERT-STATE.
  8316     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8317     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8318     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8319
  8320     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8321
  8322     IF CERT-WAS-NOT-FOUND
  8323        GO TO 0299-CERT-NOT-FOUND.
  8324
  8325     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8326        MOVE ER-2759             TO WS-ERROR
  8327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 153
* EL050.cbl
  8328        GO TO 0298-UNLOCK-RETURN.
  8329
  8330     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8331         MOVE ER-2758            TO WS-ERROR
  8332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8333         GO TO 0298-UNLOCK-RETURN.
  8334
  8335     IF PB-ISSUE
  8336        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8337           IF CERT-WAS-CREATED-FOR-CLAIM
  8338              NEXT SENTENCE
  8339            ELSE
  8340              MOVE ER-2626       TO WS-ERROR
  8341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8342              GO TO 0298-UNLOCK-RETURN.
  8343
  8344     IF NOT PB-CANCELLATION
  8345        GO TO 0300-CONTINUE-EDIT.
  8346
  8347     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8348     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8349     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8350     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8351     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8352     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8353
  8354     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8355     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8356     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8357     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8358     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8359     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8360     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8361     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8362     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8363
  8364     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8365     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8366     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8367     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8368     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8369     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8370     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8371
  8372     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8373     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8374
  8375     MOVE CM-CREDIT-INTERFACE-SW-1
  8376                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8377     MOVE CM-CREDIT-INTERFACE-SW-2
  8378                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8379
  8380     IF CM-O-B-COVERAGE
  8381         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8382
  8383     IF CM-LIVES NOT NUMERIC
  8384         MOVE ZERO                TO CM-LIVES.
  8385
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 154
* EL050.cbl
  8386     IF CM-BILLED NOT NUMERIC
  8387         MOVE ZERO                TO CM-BILLED.
  8388
  8389     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8390         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8391         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8392         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8393         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8394         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8395         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8396         MOVE CM-LIVES             TO PB-CI-LIVES
  8397*The next line causes a problem with my change  I dont think it is
  8398*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8399
  8400     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8401     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8402     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8403     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8404     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8405     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8406
  8407     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8408     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8409     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8410     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8411
  8412     IF CM-LIFE-COMM-PCT NUMERIC
  8413         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8414     ELSE
  8415         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8416
  8417     IF CM-AH-COMM-PCT NUMERIC
  8418         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8419     ELSE
  8420         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8421
  8422     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8423
  8424     IF CM-LOAN-APR       NOT NUMERIC
  8425           MOVE ZERO               TO CM-LOAN-APR.
  8426
  8427     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8428           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8429
  8430     IF CM-LOAN-TERM      NOT NUMERIC
  8431           MOVE ZERO               TO CM-LOAN-TERM.
  8432
  8433     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8434           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8435
  8436     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8437           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8438
  8439     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8440     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8441     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8442     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8443     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 155
* EL050.cbl
  8444     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8445     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8446     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8447     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8448     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8449     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8450     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8451
  8452     IF CM-STATE = CM-SSN-STATE
  8453         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8454
  8455     IF CM-STATE NOT = CM-MEMB-STATE
  8456         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8457
  8458     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8459
  8460     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8461        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8462        IF CM-ADDL-CLP NOT NUMERIC
  8463           MOVE +0               TO CM-ADDL-CLP
  8464        END-IF
  8465        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8466        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8467           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8468        END-IF
  8469     END-IF
  8470     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8471        MOVE +0                  TO WS-ADMIN-FEES
  8472                                    WS-CSO-ADMIN-FEE
  8473                                    WS-COMM-AND-MFEE
  8474                                    WS-1ST-YR-ALLOW
  8475        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8476           (SUB5 > +10)
  8477           MOVE +0 TO WS-WK-RATE
  8478           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8479              IF (AM-A-COM (SUB5) NUMERIC)
  8480                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8481                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8482              ELSE
  8483                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8484                 IF PB-ISSUE
  8485                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8486                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8487                 ELSE
  8488                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8489                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8490                 END-IF
  8491                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8492                 MOVE ZEROS             TO WS-SUB1
  8493                                           WS-COMMISSION
  8494                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8495                 MOVE '0530'               TO CTBL-SW
  8496                 MOVE ' '                  TO WS-CTBL-READ-SW
  8497                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8498                 IF FIRST-TIME-THROUGH
  8499                    MOVE 'AA'              TO CTBL-BEN-CODE
  8500                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8501                 END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 156
* EL050.cbl
  8502                 IF CTBL-TABLE-FOUND
  8503                    IF PB-ISSUE
  8504                       COMPUTE WS-COMM-CK-AMT =
  8505                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8506                    ELSE
  8507                       COMPUTE WS-COMM-CK-AMT =
  8508                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8509                    END-IF
  8510                    PERFORM 8800-GET-COMP-RATE
  8511                              THRU 8800-EXIT
  8512                 END-IF
  8513              END-IF
  8514              IF AM-COM-TYP (SUB5) = 'I'
  8515                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8516                   + (WS-WK-RATE * 1000)
  8517              END-IF
  8518              IF AM-COM-TYP (SUB5) = 'N'
  8519                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8520                   + (WS-WK-RATE * 1000)
  8521              END-IF
  8522              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8523                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8524                   + (WS-WK-RATE * 1000)
  8525              END-IF
  8526              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8527                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8528                   + (WS-WK-RATE * 1000)
  8529              END-IF
  8530           END-IF
  8531        END-PERFORM
  8532     END-IF
  8533     GO TO 0300-CONTINUE-EDIT.
  8534
  8535 0298-UNLOCK-RETURN.
  8536      PERFORM 9250-UNLOCK-RETURN
  8537      GO TO 9990-RETURN.
  8538
  8539 0299-CERT-NOT-FOUND.
  8540
  8541     MOVE '1'                     TO CERT-STATUS-SW.
  8542
  8543     IF PB-COMPANY-ID = 'UCL'
  8544         IF WS-ERROR = ER-2799
  8545             GO TO 3000-CONTINUE-EDIT.
  8546
  8547     IF NOT PB-CANCELLATION
  8548         GO TO 0300-CONTINUE-EDIT.
  8549
  8550     MOVE ER-2726                  TO  WS-ERROR.
  8551     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8552     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8553     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8554                                    PB-CI-LF-TERM
  8555                                    PB-C-LF-REM-TERM
  8556                                    PB-CI-AH-TERM
  8557                                    PB-C-AH-REM-TERM
  8558                                    PB-CI-LF-BENEFIT-CD
  8559                                    PB-CI-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 157
* EL050.cbl
  8560                                    PB-CI-LF-ALT-BENEFIT-AMT
  8561                                    PB-CI-LF-PREMIUM-AMT
  8562                                    PB-CI-LF-ALT-PREMIUM-AMT
  8563                                    PB-CI-AH-BENEFIT-CD
  8564                                    PB-CI-AH-BENEFIT-AMT
  8565                                    PB-CI-AH-PREMIUM-AMT
  8566                                    PB-CI-PAY-FREQUENCY
  8567                                    PB-CI-LOAN-APR
  8568                                    PB-CI-LOAN-TERM
  8569                                    PB-CI-LIFE-COMMISSION
  8570                                    PB-CI-AH-COMMISSION
  8571                                    PB-CI-CURR-SEQ
  8572                                    PB-CI-AH-CANCEL-AMT
  8573                                    PB-CI-LF-CANCEL-AMT
  8574                                    PB-CI-RATE-DEV-PCT-LF
  8575                                    PB-CI-RATE-DEV-PCT-AH
  8576                                    PB-CI-EXTENTION-DAYS
  8577                                    PB-CI-TERM-IN-DAYS
  8578                                    PB-CI-LIVES
  8579                                    PB-CI-LF-CRIT-PER
  8580                                    PB-CI-AH-CRIT-PER
  8581                                    PB-CI-ADDL-CLP
  8582                                    PB-CI-DDF-IU-RATE-UP.
  8583
  8584     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8585                                    PB-CI-AH-SETTLEMENT-DT
  8586                                    PB-CI-DEATH-DT
  8587                                    PB-CI-LF-PRIOR-CANCEL-DT
  8588                                    PB-CI-AH-PRIOR-CANCEL-DT
  8589                                    PB-CI-ENTRY-DT
  8590                                    PB-CI-LF-EXPIRE-DT
  8591                                    PB-CI-AH-EXPIRE-DT
  8592                                    PB-CI-LOAN-1ST-PMT-DT.
  8593
  8594     IF ACCOUNT-MAST-FOUND
  8595        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8596        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8597
  8598
  8599 0300-CONTINUE-EDIT.
  8600
  8601     IF PB-ISSUE
  8602        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8603            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8604
  8605     IF PB-ISSUE
  8606        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8607            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8608
  8609     IF PB-ISSUE
  8610       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8611          (AM-NO-AH-ONLY)
  8612           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8613               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8614                   MOVE ER-2679 TO WS-ERROR
  8615                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8616
  8617     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 158
* EL050.cbl
  8618        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8619        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8620        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8621     ELSE
  8622        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8623        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8624        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8625
  8626     MOVE 'N'                    TO PLAN-MASTER-SW
  8627                                    PLAN-MASTER-LIFE-SW
  8628                                    FORM-MASTER-SW
  8629                                    WS-APP-CERT-SW.
  8630
  8631     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8632                                    WS-PL-TOL-LF-REFUND
  8633                                    WS-PL-REF-OVS-AMT
  8634                                    WS-PL-TOL-LF-PREM-PCT
  8635                                    WS-PL-TOL-LF-REFUND-PCT
  8636                                    WS-PL-REF-OVS-PCT
  8637                                    WS-PL-TOL-LF-CLAIM.
  8638
  8639     IF PB-COMPANY-ID = 'NCL'
  8640       IF PB-ISSUE
  8641         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8642             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8643             IF FORM-MASTER-FOUND
  8644                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8645
  8646     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8647        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8648
  8649********************** MON CODE **********************
  8650     IF PB-COMPANY-ID = 'MON'
  8651     IF PB-ISSUE
  8652     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8653        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8654             PB-I-LOAN-APR = ZERO)
  8655               MOVE 14.0         TO PB-I-LOAN-APR.
  8656******************************************************
  8657
  8658     IF PB-COMPANY-ID = 'NCL'
  8659       IF PB-ISSUE
  8660           IF FORM-MASTER-FOUND
  8661             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8662                AM-DISMBR-COVERAGE
  8663                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8664                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8665                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8666                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8667                                           PB-I-LIFE-BENEFIT-CD.
  8668
  8669     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8670
  8671     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8672         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8673         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8674         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8675         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 159
* EL050.cbl
  8676         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8677           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8678             GO TO 0301-LIFE-BENEFIT-SEARCH
  8679         ELSE
  8680             NEXT SENTENCE
  8681     ELSE
  8682         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8683
  8684     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8685     MOVE '4'                    TO CNTL-REC-TYPE.
  8686     MOVE +0                     TO CNTL-SEQ-NO.
  8687     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8688
  8689     MOVE '1' TO RC-SW-2.
  8690     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8691
  8692     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8693        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8694         GO TO 0305-BENEFIT-NOT-FOUND.
  8695
  8696     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8697
  8698 0301-LIFE-BENEFIT-SEARCH.
  8699
  8700     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8701
  8702     IF NO-BENEFIT-FOUND
  8703        GO TO 0305-BENEFIT-NOT-FOUND.
  8704
  8705     IF WS-BEN-CD = '99'
  8706        GO TO 0305-BENEFIT-NOT-FOUND.
  8707
  8708     IF PB-COMPANY-ID = 'NCL'
  8709         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8710             GO TO 0304-LIFE-BENEFIT-FOUND.
  8711
  8712     MOVE +1                     TO SUB5.
  8713     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8714
  8715* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8716* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8717     IF PB-COMPANY-ID = 'DMD'
  8718         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8719
  8720 0302-EDIT-ACCT-LF-BENEFITS.
  8721
  8722     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8723        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8724           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8725                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8726           GO TO 03XX-GET-LIFE-ERPLAN.
  8727
  8728     IF SUB5 LESS THAN +20
  8729        ADD +1                   TO SUB5
  8730        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8731
  8732     MOVE +1                     TO SUB5.
  8733
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 160
* EL050.cbl
  8734     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8735        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8736
  8737 0303-EDIT-DMD-EXTRA-BENEFITS.
  8738
  8739     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8740        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8741           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8742                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8743           GO TO 03XX-GET-LIFE-ERPLAN.
  8744
  8745     IF SUB5 LESS THAN +30
  8746        ADD +1                   TO SUB5
  8747        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8748
  8749     MOVE +1                     TO SUB5.
  8750
  8751 03XX-EDIT-FOR-NINETY-LF.
  8752
  8753***************************************************************
  8754*                                                             *
  8755*    NINETY BENEFIT PLAN TYPES:                               *
  8756*                                                             *
  8757*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8758*      92 = ALL GROUP REDUCING BENEFITS                       *
  8759*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8760*      94 = ALL GROUP LEVEL BENEFITS                          *
  8761*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8762*           BENEFIT CONTROLS.                                 *
  8763*      99 = ALL BENEFITS                                      *
  8764*                                                             *
  8765***************************************************************
  8766
  8767     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8768                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8769
  8770     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8771       AND
  8772        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8773        GO TO 03XX-GET-LIFE-ERPLAN.
  8774
  8775     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8776       AND
  8777        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8778        IF CF-REDUCING (SUB3)
  8779           IF (PB-I-INDV-GRP-OVRD = 'I')
  8780              OR
  8781           ((AM-IG = '1') AND
  8782           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8783              OR
  8784           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8785           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8786           (AM-IG NOT = '2'))
  8787              GO TO 03XX-GET-LIFE-ERPLAN.
  8788
  8789     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8790       AND
  8791        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 161
* EL050.cbl
  8792        IF CF-REDUCING (SUB3)
  8793           IF (PB-I-INDV-GRP-OVRD = 'G')
  8794              OR
  8795           ((AM-IG = '2') AND
  8796           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8797              OR
  8798           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8799           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8800           (AM-IG NOT = '1'))
  8801              GO TO 03XX-GET-LIFE-ERPLAN.
  8802
  8803     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8804       AND
  8805        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8806        IF CF-LEVEL    (SUB3)
  8807           IF (PB-I-INDV-GRP-OVRD = 'I')
  8808              OR
  8809           ((AM-IG = '1') AND
  8810           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8811              OR
  8812           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8813           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8814            (AM-IG NOT = '2'))
  8815              GO TO 03XX-GET-LIFE-ERPLAN.
  8816
  8817     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8818       AND
  8819        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8820        IF CF-LEVEL    (SUB3)
  8821           IF (PB-I-INDV-GRP-OVRD = 'G')
  8822              OR
  8823           ((AM-IG = '2') AND
  8824           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8825              OR
  8826           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8827           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8828           (AM-IG NOT = '1'))
  8829              GO TO 03XX-GET-LIFE-ERPLAN.
  8830
  8831     IF SUB5 LESS THAN +20
  8832        ADD +1                   TO SUB5
  8833        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8834
  8835     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8836
  8837     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8838        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8839
  8840     MOVE +1                     TO SUB5.
  8841
  8842 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8843
  8844     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8845                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8846
  8847     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8848       AND
  8849        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 162
* EL050.cbl
  8850        GO TO 03XX-GET-LIFE-ERPLAN.
  8851
  8852     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8853       AND
  8854        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8855        IF CF-REDUCING (SUB3)
  8856           IF (PB-I-INDV-GRP-OVRD = 'I')
  8857              OR
  8858           ((AM-IG = '1') AND
  8859           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8860              OR
  8861           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8862           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8863           (AM-IG NOT = '2'))
  8864              GO TO 03XX-GET-LIFE-ERPLAN.
  8865
  8866     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8867       AND
  8868        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8869        IF CF-REDUCING (SUB3)
  8870           IF (PB-I-INDV-GRP-OVRD = 'G')
  8871              OR
  8872           ((AM-IG = '2') AND
  8873           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8874              OR
  8875           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8876           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8877           (AM-IG NOT = '1'))
  8878              GO TO 03XX-GET-LIFE-ERPLAN.
  8879
  8880     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8881       AND
  8882        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8883        IF CF-LEVEL    (SUB3)
  8884           IF (PB-I-INDV-GRP-OVRD = 'I')
  8885              OR
  8886           ((AM-IG = '1') AND
  8887           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8888              OR
  8889           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8890           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8891            (AM-IG NOT = '2'))
  8892              GO TO 03XX-GET-LIFE-ERPLAN.
  8893
  8894     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8895       AND
  8896        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8897        IF CF-LEVEL    (SUB3)
  8898           IF (PB-I-INDV-GRP-OVRD = 'G')
  8899              OR
  8900           ((AM-IG = '2') AND
  8901           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8902              OR
  8903           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8904           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8905           (AM-IG NOT = '1'))
  8906              GO TO 03XX-GET-LIFE-ERPLAN.
  8907
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 163
* EL050.cbl
  8908     IF SUB5 LESS THAN +30
  8909        ADD +1                   TO SUB5
  8910        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8911
  8912     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8913
  8914 03XX-EDIT-FOR-NINETY-LF-CONT.
  8915
  8916     MOVE +99                    TO SUB5.
  8917
  8918     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8919        IF PB-ISSUE
  8920           MOVE ER-1924          TO  WS-ERROR
  8921           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8922
  8923     GO TO 0304-LIFE-BENEFIT-FOUND.
  8924
  8925 03XX-GET-LIFE-ERPLAN.
  8926
  8927     IF WK-PLAN-ADDR EQUAL +0
  8928        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8929
  8930     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8931     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8932     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8933     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8934     MOVE 'Y'                    TO PLAN-MASTER-SW
  8935                                    PLAN-MASTER-LIFE-SW.
  8936     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8937
  8938 03XX-ERPLAN-LIFE-GETMAIN.
  8939
  8940     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8941     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8942
  8943 03XX-ERPLAN-LIFE-READ.
  8944
  8945     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8946     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8947     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8948     MOVE PB-SV-STATE            TO PLAN-STATE.
  8949     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8950     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8951     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8952     MOVE WS-SAVE-BENEFIT-REVISION
  8953                                 TO PLAN-REVISION-NO.
  8954
  8955     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8956     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8957
  8958     IF PB-COMPANY-ID = 'NCL'
  8959       IF NOT LF-PLAN-MASTER-FOUND
  8960         IF NOT PB-POLICY-IS-DECLINED  AND
  8961            NOT PB-POLICY-IS-VOIDED
  8962             MOVE  ER-1921         TO  WS-ERROR
  8963             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8964             GO TO 0304-LIFE-BENEFIT-FOUND.
  8965
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 164
* EL050.cbl
  8966     IF NOT LF-PLAN-MASTER-FOUND
  8967        GO TO 0304-LIFE-BENEFIT-FOUND.
  8968
  8969 XXXX-CHECK-LF-PLAN-KEY.
  8970
  8971     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8972        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8973        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8974        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8975        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8976        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8977        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8978        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8979        MOVE 'N'                 TO PLAN-MASTER-SW
  8980          GO TO 03XX-ERPLAN-LIFE-READ.
  8981
  8982     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8983
  8984     IF  PB-CANCELLATION
  8985         GO TO  0303-LF-ACCT-BEN-FOUND.
  8986
  8987     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8988        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8989           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8990           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8991              MOVE ER-2644             TO WS-ERROR
  8992              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993           ELSE
  8994              NEXT SENTENCE
  8995        ELSE
  8996           IF PB-COMPANY-ID NOT = 'NCL'
  8997              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8998                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8999
  9000 0303-LF-ACCT-BEN-FOUND.
  9001
  9002     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9003
  9004     IF PL-DEV-CODE NOT = SPACES
  9005        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9006
  9007     IF PL-DEV-PCT NUMERIC AND
  9008        PL-DEV-PCT NOT = ZEROS
  9009        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9010
  9011     IF PL-TOL-PREM-AMT GREATER THAN +0
  9012        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9013
  9014     IF PL-TOL-REF-AMT GREATER THAN +0
  9015        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9016
  9017     IF PL-TOL-PREM-PCT GREATER THAN +0
  9018        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9019
  9020     IF PL-TOL-REF-PCT GREATER THAN +0
  9021        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9022
  9023     IF PL-TOL-CLM-AMT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 165
* EL050.cbl
  9024        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9025
  9026     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9027                          PL-OVER-SHORT-AMT > +0
  9028        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9029
  9030     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9031                          PL-OVER-SHORT-PCT > +0
  9032        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9033
  9034     IF PL-SALES-TAX NUMERIC AND
  9035                          PL-SALES-TAX > +0
  9036         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9037
  9038     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9039        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9040                                    WS-IG-OVRD-AM.
  9041
  9042 0304-LIFE-BENEFIT-FOUND.
  9043
  9044     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9045
  9046     IF PB-ISSUE
  9047        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9048     ELSE
  9049        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9050
  9051     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9052     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9053     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9054     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9055     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9056                                         WS-LF-REFUND-CALC.
  9057     if (ws-lf-earnings-calc = '5')
  9058        and (pb-i-loan-apr = zeros)
  9059        and (benefit-code-chg)
  9060        move +99.9999 to pb-i-loan-apr
  9061     end-if
  9062
  9063     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9064        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9065
  9066     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9067        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9068     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9069
  9070     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9071     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9072     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9073     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9074     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9075     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9076
  9077     IF PB-COMPANY-ID = 'NCL'  AND
  9078        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9079         NEXT SENTENCE
  9080     ELSE
  9081         IF SUB5 NOT GREATER THAN +20
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 166
* EL050.cbl
  9082            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9083               MOVE WS-SAVE-BENEFIT-REM-TERM
  9084                                      TO WS-AM-LF-BENE-REM-TERM
  9085                                         EC-BR-LF-REM-TERM-CALC.
  9086
  9087     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9088     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9089
  9090     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9091
  9092 0305-BENEFIT-NOT-FOUND.
  9093
  9094     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9095     MOVE ER-2604                TO WS-ERROR.
  9096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9097
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 167
* EL050.cbl
  9099
  9100 0310-FIND-AH-BENEFIT-RECORD.
  9101
  9102     MOVE 'N'                    TO PLAN-MASTER-SW
  9103                                    PLAN-MASTER-AH-SW.
  9104
  9105     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9106                                    WS-PL-TOL-AH-REFUND
  9107                                    WS-AH-PL-REF-OVS-AMT
  9108                                    WS-PL-TOL-AH-PREM-PCT
  9109                                    WS-PL-TOL-AH-REFUND-PCT
  9110                                    WS-AH-PL-REF-OVS-PCT
  9111                                    WS-PL-TOL-AH-CLAIM.
  9112     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9113
  9114
  9115     if pb-issue
  9116        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9117           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9118        end-if
  9119        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9120           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9121           GO TO 0399-BENEFIT-NOT-FOUND
  9122        end-if
  9123     end-if
  9124
  9125     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9126        GO TO 0400-FIND-CARRIER.
  9127
  9128     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9129
  9130     IF WK-AH-BEN-ADDR NOT = ZEROS
  9131         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9132         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9133         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9134         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9135           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9136             GO TO 0311-AH-BENEFIT-SEARCH
  9137         ELSE
  9138             NEXT SENTENCE
  9139     ELSE
  9140         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9141
  9142     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9143     MOVE '5'                    TO CNTL-REC-TYPE.
  9144     MOVE +0                     TO CNTL-SEQ-NO.
  9145     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9146
  9147     MOVE '2' TO RC-SW-2.
  9148     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9149
  9150     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9151        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9152          GO TO 0399-BENEFIT-NOT-FOUND.
  9153
  9154     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9155
  9156 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 168
* EL050.cbl
  9157
  9158     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9159
  9160     IF NO-BENEFIT-FOUND
  9161         GO TO 0399-BENEFIT-NOT-FOUND.
  9162
  9163     IF WS-BEN-CD = '99'
  9164        GO TO 0399-BENEFIT-NOT-FOUND.
  9165
  9166     IF PB-COMPANY-ID  =  'NCL'
  9167         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9168             GO TO 0314-A-H-BENEFIT-FOUND.
  9169
  9170     MOVE +1                     TO SUB5.
  9171     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9172
  9173* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9174* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9175     IF PB-COMPANY-ID = 'DMD'
  9176         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9177
  9178 0312-EDIT-ACCT-AH-BENEFITS.
  9179
  9180     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9181        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9182           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9183                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9184           GO TO 03XX-GET-AH-ERPLAN.
  9185
  9186     IF SUB5 LESS THAN +20
  9187        ADD +1                   TO SUB5
  9188        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9189
  9190     MOVE +1                     TO SUB5.
  9191
  9192     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9193        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9194
  9195 0313-EDIT-DMD-EXTRA-BENEFITS.
  9196
  9197     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9198        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9199           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9200                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9201           GO TO 03XX-GET-AH-ERPLAN.
  9202
  9203     IF SUB5 LESS THAN +30
  9204        ADD +1                   TO SUB5
  9205        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9206
  9207     MOVE +1                     TO SUB5.
  9208
  9209 03XX-EDIT-FOR-NINETY-AH.
  9210
  9211***************************************************************
  9212*                                                             *
  9213*    NINETY BENEFIT PLAN TYPES:                               *
  9214*                                                             *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 169
* EL050.cbl
  9215*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9216*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9217*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9218*           BENEFIT CONTROLS.                                 *
  9219*      99 = ALL BENEFITS.                                     *
  9220*                                                             *
  9221***************************************************************
  9222
  9223     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9224                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9225
  9226     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9227       AND
  9228        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9229        GO TO 03XX-GET-AH-ERPLAN.
  9230
  9231     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9232       AND
  9233        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9234           IF (PB-I-INDV-GRP-OVRD = 'I')
  9235              OR
  9236           ((AM-IG = '1') AND
  9237           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9238              OR
  9239           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9240           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9241           (AM-IG NOT = '2'))
  9242              GO TO 03XX-GET-AH-ERPLAN.
  9243
  9244     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9245       AND
  9246        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9247           IF (PB-I-INDV-GRP-OVRD = 'G')
  9248              OR
  9249           ((AM-IG = '2') AND
  9250           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9251              OR
  9252           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9253           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9254           (AM-IG NOT = '1'))
  9255              GO TO 03XX-GET-AH-ERPLAN.
  9256
  9257     IF SUB5 LESS THAN +20
  9258        ADD +1                   TO SUB5
  9259        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9260
  9261     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9262        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9263
  9264     MOVE +1                    TO SUB5.
  9265
  9266 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9267
  9268     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9269                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9270
  9271     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9272       AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 170
* EL050.cbl
  9273        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9274        GO TO 03XX-GET-AH-ERPLAN.
  9275
  9276     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9277       AND
  9278        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9279           IF (PB-I-INDV-GRP-OVRD = 'I')
  9280              OR
  9281           ((AM-IG = '1') AND
  9282           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9283              OR
  9284           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9285           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9286           (AM-IG NOT = '2'))
  9287              GO TO 03XX-GET-AH-ERPLAN.
  9288
  9289     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9290       AND
  9291        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9292           IF (PB-I-INDV-GRP-OVRD = 'G')
  9293              OR
  9294           ((AM-IG = '2') AND
  9295           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9296              OR
  9297           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9298           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9299           (AM-IG NOT = '1'))
  9300              GO TO 03XX-GET-AH-ERPLAN.
  9301
  9302     IF SUB5 LESS THAN +30
  9303        ADD +1                   TO SUB5
  9304        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9305
  9306 03XX-EDIT-FOR-NINETY-AH-CONT.
  9307
  9308     MOVE +99                    TO SUB5.
  9309
  9310     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9311
  9312     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9313        IF PB-ISSUE
  9314           MOVE ER-1925          TO  WS-ERROR
  9315           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9316
  9317     GO TO 0314-A-H-BENEFIT-FOUND.
  9318
  9319 03XX-GET-AH-ERPLAN.
  9320
  9321     IF WK-PLAN-ADDR EQUAL +0
  9322         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9323
  9324     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9325     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9326     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9327     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9328     MOVE 'Y'                    TO PLAN-MASTER-SW
  9329                                    PLAN-MASTER-AH-SW.
  9330*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 171
* EL050.cbl
  9331     GO TO 03XX-ERPLAN-AH-READ.
  9332
  9333 03XX-ERPLAN-AH-GETMAIN.
  9334
  9335     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9336     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9337
  9338 03XX-ERPLAN-AH-READ.
  9339
  9340     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9341     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9342     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9343     MOVE PB-SV-STATE            TO PLAN-STATE.
  9344     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9345     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9346     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9347     MOVE WS-SAVE-BENEFIT-REVISION
  9348                                 TO PLAN-REVISION-NO.
  9349
  9350     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9351     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9352
  9353     IF PB-COMPANY-ID = 'NCL'
  9354       IF NOT AH-PLAN-MASTER-FOUND
  9355         IF NOT PB-POLICY-IS-DECLINED  AND
  9356            NOT PB-POLICY-IS-VOIDED
  9357             MOVE  ER-1922         TO  WS-ERROR
  9358             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9359             GO TO 0314-A-H-BENEFIT-FOUND.
  9360
  9361     IF NOT AH-PLAN-MASTER-FOUND
  9362        GO TO 0314-A-H-BENEFIT-FOUND.
  9363
  9364 XXXX-CHECK-AH-PLAN-KEY.
  9365
  9366     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9367        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9368        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9369        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9370        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9371        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9372        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9373        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9374        MOVE 'N'                 TO PLAN-MASTER-SW
  9375          GO TO 03XX-ERPLAN-AH-READ.
  9376
  9377     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9378
  9379     IF  PB-CANCELLATION
  9380         GO TO  0313-AH-ACCT-BEN-FOUND.
  9381
  9382     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9383       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9384          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9385          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9386             MOVE ER-2644             TO WS-ERROR
  9387             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9388          ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 172
* EL050.cbl
  9389             NEXT SENTENCE
  9390       ELSE
  9391          IF PB-COMPANY-ID NOT = 'NCL'
  9392             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9393                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9394
  9395 0313-AH-ACCT-BEN-FOUND.
  9396
  9397     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9398
  9399     IF PL-DEV-CODE NOT = SPACES
  9400        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9401
  9402     IF PL-DEV-PCT NUMERIC AND
  9403        PL-DEV-PCT NOT = ZEROS
  9404        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9405
  9406     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9407        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9408
  9409     IF PL-TOL-REF-AMT NOT EQUAL +0
  9410        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9411
  9412     IF PL-TOL-PREM-PCT GREATER THAN +0
  9413        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9414
  9415     IF PL-TOL-REF-PCT GREATER THAN +0
  9416        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9417
  9418     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9419        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9420
  9421     IF PL-OVER-SHORT-AMT NUMERIC AND
  9422                          PL-OVER-SHORT-AMT > +0
  9423        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9424
  9425     IF PL-OVER-SHORT-PCT NUMERIC AND
  9426                          PL-OVER-SHORT-PCT > +0
  9427        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9428
  9429     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9430        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9431        IF WS-IG-OVRD-AM EQUAL SPACES
  9432            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9433
  9434 0314-A-H-BENEFIT-FOUND.
  9435
  9436     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9437
  9438     IF PB-ISSUE
  9439        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9440       ELSE
  9441        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9442
  9443     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9444     if cf-maximum-benefits (sub3) numeric
  9445        move cf-maximum-benefits (sub3)
  9446                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 173
* EL050.cbl
  9447     else
  9448        move zeros               to ws-ah-max-bens
  9449     end-if
  9450     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9451     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9452     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9453                                         WS-AH-REFUND-CALC.
  9454
  9455     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9456        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9457
  9458     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9459        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9460     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9461
  9462     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9463     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9464     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9465     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9466     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9467     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9468
  9469     IF PB-COMPANY-ID = 'NCL'  AND
  9470        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9471         NEXT SENTENCE
  9472     ELSE
  9473         IF SUB5 NOT GREATER THAN +20
  9474            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9475                MOVE WS-SAVE-BENEFIT-REM-TERM
  9476                                      TO WS-AM-AH-BENE-REM-TERM
  9477                                         EC-BR-AH-REM-TERM-CALC.
  9478
  9479     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9480     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9481
  9482     GO TO 0400-FIND-CARRIER.
  9483
  9484 0399-BENEFIT-NOT-FOUND.
  9485
  9486     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9487     MOVE ER-2605                TO WS-ERROR.
  9488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9489
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 174
* EL050.cbl
  9491
  9492 0400-FIND-CARRIER.
  9493
  9494     MOVE PB-SV-CARRIER          TO WS-CARR.
  9495
  9496     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9497     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9498     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9499     MOVE '6'                    TO CNTL-REC-TYPE.
  9500
  9501*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9502     MOVE SPACE                  TO WS-DMD-RATING-SW
  9503                                    EC-BR-DMD-RATING-SW.
  9504
  9505     MOVE '2'                    TO RC-SW-1.
  9506     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9507
  9508     IF NOT CF-CARRIER-MASTER
  9509        GO TO 0400-CARRIER-NOT-FOUND.
  9510
  9511 0400-BUILD-CARR-TOL.
  9512
  9513     IF CF-CR-TOL-PREM NUMERIC AND
  9514        CF-CR-TOL-PREM GREATER THAN +0
  9515        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9516                                    WS-TOL-AH-PREM.
  9517
  9518     IF CF-CR-TOL-REFUND NUMERIC AND
  9519        CF-CR-TOL-REFUND GREATER THAN +0
  9520        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9521                                    WS-TOL-AH-REFUND.
  9522
  9523     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9524        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9525        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9526                                    WS-AH-REFUND-OVS-AMT.
  9527
  9528     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9529        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9530        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9531                                    WS-AH-REFUND-OVS-PCT.
  9532
  9533     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9534        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9535        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9536                                    WS-TOL-AH-PREM-PCT.
  9537
  9538     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9539        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9540        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9541                                     WS-TOL-AH-REFUND-PCT.
  9542
  9543     IF CF-COMPANY-ID EQUAL 'DMD'
  9544         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9545                                    EC-BR-DMD-RATING-SW.
  9546
  9547     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9548     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 175
* EL050.cbl
  9549        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9550     END-IF
  9551     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9552        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9553     END-IF
  9554     IF WS-TOL-CLP-PCT = ZEROS
  9555        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9556     END-IF
  9557
  9558     IF WS-SPP-LEASE-COMM = ZEROS
  9559        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9560     END-IF
  9561     GO TO 0400-FIND-ERPDEF.
  9562
  9563 0400-CARRIER-NOT-FOUND.
  9564
  9565     MOVE ER-2602                TO WS-ERROR.
  9566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
  9568 0400-FIND-ERPDEF.
  9569*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9570     IF (PB-COMPANY-ID = 'DCC')
  9571        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9572        CONTINUE
  9573     ELSE
  9574        GO TO 0400-FIND-ERCOMP
  9575     END-IF
  9576     MOVE ' '                    TO PDEF-MASTER-SW
  9577     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9578     MOVE PB-STATE               TO ERPDEF-STATE
  9579     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9580        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9581     END-IF
  9582     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9583     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9584     IF PB-ISSUE
  9585        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9586     ELSE
  9587        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9588     END-IF
  9589     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9590     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9591     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9592     IF PDEF-MASTER-FOUND
  9593        MOVE 'N'                 TO PDEF-MASTER-SW
  9594        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9595        IF PDEF-MASTER-FOUND
  9596           IF (ERPDEF-KEY-SAVE (1:16) =
  9597                        PD-CONTROL-PRIMARY (1:16))
  9598              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9599              CONTINUE
  9600           ELSE
  9601              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9602              IF (ERPDEF-KEY-SAVE (1:16) =
  9603                        PD-CONTROL-PRIMARY (1:16))
  9604                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9605                 CONTINUE
  9606              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 176
* EL050.cbl
  9607                 MOVE 'N'        TO PDEF-MASTER-SW
  9608              END-IF
  9609           END-IF
  9610        END-IF
  9611        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9612     END-IF
  9613     IF PDEF-MASTER-FOUND
  9614        IF PD-TRUNCATED = 'Y'
  9615           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9616        END-IF
  9617     END-IF
  9618     .
  9619 0400-FIND-ERCOMP.
  9620     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9621        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9622           (WS-SUB1 > +10)
  9623           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9624                 OR 'A' OR 'N'
  9625              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9626              MOVE PB-CARRIER    TO COMP-CARRIER
  9627              MOVE PB-GROUPING   TO COMP-GROUPING
  9628              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9629              MOVE AM-AGT (WS-SUB1)
  9630                                 TO COMP-FIN-RESP
  9631              MOVE 'G'           TO COMP-TYPE
  9632              PERFORM 8582-READ-COMPENSATION-MASTER
  9633                                 THRU 8582-EXIT
  9634              IF COMP-MASTER-FOUND
  9635                 IF CO-GA-INACTIVE
  9636                    MOVE ER-2763 TO WS-ERROR
  9637                    PERFORM 9900-ERROR-FORMAT
  9638                                 THRU 9900-EXIT
  9639                    MOVE +11     TO WS-SUB1
  9640                 END-IF
  9641                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9642                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9643                    MOVE ER-2788 TO WS-ERROR
  9644                    PERFORM 9900-ERROR-FORMAT
  9645                                 THRU 9900-EXIT
  9646                    MOVE +11     TO WS-SUB1
  9647                 END-IF
  9648              END-IF
  9649           END-IF
  9650        END-PERFORM
  9651     END-IF
  9652     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9653        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9654           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9655                                    WS-CLP-STATE
  9656        ELSE
  9657           MOVE SPACES           TO PB-I-CLP-STATE
  9658                                    WS-CLP-STATE
  9659        END-IF
  9660     END-IF
  9661
  9662     IF (PB-COMPANY-ID = 'DCC')
  9663        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9664        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 177
* EL050.cbl
  9665        CONTINUE
  9666     ELSE
  9667        GO TO 0400-FIND-STATE-RECORD
  9668     END-IF
  9669     MOVE SPACES                 TO WS-CLP-STATE
  9670     MOVE +0                     TO WS-BANK-FEE
  9671                                    WS-BANK-LFEE
  9672                                    WS-BANK-NOCHRGB
  9673
  9674     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9675     IF (PB-ISSUE)
  9676        AND (PB-I-BANK-NUMBER NOT =
  9677            SPACES AND ZEROS AND LOW-VALUES)
  9678        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9679     ELSE
  9680        IF (PB-CANCELLATION)
  9681           AND (PB-CI-BANK-NUMBER NOT =
  9682                SPACES AND ZEROS AND LOW-VALUES)
  9683           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9684        END-IF
  9685     END-IF
  9686     IF COMP-FIN-RESP NOT = LOW-VALUES
  9687        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9688        MOVE PB-CARRIER          TO COMP-CARRIER
  9689        MOVE PB-GROUPING         TO COMP-GROUPING
  9690        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9691        MOVE 'B'                 TO COMP-TYPE
  9692        PERFORM 8582-READ-COMPENSATION-MASTER
  9693                                 THRU 8582-EXIT
  9694        IF COMP-MASTER-FOUND
  9695           IF CO-MAX-BANK-FEE NOT NUMERIC
  9696              MOVE +0            TO CO-MAX-BANK-FEE
  9697           END-IF
  9698           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9699              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9700           END-IF
  9701           IF CO-GA-INACTIVE
  9702              MOVE ER-2763       TO WS-ERROR
  9703              PERFORM 9900-ERROR-FORMAT
  9704                                 THRU 9900-EXIT
  9705           END-IF
  9706           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9707              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9708              MOVE ER-2788 TO WS-ERROR
  9709              PERFORM 9900-ERROR-FORMAT
  9710                                 THRU 9900-EXIT
  9711              MOVE +11     TO WS-SUB1
  9712           END-IF
  9713           IF WS-AH-BEN-CATEGORY = 'G'
  9714              MOVE CO-MAX-BANK-FEE
  9715                                 TO WS-BANK-FEE
  9716                                    PB-I-BANK-FEE
  9717           ELSE
  9718              MOVE CO-MAX-BANK-FEE-LEASE
  9719                                 TO WS-BANK-LFEE
  9720                                    PB-I-BANK-FEE
  9721           END-IF
  9722           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 178
* EL050.cbl
  9723              AND (WS-AH-REFUND-CALC = 'G'))
  9724                        OR
  9725              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9726              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9727              CONTINUE
  9728           ELSE
  9729              MOVE ER-2789 TO WS-ERROR
  9730              PERFORM 9900-ERROR-FORMAT
  9731                                 THRU 9900-EXIT
  9732           END-IF
  9733           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9734                                    PB-I-CLP-STATE
  9735           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9736           MOVE CO-CARRIER       TO BXRF-CARRIER
  9737           MOVE CO-GROUPING      TO BXRF-GROUPING
  9738           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9739           MOVE BXRF-MAX-REC-LENGTH
  9740                                 TO BXRF-REC-LENGTH
  9741           PERFORM 8584-READ-BANK-CROSS-REF
  9742                                 THRU 8584-EXIT
  9743           IF BXRF-MASTER-FOUND
  9744              MOVE ' '           TO BANK-ACCT-SW
  9745              MOVE BK-BANK-POINTER-CNT
  9746                                 TO BK-BANK-POINTER-CNT
  9747              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9748                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9749                 OR (BANK-ACCT-FOUND)
  9750                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9751                    AND (BK-AM-EXP-DT (WS-SUB1)
  9752                                 > PB-CERT-EFF-DT)
  9753                    AND (BK-AM-EFF-DT (WS-SUB1)
  9754                                 NOT > PB-CERT-EFF-DT)
  9755                    SET BANK-ACCT-FOUND TO TRUE
  9756                 END-IF
  9757              END-PERFORM
  9758              IF NOT BANK-ACCT-FOUND
  9759                 MOVE ZEROS      TO WS-BANK-FEE
  9760                                    WS-BANK-LFEE
  9761                 MOVE ER-2869    TO WS-ERROR
  9762                 PERFORM 9900-ERROR-FORMAT
  9763                                 THRU 9900-EXIT
  9764              ELSE
  9765                 PERFORM 5000-PROCESS-REPS
  9766                                 THRU 5000-EXIT
  9767                 IF AGENT-MASTER-FOUND
  9768                    MOVE +0      TO WS-BANK-FEE
  9769                                    WS-BANK-LFEE
  9770*                   MOVE AG-SPP-FEES (1)
  9771*                                TO PB-I-BANK-FEE
  9772*                                   WS-BANK-FEE
  9773                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9774                       (WS-SUB1 > +10)
  9775                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9776                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9777                       END-IF
  9778                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9779                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9780                       END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 179
* EL050.cbl
  9781                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9782                          AG-SPP-FEES (WS-SUB1)
  9783                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9784                          AG-SPP-LFEES (WS-SUB1)
  9785                    END-PERFORM
  9786                    IF WS-AH-BEN-CATEGORY = 'G'
  9787                       MOVE WS-BANK-FEE
  9788                                 TO PB-I-BANK-FEE
  9789                    ELSE
  9790                       MOVE WS-BANK-LFEE
  9791                                 TO PB-I-BANK-FEE
  9792                    END-IF
  9793                 END-IF
  9794              END-IF
  9795           END-IF
  9796        ELSE
  9797           MOVE ER-2879          TO WS-ERROR
  9798           PERFORM 9900-ERROR-FORMAT
  9799                                 THRU 9900-EXIT
  9800        END-IF
  9801     ELSE
  9802        MOVE ER-2879             TO WS-ERROR
  9803        PERFORM 9900-ERROR-FORMAT
  9804                                 THRU 9900-EXIT
  9805     END-IF
  9806     IF WS-AH-BEN-CATEGORY = 'G'
  9807        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9808        + WS-BANK-FEE
  9809     ELSE
  9810        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9811        + WS-BANK-LFEE
  9812     END-IF
  9813     .
  9814 0400-FIND-STATE-RECORD.
  9815
  9816     IF WK-STATE-ADDR NOT = ZEROS
  9817         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9818         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9819         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9820         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9821         IF PB-SV-STATE = CF-STATE-CODE
  9822             GO TO 0405-CONTINUE-EDIT
  9823         ELSE
  9824             NEXT SENTENCE
  9825     ELSE
  9826         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9827
  9828     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9829     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9830     MOVE '3'                    TO CNTL-REC-TYPE.
  9831     MOVE +0                     TO CNTL-SEQ-NO.
  9832
  9833     MOVE '3'                    TO RC-SW-2.
  9834     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9835
  9836     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9837        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9838        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 180
* EL050.cbl
  9839        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9840                                    WS-TOL-AH-CLAIM
  9841                                    WS-MINIMUM-REFUND
  9842                                    WS-TOL-LF-PREM
  9843                                    WS-TOL-AH-PREM
  9844                                    WS-TOL-LF-REFUND
  9845                                    WS-TOL-AH-REFUND
  9846                                    EC-ST-TOL-PREM-PCT
  9847                                    WS-TOL-LF-PREM-PCT
  9848                                    WS-TOL-AH-PREM-PCT
  9849                                    EC-ST-TOL-REFUND-PCT
  9850                                    WS-TOL-LF-REFUND-PCT
  9851                                    WS-TOL-AH-REFUND-PCT
  9852                                    EC-ST-TOL-PREM
  9853                                    EC-ST-TOL-REFUND
  9854                                    EC-ST-FST-PMT-DAYS-MAX
  9855                                    WS-FREE-LOOK-PERIOD
  9856                                    WS-ST-LF-PREM-TAX
  9857                                    WS-ST-AH-PREM-TAX-I
  9858                                    WS-ST-AH-PREM-TAX-G
  9859                                    WS-BANK-FEE
  9860                                    WS-BANK-LFEE
  9861                                    WS-TOL-CLP-PCT
  9862                                    WS-SPP-LEASE-COMM
  9863                                    WS-INT-PERIODS
  9864                                    WS-EXTRA-PMTS
  9865        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9866                                    EC-ST-FST-PMT-DAYS-CHG
  9867                                    WS-LF-REM-TERM-CALC
  9868                                    WS-LF-REFUND-CALC
  9869                                    EC-ST-LF-REM-TERM-CALC
  9870                                    EC-ST-LF-REFUND-CALC
  9871                                    WS-AH-REM-TERM-CALC
  9872                                    WS-AH-REFUND-CALC
  9873                                    WS-LF-BEN-CATEGORY
  9874                                    WS-AH-BEN-CATEGORY
  9875                                    WS-CLP-STATE
  9876                                    WS-ST-REFUND-CLAIM-FLAG
  9877                                    WS-ST-CAUSAL-STATE
  9878                                    ws-st-agent-sig-edit
  9879                                    EC-ST-AH-REM-TERM-CALC
  9880                                    EC-ST-AH-REFUND-CALC
  9881          GO TO 0499-STATE-NOT-FOUND.
  9882
  9883     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9884
  9885 0405-CONTINUE-EDIT.
  9886
  9887     if pb-company-id = 'AHL'
  9888        continue
  9889     else
  9890        IF PB-CERT-PRIME NOT NUMERIC
  9891           MOVE ER-2722          TO WS-ERROR
  9892           PERFORM 9900-ERROR-FORMAT
  9893                                 THRU 9900-EXIT
  9894        end-if
  9895     END-IF
  9896*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 181
* EL050.cbl
  9897*       MOVE +0                  TO SUB3
  9898*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9899*       IF SUB3 > +0
  9900*          MOVE ER-2722          TO WS-ERROR
  9901*          PERFORM 9900-ERROR-FORMAT
  9902*                                THRU 9900-EXIT
  9903*       END-IF
  9904*    END-IF
  9905*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9906*       IF PB-CERT-PRIME NOT NUMERIC
  9907*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9908*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9909*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9910*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9911*
  9912*          MOVE ER-2722          TO WS-ERROR
  9913*          PERFORM 9900-ERROR-FORMAT
  9914*                                THRU 9900-EXIT
  9915*       END-IF
  9916*    END-IF
  9917
  9918     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9919
  9920     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9921        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9922                                    WS-TOL-AH-CLAIM.
  9923
  9924     IF CF-ST-REFUND-MIN NOT NUMERIC
  9925        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9926
  9927     IF CF-ST-REFUND-MIN NOT = ZEROS
  9928        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9929
  9930     IF CF-ST-TOL-PREM  NOT = ZEROS
  9931        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9932                                    WS-TOL-AH-PREM
  9933        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9934
  9935     IF CF-ST-TOL-REFUND NOT = ZEROS
  9936        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9937                                    WS-TOL-AH-REFUND
  9938        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9939
  9940     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9941        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9942        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9943                                    WS-AH-REFUND-OVS-AMT
  9944                                    EC-ST-OVR-SHT-AMT.
  9945
  9946     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9947        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9948        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9949                                    WS-TOL-LF-PREM-PCT
  9950                                    WS-TOL-AH-PREM-PCT.
  9951
  9952     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9953        CF-ST-TOL-REF-PCT GREATER THAN +0
  9954        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 182
* EL050.cbl
  9955                                    WS-TOL-LF-REFUND-PCT
  9956                                    WS-TOL-AH-REFUND-PCT.
  9957
  9958     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9959        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9960        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9961                                    WS-AH-REFUND-OVS-PCT
  9962                                    EC-ST-OVR-SHT-PCT.
  9963
  9964     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9965     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9966
  9967     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9968          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9969
  9970     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9971     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9972     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9973
  9974     IF CF-ST-LF-PREM-TAX NUMERIC
  9975        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9976     END-IF
  9977     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9978        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9979     END-IF
  9980     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9981        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9982     END-IF
  9983
  9984     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9985         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9986     END-IF.
  9987
  9988     IF CF-ST-CAUSAL-STATE > SPACES
  9989         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9990     END-IF.
  9991     if cf-st-extra-interest-periods not numeric
  9992        move zeros               to cf-st-extra-interest-periods
  9993     end-if
  9994     if cf-st-extra-payments not numeric
  9995        move zeros               to cf-st-extra-payments
  9996     end-if
  9997
  9998     move cf-st-extra-interest-periods
  9999                                 to ws-int-periods
 10000     move cf-st-extra-payments   to ws-extra-pmts
 10001     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10002     move cf-st-net-only-state   to ws-net-only-state
 10003     if cf-st-comm-cap-sl not numeric
 10004        move zeros               to cf-st-comm-cap-sl
 10005     end-if
 10006     if cf-st-comm-cap-jl not numeric
 10007        move zeros               to cf-st-comm-cap-jl
 10008     end-if
 10009     if cf-st-comm-cap-sa not numeric
 10010        move zeros               to cf-st-comm-cap-sa
 10011     end-if
 10012     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 183
* EL050.cbl
 10013        move zeros               to cf-st-comm-cap-ja
 10014     end-if
 10015     if cf-st-ga-comm-cap-sl not numeric
 10016        move zeros               to cf-st-ga-comm-cap-sl
 10017     end-if
 10018     if cf-st-ga-comm-cap-jl not numeric
 10019        move zeros               to cf-st-ga-comm-cap-jl
 10020     end-if
 10021     if cf-st-ga-comm-cap-sa not numeric
 10022        move zeros               to cf-st-ga-comm-cap-sa
 10023     end-if
 10024     if cf-st-ga-comm-cap-ja not numeric
 10025        move zeros               to cf-st-ga-comm-cap-ja
 10026     end-if
 10027
 10028     if cf-st-tot-comm-cap-sl not numeric
 10029        move zeros               to cf-st-tot-comm-cap-sl
 10030     end-if
 10031     if cf-st-tot-comm-cap-jl not numeric
 10032        move zeros               to cf-st-tot-comm-cap-jl
 10033     end-if
 10034     if cf-st-tot-comm-cap-sa not numeric
 10035        move zeros               to cf-st-tot-comm-cap-sa
 10036     end-if
 10037     if cf-st-tot-comm-cap-ja not numeric
 10038        move zeros               to cf-st-tot-comm-cap-ja
 10039     end-if
 10040
 10041     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10042     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10043     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10044     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10045     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10046     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10047     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10048     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10049     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10050     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10051     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10052     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10053     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10054     IF WS-LF-BENEFIT-CD = ZEROS
 10055        GO TO 0410-CHECK-AH.
 10056
 10057     IF CF-ST-RT-CALC NOT = SPACES
 10058        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10059                                    EC-ST-LF-REM-TERM-CALC
 10060     END-IF
 10061
 10062     IF WS-LF-COVERAGE-TYPE = 'R'
 10063        IF WS-LF-EARNINGS-CALC = '5'
 10064           IF CF-ST-RF-LN-CALC > '0'
 10065              MOVE CF-ST-RF-LN-CALC
 10066                                 TO WS-LF-REFUND-CALC
 10067                                    EC-ST-LF-REFUND-CALC
 10068           END-IF
 10069        ELSE
 10070           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 184
* EL050.cbl
 10071              MOVE CF-ST-RF-LR-CALC
 10072                                 TO WS-LF-REFUND-CALC
 10073                                    EC-ST-LF-REFUND-CALC
 10074           END-IF
 10075        END-IF
 10076     ELSE
 10077        IF CF-ST-RF-LL-CALC > '0'
 10078           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10079                                    EC-ST-LF-REFUND-CALC
 10080        END-IF
 10081     END-IF
 10082
 10083     IF CF-ST-RT-CALC NOT = SPACES
 10084        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10085                                    EC-ST-LF-REM-TERM-CALC
 10086     END-IF
 10087
 10088     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10089     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10090
 10091     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10092
 10093     IF NO-BENEFIT-FOUND
 10094        GO TO 0410-CHECK-AH.
 10095
 10096     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10097        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10098                                 TO EC-ST-LF-REM-TERM-CALC
 10099                                    WS-LF-REM-TERM-CALC
 10100     END-IF
 10101
 10102     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10103        MOVE CF-ST-REFUND-CALC (SUB3)
 10104                                 TO WS-LF-REFUND-CALC
 10105                                    EC-ST-LF-REFUND-CALC
 10106     END-IF
 10107*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10108     if cf-st-extra-periods (sub3) not numeric
 10109        move zeros               to cf-st-extra-periods (sub3)
 10110     end-if
 10111     if cf-st-extra-periods (sub3) > zeros
 10112        if ws-lf-ben-category = 'P'
 10113           move cf-st-extra-periods (sub3)
 10114                                 to ws-extra-pmts
 10115        else
 10116           if ws-lf-ben-category = 'I'
 10117              move cf-st-extra-periods (sub3)
 10118                                 to ws-int-periods
 10119           end-if
 10120        end-if
 10121     end-if
 10122     .
 10123 0410-CHECK-AH.
 10124
 10125     IF WS-AH-BENEFIT-CD = ZEROS
 10126        GO TO 0500-SET-ACCOUNT.
 10127
 10128     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 185
* EL050.cbl
 10129        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10130                                    EC-ST-AH-REM-TERM-CALC
 10131     END-IF
 10132
 10133     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10134        IF CF-ST-RF-CP-CALC > '0'
 10135           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10136                                    EC-ST-AH-REFUND-CALC
 10137        END-IF
 10138     ELSE
 10139        IF CF-ST-RF-AH-CALC > '0'
 10140           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10141                                    EC-ST-AH-REFUND-CALC
 10142        END-IF
 10143     END-IF
 10144     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10145     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10146
 10147     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10148
 10149     IF NO-BENEFIT-FOUND
 10150        GO TO 0500-SET-ACCOUNT.
 10151
 10152     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10153        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10154                                 TO WS-AH-REM-TERM-CALC
 10155                                    EC-ST-AH-REM-TERM-CALC
 10156     END-IF
 10157
 10158     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10159        MOVE CF-ST-REFUND-CALC (SUB3)
 10160                                 TO WS-AH-REFUND-CALC
 10161                                    EC-ST-AH-REFUND-CALC
 10162     END-IF
 10163
 10164*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10165
 10166     GO TO 0500-SET-ACCOUNT.
 10167
 10168 0499-STATE-NOT-FOUND.
 10169
 10170     MOVE ER-2603                TO WS-ERROR.
 10171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10172
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 186
* EL050.cbl
 10174
 10175 0500-SET-ACCOUNT.
 10176*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10177     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10178        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10179        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10180        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10181        MOVE '3'                 TO CNTL-REC-TYPE
 10182        MOVE +0                  TO CNTL-SEQ-NO
 10183
 10184        MOVE '3'                 TO RC-SW-2
 10185        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10186
 10187        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10188           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10189           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10190           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10191                                    WS-ST-AH-PREM-TAX-I
 10192                                    WS-ST-AH-PREM-TAX-G
 10193        ELSE
 10194           IF CF-ST-LF-PREM-TAX NUMERIC
 10195              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10196           END-IF
 10197           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10198              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10199           END-IF
 10200           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10201              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10202           END-IF
 10203        END-IF
 10204        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10205     END-IF
 10206*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10207*  FOR DCC ONLY
 10208     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10209
 10210        MOVE ' '                 TO STAT-MASTER-SW
 10211        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10212        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10213        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10214        MOVE PB-STATE            TO ELSTAT-STATE
 10215        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10216           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10217        END-IF
 10218
 10219        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10220        SET BIN-TO-GREG          TO TRUE
 10221        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10222        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10223        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10224
 10225        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10226        IF STAT-MASTER-FOUND
 10227           MOVE 'N'              TO STAT-MASTER-SW
 10228           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10229           IF STAT-MASTER-FOUND
 10230              IF (ELSTAT-KEY-SAVE (1:12) =
 10231                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 187
* EL050.cbl
 10232                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10233                    MOVE 'F'        TO STAT-MASTER-SW
 10234                 ELSE
 10235                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10236                    IF (STAT-MASTER-FOUND)
 10237                       AND (ELSTAT-KEY-SAVE (1:12) =
 10238                           SF-CONTROL-PRIMARY (1:12))
 10239                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10240                       MOVE 'F'     TO STAT-MASTER-SW
 10241                    END-IF
 10242                 END-IF
 10243              END-IF
 10244           END-IF
 10245        END-IF
 10246
 10247        IF STAT-MASTER-SW = 'F'
 10248           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10249              and (sf-st-lf-prem-tax > zeros)
 10250              MOVE SF-ST-LF-PREM-TAX
 10251                                 TO WS-ST-LF-PREM-TAX
 10252           END-IF
 10253           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10254              and (sf-st-ah-prem-tax-i > zeros)
 10255              MOVE SF-ST-AH-PREM-TAX-I
 10256                                 TO WS-ST-AH-PREM-TAX-I
 10257           END-IF
 10258           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10259              and (sf-st-ah-prem-tax-g > zeros)
 10260              MOVE SF-ST-AH-PREM-TAX-G
 10261                                 TO WS-ST-AH-PREM-TAX-G
 10262           END-IF
 10263        END-IF
 10264     END-IF
 10265     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10266        AND (PB-ISSUE)
 10267        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10268        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10269        AND (AM-GPCD = 06)
 10270        MOVE 'Y'                 TO WS-GOOD-HIN
 10271        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10272           MOVE PB-I-VIN         TO WS-WORK-VIN
 10273           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10274              (V1 > 16)
 10275              IF WS-WORK-VIN (V1:1) NUMERIC
 10276                 MOVE WS-WORK-VIN-N (V1)
 10277                                 TO WS-ROW-B-VAL (V1)
 10278              ELSE
 10279                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10280                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10281                    OR (V2 > 26)
 10282                 END-PERFORM
 10283                 IF V2 < 27
 10284                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10285                 ELSE
 10286                    MOVE 'N'     TO WS-GOOD-HIN
 10287                 END-IF
 10288              END-IF
 10289              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 188
* EL050.cbl
 10290                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10291              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10292                 WS-ROW-D-VAL (V1)
 10293           END-PERFORM
 10294           MOVE ZEROS            TO WS-VIN-REMAINDER
 10295           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10296             REMAINDER WS-VIN-REMAINDER
 10297           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10298              CONTINUE
 10299           ELSE
 10300              MOVE 'N'           TO WS-GOOD-HIN
 10301           END-IF
 10302        ELSE
 10303           MOVE 'N'              TO WS-GOOD-HIN
 10304        END-IF
 10305        IF WS-GOOD-HIN NOT = 'Y'
 10306           MOVE ER-3826           TO WS-ERROR
 10307           PERFORM 9900-ERROR-FORMAT
 10308                                 THRU 9900-EXIT
 10309        END-IF
 10310     END-IF
 10311     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10312        AND (PB-ISSUE)
 10313        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10314        AND (AM-GPCD NOT = 06)
 10315        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10316           perform 3400-edit-vin thru 3400-exit
 10317        ELSE
 10318          MOVE ER-3826           TO WS-ERROR
 10319          PERFORM 9900-ERROR-FORMAT
 10320                                 THRU 9900-EXIT
 10321        END-IF
 10322     END-IF
 10323     if (pb-company-id = 'CID')
 10324        and (pb-issue)
 10325        and (pb-i-vin not = spaces and low-values and zeros)
 10326        perform 3400-edit-vin    thru 3400-exit
 10327     end-if
 10328******************************************************************
 10329******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10330******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10331******* METHODS.
 10332******************************************************************
 10333     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10334        IF PB-CANCELLATION
 10335           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10336              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10337                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10338                IF FORM-MASTER-FOUND
 10339                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10340******************************************************************
 10341
 10342     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10343     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10344
 10345     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10346     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10347     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 189
* EL050.cbl
 10348     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10349
 10350
 10351     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10352     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10353     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10354
 10355     IF AM-LF-OB-RATE NOT NUMERIC
 10356         MOVE ZERO               TO AM-LF-OB-RATE.
 10357
 10358     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10359         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10360
 10361     IF AM-AH-OB-RATE NOT NUMERIC
 10362         MOVE ZERO               TO AM-AH-OB-RATE.
 10363
 10364     IF WS-LF-JOINT-INDICATOR = 'J'
 10365         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10366     ELSE
 10367         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10368
 10369     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10370
 10371     IF WS-IG-OVRD-AM  EQUAL SPACE
 10372         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10373
 10374     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10375         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10376                                       WS-IG-OVRD
 10377     ELSE
 10378         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10379             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10380                                       WS-IG-OVRD
 10381         ELSE
 10382             MOVE AM-IG             TO WS-IG-OVRD-AH
 10383                                       WS-IG-OVRD.
 10384
 10385     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10386         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10387                                       WS-IG-OVRD
 10388     ELSE
 10389         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10390             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10391                                       WS-IG-OVRD
 10392         ELSE
 10393             MOVE AM-IG             TO WS-IG-OVRD-LF
 10394                                       WS-IG-OVRD.
 10395
 10396     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10397     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10398     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10399     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10400*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10401     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10402                                              TO 'PRLDSFCTIA'.
 10403
 10404     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10405     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 190
* EL050.cbl
 10406     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10407     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10408
 10409     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10410     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10411     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10412     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10413     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10414     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10415     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10416
 10417     IF WS-ACCT-AH-DEV-PCT > +0
 10418        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10419     ELSE
 10420        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10421
 10422     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10423        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10424     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10425        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10426
 10427        IF AM-EARN-METHOD-L = 'S'
 10428            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10429                                        WS-LF-REFUND-CALC.
 10430
 10431        IF AM-EARN-METHOD-R = 'S'
 10432            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10433                                        WS-LF-REFUND-CALC.
 10434
 10435     IF WS-LF-COVERAGE-TYPE = 'R'
 10436         IF AM-EARN-METHOD-R = 'R'
 10437            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10438                                    WS-LF-REFUND-CALC.
 10439     IF WS-LF-COVERAGE-TYPE = 'R'
 10440         IF AM-EARN-METHOD-R = 'P'
 10441            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10442                                    WS-LF-REFUND-CALC.
 10443     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10444         IF AM-EARN-METHOD-L = 'R'
 10445            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10446                                    WS-LF-REFUND-CALC.
 10447     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10448         IF AM-EARN-METHOD-L = 'P'
 10449            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10450                                    WS-LF-REFUND-CALC.
 10451     IF WS-LF-COVERAGE-TYPE = 'R'
 10452         IF AM-EARN-METHOD-R = 'A'
 10453            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10454                                    WS-LF-REFUND-CALC.
 10455     IF WS-LF-COVERAGE-TYPE = 'R'
 10456         IF AM-EARN-METHOD-R = 'M'
 10457            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10458                                    WS-LF-REFUND-CALC.
 10459     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10460         IF AM-EARN-METHOD-L = 'A'
 10461            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10462                                    WS-LF-REFUND-CALC.
 10463     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 191
* EL050.cbl
 10464         IF AM-EARN-METHOD-L = 'M'
 10465            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10466                                    WS-LF-REFUND-CALC.
 10467
 10468     IF AM-EARN-METHOD-A = 'R'
 10469        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10470                                    WS-AH-REFUND-CALC.
 10471     IF AM-EARN-METHOD-A = 'P'
 10472        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10473                                    WS-AH-REFUND-CALC.
 10474     IF AM-EARN-METHOD-A = 'C'
 10475        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10476                                    WS-AH-REFUND-CALC.
 10477     IF AM-EARN-METHOD-A = 'A'
 10478        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10479                                    WS-AH-REFUND-CALC.
 10480     IF AM-EARN-METHOD-A = 'M'
 10481        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10482                                    WS-AH-REFUND-CALC.
 10483     IF AM-EARN-METHOD-A = 'N'
 10484        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10485                                    WS-AH-REFUND-CALC.
 10486     IF AM-EARN-METHOD-A = 'S'
 10487        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10488                                    WS-AH-REFUND-CALC.
 10489
 10490     IF AM-TOL-PREM NOT = ZEROS
 10491        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10492                                    WS-TOL-AH-PREM.
 10493
 10494     IF AM-OVR-SHT-AMT NUMERIC AND
 10495                  AM-OVR-SHT-AMT > 0
 10496        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10497                                    EC-AM-LF-OVR-SHT-AMT
 10498                                    WS-AH-REFUND-OVS-AMT
 10499                                    EC-AM-AH-OVR-SHT-AMT.
 10500
 10501     IF AM-OVR-SHT-PCT NUMERIC AND
 10502                    AM-OVR-SHT-PCT > 0
 10503        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10504                                    EC-AM-LF-OVR-SHT-PCT
 10505                                    WS-AH-REFUND-OVS-PCT
 10506                                    EC-AM-AH-OVR-SHT-PCT.
 10507
 10508     IF AM-TOL-REF-PCT NUMERIC AND
 10509                  AM-TOL-REF-PCT > 0
 10510        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10511                                    WS-TOL-AH-REFUND-PCT.
 10512
 10513     IF AM-TOL-REF  NOT = ZEROS  AND
 10514                  AM-TOL-REF NUMERIC
 10515        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10516                                    EC-AM-LF-TOL-REFUND
 10517                                    WS-TOL-AH-REFUND
 10518                                    EC-AM-AH-TOL-REFUND.
 10519
 10520     IF AM-TOL-CLM  NOT = ZEROS
 10521        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 192
* EL050.cbl
 10522                                    WS-TOL-AH-CLAIM.
 10523
 10524     IF AM-CLP-TOL-PCT NOT NUMERIC
 10525        MOVE +0                  TO AM-CLP-TOL-PCT
 10526     END-IF
 10527
 10528     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10529        MOVE +0                  TO AM-SPP-LEASE-COMM
 10530     END-IF
 10531     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10532        MOVE WS-PL-TOL-LF-PREM-PCT
 10533                                 TO WS-TOL-LF-PREM-PCT.
 10534
 10535     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10536        MOVE WS-PL-TOL-AH-PREM-PCT
 10537                                 TO WS-TOL-AH-PREM-PCT.
 10538
 10539     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10540        MOVE WS-PL-TOL-LF-REFUND-PCT
 10541                                 TO WS-TOL-LF-REFUND-PCT.
 10542
 10543     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10544        MOVE WS-PL-TOL-AH-REFUND-PCT
 10545                                 TO WS-TOL-AH-REFUND-PCT.
 10546
 10547     IF WS-PL-REF-OVS-AMT > +0
 10548        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10549
 10550     IF WS-PL-REF-OVS-PCT > +0
 10551        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10552
 10553     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10554        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10555     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10556        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10557     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10558        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10559     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10560        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10561     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10562        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10563     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10564        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10565
 10566     IF WS-AH-PL-REF-OVS-AMT > +0
 10567        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10568
 10569     IF WS-AH-PL-REF-OVS-PCT > +0
 10570        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10571
 10572     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10573     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10574
 10575     IF PB-CANCELLATION
 10576        GO TO 3000-CONTINUE-EDIT.
 10577
 10578     MOVE +1 TO SUB1.
 10579     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 193
* EL050.cbl
 10580     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10581
 10582     IF CF-COMPANY-ID = 'DMD'
 10583       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10584         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10585        ELSE
 10586         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10587
 10588  0525-FIND-ACCT-COMM.
 10589     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10590        NEXT SENTENCE
 10591      ELSE
 10592         ADD +1 TO SUB1
 10593         IF SUB1 LESS +11
 10594            GO TO 0525-FIND-ACCT-COMM
 10595          ELSE
 10596             GO TO 0550-st-comm-cap-check.
 10597
 10598     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10599     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10600                                    PB-I-LIFE-COMMISSION.
 10601***  IF PB-COMPANY-ID = 'CRI'
 10602     IF PB-PREM-ACCTNG-ONLY
 10603         GO TO 0550-st-comm-cap-check.
 10604
 10605     MOVE '0530' TO CTBL-SW.
 10606     MOVE ' '    TO WS-CTBL-READ-SW.
 10607
 10608
 10609 0530-GET-AH-COMP.
 10610     IF NO-AH-COVERAGE  OR
 10611        NO-AH-BENEFIT-MATCH
 10612           GO TO 0540-NEXT-READ-STEP.
 10613
 10614     IF AM-A-COM (SUB1) NUMERIC
 10615        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10616         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10617         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10618         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10619         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10620     ELSE
 10621          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10622          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10623          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10624          MOVE ZEROS             TO WS-SUB1
 10625                                    WS-COMMISSION
 10626          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10627          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10628          IF WS-COMMISSION > ZEROS
 10629             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10630             GO TO 0540-NEXT-READ-STEP
 10631          END-IF
 10632          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10633          IF CTBL-TABLE-FOUND
 10634             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10635                                        PB-I-AH-TERM
 10636             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10637             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 194
* EL050.cbl
 10638             GO TO 0540-NEXT-READ-STEP
 10639          ELSE
 10640             IF FIRST-TIME-THROUGH
 10641                 GO TO 0530-GET-AH-COMP
 10642             ELSE
 10643                 MOVE ER-2609                TO WS-ERROR
 10644                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10645
 10646 0540-NEXT-READ-STEP.
 10647     MOVE '0540' TO CTBL-SW.
 10648     MOVE ' '    TO WS-CTBL-READ-SW.
 10649
 10650 0540-GET-LF-COMP.
 10651     IF NO-LIFE-COVERAGE  OR
 10652        NO-LF-BENEFIT-MATCH
 10653           GO TO 0550-st-comm-cap-check.
 10654
 10655     IF WS-LF-JOINT-INDICATOR = 'J'
 10656        IF AM-J-COM (SUB1) NUMERIC
 10657           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10658           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10659           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10660           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10661           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10662        ELSE
 10663           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10664           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10665           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10666           MOVE ZEROS                TO WS-SUB1
 10667                                        WS-COMMISSION
 10668           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10669           IF WS-COMMISSION > ZEROS
 10670              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10671              GO TO 0550-st-comm-cap-check
 10672           END-IF
 10673           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10674           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10675           IF CTBL-TABLE-FOUND
 10676              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10677              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10678              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10679              GO TO 0550-st-comm-cap-check
 10680           ELSE
 10681              IF FIRST-TIME-THROUGH
 10682                  GO TO 0540-GET-LF-COMP
 10683              ELSE
 10684                  MOVE ER-2609                TO WS-ERROR
 10685                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10686                  GO TO 0550-st-comm-cap-check.
 10687
 10688     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10689        IF AM-L-COM (SUB1) NUMERIC
 10690           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10691           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10692           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10693           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10694           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10695        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 195
* EL050.cbl
 10696           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10697           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10698           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10699           MOVE ZEROS                TO WS-SUB1
 10700                                        WS-COMMISSION
 10701           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10702           IF WS-COMMISSION IS GREATER THAN ZEROS
 10703              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10704              GO TO 0550-st-comm-cap-check
 10705           END-IF
 10706           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10707           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10708           IF CTBL-TABLE-FOUND
 10709              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10710              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10711              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10712              GO TO 0550-st-comm-cap-check
 10713           ELSE
 10714              IF FIRST-TIME-THROUGH
 10715                  GO TO 0540-GET-LF-COMP
 10716              ELSE
 10717                  MOVE ER-2609                TO WS-ERROR
 10718                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10719
 10720 0550-st-comm-cap-check.
 10721
 10722     move +0                     to ws-tot-sl-wk-rate
 10723                                    ws-sl-wk-rate
 10724                                    ws-ga-sl-wk-rate
 10725                                    ws-tot-jl-wk-rate
 10726                                    ws-jl-wk-rate
 10727                                    ws-ga-jl-wk-rate
 10728                                    ws-tot-sa-wk-rate
 10729                                    ws-sa-wk-rate
 10730                                    ws-ga-sa-wk-rate
 10731                                    ws-tot-ja-wk-rate
 10732                                    ws-ja-wk-rate
 10733                                    ws-ga-ja-wk-rate
 10734     perform varying sub5 from +1 by +1 until
 10735        (sub5 > +10)
 10736        move +0                  to ws-wk-rate
 10737        if (am-gl-codes (sub5) <> 'Y')
 10738           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10739           if pb-i-lf-benefit-cd <> '  ' and '00'
 10740              move zeros         to ws-wk-rate
 10741              if (am-l-com (sub5) numeric)
 10742                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10743                 move am-l-com(sub5)
 10744                                 to ws-wk-rate
 10745              else
 10746                 move pb-company-cd to ctbl-company-cd
 10747                 move pb-i-lf-benefit-cd
 10748                                 to ctbl-ben-code
 10749                 move pb-i-lf-term  to ws-work-term
 10750                 move pb-life-override-l1
 10751                                 to ctbl-ben-type
 10752                 move zeros      to ws-sub1
 10753                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 196
* EL050.cbl
 10754                 move am-l-coma (sub5)
 10755                                 to ctbl-table
 10756                 move '0540'     to ctbl-sw
 10757                 perform 0552-get-it
 10758                                 thru 0552-exit
 10759              end-if
 10760              compute ws-tot-sl-wk-rate =
 10761                 ws-tot-sl-wk-rate + ws-wk-rate
 10762              if am-com-typ(sub5) = 'C' or 'D'
 10763                 compute ws-sl-wk-rate =
 10764                    ws-sl-wk-rate + ws-wk-rate
 10765              else
 10766                 if am-com-typ(sub5) = 'O' or 'P'
 10767                    compute ws-ga-sl-wk-rate =
 10768                       ws-ga-sl-wk-rate + ws-wk-rate
 10769                 end-if
 10770              end-if
 10771
 10772              move zeros         to ws-wk-rate
 10773              if (am-j-com (sub5) numeric)
 10774                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10775                 move am-j-com(sub5)
 10776                                 to ws-wk-rate
 10777              else
 10778                 move pb-company-cd to ctbl-company-cd
 10779                 move pb-i-lf-benefit-cd
 10780                                 to ctbl-ben-code
 10781                 move pb-i-lf-term  to ws-work-term
 10782                 move pb-life-override-l1
 10783                                 to ctbl-ben-type
 10784                 move zeros      to ws-sub1
 10785                                    ws-commission
 10786                 move am-j-coma (sub5)
 10787                                 to ctbl-table
 10788                 move '0540'     to ctbl-sw
 10789                 perform 0552-get-it
 10790                                 thru 0552-exit
 10791              end-if
 10792              compute ws-tot-jl-wk-rate =
 10793                 ws-tot-jl-wk-rate + ws-wk-rate
 10794              if am-com-typ(sub5) = 'C' or 'D'
 10795                 compute ws-jl-wk-rate =
 10796                    ws-jl-wk-rate + ws-wk-rate
 10797              else
 10798                 if am-com-typ(sub5) = 'O' or 'P'
 10799                    compute ws-ga-jl-wk-rate =
 10800                       ws-ga-jl-wk-rate + ws-wk-rate
 10801                 end-if
 10802              end-if
 10803           end-if
 10804           move zeros            to ws-wk-rate
 10805
 10806           if pb-i-ah-benefit-cd <> '  ' and '00'
 10807              if (am-a-com (sub5) numeric)
 10808                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10809                 move am-a-com(sub5)
 10810                                 to ws-wk-rate
 10811              else
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 197
* EL050.cbl
 10812                 move pb-company-cd to ctbl-company-cd
 10813                 move pb-i-ah-benefit-cd
 10814                                 to ctbl-ben-code
 10815                 move pb-i-ah-term  to ws-work-term
 10816                 move pb-ah-override-l1
 10817                                 to ctbl-ben-type
 10818                 move zeros      to ws-sub1
 10819                                    ws-commission
 10820                 move am-a-coma (sub5)
 10821                                 to ctbl-table
 10822                 move '0530'     to ctbl-sw
 10823                 perform 0552-get-it
 10824                                 thru 0552-exit
 10825              end-if
 10826              compute ws-tot-sa-wk-rate =
 10827                 ws-tot-sa-wk-rate + ws-wk-rate
 10828              if am-com-typ(sub5) = 'C' or 'D'
 10829                 compute ws-sa-wk-rate =
 10830                    ws-sa-wk-rate + ws-wk-rate
 10831              else
 10832                 if am-com-typ(sub5) = 'O' or 'P'
 10833                    compute ws-ga-sa-wk-rate =
 10834                       ws-ga-sa-wk-rate + ws-wk-rate
 10835                 end-if
 10836              end-if
 10837           end-if
 10838        end-if
 10839     end-perform
 10840
 10841     go to 0550-continue
 10842
 10843     .
 10844 0552-get-it.
 10845
 10846     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10847     MOVE ZEROS                  TO WS-SUB1
 10848                                    WS-COMMISSION
 10849     MOVE ' '                    TO WS-CTBL-READ-SW
 10850     PERFORM 8300-READ-CTBL-TABLE
 10851                                 THRU 8300-EXIT
 10852     IF FIRST-TIME-THROUGH
 10853        MOVE 'AA'                TO CTBL-BEN-CODE
 10854        PERFORM 8300-READ-CTBL-TABLE
 10855                                 THRU 8300-EXIT
 10856     END-IF
 10857     IF CTBL-TABLE-FOUND
 10858        if pb-life-override-l1 = ctbl-ben-type
 10859           move pb-i-lf-benefit-amt
 10860                                 to WS-COMM-CK-AMT
 10861        else
 10862           compute ws-comm-ck-amt =
 10863              pb-I-ah-benefit-amt * pb-i-ah-term
 10864        end-if
 10865        PERFORM 8800-GET-COMP-RATE
 10866                                 THRU 8800-EXIT
 10867     else
 10868        move zeros               to ws-wk-rate
 10869     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 198
* EL050.cbl
 10870
 10871     .
 10872 0552-exit.
 10873     exit.
 10874
 10875 0550-continue.
 10876
 10877     if ws-lf-joint-indicator = 'J'
 10878        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10879           and (ws-st-comm-cap-jl <> zeros)
 10880           MOVE ER-1956          TO WS-ERROR
 10881           PERFORM 9900-ERROR-FORMAT
 10882                                 THRU 9900-EXIT
 10883        end-if
 10884        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10885           and (ws-st-ga-comm-cap-jl <> zeros)
 10886           MOVE ER-1959          TO WS-ERROR
 10887           PERFORM 9900-ERROR-FORMAT
 10888                                 THRU 9900-EXIT
 10889        end-if
 10890        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10891           and (ws-st-tot-comm-cap-jl <> zeros)
 10892           MOVE ER-1962          TO WS-ERROR
 10893           PERFORM 9900-ERROR-FORMAT
 10894                                 THRU 9900-EXIT
 10895        end-if
 10896     else
 10897        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10898           and (ws-st-comm-cap-sl <> zeros)
 10899           MOVE ER-1955          TO WS-ERROR
 10900           PERFORM 9900-ERROR-FORMAT
 10901                                 THRU 9900-EXIT
 10902        end-if
 10903        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10904           and (ws-st-ga-comm-cap-sl <> zeros)
 10905           MOVE ER-1958          TO WS-ERROR
 10906           PERFORM 9900-ERROR-FORMAT
 10907                                 THRU 9900-EXIT
 10908        end-if
 10909        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10910           and (ws-st-tot-comm-cap-sl <> zeros)
 10911           MOVE ER-1961          TO WS-ERROR
 10912           PERFORM 9900-ERROR-FORMAT
 10913                                 THRU 9900-EXIT
 10914        end-if
 10915
 10916     if ws-ah-joint-indicator = 'J'
 10917        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10918           and (ws-st-comm-cap-ja <> zeros)
 10919           MOVE ER-1957          TO WS-ERROR
 10920           PERFORM 9900-ERROR-FORMAT
 10921                                 THRU 9900-EXIT
 10922        end-if
 10923        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10924           and (ws-st-ga-comm-cap-ja <> zeros)
 10925           MOVE ER-1960          TO WS-ERROR
 10926           PERFORM 9900-ERROR-FORMAT
 10927                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 199
* EL050.cbl
 10928        end-if
 10929        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10930           and (ws-st-tot-comm-cap-ja <> zeros)
 10931           MOVE ER-1963          TO WS-ERROR
 10932           PERFORM 9900-ERROR-FORMAT
 10933                                 THRU 9900-EXIT
 10934        end-if
 10935     else
 10936        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10937           and (ws-st-comm-cap-sa <> zeros)
 10938           MOVE ER-1957          TO WS-ERROR
 10939           PERFORM 9900-ERROR-FORMAT
 10940                                 THRU 9900-EXIT
 10941        end-if
 10942        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10943           and (ws-st-ga-comm-cap-sa <> zeros)
 10944           MOVE ER-1960          TO WS-ERROR
 10945           PERFORM 9900-ERROR-FORMAT
 10946                                 THRU 9900-EXIT
 10947        end-if
 10948        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10949           and (ws-st-tot-comm-cap-sa <> zeros)
 10950           MOVE ER-1963          TO WS-ERROR
 10951           PERFORM 9900-ERROR-FORMAT
 10952                                 THRU 9900-EXIT
 10953        end-if
 10954     end-if
 10955     .
 10956 0560-EDIT-CONTINUE.
 10957     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10958                                    WS-AH-PMF-COMM
 10959*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10960*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10961     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10962        (SUB1 > +10)
 10963        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10964           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10965           MOVE '0530'           TO CTBL-SW
 10966           MOVE ' '              TO WS-CTBL-READ-SW
 10967           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10968           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10969           MOVE '0540'           TO CTBL-SW
 10970           MOVE ' '              TO WS-CTBL-READ-SW
 10971           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10972        END-IF
 10973     END-PERFORM
 10974     GO TO 0564-EDIT-CONTINUE
 10975     .
 10976 0561-CHECK-AH.
 10977     IF (NO-AH-COVERAGE)
 10978        OR (NO-AH-BENEFIT-MATCH)
 10979        CONTINUE
 10980     ELSE
 10981        IF (AM-A-COM (SUB1) NUMERIC)
 10982           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10983           IF (AM-COM-TYP (SUB1) = 'A')
 10984              AND (WS-AH-PMF-COMM = ZEROS)
 10985              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 200
* EL050.cbl
 10986           END-IF
 10987           CONTINUE
 10988        ELSE
 10989           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10990           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10991           MOVE PB-AH-OVERRIDE-L1
 10992                                 TO CTBL-BEN-TYPE
 10993           MOVE ZEROS            TO WS-SUB1
 10994                                    WS-COMMISSION
 10995           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10996           PERFORM 8300-READ-CTBL-TABLE
 10997                                 THRU 8300-EXIT
 10998           IF CTBL-TABLE-FOUND
 10999              IF (AM-COM-TYP (SUB1) = 'A')
 11000                 AND (WS-AH-PMF-COMM = ZEROS)
 11001                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11002                                        PB-I-AH-TERM
 11003                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11004                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11005              END-IF
 11006              CONTINUE
 11007           ELSE
 11008              IF FIRST-TIME-THROUGH
 11009                 GO TO 0561-CHECK-AH
 11010              ELSE
 11011                 MOVE ER-2609    TO WS-ERROR
 11012                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11013              END-IF
 11014           END-IF
 11015        END-IF
 11016     END-IF
 11017     .
 11018 0561-EXIT.
 11019     EXIT.
 11020 0563-CHECK-LF.
 11021     IF (NO-LIFE-COVERAGE)
 11022        OR (NO-LF-BENEFIT-MATCH)
 11023        CONTINUE
 11024     ELSE
 11025        IF WS-LF-JOINT-INDICATOR = 'J'
 11026           IF AM-J-COM (SUB1) NUMERIC
 11027              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11028              IF (AM-COM-TYP (SUB1) = 'A')
 11029                 AND (WS-LF-PMF-COMM = ZEROS)
 11030                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11031              END-IF
 11032              CONTINUE
 11033           ELSE
 11034              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11035              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11036              MOVE PB-LIFE-OVERRIDE-L1
 11037                                 TO CTBL-BEN-TYPE
 11038              MOVE ZEROS         TO WS-SUB1
 11039                                    WS-COMMISSION
 11040              MOVE AM-J-COMA (SUB1)
 11041                                 TO CTBL-TABLE
 11042              PERFORM 8300-READ-CTBL-TABLE
 11043                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 201
* EL050.cbl
 11044              IF CTBL-TABLE-FOUND
 11045                 IF (AM-COM-TYP (SUB1) = 'A')
 11046                    AND (WS-LF-PMF-COMM = ZEROS)
 11047                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11048                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11049                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11050                 END-IF
 11051                 CONTINUE
 11052              ELSE
 11053                 IF FIRST-TIME-THROUGH
 11054                    GO TO 0563-CHECK-LF
 11055                 ELSE
 11056                    MOVE ER-2609 TO WS-ERROR
 11057                    PERFORM 9900-ERROR-FORMAT
 11058                                 THRU 9900-EXIT
 11059*                   GO TO 0560-EDIT-CONTINUE
 11060                 END-IF
 11061              END-IF
 11062           END-IF
 11063        ELSE
 11064           IF AM-L-COM (SUB1) NUMERIC
 11065              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11066              IF (AM-COM-TYP (SUB1) = 'A')
 11067                 AND (WS-LF-PMF-COMM = ZEROS)
 11068                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11069              END-IF
 11070              CONTINUE
 11071           ELSE
 11072              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11073              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11074              MOVE PB-LIFE-OVERRIDE-L1
 11075                                 TO CTBL-BEN-TYPE
 11076              MOVE ZEROS         TO WS-SUB1
 11077                                    WS-COMMISSION
 11078              MOVE AM-L-COMA (SUB1)
 11079                                 TO CTBL-TABLE
 11080              PERFORM 8300-READ-CTBL-TABLE
 11081                                 THRU 8300-EXIT
 11082              IF CTBL-TABLE-FOUND
 11083                 CONTINUE
 11084              ELSE
 11085                 IF FIRST-TIME-THROUGH
 11086                    GO TO 0563-CHECK-LF
 11087                 ELSE
 11088                    MOVE ER-2609 TO WS-ERROR
 11089                    PERFORM 9900-ERROR-FORMAT
 11090                                 THRU 9900-EXIT
 11091                 END-IF
 11092              END-IF
 11093           END-IF
 11094        END-IF
 11095     END-IF
 11096     .
 11097 0563-EXIT.
 11098     EXIT.
 11099 0564-EDIT-CONTINUE.
 11100
 11101     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 202
* EL050.cbl
 11102         IF PB-I-NUM-BILLED EQUAL ZEROS
 11103            MOVE ER-8148       TO WS-ERROR
 11104            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11105
 11106*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11107*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11108*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11109*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11110*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11111*         IF NO-CONVERSION-ERROR
 11112*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11113*         ELSE
 11114*             IF PB-COMPANY-ID EQUAL 'HAN'
 11115*                 MOVE ZEROS     TO PB-I-AGE.
 11116     IF PB-I-BIRTHDAY > LOW-VALUES
 11117        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11118        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11119        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11120        PERFORM 8500-DATE-CONVERT
 11121                                 THRU 8500-EXIT
 11122        IF NO-CONVERSION-ERROR
 11123           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11124           IF PB-I-AGE > ZEROS
 11125              IF WS-WORK-AGE NOT = PB-I-AGE
 11126                 MOVE ER-9501    TO WS-ERROR
 11127                 PERFORM 9900-ERROR-FORMAT
 11128                                 THRU 9900-EXIT
 11129              END-IF
 11130           ELSE
 11131              MOVE WS-WORK-AGE   TO PB-I-AGE
 11132           END-IF
 11133        END-IF
 11134     END-IF
 11135     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11136                                   WS-INS-AGE-SET
 11137     IF PB-I-AGE = ZEROS
 11138        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11139           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11140                                   WS-INS-AGE-SET
 11141           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11142
 11143     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11144                                   WS-AH-EDIT-AGE.
 11145
 11146     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11147        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11148        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11149        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11150        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11151        IF NO-CONVERSION-ERROR
 11152           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11153           IF PB-I-JOINT-AGE > 0
 11154              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11155                 MOVE ER-9503    TO WS-ERROR
 11156                 PERFORM 9900-ERROR-FORMAT
 11157                                 THRU 9900-EXIT
 11158              END-IF
 11159           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 203
* EL050.cbl
 11160              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11161           END-IF
 11162        ELSE
 11163           MOVE ZEROS            TO PB-I-JOINT-AGE
 11164        END-IF
 11165     END-IF
 11166     IF PB-I-JOINT-AGE NOT NUMERIC
 11167        MOVE ZERO               TO PB-I-JOINT-AGE.
 11168
 11169     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11170                                   WS-JNT-AGE-SET
 11171     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11172        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11173           (WS-AH-JOINT-INDICATOR = 'J')
 11174           IF PB-I-JOINT-AGE = ZEROS
 11175               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11176                                          WS-JNT-AGE-SET
 11177               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11178           END-IF
 11179        END-IF
 11180     END-IF
 11181
 11182     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11183     IF WS-LF-JOINT-INDICATOR = 'J'
 11184        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11185        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11186            IF  PB-I-JOINT-AGE = ZERO
 11187                MOVE ER-2686       TO WS-ERROR
 11188                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11189            ELSE
 11190                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11191                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11192                    IF PB-COMPANY-ID NOT = 'LBL'
 11193                        MOVE ER-2685    TO WS-ERROR
 11194                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11195
 11196     IF WS-AH-JOINT-INDICATOR = 'J'
 11197        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11198            IF  PB-I-JOINT-AGE = ZERO
 11199                MOVE ER-2686       TO WS-ERROR
 11200                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11201            ELSE
 11202                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11203                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11204                                           WS-EDIT-AGE
 11205                    IF PB-COMPANY-ID NOT = 'LBL'
 11206                        MOVE ER-2685    TO WS-ERROR
 11207                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11208
 11209******************************************************************
 11210*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11211******************************************************************
 11212
 11213     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11214        (WS-AH-SPECIAL-CALC-CD = 'O')
 11215        NEXT SENTENCE
 11216     ELSE
 11217        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 204
* EL050.cbl
 11218          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11219           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11220            WS-AH-JOINT-INDICATOR = 'J')  AND
 11221           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11222            MOVE ER-2627             TO WS-ERROR
 11223            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11224
 11225     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11226        (WS-AH-SPECIAL-CALC-CD = 'O')
 11227         NEXT SENTENCE
 11228     ELSE
 11229         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11230            WS-AH-JOINT-INDICATOR = 'J'
 11231             IF PB-I-JOINT-INSURED = SPACES
 11232                 IF PB-COMPANY-ID NOT = 'JAL'
 11233                     MOVE ER-2696    TO WS-ERROR
 11234                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11235
 11236     IF PB-COMPANY-ID NOT = 'BOA'
 11237        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11238           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11239           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11240               PB-I-JOINT-INSURED NOT = SPACES)
 11241                MOVE ER-2691         TO WS-ERROR
 11242                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11243
 11244     IF PB-COMPANY-ID = 'BOA'
 11245        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11246           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11247            IF PB-I-JOINT-AGE NOT = ZEROS
 11248                MOVE ER-2691         TO WS-ERROR
 11249                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11250
 11251     IF PB-COMPANY-ID = 'CRI'
 11252        IF PB-I-SIG-SW = 'J'
 11253           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11254              WS-AH-JOINT-INDICATOR NOT = 'J'
 11255              MOVE ER-2675       TO WS-ERROR
 11256              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11257
 11258     IF PB-COMPANY-ID = 'CRI'
 11259        IF PB-I-SIG-SW = 'S'
 11260           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11261              WS-AH-JOINT-INDICATOR = 'J'
 11262              MOVE ER-2676       TO WS-ERROR
 11263              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
 11265     IF PB-COMPANY-ID = 'CVL'
 11266         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11267            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11268              MOVE ER-2783           TO WS-ERROR
 11269              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11270     IF (WS-LF-JOINT-INDICATOR = 'J')
 11271        AND (WS-AH-JOINT-INDICATOR = 'J')
 11272        AND (PB-I-LF-TERM > 120)
 11273        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11274        MOVE ER-2783             TO WS-ERROR
 11275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 205
* EL050.cbl
 11276     END-IF
 11277     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11278
 11279     IF PB-I-INDV-GRP-OVRD = 'I'
 11280        MOVE ER-2666             TO WS-ERROR
 11281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11282        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11283
 11284     IF PB-I-INDV-GRP-OVRD = 'G'
 11285        MOVE ER-2666             TO WS-ERROR
 11286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11287        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11288
 11289     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11290        NEXT SENTENCE
 11291     ELSE
 11292        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11293
 11294     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11295        IF WS-ERROR = ER-2666
 11296           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11297           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11298
 11299     IF PB-COMPANY-ID = 'CID'
 11300        IF PB-STATE = 'UT' OR 'MO'
 11301           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11302                 OR '76' OR '77')
 11303                      OR
 11304               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11305                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11306                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11307                   OR '2K' OR '2L'))
 11308              AND PB-I-INDV-GRP-CD = 'I'
 11309              MOVE ER-2721             TO WS-ERROR
 11310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11311           END-IF
 11312        END-IF
 11313     END-IF
 11314
 11315     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11316     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11317        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11318     ELSE
 11319        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11320     END-IF
 11321
 11322*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11323*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11324     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11325                                    ACCOUNT-AH-CK-SW.
 11326
 11327     IF PB-REISSUED-CERT       OR
 11328        PB-REIN-ONLY-CERT      OR
 11329        PB-POLICY-IS-DECLINED  OR
 11330        PB-POLICY-IS-VOIDED
 11331*       OR PB-MONTHLY-CERT
 11332         GO TO 3000-CONTINUE-EDIT.
 11333
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 206
* EL050.cbl
 11334     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11335        IF WS-EDIT-AGE           > +65
 11336           MOVE ER-2709          TO WS-ERROR
 11337           PERFORM 9900-ERROR-FORMAT
 11338                                 THRU 9900-EXIT
 11339        ELSE
 11340           IF WS-EDIT-AGE        > +55
 11341              MOVE ER-2718       TO WS-ERROR
 11342              PERFORM 9900-ERROR-FORMAT
 11343                                 THRU 9900-EXIT
 11344           END-IF
 11345        END-IF
 11346     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11347        IF WS-EDIT-AGE           > +65
 11348           MOVE ER-2709          TO WS-ERROR
 11349           PERFORM 9900-ERROR-FORMAT
 11350                                 THRU 9900-EXIT
 11351        END-IF
 11352     END-IF
 11353     .
 11354
 11355 0565-LIFE-PLAN-LIMIT-EDITS.
 11356
 11357     IF NOT LF-PLAN-MASTER-FOUND
 11358        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11359                                    EC-AM-LF-MAX-TOT-BEN
 11360        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11361
 11362     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11363
 11364     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11365         IF PL-LM-AGE (1) = ZEROS
 11366             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11367
 11368     IF NO-LF-BENEFIT-MATCH          OR
 11369        WS-LF-BENEFIT-CD = ZEROS     OR
 11370        WS-LF-SPECIAL-CALC-CD = 'M'
 11371        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11372
 11373     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11374     MOVE +1                     TO SUB2.
 11375
 11376     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11377        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11378           MOVE +5   TO SUB2
 11379           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11380              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11381              (PL-LM-AGE (SUB2) EQUAL +0)
 11382              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11383              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11384
 11385     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11386
 11387     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11388                               + PB-I-LF-ALT-BENEFIT-AMT.
 11389
 11390 0568-CHECK-LIFE-ATT-AGE.
 11391
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 207
* EL050.cbl
 11392     IF PL-ATT-AGE NUMERIC AND
 11393        PL-ATT-AGE > +0
 11394        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11395     END-IF
 11396*    IF PL-ATT-AGE NUMERIC AND
 11397*       PL-ATT-AGE > +0
 11398*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11399*       IF PB-I-BIRTHDAY > LOW-VALUES
 11400*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11401*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11402*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11403*          SET BIN-PLUS-ELAPSED  TO TRUE
 11404*          PERFORM 8500-DATE-CONVERT
 11405*                                THRU 8500-EXIT
 11406*          IF NO-CONVERSION-ERROR
 11407*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11408*             MOVE ER-2669       TO WS-ERROR
 11409*             PERFORM 9900-ERROR-FORMAT
 11410*                                THRU 9900-EXIT
 11411*          END-IF
 11412*       ELSE
 11413*          IF WS-ATT-AGE >= PL-ATT-AGE
 11414*             MOVE ER-2669       TO WS-ERROR
 11415*             PERFORM 9900-ERROR-FORMAT
 11416*                                THRU 9900-EXIT
 11417*          END-IF
 11418*       END-IF
 11419*    END-IF
 11420     .
 11421 0570-CHECK-LIFE-LIMITS.
 11422
 11423     IF PB-COMPANY-ID EQUAL 'CRI'
 11424        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11425           IF SUB2 GREATER THAN +4
 11426              MOVE ER-2637 TO WS-ERROR
 11427              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11428              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11429
 11430     IF PB-COMPANY-ID  =  'NCL'
 11431        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11432            SUB2 GREATER THAN +8
 11433             MOVE 'U'         TO PB-BATCH-ENTRY
 11434             MOVE ER-2637     TO WS-ERROR
 11435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11436             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11437
 11438     IF SUB2 > +8
 11439        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11440           AND (PB-I-SIG-SW = 'Y')
 11441           CONTINUE
 11442        ELSE
 11443           MOVE ER-2637          TO WS-ERROR
 11444           PERFORM 9900-ERROR-FORMAT
 11445                                 THRU 9900-EXIT
 11446        END-IF
 11447        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11448     END-IF
 11449     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 208
* EL050.cbl
 11450     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11451     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11452
 11453     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11454        ADD +1  TO SUB2
 11455        GO TO 0570-CHECK-LIFE-LIMITS.
 11456
 11457     IF PB-COMPANY-ID = 'NCL'
 11458         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11459
 11460     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11461        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11462        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11463           AND (PB-I-SIG-SW = 'Y')
 11464           CONTINUE
 11465        ELSE
 11466           MOVE ER-2637          TO WS-ERROR
 11467           PERFORM 9900-ERROR-FORMAT
 11468                                 THRU 9900-EXIT
 11469        END-IF
 11470     END-IF
 11471     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11472
 11473
 11474 0570-CHECK-NCL-LIFE-LIMITS.
 11475
 11476     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11477        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11478         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11479
 11480     IF APP-CERT-USED
 11481         IF SUB2  LESS THAN  +5
 11482             MOVE +5          TO SUB2
 11483             GO TO 0570-CHECK-LIFE-LIMITS.
 11484
 11485     MOVE ER-2637             TO WS-ERROR.
 11486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11487
 11488     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11489
 11490 0575-CHECK-NCL-SIG-SWITCH.
 11491
 11492     IF NOT APP-CERT-USED
 11493         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11494
 11495     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11496        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11497        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11498        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11499         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11500
 11501     IF SUB2 GREATER THAN +4
 11502         IF PL-LM-AGE (5) = ZEROS  AND
 11503            PL-LM-AGE (6) = ZEROS  AND
 11504            PL-LM-AGE (7) = ZEROS  AND
 11505            PL-LM-AGE (8) = ZEROS
 11506             MOVE  ER-1927        TO WS-ERROR
 11507             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 209
* EL050.cbl
 11508             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11509         ELSE
 11510             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11511                 MOVE  ER-1920    TO WS-ERROR
 11512                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11513
 11514     IF PB-I-SIG-SW  = 'Y'
 11515       IF NOT PB-I-POLICY-ACCEPTED  AND
 11516          NOT PB-I-POLICY-DECLINED
 11517           MOVE 'U'               TO PB-BATCH-ENTRY
 11518           MOVE  ER-1926          TO WS-ERROR
 11519           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11520
 11521
 11522 0580-AH-PLAN-LIMIT-EDITS.
 11523
 11524     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11525        IF PB-I-AH-BENEFIT-AMT > +1250
 11526           MOVE ER-2702          TO WS-ERROR
 11527           PERFORM 9900-ERROR-FORMAT
 11528                                 THRU 9900-EXIT
 11529        END-IF
 11530     END-IF
 11531
 11532     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11533        AND (PB-MONTHLY-CERT)
 11534        IF PB-I-AH-BENEFIT-AMT > +3000
 11535           MOVE ER-2881          TO WS-ERROR
 11536           PERFORM 9900-ERROR-FORMAT
 11537                                 THRU 9900-EXIT
 11538        END-IF
 11539     END-IF
 11540     IF NOT AH-PLAN-MASTER-FOUND
 11541        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11542        GO TO 3000-CONTINUE-EDIT.
 11543
 11544     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11545
 11546     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11547         IF PL-LM-AGE (1) = ZEROS
 11548             GO TO 3000-CONTINUE-EDIT.
 11549
 11550     IF NO-AH-BENEFIT-MATCH          OR
 11551        WS-AH-BENEFIT-CD = ZEROS     OR
 11552        WS-AH-SPECIAL-CALC-CD = 'M'
 11553        GO TO 3000-CONTINUE-EDIT.
 11554
 11555     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11556     MOVE +1                     TO SUB2.
 11557
 11558     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11559        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11560           MOVE +5 TO SUB2
 11561           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11562              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11563              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11564              (PL-LM-AGE (SUB2) EQUAL +0)
 11565              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 210
* EL050.cbl
 11566              GO TO 3000-CONTINUE-EDIT.
 11567
 11568     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11569
 11570 0590-CHECK-AH-ATT-AGE.
 11571
 11572     IF PL-ATT-AGE NUMERIC AND
 11573        PL-ATT-AGE GREATER THAN +0
 11574        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11575     END-IF
 11576*       IF WS-ATT-AGE >= PL-ATT-AGE
 11577*          MOVE ER-3054          TO WS-ERROR
 11578*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11579     .
 11580 0597-CHECK-AH-LIMITS.
 11581
 11582     IF PB-COMPANY-ID EQUAL 'CRI'
 11583        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11584           IF SUB2 GREATER THAN +4
 11585              MOVE ER-2638       TO WS-ERROR
 11586              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587              GO TO 3000-CONTINUE-EDIT.
 11588
 11589     IF PB-COMPANY-ID  =  'NCL'
 11590        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11591            SUB2 GREATER THAN +8
 11592             MOVE 'U'            TO PB-BATCH-ENTRY
 11593             MOVE ER-2638        TO WS-ERROR
 11594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11596
 11597     IF SUB2 > +8
 11598        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11599           AND (PB-I-SIG-SW = 'Y')
 11600           CONTINUE
 11601        ELSE
 11602           MOVE ER-2638          TO WS-ERROR
 11603           PERFORM 9900-ERROR-FORMAT
 11604                                 THRU 9900-EXIT
 11605        END-IF
 11606        GO TO 3000-CONTINUE-EDIT
 11607     END-IF
 11608
 11609     IF PB-COMPANY-ID = 'CRI'
 11610        IF WS-ERROR = ER-2638
 11611           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11612
 11613     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11614     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11615     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11616     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11617
 11618     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11619        ADD +1                   TO SUB2
 11620        GO TO 0597-CHECK-AH-LIMITS.
 11621
 11622     IF PB-COMPANY-ID = 'NCL'
 11623         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 211
* EL050.cbl
 11624
 11625     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11626        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11627        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11628                                 > PL-LM-AMT (SUB2))
 11629        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11630           AND (PB-I-SIG-SW = 'Y')
 11631           CONTINUE
 11632        ELSE
 11633           MOVE ER-2638          TO WS-ERROR
 11634           PERFORM 9900-ERROR-FORMAT
 11635                                 THRU 9900-EXIT
 11636        END-IF
 11637     END-IF
 11638
 11639     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11640         IF  WS-ERROR    EQUAL    ER-2638
 11641             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11642                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11643                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11644                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11645                MOVE  ER-1910    TO  WS-ERROR
 11646                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11647
 11648     IF PB-COMPANY-ID = 'CRI'
 11649        IF WS-ERROR = ER-2638
 11650            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11651            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11652            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11653
 11654     GO TO 3000-CONTINUE-EDIT.
 11655
 11656 0597-CHECK-NCL-AH-LIMITS.
 11657
 11658     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11659        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11660        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11661                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11662         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11663
 11664     IF APP-CERT-USED
 11665         IF SUB2  LESS THAN  +5
 11666             MOVE +5             TO SUB2
 11667             GO TO 0597-CHECK-AH-LIMITS.
 11668
 11669     MOVE ER-2638                TO WS-ERROR.
 11670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11671
 11672     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11673
 11674 0599-CHECK-NCL-SIG-SWITCH.
 11675
 11676     IF NOT APP-CERT-USED
 11677         GO TO 3000-CONTINUE-EDIT.
 11678
 11679     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11680        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11681        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 212
* EL050.cbl
 11682        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11683         GO TO 3000-CONTINUE-EDIT.
 11684
 11685     IF SUB2 GREATER THAN +4
 11686         IF PL-LM-AGE (5) = ZEROS  AND
 11687            PL-LM-AGE (6) = ZEROS  AND
 11688            PL-LM-AGE (7) = ZEROS  AND
 11689            PL-LM-AGE (8) = ZEROS
 11690             MOVE  ER-1927        TO WS-ERROR
 11691             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11692             GO TO 3000-CONTINUE-EDIT
 11693         ELSE
 11694             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11695                 MOVE  ER-1920    TO WS-ERROR
 11696                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11697
 11698     IF PB-I-SIG-SW  = 'Y'
 11699       IF NOT PB-I-POLICY-ACCEPTED  AND
 11700          NOT PB-I-POLICY-DECLINED
 11701           MOVE 'U'               TO PB-BATCH-ENTRY
 11702           MOVE  ER-1926          TO WS-ERROR
 11703           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11704
 11705******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 213
* EL050.cbl
 11707
 11708 3000-CONTINUE-EDIT.
 11709
 11710     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11711     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11712     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11713     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11714     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11715
 11716     IF BROWSE-STARTED
 11717        PERFORM 9990-RETURN THRU 9990-EXIT
 11718        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11719
 11720     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11721        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11722        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11723        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11724*       MOVE 1                   TO DC-OPTION-CODE
 11725        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11726        IF DATE-CONVERSION-ERROR
 11727           MOVE ER-2622          TO WS-ERROR
 11728           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729        ELSE
 11730           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11731              MOVE ER-2623       TO WS-ERROR
 11732              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11733           ELSE
 11734              MOVE ER-2622       TO WS-ERROR
 11735              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11736
 11737     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11738     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11739     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11740*    MOVE 1                      TO DC-OPTION-CODE.
 11741     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11742     IF DATE-CONVERSION-ERROR
 11743        GO TO 3005-EDIT-CONTINUE
 11744     ELSE
 11745        IF DC-ELAPSED-DAYS GREATER +180
 11746           MOVE ER-2613          TO WS-ERROR
 11747           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11748        ELSE
 11749           IF DC-ELAPSED-DAYS GREATER +90
 11750              MOVE ER-2612       TO WS-ERROR
 11751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752           ELSE
 11753             IF DC-ELAPSED-DAYS GREATER +60
 11754                MOVE ER-2614     TO WS-ERROR
 11755                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11756
 11757 3005-EDIT-CONTINUE.
 11758
 11759     IF PB-CANCELLATION
 11760         GO TO 3700-EDIT-CANCEL.
 11761
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 214
* EL050.cbl
 11763******************************************************************
 11764*                  E D I T   I S S U E                           *
 11765******************************************************************
 11766
 11767 3020-EDIT-ISSUE.
 11768
 11769      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11770      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11771      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11772      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11773      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11774
 11775     IF PB-ISSUE-FORCE
 11776        OR PB-ISSUE-DATE-FORCED
 11777        OR PB-FORCE-OFF
 11778        OR PB-OVERCHARGE-FORCE
 11779        or pb-exceeded-limit-forced
 11780        CONTINUE
 11781     ELSE
 11782        MOVE ER-2670             TO WS-ERROR
 11783        PERFORM 9900-ERROR-FORMAT
 11784                                 THRU 9900-EXIT
 11785     END-IF
 11786     .
 11787 3022-SET-POLICY-STATUS.
 11788
 11789     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11790
 11791     IF (PB-REISSUED-CERT)
 11792             OR
 11793        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11794         AND (PB-MONTHLY-CERT))
 11795         MOVE '5'                TO PB-I-ENTRY-STATUS
 11796         MOVE 'E'                TO PB-BATCH-ENTRY
 11797     END-IF
 11798
 11799     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11800        IF PB-MONTHLY-CERT
 11801           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11802        END-IF
 11803        IF PB-CASH-CERT
 11804           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11805        END-IF
 11806     END-IF
 11807     IF PB-POLICY-IS-DECLINED
 11808         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11809     IF PB-POLICY-IS-VOIDED
 11810         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11811     IF PB-NEEDS-UNDERWRITING
 11812         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11813     IF PB-REIN-ONLY-CERT
 11814         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11815     IF PB-PREM-ACCTNG-ONLY
 11816         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11817
 11818     MOVE SPACE                  TO PB-I-OB-FLAG.
 11819
 11820     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 215
* EL050.cbl
 11821         MOVE ER-2665            TO WS-ERROR
 11822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11823         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11824
 11825     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11826        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11827           MOVE 'Z'             TO PB-I-OB-FLAG.
 11828
 11829     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11830        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11831           MOVE 'Z'             TO PB-I-OB-FLAG.
 11832
 11833     IF ACCOUNT-MAST-FOUND
 11834         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11835         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11836         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11837         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11838         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11839         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11840         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11841     END-IF
 11842
 11843     IF ACCOUNT-MAST-FOUND
 11844        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11845         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11846
 11847     IF (ACCOUNT-MAST-FOUND)
 11848*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11849        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11850        IF PB-REISSUED-CERT
 11851           CONTINUE
 11852        ELSE
 11853           MOVE ER-2608          TO WS-ERROR
 11854           PERFORM 9900-ERROR-FORMAT
 11855                                 THRU 9900-EXIT
 11856         END-IF
 11857     END-IF
 11858
 11859     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11860        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11861        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11862
 11863**********   DMD CUSTOM CODE FOLLOWS  **********
 11864 3024-EDIT-DMD-FIELDS.
 11865     IF PB-COMPANY-ID NOT = 'DMD'
 11866        GO TO 3025-EDIT-REINSURANCE.
 11867
 11868*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11869*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11870*** ERROR IF THEY ARE NOT EQUAL.
 11871
 11872     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11873     SET BIN-TO-GREG               TO TRUE.
 11874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11875     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11876**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11877
 11878     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 216
* EL050.cbl
 11879     SET BIN-TO-GREG               TO TRUE.
 11880     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11881     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11882**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11883
 11884     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11885        MOVE ER-8116               TO WS-ERROR
 11886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11887
 11888     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11889
 11890     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11891                                      WK-FULL-CERT-NO.
 11892     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11893
 11894     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11895
 11896     IF PB-VALID-LIFE
 11897        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11898     ELSE
 11899        IF PB-VALID-AH
 11900          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11901
 11902
 11903     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11904     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11905     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11906                                      DCUA-UNDRWRTR-CODE
 11907                                      DCUA-UNDRWRTR-GROUP-CODE
 11908                                      DCUA-RETURN-CODE.
 11909
 11910****************************************************************
 11911*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11912***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11913***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11914***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11915***   TO THIS RECORD.                                        ***
 11916****************************************************************
 11917     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11918     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11919     IF DCUA-SUCCESSFUL-PROCESS
 11920        GO TO 3024-EDIT-DL7-CONT.
 11921
 11922     IF DCUA-RETURN-CODE EQUAL '01'
 11923        MOVE ER-8110               TO WS-ERROR
 11924        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11926        GO TO 3024-EDIT-DL7-CONT.
 11927
 11928     IF DCUA-RETURN-CODE EQUAL '02'
 11929        MOVE ER-8111               TO WS-ERROR
 11930        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11932        GO TO 3024-EDIT-DL7-CONT.
 11933
 11934     IF DCUA-RETURN-CODE EQUAL '03'
 11935        MOVE ER-8074               TO WS-ERROR
 11936        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 217
* EL050.cbl
 11937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938        GO TO 3024-EDIT-DL7-CONT.
 11939
 11940     IF DCUA-RETURN-CODE EQUAL '04'
 11941        MOVE ER-8075               TO WS-ERROR
 11942        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11944        GO TO 3024-EDIT-DL7-CONT.
 11945
 11946     IF DCUA-RETURN-CODE EQUAL '05'
 11947        MOVE ER-8076               TO WS-ERROR
 11948        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11950        GO TO 3024-EDIT-DL7-CONT.
 11951
 11952     IF DCUA-RETURN-CODE EQUAL '06'
 11953        MOVE ER-8077               TO WS-ERROR
 11954        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11956        GO TO 3024-EDIT-DL7-CONT.
 11957
 11958     IF DCUA-RETURN-CODE EQUAL '07'
 11959        MOVE ER-8078               TO WS-ERROR
 11960        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11962        GO TO 3024-EDIT-DL7-CONT.
 11963
 11964     IF DCUA-RETURN-CODE EQUAL 'E1'
 11965        MOVE ER-8079               TO WS-ERROR
 11966        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11968        GO TO 3024-EDIT-DL7-CONT.
 11969
 11970     IF DCUA-RETURN-CODE EQUAL 'E2'
 11971        MOVE ER-8080               TO WS-ERROR
 11972        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11974        GO TO 3024-EDIT-DL7-CONT.
 11975
 11976     IF DCUA-RETURN-CODE EQUAL 'E3'
 11977        MOVE ER-8098               TO WS-ERROR
 11978        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11980        GO TO 3024-EDIT-DL7-CONT.
 11981
 11982     IF DCUA-RETURN-CODE EQUAL 'C1'
 11983        MOVE ER-8099               TO WS-ERROR
 11984        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986        GO TO 3024-EDIT-DL7-CONT.
 11987
 11988     IF DCUA-RETURN-CODE EQUAL 'U1'
 11989        MOVE ER-8109               TO WS-ERROR
 11990        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11992        GO TO 3024-EDIT-DL7-CONT.
 11993
 11994     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 218
* EL050.cbl
 11995        MOVE ER-8112               TO WS-ERROR
 11996        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11998        GO TO 3024-EDIT-DL7-CONT.
 11999
 12000     IF DCUA-RETURN-CODE EQUAL 'N2'
 12001        MOVE ER-8113               TO WS-ERROR
 12002        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12004        GO TO 3024-EDIT-DL7-CONT.
 12005
 12006     IF DCUA-RETURN-CODE EQUAL 'N3'
 12007        MOVE ER-8114               TO WS-ERROR
 12008        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12010        GO TO 3024-EDIT-DL7-CONT.
 12011
 12012     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12013     MOVE ER-8097                  TO WS-ERROR.
 12014     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12015     GO TO 3024-EDIT-DL7-CONT.
 12016
 12017 3024-EDIT-DL7-CONT.
 12018
 12019     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12020     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12021     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12022        NEXT SENTENCE
 12023     ELSE
 12024        MOVE ER-9263               TO WS-ERROR
 12025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12026
 12027******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12028******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12029     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12030        NEXT SENTENCE
 12031     ELSE
 12032        MOVE ER-8039               TO WS-ERROR
 12033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12034
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 219
* EL050.cbl
 12036****************************************************************
 12037*** VALIDATE STATE  : DLO022                                 ***
 12038****************************************************************
 12039     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12040     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12041
 12042     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12043     IF DVSC-SUCCESSFUL-EDIT
 12044        GO TO 3024-EDIT-DL22-CONT.
 12045
 12046     IF DVSC-RETURN-CODE EQUAL '01'
 12047        MOVE ER-8300               TO WS-ERROR
 12048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12049        GO TO 3024-EDIT-DL22-CONT.
 12050
 12051     IF DVSC-RETURN-CODE EQUAL '02'
 12052        MOVE ER-8301               TO WS-ERROR
 12053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12054        GO TO 3024-EDIT-DL22-CONT.
 12055
 12056     IF DVSC-RETURN-CODE EQUAL '03'
 12057        MOVE ER-8302               TO WS-ERROR
 12058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12059        GO TO 3024-EDIT-DL22-CONT.
 12060
 12061     IF DVSC-RETURN-CODE EQUAL 'N1'
 12062        MOVE ER-8304               TO WS-ERROR
 12063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12064        GO TO 3024-EDIT-DL22-CONT.
 12065
 12066     MOVE ER-8303                  TO WS-ERROR
 12067     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12068
 12069 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 220
* EL050.cbl
 12071****************************************************************
 12072*** VALIDATE LOAN OFFICER : DLO021                           ***
 12073****************************************************************
 12074
 12075     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12076     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12077     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12078     IF DVLO-SUCCESSFUL-EDIT
 12079        GO TO 3024-EDIT-DL21-CONT.
 12080
 12081     IF DVLO-RETURN-CODE EQUAL '01'
 12082        MOVE ER-8081               TO WS-ERROR
 12083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12084        GO TO 3024-EDIT-DL21-CONT.
 12085
 12086     IF DVLO-RETURN-CODE EQUAL '02'
 12087        MOVE ER-8082               TO WS-ERROR
 12088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089        GO TO 3024-EDIT-DL21-CONT.
 12090
 12091     IF DVLO-RETURN-CODE EQUAL '03'
 12092        MOVE ER-8083               TO WS-ERROR
 12093        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12094        GO TO 3024-EDIT-DL21-CONT.
 12095
 12096     IF DVLO-RETURN-CODE EQUAL '04'
 12097        MOVE ER-8084               TO WS-ERROR
 12098        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12099        GO TO 3024-EDIT-DL21-CONT.
 12100
 12101     IF DVLO-RETURN-CODE EQUAL '05'
 12102        MOVE ER-8085               TO WS-ERROR
 12103        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12104        GO TO 3024-EDIT-DL21-CONT.
 12105
 12106     MOVE ER-7825                  TO WS-ERROR
 12107     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12108     GO TO 3024-EDIT-DL21-CONT.
 12109
 12110 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 221
* EL050.cbl
 12112
 12113****************************************************************
 12114*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12115****************************************************************
 12116
 12117     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12118     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12119     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12120     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12121     IF DIPF-SUCCESSFUL-EDIT
 12122        GO TO 3024-EDIT-DL02-CONT.
 12123
 12124     IF DIPF-RETURN-CODE EQUAL '01'
 12125        MOVE ER-8086               TO WS-ERROR
 12126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12127        GO TO 3024-EDIT-DL02-CONT.
 12128
 12129     IF DIPF-RETURN-CODE EQUAL '02'
 12130        MOVE ER-8087               TO WS-ERROR
 12131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12132        GO TO 3024-EDIT-DL02-CONT.
 12133
 12134     IF DIPF-RETURN-CODE EQUAL '03'
 12135        MOVE ER-8088               TO WS-ERROR
 12136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12137        GO TO 3024-EDIT-DL02-CONT.
 12138
 12139     MOVE ER-8095                  TO WS-ERROR
 12140     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12141     GO TO 3024-EDIT-DL02-CONT.
 12142
 12143 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 222
* EL050.cbl
 12145
 12146****************************************************************
 12147*** VALIDATE BANK ID : DLO003                                ***
 12148****************************************************************
 12149
 12150     MOVE WK-GREG-CENT           TO WCG-CENT.
 12151     MOVE WK-GREG-YYMM           TO WCG-REST.
 12152     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12153        MOVE ER-8040               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12155
 12156     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12157     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12158     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12159     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12160     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12161     IF DVBI-SUCCESSFUL-EDIT
 12162        GO TO 3024-EDIT-DL03-CONT.
 12163
 12164     IF DVBI-RETURN-CODE EQUAL '01'
 12165        MOVE ER-8089               TO WS-ERROR
 12166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12167        GO TO 3024-EDIT-DL03-CONT.
 12168
 12169     IF DVBI-RETURN-CODE EQUAL '02'
 12170        MOVE ER-8090               TO WS-ERROR
 12171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12172        GO TO 3024-EDIT-DL03-CONT.
 12173
 12174     IF DVBI-RETURN-CODE EQUAL '03'
 12175        MOVE ER-8091               TO WS-ERROR
 12176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12177        GO TO 3024-EDIT-DL03-CONT.
 12178
 12179     IF DVBI-RETURN-CODE EQUAL '04'
 12180        MOVE ER-8092               TO WS-ERROR
 12181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12182        GO TO 3024-EDIT-DL03-CONT.
 12183
 12184     IF DVBI-RETURN-CODE EQUAL '05'
 12185        MOVE ER-8093               TO WS-ERROR
 12186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12187        GO TO 3024-EDIT-DL03-CONT.
 12188
 12189     IF DVBI-RETURN-CODE EQUAL '06'
 12190        MOVE ER-8094               TO WS-ERROR
 12191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12192        GO TO 3024-EDIT-DL03-CONT.
 12193
 12194     MOVE ER-8096                  TO WS-ERROR
 12195     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12196     GO TO 3024-EDIT-DL03-CONT.
 12197
 12198 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 223
* EL050.cbl
 12200
 12201     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12202        NEXT SENTENCE
 12203     ELSE
 12204        MOVE ER-8042               TO WS-ERROR
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12206
 12207     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12208     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12209     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12210
 12211     IF DMPF-RETURN-CODE = '01'
 12212        MOVE ER-8067               TO WS-ERROR
 12213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12214        GO TO 3024-EDIT-DL01-CONT.
 12215
 12216     IF DMPF-RETURN-CODE = '02'
 12217        MOVE ER-8068               TO WS-ERROR
 12218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12219        GO TO 3024-EDIT-DL01-CONT.
 12220
 12221     IF DMPF-RETURN-CODE = '03'
 12222        MOVE ER-8069               TO WS-ERROR
 12223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12224        GO TO 3024-EDIT-DL01-CONT.
 12225
 12226     IF DMPF-RETURN-CODE = 'E1'
 12227        MOVE ER-8070               TO WS-ERROR
 12228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12229        GO TO 3024-EDIT-DL01-CONT.
 12230
 12231     IF DMPF-RETURN-CODE = 'N1'
 12232        MOVE ER-8071               TO WS-ERROR
 12233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12234        GO TO 3024-EDIT-DL01-CONT.
 12235
 12236     IF DMPF-RETURN-CODE NOT = 'OK'
 12237        MOVE ER-8072               TO WS-ERROR
 12238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12239
 12240 3024-EDIT-DL01-CONT.
 12241******************************************************************
 12242***  VALIDATES RATE CODES : DLO017                             ***
 12243******************************************************************
 12244
 12245      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12246      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12247      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12248      IF DVRC-SUCCESSFUL-EDIT
 12249        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12250        GO TO 3024-CHECK-VALID-RATE.
 12251
 12252      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12253
 12254      IF DVRC-RETURN-CODE EQUAL '01'
 12255         MOVE ER-7817                   TO WS-ERROR
 12256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12257         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 224
* EL050.cbl
 12258
 12259      IF DVRC-RETURN-CODE EQUAL '02'
 12260         MOVE ER-7818                   TO WS-ERROR
 12261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262         GO TO 3025-EDIT-REINSURANCE.
 12263
 12264      IF DVRC-RETURN-CODE EQUAL '03'
 12265         MOVE ER-7819                   TO WS-ERROR
 12266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12267         GO TO 3025-EDIT-REINSURANCE.
 12268
 12269       MOVE ER-7820                     TO WS-ERROR.
 12270       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12271       GO TO 3025-EDIT-REINSURANCE.
 12272
 12273******************************************************************
 12274***  GET PREMIUM RATES : DLO011                                ***
 12275******************************************************************
 12276
 12277 3024-CHECK-VALID-RATE.
 12278
 12279     IF VALID-RATE-CODE
 12280        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12281        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12282        MOVE SPACES                TO DPRB-RETURN-CODE
 12283        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12284     ELSE
 12285         GO TO 3025-EDIT-REINSURANCE.
 12286
 12287      IF DPRB-SUCCESSFUL-PROCESS
 12288         IF PB-VALID-LIFE
 12289             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12290             GO TO 3025-EDIT-REINSURANCE
 12291         ELSE
 12292             IF PB-VALID-AH
 12293                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12294                 GO TO 3025-EDIT-REINSURANCE.
 12295
 12296      IF DPRB-RETURN-CODE EQUAL '01'
 12297         MOVE ER-7812                   TO WS-ERROR
 12298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12299         GO TO 3025-EDIT-REINSURANCE.
 12300
 12301      IF DPRB-RETURN-CODE EQUAL '02'
 12302         MOVE ER-7813                   TO WS-ERROR
 12303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12304         GO TO 3025-EDIT-REINSURANCE.
 12305
 12306      IF DPRB-RETURN-CODE EQUAL '03'
 12307         MOVE ER-7814                   TO WS-ERROR
 12308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12309         GO TO 3025-EDIT-REINSURANCE.
 12310
 12311      IF DPRB-RETURN-CODE EQUAL '04'
 12312         IF NOT DPRB-1ST-TIME
 12313            MOVE ER-7815                   TO WS-ERROR
 12314            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12315            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 225
* EL050.cbl
 12316          ELSE
 12317         IF PB-VALID-LIFE
 12318            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12319          ELSE
 12320            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12321         END-IF
 12322         MOVE SPACES                TO DOCC-RETURN-CODE
 12323         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12324         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12325         IF DOCC-RETURN-CODE = 'OK'
 12326             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12327             GO TO 3024-CHECK-VALID-RATE
 12328           ELSE
 12329             MOVE ER-7823               TO WS-ERROR
 12330             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12331             GO TO 3025-EDIT-REINSURANCE.
 12332
 12333       MOVE ER-7816                     TO WS-ERROR.
 12334       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12335       GO TO 3025-EDIT-REINSURANCE.
 12336
 12337**********   DMD CUSTOM CODE ABOVE    **********
 12338
 12339 3025-EDIT-REINSURANCE.
 12340     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12341         GO TO 3027-EDIT-CONTINUE.
 12342
 12343     MOVE LOW-VALUES               TO ERREIN-KEY.
 12344     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12345     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12346                                      REIN-CODE-2
 12347                                      REIN-CODE-3.
 12348     MOVE 'A'                      TO REIN-TYPE.
 12349
 12350     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12351
 12352     MOVE '3026' TO REIN-SW.
 12353     MOVE ' '                   TO WS-REIN-READ-SW.
 12354
 12355     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12356     IF REIN-TABLE-NOT-FOUND
 12357         GO TO 3026-NO-SPEC-TABLE.
 12358
 12359     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12360     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12361                                   WS-NSP-ST-CD-LF.
 12362     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12363                                   WS-NSP-ST-CD-AH.
 12364
 12365     GO TO 3040-EDIT-CONTINUE.
 12366
 12367 3026-NO-SPEC-TABLE.
 12368
 12369     MOVE ER-2664                TO WS-ERROR.
 12370     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12371     GO TO 3040-EDIT-CONTINUE.
 12372
 12373 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 226
* EL050.cbl
 12374
 12375     IF PB-I-REIN-TABLE = SPACES
 12376       GO TO 3040-EDIT-CONTINUE.
 12377
 12378     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12379          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12380          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12381           GO TO 3040-EDIT-CONTINUE.
 12382
 12383     MOVE LOW-VALUES            TO ERREIN-KEY.
 12384     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12385     MOVE 'A'                   TO REIN-TYPE.
 12386     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12387
 12388     MOVE '3028'                TO REIN-SW.
 12389     MOVE ' '                   TO WS-REIN-READ-SW.
 12390
 12391     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12392     IF REIN-TABLE-NOT-FOUND
 12393         GO TO 3028-NO-REIN-TABLE.
 12394
 12395     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12396     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12397                                   WS-NSP-ST-CD-LF.
 12398     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12399                                   WS-NSP-ST-CD-AH.
 12400
 12401     GO TO 3040-EDIT-CONTINUE.
 12402
 12403 3028-NO-REIN-TABLE.
 12404
 12405     MOVE ER-2615                TO WS-ERROR.
 12406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12407     GO TO 3040-EDIT-CONTINUE.
 12408
 12409 3040-EDIT-CONTINUE.
 12410
 12411     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12412         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12413
 12414     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12415         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12416
 12417     IF (NOT PB-REISSUED-CERT)
 12418        AND (NOT PB-MONTHLY-CERT)
 12419        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12420            MOVE '001'           TO PB-I-LF-TERM
 12421            MOVE 'M'             TO PB-I-INSURED-SEX.
 12422
 12423     IF (NOT PB-REISSUED-CERT)
 12424        AND (NOT PB-MONTHLY-CERT)
 12425        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12426            MOVE '001'           TO PB-I-AH-TERM
 12427            MOVE 'M'             TO PB-I-INSURED-SEX.
 12428
 12429 3040-EDIT-1ST-PMT-DT.
 12430     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12431     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 227
* EL050.cbl
 12432         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12433
 12434******************************************************************
 12435*                                                                *
 12436*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12437*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12438*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12439*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12440*                                                                *
 12441******************************************************************
 12442
 12443     IF PB-EFF-DT-PROCESSING
 12444        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12445                                    PB-I-LF-EXPIRE-DT
 12446                                    PB-I-AH-EXPIRE-DT
 12447        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12448        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12449        MOVE ZERO                TO DC-ELAPSED-DAYS
 12450        MOVE +1                  TO DC-ELAPSED-MONTHS
 12451        SET BIN-PLUS-ELAPSED     TO TRUE
 12452*       MOVE 6                   TO DC-OPTION-CODE
 12453        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12454        IF NO-CONVERSION-ERROR
 12455           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12456
 12457******************************************************************
 12458*                                                                *
 12459*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12460*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12461*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12462*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12463*                                                                *
 12464******************************************************************
 12465
 12466     IF PB-EXT-DAYS-PROCESSING
 12467          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12468                                         PB-I-LF-EXPIRE-DT
 12469                                         PB-I-AH-EXPIRE-DT
 12470          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12471          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12472          MOVE +1                     TO DC-ELAPSED-MONTHS
 12473          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12474          SET BIN-PLUS-ELAPSED        TO TRUE
 12475*         MOVE 6                      TO DC-OPTION-CODE
 12476          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12477          IF NO-CONVERSION-ERROR
 12478             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12479
 12480******************************************************************
 12481*                                                                *
 12482*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12483*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12484*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12485*        (EXPIRE DATE - (TERM -1))  *  -1.
 12486*                                                                *
 12487******************************************************************
 12488
 12489     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 228
* EL050.cbl
 12490        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12491           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12492              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12493              MOVE PB-I-AH-TERM      TO WS-TERM
 12494           ELSE
 12495              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12496              MOVE PB-I-LF-TERM      TO WS-TERM
 12497        ELSE
 12498           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12499              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12500              MOVE PB-I-LF-TERM      TO WS-TERM
 12501           ELSE
 12502              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12503              MOVE PB-I-AH-TERM      TO WS-TERM.
 12504
 12505     IF PB-EXPIRE-DT-PROCESSING
 12506        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12507        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12508        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12509        MOVE ZERO                TO DC-ELAPSED-DAYS
 12510                                    DC-ODD-DAYS-OVER
 12511          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12512          SET BIN-PLUS-ELAPSED    TO TRUE
 12513*         MOVE 6                  TO DC-OPTION-CODE
 12514          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12515          IF NO-CONVERSION-ERROR
 12516             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12517
 12518******************************************************************
 12519*                                                                *
 12520*            1ST PAYMENT DATE PROCESSING                         *
 12521*                                                                *
 12522******************************************************************
 12523
 12524     IF PB-1ST-PMT-DT-PROCESSING
 12525        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12526                                    PB-I-AH-EXPIRE-DT
 12527        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12528
 12529     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12530         NEXT SENTENCE
 12531     ELSE
 12532         MOVE ER-2680                 TO WS-ERROR
 12533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12534         GO TO 3060-ORIG-TERM-CHECK.
 12535
 12536     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12537     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12538     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12539*    MOVE 1                      TO DC-OPTION-CODE.
 12540     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12541                                    DC-ELAPSED-DAYS
 12542                                    DC-ODD-DAYS-OVER.
 12543
 12544     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12545
 12546     IF DATE-CONVERSION-ERROR
 12547        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 229
* EL050.cbl
 12548
 12549     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12550     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12551        AND (WS-LF-COVERAGE-TYPE = 'L')
 12552        IF (DC-ELAPSED-MONTHS > 1)
 12553                      OR
 12554           ((DC-ELAPSED-MONTHS = 1)
 12555           AND (DC-ODD-DAYS-OVER > 0))
 12556           MOVE ER-2882          TO WS-ERROR
 12557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12558        END-IF
 12559     END-IF
 12560     if dc-elapsed-months > 0
 12561        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12562        + dc-odd-days-over
 12563     end-if
 12564     IF PB-EXT-DAYS-PROCESSING
 12565        CONTINUE
 12566     ELSE
 12567        IF DC-ELAPSED-MONTHS = +0
 12568           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12569        ELSE
 12570           IF (WS-LF-EARNINGS-CALC = '4')
 12571              AND (DC-ELAPSED-MONTHS > ZERO)
 12572              AND (DC-ELAPSED-DAYS > ZERO)
 12573              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12574           ELSE
 12575              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12576                                 THRU 6499-EXIT
 12577              MOVE WS-ODD-DAYS-OVER
 12578                                 TO PB-I-EXTENTION-DAYS
 12579           END-IF
 12580        END-IF
 12581     END-IF
 12582******************************************************************
 12583*                                                                *
 12584*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12585*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12586*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12587*            AND ANY ODD DAYS.                                   *
 12588*                                                                *
 12589******************************************************************
 12590
 12591     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12592                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12593     IF WS-LF-EARNINGS-CALC NOT = '4'
 12594        IF DC-ELAPSED-DAYS > ZEROS
 12595           MOVE ER-2681          TO WS-ERROR
 12596           PERFORM 9900-ERROR-FORMAT
 12597                                 THRU 9900-EXIT
 12598        END-IF
 12599     END-IF
 12600
 12601     IF WS-LF-EARNINGS-CALC NOT = '4'
 12602        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12603           MOVE ER-2681          TO WS-ERROR
 12604           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12605
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 230
* EL050.cbl
 12606     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12607        (PB-I-LF-TERM NOT = ZERO) AND
 12608         NOT NO-LIFE-COVERAGE
 12609          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12610          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12611          IF WS-LF-EARNINGS-CALC = '4'
 12612             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12613             PB-I-PAY-FREQUENCY
 12614          END-IF
 12615          MOVE ZERO              TO DC-ELAPSED-DAYS
 12616                                    DC-ODD-DAYS-OVER
 12617          MOVE 1                 TO DC-END-OF-MONTH
 12618          SET BIN-PLUS-ELAPSED        TO TRUE
 12619*         MOVE 6                 TO DC-OPTION-CODE
 12620          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12621          IF NO-CONVERSION-ERROR
 12622             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12623             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12624                (WS-LF-SPECIAL-CALC-CD = 'L')
 12625                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12626                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12627                  MOVE +1             TO DC-ELAPSED-MONTHS
 12628                  SET BIN-PLUS-ELAPSED  TO TRUE
 12629*                 MOVE 6              TO DC-OPTION-CODE
 12630                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12631                  IF NO-CONVERSION-ERROR
 12632                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12633
 12634* okay, i had to move the new att age edit down here because the
 12635* expiration date could get recalculated and i need the exp date
 12636     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12637        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12638        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12639        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12640           AND ZEROS
 12641           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12642           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12643           SET ELAPSED-BETWEEN-BIN TO TRUE
 12644           PERFORM 8500-DATE-CONVERT
 12645                                 THRU 8500-EXIT
 12646           IF NO-CONVERSION-ERROR
 12647              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12648                 MOVE ER-2669       TO WS-ERROR
 12649*                PERFORM 9900-ERROR-FORMAT
 12650*                                THRU 9900-EXIT
 12651              END-IF
 12652           END-IF
 12653        ELSE
 12654           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12655           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12656              MOVE ER-2669       TO WS-ERROR
 12657*             PERFORM 9900-ERROR-FORMAT
 12658*                                THRU 9900-EXIT
 12659           ELSE
 12660              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12661                 MOVE ER-1570    TO WS-ERROR
 12662                 PERFORM 9900-ERROR-FORMAT
 12663                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 231
* EL050.cbl
 12664              END-IF
 12665           END-IF
 12666        END-IF
 12667        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12668           AND ZEROS
 12669           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12670           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12671           SET ELAPSED-BETWEEN-BIN TO TRUE
 12672           PERFORM 8500-DATE-CONVERT
 12673                                 THRU 8500-EXIT
 12674           IF NO-CONVERSION-ERROR
 12675              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12676                 MOVE ER-2669       TO WS-ERROR
 12677*                PERFORM 9900-ERROR-FORMAT
 12678*                                THRU 9900-EXIT
 12679              END-IF
 12680           END-IF
 12681        ELSE
 12682           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12683             (PB-I-LF-TERM / 12)
 12684           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12685              MOVE ER-2669       TO WS-ERROR
 12686*             PERFORM 9900-ERROR-FORMAT
 12687*                                THRU 9900-EXIT
 12688           ELSE
 12689              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12690                 MOVE ER-1571    TO WS-ERROR
 12691                 PERFORM 9900-ERROR-FORMAT
 12692                                 THRU 9900-EXIT
 12693              END-IF
 12694           END-IF
 12695        END-IF
 12696        IF WS-ERROR = ER-2669
 12697           PERFORM 9900-ERROR-FORMAT
 12698                                 THRU 9900-EXIT
 12699        END-IF
 12700     END-IF
 12701     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12702        (PB-I-AH-TERM NOT = ZERO) AND
 12703         NOT NO-AH-COVERAGE
 12704          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12705             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12706             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12707             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12708          ELSE
 12709             IF WS-LF-EARNINGS-CALC = '4'
 12710                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12711                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12712                PB-I-PAY-FREQUENCY
 12713             ELSE
 12714                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12715                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12716             END-IF
 12717          END-IF
 12718          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12719                                         DC-ODD-DAYS-OVER
 12720          MOVE 1                      TO DC-END-OF-MONTH
 12721          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 232
* EL050.cbl
 12722*         MOVE 6                      TO DC-OPTION-CODE
 12723          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12724          IF NO-CONVERSION-ERROR
 12725             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12726     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12727        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12728        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12729        IF PB-I-BIRTHDAY > LOW-VALUES
 12730           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12731           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12732           SET ELAPSED-BETWEEN-BIN TO TRUE
 12733           PERFORM 8500-DATE-CONVERT
 12734                                 THRU 8500-EXIT
 12735           IF NO-CONVERSION-ERROR
 12736              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12737                 MOVE ER-3054       TO WS-ERROR
 12738*                PERFORM 9900-ERROR-FORMAT
 12739*                                THRU 9900-EXIT
 12740              END-IF
 12741           END-IF
 12742        ELSE
 12743           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12744           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12745              MOVE ER-3054       TO WS-ERROR
 12746*             PERFORM 9900-ERROR-FORMAT
 12747*                                THRU 9900-EXIT
 12748           END-IF
 12749        END-IF
 12750        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12751           AND ZEROS
 12752           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12753           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12754           SET ELAPSED-BETWEEN-BIN TO TRUE
 12755           PERFORM 8500-DATE-CONVERT
 12756                                 THRU 8500-EXIT
 12757           IF NO-CONVERSION-ERROR
 12758              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12759                 MOVE ER-3054       TO WS-ERROR
 12760*                PERFORM 9900-ERROR-FORMAT
 12761*                                THRU 9900-EXIT
 12762              END-IF
 12763           END-IF
 12764        ELSE
 12765           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12766             (PB-I-AH-TERM / 12)
 12767           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12768              MOVE ER-3054       TO WS-ERROR
 12769*             PERFORM 9900-ERROR-FORMAT
 12770*                                THRU 9900-EXIT
 12771           END-IF
 12772        END-IF
 12773        IF WS-ERROR = ER-3054
 12774           PERFORM 9900-ERROR-FORMAT
 12775                                 THRU 9900-EXIT
 12776        END-IF
 12777     END-IF
 12778     MOVE SPACE                       TO DC-END-OF-MONTH.
 12779
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 233
* EL050.cbl
 12780     IF PB-COMPANY-ID = 'NCB'
 12781        GO TO 3040-EDIT-EXTENSION-DAYS.
 12782
 12783     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12784       AND
 12785        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12786        NEXT SENTENCE
 12787     ELSE
 12788        GO TO 3040-EDIT-EXTENSION-DAYS.
 12789
 12790     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12791        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12792        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12793     ELSE
 12794        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12795        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12796
 12797     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12798*    MOVE '1'      TO DC-OPTION-CODE
 12799     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12800     IF (NO-CONVERSION-ERROR)
 12801        AND (DC-ELAPSED-MONTHS > +1)
 12802        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12803        MOVE ER-2668   TO WS-ERROR
 12804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12805
 12806 3040-EDIT-EXTENSION-DAYS.
 12807
 12808     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12809        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12810         GO TO 3050-EDIT-TERM-IN-DAYS
 12811     ELSE
 12812         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12813
 12814     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12815         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12816     ELSE
 12817        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12818           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12819           MOVE ER-2681         TO WS-ERROR
 12820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12821
 12822     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12823        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12824        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12825         GO TO 3060-ORIG-TERM-CHECK.
 12826
 12827     GO TO 3060-ORIG-TERM-CHECK.
 12828
 12829 3050-EDIT-TERM-IN-DAYS.
 12830
 12831     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12832
 12833     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12834         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12835     ELSE
 12836         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12837            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 234
* EL050.cbl
 12838            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12839
 12840     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12841                                       REMAINDER WS-WORK-TERM.
 12842     IF WS-WORK-TERM GREATER THAN ZERO
 12843         ADD +1 TO PB-I-LF-TERM.
 12844
 12845     IF NOT NO-AH-COVERAGE
 12846         MOVE ER-2684            TO WS-ERROR
 12847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12848
 12849
 12850 3060-ORIG-TERM-CHECK.
 12851
 12852******************************************************************
 12853*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12854******************************************************************
 12855
 12856     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12857        NEXT SENTENCE
 12858     ELSE
 12859        IF NOT NO-LIFE-COVERAGE
 12860           IF PB-I-LF-TERM NUMERIC
 12861              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12862              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12863              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12864                  NEXT SENTENCE
 12865           ELSE
 12866              MOVE ER-2647       TO WS-ERROR
 12867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12868
 12869     IF NOT NO-AH-COVERAGE
 12870         IF PB-I-AH-TERM NUMERIC
 12871            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12872            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12873            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12874             NEXT SENTENCE
 12875          ELSE
 12876              MOVE ER-2658       TO WS-ERROR
 12877              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12878
 12879     IF PB-COMPANY-ID = 'NCB'
 12880        GO TO 3070-LOAN-TERM-CHECK.
 12881
 12882     IF POLICY-HAS-AH
 12883       AND
 12884        POLICY-HAS-LIFE
 12885       AND
 12886        PB-I-LF-TERM NUMERIC
 12887       AND
 12888        PB-I-AH-TERM NUMERIC
 12889        NEXT SENTENCE
 12890     ELSE
 12891        GO TO 3070-LOAN-TERM-CHECK.
 12892
 12893     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12894     IF WS-TEX-FACT-2 LESS THAN +0
 12895        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 235
* EL050.cbl
 12896
 12897     IF WS-TEX-FACT-2 GREATER THAN +1
 12898        MOVE ER-2668             TO WS-ERROR
 12899        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12900
 12901 3070-LOAN-TERM-CHECK.
 12902
 12903     IF (WS-LF-BENEFIT-CD = ZERO)
 12904         OR (NO-LF-BENEFIT-MATCH)
 12905            GO TO 3125-EDIT-PMT-FREQ.
 12906*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12907*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12908*          AND 'V' AND 'W' AND 'X'
 12909*          GO TO 3125-EDIT-PMT-FREQ
 12910*       END-IF
 12911*    ELSE
 12912*       IF WS-AH-DCC-TRUNC = 'T'
 12913*          CONTINUE
 12914*       ELSE
 12915*          GO TO 3125-EDIT-PMT-FREQ
 12916*       END-IF
 12917*    END-IF
 12918     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12919                    OR
 12920        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12921        AND (WS-AH-DCC-TRUNC = 'T'))
 12922        CONTINUE
 12923     ELSE
 12924        GO TO 3125-EDIT-PMT-FREQ
 12925     END-IF
 12926     IF PB-I-LOAN-TERM NOT NUMERIC
 12927         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12928
 12929     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12930        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12931*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12932        PB-I-LOAN-TERM NOT GREATER THAN +360
 12933         NEXT SENTENCE
 12934     ELSE
 12935         MOVE ER-2648            TO WS-ERROR
 12936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12939        MOVE ER-3058             TO WS-ERROR
 12940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941     end-if
 12942
 12943     IF WS-STATE-ABBREVIATION = 'NC'
 12944        IF PB-I-LOAN-TERM > +59
 12945           CONTINUE
 12946        ELSE
 12947           MOVE ER-2792          TO WS-ERROR
 12948           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12949        END-IF
 12950     END-IF
 12951
 12952     .
 12953 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 236
* EL050.cbl
 12954     IF (WS-LF-BENEFIT-CD = ZERO)
 12955         OR (NO-LF-BENEFIT-MATCH)
 12956            GO TO 3127-EDIT-LOAN-OFFICER.
 12957     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12958                    OR
 12959        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12960        AND (WS-AH-DCC-TRUNC = 'T'))
 12961                    OR
 12962         (PB-COMPANY-ID = 'AHL')
 12963        CONTINUE
 12964     ELSE
 12965        IF (PB-I-LOAN-TERM > ZEROS)
 12966           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12967           MOVE ER-1575          TO WS-ERROR
 12968           PERFORM 9900-ERROR-FORMAT
 12969                                 THRU 9900-EXIT
 12970        END-IF
 12971     END-IF
 12972     IF WS-LF-EARNINGS-CALC NOT = '4'
 12973         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12974            MOVE ER-2653         TO WS-ERROR
 12975            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976            GO TO 3127-EDIT-LOAN-OFFICER
 12977         ELSE
 12978            GO TO 3127-EDIT-LOAN-OFFICER.
 12979
 12980     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12981         MOVE ER-2655            TO WS-ERROR
 12982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12983         GO TO 3127-EDIT-LOAN-OFFICER.
 12984
 12985     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12986         MOVE ER-2654            TO WS-ERROR
 12987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12988         GO TO 3127-EDIT-LOAN-OFFICER.
 12989
 12990     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12991         GIVING WS-TEX-FACT-2
 12992             REMAINDER WS-TEX-FACT-3.
 12993
 12994*    IF WS-TEX-FACT-3 NOT = ZERO
 12995*       MOVE ER-2654             TO WS-ERROR
 12996*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12997
 12998
 12999 3127-EDIT-LOAN-OFFICER.
 13000
 13001     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13002        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13003           MOVE ER-2690          TO WS-ERROR
 13004           PERFORM 9900-ERROR-FORMAT
 13005                                 THRU 9900-EXIT
 13006        ELSE
 13007           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13008           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13009           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13010           MOVE PB-SV-STATE      TO LOFC-STATE
 13011           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 237
* EL050.cbl
 13012           MOVE PB-I-LOAN-OFFICER
 13013                                 TO LOFC-CODE
 13014           PERFORM 8586-READ-LOAN-OFFICER
 13015                                 THRU 8586-EXIT
 13016           IF (NOT LOFC-MASTER-FOUND)
 13017              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13018              MOVE ER-3006       TO WS-ERROR
 13019              PERFORM 9900-ERROR-FORMAT
 13020                                 THRU 9900-EXIT
 13021           END-IF
 13022        END-IF
 13023     END-IF
 13024     .
 13025 3129-EDIT-APR.
 13026
 13027     IF (WS-LF-BENEFIT-CD = ZERO)
 13028        OR (NO-LF-BENEFIT-MATCH)
 13029        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13030           GO TO 3130-EDIT-AGE
 13031*       ELSE
 13032*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13033*             GO TO 3130-EDIT-AGE
 13034*          END-IF
 13035        END-IF
 13036     END-IF
 13037
 13038     IF (WS-STATE-ABBREVIATION = 'OH')
 13039         AND (PB-I-RATE-CLASS NOT = 'L ')
 13040         AND (PB-I-LF-TERM GREATER THAN 60)
 13041         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13042         GO TO 3129-APR-CONT.
 13043
 13044     IF (WS-STATE-ABBREVIATION = 'RI')
 13045         AND (PB-I-LF-TERM GREATER THAN 60)
 13046         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13047         GO TO 3129-APR-CONT.
 13048
 13049     IF (WS-STATE-ABBREVIATION = 'UT')
 13050         AND (PB-I-LF-TERM GREATER THAN 62)
 13051         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13052         AND (PB-CERT-EFF-DT LESS WS-830901)
 13053         GO TO 3129-APR-CONT.
 13054
 13055     IF PB-COMPANY-ID = 'LAP'
 13056        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13057           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13058              MOVE ER-2656         TO WS-ERROR
 13059              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13060              GO TO 3130-EDIT-AGE.
 13061
 13062     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13063        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13064        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13065        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13066        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13067        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13068         GO TO 3130-EDIT-AGE.
 13069
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 238
* EL050.cbl
 13070 3129-APR-CONT.
 13071     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13072         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13073         GO TO 3130-EDIT-AGE.
 13074
 13075     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13076         WS-AH-BENEFIT-CD (1:1) = 'S')
 13077        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13078        AND (PB-I-LOAN-APR = ZERO)
 13079        MOVE ER-2657             TO WS-ERROR
 13080        PERFORM 9900-ERROR-FORMAT
 13081                                 THRU 9900-EXIT
 13082        GO TO 3130-EDIT-AGE
 13083     END-IF
 13084*    IF PB-I-LOAN-APR = ZERO
 13085*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13086*    END-IF
 13087
 13088     if pb-i-loan-apr = +99.9999
 13089        move er-2656             to ws-error
 13090        PERFORM 9900-ERROR-FORMAT
 13091                                 THRU 9900-EXIT
 13092        GO TO 3130-EDIT-AGE
 13093     end-if
 13094*    IF PB-I-LOAN-APR = ZERO
 13095*       MOVE ER-2656             TO WS-ERROR
 13096*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13097*       GO TO 3130-EDIT-AGE.
 13098
 13099*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13100     if pb-i-loan-apr not = +99.9999
 13101        IF PB-I-LOAN-APR > +30.000
 13102           MOVE ER-2657          TO WS-ERROR
 13103           PERFORM 9900-ERROR-FORMAT
 13104                                 THRU 9900-EXIT
 13105        end-if
 13106     end-if
 13107     .
 13108 3130-EDIT-AGE.
 13109
 13110******************************************************************
 13111*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13112******************************************************************
 13113
 13114     IF NOT NO-LIFE-COVERAGE
 13115        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13116           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13117               MOVE ER-2628             TO WS-ERROR
 13118               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13119
 13120     IF NOT NO-AH-COVERAGE
 13121        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13122           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13123               MOVE ER-2628         TO WS-ERROR
 13124               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13125
 13126 3133-SEX-CODE.
 13127     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 239
* EL050.cbl
 13128         IF WS-DEFAULT-SEX = 'M'
 13129             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13130          ELSE
 13131             IF WS-DEFAULT-SEX = 'F'
 13132             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13133
 13134     IF PB-I-INSURED-SEX = '1'
 13135         MOVE 'M' TO PB-I-INSURED-SEX.
 13136
 13137     IF PB-I-INSURED-SEX = '2'
 13138         MOVE 'F' TO PB-I-INSURED-SEX.
 13139
 13140 3134-SIG-SW-EDIT.
 13141     IF PB-I-SIG-SW = SPACE
 13142         MOVE 'N'                TO  PB-I-SIG-SW.
 13143
 13144     IF PB-COMPANY-ID = 'NCL'
 13145         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13146             NEXT SENTENCE
 13147         ELSE
 13148             MOVE ER-1923        TO  WS-ERROR
 13149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13150     ELSE
 13151     IF PB-COMPANY-ID = 'CRI'
 13152         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13153             NEXT SENTENCE
 13154         ELSE
 13155             MOVE ER-2606        TO  WS-ERROR
 13156             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13157     ELSE
 13158     IF PB-COMPANY-ID = 'TMS'
 13159         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13160             NEXT SENTENCE
 13161         ELSE
 13162             MOVE ER-2689        TO  WS-ERROR
 13163             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13164     ELSE
 13165         IF PB-I-SIG-SW = 'Y' OR 'N'
 13166             NEXT SENTENCE
 13167         ELSE
 13168             MOVE ER-2651        TO  WS-ERROR
 13169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13170
 13171     IF PB-COMPANY-ID = 'FLA'
 13172         IF (WS-EDIT-AGE GREATER 54  OR
 13173             WS-AH-EDIT-AGE GREATER 54)  AND
 13174            PB-I-SIG-SW = 'N'
 13175            MOVE ER-2651         TO  WS-ERROR
 13176            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13177
 13178 3135-NAME-EDIT.
 13179
 13180     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13181        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13182        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13183           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13184                                 TO PB-I-JOINT-FIRST-NAME
 13185        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 240
* EL050.cbl
 13186     END-IF
 13187     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13188        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13189        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13190           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13191                                 TO PB-I-JOINT-LAST-NAME
 13192        END-PERFORM
 13193     END-IF
 13194     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13195        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13196        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13197           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13198                                 TO PB-I-INSURED-FIRST-NAME
 13199        END-PERFORM
 13200     END-IF
 13201     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13202        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13203        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13204           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13205                                 TO PB-I-INSURED-LAST-NAME
 13206        END-PERFORM
 13207     END-IF
 13208     IF PB-I-INSURED-LAST-NAME = SPACES
 13209       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13210       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13211           MOVE ER-2660    TO WS-ERROR
 13212           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13213
 13214 3136-EDIT-SEX.
 13215
 13216******************************************************************
 13217*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13218******************************************************************
 13219
 13220     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13221        (WS-AH-SPECIAL-CALC-CD = 'O')
 13222        NEXT SENTENCE
 13223     ELSE
 13224        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13225           NEXT SENTENCE
 13226        ELSE
 13227           MOVE ER-2629            TO WS-ERROR
 13228           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13229
 13230 3137-EDIT-EFF-DATE.
 13231
 13232     IF PB-REISSUED-CERT       OR
 13233        PB-POLICY-IS-DECLINED  OR
 13234        PB-POLICY-IS-VOIDED
 13235         GO TO 3139-EDIT-COVERAGE-CODES.
 13236
 13237     MOVE SPACE                  TO WS-2671-SW
 13238                                    WS-2672-SW.
 13239
 13240     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13241         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13242             MOVE ER-2703        TO WS-ERROR
 13243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 241
* EL050.cbl
 13244             GO TO 3139-EDIT-COVERAGE-CODES.
 13245
 13246     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13247         GO TO 3139-EDIT-COVERAGE-CODES.
 13248
 13249     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13250     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13251*    MOVE '1'                    TO DC-OPTION-CODE.
 13252     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13253     MOVE +0                     TO DC-ELAPSED-MONTHS
 13254                                    DC-ELAPSED-DAYS.
 13255     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13256
 13257     IF DATE-CONVERSION-ERROR
 13258         GO TO 3139-EDIT-COVERAGE-CODES.
 13259
 13260     IF DC-ELAPSED-DAYS GREATER +180
 13261         MOVE ER-2672            TO WS-ERROR
 13262         MOVE 'Y'                TO WS-2672-SW
 13263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13264     END-IF
 13265
 13266     IF WS-ERROR = ER-2671  AND
 13267        PB-COMPANY-ID  = 'LBL'
 13268        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13269        MOVE SPACE               TO WS-2671-SW
 13270        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13271
 13272     IF PB-ISSUE-DATE-FORCED  AND
 13273      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13274         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13275         MOVE ER-2673            TO WS-ERROR
 13276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13277         MOVE SPACE              TO WS-2671-SW
 13278                                    WS-2672-SW.
 13279
 13280     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13281         IF PB-ISSUE-DATE-FORCED
 13282             MOVE ER-2600          TO  WS-ERROR
 13283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13284         ELSE
 13285             MOVE ER-2692          TO  WS-ERROR
 13286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13287
 13288
 13289 3139-EDIT-COVERAGE-CODES.
 13290
 13291     if pb-company-id not = 'AHL'
 13292        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13293           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13294           MOVE ER-2787          TO WS-ERROR
 13295           PERFORM 9900-ERROR-FORMAT
 13296                                 THRU 9900-EXIT
 13297        END-IF
 13298     end-if
 13299     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13300        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13301                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 242
* EL050.cbl
 13302           MOVE ER-2719          TO WS-ERROR
 13303           PERFORM 9900-ERROR-FORMAT
 13304                                 THRU 9900-EXIT
 13305        END-IF
 13306     END-IF
 13307
 13308     IF PB-POLICY-IS-DECLINED  OR
 13309        PB-POLICY-IS-VOIDED
 13310         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13311
 13312     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13313        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13314         MOVE ER-2630                TO WS-ERROR
 13315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13316
 13317     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13318        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13319        PB-I-LF-PREMIUM-AMT = ZERO
 13320         GO TO 3140-CHECK-AH-FOR-ZERO.
 13321
 13322     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13323        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13324        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13325         GO TO 3140-CHECK-AH-FOR-ZERO.
 13326
 13327     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13328        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13329        MOVE ER-2631             TO WS-ERROR
 13330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331     END-IF
 13332
 13333
 13334******************************************************************
 13335*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13336******************************************************************
 13337
 13338     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13339        NEXT SENTENCE
 13340     ELSE
 13341        IF PB-I-LF-BENEFIT-AMT = ZERO
 13342           MOVE ER-2632             TO WS-ERROR
 13343           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13344
 13345
 13346******************************************************************
 13347*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13348******************************************************************
 13349
 13350     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13351        CONTINUE
 13352     ELSE
 13353        IF PB-I-LF-PREMIUM-AMT = ZERO
 13354           IF (NOT PB-COMP-LF-PREM)
 13355              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13356              and (ws-lf-ben-category not = 'C')
 13357              MOVE ER-2633       TO WS-ERROR
 13358              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13359           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 243
* EL050.cbl
 13360        END-IF
 13361     END-IF
 13362     .
 13363 3140-CHECK-AH-FOR-ZERO.
 13364
 13365     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13366        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13367        PB-I-AH-PREMIUM-AMT = ZERO
 13368         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13369
 13370     IF PB-COMPANY-ID = 'CSL'  AND
 13371        PB-I-AH-BENEFIT-CD = ZERO  AND
 13372        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13373        PB-I-AH-PREMIUM-AMT = ZERO
 13374         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13375
 13376     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13377        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13378        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13379         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13380
 13381     IF PB-I-AH-BENEFIT-CD = ZERO
 13382         MOVE ER-2634            TO WS-ERROR
 13383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13384
 13385******************************************************************
 13386*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13387******************************************************************
 13388
 13389     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13390        NEXT SENTENCE
 13391     ELSE
 13392        IF PB-I-AH-BENEFIT-AMT = ZERO
 13393           MOVE ER-2635             TO WS-ERROR
 13394           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13395
 13396******************************************************************
 13397*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13398******************************************************************
 13399
 13400     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13401        NEXT SENTENCE
 13402     ELSE
 13403        IF PB-I-AH-PREMIUM-AMT = ZERO
 13404            IF NOT PB-COMP-AH-PREM
 13405                MOVE ER-2636    TO WS-ERROR
 13406                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13407
 13408
 13409 3140-EDIT-MAX-AMT-SIZES.
 13410* CUSTOM CODE FOR CLIENT    'DMD'
 13411     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13412                                     WS-RES-MUNI-TAX
 13413                                     PB-I-STATE-TAX
 13414                                     PB-I-MUNI-TAX.
 13415
 13416     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13417
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 244
* EL050.cbl
 13418     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13419        GO TO 3150-RATE-OUTSTAND-BAL.
 13420
 13421     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13422        GO TO 3150-RATE-OUTSTAND-BAL.
 13423
 13424     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13425        GO TO 3150-RATE-OUTSTAND-BAL.
 13426
 13427     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13428                             OR 'RIC')
 13429        GO TO 3150-RATE-OUTSTAND-BAL.
 13430
 13431     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13432        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13433            GO TO 3150-RATE-OUTSTAND-BAL
 13434        ELSE
 13435           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13436               GO TO 3150-RATE-OUTSTAND-BAL.
 13437
 13438     IF NOT PB-NO-MONTHS-SKIPPED
 13439        GO TO 3150-RATE-OUTSTAND-BAL.
 13440
 13441     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13442        GO TO 3150-RATE-OUTSTAND-BAL.
 13443
 13444     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13445        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13446           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13447             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13448           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13449           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13450              MOVE ER-2693     TO WS-ERROR
 13451              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13452              GO TO 3150-RATE-OUTSTAND-BAL
 13453           ELSE
 13454              GO TO 3150-RATE-OUTSTAND-BAL.
 13455
 13456 3150-RATE-OUTSTAND-BAL.
 13457
 13458* DMD RATING TEST
 13459     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13460         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13461         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13462         MOVE ER-2687                 TO WS-ERROR
 13463         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13464         MOVE 'B'                     TO PB-I-OB-FLAG
 13465         GO TO 3260-EDIT-CONTINUE.
 13466
 13467     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13468         IF  WS-ERROR    EQUAL    ER-2693
 13469             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13470                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13471                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13472                 MOVE  +0            TO  WS-ERROR.
 13473
 13474     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13475         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 245
* EL050.cbl
 13476             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13477                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13478                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13479                 MOVE  +0            TO  WS-ERROR.
 13480
 13481     IF PLAN-MASTER-AH-SW = 'Y'
 13482        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13483            IF  WS-ERROR    EQUAL    ER-2693
 13484              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13485                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13486                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13487                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13488                 MOVE  ER-1910           TO  WS-ERROR
 13489                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13490
 13491     IF PLAN-MASTER-AH-SW = 'Y'
 13492        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13493            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13494               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13495               MOVE  ER-1910           TO  WS-ERROR
 13496               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13497
 13498     IF PLAN-MASTER-AH-SW = 'Y'
 13499        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13500            IF  WS-ERROR    EQUAL    ER-2693
 13501                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13502                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13503                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13504                 MOVE  +0       TO  WS-ERROR.
 13505
 13506     IF WS-ERROR = ER-2693
 13507        IF PB-COMPANY-ID = 'JAL' AND
 13508           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13509           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13510           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13511
 13512     IF WS-ERROR = ER-2693
 13513        IF PB-COMPANY-ID = 'NCL'  AND
 13514           PB-I-AH-BENEFIT-CD = 'OA'
 13515           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13516           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13517
 13518     IF WS-ERROR = ER-2693
 13519        IF PB-COMPANY-ID = 'CNL' AND
 13520           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13521           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13522           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13523
 13524     IF WS-ERROR = ER-2693
 13525        IF PB-COMPANY-ID = 'HER'
 13526           IF WS-LEVEL
 13527              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13528              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13529
 13530     IF ((LF-BENEFIT-FOUND) AND
 13531         (NOT NO-LIFE-COVERAGE)  AND
 13532         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13533       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 246
* EL050.cbl
 13534             (NOT NO-AH-COVERAGE)    AND
 13535             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13536         NEXT SENTENCE
 13537     ELSE
 13538         GO TO 3215-EDIT-RATES.
 13539
 13540     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13541        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13542           MOVE ER-2674          TO WS-ERROR
 13543           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13544           GO TO 3215-EDIT-RATES.
 13545
 13546     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13547        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13548           MOVE ER-2674          TO WS-ERROR
 13549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13550           GO TO 3215-EDIT-RATES.
 13551
 13552     MOVE 'B'                    TO PB-I-OB-FLAG.
 13553
 13554     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13555         NEXT SENTENCE
 13556     ELSE
 13557         IF NOT NO-LIFE-COVERAGE
 13558             IF WS-ACCT-LF-OB-RT = ZERO
 13559                MOVE ER-2641    TO WS-ERROR
 13560                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13561
 13562     IF PB-COMPANY-ID = 'CRI'
 13563       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13564         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13565         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13566         IF WS-ERROR = ER-2675
 13567            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13568            MOVE ER-2687              TO WS-ERROR
 13569            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13570         ELSE
 13571            MOVE ER-2687              TO WS-ERROR
 13572            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13573
 13574
 13575     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13576         NEXT SENTENCE
 13577     ELSE
 13578       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13579            NEXT SENTENCE
 13580       ELSE
 13581         IF NOT NO-AH-COVERAGE
 13582             IF WS-ACCT-AH-OB-RT = ZERO
 13583                MOVE ER-2642    TO WS-ERROR
 13584                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13585
 13586     IF PB-COMPANY-ID = 'CRI'
 13587       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13588         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13589         IF WS-ERROR = ER-2676
 13590            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13591            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 247
* EL050.cbl
 13592            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13593         ELSE
 13594            MOVE ER-2687              TO WS-ERROR
 13595            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13596
 13597     IF PB-COMPANY-ID NOT = 'GIC'
 13598         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13599            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13600     ELSE
 13601         IF PB-I-LF-PREM-CALC = ZEROS
 13602             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13603                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13604
 13605     IF PB-COMPANY-ID NOT = 'GIC'
 13606         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13607            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13608     ELSE
 13609         IF PB-I-AH-PREM-CALC = ZEROS
 13610             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13611                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13612
 13613     MOVE ZEROS TO PB-I-MORT-CODE.
 13614
 13615     GO TO 3260-EDIT-CONTINUE.
 13616
 13617
 13618 3215-EDIT-RATES.
 13619     IF ACCOUNT-MAST-FOUND
 13620         NEXT SENTENCE
 13621     ELSE
 13622         GO TO 3999-END-EDIT.
 13623
 13624 3220-CHECK-LF-RATES.
 13625
 13626     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13627        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13628        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13629        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13630           AND (NOT WS-LF-CASH))
 13631                           OR
 13632           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13633           AND (NOT WS-AH-CASH)))
 13634                       AND
 13635           (PB-I-ENTRY-STATUS NOT = '5')
 13636           MOVE 'M'              TO PB-BATCH-ENTRY
 13637                                    PB-I-ENTRY-STATUS
 13638        END-IF
 13639     END-IF
 13640     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13641                                    PB-I-AH-PREM-CALC
 13642                                    PB-I-LF-ALT-PREM-CALC
 13643                                    PB-I-LF-ALT-RATE
 13644                                    PB-I-LF-REI-RATE
 13645                                    PB-I-LF-ALT-REI-RATE
 13646                                    PB-I-AH-REI-RATE
 13647                                    PB-I-TOT-FEES-CALC.
 13648
 13649     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 248
* EL050.cbl
 13650        NEXT SENTENCE
 13651     ELSE
 13652        MOVE ZEROS               TO PB-I-LF-RATE
 13653                                    PB-I-AH-RATE.
 13654
 13655     IF PB-I-TOT-FEES NOT NUMERIC
 13656        MOVE ZEROS               TO PB-I-TOT-FEES
 13657     END-IF
 13658     IF PB-I-LIVES NOT NUMERIC
 13659         MOVE ZERO               TO PB-I-LIVES.
 13660
 13661     IF PB-I-NUM-BILLED NOT NUMERIC
 13662         MOVE ZERO               TO PB-I-NUM-BILLED.
 13663
 13664     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13665        MOVE +0                  TO PB-I-LF-PREM-TAX
 13666     END-IF
 13667
 13668     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13669        MOVE +0                  TO PB-I-AH-PREM-TAX
 13670     END-IF
 13671
 13672     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13673        PB-I-PAY-FREQUENCY = ZEROS
 13674            MOVE 12 TO CP-PAY-FREQUENCY
 13675     ELSE
 13676            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13677
 13678     IF PB-I-STATE-TAX NOT NUMERIC
 13679         MOVE ZEROS               TO PB-I-STATE-TAX.
 13680
 13681     IF PB-I-MUNI-TAX NOT NUMERIC
 13682         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13683
 13684     MOVE SPACES                 TO CP-BEN-CATEGORY
 13685     IF PB-COMPANY-ID  = 'CSL'  AND
 13686        PB-I-LF-TERM NOT = ZERO
 13687        COMPUTE WS-PAYMENT-AMT =
 13688             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13689        COMPUTE WS-CSL-AMT1 =
 13690             PB-I-LF-TERM * AM-MAX-MON-BEN
 13691        COMPUTE WS-CSL-AMT2 =
 13692             WS-PAYMENT-AMT * PB-I-LF-TERM
 13693        IF CP-PAY-FREQUENCY NOT = 12
 13694           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13695           MOVE '8' TO WS-CSL-CALC-CD
 13696        ELSE
 13697           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13698              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13699               AM-MAX-TOT-BEN
 13700               MOVE '6' TO WS-CSL-CALC-CD
 13701           ELSE
 13702              IF (WS-CSL-AMT1  GREATER THAN
 13703                 AM-MAX-TOT-BEN) AND
 13704                 (WS-CSL-AMT2  GREATER THAN
 13705                 AM-MAX-TOT-BEN)
 13706                 MOVE '7' TO WS-CSL-CALC-CD
 13707              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 249
* EL050.cbl
 13708                 MOVE '5' TO WS-CSL-CALC-CD.
 13709
 13710     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13711         NEXT SENTENCE
 13712     ELSE
 13713         GO TO 3300-CHECK-AH-RATES.
 13714
 13715*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13716
 13717     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13718        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13719              OR
 13720           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13721           MOVE ER-2618          TO WS-ERROR
 13722           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13723           GO TO 3300-CHECK-AH-RATES.
 13724
 13725     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13726           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13727                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13728
 13729     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13730         MOVE ER-2687             TO WS-ERROR
 13731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13732         MOVE 'Z000'              TO PB-I-MORT-CODE
 13733         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13734         GO TO 3300-CHECK-AH-RATES.
 13735
 13736     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13737        IF PB-I-LIVES = ZERO
 13738           MOVE ER-2688          TO WS-ERROR
 13739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13740
 13741     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13742
 13743     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13744     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13745     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13746     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13747     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13748     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13749     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13750     MOVE '3'                    TO CP-PROCESS-TYPE.
 13751     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13752     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13753
 13754******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13755     IF PB-COMPANY-ID EQUAL 'CDL'
 13756         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13757            CP-EARN-AS-NET-PAY)
 13758             IF PB-CERT-EFF-DT GREATER  WS-931231
 13759                 MOVE '1'        TO CP-EARNING-METHOD.
 13760*******
 13761
 13762     MOVE PB-SV-STATE            TO CP-STATE.
 13763     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13764     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13765     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 250
* EL050.cbl
 13766     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13767     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13768                                    CP-RATING-BENEFIT-AMT.
 13769     IF CP-STATE-STD-ABBRV = 'OR'
 13770         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13771                                         PB-I-LF-ALT-BENEFIT-AMT.
 13772     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13773     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13774     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13775     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13776     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13777     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13778     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13779     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13780     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13781                                    CP-REMAINING-TERM
 13782                                    CP-LOAN-TERM.
 13783
 13784     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13785         NEXT SENTENCE
 13786     ELSE
 13787         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13788             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13789                                           PB-I-LF-PREMIUM-AMT.
 13790
 13791     IF PB-COMPANY-ID EQUAL 'CSL'
 13792        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13793           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13794                                         PB-I-LF-PREMIUM-AMT.
 13795
 13796     IF PB-COMPANY-ID EQUAL 'NCB'
 13797         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13798            CP-EARN-AS-NET-PAY
 13799             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13800                 PB-I-LF-PREMIUM-AMT.
 13801
 13802     IF (CP-TRUNCATED-LIFE)
 13803        or ((pb-company-id = 'AHL')
 13804           and (pb-i-loan-term > pb-i-lf-term))
 13805        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13806
 13807     IF PB-COMPANY-ID EQUAL 'CRI'
 13808        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13809
 13810     IF CP-TERM-IS-DAYS
 13811         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13812     ELSE
 13813         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13814     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13815        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13816        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13817        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13818        IF WS-LF-BEN-CATEGORY = 'D'
 13819           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13820           MOVE PB-I-LIFE-COMMISSION
 13821                                 TO CP-DCC-ACT-COMM
 13822           MOVE WS-LF-BEN-CATEGORY
 13823                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 251
* EL050.cbl
 13824        END-IF
 13825        IF (CP-BENEFIT-CD (1:1) = 'P')
 13826           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13827           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13828           add pb-i-ah-premium-amt to cp-original-premium
 13829        END-IF
 13830     END-IF
 13831     IF PB-COMPANY-ID = 'CSL'
 13832         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13833         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13834         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13835
 13836     IF PB-COMPANY-ID = 'CSL'
 13837        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13838
 13839     IF (CP-SPECIAL-CALC-CD = 'H')
 13840        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13841         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13842                                    TO CP-ALTERNATE-BENEFIT
 13843         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13844     if (pb-company-id = 'CID')
 13845        and (ws-lf-earnings-calc = '4')
 13846        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13847        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13848        move pb-i-term-type      to cp-pmt-mode
 13849        move pb-i-no-of-payments to cp-no-of-pmts
 13850     end-if
 13851     move ws-net-only-state      to cp-net-only-state
 13852     IF (PB-COMPANY-ID = 'CID')
 13853        AND (WS-LF-EARNINGS-CALC = 'B')
 13854        AND (CP-STATE-STD-ABBRV = 'MN')
 13855        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13856                                 TO CP-ALTERNATE-BENEFIT
 13857        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13858     END-IF
 13859     IF (PB-COMPANY-ID = 'CID')
 13860        AND (WS-LF-EARNINGS-CALC = 'B')
 13861        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13862                                 TO CP-ALTERNATE-BENEFIT
 13863        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13864        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13865*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13866*         pb-i-lf-alt-premium-amt
 13867        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13868        IF WS-LF-BEN-CATEGORY = 'P'
 13869           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13870        ELSE
 13871           IF WS-LF-BEN-CATEGORY = 'I'
 13872              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13873           END-IF
 13874        END-IF
 13875     END-IF
 13876     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13877     MOVE 'R'                   TO CP-RATE-FILE.
 13878     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13879
 13880     IF CP-ERROR-RATE-NOT-FOUND
 13881        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 252
* EL050.cbl
 13882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13883        GO TO 3300-CHECK-AH-RATES.
 13884
 13885     IF PB-COMPANY-ID EQUAL 'CRI'
 13886        IF CP-ERROR-NO-LIMITS-CRI
 13887           IF NOT ACCOUNT-LIFE-CHECKED
 13888              MOVE ER-2607      TO WS-ERROR
 13889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13890
 13891******************************************************************
 13892*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13893*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13894******************************************************************
 13895
 13896* CALC LIFE AGE AT EXPIRATION.
 13897
 13898     COMPUTE WS-AGE-AT-EXPIRE =
 13899          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13900
 13901*    IF PB-STATE = 'CO' OR 'UT'
 13902*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13903*        MOVE 'F'            TO PB-FATAL-FLAG
 13904*        MOVE ER-2709        TO WS-ERROR
 13905*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13906*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13907
 13908*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13909*        MOVE 'X'            TO PB-FATAL-FLAG
 13910*        MOVE ER-2718        TO WS-ERROR
 13911*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13912*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13913
 13914* CALC A & H AGE AT EXPIRATION.
 13915
 13916     COMPUTE WS-AGE-AT-EXPIRE =
 13917          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13918
 13919*    IF PB-STATE = 'CO' OR 'UT'
 13920*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13921*        MOVE 'F'            TO PB-FATAL-FLAG
 13922*        MOVE ER-2709        TO WS-ERROR
 13923*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13924*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13925
 13926*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13927*        MOVE 'X'            TO PB-FATAL-FLAG
 13928*        MOVE ER-2718        TO WS-ERROR
 13929*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13931
 13932     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13933        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13934
 13935     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13936        and (not pb-monthly-cert)
 13937        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13938     end-if
 13939
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 253
* EL050.cbl
 13940     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13941        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13942
 13943     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13944         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13945         MOVE ER-2639        TO WS-ERROR
 13946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13947
 13948
 13949******************************************************************
 13950*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13951******************************************************************
 13952
 13953 PREMIUM-EDITING-IS-BYPASSED.
 13954     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13955        AND (CP-R-MAX-ATT-AGE > +0)
 13956        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13957        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13958           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13959           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13960           MOVE '1'              TO DC-OPTION-CODE
 13961           PERFORM 8500-DATE-CONVERT
 13962                                 THRU 8500-EXIT
 13963           IF NO-CONVERSION-ERROR
 13964              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13965                 MOVE ER-2661       TO WS-ERROR
 13966*                PERFORM 9900-ERROR-FORMAT
 13967*                                THRU 9900-EXIT
 13968              END-IF
 13969           END-IF
 13970        ELSE
 13971           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13972           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13973              MOVE ER-2661       TO WS-ERROR
 13974*             PERFORM 9900-ERROR-FORMAT
 13975*                                THRU 9900-EXIT
 13976           ELSE
 13977              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13978                 MOVE ER-1570    TO WS-ERROR
 13979                 PERFORM 9900-ERROR-FORMAT
 13980                                 THRU 9900-EXIT
 13981              END-IF
 13982           END-IF
 13983        END-IF
 13984        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13985           MOVE PB-I-JOINT-BIRTHDAY
 13986                                 TO DC-BIN-DATE-1
 13987           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13988           MOVE '1'              TO DC-OPTION-CODE
 13989           PERFORM 8500-DATE-CONVERT
 13990                                 THRU 8500-EXIT
 13991           IF NO-CONVERSION-ERROR
 13992              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13993                 MOVE ER-2661       TO WS-ERROR
 13994*                PERFORM 9900-ERROR-FORMAT
 13995*                                THRU 9900-EXIT
 13996              END-IF
 13997           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 254
* EL050.cbl
 13998              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13999           END-IF
 14000        ELSE
 14001           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14002             (PB-I-LF-TERM / 12)
 14003           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14004              MOVE ER-2661       TO WS-ERROR
 14005*             PERFORM 9900-ERROR-FORMAT
 14006*                                THRU 9900-EXIT
 14007           ELSE
 14008              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14009                 MOVE ER-1571    TO WS-ERROR
 14010                 PERFORM 9900-ERROR-FORMAT
 14011                                 THRU 9900-EXIT
 14012              END-IF
 14013           END-IF
 14014        END-IF
 14015        IF WS-ERROR = ER-2661
 14016           PERFORM 9900-ERROR-FORMAT
 14017                                 THRU 9900-EXIT
 14018        END-IF
 14019     END-IF
 14020*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14021*       MOVE ER-2661             TO WS-ERROR
 14022*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14023
 14024     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14025        MOVE ER-2662             TO WS-ERROR
 14026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14027
 14028     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14029        MOVE ER-2677             TO WS-ERROR
 14030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14031
 14032     IF CP-ERROR-LOAN-TERM
 14033        MOVE ER-2648             TO WS-ERROR
 14034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14035
 14036 3221-CHECK-ERROR-RATE-OPEN.
 14037
 14038     IF CP-ERROR-RATE-FILE-NOTOPEN
 14039         GO TO 3990-FILES-NOT-OPEN.
 14040
 14041     IF PB-COMPANY-ID NOT = 'DMD'
 14042        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14043     END-IF
 14044     .
 14045 3221-CONTINUE.
 14046     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14047                                    WS-DCC-AH-RATE
 14048     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14049        IF WS-LF-BEN-CATEGORY = 'D'
 14050           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14051              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14052        END-IF
 14053     END-IF
 14054     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14055*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 255
* EL050.cbl
 14056     IF (PB-COMPANY-ID = 'CID')
 14057        AND (WS-LF-EARNINGS-CALC = 'B')
 14058        AND (CP-STATE-STD-ABBRV = 'MN')
 14059        AND (PB-CERT-EFF-DT > X'A4FF')
 14060        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14061     END-IF
 14062     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14063
 14064     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14065     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14066        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14067        AND (PB-I-POLICY-IS-MONTHLY)
 14068        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14069        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14070     END-IF
 14071     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14072     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14073     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14074     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14075     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14076        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14077        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14078        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14079        MOVE ER-2786             TO WS-ERROR
 14080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14081     END-IF
 14082
 14083     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14084
 14085******************************************************************
 14086*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14087******************************************************************
 14088     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14089        and ((not pb-monthly-cert)
 14090        or (ws-lf-ben-category = 'C'))
 14091        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14092
 14093     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14094        GO TO 3225-CHECK-ALT-LIFE-RATE
 14095     ELSE
 14096       IF PB-I-LF-RATE = ZERO
 14097          MOVE ER-2641          TO WS-ERROR
 14098          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
 14100 3225-CHECK-ALT-LIFE-RATE.
 14101
 14102     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14103        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14104        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14105         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14106
 14107     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14108         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14109             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14110                   OR
 14111              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14112              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14113              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 256
* EL050.cbl
 14114             MOVE ER-2720        TO  WS-ERROR
 14115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14116             GO TO 3225-RATING-CONT
 14117         ELSE
 14118             GO TO 3225-RATING-CONT.
 14119     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14120        AND (AM-GPCD = 01 OR 06 OR 15)
 14121        MOVE ER-2798             TO WS-ERROR
 14122        PERFORM 9900-ERROR-FORMAT
 14123                                 THRU 9900-EXIT
 14124*       GO TO 3225-RATING-CONT
 14125     END-IF
 14126     if (pb-company-id = 'CID')
 14127        and (ws-lf-earnings-calc = 'B')
 14128        and (ws-lf-ben-category = 'P' or 'I')
 14129        and (ws-net-only-state = 'Y')
 14130        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14131        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14132        go to 3225-rating-cont
 14133     end-if
 14134     IF (PB-COMPANY-ID = 'CID')
 14135        AND (WS-LF-EARNINGS-CALC = 'B')
 14136        AND (CP-STATE-STD-ABBRV = 'MN')
 14137        AND (PB-CERT-EFF-DT > X'A4FF')
 14138        GO TO 3225-RATING-CONT
 14139     END-IF
 14140     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14141        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14142           AND (PB-I-POLICY-IS-MONTHLY)
 14143           GO TO 3225-RATING-CONT
 14144        END-IF
 14145     END-IF
 14146
 14147     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14148        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14149        CP-EARN-AS-REG-BALLOON
 14150        NEXT SENTENCE
 14151     ELSE
 14152        MOVE '2'                 TO CP-EARNING-METHOD.
 14153
 14154 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14155
 14156     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14157
 14158     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14159        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14160        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14161         NEXT SENTENCE
 14162     ELSE
 14163         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14164
 14165     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14166     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14167     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14168                                     CP-RATING-BENEFIT-AMT.
 14169     IF CP-STATE-STD-ABBRV = 'OR'
 14170         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14171                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 257
* EL050.cbl
 14172     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14173        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14174     END-IF
 14175     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14176     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14177     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14178                                    CP-REMAINING-TERM
 14179                                    CP-LOAN-TERM.
 14180     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14181        ADD +1                   TO CP-ORIGINAL-TERM
 14182                                    CP-REMAINING-TERM
 14183                                    CP-LOAN-TERM.
 14184
 14185     MOVE 'R'                   TO CP-RATE-FILE.
 14186     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14187
 14188     IF CP-ERROR-RATE-NOT-FOUND
 14189         MOVE ER-2641            TO WS-ERROR
 14190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14191         GO TO 3300-CHECK-AH-RATES.
 14192
 14193     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14194     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14195
 14196     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14197         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14198
 14199     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14200                               + PB-I-LF-ALT-BENEFIT-AMT.
 14201
 14202     IF ACCOUNT-LIFE-CHECKED  OR
 14203        PB-POLICY-IS-VOIDED   OR
 14204        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14205        and (not pb-monthly-cert))
 14206        GO TO 3225-CONTINUE.
 14207
 14208     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14209        GO TO 3225-CONTINUE.
 14210
 14211     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14212                             EC-RT-LF-MAX-TOT-BEN
 14213        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14214        MOVE ER-2639       TO WS-ERROR
 14215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14216
 14217 3225-CONTINUE.
 14218     IF PB-I-LF-ALT-RATE = ZERO
 14219         MOVE ER-2659            TO WS-ERROR
 14220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14221
 14222     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14223        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14224        MOVE ER-2698             TO WS-ERROR
 14225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14226
 14227 3225-RATING-CONT.
 14228
 14229     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 258
* EL050.cbl
 14230        and (not pb-monthly-cert)
 14231         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14232         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14233         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14234            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14235            CONTINUE
 14236         ELSE
 14237            MOVE ER-2687         TO WS-ERROR
 14238            PERFORM 9900-ERROR-FORMAT
 14239                                 THRU 9900-EXIT
 14240         END-IF
 14241         GO TO 3290-EDIT-LF-REIN-RATE
 14242     END-IF
 14243
 14244* DMD RATING TEST
 14245     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14246         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14247         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14248         MOVE ER-2687                 TO WS-ERROR
 14249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14250         GO TO 3290-EDIT-LF-REIN-RATE.
 14251
 14252 3230-CLIENT-MORT-CD-SPECIALS.
 14253
 14254     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14255     SET BIN-TO-GREG          TO TRUE.
 14256*    MOVE ' '                 TO DC-OPTION-CODE.
 14257     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14258     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14259
 14260 C-POS-3230-MORT-CD.
 14261     IF PB-COMPANY-ID = 'POS' AND
 14262        PB-SV-CARRIER = '2'
 14263         NEXT SENTENCE
 14264     ELSE
 14265         GO TO C-POS-3240-MORT-CD.
 14266
 14267     IF PB-SV-GROUPING = '030'
 14268        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14269         MOVE '2350' TO PB-I-MORT-CODE
 14270      ELSE
 14271         MOVE '3300' TO PB-I-MORT-CODE.
 14272
 14273
 14274 C-POS-3240-MORT-CD.
 14275     IF PB-COMPANY-ID = 'POS' AND
 14276        PB-SV-CARRIER = '1'
 14277         NEXT SENTENCE
 14278     ELSE
 14279         GO TO 3230-CONTINUE.
 14280
 14281     IF PB-SV-STATE = '45' OR '47'
 14282        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14283         MOVE '5200' TO PB-I-MORT-CODE
 14284     ELSE
 14285         MOVE '8300' TO PB-I-MORT-CODE.
 14286
 14287 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 259
* EL050.cbl
 14288
 14289     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14290        GO TO 3240-CONTINUE
 14291     END-IF
 14292
 14293     IF PB-CERT-EFF-DT > WS-971231
 14294        GO TO 3240-CONTINUE
 14295     END-IF
 14296
 14297     IF LF-BENEFIT-FOUND AND
 14298        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14299         MOVE 'F250'       TO PB-I-MORT-CODE
 14300     ELSE
 14301         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14302             MOVE '7250'   TO PB-I-MORT-CODE
 14303         ELSE
 14304             MOVE '4251'   TO PB-I-MORT-CODE
 14305         END-IF
 14306     END-IF
 14307
 14308     .
 14309 3240-CONTINUE.
 14310
 14311     IF PB-COMPANY-ID NOT = 'GNL'
 14312         GO TO 3256-CONTINUE.
 14313
 14314     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14315         MOVE 'A300' TO PB-I-MORT-CODE
 14316     ELSE
 14317         MOVE '8350' TO PB-I-MORT-CODE.
 14318
 14319 3256-CONTINUE.
 14320     IF PB-COMPANY-ID NOT = 'ABL'
 14321         GO TO 3260-EDIT-CONTINUE.
 14322
 14323     IF PB-I-LF-TERM GREATER THAN 59
 14324         MOVE 'F550' TO PB-I-MORT-CODE
 14325     ELSE
 14326         MOVE 'E550' TO PB-I-MORT-CODE.
 14327
 14328 3260-EDIT-CONTINUE.
 14329     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14330
 14331 3290-EDIT-LF-REIN-RATE.
 14332     IF LF-REIN-NSP-NOT-USED
 14333         GO TO 3290-RATING-CONT.
 14334
 14335     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14336        GO TO 3290-RATING-CONT.
 14337     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14338     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14339     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14340     MOVE '3'                   TO CP-PROCESS-TYPE.
 14341     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14342
 14343******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14344     IF PB-COMPANY-ID EQUAL 'CDL'
 14345         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 260
* EL050.cbl
 14346            CP-EARN-AS-NET-PAY)
 14347             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14348*            MOVE SPACE          TO DC-OPTION-CODE
 14349             SET BIN-TO-GREG     TO TRUE
 14350             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14351***  Y2K PROJ 7744
 14352             IF DC-GREG-DATE-CYMD GREATER 19931231
 14353                 MOVE '1'        TO CP-EARNING-METHOD.
 14354***  Y2K PROJ 7744
 14355*******
 14356
 14357     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14358     MOVE PB-SV-STATE           TO CP-STATE.
 14359     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14360     MOVE ZERO                  TO CP-DEVIATION-CODE
 14361                                   CP-RATE-DEV-PCT.
 14362     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14363     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14364                                   CP-RATING-BENEFIT-AMT.
 14365
 14366************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14367     IF PB-COMPANY-ID EQUAL 'NCB'
 14368         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14369            CP-EARN-AS-NET-PAY
 14370             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14371                 PB-I-LF-PREMIUM-AMT.
 14372************
 14373
 14374     IF CP-STATE-STD-ABBRV = 'OR'
 14375         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14376                                         PB-I-LF-ALT-BENEFIT-AMT.
 14377     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14378     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14379     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14380     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14381     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14382     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14383     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14384     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14385                                   CP-REMAINING-TERM
 14386                                   CP-LOAN-TERM.
 14387     IF CP-TRUNCATED-LIFE
 14388        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14389
 14390     IF CP-TERM-IS-DAYS
 14391         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14392     ELSE
 14393         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14394
 14395     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14396        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14397     END-IF
 14398     IF PB-COMPANY-ID NOT = 'TIC'
 14399          MOVE ZERO          TO CP-CLASS-CODE.
 14400
 14401     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14402
 14403     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 261
* EL050.cbl
 14404     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14405
 14406     IF CP-ERROR-RATE-NOT-FOUND
 14407        IF PB-I-OB
 14408           MOVE ER-2625      TO WS-ERROR
 14409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14410           GO TO 3299-EDIT-CONTINUE
 14411        ELSE
 14412           MOVE ER-2643      TO WS-ERROR
 14413           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14414           GO TO 3299-EDIT-CONTINUE.
 14415
 14416     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14417
 14418     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14419     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14420
 14421     IF PB-I-LF-REI-RATE = ZERO
 14422         MOVE ER-2643        TO WS-ERROR
 14423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14424
 14425 3290-CHECK-ALT-REIN-RATE.
 14426
 14427     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14428        GO TO 3290-RATING-CONT.
 14429
 14430     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14431     MOVE '2'                    TO CP-EARNING-METHOD.
 14432     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14433     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14434     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14435     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14436                                     CP-RATING-BENEFIT-AMT.
 14437     IF CP-STATE-STD-ABBRV = 'OR'
 14438         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14439                                         PB-I-LF-ALT-BENEFIT-AMT.
 14440     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14441        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14442     END-IF
 14443     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14444     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14445     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14446                                    CP-REMAINING-TERM
 14447                                    CP-LOAN-TERM.
 14448     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14449        ADD +1                   TO CP-ORIGINAL-TERM
 14450                                    CP-REMAINING-TERM
 14451                                    CP-LOAN-TERM.
 14452
 14453     MOVE 'R'                   TO CP-RATE-FILE.
 14454     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14455
 14456     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14457
 14458     IF PB-I-LF-ALT-REI-RATE = ZERO
 14459         MOVE ER-2643            TO WS-ERROR
 14460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14461
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 262
* EL050.cbl
 14462 3290-RATING-CONT.
 14463
 14464     IF PB-I-OB
 14465*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14466        GO TO 3300-CHECK-AH-RATES.
 14467
 14468 3299-EDIT-CONTINUE.
 14469
 14470     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14471         NEXT SENTENCE
 14472     ELSE
 14473         MOVE ER-2620           TO WS-ERROR
 14474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14475
 14476 3300-CHECK-AH-RATES.
 14477     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14478         NEXT SENTENCE
 14479     ELSE
 14480         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14481
 14482     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14483        and (not pb-monthly-cert))
 14484                  or
 14485        ((CF-COMPANY-ID = 'DMD') AND
 14486                (NO-DMD-RATING))
 14487         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14488            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14489            CONTINUE
 14490         ELSE
 14491            MOVE ER-2687         TO WS-ERROR
 14492            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14493         END-IF
 14494         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14495         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14496     END-IF
 14497
 14498     IF PB-I-OB
 14499        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14500
 14501     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14502         MOVE ER-2687             TO WS-ERROR
 14503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14504         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14505         GO TO 3999-END-EDIT.
 14506
 14507*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14508     if pb-company-id = 'AHL'
 14509        go to 3300-skip-crit-per
 14510     end-if
 14511     if (pb-i-ah-crit-per not = zeros)
 14512        and (ws-ah-special-calc-cd not = 'C')
 14513        MOVE ER-1572             TO WS-ERROR
 14514        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14515        go to 3300-skip-crit-per
 14516     END-IF
 14517     if (pb-company-id = 'DCC' or 'VPP')
 14518        and (am-dcc-product-code not = spaces)
 14519        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 263
* EL050.cbl
 14520     end-if
 14521     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14522        IF PB-I-AH-CRIT-PER = ZERO
 14523           move ws-ah-max-bens   to pb-i-ah-crit-per
 14524*          MOVE ER-2618       TO WS-ERROR
 14525*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14526*          GO TO 3999-END-EDIT
 14527        END-IF
 14528     END-IF
 14529     if (ws-ah-special-calc-cd = 'C')
 14530        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14531        MOVE ER-1576             TO WS-ERROR
 14532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14533     end-if
 14534
 14535     .
 14536 3300-skip-crit-per.
 14537     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14538     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14539     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14540     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14541     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14542     MOVE PB-SV-STATE            TO CP-STATE.
 14543     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14544     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14545     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14546*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14547     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14548     MOVE '3'                    TO CP-PROCESS-TYPE.
 14549     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14550     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14551                                    CP-RATING-BENEFIT-AMT.
 14552     IF PB-COMPANY-ID = 'CID'
 14553               OR
 14554        CP-STATE-STD-ABBRV = 'OR'
 14555         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14556                                         PB-I-AH-TERM.
 14557     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14558        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14559           AND (PB-I-POLICY-IS-MONTHLY)
 14560           MOVE PB-I-LF-BENEFIT-AMT
 14561                                 TO CP-NET-BENEFIT-AMT
 14562           move pb-i-ah-premium-amt to cp-original-premium
 14563           add pb-i-lf-premium-amt to cp-original-premium
 14564        END-IF
 14565     END-IF
 14566     MOVE SPACES                 TO CP-BEN-CATEGORY
 14567     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14568        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14569        EVALUATE TRUE
 14570           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14571              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14572              MOVE PB-I-LF-BENEFIT-AMT
 14573                                 TO CP-RATING-BENEFIT-AMT
 14574              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14575           WHEN WS-AH-BEN-CATEGORY = 'G'
 14576              MOVE PB-I-UNPAID-CASH-PRICE
 14577                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 264
* EL050.cbl
 14578           WHEN WS-AH-BEN-CATEGORY = 'D'
 14579              MOVE WS-AH-PMF-COMM
 14580                                 TO CP-DCC-PMF-COMM
 14581              MOVE PB-I-AH-COMMISSION
 14582                                 TO CP-DCC-ACT-COMM
 14583        END-EVALUATE
 14584     END-IF
 14585     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14586     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14587     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14588     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14589     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14590     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14591     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14592                                    CP-REMAINING-TERM
 14593                                    WS-WORK-TERM.
 14594     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14595
 14596     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14597     SET BIN-TO-GREG             TO TRUE.
 14598*    MOVE ' '                    TO DC-OPTION-CODE.
 14599     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14600     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14601
 14602     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14603     IF NOT VALID-SKIP-CODE
 14604         MOVE ER-2683            TO WS-ERROR
 14605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14606         GO TO 3320-RATE-CONTINUE.
 14607
 14608     IF PB-NO-MONTHS-SKIPPED
 14609         GO TO 3320-RATE-CONTINUE.
 14610
 14611     MOVE SPACE TO NUMBER-OF-MONTHS.
 14612
 14613     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14614         MOVE 'S'                TO SK-MO (6).
 14615     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14616         MOVE 'S'                TO SK-MO (7).
 14617     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14618         MOVE 'S'                TO SK-MO (8).
 14619     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14620         MOVE 'S'                TO SK-MO (9).
 14621     IF PB-I-SKIP-CODE = 'A'
 14622         MOVE 'S'                TO SK-MO (10).
 14623
 14624     MOVE 1                      TO SUB2.
 14625     MOVE PB-I-AH-TERM           TO SUB3.
 14626     MOVE WS-MONTH               TO SUB1.
 14627     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14628     GO TO 3320-RATE-CONTINUE.
 14629
 14630 3310-GET-SKIP-MO.
 14631     IF SUB1 = 13
 14632         MOVE 1                  TO SUB1.
 14633
 14634     IF SK-MO (SUB1) = 'S'
 14635         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 265
* EL050.cbl
 14636
 14637     ADD 1 TO SUB2
 14638              SUB1.
 14639
 14640 3320-RATE-CONTINUE.
 14641
 14642     IF WS-WORK-TERM = ZERO
 14643         MOVE 1                  TO WS-WORK-TERM.
 14644
 14645     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14646                                    CP-LOAN-TERM.
 14647
 14648     IF PB-COMPANY-ID EQUAL 'DMD'
 14649         NEXT SENTENCE
 14650     ELSE
 14651         MOVE ZERO               TO PB-I-AH-RATE
 14652                                    PB-I-AH-REI-RATE.
 14653
 14654
 14655     IF PB-COMPANY-ID EQUAL 'CRI'
 14656        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14657
 14658     IF PB-COMPANY-ID = 'CSL'
 14659         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14660         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14661         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14662         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14663
 14664     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14665        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14666           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14667              PB-I-RATE-DEV-PCT-LF
 14668        END-IF
 14669        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14670                                 TO CP-ALTERNATE-BENEFIT
 14671        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14672        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14673        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14674     END-IF
 14675*    if ws-clp-state not = spaces
 14676*       move ws-clp-state to cp-state
 14677*    end-if
 14678     IF (PB-COMPANY-ID = 'CID')
 14679        AND (WS-LF-EARNINGS-CALC = 'B')
 14680        AND (CP-STATE-STD-ABBRV = 'MN')
 14681        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14682     ELSE
 14683        MOVE ' '                 TO CP-AH-BALLOON-SW
 14684     END-IF
 14685     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14686     MOVE 'R'                   TO CP-RATE-FILE.
 14687     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14688
 14689     IF (CP-ERROR-RATE-NOT-FOUND)
 14690        and (not pb-monthly-cert)
 14691        IF PB-I-OB
 14692           MOVE ER-2624          TO WS-ERROR
 14693           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 266
* EL050.cbl
 14694           GO TO 3340-CALCULATE-PREMIUM-AMT
 14695        ELSE
 14696          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14697              NEXT SENTENCE
 14698          ELSE
 14699           MOVE ER-2642          TO WS-ERROR
 14700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14701           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14702
 14703     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14704        CP-ERROR-DIV-BY-ZERO
 14705           MOVE ER-3782          TO WS-ERROR
 14706           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14707
 14708     IF PB-COMPANY-ID EQUAL 'CRI'
 14709        IF CP-ERROR-NO-LIMITS-CRI
 14710           IF NOT ACCOUNT-AH-CHECKED
 14711              MOVE ER-2607          TO WS-ERROR
 14712              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14713
 14714     IF ACCOUNT-AH-CHECKED
 14715        NEXT SENTENCE
 14716     ELSE
 14717       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14718          MOVE ER-2640           TO WS-ERROR
 14719          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14720
 14721     IF PB-COMPANY-ID = 'CRI'
 14722         IF WS-ERROR = ER-2640
 14723             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14724     IF ACCOUNT-AH-CHECKED
 14725        CONTINUE
 14726     ELSE
 14727        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14728           AND (CP-R-MAX-ATT-AGE > +0)
 14729           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14730           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14731              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14732              MOVE PB-I-AH-EXPIRE-DT
 14733                                 TO DC-BIN-DATE-2
 14734              MOVE '1'           TO DC-OPTION-CODE
 14735              PERFORM 8500-DATE-CONVERT
 14736                                 THRU 8500-EXIT
 14737              IF NO-CONVERSION-ERROR
 14738                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14739                    MOVE ER-2661       TO WS-ERROR
 14740*                   PERFORM 9900-ERROR-FORMAT
 14741*                                THRU 9900-EXIT
 14742                 END-IF
 14743              END-IF
 14744           ELSE
 14745              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14746              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14747                 MOVE ER-2661    TO WS-ERROR
 14748*                PERFORM 9900-ERROR-FORMAT
 14749*                                THRU 9900-EXIT
 14750              ELSE
 14751                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 267
* EL050.cbl
 14752                    MOVE ER-1570 TO WS-ERROR
 14753                    PERFORM 9900-ERROR-FORMAT
 14754                                 THRU 9900-EXIT
 14755                 END-IF
 14756              END-IF
 14757           END-IF
 14758           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14759              MOVE PB-I-JOINT-BIRTHDAY
 14760                                    TO DC-BIN-DATE-1
 14761              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14762              MOVE '1'              TO DC-OPTION-CODE
 14763              PERFORM 8500-DATE-CONVERT
 14764                                    THRU 8500-EXIT
 14765              IF NO-CONVERSION-ERROR
 14766                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14767                    MOVE ER-2661       TO WS-ERROR
 14768*                   PERFORM 9900-ERROR-FORMAT
 14769*                                   THRU 9900-EXIT
 14770                 END-IF
 14771              END-IF
 14772           ELSE
 14773              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14774                (PB-I-AH-TERM / 12)
 14775              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14776                 MOVE ER-2661       TO WS-ERROR
 14777*                PERFORM 9900-ERROR-FORMAT
 14778*                                   THRU 9900-EXIT
 14779              ELSE
 14780                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14781                    MOVE ER-1571 TO WS-ERROR
 14782                    PERFORM 9900-ERROR-FORMAT
 14783                                 THRU 9900-EXIT
 14784                 END-IF
 14785              END-IF
 14786           END-IF
 14787           IF WS-ERROR = ER-2661
 14788              PERFORM 9900-ERROR-FORMAT
 14789                                    THRU 9900-EXIT
 14790           END-IF
 14791        END-IF
 14792     END-IF
 14793*    IF ACCOUNT-AH-CHECKED
 14794*       NEXT SENTENCE
 14795*    ELSE
 14796*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14797*          MOVE ER-2661          TO WS-ERROR
 14798*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14799
 14800     IF ACCOUNT-AH-CHECKED
 14801        NEXT SENTENCE
 14802     ELSE
 14803        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14804           MOVE ER-2663          TO WS-ERROR
 14805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14806
 14807     IF ACCOUNT-AH-CHECKED OR
 14808        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14809         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 268
* EL050.cbl
 14810        NEXT SENTENCE
 14811     ELSE
 14812        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14813           MOVE ER-2667            TO WS-ERROR
 14814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14815
 14816     IF PB-COMPANY-ID = 'CRI'
 14817         IF WS-ERROR = ER-2667
 14818             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14819
 14820     IF ACCOUNT-AH-CHECKED
 14821        NEXT SENTENCE
 14822     ELSE
 14823        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14824           MOVE ER-2678            TO WS-ERROR
 14825           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14826
 14827     IF CP-ERROR-RATE-FILE-NOTOPEN
 14828         GO TO 3990-FILES-NOT-OPEN.
 14829
 14830 3321-CONTINUE.
 14831     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14832     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14833     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14834*    IF (PB-COMPANY-ID = 'DCC')
 14835        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14836        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14837                                    PB-I-LF-ALT-PREM-CALC
 14838        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14839        IF WS-AH-BEN-CATEGORY = 'G'
 14840           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14841           + PB-I-ADDL-CLP)
 14842           * (1 + WS-TOL-CLP-PCT)
 14843*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14844        ELSE
 14845           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14846           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14847*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14848        END-IF
 14849        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14850                                 TO PB-I-AH-PREM-CALC
 14851        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14852           MOVE ER-8152          TO WS-ERROR
 14853           PERFORM 9900-ERROR-FORMAT
 14854                                 THRU 9900-EXIT
 14855        ELSE
 14856           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14857                 PB-I-ADDL-CLP)
 14858              MOVE ER-8148       TO WS-ERROR
 14859              PERFORM 9900-ERROR-FORMAT
 14860                                 THRU 9900-EXIT
 14861           END-IF
 14862        END-IF
 14863     END-IF
 14864     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14865        AND (PB-I-POLICY-IS-MONTHLY)
 14866        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14867        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 269
* EL050.cbl
 14868        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14869           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14870        END-IF
 14871     END-IF
 14872     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14873        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14874        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14875        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14876        MOVE ER-2786             TO WS-ERROR
 14877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14878     END-IF
 14879     MOVE +0                     TO PB-I-AH-CLP
 14880     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14881        evaluate true
 14882           when WS-AH-BEN-CATEGORY = 'D'
 14883              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14884                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14885           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14886              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14887           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14888              compute ws-cred-union-fees rounded =
 14889                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14890                    pb-i-ah-commission)
 14891              COMPUTE PB-I-AH-CLP =
 14892                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14893        end-evaluate
 14894     END-IF
 14895     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14896
 14897     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14898         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14899
 14900     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14901         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14902
 14903     if (ws-ah-special-calc-cd = 'E')
 14904        and (pb-monthly-cert)
 14905        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14906     end-if
 14907     IF PB-COMPANY-ID = 'CRI'
 14908         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14909            PB-I-PAYMENT-AMOUNT = ZERO
 14910             NEXT SENTENCE
 14911         ELSE
 14912             COMPUTE PB-I-AH-PREM-CALC =
 14913                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14914                 (CP-PREMIUM-RATE / 100)
 14915             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14916                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14917                                             PB-I-RATE-DEV-PCT-AH.
 14918
 14919     IF (PB-I-AH-RATE  = ZERO)
 14920        and (not pb-monthly-cert)
 14921       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14922           NEXT SENTENCE
 14923       ELSE
 14924         MOVE ER-2642            TO WS-ERROR
 14925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 270
* EL050.cbl
 14926
 14927     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14928     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14929     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14930     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14931     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14932     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14933
 14934     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14935        AND (WS-AH-BEN-CATEGORY = 'G')
 14936        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14937        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14938        IF CP-DEVIATION-CODE NOT = '000'
 14939           MOVE '000'            TO CP-DEVIATION-CODE
 14940           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14941           IF NO-CP-ERROR
 14942              COMPUTE PB-I-DDF-IU-RATE-UP =
 14943              PB-I-AH-CLP - CP-CALC-PREMIUM
 14944           ELSE
 14945              MOVE ER-3057        TO WS-ERROR
 14946              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14947           END-IF
 14948        END-IF
 14949     END-IF
 14950     .
 14951 3335-EDIT-AH-REIN-NSP-RATE.
 14952     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14953        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14954              compute ws-cred-union-fees rounded =
 14955                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14956                    pb-i-ah-commission)
 14957              COMPUTE PB-I-AH-CLP =
 14958                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14959        end-if
 14960     END-IF
 14961     IF AH-REIN-NSP-NOT-USED
 14962         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14963
 14964     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14965     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14966         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14967     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14968     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14969     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14970     MOVE PB-SV-STATE            TO CP-STATE.
 14971     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14972     MOVE ZERO                   TO CP-DEVIATION-CODE
 14973                                    CP-RATE-DEV-PCT.
 14974*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14975     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14976     MOVE '3'                    TO CP-PROCESS-TYPE.
 14977     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14978     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14979                                    CP-RATING-BENEFIT-AMT.
 14980     IF CP-STATE-STD-ABBRV = 'OR'
 14981         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14982                                         PB-I-AH-TERM.
 14983     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 271
* EL050.cbl
 14984     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14985     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14986     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14987     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14988     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14989                                    CP-REMAINING-TERM
 14990                                    WS-WORK-TERM.
 14991     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14992     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14993        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14994     END-IF
 14995     IF  PB-COMPANY-ID = 'TIC'
 14996         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14997            MOVE ZERO TO CP-CLASS-CODE.
 14998
 14999     IF PB-COMPANY-ID NOT = 'TIC'
 15000          MOVE ZERO          TO CP-CLASS-CODE.
 15001
 15002     MOVE ZERO               TO CP-DEVIATION-CODE.
 15003
 15004     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15005
 15006     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15007
 15008     MOVE 'R'                   TO CP-RATE-FILE.
 15009     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15010
 15011     IF CP-ERROR-RATE-NOT-FOUND
 15012         MOVE ER-2645        TO WS-ERROR
 15013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15014         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15015
 15016     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15017
 15018     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15019     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15020
 15021     IF PB-I-AH-REI-RATE = ZERO
 15022         MOVE ER-2645        TO WS-ERROR
 15023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15024
 15025
 15026 3340-CALCULATE-PREMIUM-AMT.
 15027
 15028     IF PB-COMPANY-ID = 'NCL'
 15029         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15030             WS-AH-SPECIAL-CALC-CD = 'O')
 15031             GO TO 3999-END-EDIT.
 15032
 15033     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15034                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15035                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15036                         OR 'AHL'
 15037         NEXT SENTENCE
 15038     ELSE
 15039         IF WS-STATE-ABBREVIATION = 'CT'
 15040             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15041                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 272
* EL050.cbl
 15042                 COMPUTE PB-I-LF-PREM-CALC =
 15043                                     PB-I-LF-PREM-CALC * .90
 15044                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15045                                     PB-I-LF-ALT-PREM-CALC * .90
 15046                 COMPUTE PB-I-AH-PREM-CALC =
 15047                                     PB-I-AH-PREM-CALC * .90.
 15048
 15049     IF PB-COMP-LF-PREM
 15050        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15051        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15052
 15053     IF PB-COMP-AH-PREM
 15054        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15055
 15056 3340-CHECK-DCC-TOT-FEES.
 15057     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15058        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15059        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15060        AND (PB-I-POLICY-IS-MONTHLY)
 15061        CONTINUE
 15062     ELSE
 15063        GO TO 3340-EDIT-LF-AH-TOL
 15064     END-IF
 15065     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15066     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15067     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15068        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15069           PB-I-RATE-DEV-PCT-LF
 15070     END-IF
 15071     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15072        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15073           PB-I-RATE-DEV-PCT-AH
 15074     END-IF
 15075     MOVE 'N'                    TO CP-BEN-CATEGORY
 15076     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15077
 15078     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15079     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15080     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15081     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15082     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15083     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15084     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15085     MOVE '3'                    TO CP-PROCESS-TYPE.
 15086     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15087     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15088
 15089     MOVE PB-SV-STATE            TO CP-STATE.
 15090     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15091     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15092     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15093     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15094     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15095                                    CP-RATING-BENEFIT-AMT.
 15096     IF CP-STATE-STD-ABBRV = 'OR'
 15097         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15098                                         PB-I-LF-ALT-BENEFIT-AMT.
 15099     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 273
* EL050.cbl
 15100     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15101     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15102     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15103     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15104     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15105     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15106     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15107     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15108                                    CP-REMAINING-TERM
 15109                                    CP-LOAN-TERM.
 15110     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15111        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15112           PB-I-LF-PREMIUM-AMT
 15113     end-if
 15114
 15115     IF CP-TRUNCATED-LIFE
 15116        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15117
 15118     IF CP-TERM-IS-DAYS
 15119         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15120     ELSE
 15121         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15122
 15123     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15124     IF CP-SPECIAL-CALC-CD = 'H'
 15125         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15126                                    TO CP-ALTERNATE-BENEFIT
 15127         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15128     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15129     MOVE 'R'                    TO CP-RATE-FILE
 15130     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15131     IF NOT CP-ERROR-RATE-NOT-FOUND
 15132        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15133        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15134           AND (CP-BENEFIT-CD (1:1) = 'S')
 15135           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15136                                    PB-I-LF-PREMIUM-AMT
 15137        END-IF
 15138     ELSE
 15139        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15140     END-IF
 15141     .
 15142 3340-EDIT-LF-AH-TOL.
 15143
 15144***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15145***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15146***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15147***
 15148     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15149         PB-I-AH-PREMIUM-AMT
 15150          GIVING WS-CALC-WORK.
 15151
 15152     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15153        AND WS-CALC-WORK NOT = ZERO
 15154         MOVE ER-2649            TO WS-ERROR
 15155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15156
 15157     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 274
* EL050.cbl
 15158             FROM PB-I-LF-PREMIUM-AMT
 15159                 GIVING WS-UNSIGN-WRK1.
 15160
 15161     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15162             FROM PB-I-LF-ALT-PREMIUM-AMT
 15163                 GIVING WS-UNSIGN-WRK4.
 15164
 15165     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15166                                + WS-UNSIGN-WRK4.
 15167
 15168     SUBTRACT PB-I-AH-PREM-CALC
 15169             FROM PB-I-AH-PREMIUM-AMT
 15170                 GIVING WS-UNSIGN-WRK2.
 15171
 15172******************************************************************
 15173*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15174******************************************************************
 15175
 15176     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15177         MOVE ZERO TO WS-UNSIGN-WRK1.
 15178
 15179     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15180         MOVE ZERO TO WS-UNSIGN-WRK2.
 15181
 15182     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15183             GIVING WS-UNSIGN-WRK3.
 15184
 15185 3342-CONTINUE.
 15186
 15187     IF (PB-I-LF-RATE = ZERO  AND
 15188         PB-I-AH-RATE = ZERO)
 15189         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15190            WS-AH-SPECIAL-CALC-CD = 'O'
 15191              NEXT SENTENCE
 15192         ELSE
 15193             GO TO 3345-EDIT-CONTINUE.
 15194
 15195     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15196         NEXT SENTENCE
 15197     ELSE
 15198     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15199        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15200           IF (PB-REISSUED-CERT         OR
 15201               PB-POLICY-IS-DECLINED    OR
 15202               PB-POLICY-IS-VOIDED)
 15203              NEXT SENTENCE
 15204           ELSE
 15205              IF WS-PREM-REJECT-SW = SPACE
 15206                 MOVE ER-2652    TO WS-ERROR
 15207                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15208                 GO TO 3344-CHECK-AH
 15209              ELSE
 15210                 MOVE ER-2650    TO WS-ERROR
 15211                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15212                 GO TO 3344-CHECK-AH.
 15213
 15214***
 15215***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 275
* EL050.cbl
 15216***
 15217
 15218     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15219         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15220            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15221             (1 + WS-TOL-LF-PREM-PCT)
 15222         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15223            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15224             (1 - WS-TOL-LF-PREM-PCT)
 15225     ELSE
 15226         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15227         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15228
 15229***
 15230***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15231***
 15232
 15233     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15234         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15235          WS-TOL-LF-PREM.
 15236
 15237     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15238         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15239          WS-TOL-LF-PREM.
 15240
 15241     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15242        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15243
 15244     IF PB-REISSUED-CERT
 15245        or PB-POLICY-IS-DECLINED
 15246        or PB-POLICY-IS-VOIDED
 15247        continue
 15248     ELSE
 15249        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15250              > WS-TOL-LF-HIGH-PREM-AMT)
 15251           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15252              < WS-TOL-LF-LOW-PREM-AMT))
 15253                      or
 15254           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15255              > WS-TOL-LF-HIGH-PREM-PCT)
 15256           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15257              < WS-TOL-LF-LOW-PREM-PCT))
 15258           IF WS-PREM-REJECT-SW = SPACE
 15259              MOVE ER-2652       TO WS-ERROR
 15260              PERFORM 9900-ERROR-FORMAT
 15261                                 THRU 9900-EXIT
 15262           ELSE
 15263              MOVE ER-2650       TO WS-ERROR
 15264              PERFORM 9900-ERROR-FORMAT
 15265                                 THRU 9900-EXIT
 15266           end-if
 15267        end-if
 15268     end-if
 15269
 15270*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15271*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15272*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15273*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 276
* EL050.cbl
 15274
 15275     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15276        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15277                      OR
 15278           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15279           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15280           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15281           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15282        END-IF
 15283     END-IF
 15284
 15285     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15286        IF WS-COMP-MAX-CAP GREATER THAN +0
 15287           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15288              IF (PB-REISSUED-CERT         OR
 15289                  PB-POLICY-IS-DECLINED    OR
 15290                  PB-POLICY-IS-VOIDED)
 15291                 NEXT SENTENCE
 15292              ELSE
 15293                  MOVE ER-2646   TO  WS-ERROR
 15294                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15295
 15296 3344-CVL-TOLERANCE-CHECK.
 15297
 15298      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15299          GO TO 3344-CHECK-AH.
 15300
 15301      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15302          GO TO 3344-CHECK-AH.
 15303
 15304      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15305                                     WS-UNSIGN-WRK6.
 15306
 15307      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15308          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15309                                 + PB-I-LF-PREMIUM-AMT
 15310                                 - PB-I-LF-PREM-CALC.
 15311
 15312      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15313          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15314                                 + PB-I-LF-ALT-PREMIUM-AMT
 15315                                 - PB-I-LF-ALT-PREM-CALC.
 15316
 15317      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15318          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15319              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15320                 MOVE ER-2652    TO  WS-ERROR
 15321                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15322              ELSE
 15323                 MOVE ER-2650    TO  WS-ERROR
 15324                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15325
 15326      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15327          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15328              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15329                 MOVE ER-2652    TO  WS-ERROR
 15330                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15331              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 277
* EL050.cbl
 15332                 MOVE ER-2650    TO  WS-ERROR
 15333                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15334
 15335 3344-CHECK-AH.
 15336
 15337****************************************************************
 15338***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15339***
 15340
 15341     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15342         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15343             (1 + WS-TOL-AH-PREM-PCT)
 15344         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15345             (1 - WS-TOL-AH-PREM-PCT)
 15346     ELSE
 15347         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15348         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15349
 15350***
 15351***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15352***
 15353
 15354     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15355         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15356
 15357     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15358         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15359
 15360     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15361        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15362
 15363     IF (PB-REISSUED-CERT)
 15364        OR (PB-POLICY-IS-DECLINED)
 15365        OR (PB-POLICY-IS-VOIDED)
 15366        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15367        CONTINUE
 15368     ELSE
 15369        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15370              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15371                          or
 15372           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15373              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15374           IF WS-PREM-REJECT-SW = SPACE
 15375              MOVE ER-3052       TO WS-ERROR
 15376              PERFORM 9900-ERROR-FORMAT
 15377                                 THRU 9900-EXIT
 15378           ELSE
 15379              MOVE ER-3050       TO WS-ERROR
 15380              PERFORM 9900-ERROR-FORMAT
 15381                                 THRU 9900-EXIT
 15382           END-IF
 15383        END-IF
 15384     END-IF
 15385     if (pb-company-id = 'DCC' or 'VPP')
 15386        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15387        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15388        and (pb-i-policy-is-monthly)
 15389        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 278
* EL050.cbl
 15390           pb-i-tot-fees-calc + ws-tol-ah-prem
 15391        compute ws-tol-ah-low-prem-amt =
 15392           pb-i-tot-fees-calc - ws-tol-ah-prem
 15393        if ws-tol-ah-prem-pct > zeros
 15394           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15395              (1 + ws-tol-ah-prem-pct)
 15396           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15397              (1 - ws-tol-ah-prem-pct)
 15398        else
 15399           move +9999999.99      to ws-tol-ah-high-prem-pct
 15400           move +0               to ws-tol-ah-low-prem-pct
 15401        end-if
 15402        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15403            or
 15404           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15405                          or
 15406           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15407           or
 15408           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15409            move er-3049         to ws-error
 15410           perform 9900-error-format
 15411                                 thru 9900-exit
 15412
 15413        end-if
 15414     end-if
 15415     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15416         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15417             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15418             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15419
 15420     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15421        IF WS-COMP-MAX-CAP GREATER THAN +0
 15422           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15423              IF (PB-REISSUED-CERT         OR
 15424                  PB-POLICY-IS-DECLINED    OR
 15425                  PB-POLICY-IS-VOIDED)
 15426                 NEXT SENTENCE
 15427              ELSE
 15428                  MOVE ER-2646   TO  WS-ERROR
 15429                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15430
 15431     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15432        (WS-COMP-MAX-CAP EQUAL +0)
 15433           GO TO 3345-EDIT-CONTINUE.
 15434
 15435     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15436        GREATER THAN WS-COMP-MAX-CAP
 15437           MOVE ER-2646          TO  WS-ERROR
 15438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15439
 15440 3345-EDIT-CONTINUE.
 15441
 15442*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15443*       IF PB-ENTRY-BATCH   NUMERIC
 15444*          IF PB-ISSUE
 15445*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15446*          ELSE
 15447*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 279
* EL050.cbl
 15448*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15449
 15450*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15451*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15452*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15453*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15454*        ELSE
 15455*            MOVE  ER-1909            TO  WS-ERROR
 15456*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15457
 15458     IF PB-I-POLICY-ACCEPTED
 15459        IF PB-POLICY-IS-DECLINED  OR
 15460           PB-REISSUED-CERT  OR
 15461           PB-REIN-ONLY-CERT  OR
 15462           PB-POLICY-IS-VOIDED
 15463            MOVE  ER-1891         TO  WS-ERROR
 15464            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15465        ELSE
 15466            MOVE SPACE            TO  PB-BATCH-ENTRY
 15467            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15468
 15469     IF PB-I-POLICY-DECLINED
 15470        IF PB-REISSUED-CERT  OR
 15471           PB-REIN-ONLY-CERT  OR
 15472           PB-POLICY-IS-VOIDED
 15473            MOVE  ER-1906         TO  WS-ERROR
 15474            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15475        ELSE
 15476            MOVE  'D'             TO  PB-BATCH-ENTRY
 15477                                      PB-I-ENTRY-STATUS.
 15478
 15479     IF PB-I-NEEDS-UNDERWRITING
 15480        IF PB-POLICY-IS-DECLINED OR
 15481           PB-REISSUED-CERT  OR
 15482           PB-REIN-ONLY-CERT  OR
 15483           PB-POLICY-IS-VOIDED
 15484            MOVE  ER-1907         TO  WS-ERROR
 15485            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15486        ELSE
 15487            MOVE 'U'              TO  PB-BATCH-ENTRY
 15488                                      PB-I-ENTRY-STATUS.
 15489
 15490     IF PB-NEEDS-UNDERWRITING
 15491        MOVE  ER-1901             TO  WS-ERROR
 15492        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15493     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15494        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15495        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15496        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15497           AND (NOT WS-LF-CASH))
 15498                           OR
 15499           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15500           AND (NOT WS-AH-CASH)))
 15501                       AND
 15502           (PB-I-ENTRY-STATUS NOT = '5')
 15503           MOVE 'M'              TO PB-BATCH-ENTRY
 15504                                    PB-I-ENTRY-STATUS
 15505        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 280
* EL050.cbl
 15506     END-IF
 15507     move pending-business       to ws-passed-erpndb
 15508     move ' '                    to ws-exceed-limit-yn
 15509     perform 7780-call-agg       thru 7780-exit
 15510*    display ' el050 exceed ' ws-exceed-limit-yn
 15511     if ws-exceed-limit-yn = 'Y'
 15512        MOVE  ER-9813            TO WS-ERROR
 15513        move 'Y'                 to ws-9813-sw
 15514        PERFORM  9900-ERROR-FORMAT
 15515                                 THRU 9900-EXIT
 15516     end-if
 15517     if (PB-EXCEEDED-LIMIT-FORCED)
 15518        and (ws-9813-sw = 'Y')
 15519        subtract +1 from PB-NO-OF-ERRORS
 15520        move er-9823             to ws-error
 15521        PERFORM  9900-ERROR-FORMAT
 15522                                 THRU 9900-EXIT
 15523     end-if
 15524     IF  PB-COMPANY-ID NOT = 'NCL'
 15525         GO TO 3999-END-EDIT.
 15526
 15527     IF PB-REISSUED-CERT  OR
 15528        PB-POLICY-IS-DECLINED  OR
 15529        PB-POLICY-IS-VOIDED  OR
 15530        PB-I-OB
 15531         GO TO 3999-END-EDIT.
 15532
 15533     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15534         MOVE  ER-2644            TO  WS-ERROR
 15535         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15536         GO TO 3999-END-EDIT.
 15537
 15538     MOVE 'N'                     TO  FORM-MASTER-SW.
 15539     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15540
 15541     IF NOT FORM-MASTER-FOUND
 15542         GO TO 3999-END-EDIT.
 15543
 15544     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15545                                      FORM-MASTER-AH-SW.
 15546
 15547     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15548         MOVE  +1                 TO SUB6
 15549         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15550
 15551     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15552         MOVE  +1                 TO SUB6
 15553         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15554
 15555     IF LF-FORM-MASTER-FOUND  OR
 15556        AH-FORM-MASTER-FOUND
 15557         GO TO 3360-CHECK-FORM-LIMITS
 15558     ELSE
 15559         GO TO 3999-END-EDIT.
 15560
 15561******************************************************************
 15562*                  3350-GET-ERFORM                               *
 15563*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 281
* EL050.cbl
 15564*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15565******************************************************************
 15566
 15567 3350-GET-ERFORM.
 15568
 15569     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15570         GO TO  3350-ERFORM-GETMAIN.
 15571
 15572     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15573     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15574     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15575     MOVE 'Y'                     TO FORM-MASTER-SW.
 15576
 15577     IF PB-CANCELLATION
 15578         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15579            PB-SV-STATE          EQUAL   FO-STATE       AND
 15580            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15581              GO TO 3350-EXIT
 15582         ELSE
 15583             NEXT SENTENCE
 15584     ELSE
 15585         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15586            PB-SV-STATE          EQUAL   FO-STATE       AND
 15587            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15588              GO TO 3350-EXIT.
 15589
 15590 3350-ERFORM-GETMAIN.
 15591
 15592     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15593     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15594
 15595 3350-ERFORM-READ.
 15596
 15597     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15598     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15599     IF PB-CANCELLATION
 15600         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15601     ELSE
 15602         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15603     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15604
 15605     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15606
 15607     IF FORM-MASTER-FOUND
 15608       IF PB-CANCELLATION
 15609          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15610             PB-SV-STATE          EQUAL   FO-STATE       AND
 15611             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15612              GO  TO 3350-EXIT
 15613          ELSE
 15614              NEXT SENTENCE
 15615       ELSE
 15616          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15617             PB-SV-STATE          EQUAL   FO-STATE       AND
 15618             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15619              GO  TO 3350-EXIT.
 15620
 15621     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 282
* EL050.cbl
 15622     MOVE  ER-1895                TO  WS-ERROR.
 15623     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15624
 15625 3350-EXIT.
 15626      EXIT.
 15627
 15628******************************************************************
 15629*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15630*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15631*   VALID FOR THE POLICY FORM USED.                              *
 15632******************************************************************
 15633
 15634 3355-EDIT-FORM-LF-BENEFITS.
 15635
 15636     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15637        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15638         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15639         GO TO   3355-EXIT.
 15640
 15641     IF  SUB6    LESS THAN   +40
 15642         ADD  +1      TO  SUB6
 15643         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15644
 15645     MOVE  ER-1896         TO  WS-ERROR.
 15646     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15647
 15648 3355-EXIT.
 15649      EXIT.
 15650
 15651******************************************************************
 15652*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15653*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15654*   VALID FOR THE POLICY FORM USED.                              *
 15655******************************************************************
 15656
 15657 3356-EDIT-FORM-AH-BENEFITS.
 15658
 15659     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15660        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15661         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15662         GO TO  3356-EXIT.
 15663
 15664      IF  SUB6    LESS THAN     +40
 15665          ADD  +1      TO  SUB6
 15666          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15667
 15668     MOVE  ER-1897         TO  WS-ERROR.
 15669     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15670
 15671 3356-EXIT.
 15672      EXIT.
 15673
 15674******************************************************************
 15675*                  3357-BENEFIT-SEARCH                           *
 15676*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15677*   CANCELLATIONS ONLY.                                          *
 15678******************************************************************
 15679 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 283
* EL050.cbl
 15680     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15681         MOVE +1                          TO SUB6
 15682         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15683
 15684     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15685         MOVE +1                          TO SUB6
 15686         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15687
 15688 3357-EXIT.
 15689     EXIT.
 15690
 15691******************************************************************
 15692*                  3358-BENEFIT-LIFE-SEARCH                      *
 15693*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15694*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15695*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15696******************************************************************
 15697 3358-BENEFIT-LIFE-SEARCH.
 15698     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15699       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15700         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15701           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15702              IF FO-PLAN-REFUND-METHOD (SUB6)
 15703                     IS GREATER THAN SPACES
 15704                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15705                                          WS-LF-REFUND-CALC
 15706                 GO TO 3358-EXIT.
 15707
 15708     IF SUB6 LESS THAN +40
 15709         ADD +1                 TO SUB6
 15710         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15711
 15712 3358-EXIT.
 15713     EXIT.
 15714******************************************************************
 15715*                  3359-BENEFIT-AH-SEARCH                        *
 15716*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15717*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15718*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15719******************************************************************
 15720 3359-BENEFIT-AH-SEARCH.
 15721     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15722       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15723         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15724           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15725              IF FO-PLAN-REFUND-METHOD (SUB6)
 15726                      IS GREATER THAN SPACES
 15727                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15728                                          WS-AH-REFUND-CALC
 15729                 GO TO 3359-EXIT.
 15730
 15731     IF SUB6 LESS THAN +40
 15732         ADD +1                 TO SUB6
 15733         GO TO 3359-BENEFIT-AH-SEARCH.
 15734
 15735 3359-EXIT.
 15736     EXIT.
 15737
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 284
* EL050.cbl
 15738******************************************************************
 15739*                  3360-CHECK-FORM-LIMITS                        *
 15740*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15741*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15742******************************************************************
 15743
 15744 3360-CHECK-FORM-LIMITS.
 15745
 15746     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15747         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15748
 15749     IF NOT LF-FORM-MASTER-FOUND
 15750         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15751
 15752 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15753
 15754     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15755       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15756        WS-LF-JOINT-INDICATOR = 'J'  AND
 15757        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15758         IF PB-COMPANY-ID = 'NCL'
 15759            MOVE  ER-1911          TO  WS-ERROR
 15760            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15761         ELSE
 15762            MOVE  ER-1892          TO  WS-ERROR
 15763            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15764
 15765 3360-CHECK-FORM-LF-ATT-AGE.
 15766
 15767     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15768
 15769     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15770         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15771         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15772            IF PB-COMPANY-ID = 'NCL'
 15773                MOVE  ER-1913      TO  WS-ERROR
 15774                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15775            ELSE
 15776                MOVE  ER-1894      TO  WS-ERROR
 15777                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15778
 15779 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15780
 15781     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15782         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15783         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15784            IF PB-COMPANY-ID = 'NCL'
 15785                MOVE  ER-1914      TO  WS-ERROR
 15786                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15787            ELSE
 15788                MOVE  ER-1899      TO  WS-ERROR
 15789                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15790
 15791 3360-CHECK-FORM-LF-TERM-BAMT.
 15792
 15793     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15794         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15795         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 285
* EL050.cbl
 15796           IF  PB-COMPANY-ID = 'NCL'
 15797               MOVE  ER-1916       TO  WS-ERROR
 15798               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15799           ELSE
 15800               MOVE  ER-1902       TO  WS-ERROR
 15801               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15802
 15803     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15804                                    PB-I-LF-ALT-BENEFIT-AMT.
 15805
 15806     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15807         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15808         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15809             IF  PB-COMPANY-ID = 'NCL'
 15810                 MOVE  ER-1918     TO  WS-ERROR
 15811                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15812             ELSE
 15813                 MOVE  ER-1904     TO  WS-ERROR
 15814                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15815
 15816******************************************************************
 15817*                  3360-CHECK-FORM-AH-LIMITS                     *
 15818*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15819*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15820******************************************************************
 15821
 15822 3360-CHECK-FORM-AH-LIMITS.
 15823
 15824     IF NOT AH-FORM-MASTER-FOUND
 15825         GO TO 3999-END-EDIT.
 15826
 15827 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15828
 15829     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15830       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15831        WS-AH-JOINT-INDICATOR = 'J'  AND
 15832        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15833         IF PB-COMPANY-ID = 'NCL'
 15834            MOVE  ER-1912          TO  WS-ERROR
 15835            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15836         ELSE
 15837            MOVE  ER-1893          TO  WS-ERROR
 15838            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15839
 15840 3360-CHECK-FORM-AH-ATT-AGE.
 15841
 15842     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15843
 15844     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15845         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15846         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15847            IF PB-COMPANY-ID = 'NCL'
 15848                MOVE  ER-1913      TO  WS-ERROR
 15849                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15850            ELSE
 15851                MOVE  ER-1894      TO  WS-ERROR
 15852                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15853
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 286
* EL050.cbl
 15854 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15855
 15856     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15857         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15858         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15859            IF PB-COMPANY-ID = 'NCL'
 15860                MOVE  ER-1915      TO  WS-ERROR
 15861                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15862            ELSE
 15863                MOVE  ER-1900      TO  WS-ERROR
 15864                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15865
 15866 3360-CHECK-FORM-AH-TERM-BAMT.
 15867
 15868     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15869         FO-AH-MAX-TERM    GREATER THAN  +0
 15870         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15871             IF  PB-COMPANY-ID = 'NCL'
 15872                 MOVE  ER-1917     TO  WS-ERROR
 15873                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15874             ELSE
 15875                  MOVE  ER-1903    TO  WS-ERROR
 15876                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15877
 15878     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15879         FO-MAX-AH-AMT    GREATER THAN  +0
 15880         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15881             IF  PB-COMPANY-ID = 'NCL'
 15882                 MOVE  ER-1919     TO  WS-ERROR
 15883                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15884             ELSE
 15885                 MOVE  ER-1905     TO  WS-ERROR
 15886                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15887
 15888     GO TO 3999-END-EDIT.
 15889
 15890******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 287
* EL050.cbl
 15892 3400-edit-vin.
 15893
 15894     move spaces                 to hldi-pass-area
 15895     MOVE PB-I-VIN               TO WS-WORK-VIN
 15896     MOVE +8                     TO V2
 15897     MOVE ZEROS                  TO WS-VIN-TOTAL
 15898     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15899      (V1 > 17)
 15900        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15901           MOVE ER-3825          TO WS-ERROR
 15902           PERFORM 9900-ERROR-FORMAT
 15903                                 THRU 9900-EXIT
 15904        ELSE
 15905           IF V1 = 8
 15906              MOVE 10            TO V2
 15907           END-IF
 15908           IF V1 = 9
 15909              MOVE 0             TO V2
 15910           END-IF
 15911           IF V1 = 10
 15912              MOVE 9             TO V2
 15913           END-IF
 15914           IF WS-WORK-VIN (V1:1) NUMERIC
 15915              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15916               + (WS-WORK-VIN-N (V1) * V2)
 15917           ELSE
 15918              MOVE WS-WORK-VIN (V1:1)
 15919                            TO WS-HEX-BYTE
 15920              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15921              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15922               + (WS-NUM (V3) * V2)
 15923           END-IF
 15924           COMPUTE V2 = V2 - 1
 15925        END-IF
 15926     END-PERFORM
 15927     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15928     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15929        REMAINDER WS-VIN-REMAINDER
 15930     IF ((WS-WORK-VIN (9:1) = 'X')
 15931        AND (WS-VIN-REMAINDER = 10))
 15932                OR
 15933        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15934        if pb-company-id = 'VPP'
 15935           perform 3410-check-with-hldi
 15936                                 thru 3410-exit
 15937        end-if
 15938     ELSE
 15939        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15940           MOVE ER-3826          TO WS-ERROR
 15941           PERFORM 9900-ERROR-FORMAT
 15942                                 THRU 9900-EXIT
 15943        ELSE
 15944           MOVE ER-3827          TO WS-ERROR
 15945           PERFORM 9900-ERROR-FORMAT
 15946                                 THRU 9900-EXIT
 15947        END-IF
 15948     END-IF
 15949
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 288
* EL050.cbl
 15950     .
 15951 3400-exit.
 15952     exit.
 15953 3410-check-with-hldi.
 15954     move spaces                 to hldi-pass-area
 15955     move pb-i-vin               to pa-vin
 15956     perform 7785-call-hldi      thru 7785-exit
 15957*    display 'PA-VIN        ' PA-VIN
 15958*    display 'PA-ErrorCode  ' PA-ErrorCode
 15959*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15960*    display 'PA-ModelYear  ' PA-ModelYear
 15961*    display 'PA-MakeName   ' PA-MakeName
 15962*    display 'PA-ModelName  ' PA-ModelName
 15963*    display 'PA-SeriesName ' PA-SeriesName
 15964     if pa-errorcode (1:1) not = '0'
 15965        move spaces              to hldi-pass-area
 15966        move pb-i-vin            to pa-vin
 15967*       move pa-errordesc        to pa-seriesname
 15968*       perform 7786-call-hldim  thru 7786-exit
 15969*       display 'PA-VIN        ' PA-VIN
 15970*       display 'PA-ErrorCode  ' PA-ErrorCode
 15971*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15972*       display 'PA-ModelYear  ' PA-ModelYear
 15973*       display 'PA-MakeName   ' PA-MakeName
 15974*       display 'PA-ModelName  ' PA-ModelName
 15975*       display 'PA-SeriesName ' PA-SeriesName
 15976     end-if
 15977     .
 15978 3410-exit.
 15979     exit.
 15980******************************************************************
 15981*                  E D I T   C A N C E L                         *
 15982******************************************************************
 15983
 15984 3700-EDIT-CANCEL.
 15985     IF PB-COMPANY-ID = 'DMD'
 15986         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15987                                         WS-RES-MUNI-TAX
 15988                                         PB-CI-STATE-TAX
 15989                                         PB-CI-MUNI-TAX
 15990         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15991
 15992*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15993*       IF PB-ENTRY-BATCH  NUMERIC
 15994*          IF PB-CANCELLATION
 15995*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15996*          ELSE
 15997*             IF PB-ISSUE
 15998*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15999
 16000     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 16001        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 16002     END-IF
 16003*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16004*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16005
 16006     IF CM-ENTRY-STATUS = 'V'
 16007        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 289
* EL050.cbl
 16008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16009        GO TO 3999-END-EDIT.
 16010
 16011     IF CM-ENTRY-STATUS = 'D'
 16012        MOVE ER-2781             TO WS-ERROR
 16013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16014        GO TO 3999-END-EDIT.
 16015
 16016     IF CM-ENTRY-STATUS = 'U'
 16017        MOVE ER-2782             TO WS-ERROR
 16018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16019
 16020***************************************************************
 16021*                                                             *
 16022*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16023*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16024*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16025*   OF ANOTHER COVERAGE.                                      *
 16026*                                                             *
 16027***************************************************************
 16028
 16029     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16030                                    PB-C-AH-CANCEL-VOID-SW.
 16031
 16032     if pb-company-id = 'DCC' or 'VPP'
 16033        if ((pb-ci-lf-cancel-amt <> zeros)
 16034                       or
 16035            (pb-ci-ah-cancel-amt <> zeros))
 16036           MOVE ER-3068          TO WS-ERROR
 16037           PERFORM 9900-ERROR-FORMAT
 16038                                 THRU 9900-EXIT
 16039           GO TO 3999-END-EDIT
 16040        end-if
 16041     end-if
 16042     IF PB-C-LF-CANCEL-AMT = ZERO
 16043        NEXT SENTENCE
 16044     ELSE
 16045        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16046           AND
 16047           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16048               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16049               MOVE ER-2745           TO WS-ERROR
 16050               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16051
 16052     IF PB-C-AH-CANCEL-AMT = ZERO
 16053        NEXT SENTENCE
 16054     ELSE
 16055        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16056           AND
 16057           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16058               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16059               MOVE ER-2745           TO WS-ERROR
 16060               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16061
 16062     IF WS-LF-EARNINGS-CALC = '4'
 16063        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16064
 16065     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 290
* EL050.cbl
 16066     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16067     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16068     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16069     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16070     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16071
 16072     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16073                                      PB-C-AH-REF-CALC.
 16074     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16075
 16076******************************************************************
 16077*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16078*             TO VALIDATE COVERAGE.                              *
 16079******************************************************************
 16080
 16081     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16082        PB-C-LF-CANCEL-AMT = ZEROS
 16083          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16084      ELSE
 16085          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16086
 16087     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16088        PB-C-AH-CANCEL-AMT = ZEROS
 16089          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16090      ELSE
 16091          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16092
 16093     EVALUATE TRUE
 16094         WHEN PB-CANCEL-FORCE             OR
 16095              PB-CANCEL-DATE-FORCED       OR
 16096              PB-FORCE-OFF
 16097                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16098                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16099                  END-IF
 16100         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16101               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16102              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16103                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16104         WHEN OTHER
 16105              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16106                 MOVE ER-2794              TO WS-ERROR
 16107              ELSE
 16108                 MOVE ER-2749              TO WS-ERROR
 16109              END-IF
 16110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16111     END-EVALUATE.
 16112
 16113
 16114*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16115*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16116*            MOVE  ER-1909            TO  WS-ERROR
 16117*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16118*        ELSE
 16119*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16120
 16121     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16122     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16123        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 291
* EL050.cbl
 16124     ELSE
 16125        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16126     END-IF
 16127     .
 16128 3705-EDIT-CANCEL-DT.
 16129
 16130     IF LF-COVERAGE-CANCELLED
 16131        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16132         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16133         MOVE WS-CURRENT-MONTH-END
 16134                                 TO DC-BIN-DATE-2
 16135         SET ELAPSED-BETWEEN-BIN TO TRUE
 16136*        MOVE 1                  TO DC-OPTION-CODE
 16137         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16138         IF DATE-CONVERSION-ERROR
 16139            NEXT SENTENCE
 16140          ELSE
 16141             IF DC-ELAPSED-DAYS GREATER +180
 16142                IF PB-CANCEL-DATE-FORCED  OR
 16143                   PB-CANCEL-DATE-FORCED-NO-FEE
 16144                      MOVE ER-2751  TO WS-ERROR
 16145                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16146                 ELSE
 16147                   MOVE ER-2752  TO WS-ERROR
 16148                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16149
 16150     IF AH-COVERAGE-CANCELLED
 16151        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16152         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16153         MOVE WS-CURRENT-MONTH-END
 16154                                 TO DC-BIN-DATE-2
 16155         SET ELAPSED-BETWEEN-BIN TO TRUE
 16156*        MOVE 1                  TO DC-OPTION-CODE
 16157         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16158         IF DATE-CONVERSION-ERROR
 16159            NEXT SENTENCE
 16160          ELSE
 16161             IF DC-ELAPSED-DAYS GREATER +180
 16162                IF PB-CANCEL-DATE-FORCED OR
 16163                   PB-CANCEL-DATE-FORCED-NO-FEE
 16164                      MOVE ER-2751  TO WS-ERROR
 16165                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16166                 ELSE
 16167                   MOVE ER-2752  TO WS-ERROR
 16168                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16169
 16170     IF WS-ERROR = ER-2752
 16171        AND (PB-COMPANY-ID = 'ABL'
 16172         OR  PB-COMPANY-ID = 'FGL'
 16173         OR  PB-COMPANY-ID = 'IST'
 16174         OR  PB-COMPANY-ID = 'JHL'
 16175         OR  PB-COMPANY-ID = 'LAP'
 16176         OR  PB-COMPANY-ID = 'LBL'
 16177         OR  PB-COMPANY-ID = 'NCB'
 16178         OR  PB-COMPANY-ID = 'NLI'
 16179         OR  PB-COMPANY-ID = 'OFI'
 16180         OR  PB-COMPANY-ID = 'PLI'
 16181         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 292
* EL050.cbl
 16182         OR  PB-COMPANY-ID = 'TIC'
 16183         OR  PB-COMPANY-ID = 'HER'
 16184         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16185         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16186            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16187            MOVE ER-2762     TO WS-ERROR
 16188            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16189
 16190     IF LF-COVERAGE-CANCELLED
 16191        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16192        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16193             MOVE ER-2733         TO WS-ERROR
 16194             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16195
 16196     IF AH-COVERAGE-CANCELLED
 16197        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16198        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16199              MOVE ER-2733        TO WS-ERROR
 16200              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16201
 16202     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16203        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16204        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16205           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16206            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16207              IF PB-COMPANY-ID NOT = 'LAP'
 16208               MOVE ER-2704            TO WS-ERROR
 16209               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16210
 16211     IF CERT-WAS-NOT-FOUND
 16212         GO TO 3999-END-EDIT.
 16213
 16214     IF PB-COMPANY-ID EQUAL 'CDC'
 16215        IF LF-COVERAGE-CANCELLED
 16216           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16217            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16218            MOVE PB-C-LF-CANCEL-DT
 16219                                 TO DC-BIN-DATE-2
 16220            SET ELAPSED-BETWEEN-BIN TO TRUE
 16221*           MOVE 1               TO DC-OPTION-CODE
 16222            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16223            IF DATE-CONVERSION-ERROR
 16224               NEXT SENTENCE
 16225             ELSE
 16226                IF DC-ELAPSED-DAYS GREATER +60
 16227                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16228
 16229     IF PB-COMPANY-ID EQUAL 'CDC'
 16230        IF AH-COVERAGE-CANCELLED
 16231           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16232            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16233            MOVE PB-C-AH-CANCEL-DT
 16234                                 TO DC-BIN-DATE-2
 16235            MOVE +0              TO DC-ELAPSED-DAYS
 16236                                    DC-ELAPSED-MONTHS
 16237            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16238*           MOVE 1               TO DC-OPTION-CODE
 16239            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 293
* EL050.cbl
 16240            IF DATE-CONVERSION-ERROR
 16241               NEXT SENTENCE
 16242             ELSE
 16243                IF DC-ELAPSED-DAYS GREATER +60
 16244                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16245
 16246     MOVE +0                     TO DC-ELAPSED-DAYS
 16247                                    DC-ELAPSED-MONTHS.
 16248
 16249     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16250        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16251          MOVE 'Z'                TO PB-CI-OB-FLAG
 16252          MOVE ER-2767            TO WS-ERROR
 16253          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16254          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16255          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16256          GO TO 3775-OVER-REF-CHK
 16257        ELSE
 16258          MOVE ZEROS              TO PB-CI-LIVES
 16259                                     PB-C-LIVES
 16260          IF PB-CI-OB-FLAG NOT = 'B'
 16261             MOVE SPACE           TO PB-CI-OB-FLAG.
 16262
 16263     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16264         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16265     ELSE
 16266         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16267
 16268     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16269        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16270            MOVE ER-2760         TO WS-ERROR
 16271            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16272
 16273     IF LF-COVERAGE-CANCELLED
 16274        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16275         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16276            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16277               MOVE ER-2774       TO WS-ERROR
 16278               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16279
 16280     IF AH-COVERAGE-CANCELLED
 16281        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16282         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16283            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16284               MOVE ER-2775       TO WS-ERROR
 16285               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16286
 16287     IF LF-COVERAGE-CANCELLED
 16288        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16289         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16290            MOVE ER-2776         TO WS-ERROR
 16291            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16292
 16293     IF AH-COVERAGE-CANCELLED
 16294        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16295         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16296            MOVE ER-2777         TO WS-ERROR
 16297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 294
* EL050.cbl
 16298
 16299     IF LF-COVERAGE-CANCELLED
 16300        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16301        if pb-ci-lf-expire-dt = low-values or spaces
 16302           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16303           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16304           MOVE PB-CI-EXTENTION-DAYS
 16305                                 TO DC-ELAPSED-DAYS
 16306           SET BIN-PLUS-ELAPSED  TO TRUE
 16307           PERFORM 8500-DATE-CONVERT
 16308                                 THRU 8500-EXIT
 16309           IF DATE-CONVERSION-ERROR
 16310              move low-values    to dc-bin-date-2
 16311           end-if
 16312        else
 16313           move pb-ci-lf-expire-dt
 16314                                 to dc-bin-date-2
 16315        end-if
 16316        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16317           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16318                             OR  'FIA'
 16319              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16320           ELSE
 16321              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16322              MOVE ER-2731       TO WS-ERROR
 16323              PERFORM 9900-ERROR-FORMAT
 16324                                 THRU 9900-EXIT
 16325           end-if
 16326        end-if
 16327     end-if
 16328*    IF LF-COVERAGE-CANCELLED
 16329*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16330*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16331*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16332*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16333*        SET BIN-PLUS-ELAPSED      TO TRUE
 16334*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16335*        IF DATE-CONVERSION-ERROR
 16336*           NEXT SENTENCE
 16337*         ELSE
 16338*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16339*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16340*                            OR  'FIA'
 16341*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16342*              ELSE
 16343*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16344*               MOVE ER-2731       TO WS-ERROR
 16345*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16346     .
 16347 3705-EDIT-AH-CANCEL-DT.
 16348     IF AH-COVERAGE-CANCELLED
 16349        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16350        if pb-ci-AH-expire-dt = low-values or spaces
 16351           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16352           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16353           MOVE PB-CI-EXTENTION-DAYS
 16354                                 TO DC-ELAPSED-DAYS
 16355           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 295
* EL050.cbl
 16356           PERFORM 8500-DATE-CONVERT
 16357                                 THRU 8500-EXIT
 16358           IF DATE-CONVERSION-ERROR
 16359              move low-values    to dc-bin-date-2
 16360           end-if
 16361        else
 16362           move pb-ci-ah-expire-dt
 16363                                 to dc-bin-date-2
 16364        end-if
 16365        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16366           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16367                             OR  'FIA'
 16368              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16369           ELSE
 16370              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16371              MOVE ER-2771       TO WS-ERROR
 16372              PERFORM 9900-ERROR-FORMAT
 16373                                 THRU 9900-EXIT
 16374           end-if
 16375        end-if
 16376     end-if
 16377*    IF AH-COVERAGE-CANCELLED
 16378*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16379*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16380*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16381*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16382**       MOVE 6                    TO DC-OPTION-CODE
 16383*        SET BIN-PLUS-ELAPSED      TO TRUE
 16384*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16385*        IF DATE-CONVERSION-ERROR
 16386*           NEXT SENTENCE
 16387*         ELSE
 16388*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16389*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16390*                             OR 'FIA'
 16391*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16392*             ELSE
 16393*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16394*              MOVE ER-2771       TO WS-ERROR
 16395*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16396     .
 16397 3705-EDIT-CONTINUED.
 16398
 16399*    IF LF-COVERAGE-CANCELLED
 16400*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16401*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16402*            MOVE ER-2727         TO WS-ERROR
 16403*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16404*
 16405*    IF AH-COVERAGE-CANCELLED
 16406*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16407*        IF PB-COMPANY-ID = 'ACE'
 16408*           MOVE ER-2727        TO WS-ERROR
 16409*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16410*        ELSE
 16411*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16412*              MOVE ER-2727     TO WS-ERROR
 16413*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 296
* EL050.cbl
 16414
 16415     IF PB-COMPANY-ID = 'ACE'
 16416       IF AH-COVERAGE-CANCELLED
 16417         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16418           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16419              MOVE ER-2732      TO WS-ERROR
 16420              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16421
 16422     IF PB-COMPANY-ID      EQUAL   'HER'
 16423        IF WS-ERROR        EQUAL   ER-2727
 16424            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16425            MOVE  ER-2725          TO  WS-ERROR
 16426            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16427
 16428     IF PB-C-CLAIM-CREATED-CANCEL
 16429            MOVE ER-2748         TO WS-ERROR
 16430            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16431
 16432     IF PB-C-LAST-NAME NOT = SPACES
 16433         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16434            MOVE ER-2747         TO WS-ERROR
 16435            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16436
 16437 3710-EDIT-LUMP-SUM-PRIOR.
 16438
 16439     IF AH-COVERAGE-CANCELLED
 16440         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16441             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16442                MOVE ER-2735    TO WS-ERROR
 16443                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16444
 16445     IF LF-COVERAGE-CANCELLED
 16446         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16447             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16448                MOVE ER-2735    TO WS-ERROR
 16449                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16450
 16451 3710-EDIT-PRIOR-DEATH.
 16452
 16453*    IF LF-COVERAGE-CANCELLED
 16454*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16455*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16456*           (NOT PB-CI-OB)
 16457*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16458*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16459*                   MOVE ER-2732  TO WS-ERROR
 16460*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16461*
 16462*    IF AH-COVERAGE-CANCELLED
 16463*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16464*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16465*           (NOT PB-CI-OB)
 16466*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16467*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16468*                   MOVE ER-2732  TO WS-ERROR
 16469*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16470
 16471     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 297
* EL050.cbl
 16472         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16473            (NOT PB-COMP-LF-CANCEL)
 16474             NEXT SENTENCE
 16475         ELSE
 16476           IF PB-C-LF-CANCEL-VOIDED
 16477              NEXT SENTENCE
 16478           ELSE
 16479              MOVE ER-2753      TO WS-ERROR
 16480              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16481
 16482     IF CANCEL-FUTURE-DT
 16483         GO TO 3999-END-EDIT.
 16484
 16485 3715-GET-REMAIN-TERM-LF.
 16486
 16487     IF NO-LF-BENEFIT-MATCH  OR
 16488        WS-LF-BENEFIT-CD = ZEROS
 16489        GO TO 3730-GET-AH-REMAIN-TERM.
 16490
 16491     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16492     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16493     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16494     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16495     MOVE PB-SV-STATE            TO CP-STATE.
 16496     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16497     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16498     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16499     MOVE '2'                    TO CP-PROCESS-TYPE.
 16500     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16501     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16502     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16503     IF (PB-COMPANY-ID = 'CID')
 16504        AND (CP-STATE-STD-ABBRV = 'WI')
 16505        MOVE '7'                 TO CP-REM-TERM-METHOD
 16506        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16507     ELSE
 16508        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16509        MOVE WS-REM-TRM-CALC-OPTION
 16510                                 TO CP-REM-TRM-CALC-OPTION
 16511     END-IF
 16512**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16513     IF (PB-COMPANY-ID = 'CID')
 16514        AND (CP-STATE-STD-ABBRV = 'MO')
 16515        AND (PB-CERT-EFF-DT >= X'9B41')
 16516        AND (PB-CERT-EFF-DT <= X'A2FB')
 16517        MOVE '7'                 TO CP-REM-TERM-METHOD
 16518        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16519     END-IF
 16520     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16521                                    CP-LOAN-TERM.
 16522     IF CP-TRUNCATED-LIFE
 16523        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16524
 16525     IF CP-TERM-IS-DAYS
 16526         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16527     ELSE
 16528         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16529
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 298
* EL050.cbl
 16530     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16531
 16532     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16533
 16534     IF LF-COVERAGE-CANCELLED
 16535        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16536        NEXT SENTENCE
 16537      ELSE
 16538          GO TO 3730-GET-AH-REMAIN-TERM.
 16539
 16540 3720-GET-LF-REFUND.
 16541
 16542     IF PB-C-LF-CANCEL-VOIDED
 16543        GO TO 3730-GET-AH-REMAIN-TERM
 16544     end-if
 16545
 16546     IF PB-COMPANY-ID EQUAL 'BOA'
 16547         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16548         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16549         GO TO 3730-GET-AH-REMAIN-TERM.
 16550
 16551     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16552        (WS-AH-SPECIAL-CALC-CD = 'M')
 16553         MOVE ER-2767            TO WS-ERROR
 16554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16555         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16556         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16557         GO TO 3780-UPDATE-CANCEL-CERT.
 16558
 16559*    if (ws-lf-earnings-calc = '6')
 16560*       or (pb-c-lf-refund-override = '6')
 16561*       move cp-remaining-term-1 to cp-remaining-term-2
 16562*    end-if
 16563     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16564
 16565     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16566     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16567     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16568     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16569     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16570     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16571     IF PB-COMPANY-ID = 'DCC'
 16572        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16573        IF PDEF-MASTER-FOUND
 16574           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16575              (V1 > +8)
 16576              OR (PD-PROD-CODE (V1) = 'L')
 16577           END-PERFORM
 16578           IF V1 < +9
 16579              MOVE PD-MAX-AMT (V1)
 16580                           TO CP-R-MAX-TOT-BEN
 16581                              EC-AM-LF-MAX-TOT-BEN
 16582           END-IF
 16583        ELSE
 16584        MOVE ' '                 TO PDEF-MASTER-SW
 16585        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16586        MOVE PB-STATE            TO ERPDEF-STATE
 16587        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 299
* EL050.cbl
 16588           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16589        END-IF
 16590        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16591        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16592        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16593        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16594        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16595        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16596        IF PDEF-MASTER-FOUND
 16597           MOVE 'N'              TO PDEF-MASTER-SW
 16598           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16599           IF PDEF-MASTER-FOUND
 16600              IF (ERPDEF-KEY-SAVE (1:16) =
 16601                           PD-CONTROL-PRIMARY (1:16))
 16602                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16603                 CONTINUE
 16604              ELSE
 16605                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16606                 IF (ERPDEF-KEY-SAVE (1:16) =
 16607                           PD-CONTROL-PRIMARY (1:16))
 16608                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16609                    CONTINUE
 16610                 ELSE
 16611                    MOVE 'N'     TO PDEF-MASTER-SW
 16612                 END-IF
 16613              END-IF
 16614
 16615              IF PDEF-MASTER-FOUND
 16616                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16617                    (V1 > +8)
 16618                    OR (PD-PROD-CODE (V1) = 'L')
 16619                 END-PERFORM
 16620                 IF V1 < +9
 16621                    MOVE PD-MAX-AMT (V1)
 16622                                 TO CP-R-MAX-TOT-BEN
 16623                                    EC-AM-LF-MAX-TOT-BEN
 16624                 END-IF
 16625              END-IF
 16626           END-IF
 16627           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16628        END-IF
 16629        END-IF
 16630     END-IF
 16631     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16632
 16633     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16634
 16635     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16636                                    PB-C-LF-REM-TERM.
 16637
 16638     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16639     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16640
 16641     IF PB-COMPANY-ID EQUAL 'FLC'
 16642        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16643           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16644           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16645                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 300
* EL050.cbl
 16646                    - CM-LF-ITD-DEATH-AMT
 16647           IF PB-C-LF-REF-CALC LESS THAN +0
 16648              MOVE +0            TO PB-C-LF-REF-CALC
 16649              GO TO 3730-GET-AH-REMAIN-TERM
 16650           ELSE
 16651              GO TO 3730-GET-AH-REMAIN-TERM.
 16652
 16653     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16654                            OR '4' OR '5' OR '6' OR '8'
 16655                            OR '9' OR 'G'
 16656        MOVE PB-C-LF-REFUND-OVERRIDE
 16657                                 TO CP-EARNING-METHOD.
 16658
 16659     if pb-company-id = 'AHL'
 16660        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16661        if cp-class-code = spaces
 16662           move zeros            to cp-class-code
 16663        end-if
 16664     ELSE
 16665        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16666     END-IF
 16667*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16668     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16669     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16670                                    CP-RATING-BENEFIT-AMT.
 16671     IF CP-STATE-STD-ABBRV = 'OR'
 16672         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16673                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16674     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16675     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16676     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16677     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16678     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16679     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16680     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16681     IF WS-DEFAULT-APR NOT NUMERIC
 16682         MOVE ZEROS TO WS-DEFAULT-APR.
 16683****   N O T E   ****
 16684*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16685*      THE OH HARD CODING IN ELCRFNDP
 16686
 16687     IF PB-COMPANY-ID = 'CID'
 16688        IF CP-STATE-STD-ABBRV = 'OH'
 16689           MOVE WS-LF-EARNINGS-CALC
 16690                                 TO CP-EARNING-METHOD
 16691        END-IF
 16692     END-IF
 16693
 16694****   N O T E   ****
 16695
 16696*    IF CP-EARN-AS-NET-PAY
 16697*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16698*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16699*               MOVE WS-DEFAULT-APR
 16700*                                TO  CP-LOAN-APR
 16701*               MOVE ER-3780     TO  WS-ERROR
 16702*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16703*           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 301
* EL050.cbl
 16704*               MOVE ER-3781     TO  WS-ERROR
 16705*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16706*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16707     move ' '                    to cp-ext-days-calc
 16708     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16709
 16710     IF CP-REFUND-TYPE-USED NOT = SPACE
 16711         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16712
 16713     IF CP-ERROR-RATE-IS-ZERO OR
 16714        CP-ERROR-RATE-NOT-FOUND
 16715        MOVE ER-2740             TO WS-ERROR
 16716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16717
 16718     IF CP-ERROR-RATE-FILE-NOTOPEN
 16719        MOVE ER-2617             TO WS-ERROR
 16720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16721
 16722     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16723        AND PB-CI-ENTRY-STATUS = 'M'
 16724        MOVE +0                  TO PB-C-LF-REF-CALC
 16725     ELSE
 16726        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16727     END-IF
 16728
 16729     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16730         GO TO 3730-GET-AH-REMAIN-TERM.
 16731
 16732*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16733*       ADD +1                   TO PB-C-LF-REM-TERM
 16734*                                   CP-REMAINING-TERM
 16735*                                   CP-ORIGINAL-TERM.
 16736
 16737     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16738     MOVE '2'                    TO CP-EARNING-METHOD
 16739                                    CP-RATING-METHOD.
 16740     IF PB-COMPANY-ID = 'CID'
 16741        IF (CP-STATE-STD-ABBRV = 'MN')
 16742           AND (PB-CERT-EFF-DT > X'A4FF')
 16743           AND (WS-LF-EARNINGS-CALC = 'B')
 16744           MOVE '5'              TO CP-EARNING-METHOD
 16745           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16746        END-IF
 16747     END-IF
 16748     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16749                                        CP-REMAINING-BENEFIT
 16750                                        CP-RATING-BENEFIT-AMT.
 16751     IF CP-STATE-STD-ABBRV = 'OR'
 16752         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16753                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16754     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16755     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16756
 16757     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16758
 16759     IF CP-ERROR-RATE-IS-ZERO OR
 16760        CP-ERROR-RATE-NOT-FOUND
 16761        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 302
* EL050.cbl
 16762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16763
 16764     IF CP-ERROR-RATE-FILE-NOTOPEN
 16765        MOVE ER-2617             TO WS-ERROR
 16766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16767
 16768     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16769
 16770******************************************************************
 16771
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 303
* EL050.cbl
 16773 3730-GET-AH-REMAIN-TERM.
 16774     IF NO-AH-BENEFIT-MATCH  OR
 16775        WS-AH-BENEFIT-CD = ZEROS
 16776         GO TO 3770-CHECK-REFUNDS.
 16777
 16778     IF PB-CI-AH-LUMP-SUM-DISAB
 16779         IF  PB-C-AH-CANCEL-AMT = ZERO
 16780            IF NOT PB-COMP-AH-CANCEL
 16781             GO TO 3770-CHECK-REFUNDS.
 16782
 16783     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16784     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16785     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16786     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16787     MOVE PB-SV-STATE            TO CP-STATE.
 16788     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16789     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16790     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16791     MOVE '2'                    TO CP-PROCESS-TYPE.
 16792     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16793     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16794     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16795     IF (PB-COMPANY-ID = 'CID')
 16796        AND (CP-STATE-STD-ABBRV = 'WI')
 16797        MOVE '7'                 TO CP-REM-TERM-METHOD
 16798        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16799     ELSE
 16800        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16801        MOVE WS-REM-TRM-CALC-OPTION
 16802                                 TO CP-REM-TRM-CALC-OPTION
 16803     END-IF
 16804     IF (PB-COMPANY-ID = 'CID')
 16805        AND (CP-STATE-STD-ABBRV = 'MO')
 16806        AND (PB-CERT-EFF-DT >= X'9B41')
 16807        AND (PB-CERT-EFF-DT <= X'A2FB')
 16808        MOVE '7'                 TO CP-REM-TERM-METHOD
 16809        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16810     END-IF
 16811     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16812                                    CP-LOAN-TERM.
 16813     IF NOT CP-TERM-IS-DAYS
 16814         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16815
 16816     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16817
 16818     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16819
 16820     IF AH-COVERAGE-CANCELLED
 16821        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16822        NEXT SENTENCE
 16823      ELSE
 16824         GO TO 3770-CHECK-REFUNDS.
 16825
 16826 3740-GET-AH-REFUND.
 16827
 16828     IF PB-C-AH-CANCEL-VOIDED
 16829        GO TO 3780-UPDATE-CANCEL-CERT
 16830     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 304
* EL050.cbl
 16831
 16832     IF PB-COMPANY-ID = 'BOA'
 16833         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16834         GO TO 3770-CHECK-REFUNDS.
 16835
 16836     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16837*    MOVE ' '                    TO DC-OPTION-CODE
 16838     SET BIN-TO-GREG             TO TRUE
 16839     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16840     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16841                                    PB-C-AH-REM-TERM.
 16842     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16843     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16844
 16845     IF PB-COMPANY-ID EQUAL 'FLC'
 16846        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16847           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16848           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16849                    - CM-AH-ITD-AH-PMT)
 16850           IF PB-C-AH-REF-CALC LESS THAN +0
 16851              MOVE +0            TO PB-C-AH-REF-CALC
 16852              GO TO 3770-CHECK-REFUNDS
 16853           ELSE
 16854              GO TO 3770-CHECK-REFUNDS.
 16855
 16856     IF PB-COMPANY-ID = 'DCC'
 16857        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16858            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16859           MOVE 'S'              TO CP-EARNING-METHOD
 16860        END-IF
 16861     END-IF
 16862     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16863                            OR '4' OR '5' OR '6' OR '8'
 16864                            OR '9' OR 'G' OR 'S'
 16865        MOVE PB-C-AH-REFUND-OVERRIDE
 16866                                 TO CP-EARNING-METHOD.
 16867
 16868     if pb-company-id = 'AHL'
 16869        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16870        if cp-class-code = spaces
 16871           move zeros            to cp-class-code
 16872        end-if
 16873     ELSE
 16874        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16875     END-IF
 16876*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16877     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16878     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16879                                    CP-RATING-BENEFIT-AMT.
 16880     IF CP-STATE-STD-ABBRV = 'OR'
 16881         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16882                                         PB-CI-AH-TERM.
 16883     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16884     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16885     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16886     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16887     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16888     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 305
* EL050.cbl
 16889
 16890     IF CP-STATE-STD-ABBRV = 'OH'
 16891        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16892                                AND 'CID' AND 'DCC' and 'VPP'
 16893                                AND 'AHL')
 16894           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16895              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16896              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16897              MOVE '6' TO CP-EARNING-METHOD
 16898           END-IF
 16899        END-IF
 16900        IF PB-COMPANY-ID = 'CID'
 16901           IF NO-LIFE-COVERAGE
 16902              IF CP-CRITICAL-PERIOD
 16903                 MOVE '2'       TO CP-EARNING-METHOD
 16904              ELSE
 16905                 MOVE '6'       TO CP-EARNING-METHOD
 16906              END-IF
 16907           ELSE
 16908              IF WS-LF-COVERAGE-TYPE = 'L'
 16909                 MOVE '2'       TO CP-EARNING-METHOD
 16910              ELSE
 16911                 IF (PB-CI-LF-TERM > +60) OR
 16912                    (WS-LF-EARNINGS-CALC = '5')
 16913                    IF CP-CRITICAL-PERIOD
 16914                       MOVE '2'  TO CP-EARNING-METHOD
 16915                    ELSE
 16916                       MOVE '6'  TO CP-EARNING-METHOD
 16917                    END-IF
 16918                 ELSE
 16919                    MOVE '1'     TO CP-EARNING-METHOD
 16920                 END-IF
 16921              END-IF
 16922           END-IF
 16923        END-IF
 16924     END-IF
 16925
 16926*    IF CP-STATE-STD-ABBRV = 'VA'
 16927*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16928*          IF CP-ORIGINAL-TERM GREATER 61
 16929*             MOVE '6' TO CP-EARNING-METHOD
 16930*          ELSE
 16931*             MOVE '1' TO CP-EARNING-METHOD.
 16932
 16933     IF WS-DEFAULT-APR NOT NUMERIC
 16934         MOVE ZEROS TO WS-DEFAULT-APR.
 16935     IF CP-EARN-AS-NET-PAY
 16936         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16937            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16938                MOVE WS-DEFAULT-APR
 16939                                 TO  CP-LOAN-APR
 16940                MOVE ER-3780     TO  WS-ERROR
 16941                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16942            ELSE
 16943                MOVE ER-3781     TO  WS-ERROR
 16944                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16945     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16946     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 306
* EL050.cbl
 16947        AND CP-CANCEL-REASON = 'R'
 16948        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16949        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16950     END-IF
 16951     IF PB-COMPANY-ID = 'DCC'
 16952        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16953        AND (CP-EARNING-METHOD = 'D')
 16954        AND (CP-CANCEL-REASON NOT = 'R')
 16955        CONTINUE
 16956     ELSE
 16957        GO TO 3750-CONTINUE
 16958     END-IF
 16959     MOVE ' '                    TO DD-IU-SW
 16960     IF NOT PDEF-MASTER-FOUND
 16961        MOVE ' '                 TO PDEF-MASTER-SW
 16962        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16963        MOVE PB-STATE            TO ERPDEF-STATE
 16964        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16965           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16966        END-IF
 16967        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16968        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16969        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16970        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16971        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16972        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16973        IF PDEF-MASTER-FOUND
 16974           MOVE 'N'              TO PDEF-MASTER-SW
 16975           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16976           IF PDEF-MASTER-FOUND
 16977              IF (ERPDEF-KEY-SAVE (1:16) =
 16978                           PD-CONTROL-PRIMARY (1:16))
 16979                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16980                 CONTINUE
 16981              ELSE
 16982                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16983                 IF (ERPDEF-KEY-SAVE (1:16) =
 16984                           PD-CONTROL-PRIMARY (1:16))
 16985                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16986                    CONTINUE
 16987                 ELSE
 16988                    MOVE ER-2740 TO WS-ERROR
 16989                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16990                    GO TO 3770-CHECK-REFUNDS
 16991                 END-IF
 16992              END-IF
 16993           END-IF
 16994           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16995        END-IF
 16996     END-IF
 16997     IF PDEF-MASTER-FOUND
 16998        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16999           (V1 > +8)
 17000           OR (PD-PROD-CODE (V1) = 'I')
 17001        END-PERFORM
 17002        IF V1 < +9
 17003           SET DD-IU-PRESENT        TO TRUE
 17004        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 307
* EL050.cbl
 17005        IF WS-AH-DCC-TRUNC = 'T'
 17006           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17007        ELSE
 17008           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17009        END-IF
 17010        EVALUATE TRUE
 17011           WHEN WS-TERM > +168
 17012              MOVE 15               TO V1
 17013           WHEN WS-TERM > +156
 17014              MOVE 14               TO V1
 17015           WHEN WS-TERM > +144
 17016              MOVE 13               TO V1
 17017           WHEN WS-TERM > +132
 17018              MOVE 12               TO V1
 17019           WHEN WS-TERM > +120
 17020              MOVE 11               TO V1
 17021           WHEN WS-TERM > +108
 17022              MOVE 10               TO V1
 17023           WHEN WS-TERM > +96
 17024              MOVE 9                TO V1
 17025           WHEN WS-TERM > +84
 17026              MOVE 8                TO V1
 17027           WHEN WS-TERM > +72
 17028              MOVE 7                TO V1
 17029           WHEN WS-TERM > +60
 17030              MOVE 6                TO V1
 17031           WHEN WS-TERM > +48
 17032              MOVE 5                TO V1
 17033           WHEN WS-TERM > +36
 17034              MOVE 4                TO V1
 17035           WHEN WS-TERM > +24
 17036              MOVE 3                TO V1
 17037           WHEN WS-TERM > +12
 17038              MOVE 2                TO V1
 17039           WHEN OTHER
 17040              MOVE 1                TO V1
 17041        END-EVALUATE
 17042
 17043        EVALUATE TRUE
 17044*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17045*             < +13)
 17046*             AND (DD-IU-PRESENT)
 17047*             MOVE 2                TO V2
 17048*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17049*             MOVE 1                TO V2
 17050           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17051              MOVE 2                TO V2
 17052           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17053              MOVE 3                TO V2
 17054           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17055              MOVE 4                TO V2
 17056           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17057              MOVE 5                TO V2
 17058           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17059              MOVE 6                TO V2
 17060           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17061              MOVE 7                TO V2
 17062           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 308
* EL050.cbl
 17063              MOVE 8                TO V2
 17064           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17065              MOVE 9                TO V2
 17066           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17067              MOVE 10               TO V2
 17068           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17069              MOVE 11               TO V2
 17070           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17071              MOVE 12               TO V2
 17072           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17073              MOVE 13               TO V2
 17074           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17075              MOVE 14               TO V2
 17076           WHEN OTHER
 17077              MOVE 15               TO V2
 17078        END-EVALUATE
 17079
 17080        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17081                                 TO CP-DDF-LO-FACT
 17082        MOVE PD-UEP-FACTOR (V1 V2)
 17083                                 TO CP-DDF-HI-FACT
 17084
 17085        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17086        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17087        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17088           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17089        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17090        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17091        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17092           + PD-1ST-YR-ADMIN-ALLOW
 17093
 17094        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17095*       IF PI-CLP-YN = 'Y'
 17096*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17097*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17098*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17099*       END-IF
 17100
 17101        IF DD-IU-PRESENT
 17102           MOVE 'I'              TO CP-EARNING-METHOD
 17103        END-IF
 17104        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17105                                     CP-CLP-RATE-UP
 17106        IF CP-IU-RATE-UP NOT = ZEROS
 17107           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17108              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17109           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17110              / (1 - WS-WORK-FACT)
 17111        END-IF
 17112     END-IF
 17113     .
 17114 3750-CONTINUE.
 17115     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17116
 17117     IF CP-REFUND-TYPE-USED NOT = SPACE
 17118         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17119
 17120     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 309
* EL050.cbl
 17121        CP-ERROR-RATE-NOT-FOUND
 17122        MOVE ER-2740             TO WS-ERROR
 17123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17124
 17125     IF CP-ERROR-RATE-FILE-NOTOPEN
 17126        MOVE ER-2617             TO WS-ERROR
 17127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17128     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17129        AND (PB-CI-ENTRY-STATUS = 'M')
 17130        MOVE +0                  TO PB-C-AH-REF-CALC
 17131     ELSE
 17132        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17133     END-IF
 17134     if pb-company-id = 'VPP'
 17135        MOVE cm-ah-clp           to cp-original-premium
 17136        move zeros               to cp-calc-refund
 17137        perform 7600-get-refund  thru 7600-exit
 17138        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17139           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17140        else
 17141           move zeros            to pb-c-ah-rfnd-clp
 17142        end-if
 17143        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17144           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17145           pb-ci-cancel-fee
 17146     end-if
 17147     IF PB-COMPANY-ID = 'DCC'
 17148        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17149        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17150        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17151        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17152        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17153        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17154        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17155        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17156*       if pb-c-cancel-amt < +0
 17157*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17158*       end-if
 17159*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17160     END-IF
 17161     .
 17162 3770-CHECK-REFUNDS.
 17163
 17164     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17165        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17166           MOVE ER-2766          TO WS-ERROR
 17167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17168           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17169           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17170              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17171
 17172     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17173        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17174           MOVE ER-2766          TO WS-ERROR
 17175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17176           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17177           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17178              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 310
* EL050.cbl
 17179
 17180     IF PB-COMP-LF-CANCEL
 17181        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17182        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17183           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17184              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17185
 17186     IF PB-COMP-AH-CANCEL
 17187        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17188        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17189           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17190              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17191
 17192     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17193             GIVING WS-UNSIGN-WRK1
 17194     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17195             GIVING WS-UNSIGN-WRK2.
 17196
 17197     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17198         MOVE ZERO TO WS-UNSIGN-WRK1.
 17199
 17200     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17201         MOVE ZERO TO WS-UNSIGN-WRK2.
 17202
 17203     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17204
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 311
* EL050.cbl
 17206
 17207 3772-CONTINUE.
 17208
 17209**********************************
 17210*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17211*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17212*** DOUBLES THE TOLERANCE AMOUNT.
 17213***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17214**********************************
 17215     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17216     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17217         IF WS-REF-REJECT-SW = SPACE
 17218             MOVE ER-2754        TO WS-ERROR
 17219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17220           ELSE
 17221             MOVE ER-2736        TO WS-ERROR
 17222             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17223**********************************
 17224
 17225 3773-CONTINUE.
 17226
 17227     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17228        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17229           MOVE ER-2723          TO WS-ERROR
 17230           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17231
 17232     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17233        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17234           MOVE ER-2724          TO WS-ERROR
 17235           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17236
 17237     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17238         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17239             (1 + WS-LF-REFUND-OVS-PCT)
 17240     ELSE
 17241         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17242
 17243     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17244         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17245             (1 - WS-TOL-LF-REFUND-PCT)
 17246     ELSE
 17247         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17248
 17249     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17250        AND (PB-CI-ENTRY-STATUS = 'M')
 17251        AND (PB-C-LF-CANCEL-AMT > +0)
 17252        MOVE ER-3843             TO WS-ERROR
 17253        PERFORM 9900-ERROR-FORMAT
 17254                                 THRU 9900-EXIT
 17255     END-IF
 17256     EVALUATE TRUE
 17257        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17258           CONTINUE
 17259        WHEN PB-C-LF-CANCEL-AMT = +0
 17260                 AND PB-C-LF-REF-CALC > +0
 17261           CONTINUE
 17262        WHEN WS-LF-REFUND-OVS-AMT = 0
 17263                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 312
* EL050.cbl
 17264           CONTINUE
 17265        WHEN OTHER
 17266           IF WS-TOL-LF-REFUND  = +0
 17267              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17268           END-IF
 17269           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17270                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17271                          (PB-C-LF-CANCEL-AMT))
 17272              CONTINUE
 17273           ELSE
 17274              IF WS-LF-REFUND-OVS-AMT = +0
 17275                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17276              END-IF
 17277              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17278                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17279                                       PB-C-LF-CANCEL-AMT)
 17280                 CONTINUE
 17281              ELSE
 17282                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17283                   MOVE ER-2754   TO  WS-ERROR
 17284                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17285                 ELSE
 17286                    MOVE ER-2736   TO  WS-ERROR
 17287                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17288                 END-IF
 17289              END-IF
 17290           END-IF
 17291     END-EVALUATE.
 17292
 17293     EVALUATE TRUE
 17294        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17295           CONTINUE
 17296        WHEN PB-C-LF-CANCEL-AMT = +0
 17297                 AND PB-C-LF-REF-CALC > +0
 17298           CONTINUE
 17299        WHEN OTHER
 17300           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17301               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17302              CONTINUE
 17303           ELSE
 17304              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17305               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17306                CONTINUE
 17307              ELSE
 17308                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17309                     MOVE ER-2754   TO  WS-ERROR
 17310                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17311                 ELSE
 17312                     MOVE ER-2736   TO  WS-ERROR
 17313                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17314                 END-IF
 17315              END-IF
 17316           END-IF
 17317     END-EVALUATE.
 17318
 17319     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17320         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17321             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 313
* EL050.cbl
 17322     ELSE
 17323         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17324
 17325     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17326         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17327             (1 - WS-TOL-AH-REFUND-PCT)
 17328     ELSE
 17329         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17330
 17331     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17332        AND (PB-CI-ENTRY-STATUS = 'M')
 17333        AND (PB-C-AH-CANCEL-AMT > +0)
 17334        MOVE ER-3843             TO WS-ERROR
 17335        PERFORM 9900-ERROR-FORMAT
 17336                                 THRU 9900-EXIT
 17337     END-IF
 17338     EVALUATE TRUE
 17339        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17340           CONTINUE
 17341*       WHEN PB-C-AH-REF-CALC = +0 AND
 17342*                  PB-C-AH-CANCEL-AMT > +0
 17343        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17344                   PB-C-AH-REF-CALC > +0
 17345           CONTINUE
 17346        WHEN WS-AH-REFUND-OVS-AMT = +0
 17347                AND WS-TOL-AH-REFUND = +0
 17348           CONTINUE
 17349        WHEN OTHER
 17350           IF WS-TOL-AH-REFUND = +0
 17351              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17352           END-IF
 17353           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17354               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17355                                         PB-C-AH-CANCEL-AMT)
 17356              CONTINUE
 17357           ELSE
 17358              IF WS-AH-REFUND-OVS-AMT = +0
 17359                 MOVE +9999999.99 TO
 17360                         WS-AH-REFUND-OVS-AMT
 17361              END-IF
 17362              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17363                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17364                                         PB-C-AH-CANCEL-AMT)
 17365                 CONTINUE
 17366              ELSE
 17367                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17368                    MOVE ER-2754   TO  WS-ERROR
 17369                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17370                 ELSE
 17371                    MOVE ER-2736   TO  WS-ERROR
 17372                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17373                 END-IF
 17374              END-IF
 17375           END-IF
 17376     END-EVALUATE.
 17377
 17378     EVALUATE TRUE
 17379        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 314
* EL050.cbl
 17380           CONTINUE
 17381*       WHEN PB-C-AH-REF-CALC > +0 AND
 17382*                  PB-C-AH-CANCEL-AMT = +0
 17383        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17384                   PB-C-AH-REF-CALC = +0
 17385           CONTINUE
 17386        WHEN OTHER
 17387           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17388               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17389              CONTINUE
 17390           ELSE
 17391              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17392                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17393                 CONTINUE
 17394              ELSE
 17395                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17396                     MOVE ER-2754   TO  WS-ERROR
 17397                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17398                 ELSE
 17399                     MOVE ER-2736   TO  WS-ERROR
 17400                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17401                 END-IF
 17402              END-IF
 17403           END-IF
 17404     END-EVALUATE.
 17405
 17406     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17407        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17408        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17409           AND  PB-C-LF-REF-CALC < +1.00
 17410           AND  PB-C-AH-REF-CALC < +1.00
 17411           CONTINUE
 17412        ELSE
 17413           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17414              AND (PB-CI-ENTRY-STATUS = 'M')
 17415              CONTINUE
 17416           ELSE
 17417              MOVE ER-2741       TO WS-ERROR
 17418              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17419           END-IF
 17420        END-IF
 17421     END-IF
 17422
 17423     IF (PB-C-LF-CANCEL-AMT = ZERO
 17424        AND WS-LF-BENEFIT-CD NOT = ZERO
 17425        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17426        AND PB-C-LF-REF-CALC NOT = ZERO)
 17427        OR
 17428        (PB-C-LF-CANCEL-AMT = ZERO
 17429        AND WS-LF-BENEFIT-CD NOT = ZERO
 17430        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17431             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17432                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17433                NEXT SENTENCE
 17434             ELSE
 17435                MOVE ER-2739        TO WS-ERROR
 17436                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17437
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 315
* EL050.cbl
 17438     IF (PB-C-AH-CANCEL-AMT = ZERO
 17439        AND WS-AH-BENEFIT-CD NOT = ZERO
 17440        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17441        AND PB-C-AH-REF-CALC NOT = ZERO)
 17442        OR
 17443        (PB-C-AH-CANCEL-AMT = ZERO
 17444        AND WS-AH-BENEFIT-CD NOT = ZERO
 17445        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17446             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17447                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17448                NEXT SENTENCE
 17449             ELSE
 17450                MOVE ER-2738        TO WS-ERROR
 17451                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17452
 17453 3775-OVER-REF-CHK.
 17454
 17455     IF PB-CI-ENTRY-STATUS = '5'
 17456        GO TO 3780-UPDATE-CANCEL-CERT.
 17457
 17458     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17459                              PB-CI-LF-ALT-PREMIUM-AMT.
 17460
 17461     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17462        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17463                                 PB-C-LF-REF-CALC
 17464      ELSE
 17465        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17466                                 PB-C-LF-CANCEL-AMT.
 17467
 17468     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17469        MOVE ER-2755             TO WS-ERROR
 17470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17471
 17472     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17473
 17474     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17475        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17476                                 PB-C-AH-REF-CALC
 17477      ELSE
 17478        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17479                                 PB-C-AH-CANCEL-AMT.
 17480
 17481     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17482        MOVE ER-2778             TO WS-ERROR
 17483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17484
 17485     IF PB-CI-OB-FLAG NOT = 'Z'
 17486        NEXT SENTENCE
 17487       ELSE
 17488         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17489            MOVE ER-2757           TO WS-ERROR
 17490            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17491
 17492 3780-UPDATE-CANCEL-CERT.
 17493
 17494     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17495        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 316
* EL050.cbl
 17496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17497
 17498     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17499         MOVE ER-2729              TO WS-ERROR
 17500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17501
 17502     IF PB-CI-LF-BENEFIT-CD = ZERO
 17503         GO TO 3780-UPDATE-CONT-1.
 17504
 17505     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17506         GO TO 3780-UPDATE-CONT-1.
 17507
 17508     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17509       AND
 17510        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17511       AND
 17512        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17513       AND
 17514        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17515            NEXT SENTENCE
 17516       ELSE
 17517        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17518          AND
 17519***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17520***       AND
 17521           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17522            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17523               MOVE ER-2730      TO WS-ERROR
 17524               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17525               GO TO 3999-END-EDIT
 17526            ELSE
 17527               GO TO 3999-END-EDIT
 17528        ELSE
 17529            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17530               MOVE ER-2765           TO WS-ERROR
 17531               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17532               GO TO 3785-CHECK-NH.
 17533*              GO TO 3999-END-EDIT.
 17534
 17535 3780-UPDATE-CONT-1.
 17536     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17537
 17538     IF PB-CI-AH-BENEFIT-CD = ZERO
 17539         GO TO 3780-UPDATE-CONT-2.
 17540
 17541     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17542         GO TO 3780-UPDATE-CONT-2.
 17543
 17544     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17545
 17546     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17547       AND
 17548        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17549       AND
 17550        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17551       AND
 17552        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17553            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 317
* EL050.cbl
 17554       ELSE
 17555        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17556          AND
 17557***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17558***       AND
 17559           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17560           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17561            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17562               MOVE ER-2773      TO WS-ERROR
 17563               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17564               GO TO 3999-END-EDIT
 17565            ELSE
 17566               GO TO 3999-END-EDIT
 17567            END-IF
 17568           ELSE
 17569             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17570                IF MSTR-CERT-NO = W-CL-CERT-NO
 17571                   MOVE ER-2890 TO WS-ERROR
 17572                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17573                   GO TO 3999-END-EDIT
 17574                ELSE
 17575                   MOVE ER-2898 TO WS-ERROR
 17576                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17577                   GO TO 3999-END-EDIT
 17578                END-IF
 17579             ELSE
 17580                GO TO 3785-CHECK-NH
 17581             END-IF
 17582           END-IF
 17583          ELSE
 17584            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17585              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17586                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17587                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17588                      MOVE ER-2890 TO WS-ERROR
 17589                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17590                      GO TO 3999-END-EDIT
 17591                   ELSE
 17592                      MOVE ER-2898 TO WS-ERROR
 17593                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17594                      GO TO 3999-END-EDIT
 17595                   END-IF
 17596                ELSE
 17597                   MOVE ER-2765 TO WS-ERROR
 17598                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17599                   GO TO 3785-CHECK-NH
 17600                END-IF
 17601              ELSE
 17602               MOVE ER-2765      TO WS-ERROR
 17603               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17604               GO TO 3785-CHECK-NH.
 17605*              GO TO 3999-END-EDIT.
 17606
 17607 3780-UPDATE-CONT-2.
 17608
 17609     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17610        AND WS-LF-BENEFIT-CD = ZERO
 17611           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 318
* EL050.cbl
 17612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17613
 17614     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17615        AND WS-AH-BENEFIT-CD = ZERO
 17616           MOVE ER-2744           TO WS-ERROR
 17617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17618
 17619     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17620        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17621        AND
 17622        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17623         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17624           MOVE ER-2746           TO WS-ERROR
 17625           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17626
 17627     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17628       AND
 17629        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17630             MOVE ER-2737        TO WS-ERROR
 17631             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17632
 17633     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17634       AND
 17635        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17636             MOVE ER-2737        TO WS-ERROR
 17637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17638
 17639     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17640         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17641             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17642             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17643         ELSE
 17644             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17645                 MOVE ER-2768    TO WS-ERROR
 17646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17647             ELSE
 17648                 MOVE ER-2756    TO WS-ERROR
 17649                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17650
 17651     IF CERT-PEND-ISSUE-RETURNED
 17652        MOVE ER-2772             TO WS-ERROR
 17653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17654 3785-CHECK-NH.
 17655*    IF PB-STATE NOT = 'NH' and 'TN'
 17656     IF PB-STATE NOT = 'NH'
 17657        GO TO 3999-END-EDIT
 17658     END-IF
 17659
 17660     MOVE ER-2796                TO WS-ERROR
 17661     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17662     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17663        OR (CM-NH-INTERFACE-SW = 'Y')
 17664        MOVE ER-2793             TO WS-ERROR
 17665        PERFORM 9900-ERROR-FORMAT
 17666                                 THRU 9900-EXIT
 17667     END-IF
 17668     MOVE +0                     TO WS-PAYMENT-AMT
 17669     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 319
* EL050.cbl
 17670        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17671               PB-C-AH-CANCEL-DT
 17672           GO TO 3999-END-EDIT
 17673        END-IF
 17674     end-if
 17675***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17676***-_-
 17677***-_-   For TN it's only flat cancels
 17678***-_-
 17679***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17680     if pb-state = 'TN'
 17681        if ((pb-c-lf-cancel-dt <> low-values)
 17682           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17683                      or
 17684           ((pb-c-ah-cancel-dt <> low-values)
 17685           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17686           GO TO 3999-END-EDIT
 17687        END-IF
 17688     end-if
 17689     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17690        GO TO 3999-END-EDIT
 17691     END-IF
 17692***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17693***-_-
 17694***-_-   if cancel date within 15 days of effective date, bypass
 17695***-_-
 17696***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17697     IF PB-STATE NOT = 'NH'
 17698        GO TO 3785-CONTINUE
 17699     END-IF
 17700     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17701     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17702     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17703        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17704     END-IF
 17705     MOVE '1'                    TO DC-OPTION-CODE
 17706     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17707     IF NO-CONVERSION-ERROR
 17708        IF DC-ELAPSED-DAYS < +16
 17709           GO TO 3999-END-EDIT
 17710        END-IF
 17711     END-IF
 17712***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17713***-_-
 17714***-_-   if cancel date within 30 days of current date then
 17715***-_-   bypass else subtract 15 days from period
 17716***-_-
 17717***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17718     MOVE +0                     TO DC-ELAPSED-DAYS
 17719     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17720     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17721     MOVE '1'                    TO DC-OPTION-CODE
 17722     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17723     IF NO-CONVERSION-ERROR
 17724        IF DC-ELAPSED-DAYS > +30
 17725           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17726        ELSE
 17727           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 320
* EL050.cbl
 17728        END-IF
 17729     ELSE
 17730        GO TO 3999-END-EDIT
 17731     END-IF
 17732     .
 17733 3785-CONTINUE.
 17734     if pb-state = 'TN'
 17735        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17736        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17737        MOVE '1'                 TO DC-OPTION-CODE
 17738        PERFORM 8500-DATE-CONVERT
 17739                                 THRU 8500-EXIT
 17740        IF no-CONVERSION-ERROR
 17741           IF DC-ELAPSED-DAYS < +16
 17742              GO TO 3999-END-EDIT
 17743           END-IF
 17744        END-IF
 17745     end-if
 17746***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17747***-_-
 17748***-_-   'NH' is 10%, TN is 3.5%
 17749***-_-
 17750***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17751     if pb-state = 'NH'
 17752        move +1.10               to ws-work-rate
 17753     else
 17754        move +1.035              to ws-work-rate
 17755     end-if
 17756     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17757        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17758           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17759     IF WS-PAYMENT-AMT < 600.00
 17760        GO TO 3999-END-EDIT
 17761     END-IF
 17762     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17763
 17764     IF (ERMAIL-FOUND = ' ')
 17765         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17766         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17767        GO TO 3999-END-EDIT
 17768     END-IF
 17769     MOVE ER-2795                TO WS-ERROR
 17770     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17771
 17772     GO TO 3999-END-EDIT.
 17773******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 321
* EL050.cbl
 17775 3990-FILES-NOT-OPEN.
 17776
 17777     MOVE ER-2617                TO WS-ERROR.
 17778     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17779     GO TO 9990-RETURN.
 17780
 17781 3999-END-EDIT.
 17782
 17783     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17784
 17785     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17786         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17787         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17788             PERFORM 9250-UNLOCK-RETURN
 17789             GO TO 9990-RETURN
 17790          ELSE
 17791             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17792             GO TO 9990-RETURN.
 17793
 17794     IF PB-CANCELLATION
 17795          GO TO 9990-RETURN.
 17796
 17797     IF CERT-WAS-NOT-FOUND
 17798        MOVE SPACES              TO CERTIFICATE-MASTER.
 17799
 17800     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17801
 17802     IF CERT-WAS-FOUND
 17803         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17804             PERFORM 9250-UNLOCK-RETURN
 17805          ELSE
 17806            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17807      ELSE
 17808         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17809
 17810*    if pb-company-id = 'VPP'
 17811*       perform 8150-read-elcrtt thru 8150-exit
 17812*       if ws-vehicle-odometer numeric
 17813*          if ws-vehicle-odometer > 6000
 17814*             move er-1583       to ws-error
 17815*             PERFORM 9900-ERROR-FORMAT
 17816*                                THRU 9900-EXIT
 17817*          end-if
 17818*       end-if
 17819*    end-if
 17820     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17821        IF ((PB-COMPANY-ID = 'DCC')
 17822           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17823                         or
 17824            (pb-company-id = 'CID' or 'VPP')
 17825            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17826        END-IF
 17827     END-IF.
 17828
 17829     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17830         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17831     END-IF.
 17832     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 322
* EL050.cbl
 17833     perform 8150-read-elcrtt    thru 8150-exit
 17834     if ws-ins-age-defaulted = 'Y'
 17835        move er-1573             to ws-error
 17836        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17837     end-if
 17838
 17839     if ws-jnt-age-defaulted = 'Y'
 17840        move er-1574             to ws-error
 17841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17842     end-if
 17843***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17844***                                                           ****
 17845***  Set an error if the state requires verification of agent ****
 17846***  and agent hasn't verified yet and the status is not =    ****
 17847***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17848***  and the entry date > 09/01/2015.                         ****
 17849***                                                           ****
 17850***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17851     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17852        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17853        and (pb-account (9:2) not = 'OB')
 17854        if (ws-st-agent-sig-edit = 'Y')
 17855           and (am-report-code-1 not = 'CONLEY')
 17856           evaluate true
 17857              when cs-agent-edit-status = 'C'
 17858                 move er-1743    to ws-error
 17859                 perform 9900-error-format
 17860                                 thru 9900-exit
 17861              when cs-agent-edit-status = 'S'
 17862                 move er-1744    to ws-error
 17863                 perform 9900-error-format
 17864                                 thru 9900-exit
 17865              when cs-agent-edit-status = 'M'
 17866                 move er-1745    to ws-error
 17867                 perform 9900-error-format
 17868                                 thru 9900-exit
 17869              when cs-agent-edit-status = 'R'
 17870                 move er-1747    to ws-error
 17871                 perform 9900-error-format
 17872                                 thru 9900-exit
 17873              when cs-agent-edit-status = 'N'
 17874                 move er-1748    to ws-error
 17875                 perform 9900-error-format
 17876                                 thru 9900-exit
 17877              when cs-agent-edit-status <> 'V' and 'U' and
 17878                                           'R' and 'N'
 17879                 move er-1746    to ws-error
 17880                 perform 9900-error-format
 17881                                 thru 9900-exit
 17882           end-evaluate
 17883        end-if
 17884     end-if
 17885     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17886     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17887        AND (WS-NO-SECURE-PAY))
 17888                  OR
 17889        (WS-LF-SPECIAL-CALC-CD = 'O'
 17890        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 323
* EL050.cbl
 17891        SET SKIP-ADDR-EDIT       TO TRUE
 17892     END-IF
 17893     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17894        AND (NOT SKIP-ADDR-EDIT)
 17895        MOVE ER-2963             TO WS-ERROR
 17896        PERFORM 9900-ERROR-FORMAT
 17897                                 THRU 9900-EXIT
 17898        GO TO 9990-RETURN
 17899     END-IF
 17900     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17901     IF ERPNDM-FOUND NOT = 'X'
 17902        move 'Y'                 to erpndm-unlock-sw
 17903        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17904           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17905           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17906           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17907           or (pm-zip-code    = zeros)
 17908           or (pm-zip-code not numeric))
 17909           AND (NOT SKIP-ADDR-EDIT)
 17910           MOVE ER-2694          TO WS-ERROR
 17911           PERFORM 9900-ERROR-FORMAT
 17912                                 THRU 9900-EXIT
 17913        END-IF
 17914        MOVE ' '                 TO STATE-RECORD-ERROR
 17915        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17916        MOVE PM-STATE            TO CNTL-ACCESS
 17917        MOVE '3'                 TO CNTL-REC-TYPE
 17918        MOVE +0                  TO CNTL-SEQ-NO
 17919        MOVE '0'                 TO RC-SW-2
 17920        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17921        IF (NO-STATE-RECORD)
 17922           OR (CF-RECORD-TYPE NOT = '3')
 17923           OR (PM-STATE NOT = CF-STATE-CODE)
 17924           IF (PM-STATE = SPACES)
 17925              AND (SKIP-ADDR-EDIT)
 17926              CONTINUE
 17927           ELSE
 17928              MOVE ER-2963       TO WS-ERROR
 17929              PERFORM 9900-ERROR-FORMAT
 17930                                 THRU 9900-EXIT
 17931           END-IF
 17932        END-IF
 17933        if (ws-error not = er-2963 and er-2694)
 17934           and (pm-city-st-zip-verified = ' ')
 17935           and (pb-company-id = 'CID')
 17936           move spaces           to zipcd-pass-area
 17937           move pm-zip-code      to pa-zip
 17938           move pm-city          to pa-city
 17939           move pm-state         to pa-state
 17940           perform 7790-call-zip-verify
 17941                                 thru 7790-exit
 17942           if pa-errorcode-zip (1:1) = ' '
 17943                    move 'Y'     to pm-city-st-zip-verified
 17944                    PERFORM 8102-REWRITE-ERPNDM
 17945                                 THRU 8102-EXIT
 17946                    move 'N'     to erpndm-unlock-sw
 17947           else
 17948              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 324
* EL050.cbl
 17949              PERFORM 9900-ERROR-FORMAT
 17950                                 THRU 9900-EXIT
 17951           end-if
 17952        end-if
 17953        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17954           MOVE ER-2883          TO WS-ERROR
 17955           PERFORM 9900-ERROR-FORMAT
 17956                                 THRU 9900-EXIT
 17957        END-IF
 17958        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17959           MOVE ' '                 TO STATE-RECORD-ERROR
 17960           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17961           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17962           MOVE '3'                 TO CNTL-REC-TYPE
 17963           MOVE +0                  TO CNTL-SEQ-NO
 17964           MOVE '0'                 TO RC-SW-2
 17965           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17966           IF NO-STATE-RECORD
 17967              OR (CF-RECORD-TYPE NOT = '3')
 17968              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17969              MOVE ER-2964          TO WS-ERROR
 17970              PERFORM 9900-ERROR-FORMAT
 17971                                    THRU 9900-EXIT
 17972           END-IF
 17973        END-IF
 17974     ELSE
 17975        IF NOT SKIP-ADDR-EDIT
 17976           MOVE ER-2393          TO WS-ERROR
 17977           PERFORM 9900-ERROR-FORMAT
 17978                                 THRU 9900-EXIT
 17979        END-IF
 17980     END-IF
 17981     if need-to-unlock-erpndm
 17982        perform 8104-unlock-erpndm
 17983                                 thru 8104-exit
 17984     end-if
 17985     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17986
 17987     IF (ERMAIL-FOUND = ' ' AND
 17988        ERPNDM-FOUND = ' ')
 17989        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17990           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17991           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17992          OR
 17993           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17994          OR
 17995           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17996           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17997           GO TO 3999-UNLOCK-ERMAIL.
 17998
 17999     IF ERPNDM-FOUND = 'X'
 18000        GO TO 3999-UNLOCK-ERMAIL.
 18001
 18002     IF PM-INSURED-LAST-NAME      = SPACES
 18003        AND PM-INSURED-FIRST-NAME = SPACES
 18004        AND PM-ADDRESS-LINE-1     = SPACES
 18005        AND PM-ADDRESS-LINE-2     = SPACES
 18006        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 325
* EL050.cbl
 18007        AND PM-CRED-BENE-NAME     = SPACES
 18008        AND PM-CRED-BENE-ADDR     = SPACES
 18009        AND PM-CRED-BENE-CTYST    = SPACES
 18010        GO TO 3999-UNLOCK-ERMAIL
 18011     END-IF
 18012
 18013     MOVE SPACES                 TO MAILING-DATA.
 18014
 18015     MOVE 'MA'                   TO MA-RECORD-ID.
 18016     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18017     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18018     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18019     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18020     MOVE PB-SV-STATE            TO MA-STATE.
 18021     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18022     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18023
 18024     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18025     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18026
 18027     IF ERMAIL-FOUND = ' '
 18028        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18029     ELSE
 18030        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18031        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18032        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18033
 18034     GO TO 9990-RETURN.
 18035
 18036 3999-UNLOCK-ERMAIL.
 18037     IF ERMAIL-FOUND = ' '
 18038        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18039
 18040     GO TO 9990-RETURN.
 18041******************************************************************
 18042
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 326
* EL050.cbl
 18044 4000-UPDATE-CANCELLED-CERT.
 18045     IF CERT-WAS-NOT-FOUND
 18046        GO TO 4299-EXIT.
 18047
 18048*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18049     IF PB-C-NH-INT-ON-REFS > ZEROS
 18050        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18051     END-IF
 18052     IF PB-C-REF-INTERFACE-SW = 'Y'
 18053        MOVE PB-C-REF-INTERFACE-SW
 18054                                 TO CM-NH-INTERFACE-SW
 18055     END-IF
 18056     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18057     IF ERMAIL-FOUND = 'X'
 18058        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18059        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18060        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18061        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18062           MOVE ER-2694          TO WS-ERROR
 18063           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18064     END-IF
 18065
 18066     IF PB-C-POST-CARD-IND = 'Y'
 18067        MOVE +8                  TO SUB
 18068*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18069        IF ERMAIL-FOUND = ' '
 18070           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18071              (SUB > +7)
 18072              OR (MA-MAIL-STATUS (SUB) = '1')
 18073           END-PERFORM
 18074        END-IF
 18075        IF (SUB > +7)
 18076           OR (ERMAIL-FOUND = 'X')
 18077           MOVE ER-3789          TO WS-ERROR
 18078           PERFORM 9900-ERROR-FORMAT
 18079                                 THRU 9900-EXIT
 18080        END-IF
 18081     ELSE
 18082        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18083     END-IF
 18084
 18085     IF ERMAIL-FOUND = ' '
 18086        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18087     END-IF.
 18088
 18089     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18090
 18091     IF PB-CI-OB-FLAG = 'Z'
 18092        GO TO 4150-SUMMARY-CERT-CANCEL.
 18093
 18094     IF PB-C-LF-CANCEL-VOIDED
 18095         PERFORM 4200-REVERSE-LF-CANCEL.
 18096     IF PB-C-AH-CANCEL-VOIDED
 18097         PERFORM 4200-REVERSE-AH-CANCEL.
 18098
 18099 4100-APPLY-LF-CANCEL.
 18100
 18101     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 327
* EL050.cbl
 18102
 18103 4100-CHECK-LF-ERRORS.
 18104
 18105     ADD +1                       TO WS-SUB.
 18106
 18107     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18108        IF LF-COVERAGE-CANCELLED
 18109           GO TO 4100-LF-CANCEL-CONT
 18110        ELSE
 18111           GO TO 4100-UPDATE-LF-COVERAGE.
 18112
 18113     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18114                                   ER-2729 OR
 18115                                   ER-2730 OR
 18116                                   ER-2731 OR
 18117                                   ER-2732 OR
 18118                                   ER-2737 OR
 18119                                   ER-2740 OR
 18120                                   ER-2743 OR
 18121                                   ER-2749 OR
 18122                                   ER-2750 OR
 18123                                   ER-2755 OR
 18124                                   ER-2757 OR
 18125                                   ER-2760 OR
 18126                                   ER-2772 OR
 18127                                   ER-2774 OR
 18128                                   ER-2776 OR
 18129                                   ER-2794
 18130        GO TO 4100-UPDATE-LF-COVERAGE.
 18131
 18132     GO TO 4100-CHECK-LF-ERRORS.
 18133
 18134 4100-UPDATE-LF-COVERAGE.
 18135
 18136     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18137     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18138     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18139        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18140     END-IF
 18141     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18142                                      TO CM-CREDIT-INTERFACE-SW-2.
 18143     IF CM-LF-CANCEL-DT = LOW-VALUE
 18144         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18145
 18146     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18147         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18148                                         CM-LF-STATUS-AT-CANCEL.
 18149
 18150     GO TO 4100-APPLY-AH-CANCEL.
 18151
 18152 4100-LF-CANCEL-CONT.
 18153     IF PB-C-LF-CANCEL-VOIDED
 18154         GO TO 4100-APPLY-AH-CANCEL.
 18155
 18156     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18157         GO TO 4100-APPLY-AH-CANCEL.
 18158
 18159     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 328
* EL050.cbl
 18160        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18161           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18162        ELSE
 18163           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18164
 18165     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18166     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18167
 18168     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18169         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18170
 18171     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18172        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18173         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18174         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18175
 18176     IF PB-RECORD-RETURNED
 18177        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18178      ELSE
 18179        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18180
 18181 4100-APPLY-AH-CANCEL.
 18182
 18183     MOVE +0                      TO WS-SUB.
 18184
 18185 4100-CHECK-AH-ERRORS.
 18186
 18187     ADD +1                       TO WS-SUB.
 18188
 18189     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18190        IF AH-COVERAGE-CANCELLED
 18191           GO TO 4100-AH-CANCEL-CONT
 18192        ELSE
 18193           GO TO 4100-UPDATE-AH-COVERAGE.
 18194
 18195     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18196                                   ER-2729 OR
 18197                                   ER-2732 OR
 18198                                   ER-2737 OR
 18199                                   ER-2740 OR
 18200                                   ER-2744 OR
 18201                                   ER-2749 OR
 18202                                   ER-2750 OR
 18203                                   ER-2755 OR
 18204                                   ER-2757 OR
 18205                                   ER-2760 OR
 18206                                   ER-2771 OR
 18207                                   ER-2772 OR
 18208                                   ER-2773 OR
 18209                                   ER-2775 OR
 18210                                   ER-2777 OR
 18211                                   ER-2778 OR
 18212                                   ER-2794
 18213        GO TO 4100-UPDATE-AH-COVERAGE.
 18214
 18215     GO TO 4100-CHECK-AH-ERRORS.
 18216
 18217 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 329
* EL050.cbl
 18218
 18219     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18220     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18221     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18222     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18223                                      TO CM-CREDIT-INTERFACE-SW-2.
 18224     IF CM-AH-CANCEL-DT = LOW-VALUE
 18225         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18226
 18227     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18228         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18229                                         CM-AH-STATUS-AT-CANCEL.
 18230
 18231     IF LF-COVERAGE-CANCELLED
 18232         IF PB-RECORD-RETURNED
 18233              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18234          ELSE
 18235              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18236
 18237     GO TO 4299-EXIT.
 18238
 18239 4100-AH-CANCEL-CONT.
 18240     IF PB-C-AH-CANCEL-VOIDED
 18241         GO TO 4299-EXIT.
 18242
 18243     if cm-credit-interface-sw-2 = ' '
 18244        if pb-fatal-errors or pb-unforced-errors
 18245           move '4'              to cm-credit-interface-sw-2
 18246        else
 18247           move '1'              to cm-credit-interface-sw-2
 18248        end-if
 18249     end-if
 18250     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18251         GO TO 4299-EXIT.
 18252
 18253     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18254        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18255           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18256        ELSE
 18257           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18258
 18259     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18260     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18261
 18262     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18263         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18264
 18265     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18266         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18267         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18268
 18269     IF PB-RECORD-RETURNED
 18270        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18271      ELSE
 18272        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18273
 18274     GO TO 4299-EXIT.
 18275
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 330
* EL050.cbl
 18276 4150-SUMMARY-CERT-CANCEL.
 18277     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18278
 18279     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18280        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18281                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18282     ELSE
 18283        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18284                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18285
 18286     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18287        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18288                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18289     ELSE
 18290        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18291                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18292
 18293     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18294        NEXT SENTENCE
 18295     ELSE
 18296        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18297
 18298     GO TO 4299-EXIT.
 18299
 18300 4200-REVERSE-LF-CANCEL.
 18301     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18302
 18303     IF CM-LF-CANCEL-APPLIED
 18304        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18305        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18306        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18307
 18308     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18309
 18310     IF PB-RECORD-RETURNED
 18311        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18312       ELSE
 18313        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18314
 18315 4200-REVERSE-LF-EXIT.
 18316       EXIT.
 18317
 18318 4200-REVERSE-AH-CANCEL.
 18319     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18320
 18321     IF CM-AH-CANCEL-APPLIED
 18322        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18323        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18324        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18325
 18326     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18327
 18328     IF PB-RECORD-RETURNED
 18329        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18330       ELSE
 18331        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18332
 18333 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 331
* EL050.cbl
 18334       EXIT.
 18335
 18336 4299-EXIT.
 18337       EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 332
* EL050.cbl
 18339
 18340 4500-UPDATE-NEW-CERT.
 18341     IF CERT-WAS-FOUND
 18342         NEXT SENTENCE
 18343       ELSE
 18344         GO TO 4520-BUILD-NEW-KEY.
 18345
 18346     IF  CLASIC-CREATED-CERT
 18347         GO TO 4999-EXIT.
 18348
 18349     IF  CERT-WAS-CREATED-FOR-CLAIM
 18350         GO TO 4520-BUILD-NEW-KEY.
 18351
 18352     IF CERT-ADDED-BATCH
 18353        IF CM-RECORD-ID = 'CM'
 18354            GO TO 4999-EXIT.
 18355
 18356 4520-BUILD-NEW-KEY.
 18357* BUILD CONTROL PRIMARY
 18358
 18359     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18360                                       CM-COMPANY-CD-A1
 18361                                       CM-COMPANY-CD-A2
 18362                                       CM-COMPANY-CD-A4
 18363                                       CM-COMPANY-CD-A5.
 18364
 18365     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18366     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18367     MOVE PB-SV-STATE               TO CM-STATE.
 18368     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18369     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18370     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18371     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18372
 18373     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18374
 18375     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18376     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18377     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18378     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18379
 18380     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18381        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18382
 18383     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18384         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18385         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18386         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18387         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18388     ELSE
 18389         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18390
 18391     IF PB-COMPANY-ID   EQUAL  'CRI'
 18392         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18393         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18394         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18395         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18396         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 333
* EL050.cbl
 18397
 18398     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18399        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18400         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18401
 18402     IF PB-COMPANY-ID  = 'LBL'
 18403        IF PB-I-JOINT-COVERAGE
 18404            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18405                                           PB-I-MEMBER-NO
 18406            GO TO 4550-CONT-CERT-PROCESS.
 18407
 18408     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18409        NEXT SENTENCE
 18410     ELSE
 18411        GO TO 4540-BUILD-MEMBER-NO.
 18412
 18413******************************************************************
 18414*                                                                *
 18415*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18416*    FOR 'MON'.                                                  *
 18417*                                                                *
 18418******************************************************************
 18419
 18420     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18421     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18422     MOVE +1                     TO WS-SUB1
 18423                                    WS-SUB2.
 18424
 18425 4530-EDIT-MEMB-NAME.
 18426
 18427     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18428        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18429        ADD +1                       TO WS-SUB2.
 18430
 18431     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18432        ADD +1                       TO WS-SUB1
 18433        GO TO 4530-EDIT-MEMB-NAME.
 18434
 18435     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18436     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18437     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18438*    MOVE SPACE                      TO DC-OPTION-CODE.
 18439     SET  BIN-TO-GREG                TO TRUE.
 18440     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18441     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18442
 18443     GO TO 4550-CONT-CERT-PROCESS.
 18444
 18445******************************************************************
 18446*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18447******************************************************************
 18448
 18449 4540-BUILD-MEMBER-NO.
 18450
 18451     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18452         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18453         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18454         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 334
* EL050.cbl
 18455         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18456     ELSE
 18457         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18458
 18459     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18460        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18461         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18462
 18463 4550-CONT-CERT-PROCESS.
 18464
 18465*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18466*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18467*    ELSE
 18468*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18469
 18470     IF CERT-WAS-CREATED-FOR-CLAIM
 18471        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18472        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18473
 18474     IF CERT-AND-CLAIM-ONLINE
 18475        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18476        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18477
 18478     MOVE 'CM'                     TO CM-RECORD-ID.
 18479     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18480
 18481     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18482        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18483        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18484     ELSE
 18485        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18486        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18487
 18488     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18489     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18490     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18491     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18492     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18493     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18494     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18495                                      CM-LF-ITD-CANCEL-AMT
 18496                                      CM-LF-ITD-DEATH-AMT
 18497                                      CM-AH-ITD-AH-PMT
 18498                                      CM-AH-ITD-LUMP-PMT
 18499                                      CM-AH-ITD-CANCEL-AMT
 18500                                      CM-LF-NSP-PREMIUM-AMT
 18501                                      CM-AH-NSP-PREMIUM-AMT.
 18502*                                     CM-CLAIM-DEDUCT-WITHHELD
 18503*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18504     if pb-i-loan-apr = +99.9999
 18505        move zeros                 to cm-loan-apr
 18506     else
 18507        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18508     end-if
 18509     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18510     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18511     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18512     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 335
* EL050.cbl
 18513     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18514     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18515     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18516     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18517     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18518     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18519     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18520
 18521     IF PB-I-LIVES NOT NUMERIC
 18522         MOVE ZERO                 TO PB-I-LIVES.
 18523
 18524     IF PB-I-NUM-BILLED NOT NUMERIC
 18525         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18526
 18527     MOVE PB-I-LIVES               TO CM-LIVES.
 18528     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18529
 18530     IF PB-COMPANY-ID EQUAL  'DMD'
 18531         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18532         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18533
 18534     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18535     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18536     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18537     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18538     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18539     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18540
 18541     IF PB-I-LF-POLICY-FEE NUMERIC
 18542        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18543     ELSE
 18544        MOVE +0                    TO CM-LF-POLICY-FEE.
 18545
 18546     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18547        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18548        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18549     ELSE
 18550        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18551
 18552     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18553     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18554     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18555     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18556     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18557     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18558     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18559     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18560     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18561
 18562     IF PB-I-CANCEL-FEE NUMERIC
 18563        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18564     ELSE
 18565        MOVE +0                  TO CM-CANCEL-FEE
 18566     END-IF
 18567
 18568     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18569        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18570     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 336
* EL050.cbl
 18571        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18572
 18573     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18574     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18575
 18576     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18577                                      CM-LF-DEATH-EXIT-DT
 18578                                      CM-AH-SETTLEMENT-EXIT-DT.
 18579
 18580*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18581*                       'TIH' OR 'OFL' OR 'FLA' OR
 18582*                       'TII' OR 'TMS' OR 'CRI' OR
 18583*                       'NCL'
 18584     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18585
 18586     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18587         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18588            MOVE '2'                TO CM-PREMIUM-TYPE.
 18589
 18590     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18591         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18592            MOVE '2'                TO CM-PREMIUM-TYPE.
 18593
 18594     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18595         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18596     ELSE
 18597         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18598         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18599
 18600     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18601     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18602     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18603     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18604     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18605     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18606     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18607     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18608
 18609     IF PB-NO-MONTHS-SKIPPED
 18610         MOVE SPACE                 TO CM-SKIP-CODE
 18611     ELSE
 18612         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18613
 18614     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18615     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18616                                       CM-LF-STATUS-AT-CANCEL.
 18617
 18618     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18619     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18620                                       CM-AH-STATUS-AT-CANCEL.
 18621
 18622     MOVE '1'                       TO CM-ENTRY-STATUS.
 18623
 18624     IF PB-REISSUED-CERT
 18625        MOVE '5'                    TO CM-ENTRY-STATUS.
 18626
 18627     IF PB-MONTHLY-CERT
 18628        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 337
* EL050.cbl
 18629
 18630     IF PB-CASH-CERT
 18631        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18632
 18633     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18634     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18635     IF PB-POLICY-IS-DECLINED
 18636        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18637
 18638     IF PB-POLICY-IS-VOIDED
 18639        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18640
 18641     IF PB-NEEDS-UNDERWRITING
 18642        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18643
 18644     IF PB-REIN-ONLY-CERT
 18645        MOVE '9'                    TO CM-ENTRY-STATUS.
 18646
 18647     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18648         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18649     ELSE
 18650         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18651
 18652     IF PB-RECORD-RETURNED
 18653        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18654      ELSE
 18655        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18656
 18657     IF PB-I-MAIL-ADDRS-PRESENT
 18658        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18659
 18660     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18661                                       CM-ENTRY-DT.
 18662
 18663 4999-EXIT.
 18664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 338
* EL050.cbl
 18666
 18667 5000-PROCESS-REPS.
 18668     MOVE ' '                    TO AGTC-MASTER-SW
 18669     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18670     MOVE CO-TYPE                TO AGTC-TYPE
 18671     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18672     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18673     IF (AGTC-MASTER-SW NOT = 'N')
 18674        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18675        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18676        PERFORM 8583-READ-ERAGTC-NEXT
 18677                                 THRU 8583-EXIT
 18678     END-IF
 18679     IF AGTC-MASTER-SW = 'N'
 18680        CONTINUE
 18681     ELSE
 18682        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18683           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18684              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18685              MOVE 'Y'           TO AGTC-MASTER-SW
 18686           END-IF
 18687        END-IF
 18688     END-IF
 18689     .
 18690 5000-EXIT.
 18691     EXIT.
 18692 6370-EDIT-INPUT-LF-CODE.
 18693     move ' ' to ws-benefit-cd-chg-sw
 18694     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18695        MOVE +1                  TO SUB
 18696        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18697        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18698        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18699        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18700        GO TO 6370-SEARCH-LOOP.
 18701
 18702     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18703
 18704     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18705     MOVE SPACES                 TO CNTL-ACCESS.
 18706*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18707     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18708     MOVE +0                     TO CNTL-SEQ-NO.
 18709     MOVE '4' TO RC-SW-2.
 18710     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18711
 18712     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18713        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18714        GO TO 6370-NO-LF-FOUND.
 18715
 18716     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18717     MOVE +1                     TO SUB.
 18718
 18719 6370-SEARCH-LOOP.
 18720     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18721         GO TO 6370-NO-LF-FOUND.
 18722
 18723     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 339
* EL050.cbl
 18724        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18725           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18726           set benefit-code-chg to true
 18727        end-if
 18728        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18729        GO TO 6370-HER-NET-PAY-CHECK.
 18730
 18731     ADD 1   TO SUB.
 18732*    IF SUB GREATER 120
 18733     IF SUB GREATER 200
 18734         GO TO 6370-NO-LF-FOUND.
 18735
 18736     GO TO 6370-SEARCH-LOOP.
 18737
 18738 6370-NO-LF-FOUND.
 18739
 18740     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18741        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18742        set benefit-code-chg to true
 18743     end-if
 18744     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18745
 18746 6370-HER-NET-PAY-CHECK.
 18747
 18748     IF PB-COMPANY-ID = 'CID'
 18749        IF PB-SV-STATE = 'CA' OR 'MN'
 18750           IF PB-I-LF-BENEFIT-CD = '02'
 18751              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18752           ELSE
 18753              IF PB-I-LF-BENEFIT-CD = '04'
 18754                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18755              END-IF
 18756           END-IF
 18757        END-IF
 18758     END-IF
 18759
 18760     IF PB-COMPANY-ID NOT = 'HER'
 18761         GO TO 6370-EXIT.
 18762
 18763     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18764         GO TO 6370-EXIT.
 18765
 18766     IF PB-I-LF-TERM NOT NUMERIC
 18767         MOVE ZEROS              TO PB-I-LF-TERM.
 18768
 18769     IF PB-I-LOAN-TERM NOT NUMERIC
 18770         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18771
 18772     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18773         GO TO 6370-EXIT.
 18774
 18775     IF PB-I-LF-BENEFIT-CD = '33'
 18776         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18777
 18778     IF PB-I-LF-BENEFIT-CD = '34'
 18779         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18780
 18781 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 340
* EL050.cbl
 18782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 341
* EL050.cbl
 18784
 18785 6380-EDIT-INPUT-AH-CODE.
 18786     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18787        MOVE +1                  TO SUB
 18788        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18789        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18790        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18791        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18792        GO TO 6380-SEARCH-LOOP.
 18793
 18794     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18795
 18796     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18797     MOVE SPACES                 TO CNTL-ACCESS.
 18798     MOVE 'A'                    TO CNTL-REC-TYPE.
 18799*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18800     MOVE +0                     TO CNTL-SEQ-NO.
 18801     MOVE '5' TO RC-SW-2.
 18802     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18803
 18804     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18805        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18806        GO TO 6380-NO-AH-FOUND.
 18807
 18808     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18809     MOVE +1 TO SUB.
 18810
 18811 6380-SEARCH-LOOP.
 18812     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18813         GO TO 6380-NO-AH-FOUND.
 18814
 18815     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18816         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18817         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18818
 18819     ADD 1   TO SUB.
 18820     IF SUB GREATER THAN 96
 18821*    IF SUB GREATER THAN 300
 18822         GO TO 6380-NO-AH-FOUND.
 18823
 18824     GO TO 6380-SEARCH-LOOP.
 18825
 18826 6380-NO-AH-FOUND.
 18827
 18828     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18829
 18830     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18831         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18832     ELSE
 18833         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18834
 18835 6380-CSO-AH-ONLY-CHECKS.
 18836
 18837     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18838        NEXT SENTENCE
 18839      ELSE
 18840        GO TO 6380-EXIT.
 18841
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 342
* EL050.cbl
 18842     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18843         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18844
 18845
 18846     GO TO 6380-EXIT
 18847     .
 18848 6380-CSO-LIFE-WITH-AH-CHECKS.
 18849
 18850
 18851     .
 18852 6380-EXIT.
 18853     EXIT.
 18854
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 343
* EL050.cbl
 18856
 18857 6400-COMPUTE-EXTENSION-DAYS.
 18858
 18859******************************************************************
 18860*                                                                *
 18861*                   COMPUTE EXTENSION DAYS                       *
 18862*                                                                *
 18863*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18864*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18865*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18866*    THE EXTENSION DAYS.                                         *
 18867*                                                                *
 18868******************************************************************
 18869
 18870     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18871     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18872
 18873******************************************************************
 18874*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18875*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18876******************************************************************
 18877
 18878     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18879        COMPUTE WS-ODD-DAYS-OVER =
 18880               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18881     ELSE
 18882        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18883
 18884     IF WS-ODD-DAYS-OVER = ZEROS
 18885           GO TO 6499-EXIT
 18886     ELSE
 18887        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18888           IF WS-WDF-MONTH = 02
 18889              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18890              ADD 2       TO  WS-ODD-DAYS-OVER
 18891              GO TO 6499-EXIT
 18892           ELSE
 18893              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18894                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18895                 GO TO 6499-EXIT
 18896               ELSE
 18897                 GO TO 6499-EXIT
 18898        ELSE
 18899           GO TO 6499-EXIT.
 18900
 18901 6412-CHECK-TO-DAY.
 18902
 18903        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18904           IF WS-WDT-DAY = 28
 18905              ADD 2              TO WS-ODD-DAYS-OVER
 18906           ELSE
 18907              IF WS-WDT-DAY = 29
 18908                 ADD 1           TO WS-ODD-DAYS-OVER
 18909              ELSE
 18910                 NEXT SENTENCE
 18911        ELSE
 18912           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18913              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 344
* EL050.cbl
 18914
 18915     GO TO 6499-EXIT.
 18916
 18917
 18918 6415-CHECK-LEAP-YEAR.
 18919
 18920     IF DC-DAYS-IN-MONTH = 29
 18921        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18922
 18923 6415-EXIT.
 18924     EXIT.
 18925
 18926 6499-EXIT.
 18927      EXIT.
 18928
 18929 6500-END.
 18930     EXIT.
 18931
 18932
 18933******************************************************************
 18934************* PROCEDURE DIVISION FOR EL050 ***********************
 18935********************** ELC50PD END *******************************
 18936
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 345
* EL050.cbl
 18938
 18939**START***********************************************************
 18940*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18941*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18942******************************************************************
 18943*
 18944 6600-GET-STATE-MUNICIPAL-TAX.
 18945
 18946     IF PB-COMPANY-ID NOT = 'DMD'
 18947         GO TO 6640-EXIT.
 18948
 18949     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18950     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18951     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18952*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18953*
 18954***  Y2K PROJ 7744
 18955     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18956     SET BIN-TO-GREG          TO TRUE.
 18957     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18958
 18959     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18960
 18961     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18962     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18963
 18964
 18965* EXEC CICS HANDLE CONDITION
 18966*        INVREQ    (6610-START-BROWSE)
 18967*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18968*        NOTFND    (6630-END-OF-FILE)
 18969*    END-EXEC.
 18970*    MOVE '"$8JI                 ! # #00018954' TO DFHEIV0
 18971     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18973     MOVE X'2320233030303138393534' TO DFHEIV0(25:11)
 18974     CALL 'kxdfhei1' USING DFHEIV0
 18975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18976
 18977
 18978 6610-START-BROWSE.
 18979
 18980
 18981* EXEC CICS HANDLE CONDITION
 18982*        NOTFND    (6630-END-OF-FILE)
 18983*        DISABLED  (6630-ERRESS-PROBLEM)
 18984*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18985*        ENDFILE   (6630-END-OF-FILE)
 18986*    END-EXEC.
 18987*    MOVE '"$IcJ''                ! $ #00018962' TO DFHEIV0
 18988     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18990     MOVE X'2420233030303138393632' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0
 18992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18993
 18994
 18995
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 346
* EL050.cbl
 18996* EXEC CICS STARTBR
 18997*        DATASET (FILE-ID-ERRESS)
 18998*        RIDFLD  (WS-ERRESS-KEY)
 18999*        GTEQ
 19000*    END-EXEC.
 19001     MOVE 0
 19002       TO DFHEIV11
 19003*    MOVE '&,         G          &   #00018969' TO DFHEIV0
 19004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19006     MOVE X'2020233030303138393639' TO DFHEIV0(25:11)
 19007     CALL 'kxdfhei1' USING DFHEIV0,
 19008           FILE-ID-ERRESS,
 19009           WS-ERRESS-KEY,
 19010           DFHEIV99,
 19011           DFHEIV11,
 19012           DFHEIV99
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016 6620-READ-NEXT-ERRESS-MASTER.
 19017
 19018
 19019* EXEC CICS HANDLE CONDITION
 19020*        NOTFND    (6630-END-OF-FILE)
 19021*        ENDFILE   (6630-END-OF-FILE)
 19022*        DISABLED  (6630-ERRESS-PROBLEM)
 19023*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19024*    END-EXEC.
 19025*    MOVE '"$I''cJ                ! % #00018977' TO DFHEIV0
 19026     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19028     MOVE X'2520233030303138393737' TO DFHEIV0(25:11)
 19029     CALL 'kxdfhei1' USING DFHEIV0
 19030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19031
 19032
 19033
 19034* EXEC CICS READNEXT
 19035*        DATASET (FILE-ID-ERRESS)
 19036*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19037*        RIDFLD  (WS-ERRESS-KEY)
 19038*    END-EXEC.
 19039     MOVE LENGTH OF
 19040      RESIDENT-STATE-TAX-MASTER
 19041       TO DFHEIV12
 19042     MOVE 0
 19043       TO DFHEIV11
 19044*    MOVE '&.IL                  )   #00018984' TO DFHEIV0
 19045     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19046     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19047     MOVE X'2020233030303138393834' TO DFHEIV0(25:11)
 19048     CALL 'kxdfhei1' USING DFHEIV0,
 19049           FILE-ID-ERRESS,
 19050           RESIDENT-STATE-TAX-MASTER,
 19051           DFHEIV12,
 19052           WS-ERRESS-KEY,
 19053           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 347
* EL050.cbl
 19054           DFHEIV11,
 19055           DFHEIV99,
 19056           DFHEIV99
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19061
 19062* EXEC CICS ENDBR
 19063*            DATASET (FILE-ID-ERRESS)
 19064*       END-EXEC
 19065     MOVE 0
 19066       TO DFHEIV11
 19067*    MOVE '&2                    $   #00018991' TO DFHEIV0
 19068     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19070     MOVE X'2020233030303138393931' TO DFHEIV0(25:11)
 19071     CALL 'kxdfhei1' USING DFHEIV0,
 19072           FILE-ID-ERRESS,
 19073           DFHEIV11,
 19074           DFHEIV99
 19075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19076        GO TO 6630-END-OF-FILE.
 19077
 19078     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19079        NEXT SENTENCE
 19080      ELSE
 19081        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19082
 19083*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19084*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19085*
 19086     MOVE +2                     TO WS-SUB1.
 19087
 19088     IF PB-ISSUE
 19089     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19090        MOVE +1                  TO WS-SUB1.
 19091
 19092     IF PB-CANCELLATION
 19093     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19094        MOVE +1                  TO WS-SUB1.
 19095*
 19096*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19097*
 19098***  Y2K PROJ 7744
 19099     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19100***  Y2K PROJ 7744
 19101
 19102*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19103* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19104* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19105
 19106     ADD 1                    TO WS-YEAR-YY.
 19107
 19108     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19109         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19110                              TO WS-RES-STATE-TAX
 19111         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 348
* EL050.cbl
 19112                              TO WS-RES-MUNI-TAX
 19113     ELSE
 19114         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19115                              TO WS-RES-STATE-TAX
 19116         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19117                              TO WS-RES-MUNI-TAX.
 19118
 19119*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19120
 19121     IF PB-CANCELLATION
 19122         GO TO 6640-CANCEL-TAX.
 19123
 19124     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19125         COMPUTE PB-I-STATE-TAX ROUNDED =
 19126                                   PB-I-LF-PREMIUM-AMT
 19127                                 * WS-RES-STATE-TAX
 19128         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19129                                   PB-I-LF-PREMIUM-AMT
 19130                                 * WS-RES-MUNI-TAX
 19131     ELSE
 19132     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19133         COMPUTE PB-I-STATE-TAX ROUNDED =
 19134                                   PB-I-AH-PREMIUM-AMT
 19135                                 * WS-RES-STATE-TAX
 19136         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19137                                   PB-I-AH-PREMIUM-AMT
 19138                                 * WS-RES-MUNI-TAX.
 19139
 19140
 19141* EXEC CICS ENDBR
 19142*         DATASET (FILE-ID-ERRESS)
 19143*    END-EXEC.
 19144     MOVE 0
 19145       TO DFHEIV11
 19146*    MOVE '&2                    $   #00019058' TO DFHEIV0
 19147     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19149     MOVE X'2020233030303139303538' TO DFHEIV0(25:11)
 19150     CALL 'kxdfhei1' USING DFHEIV0,
 19151           FILE-ID-ERRESS,
 19152           DFHEIV11,
 19153           DFHEIV99
 19154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19155
 19156
 19157     GO TO 6640-EXIT.
 19158
 19159 6640-CANCEL-TAX.
 19160     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19161
 19162     IF PB-C-LF-CANCEL-AMT > ZEROS
 19163         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19164                                   PB-C-LF-CANCEL-AMT
 19165                                 * WS-RES-STATE-TAX
 19166         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19167                                   PB-C-LF-CANCEL-AMT
 19168                                *  WS-RES-MUNI-TAX
 19169     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 349
* EL050.cbl
 19170     IF PB-C-AH-CANCEL-AMT > ZEROS
 19171         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19172                                   PB-C-AH-CANCEL-AMT
 19173                                 * WS-RES-STATE-TAX
 19174         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19175                                   PB-C-AH-CANCEL-AMT
 19176                                *  WS-RES-MUNI-TAX.
 19177
 19178
 19179* EXEC CICS ENDBR
 19180*         DATASET (FILE-ID-ERRESS)
 19181*    END-EXEC.
 19182     MOVE 0
 19183       TO DFHEIV11
 19184*    MOVE '&2                    $   #00019083' TO DFHEIV0
 19185     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19187     MOVE X'2020233030303139303833' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0,
 19189           FILE-ID-ERRESS,
 19190           DFHEIV11,
 19191           DFHEIV99
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195     GO TO 6640-EXIT.
 19196
 19197 6630-END-OF-FILE.
 19198     MOVE ER-8002              TO WS-ERROR.
 19199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19200
 19201     GO TO 6640-EXIT.
 19202
 19203 6630-ERRESS-PROBLEM.
 19204     MOVE ER-8044              TO WS-ERROR.
 19205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19206
 19207 6640-EXIT.
 19208     EXIT.
 19209
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 350
* EL050.cbl
 19211 6650-GET-RES-STATE-COMM.
 19212
 19213     IF PB-COMPANY-ID NOT = 'DMD'
 19214         GO TO 6700-COMM-EXIT.
 19215
 19216     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19217     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19218     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19219     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19220     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19221     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19222     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19223
 19224*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19225*
 19226***  Y2K PROJ 7744
 19227     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19228     SET BIN-TO-GREG          TO TRUE.
 19229     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19230
 19231     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19232***  Y2K PROJ 7744
 19233
 19234     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19235
 19236
 19237* EXEC CICS HANDLE CONDITION
 19238*        INVREQ    (6660-START-BROWSE)
 19239*        DISABLED  (6690-ERRESC-PROBLEM)
 19240*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19241*        NOTFND    (6690-END-OF-FILE)
 19242*    END-EXEC.
 19243*    MOVE '"$8cJI                ! & #00019128' TO DFHEIV0
 19244     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19246     MOVE X'2620233030303139313238' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251
 19252* EXEC CICS RESETBR
 19253*        DATASET (FILE-ID-ERRESC)
 19254*        RIDFLD  (WS-ERRESC-KEY)
 19255*    END-EXEC.
 19256     MOVE 0
 19257       TO DFHEIV11
 19258*    MOVE '&4         G          &   #00019135' TO DFHEIV0
 19259     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19260     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19261     MOVE X'2020233030303139313335' TO DFHEIV0(25:11)
 19262     CALL 'kxdfhei1' USING DFHEIV0,
 19263           FILE-ID-ERRESC,
 19264           WS-ERRESC-KEY,
 19265           DFHEIV99,
 19266           DFHEIV11,
 19267           DFHEIV99
 19268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 351
* EL050.cbl
 19269
 19270
 19271 6660-START-BROWSE.
 19272
 19273
 19274* EXEC CICS HANDLE CONDITION
 19275*        NOTFND    (6690-END-OF-FILE)
 19276*        DISABLED  (6690-ERRESC-PROBLEM)
 19277*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19278*        ENDFILE   (6690-END-OF-FILE)
 19279*    END-EXEC.
 19280*    MOVE '"$IcJ''                ! '' #00019142' TO DFHEIV0
 19281     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19283     MOVE X'2720233030303139313432' TO DFHEIV0(25:11)
 19284     CALL 'kxdfhei1' USING DFHEIV0
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19286
 19287
 19288
 19289* EXEC CICS STARTBR
 19290*        DATASET (FILE-ID-ERRESC)
 19291*        RIDFLD  (WS-ERRESC-KEY)
 19292*        GTEQ
 19293*    END-EXEC.
 19294     MOVE 0
 19295       TO DFHEIV11
 19296*    MOVE '&,         G          &   #00019149' TO DFHEIV0
 19297     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19298     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19299     MOVE X'2020233030303139313439' TO DFHEIV0(25:11)
 19300     CALL 'kxdfhei1' USING DFHEIV0,
 19301           FILE-ID-ERRESC,
 19302           WS-ERRESC-KEY,
 19303           DFHEIV99,
 19304           DFHEIV11,
 19305           DFHEIV99
 19306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19307
 19308
 19309     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19310
 19311 6670-READ-NEXT-ERRESC-MASTER.
 19312
 19313
 19314* EXEC CICS HANDLE CONDITION
 19315*        NOTFND    (6690-END-OF-FILE)
 19316*        DISABLED  (6690-ERRESC-PROBLEM)
 19317*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19318*        ENDFILE   (6690-END-OF-FILE)
 19319*    END-EXEC.
 19320*    MOVE '"$IcJ''                ! ( #00019159' TO DFHEIV0
 19321     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19323     MOVE X'2820233030303139313539' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19326
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 352
* EL050.cbl
 19327
 19328
 19329* EXEC CICS READNEXT
 19330*        DATASET (FILE-ID-ERRESC)
 19331*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19332*        RIDFLD  (ERRESC-RECORD-KEY)
 19333*    END-EXEC.
 19334     MOVE LENGTH OF
 19335      ACCOUNT-RESIDENT-ST-COMMISSION
 19336       TO DFHEIV12
 19337     MOVE 0
 19338       TO DFHEIV11
 19339*    MOVE '&.IL                  )   #00019166' TO DFHEIV0
 19340     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19342     MOVE X'2020233030303139313636' TO DFHEIV0(25:11)
 19343     CALL 'kxdfhei1' USING DFHEIV0,
 19344           FILE-ID-ERRESC,
 19345           ACCOUNT-RESIDENT-ST-COMMISSION,
 19346           DFHEIV12,
 19347           ERRESC-RECORD-KEY,
 19348           DFHEIV99,
 19349           DFHEIV11,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19353
 19354
 19355     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19356        NEXT SENTENCE
 19357     ELSE
 19358
 19359* EXEC CICS ENDBR
 19360*            DATASET (FILE-ID-ERRESC)
 19361*       END-EXEC
 19362     MOVE 0
 19363       TO DFHEIV11
 19364*    MOVE '&2                    $   #00019175' TO DFHEIV0
 19365     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19367     MOVE X'2020233030303139313735' TO DFHEIV0(25:11)
 19368     CALL 'kxdfhei1' USING DFHEIV0,
 19369           FILE-ID-ERRESC,
 19370           DFHEIV11,
 19371           DFHEIV99
 19372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19373        GO TO 6690-END-OF-FILE.
 19374
 19375     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19376
 19377* EXEC CICS ENDBR
 19378*            DATASET (FILE-ID-ERRESC)
 19379*       END-EXEC
 19380     MOVE 0
 19381       TO DFHEIV11
 19382*    MOVE '&2                    $   #00019181' TO DFHEIV0
 19383     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 353
* EL050.cbl
 19385     MOVE X'2020233030303139313831' TO DFHEIV0(25:11)
 19386     CALL 'kxdfhei1' USING DFHEIV0,
 19387           FILE-ID-ERRESC,
 19388           DFHEIV11,
 19389           DFHEIV99
 19390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19391        GO TO 6690-END-OF-FILE.
 19392
 19393     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19394        NEXT SENTENCE
 19395      ELSE
 19396        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19397
 19398* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19399*
 19400     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19401
 19402     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19403
 19404     IF WS-SUB1 > ZERO
 19405         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19406             PERFORM 6680-SET-COMMISSION
 19407         ELSE
 19408             PERFORM 6680-SET-TABLE-CODE.
 19409
 19410
 19411* EXEC CICS ENDBR
 19412*         DATASET (FILE-ID-ERRESC)
 19413*    END-EXEC.
 19414     MOVE 0
 19415       TO DFHEIV11
 19416*    MOVE '&2                    $   #00019203' TO DFHEIV0
 19417     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19419     MOVE X'2020233030303139323033' TO DFHEIV0(25:11)
 19420     CALL 'kxdfhei1' USING DFHEIV0,
 19421           FILE-ID-ERRESC,
 19422           DFHEIV11,
 19423           DFHEIV99
 19424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19425
 19426
 19427     GO TO 6700-COMM-EXIT.
 19428
 19429 6680-SET-TABLE-CODE.
 19430     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19431        MOVE ZEROS             TO WS-SUB1
 19432     ELSE
 19433* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19434* TO COMPUTE AH COMMISSION.
 19435        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19436        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19437        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19438        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19439        PERFORM 6680-READ-CTBL-TABLE
 19440        IF WS-CTBL-READ-SW NOT = 'Y'
 19441           MOVE ZEROS          TO WS-SUB1.
 19442
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 354
* EL050.cbl
 19443 6680-READ-CTBL-TABLE.
 19444*
 19445* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19446* TO COMPUTE LIFE COMMISSION
 19447
 19448     IF CTBL-SW = '0540'
 19449        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19450        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19451        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19452
 19453     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19454
 19455     IF CTBL-TABLE-FOUND
 19456        IF CTBL-SW = '0530'
 19457             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19458                                    * PB-I-AH-TERM
 19459             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19460             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19461        ELSE
 19462             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19463             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19464             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19465     ELSE
 19466        IF FIRST-TIME-THROUGH
 19467            GO TO 6680-READ-CTBL-TABLE
 19468        ELSE
 19469            MOVE ZEROS         TO WS-SUB1.
 19470
 19471 6680-SET-COMMISSION.
 19472     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19473           MOVE ZEROS          TO WS-SUB1
 19474       ELSE
 19475           MOVE RESC-COMMISSION-PER (WS-SUB)
 19476                               TO WS-COMMISSION
 19477           IF CTBL-SW = '0530'
 19478               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19479           ELSE
 19480               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19481
 19482 6680-SEARCH-CATEGORY.
 19483     ADD +1                   TO WS-SUB.
 19484     IF WS-SUB > +12
 19485         GO TO 6680-EXIT.
 19486
 19487     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19488          MOVE WS-SUB         TO WS-SUB1
 19489          GO TO 6680-EXIT.
 19490
 19491     GO TO 6680-SEARCH-CATEGORY.
 19492
 19493 6680-EXIT.
 19494     EXIT.
 19495
 19496 6690-END-OF-FILE.
 19497     GO TO 6700-COMM-EXIT.
 19498
 19499 6690-ERRESC-PROBLEM.
 19500      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 355
* EL050.cbl
 19501      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19502
 19503      GO TO 6700-COMM-EXIT.
 19504
 19505 6700-COMM-EXIT.
 19506     EXIT.
 19507
 19508 7000-GET-RATE.
 19509
 19510* EXEC CICS LINK
 19511*        PROGRAM    ('ELRATE')
 19512*        COMMAREA   (CALCULATION-PASS-AREA)
 19513*        LENGTH     (CP-COMM-LENGTH)
 19514*    END-EXEC.
 19515     MOVE 'ELRATE' TO DFHEIV1
 19516*    MOVE '."C                   (   #00019289' TO DFHEIV0
 19517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303139323839' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           DFHEIV1,
 19522           CALCULATION-PASS-AREA,
 19523           CP-COMM-LENGTH,
 19524           DFHEIV99,
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99
 19528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19529
 19530
 19531 7000-EXIT.
 19532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 356
* EL050.cbl
 19534 7100-FIND-BENEFIT-IN-STATE.
 19535     MOVE 'N'                    TO BEN-SEARCH-SW.
 19536
 19537     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19538         VARYING SUB3 FROM 1 BY 1 UNTIL
 19539            ((SUB3 GREATER 50) OR
 19540              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19541               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19542
 19543     IF SUB3 NOT = 51
 19544         MOVE 'Y'                TO BEN-SEARCH-SW.
 19545
 19546     GO TO 7199-EXIT.
 19547
 19548 7100-BENEFIT-DUMMY.
 19549
 19550 7100-DUMMY-EXIT.
 19551     EXIT.
 19552
 19553 7199-EXIT.
 19554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 357
* EL050.cbl
 19556 7200-FIND-BENEFIT.
 19557     MOVE 'N'                    TO BEN-SEARCH-SW.
 19558
 19559     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19560         VARYING SUB3 FROM 1 BY 1 UNTIL
 19561            ((SUB3 GREATER 8) OR
 19562            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19563
 19564     IF SUB3 NOT = 9
 19565         MOVE 'Y'                TO BEN-SEARCH-SW.
 19566
 19567     GO TO 7200-EXIT.
 19568
 19569 7200-BENEFIT-DUMMY.
 19570
 19571 7200-DUMMY-EXIT.
 19572     EXIT.
 19573
 19574 7200-EXIT.
 19575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 358
* EL050.cbl
 19577 7250-LOOK-FOR-RESCINDED-CLAIM.
 19578     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19579                                    W-CL-COMP-CD.
 19580     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19581                                    W-CL-CERT-NO.
 19582
 19583
 19584* EXEC CICS HANDLE CONDITION
 19585*        NOTFND  (7250-CONTINUE)
 19586*        ENDFILE (7250-CONTINUE)
 19587*    END-EXEC.
 19588*    MOVE '"$I''                  ! ) #00019347' TO DFHEIV0
 19589     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19591     MOVE X'2920233030303139333437' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0
 19593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19594
 19595
 19596
 19597* EXEC CICS IGNORE CONDITION
 19598*        DUPKEY
 19599*    END-EXEC.
 19600*    MOVE '"*$                   !   #00019352' TO DFHEIV0
 19601     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19603     MOVE X'2020233030303139333532' TO DFHEIV0(25:11)
 19604     CALL 'kxdfhei1' USING DFHEIV0
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608
 19609* EXEC CICS STARTBR
 19610*        DATASET   (CLMS-ID)
 19611*        RIDFLD    (ELMSTR-KEY)
 19612*        GENERIC   EQUAL
 19613*        KEYLENGTH (ELMSTR-LENGTH)
 19614*    END-EXEC.
 19615     MOVE 0
 19616       TO DFHEIV11
 19617*    MOVE '&,   KG    E          &   #00019356' TO DFHEIV0
 19618     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19619     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19620     MOVE X'2020233030303139333536' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0,
 19622           CLMS-ID,
 19623           ELMSTR-KEY,
 19624           ELMSTR-LENGTH,
 19625           DFHEIV11,
 19626           DFHEIV99
 19627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19628
 19629
 19630     MOVE 'Y'                    TO W-BROWSE-SW.
 19631
 19632 7250-NEXT-CLAIM.
 19633
 19634
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 359
* EL050.cbl
 19635* EXEC CICS READNEXT
 19636*        DATASET   (CLMS-ID)
 19637*        RIDFLD    (ELMSTR-KEY)
 19638*        SET       (ADDRESS OF CLAIM-MASTER)
 19639*    END-EXEC.
 19640     MOVE 0
 19641       TO DFHEIV11
 19642*    MOVE '&.S                   )   #00019367' TO DFHEIV0
 19643     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303139333637' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           CLMS-ID,
 19648           DFHEIV20,
 19649           DFHEIV99,
 19650           ELMSTR-KEY,
 19651           DFHEIV99,
 19652           DFHEIV11,
 19653           DFHEIV99,
 19654           DFHEIV99
 19655     SET ADDRESS OF CLAIM-MASTER TO
 19656         DFHEIV20
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19661        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19662         GO TO 7250-CONTINUE
 19663     END-IF.
 19664
 19665     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19666        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19667        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19668        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19669        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19670         GO TO 7250-NEXT-CLAIM
 19671     END-IF.
 19672
 19673     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19674        OR (CL-CLAIM-TYPE = 'I')
 19675        OR (CL-CLAIM-TYPE = 'G')
 19676        OR (CL-CLAIM-TYPE = 'F')
 19677          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19678              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19679              GO TO 7250-CONTINUE
 19680          END-IF
 19681     END-IF.
 19682
 19683     GO TO 7250-NEXT-CLAIM.
 19684
 19685 7250-CONTINUE.
 19686
 19687     IF W-BROWSE-SW = 'Y'
 19688
 19689* EXEC CICS ENDBR
 19690*            DATASET   (CLMS-ID)
 19691*        END-EXEC
 19692     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 360
* EL050.cbl
 19693       TO DFHEIV11
 19694*    MOVE '&2                    $   #00019401' TO DFHEIV0
 19695     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19696     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19697     MOVE X'2020233030303139343031' TO DFHEIV0(25:11)
 19698     CALL 'kxdfhei1' USING DFHEIV0,
 19699           CLMS-ID,
 19700           DFHEIV11,
 19701           DFHEIV99
 19702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19703         MOVE 'N' TO W-BROWSE-SW
 19704     END-IF.
 19705
 19706 7250-EXIT.
 19707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 361
* EL050.cbl
 19709 7300-CHECK-FOR-OPEN-CLMS.
 19710
 19711*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19712*    MOVE SPACES                 TO CNTL-ACCESS.
 19713*    MOVE '1'                    TO CNTL-REC-TYPE.
 19714*    MOVE +0                     TO CNTL-SEQ-NO.
 19715
 19716*    MOVE '3'                    TO RC-SW-1.
 19717*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19718
 19719*    IF NOT CF-COMPANY-MASTER
 19720*         PERFORM 0099-COMPANY-NOT-FOUND
 19721*         GO TO 7300-EXIT.
 19722
 19723     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19724                                    W-CL-COMP-CD.
 19725     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19726                                    W-CL-CERT-NO.
 19727
 19728
 19729* EXEC CICS HANDLE CONDITION
 19730*        NOTFND  (7300-CONTINUE)
 19731*        ENDFILE (7300-CONTINUE)
 19732*    END-EXEC.
 19733*    MOVE '"$I''                  ! * #00019429' TO DFHEIV0
 19734     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19736     MOVE X'2A20233030303139343239' TO DFHEIV0(25:11)
 19737     CALL 'kxdfhei1' USING DFHEIV0
 19738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19739
 19740
 19741
 19742* EXEC CICS IGNORE CONDITION
 19743*        DUPKEY
 19744*    END-EXEC.
 19745*    MOVE '"*$                   !   #00019434' TO DFHEIV0
 19746     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19748     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 19749     CALL 'kxdfhei1' USING DFHEIV0
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753
 19754* EXEC CICS STARTBR
 19755*        DATASET   (CLMS-ID)
 19756*        RIDFLD    (ELMSTR-KEY)
 19757*        GENERIC   EQUAL
 19758*        KEYLENGTH (ELMSTR-LENGTH)
 19759*    END-EXEC.
 19760     MOVE 0
 19761       TO DFHEIV11
 19762*    MOVE '&,   KG    E          &   #00019438' TO DFHEIV0
 19763     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19765     MOVE X'2020233030303139343338' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 362
* EL050.cbl
 19767           CLMS-ID,
 19768           ELMSTR-KEY,
 19769           ELMSTR-LENGTH,
 19770           DFHEIV11,
 19771           DFHEIV99
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19773
 19774
 19775     MOVE 'Y'                    TO W-BROWSE-SW.
 19776
 19777 7300-NEXT-CLAIM.
 19778
 19779
 19780* EXEC CICS READNEXT
 19781*        DATASET   (CLMS-ID)
 19782*        RIDFLD    (ELMSTR-KEY)
 19783*        SET       (ADDRESS OF CLAIM-MASTER)
 19784*    END-EXEC.
 19785     MOVE 0
 19786       TO DFHEIV11
 19787*    MOVE '&.S                   )   #00019449' TO DFHEIV0
 19788     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303139343439' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           CLMS-ID,
 19793           DFHEIV20,
 19794           DFHEIV99,
 19795           ELMSTR-KEY,
 19796           DFHEIV99,
 19797           DFHEIV11,
 19798           DFHEIV99,
 19799           DFHEIV99
 19800     SET ADDRESS OF CLAIM-MASTER TO
 19801         DFHEIV20
 19802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19803
 19804
 19805     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19806        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19807         GO TO 7300-CONTINUE.
 19808
 19809     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19810        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19811        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19812        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19813        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19814         GO TO 7300-NEXT-CLAIM.
 19815
 19816*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19817     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19818        OR (CL-CLAIM-TYPE = 'I')
 19819        OR (CL-CLAIM-TYPE = 'G')
 19820        OR (CL-CLAIM-TYPE = 'F')
 19821        IF CLAIM-IS-OPEN
 19822           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19823             AND PB-C-AH-CANCEL-DT > SPACES
 19824              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 363
* EL050.cbl
 19825              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19826           END-IF
 19827           EVALUATE TRUE
 19828             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19829                 MOVE ER-2884      TO WS-ERROR
 19830             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19831                 MOVE ER-2887      TO WS-ERROR
 19832             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19833                 MOVE ER-2886      TO WS-ERROR
 19834             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19835                 MOVE ER-2888      TO WS-ERROR
 19836             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19837                 MOVE ER-2885      TO WS-ERROR
 19838             WHEN OTHER
 19839                 MOVE ER-2768      TO WS-ERROR
 19840           END-EVALUATE
 19841           IF PB-C-AH-CANCEL-VOIDED OR
 19842              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19843                NOT AH-COVERAGE-CANCELLED)
 19844               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19845               MOVE ER-2768      TO WS-ERROR
 19846           END-IF
 19847           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19848           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19849              PB-FORCE-CODE NOT EQUAL '8'
 19850               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19851           END-IF
 19852           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19853           GO TO 7300-NEXT-CLAIM
 19854        ELSE
 19855           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19856*****THIS IS A RESCISSION OR REFORMATION
 19857              IF AH-COVERAGE-CANCELLED
 19858                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19859                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19860                    MOVE 1                   TO DC-ELAPSED-DAYS
 19861                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19862                    SET BIN-PLUS-ELAPSED     TO TRUE
 19863                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19864                    IF NO-CONVERSION-ERROR
 19865                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19866                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19867                          MOVE ER-2897 TO WS-ERROR
 19868                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19869                          GO TO 7300-NEXT-CLAIM
 19870                       END-IF
 19871                    END-IF
 19872                 ELSE
 19873                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19874                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19875                         MOVE ER-2890 TO WS-ERROR
 19876                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19877                         GO TO 7300-NEXT-CLAIM
 19878                      ELSE
 19879                         MOVE ER-2898 TO WS-ERROR
 19880                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19881                         GO TO 7300-NEXT-CLAIM
 19882                      END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 364
* EL050.cbl
 19883                   END-IF
 19884                 END-IF
 19885              END-IF
 19886           ELSE
 19887              IF CL-DENIAL-TYPE = '1'  AND
 19888                 CL-TOTAL-PAID-AMT = 0
 19889                    GO TO 7300-NEXT-CLAIM
 19890              END-IF
 19891              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19892               AND PB-C-AH-CANCEL-DT > SPACES
 19893                 MOVE ER-2756        TO WS-ERROR
 19894                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19895                 GO TO 7300-NEXT-CLAIM
 19896              END-IF
 19897           END-IF
 19898        END-IF
 19899     ELSE
 19900*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19901        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19902           IF (CLAIM-IS-OPEN)
 19903              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19904                 <> zeros
 19905              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19906                 <> zeros)
 19907              MOVE ER-2889      TO WS-ERROR
 19908              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19909              GO TO 7300-NEXT-CLAIM
 19910           ELSE
 19911              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19912*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19913                 IF (LF-COVERAGE-CANCELLED AND
 19914                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19915                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19916                         MOVE ER-2890 TO WS-ERROR
 19917                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19918                         GO TO 7300-NEXT-CLAIM
 19919                      ELSE
 19920                         MOVE ER-2898 TO WS-ERROR
 19921                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19922                         GO TO 7300-NEXT-CLAIM
 19923                      END-IF
 19924                 END-IF
 19925              ELSE
 19926                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19927                    and (CL-TOTAL-PAID-AMT = 0)
 19928                    GO TO 7300-NEXT-CLAIM
 19929                 END-IF
 19930                 IF (
 19931                      (AH-COVERAGE-CANCELLED)
 19932                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19933                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19934                      and (pb-ci-ah-cancel-amt +
 19935                         pb-c-ah-cancel-amt) <> zeros
 19936                    )
 19937                               OR
 19938                    (
 19939                      (LF-COVERAGE-CANCELLED)
 19940                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 365
* EL050.cbl
 19941                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19942                      and (pb-ci-lf-cancel-amt +
 19943                         pb-c-lf-cancel-amt) <> zeros
 19944                    )
 19945                       MOVE ER-2965 TO WS-ERROR
 19946                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19947                       GO TO 7300-NEXT-CLAIM
 19948                 END-IF
 19949                 IF LF-COVERAGE-CANCELLED
 19950                  IF CL-TOTAL-PAID-AMT > 0
 19951                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19952                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19953                        MOVE ER-2891 TO WS-ERROR
 19954                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19955                        GO TO 7300-NEXT-CLAIM
 19956                      END-IF
 19957                    ELSE
 19958****only show this error if cert num matches exactly
 19959                      IF PB-CERT-NO = CL-CERT-NO
 19960                         MOVE ER-2892 TO WS-ERROR
 19961                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19962                         GO TO 7300-NEXT-CLAIM
 19963                      END-IF
 19964                    END-IF
 19965                  END-IF
 19966                 END-IF
 19967              END-IF
 19968           END-IF
 19969        END-IF
 19970     END-IF
 19971
 19972     GO TO 7300-NEXT-CLAIM.
 19973
 19974 7300-CONTINUE.
 19975
 19976     IF W-BROWSE-SW = 'Y'
 19977
 19978* EXEC CICS ENDBR
 19979*            DATASET   (CLMS-ID)
 19980*        END-EXEC.
 19981     MOVE 0
 19982       TO DFHEIV11
 19983*    MOVE '&2                    $   #00019627' TO DFHEIV0
 19984     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19985     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19986     MOVE X'2020233030303139363237' TO DFHEIV0(25:11)
 19987     CALL 'kxdfhei1' USING DFHEIV0,
 19988           CLMS-ID,
 19989           DFHEIV11,
 19990           DFHEIV99
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994 7300-EXIT.
 19995     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 366
* EL050.cbl
 19997
 19998 7400-GET-REMAIN-TERM.
 19999
 20000* EXEC CICS LINK
 20001*        PROGRAM    ('ELRTRM')
 20002*        COMMAREA   (CALCULATION-PASS-AREA)
 20003*        LENGTH     (CP-COMM-LENGTH)
 20004*    END-EXEC.
 20005     MOVE 'ELRTRM' TO DFHEIV1
 20006*    MOVE '."C                   (   #00019636' TO DFHEIV0
 20007     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20009     MOVE X'2020233030303139363336' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0,
 20011           DFHEIV1,
 20012           CALCULATION-PASS-AREA,
 20013           CP-COMM-LENGTH,
 20014           DFHEIV99,
 20015           DFHEIV99,
 20016           DFHEIV99,
 20017           DFHEIV99
 20018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20019
 20020
 20021 7400-EXIT.
 20022     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 367
* EL050.cbl
 20024
 20025 7500-GET-REMAIN-AMOUNT.
 20026
 20027* EXEC CICS LINK
 20028*        PROGRAM    ('ELRAMT')
 20029*        COMMAREA   (CALCULATION-PASS-AREA)
 20030*        LENGTH     (CP-COMM-LENGTH)
 20031*    END-EXEC.
 20032     MOVE 'ELRAMT' TO DFHEIV1
 20033*    MOVE '."C                   (   #00019647' TO DFHEIV0
 20034     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20036     MOVE X'2020233030303139363437' TO DFHEIV0(25:11)
 20037     CALL 'kxdfhei1' USING DFHEIV0,
 20038           DFHEIV1,
 20039           CALCULATION-PASS-AREA,
 20040           CP-COMM-LENGTH,
 20041           DFHEIV99,
 20042           DFHEIV99,
 20043           DFHEIV99,
 20044           DFHEIV99
 20045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20046
 20047
 20048 7500-EXIT.
 20049     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 368
* EL050.cbl
 20051
 20052 7600-GET-REFUND.
 20053
 20054* EXEC CICS LINK
 20055*        PROGRAM    ('ELRFND')
 20056*        COMMAREA   (CALCULATION-PASS-AREA)
 20057*        LENGTH     (CP-COMM-LENGTH)
 20058*    END-EXEC.
 20059     MOVE 'ELRFND' TO DFHEIV1
 20060*    MOVE '."C                   (   #00019658' TO DFHEIV0
 20061     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20063     MOVE X'2020233030303139363538' TO DFHEIV0(25:11)
 20064     CALL 'kxdfhei1' USING DFHEIV0,
 20065           DFHEIV1,
 20066           CALCULATION-PASS-AREA,
 20067           CP-COMM-LENGTH,
 20068           DFHEIV99,
 20069           DFHEIV99,
 20070           DFHEIV99,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075 7600-EXIT.
 20076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 369
* EL050.cbl
 20078 7700-CALL-DL1.
 20079
 20080* EXEC CICS LINK
 20081*        PROGRAM    ('DLO001')
 20082*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20083*        LENGTH     (DLO001-COMM-LENGTH)
 20084*    END-EXEC.
 20085     MOVE 'DLO001' TO DFHEIV1
 20086*    MOVE '."C                   (   #00019668' TO DFHEIV0
 20087     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20089     MOVE X'2020233030303139363638' TO DFHEIV0(25:11)
 20090     CALL 'kxdfhei1' USING DFHEIV0,
 20091           DFHEIV1,
 20092           WS-DLO-MASTER-POLICY-FORM,
 20093           DLO001-COMM-LENGTH,
 20094           DFHEIV99,
 20095           DFHEIV99,
 20096           DFHEIV99,
 20097           DFHEIV99
 20098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20099
 20100
 20101 7700-EXIT.
 20102     EXIT.
 20103
 20104 7710-CALL-DL2.
 20105
 20106* EXEC CICS LINK
 20107*        PROGRAM    ('DLO002')
 20108*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20109*        LENGTH     (DLO002-COMM-LENGTH)
 20110*    END-EXEC.
 20111     MOVE 'DLO002' TO DFHEIV1
 20112*    MOVE '."C                   (   #00019678' TO DFHEIV0
 20113     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20115     MOVE X'2020233030303139363738' TO DFHEIV0(25:11)
 20116     CALL 'kxdfhei1' USING DFHEIV0,
 20117           DFHEIV1,
 20118           WS-DLO-INTERNAL-POLICY-FORM,
 20119           DLO002-COMM-LENGTH,
 20120           DFHEIV99,
 20121           DFHEIV99,
 20122           DFHEIV99,
 20123           DFHEIV99
 20124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20125
 20126
 20127 7710-EXIT.
 20128     EXIT.
 20129
 20130 7720-CALL-DL3.
 20131
 20132* EXEC CICS LINK
 20133*        PROGRAM    ('DLO003')
 20134*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20135*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 370
* EL050.cbl
 20136*    END-EXEC.
 20137     MOVE 'DLO003' TO DFHEIV1
 20138*    MOVE '."C                   (   #00019688' TO DFHEIV0
 20139     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20141     MOVE X'2020233030303139363838' TO DFHEIV0(25:11)
 20142     CALL 'kxdfhei1' USING DFHEIV0,
 20143           DFHEIV1,
 20144           WS-DLO-VALID-BANK-ID,
 20145           DLO003-COMM-LENGTH,
 20146           DFHEIV99,
 20147           DFHEIV99,
 20148           DFHEIV99,
 20149           DFHEIV99
 20150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20151
 20152
 20153 7720-EXIT.
 20154     EXIT.
 20155
 20156 7730-CALL-DL7.
 20157
 20158* EXEC CICS LINK
 20159*        PROGRAM    ('DLO007')
 20160*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20161*        LENGTH     (DLO007-COMM-LENGTH)
 20162*    END-EXEC.
 20163     MOVE 'DLO007' TO DFHEIV1
 20164*    MOVE '."C                   (   #00019698' TO DFHEIV0
 20165     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20167     MOVE X'2020233030303139363938' TO DFHEIV0(25:11)
 20168     CALL 'kxdfhei1' USING DFHEIV0,
 20169           DFHEIV1,
 20170           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20171           DLO007-COMM-LENGTH,
 20172           DFHEIV99,
 20173           DFHEIV99,
 20174           DFHEIV99,
 20175           DFHEIV99
 20176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20177
 20178
 20179 7730-EXIT.
 20180     EXIT.
 20181
 20182 7740-CALL-DL11.
 20183
 20184* EXEC CICS LINK
 20185*        PROGRAM    ('DLO011')
 20186*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20187*        LENGTH     (DLO011-COMM-LENGTH)
 20188*    END-EXEC.
 20189     MOVE 'DLO011' TO DFHEIV1
 20190*    MOVE '."C                   (   #00019708' TO DFHEIV0
 20191     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20193     MOVE X'2020233030303139373038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 371
* EL050.cbl
 20194     CALL 'kxdfhei1' USING DFHEIV0,
 20195           DFHEIV1,
 20196           WS-DLO-PREM-RATES-BEN-TYPE,
 20197           DLO011-COMM-LENGTH,
 20198           DFHEIV99,
 20199           DFHEIV99,
 20200           DFHEIV99,
 20201           DFHEIV99
 20202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20203
 20204
 20205 7740-EXIT.
 20206     EXIT.
 20207
 20208 7750-CALL-DL17.
 20209
 20210* EXEC CICS LINK
 20211*        PROGRAM    ('DLO017')
 20212*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20213*        LENGTH     (DLO017-COMM-LENGTH)
 20214*    END-EXEC.
 20215     MOVE 'DLO017' TO DFHEIV1
 20216*    MOVE '."C                   (   #00019718' TO DFHEIV0
 20217     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20219     MOVE X'2020233030303139373138' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0,
 20221           DFHEIV1,
 20222           WS-DLO-VALID-RATE-CODE,
 20223           DLO017-COMM-LENGTH,
 20224           DFHEIV99,
 20225           DFHEIV99,
 20226           DFHEIV99,
 20227           DFHEIV99
 20228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20229
 20230
 20231 7750-EXIT.
 20232     EXIT.
 20233
 20234 7755-CALL-DL19.
 20235
 20236* EXEC CICS LINK
 20237*        PROGRAM    ('DLO019')
 20238*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20239*        LENGTH     (DLO019-COMM-LENGTH)
 20240*    END-EXEC.
 20241     MOVE 'DLO019' TO DFHEIV1
 20242*    MOVE '."C                   (   #00019728' TO DFHEIV0
 20243     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20244     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20245     MOVE X'2020233030303139373238' TO DFHEIV0(25:11)
 20246     CALL 'kxdfhei1' USING DFHEIV0,
 20247           DFHEIV1,
 20248           WS-DLO-ORIG-COV-CAT,
 20249           DLO019-COMM-LENGTH,
 20250           DFHEIV99,
 20251           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 372
* EL050.cbl
 20252           DFHEIV99,
 20253           DFHEIV99
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20255
 20256
 20257 7755-EXIT.
 20258     EXIT.
 20259
 20260 7760-CALL-DL21.
 20261
 20262* EXEC CICS LINK
 20263*        PROGRAM    ('DLO021')
 20264*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20265*        LENGTH     (DLO021-COMM-LENGTH)
 20266*    END-EXEC.
 20267     MOVE 'DLO021' TO DFHEIV1
 20268*    MOVE '."C                   (   #00019738' TO DFHEIV0
 20269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20271     MOVE X'2020233030303139373338' TO DFHEIV0(25:11)
 20272     CALL 'kxdfhei1' USING DFHEIV0,
 20273           DFHEIV1,
 20274           WS-DLO-VALID-LOAN-OFFICER,
 20275           DLO021-COMM-LENGTH,
 20276           DFHEIV99,
 20277           DFHEIV99,
 20278           DFHEIV99,
 20279           DFHEIV99
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20281
 20282
 20283 7760-EXIT.
 20284     EXIT.
 20285
 20286 7770-CALL-DL22.
 20287
 20288* EXEC CICS LINK
 20289*        PROGRAM    ('DLO022')
 20290*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20291*        LENGTH     (DLO022-COMM-LENGTH)
 20292*    END-EXEC.
 20293     MOVE 'DLO022' TO DFHEIV1
 20294*    MOVE '."C                   (   #00019748' TO DFHEIV0
 20295     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303139373438' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           DFHEIV1,
 20300           WS-DLO-VALID-STATE-CODE,
 20301           DLO022-COMM-LENGTH,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99,
 20305           DFHEIV99
 20306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20307
 20308
 20309 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 373
* EL050.cbl
 20310     EXIT.
 20311
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 374
* EL050.cbl
 20313
 20314 7780-CALL-AGG.
 20315
 20316* EXEC CICS LINK
 20317*        PROGRAM    ('ELAGGO')
 20318*        COMMAREA   (WS-PASS-to-pemaggo)
 20319*        LENGTH     (ws-passed-key-LENGTH)
 20320*    END-EXEC.
 20321     MOVE 'ELAGGO' TO DFHEIV1
 20322*    MOVE '."C                   (   #00019760' TO DFHEIV0
 20323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20325     MOVE X'2020233030303139373630' TO DFHEIV0(25:11)
 20326     CALL 'kxdfhei1' USING DFHEIV0,
 20327           DFHEIV1,
 20328           WS-PASS-to-pemaggo,
 20329           ws-passed-key-LENGTH,
 20330           DFHEIV99,
 20331           DFHEIV99,
 20332           DFHEIV99,
 20333           DFHEIV99
 20334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20335
 20336 7780-EXIT.
 20337     EXIT.
 20338 7785-CALL-HLDI.
 20339
 20340* EXEC CICS LINK
 20341*        PROGRAM    ('ELHLDI')
 20342*        COMMAREA   (HLDI-PASS-AREA)
 20343*        LENGTH     (HLDI-PASS-AREA-LEN)
 20344*    END-EXEC.
 20345     MOVE 'ELHLDI' TO DFHEIV1
 20346*    MOVE '."C                   (   #00019768' TO DFHEIV0
 20347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20349     MOVE X'2020233030303139373638' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0,
 20351           DFHEIV1,
 20352           HLDI-PASS-AREA,
 20353           HLDI-PASS-AREA-LEN,
 20354           DFHEIV99,
 20355           DFHEIV99,
 20356           DFHEIV99,
 20357           DFHEIV99
 20358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20359
 20360 7785-EXIT.
 20361     EXIT.
 20362 7786-CALL-HLDIM.
 20363
 20364* EXEC CICS LINK
 20365*        PROGRAM    ('ELHLDIM')
 20366*        COMMAREA   (HLDI-PASS-AREA)
 20367*        LENGTH     (HLDI-PASS-AREA-LEN)
 20368*    END-EXEC.
 20369     MOVE 'ELHLDIM' TO DFHEIV1
 20370*    MOVE '."C                   (   #00019776' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 375
* EL050.cbl
 20371     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20373     MOVE X'2020233030303139373736' TO DFHEIV0(25:11)
 20374     CALL 'kxdfhei1' USING DFHEIV0,
 20375           DFHEIV1,
 20376           HLDI-PASS-AREA,
 20377           HLDI-PASS-AREA-LEN,
 20378           DFHEIV99,
 20379           DFHEIV99,
 20380           DFHEIV99,
 20381           DFHEIV99
 20382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20383
 20384 7786-EXIT.
 20385     EXIT.
 20386 7790-CALL-ZIP-VERIFY.
 20387
 20388
 20389* EXEC CICS LINK
 20390*        PROGRAM    ('WSZIPCD')
 20391*        COMMAREA   (ZIPCD-PASS-AREA)
 20392*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20393*    END-EXEC.
 20394     MOVE 'WSZIPCD' TO DFHEIV1
 20395*    MOVE '."C                   (   #00019785' TO DFHEIV0
 20396     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20398     MOVE X'2020233030303139373835' TO DFHEIV0(25:11)
 20399     CALL 'kxdfhei1' USING DFHEIV0,
 20400           DFHEIV1,
 20401           ZIPCD-PASS-AREA,
 20402           ZIPCD-PASS-AREA-LEN,
 20403           DFHEIV99,
 20404           DFHEIV99,
 20405           DFHEIV99,
 20406           DFHEIV99
 20407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20408
 20409
 20410 7790-EXIT.
 20411     EXIT.
 20412 7800-REWRITE-CERT.
 20413******************************************************************
 20414*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20415*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20416******************************************************************
 20417
 20418     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20419        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20420        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20421        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20422
 20423* EXEC CICS REWRITE
 20424*                  DATASET (CERT-ID)
 20425*                  FROM    (CERTIFICATE-MASTER)
 20426*              END-EXEC
 20427     MOVE LENGTH OF
 20428      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 376
* EL050.cbl
 20429       TO DFHEIV11
 20430*    MOVE '&& L                  %   #00019803' TO DFHEIV0
 20431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20433     MOVE X'2020233030303139383033' TO DFHEIV0(25:11)
 20434     CALL 'kxdfhei1' USING DFHEIV0,
 20435           CERT-ID,
 20436           CERTIFICATE-MASTER,
 20437           DFHEIV11,
 20438           DFHEIV99
 20439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20440        GO TO 7800-EXIT.
 20441
 20442       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20443       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20444
 20445 7800-EXIT.
 20446      EXIT.
 20447
 20448 7900-DELETE-CERT.
 20449
 20450* EXEC CICS DELETE
 20451*        DATASET (CERT-ID)
 20452*    END-EXEC.
 20453*    MOVE '&(                    &   #00019816' TO DFHEIV0
 20454     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20455     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20456     MOVE X'2020233030303139383136' TO DFHEIV0(25:11)
 20457     CALL 'kxdfhei1' USING DFHEIV0,
 20458           CERT-ID,
 20459           DFHEIV99,
 20460           DFHEIV99,
 20461           DFHEIV99,
 20462           DFHEIV99
 20463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20464
 20465
 20466 7900-EXIT.
 20467     EXIT.
 20468
 20469 8000-WRITE-CERT.
 20470
 20471* EXEC CICS HANDLE CONDITION
 20472*        DUPKEY    (8000-FREE-MAIN)
 20473*    END-EXEC.
 20474*    MOVE '"$$                   ! + #00019824' TO DFHEIV0
 20475     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20477     MOVE X'2B20233030303139383234' TO DFHEIV0(25:11)
 20478     CALL 'kxdfhei1' USING DFHEIV0
 20479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20480
 20481
 20482
 20483* EXEC CICS WRITE
 20484*        DATASET     (CERT-ID)
 20485*        FROM        (CERTIFICATE-MASTER)
 20486*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 377
* EL050.cbl
 20487*    END-EXEC.
 20488     MOVE LENGTH OF
 20489      CERTIFICATE-MASTER
 20490       TO DFHEIV11
 20491*    MOVE '&$ L                  ''   #00019828' TO DFHEIV0
 20492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20494     MOVE X'2020233030303139383238' TO DFHEIV0(25:11)
 20495     CALL 'kxdfhei1' USING DFHEIV0,
 20496           CERT-ID,
 20497           CERTIFICATE-MASTER,
 20498           DFHEIV11,
 20499           ELCERT-KEY,
 20500           DFHEIV99,
 20501           DFHEIV99
 20502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20503
 20504
 20505 8000-FREE-MAIN.
 20506
 20507 8000-EXIT.
 20508      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 378
* EL050.cbl
 20510
 20511 8100-READ-ERPNDM.
 20512
 20513* EXEC CICS HANDLE CONDITION
 20514*         NOTFND     (8100-NOTFND)
 20515*         ENDFILE    (8100-NOTFND)
 20516*    END-EXEC.
 20517*    MOVE '"$I''                  ! , #00019841' TO DFHEIV0
 20518     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20520     MOVE X'2C20233030303139383431' TO DFHEIV0(25:11)
 20521     CALL 'kxdfhei1' USING DFHEIV0
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20523
 20524
 20525     MOVE SPACES                 TO ERPNDM-FOUND.
 20526     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20527
 20528
 20529* EXEC CICS READ UPDATE
 20530*         DATASET   (FILE-ERPNDM)
 20531*         RIDFLD    (PM-CONTROL-PRIMARY)
 20532*         INTO      (PENDING-MAILING-DATA)
 20533*    END-EXEC.
 20534     MOVE LENGTH OF
 20535      PENDING-MAILING-DATA
 20536       TO DFHEIV11
 20537*    MOVE '&"IL       EU         (   #00019849' TO DFHEIV0
 20538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20539     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20540     MOVE X'2020233030303139383439' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0,
 20542           FILE-ERPNDM,
 20543           PENDING-MAILING-DATA,
 20544           DFHEIV11,
 20545           PM-CONTROL-PRIMARY,
 20546           DFHEIV99,
 20547           DFHEIV99,
 20548           DFHEIV99
 20549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20550
 20551
 20552     GO TO 8100-EXIT.
 20553
 20554 8100-NOTFND.
 20555
 20556     MOVE 'X'                    TO ERPNDM-FOUND.
 20557     MOVE ER-2694                TO WS-ERROR.
 20558     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20559     MOVE ER-2883                TO WS-ERROR
 20560     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20561     .
 20562 8100-EXIT.
 20563     EXIT.
 20564 8102-REWRITE-ERPNDM.
 20565
 20566
 20567* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 379
* EL050.cbl
 20568*         DATASET    (FILE-ERPNDM)
 20569*         FROM       (PENDING-MAILING-DATA)
 20570*    END-EXEC
 20571     MOVE LENGTH OF
 20572      PENDING-MAILING-DATA
 20573       TO DFHEIV11
 20574*    MOVE '&& L                  %   #00019869' TO DFHEIV0
 20575     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20577     MOVE X'2020233030303139383639' TO DFHEIV0(25:11)
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           FILE-ERPNDM,
 20580           PENDING-MAILING-DATA,
 20581           DFHEIV11,
 20582           DFHEIV99
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20584
 20585     .
 20586 8102-EXIT.
 20587     EXIT.
 20588 8104-UNLOCK-ERPNDM.
 20589
 20590
 20591* EXEC CICS UNLOCK
 20592*         DATASET   (FILE-ERPNDM)
 20593*    END-EXEC
 20594*    MOVE '&*                    #   #00019879' TO DFHEIV0
 20595     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20597     MOVE X'2020233030303139383739' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0,
 20599           FILE-ERPNDM,
 20600           DFHEIV99
 20601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20602
 20603     .
 20604 8104-EXIT.
 20605     EXIT.
 20606 8110-READ-ERMAIL.
 20607
 20608* EXEC CICS HANDLE CONDITION
 20609*         NOTFND     (8110-NOTFND)
 20610*         ENDFILE    (8110-NOTFND)
 20611*    END-EXEC.
 20612*    MOVE '"$I''                  ! - #00019887' TO DFHEIV0
 20613     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20615     MOVE X'2D20233030303139383837' TO DFHEIV0(25:11)
 20616     CALL 'kxdfhei1' USING DFHEIV0
 20617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20618
 20619
 20620     MOVE SPACES                 TO ERMAIL-FOUND.
 20621     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20622     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20623     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20624     MOVE PB-SV-STATE            TO MA-STATE.
 20625
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 380
* EL050.cbl
 20626
 20627* EXEC CICS READ
 20628*         UPDATE
 20629*         DATASET   (FILE-ERMAIL)
 20630*         RIDFLD    (MA-CONTROL-PRIMARY)
 20631*         INTO      (MAILING-DATA)
 20632*    END-EXEC.
 20633     MOVE LENGTH OF
 20634      MAILING-DATA
 20635       TO DFHEIV11
 20636*    MOVE '&"IL       EU         (   #00019898' TO DFHEIV0
 20637     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20639     MOVE X'2020233030303139383938' TO DFHEIV0(25:11)
 20640     CALL 'kxdfhei1' USING DFHEIV0,
 20641           FILE-ERMAIL,
 20642           MAILING-DATA,
 20643           DFHEIV11,
 20644           MA-CONTROL-PRIMARY,
 20645           DFHEIV99,
 20646           DFHEIV99,
 20647           DFHEIV99
 20648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20649
 20650
 20651     GO TO 8110-EXIT.
 20652
 20653 8110-NOTFND.
 20654     MOVE 'X'                    TO ERMAIL-FOUND.
 20655
 20656 8110-EXIT.
 20657     EXIT.
 20658
 20659 8120-REWRITE-ERMAIL.
 20660
 20661* EXEC CICS REWRITE
 20662*         DATASET    (FILE-ERMAIL)
 20663*         FROM       (MAILING-DATA)
 20664*    END-EXEC.
 20665     MOVE LENGTH OF
 20666      MAILING-DATA
 20667       TO DFHEIV11
 20668*    MOVE '&& L                  %   #00019914' TO DFHEIV0
 20669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20671     MOVE X'2020233030303139393134' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0,
 20673           FILE-ERMAIL,
 20674           MAILING-DATA,
 20675           DFHEIV11,
 20676           DFHEIV99
 20677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20678
 20679
 20680 8120-EXIT.
 20681     EXIT.
 20682
 20683 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 381
* EL050.cbl
 20684
 20685* EXEC CICS HANDLE CONDITION
 20686*         DUPKEY   (8130-EXIT)
 20687*    END-EXEC.
 20688*    MOVE '"$$                   ! . #00019923' TO DFHEIV0
 20689     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20691     MOVE X'2E20233030303139393233' TO DFHEIV0(25:11)
 20692     CALL 'kxdfhei1' USING DFHEIV0
 20693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20694
 20695
 20696
 20697* EXEC CICS WRITE
 20698*         DATASET     (FILE-ERMAIL)
 20699*         RIDFLD      (MA-CONTROL-PRIMARY)
 20700*         FROM        (MAILING-DATA)
 20701*    END-EXEC.
 20702     MOVE LENGTH OF
 20703      MAILING-DATA
 20704       TO DFHEIV11
 20705*    MOVE '&$ L                  ''   #00019927' TO DFHEIV0
 20706     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20708     MOVE X'2020233030303139393237' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           FILE-ERMAIL,
 20711           MAILING-DATA,
 20712           DFHEIV11,
 20713           MA-CONTROL-PRIMARY,
 20714           DFHEIV99,
 20715           DFHEIV99
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719 8130-EXIT.
 20720     EXIT.
 20721
 20722 8140-UNLOCK-ERMAIL.
 20723
 20724* EXEC CICS UNLOCK
 20725*         DATASET   (FILE-ERMAIL)
 20726*    END-EXEC.
 20727*    MOVE '&*                    #   #00019937' TO DFHEIV0
 20728     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20730     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 20731     CALL 'kxdfhei1' USING DFHEIV0,
 20732           FILE-ERMAIL,
 20733           DFHEIV99
 20734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20735
 20736
 20737 8140-EXIT.
 20738     EXIT.
 20739
 20740 8150-read-elcrtt.
 20741
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 382
* EL050.cbl
 20742
 20743* EXEC CICS HANDLE CONDITION
 20744*        NOTFND   (8150-exit)
 20745*    END-EXEC
 20746*    MOVE '"$I                   ! / #00019946' TO DFHEIV0
 20747     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20749     MOVE X'2F20233030303139393436' TO DFHEIV0(25:11)
 20750     CALL 'kxdfhei1' USING DFHEIV0
 20751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20752
 20753     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20754     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20755
 20756
 20757* EXEC CICS READ
 20758*        DATASET  (CRTT-ID)
 20759*        RIDFLD   (WS-ELCRTT-KEY)
 20760*        INTO     (CERTIFICATE-TRAILERS)
 20761*    END-EXEC
 20762     MOVE LENGTH OF
 20763      CERTIFICATE-TRAILERS
 20764       TO DFHEIV11
 20765*    MOVE '&"IL       E          (   #00019953' TO DFHEIV0
 20766     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20768     MOVE X'2020233030303139393533' TO DFHEIV0(25:11)
 20769     CALL 'kxdfhei1' USING DFHEIV0,
 20770           CRTT-ID,
 20771           CERTIFICATE-TRAILERS,
 20772           DFHEIV11,
 20773           WS-ELCRTT-KEY,
 20774           DFHEIV99,
 20775           DFHEIV99,
 20776           DFHEIV99
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20778
 20779     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20780     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20781     move cs-vehicle-odometer    to ws-vehicle-odometer
 20782
 20783     .
 20784 8150-exit.
 20785     exit.
 20786 8180-UPDATE-VIN-NUMBER.
 20787
 20788* EXEC CICS HANDLE CONDITION
 20789*        NOTFND   (8180-NOTFND)
 20790*    END-EXEC.
 20791*    MOVE '"$I                   ! 0 #00019967' TO DFHEIV0
 20792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20794     MOVE X'3020233030303139393637' TO DFHEIV0(25:11)
 20795     CALL 'kxdfhei1' USING DFHEIV0
 20796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20797
 20798
 20799     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 383
* EL050.cbl
 20800     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20801
 20802
 20803* EXEC CICS READ
 20804*        UPDATE
 20805*        DATASET  (CRTT-ID)
 20806*        RIDFLD   (WS-ELCRTT-KEY)
 20807*        INTO     (CERTIFICATE-TRAILERS)
 20808*    END-EXEC.
 20809     MOVE LENGTH OF
 20810      CERTIFICATE-TRAILERS
 20811       TO DFHEIV11
 20812*    MOVE '&"IL       EU         (   #00019974' TO DFHEIV0
 20813     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20814     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20815     MOVE X'2020233030303139393734' TO DFHEIV0(25:11)
 20816     CALL 'kxdfhei1' USING DFHEIV0,
 20817           CRTT-ID,
 20818           CERTIFICATE-TRAILERS,
 20819           DFHEIV11,
 20820           WS-ELCRTT-KEY,
 20821           DFHEIV99,
 20822           DFHEIV99,
 20823           DFHEIV99
 20824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20825
 20826
 20827     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20828        or (hldi-pass-area not = spaces)
 20829        move pa-modelyear        to cs-year
 20830        move pa-makename         to cs-make
 20831        move pa-modelname        to cs-model
 20832        move pa-seriesname       to cs-future
 20833        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20834
 20835* EXEC CICS REWRITE
 20836*           DATASET  (CRTT-ID)
 20837*           FROM     (CERTIFICATE-TRAILERS)
 20838*        END-EXEC
 20839     MOVE LENGTH OF
 20840      CERTIFICATE-TRAILERS
 20841       TO DFHEIV11
 20842*    MOVE '&& L                  %   #00019988' TO DFHEIV0
 20843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20845     MOVE X'2020233030303139393838' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0,
 20847           CRTT-ID,
 20848           CERTIFICATE-TRAILERS,
 20849           DFHEIV11,
 20850           DFHEIV99
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20852     ELSE
 20853
 20854* EXEC CICS UNLOCK
 20855*          DATASET  (CRTT-ID)
 20856*       END-EXEC
 20857*    MOVE '&*                    #   #00019993' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 384
* EL050.cbl
 20858     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20859     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20860     MOVE X'2020233030303139393933' TO DFHEIV0(25:11)
 20861     CALL 'kxdfhei1' USING DFHEIV0,
 20862           CRTT-ID,
 20863           DFHEIV99
 20864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20865     END-IF.
 20866
 20867     GO TO 8180-EXIT.
 20868
 20869 8180-NOTFND.
 20870
 20871     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20872     MOVE 'CS'         TO CS-RECORD-ID.
 20873     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20874     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20875     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20876     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20877
 20878* EXEC CICS WRITE
 20879*       DATASET  (CRTT-ID)
 20880*       RIDFLD   (WS-ELCRTT-KEY)
 20881*       FROM     (CERTIFICATE-TRAILERS)
 20882*    END-EXEC.
 20883     MOVE LENGTH OF
 20884      CERTIFICATE-TRAILERS
 20885       TO DFHEIV11
 20886*    MOVE '&$ L                  ''   #00020008' TO DFHEIV0
 20887     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20889     MOVE X'2020233030303230303038' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0,
 20891           CRTT-ID,
 20892           CERTIFICATE-TRAILERS,
 20893           DFHEIV11,
 20894           WS-ELCRTT-KEY,
 20895           DFHEIV99,
 20896           DFHEIV99
 20897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20898
 20899
 20900 8180-EXIT.
 20901     EXIT.
 20902
 20903 8190-UPDATE-REFUND-CLAIM-FLAG.
 20904
 20905* EXEC CICS HANDLE CONDITION
 20906*        NOTFND   (8190-NOTFND)
 20907*    END-EXEC.
 20908*    MOVE '"$I                   ! 1 #00020018' TO DFHEIV0
 20909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20911     MOVE X'3120233030303230303138' TO DFHEIV0(25:11)
 20912     CALL 'kxdfhei1' USING DFHEIV0
 20913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20914
 20915
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 385
* EL050.cbl
 20916     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20917     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20918
 20919
 20920* EXEC CICS READ
 20921*        UPDATE
 20922*        DATASET  (CRTT-ID)
 20923*        RIDFLD   (WS-ELCRTT-KEY)
 20924*        INTO     (CERTIFICATE-TRAILERS)
 20925*    END-EXEC.
 20926     MOVE LENGTH OF
 20927      CERTIFICATE-TRAILERS
 20928       TO DFHEIV11
 20929*    MOVE '&"IL       EU         (   #00020025' TO DFHEIV0
 20930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20932     MOVE X'2020233030303230303235' TO DFHEIV0(25:11)
 20933     CALL 'kxdfhei1' USING DFHEIV0,
 20934           CRTT-ID,
 20935           CERTIFICATE-TRAILERS,
 20936           DFHEIV11,
 20937           WS-ELCRTT-KEY,
 20938           DFHEIV99,
 20939           DFHEIV99,
 20940           DFHEIV99
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20942
 20943
 20944     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20945
 20946* EXEC CICS REWRITE
 20947*       DATASET  (CRTT-ID)
 20948*       FROM     (CERTIFICATE-TRAILERS)
 20949*    END-EXEC.
 20950     MOVE LENGTH OF
 20951      CERTIFICATE-TRAILERS
 20952       TO DFHEIV11
 20953*    MOVE '&& L                  %   #00020033' TO DFHEIV0
 20954     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303230303333' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
 20958           CRTT-ID,
 20959           CERTIFICATE-TRAILERS,
 20960           DFHEIV11,
 20961           DFHEIV99
 20962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20963
 20964
 20965     GO TO 8190-EXIT.
 20966
 20967 8190-NOTFND.
 20968
 20969     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20970     MOVE 'CS'         TO CS-RECORD-ID.
 20971     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20972     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20973     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 386
* EL050.cbl
 20974     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20975
 20976* EXEC CICS WRITE
 20977*       DATASET  (CRTT-ID)
 20978*       RIDFLD   (WS-ELCRTT-KEY)
 20979*       FROM     (CERTIFICATE-TRAILERS)
 20980*    END-EXEC.
 20981     MOVE LENGTH OF
 20982      CERTIFICATE-TRAILERS
 20983       TO DFHEIV11
 20984*    MOVE '&$ L                  ''   #00020048' TO DFHEIV0
 20985     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20987     MOVE X'2020233030303230303438' TO DFHEIV0(25:11)
 20988     CALL 'kxdfhei1' USING DFHEIV0,
 20989           CRTT-ID,
 20990           CERTIFICATE-TRAILERS,
 20991           DFHEIV11,
 20992           WS-ELCRTT-KEY,
 20993           DFHEIV99,
 20994           DFHEIV99
 20995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20996
 20997
 20998 8190-EXIT.
 20999     EXIT.
 21000
 21001 8195-UPDATE-AGE-FLAGS.
 21002
 21003* EXEC CICS HANDLE CONDITION
 21004*        NOTFND   (8195-NOTFND)
 21005*    END-EXEC.
 21006*    MOVE '"$I                   ! 2 #00020058' TO DFHEIV0
 21007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21009     MOVE X'3220233030303230303538' TO DFHEIV0(25:11)
 21010     CALL 'kxdfhei1' USING DFHEIV0
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21012
 21013
 21014     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21015     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21016
 21017
 21018* EXEC CICS READ
 21019*        UPDATE
 21020*        DATASET  (CRTT-ID)
 21021*        RIDFLD   (WS-ELCRTT-KEY)
 21022*        INTO     (CERTIFICATE-TRAILERS)
 21023*    END-EXEC.
 21024     MOVE LENGTH OF
 21025      CERTIFICATE-TRAILERS
 21026       TO DFHEIV11
 21027*    MOVE '&"IL       EU         (   #00020065' TO DFHEIV0
 21028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21030     MOVE X'2020233030303230303635' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 387
* EL050.cbl
 21032           CRTT-ID,
 21033           CERTIFICATE-TRAILERS,
 21034           DFHEIV11,
 21035           WS-ELCRTT-KEY,
 21036           DFHEIV99,
 21037           DFHEIV99,
 21038           DFHEIV99
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21040
 21041
 21042     IF WS-INS-AGE-SET = 'Y'
 21043        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21044     END-IF
 21045     IF WS-JNT-AGE-SET = 'Y'
 21046        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21047     END-IF
 21048
 21049
 21050* EXEC CICS REWRITE
 21051*       DATASET  (CRTT-ID)
 21052*       FROM     (CERTIFICATE-TRAILERS)
 21053*    END-EXEC.
 21054     MOVE LENGTH OF
 21055      CERTIFICATE-TRAILERS
 21056       TO DFHEIV11
 21057*    MOVE '&& L                  %   #00020079' TO DFHEIV0
 21058     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303230303739' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           CRTT-ID,
 21063           CERTIFICATE-TRAILERS,
 21064           DFHEIV11,
 21065           DFHEIV99
 21066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21067
 21068
 21069     GO TO 8195-EXIT.
 21070
 21071 8195-NOTFND.
 21072
 21073     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21074     MOVE 'CS'         TO CS-RECORD-ID.
 21075     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21076     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21077     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21078     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21079     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21080
 21081* EXEC CICS WRITE
 21082*       DATASET  (CRTT-ID)
 21083*       RIDFLD   (WS-ELCRTT-KEY)
 21084*       FROM     (CERTIFICATE-TRAILERS)
 21085*    END-EXEC.
 21086     MOVE LENGTH OF
 21087      CERTIFICATE-TRAILERS
 21088       TO DFHEIV11
 21089*    MOVE '&$ L                  ''   #00020095' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 388
* EL050.cbl
 21090     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21092     MOVE X'2020233030303230303935' TO DFHEIV0(25:11)
 21093     CALL 'kxdfhei1' USING DFHEIV0,
 21094           CRTT-ID,
 21095           CERTIFICATE-TRAILERS,
 21096           DFHEIV11,
 21097           WS-ELCRTT-KEY,
 21098           DFHEIV99,
 21099           DFHEIV99
 21100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21101
 21102
 21103 8195-EXIT.
 21104     EXIT.
 21105
 21106 8200-READ-REIN-TABLE.
 21107
 21108* EXEC CICS HANDLE CONDITION
 21109*         NOTFND   (8200-NOTFND)
 21110*    END-EXEC.
 21111*    MOVE '"$I                   ! 3 #00020105' TO DFHEIV0
 21112     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21114     MOVE X'3320233030303230313035' TO DFHEIV0(25:11)
 21115     CALL 'kxdfhei1' USING DFHEIV0
 21116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21117
 21118
 21119
 21120* EXEC CICS READ
 21121*        DATASET     (REIN-ID)
 21122*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21123*        RIDFLD      (ERREIN-KEY)
 21124*    END-EXEC.
 21125*    MOVE '&"S        E          (   #00020109' TO DFHEIV0
 21126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21128     MOVE X'2020233030303230313039' TO DFHEIV0(25:11)
 21129     CALL 'kxdfhei1' USING DFHEIV0,
 21130           REIN-ID,
 21131           DFHEIV20,
 21132           DFHEIV99,
 21133           ERREIN-KEY,
 21134           DFHEIV99,
 21135           DFHEIV99,
 21136           DFHEIV99
 21137     SET ADDRESS OF REINSURANCE-RECORD TO
 21138         DFHEIV20
 21139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21140
 21141
 21142     GO TO 8200-EXIT.
 21143
 21144 8200-NOTFND.
 21145     MOVE 'N'             TO WS-REIN-READ-SW.
 21146
 21147 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 389
* EL050.cbl
 21148      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 390
* EL050.cbl
 21150
 21151 8300-READ-CTBL-TABLE.
 21152
 21153* EXEC CICS HANDLE CONDITION
 21154*        NOTFND    (8300-NOTFND)
 21155*        DISABLED  (8300-ERRESS-PROBLEM)
 21156*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21157*        ENDFILE   (8300-NOTFND)
 21158*    END-EXEC.
 21159*    MOVE '"$IcJ''                ! 4 #00020125' TO DFHEIV0
 21160     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21162     MOVE X'3420233030303230313235' TO DFHEIV0(25:11)
 21163     CALL 'kxdfhei1' USING DFHEIV0
 21164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21165
 21166
 21167
 21168* EXEC CICS READ
 21169*        DATASET     (CTBL-ID)
 21170*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21171*        RIDFLD      (ERCTBL-KEY)
 21172*    END-EXEC.
 21173*    MOVE '&"S        E          (   #00020132' TO DFHEIV0
 21174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21176     MOVE X'2020233030303230313332' TO DFHEIV0(25:11)
 21177     CALL 'kxdfhei1' USING DFHEIV0,
 21178           CTBL-ID,
 21179           DFHEIV20,
 21180           DFHEIV99,
 21181           ERCTBL-KEY,
 21182           DFHEIV99,
 21183           DFHEIV99,
 21184           DFHEIV99
 21185     SET ADDRESS OF COMM-TABLE-RECORD TO
 21186         DFHEIV20
 21187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21188
 21189
 21190     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21191
 21192     GO TO 8300-EXIT.
 21193
 21194 8300-NOTFND.
 21195
 21196     IF CTBL-SW = '0530'
 21197         MOVE 'AA'                     TO WS-AH-COMP-CD
 21198         MOVE '0550'                   TO CTBL-SW
 21199         MOVE '1'                      TO WS-CTBL-READ-SW
 21200         GO TO 8300-EXIT.
 21201
 21202     IF CTBL-SW = '0540'
 21203         MOVE 'AA'                     TO WS-LF-COMP-CD
 21204         MOVE '0550'                   TO CTBL-SW
 21205         MOVE '1'                      TO WS-CTBL-READ-SW
 21206         GO TO 8300-EXIT.
 21207
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 391
* EL050.cbl
 21208     IF CTBL-SW = '0550'
 21209         MOVE '2'                      TO WS-CTBL-READ-SW
 21210         GO TO 8300-EXIT.
 21211
 21212     GO TO 8300-EXIT.
 21213
 21214 8300-ERRESS-PROBLEM.
 21215
 21216      MOVE ER-8050              TO WS-ERROR.
 21217      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21218
 21219     GO TO 8300-EXIT.
 21220
 21221 8300-EXIT.
 21222      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 392
* EL050.cbl
 21224
 21225
 21226 8400-GETMAIN-ERFORM.
 21227
 21228
 21229* EXEC CICS   GETMAIN
 21230*        LENGTH  (500)
 21231*        SET     (ADDRESS OF FORM-MASTER)
 21232*    END-EXEC.
 21233     MOVE 500
 21234       TO DFHEIV11
 21235*    MOVE '," L                  $   #00020176' TO DFHEIV0
 21236     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21238     MOVE X'2020233030303230313736' TO DFHEIV0(25:11)
 21239     CALL 'kxdfhei1' USING DFHEIV0,
 21240           DFHEIV20,
 21241           DFHEIV11,
 21242           DFHEIV99
 21243     SET ADDRESS OF FORM-MASTER TO
 21244         DFHEIV20
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21246
 21247
 21248     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21249
 21250 8400-EXIT.
 21251      EXIT.
 21252
 21253 8450-READ-FORM-MASTER.
 21254
 21255
 21256* EXEC CICS  HANDLE CONDITION
 21257*        NOTFND   (8450-FORM-NOT-FOUND)
 21258*        ENDFILE  (8450-FORM-NOT-FOUND)
 21259*    END-EXEC.
 21260*    MOVE '"$I''                  ! 5 #00020188' TO DFHEIV0
 21261     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21263     MOVE X'3520233030303230313838' TO DFHEIV0(25:11)
 21264     CALL 'kxdfhei1' USING DFHEIV0
 21265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21266
 21267
 21268
 21269* EXEC CICS   READ
 21270*        DATASET   (FORM-ID)
 21271*        RIDFLD    (ERFORM-KEY)
 21272*        INTO      (FORM-MASTER)
 21273*        GTEQ
 21274*    END-EXEC.
 21275     MOVE LENGTH OF
 21276      FORM-MASTER
 21277       TO DFHEIV11
 21278*    MOVE '&"IL       G          (   #00020193' TO DFHEIV0
 21279     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21281     MOVE X'2020233030303230313933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 393
* EL050.cbl
 21282     CALL 'kxdfhei1' USING DFHEIV0,
 21283           FORM-ID,
 21284           FORM-MASTER,
 21285           DFHEIV11,
 21286           ERFORM-KEY,
 21287           DFHEIV99,
 21288           DFHEIV99,
 21289           DFHEIV99
 21290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21291
 21292
 21293     MOVE  'Y'           TO  FORM-MASTER-SW.
 21294
 21295     GO TO  8450-EXIT.
 21296
 21297 8450-FORM-NOT-FOUND.
 21298
 21299     MOVE  'N'           TO  FORM-MASTER-SW.
 21300
 21301 8450-EXIT.
 21302      EXIT.
 21303
 21304 8500-DATE-CONVERT.
 21305
 21306* EXEC CICS LINK
 21307*        PROGRAM    ('ELDATCV')
 21308*        COMMAREA   (DATE-CONVERSION-DATA)
 21309*        LENGTH     (DC-COMM-LENGTH)
 21310*    END-EXEC.
 21311     MOVE 'ELDATCV' TO DFHEIV1
 21312*    MOVE '."C                   (   #00020212' TO DFHEIV0
 21313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21315     MOVE X'2020233030303230323132' TO DFHEIV0(25:11)
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           DFHEIV1,
 21318           DATE-CONVERSION-DATA,
 21319           DC-COMM-LENGTH,
 21320           DFHEIV99,
 21321           DFHEIV99,
 21322           DFHEIV99,
 21323           DFHEIV99
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21325
 21326
 21327 8500-EXIT.
 21328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 394
* EL050.cbl
 21330
 21331 8555-RELOAD-CONTROL-FILE.
 21332     CONTINUE.
 21333
 21334 8555-EXIT.
 21335     EXIT.
 21336
 21337 8557-GETMAIN-ERPLAN.
 21338
 21339
 21340* EXEC CICS GETMAIN
 21341*        LENGTH    (840)
 21342*        SET       (ADDRESS OF PLAN-RECORDS)
 21343*    END-EXEC.
 21344     MOVE 840
 21345       TO DFHEIV11
 21346*    MOVE '," L                  $   #00020230' TO DFHEIV0
 21347     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21349     MOVE X'2020233030303230323330' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0,
 21351           DFHEIV20,
 21352           DFHEIV11,
 21353           DFHEIV99
 21354     SET ADDRESS OF PLAN-RECORDS TO
 21355         DFHEIV20
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21357
 21358
 21359     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21360
 21361 8557-EXIT.
 21362     EXIT.
 21363
 21364 8560-GETMAIN.
 21365
 21366* EXEC CICS GETMAIN
 21367*        LENGTH    (2000)
 21368*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21369*    END-EXEC.
 21370     MOVE 2000
 21371       TO DFHEIV11
 21372*    MOVE '," L                  $   #00020241' TO DFHEIV0
 21373     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21375     MOVE X'2020233030303230323431' TO DFHEIV0(25:11)
 21376     CALL 'kxdfhei1' USING DFHEIV0,
 21377           DFHEIV20,
 21378           DFHEIV11,
 21379           DFHEIV99
 21380     SET ADDRESS OF ACCOUNT-MASTER TO
 21381         DFHEIV20
 21382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21383
 21384
 21385     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21386
 21387 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 395
* EL050.cbl
 21388     EXIT.
 21389
 21390 8570-START-ACCOUNT-MASTER.
 21391
 21392* EXEC CICS HANDLE CONDITION
 21393*        NOTFND    (0199-ACCT-NOT-FOUND)
 21394*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21395*    END-EXEC.
 21396*    MOVE '"$I''                  ! 6 #00020252' TO DFHEIV0
 21397     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21399     MOVE X'3620233030303230323532' TO DFHEIV0(25:11)
 21400     CALL 'kxdfhei1' USING DFHEIV0
 21401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21402
 21403
 21404
 21405* EXEC CICS STARTBR
 21406*        DATASET    (ACCT-ID)
 21407*        RIDFLD     (ERACCT-KEY)
 21408*        GTEQ
 21409*    END-EXEC.
 21410     MOVE 0
 21411       TO DFHEIV11
 21412*    MOVE '&,         G          &   #00020257' TO DFHEIV0
 21413     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21414     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21415     MOVE X'2020233030303230323537' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0,
 21417           ACCT-ID,
 21418           ERACCT-KEY,
 21419           DFHEIV99,
 21420           DFHEIV11,
 21421           DFHEIV99
 21422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21423
 21424
 21425 8570-EXIT.
 21426     EXIT.
 21427
 21428 8580-READ-ACCOUNT-MASTER.
 21429
 21430* EXEC CICS HANDLE CONDITION
 21431*        NOTFND    (0199-ACCT-NOT-FOUND)
 21432*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21433*    END-EXEC.
 21434*    MOVE '"$I''                  ! 7 #00020267' TO DFHEIV0
 21435     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21437     MOVE X'3720233030303230323637' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0
 21439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21440
 21441
 21442
 21443* EXEC CICS READNEXT
 21444*        DATASET     (ACCT-ID)
 21445*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 396
* EL050.cbl
 21446*        RIDFLD      (ERACCT-KEY)
 21447*    END-EXEC.
 21448     MOVE LENGTH OF
 21449      ACCOUNT-MASTER
 21450       TO DFHEIV12
 21451     MOVE 0
 21452       TO DFHEIV11
 21453*    MOVE '&.IL                  )   #00020272' TO DFHEIV0
 21454     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21455     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21456     MOVE X'2020233030303230323732' TO DFHEIV0(25:11)
 21457     CALL 'kxdfhei1' USING DFHEIV0,
 21458           ACCT-ID,
 21459           ACCOUNT-MASTER,
 21460           DFHEIV12,
 21461           ERACCT-KEY,
 21462           DFHEIV99,
 21463           DFHEIV11,
 21464           DFHEIV99,
 21465           DFHEIV99
 21466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21467
 21468
 21469 8580-EXIT.
 21470     EXIT.
 21471
 21472 8582-READ-COMPENSATION-MASTER.
 21473
 21474* EXEC CICS HANDLE CONDITION
 21475*        NOTFND    (8582-COMP-NOT-FOUND)
 21476*        ENDFILE   (8582-COMP-NOT-FOUND)
 21477*    END-EXEC.
 21478*    MOVE '"$I''                  ! 8 #00020282' TO DFHEIV0
 21479     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21481     MOVE X'3820233030303230323832' TO DFHEIV0(25:11)
 21482     CALL 'kxdfhei1' USING DFHEIV0
 21483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21484
 21485
 21486
 21487* EXEC CICS READ
 21488*        DATASET     (COMP-ID)
 21489*        INTO        (COMPENSATION-MASTER)
 21490*        RIDFLD      (ERCOMP-KEY)
 21491*    END-EXEC.
 21492     MOVE LENGTH OF
 21493      COMPENSATION-MASTER
 21494       TO DFHEIV11
 21495*    MOVE '&"IL       E          (   #00020287' TO DFHEIV0
 21496     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21498     MOVE X'2020233030303230323837' TO DFHEIV0(25:11)
 21499     CALL 'kxdfhei1' USING DFHEIV0,
 21500           COMP-ID,
 21501           COMPENSATION-MASTER,
 21502           DFHEIV11,
 21503           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 397
* EL050.cbl
 21504           DFHEIV99,
 21505           DFHEIV99,
 21506           DFHEIV99
 21507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21508
 21509
 21510     MOVE 'Y'                    TO COMP-MASTER-SW
 21511
 21512     GO TO 8582-EXIT
 21513     .
 21514 8582-COMP-NOT-FOUND.
 21515
 21516     MOVE 'N'                    TO COMP-MASTER-SW.
 21517
 21518 8582-EXIT.
 21519     EXIT.
 21520
 21521 8583-READ-ERAGTC.
 21522
 21523* EXEC CICS HANDLE CONDITION
 21524*        NOTFND    (8583-AGTC-NOT-FOUND)
 21525*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21526*    END-EXEC.
 21527*    MOVE '"$I''                  ! 9 #00020305' TO DFHEIV0
 21528     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21530     MOVE X'3920233030303230333035' TO DFHEIV0(25:11)
 21531     CALL 'kxdfhei1' USING DFHEIV0
 21532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21533
 21534
 21535
 21536* EXEC CICS STARTBR
 21537*        DATASET    (AGTC-ID)
 21538*        RIDFLD     (ERAGTC-KEY)
 21539*        GTEQ
 21540*    END-EXEC.
 21541     MOVE 0
 21542       TO DFHEIV11
 21543*    MOVE '&,         G          &   #00020310' TO DFHEIV0
 21544     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21546     MOVE X'2020233030303230333130' TO DFHEIV0(25:11)
 21547     CALL 'kxdfhei1' USING DFHEIV0,
 21548           AGTC-ID,
 21549           ERAGTC-KEY,
 21550           DFHEIV99,
 21551           DFHEIV11,
 21552           DFHEIV99
 21553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21554
 21555
 21556 8583-READ-ERAGTC-NEXT.
 21557
 21558* EXEC CICS READNEXT
 21559*        DATASET     (AGTC-ID)
 21560*        INTO        (AGENT-COMMISSIONS)
 21561*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 398
* EL050.cbl
 21562*    END-EXEC.
 21563     MOVE LENGTH OF
 21564      AGENT-COMMISSIONS
 21565       TO DFHEIV12
 21566     MOVE 0
 21567       TO DFHEIV11
 21568*    MOVE '&.IL                  )   #00020317' TO DFHEIV0
 21569     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21571     MOVE X'2020233030303230333137' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0,
 21573           AGTC-ID,
 21574           AGENT-COMMISSIONS,
 21575           DFHEIV12,
 21576           ERAGTC-KEY,
 21577           DFHEIV99,
 21578           DFHEIV11,
 21579           DFHEIV99,
 21580           DFHEIV99
 21581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21582
 21583
 21584*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21585
 21586     GO TO 8583-EXIT
 21587     .
 21588 8583-AGTC-NOT-FOUND.
 21589
 21590     MOVE 'N'                    TO AGTC-MASTER-SW.
 21591
 21592 8583-EXIT.
 21593     EXIT.
 21594
 21595 8584-READ-BANK-CROSS-REF.
 21596
 21597* EXEC CICS HANDLE CONDITION
 21598*        NOTFND    (8584-BXRF-NOT-FOUND)
 21599*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21600*    END-EXEC.
 21601*    MOVE '"$I''                  ! : #00020335' TO DFHEIV0
 21602     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21604     MOVE X'3A20233030303230333335' TO DFHEIV0(25:11)
 21605     CALL 'kxdfhei1' USING DFHEIV0
 21606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21607
 21608
 21609
 21610* EXEC CICS READ
 21611*        DATASET     (BXRF-ID)
 21612*        INTO        (BANK-CROSS-REFERENCE)
 21613*        RIDFLD      (ERBXRF-KEY)
 21614*        LENGTH      (BXRF-REC-LENGTH)
 21615*    END-EXEC.
 21616*    MOVE '&"IL       E          (   #00020340' TO DFHEIV0
 21617     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21619     MOVE X'2020233030303230333430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 399
* EL050.cbl
 21620     CALL 'kxdfhei1' USING DFHEIV0,
 21621           BXRF-ID,
 21622           BANK-CROSS-REFERENCE,
 21623           BXRF-REC-LENGTH,
 21624           ERBXRF-KEY,
 21625           DFHEIV99,
 21626           DFHEIV99,
 21627           DFHEIV99
 21628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21629
 21630
 21631     MOVE 'Y'                    TO BXRF-MASTER-SW
 21632
 21633     GO TO 8584-EXIT
 21634     .
 21635 8584-BXRF-NOT-FOUND.
 21636
 21637     MOVE 'N'                    TO BXRF-MASTER-SW.
 21638
 21639 8584-EXIT.
 21640     EXIT.
 21641
 21642 8585-READ-PLAN-MASTER.
 21643
 21644
 21645* EXEC CICS HANDLE CONDITION
 21646*        NOTFND    (8585-PLAN-NOT-FOUND)
 21647*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21648*    END-EXEC.
 21649*    MOVE '"$I''                  ! ; #00020360' TO DFHEIV0
 21650     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21652     MOVE X'3B20233030303230333630' TO DFHEIV0(25:11)
 21653     CALL 'kxdfhei1' USING DFHEIV0
 21654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21655
 21656
 21657
 21658* EXEC CICS READ
 21659*        DATASET     (PLAN-ID)
 21660*        INTO        (PLAN-MASTER)
 21661*        RIDFLD      (ERPLAN-KEY)
 21662*    END-EXEC.
 21663     MOVE LENGTH OF
 21664      PLAN-MASTER
 21665       TO DFHEIV11
 21666*    MOVE '&"IL       E          (   #00020365' TO DFHEIV0
 21667     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21669     MOVE X'2020233030303230333635' TO DFHEIV0(25:11)
 21670     CALL 'kxdfhei1' USING DFHEIV0,
 21671           PLAN-ID,
 21672           PLAN-MASTER,
 21673           DFHEIV11,
 21674           ERPLAN-KEY,
 21675           DFHEIV99,
 21676           DFHEIV99,
 21677           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 400
* EL050.cbl
 21678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21679
 21680
 21681     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21682
 21683     GO TO 8585-EXIT.
 21684
 21685 8585-PLAN-NOT-FOUND.
 21686
 21687     MOVE 'N'                    TO PLAN-MASTER-SW.
 21688
 21689 8585-EXIT.
 21690     EXIT.
 21691
 21692 8586-READ-LOAN-OFFICER.
 21693
 21694* EXEC CICS READ
 21695*        DATASET     (LOFC-ID)
 21696*        INTO        (LOAN-OFFICER-MASTER)
 21697*        RIDFLD      (ERLOFC-KEY)
 21698*        RESP        (WS-RESPONSE)
 21699*    END-EXEC
 21700     MOVE LENGTH OF
 21701      LOAN-OFFICER-MASTER
 21702       TO DFHEIV11
 21703*    MOVE '&"IL       E          (  N#00020383' TO DFHEIV0
 21704     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21706     MOVE X'204E233030303230333833' TO DFHEIV0(25:11)
 21707     CALL 'kxdfhei1' USING DFHEIV0,
 21708           LOFC-ID,
 21709           LOAN-OFFICER-MASTER,
 21710           DFHEIV11,
 21711           ERLOFC-KEY,
 21712           DFHEIV99,
 21713           DFHEIV99,
 21714           DFHEIV99
 21715     MOVE EIBRESP  TO WS-RESPONSE
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21717
 21718     IF WS-RESP-NORMAL
 21719        MOVE 'Y'                 TO LOFC-MASTER-SW
 21720     ELSE
 21721        MOVE 'N'                 TO LOFC-MASTER-SW
 21722     END-IF
 21723     .
 21724 8586-EXIT.
 21725     EXIT.
 21726 8587-START-ERPDEF.
 21727
 21728* EXEC CICS STARTBR
 21729*       DATASET   (PDEF-ID)
 21730*       RIDFLD    (ERPDEF-KEY)
 21731*       GTEQ
 21732*       RESP      (WS-RESPONSE)
 21733*    END-EXEC
 21734     MOVE 0
 21735       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 401
* EL050.cbl
 21736*    MOVE '&,         G          &  N#00020399' TO DFHEIV0
 21737     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21738     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21739     MOVE X'204E233030303230333939' TO DFHEIV0(25:11)
 21740     CALL 'kxdfhei1' USING DFHEIV0,
 21741           PDEF-ID,
 21742           ERPDEF-KEY,
 21743           DFHEIV99,
 21744           DFHEIV11,
 21745           DFHEIV99
 21746     MOVE EIBRESP  TO WS-RESPONSE
 21747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21748     IF WS-RESP-NORMAL
 21749        MOVE 'Y'                 TO PDEF-MASTER-SW
 21750     ELSE
 21751        MOVE 'N'                 TO PDEF-MASTER-SW
 21752     END-IF
 21753     .
 21754 8587-EXIT.
 21755     EXIT.
 21756 8588-READ-ERPDEF.
 21757
 21758* EXEC CICS READNEXT
 21759*       DATASET   (PDEF-ID)
 21760*       RIDFLD    (ERPDEF-KEY)
 21761*       INTO      (PRODUCT-MASTER)
 21762*       RESP      (WS-RESPONSE)
 21763*    END-EXEC
 21764     MOVE LENGTH OF
 21765      PRODUCT-MASTER
 21766       TO DFHEIV12
 21767     MOVE 0
 21768       TO DFHEIV11
 21769*    MOVE '&.IL                  )  N#00020414' TO DFHEIV0
 21770     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21771     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21772     MOVE X'204E233030303230343134' TO DFHEIV0(25:11)
 21773     CALL 'kxdfhei1' USING DFHEIV0,
 21774           PDEF-ID,
 21775           PRODUCT-MASTER,
 21776           DFHEIV12,
 21777           ERPDEF-KEY,
 21778           DFHEIV99,
 21779           DFHEIV11,
 21780           DFHEIV99,
 21781           DFHEIV99
 21782     MOVE EIBRESP  TO WS-RESPONSE
 21783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21784     IF WS-RESP-NORMAL
 21785        MOVE 'Y'                 TO PDEF-MASTER-SW
 21786     ELSE
 21787        MOVE 'N'                 TO PDEF-MASTER-SW
 21788     END-IF
 21789     .
 21790 8588-EXIT.
 21791     EXIT.
 21792 8589-ENDBR-ERPDEF.
 21793
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 402
* EL050.cbl
 21794* EXEC CICS ENDBR
 21795*       DATASET   (PDEF-ID)
 21796*    END-EXEC
 21797     MOVE 0
 21798       TO DFHEIV11
 21799*    MOVE '&2                    $   #00020429' TO DFHEIV0
 21800     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21802     MOVE X'2020233030303230343239' TO DFHEIV0(25:11)
 21803     CALL 'kxdfhei1' USING DFHEIV0,
 21804           PDEF-ID,
 21805           DFHEIV11,
 21806           DFHEIV99
 21807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21808     .
 21809 8589-EXIT.
 21810     EXIT.
 21811 8590-READ-CERT-MASTER.
 21812     IF PB-COMPANY-ID = 'UCL'
 21813         GO TO 8690-READ-CERT-MASTER-UCL.
 21814
 21815
 21816* EXEC CICS HANDLE CONDITION
 21817*         NOTFND    (0299-CERT-NOT-FOUND)
 21818*    END-EXEC.
 21819*    MOVE '"$I                   ! < #00020439' TO DFHEIV0
 21820     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21822     MOVE X'3C20233030303230343339' TO DFHEIV0(25:11)
 21823     CALL 'kxdfhei1' USING DFHEIV0
 21824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21825
 21826
 21827
 21828* EXEC CICS READ
 21829*        DATASET     (CERT-ID)
 21830*        INTO        (CERTIFICATE-MASTER)
 21831*        RIDFLD      (ELCERT-KEY)
 21832*        UPDATE
 21833*    END-EXEC.
 21834     MOVE LENGTH OF
 21835      CERTIFICATE-MASTER
 21836       TO DFHEIV11
 21837*    MOVE '&"IL       EU         (   #00020443' TO DFHEIV0
 21838     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21839     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21840     MOVE X'2020233030303230343433' TO DFHEIV0(25:11)
 21841     CALL 'kxdfhei1' USING DFHEIV0,
 21842           CERT-ID,
 21843           CERTIFICATE-MASTER,
 21844           DFHEIV11,
 21845           ELCERT-KEY,
 21846           DFHEIV99,
 21847           DFHEIV99,
 21848           DFHEIV99
 21849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21850
 21851
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 403
* EL050.cbl
 21852 8590-EXIT.
 21853     EXIT.
 21854
 21855 8690-READ-CERT-MASTER-UCL.
 21856
 21857* EXEC CICS HANDLE CONDITION
 21858*         NOTFND    (8700-READ-CERT-MASTER)
 21859*    END-EXEC.
 21860*    MOVE '"$I                   ! = #00020454' TO DFHEIV0
 21861     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21863     MOVE X'3D20233030303230343534' TO DFHEIV0(25:11)
 21864     CALL 'kxdfhei1' USING DFHEIV0
 21865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21866
 21867
 21868 8690-READ-CERT-CONT.
 21869
 21870* EXEC CICS READ
 21871*        DATASET     (CERT-ID)
 21872*        INTO        (CERTIFICATE-MASTER)
 21873*        RIDFLD      (ELCERT-KEY)
 21874*        UPDATE
 21875*    END-EXEC.
 21876     MOVE LENGTH OF
 21877      CERTIFICATE-MASTER
 21878       TO DFHEIV11
 21879*    MOVE '&"IL       EU         (   #00020459' TO DFHEIV0
 21880     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21882     MOVE X'2020233030303230343539' TO DFHEIV0(25:11)
 21883     CALL 'kxdfhei1' USING DFHEIV0,
 21884           CERT-ID,
 21885           CERTIFICATE-MASTER,
 21886           DFHEIV11,
 21887           ELCERT-KEY,
 21888           DFHEIV99,
 21889           DFHEIV99,
 21890           DFHEIV99
 21891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21892
 21893
 21894     GO TO 8590-EXIT.
 21895
 21896 8700-READ-CERT-MASTER.
 21897     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21898     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21899
 21900* EXEC CICS HANDLE CONDITION
 21901*         DUPKEY    (8720-COMP-ACCOUNTS)
 21902*         ENDFILE   (8730-END-BROWSE)
 21903*         NOTFND    (8740-NOT-FOUND)
 21904*    END-EXEC.
 21905*    MOVE '"$$''I                 ! > #00020471' TO DFHEIV0
 21906     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21908     MOVE X'3E20233030303230343731' TO DFHEIV0(25:11)
 21909     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 404
* EL050.cbl
 21910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21911
 21912
 21913
 21914* EXEC CICS STARTBR
 21915*        DATASET     ('ELCERT5')
 21916*        RIDFLD      (ELCERT2-KEY)
 21917*        EQUAL
 21918*    END-EXEC.
 21919     MOVE 'ELCERT5' TO DFHEIV1
 21920     MOVE 0
 21921       TO DFHEIV11
 21922*    MOVE '&,         E          &   #00020477' TO DFHEIV0
 21923     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21925     MOVE X'2020233030303230343737' TO DFHEIV0(25:11)
 21926     CALL 'kxdfhei1' USING DFHEIV0,
 21927           DFHEIV1,
 21928           ELCERT2-KEY,
 21929           DFHEIV99,
 21930           DFHEIV11,
 21931           DFHEIV99
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21933
 21934
 21935 8710-READ-NEXT.
 21936
 21937* EXEC CICS READNEXT
 21938*        DATASET     ('ELCERT5')
 21939*        INTO        (CERTIFICATE-MASTER)
 21940*        RIDFLD      (ELCERT2-KEY)
 21941*    END-EXEC.
 21942     MOVE LENGTH OF
 21943      CERTIFICATE-MASTER
 21944       TO DFHEIV12
 21945     MOVE 'ELCERT5' TO DFHEIV1
 21946     MOVE 0
 21947       TO DFHEIV11
 21948*    MOVE '&.IL                  )   #00020484' TO DFHEIV0
 21949     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21950     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21951     MOVE X'2020233030303230343834' TO DFHEIV0(25:11)
 21952     CALL 'kxdfhei1' USING DFHEIV0,
 21953           DFHEIV1,
 21954           CERTIFICATE-MASTER,
 21955           DFHEIV12,
 21956           ELCERT2-KEY,
 21957           DFHEIV99,
 21958           DFHEIV11,
 21959           DFHEIV99,
 21960           DFHEIV99
 21961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21962
 21963
 21964 8720-COMP-ACCOUNTS.
 21965
 21966* EXEC CICS ENTER
 21967*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 405
* EL050.cbl
 21968*         FROM (PB-C-LAST-NAME)
 21969*    END-EXEC.
 21970     MOVE 001
 21971       TO DFHEIV11
 21972*    MOVE ':$F                   %   #00020491' TO DFHEIV0
 21973     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21974     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21975     MOVE X'2020233030303230343931' TO DFHEIV0(25:11)
 21976     CALL 'kxdfhei1' USING DFHEIV0,
 21977           DFHEIV11,
 21978           PB-C-LAST-NAME,
 21979           DFHEIV99,
 21980           DFHEIV99
 21981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21982
 21983
 21984
 21985* EXEC CICS ENTER
 21986*         TRACEID (002)
 21987*         FROM (CM-INSURED-LAST-NAME)
 21988*    END-EXEC.
 21989     MOVE 002
 21990       TO DFHEIV11
 21991*    MOVE ':$F                   %   #00020496' TO DFHEIV0
 21992     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21993     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21994     MOVE X'2020233030303230343936' TO DFHEIV0(25:11)
 21995     CALL 'kxdfhei1' USING DFHEIV0,
 21996           DFHEIV11,
 21997           CM-INSURED-LAST-NAME,
 21998           DFHEIV99,
 21999           DFHEIV99
 22000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22001
 22002
 22003     IF PB-CERT-NO NOT = CM-CERT-NO
 22004         GO TO 8730-END-BROWSE.
 22005
 22006     IF PB-ACCOUNT = CM-ACCOUNT
 22007         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22008             MOVE ER-2799        TO WS-ERROR
 22009             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22010             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22011             GO TO 8730-END-BROWSE.
 22012
 22013     GO TO 8710-READ-NEXT.
 22014
 22015 8730-END-BROWSE.
 22016
 22017* EXEC CICS ENDBR
 22018*         DATASET    ('ELCERT5')
 22019*    END-EXEC.
 22020     MOVE 'ELCERT5' TO DFHEIV1
 22021     MOVE 0
 22022       TO DFHEIV11
 22023*    MOVE '&2                    $   #00020514' TO DFHEIV0
 22024     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 406
* EL050.cbl
 22026     MOVE X'2020233030303230353134' TO DFHEIV0(25:11)
 22027     CALL 'kxdfhei1' USING DFHEIV0,
 22028           DFHEIV1,
 22029           DFHEIV11,
 22030           DFHEIV99
 22031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22032
 22033
 22034 8740-NOT-FOUND.
 22035     GO TO 0299-CERT-NOT-FOUND.
 22036
 22037 8750-START-ELSTAT.
 22038
 22039* EXEC CICS STARTBR
 22040*       DATASET   (STAT-ID)
 22041*       RIDFLD    (ELSTAT-KEY)
 22042*       GTEQ
 22043*       RESP      (WS-RESPONSE)
 22044*    END-EXEC
 22045     MOVE 0
 22046       TO DFHEIV11
 22047*    MOVE '&,         G          &  N#00020522' TO DFHEIV0
 22048     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22050     MOVE X'204E233030303230353232' TO DFHEIV0(25:11)
 22051     CALL 'kxdfhei1' USING DFHEIV0,
 22052           STAT-ID,
 22053           ELSTAT-KEY,
 22054           DFHEIV99,
 22055           DFHEIV11,
 22056           DFHEIV99
 22057     MOVE EIBRESP  TO WS-RESPONSE
 22058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22059     IF WS-RESP-NORMAL
 22060        MOVE 'Y'                 TO STAT-MASTER-SW
 22061     ELSE
 22062        MOVE 'N'                 TO STAT-MASTER-SW
 22063     END-IF
 22064     .
 22065 8750-EXIT.
 22066     EXIT.
 22067 8752-READ-ELSTAT.
 22068
 22069* EXEC CICS READNEXT
 22070*       DATASET   (STAT-ID)
 22071*       RIDFLD    (ELSTAT-KEY)
 22072*       INTO      (STATE-FILE)
 22073*       RESP      (WS-RESPONSE)
 22074*    END-EXEC
 22075     MOVE LENGTH OF
 22076      STATE-FILE
 22077       TO DFHEIV12
 22078     MOVE 0
 22079       TO DFHEIV11
 22080*    MOVE '&.IL                  )  N#00020537' TO DFHEIV0
 22081     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22082     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22083     MOVE X'204E233030303230353337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 407
* EL050.cbl
 22084     CALL 'kxdfhei1' USING DFHEIV0,
 22085           STAT-ID,
 22086           STATE-FILE,
 22087           DFHEIV12,
 22088           ELSTAT-KEY,
 22089           DFHEIV99,
 22090           DFHEIV11,
 22091           DFHEIV99,
 22092           DFHEIV99
 22093     MOVE EIBRESP  TO WS-RESPONSE
 22094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22095     IF WS-RESP-NORMAL
 22096        MOVE 'Y'                 TO STAT-MASTER-SW
 22097     ELSE
 22098        MOVE 'N'                 TO STAT-MASTER-SW
 22099     END-IF
 22100     .
 22101 8752-EXIT.
 22102     EXIT.
 22103 8800-GET-COMP-RATE.
 22104     MOVE +1 TO IB.
 22105     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22106         ADD +9 TO IB
 22107         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22108             ADD +9 TO IB
 22109             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22110                MOVE ZEROS       TO WS-WK-RATE
 22111                GO TO 8800-EXIT.
 22112
 22113     IF PB-I-AGE GREATER CT-AGE (1)
 22114         ADD +3 TO IB
 22115         IF PB-I-AGE GREATER CT-AGE (2)
 22116             ADD +3 TO IB
 22117             IF PB-I-AGE GREATER CT-AGE (3)
 22118                MOVE ZEROS       TO WS-WK-RATE
 22119                GO TO 8800-EXIT.
 22120
 22121     IF WS-WORK-TERM GREATER CT-TRM (1)
 22122         ADD +1 TO IB
 22123         IF WS-WORK-TERM GREATER CT-TRM (2)
 22124             ADD +1 TO IB
 22125             IF WS-WORK-TERM GREATER CT-TRM (3)
 22126                MOVE ZEROS       TO WS-WK-RATE
 22127                GO TO 8800-EXIT.
 22128
 22129     IF CT-RT (IB) NOT NUMERIC
 22130         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22131         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22132         GO TO 8800-GET-COMP-RATE.
 22133
 22134     MOVE CT-RT (IB) TO WS-WK-RATE.
 22135
 22136 8800-EXIT.
 22137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 408
* EL050.cbl
 22139 8900-ADDRESS-FILE.
 22140     IF ERACCT-FILE-ADDRESSED
 22141         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22142         GO TO 8900-ADDRESS-EXIT.
 22143
 22144     IF ELCNTL-FILE-ADDRESSED
 22145         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22146         GO TO 8900-ADDRESS-EXIT.
 22147
 22148     IF ERPLAN-FILE-ADDRESSED
 22149         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22150         GO TO 8900-ADDRESS-EXIT.
 22151
 22152     IF ERFORM-FILE-ADDRESSED
 22153         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22154         GO TO 8900-ADDRESS-EXIT.
 22155
 22156 8900-ADDRESS-EXIT.
 22157     EXIT.
 22158
 22159 9000-READ-CONTROL.
 22160
 22161* EXEC CICS HANDLE CONDITION
 22162*        NOTFND    (9000-NOTFND)
 22163*    END-EXEC.
 22164*    MOVE '"$I                   ! ? #00020608' TO DFHEIV0
 22165     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22167     MOVE X'3F20233030303230363038' TO DFHEIV0(25:11)
 22168     CALL 'kxdfhei1' USING DFHEIV0
 22169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22170
 22171
 22172
 22173* EXEC CICS READ
 22174*        DATASET     (CNTL-ID)
 22175*        SET         (ADDRESS OF CONTROL-FILE)
 22176*        RIDFLD      (ELCNTL-KEY)
 22177*        GTEQ
 22178*    END-EXEC.
 22179*    MOVE '&"S        G          (   #00020612' TO DFHEIV0
 22180     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22182     MOVE X'2020233030303230363132' TO DFHEIV0(25:11)
 22183     CALL 'kxdfhei1' USING DFHEIV0,
 22184           CNTL-ID,
 22185           DFHEIV20,
 22186           DFHEIV99,
 22187           ELCNTL-KEY,
 22188           DFHEIV99,
 22189           DFHEIV99,
 22190           DFHEIV99
 22191     SET ADDRESS OF CONTROL-FILE TO
 22192         DFHEIV20
 22193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22194
 22195
 22196     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 409
* EL050.cbl
 22197
 22198 9000-NOTFND.
 22199     IF RC-SW-1 = '1'
 22200        MOVE ER-2616              TO WS-ERROR
 22201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22202        GO TO 9000-EXIT.
 22203
 22204     IF RC-SW-1 = '2'
 22205        MOVE ER-2602              TO WS-ERROR
 22206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22207
 22208 9000-EXIT.
 22209      EXIT.
 22210
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 410
* EL050.cbl
 22212 9100-READ-CONTROL.
 22213
 22214* EXEC CICS HANDLE CONDITION
 22215*        NOTFND  (9100-NOTFND)
 22216*        ENDFILE (9100-NOTFND)
 22217*    END-EXEC.
 22218*    MOVE '"$I''                  ! @ #00020636' TO DFHEIV0
 22219     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22221     MOVE X'4020233030303230363336' TO DFHEIV0(25:11)
 22222     CALL 'kxdfhei1' USING DFHEIV0
 22223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22224
 22225
 22226
 22227* EXEC CICS READ
 22228*        DATASET     (CNTL-ID)
 22229*        INTO        (CONTROL-FILE)
 22230*        RIDFLD      (ELCNTL-KEY)
 22231*        GTEQ
 22232*    END-EXEC.
 22233     MOVE LENGTH OF
 22234      CONTROL-FILE
 22235       TO DFHEIV11
 22236*    MOVE '&"IL       G          (   #00020641' TO DFHEIV0
 22237     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22239     MOVE X'2020233030303230363431' TO DFHEIV0(25:11)
 22240     CALL 'kxdfhei1' USING DFHEIV0,
 22241           CNTL-ID,
 22242           CONTROL-FILE,
 22243           DFHEIV11,
 22244           ELCNTL-KEY,
 22245           DFHEIV99,
 22246           DFHEIV99,
 22247           DFHEIV99
 22248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22249
 22250
 22251     GO TO 9100-EXIT.
 22252
 22253 9100-NOTFND.
 22254     IF RC-SW-2 = '0'
 22255        MOVE '1'                  TO STATE-RECORD-ERROR
 22256        GO TO 9100-EXIT
 22257     END-IF
 22258     IF RC-SW-2 = '1'
 22259        MOVE '1'                  TO LF-BENEFIT-ERROR
 22260        MOVE ER-2604              TO WS-ERROR
 22261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22262        GO TO 9100-EXIT.
 22263
 22264     IF RC-SW-2 = '2'
 22265        MOVE '1'                  TO AH-BENEFIT-ERROR
 22266        MOVE ER-2605              TO WS-ERROR
 22267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22268        GO TO 9100-EXIT.
 22269
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 411
* EL050.cbl
 22270     IF RC-SW-2 = '3'
 22271         MOVE ER-2603           TO WS-ERROR
 22272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22273         GO TO 9100-EXIT.
 22274
 22275     IF RC-SW-2 = '4'
 22276         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22277         GO TO 9100-EXIT.
 22278
 22279     IF RC-SW-2 = '5'
 22280         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22281         IF WS-AH-INPUT-CD-1 = SPACE
 22282             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22283         ELSE
 22284             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22285
 22286 9100-EXIT.
 22287      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 412
* EL050.cbl
 22289 9200-CONTROL-GETMAIN.
 22290
 22291* EXEC CICS GETMAIN
 22292*         LENGTH   (750)
 22293*         SET      (ADDRESS OF CONTROL-FILE)
 22294*    END-EXEC.
 22295     MOVE 750
 22296       TO DFHEIV11
 22297*    MOVE '," L                  $   #00020687' TO DFHEIV0
 22298     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22300     MOVE X'2020233030303230363837' TO DFHEIV0(25:11)
 22301     CALL 'kxdfhei1' USING DFHEIV0,
 22302           DFHEIV20,
 22303           DFHEIV11,
 22304           DFHEIV99
 22305     SET ADDRESS OF CONTROL-FILE TO
 22306         DFHEIV20
 22307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22308
 22309
 22310     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22311
 22312 9200-EXIT.
 22313     EXIT.
 22314
 22315 9250-UNLOCK-RETURN.
 22316
 22317* EXEC CICS UNLOCK
 22318*        DATASET   (CERT-ID)
 22319*    END-EXEC.
 22320*    MOVE '&*                    #   #00020698' TO DFHEIV0
 22321     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22322     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22323     MOVE X'2020233030303230363938' TO DFHEIV0(25:11)
 22324     CALL 'kxdfhei1' USING DFHEIV0,
 22325           CERT-ID,
 22326           DFHEIV99
 22327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22328
 22329
 22330 9300-ABEND.
 22331     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22332
 22333
 22334* EXEC CICS LINK
 22335*        PROGRAM   ('EL004')
 22336*        COMMAREA  (WS-ERROR-LINE)
 22337*        LENGTH    (72)
 22338*    END-EXEC.
 22339     MOVE 'EL004' TO DFHEIV1
 22340     MOVE 72
 22341       TO DFHEIV11
 22342*    MOVE '."C                   (   #00020705' TO DFHEIV0
 22343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22345     MOVE X'2020233030303230373035' TO DFHEIV0(25:11)
 22346     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 413
* EL050.cbl
 22347           DFHEIV1,
 22348           WS-ERROR-LINE,
 22349           DFHEIV11,
 22350           DFHEIV99,
 22351           DFHEIV99,
 22352           DFHEIV99,
 22353           DFHEIV99
 22354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22355
 22356
 22357     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22358
 22359
 22360* EXEC CICS ABEND
 22361*        ABCODE ('EL50')
 22362*    END-EXEC.
 22363     MOVE 'EL50' TO DFHEIV5
 22364*    MOVE '.,A                   "   #00020713' TO DFHEIV0
 22365     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22366     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22367     MOVE X'2020233030303230373133' TO DFHEIV0(25:11)
 22368     CALL 'kxdfhei1' USING DFHEIV0,
 22369           DFHEIV5
 22370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22371
 22372
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 414
* EL050.cbl
 22374
 22375******************************************************************
 22376*                                                                *
 22377*            E R R O R   F O R M A T   R O U T I N E             *
 22378*                                                                *
 22379******************************************************************
 22380
 22381 9900-ERROR-FORMAT.
 22382
 22383     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22384                    PB-COMMON-ERROR (2) OR
 22385                    PB-COMMON-ERROR (3) OR
 22386                    PB-COMMON-ERROR (4) OR
 22387                    PB-COMMON-ERROR (5) OR
 22388                    PB-COMMON-ERROR (6) OR
 22389                    PB-COMMON-ERROR (7) OR
 22390                    PB-COMMON-ERROR (8) OR
 22391                    PB-COMMON-ERROR (9) OR
 22392                    PB-COMMON-ERROR (10)
 22393        GO TO 9900-EXIT.
 22394
 22395     IF PB-NO-OF-ERRORS = +10
 22396        GO TO 9900-EXIT.
 22397
 22398     ADD +1  TO PB-NO-OF-ERRORS.
 22399     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22400                                       (PB-NO-OF-ERRORS).
 22401 9900-EXIT.
 22402     EXIT.
 22403
 22404 9990-RETURN.
 22405     IF BROWSE-STARTED
 22406
 22407* EXEC CICS ENDBR
 22408*            DATASET  (ACCT-ID)
 22409*       END-EXEC.
 22410     MOVE 0
 22411       TO DFHEIV11
 22412*    MOVE '&2                    $   #00020750' TO DFHEIV0
 22413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22415     MOVE X'2020233030303230373530' TO DFHEIV0(25:11)
 22416     CALL 'kxdfhei1' USING DFHEIV0,
 22417           ACCT-ID,
 22418           DFHEIV11,
 22419           DFHEIV99
 22420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22421
 22422
 22423 9990-EXIT.
 22424     EXIT.
 22425
 22426
 22427****Check for CRTO record, add one if not found.
 22428 9991-CHECK-FOR-ELCRTO.
 22429
 22430* EXEC CICS HANDLE CONDITION
 22431*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 415
* EL050.cbl
 22432*         ENDFILE (9991-CRTO-NOT-FOUND)
 22433*     END-EXEC.
 22434*    MOVE '"$I''                  ! A #00020760' TO DFHEIV0
 22435     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22437     MOVE X'4120233030303230373630' TO DFHEIV0(25:11)
 22438     CALL 'kxdfhei1' USING DFHEIV0
 22439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22440
 22441     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22442     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22443     MOVE +0                     TO ELCRTO-SEQ-NO
 22444
 22445
 22446* EXEC CICS READ
 22447*       DATASET   ('ELCRTO')
 22448*       INTO      (ORIGINAL-CERTIFICATE)
 22449*       RIDFLD    (ELCRTO-KEY)
 22450*       GTEQ
 22451*       RESP      (WS-RESPONSE)
 22452*    END-EXEC
 22453     MOVE LENGTH OF
 22454      ORIGINAL-CERTIFICATE
 22455       TO DFHEIV11
 22456     MOVE 'ELCRTO' TO DFHEIV1
 22457*    MOVE '&"IL       G          (  N#00020768' TO DFHEIV0
 22458     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22460     MOVE X'204E233030303230373638' TO DFHEIV0(25:11)
 22461     CALL 'kxdfhei1' USING DFHEIV0,
 22462           DFHEIV1,
 22463           ORIGINAL-CERTIFICATE,
 22464           DFHEIV11,
 22465           ELCRTO-KEY,
 22466           DFHEIV99,
 22467           DFHEIV99,
 22468           DFHEIV99
 22469     MOVE EIBRESP  TO WS-RESPONSE
 22470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22471
 22472     IF WS-RESP-NORMAL
 22473        AND (OC-CONTROL-PRIMARY (1:33) =
 22474                 PB-CONTROL-BY-ACCOUNT (1:33))
 22475        AND (OC-RECORD-TYPE =  'I')
 22476           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22477               GO TO 9991-CHECK-INDICATORS
 22478           ELSE
 22479               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22480               GO TO 9991-CRTO-ADD-REC
 22481           END-IF
 22482     END-IF.
 22483
 22484 9991-CRTO-NOT-FOUND.
 22485
 22486     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22487     MOVE 'OC'                TO OC-RECORD-ID
 22488     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22489                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 416
* EL050.cbl
 22490     MOVE +4096               TO OC-KEY-SEQ-NO.
 22491
 22492 9991-CRTO-ADD-REC.
 22493
 22494     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22495     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22496     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22497     MOVE 'I'                 TO OC-RECORD-TYPE
 22498     IF PB-ISSUE
 22499         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22500         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22501         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22502         MOVE PB-I-AGE               TO OC-INS-AGE
 22503         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22504         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22505         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22506         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22507         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22508         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22509         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22510         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22511         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22512         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22513         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22514         IF PB-I-JOINT-COMMISSION > +0
 22515             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22516         ELSE
 22517             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22518         END-IF
 22519         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22520         MOVE +0                     TO OC-LF-CANCEL-AMT
 22521                                        OC-LF-ITD-CANCEL-AMT
 22522         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22523         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22524         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22525         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22526         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22527         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22528         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22529         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22530         MOVE +0                     TO OC-AH-CANCEL-AMT
 22531                                        OC-AH-ITD-CANCEL-AMT
 22532         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22533         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22534         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22535     ELSE
 22536         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22537         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22538         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22539         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22540         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22541         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22542         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22543         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22544         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22545          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22546             MOVE SPACES             TO OC-LF-BENCD
 22547             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 417
* EL050.cbl
 22548                                        OC-LF-BEN-AMT
 22549                                        OC-LF-PRM-AMT
 22550                                        OC-LF-ALT-BEN-AMT
 22551                                        OC-LF-ALT-PRM-AMT
 22552                                        OC-LF-COMM-PCT
 22553                                        OC-LF-CANCEL-AMT
 22554             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22555             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22556         ELSE
 22557             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22558             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22559             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22560             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22561             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22562             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22563             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22564             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22565             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22566             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22567         END-IF
 22568         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22569         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22570          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22571             MOVE SPACES             TO OC-AH-BENCD
 22572             MOVE ZEROS              TO OC-AH-TERM
 22573                                        OC-AH-BEN-AMT
 22574                                        OC-AH-PRM-AMT
 22575                                        OC-AH-COMM-PCT
 22576                                        OC-AH-CANCEL-AMT
 22577                                        OC-AH-CP
 22578             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22579             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22580         ELSE
 22581             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22582             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22583             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22584             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22585             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22586             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22587             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22588             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22589             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22590         END-IF
 22591         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22592         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22593         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22594         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22595     END-IF
 22596     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22597
 22598     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22599
 22600
 22601* EXEC CICS READ
 22602*         DATASET   (FILE-ERMAIL)
 22603*         RIDFLD    (MA-CONTROL-PRIMARY)
 22604*         INTO      (MAILING-DATA)
 22605*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 418
* EL050.cbl
 22606*    END-EXEC
 22607     MOVE LENGTH OF
 22608      MAILING-DATA
 22609       TO DFHEIV11
 22610*    MOVE '&"IL       E          (  N#00020904' TO DFHEIV0
 22611     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22612     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22613     MOVE X'204E233030303230393034' TO DFHEIV0(25:11)
 22614     CALL 'kxdfhei1' USING DFHEIV0,
 22615           FILE-ERMAIL,
 22616           MAILING-DATA,
 22617           DFHEIV11,
 22618           MA-CONTROL-PRIMARY,
 22619           DFHEIV99,
 22620           DFHEIV99,
 22621           DFHEIV99
 22622     MOVE EIBRESP  TO WS-RESPONSE
 22623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22624
 22625     IF WS-RESP-NORMAL
 22626         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22627     END-IF.
 22628
 22629     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22630     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22631
 22632
 22633* EXEC CICS READ
 22634*         DATASET  (CRTT-ID)
 22635*         RIDFLD   (WS-ELCRTT-KEY)
 22636*         INTO     (CERTIFICATE-TRAILERS)
 22637*         RESP     (WS-RESPONSE)
 22638*    END-EXEC
 22639     MOVE LENGTH OF
 22640      CERTIFICATE-TRAILERS
 22641       TO DFHEIV11
 22642*    MOVE '&"IL       E          (  N#00020918' TO DFHEIV0
 22643     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22645     MOVE X'204E233030303230393138' TO DFHEIV0(25:11)
 22646     CALL 'kxdfhei1' USING DFHEIV0,
 22647           CRTT-ID,
 22648           CERTIFICATE-TRAILERS,
 22649           DFHEIV11,
 22650           WS-ELCRTT-KEY,
 22651           DFHEIV99,
 22652           DFHEIV99,
 22653           DFHEIV99
 22654     MOVE EIBRESP  TO WS-RESPONSE
 22655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22656
 22657     IF WS-RESP-NORMAL
 22658         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22659         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22660     END-IF.
 22661
 22662
 22663* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 419
* EL050.cbl
 22664*       DATASET   ('ELCRTO')
 22665*       FROM      (ORIGINAL-CERTIFICATE)
 22666*       RIDFLD    (OC-CONTROL-PRIMARY)
 22667*       RESP      (WS-RESPONSE)
 22668*    END-EXEC.
 22669     MOVE LENGTH OF
 22670      ORIGINAL-CERTIFICATE
 22671       TO DFHEIV11
 22672     MOVE 'ELCRTO' TO DFHEIV1
 22673*    MOVE '&$ L                  ''  N#00020930' TO DFHEIV0
 22674     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22675     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22676     MOVE X'204E233030303230393330' TO DFHEIV0(25:11)
 22677     CALL 'kxdfhei1' USING DFHEIV0,
 22678           DFHEIV1,
 22679           ORIGINAL-CERTIFICATE,
 22680           DFHEIV11,
 22681           OC-CONTROL-PRIMARY,
 22682           DFHEIV99,
 22683           DFHEIV99
 22684     MOVE EIBRESP  TO WS-RESPONSE
 22685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22686
 22687
 22688     GO TO 9991-EXIT.
 22689
 22690 9991-CHECK-INDICATORS.
 22691
 22692     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22693         GO TO 9991-EXIT
 22694     END-IF.
 22695
 22696     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22697         GO TO 9991-EXIT
 22698     END-IF.
 22699
 22700
 22701* EXEC CICS READ
 22702*       DATASET   ('ELCRTO')
 22703*       INTO      (ORIGINAL-CERTIFICATE)
 22704*       RIDFLD    (OC-CONTROL-PRIMARY)
 22705*       UPDATE
 22706*       RESP      (WS-RESPONSE)
 22707*    END-EXEC
 22708     MOVE LENGTH OF
 22709      ORIGINAL-CERTIFICATE
 22710       TO DFHEIV11
 22711     MOVE 'ELCRTO' TO DFHEIV1
 22712*    MOVE '&"IL       EU         (  N#00020949' TO DFHEIV0
 22713     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22715     MOVE X'204E233030303230393439' TO DFHEIV0(25:11)
 22716     CALL 'kxdfhei1' USING DFHEIV0,
 22717           DFHEIV1,
 22718           ORIGINAL-CERTIFICATE,
 22719           DFHEIV11,
 22720           OC-CONTROL-PRIMARY,
 22721           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 420
* EL050.cbl
 22722           DFHEIV99,
 22723           DFHEIV99
 22724     MOVE EIBRESP  TO WS-RESPONSE
 22725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22726     IF WS-RESP-NORMAL
 22727        IF PB-ISSUE
 22728          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22729          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22730          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22731          MOVE PB-I-AGE               TO OC-INS-AGE
 22732          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22733          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22734          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22735          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22736          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22737          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22738          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22739          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22740          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22741          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22742          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22743          IF PB-I-JOINT-COMMISSION > +0
 22744              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22745          ELSE
 22746              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22747          END-IF
 22748          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22749          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22750          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22751          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22752          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22753          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22754          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22755          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22756          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22757
 22758          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22759
 22760* EXEC CICS READ
 22761*             DATASET   (FILE-ERMAIL)
 22762*             RIDFLD    (MA-CONTROL-PRIMARY)
 22763*             INTO      (MAILING-DATA)
 22764*             RESP      (WS-RESPONSE)
 22765*         END-EXEC
 22766     MOVE LENGTH OF
 22767      MAILING-DATA
 22768       TO DFHEIV11
 22769*    MOVE '&"IL       E          (  N#00020989' TO DFHEIV0
 22770     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22772     MOVE X'204E233030303230393839' TO DFHEIV0(25:11)
 22773     CALL 'kxdfhei1' USING DFHEIV0,
 22774           FILE-ERMAIL,
 22775           MAILING-DATA,
 22776           DFHEIV11,
 22777           MA-CONTROL-PRIMARY,
 22778           DFHEIV99,
 22779           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 421
* EL050.cbl
 22780           DFHEIV99
 22781     MOVE EIBRESP  TO WS-RESPONSE
 22782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22783          IF WS-RESP-NORMAL
 22784             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22785          END-IF
 22786
 22787          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22788          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22789
 22790* EXEC CICS READ
 22791*             DATASET  (CRTT-ID)
 22792*             RIDFLD   (WS-ELCRTT-KEY)
 22793*             INTO     (CERTIFICATE-TRAILERS)
 22794*             RESP     (WS-RESPONSE)
 22795*         END-EXEC
 22796     MOVE LENGTH OF
 22797      CERTIFICATE-TRAILERS
 22798       TO DFHEIV11
 22799*    MOVE '&"IL       E          (  N#00021001' TO DFHEIV0
 22800     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22802     MOVE X'204E233030303231303031' TO DFHEIV0(25:11)
 22803     CALL 'kxdfhei1' USING DFHEIV0,
 22804           CRTT-ID,
 22805           CERTIFICATE-TRAILERS,
 22806           DFHEIV11,
 22807           WS-ELCRTT-KEY,
 22808           DFHEIV99,
 22809           DFHEIV99,
 22810           DFHEIV99
 22811     MOVE EIBRESP  TO WS-RESPONSE
 22812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22813          IF WS-RESP-NORMAL
 22814             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22815                               OC-INS-AGE-DEFAULT-FLAG
 22816             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22817                               OC-JNT-AGE-DEFAULT-FLAG
 22818          END-IF
 22819
 22820        ELSE
 22821          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22822             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22823             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22824             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22825          END-IF
 22826          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22827             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22828             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22829             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22830          END-IF
 22831          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22832        END-IF
 22833
 22834* EXEC CICS REWRITE
 22835*          DATASET   ('ELCRTO')
 22836*          FROM      (ORIGINAL-CERTIFICATE)
 22837*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 422
* EL050.cbl
 22838*       END-EXEC
 22839     MOVE LENGTH OF
 22840      ORIGINAL-CERTIFICATE
 22841       TO DFHEIV11
 22842     MOVE 'ELCRTO' TO DFHEIV1
 22843*    MOVE '&& L                  %  N#00021027' TO DFHEIV0
 22844     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22845     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22846     MOVE X'204E233030303231303237' TO DFHEIV0(25:11)
 22847     CALL 'kxdfhei1' USING DFHEIV0,
 22848           DFHEIV1,
 22849           ORIGINAL-CERTIFICATE,
 22850           DFHEIV11,
 22851           DFHEIV99
 22852     MOVE EIBRESP  TO WS-RESPONSE
 22853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22854     END-IF.
 22855
 22856 9991-EXIT.
 22857     EXIT.
 22858
 22859
 22860 9999-RETURN.
 22861     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22862
 22863
 22864* EXEC CICS RETURN
 22865*    END-EXEC.
 22866*    MOVE '.(                    ''   #00021041' TO DFHEIV0
 22867     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22868     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22869     MOVE X'2020233030303231303431' TO DFHEIV0(25:11)
 22870     CALL 'kxdfhei1' USING DFHEIV0,
 22871           DFHEIV99,
 22872           DFHEIV99,
 22873           DFHEIV99,
 22874           DFHEIV99,
 22875           DFHEIV99,
 22876           DFHEIV99
 22877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22878
 22879
 22880
 22881* GOBACK.
 22882     MOVE '9%                    "   ' TO DFHEIV0
 22883     MOVE 'EL050' TO DFHEIV1
 22884     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22885     GOBACK.
 22886
 22887 9999-DFHBACK SECTION.
 22888     MOVE '9%                    "   ' TO DFHEIV0
 22889     MOVE 'EL050' TO DFHEIV1
 22890     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22891     GOBACK.
 22892 9999-DFHEXIT.
 22893     IF DFHEIGDJ EQUAL 0001
 22894         NEXT SENTENCE
 22895     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 423
* EL050.cbl
 22896         GO TO 9300-ABEND,
 22897               3990-FILES-NOT-OPEN
 22898         DEPENDING ON DFHEIGDI
 22899     ELSE IF DFHEIGDJ EQUAL 3
 22900         GO TO 6610-START-BROWSE,
 22901               6630-ERRESS-PROBLEM,
 22902               6630-END-OF-FILE
 22903         DEPENDING ON DFHEIGDI
 22904     ELSE IF DFHEIGDJ EQUAL 4
 22905         GO TO 6630-END-OF-FILE,
 22906               6630-ERRESS-PROBLEM,
 22907               6630-ERRESS-PROBLEM,
 22908               6630-END-OF-FILE
 22909         DEPENDING ON DFHEIGDI
 22910     ELSE IF DFHEIGDJ EQUAL 5
 22911         GO TO 6630-END-OF-FILE,
 22912               6630-END-OF-FILE,
 22913               6630-ERRESS-PROBLEM,
 22914               6630-ERRESS-PROBLEM
 22915         DEPENDING ON DFHEIGDI
 22916     ELSE IF DFHEIGDJ EQUAL 6
 22917         GO TO 6660-START-BROWSE,
 22918               6690-ERRESC-PROBLEM,
 22919               6690-ERRESC-PROBLEM,
 22920               6690-END-OF-FILE
 22921         DEPENDING ON DFHEIGDI
 22922     ELSE IF DFHEIGDJ EQUAL 7
 22923         GO TO 6690-END-OF-FILE,
 22924               6690-ERRESC-PROBLEM,
 22925               6690-ERRESC-PROBLEM,
 22926               6690-END-OF-FILE
 22927         DEPENDING ON DFHEIGDI
 22928     ELSE IF DFHEIGDJ EQUAL 8
 22929         GO TO 6690-END-OF-FILE,
 22930               6690-ERRESC-PROBLEM,
 22931               6690-ERRESC-PROBLEM,
 22932               6690-END-OF-FILE
 22933         DEPENDING ON DFHEIGDI
 22934     ELSE IF DFHEIGDJ EQUAL 9
 22935         GO TO 7250-CONTINUE,
 22936               7250-CONTINUE
 22937         DEPENDING ON DFHEIGDI
 22938     ELSE IF DFHEIGDJ EQUAL 10
 22939         GO TO 7300-CONTINUE,
 22940               7300-CONTINUE
 22941         DEPENDING ON DFHEIGDI
 22942     ELSE IF DFHEIGDJ EQUAL 11
 22943         GO TO 8000-FREE-MAIN
 22944         DEPENDING ON DFHEIGDI
 22945     ELSE IF DFHEIGDJ EQUAL 12
 22946         GO TO 8100-NOTFND,
 22947               8100-NOTFND
 22948         DEPENDING ON DFHEIGDI
 22949     ELSE IF DFHEIGDJ EQUAL 13
 22950         GO TO 8110-NOTFND,
 22951               8110-NOTFND
 22952         DEPENDING ON DFHEIGDI
 22953     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 424
* EL050.cbl
 22954         GO TO 8130-EXIT
 22955         DEPENDING ON DFHEIGDI
 22956     ELSE IF DFHEIGDJ EQUAL 15
 22957         GO TO 8150-exit
 22958         DEPENDING ON DFHEIGDI
 22959     ELSE IF DFHEIGDJ EQUAL 16
 22960         GO TO 8180-NOTFND
 22961         DEPENDING ON DFHEIGDI
 22962     ELSE IF DFHEIGDJ EQUAL 17
 22963         GO TO 8190-NOTFND
 22964         DEPENDING ON DFHEIGDI
 22965     ELSE IF DFHEIGDJ EQUAL 18
 22966         GO TO 8195-NOTFND
 22967         DEPENDING ON DFHEIGDI
 22968     ELSE IF DFHEIGDJ EQUAL 19
 22969         GO TO 8200-NOTFND
 22970         DEPENDING ON DFHEIGDI
 22971     ELSE IF DFHEIGDJ EQUAL 20
 22972         GO TO 8300-NOTFND,
 22973               8300-ERRESS-PROBLEM,
 22974               8300-ERRESS-PROBLEM,
 22975               8300-NOTFND
 22976         DEPENDING ON DFHEIGDI
 22977     ELSE IF DFHEIGDJ EQUAL 21
 22978         GO TO 8450-FORM-NOT-FOUND,
 22979               8450-FORM-NOT-FOUND
 22980         DEPENDING ON DFHEIGDI
 22981     ELSE IF DFHEIGDJ EQUAL 22
 22982         GO TO 0199-ACCT-NOT-FOUND,
 22983               0199-ACCT-NOT-FOUND
 22984         DEPENDING ON DFHEIGDI
 22985     ELSE IF DFHEIGDJ EQUAL 23
 22986         GO TO 0199-ACCT-NOT-FOUND,
 22987               0199-ACCT-NOT-FOUND
 22988         DEPENDING ON DFHEIGDI
 22989     ELSE IF DFHEIGDJ EQUAL 24
 22990         GO TO 8582-COMP-NOT-FOUND,
 22991               8582-COMP-NOT-FOUND
 22992         DEPENDING ON DFHEIGDI
 22993     ELSE IF DFHEIGDJ EQUAL 25
 22994         GO TO 8583-AGTC-NOT-FOUND,
 22995               8583-AGTC-NOT-FOUND
 22996         DEPENDING ON DFHEIGDI
 22997     ELSE IF DFHEIGDJ EQUAL 26
 22998         GO TO 8584-BXRF-NOT-FOUND,
 22999               8584-BXRF-NOT-FOUND
 23000         DEPENDING ON DFHEIGDI
 23001     ELSE IF DFHEIGDJ EQUAL 27
 23002         GO TO 8585-PLAN-NOT-FOUND,
 23003               8585-PLAN-NOT-FOUND
 23004         DEPENDING ON DFHEIGDI
 23005     ELSE IF DFHEIGDJ EQUAL 28
 23006         GO TO 0299-CERT-NOT-FOUND
 23007         DEPENDING ON DFHEIGDI
 23008     ELSE IF DFHEIGDJ EQUAL 29
 23009         GO TO 8700-READ-CERT-MASTER
 23010         DEPENDING ON DFHEIGDI
 23011     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 18-Jan-18 09:35 Page 425
* EL050.cbl
 23012         GO TO 8720-COMP-ACCOUNTS,
 23013               8730-END-BROWSE,
 23014               8740-NOT-FOUND
 23015         DEPENDING ON DFHEIGDI
 23016     ELSE IF DFHEIGDJ EQUAL 31
 23017         GO TO 9000-NOTFND
 23018         DEPENDING ON DFHEIGDI
 23019     ELSE IF DFHEIGDJ EQUAL 32
 23020         GO TO 9100-NOTFND,
 23021               9100-NOTFND
 23022         DEPENDING ON DFHEIGDI
 23023     ELSE IF DFHEIGDJ EQUAL 33
 23024         GO TO 9991-CRTO-NOT-FOUND,
 23025               9991-CRTO-NOT-FOUND
 23026         DEPENDING ON DFHEIGDI.
 23027     MOVE '9%                    "   ' TO DFHEIV0
 23028     MOVE 'EL050' TO DFHEIV1
 23029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23030     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41680     Code:       94517
