* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 030515  IR2015030300002  PEMA  FIX CRIT PERIOD EDITS
    58******************************************************************
    59
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   3
* EL156.cbl
    61 ENVIRONMENT DIVISION.
    62
    63 DATA DIVISION.
    64
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67
    68 77  FILLER  PIC X(32)  VALUE '********************************'.
    69 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    70 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    71 77  WS-SSN  PIC X(9) VALUE ZEROS.
    72 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    73 77  C0                          PIC S999 COMP-3 VALUE +0.
    74 77  C1                          PIC S999 COMP-3 VALUE +0.
    75 77  C2                          PIC S999 COMP-3 VALUE +0.
    76 77  C3                          PIC S999 COMP-3 VALUE +0.
    77 77  s1                          PIC S999 COMP-3 VALUE +0.
    78 77  s2                          pic s999 comp-3 value +0.
    79 77  P1                          PIC S999 COMP-3 VALUE +0.
    80 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    81 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    82 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    83 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    84 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    85 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    86 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    87 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    88 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    89 77  ws-max-bens                 pic s999 comp-3 value +0.
    90 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    91 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    92 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    93 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    94 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    95 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    96
    97*    COPY ELCSCTM.
    98******************************************************************
    99*                                                                *
   100*                                                                *
   101*                            ELCSCTM                             *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-MESSAGE.
   108     12  FILLER                          PIC X(30)
   109            VALUE '** LOGIC SECURITY VIOLATION -'.
   110     12  SM-READ                         PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' PGM='.
   113     12  SM-PGM                          PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' OPR='.
   116     12  SM-PROCESSOR-ID                 PIC X(4).
   117     12  FILLER                          PIC X(6)
   118            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   4
* EL156.cbl
   119     12  SM-TERMID                       PIC X(4).
   120     12  FILLER                          PIC XX   VALUE SPACE.
   121     12  SM-JUL-DATE                     PIC 9(5).
   122     12  FILLER                          PIC X    VALUE SPACE.
   123     12  SM-TIME                         PIC 99.99.
   124
   125
   126*    COPY ELCSCRTY.
   127******************************************************************
   128*                                                                *
   129*                                                                *
   130*                            ELCSCRTY                            *
   131*                            VMOD=2.001                          *
   132*                                                                *
   133*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   134*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   135*        SAVED IN PI-SECURITY-ADDRESS.                           *
   136*                                                                *
   137******************************************************************
   138 01  SECURITY-CONTROL.
   139     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   140     12  FILLER                       PIC XX    VALUE 'SC'.
   141     12  SC-CREDIT-CODES.
   142         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   143             20  SC-CREDIT-DISPLAY    PIC X.
   144             20  SC-CREDIT-UPDATE     PIC X.
   145     12  SC-CLAIMS-CODES.
   146         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   147             20  SC-CLAIMS-DISPLAY    PIC X.
   148             20  SC-CLAIMS-UPDATE     PIC X.
   149
   150 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   151 01  WS-DATE-AREA.
   152     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   153     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   154     12  SAVE-DATE-CCYYMMDD.
   155         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   156         16  SAVE-DATE-YMD.
   157             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   158             20  FILLER              PIC X(04)   VALUE SPACES.
   159
   160 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   161 01  STANDARD-AREAS.
   162     12  WS-RESPONSE         PIC S9(8)   COMP.
   163         88  WS-RESP-NORMAL              VALUE +00.
   164         88  WS-RESP-ERROR               VALUE +01.
   165         88  WS-RESP-NOTFND              VALUE +13.
   166         88  WS-RESP-DUPREC              VALUE +14.
   167         88  WS-RESP-ENDFILE             VALUE +20.
   168     12  PMT-HEAD-A.
   169         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   170         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   171         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   172-        '     RESERVES  TYPE    AMOUNT'.
   173     12  PMT-HEAD-B.
   174         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   175         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   176         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   5
* EL156.cbl
   177     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   178     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   179     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   180     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   181     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   182     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   183     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   184     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   185     12  PGM-NAME            PIC X(8).
   186     12  TIME-IN             PIC S9(7).
   187     12  TIME-OUT-R  REDEFINES TIME-IN.
   188         16  FILLER          PIC X.
   189         16  TIME-OUT        PIC 99V99.
   190         16  FILLER          PIC XX.
   191     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   192     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   193     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   194     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   195     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   196     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   197     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   198     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   199     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   200     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   201     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   202     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   203     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   204     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   205     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   206     12  WS-BLANK            PIC X       VALUE ' '.
   207
   208 01  MISC-WORK-AREAS.
   209     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   210     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   211     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   212     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   213     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   214     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   215     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   216     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   217     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   218     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   219     12  W-CALLED-NAME           PIC X(08).
   220     12  W-EOB-CODES.
   221         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   222             20  W-EOB-CODE      PIC XXX.
   223             20  W-EOB-FILLER    PIC X.
   224     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   225     12  W-NAME-LAST             PIC X(15).
   226     12  W-NAME-FIRST            PIC X(15).
   227     12  W-NAME-MIDDLE.
   228         16  FILLER              PIC X.
   229         16  W-NAME-MIDDLE-2     PIC X.
   230         16  FILLER              PIC X(13).
   231     12  W-DMD-CHECK-NO.
   232         16  W-DMD-CHECK-NO-1    PIC X(4).
   233         16  W-DMD-CHECK-NO-2    PIC X.
   234         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   6
* EL156.cbl
   235
   236     12  WS-COMPUTE-FROM-DT  PIC XX.
   237     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   238     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   239     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   240     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   241     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   242     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   243         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   244         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   245     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   246         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   247     12  WS-UPDATE-SW        PIC X VALUE ' '.
   248     12  WS-GROUPING.
   249         16  WS-GROUP-1      PIC X VALUE SPACES.
   250         16  FILLER          PIC X(05) VALUE SPACES.
   251     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   252     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   253     12  WS-WORK-STATE-ACCT.
   254         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   255         16  FILLER          PIC X       VALUE '/'.
   256         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   257     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   258     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   259     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   260     12  QID.
   261         16  QID-TERM        PIC X(4)    VALUE SPACES.
   262         16  FILLER          PIC X(4)    VALUE '156A'.
   263     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   264     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   265     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   266     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   267     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   268     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   269     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   270     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   271     12  WS-STATUS           PIC X       VALUE SPACES.
   272     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   273     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   274     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   275     12  ws-extended-exp-dt  pic xx      value low-values.
   276     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   277     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   278     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   279     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   280     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   281     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   282     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   283     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   284     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   285     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   286     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   287     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   288     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   289     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   290     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   291     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   292     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   7
* EL156.cbl
   293     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   294     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   295     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   296     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   297     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   298     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   299     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   300     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   301     12  WORK-DATE-FROM.
   302         16  WDF-MONTH       PIC 99        VALUE ZERO.
   303         16  WDF-DAY         PIC 99        VALUE ZERO.
   304         16  WDF-YEAR        PIC 99        VALUE ZERO.
   305     12  WORK-DATE-THRU.
   306         16  WDT-MONTH       PIC 99        VALUE ZERO.
   307         16  WDT-DAY         PIC 99        VALUE ZERO.
   308         16  WDT-YEAR        PIC 99        VALUE ZERO.
   309     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   310     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   311     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   312     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   313     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   314     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   315     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   316     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   317     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   318     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   319     12  WS-PY-WK REDEFINES WS-PY-WORK.
   320         16  WS-PY-NUM       PIC S9(7)V99.
   321         16  WS-PY-SIGN      PIC X.
   322     12  WS-DY-WORK          PIC S9(5).
   323     12  WS-DY-WK REDEFINES WS-DY-WORK.
   324         16  WS-DY-NUM       PIC S9(4).
   325         16  WS-DY-SIGN      PIC X.
   326     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   327         88  COMP-REC-FOUND              VALUE 'Y'.
   328     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   329         88  BENEFIT-FOUND       VALUE 'Y'.
   330         88  NO-BENEFIT-FOUND    VALUE 'N'.
   331     12  WS-TERMS.
   332         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   333         16  FILLER          PIC X       VALUE '/'.
   334         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   335         16  WST-REM-DAYS-GRP.
   336             20  WST-SLASH   PIC X       VALUE '/'.
   337             20  WST-REM-DAYS
   338                             PIC --9.
   339     12  WS-ACCESS.
   340         16  FILLER          PIC XX      VALUE SPACES.
   341         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   342     12  WS-STATE-ACCESS.
   343         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   344         16  FILLER          PIC XX      VALUE SPACES.
   345     12  WS-CARR-ACCESS.
   346         16  FILLER          PIC X(3)    VALUE SPACES.
   347         16  WS-CARR         PIC X       VALUE SPACES.
   348     12  DATE-WORK.
   349         16  FILLER          PIC XX      VALUE SPACES.
   350         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   8
* EL156.cbl
   351     12  WS-SAVE-INPUT.
   352         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   353         16  WS-PAYEE        PIC XX      VALUE SPACE.
   354         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   355         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   356         16  WS-OFFLINE      PIC X       VALUE SPACE.
   357         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   358         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   359         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   360         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   361         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   362         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   363         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   364         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   365         16  WS-ETYPE        PIC X       VALUE SPACE.
   366         16  WS-CASH         PIC X       VALUE SPACE.
   367         16  WS-GROUPED      PIC X       VALUE SPACE.
   368         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   369         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   370         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   371         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   372         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   373         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   374         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   375         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   376     12  LAST-ERROR-LINE.
   377         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   378         16  FILLER              PIC X(30)
   379             VALUE ' FATAL ERRORS ENCOUNTERED'.
   380         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   381         16  FILLER              PIC X(28)
   382             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   383     12  WS-CHECK-AREA.
   384         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   385         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   386     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   387     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   388         16  FILLER              PIC XX.
   389         16  WS-A-CHECK-NUM-5    PIC 9(5).
   390     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   391         16  FILLER              PIC X.
   392         16  WS-A-CHECK-NUM-6    PIC 9(6).
   393     12  OPTION-1-SAVE-AREA.
   394         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   395         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   396     12  WS-WORK-ZIP.
   397         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   398         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   399     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   400                                 PIC 9(9).
   401     12  WS-FLI-PMTNOTE.
   402         16  WS-PMTOPTION        PIC XX.
   403         16  WS-DOCNAME          PIC X(28).
   404         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   405             20  WS-AMOUNT       PIC X(8).
   406             20  FILLER          PIC X(20).
   407         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   408             20  WS-NUM-AMT      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   9
* EL156.cbl
   409             20  FILLER          PIC X(20).
   410
   411     12  WS-HAN-PMTNOTE.
   412         16  WS-HAN-PMT-CODE     PIC X.
   413         16  WS-HAN-PMT-NOTE     PIC X(39).
   414
   415     12  WS-NCL-PMT-OPTION       PIC XX.
   416         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   417
   418     12  WS-CLAIM-SEQUENCE.
   419         16  FILLER              PIC X VALUE '('.
   420         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   421         16  FILLER              PIC X(04) VALUE ' OF '.
   422         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   423         16  FILLER              PIC X VALUE ')'.
   424
   425     12  WS-REFUND-AMT           PIC Z(7).99.
   426     12  WS-CALC-INT             PIC S9(7)V99.
   427     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   428
   429     12  SUB                     PIC 99 VALUE ZEROS.
   430
   431     12  WS-BOANOTE1.
   432         16  WS-BOANOTE1-DESC    PIC X(11).
   433         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   434         16  FILLER              PIC X(17).
   435     12  WS-BOANOTE2.
   436         16  WS-BOANOTE2-DESC    PIC X(11).
   437         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   438         16  FILLER              PIC X(17).
   439
   440     12  WS-NCLNOTE1.
   441         16  WS-NCLNOTE1-DESC    PIC X(11).
   442         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   443         16  FILLER              PIC X(17).
   444     12  WS-NCLNOTE2.
   445         16  WS-NCLNOTE2-DESC    PIC X(11).
   446         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   447         16  FILLER              PIC X(17).
   448
   449     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   450     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   451     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   452     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   453     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   454     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   455     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   456     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   457     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   458     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   459
   460     12  WS-AIG-WORK-AREAS.
   461         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   462             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   463         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   464             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   465         16  WS-FROM-DATE-MDY.
   466             20  WS-FROM-MO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  10
* EL156.cbl
   467             20  WS-FROM-DA      PIC 99.
   468             20  WS-FROM-YR      PIC 99.
   469         16  WS-TEMP-DATE-MDY.
   470             20  WS-TEMP-MO      PIC 99.
   471             20  WS-TEMP-DA      PIC 99.
   472             20  WS-TEMP-YR      PIC 99.
   473         16  WS-BIN-FROM-DT      PIC XX.
   474         16  WS-TEMP-INC-MDY.
   475             20  WS-TEMP-INC-MO  PIC 99.
   476             20  WS-TEMP-INC-DA  PIC 99.
   477             20  WS-TEMP-INC-YR  PIC 99.
   478         16  WS-PMT-DUE-MDY.
   479             20  WS-PMT-DUE-MO   PIC 99.
   480             20  WS-PMT-DUE-DA   PIC 99.
   481             20  WS-PMT-DUE-YR   PIC 99.
   482         16  WS-PMT-DUE-DT       PIC XX.
   483         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   484         16  WS-RETRO-ELIM-DT    PIC XX.
   485         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   486             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   487         16  WS-SAVE-DUE-DA      PIC 99.
   488         16  WS-CDAYS            PIC S9(05).
   489         16  WS-DAYS-OFF         PIC S9(05).
   490         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   491             88  ELIM-SATISFIED            VALUE 'Y'.
   492         16  WS-AIG-CHECKNO.
   493             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   494             20  WS-A-CHECKNO-3-7.
   495                 24  FILLER              PIC X(3)    VALUE SPACES.
   496                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   497                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   498         16  WS-AIG-GROUPING.
   499             20  WS-A-BENE               PIC XXX.
   500             20  FILLER                  PIC XXX.
   501         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   502             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   503             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   504         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   505                 VALUE 'UNEMPLOYMENT PAYMENT'.
   506         16  WS-CHK-THRU-DT              PIC XX.
   507         16  WS-HOLD-BIN-DATE-1          PIC XX.
   508
   509 01  MISC-CSO-AREA.
   510     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   511     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   512     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   513         88  APPROVAL-NEEDED                        VALUE 'Y'.
   514     12  WS-APPROV-NOTE                  PIC X(43)
   515         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   516     12  WS-3550-APPROV-NOTE             PIC X(43)
   517         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   518     12  WS-REAUDIT-NOTE                 PIC X(43)
   519         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   520     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   521     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   522     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   523     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   524     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  11
* EL156.cbl
   525     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   526     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   527         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   528     12  WS-PAYEE-CITY-STATE     PIC X(30).
   529     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   530         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   531     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   532     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   533     12  WS-WORK-NAME            PIC X(30).
   534     12  FILLER  REDEFINES WS-WORK-NAME.
   535         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   536     12  WS-INSURED-NAME         PIC X(30).
   537     12  FILLER  REDEFINES WS-INSURED-NAME.
   538         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   539     12  WS-PAYEE-NAME           PIC X(30).
   540     12  FILLER  REDEFINES WS-PAYEE-NAME.
   541         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   542
   543 01  ERROR-MESSAGES.
   544     12  ER-0000                 PIC X(4)  VALUE '0000'.
   545     12  ER-0004                 PIC X(4)  VALUE '0004'.
   546     12  ER-0008                 PIC X(4)  VALUE '0008'.
   547     12  ER-0019                 PIC X(4)  VALUE '0019'.
   548     12  ER-0029                 PIC X(4)  VALUE '0029'.
   549     12  ER-0042                 PIC X(4)  VALUE '0042'.
   550     12  ER-0070                 PIC X(4)  VALUE '0070'.
   551     12  ER-0130                 PIC X(4)  VALUE '0130'.
   552     12  ER-0149                 PIC X(4)  VALUE '0149'.
   553     12  ER-0154                 PIC X(4)  VALUE '0154'.
   554     12  ER-0168                 PIC X(4)  VALUE '0168'.
   555     12  ER-0169                 PIC X(4)  VALUE '0169'.
   556     12  ER-0172                 PIC X(4)  VALUE '0174'.
   557     12  ER-0198                 PIC X(4)  VALUE '0198'.
   558     12  ER-0204                 PIC X(4)  VALUE '0204'.
   559     12  ER-0206                 PIC X(4)  VALUE '0206'.
   560     12  ER-0252                 PIC X(4)  VALUE '0252'.
   561     12  ER-0254                 PIC X(4)  VALUE '0254'.
   562     12  ER-0282                 PIC X(4)  VALUE '0282'.
   563     12  ER-0283                 PIC X(4)  VALUE '0283'.
   564     12  ER-0294                 PIC X(4)  VALUE '0294'.
   565     12  ER-0338                 PIC X(4)  VALUE '0338'.
   566     12  ER-0419                 PIC X(4)  VALUE '0419'.
   567     12  ER-0420                 PIC X(4)  VALUE '0420'.
   568     12  ER-0421                 PIC X(4)  VALUE '0421'.
   569     12  ER-0422                 PIC X(4)  VALUE '0422'.
   570     12  ER-0433                 PIC X(4)  VALUE '0433'.
   571     12  ER-0436                 PIC X(4)  VALUE '0436'.
   572     12  ER-0437                 PIC X(4)  VALUE '0437'.
   573     12  ER-0438                 PIC X(4)  VALUE '0438'.
   574     12  ER-0439                 PIC X(4)  VALUE '0439'.
   575     12  ER-0440                 PIC X(4)  VALUE '0440'.
   576     12  ER-0441                 PIC X(4)  VALUE '0441'.
   577     12  ER-0442                 PIC X(4)  VALUE '0442'.
   578     12  ER-0443                 PIC X(4)  VALUE '0443'.
   579     12  ER-0444                 PIC X(4)  VALUE '0444'.
   580     12  ER-0445                 PIC X(4)  VALUE '0445'.
   581     12  ER-0446                 PIC X(4)  VALUE '0446'.
   582     12  ER-0447                 PIC X(4)  VALUE '0447'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  12
* EL156.cbl
   583     12  ER-0448                 PIC X(4)  VALUE '0448'.
   584     12  ER-0449                 PIC X(4)  VALUE '0449'.
   585     12  ER-0452                 PIC X(4)  VALUE '0452'.
   586     12  ER-0458                 PIC X(4)  VALUE '0458'.
   587     12  ER-0459                 PIC X(4)  VALUE '0459'.
   588     12  ER-0460                 PIC X(4)  VALUE '0460'.
   589     12  ER-0461                 PIC X(4)  VALUE '0461'.
   590     12  ER-0462                 PIC X(4)  VALUE '0462'.
   591     12  ER-0463                 PIC X(4)  VALUE '0463'.
   592     12  ER-0464                 PIC X(4)  VALUE '0464'.
   593     12  ER-0465                 PIC X(4)  VALUE '0465'.
   594     12  ER-0466                 PIC X(4)  VALUE '0466'.
   595     12  ER-0467                 PIC X(4)  VALUE '0467'.
   596     12  ER-0468                 PIC X(4)  VALUE '0468'.
   597     12  ER-0469                 PIC X(4)  VALUE '0469'.
   598     12  ER-0473                 PIC X(4)  VALUE '0473'.
   599     12  ER-0474                 PIC X(4)  VALUE '0474'.
   600     12  ER-0475                 PIC X(4)  VALUE '0475'.
   601     12  ER-0476                 PIC X(4)  VALUE '0476'.
   602     12  ER-0477                 PIC X(4)  VALUE '0477'.
   603     12  ER-0478                 PIC X(4)  VALUE '0478'.
   604     12  ER-0479                 PIC X(4)  VALUE '0479'.
   605     12  ER-0481                 PIC X(4)  VALUE '0481'.
   606     12  ER-0491                 PIC X(4)  VALUE '0491'.
   607     12  ER-0492                 PIC X(4)  VALUE '0492'.
   608     12  ER-0493                 PIC X(4)  VALUE '0493'.
   609     12  ER-0494                 PIC X(4)  VALUE '0494'.
   610     12  ER-0495                 PIC X(4)  VALUE '0495'.
   611     12  ER-0499                 PIC X(4)  VALUE '0499'.
   612     12  ER-0500                 PIC X(4)  VALUE '0500'.
   613     12  ER-0501                 PIC X(4)  VALUE '0501'.
   614     12  ER-0502                 PIC X(4)  VALUE '0502'.
   615     12  ER-0508                 PIC X(4)  VALUE '0508'.
   616     12  ER-0513                 PIC X(4)  VALUE '0513'.
   617     12  ER-0518                 PIC X(4)  VALUE '0518'.
   618     12  ER-0524                 PIC X(4)  VALUE '0524'.
   619     12  ER-0525                 PIC X(4)  VALUE '0525'.
   620     12  ER-0526                 PIC X(4)  VALUE '0526'.
   621     12  ER-0530                 PIC X(4)  VALUE '0530'.
   622     12  ER-0540                 PIC X(4)  VALUE '0540'.
   623     12  ER-0541                 PIC X(4)  VALUE '0541'.
   624     12  ER-0542                 PIC X(4)  VALUE '0542'.
   625     12  ER-0543                 PIC X(4)  VALUE '0543'.
   626     12  ER-0545                 PIC X(4)  VALUE '0545'.
   627     12  ER-0552                 PIC X(4)  VALUE '0552'.
   628     12  ER-0555                 PIC X(4)  VALUE '0555'.
   629     12  ER-0556                 PIC X(4)  VALUE '0556'.
   630     12  ER-0557                 PIC X(4)  VALUE '0557'.
   631     12  ER-0572                 PIC X(4)  VALUE '0572'.
   632     12  ER-0573                 PIC X(4)  VALUE '0573'.
   633     12  ER-0594                 PIC X(4)  VALUE '0594'.
   634     12  ER-0616                 PIC X(4)  VALUE '0616'.
   635     12  ER-0617                 PIC X(4)  VALUE '0617'.
   636     12  ER-0618                 PIC X(4)  VALUE '0618'.
   637     12  ER-0657                 PIC X(4)  VALUE '0657'.
   638     12  ER-0658                 PIC X(4)  VALUE '0658'.
   639     12  ER-0699                 PIC X(4)  VALUE '0699'.
   640     12  ER-0730                 PIC X(4)  VALUE '0730'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  13
* EL156.cbl
   641     12  ER-0737                 PIC X(4)  VALUE '0737'.
   642     12  ER-0760                 PIC X(4)  VALUE '0760'.
   643     12  ER-0768                 PIC X(4)  VALUE '0768'.
   644     12  ER-0769                 PIC X(4)  VALUE '0769'.
   645     12  ER-0770                 PIC X(4)  VALUE '0770'.
   646     12  ER-0802                 PIC X(4)  VALUE '0802'.
   647     12  ER-0803                 PIC X(4)  VALUE '0803'.
   648     12  ER-0819                 PIC X(4)  VALUE '0819'.
   649     12  ER-0834                 PIC X(4)  VALUE '0834'.
   650     12  ER-0836                 PIC X(4)  VALUE '0836'.
   651     12  ER-0844                 PIC X(4)  VALUE '0844'.
   652     12  ER-0845                 PIC X(4)  VALUE '0845'.
   653     12  ER-0846                 PIC X(4)  VALUE '0846'.
   654     12  ER-0849                 PIC X(4)  VALUE '0849'.
   655     12  ER-0851                 PIC X(4)  VALUE '0851'.
   656     12  ER-0872                 PIC X(4)  VALUE '0872'.
   657     12  ER-0873                 PIC X(4)  VALUE '0873'.
   658     12  ER-0874                 PIC X(4)  VALUE '0874'.
   659     12  ER-0879                 PIC X(4)  VALUE '0879'.
   660     12  ER-0919                 PIC X(4)  VALUE '0919'.
   661     12  ER-0921                 PIC X(4)  VALUE '0921'.
   662     12  ER-0923                 PIC X(4)  VALUE '0923'.
   663     12  ER-0925                 PIC X(4)  VALUE '0925'.
   664     12  ER-0944                 PIC X(4)  VALUE '0944'.
   665     12  ER-0945                 PIC X(4)  VALUE '0945'.
   666     12  ER-0946                 PIC X(4)  VALUE '0946'.
   667     12  ER-0947                 PIC X(4)  VALUE '0947'.
   668     12  ER-0948                 PIC X(4)  VALUE '0948'.
   669     12  ER-0949                 PIC X(4)  VALUE '0949'.
   670     12  ER-0950                 PIC X(4)  VALUE '0950'.
   671     12  ER-0951                 PIC X(4)  VALUE '0951'.
   672     12  ER-0954                 PIC X(4)  VALUE '0954'.
   673     12  ER-0956                 PIC X(4)  VALUE '0956'.
   674     12  ER-0967                 PIC X(4)  VALUE '0967'.
   675     12  ER-0968                 PIC X(4)  VALUE '0968'.
   676     12  ER-0974                 PIC X(4)  VALUE '0974'.
   677     12  ER-0975                 PIC X(4)  VALUE '0975'.
   678     12  ER-1561                 PIC X(4)  VALUE '1561'.
   679     12  ER-1566                 PIC X(4)  VALUE '1566'.
   680     12  ER-1567                 PIC X(4)  VALUE '1567'.
   681     12  ER-1569                 PIC X(4)  VALUE '1569'.
   682     12  er-1657                 pic x(4)  value '1657'.
   683     12  er-1658                 pic x(4)  value '1658'.
   684     12  er-1667                 pic x(4)  value '1667'.
   685     12  er-1670                 pic x(4)  value '1670'.
   686     12  er-1671                 pic x(4)  value '1671'.
   687     12  er-1672                 pic x(4)  value '1672'.
   688     12  er-1673                 pic x(4)  value '1673'.
   689     12  er-1674                 pic x(4)  value '1674'.
   690     12  er-1677                 pic x(4)  value '1677'.
   691     12  ER-1775                 PIC X(4)  VALUE '1775'.
   692     12  ER-1880                 PIC X(4)  VALUE '1880'.
   693     12  ER-2044                 PIC X(4)  VALUE '2044'.
   694     12  ER-3140                 PIC X(4)  VALUE '3140'.
   695     12  ER-3141                 PIC X(4)  VALUE '3141'.
   696     12  ER-3255                 PIC X(4)  VALUE '3255'.
   697     12  ER-3516                 PIC X(4)  VALUE '3516'.
   698     12  ER-3527                 PIC X(4)  VALUE '3527'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  14
* EL156.cbl
   699     12  ER-3528                 PIC X(4)  VALUE '3528'.
   700     12  ER-3529                 PIC X(4)  VALUE '3529'.
   701     12  ER-3530                 PIC X(4)  VALUE '3530'.
   702     12  ER-3531                 PIC X(4)  VALUE '3531'.
   703     12  ER-3532                 PIC X(4)  VALUE '3532'.
   704     12  ER-3533                 PIC X(4)  VALUE '3533'.
   705     12  ER-3534                 PIC X(4)  VALUE '3534'.
   706     12  ER-3535                 PIC X(4)  VALUE '3535'.
   707     12  ER-3536                 PIC X(4)  VALUE '3536'.
   708     12  ER-3537                 PIC X(4)  VALUE '3537'.
   709     12  ER-3538                 PIC X(4)  VALUE '3538'.
   710     12  ER-3539                 PIC X(4)  VALUE '3539'.
   711     12  ER-3540                 PIC X(4)  VALUE '3540'.
   712     12  ER-3541                 PIC X(4)  VALUE '3541'.
   713     12  ER-3542                 PIC X(4)  VALUE '3542'.
   714     12  ER-3543                 PIC X(4)  VALUE '3543'.
   715     12  ER-3546                 PIC X(4)  VALUE '3546'.
   716     12  ER-3549                 PIC X(4)  VALUE '3549'.
   717     12  ER-3818                 PIC X(4)  VALUE '3818'.
   718     12  ER-7540                 PIC X(4)  VALUE '7540'.
   719     12  ER-7576                 PIC X(4)  VALUE '7576'.
   720     12  ER-7579                 PIC X(4)  VALUE '7579'.
   721     12  ER-7580                 PIC X(4)  VALUE '7580'.
   722     12  ER-7583                 PIC X(4)  VALUE '7583'.
   723     12  ER-7830                 PIC X(4)  VALUE '7830'.
   724     12  ER-7831                 PIC X(4)  VALUE '7831'.
   725     12  ER-7832                 PIC X(4)  VALUE '7832'.
   726     12  ER-7833                 PIC X(4)  VALUE '7833'.
   727     12  ER-7834                 PIC X(4)  VALUE '7834'.
   728     12  ER-7835                 PIC X(4)  VALUE '7835'.
   729     12  ER-7836                 PIC X(4)  VALUE '7836'.
   730     12  ER-7837                 PIC X(4)  VALUE '7837'.
   731     12  ER-7838                 PIC X(4)  VALUE '7838'.
   732     12  ER-7841                 PIC X(4)  VALUE '7841'.
   733     12  ER-7844                 PIC X(4)  VALUE '7844'.
   734     12  ER-7845                 PIC X(4)  VALUE '7845'.
   735     12  ER-8000                 PIC X(4)  VALUE '8000'.
   736     12  ER-8051                 PIC X(4)  VALUE '8051'.
   737     12  ER-8052                 PIC X(4)  VALUE '8052'.
   738     12  ER-8053                 PIC X(4)  VALUE '8053'.
   739     12  ER-8054                 PIC X(4)  VALUE '8054'.
   740     12  ER-8055                 PIC X(4)  VALUE '8055'.
   741     12  ER-8056                 PIC X(4)  VALUE '8056'.
   742     12  ER-8057                 PIC X(4)  VALUE '8057'.
   743     12  ER-8058                 PIC X(4)  VALUE '8058'.
   744     12  ER-8059                 PIC X(4)  VALUE '8059'.
   745     12  ER-8060                 PIC X(4)  VALUE '8060'.
   746     12  ER-8061                 PIC X(4)  VALUE '8061'.
   747     12  ER-8062                 PIC X(4)  VALUE '8062'.
   748     12  ER-8063                 PIC X(4)  VALUE '8063'.
   749     12  ER-8064                 PIC X(4)  VALUE '8064'.
   750     12  ER-8065                 PIC X(4)  VALUE '8065'.
   751     12  ER-8066                 PIC X(4)  VALUE '8066'.
   752     12  ER-8146                 PIC X(4)  VALUE '8146'.
   753     12  ER-8147                 PIC X(4)  VALUE '8147'.
   754     12  ER-8152                 PIC X(4)  VALUE '8152'.
   755     12  ER-8153                 PIC X(4)  VALUE '8153'.
   756     12  ER-8154                 PIC X(4)  VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  15
* EL156.cbl
   757     12  ER-8155                 PIC X(4)  VALUE '8155'.
   758     12  ER-8310                 PIC X(4)  VALUE '8310'.
   759     12  ER-8311                 PIC X(4)  VALUE '8311'.
   760     12  ER-8312                 PIC X(4)  VALUE '8312'.
   761     12  ER-8313                 PIC X(4)  VALUE '8313'.
   762     12  ER-8314                 PIC X(4)  VALUE '8314'.
   763     12  ER-8315                 PIC X(4)  VALUE '8315'.
   764     12  ER-8316                 PIC X(4)  VALUE '8316'.
   765     12  ER-8317                 PIC X(4)  VALUE '8317'.
   766
   767 01  CSO-WORK-FIELDS.
   768     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   769       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   770
   771     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   772     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   773         88  CERT-NOTE-ADDED           VALUE 'Y'.
   774     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   775         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   776     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   777
   778     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   779
   780 01  SC-NP6-CERT-NOTE.
   781     12  FILLER                  PIC X(12)
   782               VALUE 'REM BENEFIT '.
   783     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   784     12  SC-NP6-COMM             PIC X(8)
   785               VALUE ' + 6 MO '.
   786     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   787     12  FILLER                  PIC X(12)
   788               VALUE ' = AMT PAID '.
   789     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   790
   791 01  SC-NP6-ORIG-NOTE.
   792     12  FILLER                  PIC X(63)  VALUE
   793         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   794 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   795     88  PDEF-FOUND                   VALUE 'Y'.
   796 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   797     88  ACCT-FOUND                   VALUE 'Y'.
   798 01  CTBL-KEY-SAVE               PIC X(5).
   799 01  CTBL-KEY.
   800     05  CTBL-COMPANY-CD         PIC X.
   801     05  CTBL-TABLE              PIC XXX.
   802     05  CTBL-BEN-TYPE           PIC X.
   803     05  CTBL-BEN-CODE           PIC XX.
   804 01  ERPDEF-KEY-SAVE             PIC X(18).
   805 01  ERPDEF-KEY.
   806     12  ERPDEF-COMPANY-CD       PIC X.
   807     12  ERPDEF-STATE            PIC XX.
   808     12  ERPDEF-PROD-CD          PIC XXX.
   809     12  F                       PIC X(7).
   810     12  ERPDEF-BEN-TYPE         PIC X.
   811     12  ERPDEF-BEN-CODE         PIC XX.
   812     12  ERPDEF-EXP-DT           PIC XX.
   813 01  ELCRTT-KEY.
   814     05  CTRLR-COMP-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  16
* EL156.cbl
   815     05  CTRLR-CARRIER       PIC X.
   816     05  CTRLR-GROUPING      PIC X(6).
   817     05  CTRLR-STATE         PIC X(2).
   818     05  CTRLR-ACCOUNT       PIC X(10).
   819     05  CTRLR-EFF-DT        PIC XX.
   820     05  CTRLR-CERT-NO       PIC X(11).
   821     05  CTRLR-REC-TYPE      PIC X.
   822 01  ACCESS-KEYS.
   823     12  ELARCH-KEY.
   824         16  ARCH-CO             PIC X.
   825         16  ARCH-NUMBER         PIC S9(08) COMP.
   826         16  ARCH-REC-TYPE       PIC X.
   827         16  ARCH-SEQ            PIC S9(04) COMP.
   828     12  ELMSTR-KEY.
   829         16  MSTR-COMP-CD        PIC X.
   830         16  MSTR-CARRIER        PIC X.
   831         16  MSTR-CLAIM-NO       PIC X(7).
   832         16  MSTR-CERT-NO        PIC X(11).
   833     12  ELCNTL-KEY.
   834         16  CNTL-COMP-ID        PIC X(3).
   835         16  CNTL-REC-TYPE       PIC X.
   836         16  CNTL-ACCESS         PIC X(4).
   837         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   838     12  ELCERT-KEY.
   839         16  CERT-COMP-CD        PIC X.
   840         16  CERT-CARRIER        PIC X.
   841         16  CERT-GROUPING       PIC X(6).
   842         16  CERT-STATE          PIC XX.
   843         16  CERT-ACCOUNT        PIC X(10).
   844         16  CERT-EFF-DT         PIC XX.
   845         16  CERT-CERT-NO        PIC X(11).
   846     12  ELTRLR-KEY.
   847         16  TRLR-COMP-CD        PIC X.
   848         16  TRLR-CARRIER        PIC X.
   849         16  TRLR-CLAIM-NO       PIC X(7).
   850         16  TRLR-CERT-NO        PIC X(11).
   851         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   852     12  ELACTQ-KEY.
   853         16  ACTQ-COMP-CD        PIC X.
   854         16  ACTQ-CARRIER        PIC X.
   855         16  ACTQ-CLAIM-NO       PIC X(7).
   856         16  ACTQ-CERT-NO        PIC X(11).
   857     12  W-NOTE-KEY.
   858         16  W-NOTE-COMP-CD      PIC X.
   859         16  W-NOTE-CERT-KEY.
   860             20  W-NOTE-CARRIER  PIC X.
   861             20  W-NOTE-GROUPING PIC X(6).
   862             20  W-NOTE-STATE    PIC XX.
   863             20  W-NOTE-ACCOUNT  PIC X(10).
   864             20  W-NOTE-EFF-DT   PIC XX.
   865             20  W-NOTE-CERT-NO  PIC X(11).
   866     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   867     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   868     12  ERACCT-KEY.
   869         16  ERACCT-PARTIAL-KEY.
   870             20  ACCT-COMP-CD    PIC X.
   871             20  ACCT-CARRIER    PIC X.
   872             20  ACCT-GROUPING   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  17
* EL156.cbl
   873             20  ACCT-STATE      PIC XX.
   874             20  ACCT-ACCOUNT    PIC X(10).
   875         16  ACCT-EXP-DT         PIC XX.
   876         16  FILLER              PIC X(4) VALUE SPACES.
   877     12  ELCHKQ-KEY.
   878         16  CHKQ-COMP-CD        PIC X.
   879         16  CHKQ-CONTROL        PIC S9(8) COMP.
   880         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   881     12  ELBENE-KEY.
   882         16  BENE-COMP-CD         PIC X.
   883         16  BENE-RECORD-TYPE     PIC X.
   884         16  BENE-NUMBER          PIC X(10).
   885     12  ERCOMP-KEY.
   886         16  COMP-COMP-CD        PIC X.
   887         16  COMP-CARRIER        PIC X.
   888         16  COMP-GROUP          PIC X(06).
   889         16  COMP-FIN-RESP       PIC X(10).
   890         16  COMP-ACCOUNT        PIC X(10).
   891         16  COMP-TYPE           PIC X.
   892
   893     12  DLO035-KEY.
   894         16  DL35-PROCESS-TYPE   PIC X.
   895         16  DL35-CREDIT-CARD    PIC X(20).
   896         16  DL35-BEN-TYPE       PIC XX.
   897         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   898         16  DL35-RETURN-CODE    PIC XX.
   899
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  18
* EL156.cbl
   901*    COPY ELCDATE.
   902******************************************************************
   903*                                                                *
   904*                                                                *
   905*                            ELCDATE.                            *
   906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   907*                            VMOD=2.003
   908*                                                                *
   909*                                                                *
   910*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   911*                 LENGTH = 200                                   *
   912******************************************************************
   913
   914 01  DATE-CONVERSION-DATA.
   915     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   916     12  DC-OPTION-CODE                PIC X.
   917         88  BIN-TO-GREG                VALUE ' '.
   918         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   919         88  EDIT-GREG-TO-BIN           VALUE '2'.
   920         88  YMD-GREG-TO-BIN            VALUE '3'.
   921         88  MDY-GREG-TO-BIN            VALUE '4'.
   922         88  JULIAN-TO-BIN              VALUE '5'.
   923         88  BIN-PLUS-ELAPSED           VALUE '6'.
   924         88  FIND-CENTURY               VALUE '7'.
   925         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   926         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   927         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   928         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   929         88  JULIAN-TO-BIN-3            VALUE 'C'.
   930         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   931         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   932         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   933         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   934         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   935         88  CHECK-LEAP-YEAR            VALUE 'H'.
   936         88  BIN-3-TO-GREG              VALUE 'I'.
   937         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   938         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   939         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   940         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   941         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   942         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   943         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   944         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   945         88  THREE-CHARACTER-BIN
   946                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   947         88  GREGORIAN-TO-BIN
   948                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   949         88  BIN-TO-GREGORIAN
   950                  VALUES ' ' '1' 'I' '8' 'G'.
   951         88  JULIAN-TO-BINARY
   952                  VALUES '5' 'C' 'E' 'F'.
   953     12  DC-ERROR-CODE                 PIC X.
   954         88  NO-CONVERSION-ERROR        VALUE ' '.
   955         88  DATE-CONVERSION-ERROR
   956                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   957         88  DATE-IS-ZERO               VALUE '1'.
   958         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  19
* EL156.cbl
   959         88  DATE-IS-INVALID            VALUE '3'.
   960         88  DATE1-GREATER-DATE2        VALUE '4'.
   961         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   962         88  DATE-INVALID-OPTION        VALUE '9'.
   963         88  INVALID-CENTURY            VALUE 'A'.
   964         88  ONLY-CENTURY               VALUE 'B'.
   965         88  ONLY-LEAP-YEAR             VALUE 'C'.
   966         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   967     12  DC-END-OF-MONTH               PIC X.
   968         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   969     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   970         88  USE-NORMAL-PROCESS         VALUE ' '.
   971         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   972         88  ADJUST-UP-100-YRS          VALUE '2'.
   973     12  FILLER                        PIC X.
   974     12  DC-CONVERSION-DATES.
   975         16  DC-BIN-DATE-1             PIC XX.
   976         16  DC-BIN-DATE-2             PIC XX.
   977         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   978         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   979                       DC-GREG-DATE-1-EDIT.
   980             20  DC-EDIT1-MONTH        PIC 99.
   981             20  SLASH1-1              PIC X.
   982             20  DC-EDIT1-DAY          PIC 99.
   983             20  SLASH1-2              PIC X.
   984             20  DC-EDIT1-YEAR         PIC 99.
   985         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   986         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   987                     DC-GREG-DATE-2-EDIT.
   988             20  DC-EDIT2-MONTH        PIC 99.
   989             20  SLASH2-1              PIC X.
   990             20  DC-EDIT2-DAY          PIC 99.
   991             20  SLASH2-2              PIC X.
   992             20  DC-EDIT2-YEAR         PIC 99.
   993         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   994         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   995                     DC-GREG-DATE-1-YMD.
   996             20  DC-YMD-YEAR           PIC 99.
   997             20  DC-YMD-MONTH          PIC 99.
   998             20  DC-YMD-DAY            PIC 99.
   999         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1000         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1001                      DC-GREG-DATE-1-MDY.
  1002             20  DC-MDY-MONTH          PIC 99.
  1003             20  DC-MDY-DAY            PIC 99.
  1004             20  DC-MDY-YEAR           PIC 99.
  1005         16  DC-GREG-DATE-1-ALPHA.
  1006             20  DC-ALPHA-MONTH        PIC X(10).
  1007             20  DC-ALPHA-DAY          PIC 99.
  1008             20  FILLER                PIC XX.
  1009             20  DC-ALPHA-CENTURY.
  1010                 24 DC-ALPHA-CEN-N     PIC 99.
  1011             20  DC-ALPHA-YEAR         PIC 99.
  1012         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1013         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1014         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1015         16  DC-JULIAN-DATE            PIC 9(05).
  1016         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  20
* EL156.cbl
  1017                                       PIC 9(05).
  1018         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1019             20  DC-JULIAN-YEAR        PIC 99.
  1020             20  DC-JULIAN-DAYS        PIC 999.
  1021         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1022         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1023         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1024     12  DATE-CONVERSION-VARIBLES.
  1025         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1026         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1027             20  FILLER                PIC 9(3).
  1028             20  HOLD-CEN-1-CCYY.
  1029                 24  HOLD-CEN-1-CC     PIC 99.
  1030                 24  HOLD-CEN-1-YY     PIC 99.
  1031             20  HOLD-CEN-1-MO         PIC 99.
  1032             20  HOLD-CEN-1-DA         PIC 99.
  1033         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1034             20  HOLD-CEN-1-R-MO       PIC 99.
  1035             20  HOLD-CEN-1-R-DA       PIC 99.
  1036             20  HOLD-CEN-1-R-CCYY.
  1037                 24  HOLD-CEN-1-R-CC   PIC 99.
  1038                 24  HOLD-CEN-1-R-YY   PIC 99.
  1039             20  FILLER                PIC 9(3).
  1040         16  HOLD-CENTURY-1-X.
  1041             20  FILLER                PIC X(3)  VALUE SPACES.
  1042             20  HOLD-CEN-1-X-CCYY.
  1043                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1044                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1045             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1046             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1047         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1048             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1049             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1050             20  HOLD-CEN-1-R-X-CCYY.
  1051                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1052                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1053             20  FILLER                PIC XXX.
  1054         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1055         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1056         16  DC-JULIAN-DATE-1          PIC 9(07).
  1057         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1058             20  DC-JULIAN-1-CCYY.
  1059                 24  DC-JULIAN-1-CC    PIC 99.
  1060                 24  DC-JULIAN-1-YR    PIC 99.
  1061             20  DC-JULIAN-DA-1        PIC 999.
  1062         16  DC-JULIAN-DATE-2          PIC 9(07).
  1063         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1064             20  DC-JULIAN-2-CCYY.
  1065                 24  DC-JULIAN-2-CC    PIC 99.
  1066                 24  DC-JULIAN-2-YR    PIC 99.
  1067             20  DC-JULIAN-DA-2        PIC 999.
  1068         16  DC-GREG-DATE-A-EDIT.
  1069             20  DC-EDITA-MONTH        PIC 99.
  1070             20  SLASHA-1              PIC X VALUE '/'.
  1071             20  DC-EDITA-DAY          PIC 99.
  1072             20  SLASHA-2              PIC X VALUE '/'.
  1073             20  DC-EDITA-CCYY.
  1074                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  21
* EL156.cbl
  1075                 24  DC-EDITA-YEAR     PIC 99.
  1076         16  DC-GREG-DATE-B-EDIT.
  1077             20  DC-EDITB-MONTH        PIC 99.
  1078             20  SLASHB-1              PIC X VALUE '/'.
  1079             20  DC-EDITB-DAY          PIC 99.
  1080             20  SLASHB-2              PIC X VALUE '/'.
  1081             20  DC-EDITB-CCYY.
  1082                 24  DC-EDITB-CENT     PIC 99.
  1083                 24  DC-EDITB-YEAR     PIC 99.
  1084         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1085         16  DC-GREG-DATE-CYMD-R REDEFINES
  1086                              DC-GREG-DATE-CYMD.
  1087             20  DC-CYMD-CEN           PIC 99.
  1088             20  DC-CYMD-YEAR          PIC 99.
  1089             20  DC-CYMD-MONTH         PIC 99.
  1090             20  DC-CYMD-DAY           PIC 99.
  1091         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1092         16  DC-GREG-DATE-MDCY-R REDEFINES
  1093                              DC-GREG-DATE-MDCY.
  1094             20  DC-MDCY-MONTH         PIC 99.
  1095             20  DC-MDCY-DAY           PIC 99.
  1096             20  DC-MDCY-CEN           PIC 99.
  1097             20  DC-MDCY-YEAR          PIC 99.
  1098    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1099        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1100    12  DC-EL310-DATE                  PIC X(21).
  1101    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  22
* EL156.cbl
  1103*    COPY ELCLOGOF.
  1104******************************************************************
  1105*                                                                *
  1106*                                                                *
  1107*                            ELCLOGOF.                           *
  1108*                            VMOD=2.001                          *
  1109*                                                                *
  1110*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1111*                                                                *
  1112******************************************************************
  1113 01  CLASIC-LOGOFF.
  1114     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1115     12  LOGOFF-TEXT.
  1116         16  FILLER          PIC X(5)    VALUE SPACES.
  1117         16  LOGOFF-MSG.
  1118             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1119             20  FILLER      PIC X       VALUE SPACES.
  1120             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1121         16  FILLER          PIC X(80)
  1122           VALUE '* YOU ARE NOW LOGGED OFF'.
  1123         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1124         16  FILLER          PIC X       VALUE QUOTE.
  1125         16  LOGOFF-SYS-MSG  PIC X(17)
  1126           VALUE 'S CLAS-IC SYSTEM '.
  1127     12  TEXT-MESSAGES.
  1128         16  UNACCESS-MSG    PIC X(29)
  1129             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1130         16  PGMIDERR-MSG    PIC X(17)
  1131             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  23
* EL156.cbl
  1133*    COPY ELCCALC.
  1134******************************************************************
  1135*                                                                *
  1136*                           ELCCALC.                            *
  1137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1138*                            VMOD=2.025                          *
  1139*                                                                *
  1140*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1141*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1142*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1143*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1144*                                                                *
  1145*  PASSED TO ELRTRM                                              *
  1146*  -----------------                                             *
  1147*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1148*  ORIGINAL TERM                                                 *
  1149*  BEGINNING DATE                                                *
  1150*  ENDING DATE                                                   *
  1151*  COMPANY I.D.                                                  *
  1152*  ACCOUNT MASTER USER FIELD                                     *
  1153*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1154*  FREE LOOK DAYS                                                *
  1155*                                                                *
  1156*  RETURNED FROM ELRTRM                                          *
  1157*  ---------------------                                         *
  1158*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1159*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1160*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1161*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1162*----------------------------------------------------------------*
  1163*  PASSED TO ELRAMT                                              *
  1164*  ----------------                                              *
  1165*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1166*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1167*  ORIGINAL AMOUNT                                               *
  1168*  ALTERNATE BENEFIT (BALLON)                                    *
  1169*  A.P.R. - NET PAY ONLY                                         *
  1170*  METHOD
  1171*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1172*  COMPANY I.D.                                                  *
  1173*  BENEFIT TYPE                                                  *
  1174*                                                                *
  1175*  RETURNED FROM ELRAMT                                          *
  1176*  --------------------                                          *
  1177*  REMAINING AMOUNT 1 - CURRENT                                  *
  1178*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1179*  REMAINING AMOUNT FACTOR
  1180*----------------------------------------------------------------*
  1181*  PASSED TO ELRESV                                              *
  1182*  -----------------                                             *
  1183*  CERTIFICATE EFFECTIVE DATE                                    *
  1184*  VALUATION DATE                                                *
  1185*  PAID THRU DATE                                                *
  1186*  BENEFIT                                                       *
  1187*  INCURRED DATE                                                 *
  1188*  REPORTED DATE                                                 *
  1189*  ISSUE AGE                                                     *
  1190*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  24
* EL156.cbl
  1191*  CDT PERCENT                                                   *
  1192*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1193* *CLAIM TYPE (LIFE, A/H)                                        *
  1194* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1195* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1196*                                                                *
  1197*  RETURNED FROM ELRESV                                          *
  1198*  --------------------                                          *
  1199*  CDT TABLE USED                                                *
  1200*  CDT FACTOR USED                                               *
  1201*  PAY TO CURRENT RESERVE                                        *
  1202*  I.B.N.R. - A/H ONLY                                           *
  1203*  FUTURE (ACCRUED) AH ONLY                                      *
  1204*----------------------------------------------------------------*
  1205*  PASSED TO ELRATE                                              *
  1206*  ----------------                                              *
  1207*  CERT ISSUE DATE                                               *
  1208*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1209*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1210*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1211*  STATE CODE (CLIENT DEFINED)                                   *
  1212*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1213*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1214*  DEVIATION CODE                                                *
  1215*  ISSUE AGE                                                     *
  1216*  ORIGINAL BENEFIT AMOUNT                                       *
  1217*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1218*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1219*  BENEFIT KIND (LIFE OR A/H)                                    *
  1220*  A.P.R.                                                        *
  1221*  METHOD
  1222*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1223*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1224*  COMPANY I.D. (3 CHARACTER)                                    *
  1225*  BENEFIT CODE                                                  *
  1226*  BENEFIT OVERRIDE CODE                                         *
  1227*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1228*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1229*  JOINT INDICATOR (CSL ONLY)                                    *
  1230*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1231*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1232*                                                                *
  1233*  RETURNED FROM ELRATE                                          *
  1234*  --------------------                                          *
  1235*  CALCULATED PREMIUM                                            *
  1236*  PREMIUM RATE                                                  *
  1237*  MORTALITY CODE                                                *
  1238*  MAX ATTAINED AGE                                              *
  1239*  MAX AGE                                                       *
  1240*  MAX TERM                                                      *
  1241*  MAX MONTHLY BENEFIT                                           *
  1242*  MAX TOTAL BENIFIT                                             *
  1243*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1244*----------------------------------------------------------------*
  1245*  PASSED TO ELRFND                                              *
  1246*  ----------------                                              *
  1247*  CERT ISSUE DATE                                               *
  1248*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  25
* EL156.cbl
  1249*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1250*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1251*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1252*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1253*  STATE CODE (CLIENT DEFINED)                                   *
  1254*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1255*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1256*  DEVIATION CODE                                                *
  1257*  ISSUE AGE                                                     *
  1258*  ORIGINAL BENEFIT AMOUNT                                       *
  1259*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1260*  PROCESS TYPE (CANCEL)                                         *
  1261*  BENEFIT KIND (LIFE OR A/H)                                    *
  1262*  A.P.R.                                                        *
  1263*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1264*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1265*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1266*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1267*  COMPANY I.D. (3 CHARACTER)                                    *
  1268*  BENEFIT CODE                                                  *
  1269*  BENEFIT OVERRIDE CODE                                         *
  1270*                                                                *
  1271*  RETURNED FROM ELRFND                                          *
  1272*  --------------------                                          *
  1273*  CALCULATED REFUND                                             *
  1274*----------------------------------------------------------------*
  1275*  PASSED TO ELEARN                                              *
  1276*  ----------------                                              *
  1277*  CERT ISSUE DATE                                               *
  1278*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1279*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1280*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1281*  STATE CODE (CLIENT DEFINED)                                   *
  1282*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1283*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1284*  DEVIATION CODE                                                *
  1285*  ISSUE AGE                                                     *
  1286*  ORIGINAL BENEFIT AMOUNT                                       *
  1287*  BENEFIT KIND (LIFE OR A/H)                                    *
  1288*  A.P.R.                                                        *
  1289*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1290*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1291*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1292*  COMPANY I.D. (3 CHARACTER)                                    *
  1293*  BENEFIT CODE                                                  *
  1294*  BENEFIT OVERRIDE CODE                                         *
  1295*                                                                *
  1296*  RETURNED FROM ELEARN                                          *
  1297*  --------------------                                          *
  1298*  INDICATED  EARNINGS                                           *
  1299*----------------------------------------------------------------*
  1300*                 LENGTH = 450                                   *
  1301*                                                                *
  1302******************************************************************
  1303******************************************************************
  1304*                   C H A N G E   L O G
  1305*
  1306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  26
* EL156.cbl
  1307*-----------------------------------------------------------------
  1308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1309* EFFECTIVE    NUMBER
  1310*-----------------------------------------------------------------
  1311* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1312* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1313* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1314* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1315* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1316* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1317* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1318* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1319* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1320******************************************************************
  1321
  1322 01  CALCULATION-PASS-AREA.
  1323     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1324                                     COMP.
  1325
  1326     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1327       88  NO-CP-ERROR                             VALUE ZERO.
  1328       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1329                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1330       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1331       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1332       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1333       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1334       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1335       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1336       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1337       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1338       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1339       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1340       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1341       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1342       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1343       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1344       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1345       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1346       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1347
  1348     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1349       88  NO-CP-ERROR-2                           VALUE ZERO.
  1350***********************  INPUT AREAS ****************************
  1351
  1352     12  CP-CALCULATION-AREA.
  1353         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1354         16  CP-CERT-EFF-DT        PIC XX.
  1355         16  CP-VALUATION-DT       PIC XX.
  1356         16  CP-PAID-THRU-DT       PIC XX.
  1357         16  CP-BENEFIT-TYPE       PIC X.
  1358           88  CP-AH                               VALUE 'A' 'D'
  1359                                                   'I' 'U'.
  1360           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1361           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1362         16  CP-INCURRED-DT        PIC XX.
  1363         16  CP-REPORTED-DT        PIC XX.
  1364         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  27
* EL156.cbl
  1365         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1366         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1367                                     COMP-3.
  1368         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1369                                     COMP-3.
  1370         16  CP-CDT-METHOD         PIC X.
  1371           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1372           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1373           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1374         16  CP-CLAIM-TYPE         PIC X.
  1375           88  CP-AH-CLAIM                         VALUE 'A'.
  1376           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1377         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1380                                     COMP-3.
  1381         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1382                                     COMP-3.
  1383         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1384                                     COMP-3.
  1385         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1386                                     COMP-3.
  1387         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1388                                     COMP-3.
  1389         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1390                                     COMP-3.
  1391         16  CP-REM-TERM-METHOD    PIC X.
  1392           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1393           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1394           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1395           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1396           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1397           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1398           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1399         16  CP-EARNING-METHOD     PIC X.
  1400           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1401           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1402           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1403           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1404           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1405           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1406           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1407           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1408           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1409           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1410           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1411           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1412           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1413           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1414         16  CP-PROCESS-TYPE       PIC X.
  1415           88  CP-CLAIM                            VALUE '1'.
  1416           88  CP-CANCEL                           VALUE '2'.
  1417           88  CP-ISSUE                            VALUE '3'.
  1418         16  CP-SPECIAL-CALC-CD    PIC X.
  1419           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1420           88  CP-1-MTH-INTEREST               VALUE ' '.
  1421           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1422           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  28
* EL156.cbl
  1423           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1424           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1425           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1426           88  CP-FARM-PLAN                    VALUE 'F'.
  1427           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1428           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1429           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1430           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1431           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1432           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1433           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1434           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1435           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1436           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1437                                                     'W' 'X'.
  1438           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1439           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1440           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1441           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1442           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1443           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1444           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1445           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1446           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1447           88  CP-CSL-METH-1                   VALUE '5'.
  1448           88  CP-CSL-METH-2                   VALUE '6'.
  1449           88  CP-CSL-METH-3                   VALUE '7'.
  1450           88  CP-CSL-METH-4                   VALUE '8'.
  1451
  1452         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1453                                     COMP-3.
  1454         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1455         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1456         16  CP-STATE              PIC XX          VALUE SPACE.
  1457         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1458         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1459           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1460               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1461         16  CP-R78-OPTION         PIC X.
  1462           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1463           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1464
  1465         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1466         16  CP-IBNR-RESERVE-SW    PIC X.
  1467         16  CP-CLAIM-STATUS       PIC X.
  1468         16  CP-RATE-FILE          PIC X.
  1469         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1470                                     COMP-3.
  1471
  1472         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1473         16  CP-AH-OVERRIDE-CODE   PIC X.
  1474
  1475         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1476                                     COMP-3.
  1477         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1478                                   PIC S9(5)V99 COMP-3.
  1479         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1480                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  29
* EL156.cbl
  1481         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1482                                     COMP-3.
  1483         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1484                                     COMP-3.
  1485         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1486                                  PIC S9(7)V99 COMP-3.
  1487
  1488         16  CP-PAID-FROM-DATE     PIC X(02).
  1489         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1490         16  CP-EXT-DAYS-CALC      PIC X.
  1491           88  CP-EXT-NO-CHG                   VALUE ' '.
  1492           88  CP-EXT-CHG-LF                   VALUE '1'.
  1493           88  CP-EXT-CHG-AH                   VALUE '2'.
  1494           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1495         16  CP-DOMICILE-STATE     PIC XX.
  1496         16  CP-CARRIER            PIC X.
  1497         16  CP-REIN-FLAG          PIC X.
  1498         16  CP-REM-TRM-CALC-OPTION PIC X.
  1499           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1500                      '2' '3' '4' '5'.
  1501           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1502           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1503           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1504           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1505           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1506           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1507           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1508           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1509         16  CP-SIG-SWITCH         PIC X.
  1510         16  CP-RATING-METHOD      PIC X.
  1511           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1512           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1513           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1514           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1515           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1516           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1517           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1518           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1519           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1520         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1521                                     COMP-3.
  1522         16  CP-BEN-CATEGORY       PIC X.
  1523         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1524         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1525                                   PIC S99V9(5) COMP-3.
  1526         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1527         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1528                                   PIC S99V9(5) COMP-3.
  1529         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1530         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1531         16  CP-EXPIRE-DT          PIC XX.
  1532         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1533         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1534         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1535         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1536         16  CP-DDF-SPEC-CALC      PIC X.
  1537             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1538             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  30
* EL156.cbl
  1539         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1540         16  CP-CANCEL-REASON      PIC X.
  1541         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1542         16  CP-PMT-MODE           PIC X.
  1543         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1544         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1545         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1546         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1547         16  FILLER                PIC X.
  1548
  1549***************    OUTPUT FROM ELRESV   ************************
  1550
  1551         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1552
  1553         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1554                                     COMP-3.
  1555         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1556                                     COMP-3.
  1557         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1558                                     COMP-3.
  1559         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1560                                     COMP-3.
  1561         16  FILLER                PIC X(09).
  1562***************    OUTPUT FROM ELRTRM   *************************
  1563
  1564         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1565                                     COMP-3.
  1566         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1567                                     COMP-3.
  1568         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1569                                     COMP-3.
  1570         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1571                                     COMP-3.
  1572         16  FILLER                PIC X(12).
  1573
  1574***************    OUTPUT FROM ELRAMT   *************************
  1575
  1576         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1579                                     COMP-3.
  1580         16  FILLER                PIC X(12).
  1581
  1582***************    OUTPUT FROM ELRATE   *************************
  1583
  1584         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1585                                     COMP-3.
  1586         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1587                                     COMP-3.
  1588         16  CP-MORTALITY-CODE     PIC X(4).
  1589         16  CP-RATE-EDIT-FLAG     PIC X.
  1590             88  CP-RATES-NEED-APR                  VALUE '1'.
  1591         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1594         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1595         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1596                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  31
* EL156.cbl
  1597         16  FILLER                PIC X(07).
  1598
  1599***************    OUTPUT FROM ELRFND   *************************
  1600
  1601         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-REFUND-TYPE-USED   PIC X.
  1604           88  CP-R-AS-R78                         VALUE '1'.
  1605           88  CP-R-AS-PRORATA                     VALUE '2'.
  1606           88  CP-R-AS-CALIF                       VALUE '3'.
  1607           88  CP-R-AS-TEXAS                       VALUE '4'.
  1608           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1609           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1610           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1611           88  CP-R-AS-MEAN                        VALUE '8'.
  1612           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1613           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1614           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1615           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1616           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1617           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1618         16  FILLER                PIC X(12).
  1619
  1620***************    OUTPUT FROM ELEARN   *************************
  1621
  1622         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1625                                     COMP-3.
  1626         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1631                                     COMP-3.
  1632         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-EARNING-TYPE-USED  PIC X.
  1635           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1636           88  CP-E-AS-R78                         VALUE '1'.
  1637           88  CP-E-AS-PRORATA                     VALUE '2'.
  1638           88  CP-E-AS-TEXAS                       VALUE '4'.
  1639           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1640           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1641           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1642           88  CP-E-AS-MEAN                        VALUE '8'.
  1643           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1644         16  FILLER                PIC X(12).
  1645
  1646***************    OUTPUT FROM ELPMNT   *************************
  1647
  1648         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1649                                     COMP-3.
  1650         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1651                                     COMP-3.
  1652         16  FILLER                PIC X(12).
  1653
  1654***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  32
* EL156.cbl
  1655         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1658                                     COMP-3.
  1659         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1660                                     COMP-3.
  1661         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1662                                     COMP-3.
  1663         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1664                                     COMP-3.
  1665         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1666                                     COMP-3.
  1667         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1668             88  OPEN-RATE-FILE                   VALUE 'O'.
  1669             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1670             88  IO-ERROR                         VALUE 'E'.
  1671
  1672         16  CP-FIRST-PAY-DATE     PIC XX.
  1673
  1674         16  CP-JOINT-INDICATOR    PIC X.
  1675
  1676         16  CP-RESERVE-REMAINING-TERM
  1677                                   PIC S9(4)V9    VALUE ZERO
  1678                                     COMP-3.
  1679
  1680         16  CP-INSURED-BIRTH-DT   PIC XX.
  1681
  1682         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1683                                     COMP-3.
  1684
  1685         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1686                                     COMP-3.
  1687
  1688         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1698                                     COMP-3.
  1699
  1700         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1704             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1705
  1706         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1707                                     COMP-3.
  1708         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1709                                     COMP-3.
  1710         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1711         16  FILLER                PIC X(15).
  1712******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  33
* EL156.cbl
  1713*    COPY ELCICALC.
  1714******************************************************************
  1715*                                                                *
  1716*                           ELCCICALC.                           *
  1717*                            VMOD=2.001                          *
  1718*                                                                *
  1719*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1720*                 CALCULATION MODULE                             *
  1721*                                                                *
  1722*  PASSED TO ELCLMI                                              *
  1723*  -----------------                                             *
  1724*  STATE                                                         *
  1725*  PRODUCT                                                       *
  1726*  COVERAGE                                                      *
  1727*  EFFECTIVE DATE                                                *
  1728*  INCURRED DATE                                                 *
  1729*  ESTABLISHED DATE                                              *
  1730*  LAST PAID DATE                                                *
  1731*  REPORTED DATE                                                 *
  1732*  CLAIM PAYMENT AMOUNT                                          *
  1733*                                                                *
  1734*  RETURNED FROM ELRTRM                                          *
  1735*  ---------------------                                         *
  1736*  RETURN CODE                                                   *
  1737*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1738*  CLAIM INTEREST AMOUNT                                         *
  1739*----------------------------------------------------------------*
  1740*----------------------------------------------------------------*
  1741*                 LENGTH = 100                                   *
  1742*                                                                *
  1743******************************************************************
  1744******************************************************************
  1745*                   C H A N G E   L O G
  1746*
  1747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1748*-----------------------------------------------------------------
  1749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1750* EFFECTIVE    NUMBER
  1751*-----------------------------------------------------------------
  1752* 120905    2004040700004  PEMA  NEW COPYBOOK
  1753* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1754******************************************************************
  1755
  1756 01  CLAIM-INT-PASS-AREA.
  1757     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1758                                     COMP.
  1759
  1760     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1761       88  NO-CI-ERROR                             VALUE ZERO.
  1762       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1763       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1764       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1765       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1766       88  CP-AMT-LT-5000                          VALUE '4'.
  1767       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1768       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1769       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1770       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  34
* EL156.cbl
  1771***********************  INPUT AREAS ****************************
  1772
  1773     12  CP-CALCULATION-AREA.
  1774         16  CP-COMPANY-CD         PIC X.
  1775         16  CP-STATE              PIC XX.
  1776         16  CP-PRODUCT            PIC XX.
  1777         16  CP-COVERAGE           PIC XX.
  1778         16  CP-INC-DT             PIC XX.
  1779         16  CP-EST-DT             PIC XX.
  1780         16  CP-LSTPD-DT           PIC XX.
  1781         16  CP-RPT-DT             PIC XX.
  1782         16  CP-PRF-DT             PIC XX.
  1783         16  CP-EFF-DT             PIC XX.
  1784         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1785         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1786         16  FILLER                PIC X(37).
  1787
  1788***************    OUTPUT FROM ELCLMI   ************************
  1789
  1790         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1791
  1792         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1793         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1794         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1795         16  FILLER                PIC X(19).
  1796******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  35
* EL156.cbl
  1798*    COPY ELCATTR.
  1799******************************************************************
  1800*                                                                *
  1801*                            ELCATTR.                            *
  1802*                            VMOD=2.001                          *
  1803*                                                                *
  1804*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1805*                                                                *
  1806*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1807*                                                                *
  1808*                   POS 1   P=PROTECTED                          *
  1809*                           U=UNPROTECTED                        *
  1810*                           S=ASKIP                              *
  1811*                   POS 2   A=ALPHA/NUMERIC                      *
  1812*                           N=NUMERIC                            *
  1813*                   POS 3   N=NORMAL                             *
  1814*                           B=BRIGHT                             *
  1815*                           D=DARK                               *
  1816*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1817*                           OF=MODIFIED DATA TAG OFF             *
  1818*                                                                *
  1819*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1820******************************************************************
  1821 01  ATTRIBUTE-LIST.
  1822     12  AL-PABOF            PIC X       VALUE 'Y'.
  1823     12  AL-PABON            PIC X       VALUE 'Z'.
  1824     12  AL-PADOF            PIC X       VALUE '%'.
  1825     12  AL-PADON            PIC X       VALUE '_'.
  1826     12  AL-PANOF            PIC X       VALUE '-'.
  1827     12  AL-PANON            PIC X       VALUE '/'.
  1828     12  AL-SABOF            PIC X       VALUE '8'.
  1829     12  AL-SABON            PIC X       VALUE '9'.
  1830     12  AL-SADOF            PIC X       VALUE '@'.
  1831     12  AL-SADON            PIC X       VALUE QUOTE.
  1832     12  AL-SANOF            PIC X       VALUE '0'.
  1833     12  AL-SANON            PIC X       VALUE '1'.
  1834     12  AL-UABOF            PIC X       VALUE 'H'.
  1835     12  AL-UABON            PIC X       VALUE 'I'.
  1836     12  AL-UADOF            PIC X       VALUE '<'.
  1837     12  AL-UADON            PIC X       VALUE '('.
  1838     12  AL-UANOF            PIC X       VALUE ' '.
  1839     12  AL-UANON            PIC X       VALUE 'A'.
  1840     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1841     12  AL-UNBON            PIC X       VALUE 'R'.
  1842     12  AL-UNDOF            PIC X       VALUE '*'.
  1843     12  AL-UNDON            PIC X       VALUE ')'.
  1844     12  AL-UNNOF            PIC X       VALUE '&'.
  1845     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  36
* EL156.cbl
  1847*    COPY ELCEMIB.
  1848******************************************************************
  1849*                                                                *
  1850*                                                                *
  1851*                            ELCEMIB.                            *
  1852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1853*                            VMOD=2.005                          *
  1854*                                                                *
  1855*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1856*                                                                *
  1857******************************************************************
  1858 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1859     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1860     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1861     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1862     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1863     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1864     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1865     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1866     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1867     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1868         88  EMI-NO-ERRORS                    VALUE '1'.
  1869         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1870         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1871     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1872         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1873     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1874         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1875         88  EMI-AREA1-FULL                   VALUE '2'.
  1876     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1877         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1878         88  EMI-AREA2-FULL                   VALUE '2'.
  1879     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1880         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1881         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1882         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1883         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1884         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1885     12  EMI-ERROR-LINES.
  1886         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1887         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1888         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1889         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1890             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1891                 24  EMI-ERR-NUM         PIC X(4).
  1892                 24  EMI-FILLER          PIC X.
  1893                 24  EMI-SEV             PIC X.
  1894                 24  FILLER              PIC X.
  1895             20  FILLER                  PIC X(02).
  1896     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1897         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1898             20  EMI-ERROR-NUMBER    PIC X(4).
  1899             20  EMI-FILL            PIC X.
  1900             20  EMI-SEVERITY        PIC X.
  1901             20  FILLER              PIC X.
  1902             20  EMI-ERROR-TEXT.
  1903                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1904                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  37
* EL156.cbl
  1905     12  EMI-SEVERITY-SAVE           PIC X.
  1906         88  EMI-NOTE                    VALUE 'N'.
  1907         88  EMI-WARNING                 VALUE 'W'.
  1908         88  EMI-FORCABLE                VALUE 'F'.
  1909         88  EMI-FATAL                   VALUE 'X'.
  1910     12  EMI-MESSAGE-FLAG            PIC X.
  1911         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1912         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1913     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1914     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1915         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1916         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1917         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1918     12  emi-claim-no                pic x(7).
  1919     12  emi-claim-type              pic x(6).
  1920     12  FILLER                      PIC X(124)  VALUE SPACES.
  1921     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1922     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1923     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1924     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  38
* EL156.cbl
  1926*    COPY ELCLNKLT.
  1927******************************************************************
  1928*                                                                *
  1929*                                                                *
  1930*                           ELCLNKLT                             *
  1931*                            VMOD=2.003                          *
  1932*                                                                *
  1933*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1934*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1935*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1936*                                                                *
  1937*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1938*   COMPLETING THE REQUIRED FIELDS.                              *
  1939*                                                                *
  1940*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1941*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1942*                              9999 INDICATES AN UNKNOWN ABEND   *
  1943*                                   WAS DETECTED.                *
  1944*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1945*                              CODES FOUND IN THE ERROR FILE.    *
  1946******************************************************************
  1947 01  W-1523-LINKDATA.
  1948     12  W-1523-COMMON-PI-DATA.
  1949         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1950         16  FILLER              PIC  X(67).
  1951         16  W-1523-COMPANY-CD   PIC  X(01).
  1952         16  FILLER              PIC  X(10).
  1953         16  W-1523-CONTROL-IN-PROGRESS.
  1954             20  W-1523-CARRIER  PIC  X(01).
  1955             20  W-1523-GROUPING PIC  X(06).
  1956             20  W-1523-STATE    PIC  X(02).
  1957             20  W-1523-ACCOUNT  PIC  X(10).
  1958             20  W-1523-CLAIM-CERT-GRP.
  1959                 24  W-1523-CLAIM-NO
  1960                                 PIC  X(07).
  1961                 24  W-1523-CERT-NO.
  1962                     28  W-1523-CERT-PRIME
  1963                                 PIC  X(10).
  1964                     28  W-1523-CERT-SFX
  1965                                 PIC  X(01).
  1966                 24  W-1523-CERT-EFF-DT
  1967                                 PIC  X(02).
  1968         16  FILLER              PIC X(265).
  1969
  1970     12  W-1523-WORK-AREA.
  1971         16  W-1523-FORM-NUMBER  PIC  X(04).
  1972         16  W-1523-NUMBER-COPIES
  1973                                 PIC  9(01).
  1974         16  W-1523-ADDR-TYPE    PIC  X(02).
  1975         16  W-1523-FOLLOW-UP-DATE
  1976                                 PIC  X(02).
  1977         16  W-1523-RESEND-DATE  PIC  X(02).
  1978         16  W-1523-ERROR-CODE   PIC  9(04).
  1979             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1980             88  W-1523-FATAL-ERROR
  1981                                    VALUES  0006 0013 0042
  1982                                            0154 0168 0169
  1983                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  39
* EL156.cbl
  1984                                            0179 0186 0281
  1985                                            0332 2055 3697
  1986                                            3698 3699 3770
  1987                                            3771 3772 7675
  1988                                            9106 9808 9883
  1989                                            9887.
  1990             88  W-1523-STOP-ERRORS
  1991                                    VALUES  0013 0042 0154
  1992                                            0168 0169 0172
  1993                                            0281 0332 2055
  1994                                            3698 3699 7675
  1995                                            9106 9808 9883
  1996                                            9999.
  1997         16  W-1523-REASON       PIC  X(70).
  1998         16  W-1523-ARCHIVE-NUMBER
  1999                                 PIC  9(08).
  2000     12  W-1523-POINTER-AREA.
  2001         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2002         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2003         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2004         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2005         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  40
* EL156.cbl
  2007*    COPY ELCNWA.
  2008*****************************************************************
  2009*                                                               *
  2010*                                                               *
  2011*                            ELCNWA.                            *
  2012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2013*                            VMOD=2.003                         *
  2014*                                                               *
  2015*            M O V E   N A M E   W O R K   A R E A.             *
  2016*                                                               *
  2017*****************************************************************.
  2018
  2019 01  WS-NAME-WORK-AREA.
  2020     05  WS-INSURED-LAST-NAME        PIC X(15).
  2021     05  WS-INSURED-1ST-NAME         PIC X(12).
  2022     05  WS-INSURED-MID-INIT         PIC X.
  2023
  2024     05  WS-NAME-WORK.
  2025         10  WS-NW                   PIC X
  2026             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2027
  2028     05  WS-NAME-WORK2.
  2029         10  WS-NW2                  PIC X
  2030             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2031                                        NWA-INDEX0.
  2032
  2033     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2034                                     COMP-3.
  2035
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  41
* EL156.cbl
  2037*    COPY ELCDMO.
  2038******************************************************************
  2039*                                                                *
  2040*                                                                *
  2041*                            ELCDMO.                             *
  2042*                            VMOD=2.004                          *
  2043*                                                                *
  2044*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2045*        COMMUNICATION AREA                                      *
  2046*   FILE TYPE = NA                                               *
  2047*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2048*                                                                *
  2049******************************************************************
  2050 01  DMO-COMMUNICATION-AREA.
  2051     12  DM-RECORD-TYPE                  PIC  X(02).
  2052             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2053             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2054             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2055     12  DM-DIST-CODE                    PIC  X(04).
  2056     12  DM-MAIL-CODE                    PIC  X(05).
  2057     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2058     12  DM-INSURED-NAME                 PIC  X(30).
  2059     12  DM-CLAIM-NO                     PIC  X(07).
  2060     12  DM-CLAIM-TYPE                   PIC  X.
  2061
  2062     12  DM-STATUS-DATA-AREA.
  2063         16  DM-CLAIM-STATUS             PIC  X.
  2064             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2065             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2066             88  DM-CLOSED                        VALUE '3'.
  2067             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2068             88  DM-DEFAULT                       VALUE '9'.
  2069         16  DM-STATUS-DATE              PIC  X(08).
  2070******YYYYMMDD
  2071         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2072             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2073             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2074             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2075             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2076             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2077             88  DM-RE-OPENED                     VALUE 'R'.
  2078             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2079             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2080             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2081         16  DM-STAT-CARRIER             PIC X.
  2082
  2083     12  DM-DRAFT-DATA-AREA.
  2084         16  DM-PAYMENT-TYPE             PIC  X.
  2085             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2086         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2087         16  DM-PAYMENT-DATE             PIC  X(08).
  2088******YYYYMMDD
  2089         16  DM-CERT-NO                  PIC  X(11).
  2090         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2091         16  DM-CARRIER                  PIC  X.
  2092
  2093     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  42
* EL156.cbl
  2095*    COPY ELCDMDCD.
  2096******************************************************************
  2097*                                                                *
  2098*                                                                *
  2099*                            ELCDMDCD.                           *
  2100*                            VMOD=2.001                          *
  2101*                                                                *
  2102*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2103*       COMMUNICATIONS AREA                                      *
  2104*                                                                *
  2105******************************************************************
  2106 01  CD-COMMUNICATION-AREA.
  2107     12  CD-SYSTEM-ID            PIC  X(02).
  2108         88 CD-CLAIMS                      VALUE 'CL'.
  2109         88 CD-CREDIT                      VALUE 'CR'.
  2110     12  CD-RECORD-TYPE          PIC  X(02).
  2111         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2112         88 CD-EOB-CODE                    VALUE 'EO'.
  2113         88 CD-ICD9-CODE                   VALUE 'I9'.
  2114         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2115         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2116         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2117         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2118         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2119     12  CD-RECORD-KEY           PIC  X(06).
  2120         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2121     12  CD-RETURN-CODE          PIC  X(02).
  2122     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2123     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2124     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2125     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  43
* EL156.cbl
  2127*    COPY ELCDCTB.
  2128******************************************************************
  2129*                                                                *
  2130*                                                                *
  2131*                            ELCDCTB.                            *
  2132*                            VMOD=2.002                          *
  2133*                                                                *
  2134*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2135*       COMMUNICATIONS AREA                                      *
  2136*                                                                *
  2137******************************************************************
  2138 01  DCT-COMMUNICATION-AREA.
  2139     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2140     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2141     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2142     12  DCT-PRODUCT-CODE         PIC  X(02).
  2143     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2144     12  DCT-RETURN-CODE          PIC  X(02).
  2145     12  DCT-MAIL-CODE            PIC  X(05).
  2146     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2147     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  44
* EL156.cbl
  2149 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2150 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2151 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2152 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  45
* EL156.cbl
  2154*    COPY ELCINTF.
  2155******************************************************************
  2156*                                                                *
  2157*                                                                *
  2158*                            ELCINTF.                            *
  2159*                            VMOD=2.017                          *
  2160*                                                                *
  2161*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2162*                                                                *
  2163*       LENGTH = 1024                                            *
  2164*                                                                *
  2165******************************************************************
  2166*                   C H A N G E   L O G
  2167*
  2168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2169*-----------------------------------------------------------------
  2170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2171* EFFECTIVE    NUMBER
  2172*-----------------------------------------------------------------
  2173* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2174******************************************************************
  2175 01  PROGRAM-INTERFACE-BLOCK.
  2176     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2177     12  PI-CALLING-PROGRAM              PIC X(8).
  2178     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2181     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2182     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2183     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2184     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2185     12  PI-COMPANY-ID                   PIC XXX.
  2186     12  PI-COMPANY-CD                   PIC X.
  2187
  2188     12  PI-COMPANY-PASSWORD             PIC X(8).
  2189
  2190     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2191
  2192     12  PI-CONTROL-IN-PROGRESS.
  2193         16  PI-CARRIER                  PIC X.
  2194         16  PI-GROUPING                 PIC X(6).
  2195         16  PI-STATE                    PIC XX.
  2196         16  PI-ACCOUNT                  PIC X(10).
  2197         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2198                                         PIC X(10).
  2199         16  PI-CLAIM-CERT-GRP.
  2200             20  PI-CLAIM-NO             PIC X(7).
  2201             20  PI-CERT-NO.
  2202                 25  PI-CERT-PRIME       PIC X(10).
  2203                 25  PI-CERT-SFX         PIC X.
  2204             20  PI-CERT-EFF-DT          PIC XX.
  2205         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2206             20  PI-PLAN-CODE            PIC X(2).
  2207             20  PI-REVISION-NUMBER      PIC X(3).
  2208             20  PI-PLAN-EFF-DT          PIC X(2).
  2209             20  PI-PLAN-EXP-DT          PIC X(2).
  2210             20  FILLER                  PIC X(11).
  2211         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  46
* EL156.cbl
  2212             20  PI-OE-REFERENCE-1.
  2213                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2214                 25  PI-OE-REF-1-SUFF    PIC XX.
  2215
  2216     12  PI-SESSION-IN-PROGRESS          PIC X.
  2217         88  CLAIM-SESSION                   VALUE '1'.
  2218         88  CREDIT-SESSION                  VALUE '2'.
  2219         88  WARRANTY-SESSION                VALUE '3'.
  2220         88  MORTGAGE-SESSION                VALUE '4'.
  2221         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2222
  2223
  2224*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2225
  2226     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2227     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2228
  2229     12  PI-CREDIT-USER                  PIC X.
  2230         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2231         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2232
  2233     12  PI-CLAIM-USER                   PIC X.
  2234         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2235         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2236
  2237     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2238         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2239         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2240         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2241         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2242         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2243
  2244     12  PI-PROCESSOR-ID                 PIC X(4).
  2245
  2246     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2247
  2248     12  PI-MEMBER-CAPTION               PIC X(10).
  2249
  2250     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2251         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2252
  2253     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2254     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2255     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2256     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2257
  2258     12  PI-AH-OVERRIDE-L1               PIC X.
  2259     12  PI-AH-OVERRIDE-L2               PIC XX.
  2260     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2261     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2262
  2263     12  PI-NEW-SYSTEM                   PIC X(2).
  2264
  2265     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2266     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2267         88  PI-USES-PAID-TO                 VALUE '1'.
  2268     12  PI-CRDTCRD-SYSTEM.
  2269         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  47
* EL156.cbl
  2270             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2271             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2272         16  PI-CC-MONTH-END-DT          PIC XX.
  2273     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2274
  2275     12  PI-OE-REFERENCE-2.
  2276         16  PI-OE-REF-2-PRIME           PIC X(10).
  2277         16  PI-OE-REF-2-SUFF            PIC X.
  2278
  2279     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2280
  2281     12  PI-LANGUAGE-TYPE                PIC X.
  2282             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2283             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2284             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2285
  2286     12  PI-POLICY-LINKAGE-IND           PIC X.
  2287         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2288         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2289                                                   LOW-VALUES.
  2290
  2291     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2292     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2293         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2294         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2295
  2296     12  PI-PROCESSOR-CSR-IND            PIC X.
  2297         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2298         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2299
  2300     12  FILLER                          PIC X(3).
  2301
  2302     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2303
  2304     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2305         PI-SYSTEM-LEVEL.
  2306
  2307         16  PI-ENTRY-CODES.
  2308             20  PI-ENTRY-CD-1           PIC X.
  2309             20  PI-ENTRY-CD-2           PIC X.
  2310
  2311         16  PI-RETURN-CODES.
  2312             20  PI-RETURN-CD-1          PIC X.
  2313             20  PI-RETURN-CD-2          PIC X.
  2314
  2315         16  PI-UPDATE-STATUS-SAVE.
  2316             20  PI-UPDATE-BY            PIC X(4).
  2317             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2318
  2319         16  PI-LOWER-CASE-LETTERS       PIC X.
  2320             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2321
  2322*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2323*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2324*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2325
  2326         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2327             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  48
* EL156.cbl
  2328             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2329             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2330             88  ACCNT-CNTL                  VALUE '3'.
  2331             88  CARR-ACCNT-CNTL             VALUE '4'.
  2332
  2333         16  PI-PROCESSOR-CAP-LIST.
  2334             20  PI-SYSTEM-CONTROLS.
  2335                24 PI-SYSTEM-DISPLAY     PIC X.
  2336                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2337                24 PI-SYSTEM-MODIFY      PIC X.
  2338                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2339             20  FILLER                  PIC XX.
  2340             20  PI-DISPLAY-CAP          PIC X.
  2341                 88  DISPLAY-CAP             VALUE 'Y'.
  2342             20  PI-MODIFY-CAP           PIC X.
  2343                 88  MODIFY-CAP              VALUE 'Y'.
  2344             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2345                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2346             20  PI-FORCE-CAP            PIC X.
  2347                 88  FORCE-CAP               VALUE 'Y'.
  2348
  2349         16  PI-PROGRAM-CONTROLS.
  2350             20  PI-PGM-PRINT-OPT        PIC X.
  2351             20  PI-PGM-FORMAT-OPT       PIC X.
  2352             20  PI-PGM-PROCESS-OPT      PIC X.
  2353             20  PI-PGM-TOTALS-OPT       PIC X.
  2354
  2355         16  PI-HELP-INTERFACE.
  2356             20  PI-LAST-ERROR-NO        PIC X(4).
  2357             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2358
  2359         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2360             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2361
  2362         16  PI-CR-CONTROL-IN-PROGRESS.
  2363             20  PI-CR-CARRIER           PIC X.
  2364             20  PI-CR-GROUPING          PIC X(6).
  2365             20  PI-CR-STATE             PIC XX.
  2366             20  PI-CR-ACCOUNT           PIC X(10).
  2367             20  PI-CR-FIN-RESP          PIC X(10).
  2368             20  PI-CR-TYPE              PIC X.
  2369
  2370         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2371
  2372         16  PI-CR-MONTH-END-DT          PIC XX.
  2373
  2374         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2375             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2376             88  PI-ZERO-CARRIER             VALUE '1'.
  2377             88  PI-ZERO-GROUPING            VALUE '2'.
  2378             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2379
  2380         16  PI-CARRIER-SECURITY         PIC X.
  2381             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2382
  2383         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2384             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2385             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  49
* EL156.cbl
  2386
  2387         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2388             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2389                                         INDEXED BY PI-ACCESS-NDX
  2390                                         PIC X.
  2391
  2392         16  PI-GA-BILLING-CONTROL       PIC X.
  2393             88  PI-GA-BILLING               VALUE '1'.
  2394
  2395         16  PI-MAIL-PROCESSING          PIC X.
  2396             88  PI-MAIL-YES                 VALUE 'Y'.
  2397
  2398         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2399
  2400         16  PI-AR-SYSTEM.
  2401             20  PI-AR-PROCESSING-CNTL   PIC X.
  2402                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2403             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2404             20  PI-AR-MONTH-END-DT      PIC XX.
  2405
  2406         16  PI-MP-SYSTEM.
  2407             20  PI-MORTGAGE-USER            PIC X.
  2408                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2409                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2410             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2411                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2412                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2413                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2414                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2415                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2416             20  PI-MP-MONTH-END-DT          PIC XX.
  2417             20  PI-MP-REFERENCE-NO.
  2418                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2419                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2420
  2421         16  PI-LABEL-CONTROL            PIC X(01).
  2422             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2423             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2424
  2425         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2426             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2427
  2428         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2429             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2430             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2431
  2432         16  FILLER                      PIC X(14).
  2433
  2434     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2435******************************************************************
  2436     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2437         16  PI-SAVE-FORM        PIC X(12).
  2438         16  PI-ACCT-KEY         PIC X(26).
  2439         16  PI-PAYEE-NAME       PIC X(30).
  2440         16  PI-DAILY-RATE       PIC S9(3)V99.
  2441         16  PI-MONTH-END-SAVE   PIC XX.
  2442         16  PI-BENEFIT-SAVE.
  2443             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  50
* EL156.cbl
  2444             20  PI-BEN-TYPE     PIC X.
  2445         16  PI-MANUAL-SW        PIC 9.
  2446         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2447         16  PI-PASS-SW          PIC X.
  2448         16  PI-PFKEY-USED       PIC X.
  2449         16  PI-CK-ASSIGN        PIC X.
  2450         16  PI-FATAL-COUNT      PIC 99.
  2451         16  PI-FORCE-COUNT      PIC 99.
  2452         16  PI-SAVE-INPUT.
  2453             20  PI-PMTTYPE      PIC X.
  2454             20  PI-PAYEE.
  2455                 24  PI-PAYEE-TYPE PIC X.
  2456                 24  PI-PAYEE-SEQ  PIC X.
  2457                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2458                   PI-PAYEE-SEQ    PIC S9.
  2459             20  PI-PMTNOTE1     PIC X(60).
  2460             20  PI-PMTNOTE2     PIC X(60).
  2461             20  PI-OFFLINE      PIC X.
  2462             20  PI-ECHECKNO     PIC X(7).
  2463             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2464                 28  PI-ECHECKNO-N     PIC X.
  2465                 28  PI-ECHECKNO-6     PIC X(6).
  2466             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2467                 24  PI-ECHECKNO-CR    PIC XX.
  2468                 24  PI-ECHECKNO-5     PIC X(5).
  2469             20  PI-HOLDTIL      PIC 9(6).
  2470             20  PI-EPYFROM      PIC 9(6).
  2471             20  PI-EPYTHRU      PIC 9(6).
  2472             20  PI-EDAYS        PIC S9(5).
  2473             20  PI-EPYAMT       PIC S9(7)V99.
  2474             20  PI-ERESV        PIC S9(7)V99.
  2475             20  PI-EEXPENS      PIC 9(6)V99.
  2476             20  PI-ETYPE        PIC X.
  2477             20  PI-CASH         PIC X.
  2478             20  PI-GROUPED      PIC X.
  2479             20  PI-INT-RATE     PIC S99V9(5).
  2480             20  PI-AIGFROM      PIC 9(6).
  2481             20  PI-LOAN-NO      PIC X(20).
  2482             20  PI-PROOF-DATE   PIC 9(6).
  2483             20  PI-PRINT-EOB-YN PIC X.
  2484             20  PI-PRINT-CLM-FRM-YN PIC X.
  2485             20  PI-PRINT-SURVEY-YN PIC X.
  2486             20  PI-SPECIAL-RELEASE-YN PIC X.
  2487         16  PI-SAVE-COMPUTED.
  2488             20  PI-CCHECKNO     PIC X(7).
  2489             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2490                 28  PI-CCHECKNO-N     PIC X.
  2491                 28  PI-CCHECKNO-6     PIC X(6).
  2492             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2493                 24  PI-CCHECKNO-CR    PIC XX.
  2494                 24  PI-CCHECKNO-5     PIC X(5).
  2495             20  PI-CPYFROM      PIC XX.
  2496             20  PI-CPYTHRU      PIC XX.
  2497             20  PI-CDAYS        PIC S9(5).
  2498             20  PI-CPYAMT       PIC S9(7)V99.
  2499             20  PI-CRESV        PIC 9(6)V99.
  2500             20  PI-CEXPENS      PIC 9(6)V99.
  2501             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  51
* EL156.cbl
  2502                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2503                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2504                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2505         16  PI-PREV-CLMNO       PIC X(7).
  2506         16  PI-LF-COVERAGE-TYPE PIC X.
  2507         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2508         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2509         16  PI-PROVISIONAL-IND  PIC X.
  2510             88 PI-PROV-PMT      VALUE 'P'.
  2511         16  PI-PREV-TRLR-KEY    PIC X(22).
  2512         16  PI-SPLIT-PMT-SW     PIC X.
  2513         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2514         16  PI-ACTIVITY-CODE    PIC 99.
  2515         16  PI-RESET-SW         PIC X.
  2516         16  PI-SPECIAL-BEN-SW   PIC X.
  2517             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2518         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2519         16  PI-EXP-DT           PIC XX.
  2520         16  PI-LOAN-DUE-DAY     PIC 99.
  2521         16  PI-3RD-PARTY-SW     PIC X.
  2522         16  PI-LOAN-UPDATE-SW   PIC X.
  2523
  2524         16  PI-DMD-DATA.
  2525             20  PI-SV-CERT-KEY       PIC X(21).
  2526             20  PI-SV-CERT-NO        PIC X(11).
  2527             20  PI-SV-BEN            PIC X(10).
  2528             20  PI-SV-CCN            PIC X(16).
  2529             20  PI-INTEREST-PAID-IND PIC X.
  2530                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2531             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2532             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2533             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2534             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2535         16  PI-AT-EOB-CODES.
  2536             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2537         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2538         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2539         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2540         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2541         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2542         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2543         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2544         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2545         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2546         16  PI-LF-BENEFIT-CD         PIC X(2).
  2547         16  PI-EOB-CODES-EXIST PIC X.
  2548         16  PI-SET-NOTE2-MDT   PIC X.
  2549         16  PI-VFY-2ND-BENE          PIC X.
  2550         16  PI-CLM-TYPE              PIC X.
  2551         16  PI-APPROVAL-LEVEL        PIC X.
  2552         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2553         16  PI-REAUDIT-NEEDED        PIC X.
  2554         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2555         16  PI-AH-BENEFIT-CD         PIC XX.
  2556         16  pi-ah-term               pic s999 comp-3.
  2557         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2558         16  pi-max-ext               pic 999.
  2559         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  52
* EL156.cbl
  2560         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2561         16  PI-JOINT-COV-IND         PIC X.
  2562             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2563             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2564         16  PI-JOINT-INSURED-IND     PIC X.
  2565             88  PI-JOINT-INSURED        VALUE 'Y'.
  2566             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2567*00781          16  FILLER                   PIC X(176).
  2568*052506         16  FILLER                   PIC X(161).
  2569*031808         16  FILLER                   PIC X(154).
  2570*091808         16  FILLER                   PIC X(152).
  2571*041710         16  FILLER                   PIC X(94).
  2572         16  FILLER                   PIC X(67).
  2573
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  53
* EL156.cbl
  2575*    COPY ELCJPFX.
  2576******************************************************************
  2577*                                                                *
  2578*                                                                *
  2579*                            ELCJPFX.                            *
  2580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2581*                            VMOD=2.002                          *
  2582*                                                                *
  2583*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2584*                                                                *
  2585*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2586*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2587*        ELCNTL - CONTROL FILE                                   *
  2588*        ELMSTR - CLAIM MASTERS                                  *
  2589*        ELTRLR - ACTIVITY TRAILERS                              *
  2590*        ELCHKQ - CHECK QUE                                      *
  2591******************************************************************
  2592 01  JOURNAL-RECORD.
  2593     12  jp-date                     pic s9(5) comp-3.
  2594     12  jp-time                     pic s9(7) comp-3.
  2595     12  JP-USER-ID                  PIC X(4).
  2596     12  JP-FILE-ID                  PIC X(8).
  2597     12  JP-PROGRAM-ID               PIC X(8).
  2598     12  JP-RECORD-TYPE              PIC X.
  2599         88 JP-ADD              VALUE 'A'.
  2600         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2601         88 JP-AFTER-CHANGE     VALUE 'C'.
  2602         88 JP-DELETE           VALUE 'D'.
  2603         88 JP-GENERIC-DELETE   VALUE 'G'.
  2604         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2605         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2606     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2607     12  JP-RECORD-AREA
  2608
  2609
  2610                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  54
* EL156.cbl
  2612*    COPY ELCAID.
  2613******************************************************************
  2614*                                                                *
  2615*                            ELCAID.                             *
  2616*                            VMOD=2.001                          *
  2617*                                                                *
  2618*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2619*                                                                *
  2620*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2621*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2622******************************************************************
  2623
  2624 01  DFHAID.
  2625   02  DFHNULL   PIC  X  VALUE  ' '.
  2626   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2627   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2628   02  DFHPEN    PIC  X  VALUE  '='.
  2629   02  DFHOPID   PIC  X  VALUE  'W'.
  2630   02  DFHPA1    PIC  X  VALUE  '%'.
  2631   02  DFHPA2    PIC  X  VALUE  '>'.
  2632   02  DFHPA3    PIC  X  VALUE  ','.
  2633   02  DFHPF1    PIC  X  VALUE  '1'.
  2634   02  DFHPF2    PIC  X  VALUE  '2'.
  2635   02  DFHPF3    PIC  X  VALUE  '3'.
  2636   02  DFHPF4    PIC  X  VALUE  '4'.
  2637   02  DFHPF5    PIC  X  VALUE  '5'.
  2638   02  DFHPF6    PIC  X  VALUE  '6'.
  2639   02  DFHPF7    PIC  X  VALUE  '7'.
  2640   02  DFHPF8    PIC  X  VALUE  '8'.
  2641   02  DFHPF9    PIC  X  VALUE  '9'.
  2642   02  DFHPF10   PIC  X  VALUE  ':'.
  2643   02  DFHPF11   PIC  X  VALUE  '#'.
  2644   02  DFHPF12   PIC  X  VALUE  '@'.
  2645   02  DFHPF13   PIC  X  VALUE  'A'.
  2646   02  DFHPF14   PIC  X  VALUE  'B'.
  2647   02  DFHPF15   PIC  X  VALUE  'C'.
  2648   02  DFHPF16   PIC  X  VALUE  'D'.
  2649   02  DFHPF17   PIC  X  VALUE  'E'.
  2650   02  DFHPF18   PIC  X  VALUE  'F'.
  2651   02  DFHPF19   PIC  X  VALUE  'G'.
  2652   02  DFHPF20   PIC  X  VALUE  'H'.
  2653   02  DFHPF21   PIC  X  VALUE  'I'.
  2654*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2655   02  DFHPF22   PIC  X  VALUE  '['.
  2656   02  DFHPF23   PIC  X  VALUE  '.'.
  2657   02  DFHPF24   PIC  X  VALUE  '<'.
  2658   02  DFHMSRE   PIC  X  VALUE  'X'.
  2659   02  DFHSTRF   PIC  X  VALUE  'h'.
  2660   02  DFHTRIG   PIC  X  VALUE  '"'.
  2661 01  FILLER    REDEFINES DFHAID.
  2662     12  FILLER              PIC X(8).
  2663     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  55
* EL156.cbl
  2665*    COPY EL156S.
  2666 01  EL156AI.
  2667     05  FILLER            PIC  X(0012).
  2668*    -------------------------------
  2669     05  RUNDTEAL PIC S9(0004) COMP.
  2670     05  RUNDTEAF PIC  X(0001).
  2671     05  FILLER REDEFINES RUNDTEAF.
  2672         10  RUNDTEAA PIC  X(0001).
  2673     05  RUNDTEAI PIC  X(0008).
  2674*    -------------------------------
  2675     05  RUNTIMAL PIC S9(0004) COMP.
  2676     05  RUNTIMAF PIC  X(0001).
  2677     05  FILLER REDEFINES RUNTIMAF.
  2678         10  RUNTIMAA PIC  X(0001).
  2679     05  RUNTIMAI PIC  X(0005).
  2680*    -------------------------------
  2681     05  SEQUL PIC S9(0004) COMP.
  2682     05  SEQUF PIC  X(0001).
  2683     05  FILLER REDEFINES SEQUF.
  2684         10  SEQUA PIC  X(0001).
  2685     05  SEQUI PIC  X(0010).
  2686*    -------------------------------
  2687     05  CLMNOL PIC S9(0004) COMP.
  2688     05  CLMNOF PIC  X(0001).
  2689     05  FILLER REDEFINES CLMNOF.
  2690         10  CLMNOA PIC  X(0001).
  2691     05  CLMNOI PIC  X(0007).
  2692*    -------------------------------
  2693     05  CARRL PIC S9(0004) COMP.
  2694     05  CARRF PIC  X(0001).
  2695     05  FILLER REDEFINES CARRF.
  2696         10  CARRA PIC  X(0001).
  2697     05  CARRI PIC  X(0001).
  2698*    -------------------------------
  2699     05  CERTNOL PIC S9(0004) COMP.
  2700     05  CERTNOF PIC  X(0001).
  2701     05  FILLER REDEFINES CERTNOF.
  2702         10  CERTNOA PIC  X(0001).
  2703     05  CERTNOI PIC  X(0010).
  2704*    -------------------------------
  2705     05  SUFXL PIC S9(0004) COMP.
  2706     05  SUFXF PIC  X(0001).
  2707     05  FILLER REDEFINES SUFXF.
  2708         10  SUFXA PIC  X(0001).
  2709     05  SUFXI PIC  X(0001).
  2710*    -------------------------------
  2711     05  CLMTYPL PIC S9(0004) COMP.
  2712     05  CLMTYPF PIC  X(0001).
  2713     05  FILLER REDEFINES CLMTYPF.
  2714         10  CLMTYPA PIC  X(0001).
  2715     05  CLMTYPI PIC  X(0006).
  2716*    -------------------------------
  2717     05  CLMSTATL PIC S9(0004) COMP.
  2718     05  CLMSTATF PIC  X(0001).
  2719     05  FILLER REDEFINES CLMSTATF.
  2720         10  CLMSTATA PIC  X(0001).
  2721     05  CLMSTATI PIC  X(0006).
  2722*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  56
* EL156.cbl
  2723     05  LSTNMEL PIC S9(0004) COMP.
  2724     05  LSTNMEF PIC  X(0001).
  2725     05  FILLER REDEFINES LSTNMEF.
  2726         10  LSTNMEA PIC  X(0001).
  2727     05  LSTNMEI PIC  X(0015).
  2728*    -------------------------------
  2729     05  FSTNMEL PIC S9(0004) COMP.
  2730     05  FSTNMEF PIC  X(0001).
  2731     05  FILLER REDEFINES FSTNMEF.
  2732         10  FSTNMEA PIC  X(0001).
  2733     05  FSTNMEI PIC  X(0012).
  2734*    -------------------------------
  2735     05  MINITL PIC S9(0004) COMP.
  2736     05  MINITF PIC  X(0001).
  2737     05  FILLER REDEFINES MINITF.
  2738         10  MINITA PIC  X(0001).
  2739     05  MINITI PIC  X(0001).
  2740*    -------------------------------
  2741     05  PRIMHDGL PIC S9(0004) COMP.
  2742     05  PRIMHDGF PIC  X(0001).
  2743     05  FILLER REDEFINES PRIMHDGF.
  2744         10  PRIMHDGA PIC  X(0001).
  2745     05  PRIMHDGI PIC  X(0012).
  2746*    -------------------------------
  2747     05  PCERTNOL PIC S9(0004) COMP.
  2748     05  PCERTNOF PIC  X(0001).
  2749     05  FILLER REDEFINES PCERTNOF.
  2750         10  PCERTNOA PIC  X(0001).
  2751     05  PCERTNOI PIC  X(0010).
  2752*    -------------------------------
  2753     05  PSUFXL PIC S9(0004) COMP.
  2754     05  PSUFXF PIC  X(0001).
  2755     05  FILLER REDEFINES PSUFXF.
  2756         10  PSUFXA PIC  X(0001).
  2757     05  PSUFXI PIC  X(0001).
  2758*    -------------------------------
  2759     05  STATUSL PIC S9(0004) COMP.
  2760     05  STATUSF PIC  X(0001).
  2761     05  FILLER REDEFINES STATUSF.
  2762         10  STATUSA PIC  X(0001).
  2763     05  STATUSI PIC  X(0010).
  2764*    -------------------------------
  2765     05  LOANHL PIC S9(0004) COMP.
  2766     05  LOANHF PIC  X(0001).
  2767     05  FILLER REDEFINES LOANHF.
  2768         10  LOANHA PIC  X(0001).
  2769     05  LOANHI PIC  X(0014).
  2770*    -------------------------------
  2771     05  LOANNOL PIC S9(0004) COMP.
  2772     05  LOANNOF PIC  X(0001).
  2773     05  FILLER REDEFINES LOANNOF.
  2774         10  LOANNOA PIC  X(0001).
  2775     05  LOANNOI PIC  X(0025).
  2776*    -------------------------------
  2777     05  DUEDAYHL PIC S9(0004) COMP.
  2778     05  DUEDAYHF PIC  X(0001).
  2779     05  FILLER REDEFINES DUEDAYHF.
  2780         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  57
* EL156.cbl
  2781     05  DUEDAYHI PIC  X(0008).
  2782*    -------------------------------
  2783     05  DUEDAYL PIC S9(0004) COMP.
  2784     05  DUEDAYF PIC  X(0001).
  2785     05  FILLER REDEFINES DUEDAYF.
  2786         10  DUEDAYA PIC  X(0001).
  2787     05  DUEDAYI PIC  X(0002).
  2788*    -------------------------------
  2789     05  ZINTHL PIC S9(0004) COMP.
  2790     05  ZINTHF PIC  X(0001).
  2791     05  FILLER REDEFINES ZINTHF.
  2792         10  ZINTHA PIC  X(0001).
  2793     05  ZINTHI PIC  X(0009).
  2794*    -------------------------------
  2795     05  ZINTL PIC S9(0004) COMP.
  2796     05  ZINTF PIC  X(0001).
  2797     05  FILLER REDEFINES ZINTF.
  2798         10  ZINTA PIC  X(0001).
  2799     05  ZINTI PIC  99V99999.
  2800*    -------------------------------
  2801     05  PTHRHDGL PIC S9(0004) COMP.
  2802     05  PTHRHDGF PIC  X(0001).
  2803     05  FILLER REDEFINES PTHRHDGF.
  2804         10  PTHRHDGA PIC  X(0001).
  2805     05  PTHRHDGI PIC  X(0014).
  2806*    -------------------------------
  2807     05  PDTHRUL PIC S9(0004) COMP.
  2808     05  PDTHRUF PIC  X(0001).
  2809     05  FILLER REDEFINES PDTHRUF.
  2810         10  PDTHRUA PIC  X(0001).
  2811     05  PDTHRUI PIC  X(0008).
  2812*    -------------------------------
  2813     05  TOTPAIDL PIC S9(0004) COMP.
  2814     05  TOTPAIDF PIC  X(0001).
  2815     05  FILLER REDEFINES TOTPAIDF.
  2816         10  TOTPAIDA PIC  X(0001).
  2817     05  TOTPAIDI PIC  X(0010).
  2818*    -------------------------------
  2819     05  COVERL PIC S9(0004) COMP.
  2820     05  COVERF PIC  X(0001).
  2821     05  FILLER REDEFINES COVERF.
  2822         10  COVERA PIC  X(0001).
  2823     05  COVERI PIC  X(0010).
  2824*    -------------------------------
  2825     05  INCURL PIC S9(0004) COMP.
  2826     05  INCURF PIC  X(0001).
  2827     05  FILLER REDEFINES INCURF.
  2828         10  INCURA PIC  X(0001).
  2829     05  INCURI PIC  X(0008).
  2830*    -------------------------------
  2831     05  LSTDTEL PIC S9(0004) COMP.
  2832     05  LSTDTEF PIC  X(0001).
  2833     05  FILLER REDEFINES LSTDTEF.
  2834         10  LSTDTEA PIC  X(0001).
  2835     05  LSTDTEI PIC  X(0008).
  2836*    -------------------------------
  2837     05  CRTSTATL PIC S9(0004) COMP.
  2838     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  58
* EL156.cbl
  2839     05  FILLER REDEFINES CRTSTATF.
  2840         10  CRTSTATA PIC  X(0001).
  2841     05  CRTSTATI PIC  X(0010).
  2842*    -------------------------------
  2843     05  EFFECTL PIC S9(0004) COMP.
  2844     05  EFFECTF PIC  X(0001).
  2845     05  FILLER REDEFINES EFFECTF.
  2846         10  EFFECTA PIC  X(0001).
  2847     05  EFFECTI PIC  X(0008).
  2848*    -------------------------------
  2849     05  TERMSL PIC S9(0004) COMP.
  2850     05  TERMSF PIC  X(0001).
  2851     05  FILLER REDEFINES TERMSF.
  2852         10  TERMSA PIC  X(0001).
  2853     05  TERMSI PIC  X(0011).
  2854*    -------------------------------
  2855     05  STACCTL PIC S9(0004) COMP.
  2856     05  STACCTF PIC  X(0001).
  2857     05  FILLER REDEFINES STACCTF.
  2858         10  STACCTA PIC  X(0001).
  2859     05  STACCTI PIC  X(0013).
  2860*    -------------------------------
  2861     05  EXPDTEHL PIC S9(0004) COMP.
  2862     05  EXPDTEHF PIC  X(0001).
  2863     05  FILLER REDEFINES EXPDTEHF.
  2864         10  EXPDTEHA PIC  X(0001).
  2865     05  EXPDTEHI PIC  X(0014).
  2866*    -------------------------------
  2867     05  EXPDTEL PIC S9(0004) COMP.
  2868     05  EXPDTEF PIC  X(0001).
  2869     05  FILLER REDEFINES EXPDTEF.
  2870         10  EXPDTEA PIC  X(0001).
  2871     05  EXPDTEI PIC  X(0008).
  2872*    -------------------------------
  2873     05  BENECAPL PIC S9(0004) COMP.
  2874     05  BENECAPF PIC  X(0001).
  2875     05  FILLER REDEFINES BENECAPF.
  2876         10  BENECAPA PIC  X(0001).
  2877     05  BENECAPI PIC  X(0013).
  2878*    -------------------------------
  2879     05  BENEL PIC S9(0004) COMP.
  2880     05  BENEF PIC  X(0001).
  2881     05  FILLER REDEFINES BENEF.
  2882         10  BENEA PIC  X(0001).
  2883     05  BENEI PIC  X(0009).
  2884*    -------------------------------
  2885     05  FORMTYPL PIC S9(0004) COMP.
  2886     05  FORMTYPF PIC  X(0001).
  2887     05  FILLER REDEFINES FORMTYPF.
  2888         10  FORMTYPA PIC  X(0001).
  2889     05  FORMTYPI PIC  X(0001).
  2890*    -------------------------------
  2891     05  PMTTYPEL PIC S9(0004) COMP.
  2892     05  PMTTYPEF PIC  X(0001).
  2893     05  FILLER REDEFINES PMTTYPEF.
  2894         10  PMTTYPEA PIC  X(0001).
  2895     05  PMTTYPEI PIC  X(0001).
  2896*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  59
* EL156.cbl
  2897     05  PAYEEL PIC S9(0004) COMP.
  2898     05  PAYEEF PIC  X(0001).
  2899     05  FILLER REDEFINES PAYEEF.
  2900         10  PAYEEA PIC  X(0001).
  2901     05  PAYEEI PIC  X(0002).
  2902*    -------------------------------
  2903     05  CHECKNOL PIC S9(0004) COMP.
  2904     05  CHECKNOF PIC  X(0001).
  2905     05  FILLER REDEFINES CHECKNOF.
  2906         10  CHECKNOA PIC  X(0001).
  2907     05  CHECKNOI PIC  X(0007).
  2908*    -------------------------------
  2909     05  OFFLINEL PIC S9(0004) COMP.
  2910     05  OFFLINEF PIC  X(0001).
  2911     05  FILLER REDEFINES OFFLINEF.
  2912         10  OFFLINEA PIC  X(0001).
  2913     05  OFFLINEI PIC  X(0001).
  2914*    -------------------------------
  2915     05  HOLDTILL PIC S9(0004) COMP.
  2916     05  HOLDTILF PIC  X(0001).
  2917     05  FILLER REDEFINES HOLDTILF.
  2918         10  HOLDTILA PIC  X(0001).
  2919     05  HOLDTILI PIC  X(0008).
  2920*    -------------------------------
  2921     05  NOTE1L PIC S9(0004) COMP.
  2922     05  NOTE1F PIC  X(0001).
  2923     05  FILLER REDEFINES NOTE1F.
  2924         10  NOTE1A PIC  X(0001).
  2925     05  NOTE1I PIC  X(0060).
  2926*    -------------------------------
  2927     05  NOTE2L PIC S9(0004) COMP.
  2928     05  NOTE2F PIC  X(0001).
  2929     05  FILLER REDEFINES NOTE2F.
  2930         10  NOTE2A PIC  X(0001).
  2931     05  NOTE2I PIC  X(0060).
  2932*    -------------------------------
  2933     05  EOBYNL PIC S9(0004) COMP.
  2934     05  EOBYNF PIC  X(0001).
  2935     05  FILLER REDEFINES EOBYNF.
  2936         10  EOBYNA PIC  X(0001).
  2937     05  EOBYNI PIC  X(0001).
  2938*    -------------------------------
  2939     05  CLMFMYNL PIC S9(0004) COMP.
  2940     05  CLMFMYNF PIC  X(0001).
  2941     05  FILLER REDEFINES CLMFMYNF.
  2942         10  CLMFMYNA PIC  X(0001).
  2943     05  CLMFMYNI PIC  X(0001).
  2944*    -------------------------------
  2945     05  SURVYYNL PIC S9(0004) COMP.
  2946     05  SURVYYNF PIC  X(0001).
  2947     05  FILLER REDEFINES SURVYYNF.
  2948         10  SURVYYNA PIC  X(0001).
  2949     05  SURVYYNI PIC  X(0001).
  2950*    -------------------------------
  2951     05  SPRELYNL PIC S9(0004) COMP.
  2952     05  SPRELYNF PIC  X(0001).
  2953     05  FILLER REDEFINES SPRELYNF.
  2954         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  60
* EL156.cbl
  2955     05  SPRELYNI PIC  X(0001).
  2956*    -------------------------------
  2957     05  PINTHL PIC S9(0004) COMP.
  2958     05  PINTHF PIC  X(0001).
  2959     05  FILLER REDEFINES PINTHF.
  2960         10  PINTHA PIC  X(0001).
  2961     05  PINTHI PIC  X(0004).
  2962*    -------------------------------
  2963     05  PINTL PIC S9(0004) COMP.
  2964     05  PINTF PIC  X(0001).
  2965     05  FILLER REDEFINES PINTF.
  2966         10  PINTA PIC  X(0001).
  2967     05  PINTI PIC  X(0008).
  2968*    -------------------------------
  2969     05  PROOFDTL PIC S9(0004) COMP.
  2970     05  PROOFDTF PIC  X(0001).
  2971     05  FILLER REDEFINES PROOFDTF.
  2972         10  PROOFDTA PIC  X(0001).
  2973     05  PROOFDTI PIC  X(0008).
  2974*    -------------------------------
  2975     05  AIGFRMHL PIC S9(0004) COMP.
  2976     05  AIGFRMHF PIC  X(0001).
  2977     05  FILLER REDEFINES AIGFRMHF.
  2978         10  AIGFRMHA PIC  X(0001).
  2979     05  AIGFRMHI PIC  X(0012).
  2980*    -------------------------------
  2981     05  AIGFROML PIC S9(0004) COMP.
  2982     05  AIGFROMF PIC  X(0001).
  2983     05  FILLER REDEFINES AIGFROMF.
  2984         10  AIGFROMA PIC  X(0001).
  2985     05  AIGFROMI PIC  X(0008).
  2986*    -------------------------------
  2987     05  PMTHDGAL PIC S9(0004) COMP.
  2988     05  PMTHDGAF PIC  X(0001).
  2989     05  FILLER REDEFINES PMTHDGAF.
  2990         10  PMTHDGAA PIC  X(0001).
  2991     05  PMTHDGAI PIC  X(0066).
  2992*    -------------------------------
  2993     05  EPYFROML PIC S9(0004) COMP.
  2994     05  EPYFROMF PIC  X(0001).
  2995     05  FILLER REDEFINES EPYFROMF.
  2996         10  EPYFROMA PIC  X(0001).
  2997     05  EPYFROMI PIC  X(0008).
  2998*    -------------------------------
  2999     05  EPYTHRUL PIC S9(0004) COMP.
  3000     05  EPYTHRUF PIC  X(0001).
  3001     05  FILLER REDEFINES EPYTHRUF.
  3002         10  EPYTHRUA PIC  X(0001).
  3003     05  EPYTHRUI PIC  X(0008).
  3004*    -------------------------------
  3005     05  EDAYSL PIC S9(0004) COMP.
  3006     05  EDAYSF PIC  X(0001).
  3007     05  FILLER REDEFINES EDAYSF.
  3008         10  EDAYSA PIC  X(0001).
  3009     05  EDAYSI PIC  S9(6).
  3010*    -------------------------------
  3011     05  EPYAMTL PIC S9(0004) COMP.
  3012     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  61
* EL156.cbl
  3013     05  FILLER REDEFINES EPYAMTF.
  3014         10  EPYAMTA PIC  X(0001).
  3015     05  EPYAMTI PIC  S9(8)V99.
  3016*    -------------------------------
  3017     05  ERESVL PIC S9(0004) COMP.
  3018     05  ERESVF PIC  X(0001).
  3019     05  FILLER REDEFINES ERESVF.
  3020         10  ERESVA PIC  X(0001).
  3021     05  ERESVI PIC  S9(7)V99.
  3022*    -------------------------------
  3023     05  ETYPEL PIC S9(0004) COMP.
  3024     05  ETYPEF PIC  X(0001).
  3025     05  FILLER REDEFINES ETYPEF.
  3026         10  ETYPEA PIC  X(0001).
  3027     05  ETYPEI PIC  X(0001).
  3028*    -------------------------------
  3029     05  EEXPENSL PIC S9(0004) COMP.
  3030     05  EEXPENSF PIC  X(0001).
  3031     05  FILLER REDEFINES EEXPENSF.
  3032         10  EEXPENSA PIC  X(0001).
  3033     05  EEXPENSI PIC  9(6)V99.
  3034*    -------------------------------
  3035     05  CPYFROML PIC S9(0004) COMP.
  3036     05  CPYFROMF PIC  X(0001).
  3037     05  FILLER REDEFINES CPYFROMF.
  3038         10  CPYFROMA PIC  X(0001).
  3039     05  CPYFROMI PIC  X(0008).
  3040*    -------------------------------
  3041     05  CPYTHRUL PIC S9(0004) COMP.
  3042     05  CPYTHRUF PIC  X(0001).
  3043     05  FILLER REDEFINES CPYTHRUF.
  3044         10  CPYTHRUA PIC  X(0001).
  3045     05  CPYTHRUI PIC  X(0008).
  3046*    -------------------------------
  3047     05  CDAYSL PIC S9(0004) COMP.
  3048     05  CDAYSF PIC  X(0001).
  3049     05  FILLER REDEFINES CDAYSF.
  3050         10  CDAYSA PIC  X(0001).
  3051     05  CDAYSI PIC  9(6).
  3052*    -------------------------------
  3053     05  CPYAMTL PIC S9(0004) COMP.
  3054     05  CPYAMTF PIC  X(0001).
  3055     05  FILLER REDEFINES CPYAMTF.
  3056         10  CPYAMTA PIC  X(0001).
  3057     05  CPYAMTI PIC  S9(8)V99.
  3058*    -------------------------------
  3059     05  CRESVL PIC S9(0004) COMP.
  3060     05  CRESVF PIC  X(0001).
  3061     05  FILLER REDEFINES CRESVF.
  3062         10  CRESVA PIC  X(0001).
  3063     05  CRESVI PIC  9(6)V99.
  3064*    -------------------------------
  3065     05  CEXPENSL PIC S9(0004) COMP.
  3066     05  CEXPENSF PIC  X(0001).
  3067     05  FILLER REDEFINES CEXPENSF.
  3068         10  CEXPENSA PIC  X(0001).
  3069     05  CEXPENSI PIC  9(6)V99.
  3070*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  62
* EL156.cbl
  3071     05  ERRMSG0L PIC S9(0004) COMP.
  3072     05  ERRMSG0F PIC  X(0001).
  3073     05  FILLER REDEFINES ERRMSG0F.
  3074         10  ERRMSG0A PIC  X(0001).
  3075     05  ERRMSG0I PIC  X(0072).
  3076*    -------------------------------
  3077     05  ERRMSG1L PIC S9(0004) COMP.
  3078     05  ERRMSG1F PIC  X(0001).
  3079     05  FILLER REDEFINES ERRMSG1F.
  3080         10  ERRMSG1A PIC  X(0001).
  3081     05  ERRMSG1I PIC  X(0072).
  3082*    -------------------------------
  3083     05  ERRMSG2L PIC S9(0004) COMP.
  3084     05  ERRMSG2F PIC  X(0001).
  3085     05  FILLER REDEFINES ERRMSG2F.
  3086         10  ERRMSG2A PIC  X(0001).
  3087     05  ERRMSG2I PIC  X(0072).
  3088*    -------------------------------
  3089     05  ENTERPFL PIC S9(0004) COMP.
  3090     05  ENTERPFF PIC  X(0001).
  3091     05  FILLER REDEFINES ENTERPFF.
  3092         10  ENTERPFA PIC  X(0001).
  3093     05  ENTERPFI PIC  99.
  3094*    -------------------------------
  3095     05  PF6TITL PIC S9(0004) COMP.
  3096     05  PF6TITF PIC  X(0001).
  3097     05  FILLER REDEFINES PF6TITF.
  3098         10  PF6TITA PIC  X(0001).
  3099     05  PF6TITI PIC  X(0016).
  3100 01  EL156AO REDEFINES EL156AI.
  3101     05  FILLER            PIC  X(0012).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  RUNDTEAO PIC  X(0008).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  RUNTIMAO PIC  99.99.
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  SEQUO PIC  X(0010).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  CLMNOO PIC  X(0007).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  CARRO PIC  X(0001).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  CERTNOO PIC  X(0010).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  SUFXO PIC  X(0001).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  CLMTYPO PIC  X(0006).
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  63
* EL156.cbl
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  LSTNMEO PIC  X(0015).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  FSTNMEO PIC  X(0012).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  MINITO PIC  X(0001).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  PRIMHDGO PIC  X(0012).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  PCERTNOO PIC  X(0010).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  PSUFXO PIC  X(0001).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  STATUSO PIC  X(0010).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  LOANHO PIC  X(0014).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  LOANNOO PIC  X(0025).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  DUEDAYHO PIC  X(0008).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  DUEDAYO PIC  X(0002).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  ZINTHO PIC  X(0009).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  ZINTO PIC  9.99999.
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  PTHRHDGO PIC  X(0014).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  PDTHRUO PIC  X(0008).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  TOTPAIDO PIC  Z(6).99-.
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  COVERO PIC  X(0010).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  INCURO PIC  X(0008).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  LSTDTEO PIC  X(0008).
  3186*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  64
* EL156.cbl
  3187     05  FILLER            PIC  X(0003).
  3188     05  CRTSTATO PIC  X(0010).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  EFFECTO PIC  X(0008).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  TERMSO PIC  X(0011).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  STACCTO PIC  X(0013).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  EXPDTEHO PIC  X(0014).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  EXPDTEO PIC  X(0008).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  BENECAPO PIC  X(0013).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  BENEO PIC  Z(6).99.
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  FORMTYPO PIC  X(0001).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PMTTYPEO PIC  X(0001).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  PAYEEO PIC  X(0002).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  CHECKNOO PIC  X(0007).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  OFFLINEO PIC  X(0001).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  HOLDTILO PIC  99B99B99.
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  NOTE1O PIC  X(0060).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  NOTE2O PIC  X(0060).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  EOBYNO PIC  X(0001).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  CLMFMYNO PIC  X(0001).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  SURVYYNO PIC  X(0001).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  65
* EL156.cbl
  3245     05  SPRELYNO PIC  X(0001).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  PINTHO PIC  X(0004).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  PINTO PIC  Z,ZZ9.99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  PROOFDTO PIC  99B99B99.
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  AIGFRMHO PIC  X(0012).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  AIGFROMO PIC  99B99B99.
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  PMTHDGAO PIC  X(0066).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  EPYFROMO PIC  99B99B99.
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EPYTHRUO PIC  99B99B99.
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EDAYSO PIC  Z(4)9-.
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  EPYAMTO PIC  Z(6).99-.
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  ERESVO PIC  Z(5).99-.
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  ETYPEO PIC  X(0001).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  EEXPENSO PIC  Z(5).99.
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  CPYFROMO PIC  99B99B99.
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CPYTHRUO PIC  99B99B99.
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  CDAYSO PIC  Z(4)9-.
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  CPYAMTO PIC  Z(6).99-.
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  CRESVO PIC  Z(5).99.
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  66
* EL156.cbl
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  ERRMSG0O PIC  X(0072).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ERRMSG1O PIC  X(0072).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  ERRMSG2O PIC  X(0072).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  ENTERPFO PIC  X(0002).
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  PF6TITO PIC  X(0016).
  3318*    -------------------------------
  3319 01  EL156BI REDEFINES EL156AI.
  3320     05  FILLER            PIC  X(0012).
  3321*    -------------------------------
  3322     05  RUNDTEBL PIC S9(0004) COMP.
  3323     05  RUNDTEBF PIC  X(0001).
  3324     05  FILLER REDEFINES RUNDTEBF.
  3325         10  RUNDTEBA PIC  X(0001).
  3326     05  RUNDTEBI PIC  X(0008).
  3327*    -------------------------------
  3328     05  RUNTIMBL PIC S9(0004) COMP.
  3329     05  RUNTIMBF PIC  X(0001).
  3330     05  FILLER REDEFINES RUNTIMBF.
  3331         10  RUNTIMBA PIC  X(0001).
  3332     05  RUNTIMBI PIC  X(0005).
  3333*    -------------------------------
  3334     05  PAYDTBL PIC S9(0004) COMP.
  3335     05  PAYDTBF PIC  X(0001).
  3336     05  FILLER REDEFINES PAYDTBF.
  3337         10  PAYDTBA PIC  X(0001).
  3338     05  PAYDTBI PIC  X(0008).
  3339*    -------------------------------
  3340     05  PAYTYPBL PIC S9(0004) COMP.
  3341     05  PAYTYPBF PIC  X(0001).
  3342     05  FILLER REDEFINES PAYTYPBF.
  3343         10  PAYTYPBA PIC  X(0001).
  3344     05  PAYTYPBI PIC  X(0015).
  3345*    -------------------------------
  3346     05  PAYAMTBL PIC S9(0004) COMP.
  3347     05  PAYAMTBF PIC  X(0001).
  3348     05  FILLER REDEFINES PAYAMTBF.
  3349         10  PAYAMTBA PIC  X(0001).
  3350     05  PAYAMTBI PIC  X(0011).
  3351*    -------------------------------
  3352     05  LOANHBL PIC S9(0004) COMP.
  3353     05  LOANHBF PIC  X(0001).
  3354     05  FILLER REDEFINES LOANHBF.
  3355         10  LOANHBA PIC  X(0001).
  3356     05  LOANHBI PIC  X(0012).
  3357*    -------------------------------
  3358     05  LOANNBL PIC S9(0004) COMP.
  3359     05  LOANNBF PIC  X(0001).
  3360     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  67
* EL156.cbl
  3361         10  LOANNBA PIC  X(0001).
  3362     05  LOANNBI PIC  X(0025).
  3363*    -------------------------------
  3364     05  CKNUMHDL PIC S9(0004) COMP.
  3365     05  CKNUMHDF PIC  X(0001).
  3366     05  FILLER REDEFINES CKNUMHDF.
  3367         10  CKNUMHDA PIC  X(0001).
  3368     05  CKNUMHDI PIC  X(0012).
  3369*    -------------------------------
  3370     05  CKNUMBL PIC S9(0004) COMP.
  3371     05  CKNUMBF PIC  X(0001).
  3372     05  FILLER REDEFINES CKNUMBF.
  3373         10  CKNUMBA PIC  X(0001).
  3374     05  CKNUMBI PIC  X(0007).
  3375*    -------------------------------
  3376     05  AGTHDGL PIC S9(0004) COMP.
  3377     05  AGTHDGF PIC  X(0001).
  3378     05  FILLER REDEFINES AGTHDGF.
  3379         10  AGTHDGA PIC  X(0001).
  3380     05  AGTHDGI PIC  X(0016).
  3381*    -------------------------------
  3382     05  NAMEBL PIC S9(0004) COMP.
  3383     05  NAMEBF PIC  X(0001).
  3384     05  FILLER REDEFINES NAMEBF.
  3385         10  NAMEBA PIC  X(0001).
  3386     05  NAMEBI PIC  X(0030).
  3387*    -------------------------------
  3388     05  NAMEB2L PIC S9(0004) COMP.
  3389     05  NAMEB2F PIC  X(0001).
  3390     05  FILLER REDEFINES NAMEB2F.
  3391         10  NAMEB2A PIC  X(0001).
  3392     05  NAMEB2I PIC  X(0030).
  3393*    -------------------------------
  3394     05  ADDR1BL PIC S9(0004) COMP.
  3395     05  ADDR1BF PIC  X(0001).
  3396     05  FILLER REDEFINES ADDR1BF.
  3397         10  ADDR1BA PIC  X(0001).
  3398     05  ADDR1BI PIC  X(0030).
  3399*    -------------------------------
  3400     05  ADDR1B2L PIC S9(0004) COMP.
  3401     05  ADDR1B2F PIC  X(0001).
  3402     05  FILLER REDEFINES ADDR1B2F.
  3403         10  ADDR1B2A PIC  X(0001).
  3404     05  ADDR1B2I PIC  X(0030).
  3405*    -------------------------------
  3406     05  ADDR2BL PIC S9(0004) COMP.
  3407     05  ADDR2BF PIC  X(0001).
  3408     05  FILLER REDEFINES ADDR2BF.
  3409         10  ADDR2BA PIC  X(0001).
  3410     05  ADDR2BI PIC  X(0030).
  3411*    -------------------------------
  3412     05  ADDR2B2L PIC S9(0004) COMP.
  3413     05  ADDR2B2F PIC  X(0001).
  3414     05  FILLER REDEFINES ADDR2B2F.
  3415         10  ADDR2B2A PIC  X(0001).
  3416     05  ADDR2B2I PIC  X(0030).
  3417*    -------------------------------
  3418     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  68
* EL156.cbl
  3419     05  CITYSTBF PIC  X(0001).
  3420     05  FILLER REDEFINES CITYSTBF.
  3421         10  CITYSTBA PIC  X(0001).
  3422     05  CITYSTBI PIC  X(0030).
  3423*    -------------------------------
  3424     05  CITYST2L PIC S9(0004) COMP.
  3425     05  CITYST2F PIC  X(0001).
  3426     05  FILLER REDEFINES CITYST2F.
  3427         10  CITYST2A PIC  X(0001).
  3428     05  CITYST2I PIC  X(0030).
  3429*    -------------------------------
  3430     05  ZIPBL PIC S9(0004) COMP.
  3431     05  ZIPBF PIC  X(0001).
  3432     05  FILLER REDEFINES ZIPBF.
  3433         10  ZIPBA PIC  X(0001).
  3434     05  ZIPBI PIC  X(0009).
  3435*    -------------------------------
  3436     05  ZIPB2L PIC S9(0004) COMP.
  3437     05  ZIPB2F PIC  X(0001).
  3438     05  FILLER REDEFINES ZIPB2F.
  3439         10  ZIPB2A PIC  X(0001).
  3440     05  ZIPB2I PIC  X(0009).
  3441*    -------------------------------
  3442     05  INTHDBL PIC S9(0004) COMP.
  3443     05  INTHDBF PIC  X(0001).
  3444     05  FILLER REDEFINES INTHDBF.
  3445         10  INTHDBA PIC  X(0001).
  3446     05  INTHDBI PIC  X(0012).
  3447*    -------------------------------
  3448     05  INTAMTBL PIC S9(0004) COMP.
  3449     05  INTAMTBF PIC  X(0001).
  3450     05  FILLER REDEFINES INTAMTBF.
  3451         10  INTAMTBA PIC  X(0001).
  3452     05  INTAMTBI PIC  X(0011).
  3453*    -------------------------------
  3454     05  PMTHDGBL PIC S9(0004) COMP.
  3455     05  PMTHDGBF PIC  X(0001).
  3456     05  FILLER REDEFINES PMTHDGBF.
  3457         10  PMTHDGBA PIC  X(0001).
  3458     05  PMTHDGBI PIC  X(0034).
  3459*    -------------------------------
  3460     05  CLMNOBL PIC S9(0004) COMP.
  3461     05  CLMNOBF PIC  X(0001).
  3462     05  FILLER REDEFINES CLMNOBF.
  3463         10  CLMNOBA PIC  X(0001).
  3464     05  CLMNOBI PIC  X(0007).
  3465*    -------------------------------
  3466     05  CARRBL PIC S9(0004) COMP.
  3467     05  CARRBF PIC  X(0001).
  3468     05  FILLER REDEFINES CARRBF.
  3469         10  CARRBA PIC  X(0001).
  3470     05  CARRBI PIC  X(0001).
  3471*    -------------------------------
  3472     05  CERTNOBL PIC S9(0004) COMP.
  3473     05  CERTNOBF PIC  X(0001).
  3474     05  FILLER REDEFINES CERTNOBF.
  3475         10  CERTNOBA PIC  X(0001).
  3476     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  69
* EL156.cbl
  3477*    -------------------------------
  3478     05  SUFXBL PIC S9(0004) COMP.
  3479     05  SUFXBF PIC  X(0001).
  3480     05  FILLER REDEFINES SUFXBF.
  3481         10  SUFXBA PIC  X(0001).
  3482     05  SUFXBI PIC  X(0001).
  3483*    -------------------------------
  3484     05  CLMTYPBL PIC S9(0004) COMP.
  3485     05  CLMTYPBF PIC  X(0001).
  3486     05  FILLER REDEFINES CLMTYPBF.
  3487         10  CLMTYPBA PIC  X(0001).
  3488     05  CLMTYPBI PIC  X(0006).
  3489*    -------------------------------
  3490     05  INCURBL PIC S9(0004) COMP.
  3491     05  INCURBF PIC  X(0001).
  3492     05  FILLER REDEFINES INCURBF.
  3493         10  INCURBA PIC  X(0001).
  3494     05  INCURBI PIC  X(0008).
  3495*    -------------------------------
  3496     05  PYFROMBL PIC S9(0004) COMP.
  3497     05  PYFROMBF PIC  X(0001).
  3498     05  FILLER REDEFINES PYFROMBF.
  3499         10  PYFROMBA PIC  X(0001).
  3500     05  PYFROMBI PIC  X(0008).
  3501*    -------------------------------
  3502     05  PYTHRUBL PIC S9(0004) COMP.
  3503     05  PYTHRUBF PIC  X(0001).
  3504     05  FILLER REDEFINES PYTHRUBF.
  3505         10  PYTHRUBA PIC  X(0001).
  3506     05  PYTHRUBI PIC  X(0008).
  3507*    -------------------------------
  3508     05  DAYSBL PIC S9(0004) COMP.
  3509     05  DAYSBF PIC  X(0001).
  3510     05  FILLER REDEFINES DAYSBF.
  3511         10  DAYSBA PIC  X(0001).
  3512     05  DAYSBI PIC  X(0005).
  3513*    -------------------------------
  3514     05  BYBL PIC S9(0004) COMP.
  3515     05  BYBF PIC  X(0001).
  3516     05  FILLER REDEFINES BYBF.
  3517         10  BYBA PIC  X(0001).
  3518     05  BYBI PIC  X(0004).
  3519*    -------------------------------
  3520     05  PROOFDBL PIC S9(0004) COMP.
  3521     05  PROOFDBF PIC  X(0001).
  3522     05  FILLER REDEFINES PROOFDBF.
  3523         10  PROOFDBA PIC  X(0001).
  3524     05  PROOFDBI PIC  X(0008).
  3525*    -------------------------------
  3526     05  ACCTBL PIC S9(0004) COMP.
  3527     05  ACCTBF PIC  X(0001).
  3528     05  FILLER REDEFINES ACCTBF.
  3529         10  ACCTBA PIC  X(0001).
  3530     05  ACCTBI PIC  X(0010).
  3531*    -------------------------------
  3532     05  STATEBL PIC S9(0004) COMP.
  3533     05  STATEBF PIC  X(0001).
  3534     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  70
* EL156.cbl
  3535         10  STATEBA PIC  X(0001).
  3536     05  STATEBI PIC  X(0002).
  3537*    -------------------------------
  3538     05  GROUPBL PIC S9(0004) COMP.
  3539     05  GROUPBF PIC  X(0001).
  3540     05  FILLER REDEFINES GROUPBF.
  3541         10  GROUPBA PIC  X(0001).
  3542     05  GROUPBI PIC  X(0006).
  3543*    -------------------------------
  3544     05  ACARRBL PIC S9(0004) COMP.
  3545     05  ACARRBF PIC  X(0001).
  3546     05  FILLER REDEFINES ACARRBF.
  3547         10  ACARRBA PIC  X(0001).
  3548     05  ACARRBI PIC  X(0001).
  3549*    -------------------------------
  3550     05  ACCTNMBL PIC S9(0004) COMP.
  3551     05  ACCTNMBF PIC  X(0001).
  3552     05  FILLER REDEFINES ACCTNMBF.
  3553         10  ACCTNMBA PIC  X(0001).
  3554     05  ACCTNMBI PIC  X(0030).
  3555*    -------------------------------
  3556     05  UNDISBL PIC S9(0004) COMP.
  3557     05  UNDISBF PIC  X(0001).
  3558     05  FILLER REDEFINES UNDISBF.
  3559         10  UNDISBA PIC  X(0001).
  3560     05  UNDISBI PIC  X(0010).
  3561*    -------------------------------
  3562     05  RATEBL PIC S9(0004) COMP.
  3563     05  RATEBF PIC  X(0001).
  3564     05  FILLER REDEFINES RATEBF.
  3565         10  RATEBA PIC  X(0001).
  3566     05  RATEBI PIC  X(0006).
  3567*    -------------------------------
  3568     05  ERMSG1BL PIC S9(0004) COMP.
  3569     05  ERMSG1BF PIC  X(0001).
  3570     05  FILLER REDEFINES ERMSG1BF.
  3571         10  ERMSG1BA PIC  X(0001).
  3572     05  ERMSG1BI PIC  X(0072).
  3573*    -------------------------------
  3574     05  ENTPFBL PIC S9(0004) COMP.
  3575     05  ENTPFBF PIC  X(0001).
  3576     05  FILLER REDEFINES ENTPFBF.
  3577         10  ENTPFBA PIC  X(0001).
  3578     05  ENTPFBI PIC  99.
  3579 01  EL156BO REDEFINES EL156AI.
  3580     05  FILLER            PIC  X(0012).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  RUNDTEBO PIC  X(0008).
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  RUNTIMBO PIC  99.99.
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  PAYDTBO PIC  99B99B99.
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  71
* EL156.cbl
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  LOANHBO PIC  X(0012).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  LOANNBO PIC  X(0025).
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  CKNUMHDO PIC  X(0012).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  CKNUMBO PIC  X(0007).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  AGTHDGO PIC  X(0016).
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  NAMEBO PIC  X(0030).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  NAMEB2O PIC  X(0030).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  ADDR1BO PIC  X(0030).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  ADDR1B2O PIC  X(0030).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  ADDR2BO PIC  X(0030).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  ADDR2B2O PIC  X(0030).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  CITYSTBO PIC  X(0030).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  CITYST2O PIC  X(0030).
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  ZIPBO PIC  ZZZZ99999.
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  ZIPB2O PIC  ZZZZZZZZZ.
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  INTHDBO PIC  X(0012).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  PMTHDGBO PIC  X(0034).
  3650*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  72
* EL156.cbl
  3651     05  FILLER            PIC  X(0003).
  3652     05  CLMNOBO PIC  X(0007).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  CARRBO PIC  X(0001).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  CERTNOBO PIC  X(0010).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  SUFXBO PIC  X(0001).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  CLMTYPBO PIC  X(0006).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  INCURBO PIC  X(0008).
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PYFROMBO PIC  99B99B99.
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  PYTHRUBO PIC  99B99B99.
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  DAYSBO PIC  X(0005).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  BYBO PIC  X(0004).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  PROOFDBO PIC  99B99B99.
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  ACCTBO PIC  X(0010).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  STATEBO PIC  X(0002).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  GROUPBO PIC  X(0006).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  ACARRBO PIC  X(0001).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  ACCTNMBO PIC  X(0030).
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  UNDISBO PIC  ZZZ,Z99.99.
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  RATEBO PIC  ZZZ.99.
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  ERMSG1BO PIC  X(0072).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  73
* EL156.cbl
  3709     05  ENTPFBO PIC  X(0002).
  3710*    -------------------------------
  3711****************************************************************
  3712*
  3713* Copyright (c) 2007 by Clerity Solutions, Inc.
  3714* All rights reserved.
  3715*
  3716****************************************************************
  3717 01  DFHEIV.
  3718   02  DFHEIV0               PIC X(35).
  3719   02  DFHEIV1               PIC X(08).
  3720   02  DFHEIV2               PIC X(08).
  3721   02  DFHEIV3               PIC X(08).
  3722   02  DFHEIV4               PIC X(06).
  3723   02  DFHEIV5               PIC X(04).
  3724   02  DFHEIV6               PIC X(04).
  3725   02  DFHEIV7               PIC X(02).
  3726   02  DFHEIV8               PIC X(02).
  3727   02  DFHEIV9               PIC X(01).
  3728   02  DFHEIV10              PIC S9(7) COMP-3.
  3729   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3730   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3731   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3732   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3733   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3734   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3735   02  DFHEIV17              PIC X(04).
  3736   02  DFHEIV18              PIC X(04).
  3737   02  DFHEIV19              PIC X(04).
  3738   02  DFHEIV20              USAGE IS POINTER.
  3739   02  DFHEIV21              USAGE IS POINTER.
  3740   02  DFHEIV22              USAGE IS POINTER.
  3741   02  DFHEIV23              USAGE IS POINTER.
  3742   02  DFHEIV24              USAGE IS POINTER.
  3743   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3744   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3745   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3746   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3747   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3748   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3749   02  FILLER                PIC X(02).
  3750   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3751   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3752   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3753   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3754   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3755 LINKAGE  SECTION.
  3756*****************************************************************
  3757*                                                               *
  3758* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3759* All rights reserved.                                          *
  3760*                                                               *
  3761*****************************************************************
  3762 01  dfheiblk.
  3763     02  eibtime          pic s9(7) comp-3.
  3764     02  eibdate          pic s9(7) comp-3.
  3765     02  eibtrnid         pic x(4).
  3766     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  74
* EL156.cbl
  3767     02  eibtrmid         pic x(4).
  3768     02  dfheigdi         pic s9(4) comp.
  3769     02  eibcposn         pic s9(4) comp.
  3770     02  eibcalen         pic s9(4) comp.
  3771     02  eibaid           pic x(1).
  3772     02  eibfiller1       pic x(1).
  3773     02  eibfn            pic x(2).
  3774     02  eibfiller2       pic x(2).
  3775     02  eibrcode         pic x(6).
  3776     02  eibfiller3       pic x(2).
  3777     02  eibds            pic x(8).
  3778     02  eibreqid         pic x(8).
  3779     02  eibrsrce         pic x(8).
  3780     02  eibsync          pic x(1).
  3781     02  eibfree          pic x(1).
  3782     02  eibrecv          pic x(1).
  3783     02  eibsend          pic x(1).
  3784     02  eibatt           pic x(1).
  3785     02  eibeoc           pic x(1).
  3786     02  eibfmh           pic x(1).
  3787     02  eibcompl         pic x(1).
  3788     02  eibsig           pic x(1).
  3789     02  eibconf          pic x(1).
  3790     02  eiberr           pic x(1).
  3791     02  eibrldbk         pic x(1).
  3792     02  eiberrcd         pic x(4).
  3793     02  eibsynrb         pic x(1).
  3794     02  eibnodat         pic x(1).
  3795     02  eibfiller5       pic x(2).
  3796     02  eibresp          pic 9(09) comp.
  3797     02  eibresp2         pic 9(09) comp.
  3798     02  dfheigdj         pic s9(4) comp.
  3799     02  dfheigdk         pic s9(4) comp.
  3800 01  DFHCOMMAREA             PIC X(1024).
  3801
  3802*    COPY ELCMSTR.
  3803******************************************************************
  3804*                                                                *
  3805*                            ELCMSTR.                            *
  3806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3807*                            VMOD=2.012                          *
  3808*                                                                *
  3809*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3810*                                                                *
  3811*   FILE TYPE = VSAM,KSDS                                        *
  3812*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3813*                                                                *
  3814*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3815*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3816*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3817*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3818*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3819*                                                 RKP=75,LEN=21  *
  3820*                                                                *
  3821*   **** NOTE ****                                               *
  3822*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3823*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3824*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  75
* EL156.cbl
  3825*   LOG = YES                                                    *
  3826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3827******************************************************************
  3828*                   C H A N G E   L O G
  3829*
  3830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3831*-----------------------------------------------------------------
  3832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3833* EFFECTIVE    NUMBER
  3834*-----------------------------------------------------------------
  3835* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3836* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3837* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3838* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3839* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3840******************************************************************
  3841 01  CLAIM-MASTER.
  3842     12  CL-RECORD-ID                PIC XX.
  3843         88  VALID-CL-ID         VALUE 'CL'.
  3844
  3845     12  CL-CONTROL-PRIMARY.
  3846         16  CL-COMPANY-CD           PIC X.
  3847         16  CL-CARRIER              PIC X.
  3848         16  CL-CLAIM-NO             PIC X(7).
  3849         16  CL-CERT-NO.
  3850             20  CL-CERT-PRIME       PIC X(10).
  3851             20  CL-CERT-SFX         PIC X.
  3852
  3853     12  CL-CONTROL-BY-NAME.
  3854         16  CL-COMPANY-CD-A1        PIC X.
  3855         16  CL-INSURED-LAST-NAME    PIC X(15).
  3856         16  CL-INSURED-NAME.
  3857             20  CL-INSURED-1ST-NAME PIC X(12).
  3858             20  CL-INSURED-MID-INIT PIC X.
  3859
  3860     12  CL-CONTROL-BY-SSN.
  3861         16  CL-COMPANY-CD-A2        PIC X.
  3862         16  CL-SOC-SEC-NO.
  3863             20  CL-SSN-STATE        PIC XX.
  3864             20  CL-SSN-ACCOUNT      PIC X(6).
  3865             20  CL-SSN-LN3          PIC X(3).
  3866
  3867     12  CL-CONTROL-BY-CERT-NO.
  3868         16  CL-COMPANY-CD-A4        PIC X.
  3869         16  CL-CERT-NO-A4.
  3870             20  CL-CERT-A4-PRIME    PIC X(10).
  3871             20  CL-CERT-A4-SFX      PIC X.
  3872
  3873     12  CL-CONTROL-BY-CCN.
  3874         16  CL-COMPANY-CD-A5        PIC X.
  3875         16  CL-CCN-A5.
  3876             20  CL-CCN.
  3877                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3878                 24  CL-CCN-PRIME-A5 PIC X(12).
  3879             20  CL-CCN-FILLER-A5    PIC X(4).
  3880
  3881     12  CL-INSURED-PROFILE-DATA.
  3882         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  76
* EL156.cbl
  3883         16  CL-INSURED-SEX-CD       PIC X.
  3884             88  INSURED-IS-MALE        VALUE 'M'.
  3885             88  INSURED-IS-FEMALE      VALUE 'F'.
  3886             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3887         16  CL-INSURED-OCC-CD       PIC X(6).
  3888         16  FILLER                  PIC X(5).
  3889
  3890     12  CL-PROCESSING-INFO.
  3891         16  CL-PROCESSOR-ID         PIC X(4).
  3892         16  CL-CLAIM-STATUS         PIC X.
  3893             88  CLAIM-IS-OPEN          VALUE 'O'.
  3894             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3895         16  CL-CLAIM-TYPE           PIC X.
  3896*            88  AH-CLAIM               VALUE 'A'.
  3897*            88  LIFE-CLAIM             VALUE 'L'.
  3898*            88  PROPERTY-CLAIM         VALUE 'P'.
  3899*            88  IUI-CLAIM              VALUE 'I'.
  3900*            88  GAP-CLAIM              VALUE 'G'.
  3901*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3902         16  CL-CLAIM-PREM-TYPE      PIC X.
  3903             88  SINGLE-PREMIUM         VALUE '1'.
  3904             88  O-B-COVERAGE           VALUE '2'.
  3905             88  OPEN-END-COVERAGE      VALUE '3'.
  3906         16  CL-INCURRED-DT          PIC XX.
  3907         16  CL-REPORTED-DT          PIC XX.
  3908         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3909         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3910         16  CL-LAST-PMT-DT          PIC XX.
  3911         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3912         16  CL-PAID-THRU-DT         PIC XX.
  3913         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3914         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3915         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3916         16  CL-PMT-CALC-METHOD      PIC X.
  3917             88  CL-360-DAY-YR          VALUE '1'.
  3918             88  CL-365-DAY-YR          VALUE '2'.
  3919             88  CL-FULL-MONTHS         VALUE '3'.
  3920         16  CL-CAUSE-CD             PIC X(6).
  3921
  3922         16  CL-PRIME-CERT-NO.
  3923             20  CL-PRIME-CERT-PRIME PIC X(10).
  3924             20  CL-PRIME-CERT-SFX   PIC X.
  3925
  3926         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3927             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3928             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3929
  3930         16  CL-MICROFILM-NO         PIC X(10).
  3931         16  FILLER REDEFINES CL-MICROFILM-NO.
  3932             20  CL-BENEFIT-PERIOD   PIC 99.
  3933             20  FILLER              PIC X(8).
  3934         16  CL-PROG-FORM-TYPE       PIC X.
  3935         16  CL-LAST-ADD-ON-DT       PIC XX.
  3936
  3937         16  CL-LAST-REOPEN-DT       PIC XX.
  3938         16  CL-LAST-CLOSE-DT        PIC XX.
  3939         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3940             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  77
* EL156.cbl
  3941             88  CLAIM-DENIED           VALUE '2'.
  3942             88  AUTO-CLOSE             VALUE '3'.
  3943             88  MANUAL-CLOSE           VALUE '4'.
  3944             88  BENEFITS-CHANGED       VALUE 'C'.
  3945             88  SETUP-ERRORS           VALUE 'E'.
  3946         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3947         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3948         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3949             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3950         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3951         16  FILLER                  PIC X.
  3952
  3953     12  CL-CERTIFICATE-DATA.
  3954         16  CL-CERT-ORIGIN          PIC X.
  3955             88  CERT-WAS-ONLINE        VALUE '1'.
  3956             88  CERT-WAS-CREATED       VALUE '2'.
  3957             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3958         16  CL-CERT-KEY-DATA.
  3959             20  CL-CERT-CARRIER     PIC X.
  3960             20  CL-CERT-GROUPING    PIC X(6).
  3961             20  CL-CERT-STATE       PIC XX.
  3962             20  CL-CERT-ACCOUNT.
  3963                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3964                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3965             20  CL-CERT-EFF-DT      PIC XX.
  3966
  3967     12  CL-STATUS-CONTROLS.
  3968         16  CL-PRIORITY-CD          PIC X.
  3969             88  CONFIDENTIAL-DATA      VALUE '8'.
  3970             88  HIGHEST-PRIORITY       VALUE '9'.
  3971         16  CL-SUPV-ATTN-CD         PIC X.
  3972             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3973             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3974         16  CL-PURGED-DT            PIC XX.
  3975         16  CL-RESTORED-DT          PIC XX.
  3976         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3977         16  CL-NEXT-RESEND-DT       PIC XX.
  3978         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3979         16  CL-CRITICAL-PERIOD      PIC 99.
  3980*        16  FILLER                  PIC XX.
  3981         16  CL-LAST-MAINT-DT        PIC XX.
  3982         16  CL-LAST-MAINT-USER      PIC X(4).
  3983         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3984         16  CL-LAST-MAINT-TYPE      PIC X.
  3985             88  CLAIM-SET-UP           VALUE ' '.
  3986             88  PAYMENT-MADE           VALUE '1'.
  3987             88  LETTER-SENT            VALUE '2'.
  3988             88  MASTER-WAS-ALTERED     VALUE '3'.
  3989             88  MASTER-WAS-RESTORED    VALUE '4'.
  3990             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3991             88  FILE-CONVERTED         VALUE '6'.
  3992             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3993             88  ERROR-CORRECTION       VALUE 'E'.
  3994         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3995         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3996         16  CL-BENEFICIARY          PIC X(10).
  3997         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3998         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  78
* EL156.cbl
  3999             88  CL-TYPE-DENIAL          VALUE '1'.
  4000             88  CL-TYPE-RESCISSION      VALUE '2'.
  4001             88  CL-TYPE-REFORMATION     VALUE '3'.
  4002             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4003             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4004         16  filler                  pic x(5).
  4005*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4006*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4007*        16  CL-RTW-DT               PIC XX.
  4008
  4009     12  CL-TRAILER-CONTROLS.
  4010         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4011             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4012             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4013             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4014         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4015         16  FILLER                  PIC XX.
  4016         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4017         16  CL-ADDRESS-TRAILER-CNT.
  4018             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4019                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4020             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4021                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4022             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4023                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4024             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4025                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4026             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4027                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4028             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4029                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4030             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4031                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4032
  4033     12  CL-CV-REFERENCE-NO.
  4034         16  CL-CV-REFNO-PRIME       PIC X(18).
  4035         16  CL-CV-REFNO-SFX         PIC XX.
  4036
  4037     12  CL-FILE-LOCATION            PIC X(4).
  4038
  4039     12  CL-PROCESS-ERRORS.
  4040         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4041             88  NO-FATAL-ERRORS        VALUE ZERO.
  4042         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4043             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4044
  4045     12  CL-PRODUCT-CD               PIC X.
  4046
  4047     12  CL-CURRENT-KEY-DATA.
  4048         16  CL-CURRENT-CARRIER      PIC X.
  4049         16  CL-CURRENT-GROUPING     PIC X(6).
  4050         16  CL-CURRENT-STATE        PIC XX.
  4051         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4052
  4053     12  CL-ASSOCIATES               PIC X.
  4054         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4055         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4056         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  79
* EL156.cbl
  4057         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4058
  4059     12  CL-ACTIVITY-CODE            PIC 99.
  4060     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4061     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4062
  4063     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4064     12  CL-LAG-REPORT-CODE          PIC 9.
  4065     12  CL-LOAN-TYPE                PIC XX.
  4066     12  CL-LEGAL-STATE              PIC XX.
  4067
  4068     12  CL-YESNOSW                  PIC X.
  4069     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4070         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4071         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4072         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4073     12  cl-insured-type             pic x.
  4074         88  cl-claim-on-primary         value 'P'.
  4075         88  cl-claim-on-co-borrower     value 'C'.
  4076     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  80
* EL156.cbl
  4078*    COPY ELCCNTL.
  4079******************************************************************
  4080*                                                                *
  4081*                                                                *
  4082*                            ELCCNTL.                            *
  4083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4084*                            VMOD=2.059                          *
  4085*                                                                *
  4086*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4087*                                                                *
  4088*   FILE TYPE = VSAM,KSDS                                        *
  4089*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4090*                                                                *
  4091*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4092*       ALTERNATE INDEX = NONE                                   *
  4093*                                                                *
  4094*   LOG = YES                                                    *
  4095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4096******************************************************************
  4097*                   C H A N G E   L O G
  4098*
  4099* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4100*-----------------------------------------------------------------
  4101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4102* EFFECTIVE    NUMBER
  4103*-----------------------------------------------------------------
  4104* 082503                   PEMA  ADD BENEFIT GROUP
  4105* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4106* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4107* 092705    2005050300006  PEMA  ADD SPP LEASES
  4108* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4109* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4110* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4111* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4112* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4113* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4114* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4115* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4116* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4117* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4118******************************************************************
  4119*
  4120 01  CONTROL-FILE.
  4121     12  CF-RECORD-ID                       PIC XX.
  4122         88  VALID-CF-ID                        VALUE 'CF'.
  4123
  4124     12  CF-CONTROL-PRIMARY.
  4125         16  CF-COMPANY-ID                  PIC XXX.
  4126         16  CF-RECORD-TYPE                 PIC X.
  4127             88  CF-COMPANY-MASTER              VALUE '1'.
  4128             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4129             88  CF-STATE-MASTER                VALUE '3'.
  4130             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4131             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4132             88  CF-CARRIER-MASTER              VALUE '6'.
  4133             88  CF-MORTALITY-MASTER            VALUE '7'.
  4134             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4135             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  81
* EL156.cbl
  4136             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4137             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4138             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4139             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4140             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4141             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4142             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4143             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4144             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4145         16  CF-ACCESS-CD-GENL              PIC X(4).
  4146         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4147             20  CF-PROCESSOR               PIC X(4).
  4148         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4149             20  CF-STATE-CODE              PIC XX.
  4150             20  FILLER                     PIC XX.
  4151         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4152             20  FILLER                     PIC XX.
  4153             20  CF-HI-BEN-IN-REC           PIC XX.
  4154         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4155             20  FILLER                     PIC XXX.
  4156             20  CF-CARRIER-CNTL            PIC X.
  4157         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4158             20  FILLER                     PIC XX.
  4159             20  CF-HI-TYPE-IN-REC          PIC 99.
  4160         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4161             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4162                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4163             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4164             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4165         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4166             20  FILLER                     PIC X.
  4167             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4168         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4169             20  FILLER                     PIC XX.
  4170             20  CF-MORTGAGE-PLAN           PIC XX.
  4171         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4172
  4173     12  CF-LAST-MAINT-DT                   PIC XX.
  4174     12  CF-LAST-MAINT-BY                   PIC X(4).
  4175     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4176
  4177     12  CF-RECORD-BODY                     PIC X(728).
  4178
  4179
  4180****************************************************************
  4181*             COMPANY MASTER RECORD                            *
  4182****************************************************************
  4183
  4184     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4185         16  CF-COMPANY-ADDRESS.
  4186             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4187             20  CF-CL-IN-CARE-OF           PIC X(30).
  4188             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4189             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4190             20  CF-CL-CITY-STATE           PIC X(30).
  4191             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4192             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4193         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  82
* EL156.cbl
  4194         16  CF-COMPANY-PASSWORD            PIC X(8).
  4195         16  CF-SECURITY-OPTION             PIC X.
  4196             88  ALL-SECURITY                   VALUE '1'.
  4197             88  COMPANY-VERIFY                 VALUE '2'.
  4198             88  PROCESSOR-VERIFY               VALUE '3'.
  4199             88  NO-SECURITY                    VALUE '4'.
  4200             88  ALL-BUT-TERM                   VALUE '5'.
  4201         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4202             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4203         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4204             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4205         16  CF-INFORCE-LOCATION            PIC X.
  4206             88  CERTS-ARE-ONLINE               VALUE '1'.
  4207             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4208             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4209         16  CF-LOWER-CASE-LETTERS          PIC X.
  4210         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4211             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4212             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4213             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4214             88  CF-ACCNT-CNTL                  VALUE '3'.
  4215             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4216
  4217         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4218         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4219
  4220         16  CF-LGX-CREDIT-USER             PIC X.
  4221             88  CO-IS-NOT-USER                 VALUE 'N'.
  4222             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4223
  4224         16 CF-CREDIT-CALC-CODES.
  4225             20  CF-CR-REM-TERM-CALC PIC X.
  4226               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4227               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4228               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4229               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4230               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4231               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4232               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4233             20  CF-CR-R78-METHOD           PIC X.
  4234               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4235               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4236
  4237         16  CF-CLAIM-CONTROL-COUNTS.
  4238             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4239                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4240
  4241             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4242                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4243
  4244             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4245                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4246
  4247             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4248                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4249
  4250         16  CF-CURRENT-MONTH-END           PIC XX.
  4251
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  83
* EL156.cbl
  4252         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4253             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4254             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4255             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4256             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4257                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4258                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4259             20  CF-CO-PREM-REJECT-SW       PIC X.
  4260                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4261                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4262             20  CF-CO-REF-REJECT-SW        PIC X.
  4263                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4264                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4265
  4266         16  CF-CO-REPORTING-DT             PIC XX.
  4267         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4268         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4269           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4270           88  CF-CO-MONTH-END                  VALUE '1'.
  4271
  4272         16  CF-LGX-CLAIM-USER              PIC X.
  4273             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4274             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4275
  4276         16  CF-CREDIT-EDIT-CONTROLS.
  4277             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4278             20  CF-MIN-AGE                 PIC 99.
  4279             20  CF-DEFAULT-AGE             PIC 99.
  4280             20  CF-MIN-TERM                PIC S999      COMP-3.
  4281             20  CF-MAX-TERM                PIC S999      COMP-3.
  4282             20  CF-DEFAULT-SEX             PIC X.
  4283             20  CF-JOINT-AGE-INPUT         PIC X.
  4284                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4285             20  CF-BIRTH-DATE-INPUT        PIC X.
  4286                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4287             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4288                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4289                 88  CF-ZERO-CARRIER            VALUE '1'.
  4290                 88  CF-ZERO-GROUPING           VALUE '2'.
  4291                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4292             20  CF-EDIT-SW                 PIC X.
  4293                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4294             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4295             20  CF-CR-PR-METHOD            PIC X.
  4296               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4297               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4298             20  FILLER                     PIC X.
  4299
  4300         16  CF-CREDIT-MISC-CONTROLS.
  4301             20  CF-REIN-TABLE-SW           PIC X.
  4302                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4303             20  CF-COMP-TABLE-SW           PIC X.
  4304                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4305             20  CF-EXPERIENCE-RETENTION-AGE
  4306                                            PIC S9        COMP-3.
  4307             20  CF-CONVERSION-DT           PIC XX.
  4308             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4309             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  84
* EL156.cbl
  4310                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4311                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4312
  4313             20  CF-CR-CHECK-NO-CONTROL.
  4314                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4315                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4316                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4317                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4318                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4319                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4320
  4321                 24  CF-CR-CHECK-COUNT       REDEFINES
  4322                     CF-CR-CHECK-COUNTER      PIC X(4).
  4323
  4324                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4325                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4326
  4327                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4328                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4329                 24  CF-MAIL-PROCESSING       PIC X.
  4330                     88  MAIL-PROCESSING          VALUE 'Y'.
  4331
  4332         16  CF-MISC-SYSTEM-CONTROL.
  4333             20  CF-SYSTEM-C                 PIC X.
  4334                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4335             20  CF-SYSTEM-D                 PIC X.
  4336                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4337             20  CF-SOC-SEC-NO-SW            PIC X.
  4338                 88  SOC-SEC-NO-USED             VALUE '1'.
  4339             20  CF-MEMBER-NO-SW             PIC X.
  4340                 88  MEMBER-NO-USED              VALUE '1'.
  4341             20  CF-TAX-ID-NUMBER            PIC X(11).
  4342             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4343             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4344                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4345                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4346                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4347                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4348             20  CF-SYSTEM-E                 PIC X.
  4349                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4350
  4351         16  CF-LGX-LIFE-USER               PIC X.
  4352             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4353             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4354
  4355         16  CF-CR-MONTH-END-DT             PIC XX.
  4356
  4357         16  CF-FILE-MAINT-DATES.
  4358             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4359                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4360             20  CF-LAST-BATCH       REDEFINES
  4361                 CF-LAST-BATCH-NO               PIC X(4).
  4362             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4363             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4364             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4365             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4366             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4367             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  85
* EL156.cbl
  4368             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4369             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4370             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4371             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4372
  4373         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4374         16  FILLER                         PIC X.
  4375
  4376         16  CF-ALT-MORT-CODE               PIC X(4).
  4377         16  CF-MEMBER-CAPTION              PIC X(10).
  4378
  4379         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4380             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4381             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4382             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4383             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4384             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4385
  4386         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4387
  4388         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4389         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4390         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4391         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4392
  4393         16  CF-AH-OVERRIDE-L1              PIC X.
  4394         16  CF-AH-OVERRIDE-L2              PIC XX.
  4395         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4396         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4397
  4398         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4399         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4400
  4401         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4402         16  CF-AR-LAST-EL860-DT            PIC XX.
  4403         16  CF-MP-MONTH-END-DT             PIC XX.
  4404
  4405         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4406         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4407             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4408
  4409         16  CF-AR-MONTH-END-DT             PIC XX.
  4410
  4411         16  CF-CRDTCRD-USER                PIC X.
  4412             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4413             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4414
  4415         16  CF-CC-MONTH-END-DT             PIC XX.
  4416
  4417         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4418
  4419         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4420             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4421             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4422             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4423         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4424         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4425         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  86
* EL156.cbl
  4426         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4427             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4428             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4429         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4430         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4431         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4432             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4433         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4434
  4435         16  CF-CL-ZIP-CODE.
  4436             20  CF-CL-ZIP-PRIME.
  4437                 24  CF-CL-ZIP-1ST          PIC X.
  4438                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4439                 24  FILLER                 PIC X(4).
  4440             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4441         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4442             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4443             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4444             20  FILLER                     PIC XXX.
  4445
  4446         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4447         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4448         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4449         16  CF-CO-OPTION-START-DATE        PIC XX.
  4450         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4451           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4452                                                      '3' '4'.
  4453           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4454           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4455           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4456           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4457           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4458           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4459
  4460         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4461
  4462         16  CF-PAYMENT-APPROVAL-LEVELS.
  4463             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4464             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4465             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4466             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4467             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4468             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4469
  4470         16  CF-END-USER-REPORTING-USER     PIC X.
  4471             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4472             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4473
  4474         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4475             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4476             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4477
  4478         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4479
  4480         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4481         16  FILLER                         PIC X.
  4482
  4483         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  87
* EL156.cbl
  4484             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4485             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4486             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4487
  4488         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4489
  4490         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4491             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4492             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4493
  4494         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4495             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4496             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4497
  4498         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4499
  4500         16  CF-CO-ACH-ID-CODE              PIC  X.
  4501             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4502             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4503             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4504         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4505         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4506         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4507         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4508         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4509         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4510         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4511         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4512         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4513                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4514         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4515                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4516
  4517         16  CF-CO-OVER-SHORT.
  4518             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4519             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4520
  4521*         16  FILLER                         PIC X(102).
  4522         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4523             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4524             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4525
  4526         16  CF-AH-APPROVAL-DAYS.
  4527             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4528             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4529             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4530             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4531
  4532         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4533
  4534         16  CF-APPROV-LEV-5.
  4535             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4536             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4537             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4538
  4539         16  FILLER                         PIC X(68).
  4540****************************************************************
  4541*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  88
* EL156.cbl
  4542****************************************************************
  4543
  4544     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4545         16  CF-PROCESSOR-NAME              PIC X(30).
  4546         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4547         16  CF-PROCESSOR-TITLE             PIC X(26).
  4548         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4549                 88  MESSAGE-YES                VALUE 'Y'.
  4550                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4551
  4552*****************************************************
  4553****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4554****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4555****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4556****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4557*****************************************************
  4558
  4559         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4560             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4561             20  CF-APPLICATION-FORCE       PIC X.
  4562             20  CF-INDIVIDUAL-APP.
  4563                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4564                     28  CF-BROWSE-APP      PIC X.
  4565                     28  CF-UPDATE-APP      PIC X.
  4566
  4567         16  CF-CURRENT-TERM-ON             PIC X(4).
  4568         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4569             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4570             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4571             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4572             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4573             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4574             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4575             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4576         16  CF-PROCESSOR-CARRIER           PIC X.
  4577             88  NO-CARRIER-SECURITY            VALUE ' '.
  4578         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4579             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4580         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4581             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4582         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4583             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4584
  4585         16  CF-PROC-SYS-ACCESS-SW.
  4586             20  CF-PROC-CREDIT-CLAIMS-SW.
  4587                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4588                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4589                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4590                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4591             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4592                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4593                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4594             20  CF-PROC-LIFE-GNRLDGR-SW.
  4595                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4596                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4597                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4598                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4599             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  89
* EL156.cbl
  4600                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4601                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4602         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4603             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4604             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4605         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4606
  4607         16  CF-APPROVAL-LEVEL                  PIC X.
  4608             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4609             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4610             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4611             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4612             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4613
  4614         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4615
  4616         16  CF-LANGUAGE-TYPE                   PIC X.
  4617             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4618             88  CF-LANG-IS-FR                      VALUE 'F'.
  4619
  4620         16  CF-CSR-IND                         PIC X.
  4621         16  FILLER                             PIC X(239).
  4622
  4623****************************************************************
  4624*             PROCESSOR/REMINDERS RECORD                       *
  4625****************************************************************
  4626
  4627     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4628         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4629             20  CF-START-REMIND-DT         PIC XX.
  4630             20  CF-END-REMIND-DT           PIC XX.
  4631             20  CF-REMINDER-TEXT           PIC X(50).
  4632         16  FILLER                         PIC X(296).
  4633
  4634
  4635****************************************************************
  4636*             STATE MASTER RECORD                              *
  4637****************************************************************
  4638
  4639     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4640         16  CF-STATE-ABBREVIATION          PIC XX.
  4641         16  CF-STATE-NAME                  PIC X(25).
  4642         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4643         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4644             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4645             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4646             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4647             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4648                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4649                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4650             20  CF-ST-PREM-REJECT-SW       PIC X.
  4651                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4652                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4653             20  CF-ST-REF-REJECT-SW        PIC X.
  4654                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4655                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4656         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4657         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  90
* EL156.cbl
  4658         16  CF-ST-REFUND-RULES.
  4659             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4660             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4661             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4662         16  CF-ST-FST-PMT-EXTENSION.
  4663             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4664             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4665                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4666                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4667                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4668                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4669         16  CF-ST-STATE-CALL.
  4670             20  CF-ST-CALL-UNEARNED        PIC X.
  4671             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4672             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4673         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4674             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4675             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4676         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4677         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4678         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4679         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4680         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4681         16  FILLER                         PIC X.
  4682         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4683             20  CF-ST-BENEFIT-CD           PIC XX.
  4684             20  CF-ST-BENEFIT-KIND         PIC X.
  4685                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4686                 88  CF-ST-AH-KIND              VALUE 'A'.
  4687             20  CF-ST-REM-TERM-CALC        PIC X.
  4688                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4689                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4690                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4691                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4692                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4693                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4694                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4695                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4696
  4697             20  CF-ST-REFUND-CALC          PIC X.
  4698                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4699                 88  ST-REFD-BY-R78             VALUE '1'.
  4700                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4701                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4702                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4703                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4704                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4705                 88  ST-REFD-UTAH               VALUE '7'.
  4706                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4707                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4708                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4709
  4710             20  CF-ST-EARNING-CALC         PIC X.
  4711                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4712                 88  ST-EARN-BY-R78             VALUE '1'.
  4713                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4714                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4715                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  91
* EL156.cbl
  4716                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4717                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4718                 88  ST-EARN-MEAN               VALUE '8'.
  4719                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4720
  4721             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4722                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4723                 88  ST-OVRD-BY-R78             VALUE '1'.
  4724                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4725                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4726                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4727                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4728                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4729                 88  ST-OVRD-MEAN               VALUE '8'.
  4730                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4731             20  FILLER                     PIC X.
  4732
  4733         16  CF-ST-COMMISSION-CAPS.
  4734             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4735             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4736             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4737             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4738         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4739                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4740
  4741         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4742
  4743         16  CF-ST-STATUTORY-INTEREST.
  4744             20  CF-ST-STAT-DATE-FROM       PIC X.
  4745                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4746                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4747             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4748             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4749             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4750             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4751             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4752
  4753         16  CF-ST-OVER-SHORT.
  4754             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4755             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4756
  4757         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4758
  4759         16  CF-ST-RT-CALC                  PIC X.
  4760
  4761         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4762         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4763         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4764         16  CF-ST-RF-LR-CALC               PIC X.
  4765         16  CF-ST-RF-LL-CALC               PIC X.
  4766         16  CF-ST-RF-LN-CALC               PIC X.
  4767         16  CF-ST-RF-AH-CALC               PIC X.
  4768         16  CF-ST-RF-CP-CALC               PIC X.
  4769*        16  FILLER                         PIC X(206).
  4770*CIDMOD         16  FILLER                         PIC X(192).
  4771         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4772             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4773         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  92
* EL156.cbl
  4774         16  CF-ST-VFY-2ND-BENE             PIC X.
  4775         16  CF-ST-CAUSAL-STATE             PIC X.
  4776         16  FILLER                         PIC X(185).
  4777
  4778****************************************************************
  4779*             BENEFIT MASTER RECORD                            *
  4780****************************************************************
  4781
  4782     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4783         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4784             20  CF-BENEFIT-CODE            PIC XX.
  4785             20  CF-BENEFIT-NUMERIC  REDEFINES
  4786                 CF-BENEFIT-CODE            PIC XX.
  4787             20  CF-BENEFIT-ALPHA           PIC XXX.
  4788             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4789             20  CF-BENEFIT-COMMENT         PIC X(10).
  4790
  4791             20  CF-LF-COVERAGE-TYPE        PIC X.
  4792                 88  CF-REDUCING                VALUE 'R'.
  4793                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4794
  4795             20  CF-SPECIAL-CALC-CD         PIC X.
  4796                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4797                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4798                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4799                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4800                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4801                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4802                 88  CF-FARM-PLAN               VALUE 'F'.
  4803                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4804                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4805                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4806                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4807                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4808                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4809                 88  CF-PRUDENTIAL              VALUE 'P'.
  4810                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4811                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4812                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4813                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4814                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4815                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4816
  4817             20  CF-JOINT-INDICATOR         PIC X.
  4818                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4819
  4820*            20  FILLER                     PIC X(12).
  4821             20  cf-maximum-benefits        pic s999 comp-3.
  4822             20  FILLER                     PIC X(09).
  4823             20  CF-BENEFIT-CATEGORY        PIC X.
  4824             20  CF-LOAN-TYPE               PIC X(8).
  4825
  4826             20  CF-CO-REM-TERM-CALC        PIC X.
  4827                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4828                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4829                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4830                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4831                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  93
* EL156.cbl
  4832
  4833             20  CF-CO-EARNINGS-CALC        PIC X.
  4834                 88  CO-EARN-BY-R78             VALUE '1'.
  4835                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4836                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4837                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4838                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4839                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4840                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4841                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4842
  4843             20  CF-CO-REFUND-CALC          PIC X.
  4844                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4845                 88  CO-REFD-BY-R78             VALUE '1'.
  4846                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4847                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4848                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4849                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4850                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4851                 88  CO-REFD-MEAN               VALUE '8'.
  4852                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4853                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4854                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4855
  4856             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4857                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4858                 88  CO-OVRD-BY-R78             VALUE '1'.
  4859                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4860                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4861                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4862                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4863                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4864                 88  CO-OVRD-MEAN               VALUE '8'.
  4865                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4866
  4867             20  CF-CO-BEN-I-G-CD           PIC X.
  4868                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4869                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4870                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4871
  4872         16  FILLER                         PIC X(304).
  4873
  4874
  4875****************************************************************
  4876*             CARRIER MASTER RECORD                            *
  4877****************************************************************
  4878
  4879     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4880         16  CF-ADDRESS-DATA.
  4881             20  CF-MAIL-TO-NAME            PIC X(30).
  4882             20  CF-IN-CARE-OF              PIC X(30).
  4883             20  CF-ADDRESS-LINE-1          PIC X(30).
  4884             20  CF-ADDRESS-LINE-2          PIC X(30).
  4885             20  CF-CITY-STATE              PIC X(30).
  4886             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4887             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4888
  4889         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  94
* EL156.cbl
  4890             20  CF-CLAIM-NO-METHOD         PIC X.
  4891                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4892                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4893                 88  CLAIM-NO-SEQ               VALUE '3'.
  4894                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4895             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4896                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4897                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4898                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4899
  4900         16  CF-CHECK-NO-CONTROL.
  4901             20  CF-CHECK-NO-METHOD         PIC X.
  4902                 88  CHECK-NO-MANUAL            VALUE '1'.
  4903                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4904                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4905                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4906             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4907                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4908
  4909         16  CF-DOMICILE-STATE              PIC XX.
  4910
  4911         16  CF-EXPENSE-CONTROLS.
  4912             20  CF-EXPENSE-METHOD          PIC X.
  4913                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4914                 88  DOLLARS-PER-PMT            VALUE '2'.
  4915                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4916                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4917             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4918             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4919
  4920         16  CF-CORRESPONDENCE-CONTROL.
  4921             20  CF-LETTER-RESEND-OPT       PIC X.
  4922                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4923                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4924             20  FILLER                     PIC X(4).
  4925
  4926         16  CF-RESERVE-CONTROLS.
  4927             20  CF-MANUAL-SW               PIC X.
  4928                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4929             20  CF-FUTURE-SW               PIC X.
  4930                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4931             20  CF-PTC-SW                  PIC X.
  4932                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4933             20  CF-IBNR-SW                 PIC X.
  4934                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4935             20  CF-PTC-LF-SW               PIC X.
  4936                 88  CF-LF-PTC-USED             VALUE '1'.
  4937             20  CF-CDT-ACCESS-METHOD       PIC X.
  4938                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4939                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4940                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4941             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4942
  4943         16  CF-CLAIM-CALC-METHOD           PIC X.
  4944             88  360-PLUS-MONTHS                VALUE '1'.
  4945             88  365-PLUS-MONTHS                VALUE '2'.
  4946             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4947             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  95
* EL156.cbl
  4948             88  365-DAILY                      VALUE '5'.
  4949
  4950         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4951         16  FILLER                         PIC X(11).
  4952
  4953         16  CF-LIMIT-AMOUNTS.
  4954             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4955             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4956             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4957             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4958             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4959             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4960             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4961             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4962             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4963             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4964
  4965         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4966         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4967         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4968
  4969         16  CF-ZIP-CODE.
  4970             20  CF-ZIP-PRIME.
  4971                 24  CF-ZIP-1ST             PIC X.
  4972                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4973                 24  FILLER                 PIC X(4).
  4974             20  CF-ZIP-PLUS4               PIC X(4).
  4975         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4976             20  CF-CAN-POSTAL-1            PIC XXX.
  4977             20  CF-CAN-POSTAL-2            PIC XXX.
  4978             20  FILLER                     PIC XXX.
  4979
  4980         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4981         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4982         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4983
  4984         16  CF-RATING-SWITCH               PIC X.
  4985             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4986             88  CF-NO-RATING                   VALUE 'N'.
  4987
  4988         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4989
  4990         16  CF-CARRIER-OVER-SHORT.
  4991             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4992             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4993
  4994         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4995         16  CF-SECPAY-SWITCH               PIC X.
  4996             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4997             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4998         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4999         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5000         16  FILLER                         PIC X(444).
  5001*        16  FILLER                         PIC X(452).
  5002
  5003
  5004****************************************************************
  5005*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  96
* EL156.cbl
  5006****************************************************************
  5007
  5008     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5009         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5010                                INDEXED BY CF-MORT-NDX.
  5011             20  CF-MORT-TABLE              PIC X(5).
  5012             20  CF-MORT-TABLE-TYPE         PIC X.
  5013                 88  CF-MORT-JOINT              VALUE 'J'.
  5014                 88  CF-MORT-SINGLE             VALUE 'S'.
  5015                 88  CF-MORT-COMBINED           VALUE 'C'.
  5016                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5017                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5018             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5019             20  CF-MORT-AGE-METHOD         PIC XX.
  5020                 88  CF-AGE-LAST                VALUE 'AL'.
  5021                 88  CF-AGE-NEAR                VALUE 'AN'.
  5022             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5023             20  CF-MORT-ADJUSTMENT-DIRECTION
  5024                                            PIC X.
  5025                 88  CF-MINUS                   VALUE '-'.
  5026                 88  CF-PLUS                    VALUE '+'.
  5027             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5028             20  CF-MORT-JOINT-CODE         PIC X.
  5029                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5030             20  CF-MORT-PC-Q               PIC X.
  5031                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5032             20  CF-MORT-TABLE-CODE         PIC X(4).
  5033             20  CF-MORT-COMMENTS           PIC X(15).
  5034             20  FILLER                     PIC X(14).
  5035
  5036         16  FILLER                         PIC X(251).
  5037
  5038
  5039****************************************************************
  5040*             BUSSINESS TYPE MASTER RECORD                     *
  5041****************************************************************
  5042
  5043     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5044* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5045* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5046* AND RECORD 05 IS TYPES 81-99
  5047         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5048             20  CF-BUSINESS-TITLE          PIC  X(19).
  5049             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5050                                            PIC S9V9(4) COMP-3.
  5051             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5052             20  FILLER                     PIC  X.
  5053         16  FILLER                         PIC  X(248).
  5054
  5055
  5056****************************************************************
  5057*             TERMINAL MASTER RECORD                           *
  5058****************************************************************
  5059
  5060     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5061
  5062         16  CF-COMPANY-TERMINALS.
  5063             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  97
* EL156.cbl
  5064                                  PIC X(4).
  5065         16  FILLER               PIC X(248).
  5066
  5067
  5068****************************************************************
  5069*             LIFE EDIT MASTER RECORD                          *
  5070****************************************************************
  5071
  5072     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5073         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5074             20  CF-LIFE-CODE-IN            PIC XX.
  5075             20  CF-LIFE-CODE-OUT           PIC XX.
  5076         16  FILLER                         PIC X(248).
  5077
  5078
  5079****************************************************************
  5080*             AH EDIT MASTER RECORD                            *
  5081****************************************************************
  5082
  5083     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5084         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5085             20  CF-AH-CODE-IN              PIC XXX.
  5086             20  CF-AH-CODE-OUT             PIC XX.
  5087         16  FILLER                         PIC X(248).
  5088
  5089
  5090****************************************************************
  5091*             CREDIBILITY TABLES                               *
  5092****************************************************************
  5093
  5094     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5095         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5096                             INDEXED BY CF-CRDB-NDX.
  5097             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5098             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5099             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5100         16  FILLER                         PIC  X(332).
  5101
  5102
  5103****************************************************************
  5104*             REPORT CUSTOMIZATION RECORD                      *
  5105****************************************************************
  5106
  5107     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5108         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5109             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5110             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5111             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5112**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5113****       A T-TRANSFER.                                   ****
  5114             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5115
  5116         16  FILLER                         PIC XX.
  5117
  5118         16  CF-CARRIER-CNTL-OPT.
  5119             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5120                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5121                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  98
* EL156.cbl
  5122             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5123                                            PIC X.
  5124         16  CF-GROUP-CNTL-OPT.
  5125             20  CF-GROUP-OPT-SEQ           PIC 9.
  5126                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5127                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5128             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5129                                            PIC X(6).
  5130         16  CF-STATE-CNTL-OPT.
  5131             20  CF-STATE-OPT-SEQ           PIC 9.
  5132                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5133                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5134             20  CF-STATE-SELECT OCCURS 3 TIMES
  5135                                            PIC XX.
  5136         16  CF-ACCOUNT-CNTL-OPT.
  5137             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5138                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5139                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5140             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5141                                            PIC X(10).
  5142         16  CF-BUS-TYP-CNTL-OPT.
  5143             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5144                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5145                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5146             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5147                                            PIC XX.
  5148         16  CF-LF-TYP-CNTL-OPT.
  5149             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5150                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5151                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5152             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5153                                            PIC XX.
  5154         16  CF-AH-TYP-CNTL-OPT.
  5155             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5156                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5157                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5158             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5159                                            PIC XX.
  5160         16  CF-REPTCD1-CNTL-OPT.
  5161             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5162                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5163                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5164             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5165                                            PIC X(10).
  5166         16  CF-REPTCD2-CNTL-OPT.
  5167             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5168                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5169                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5170             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5171                                            PIC X(10).
  5172         16  CF-USER1-CNTL-OPT.
  5173             20  CF-USER1-OPT-SEQ           PIC 9.
  5174                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5175                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5176             20  CF-USER1-SELECT OCCURS 3 TIMES
  5177                                            PIC X(10).
  5178         16  CF-USER2-CNTL-OPT.
  5179             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  99
* EL156.cbl
  5180                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5181                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5182             20  CF-USER2-SELECT OCCURS 3 TIMES
  5183                                            PIC X(10).
  5184         16  CF-USER3-CNTL-OPT.
  5185             20  CF-USER3-OPT-SEQ           PIC 9.
  5186                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5187                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5188             20  CF-USER3-SELECT OCCURS 3 TIMES
  5189                                            PIC X(10).
  5190         16  CF-USER4-CNTL-OPT.
  5191             20  CF-USER4-OPT-SEQ           PIC 9.
  5192                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5193                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5194             20  CF-USER4-SELECT OCCURS 3 TIMES
  5195                                            PIC X(10).
  5196         16  CF-USER5-CNTL-OPT.
  5197             20  CF-USER5-OPT-SEQ           PIC 9.
  5198                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5199                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5200             20  CF-USER5-SELECT OCCURS 3 TIMES
  5201                                            PIC X(10).
  5202         16  CF-REINS-CNTL-OPT.
  5203             20  CF-REINS-OPT-SEQ           PIC 9.
  5204                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5205                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5206             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5207                 24  CF-REINS-PRIME         PIC XXX.
  5208                 24  CF-REINS-SUB           PIC XXX.
  5209
  5210         16  CF-AGENT-CNTL-OPT.
  5211             20  CF-AGENT-OPT-SEQ           PIC 9.
  5212                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5213                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5214             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5215                                            PIC X(10).
  5216
  5217         16  FILLER                         PIC X(43).
  5218
  5219         16  CF-LOSS-RATIO-SELECT.
  5220             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5221             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5222         16  CF-ENTRY-DATE-SELECT.
  5223             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5224             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5225         16  CF-EFFECTIVE-DATE-SELECT.
  5226             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5227             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5228
  5229         16  CF-EXCEPTION-LIST-IND          PIC X.
  5230             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5231
  5232         16  FILLER                         PIC X(318).
  5233
  5234****************************************************************
  5235*                  EXCEPTION REPORTING RECORD                  *
  5236****************************************************************
  5237
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 100
* EL156.cbl
  5238     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5239         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5240             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5241
  5242         16  CF-COMBINED-LIFE-AH-OPT.
  5243             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5244             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5245             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5246             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5247
  5248         16  CF-LIFE-OPT.
  5249             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5250             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5251             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5252             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5253             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5254             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5255             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5256             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5257             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5258             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5259
  5260         16  CF-AH-OPT.
  5261             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5262             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5263             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5264             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5265             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5266             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5267             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5268             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5269             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5270             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5271
  5272         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5273             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5274             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5275             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5276
  5277         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5278
  5279         16  FILLER                         PIC X(673).
  5280
  5281
  5282****************************************************************
  5283*             MORTGAGE SYSTEM PLAN RECORD                      *
  5284****************************************************************
  5285
  5286     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5287         16  CF-PLAN-TYPE                   PIC X.
  5288             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5289             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5290             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5291         16  CF-PLAN-ABBREV                 PIC XXX.
  5292         16  CF-PLAN-DESCRIPT               PIC X(10).
  5293         16  CF-PLAN-NOTES                  PIC X(20).
  5294         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5295         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 101
* EL156.cbl
  5296             20  CF-PLAN-TERM-DATA.
  5297                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5298                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5299             20  CF-PLAN-AGE-DATA.
  5300                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5301                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5302                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5303             20  CF-PLAN-BENEFIT-DATA.
  5304                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5305                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5306                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5307                                            PIC S9(7)V99  COMP-3.
  5308         16  CF-PLAN-POLICY-FORMS.
  5309             20  CF-POLICY-FORM             PIC X(12).
  5310             20  CF-MASTER-APPLICATION      PIC X(12).
  5311             20  CF-MASTER-POLICY           PIC X(12).
  5312         16  CF-PLAN-RATING.
  5313             20  CF-RATE-CODE               PIC X(5).
  5314             20  CF-SEX-RATING              PIC X.
  5315                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5316                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5317             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5318             20  CF-SUB-STD-TYPE            PIC X.
  5319                 88  CF-PCT-OF-PREM            VALUE '1'.
  5320                 88  CF-PCT-OF-BENE            VALUE '2'.
  5321         16  CF-PLAN-PREM-TOLERANCES.
  5322             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5323             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5324         16  CF-PLAN-PYMT-TOLERANCES.
  5325             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5326             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5327         16  CF-PLAN-MISC-DATA.
  5328             20  FILLER                     PIC X.
  5329             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5330             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5331         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5332         16  CF-PLAN-IND-GRP                PIC X.
  5333             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5334                                                     '1'.
  5335             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5336                                                     '2'.
  5337         16  CF-MIB-SEARCH-SW               PIC X.
  5338             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5339             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5340             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5341             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5342         16  CF-ALPHA-SEARCH-SW             PIC X.
  5343             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5344             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5345             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5346             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5347             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5348             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5349             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5350             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5351             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5352             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5353                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 102
* EL156.cbl
  5354                                                     'X' 'Y' 'Z'.
  5355         16  CF-EFF-DT-RULE-SW              PIC X.
  5356             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5357             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5358             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5359             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5360             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5361         16  FILLER                         PIC X(4).
  5362         16  CF-HEALTH-QUESTIONS            PIC X.
  5363             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5364         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5365         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5366         16  CF-PLAN-SNGL-JNT               PIC X.
  5367             88  CF-COMBINED-PLAN              VALUE 'C'.
  5368             88  CF-JNT-PLAN                   VALUE 'J'.
  5369             88  CF-SNGL-PLAN                  VALUE 'S'.
  5370         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5371         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5372         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5373         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5374         16  CF-RERATE-CNTL                 PIC  X.
  5375             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5376             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5377             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5378             88  CF-AUTO-RECALC                 VALUE '4'.
  5379         16  CF-BENEFIT-TYPE                PIC  X.
  5380             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5381             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5382         16  CF-POLICY-FEE                  PIC S999V99
  5383                                                    COMP-3.
  5384         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5385         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5386         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5387         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5388         16  FILLER                         PIC  X(32).
  5389         16  CF-TERMINATION-FORM            PIC  X(04).
  5390         16  FILLER                         PIC  X(08).
  5391         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5392                                                       COMP-3.
  5393         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5394         16  CF-ISSUE-LETTER                PIC  X(4).
  5395         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5396         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5397             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5398             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5399         16  CF-MP-REFUND-CALC              PIC X.
  5400             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5401             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5402             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5403             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5404             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5405             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5406             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5407             88  CF-MP-REFD-MEAN                VALUE '8'.
  5408         16  CF-ALT-RATE-CODE               PIC  X(5).
  5409
  5410
  5411         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 103
* EL156.cbl
  5412****************************************************************
  5413*             MORTGAGE COMPANY MASTER RECORD                   *
  5414****************************************************************
  5415
  5416     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5417         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5418         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5419             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5420             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5421             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5422             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5423             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5424
  5425         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5426         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5427         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5428         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5429         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5430
  5431         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5432             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5433         16  CF-MP-RECON-USE-IND            PIC X(1).
  5434             88  CF-MP-USE-RECON             VALUE 'Y'.
  5435         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5436             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5437         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5438             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5439             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5440         16  FILLER                         PIC X(1).
  5441         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5442             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5443         16  CF-MORTG-MIB-VERSION           PIC X.
  5444             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5445             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5446             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5447         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5448             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5449                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5450             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5451                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5452             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5453                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5454             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5455                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5456             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5457                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5458             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5459                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5460         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5461         16  FILLER                         PIC X(7).
  5462         16  CF-MORTG-DESTINATION-SYMBOL.
  5463             20  CF-MORTG-MIB-COMM          PIC X(5).
  5464             20  CF-MORTG-MIB-TERM          PIC X(5).
  5465         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5466             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5467         16  FILLER                         PIC X(03).
  5468         16  CF-MP-CHECK-NO-CONTROL.
  5469             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 104
* EL156.cbl
  5470                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5471                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5472                                                ' ' LOW-VALUES.
  5473                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5474                                               VALUE '3'.
  5475         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5476         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5477         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5478             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5479                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5480             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5481                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5482             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5483                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5484             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5485                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5486             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5487                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5488             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5489                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5490         16  CF-MORTG-BILLING-AREA.
  5491             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5492                                            PIC X.
  5493         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5494         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5495         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5496         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5497             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5498             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5499         16  FILLER                         PIC X.
  5500         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5501             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5502             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5503         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5504         16  FILLER                         PIC X(8).
  5505         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5506         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5507         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5508         16  CF-ACH-COMPANY-ID.
  5509             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5510                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5511                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5512                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5513             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5514         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5515             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5516         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5517             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5518             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5519         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5520         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5521         16  FILLER                         PIC X(536).
  5522
  5523****************************************************************
  5524*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5525****************************************************************
  5526
  5527     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 105
* EL156.cbl
  5528         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5529             20  CF-FEMALE-HEIGHT.
  5530                 24  CF-FEMALE-FT           PIC 99.
  5531                 24  CF-FEMALE-IN           PIC 99.
  5532             20  CF-FEMALE-MIN-WT           PIC 999.
  5533             20  CF-FEMALE-MAX-WT           PIC 999.
  5534         16  FILLER                         PIC X(428).
  5535
  5536     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5537         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5538             20  CF-MALE-HEIGHT.
  5539                 24  CF-MALE-FT             PIC 99.
  5540                 24  CF-MALE-IN             PIC 99.
  5541             20  CF-MALE-MIN-WT             PIC 999.
  5542             20  CF-MALE-MAX-WT             PIC 999.
  5543         16  FILLER                         PIC X(428).
  5544******************************************************************
  5545*             AUTOMATIC ACTIVITY RECORD                          *
  5546******************************************************************
  5547     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5548         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5549             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5550             20  CF-SYS-LETTER-ID           PIC X(04).
  5551             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5552             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5553             20  CF-SYS-RESET-SW            PIC X(01).
  5554             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5555             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5556
  5557         16  FILLER                         PIC X(50).
  5558
  5559         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5560             20  CF-USER-ACTIVE-SW          PIC X(01).
  5561             20  CF-USER-LETTER-ID          PIC X(04).
  5562             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5563             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5564             20  CF-USER-RESET-SW           PIC X(01).
  5565             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5566             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5567             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5568
  5569         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 106
* EL156.cbl
  5571*    COPY ELCCERT.
  5572******************************************************************
  5573*                                                                *
  5574*                            ELCCERT.                            *
  5575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5576*                            VMOD=2.013                          *
  5577*                                                                *
  5578*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5579*                                                                *
  5580*   FILE TYPE = VSAM,KSDS                                        *
  5581*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5582*                                                                *
  5583*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5584*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5585*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5586*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5587*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5588*                                                                *
  5589*   LOG = YES                                                    *
  5590*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5591******************************************************************
  5592*                   C H A N G E   L O G
  5593*
  5594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5595*-----------------------------------------------------------------
  5596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5597* EFFECTIVE    NUMBER
  5598*-----------------------------------------------------------------
  5599* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5600* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5601* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5602* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5603* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5604* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5605* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5606* 032612  CR2011110200001  PEMA  AHL CHANGES
  5607* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5608******************************************************************
  5609
  5610 01  CERTIFICATE-MASTER.
  5611     12  CM-RECORD-ID                      PIC XX.
  5612         88  VALID-CM-ID                      VALUE 'CM'.
  5613
  5614     12  CM-CONTROL-PRIMARY.
  5615         16  CM-COMPANY-CD                 PIC X.
  5616         16  CM-CARRIER                    PIC X.
  5617         16  CM-GROUPING.
  5618             20  CM-GROUPING-PREFIX        PIC X(3).
  5619             20  CM-GROUPING-PRIME         PIC X(3).
  5620         16  CM-STATE                      PIC XX.
  5621         16  CM-ACCOUNT.
  5622             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5623             20  CM-ACCOUNT-PRIME          PIC X(6).
  5624         16  CM-CERT-EFF-DT                PIC XX.
  5625         16  CM-CERT-NO.
  5626             20  CM-CERT-PRIME             PIC X(10).
  5627             20  CM-CERT-SFX               PIC X.
  5628
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 107
* EL156.cbl
  5629     12  CM-CONTROL-BY-NAME.
  5630         16  CM-COMPANY-CD-A1              PIC X.
  5631         16  CM-INSURED-LAST-NAME          PIC X(15).
  5632         16  CM-INSURED-INITIALS.
  5633             20  CM-INSURED-INITIAL1       PIC X.
  5634             20  CM-INSURED-INITIAL2       PIC X.
  5635
  5636     12  CM-CONTROL-BY-SSN.
  5637         16  CM-COMPANY-CD-A2              PIC X.
  5638         16  CM-SOC-SEC-NO.
  5639             20  CM-SSN-STATE              PIC XX.
  5640             20  CM-SSN-ACCOUNT            PIC X(6).
  5641             20  CM-SSN-LN3.
  5642                 25  CM-INSURED-INITIALS-A2.
  5643                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5644                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5645                 25 CM-PART-LAST-NAME-A2         PIC X.
  5646
  5647     12  CM-CONTROL-BY-CERT-NO.
  5648         16  CM-COMPANY-CD-A4              PIC X.
  5649         16  CM-CERT-NO-A4                 PIC X(11).
  5650
  5651     12  CM-CONTROL-BY-MEMB.
  5652         16  CM-COMPANY-CD-A5              PIC X.
  5653         16  CM-MEMBER-NO.
  5654             20  CM-MEMB-STATE             PIC XX.
  5655             20  CM-MEMB-ACCOUNT           PIC X(6).
  5656             20  CM-MEMB-LN4.
  5657                 25  CM-INSURED-INITIALS-A5.
  5658                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5659                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5660                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5661
  5662     12  CM-INSURED-PROFILE-DATA.
  5663         16  CM-INSURED-FIRST-NAME.
  5664             20  CM-INSURED-1ST-INIT       PIC X.
  5665             20  FILLER                    PIC X(9).
  5666         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5667         16  CM-INSURED-SEX                PIC X.
  5668             88  CM-SEX-MALE                  VALUE 'M'.
  5669             88  CM-SEX-FEMAL                 VALUE 'F'.
  5670         16  CM-INSURED-JOINT-AGE          PIC 99.
  5671         16  CM-JOINT-INSURED-NAME.
  5672             20  CM-JT-LAST-NAME           PIC X(15).
  5673             20  CM-JT-FIRST-NAME.
  5674                 24  CM-JT-1ST-INIT        PIC X.
  5675                 24  FILLER                PIC X(9).
  5676             20  CM-JT-INITIAL             PIC X.
  5677
  5678     12  CM-LIFE-DATA.
  5679         16  CM-LF-BENEFIT-CD              PIC XX.
  5680         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5681         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5682         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5683         16  CM-LF-DEV-CODE                PIC XXX.
  5684         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5685         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5686         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 108
* EL156.cbl
  5687         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5688         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5689         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5690         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5691         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5692         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5693         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5694         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5695         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5696         16  cm-temp-epiq                  pic xx.
  5697             88  EPIQ-CLASS                  value 'EQ'.
  5698*        16  FILLER                        PIC XX.
  5699
  5700     12  CM-AH-DATA.
  5701         16  CM-AH-BENEFIT-CD              PIC XX.
  5702         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5703         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5704         16  CM-AH-DEV-CODE                PIC XXX.
  5705         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5706         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5707         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5708         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5709         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5710         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5711         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5712         16  CM-AH-PAID-THRU-DT            PIC XX.
  5713             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5714         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5715         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5716         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5717         16  FILLER                        PIC X.
  5718
  5719     12  CM-LOAN-INFORMATION.
  5720         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5721         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5722                                           PIC S9(5)V99  COMP-3.
  5723         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5724         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5725         16  CM-PAY-FREQUENCY              PIC S99.
  5726         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5727         16  CM-RATE-CLASS                 PIC XX.
  5728         16  CM-BENEFICIARY                PIC X(25).
  5729         16  CM-POLICY-FORM-NO             PIC X(12).
  5730         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5731         16  CM-LAST-ADD-ON-DT             PIC XX.
  5732         16  CM-DEDUCTIBLE-AMOUNTS.
  5733             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5734             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5735         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5736             20  CM-RESIDENT-STATE         PIC XX.
  5737             20  CM-RATE-CODE              PIC X(4).
  5738             20  FILLER                    PIC XX.
  5739         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5740             20  CM-LOAN-OFFICER           PIC X(5).
  5741             20  FILLER                    PIC XXX.
  5742         16  CM-CSR-CODE                   PIC XXX.
  5743         16  CM-UNDERWRITING-CODE          PIC X.
  5744             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 109
* EL156.cbl
  5745         16  CM-POST-CARD-IND              PIC X.
  5746         16  CM-NH-INTERFACE-SW            PIC X.
  5747         16  CM-PREMIUM-TYPE               PIC X.
  5748             88  CM-SING-PRM                  VALUE '1'.
  5749             88  CM-O-B-COVERAGE              VALUE '2'.
  5750             88  CM-OPEN-END                  VALUE '3'.
  5751         16  CM-IND-GRP-TYPE               PIC X.
  5752             88  CM-INDIVIDUAL                VALUE 'I'.
  5753             88  CM-GROUP                     VALUE 'G'.
  5754         16  CM-SKIP-CODE                  PIC X.
  5755             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5756             88  SKIP-JULY                    VALUE '1'.
  5757             88  SKIP-AUGUST                  VALUE '2'.
  5758             88  SKIP-SEPTEMBER               VALUE '3'.
  5759             88  SKIP-JULY-AUG                VALUE '4'.
  5760             88  SKIP-AUG-SEPT                VALUE '5'.
  5761             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5762             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5763             88  SKIP-JUNE                    VALUE '8'.
  5764             88  SKIP-JUNE-JULY               VALUE '9'.
  5765             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5766             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5767         16  CM-PAYMENT-MODE               PIC X.
  5768             88  PAY-MONTHLY                  VALUE SPACE.
  5769             88  PAY-WEEKLY                   VALUE '1'.
  5770             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5771             88  PAY-BI-WEEKLY                VALUE '3'.
  5772             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5773         16  CM-LOAN-NUMBER                PIC X(8).
  5774         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5775         16  CM-OLD-LOF                    PIC XXX.
  5776*        16  CM-LOAN-OFFICER               PIC XXX.
  5777         16  CM-REIN-TABLE                 PIC XXX.
  5778         16  CM-SPECIAL-REIN-CODE          PIC X.
  5779         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5780         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5781         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5782
  5783     12  CM-STATUS-DATA.
  5784         16  CM-ENTRY-STATUS               PIC X.
  5785         16  CM-ENTRY-DT                   PIC XX.
  5786
  5787         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5788         16  CM-LF-CANCEL-DT               PIC XX.
  5789         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5790
  5791         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5792         16  CM-LF-DEATH-DT                PIC XX.
  5793         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5794
  5795         16  CM-LF-CURRENT-STATUS          PIC X.
  5796             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5797                                                'M' '4' '5' '9'.
  5798             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5799             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5800             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5801             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5802             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 110
* EL156.cbl
  5803             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5804             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5805             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5806             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5807             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5808             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5809             88  CM-LF-DECLINED               VALUE 'D'.
  5810             88  CM-LF-VOIDED                 VALUE 'V'.
  5811
  5812         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5813         16  CM-AH-CANCEL-DT               PIC XX.
  5814         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5815
  5816         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5817         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5818         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5819
  5820         16  CM-AH-CURRENT-STATUS          PIC X.
  5821             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5822                                                'M' '4' '5' '9'.
  5823             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5824             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5825             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5826             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5827             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5828             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5829             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5830             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5831             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5832             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5833             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5834             88  CM-AH-DECLINED               VALUE 'D'.
  5835             88  CM-AH-VOIDED                 VALUE 'V'.
  5836
  5837         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5838             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5839             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5840             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5841         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5842
  5843         16  CM-ENTRY-BATCH                PIC X(6).
  5844         16  CM-LF-EXIT-BATCH              PIC X(6).
  5845         16  CM-AH-EXIT-BATCH              PIC X(6).
  5846         16  CM-LAST-MONTH-END             PIC XX.
  5847
  5848     12  CM-NOTE-SW                        PIC X.
  5849         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5850         88  CERT-NOTES-PRESENT               VALUE '1'.
  5851         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5852         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5853         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5854         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5855         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5856         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5857     12  CM-COMP-EXCP-SW                   PIC X.
  5858         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5859         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5860     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 111
* EL156.cbl
  5861         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5862         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5863
  5864*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5865     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5866     12  FILLER                            PIC X.
  5867
  5868*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5869     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5870     12  FILLER                            PIC X.
  5871*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5872     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5873
  5874     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5875         88  CERT-ADDED-BATCH                 VALUE ' '.
  5876         88  CERT-ADDED-ONLINE                VALUE '1'.
  5877         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5878         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5879         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5880     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5881         88  CERT-AS-LOADED                   VALUE ' '.
  5882         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5883         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5884         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5885         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5886         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5887         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5888         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5889
  5890     12  CM-ACCOUNT-COMM-PCTS.
  5891         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5892         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5893
  5894     12  CM-USER-FIELD                     PIC X.
  5895     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5896     12  CM-CLP-STATE                      PIC XX.
  5897     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5898     12  CM-USER-RESERVED                  PIC XXX.
  5899     12  FILLER REDEFINES CM-USER-RESERVED.
  5900         16  CM-AH-CLASS-CD                PIC XX.
  5901         16  F                             PIC X.
  5902******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 112
* EL156.cbl
  5904*    COPY ELCTRLR.
  5905******************************************************************
  5906*                                                                *
  5907*                            ELCTRLR.                            *
  5908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5909*                            VMOD=2.014                          *
  5910*                                                                *
  5911*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5912*                                                                *
  5913*   FILE TYPE = VSAM,KSDS                                        *
  5914*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5915*                                                                *
  5916*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5917*       ALTERNATE INDEX = NONE                                   *
  5918*                                                                *
  5919*   LOG = YES                                                    *
  5920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5921******************************************************************
  5922*                   C H A N G E   L O G
  5923*
  5924* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5925*-----------------------------------------------------------------
  5926*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5927* EFFECTIVE    NUMBER
  5928*-----------------------------------------------------------------
  5929* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5930* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5931* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5932* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5933* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5934* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5935* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5936* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5937* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5938* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5939* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5940* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5941* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5942* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5943* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5944* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5945* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5946* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5947* 040814    2014030500002  AJRA  ADD ICD CODES
  5948* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5949******************************************************************
  5950 01  ACTIVITY-TRAILERS.
  5951     12  AT-RECORD-ID                    PIC XX.
  5952         88  VALID-AT-ID                       VALUE 'AT'.
  5953
  5954     12  AT-CONTROL-PRIMARY.
  5955         16  AT-COMPANY-CD               PIC X.
  5956         16  AT-CARRIER                  PIC X.
  5957         16  AT-CLAIM-NO                 PIC X(7).
  5958         16  AT-CERT-NO.
  5959             20  AT-CERT-PRIME           PIC X(10).
  5960             20  AT-CERT-SFX             PIC X.
  5961         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 113
* EL156.cbl
  5962             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5963             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5964             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5965             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5966             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5967             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5968             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5969             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5970             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5971             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5972             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5973             88  AT-BENEFICIARY-TRL           VALUE +91.
  5974             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5975             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5976             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5977             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5978
  5979     12  AT-TRAILER-TYPE                 PIC X.
  5980         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5981         88  PAYMENT-TR                       VALUE '2'.
  5982         88  AUTO-PAY-TR                      VALUE '3'.
  5983         88  CORRESPONDENCE-TR                VALUE '4'.
  5984         88  ADDRESS-TR                       VALUE '5'.
  5985         88  GENERAL-INFO-TR                  VALUE '6'.
  5986         88  AUTO-PROMPT-TR                   VALUE '7'.
  5987         88  DENIAL-TR                        VALUE '8'.
  5988         88  INCURRED-CHG-TR                  VALUE '9'.
  5989         88  FORM-CONTROL-TR                  VALUE 'A'.
  5990
  5991     12  AT-RECORDED-DT                  PIC XX.
  5992     12  AT-RECORDED-BY                  PIC X(4).
  5993     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5994
  5995     12  AT-TRAILER-BODY                 PIC X(165).
  5996
  5997     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5998         16  AT-RESERVE-CONTROLS.
  5999             20  AT-MANUAL-SW            PIC X.
  6000                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6001             20  AT-FUTURE-SW            PIC X.
  6002                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6003             20  AT-PTC-SW               PIC X.
  6004                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6005             20  AT-IBNR-SW              PIC X.
  6006                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6007             20  AT-PTC-LF-SW            PIC X.
  6008                 88  AT-LF-PTC-USED          VALUE '1'.
  6009             20  AT-CDT-ACCESS-METHOD    PIC X.
  6010                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6011                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6012                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6013             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6014         16  AT-LAST-COMPUTED-DT         PIC XX.
  6015         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6016         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6017         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6018         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6019         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 114
* EL156.cbl
  6020         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6021         16  AT-EXPENSE-CONTROLS.
  6022             20  AT-EXPENSE-METHOD       PIC X.
  6023                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6024                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6025                 88  PERCENT-OF-PMT           VALUE '3'.
  6026                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6027             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6028             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6029         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6030         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6031
  6032         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6033         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6034
  6035*        16  FILLER                      PIC X(53).
  6036         16  FILLER                      PIC X(47).
  6037
  6038         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6039         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6040
  6041         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6042             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6043             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6044*                    C = CLOSED
  6045*                    O = OPEN
  6046             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6047*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6048
  6049     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6050         16  AT-PAYMENT-TYPE             PIC X.
  6051             88  PARTIAL-PAYMENT                VALUE '1'.
  6052             88  FINAL-PAYMENT                  VALUE '2'.
  6053             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6054             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6055             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6056             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6057             88  VOIDED-PAYMENT                 VALUE '9'.
  6058             88  TRANSFER                       VALUE 'T'.
  6059             88  LIFE-INTEREST                  VALUE 'I'.
  6060
  6061         16  AT-CLAIM-TYPE               PIC X.
  6062             88  PAID-FOR-AH                    VALUE 'A'.
  6063             88  PAID-FOR-LIFE                  VALUE 'L'.
  6064             88  PAID-FOR-IUI                   VALUE 'I'.
  6065             88  PAID-FOR-GAP                   VALUE 'G'.
  6066             88  PAID-FOR-FAM                   VALUE 'F'.
  6067         16  AT-CLAIM-PREM-TYPE          PIC X.
  6068             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6069             88  AT-O-B-COVERAGE                VALUE '2'.
  6070             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6071         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6072         16  AT-CHECK-NO                 PIC X(7).
  6073         16  AT-PAID-FROM-DT             PIC XX.
  6074         16  AT-PAID-THRU-DT             PIC XX.
  6075         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6076         16  FILLER                      PIC X.
  6077         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 115
* EL156.cbl
  6078         16  AT-PAYMENT-ORIGIN           PIC X.
  6079             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6080             88  ONLINE-AUTO-PMT                VALUE '2'.
  6081             88  OFFLINE-PMT                    VALUE '3'.
  6082         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6083         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6084         16  AT-VOID-DATA.
  6085             20  AT-VOID-DT              PIC XX.
  6086*00144       20  AT-VOID-REASON          PIC X(30).
  6087             20  AT-VOID-REASON          PIC X(26).
  6088         16  AT-PMT-APPROVED-BY          PIC X(04).
  6089         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6090         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6091         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6092                                         PIC S99V9(5)  COMP-3.
  6093         16  AT-CREDIT-INTERFACE.
  6094             20  AT-PMT-SELECT-DT        PIC XX.
  6095                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6096             20  AT-PMT-ACCEPT-DT        PIC XX.
  6097                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6098             20  AT-VOID-SELECT-DT       PIC XX.
  6099                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6100             20  AT-VOID-ACCEPT-DT       PIC XX.
  6101                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6102
  6103         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6104                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6105                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6106         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6107
  6108         16  AT-FORCE-CONTROL            PIC X.
  6109             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6110         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6111         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6112         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6113         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6114         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6115         16  AT-BENEFIT-TYPE             PIC X.
  6116
  6117         16  AT-EXPENSE-TYPE             PIC X.
  6118         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6119
  6120         16  AT-PAYEE-TYPE-CD.
  6121             20  AT-PAYEE-TYPE           PIC X.
  6122                 88  INSURED-PAID           VALUE 'I'.
  6123                 88  BENEFICIARY-PAID       VALUE 'B'.
  6124                 88  ACCOUNT-PAID           VALUE 'A'.
  6125                 88  OTHER-1-PAID           VALUE 'O'.
  6126                 88  OTHER-2-PAID           VALUE 'Q'.
  6127                 88  DOCTOR-PAID            VALUE 'P'.
  6128                 88  EMPLOYER-PAID          VALUE 'E'.
  6129             20  AT-PAYEE-SEQ            PIC X.
  6130
  6131         16  AT-CASH-PAYMENT             PIC X.
  6132         16  AT-GROUPED-PAYMENT          PIC X.
  6133         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6134         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6135         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 116
* EL156.cbl
  6136         16  AT-VOID-TYPE                PIC X.
  6137             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6138             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6139         16  AT-AIG-UNEMP-IND            PIC X.
  6140             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6141         16  AT-ASSOCIATES               PIC X.
  6142             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6143             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6144
  6145         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6146         16  AT-CV-PMT-CODE              PIC X.
  6147             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6148             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6149             88  FULL-ADD-PAYMENT           VALUE '3'.
  6150             88  HALF-ADD-PAYMENT           VALUE '4'.
  6151             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6152             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6153             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6154             88  ADDL-PAYMENT               VALUE '8'.
  6155
  6156         16  AT-EOB-CODE1                PIC XXX.
  6157         16  AT-EOB-CODE2                PIC XXX.
  6158         16  AT-EOB-CODE3                PIC XXX.
  6159         16  FILLER REDEFINES AT-EOB-CODE3.
  6160             20  AT-PRINT-CLM-FORM       PIC X.
  6161             20  AT-PRINT-SURVEY         PIC X.
  6162             20  AT-SPECIAL-RELEASE      PIC X.
  6163         16  AT-EOB-CODE4                PIC XXX.
  6164         16  FILLER REDEFINES AT-EOB-CODE4.
  6165             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6166             20  FILLER                  PIC X.
  6167         16  AT-EOB-CODE5                PIC XXX.
  6168         16  FILLER REDEFINES AT-EOB-CODE5.
  6169             20  AT-PMT-PROOF-DT         PIC XX.
  6170             20  FILLER                  PIC X.
  6171
  6172         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6173             88  AT-PRINT-EOB            VALUE 'Y'.
  6174
  6175         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6176         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6177
  6178     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6179         16  AT-SCHEDULE-START-DT        PIC XX.
  6180         16  AT-SCHEDULE-END-DT          PIC XX.
  6181         16  AT-TERMINATED-DT            PIC XX.
  6182         16  AT-LAST-PMT-TYPE            PIC X.
  6183             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6184             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6185         16  AT-FIRST-PMT-DATA.
  6186             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6187             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6188             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6189         16  AT-REGULAR-PMT-DATA.
  6190             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6191             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6192             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6193         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 117
* EL156.cbl
  6194             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6195                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6196                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6197                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6198                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6199                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6200             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6201         16  AT-AUTO-PAY-DAY             PIC 99.
  6202         16  AT-AUTO-CASH                PIC X.
  6203             88  AT-CASH                      VALUE 'Y'.
  6204             88  AT-NON-CASH                  VALUE 'N'.
  6205*        16  FILLER                      PIC X(129).
  6206         16  AT-AUTO-END-LETTER          PIC X(4).
  6207         16  FILLER                      PIC X(125).
  6208
  6209         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6210         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6211
  6212     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6213         16  AT-LETTER-SENT-DT           PIC XX.
  6214         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6215         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6216         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6217         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6218         16  AT-LETTER-ORIGIN            PIC X.
  6219             88  ONLINE-CREATION              VALUE '1' '3'.
  6220             88  OFFLINE-CREATION             VALUE '2' '4'.
  6221             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6222             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6223         16  AT-STD-LETTER-FORM          PIC X(4).
  6224         16  AT-REASON-TEXT              PIC X(70).
  6225         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6226         16  AT-ADDRESEE-TYPE            PIC X.
  6227              88  INSURED-ADDRESEE            VALUE 'I'.
  6228              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6229              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6230              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6231              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6232              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6233              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6234         16  AT-ADDRESSEE-NAME           PIC X(30).
  6235         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6236         16  AT-RESEND-PRINT-DATE        PIC XX.
  6237         16  AT-CORR-SOL-UNSOL           PIC X.
  6238         16  AT-LETTER-PURGED-DT         PIC XX.
  6239*
  6240*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6241*
  6242         16  AT-CSO-REDEFINITION.
  6243             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6244             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6245             20  AT-LETTER-TO-BENE       PIC X(1).
  6246             20  AT-STOP-LETTER-DT       PIC X(2).
  6247             20  FILLER                  PIC X(19).
  6248*             20  FILLER                  PIC X(27).
  6249             20  AT-CSO-LETTER-STATUS    PIC X.
  6250                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6251                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 118
* EL156.cbl
  6252                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6253             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6254             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6255*
  6256*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6257*
  6258*        16  FILLER                      PIC X(26).
  6259*
  6260*        16  AT-DMD-BSR-CODE             PIC X.
  6261*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6262*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6263*
  6264*        16  AT-DMD-LETTER-STATUS        PIC X.
  6265*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6266*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6267*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6268*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6269*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6270
  6271         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6272         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6273
  6274     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6275         16  AT-ADDRESS-TYPE             PIC X.
  6276             88  INSURED-ADDRESS               VALUE 'I'.
  6277             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6278             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6279             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6280             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6281             88  OTHER-ADDRESS-1               VALUE 'O'.
  6282             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6283         16  AT-MAIL-TO-NAME             PIC X(30).
  6284         16  AT-ADDRESS-LINE-1           PIC X(30).
  6285         16  AT-ADDRESS-LINE-2           PIC X(30).
  6286         16  AT-CITY-STATE.
  6287             20  AT-CITY                 PIC X(28).
  6288             20  AT-STATE                PIC XX.
  6289         16  AT-ZIP.
  6290             20  AT-ZIP-CODE.
  6291                 24  AT-ZIP-1ST          PIC X.
  6292                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6293                 24  FILLER              PIC X(4).
  6294             20  AT-ZIP-PLUS4            PIC X(4).
  6295         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6296             20  AT-CAN-POSTAL-1         PIC XXX.
  6297             20  AT-CAN-POSTAL-2         PIC XXX.
  6298             20  FILLER                  PIC XXX.
  6299         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6300*         16  FILLER                      PIC X(23).
  6301         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6302         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6303         16  FILLER                      PIC X(13).
  6304         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6305         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6306
  6307     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6308         16  AT-INFO-LINE-1              PIC X(60).
  6309         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 119
* EL156.cbl
  6310             20  AT-NOTE-ERROR-NO OCCURS 15
  6311                                         PIC X(4).
  6312         16  AT-INFO-LINE-2              PIC X(60).
  6313         16  FILLER REDEFINES AT-INFO-LINE-2.
  6314             20  AT-ICD-CODE-1           PIC X(8).
  6315             20  AT-ICD-CODE-2           PIC X(8).
  6316             20  FILLER                  PIC X(44).
  6317         16  AT-INFO-TRAILER-TYPE        PIC X.
  6318             88  AT-ERRORS-NOTE          VALUE 'E'.
  6319             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6320             88  AT-CALL-NOTE            VALUE 'C'.
  6321             88  AT-MAINT-NOTE           VALUE 'M'.
  6322             88  AT-CERT-CHANGE          VALUE 'X'.
  6323             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6324             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6325             88  AT-CERT-CANCELLED       VALUE 'T'.
  6326         16  AT-CALL-TYPE                PIC X.
  6327             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6328             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6329         16  AT-NOTE-CONTINUATION        PIC X.
  6330             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6331         16  AT-EOB-CODES-EXIST          PIC X.
  6332             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6333         16  FILLER                      PIC X(35).
  6334         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6335         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6336
  6337     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6338         16  AT-PROMPT-LINE-1            PIC X(60).
  6339         16  AT-PROMPT-LINE-2            PIC X(60).
  6340         16  AT-PROMPT-START-DT          PIC XX.
  6341         16  AT-PROMPT-END-DT            PIC XX.
  6342         16  FILLER                      PIC X(35).
  6343         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6344         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6345
  6346     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6347         16  AT-DENIAL-INFO-1            PIC X(60).
  6348         16  AT-DENIAL-INFO-2            PIC X(60).
  6349         16  AT-DENIAL-DT                PIC XX.
  6350         16  AT-RETRACTION-DT            PIC XX.
  6351         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6352*         16  FILLER                      PIC X(31).
  6353         16  AT-DENIAL-PROOF-DT          PIC XX.
  6354         16  FILLER                      PIC X(29).
  6355         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6356         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6357
  6358     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6359         16  AT-OLD-INCURRED-DT          PIC XX.
  6360         16  AT-OLD-REPORTED-DT          PIC XX.
  6361         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6362         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6363         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6364         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6365         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6366         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6367         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 120
* EL156.cbl
  6368         16  AT-OLD-DIAG-CODE            PIC X(6).
  6369         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6370         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6371         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6372         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6373         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6374         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6375         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6376         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6377         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6378         16  FILLER                      PIC X(9).
  6379         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6380
  6381     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6382         16  AT-FORM-SEND-ON-DT          PIC XX.
  6383         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6384         16  AT-FORM-RE-SEND-DT          PIC XX.
  6385         16  AT-FORM-ANSWERED-DT         PIC XX.
  6386         16  AT-FORM-PRINTED-DT          PIC XX.
  6387         16  AT-FORM-REPRINT-DT          PIC XX.
  6388         16  AT-FORM-TYPE                PIC X.
  6389             88  INITIAL-FORM                  VALUE '1'.
  6390             88  PROGRESS-FORM                 VALUE '2'.
  6391         16  AT-INSTRUCT-LN-1            PIC X(28).
  6392         16  AT-INSTRUCT-LN-2            PIC X(28).
  6393         16  AT-INSTRUCT-LN-3            PIC X(28).
  6394         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6395         16  AT-FORM-ADDRESS             PIC X.
  6396             88  FORM-TO-INSURED              VALUE 'I'.
  6397             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6398             88  FORM-TO-OTHER-1              VALUE 'O'.
  6399             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6400         16  AT-RELATED-1.
  6401             20 AT-REL-CARR-1            PIC X.
  6402             20 AT-REL-CLAIM-1           PIC X(7).
  6403             20 AT-REL-CERT-1            PIC X(11).
  6404         16  AT-RELATED-2.
  6405             20 AT-REL-CARR-2            PIC X.
  6406             20 AT-REL-CLAIM-2           PIC X(7).
  6407             20 AT-REL-CERT-2            PIC X(11).
  6408         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6409         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6410         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6411         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6412         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6413         16  AT-STOP-FORM-DT             PIC X(2).
  6414
  6415         16  FILLER                      PIC X(09).
  6416         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6417         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6418******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 121
* EL156.cbl
  6420*    COPY ELCACTQ.
  6421******************************************************************
  6422*                                                                *
  6423*                            ELCACTQ.                            *
  6424*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6425*                            VMOD=2.004                          *
  6426*                                                                *
  6427*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6428*                                                                *
  6429*   FILE TYPE = VSAM,KSDS                                        *
  6430*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6431*                                                                *
  6432*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6433*       ALTERNATE INDEX = NONE                                   *
  6434*                                                                *
  6435*   LOG = YES                                                    *
  6436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6437*                                                                *
  6438*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6439******************************************************************
  6440
  6441 01  ACTIVITY-QUE.
  6442     12  AQ-RECORD-ID                PIC XX.
  6443         88  VALID-AQ-ID                VALUE 'AQ'.
  6444
  6445     12  AQ-CONTROL-PRIMARY.
  6446         16  AQ-COMPANY-CD           PIC X.
  6447         16  AQ-CARRIER              PIC X.
  6448         16  AQ-CLAIM-NO             PIC X(7).
  6449         16  AQ-CERT-NO.
  6450             20  AQ-CERT-PRIME       PIC X(10).
  6451             20  AQ-CERT-SFX         PIC X.
  6452
  6453     12  AQ-PENDING-ACTIVITY-FLAGS.
  6454         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6455         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6456             88  PENDING-PAYMENTS       VALUE '1'.
  6457         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6458             88  PENDING-FULL-PRINT     VALUE '1'.
  6459             88  PENDING-PART-PRINT     VALUE '2'.
  6460         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6461             88  PENDING-LETTERS        VALUE '1'.
  6462         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6463             88  PENDING-RESTORE        VALUE 'C'.
  6464             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6465
  6466     12  FILLER                      PIC X(20).
  6467
  6468     12  AQ-RESEND-DATE              PIC XX.
  6469     12  AQ-FOLLOWUP-DATE            PIC XX.
  6470     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6471     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6472     12  AQ-AUTO-LETTER              PIC X(4).
  6473     12  FILLER                      PIC XX.
  6474     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6475*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 122
* EL156.cbl
  6477*    COPY ERCACCT.
  6478******************************************************************
  6479*                                                                *
  6480*                                                                *
  6481*                            ERCACCT                             *
  6482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6483*                            VMOD=2.031                          *
  6484*                                                                *
  6485*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6486*                                                                *
  6487*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6488*   VSAM ACCOUNT MASTER FILES.                                   *
  6489*                                                                *
  6490*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6491*                                                                *
  6492*   FILE TYPE = VSAM,KSDS                                        *
  6493*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6494*                                                                *
  6495*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6496*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6497*                                                                *
  6498*   LOG = NO                                                     *
  6499*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6500*                                                                *
  6501*                                                                *
  6502******************************************************************
  6503*                   C H A N G E   L O G
  6504*
  6505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6506*-----------------------------------------------------------------
  6507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6508* EFFECTIVE    NUMBER
  6509*-----------------------------------------------------------------
  6510* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6511* 092705    2005050300006  PEMA  ADD SPP LEASES
  6512* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6513* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6514* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6515* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6516* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6517******************************************************************
  6518
  6519 01  ACCOUNT-MASTER.
  6520     12  AM-RECORD-ID                      PIC XX.
  6521         88  VALID-AM-ID                      VALUE 'AM'.
  6522
  6523     12  AM-CONTROL-PRIMARY.
  6524         16  AM-COMPANY-CD                 PIC X.
  6525         16  AM-MSTR-CNTRL.
  6526             20  AM-CONTROL-A.
  6527                 24  AM-CARRIER            PIC X.
  6528                 24  AM-GROUPING.
  6529                     28 AM-GROUPING-PREFIX PIC XXX.
  6530                     28 AM-GROUPING-PRIME  PIC XXX.
  6531                 24  AM-STATE              PIC XX.
  6532                 24  AM-ACCOUNT.
  6533                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6534                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 123
* EL156.cbl
  6535             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6536                                           PIC X(19).
  6537             20  AM-CNTRL-B.
  6538                 24  AM-EXPIRATION-DT      PIC XX.
  6539                 24  FILLER                PIC X(4).
  6540             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6541                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6542
  6543     12  AM-CONTROL-BY-VAR-GRP.
  6544         16  AM-COMPANY-CD-A1              PIC X.
  6545         16  AM-VG-CARRIER                 PIC X.
  6546         16  AM-VG-GROUPING                PIC X(6).
  6547         16  AM-VG-STATE                   PIC XX.
  6548         16  AM-VG-ACCOUNT                 PIC X(10).
  6549         16  AM-VG-DATE.
  6550             20  AM-VG-EXPIRATION-DT       PIC XX.
  6551             20  FILLER                    PIC X(4).
  6552         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6553                                           PIC 9(11)      COMP-3.
  6554     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6555         16  FILLER                        PIC X(10).
  6556         16  AM-VG-KEY3.
  6557             20  AM-VG3-ACCOUNT            PIC X(10).
  6558             20  AM-VG3-EXP-DT             PIC XX.
  6559         16  FILLER                        PIC X(4).
  6560     12  AM-MAINT-INFORMATION.
  6561         16  AM-LAST-MAINT-DT              PIC XX.
  6562         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6563         16  AM-LAST-MAINT-USER            PIC X(4).
  6564         16  FILLER                        PIC XX.
  6565
  6566     12  AM-EFFECTIVE-DT                   PIC XX.
  6567     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6568
  6569     12  AM-PREV-DATES  COMP-3.
  6570         16  AM-PREV-EXP-DT                PIC 9(11).
  6571         16  AM-PREV-EFF-DT                PIC 9(11).
  6572
  6573     12  AM-REPORT-CODE-1                  PIC X(10).
  6574     12  AM-REPORT-CODE-2                  PIC X(10).
  6575
  6576     12  AM-CITY-CODE                      PIC X(4).
  6577     12  AM-COUNTY-PARISH                  PIC X(6).
  6578
  6579     12  AM-NAME                           PIC X(30).
  6580     12  AM-PERSON                         PIC X(30).
  6581     12  AM-ADDRS                          PIC X(30).
  6582     12  AM-CITY.
  6583         16  AM-ADDR-CITY                  PIC X(28).
  6584         16  AM-ADDR-STATE                 PIC XX.
  6585     12  AM-ZIP.
  6586         16  AM-ZIP-PRIME.
  6587             20  AM-ZIP-PRI-1ST            PIC X.
  6588                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6589             20  FILLER                    PIC X(4).
  6590         16  AM-ZIP-PLUS4                  PIC X(4).
  6591     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6592         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 124
* EL156.cbl
  6593         16  AM-CAN-POSTAL-2               PIC XXX.
  6594         16  FILLER                        PIC XXX.
  6595     12  AM-TEL-NO.
  6596         16  AM-AREA-CODE                  PIC 999.
  6597         16  AM-TEL-PRE                    PIC 999.
  6598         16  AM-TEL-NBR                    PIC 9(4).
  6599     12  AM-TEL-LOC                        PIC X.
  6600         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6601         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6602
  6603     12  AM-COMM-STRUCTURE.
  6604         16  AM-DEFN-1.
  6605             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6606                 24  AM-AGT.
  6607                     28  AM-AGT-PREFIX     PIC X(4).
  6608                     28  AM-AGT-PRIME      PIC X(6).
  6609                 24  AM-COM-TYP            PIC X.
  6610                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6611                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6612                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6613                 24  AM-RECALC-LV-INDIC    PIC X.
  6614                 24  AM-RETRO-LV-INDIC     PIC X.
  6615                 24  AM-GL-CODES           PIC X.
  6616                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6617                 24  FILLER                PIC X(01).
  6618         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6619             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6620                 24  FILLER                PIC X(11).
  6621                 24  AM-L-COMA             PIC XXX.
  6622                 24  AM-J-COMA             PIC XXX.
  6623                 24  AM-A-COMA             PIC XXX.
  6624                 24  FILLER                PIC X(6).
  6625
  6626     12  AM-COMM-CHANGE-STATUS             PIC X.
  6627         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6628
  6629     12  AM-CSR-CODE                       PIC X(4).
  6630
  6631     12  AM-BILLING-STATUS                 PIC X.
  6632         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6633         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6634     12  AM-AUTO-REFUND-SW                 PIC X.
  6635         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6636         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6637     12  AM-GPCD                           PIC 99.
  6638     12  AM-IG                             PIC X.
  6639         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6640         88  AM-HAS-GROUP                     VALUE '2'.
  6641     12  AM-STATUS                         PIC X.
  6642         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6643         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6644         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6645         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6646         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6647         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6648     12  AM-REMIT-TO                       PIC 99.
  6649     12  AM-ID-NO                          PIC X(11).
  6650
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 125
* EL156.cbl
  6651     12  AM-CAL-TABLE                      PIC XX.
  6652     12  AM-LF-DEVIATION                   PIC XXX.
  6653     12  AM-AH-DEVIATION                   PIC XXX.
  6654     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6655     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6656     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6657     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6658     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6659     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6660
  6661     12  AM-USER-FIELDS.
  6662         16  AM-FLD-1                      PIC XX.
  6663         16  AM-FLD-2                      PIC XX.
  6664         16  AM-FLD-3                      PIC XX.
  6665         16  AM-FLD-4                      PIC XX.
  6666         16  AM-FLD-5                      PIC XX.
  6667
  6668     12  AM-1ST-PROD-DATE.
  6669         16  AM-1ST-PROD-YR                PIC XX.
  6670         16  AM-1ST-PROD-MO                PIC XX.
  6671         16  AM-1ST-PROD-DA                PIC XX.
  6672     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6673     12  AM-CERTS-PURGED-DATE.
  6674         16  AM-PUR-YR                     PIC XX.
  6675         16  AM-PUR-MO                     PIC XX.
  6676         16  AM-PUR-DA                     PIC XX.
  6677     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6678     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6679     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6680     12  AM-INACTIVE-DATE.
  6681         16  AM-INA-MO                     PIC 99.
  6682         16  AM-INA-DA                     PIC 99.
  6683         16  AM-INA-YR                     PIC 99.
  6684     12  AM-AR-HI-CERT-DATE                PIC XX.
  6685
  6686     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6687     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6688
  6689     12  AM-OB-PAYMENT-MODE                PIC X.
  6690         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6691         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6692         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6693         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6694
  6695     12  AM-AH-ONLY-INDICATOR              PIC X.
  6696         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6697         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6698
  6699     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6700
  6701     12  AM-OVER-SHORT.
  6702         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6703         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6704
  6705     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6706     12  AM-DCC-CLP-STATE                  PIC XX.
  6707
  6708     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 126
* EL156.cbl
  6709     12  AM-RECALC-REIN                    PIC X.
  6710
  6711     12  AM-REI-TABLE                      PIC XXX.
  6712     12  AM-REI-ET-LF                      PIC X.
  6713     12  AM-REI-ET-AH                      PIC X.
  6714     12  AM-REI-PE-LF                      PIC X.
  6715     12  AM-REI-PE-AH                      PIC X.
  6716     12  AM-REI-PRT-ST                     PIC X.
  6717     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6718     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6719     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6720     12  AM-REI-GROUP-A                    PIC X(6).
  6721     12  AM-REI-MORT                       PIC X(4).
  6722     12  AM-REI-PRT-OW                     PIC X.
  6723     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6724     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6725     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6726     12  AM-REI-GROUP-B                    PIC X(6).
  6727
  6728     12  AM-TRUST-TYPE                     PIC X(2).
  6729
  6730     12  AM-EMPLOYER-STMT-USED             PIC X.
  6731     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6732
  6733     12  AM-STD-AH-TYPE                    PIC XX.
  6734     12  AM-EARN-METHODS.
  6735         16  AM-EARN-METHOD-R              PIC X.
  6736             88 AM-REF-RL-R78                 VALUE 'R'.
  6737             88 AM-REF-RL-PR                  VALUE 'P'.
  6738             88 AM-REF-RL-MEAN                VALUE 'M'.
  6739             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6740         16  AM-EARN-METHOD-L              PIC X.
  6741             88 AM-REF-LL-R78                 VALUE 'R'.
  6742             88 AM-REF-LL-PR                  VALUE 'P'.
  6743             88 AM-REF-LL-MEAN                VALUE 'M'.
  6744             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6745         16  AM-EARN-METHOD-A              PIC X.
  6746             88 AM-REF-AH-R78                 VALUE 'R'.
  6747             88 AM-REF-AH-PR                  VALUE 'P'.
  6748             88 AM-REF-AH-MEAN                VALUE 'M'.
  6749             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6750             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6751             88 AM-REF-AH-NET                 VALUE 'N'.
  6752
  6753     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6754     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6755     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6756
  6757     12  AM-RET-Y-N                        PIC X.
  6758     12  AM-RET-P-E                        PIC X.
  6759     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6760     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6761     12  AM-RET-GRP                        PIC X(6).
  6762     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6763         16  AM-POOL-PRIME                 PIC XXX.
  6764         16  AM-POOL-SUB                   PIC XXX.
  6765     12  AM-RETRO-EARNINGS.
  6766         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 127
* EL156.cbl
  6767         16  AM-RET-EARN-L                 PIC X.
  6768         16  AM-RET-EARN-A                 PIC X.
  6769     12  AM-RET-ST-TAX-USE                 PIC X.
  6770         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6771         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6772     12  AM-RETRO-BEG-EARNINGS.
  6773         16  AM-RET-BEG-EARN-R             PIC X.
  6774         16  AM-RET-BEG-EARN-L             PIC X.
  6775         16  AM-RET-BEG-EARN-A             PIC X.
  6776     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6777     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6778
  6779     12  AM-USER-SELECT-OPTIONS.
  6780         16  AM-USER-SELECT-1              PIC X(10).
  6781         16  AM-USER-SELECT-2              PIC X(10).
  6782         16  AM-USER-SELECT-3              PIC X(10).
  6783         16  AM-USER-SELECT-4              PIC X(10).
  6784         16  AM-USER-SELECT-5              PIC X(10).
  6785
  6786     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6787
  6788     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6789
  6790     12  AM-RPT045A-SWITCH                 PIC X.
  6791         88  RPT045A-OFF                   VALUE 'N'.
  6792
  6793     12  AM-INSURANCE-LIMITS.
  6794         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6795         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6796
  6797     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6798         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6799
  6800     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6801         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6802         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6803
  6804     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6805
  6806     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6807     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6808     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6809     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6810     12  AM-DCC-UEF-STATE                  PIC XX.
  6811     12  FILLER                            PIC XXX.
  6812     12  AM-REPORT-CODE-3                  PIC X(10).
  6813*    12  FILLER                            PIC X(22).
  6814
  6815     12  AM-RESERVE-DATE.
  6816         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6817         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6818         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6819
  6820     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6821     12  AM-NOTIFICATION-TYPES.
  6822         16  AM-NOTIF-OF-LETTERS           PIC X.
  6823         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6824         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 128
* EL156.cbl
  6825         16  AM-NOTIF-OF-STATUS            PIC X.
  6826
  6827     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6828         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6829         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6830         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6831         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6832
  6833     12  AM-BENEFIT-CONTROLS.
  6834         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6835             20  AM-BENEFIT-CODE           PIC XX.
  6836             20  AM-BENEFIT-TYPE           PIC X.
  6837             20  AM-BENEFIT-REVISION       PIC XXX.
  6838             20  AM-BENEFIT-REM-TERM       PIC X.
  6839             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6840             20  FILLER                    PIC XX.
  6841         16  FILLER                        PIC X(80).
  6842
  6843     12  AM-TRANSFER-DATA.
  6844         16  AM-TRANSFERRED-FROM.
  6845             20  AM-TRNFROM-CARRIER        PIC X.
  6846             20  AM-TRNFROM-GROUPING.
  6847                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6848                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6849             20  AM-TRNFROM-STATE          PIC XX.
  6850             20  AM-TRNFROM-ACCOUNT.
  6851                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6852                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6853             20  AM-TRNFROM-DTE            PIC XX.
  6854         16  AM-TRANSFERRED-TO.
  6855             20  AM-TRNTO-CARRIER          PIC X.
  6856             20  AM-TRNTO-GROUPING.
  6857                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6858                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6859             20  AM-TRNTO-STATE            PIC XX.
  6860             20  AM-TRNTO-ACCOUNT.
  6861                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6862                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6863             20  AM-TRNTO-DTE              PIC XX.
  6864         16  FILLER                        PIC X(10).
  6865
  6866     12  AM-SAVED-REMIT-TO                 PIC 99.
  6867
  6868     12  AM-COMM-STRUCTURE-SAVED.
  6869         16  AM-DEFN-1-SAVED.
  6870             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6871                 24  AM-AGT-SV             PIC X(10).
  6872                 24  AM-COM-TYP-SV         PIC X.
  6873                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6874                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6875                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6876                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6877                 24  FILLER                PIC X.
  6878                 24  AM-GL-CODES-SV        PIC X.
  6879                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6880                 24  FILLER                PIC X.
  6881         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6882             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 129
* EL156.cbl
  6883                 24  FILLER                PIC X(11).
  6884                 24  AM-L-COMA-SV          PIC XXX.
  6885                 24  AM-J-COMA-SV          PIC XXX.
  6886                 24  AM-A-COMA-SV          PIC XXX.
  6887                 24  FILLER                PIC X(6).
  6888
  6889     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6890         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6891            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6892            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6893            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6894
  6895     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6896     12  FILLER                            PIC X(120).
  6897
  6898     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6899         16  AM-CONTROL-NAME               PIC X(30).
  6900         16  AM-EXECUTIVE-ONE.
  6901             20  AM-EXEC1-NAME             PIC X(15).
  6902             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6903                                                          COMP-3.
  6904             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6905                                                          COMP-3.
  6906         16  AM-EXECUTIVE-TWO.
  6907             20  AM-EXEC2-NAME             PIC X(15).
  6908             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6909                                                          COMP-3.
  6910             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6911                                                          COMP-3.
  6912
  6913     12  AM-RETRO-ADDITIONAL-DATA.
  6914         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6915         16  AM-RETRO-PREM-P-E             PIC X.
  6916         16  AM-RETRO-CLMS-P-I             PIC X.
  6917         16  AM-RETRO-RET-BRACKET-LF.
  6918             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6919                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6920                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6921             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6922                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6923                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6924             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6925                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6926                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6927         16  AM-RETRO-RET-BRACKET-AH.
  6928             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6929                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6930                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6931                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6932             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6933                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6934                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6935             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6936                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6937                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6938
  6939     12  AM-COMMENTS.
  6940         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 130
* EL156.cbl
  6941
  6942     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6943         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6944         16  AM-FLI-BILLING-CODE           PIC X.
  6945         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6946         16  AM-FLI-UNITED-IDENT           PIC X.
  6947         16  AM-FLI-INTEREST-LOST-DATA.
  6948             20  AM-FLI-BANK-NO            PIC X(5).
  6949             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6950             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6951             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6952         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6953             20  AM-FLI-AGT                PIC X(9).
  6954             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6955             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6956         16  FILLER                        PIC X(102).
  6957
  6958     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6959         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6960             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6961             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6962             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6963             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6964             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6965         16  FILLER                          PIC X(10).
  6966******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 131
* EL156.cbl
  6968*    COPY ELCCHKQ.
  6969******************************************************************
  6970*                                                                *
  6971*                                                                *
  6972*                            ELCCHKQ.                            *
  6973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6974*                            VMOD=2.007                          *
  6975*                                                                *
  6976*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6977*                                                                *
  6978*   FILE TYPE = VSAM,KSDS                                        *
  6979*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6980*                                                                *
  6981*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6982*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6983*                                                                *
  6984*   LOG = YES                                                    *
  6985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6986******************************************************************
  6987 01  CHECK-QUE.
  6988     12  CQ-RECORD-ID                PIC XX.
  6989         88  VALID-CQ-ID         VALUE 'CQ'.
  6990
  6991     12  CQ-CONTROL-PRIMARY.
  6992         16  CQ-COMPANY-CD           PIC X.
  6993         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6994         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6995
  6996     12  CQ-CONTROL-BY-PAYEE.
  6997         16  CQ-CONTROL-BY-NUMBER.
  6998             20  CQ-COMPANY-CD-A1     PIC X.
  6999             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7000         16  CQ-PAYEE-CARRIER        PIC X.
  7001         16  CQ-PAYEE-GROUPING       PIC X(6).
  7002         16  CQ-PAYEE-STATE          PIC XX.
  7003         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7004         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7005
  7006     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7007         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7008         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7009         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7010         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7011         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7012         16  FILLER                  PIC X(3).
  7013
  7014     12  CQ-ENTRY-TYPE               PIC X.
  7015             88  CHECK-ON-QUE           VALUE 'Q'.
  7016             88  ALIGNMENT-CHECK        VALUE 'A'.
  7017             88  SPOILED-CHECK          VALUE 'S'.
  7018             88  PAYMENT-ABORTED        VALUE 'X'.
  7019
  7020     12  CQ-CLAIM-MAST-CNTL.
  7021         16  CQ-CARRIER              PIC X.
  7022         16  CQ-CLAIM-NO             PIC X(7).
  7023         16  CQ-CERT-NO.
  7024             20  CQ-CERT-PRIME       PIC X(10).
  7025             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 132
* EL156.cbl
  7026         16  CQ-CLAIM-TYPE           PIC X.
  7027             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7028             88  CQ-AH-CLAIM            VALUE 'A'.
  7029         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7030             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7031             88  CQ-O-B-COVERAGE        VALUE '2'.
  7032             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7033
  7034     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7035     12  CQ-CHECK-NUMBER             PIC X(7).
  7036     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7037     12  CQ-PAYMENT-TYPE             PIC X.
  7038             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7039             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7040             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7041             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7042             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7043             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7044             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7045             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7046     12  CQ-VOID-INDICATOR           PIC X.
  7047             88  CHECK-IS-STOPPED          VALUE 'S'.
  7048             88  CHECK-IS-VOID             VALUE 'V'.
  7049     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7050     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7051     12  CQ-CHECK-BY-USER            PIC X(4).
  7052     12  CQ-PRE-NUMBERING-SW         PIC X.
  7053       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7054       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7055
  7056     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7057     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7058     12  CQ-LEDGER-FLAG              PIC X(01).
  7059     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7060     12  CQ-LAST-UPDATED-DT          PIC XX.
  7061     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7062     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7063
  7064     12  FILLER                      PIC X(04).
  7065
  7066******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 133
* EL156.cbl
  7068*    COPY ELCBENE.
  7069******************************************************************
  7070*                                                                *
  7071*                            ELCBENE.                            *
  7072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7073*                            VMOD=2.006                          *
  7074*                                                                *
  7075*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7076*                                                                *
  7077*   FILE TYPE = VSAM,KSDS                                        *
  7078*   RECORD SIZE = 500   RECFORM = FIX                            *
  7079*                                                                *
  7080*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7081*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7082*                                                                *
  7083*   LOG = YES                                                    *
  7084*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7085*                                                                *
  7086*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7087******************************************************************
  7088
  7089 01  BENEFICIARY-MASTER.
  7090     12  BE-RECORD-ID                PIC XX.
  7091         88  VALID-BE-ID                VALUE 'BE'.
  7092
  7093     12  BE-CONTROL-PRIMARY.
  7094         16  BE-COMPANY-CD           PIC X.
  7095         16  BE-RECORD-TYPE          PIC X.
  7096             88  BENEFICIARY-RECORD  VALUE 'B'.
  7097             88  ADJUSTOR-RECORD     VALUE 'A'.
  7098         16  BE-BENEFICIARY          PIC X(10).
  7099     12  BE-CONTROL-BY-NAME.
  7100         16  BE-COMPANY-CD-A1        PIC X.
  7101         16  BE-RECORD-TYPE-A1       PIC X.
  7102         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7103         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7104
  7105     12  BE-LAST-MAINT-DT            PIC XX.
  7106     12  BE-LAST-MAINT-BY            PIC X(4).
  7107     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7108
  7109     12  BE-ADDRESS-DATA.
  7110         16  BE-MAIL-TO-NAME         PIC X(30).
  7111         16  BE-ADDRESS-LINE-1       PIC X(30).
  7112         16  BE-ADDRESS-LINE-2       PIC X(30).
  7113         16  BE-ADDRESS-LINE-3       PIC X(30).
  7114         16  BE-CITY-STATE.
  7115             20  BE-CITY             PIC X(28).
  7116             20  BE-STATE            PIC XX.
  7117         16  BE-ZIP-CODE.
  7118             20  BE-ZIP-PRIME.
  7119                 24  BE-ZIP-1ST      PIC X.
  7120                     88  BE-CANADIAN-POST-CODE
  7121                                         VALUE 'A' THRU 'Z'.
  7122                 24  FILLER          PIC X(4).
  7123             20  BE-ZIP-PLUS4        PIC X(4).
  7124         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7125             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 134
* EL156.cbl
  7126             20  BE-CAN-POSTAL-2     PIC XXX.
  7127             20  FILLER              PIC XXX.
  7128         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7129         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7130
  7131******************************************************************
  7132*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7133*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7134******************************************************************
  7135     12  BE-CARRIER                  PIC X.
  7136
  7137     12  BE-ADDRESS-DATA2.
  7138         16  BE-MAIL-TO-NAME2        PIC X(30).
  7139         16  BE-ADDRESS-LINE-12      PIC X(30).
  7140         16  BE-ADDRESS-LINE-22      PIC X(30).
  7141         16  BE-ADDRESS-LINE-32      PIC X(30).
  7142         16  BE-CITY-STATE2.
  7143             20  BE-CITY2            PIC X(28).
  7144             20  BE-STATE2           PIC XX.
  7145         16  BE-ZIP-CODE2.
  7146             20  BE-ZIP-PRIME2.
  7147                 24  BE-ZIP-1ST2     PIC X.
  7148                     88  BE-CANADIAN-POST-CODE2
  7149                                         VALUE 'A' THRU 'Z'.
  7150                 24  FILLER          PIC X(4).
  7151             20  BE-ZIP-PLUS42       PIC X(4).
  7152         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7153             20  BE-CAN-POSTAL-12    PIC XXX.
  7154             20  BE-CAN-POSTAL-22    PIC XXX.
  7155             20  FILLER              PIC XXX.
  7156         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7157         16  BE-BILLING-STMT-DATA.
  7158             20  BE-BSR              PIC X.
  7159                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7160                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7161             20  BE-BSR-FROM         PIC X(30).
  7162             20  BE-BSR-DEPT         PIC X(30).
  7163             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7164             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7165             20  BE-OUTPUT-TYPE      PIC X.
  7166                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7167                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7168
  7169     12  FILLER                      PIC X(28).
  7170******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 135
* EL156.cbl
  7172*    COPY ELCARCH.
  7173******************************************************************
  7174*                                                                *
  7175*                            ELCARCH.                            *
  7176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7177*                            VMOD=2.007                          *
  7178*                                                                *
  7179*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7180*                                                                *
  7181*   FILE TYPE = VSAM,KSDS                                        *
  7182*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7183*                                                                *
  7184*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7185*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7186*                                                                *
  7187*   LOG = NO                                                     *
  7188*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7189*                                                                *
  7190*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7191******************************************************************
  7192 01  LETTER-ARCHIVE.
  7193     12  LA-RECORD-ID                PIC XX.
  7194         88  VALID-LA-ID                VALUE 'LA'.
  7195
  7196     12  LA-CONTROL-PRIMARY.
  7197         16  LA-COMPANY-CD           PIC X.
  7198         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7199         16  LA-RECORD-TYPE          PIC X.
  7200             88  LA-HEADER-DATA         VALUE '1'.
  7201             88  LA-ADDRESS-DATA        VALUE '2'.
  7202             88  LA-TEXT-DATA           VALUE '3'.
  7203             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7204         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7205
  7206     12  LA-CONTROL-BY-TYPE.
  7207         16  LA-COMPANY-CD-A1        PIC X.
  7208         16  LA-RECORD-TYPE-A1       PIC X.
  7209         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7210         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7211
  7212     12  LA-TEXT-RECORD.
  7213         16  LA-SKIP-CONTROL         PIC XX.
  7214             88  NO-LINES-SKIPPED       VALUE SPACES.
  7215             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7216         16  LA-TEXT-LINE            PIC X(70).
  7217
  7218     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7219         16  FILLER                  PIC XX.
  7220         16  LA-ADDRESS-LINE         PIC X(30).
  7221         16  FILLER                  PIC X(40).
  7222
  7223     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7224         16  FILLER                  PIC XX.
  7225         16  LA-CARRIER              PIC X.
  7226         16  LA-CLAIM-NO             PIC X(7).
  7227         16  LA-CERT-NO.
  7228             20  LA-CERT-PRIME       PIC X(10).
  7229             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 136
* EL156.cbl
  7230         16  LA-NO-OF-COPIES         PIC S9.
  7231         16  LA-RESEND-DATE          PIC XX.
  7232         16  LA-PROCESSOR-CD         PIC X(4).
  7233         16  LA-CREATION-DT          PIC XX.
  7234         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7235         16  LA-RESEND-PRINT-DATE    PIC XX.
  7236         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7237         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7238*
  7239* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7240*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7241*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7242*   I        20  LA-DMD-RES-ST           PIC XX.
  7243*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7244*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7245*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7246*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7247*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7248*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7249*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7250*   I        20  LA-DMD-UND-CODE         PIC XX.
  7251*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7252*   V    16  FILLER                  PIC X(15).
  7253* -----
  7254*
  7255* REINSERTED  CSO  MODS
  7256*
  7257         16  FILLER.
  7258             20  FILLER                  PIC X(29).
  7259             20  LA-CSO-LETTER-STATUS    PIC X.
  7260                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7261                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7262                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7263             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7264             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7265*
  7266
  7267     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7268         16  FILLER                  PIC XX.
  7269         16  LA4-CARRIER             PIC X.
  7270         16  LA4-CLAIM-NO            PIC X(7).
  7271         16  LA4-CERT-NO.
  7272             20  LA4-CERT-PRIME      PIC X(10).
  7273             20  LA4-CERT-SFX        PIC X.
  7274         16  LA4-NO-OF-COPIES        PIC S9.
  7275         16  LA4-RESEND-DATE         PIC XX.
  7276         16  LA4-PROCESSOR-CD        PIC X(4).
  7277         16  LA4-CREATION-DT         PIC XX.
  7278         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7279         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7280         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7281         16  LA4-FORM-TYPE           PIC X.
  7282             88  LA4-INITIAL-FORM    VALUE '1'.
  7283             88  LA4-PROGRESS-FORM   VALUE '2'.
  7284         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7285         16  LA4-STATE               PIC X(02).
  7286         16  FILLER                  PIC X(31).
  7287******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 137
* EL156.cbl
  7289*    COPY ELCDAR.
  7290******************************************************************
  7291*                                                                *
  7292*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7293*   FILE TYPE = VSAM,KSDS                                        *
  7294*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7295*   BASE CLUSTER = DLYACTV                                       *
  7296*   LOG = YES                                                    *
  7297*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7298*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7299*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7300*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7301*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7302*               BY PROGRAM "LGINFCE".                            *
  7303*                                                                *
  7304******************************************************************
  7305 01  DAILY-ACTIVITY-RECORD.
  7306     05  DA-KEY.
  7307         10  DA-COMP-CD          PIC X.
  7308         10  DA-CARRIER          PIC X.
  7309         10  DA-CLAIM-NO         PIC X(7).
  7310         10  DA-CERT-NO.
  7311             15  DA-CERT-PRIME   PIC X(10).
  7312             15  DA-CERT-SFX     PIC X.
  7313     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7314     05  DA-RECORD-TYPE          PIC X.
  7315     05  FILLER                  PIC X(2).
  7316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 138
* EL156.cbl
  7318*    COPY ERCCOMP.
  7319******************************************************************
  7320*                                                                *
  7321*                                                                *
  7322*                            ERCCOMP                             *
  7323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7324*                            VMOD=2.019                          *
  7325*                                                                *
  7326*   ONLINE CREDIT SYSTEM                                         *
  7327*                                                                *
  7328*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7329*                                                                *
  7330*   FILE TYPE = VSAM,KSDS                                        *
  7331*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7332*                                                                *
  7333*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7334*       ALTERNATE PATH = NONE                                    *
  7335*                                                                *
  7336*   LOG = NO                                                     *
  7337*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7338*                                                                *
  7339******************************************************************
  7340*                   C H A N G E   L O G
  7341*
  7342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7343*-----------------------------------------------------------------
  7344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7345* EFFECTIVE    NUMBER
  7346*-----------------------------------------------------------------
  7347* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7348* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7349* 092205    2005050300006  PEMA  ADD LEASE FEE
  7350* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7351* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7352* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7353* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7354* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7355* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7356******************************************************************
  7357
  7358 01  COMPENSATION-MASTER.
  7359     12  CO-RECORD-ID                          PIC XX.
  7360         88  VALID-CO-ID                          VALUE 'CO'.
  7361
  7362     12  CO-CONTROL-PRIMARY.
  7363         16  CO-COMPANY-CD                     PIC X.
  7364         16  CO-CONTROL.
  7365             20  CO-CTL-1.
  7366                 24  CO-CARR-GROUP.
  7367                     28  CO-CARRIER            PIC X.
  7368                     28  CO-GROUPING.
  7369                         32  CO-GROUP-PREFIX   PIC XXX.
  7370                         32  CO-GROUP-PRIME    PIC XXX.
  7371                 24  CO-RESP-NO.
  7372                     28  CO-RESP-PREFIX        PIC X(4).
  7373                     28  CO-RESP-PRIME         PIC X(6).
  7374             20  CO-CTL-2.
  7375                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 139
* EL156.cbl
  7376                     28  CO-ACCT-PREFIX        PIC X(4).
  7377                     28  CO-ACCT-PRIME         PIC X(6).
  7378         16  CO-TYPE                           PIC X.
  7379             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7380             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7381             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7382
  7383     12  CO-MAINT-INFORMATION.
  7384         16  CO-LAST-MAINT-DT                  PIC XX.
  7385         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7386         16  CO-LAST-MAINT-USER                PIC X(4).
  7387     12  FILLER                                PIC XX.
  7388     12  CO-STMT-TYPE                          PIC XXX.
  7389     12  CO-COMP-TYPE                          PIC X.
  7390         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7391     12  CO-STMT-OWNER                         PIC X(4).
  7392     12  CO-BALANCE-CONTROL                    PIC X.
  7393         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7394         88  CO-NO-BALANCE                        VALUE 'N'.
  7395
  7396     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7397         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7398         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7399         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7400
  7401     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7402         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7403         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7404
  7405     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7406     12  CO-GA-DIRECT-DEP                      PIC X.
  7407     12  CO-FUTURE-SPACE                       PIC X.
  7408         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7409
  7410     12  CO-ACCT-NAME                          PIC X(30).
  7411     12  CO-MAIL-NAME                          PIC X(30).
  7412     12  CO-ADDR-1                             PIC X(30).
  7413     12  CO-ADDR-2                             PIC X(30).
  7414     12  CO-ADDR-3.
  7415         16  CO-ADDR-CITY                      PIC X(27).
  7416         16  CO-ADDR-STATE                     PIC XX.
  7417     12  CO-CSO-1099                           PIC X.
  7418     12  CO-ZIP.
  7419         16  CO-ZIP-PRIME.
  7420             20  CO-ZIP-PRI-1ST                PIC X.
  7421                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7422             20  FILLER                        PIC X(4).
  7423         16  CO-ZIP-PLUS4                      PIC X(4).
  7424     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7425         16  CO-CAN-POSTAL-1                   PIC XXX.
  7426         16  CO-CAN-POSTAL-2                   PIC XXX.
  7427         16  FILLER                            PIC XXX.
  7428     12  CO-SOC-SEC                            PIC X(13).
  7429     12  CO-TELEPHONE.
  7430         16  CO-AREA-CODE                      PIC XXX.
  7431         16  CO-PREFIX                         PIC XXX.
  7432         16  CO-PHONE                          PIC X(4).
  7433
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 140
* EL156.cbl
  7434     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7435
  7436     12  CO-AR-BAL-LEVEL                       PIC X.
  7437         88  CO-AR-REF-LVL                        VALUE '1'.
  7438         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7439         88  CO-AR-BILL-LVL                       VALUE '2'.
  7440         88  CO-AR-AGT-LVL                        VALUE '3'.
  7441         88  CO-AR-FR-LVL                         VALUE '4'.
  7442
  7443     12  CO-AR-NORMAL-PRINT                    PIC X.
  7444         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7445         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7446
  7447     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7448
  7449     12  CO-AR-REPORTING                       PIC X.
  7450         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7451         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7452
  7453     12  CO-AR-PULL-CHECK                      PIC X.
  7454         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7455         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7456
  7457     12  CO-AR-BALANCE-PRINT                   PIC X.
  7458         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7459
  7460     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7461         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7462         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7463         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7464
  7465     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7466
  7467     12  CO-USER-CODE                          PIC X.
  7468     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7469
  7470******************************************************************
  7471*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7472*    THE LAST MONTH END RUN.
  7473******************************************************************
  7474
  7475     12  CO-LAST-ACTIVITY-DATE.
  7476         16  CO-ACT-YEAR                       PIC 99.
  7477         16  CO-ACT-MONTH                      PIC 99.
  7478         16  CO-ACT-DAY                        PIC 99.
  7479
  7480     12  CO-LAST-STMT-DT.
  7481         16  CO-LAST-STMT-YEAR                 PIC 99.
  7482         16  CO-LAST-STMT-MONTH                PIC 99.
  7483         16  CO-LAST-STMT-DAY                  PIC 99.
  7484
  7485     12  CO-MO-END-TOTALS.
  7486         16  CO-MONTHLY-TOTALS.
  7487             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7488             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7489             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7490             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7491             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 141
* EL156.cbl
  7492
  7493         16  CO-AGING-TOTALS.
  7494             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7495             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7496             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7497             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7498
  7499         16  CO-YTD-TOTALS.
  7500             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7501             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7502
  7503         16  CO-OVER-UNDER-TOTALS.
  7504             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7505             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7506
  7507     12  CO-MISCELLANEOUS-TOTALS.
  7508         16  CO-FICA-TOTALS.
  7509             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7510             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7511
  7512         16  CO-CLAIM-TOTALS.
  7513             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7514             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7515
  7516******************************************************************
  7517*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7518*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7519******************************************************************
  7520
  7521     12  CO-CURRENT-TOTALS.
  7522         16  CO-CURRENT-LAST-STMT-DT.
  7523             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7524             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7525             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7526
  7527         16  CO-CURRENT-MONTHLY-TOTALS.
  7528             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7529             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7530             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7531             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7532             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7533
  7534         16  CO-CURRENT-AGING-TOTALS.
  7535             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7536             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7537             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7538             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7539
  7540         16  CO-CURRENT-YTD-TOTALS.
  7541             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7542             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7543
  7544     12  CO-PAID-COMM-TOTALS.
  7545         16  CO-YTD-PAID-COMMS.
  7546             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7547             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7548
  7549     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 142
* EL156.cbl
  7550         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7551         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7552
  7553     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7554         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7555         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7556         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7557         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7558         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7559         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7560         88  CO-FINAL-LETTER                  VALUE 'F'.
  7561         88  CO-RECONCILING                   VALUE 'R'.
  7562         88  CO-PHONE-CALL                    VALUE 'P'.
  7563         88  CO-LEGAL                         VALUE 'L'.
  7564         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7565         88  CO-WRITE-OFF                     VALUE 'W'.
  7566         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7567
  7568     12  CO-CSR-CODE                       PIC X(4).
  7569
  7570     12  CO-GA-STATUS-INFO.
  7571         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7572         16  CO-GA-TERMINATION-DT          PIC XX.
  7573         16  CO-GA-STATUS-CODE             PIC X.
  7574             88  CO-GA-ACTIVE                 VALUE 'A'.
  7575             88  CO-GA-INACTIVE               VALUE 'I'.
  7576             88  CO-GA-PENDING                VALUE 'P'.
  7577         16  CO-GA-COMMENTS.
  7578             20  CO-GA-COMMENT-1           PIC X(40).
  7579             20  CO-GA-COMMENT-2           PIC X(40).
  7580             20  CO-GA-COMMENT-3           PIC X(40).
  7581             20  CO-GA-COMMENT-4           PIC X(40).
  7582
  7583     12  CO-RPTCD2                         PIC X(10).
  7584     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7585         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7586         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7587
  7588     12  CO-TYPE-AGENT                     PIC X(01).
  7589         88  CO-CORPORATION                   VALUE 'C'.
  7590         88  CO-PARTNERSHIP                   VALUE 'P'.
  7591         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7592         88  CO-TRUST                         VALUE 'T'.
  7593         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7594
  7595     12  CO-FAXNO.
  7596         16  CO-FAX-AREA-CODE                  PIC XXX.
  7597         16  CO-FAX-PREFIX                     PIC XXX.
  7598         16  CO-FAX-PHONE                      PIC X(4).
  7599
  7600     12  CO-BANK-INFORMATION.
  7601         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7602         16  CO-BANK-TRANSIT-NON REDEFINES
  7603             CO-BANK-TRANSIT-NO                PIC 9(8).
  7604
  7605         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7606     12  CO-MISC-DEDUCT-INFO REDEFINES
  7607                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 143
* EL156.cbl
  7608         16  CO-MD-GL-ACCT                     PIC X(10).
  7609         16  CO-MD-DIV                         PIC XX.
  7610         16  CO-MD-CENTER                      PIC X(4).
  7611         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7612         16  CO-CREATE-AP-CHECK                PIC X.
  7613         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7614         16  FILLER                            PIC XXX.
  7615     12  CO-ACH-STATUS                         PIC X.
  7616         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7617         88  CO-ACH-PENDING                        VALUE 'P'.
  7618
  7619     12  CO-BILL-SW                            PIC X.
  7620     12  CO-CONTROL-NAME                       PIC X(30).
  7621     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7622     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7623     12  CO-CLP-STATE                          PIC XX.
  7624     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7625     12  CO-SPP-REFUND-EDIT                    PIC X.
  7626
  7627******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 144
* EL156.cbl
  7629*    COPY ERCDMDNT.
  7630******************************************************************
  7631*                                                                *
  7632*                            ERCDMDNT                            *
  7633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7634*                            VMOD=2.005                          *
  7635*                                                                *
  7636*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7637*                                                                *
  7638*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7639*                                                                *
  7640*        FILE TYPE= VSAM,KSDS                                    *
  7641*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7642*                                                                *
  7643*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7644*                                                                *
  7645*        LOG = YES                                               *
  7646*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7647*                                                                *
  7648******************************************************************
  7649
  7650 01  CERTIFICATE-NOTE.
  7651     12  CN-RECORD-ID                     PIC  XX.
  7652         88  VALID-CN-ID                      VALUE 'CN'.
  7653
  7654     12  CN-CONTROL-PRIMARY.
  7655         16  CN-COMPANY-CD                PIC X.
  7656         16  CN-CERT-KEY.
  7657             20  CN-CARRIER               PIC X.
  7658             20  CN-GROUPING.
  7659                 24  CN-GROUPING-PREFIX   PIC XXX.
  7660                 24  CN-GROUPING-PRIME    PIC XXX.
  7661             20  CN-STATE                 PIC XX.
  7662             20  CN-ACCOUNT.
  7663                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7664                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7665             20  CN-CERT-EFF-DT           PIC XX.
  7666             20  CN-CERT-NO.
  7667                 24  CN-CERT-PRIME        PIC X(10).
  7668                 24  CN-CERT-SFX          PIC X.
  7669
  7670     12  CN-BILLING-START-LINE-NO         PIC 99.
  7671     12  CN-BILLING-END-LINE-NO           PIC 99.
  7672
  7673     12  CN-LINES.
  7674         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7675
  7676     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7677         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7678         16  CN-CSI-GENERAL-DATA-AREA.
  7679             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7680
  7681         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7682             CN-CSI-GENERAL-DATA-AREA.
  7683             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7684             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7685             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7686             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 145
* EL156.cbl
  7687             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7688             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7689             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7690             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7691             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7692             20  FILLER                       PIC XX.
  7693             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7694             20  FILLER                       PIC X(38).
  7695
  7696         16  CN-CSI-PRODUCT-DATA-AREA.
  7697             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7698
  7699         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7700             CN-CSI-PRODUCT-DATA-AREA.
  7701             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7702             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7703             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7704             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7705             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7706             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7707             20  FILLER                   PIC XX.
  7708             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7709             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7710             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7711             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7712             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7713             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7714             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7715             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7716             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7717             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7718             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7719             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7720             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7721             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7722             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7723             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7724             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7725             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7726             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7727             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7728             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7729             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7730             20  FILLER                   PIC X(25).
  7731
  7732         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7733             CN-CSI-CREDIT-CARD-DATA.
  7734             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7735             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7736             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7737             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7738             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7739             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7740             20  FILLER                   PIC XX.
  7741             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7742             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7743             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7744             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 146
* EL156.cbl
  7745             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7746             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7747             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7748             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7749             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7750             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7751             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7752             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7753             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7754             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7755             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7756             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7757             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7758             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7759             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7760             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7761             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7762             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7763             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7764             20  FILLER                   PIC X(17).
  7765
  7766         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7767             CN-CSI-FAMILY-LEAVE-DATA.
  7768             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7769             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7770             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7771             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7772             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7773             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7774             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7775             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7776             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7777             20  CN-CSI-SL-INT-ON-PROCEEDS
  7778                                          PIC S9(5)V99  COMP-3.
  7779             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7780             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7781             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7782             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7783             20  CN-CSI-SL-POLICY-BENEFITS
  7784                                          PIC S9(5)V99  COMP-3.
  7785             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7786             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7787             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7788             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7789             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7790             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7791             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7792             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7793             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7794             20  CN-CSI-SL-STATE-NOT      PIC X.
  7795             20  FILLER                   PIC XX.
  7796
  7797         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7798             CN-CSI-SENIOR-LIFE-DATA.
  7799             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7800             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7801             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7802                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 147
* EL156.cbl
  7803             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7804             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7805             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7806             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7807             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7808             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7809             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7810             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7811             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7812             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7813             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7814             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7815             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7816             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7817             20  CN-CSI-PP-REPAIR         PIC X.
  7818             20  CN-CSI-PP-REPLACE        PIC X.
  7819             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7820             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7821             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7822             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7823             20  FILLER                   PIC X(5).
  7824
  7825         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7826             CN-CSI-PURCH-PROP-DATA.
  7827             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7828             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7829             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7830             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7831             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7832             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7833             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7834             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7835             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7836             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7837             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7838             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7839             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7840             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7841             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7842             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7843             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7844             20  CN-CSI-EW-REPLACE        PIC X.
  7845             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7846             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7847             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7848             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7849             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7850             20  FILLER                   PIC X(4).
  7851
  7852     12  CN-LAST-MAINT-DT                 PIC XX.
  7853     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7854     12  CN-LAST-MAINT-USER               PIC X(4).
  7855     12  FILLER                           PIC X(6).
  7856
  7857******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 148
* EL156.cbl
  7859*    COPY ERCCNOT.
  7860******************************************************************
  7861*                                                                *
  7862*                            ERCCNOT                             *
  7863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7864*                            VMOD=2.003                          *
  7865*                                                                *
  7866*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7867*                                                                *
  7868*        FILE TYPE= VSAM,KSDS                                    *
  7869*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7870*                                                                *
  7871*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7872*                                                                *
  7873*        LOG = YES                                               *
  7874*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7875*                                                                *
  7876******************************************************************
  7877*                   C H A N G E   L O G
  7878*
  7879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7880*-----------------------------------------------------------------
  7881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7882* EFFECTIVE    NUMBER
  7883*-----------------------------------------------------------------
  7884* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7885******************************************************************
  7886
  7887 01  CERT-NOTE-FILE.
  7888     12  CZ-RECORD-ID                PIC  XX.
  7889         88  VALID-CZ-ID                  VALUE 'CZ'.
  7890
  7891     12  CZ-CONTROL-PRIMARY.
  7892         16  CZ-COMPANY-CD           PIC X.
  7893         16  CZ-CARRIER              PIC X.
  7894         16  CZ-GROUPING.
  7895             20 CZ-GROUPING-PREFIX   PIC XXX.
  7896             20 CZ-GROUPING-PRIME    PIC XXX.
  7897         16  CZ-STATE                PIC XX.
  7898         16  CZ-ACCOUNT.
  7899             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7900             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7901         16  CZ-CERT-EFF-DT          PIC XX.
  7902         16  CZ-CERT-NO.
  7903             20  CZ-CERT-PRIME       PIC X(10).
  7904             20  CZ-CERT-SFX         PIC X.
  7905         16  CZ-RECORD-TYPE          PIC X.
  7906             88  CERT-NOTE           VALUE '1'.
  7907             88  CLAIM-CERT-NOTE     VALUE '2'.
  7908         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7909
  7910     12  CZ-LAST-MAINT-DT            PIC XX.
  7911     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7912     12  CZ-LAST-MAINT-USER          PIC X(4).
  7913
  7914     12  CZ-NOTE-INFORMATION.
  7915         16  CZ-NOTE                 PIC X(63).
  7916         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 149
* EL156.cbl
  7917******************************************************************
  7918*                            COPY ERCPDEF.
  7919******************************************************************
  7920*                                                                *
  7921*                                                                *
  7922*                            ERCPDEF.                            *
  7923*                                                                *
  7924*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7925*                                                                *
  7926*    FILE TYPE = VSAM,KSDS                                       *
  7927*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7928*                                                                *
  7929*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7930*                                                                *
  7931*    LOG = YES                                                   *
  7932*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7933******************************************************************
  7934*                   C H A N G E   L O G
  7935*
  7936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7937*-----------------------------------------------------------------
  7938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7939* EFFECTIVE    NUMBER
  7940*-----------------------------------------------------------------
  7941* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7942* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7943* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7944******************************************************************
  7945 01  PRODUCT-MASTER.
  7946    12  PD-RECORD-ID                 PIC X(02).
  7947        88  VALID-PD-ID                  VALUE 'PD'.
  7948    12  PD-CONTROL-PRIMARY.
  7949        16  PD-COMPANY-CD            PIC X.
  7950        16  PD-STATE                 PIC XX.
  7951        16  PD-PRODUCT-CD            PIC XXX.
  7952        16  PD-FILLER                PIC X(7).
  7953        16  PD-BEN-TYPE              PIC X.
  7954        16  PD-BEN-CODE              PIC XX.
  7955        16  PD-PROD-EXP-DT           PIC XX.
  7956    12  FILLER                       PIC X(50).
  7957    12  PD-PRODUCT-DATA OCCURS 8.
  7958        16  PD-PROD-CODE             PIC X.
  7959            88  PD-PROD-LIFE           VALUE 'L'.
  7960            88  PD-PROD-PROP           VALUE 'P'.
  7961            88  PD-PROD-AH             VALUE 'A'.
  7962            88  PD-PROD-IU             VALUE 'I'.
  7963            88  PD-PROD-GAP            VALUE 'G'.
  7964            88  PD-PROD-FAML           VALUE 'F'.
  7965        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7966        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7967        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7968        16  PD-MAX-TERM              PIC S999        COMP-3.
  7969        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7970        16  FILLER                   PIC X.
  7971        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7972        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7973        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7974        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 150
* EL156.cbl
  7975        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7976        16  PD-REC-CRIT-PERIOD       PIC 99.
  7977        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7978            20  PD-RECURRING-YN      PIC X.
  7979            20  FILLER               PIC X.
  7980        16  PD-RTW-MOS               PIC 99.
  7981        16  PD-MAX-EXTENSION         PIC 99.
  7982        16  pd-ben-pct               pic sv999 comp-3.
  7983*       16  FILLER                   PIC XX.
  7984    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7985    12  PD-TERM-LIMITS OCCURS 15.
  7986        16  PD-LOW-TERM              PIC S999        COMP-3.
  7987        16  PD-HI-TERM               PIC S999        COMP-3.
  7988*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7989    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7990        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7991        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7992    12  PD-EARN-FACTORS.
  7993        16  FILLER OCCURS 15.
  7994            20  FILLER OCCURS 15.
  7995                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7996    12  PD-PRODUCT-DESC              PIC X(80).
  7997    12  PD-TRUNCATED                 PIC X.
  7998    12  FILLER                       PIC X(59).
  7999    12  PD-MAINT-INFORMATION.
  8000        16  PD-LAST-MAINT-DT         PIC X(02).
  8001        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8002        16  PD-LAST-MAINT-BY         PIC X(04).
  8003*                            COPY ELCCRTT.
  8004******************************************************************
  8005*                                                                *
  8006*                            ELCCRTT.                            *
  8007*                                                                *
  8008*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8009*                                                                *
  8010*   FILE TYPE = VSAM,KSDS                                        *
  8011*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8012*                                                                *
  8013*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8014*                                                                *
  8015*   LOG = YES                                                    *
  8016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8017******************************************************************
  8018*                   C H A N G E   L O G
  8019*
  8020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8021*-----------------------------------------------------------------
  8022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8023* EFFECTIVE    NUMBER
  8024*-----------------------------------------------------------------
  8025* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8026* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8027* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8028* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8029* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8030* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8031* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8032******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 151
* EL156.cbl
  8033
  8034 01  CERTIFICATE-TRAILERS.
  8035     12  CS-RECORD-ID                      PIC XX.
  8036         88  VALID-CS-ID                      VALUE 'CS'.
  8037
  8038     12  CS-CONTROL-PRIMARY.
  8039         16  CS-COMPANY-CD                 PIC X.
  8040         16  CS-CARRIER                    PIC X.
  8041         16  CS-GROUPING                   PIC X(6).
  8042         16  CS-STATE                      PIC XX.
  8043         16  CS-ACCOUNT                    PIC X(10).
  8044         16  CS-CERT-EFF-DT                PIC XX.
  8045         16  CS-CERT-NO.
  8046             20  CS-CERT-PRIME             PIC X(10).
  8047             20  CS-CERT-SFX               PIC X.
  8048         16  CS-TRAILER-TYPE               PIC X.
  8049             88  COMM-TRLR           VALUE 'A'.
  8050             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8051             88  CERT-DATA-TRLR      VALUE 'C'.
  8052
  8053     12  CS-DATA-AREA                      PIC X(516).
  8054
  8055     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8056         16  CS-BANK-COMMISSION-AREA.
  8057             20  CS-BANK-COMMS       OCCURS 10.
  8058                 24  CS-AGT                PIC X(10).
  8059                 24  CS-COM-TYP            PIC X.
  8060                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8061                 24  CS-RECALC-LV-INDIC    PIC X.
  8062                 24  FILLER                PIC X(10).
  8063         16  FILLER                        PIC X(256).
  8064
  8065     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8066****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8067         16  CS-MB-CLAIM-DATA OCCURS 24.
  8068             20  CS-CLAIM-NO               PIC X(7).
  8069             20  CS-CLAIM-TYPE             PIC X.
  8070                 88  CS-AH-CLM               VALUE 'A'.
  8071                 88  CS-IU-CLM               VALUE 'I'.
  8072                 88  CS-GP-CLM               VALUE 'G'.
  8073                 88  CS-LF-CLM               VALUE 'L'.
  8074                 88  CS-PR-CLM               VALUE 'P'.
  8075                 88  CS-FL-CLM               VALUE 'F'.
  8076             20  CS-INSURED-TYPE           PIC X.
  8077                 88  CS-PRIM-INSURED          VALUE 'P'.
  8078                 88  CS-CO-BORROWER           VALUE 'C'.
  8079             20  CS-BENEFIT-PERIOD         PIC 99.
  8080             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8081             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8082             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8083         16  FILLER                        PIC X(12).
  8084     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8085         16  CS-VIN-NUMBER                 PIC X(17).
  8086         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8087         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8088         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8089         16  FILLER                        PIC X(496).
  8090 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 152
* EL156.cbl
  8091                          CONTROL-FILE CERTIFICATE-MASTER
  8092                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8093                          ACCOUNT-MASTER CHECK-QUE
  8094                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8095                          DAILY-ACTIVITY-RECORD
  8096                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8097                          CERT-NOTE-FILE PRODUCT-MASTER
  8098                          CERTIFICATE-TRAILERS.
  8099 0000-DFHEXIT SECTION.
  8100     MOVE '9#                    $   ' TO DFHEIV0.
  8101     MOVE 'EL156' TO DFHEIV1.
  8102     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8103
  8104     IF EIBCALEN = 0
  8105         GO TO 8800-UNAUTHORIZED-ACCESS.
  8106
  8107     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8108     MOVE EIBTRMID               TO QID-TERM.
  8109     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8110     MOVE '2'                    TO EMI-SWITCH2.
  8111     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8112     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8113
  8114     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8115     MOVE '5'                    TO DC-OPTION-CODE.
  8116     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8117     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8118                                    SAVE-BIN-DATE.
  8119     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8120     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8121
  8122     IF SAVE-DATE-YY > 70
  8123         MOVE 19                 TO SAVE-DATE-CC
  8124     ELSE
  8125         MOVE 20                 TO SAVE-DATE-CC.
  8126
  8127     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8128         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8129     END-IF.
  8130
  8131     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8132        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8133     ELSE
  8134        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8135     END-IF
  8136
  8137     IF PI-PRINT-CLM-FRM-YN = 'N'
  8138         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8139     ELSE
  8140         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8141     END-IF
  8142
  8143     IF PI-PRINT-SURVEY-YN = 'N'
  8144         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8145     ELSE
  8146         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8147     END-IF
  8148
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 153
* EL156.cbl
  8149     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8150         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8151     ELSE
  8152         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8153     END-IF
  8154
  8155* EXEC CICS HANDLE CONDITION
  8156*        NOTOPEN   (9990-ABEND)
  8157*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8158*        MAPFAIL   (0400-FIRST-TIME)
  8159*        DUPREC    (6180-DUPREC)
  8160*        ERROR     (9990-ABEND)
  8161*    END-EXEC.
  8162*    MOVE '"$JL?%.               ! " #00008150' TO DFHEIV0
  8163     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8165     MOVE X'2220233030303038313530' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0
  8167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8168
  8169
  8170     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8171         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8172
  8173     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8174         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8175             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8176             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8177             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8178             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8179             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8180             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8181             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8182             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8183             MOVE LOW-VALUES           TO EL156AI
  8184             MOVE 'Y'                  TO FIRST-ENTRY
  8185         ELSE
  8186             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8187             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8188             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8189             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8190             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8191             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8192             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8193             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8194
  8195     IF RETURNED-FROM NOT = SPACES
  8196        IF (RETURNED-FROM = 'EL614')
  8197           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8198           IF WS-SAVED-EOB-CODES NOT = SPACES
  8199              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8200           ELSE
  8201              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8202           END-IF
  8203        END-IF
  8204         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8205            MOVE 'Y'             TO FIRST-ENTRY
  8206            IF RETURNED-FROM = 'EL614'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 154
* EL156.cbl
  8207               AND (PI-PASS-SW NOT = 'C')
  8208               IF WS-SAVED-EOB-CODES NOT = SPACES
  8209                  MOVE WS-SAVED-EOB-CODES
  8210                                 TO PI-PMTNOTE2
  8211                                    WS-PMTNOTE2
  8212                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8213               ELSE
  8214                  MOVE SPACES    TO PI-PMTNOTE2
  8215                                    WS-PMTNOTE2
  8216                                    PI-EOB-CODES-EXIST
  8217               END-IF
  8218            END-IF
  8219            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8220            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8221            IF RETURNED-FROM = 'EL614'
  8222               GO TO 1000-EDIT-DATA
  8223            END-IF
  8224            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8225               (PAYEEI   = LOW-VALUES OR SPACES)
  8226               GO TO 8100-SEND-INITIAL-MAP
  8227            ELSE
  8228               GO TO 1000-EDIT-DATA.
  8229
  8230     IF EIBTRNID NOT = TRANS-ID
  8231         GO TO 0400-FIRST-TIME.
  8232
  8233     IF EIBAID = DFHCLEAR
  8234        IF PI-PASS-SW = 'C'
  8235           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8236           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8237           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8238           MOVE 'Y'            TO RETURNED-FROM-B
  8239           GO TO 1000-EDIT-DATA
  8240        ELSE
  8241           GO TO 9400-CLEAR.
  8242
  8243     IF PI-PASS-SW = 'C'
  8244         MOVE MAP-NAMEB          TO MAP-NAME
  8245         IF EIBAID = DFHPF1 OR DFHPF13
  8246             GO TO 5000-UPDATE
  8247           ELSE
  8248             IF EIBAID NOT = DFHENTER
  8249                 MOVE LOW-VALUES TO EL156BI
  8250                 MOVE MAP-NAMEB  TO MAP-NAME
  8251                 MOVE ER-0029    TO EMI-ERROR
  8252                 MOVE -1         TO  ENTPFBL
  8253                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8254                 GO TO 8200-SEND-DATAONLY.
  8255
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 155
* EL156.cbl
  8257 0200-RECEIVE.
  8258     MOVE LOW-VALUES             TO EL156AI.
  8259     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8260         MOVE ER-0008            TO EMI-ERROR
  8261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8262         IF PI-PASS-SW = 'C'
  8263             MOVE -1             TO ENTPFBL
  8264             GO TO 8200-SEND-DATAONLY
  8265         ELSE
  8266             MOVE -1             TO PMTTYPEL
  8267             GO TO 8200-SEND-DATAONLY.
  8268
  8269     IF PI-COMPANY-ID = 'DMD'
  8270         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8271
  8272     IF PI-PASS-SW = 'C'
  8273         MOVE MAP-NAMEB          TO MAP-NAME.
  8274
  8275
  8276* EXEC CICS RECEIVE
  8277*        MAP   (MAP-NAME)
  8278*        MAPSET(MAPSET-NAME)
  8279*        ASIS
  8280*        INTO  (EL156AI)
  8281*    END-EXEC.
  8282     MOVE LENGTH OF
  8283      EL156AI
  8284       TO DFHEIV11
  8285*    MOVE '8"TAI  L              ''   #00008263' TO DFHEIV0
  8286     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8288     MOVE X'2020233030303038323633' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0,
  8290           MAP-NAME,
  8291           EL156AI,
  8292           DFHEIV11,
  8293           MAPSET-NAME,
  8294           DFHEIV99,
  8295           DFHEIV99
  8296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8297
  8298
  8299     IF PI-PASS-SW NOT = 'C'
  8300         GO TO 0250-MAPA.
  8301
  8302     IF ENTPFBL NOT > ZERO
  8303         MOVE MAP-NAMEB          TO MAP-NAME
  8304         MOVE ER-0029            TO EMI-ERROR
  8305         MOVE -1                 TO  ENTPFBL
  8306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8307         GO TO 8200-SEND-DATAONLY.
  8308
  8309     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8310         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8311       ELSE
  8312         MOVE MAP-NAMEB           TO MAP-NAME
  8313         MOVE ER-0029             TO EMI-ERROR
  8314         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 156
* EL156.cbl
  8315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8316         GO TO 8200-SEND-DATAONLY.
  8317
  8318     IF EIBAID = DFHPF1 OR DFHPF13
  8319         IF MODIFY-CAP
  8320            GO TO 5000-UPDATE
  8321          ELSE
  8322            MOVE 'UPDATE'           TO SM-READ
  8323            PERFORM 9995-SECURITY-VIOLATION
  8324            MOVE MAP-NAMEB          TO MAP-NAME
  8325            MOVE ER-0070            TO EMI-ERROR
  8326            MOVE -1                 TO  ENTPFBL
  8327            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8328            GO TO 8200-SEND-DATAONLY.
  8329
  8330 0250-MAPA.
  8331     IF ENTERPFL = 0
  8332         GO TO 0300-CHECK-PFKEYS.
  8333
  8334     IF EIBAID NOT = DFHENTER
  8335         MOVE ER-0004            TO EMI-ERROR
  8336         GO TO 0320-INPUT-ERROR.
  8337
  8338     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8339         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8340     ELSE
  8341         MOVE ER-0029            TO EMI-ERROR
  8342         GO TO 0320-INPUT-ERROR.
  8343
  8344 0300-CHECK-PFKEYS.
  8345     IF EIBAID = DFHPF7 OR DFHPF8
  8346         GO TO 8820-PF7-8.
  8347
  8348     IF EIBAID = DFHPF23
  8349         GO TO 8810-PF23.
  8350
  8351     IF EIBAID = DFHPF24
  8352         GO TO 9200-RETURN-MAIN-MENU.
  8353
  8354     IF EIBAID = DFHPF12
  8355         GO TO 9500-PF12.
  8356
  8357     IF EIBAID = DFHPF1
  8358        IF PI-PASS-SW = 'A' OR 'B'
  8359          GO TO 0330-BROWSE-FORWARD.
  8360
  8361     IF EIBAID = DFHPF2
  8362        IF PI-PASS-SW = 'A' OR 'B'
  8363          GO TO 0350-BROWSE-BACKWARD.
  8364
  8365     IF EIBAID = DFHPF6
  8366        IF PI-EOB-CODES-EXIST = 'Y'
  8367           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8368        ELSE
  8369           MOVE SPACES              TO WS-PMTNOTE2
  8370        END-IF
  8371         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8372         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 157
* EL156.cbl
  8373            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8374         END-IF
  8375         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8376         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8377             MOVE 'EL614'        TO PGM-NAME
  8378             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8379             GO TO 9300-XCTL
  8380         ELSE
  8381             MOVE XCTL-157       TO PGM-NAME
  8382             GO TO 9300-XCTL.
  8383
  8384     IF EIBAID = DFHPF9
  8385        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8386        MOVE XCTL-141            TO PGM-NAME
  8387        GO TO 9300-XCTL.
  8388
  8389     IF EIBAID = DFHPF10
  8390        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8391        MOVE XCTL-155            TO PGM-NAME
  8392        GO TO 9300-XCTL.
  8393
  8394     MOVE SPACES                 TO ERRMSG0O
  8395                                    ERRMSG1O
  8396                                    ERRMSG2O.
  8397
  8398     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8399         IF PI-PASS-SW NOT = 'B'
  8400             MOVE ER-0422        TO EMI-ERROR
  8401             GO TO 0320-INPUT-ERROR
  8402           ELSE
  8403             GO TO 0700-TEST-FOR-CHANGES.
  8404
  8405     IF EIBAID = DFHPF11
  8406        IF PI-PASS-SW = 'C'
  8407           MOVE ER-0029          TO EMI-ERROR
  8408           GO TO 0320-INPUT-ERROR.
  8409
  8410     IF EIBAID = DFHENTER OR DFHPF11
  8411        NEXT SENTENCE
  8412     ELSE
  8413        MOVE ER-0029             TO EMI-ERROR
  8414        GO TO 0320-INPUT-ERROR.
  8415
  8416     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8417
  8418     if pi-epyfrom not = zeros
  8419        if pi-epyfrom not = ws-epyfrom
  8420           move zeros        to ws-edays
  8421        end-if
  8422     end-if
  8423
  8424     if pi-epythru not = zeros
  8425        if pi-epythru not = ws-epythru
  8426           move zeros        to ws-edays
  8427        end-if
  8428     end-if
  8429
  8430     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 158
* EL156.cbl
  8431         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8432         GO TO 1000-EDIT-DATA
  8433     ELSE
  8434         IF PI-FATAL-COUNT NOT = 0 OR
  8435            PI-FORCE-COUNT NOT = 0
  8436             GO TO 1000-EDIT-DATA
  8437         ELSE
  8438             GO TO 2000-EDIT-DONE.
  8439
  8440 0320-INPUT-ERROR.
  8441     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8442
  8443     IF ENTERPFL = 0
  8444         MOVE -1                 TO PMTTYPEL
  8445     ELSE
  8446         MOVE AL-UNBON           TO ENTERPFA
  8447         MOVE -1                 TO ENTERPFL.
  8448
  8449     GO TO 8200-SEND-DATAONLY.
  8450
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 159
* EL156.cbl
  8452 0330-BROWSE-FORWARD.
  8453
  8454     MOVE CLMNOI            TO PI-CLAIM-NO.
  8455     MOVE CARRI             TO PI-CARRIER.
  8456     MOVE CERTNOI           TO PI-CERT-PRIME.
  8457     MOVE SUFXI             TO PI-CERT-SFX.
  8458
  8459     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8460     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8461     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8462     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8463
  8464     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8465
  8466
  8467* EXEC CICS HANDLE CONDITION
  8468*         NOTFND   (0380-CLAIM-END-FILE)
  8469*         ENDFILE  (0380-CLAIM-END-FILE)
  8470*    END-EXEC.
  8471*    MOVE '"$I''                  ! # #00008437' TO DFHEIV0
  8472     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8474     MOVE X'2320233030303038343337' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0
  8476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8477
  8478
  8479
  8480* EXEC CICS STARTBR
  8481*         DATASET    ('ELMSTR')
  8482*         RIDFLD     (ELMSTR-KEY)
  8483*         GTEQ
  8484*    END-EXEC.
  8485     MOVE 'ELMSTR' TO DFHEIV1
  8486     MOVE 0
  8487       TO DFHEIV11
  8488*    MOVE '&,         G          &   #00008442' TO DFHEIV0
  8489     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8491     MOVE X'2020233030303038343432' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0,
  8493           DFHEIV1,
  8494           ELMSTR-KEY,
  8495           DFHEIV99,
  8496           DFHEIV11,
  8497           DFHEIV99
  8498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8499
  8500
  8501     MOVE 'Y' TO WS-BROWSE-START-SW.
  8502
  8503 0335-READNEXT.
  8504
  8505
  8506* EXEC CICS READNEXT
  8507*         DATASET    ('ELMSTR')
  8508*         RIDFLD     (ELMSTR-KEY)
  8509*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 160
* EL156.cbl
  8510*    END-EXEC.
  8511     MOVE 'ELMSTR' TO DFHEIV1
  8512     MOVE 0
  8513       TO DFHEIV11
  8514*    MOVE '&.S                   )   #00008452' TO DFHEIV0
  8515     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8516     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8517     MOVE X'2020233030303038343532' TO DFHEIV0(25:11)
  8518     CALL 'kxdfhei1' USING DFHEIV0,
  8519           DFHEIV1,
  8520           DFHEIV20,
  8521           DFHEIV99,
  8522           ELMSTR-KEY,
  8523           DFHEIV99,
  8524           DFHEIV11,
  8525           DFHEIV99,
  8526           DFHEIV99
  8527     SET ADDRESS OF CLAIM-MASTER TO
  8528         DFHEIV20
  8529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8530
  8531
  8532     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8533        GO TO 0380-CLAIM-END-FILE.
  8534
  8535     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8536        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8537        GO TO 0335-READNEXT.
  8538
  8539     IF PI-COMPANY-ID = 'CRI'
  8540         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8541            GO TO 0380-CLAIM-END-FILE.
  8542
  8543     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8544         GO TO 0335-READNEXT.
  8545
  8546     IF PI-CARRIER-SECURITY > SPACES
  8547         IF CL-CARRIER = PI-CARRIER-SECURITY
  8548             NEXT SENTENCE
  8549         ELSE
  8550             GO TO 0335-READNEXT.
  8551
  8552     IF PI-ACCOUNT-SECURITY > SPACES
  8553         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8554             NEXT SENTENCE
  8555         ELSE
  8556             GO TO 0335-READNEXT.
  8557
  8558     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8559     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8560     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8561
  8562     GO TO 0400-FIRST-TIME.
  8563
  8564 0350-BROWSE-BACKWARD.
  8565
  8566     MOVE CLMNOI            TO PI-CLAIM-NO
  8567                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 161
* EL156.cbl
  8568     MOVE CARRI             TO PI-CARRIER.
  8569     MOVE CERTNOI           TO PI-CERT-PRIME.
  8570     MOVE SUFXI             TO PI-CERT-SFX.
  8571
  8572     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8573
  8574     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8575     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8576     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8577
  8578
  8579* EXEC CICS HANDLE CONDITION
  8580*         NOTFND   (0380-CLAIM-END-FILE)
  8581*         ENDFILE  (0380-CLAIM-END-FILE)
  8582*    END-EXEC.
  8583*    MOVE '"$I''                  ! $ #00008504' TO DFHEIV0
  8584     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8586     MOVE X'2420233030303038353034' TO DFHEIV0(25:11)
  8587     CALL 'kxdfhei1' USING DFHEIV0
  8588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8589
  8590
  8591
  8592* EXEC CICS STARTBR
  8593*         DATASET    ('ELMSTR')
  8594*         RIDFLD     (ELMSTR-KEY)
  8595*         GTEQ
  8596*    END-EXEC.
  8597     MOVE 'ELMSTR' TO DFHEIV1
  8598     MOVE 0
  8599       TO DFHEIV11
  8600*    MOVE '&,         G          &   #00008509' TO DFHEIV0
  8601     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8602     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8603     MOVE X'2020233030303038353039' TO DFHEIV0(25:11)
  8604     CALL 'kxdfhei1' USING DFHEIV0,
  8605           DFHEIV1,
  8606           ELMSTR-KEY,
  8607           DFHEIV99,
  8608           DFHEIV11,
  8609           DFHEIV99
  8610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8611
  8612
  8613     MOVE 'Y' TO WS-BROWSE-START-SW.
  8614
  8615
  8616* EXEC CICS READNEXT
  8617*         DATASET    ('ELMSTR')
  8618*         RIDFLD     (ELMSTR-KEY)
  8619*         SET        (ADDRESS OF CLAIM-MASTER)
  8620*    END-EXEC.
  8621     MOVE 'ELMSTR' TO DFHEIV1
  8622     MOVE 0
  8623       TO DFHEIV11
  8624*    MOVE '&.S                   )   #00008517' TO DFHEIV0
  8625     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 162
* EL156.cbl
  8626     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8627     MOVE X'2020233030303038353137' TO DFHEIV0(25:11)
  8628     CALL 'kxdfhei1' USING DFHEIV0,
  8629           DFHEIV1,
  8630           DFHEIV20,
  8631           DFHEIV99,
  8632           ELMSTR-KEY,
  8633           DFHEIV99,
  8634           DFHEIV11,
  8635           DFHEIV99,
  8636           DFHEIV99
  8637     SET ADDRESS OF CLAIM-MASTER TO
  8638         DFHEIV20
  8639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8640
  8641
  8642
  8643* EXEC CICS READPREV
  8644*         DATASET    ('ELMSTR')
  8645*         RIDFLD     (ELMSTR-KEY)
  8646*         SET        (ADDRESS OF CLAIM-MASTER)
  8647*    END-EXEC.
  8648     MOVE 'ELMSTR' TO DFHEIV1
  8649     MOVE 0
  8650       TO DFHEIV11
  8651*    MOVE '&0S                   )   #00008523' TO DFHEIV0
  8652     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8654     MOVE X'2020233030303038353233' TO DFHEIV0(25:11)
  8655     CALL 'kxdfhei1' USING DFHEIV0,
  8656           DFHEIV1,
  8657           DFHEIV20,
  8658           DFHEIV99,
  8659           ELMSTR-KEY,
  8660           DFHEIV99,
  8661           DFHEIV11,
  8662           DFHEIV99,
  8663           DFHEIV99
  8664     SET ADDRESS OF CLAIM-MASTER TO
  8665         DFHEIV20
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669 0360-BROWSE-BACKWARD.
  8670
  8671
  8672* EXEC CICS READPREV
  8673*         DATASET    ('ELMSTR')
  8674*         RIDFLD     (ELMSTR-KEY)
  8675*         SET        (ADDRESS OF CLAIM-MASTER)
  8676*    END-EXEC.
  8677     MOVE 'ELMSTR' TO DFHEIV1
  8678     MOVE 0
  8679       TO DFHEIV11
  8680*    MOVE '&0S                   )   #00008531' TO DFHEIV0
  8681     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8682     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8683     MOVE X'2020233030303038353331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 163
* EL156.cbl
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           DFHEIV1,
  8686           DFHEIV20,
  8687           DFHEIV99,
  8688           ELMSTR-KEY,
  8689           DFHEIV99,
  8690           DFHEIV11,
  8691           DFHEIV99,
  8692           DFHEIV99
  8693     SET ADDRESS OF CLAIM-MASTER TO
  8694         DFHEIV20
  8695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8696
  8697
  8698     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8699        GO TO 0380-CLAIM-END-FILE.
  8700
  8701     IF PI-COMPANY-ID = 'CRI'
  8702         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8703            GO TO 0380-CLAIM-END-FILE.
  8704
  8705     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8706         GO TO 0360-BROWSE-BACKWARD.
  8707
  8708     IF PI-CARRIER-SECURITY > SPACES
  8709         IF CL-CARRIER = PI-CARRIER-SECURITY
  8710             NEXT SENTENCE
  8711         ELSE
  8712             GO TO 0360-BROWSE-BACKWARD.
  8713
  8714     IF PI-ACCOUNT-SECURITY > SPACES
  8715         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8716             NEXT SENTENCE
  8717         ELSE
  8718             GO TO 0360-BROWSE-BACKWARD.
  8719
  8720     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8721     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8722     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8723
  8724     GO TO 0400-FIRST-TIME.
  8725
  8726 0380-CLAIM-END-FILE.
  8727
  8728     MOVE ER-0130     TO EMI-ERROR.
  8729     MOVE -1          TO CLMNOL.
  8730     MOVE AL-UABON    TO CARRA
  8731                         CLMNOA
  8732                         CERTNOA
  8733                         SUFXA.
  8734
  8735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8736
  8737     GO TO 8200-SEND-DATAONLY.
  8738
  8739 0400-FIRST-TIME.
  8740
  8741     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 164
* EL156.cbl
  8742        MOVE 'N'         TO WS-BROWSE-START-SW
  8743
  8744* EXEC CICS ENDBR
  8745*            DATASET    ('ELMSTR')
  8746*       END-EXEC.
  8747     MOVE 'ELMSTR' TO DFHEIV1
  8748     MOVE 0
  8749       TO DFHEIV11
  8750*    MOVE '&2                    $   #00008582' TO DFHEIV0
  8751     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8753     MOVE X'2020233030303038353832' TO DFHEIV0(25:11)
  8754     CALL 'kxdfhei1' USING DFHEIV0,
  8755           DFHEIV1,
  8756           DFHEIV11,
  8757           DFHEIV99
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8759
  8760
  8761     IF PI-PROCESSOR-ID = 'LGXX'
  8762         NEXT SENTENCE
  8763     ELSE
  8764
  8765* EXEC CICS READQ TS
  8766*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8767*            INTO    (SECURITY-CONTROL)
  8768*            LENGTH  (SC-COMM-LENGTH)
  8769*            ITEM    (SC-ITEM)
  8770*        END-EXEC
  8771*    MOVE '*$II   L              ''   #00008589' TO DFHEIV0
  8772     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8774     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  8775     CALL 'kxdfhei1' USING DFHEIV0,
  8776           PI-SECURITY-TEMP-STORE-ID,
  8777           SECURITY-CONTROL,
  8778           SC-COMM-LENGTH,
  8779           SC-ITEM,
  8780           DFHEIV99,
  8781           DFHEIV99
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8783         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8784         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8785
  8786     MOVE LOW-VALUES             TO EL156AI.
  8787     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8788     MOVE 'Y'                    TO FIRST-ENTRY.
  8789     GO TO 7000-SHOW-CLAIM.
  8790
  8791 0500-CREATE-TEMP-STORAGE.
  8792     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8793
  8794
  8795* EXEC CICS WRITEQ TS
  8796*        QUEUE (QID)
  8797*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8798*        LENGTH(PI-COMM-LENGTH)
  8799*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 165
* EL156.cbl
  8800*    MOVE '*"                    ''   #00008606' TO DFHEIV0
  8801     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038363036' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           QID,
  8806           PROGRAM-INTERFACE-BLOCK,
  8807           PI-COMM-LENGTH,
  8808           DFHEIV99,
  8809           DFHEIV99,
  8810           DFHEIV99
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8812
  8813
  8814
  8815* EXEC CICS WRITEQ TS
  8816*        QUEUE (QID)
  8817*        FROM  (EL156AI)
  8818*        LENGTH(MAP-LENGTH)
  8819*    END-EXEC.
  8820*    MOVE '*"                    ''   #00008612' TO DFHEIV0
  8821     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8823     MOVE X'2020233030303038363132' TO DFHEIV0(25:11)
  8824     CALL 'kxdfhei1' USING DFHEIV0,
  8825           QID,
  8826           EL156AI,
  8827           MAP-LENGTH,
  8828           DFHEIV99,
  8829           DFHEIV99,
  8830           DFHEIV99
  8831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8832
  8833
  8834 0599-EXIT.
  8835      EXIT.
  8836
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 166
* EL156.cbl
  8838 0600-RECOVER-TEMP-STORAGE.
  8839
  8840* EXEC CICS READQ TS
  8841*        QUEUE (QID)
  8842*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8843*        LENGTH(PI-COMM-LENGTH)
  8844*    END-EXEC.
  8845*    MOVE '*$I    L              ''   #00008623' TO DFHEIV0
  8846     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8848     MOVE X'2020233030303038363233' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           QID,
  8851           PROGRAM-INTERFACE-BLOCK,
  8852           PI-COMM-LENGTH,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99
  8856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8857
  8858
  8859
  8860* EXEC CICS READQ TS
  8861*        QUEUE (QID)
  8862*        INTO  (EL156AI)
  8863*        LENGTH(MAP-LENGTH)
  8864*    END-EXEC.
  8865*    MOVE '*$I    L              ''   #00008629' TO DFHEIV0
  8866     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8868     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
  8869     CALL 'kxdfhei1' USING DFHEIV0,
  8870           QID,
  8871           EL156AI,
  8872           MAP-LENGTH,
  8873           DFHEIV99,
  8874           DFHEIV99,
  8875           DFHEIV99
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8877
  8878
  8879     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8880
  8881     IF PMTTYPEI NOT = LOW-VALUES
  8882         MOVE AL-UANON           TO PMTTYPEA.
  8883
  8884     IF PAYEEI NOT = LOW-VALUES
  8885         MOVE AL-UANON           TO PAYEEA.
  8886
  8887     IF NOTE1I NOT = LOW-VALUES
  8888         MOVE AL-UANON           TO NOTE1A.
  8889
  8890     IF (RETURNED-FROM = 'EL614')
  8891        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8892     END-IF
  8893*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8894*       AND (PI-EOB-CODES-EXIST = 'Y')
  8895*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 167
* EL156.cbl
  8896*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8897     IF PI-SET-NOTE2-MDT = 'Y'
  8898         MOVE AL-SANON           TO NOTE2A
  8899     END-IF
  8900
  8901     IF OFFLINEI NOT = LOW-VALUES
  8902         MOVE AL-UANON           TO OFFLINEA.
  8903
  8904*    IF GROUPEDI NOT = LOW-VALUES
  8905*        MOVE AL-UANON           TO GROUPEDA.
  8906
  8907*    IF CASHI NOT = LOW-VALUES
  8908*        MOVE AL-UANON           TO CASHA.
  8909
  8910     IF CHECKNOI NOT = LOW-VALUES
  8911         MOVE AL-UANON           TO CHECKNOA.
  8912
  8913     IF HOLDTILI NOT = LOW-VALUES
  8914         MOVE AL-UANON           TO HOLDTILA.
  8915
  8916     IF EPYFROMI NOT = LOW-VALUES
  8917         MOVE AL-UANON           TO EPYFROMA.
  8918
  8919     IF AIGFROMI NOT = LOW-VALUES
  8920         MOVE AL-UANON           TO AIGFROMA.
  8921
  8922     IF EPYTHRUI NOT = LOW-VALUES
  8923         MOVE AL-UANON           TO EPYTHRUA.
  8924
  8925     IF EDAYSI NOT = LOW-VALUES
  8926         MOVE AL-UNNON           TO EDAYSA.
  8927
  8928     IF EPYAMTL NOT = +0
  8929         MOVE AL-UNNON           TO EPYAMTA.
  8930
  8931     IF ERESVL NOT = +0
  8932         MOVE AL-UNNON           TO ERESVA.
  8933
  8934     IF EEXPENSL NOT = +0
  8935         MOVE AL-UNNON           TO EEXPENSA.
  8936
  8937     IF ETYPEI NOT = LOW-VALUES
  8938         MOVE AL-UNNON           TO ETYPEA.
  8939
  8940     IF PROOFDTI NOT = 0
  8941         MOVE AL-UNNON           TO PROOFDTA.
  8942
  8943     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8944        MOVE AL-UANON            TO EOBYNA
  8945     END-IF
  8946     IF CLMFMYNI = 'Y' OR 'N'
  8947        MOVE AL-UANON            TO CLMFMYNA
  8948     END-IF
  8949
  8950     IF SURVYYNI = 'Y' OR 'N'
  8951        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8952           MOVE AL-UANON         TO SURVYYNA
  8953        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 168
* EL156.cbl
  8954     END-IF
  8955
  8956     IF SPRELYNI = 'Y' OR 'N'
  8957        MOVE AL-UANON            TO SPRELYNA
  8958     END-IF
  8959
  8960     .
  8961 0699-EXIT.
  8962      EXIT.
  8963
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 169
* EL156.cbl
  8965 0700-TEST-FOR-CHANGES.
  8966     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8967         MOVE ER-0433            TO EMI-ERROR
  8968         GO TO 0750-FUNCTION-ERROR.
  8969
  8970     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8971
  8972     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8973         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8974         MOVE 'A'                TO PI-PASS-SW
  8975         GO TO 1000-EDIT-DATA.
  8976
  8977     IF PI-FATAL-COUNT NOT = 0
  8978         MOVE ER-0499            TO EMI-ERROR
  8979         GO TO 0750-FUNCTION-ERROR.
  8980
  8981     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8982         MOVE ER-0500            TO EMI-ERROR
  8983         GO TO 0750-FUNCTION-ERROR.
  8984
  8985     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8986        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8987           MOVE ER-0542          TO EMI-ERROR
  8988           MOVE -1               TO EPYAMTL
  8989           GO TO 0750-FUNCTION-ERROR.
  8990
  8991     IF PI-OFFLINE = 'Y'  OR
  8992        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8993        MOVE EIBAID              TO PI-PFKEY-USED
  8994        GO TO 5000-UPDATE.
  8995
  8996     GO TO 6000-BUILD-SCREEN-B.
  8997
  8998 0750-FUNCTION-ERROR.
  8999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9000
  9001     IF ENTERPFL > 0
  9002         MOVE -1                 TO ENTERPFL
  9003         MOVE AL-UNBON           TO ENTERPFA
  9004         GO TO 8200-SEND-DATAONLY
  9005     ELSE
  9006         MOVE -1                 TO ENTERPFL
  9007         MOVE AL-UNNOF           TO ENTERPFA
  9008         GO TO 8200-SEND-DATAONLY.
  9009
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 170
* EL156.cbl
  9011 0800-DELETE-TS.
  9012
  9013* EXEC CICS HANDLE CONDITION
  9014*        QIDERR(0800-EXIT)
  9015*    END-EXEC.
  9016*    MOVE '"$N                   ! % #00008768' TO DFHEIV0
  9017     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9019     MOVE X'2520233030303038373638' TO DFHEIV0(25:11)
  9020     CALL 'kxdfhei1' USING DFHEIV0
  9021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9022
  9023
  9024
  9025* EXEC CICS DELETEQ TS
  9026*        QUEUE(QID)
  9027*    END-EXEC.
  9028*    MOVE '*&                    #   #00008772' TO DFHEIV0
  9029     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9031     MOVE X'2020233030303038373732' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           QID,
  9034           DFHEIV99
  9035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9036
  9037
  9038 0800-EXIT.
  9039      EXIT.
  9040 0900-GET-DDF-LIMITS.
  9041
  9042     if cm-clp-state = zeros or spaces or low-values
  9043        move cm-state            to cm-clp-state
  9044     end-if
  9045     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9046     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9047     MOVE cm-clp-state           TO ERPDEF-STATE
  9048     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9049     evaluate true
  9050        when (cl-claim-type = 'L' or 'P')
  9051           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9052             and 'CU')
  9053           move 'L'              to erpdef-ben-type
  9054           move pi-lf-benefit-cd to erpdef-ben-code
  9055        when (cl-claim-type not = 'L' and 'P')
  9056           and (pi-ah-benefit-cd not = '00' and '  ')
  9057           move 'A'              to erpdef-ben-type
  9058           move pi-ah-benefit-cd to erpdef-ben-code
  9059        when (cl-claim-type not = 'L' and 'P')
  9060           and (pi-ah-benefit-cd = '00' or '  ')
  9061           move 'L'              to erpdef-ben-type
  9062           move pi-lf-benefit-cd to erpdef-ben-code
  9063        when (cl-claim-type = 'L' or 'P')
  9064           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9065           move 'A'              to erpdef-ben-type
  9066           move pi-ah-benefit-cd to erpdef-ben-code
  9067        when other
  9068           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 171
* EL156.cbl
  9069           move pi-ah-benefit-cd to erpdef-ben-code
  9070     end-evaluate
  9071*    if (cl-claim-type = 'L' or 'P')
  9072*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9073*          and 'CU')
  9074*       move 'L'                 to erpdef-ben-type
  9075*       move pi-lf-benefit-cd    to erpdef-ben-code
  9076*    else
  9077*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9078*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9079*    end-if
  9080     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9081
  9082     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9083
  9084
  9085* EXEC CICS STARTBR
  9086*        DATASET  ('ERPDEF')
  9087*        RIDFLD   (ERPDEF-KEY)
  9088*        GTEQ
  9089*        RESP     (WS-RESPONSE)
  9090*    END-EXEC
  9091     MOVE 'ERPDEF' TO DFHEIV1
  9092     MOVE 0
  9093       TO DFHEIV11
  9094*    MOVE '&,         G          &  N#00008822' TO DFHEIV0
  9095     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9096     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9097     MOVE X'204E233030303038383232' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           DFHEIV1,
  9100           ERPDEF-KEY,
  9101           DFHEIV99,
  9102           DFHEIV11,
  9103           DFHEIV99
  9104     MOVE EIBRESP  TO WS-RESPONSE
  9105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9106
  9107     IF NOT WS-RESP-NORMAL
  9108        GO TO 0900-EXIT
  9109     END-IF
  9110
  9111     .
  9112 0900-READNEXT.
  9113
  9114
  9115* EXEC CICS READNEXT
  9116*       DATASET  ('ERPDEF')
  9117*       SET      (ADDRESS OF PRODUCT-MASTER)
  9118*       RIDFLD   (ERPDEF-KEY)
  9119*       RESP     (WS-RESPONSE)
  9120*    END-EXEC
  9121     MOVE 'ERPDEF' TO DFHEIV1
  9122     MOVE 0
  9123       TO DFHEIV11
  9124*    MOVE '&.S                   )  N#00008836' TO DFHEIV0
  9125     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9126     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 172
* EL156.cbl
  9127     MOVE X'204E233030303038383336' TO DFHEIV0(25:11)
  9128     CALL 'kxdfhei1' USING DFHEIV0,
  9129           DFHEIV1,
  9130           DFHEIV20,
  9131           DFHEIV99,
  9132           ERPDEF-KEY,
  9133           DFHEIV99,
  9134           DFHEIV11,
  9135           DFHEIV99,
  9136           DFHEIV99
  9137     SET ADDRESS OF PRODUCT-MASTER TO
  9138         DFHEIV20
  9139     MOVE EIBRESP  TO WS-RESPONSE
  9140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9141
  9142     IF NOT WS-RESP-NORMAL
  9143        GO TO 0900-ENDBR
  9144     END-IF
  9145
  9146     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9147        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9148           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9149        ELSE
  9150           GO TO 0900-READNEXT
  9151        END-IF
  9152     ELSE
  9153        GO TO 0900-ENDBR
  9154     END-IF
  9155
  9156     IF CM-LOAN-TERM = ZEROS
  9157        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9158     END-IF
  9159
  9160     .
  9161 0900-ENDBR.
  9162
  9163
  9164* EXEC CICS ENDBR
  9165*       DATASET  ('ERPDEF')
  9166*    END-EXEC
  9167     MOVE 'ERPDEF' TO DFHEIV1
  9168     MOVE 0
  9169       TO DFHEIV11
  9170*    MOVE '&2                    $   #00008864' TO DFHEIV0
  9171     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9173     MOVE X'2020233030303038383634' TO DFHEIV0(25:11)
  9174     CALL 'kxdfhei1' USING DFHEIV0,
  9175           DFHEIV1,
  9176           DFHEIV11,
  9177           DFHEIV99
  9178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9179
  9180     .
  9181 0900-EXIT.
  9182     EXIT.
  9183 1000-EDIT-DATA.
  9184
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 173
* EL156.cbl
  9185     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9186         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9187         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9188
  9189     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9190
  9191     IF NOT MODIFY-CAP
  9192         MOVE ER-0070            TO EMI-ERROR
  9193         MOVE -1                 TO PMTTYPEL
  9194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9195         GO TO 2000-EDIT-DONE.
  9196
  9197     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9198                         '5' AND '6'
  9199         MOVE ER-0420            TO EMI-ERROR
  9200         MOVE -1                 TO PMTTYPEL
  9201         MOVE AL-UABON           TO PMTTYPEA
  9202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203     ELSE
  9204         MOVE AL-UANON           TO PMTTYPEA.
  9205
  9206*    IF PI-OFFLINE = 'Y'
  9207*       IF PI-GROUPED = 'Y'
  9208*          MOVE ER-1880         TO EMI-ERROR
  9209*          MOVE -1              TO GROUPEDL
  9210*          MOVE AL-UABON        TO GROUPEDA
  9211*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9212*
  9213*    IF GROUPEDL > +0
  9214*       IF PI-GROUPED = 'Y' OR 'N'
  9215*          MOVE AL-UANON TO GROUPEDA
  9216*       ELSE
  9217*          MOVE ER-3140            TO EMI-ERROR
  9218*          MOVE -1                 TO GROUPEDL
  9219*          MOVE AL-UABON           TO GROUPEDA
  9220*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9221*
  9222*    IF CASHL > +0
  9223*       IF PI-CASH = 'Y' OR 'N'
  9224*          MOVE AL-UANON           TO CASHA
  9225*       ELSE
  9226*          MOVE ER-3141            TO EMI-ERROR
  9227*          MOVE -1                 TO CASHL
  9228*          MOVE AL-UABON           TO CASHA
  9229*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9230
  9231     IF LOANNOL > +0
  9232         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9233
  9234 1000-EDIT-PAYEE.
  9235
  9236     IF PI-PAYEE-SEQ NOT NUMERIC
  9237         MOVE ER-0294            TO  EMI-ERROR
  9238         MOVE -1                 TO  PAYEEL
  9239         MOVE AL-UABON           TO  PAYEEA
  9240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241         GO TO 1000-CONT-EDIT.
  9242
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 174
* EL156.cbl
  9243     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9244                         'E' OR 'O' OR 'Q'
  9245         NEXT SENTENCE
  9246     ELSE
  9247         MOVE ER-0294            TO  EMI-ERROR
  9248         MOVE -1                 TO  PAYEEL
  9249         MOVE AL-UABON           TO  PAYEEA
  9250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9251         GO TO 1000-CONT-EDIT.
  9252
  9253     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9254        (PI-PAYEE-SEQ NOT < '1' AND
  9255         PI-PAYEE-SEQ NOT > '9'))
  9256      OR
  9257        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9258         (PI-PAYEE-SEQ NOT > '9'))
  9259         MOVE AL-UANON            TO PAYEEA
  9260     ELSE
  9261         MOVE ER-0294            TO EMI-ERROR
  9262         MOVE -1                 TO PAYEEL
  9263         MOVE AL-UABON           TO PAYEEA
  9264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9265
  9266     IF PI-COMPANY-ID = 'DMD'
  9267         IF PI-PAYEE-TYPE = 'B' AND
  9268            PI-PAYEE-SEQ NOT = '0'
  9269               MOVE ER-7841            TO EMI-ERROR
  9270               MOVE -1                 TO PAYEEL
  9271               MOVE AL-UABON           TO PAYEEA
  9272               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9273
  9274     IF PI-COMPANY-ID = 'JHL'
  9275         IF PI-PAYEE = 'B0'
  9276             NEXT SENTENCE
  9277           ELSE
  9278
  9279* EXEC CICS HANDLE CONDITION
  9280*            ENDFILE(1950-NOT-FOUND)
  9281*            NOTFND (1950-NOT-FOUND)
  9282*        END-EXEC
  9283*    MOVE '"$''I                  ! & #00008966' TO DFHEIV0
  9284     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9286     MOVE X'2620233030303038393636' TO DFHEIV0(25:11)
  9287     CALL 'kxdfhei1' USING DFHEIV0
  9288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9289         MOVE 'N'                    TO FOUND-TOL-SW
  9290         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9291         MOVE '2'                    TO CNTL-REC-TYPE
  9292         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9293         MOVE +0                     TO CNTL-SEQ-NO
  9294         MOVE 'PROC'                 TO FILE-SWITCH
  9295         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9296         IF PI-PAYEE = 'I1' AND
  9297            APPROVAL-LEVEL-2
  9298             NEXT SENTENCE
  9299           ELSE
  9300         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 175
* EL156.cbl
  9301             MOVE ER-3546        TO EMI-ERROR
  9302             MOVE -1             TO PAYEEL
  9303             MOVE AL-UABON       TO PAYEEA
  9304             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9305
  9306     IF PI-PAYEE-TYPE = 'E'
  9307        IF PI-PMTTYPE = '5' OR '6'
  9308            NEXT SENTENCE
  9309        ELSE
  9310            MOVE ER-3539            TO EMI-ERROR
  9311            MOVE -1                 TO PAYEEL
  9312            MOVE AL-UABON           TO PAYEEA
  9313            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9314
  9315 1000-CONT-EDIT.
  9316
  9317     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9318        IF PI-EPYAMT NOT NEGATIVE
  9319            MOVE ER-0421         TO EMI-ERROR
  9320            MOVE -1              TO OFFLINEL
  9321            MOVE AL-UABON        TO OFFLINEA
  9322            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9323        ELSE
  9324            MOVE AL-UANON        TO OFFLINEA.
  9325
  9326     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9327        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9328           CONTINUE
  9329        ELSE
  9330           IF PI-PRINT-EOB-YN = 'S' AND
  9331              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9332                CONTINUE
  9333           ELSE
  9334              MOVE ER-1561       TO EMI-ERROR
  9335              MOVE -1            TO EOBYNL
  9336              MOVE AL-UABON      TO EOBYNA
  9337              PERFORM 9900-ERROR-FORMAT
  9338                                 THRU 9900-EXIT
  9339           END-IF
  9340        END-IF
  9341
  9342        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9343            MOVE ER-1566        TO EMI-ERROR
  9344            MOVE -1             TO CLMFMYNL
  9345            MOVE AL-UABON       TO CLMFMYNA
  9346            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9347        END-IF
  9348
  9349        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9350            MOVE ER-1567        TO EMI-ERROR
  9351            MOVE -1             TO SURVYYNL
  9352            MOVE AL-UABON       TO SURVYYNA
  9353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9354        END-IF
  9355
  9356        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9357            MOVE ER-1569        TO EMI-ERROR
  9358            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 176
* EL156.cbl
  9359            MOVE AL-UABON       TO SPRELYNA
  9360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9361        END-IF
  9362
  9363     END-IF
  9364     IF PI-EPYAMT IS NEGATIVE
  9365         IF PI-OFFLINE NOT = 'Y'
  9366             MOVE ER-0836        TO  EMI-ERROR
  9367             MOVE -1             TO  OFFLINEL
  9368             MOVE AL-UABON       TO  OFFLINEA
  9369             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9370
  9371     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9372        MOVE ER-0872             TO EMI-ERROR
  9373        MOVE -1                  TO PROOFDTL
  9374        MOVE AL-UABON            TO PROOFDTA
  9375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9376     ELSE
  9377        MOVE '4'                TO DC-OPTION-CODE
  9378        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9379        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9380        IF DATE-CONVERSION-ERROR
  9381            MOVE ER-0873        TO EMI-ERROR
  9382            MOVE -1                  TO PROOFDTL
  9383            MOVE AL-UABON            TO PROOFDTA
  9384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385        ELSE
  9386            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9387            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9388                MOVE ER-0873    TO EMI-ERROR
  9389                MOVE -1                  TO PROOFDTL
  9390                MOVE AL-UABON            TO PROOFDTA
  9391                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9392            END-IF
  9393        END-IF
  9394     END-IF.
  9395
  9396     IF PI-COMPANY-ID = 'DMD'
  9397        IF NOTE1L NOT = ZEROS
  9398            MOVE ER-7844        TO  EMI-ERROR
  9399            MOVE -1             TO  NOTE1L
  9400            MOVE AL-UABON       TO  NOTE1A
  9401            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403     IF PI-COMPANY-ID = 'DMD'
  9404        IF NOTE2L NOT = ZEROS
  9405          GO TO 1004-DMD-EOB-CHECKS.
  9406
  9407     IF NOTE1L NOT > +0
  9408         GO TO 1005-CHECK-ERRORS.
  9409
  9410     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9411         GO TO 1005-CHECK-ERRORS.
  9412
  9413     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9414         GO TO 1003-HAN-PMT-NOTES.
  9415
  9416     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 177
* EL156.cbl
  9417
  9418     IF WS-PMTOPTION NUMERIC
  9419        IF WS-PMTOPTION > '00' AND < '17'
  9420           NEXT SENTENCE
  9421        ELSE
  9422           MOVE ER-0618          TO EMI-ERROR
  9423           MOVE -1               TO NOTE1L
  9424           MOVE AL-UABON         TO NOTE1A
  9425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9426     ELSE
  9427        GO TO 1005-CHECK-ERRORS.
  9428
  9429     IF WS-PMTOPTION = '05' AND
  9430        WS-DOCNAME = SPACES
  9431          MOVE ER-0616             TO EMI-ERROR
  9432          MOVE -1                  TO NOTE1L
  9433          MOVE AL-UABON            TO NOTE1A
  9434          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9435
  9436     IF WS-PMTOPTION = '15' OR '16'
  9437
  9438* EXEC CICS BIF DEEDIT
  9439*            FIELD (WS-AMOUNT)
  9440*            LENGTH(08)
  9441*        END-EXEC
  9442     MOVE 08
  9443       TO DFHEIV11
  9444*    MOVE '@"L                   #   #00009118' TO DFHEIV0
  9445     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9446     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9447     MOVE X'2020233030303039313138' TO DFHEIV0(25:11)
  9448     CALL 'kxdfhei1' USING DFHEIV0,
  9449           WS-AMOUNT,
  9450           DFHEIV11
  9451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9452        IF (WS-NUM-AMT = ZEROS) OR
  9453           (WS-AMOUNT NOT NUMERIC)
  9454           MOVE ER-0617          TO EMI-ERROR
  9455           MOVE -1               TO NOTE1L
  9456           MOVE AL-UABON         TO NOTE1A
  9457           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458
  9459     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9460
  9461     GO TO 1005-CHECK-ERRORS.
  9462
  9463 1003-HAN-PMT-NOTES.
  9464
  9465     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9466
  9467     IF WS-HAN-PMT-CODE = SPACE
  9468         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9469     ELSE
  9470     IF WS-HAN-PMT-CODE = 'A'
  9471         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9472                                 TO WS-HAN-PMT-NOTE
  9473     ELSE
  9474     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 178
* EL156.cbl
  9475         MOVE ':FINAL PAYMENT / DECEASED'
  9476                                 TO WS-HAN-PMT-NOTE
  9477     ELSE
  9478     IF WS-HAN-PMT-CODE = 'C'
  9479         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9480                                 TO WS-HAN-PMT-NOTE
  9481     ELSE
  9482     IF WS-HAN-PMT-CODE = 'D'
  9483         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9484                                 TO WS-HAN-PMT-NOTE
  9485     ELSE
  9486     IF WS-HAN-PMT-CODE = 'E'
  9487         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9488                                 TO WS-HAN-PMT-NOTE
  9489     ELSE
  9490     IF WS-HAN-PMT-CODE = 'F'
  9491         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9492                                 TO WS-HAN-PMT-NOTE
  9493     ELSE
  9494     IF WS-HAN-PMT-CODE = 'P'
  9495         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9496
  9497     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9498     GO TO 1005-CHECK-ERRORS.
  9499
  9500 1004-DMD-EOB-CHECKS.
  9501
  9502     INITIALIZE PI-AT-EOB-CODES.
  9503
  9504     IF NOTE2I (20:21) > SPACES
  9505         MOVE ER-7845          TO EMI-ERROR
  9506         MOVE -1               TO NOTE2L
  9507         MOVE AL-UABON         TO NOTE2A
  9508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9509         GO TO 1005-CHECK-ERRORS
  9510      ELSE
  9511         MOVE NOTE2I             TO W-EOB-CODES.
  9512
  9513     MOVE +1                     TO W-EOB-NDX.
  9514
  9515 1004-CHECK-EACH-EOB.
  9516
  9517     IF W-EOB-NDX > +5
  9518             OR
  9519        W-EOB-CODE (W-EOB-NDX) = SPACES
  9520         GO TO 1004-CHECK-DUP-EOB.
  9521
  9522     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9523         MOVE ER-0956            TO EMI-ERROR
  9524         MOVE -1                 TO NOTE2L
  9525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9526         GO TO 1005-CHECK-ERRORS.
  9527
  9528     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9529     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9530     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9531     MOVE 'DLO023'               TO PGM-NAME.
  9532
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 179
* EL156.cbl
  9533
  9534* EXEC CICS LINK
  9535*        PROGRAM    (PGM-NAME)
  9536*        COMMAREA   (CD-COMMUNICATION-AREA)
  9537*        LENGTH     (CD-RCRD-LENGTH)
  9538*    END-EXEC.
  9539*    MOVE '."C                   (   #00009203' TO DFHEIV0
  9540     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9542     MOVE X'2020233030303039323033' TO DFHEIV0(25:11)
  9543     CALL 'kxdfhei1' USING DFHEIV0,
  9544           PGM-NAME,
  9545           CD-COMMUNICATION-AREA,
  9546           CD-RCRD-LENGTH,
  9547           DFHEIV99,
  9548           DFHEIV99,
  9549           DFHEIV99,
  9550           DFHEIV99
  9551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9552
  9553
  9554     IF CD-RETURN-CODE = 'OK'
  9555         GO TO 1004-CONT.
  9556
  9557     MOVE -1                     TO NOTE2L.
  9558
  9559     IF CD-RETURN-CODE = '01'
  9560         MOVE ER-8310            TO EMI-ERROR
  9561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9562         GO TO 1005-CHECK-ERRORS.
  9563
  9564     IF CD-RETURN-CODE = '02'
  9565         MOVE ER-8311            TO EMI-ERROR
  9566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9567         GO TO 1005-CHECK-ERRORS.
  9568
  9569     IF CD-RETURN-CODE = '03'
  9570         MOVE ER-8312            TO EMI-ERROR
  9571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9572         GO TO 1005-CHECK-ERRORS.
  9573
  9574     IF CD-RETURN-CODE = '04'
  9575         MOVE ER-8313            TO EMI-ERROR
  9576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9577         GO TO 1005-CHECK-ERRORS.
  9578
  9579     IF CD-RETURN-CODE = '05'
  9580         MOVE ER-8314            TO EMI-ERROR
  9581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9582         GO TO 1005-CHECK-ERRORS.
  9583
  9584     IF CD-RETURN-CODE = '06'
  9585         MOVE ER-8315            TO EMI-ERROR
  9586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9587         GO TO 1005-CHECK-ERRORS.
  9588
  9589     IF CD-RETURN-CODE = 'E1'
  9590         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 180
* EL156.cbl
  9591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9592         GO TO 1005-CHECK-ERRORS.
  9593
  9594     IF CD-RETURN-CODE = 'N1'
  9595         MOVE ER-8317            TO EMI-ERROR
  9596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9597         GO TO 1005-CHECK-ERRORS.
  9598
  9599 1004-CONT.
  9600     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9601
  9602     ADD +1 TO W-EOB-NDX.
  9603     GO TO 1004-CHECK-EACH-EOB.
  9604
  9605 1004-CHECK-DUP-EOB.
  9606     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9607         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9608                               PI-AT-EOB-CODE (3) OR
  9609                               PI-AT-EOB-CODE (4) OR
  9610                               PI-AT-EOB-CODE (5)))
  9611                  OR
  9612        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9613         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9614                               PI-AT-EOB-CODE (4) OR
  9615                               PI-AT-EOB-CODE (5)))
  9616                  OR
  9617        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9618         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9619                               PI-AT-EOB-CODE (5)))
  9620                  OR
  9621        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9622         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9623            MOVE ER-8000            TO EMI-ERROR
  9624            MOVE AL-UABON           TO NOTE2A
  9625            MOVE -1                 TO NOTE2L
  9626            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9627            GO TO 1005-CHECK-ERRORS.
  9628
  9629 1005-CHECK-ERRORS.
  9630*    IF PI-COMPANY-ID NOT = 'DMD'
  9631        GO TO 1006-CHECK-ERRORS.
  9632
  9633*********  DMD CODE START ******************
  9634*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9635*       GO TO 1006-CHECK-ERRORS.
  9636*
  9637*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9638*
  9639*    COMPUTE W-PAYMENT-TOTAL
  9640*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9641*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9642*               AND
  9643*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9644*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9645*          MOVE ER-0967    TO EMI-ERROR
  9646*          MOVE -1         TO PMTTYPEL
  9647*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9648*
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 181
* EL156.cbl
  9649*    GO TO 1006-CHECK-ERRORS.
  9650*********  DMD CODE END ******************
  9651
  9652 1006-CHECK-ERRORS.
  9653     IF NOT EMI-NO-ERRORS
  9654        GO TO 2000-EDIT-DONE.
  9655
  9656
  9657* EXEC CICS HANDLE CONDITION
  9658*        NOTFND(1950-NOT-FOUND)
  9659*    END-EXEC.
  9660*    MOVE '"$I                   ! '' #00009311' TO DFHEIV0
  9661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9663     MOVE X'2720233030303039333131' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667
  9668     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9669     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9670     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9671     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9672     MOVE 'MSTR'                 TO FILE-SWITCH.
  9673
  9674     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9675
  9676     IF PI-COMPANY-ID = 'DMD'
  9677         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9678
  9679     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9680        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9681           MOVE ER-0873    TO EMI-ERROR
  9682           MOVE -1                  TO PROOFDTL
  9683           MOVE AL-UABON            TO PROOFDTA
  9684           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9685        END-IF
  9686     END-IF
  9687     if cl-benefit-period = zeros
  9688        move er-1667             to emi-error
  9689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9690     end-if
  9691     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9692     MOVE +95                    TO TRLR-SEQ-NO
  9693
  9694* EXEC CICS READ
  9695*       DATASET  ('ELTRLR')
  9696*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9697*       RIDFLD   (ELTRLR-KEY)
  9698*       RESP     (WS-RESPONSE)
  9699*    END-EXEC
  9700     MOVE 'ELTRLR' TO DFHEIV1
  9701*    MOVE '&"S        E          (  N#00009340' TO DFHEIV0
  9702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9704     MOVE X'204E233030303039333430' TO DFHEIV0(25:11)
  9705     CALL 'kxdfhei1' USING DFHEIV0,
  9706           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 182
* EL156.cbl
  9707           DFHEIV20,
  9708           DFHEIV99,
  9709           ELTRLR-KEY,
  9710           DFHEIV99,
  9711           DFHEIV99,
  9712           DFHEIV99
  9713     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9714         DFHEIV20
  9715     MOVE EIBRESP  TO WS-RESPONSE
  9716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9717
  9718     if ws-resp-normal
  9719        perform varying s1 from +1 by +1 until
  9720           at-note-error-no (s1) = spaces
  9721           if at-note-error-no (s1) = '1662'
  9722              continue
  9723           else
  9724              move at-note-error-no (s1)
  9725                                 to emi-error
  9726              if at-note-error-no (s1) = '1653'
  9727                 evaluate true
  9728                    when cl-claim-type = 'L'
  9729                       move '  LF  '
  9730                                 to emi-claim-type
  9731                    when cl-claim-type = 'I'
  9732                       move '  IU  '
  9733                                 to emi-claim-type
  9734                    when cl-claim-type = 'A'
  9735                       move '  AH  '
  9736                                 to emi-claim-type
  9737                    when other
  9738                       move ' FMLA '
  9739                                 to emi-claim-type
  9740                 end-evaluate
  9741              end-if
  9742              PERFORM 9900-ERROR-FORMAT
  9743                                 THRU 9900-EXIT
  9744           end-if
  9745        end-perform
  9746     end-if
  9747     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9748         IF PI-PMTTYPE = '5' OR '6'
  9749             NEXT SENTENCE
  9750         ELSE
  9751             MOVE ER-0555             TO EMI-ERROR
  9752             MOVE -1                  TO PMTTYPEL
  9753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9754
  9755     IF CL-LAST-CLOSE-REASON = '2'
  9756         IF CL-CLAIM-STATUS = 'C'
  9757             MOVE ER-0760        TO  EMI-ERROR
  9758             MOVE -1             TO  PMTTYPEL
  9759             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9760
  9761     IF PI-ACTIVITY-CODE = 9
  9762         MOVE ER-3538            TO  EMI-ERROR
  9763         MOVE -1                 TO  PMTTYPEL
  9764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 183
* EL156.cbl
  9765
  9766     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9767         GO TO 1008-READ-CERT.
  9768**********************AIG LOGIC STARTS *********************
  9769     IF CL-CERT-PRIME = 'INCOMPLETE'
  9770         MOVE ER-3540            TO  EMI-ERROR
  9771         MOVE -1                 TO  PMTTYPEL
  9772         MOVE AL-UABON           TO  PMTTYPEA
  9773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9774         GO TO 2000-EDIT-DONE.
  9775
  9776     IF PI-PMTTYPE = '4'
  9777         IF PI-EPYAMT IS NEGATIVE
  9778             IF PI-ECHECKNO-CR = 'CR'
  9779                 NEXT SENTENCE
  9780             ELSE
  9781                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9782
  9783     IF PI-PMTTYPE = '4'
  9784         IF PI-ECHECKNO-CR = 'CR'
  9785             IF PI-EPYAMT IS NEGATIVE
  9786                 NEXT SENTENCE
  9787             ELSE
  9788                 MOVE ER-0834    TO  EMI-ERROR
  9789                 MOVE -1         TO  EPYAMTL
  9790                 MOVE AL-UNBON   TO  EPYAMTA
  9791                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9792
  9793     IF PI-PMTTYPE = '4'
  9794         IF PI-EPYAMT IS NEGATIVE
  9795             IF PI-OFFLINE = 'Y'
  9796                 NEXT SENTENCE
  9797             ELSE
  9798                 MOVE 'Y'        TO  PI-OFFLINE
  9799                                     WS-OFFLINE
  9800                                     OFFLINEO
  9801                 MOVE AL-UANON   TO  OFFLINEA.
  9802
  9803*    IF PI-PMTTYPE = '4'
  9804*        IF PI-EPYAMT IS NEGATIVE
  9805*            IF PI-CASH = 'Y'
  9806*                NEXT SENTENCE
  9807*            ELSE
  9808*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9809*                MOVE AL-UANON   TO  CASHA
  9810*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9811*
  9812*    IF PI-CASH NOT = 'Y' AND 'N'
  9813*         IF PI-OFFLINE = 'Y'  AND
  9814*            PI-ECHECKNO-CR = 'CR'
  9815*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9816*              MOVE AL-UANON     TO  CASHA
  9817*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9818*
  9819*    IF PI-CASH NOT = 'Y' AND 'N'
  9820*        IF PI-PMTTYPE = '5' OR '6'
  9821*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9822*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 184
* EL156.cbl
  9823*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9824*
  9825*    IF PI-CASH NOT = 'Y' AND 'N'
  9826*       IF CL-ASSOCIATES = 'N' OR 'A'
  9827*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9828*           MOVE AL-UANON        TO  CASHA
  9829*       ELSE
  9830*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9831*           MOVE AL-UANON        TO  CASHA.
  9832*
  9833*    IF PI-PMTTYPE = '5' OR '6'
  9834*        IF PI-CASH = 'N'
  9835*            MOVE ER-0819        TO  EMI-ERROR
  9836*            MOVE AL-UANON       TO  CASHA
  9837*            MOVE -1             TO  CASHL
  9838*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9839*
  9840*    IF CL-ASSOCIATES = 'N' OR 'A'
  9841*       IF CASHI = 'N'
  9842*        MOVE ER-3537            TO  EMI-ERROR
  9843*        MOVE AL-UANON           TO  CASHA
  9844*        MOVE -1                 TO  CASHL
  9845*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9846
  9847 1007-DEFAULT-AIG-CHECKNO.
  9848
  9849     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9850         MOVE ER-3532            TO  EMI-ERROR
  9851         MOVE -1                 TO  PMTTYPEL
  9852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9853**********************AIG LOGIC ENDS ***********************
  9854
  9855 1008-READ-CERT.
  9856
  9857     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9858     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9859     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9860     MOVE CL-CERT-STATE          TO CERT-STATE.
  9861     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9862     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9863     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9864     MOVE 'CERT'                 TO FILE-SWITCH.
  9865
  9866     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9867
  9868     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9869        MOVE CM-LF-LOAN-EXPIRE-DT
  9870                                 TO WS-EXP-DT PI-EXP-DT
  9871                                    ws-extended-exp-dt
  9872     ELSE
  9873        MOVE CM-AH-LOAN-EXPIRE-DT
  9874                                 TO WS-EXP-DT PI-EXP-DT
  9875                                    ws-extended-exp-dt
  9876     end-if
  9877     if pi-dcc-product-code not = spaces
  9878        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9879        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9880        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 185
* EL156.cbl
  9881                                 THRU 0900-EXIT
  9882        IF PDEF-FOUND
  9883           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9884              (P1 > +8)
  9885              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9886           END-PERFORM
  9887           IF P1 < +9
  9888              MOVE '6'           TO DC-OPTION-CODE
  9889              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9890              MOVE PD-MAX-EXTENSION (P1)
  9891                                 TO DC-ELAPSED-MONTHS
  9892              PERFORM 9700-LINK-DATE-CONVERT
  9893                                 THRU 9700-EXIT
  9894              if no-conversion-error
  9895                 move dc-bin-date-2 to ws-extended-exp-dt
  9896              end-if
  9897           else
  9898              move er-1674       to emi-error
  9899              PERFORM 9900-ERROR-FORMAT
  9900                                 THRU 9900-EXIT
  9901           end-if
  9902        end-if
  9903     end-if
  9904*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9905*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9906
  9907     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9908         MOVE ER-0458            TO EMI-ERROR
  9909         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9910
  9911     IF (CL-INCURRED-DT > WS-EXP-DT)
  9912        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9913        MOVE ER-1677             TO EMI-ERROR
  9914        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9915     END-IF
  9916     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9917     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9918         MOVE ER-0459            TO EMI-ERROR
  9919         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9920
  9921     IF CL-REPORTED-DT = LOW-VALUES
  9922        MOVE ER-0530             TO EMI-ERROR
  9923        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9924
  9925     IF PI-COMPANY-ID = 'NCL'
  9926        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9927            MOVE ER-0770            TO EMI-ERROR
  9928            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9929
  9930     IF PI-COMPANY-ID = 'NCL'
  9931        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9932            MOVE ER-0737            TO EMI-ERROR
  9933            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9934
  9935     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9936         MOVE ER-0768            TO  EMI-ERROR
  9937         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9938
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 186
* EL156.cbl
  9939     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9940         MOVE ER-0769            TO  EMI-ERROR
  9941         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9942
  9943     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9944         GO TO 1020-DO-LIFE-EDITS
  9945     ELSE
  9946         GO TO 1030-DO-AH-EDITS.
  9947
  9948 1010-GENERAL-ERROR.
  9949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9950
  9951     IF EMI-MESSAGE-FORMATTED
  9952         MOVE -1                 TO PMTTYPEL.
  9953
  9954 1010-EXIT.
  9955     EXIT.
  9956
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 187
* EL156.cbl
  9958 1020-DO-LIFE-EDITS.
  9959     IF CM-LF-BENEFIT-CD = '00'
  9960         IF PI-PMTTYPE = '5' OR '6'
  9961             MOVE ER-0658        TO EMI-ERROR
  9962             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9963         ELSE
  9964            if (pi-company-id = 'DCC')
  9965               and (pi-dcc-product-code not = spaces)
  9966               continue
  9967            else
  9968               MOVE ER-1775      TO EMI-ERROR
  9969               PERFORM 1040-PMTTYPE-ERROR
  9970                                 THRU 1040-EXIT
  9971            end-if
  9972         end-if
  9973     end-if
  9974
  9975     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9976     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9977         MOVE ER-0460            TO EMI-ERROR
  9978         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9979
  9980     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9981     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9982     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9983     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9984     MOVE '4'                    TO  CNTL-REC-TYPE.
  9985     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9986     MOVE 'BENE'                 TO  FILE-SWITCH.
  9987     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9988     IF NO-BENEFIT-FOUND
  9989         GO TO 1950-NOT-FOUND.
  9990
  9991     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9992
  9993     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9994         IF PI-PMTTYPE = '4'
  9995             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9996                PI-LF-COVERAGE-TYPE = 'P'
  9997                 NEXT SENTENCE
  9998             ELSE
  9999                 MOVE ER-0461        TO EMI-ERROR
 10000                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10001         ELSE
 10002            NEXT SENTENCE
 10003     ELSE
 10004         IF PI-PMTTYPE = '2'
 10005            IF NOT CM-O-B-COVERAGE
 10006              AND CM-LF-CURRENT-STATUS = '7'
 10007                MOVE ER-0462     TO EMI-ERROR
 10008                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10009
 10010     IF PI-PMTTYPE = '2'
 10011         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10012            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10013             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10014             MOVE ER-0730            TO  EMI-ERROR
 10015             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 188
* EL156.cbl
 10016             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10017
 10018     IF PI-PMTTYPE = '2'
 10019         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10020            PI-LF-COVERAGE-TYPE = 'P'
 10021             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10022                 MOVE ER-0462    TO  EMI-ERROR
 10023                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10024
 10025     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10026       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10027         MOVE ER-0466            TO EMI-ERROR
 10028         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10029
 10030     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10031         IF PI-PMTTYPE = '3'
 10032             MOVE 0436           TO EMI-ERROR
 10033             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10034             GO TO 1045-EDIT-PAYEE-ADDR
 10035         ELSE
 10036             GO TO 1045-EDIT-PAYEE-ADDR.
 10037
 10038     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10039        PI-LF-COVERAGE-TYPE = 'P'
 10040         IF PI-PMTTYPE = '3'
 10041             MOVE ER-0436          TO  EMI-ERROR
 10042             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10043         ELSE
 10044             NEXT SENTENCE
 10045     ELSE
 10046         IF PI-PMTTYPE = '1' OR '3'
 10047             MOVE ER-0436            TO EMI-ERROR
 10048             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10049*
 10050     IF PI-COMPANY-ID = 'CID' AND
 10051        CL-CERT-STATE = 'SC'  AND
 10052        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10053           MOVE ER-0879    TO  EMI-ERROR
 10054           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10055           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10056     END-IF.
 10057     IF PI-COMPANY-ID = 'AHL'
 10058        evaluate true
 10059           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10060              MOVE ER-0879       TO  EMI-ERROR
 10061              PERFORM 1040-PMTTYPE-ERROR
 10062                                 THRU 1040-EXIT
 10063              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10064           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10065                 '6D' OR '6H' OR '6R'
 10066              MOVE ER-0879       TO  EMI-ERROR
 10067              PERFORM 1040-PMTTYPE-ERROR
 10068                                 THRU 1040-EXIT
 10069              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10070           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10071              MOVE ER-0879       TO  EMI-ERROR
 10072              PERFORM 1040-PMTTYPE-ERROR
 10073                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 189
* EL156.cbl
 10074              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10075        end-evaluate
 10076     END-IF
 10077     GO TO 1045-EDIT-PAYEE-ADDR.
 10078
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 190
* EL156.cbl
 10080 1030-DO-AH-EDITS.
 10081     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10082     IF CM-AH-BENEFIT-CD = '00'
 10083         IF PI-PMTTYPE = '5' OR '6'
 10084             MOVE ER-0658        TO EMI-ERROR
 10085             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10086         ELSE
 10087             MOVE ER-1775        TO EMI-ERROR
 10088             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10089
 10090     IF CL-TOTAL-PAID-AMT = ZEROS
 10091         IF PI-PMTTYPE = '4'
 10092             MOVE ER-0438        TO EMI-ERROR
 10093             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10094
 10095     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10096         IF PI-PMTTYPE = '3'
 10097             MOVE ER-0463        TO EMI-ERROR
 10098             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10099         ELSE
 10100             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10101              AND CM-LF-CURRENT-STATUS = '7'
 10102                 MOVE ER-0465    TO EMI-ERROR
 10103                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10104
 10105     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10106         IF PI-PMTTYPE = '3'
 10107             MOVE ER-0464        TO EMI-ERROR
 10108             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10109         ELSE
 10110             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10111                 MOVE ER-0469    TO EMI-ERROR
 10112                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10113
 10114     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10115         IF PI-PMTTYPE = '3'
 10116             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10117                 MOVE ER-0467    TO EMI-ERROR
 10118                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10119             ELSE
 10120                 NEXT SENTENCE
 10121         ELSE
 10122             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10123                 MOVE ER-0468    TO EMI-ERROR
 10124                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10125
 10126     GO TO 1045-EDIT-PAYEE-ADDR.
 10127
 10128 1040-PMTTYPE-ERROR.
 10129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10130
 10131     IF EMI-MESSAGE-FORMATTED
 10132         MOVE -1                 TO PMTTYPEL
 10133         MOVE AL-UABON           TO PMTTYPEA.
 10134
 10135 1040-EXIT.
 10136     EXIT.
 10137
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 191
* EL156.cbl
 10139 1045-EDIT-PAYEE-ADDR.
 10140
 10141     IF PI-OFFLINE = 'N' AND
 10142        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10143           < PI-PAYEE-SEQ-NUM)
 10144        OR
 10145         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10146         (PI-PAYEE-TYPE = 'B')                 AND
 10147         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10148        OR
 10149         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10150           < PI-PAYEE-SEQ-NUM)
 10151        OR
 10152         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10153           < PI-PAYEE-SEQ-NUM)
 10154        OR
 10155         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10156           < PI-PAYEE-SEQ-NUM)
 10157        OR
 10158         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10159           < PI-PAYEE-SEQ-NUM)
 10160        OR
 10161         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10162           < PI-PAYEE-SEQ-NUM))
 10163             MOVE ER-0437        TO EMI-ERROR
 10164             MOVE -1             TO PAYEEL
 10165             MOVE AL-UABON       TO PAYEEA
 10166             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10167
 10168     IF PI-OFFLINE    = 'N' AND
 10169        PI-PAYEE-TYPE = 'B' AND
 10170        PI-PAYEE-SEQ  = '0'
 10171         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10172         IF BENE-FOUND-SW = 'N'
 10173             MOVE ER-0437        TO EMI-ERROR
 10174             MOVE -1             TO PAYEEL
 10175             MOVE AL-UABON       TO PAYEEA
 10176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10177
 10178     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10179        IF PI-OFFLINE    = 'N'  AND
 10180           PI-PAYEE-TYPE = 'B'  AND
 10181           PI-PAYEE-SEQ  = '9'
 10182             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10183             IF BENE-FOUND-SW = 'N'
 10184                MOVE ER-0437        TO EMI-ERROR
 10185                MOVE -1             TO PAYEEL
 10186                MOVE AL-UABON       TO PAYEEA
 10187                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10188
 10189*    IF PI-COMPANY-ID = 'CRI'
 10190*        IF CL-CLAIM-TYPE = 'L'
 10191*            MOVE 'N'                TO  WS-GROUPED
 10192*                                        PI-GROUPED
 10193*                                        GROUPEDI
 10194*            MOVE AL-UANON           TO  GROUPEDA
 10195*            GO TO 1050-EDIT-CHECK-NO
 10196*        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 192
* EL156.cbl
 10197*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10198*            IF WS-GROUP-1 = 'C'
 10199*                NEXT SENTENCE
 10200*            ELSE
 10201*                MOVE 'N'            TO  WS-GROUPED
 10202*                                        PI-GROUPED
 10203*                                        GROUPEDI
 10204*                MOVE AL-UANON       TO  GROUPEDA
 10205*                GO TO 1050-EDIT-CHECK-NO.
 10206
 10207*     IF PI-GROUPED = 'Y'
 10208*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10209*           NEXT SENTENCE
 10210*        ELSE
 10211*           MOVE ER-0437        TO EMI-ERROR
 10212*           MOVE -1             TO PAYEEL
 10213**02180            MOVE AL-UABON       TO PAYEEA
 10214*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10215*
 10216*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10217*        (PI-GROUPED    = ' ')
 10218*        NEXT SENTENCE
 10219*     ELSE
 10220*
 10221     GO TO 1050-EDIT-CHECK-NO.
 10222*     IF PI-COMPANY-ID = 'CRI'
 10223*        MOVE 'N'           TO GROUPEDI
 10224*                              PI-GROUPED
 10225*                              WS-GROUPED
 10226*        MOVE AL-UANON      TO GROUPEDA.
 10227*
 10228*     IF PI-COMPANY-ID = 'CRI'
 10229*        IF PI-PAYEE-TYPE = 'B'
 10230*           IF BENE-FOUND-SW = 'Y'
 10231*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10232*                 MOVE 'Y'           TO GROUPEDI
 10233*                                       PI-GROUPED
 10234*                                       WS-GROUPED
 10235*                 MOVE AL-UANON      TO GROUPEDA
 10236*              ELSE
 10237*                 NEXT SENTENCE
 10238*           ELSE
 10239*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10240*              IF BENE-FOUND-SW = 'Y'
 10241*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10242*                    MOVE 'Y'      TO GROUPEDI
 10243*                                     PI-GROUPED
 10244*                                     WS-GROUPED
 10245*                    MOVE AL-UANON TO GROUPEDA.
 10246*
 10247
 10248     IF PI-COMPANY-ID NOT = 'CRI'
 10249        GO TO 1050-EDIT-CHECK-NO.
 10250
 10251*************** CRI CODE START ******************
 10252     IF PI-PAYEE-TYPE NOT = 'A'
 10253        GO TO 1050-EDIT-CHECK-NO.
 10254
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 193
* EL156.cbl
 10255     MOVE LOW-VALUES             TO ERACCT-KEY.
 10256     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10257     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10258     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10259     MOVE PI-STATE               TO ACCT-STATE.
 10260     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10261     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10262     MOVE 'ACCT'                 TO FILE-SWITCH.
 10263
 10264     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10265     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10266
 10267
 10268* EXEC CICS HANDLE CONDITION
 10269*         NOTFND   (1950-NOT-FOUND)
 10270*         ENDFILE  (1950-NOT-FOUND)
 10271*    END-EXEC.
 10272*    MOVE '"$I''                  ! ( #00009896' TO DFHEIV0
 10273     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10275     MOVE X'2820233030303039383936' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0
 10277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10278
 10279
 10280
 10281* EXEC CICS STARTBR
 10282*         DATASET   ('ERACCT')
 10283*         RIDFLD    (ERACCT-KEY)
 10284*         GTEQ
 10285*    END-EXEC.
 10286     MOVE 'ERACCT' TO DFHEIV1
 10287     MOVE 0
 10288       TO DFHEIV11
 10289*    MOVE '&,         G          &   #00009901' TO DFHEIV0
 10290     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10292     MOVE X'2020233030303039393031' TO DFHEIV0(25:11)
 10293     CALL 'kxdfhei1' USING DFHEIV0,
 10294           DFHEIV1,
 10295           ERACCT-KEY,
 10296           DFHEIV99,
 10297           DFHEIV11,
 10298           DFHEIV99
 10299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10300
 10301
 10302 1046-READNEXT-ERACCT.
 10303
 10304
 10305* EXEC CICS READNEXT
 10306*         DATASET   ('ERACCT')
 10307*         RIDFLD    (ERACCT-KEY)
 10308*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10309*    END-EXEC.
 10310     MOVE 'ERACCT' TO DFHEIV1
 10311     MOVE 0
 10312       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 194
* EL156.cbl
 10313*    MOVE '&.S                   )   #00009909' TO DFHEIV0
 10314     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10315     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10316     MOVE X'2020233030303039393039' TO DFHEIV0(25:11)
 10317     CALL 'kxdfhei1' USING DFHEIV0,
 10318           DFHEIV1,
 10319           DFHEIV20,
 10320           DFHEIV99,
 10321           ERACCT-KEY,
 10322           DFHEIV99,
 10323           DFHEIV11,
 10324           DFHEIV99,
 10325           DFHEIV99
 10326     SET ADDRESS OF ACCOUNT-MASTER TO
 10327         DFHEIV20
 10328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10329
 10330
 10331     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10332        IF WS-ERACCT-HOLD-RECORD = SPACES
 10333           GO TO 1950-NOT-FOUND
 10334        ELSE
 10335           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10336           GO TO 1048-CONTINUE.
 10337
 10338     IF ACCT-EXP-DT = HIGH-VALUES
 10339        NEXT SENTENCE
 10340     ELSE
 10341        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10342        GO TO 1046-READNEXT-ERACCT.
 10343
 10344 1048-CONTINUE.
 10345
 10346*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10347*       MOVE 'Y'                 TO GROUPEDI
 10348*                                   PI-GROUPED
 10349*                                   WS-GROUPED
 10350*       MOVE AL-UANON            TO GROUPEDA.
 10351*************** CRI CODE END ******************
 10352
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 195
* EL156.cbl
 10354 1050-EDIT-CHECK-NO.
 10355
 10356     IF PI-OFFLINE = 'Y'
 10357         IF PI-ECHECKNO = SPACES
 10358              MOVE ER-0439        TO EMI-ERROR
 10359              GO TO 1090-CHECK-NO-ERROR
 10360           ELSE
 10361*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10362*           IF PI-ECHECKNO-N = 'N' AND
 10363*              PI-CASH       = 'Y'
 10364*                MOVE ER-3535        TO EMI-ERROR
 10365*                GO TO 1090-CHECK-NO-ERROR
 10366*             ELSE
 10367*                MOVE AL-UANON    TO CHECKNOA
 10368*                GO TO 1100-EDIT-HOLDTIL
 10369*         ELSE
 10370            MOVE AL-UANON    TO CHECKNOA
 10371            GO TO 1100-EDIT-HOLDTIL.
 10372
 10373     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10374     MOVE '6'                    TO CNTL-REC-TYPE.
 10375
 10376     IF CONTROL-IS-ACTUAL-CARRIER
 10377         MOVE PI-CARRIER         TO WS-CARR
 10378     ELSE
 10379         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10380
 10381     IF PI-COMPANY-ID = 'FIA'
 10382         MOVE PI-CARRIER         TO WS-CARR.
 10383
 10384     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10385     MOVE 0                      TO CNTL-SEQ-NO.
 10386     MOVE 'CARR'                 TO FILE-SWITCH.
 10387
 10388     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10389
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 196
* EL156.cbl
 10391     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10392         GO TO 1051-EDIT-CHECKNO-CONT.
 10393
 10394**********************AIG LOGIC STARTS**********************
 10395     IF PI-ECHECKNO = SPACES
 10396         IF CHECK-NO-MANUAL
 10397             MOVE ER-0441        TO EMI-ERROR
 10398             GO TO 1090-CHECK-NO-ERROR
 10399         ELSE
 10400             MOVE AL-UANOF       TO CHECKNOA
 10401             GO TO 1100-EDIT-HOLDTIL.
 10402
 10403     IF PI-ECHECKNO NOT = SPACES
 10404         IF CHECK-NO-MANUAL
 10405             MOVE AL-UANON       TO CHECKNOA
 10406             GO TO 1100-EDIT-HOLDTIL.
 10407
 10408     IF PI-ECHECKNO-CR = 'CR'
 10409        IF PI-OFFLINE = 'Y'
 10410            MOVE AL-UANON       TO CHECKNOA
 10411            GO TO 1100-EDIT-HOLDTIL
 10412        ELSE
 10413            MOVE ER-3534        TO EMI-ERROR
 10414            GO TO 1090-CHECK-NO-ERROR.
 10415
 10416     IF PI-ECHECKNO-N = 'N'
 10417        IF PI-CASH = 'N'
 10418            MOVE AL-UANON       TO CHECKNOA
 10419            GO TO 1100-EDIT-HOLDTIL
 10420        ELSE
 10421            MOVE ER-3535          TO EMI-ERROR
 10422            GO TO 1090-CHECK-NO-ERROR.
 10423
 10424     MOVE ER-0442        TO EMI-ERROR
 10425     GO TO 1090-CHECK-NO-ERROR.
 10426**********************AIG LOGIC ENDS************************
 10427
 10428 1051-EDIT-CHECKNO-CONT.
 10429
 10430     IF PI-COMPANY-ID = 'DMD'
 10431        IF PI-ECHECKNO NOT = SPACES
 10432           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10433              MOVE ER-0442        TO EMI-ERROR
 10434              GO TO 1090-CHECK-NO-ERROR
 10435            ELSE
 10436              GO TO 1100-EDIT-HOLDTIL
 10437          ELSE
 10438           GO TO 1100-EDIT-HOLDTIL.
 10439
 10440     IF PI-ECHECKNO = SPACES
 10441         IF CHECK-NO-MANUAL
 10442             MOVE ER-0441        TO EMI-ERROR
 10443             GO TO 1090-CHECK-NO-ERROR
 10444         ELSE
 10445             MOVE AL-UANOF       TO CHECKNOA
 10446             GO TO 1100-EDIT-HOLDTIL
 10447     ELSE
 10448         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 197
* EL156.cbl
 10449             MOVE AL-UANON       TO CHECKNOA
 10450             GO TO 1100-EDIT-HOLDTIL
 10451         ELSE
 10452             MOVE ER-0442        TO EMI-ERROR
 10453             GO TO 1090-CHECK-NO-ERROR.
 10454
 10455 1090-CHECK-NO-ERROR.
 10456     MOVE -1                     TO CHECKNOL.
 10457     MOVE AL-UABON               TO CHECKNOA.
 10458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10459
 10460     GO TO 2000-EDIT-DONE.
 10461
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 198
* EL156.cbl
 10463 1100-EDIT-HOLDTIL.
 10464     MOVE AL-UANON               TO HOLDTILA.
 10465
 10466     IF PI-HOLDTIL = ZEROS
 10467        IF PI-OFFLINE = 'Y'
 10468           MOVE ER-0572          TO EMI-ERROR
 10469           GO TO 1105-HOLDTIL-ERROR
 10470        ELSE
 10471           GO TO 1110-EDIT-PAID-FROM.
 10472
 10473     MOVE '4'                    TO DC-OPTION-CODE.
 10474     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10475     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10476
 10477     IF DATE-CONVERSION-ERROR
 10478         MOVE ER-0446            TO EMI-ERROR
 10479         GO TO 1105-HOLDTIL-ERROR
 10480     END-IF
 10481     IF PI-OFFLINE = 'Y'
 10482        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10483           MOVE ER-0446            TO EMI-ERROR
 10484           GO TO 1105-HOLDTIL-ERROR
 10485        END-IF
 10486     END-IF
 10487
 10488     IF PI-OFFLINE = 'Y'
 10489        GO TO 1110-EDIT-PAID-FROM.
 10490
 10491     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10492     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10493     MOVE '1'                    TO DC-OPTION-CODE.
 10494     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10495
 10496     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10497         MOVE ER-0447            TO EMI-ERROR
 10498         GO TO 1105-HOLDTIL-ERROR.
 10499
 10500     GO TO 1110-EDIT-PAID-FROM.
 10501
 10502 1105-HOLDTIL-ERROR.
 10503     MOVE -1                     TO HOLDTILL.
 10504     MOVE AL-UNBON               TO HOLDTILA.
 10505     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10506
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 199
* EL156.cbl
 10508 1110-EDIT-PAID-FROM.
 10509     MOVE AL-UANON               TO EPYFROMA.
 10510
 10511     IF PI-EPYFROM = ZEROS
 10512         GO TO 1120-CALCULATE-PAID-FROM.
 10513
 10514     IF PI-PMTTYPE = '5' OR '6'
 10515         MOVE ER-0448            TO EMI-ERROR
 10516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10517         MOVE AL-UNBON           TO EPYFROMA
 10518         MOVE -1                 TO EPYFROML
 10519         GO TO 1150-EDIT-PAID-THRU.
 10520
 10521     MOVE '4'                    TO DC-OPTION-CODE.
 10522     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10523     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10524
 10525     IF DATE-CONVERSION-ERROR
 10526         MOVE ER-0449            TO EMI-ERROR
 10527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10528         MOVE AL-UNBON           TO EPYFROMA
 10529         MOVE -1                 TO EPYFROML
 10530     ELSE
 10531         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10532
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 200
* EL156.cbl
 10534 1120-CALCULATE-PAID-FROM.
 10535     IF PI-PMTTYPE = '5' OR '6'
 10536         GO TO 1150-EDIT-PAID-THRU.
 10537
 10538*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10539*       IF PI-PMTTYPE = '4'
 10540*         GO TO 1150-EDIT-PAID-THRU.
 10541
 10542     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10543         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10544         MOVE ' '                TO DC-OPTION-CODE
 10545         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10546         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10547         GO TO 1145-TEST-PAID-FROM.
 10548
 10549     IF PI-PMTTYPE = '4'
 10550        GO TO 1150-EDIT-PAID-THRU.
 10551
 10552     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10553     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10554     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10555     MOVE '5'                    TO CNTL-REC-TYPE.
 10556     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10557     MOVE 'BENE'                 TO FILE-SWITCH.
 10558
 10559     IF WS-BEN-CD = ZEROS
 10560         GO TO 1950-NOT-FOUND.
 10561
 10562     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10563
 10564     IF NO-BENEFIT-FOUND
 10565         GO TO 1950-NOT-FOUND.
 10566
 10567     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10568     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10569
 10570     IF PI-BEN-DAYS NOT NUMERIC
 10571        MOVE ZEROS               TO PI-BEN-DAYS.
 10572
 10573     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10574
 10575     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10576        (CL-TOTAL-PAID-AMT > ZEROS)
 10577         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10578         MOVE '6'                 TO DC-OPTION-CODE
 10579         MOVE +0                  TO DC-ELAPSED-MONTHS
 10580         MOVE +1                  TO DC-ELAPSED-DAYS
 10581         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10582         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10583         GO TO 1145-TEST-PAID-FROM.
 10584
 10585******************************************************************
 10586****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10587****** SPECIAL ENTERED DATE.
 10588******************************************************************
 10589
 10590     IF PI-AIGFROM = ZEROS
 10591         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 201
* EL156.cbl
 10592
 10593     MOVE AL-UANON TO AIGFROMA.
 10594
 10595     MOVE '4'                    TO DC-OPTION-CODE.
 10596     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10597     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10598
 10599     IF DATE-CONVERSION-ERROR
 10600         MOVE ER-0449            TO EMI-ERROR
 10601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10602         MOVE AL-UNBON           TO AIGFROMA
 10603         MOVE -1                 TO AIGFROML
 10604         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10605     ELSE
 10606         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10607         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10608
 10609     GO TO 1140-CONTINUE-PAID-FROM.
 10610
 10611 1130-CONTINUE-PAID-FROM.
 10612
 10613     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10614        (CL-TOTAL-PAID-AMT = ZEROS)
 10615           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10616
 10617 1140-CONTINUE-PAID-FROM.
 10618
 10619     IF PI-BEN-TYPE = 'R'
 10620         IF PI-BEN-DAYS = ZEROS
 10621             NEXT SENTENCE
 10622         ELSE
 10623         IF PI-COMPANY-ID NOT = 'DMD'
 10624             SUBTRACT 1 FROM PI-BEN-DAYS.
 10625
 10626     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10627
 10628     IF PI-COMPANY-ID = 'DMD'
 10629         MOVE -1                 TO DC-ELAPSED-DAYS
 10630         MOVE +0                 TO DC-ELAPSED-MONTHS
 10631         MOVE '6'                TO DC-OPTION-CODE
 10632         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10633         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10634         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10635                               REMAINDER DC-ELAPSED-DAYS
 10636      ELSE
 10637         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10638         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10639
 10640     MOVE '6'                    TO DC-OPTION-CODE.
 10641     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10642     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10643
 10644     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10645
 10646     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10647         MOVE ER-0541            TO EMI-ERROR
 10648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10649         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 202
* EL156.cbl
 10650         MOVE AL-UNBON           TO EPYFROMA.
 10651
 10652     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10653        (PI-BENEFIT-SAVE = '60E')
 10654        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10655           (CL-TOTAL-PAID-AMT = ZEROS)
 10656             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10657             MOVE 30                  TO DC-ELAPSED-DAYS
 10658             MOVE +0                  TO DC-ELAPSED-MONTHS
 10659             MOVE '6'                 TO DC-OPTION-CODE
 10660             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10661
 10662     IF PI-BEN-TYPE = 'R'
 10663         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10664     ELSE
 10665         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10666         IF WS-SV-EPYFROM = LOW-VALUES
 10667            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10668
 10669     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10670         IF WS-USE-AIG-PAYFROM   OR
 10671            WS-AIG-RECALC-PAYFROM
 10672              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10673                                      DC-BIN-DATE-1
 10674              MOVE ' '            TO  DC-OPTION-CODE
 10675              MOVE +0             TO  DC-ELAPSED-MONTHS
 10676                                      DC-ELAPSED-DAYS
 10677              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10678              IF NO-CONVERSION-ERROR
 10679                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10680
 10681     IF PI-CPYFROM < CL-INCURRED-DT
 10682        MOVE -1                  TO EPYFROML
 10683        MOVE ER-3542             TO EMI-ERROR
 10684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10685
 10686     IF CM-ENTRY-DT < CL-INCURRED-DT
 10687        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10688        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10689        MOVE +0                     TO DC-ELAPSED-DAYS
 10690        MOVE +0                     TO DC-ELAPSED-MONTHS
 10691        MOVE '1'                    TO DC-OPTION-CODE
 10692        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10693        ELSE
 10694        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10695
 10696     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10697         NEXT SENTENCE
 10698     ELSE
 10699         IF DC-ELAPSED-MONTHS < 2
 10700             MOVE ER-3255        TO EMI-ERROR
 10701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10702
 10703 1145-TEST-PAID-FROM.
 10704     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10705         GO TO 1150-EDIT-PAID-THRU.
 10706
 10707     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 203
* EL156.cbl
 10708         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10709         MOVE ' '                TO DC-OPTION-CODE
 10710         MOVE +0                 TO DC-ELAPSED-MONTHS
 10711                                    DC-ELAPSED-DAYS
 10712         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10713         IF NO-CONVERSION-ERROR
 10714             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10715         ELSE
 10716             MOVE SPACES             TO EMI-DATE-FIELD.
 10717
 10718     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10719         IF CL-TOTAL-PAID-AMT = ZEROS
 10720             MOVE ER-3543            TO EMI-ERROR
 10721             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10722             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10723             IF EMI-MESSAGE-FORMATTED
 10724                MOVE -1             TO EPYFROML
 10725                MOVE AL-UNBON       TO EPYFROMA
 10726             ELSE
 10727                NEXT SENTENCE
 10728         ELSE
 10729             MOVE ER-0452            TO EMI-ERROR
 10730             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10732             IF EMI-MESSAGE-FORMATTED
 10733                MOVE -1             TO EPYFROML
 10734                MOVE AL-UNBON       TO EPYFROMA.
 10735
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 204
* EL156.cbl
 10737 1150-EDIT-PAID-THRU.
 10738
 10739     MOVE AL-UANON               TO EPYTHRUA.
 10740
 10741     IF PI-EPYTHRU = ZEROS
 10742         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10743             GO TO 1200-EDIT-FIND-TOLERANCES
 10744         ELSE
 10745            IF (PI-PMTTYPE = '3') OR
 10746               (PI-PMTTYPE = '2' AND
 10747                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10748               GO TO 1152-CHECK-TYPE
 10749            ELSE
 10750               MOVE ER-0473      TO EMI-ERROR
 10751               GO TO 1170-PAID-THRU-FATAL-ERROR
 10752     ELSE
 10753         IF PI-PMTTYPE = '5' OR '6'
 10754             MOVE ER-0474        TO EMI-ERROR
 10755             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10756
 10757     MOVE '4'                    TO DC-OPTION-CODE.
 10758     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10759     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10760
 10761     IF DATE-CONVERSION-ERROR
 10762         MOVE ER-0475            TO EMI-ERROR
 10763         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10764
 10765     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10766
 10767     IF PI-COMPANY-ID = 'DMD'
 10768         IF PI-PMTTYPE NOT = '2'
 10769                 AND
 10770            WS-EXP-DT > WS-SV-EPYTHRU
 10771             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10772             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10773             MOVE '1'              TO DC-OPTION-CODE
 10774             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10775             IF DATE-CONVERSION-ERROR
 10776                 MOVE ER-0944      TO EMI-ERROR
 10777                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10778             ELSE
 10779                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10780                    DC-ELAPSED-DAYS   = 1
 10781                     MOVE ER-0945  TO EMI-ERROR
 10782                     MOVE -1       TO EPYTHRUL
 10783                     MOVE AL-UABON TO EPYTHRUA
 10784                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786     IF PI-PMTTYPE = '4'
 10787         NEXT SENTENCE
 10788     ELSE
 10789         IF WS-SV-EPYTHRU = WS-EXP-DT
 10790             IF PI-PMTTYPE NOT = '2' AND '3'
 10791                 MOVE ER-3541    TO EMI-ERROR
 10792                 MOVE -1         TO PMTTYPEL
 10793                 MOVE AL-UABON   TO PMTTYPEA
 10794                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 205
* EL156.cbl
 10795
 10796     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10797         MOVE ER-0501            TO EMI-ERROR
 10798         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10799
 10800     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10801        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10802*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10803*              MOVE ER-0540         TO EMI-ERROR
 10804*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10805*              MOVE -1              TO EPYTHRUL
 10806*              MOVE AL-UNBON        TO EPYTHRUA
 10807*          ELSE
 10808*          IF PI-COMPANY-ID = 'DMD'
 10809*              MOVE ER-7540         TO EMI-ERROR
 10810*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10811*              MOVE -1              TO EPYTHRUL
 10812*              MOVE AL-UNBON        TO EPYTHRUA
 10813*          ELSE
 10814               IF PI-PMTTYPE NOT = '2' AND '3'
 10815                  IF PI-COMPANY-ID = '???'
 10816                      MOVE ER-7540  TO EMI-ERROR
 10817                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10818                      MOVE -1       TO EPYTHRUL
 10819                      MOVE AL-UNBON TO EPYTHRUA
 10820                  ELSE
 10821                      MOVE ER-0540  TO EMI-ERROR
 10822                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10823                      MOVE -1       TO EPYTHRUL
 10824                      MOVE AL-UNBON TO EPYTHRUA.
 10825
 10826     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10827            OR
 10828        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10829         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10830            OR
 10831        (PI-CPYFROM NOT = LOW-VALUES AND
 10832         PI-CPYFROM < CL-PAID-THRU-DT)
 10833        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10834
 10835 1152-CHECK-TYPE.
 10836     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10837        OR (PI-PMTTYPE = '5' OR '6')
 10838         GO TO 1160-EDIT-PAID-THRU-AH.
 10839
 10840 1155-EDIT-PAID-THRU-LIFE.
 10841     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10842     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10843     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10844     MOVE '4'                    TO CNTL-REC-TYPE.
 10845     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10846     MOVE 'BENE'                 TO FILE-SWITCH.
 10847
 10848     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10849
 10850     IF NO-BENEFIT-FOUND
 10851         GO TO 1950-NOT-FOUND.
 10852
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 206
* EL156.cbl
 10853     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10854
 10855     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10856
 10857     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10858        PI-LF-COVERAGE-TYPE = 'P'
 10859         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10860         GO TO 1200-EDIT-FIND-TOLERANCES.
 10861
 10862     IF PI-EPYTHRU = ZEROS
 10863        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10864
 10865     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10866         MOVE ER-0476            TO EMI-ERROR
 10867         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10868
 10869     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10870*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10871     move cl-critical-period    to dc-elapsed-months
 10872     MOVE +0                    TO DC-ELAPSED-DAYS.
 10873     MOVE '6'                   TO DC-OPTION-CODE.
 10874     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10875
 10876     IF (NO-CONVERSION-ERROR AND
 10877         WS-SPECIAL-CALC-CD = 'C')
 10878        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10879            MOVE ER-0657 TO EMI-ERROR
 10880            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10881
 10882     IF PI-COMPANY-ID = 'NCL'
 10883         IF WS-SPECIAL-CALC-CD = 'C' AND
 10884            cl-critical-period = zeros
 10885*           CM-LF-CRITICAL-PERIOD = +0
 10886             MOVE ER-0844       TO EMI-ERROR
 10887             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10888
 10889     GO TO 1200-EDIT-FIND-TOLERANCES.
 10890
 10891 1160-EDIT-PAID-THRU-AH.
 10892     IF PI-EPYTHRU = ZEROS
 10893        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10894                                    WS-SV-EPYTHRU
 10895     ELSE
 10896        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10897
 10898     IF WS-SV-EPYTHRU < PI-CPYFROM
 10899         MOVE ER-0508            TO EMI-ERROR
 10900         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10901
 10902     perform 7975-read-acct      thru 7975-exit
 10903     move zeros                  to pi-max-ext
 10904     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10905        PERFORM 0900-GET-DDF-LIMITS
 10906                                 THRU 0900-EXIT
 10907        IF PDEF-FOUND
 10908           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10909              (P1 > +8)
 10910              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 207
* EL156.cbl
 10911           END-PERFORM
 10912           IF P1 < +9
 10913              MOVE PD-MAX-extension (P1)
 10914                                 TO pi-max-ext
 10915           else
 10916              move er-1674       to emi-error
 10917              PERFORM 9900-ERROR-FORMAT
 10918                                 THRU 9900-EXIT
 10919           END-IF
 10920        else
 10921           move er-1672          to emi-error
 10922           PERFORM 9900-ERROR-FORMAT
 10923                                 THRU 9900-EXIT
 10924        END-IF
 10925     end-if
 10926     move spaces                 to pi-max-ext-used
 10927     IF PI-PMTTYPE = '3'
 10928        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10929        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10930           MOVE ER-0477          TO EMI-ERROR
 10931           PERFORM 1165-PAID-THRU-ERROR
 10932                                 THRU 1165-EXIT
 10933        ELSE
 10934           continue
 10935        end-if
 10936     ELSE
 10937        IF WS-SV-EPYTHRU > WS-EXP-DT
 10938           move ws-exp-dt        to dc-bin-date-1
 10939           move ws-sv-epythru    to dc-bin-date-2
 10940           MOVE '1'              TO DC-OPTION-CODE
 10941           MOVE +0               TO DC-ELAPSED-DAYS
 10942                                    DC-ELAPSED-MONTHS
 10943           PERFORM 9700-LINK-DATE-CONVERT
 10944                                 THRU 9700-EXIT
 10945           if no-conversion-error
 10946              if dc-elapsed-days > zeros
 10947                 add +1 to dc-elapsed-months
 10948              end-if
 10949              if dc-elapsed-months > pi-max-ext
 10950                 MOVE ER-0557    TO EMI-ERROR
 10951                 PERFORM 1165-PAID-THRU-ERROR
 10952                                 THRU 1165-EXIT
 10953              else
 10954                 move 'Y'        to pi-max-ext-used
 10955                 move er-1670    to emi-error
 10956                 perform 9900-error-format
 10957                                 thru 9900-exit
 10958              end-if
 10959           end-if
 10960        end-if
 10961     end-if
 10962
 10963     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10964         PI-PMTTYPE NOT = '3'
 10965         MOVE ER-0541        TO EMI-ERROR
 10966         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10967
 10968     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 208
* EL156.cbl
 10969        (PI-PMTTYPE NOT = '3')
 10970         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10971             MOVE ER-0478        TO EMI-ERROR
 10972             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10973
 10974     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10975        (PI-PMTTYPE NOT = '4')
 10976         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10977             MOVE ER-0479        TO EMI-ERROR
 10978             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10979
 10980     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10981         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10982             MOVE ER-0545        TO EMI-ERROR
 10983             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10984
 10985     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10986         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10987             MOVE ER-0481        TO EMI-ERROR
 10988             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10989
 10990*    IF PI-COMPANY-ID = 'NCL'
 10991*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10992*           CM-AH-CRITICAL-PERIOD = +0
 10993*            MOVE ER-0844        TO  EMI-ERROR
 10994*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10995
 10996*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10997     if (cl-critical-period = zeros)
 10998        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10999          GO TO 1200-EDIT-FIND-TOLERANCES.
 11000
 11001     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11002     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11003     MOVE '1'        TO DC-OPTION-CODE.
 11004     MOVE +0         TO DC-ELAPSED-DAYS
 11005                        DC-ELAPSED-MONTHS.
 11006     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11007
 11008*    IF NO-CONVERSION-ERROR
 11009*       COMPUTE ws-benefits-paid =
 11010*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11011*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11012*           MOVE ER-0657 TO EMI-ERROR
 11013*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11014
 11015     GO TO 1200-EDIT-FIND-TOLERANCES.
 11016
 11017 1165-PAID-THRU-ERROR.
 11018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11019
 11020     IF EMI-MESSAGE-FORMATTED
 11021         MOVE -1                 TO EPYTHRUL
 11022         MOVE AL-UNBON           TO EPYTHRUA.
 11023
 11024 1165-EXIT.
 11025     EXIT.
 11026
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 209
* EL156.cbl
 11027 1166-CHECK-ALL-TRLRS.
 11028
 11029     IF PI-PMTTYPE = '4'
 11030        GO TO 1166-TRLR-EXIT.
 11031
 11032     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11033
 11034     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11035        WS-SV-EPYFROM = LOW-VALUES
 11036          GO TO 1166-END-CHECK.
 11037
 11038
 11039* EXEC CICS HANDLE CONDITION
 11040*        ENDFILE   (1166-END-CHECK)
 11041*        NOTFND    (1166-END-CHECK)
 11042*    END-EXEC.
 11043*    MOVE '"$''I                  ! ) #00010622' TO DFHEIV0
 11044     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11046     MOVE X'2920233030303130363232' TO DFHEIV0(25:11)
 11047     CALL 'kxdfhei1' USING DFHEIV0
 11048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11049
 11050
 11051     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11052     MOVE +100                   TO TRLR-SEQ-NO.
 11053
 11054
 11055* EXEC CICS STARTBR
 11056*         DATASET    ('ELTRLR')
 11057*         RIDFLD     (ELTRLR-KEY)
 11058*         GTEQ
 11059*    END-EXEC.
 11060     MOVE 'ELTRLR' TO DFHEIV1
 11061     MOVE 0
 11062       TO DFHEIV11
 11063*    MOVE '&,         G          &   #00010630' TO DFHEIV0
 11064     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11065     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11066     MOVE X'2020233030303130363330' TO DFHEIV0(25:11)
 11067     CALL 'kxdfhei1' USING DFHEIV0,
 11068           DFHEIV1,
 11069           ELTRLR-KEY,
 11070           DFHEIV99,
 11071           DFHEIV11,
 11072           DFHEIV99
 11073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11074
 11075
 11076     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11077
 11078 1166-READ-TRLR-NEXT.
 11079
 11080
 11081* EXEC CICS READNEXT
 11082*         DATASET    ('ELTRLR')
 11083*         RIDFLD     (ELTRLR-KEY)
 11084*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 210
* EL156.cbl
 11085*    END-EXEC.
 11086     MOVE 'ELTRLR' TO DFHEIV1
 11087     MOVE 0
 11088       TO DFHEIV11
 11089*    MOVE '&.S                   )   #00010640' TO DFHEIV0
 11090     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11091     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11092     MOVE X'2020233030303130363430' TO DFHEIV0(25:11)
 11093     CALL 'kxdfhei1' USING DFHEIV0,
 11094           DFHEIV1,
 11095           DFHEIV20,
 11096           DFHEIV99,
 11097           ELTRLR-KEY,
 11098           DFHEIV99,
 11099           DFHEIV11,
 11100           DFHEIV99,
 11101           DFHEIV99
 11102     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11103         DFHEIV20
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11108        TRLR-CARRIER  = MSTR-CARRIER  AND
 11109        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11110        TRLR-CERT-NO  = MSTR-CERT-NO
 11111          NEXT SENTENCE
 11112      ELSE
 11113          GO TO 1166-END-CHECK.
 11114
 11115* **  BYPASS ALL NON-PAYMENT TRAILERS
 11116
 11117     IF AT-TRAILER-TYPE = '2'
 11118        NEXT SENTENCE
 11119     ELSE
 11120        GO TO 1166-READ-TRLR-NEXT.
 11121
 11122* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11123
 11124     IF AT-PAYMENT-TYPE = '1' OR '2'
 11125        NEXT SENTENCE
 11126     ELSE
 11127        GO TO 1166-READ-TRLR-NEXT.
 11128
 11129* **  BYPASS ALL VOID PAYMENTS
 11130
 11131     IF AT-VOID-DT NOT = LOW-VALUES
 11132        GO TO 1166-READ-TRLR-NEXT.
 11133
 11134     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11135        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11136          GO TO 1166-READ-TRLR-NEXT.
 11137
 11138     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11139         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11140            OR
 11141        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11142         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 211
* EL156.cbl
 11143        NEXT SENTENCE
 11144     ELSE
 11145         IF CL-TOTAL-PAID-AMT > ZEROS
 11146             MOVE ER-0502            TO EMI-ERROR
 11147             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11148             MOVE -1                 TO EPYTHRUL
 11149             MOVE AL-UNBON           TO EPYTHRUA.
 11150
 11151     GO TO 1166-READ-TRLR-NEXT.
 11152
 11153 1166-END-CHECK.
 11154
 11155     IF WS-BROWSE-TRLR-SW = 'Y'
 11156
 11157* EXEC CICS ENDBR
 11158*            DATASET   ('ELTRLR')
 11159*       END-EXEC.
 11160     MOVE 'ELTRLR' TO DFHEIV1
 11161     MOVE 0
 11162       TO DFHEIV11
 11163*    MOVE '&2                    $   #00010695' TO DFHEIV0
 11164     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11165     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11166     MOVE X'2020233030303130363935' TO DFHEIV0(25:11)
 11167     CALL 'kxdfhei1' USING DFHEIV0,
 11168           DFHEIV1,
 11169           DFHEIV11,
 11170           DFHEIV99
 11171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11172
 11173
 11174     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11175
 11176 1166-TRLR-EXIT.
 11177     EXIT.
 11178
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 212
* EL156.cbl
 11180 1170-PAID-THRU-FATAL-ERROR.
 11181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11182
 11183     MOVE -1                     TO EPYTHRUL.
 11184     MOVE AL-UNBON               TO EPYTHRUA.
 11185
 11186 1200-EDIT-FIND-TOLERANCES.
 11187
 11188* EXEC CICS HANDLE CONDITION
 11189*        ENDFILE(1950-NOT-FOUND)
 11190*        NOTFND (1950-NOT-FOUND)
 11191*    END-EXEC.
 11192*    MOVE '"$''I                  ! * #00010712' TO DFHEIV0
 11193     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11195     MOVE X'2A20233030303130373132' TO DFHEIV0(25:11)
 11196     CALL 'kxdfhei1' USING DFHEIV0
 11197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11198
 11199
 11200     IF PI-PROCESSOR-ID = 'LGXX'
 11201        GO TO 1240-FIND-ACCT-TOLERANCES.
 11202
 11203     MOVE 'N'                    TO FOUND-TOL-SW.
 11204     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11205     MOVE '2'                    TO CNTL-REC-TYPE.
 11206     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11207     MOVE +0                     TO CNTL-SEQ-NO.
 11208     MOVE 'PROC'                 TO FILE-SWITCH.
 11209
 11210     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11211
 11212     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11213     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11214                                    PI-MAX-PMT-TOL.
 11215     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11216
 11217     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11218         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11219
 11220     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11221     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11222                                    PI-MAX-LF-PMT-TOL.
 11223
 11224     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11225         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11226
 11227     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11228                                    PI-MAX-EXP-PMT.
 11229
 11230 1240-FIND-ACCT-TOLERANCES.
 11231
 11232     IF WS-PMT-TOL NOT = +0
 11233         MOVE 'Y'                TO FOUND-TOL-SW.
 11234
 11235     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11236         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11237         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 213
* EL156.cbl
 11238         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11239         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11240         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11241         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11242     ELSE
 11243         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11244         MOVE PI-CARRIER             TO ACCT-CARRIER
 11245         MOVE PI-GROUPING            TO ACCT-GROUPING
 11246         MOVE PI-STATE               TO ACCT-STATE
 11247         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11248         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11249
 11250     MOVE 'ACCT'                 TO FILE-SWITCH.
 11251
 11252     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11253     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11254
 11255
 11256* EXEC CICS HANDLE CONDITION
 11257*         NOTFND   (1950-NOT-FOUND)
 11258*         ENDFILE  (1950-NOT-FOUND)
 11259*    END-EXEC.
 11260*    MOVE '"$I''                  ! + #00010772' TO DFHEIV0
 11261     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11263     MOVE X'2B20233030303130373732' TO DFHEIV0(25:11)
 11264     CALL 'kxdfhei1' USING DFHEIV0
 11265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11266
 11267
 11268
 11269* EXEC CICS STARTBR
 11270*        DATASET('ERACCT')
 11271*        RIDFLD (ERACCT-KEY)
 11272*        GTEQ
 11273*    END-EXEC.
 11274     MOVE 'ERACCT' TO DFHEIV1
 11275     MOVE 0
 11276       TO DFHEIV11
 11277*    MOVE '&,         G          &   #00010777' TO DFHEIV0
 11278     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11280     MOVE X'2020233030303130373737' TO DFHEIV0(25:11)
 11281     CALL 'kxdfhei1' USING DFHEIV0,
 11282           DFHEIV1,
 11283           ERACCT-KEY,
 11284           DFHEIV99,
 11285           DFHEIV11,
 11286           DFHEIV99
 11287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11288
 11289
 11290 1245-FIND-ACCT-TOLERANCES-LOOP.
 11291
 11292
 11293* EXEC CICS READNEXT
 11294*        DATASET('ERACCT')
 11295*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 214
* EL156.cbl
 11296*        RIDFLD (ERACCT-KEY)
 11297*    END-EXEC.
 11298     MOVE 'ERACCT' TO DFHEIV1
 11299     MOVE 0
 11300       TO DFHEIV11
 11301*    MOVE '&.S                   )   #00010785' TO DFHEIV0
 11302     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11304     MOVE X'2020233030303130373835' TO DFHEIV0(25:11)
 11305     CALL 'kxdfhei1' USING DFHEIV0,
 11306           DFHEIV1,
 11307           DFHEIV20,
 11308           DFHEIV99,
 11309           ERACCT-KEY,
 11310           DFHEIV99,
 11311           DFHEIV11,
 11312           DFHEIV99,
 11313           DFHEIV99
 11314     SET ADDRESS OF ACCOUNT-MASTER TO
 11315         DFHEIV20
 11316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11317
 11318
 11319     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11320        IF WS-ERACCT-HOLD-RECORD = SPACES
 11321           GO TO 1950-NOT-FOUND
 11322        ELSE
 11323           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11324           GO TO 1250-CONTINUE.
 11325
 11326     IF ACCT-EXP-DT = HIGH-VALUES
 11327        NEXT SENTENCE
 11328     ELSE
 11329        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11330        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11331
 11332 1250-CONTINUE.
 11333
 11334     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11335
 11336     IF FOUND-TOL-SW = 'N'
 11337         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11338
 11339********* 1260-FIND-STATE-TOLERANCES.
 11340
 11341     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11342     MOVE PI-STATE               TO WS-ST-ACCESS.
 11343     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11344     MOVE '3'                    TO CNTL-REC-TYPE.
 11345     MOVE +0                     TO CNTL-SEQ-NO.
 11346     MOVE 'STAT'                 TO FILE-SWITCH.
 11347
 11348     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11349
 11350     IF WS-PMT-TOL = +0
 11351         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11352
 11353     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 215
* EL156.cbl
 11354     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11355     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11356     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11357     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11358
 11359****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11360****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11361     IF PI-PAYEE-TYPE <> 'B'
 11362           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11363     END-IF.
 11364
 11365     IF PI-PMTTYPE      = '2'  AND
 11366        PI-SPLIT-PMT-SW = 'Y'  AND
 11367        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11368          MOVE ER-3530                TO EMI-ERROR
 11369          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11370
 11371********* 1280-FIND-BENEFIT-TOLERANCES.
 11372
 11373     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11374        OR (PI-PMTTYPE = '5' OR '6')
 11375         GO TO 1300-FIND-CARR-TOLERANCES.
 11376
 11377     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11378     MOVE '4'                    TO CNTL-REC-TYPE.
 11379     MOVE +0                     TO CNTL-SEQ-NO.
 11380     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11381     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11382     MOVE 'BENE'                 TO FILE-SWITCH.
 11383
 11384     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11385
 11386     IF NO-BENEFIT-FOUND
 11387         GO TO 1950-NOT-FOUND.
 11388
 11389     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11390     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11391     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11392
 11393
 11394* EXEC CICS HANDLE CONDITION
 11395*        NOTFND(1950-NOT-FOUND)
 11396*    END-EXEC.
 11397*    MOVE '"$I                   ! , #00010865' TO DFHEIV0
 11398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11400     MOVE X'2C20233030303130383635' TO DFHEIV0(25:11)
 11401     CALL 'kxdfhei1' USING DFHEIV0
 11402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11403
 11404
 11405 1300-FIND-CARR-TOLERANCES.
 11406     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11407     MOVE '6'                    TO CNTL-REC-TYPE.
 11408
 11409     IF CONTROL-IS-ACTUAL-CARRIER
 11410         MOVE PI-CARRIER               TO WS-CARR
 11411     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 216
* EL156.cbl
 11412         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11413
 11414     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11415     MOVE +0                     TO CNTL-SEQ-NO.
 11416     MOVE 'CARR'                 TO FILE-SWITCH.
 11417
 11418     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11419
 11420     IF WS-DAYS-TOL = +0
 11421         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11422
 11423     IF WS-PMT-TOL = +0
 11424         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11425
 11426     IF WS-MAX-DAYS-TOL = +0
 11427         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11428
 11429     IF WS-MAX-PMT-TOL = +0
 11430         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11431                                    PI-MAX-PMT-TOL.
 11432
 11433     IF WS-MAX-LF-PMT-TOL = +0
 11434        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11435                                    PI-MAX-LF-PMT-TOL.
 11436
 11437     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11438
 11439********* 1320-FIND-COMP-TOLERANCES.
 11440
 11441     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11442     MOVE '1'                    TO CNTL-REC-TYPE.
 11443     MOVE SPACES                 TO CNTL-ACCESS.
 11444     MOVE +0                     TO CNTL-SEQ-NO.
 11445     MOVE 'COMP'                 TO FILE-SWITCH.
 11446
 11447     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11448
 11449     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11450     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11451
 11452     IF WS-PMT-TOL NOT = +0
 11453        IF WS-TOL-SEVERITY NOT = ' '
 11454         GO TO 1360-EDIT-DAYS.
 11455
 11456     IF WS-PMT-TOL = +0
 11457         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11458
 11459     IF WS-TOL-SEVERITY = ' '
 11460         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11461
 11462 1360-EDIT-DAYS.
 11463     IF PI-PMTTYPE NOT = '4'
 11464        IF PI-EDAYS NEGATIVE OR
 11465           PI-EPYAMT NEGATIVE
 11466          MOVE ER-0513             TO EMI-ERROR
 11467          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11468          MOVE -1                  TO PMTTYPEL.
 11469
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 217
* EL156.cbl
 11470     IF PI-PMTTYPE = '5' OR '6'
 11471        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11472
 11473     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11474        IF PI-PMTTYPE = '4'
 11475          MOVE PI-EDAYS          TO PI-CDAYS.
 11476
 11477     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11478         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11479
 11480     IF PI-PMTTYPE = '4'
 11481        MOVE PI-EDAYS            TO PI-CDAYS
 11482        GO TO 1400-EDIT-PAYMENT.
 11483
 11484     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11485        GO TO 1500-EDIT-EXPENSES.
 11486
 11487*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11488*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11489*          CM-AH-BENEFIT-CD = '23'              AND
 11490*          CL-CERT-STATE    = '04'              AND
 11491*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11492*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11493*            GO TO 1362-CHECK-MAX-DAYS.
 11494
 11495     IF PI-EDAYS = ZEROS
 11496*        IF PI-COMPANY-ID = 'DMD'
 11497*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11498*            MOVE -1             TO DC-ELAPSED-DAYS
 11499*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11500*            MOVE '6'            TO DC-OPTION-CODE
 11501*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11502*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11503*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11504*            MOVE '1'            TO DC-OPTION-CODE
 11505*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11506*            IF NO-CONVERSION-ERROR
 11507*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11508*                                 + DC-ODD-DAYS-OVER
 11509*               MOVE 6           TO EDAYSL
 11510*               MOVE AL-UNNON    TO EDAYSA
 11511*            ELSE
 11512*                NEXT SENTENCE
 11513*       ELSE
 11514            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11515            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11516            MOVE '1'             TO DC-OPTION-CODE
 11517            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11518            IF NO-CONVERSION-ERROR
 11519                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11520                ADD 1                 TO PI-EDAYS
 11521                MOVE AL-UNNON         TO EDAYSA.
 11522
 11523*    IF PI-COMPANY-ID = 'DMD'
 11524*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11525*        MOVE -1                 TO DC-ELAPSED-DAYS
 11526*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11527*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 218
* EL156.cbl
 11528*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11529*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11530*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11531*        MOVE '1'                TO DC-OPTION-CODE
 11532*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11533*    ELSE
 11534         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11535         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11536         MOVE '1'                TO DC-OPTION-CODE.
 11537         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11538
 11539     IF NO-CONVERSION-ERROR
 11540        IF PI-COMPANY-ID = 'DMD'
 11541            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11542                             + DC-ODD-DAYS-OVER
 11543        ELSE
 11544            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11545            ADD 1                TO PI-CDAYS.
 11546
 11547     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11548        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11549        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11550
 11551     IF PI-EDAYS NOT NUMERIC
 11552         MOVE ER-0491            TO EMI-ERROR
 11553         GO TO 1370-DAYS-ERROR.
 11554
 11555     IF CL-NO-OF-PMTS-MADE = 0
 11556        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11557        AND CL-CERT-STATE = 'MI'
 11558        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11559            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11560     END-IF.
 11561
 11562 1362-CHECK-MAX-DAYS.
 11563
 11564     IF WS-MAX-DAYS-TOL = +999
 11565         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11566
 11567     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11568         IF PI-EDAYS = ZEROS
 11569             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11570         ELSE
 11571             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11572
 11573     IF WS-MAX-DAYS-TOL NOT = ZERO
 11574        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11575           PI-CDAYS > WS-MAX-DAYS-TOL
 11576             MOVE ER-0492          TO EMI-ERROR
 11577             GO TO 1370-DAYS-ERROR.
 11578
 11579 1365-SKIP-MAX-DAYS-EDIT.
 11580     IF PI-EDAYS = ZEROS
 11581        GO TO 1400-EDIT-PAYMENT.
 11582
 11583     IF WS-DAYS-TOL NOT = ZERO
 11584        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11585           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 219
* EL156.cbl
 11586                MOVE ER-0493     TO EMI-ERROR
 11587                GO TO 1370-DAYS-ERROR.
 11588
 11589     GO TO 1400-EDIT-PAYMENT.
 11590
 11591 1370-DAYS-ERROR.
 11592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11593
 11594     IF EMI-MESSAGE-FORMATTED
 11595         MOVE -1                 TO EDAYSL
 11596         MOVE AL-UABON           TO EDAYSA.
 11597
 11598     GO TO 1400-EDIT-PAYMENT.
 11599
 11600 1380-EDIT-EXPENSE-PMT-AMT.
 11601     IF PI-PMTTYPE = '5' OR '6'
 11602         NEXT SENTENCE
 11603     ELSE
 11604         GO TO 1400-EDIT-PAYMENT.
 11605
 11606     IF WS-MAX-EXP-PMT NOT = ZEROS
 11607        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11608            MOVE ER-3529            TO EMI-ERROR
 11609            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11610
 11611     GO TO 1500-EDIT-EXPENSES.
 11612
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 220
* EL156.cbl
 11614
 11615 1390-CHECK-PAYMENT-DAYS.
 11616
 11617     IF PI-EDAYS = 0
 11618         MOVE PI-CDAYS TO WS-PD-DAYS
 11619     ELSE
 11620         MOVE PI-EDAYS TO WS-PD-DAYS
 11621     END-IF.
 11622
 11623     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11624         IF WS-PD-DAYS = 14
 11625            GO TO 1390-EXIT
 11626         END-IF
 11627     END-IF.
 11628
 11629     IF PI-COMPANY-ID = 'AHL'  AND
 11630        CM-AH-BENEFIT-CD = '1K'
 11631         IF WS-PD-DAYS = 14
 11632            GO TO 1390-EXIT
 11633         END-IF
 11634     END-IF.
 11635
 11636     IF WS-PD-DAYS < 30
 11637         MOVE ER-3549              TO EMI-ERROR
 11638         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11639     END-IF.
 11640
 11641 1390-EXIT.
 11642      EXIT.
 11643
 11644 1400-EDIT-PAYMENT.
 11645*    IF PI-COMPANY-ID = 'DMD'
 11646*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11647*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11648
 11649     IF PI-COMPANY-ID = 'DCC'
 11650        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11651        MOVE PI-CARRIER          TO ACCT-CARRIER
 11652        MOVE PI-GROUPING         TO ACCT-GROUPING
 11653        MOVE PI-STATE            TO ACCT-STATE
 11654        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11655        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11656        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11657        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11658
 11659
 11660* EXEC CICS READ
 11661*          DATASET ('ERACCT')
 11662*          RIDFLD  (ERACCT-KEY)
 11663*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11664*          GTEQ
 11665*          resp    (WS-RESPONSE)
 11666*       END-EXEC
 11667     MOVE 'ERACCT' TO DFHEIV1
 11668*    MOVE '&"S        G          (  N#00011123' TO DFHEIV0
 11669     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11671     MOVE X'204E233030303131313233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 221
* EL156.cbl
 11672     CALL 'kxdfhei1' USING DFHEIV0,
 11673           DFHEIV1,
 11674           DFHEIV20,
 11675           DFHEIV99,
 11676           ERACCT-KEY,
 11677           DFHEIV99,
 11678           DFHEIV99,
 11679           DFHEIV99
 11680     SET ADDRESS OF ACCOUNT-MASTER TO
 11681         DFHEIV20
 11682     MOVE EIBRESP  TO WS-RESPONSE
 11683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11684        IF WS-RESP-NORMAL
 11685           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11686           and pi-cert-eff-dt < am-expiration-dt
 11687           and pi-cert-eff-dt >= am-effective-dt
 11688           move am-dcc-product-code to pi-dcc-product-code
 11689        else
 11690           move spaces           to pi-dcc-product-code
 11691        end-if
 11692        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11693           PERFORM 0900-GET-DDF-LIMITS
 11694                                 THRU 0900-EXIT
 11695           IF PDEF-FOUND
 11696              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11697                 (P1 > +8)
 11698                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11699              END-PERFORM
 11700              IF P1 < +9
 11701                 if pd-ben-pct (p1) not numeric
 11702                    move zeros   to pd-ben-pct (p1)
 11703                 end-if
 11704                 if pd-ben-pct (p1) = zeros
 11705                    move +1      to ws-work-ben-pct
 11706                 else
 11707                    move pd-ben-pct (p1)
 11708                                 to ws-work-ben-pct
 11709                 end-if
 11710                 compute cm-ah-benefit-amt =
 11711                    cm-ah-benefit-amt * ws-work-ben-pct
 11712                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11713                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11714                 end-if
 11715              else
 11716                 move er-1674    to emi-error
 11717                 PERFORM 9900-ERROR-FORMAT
 11718                                 THRU 9900-EXIT
 11719              END-IF
 11720           else
 11721              move er-1672       to emi-error
 11722              PERFORM 9900-ERROR-FORMAT
 11723                                 THRU 9900-EXIT
 11724           END-IF
 11725        end-if
 11726     END-IF
 11727     IF PI-PMTTYPE NOT = '4'
 11728        GO TO 1405-CALC-PAYMENT.
 11729
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 222
* EL156.cbl
 11730     IF PI-EDAYS NOT NUMERIC
 11731         MOVE PI-EPYAMT           TO PI-CPYAMT
 11732         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11733         GO TO 1430-CHECK-AH-TOLERANCE.
 11734
 11735*    IF PI-COMPANY-ID = 'FIA'
 11736*       IF CERT-ACCOUNT = '0000011043'
 11737*        COMPUTE PI-DAILY-RATE ROUNDED =
 11738*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11739*        COMPUTE PI-CPYAMT ROUNDED =
 11740*                          PI-DAILY-RATE * PI-EDAYS
 11741*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11742*        GO TO 1430-CHECK-AH-TOLERANCE.
 11743
 11744     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11745         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11746         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11747         GO TO 1420-CHECK-AIG-BENEFIT.
 11748
 11749     IF WS-CALC-METHOD = '2' OR  '5'
 11750         COMPUTE PI-DAILY-RATE ROUNDED =
 11751                        (CM-AH-BENEFIT-AMT * 12) / 365
 11752         COMPUTE PI-CPYAMT ROUNDED =
 11753                           PI-DAILY-RATE * PI-EDAYS
 11754        GO TO 1420-CHECK-AIG-BENEFIT.
 11755
 11756     IF WS-CALC-METHOD = '3'
 11757         COMPUTE PI-DAILY-RATE =
 11758                         (CM-AH-BENEFIT-AMT * 12) / 365
 11759         COMPUTE PI-CPYAMT ROUNDED =
 11760                           PI-DAILY-RATE * PI-EDAYS
 11761        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 223
* EL156.cbl
 11763*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11764
 11765****************************************************************
 11766****************************************************************
 11767*                  CALCULATED FROM      PAYMENT      PAYMENT
 11768*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11769* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11770*1-01-83  1-15-83    0    15     15        15           15
 11771*1-01-83  1-30-83    0    30     30        30           30
 11772*1-01-83  1-31-83    1     0     31        30           30
 11773*1-01-83  2-01-83    1     1     32        31           31
 11774*1-01-83  2-15-83    1    15     46        45           45
 11775*1-01-83  2-28-83    2     0     59        60           60
 11776*1-01-83  3-01-83    2     1     60        61           61
 11777*1-01-83  3-31-83    3     0     90        90           90
 11778*1-15-83  1-31-83    0    17     17        17           16
 11779*1-15-83  2-01-83    0    18     18        18           17
 11780*1-15-83  2-28-83    1    14     45        44           46
 11781*1-21-83  3-09-83    1    20     48        50           49
 11782*2-05-83  3-06-83    1     2     30        32           32
 11783*2-05-83  3-23-83    1    19     47        49           49
 11784*2-15-83  2-28-83    0    14     14        14           16
 11785*2-15-83  3-01-83    0    15     15        15           17
 11786*2-21-83  3-19-83    0    27     27        27           29
 11787*2-21-83  3-20-83    1     0     28        30           30
 11788*2-21-83  4-10-83    1    18     49        30           50
 11789*2-21-83  5-19-83    2    27     88        87           89
 11790*2-21-83  5-22-83    3     2     91        92           92
 11791*3-21-83  5-19-83    1    30     60        60           59
 11792****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 224
* EL156.cbl
 11794 1405-CALC-PAYMENT.
 11795     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11796     MOVE ' '                    TO DC-OPTION-CODE.
 11797     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11798     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11799     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11800
 11801     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11802     MOVE ' '                    TO DC-OPTION-CODE.
 11803     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11804     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11805     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11806
 11807     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11808     MOVE -1                     TO DC-ELAPSED-DAYS.
 11809     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11810     MOVE '6'                    TO DC-OPTION-CODE.
 11811     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11812     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11813
 11814     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11815     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11816     MOVE '1'                    TO DC-OPTION-CODE.
 11817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11818
 11819     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11820     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11821     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11822
 11823******************************************************************
 11824*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11825*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11826*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11827******************************************************************
 11828
 11829     IF WS-CALC-METHOD = '1'           AND
 11830        DC-ELAPSED-MONTHS > ZERO AND
 11831        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11832        WDF-DAY > WDT-DAY
 11833          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11834          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11835          MOVE -1                  TO DC-ELAPSED-MONTHS
 11836          MOVE '6'                 TO DC-OPTION-CODE
 11837          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11838          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11839          COMPUTE WS-SAVE-ODD-DAYS =
 11840          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11841          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11842
 11843     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11844     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11845     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11846
 11847     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11848     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11849
 11850*    IF PI-COMPANY-ID = 'FIA'
 11851*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 225
* EL156.cbl
 11852*        COMPUTE PI-DAILY-RATE ROUNDED =
 11853*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11854*        COMPUTE PI-CPYAMT ROUNDED =
 11855*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11856*        GO TO 1420-CHECK-AIG-BENEFIT.
 11857
 11858*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11859*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11860*          CM-AH-BENEFIT-CD = '23'               AND
 11861*          CL-CERT-STATE    = '04'               AND
 11862*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11863*            COMPUTE WS-DAILY-RATE ROUNDED =
 11864*                               CM-AH-BENEFIT-AMT / 30
 11865*            COMPUTE PI-CPYAMT ROUNDED =
 11866*                               (WS-DAILY-RATE * PI-CDAYS)
 11867*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11868*            GO TO 1420-CHECK-AIG-BENEFIT.
 11869
 11870     IF WS-CALC-METHOD = '1'
 11871         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11872         COMPUTE PI-CPYAMT ROUNDED =
 11873             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11874             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11875         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11876         GO TO 1420-CHECK-AIG-BENEFIT.
 11877
 11878     IF WS-CALC-METHOD = '2'
 11879         COMPUTE PI-DAILY-RATE ROUNDED =
 11880                          (CM-AH-BENEFIT-AMT * 12) / 365
 11881         COMPUTE PI-CPYAMT ROUNDED =
 11882             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11883             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11884         GO TO 1420-CHECK-AIG-BENEFIT.
 11885
 11886     IF WS-CALC-METHOD = '4'
 11887         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11888         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11889         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11890         COMPUTE PI-CPYAMT ROUNDED =
 11891                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11892         GO TO 1420-CHECK-AIG-BENEFIT.
 11893
 11894     IF WS-CALC-METHOD = '5'
 11895         COMPUTE PI-DAILY-RATE ROUNDED =
 11896                            (CM-AH-BENEFIT-AMT * 12) / 365
 11897         COMPUTE PI-CPYAMT ROUNDED =
 11898                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11899         GO TO 1420-CHECK-AIG-BENEFIT.
 11900
 11901     IF WS-CALC-METHOD NOT = '3'
 11902        GO TO 1410-CHECK-PAYMENT.
 11903
 11904******   CALCULATION METHOD  3  ROUTINE
 11905     COMPUTE PI-DAILY-RATE =
 11906                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11907
 11908******CHECK TO SEE IF WITHIN SAME MONTH
 11909     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 226
* EL156.cbl
 11910        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11911                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11912         GO TO 1420-CHECK-AIG-BENEFIT.
 11913
 11914******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11915     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11916             SAVE-ODD-DAYS-OVER = ZEROS
 11917      COMPUTE PI-CPYAMT  ROUNDED =
 11918                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11919      GO TO 1420-CHECK-AIG-BENEFIT.
 11920
 11921******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11922******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11923     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11924        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11925        IF WDF-MONTH > 12
 11926           ADD 1                 TO WDF-YEAR
 11927           SUBTRACT 12         FROM WDF-MONTH.
 11928
 11929******CONVERT THE NEW FROM MONTH TO BINARY
 11930     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11931        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11932        MOVE '4'              TO DC-OPTION-CODE
 11933        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11934        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11935
 11936     IF WDF-MONTH = WDT-MONTH AND
 11937        WDF-YEAR  = WDT-YEAR
 11938          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11939                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11940                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11941        ELSE
 11942          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11943          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11944          COMPUTE PI-CPYAMT ROUNDED =
 11945       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11946       +
 11947       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11948       +
 11949       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11950
 11951     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 227
* EL156.cbl
 11953 1410-CHECK-PAYMENT.
 11954******PAYMENT OPTION 6
 11955******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11956     IF SAVE-ELAPSED-MONTHS > ZERO
 11957        IF SAVE-ODD-DAYS-OVER = ZEROS
 11958           GO TO 1412-CHECK-TO-DAY
 11959        ELSE
 11960           IF WDF-DAY > WDT-DAY
 11961              IF WDF-MONTH = 02
 11962                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11963                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11964                  GO TO 1412-CHECK-TO-DAY
 11965              ELSE
 11966                  IF FROM-DAYS-IN-MONTH = 31
 11967                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11968                     GO TO 1412-CHECK-TO-DAY
 11969                  ELSE
 11970                     GO TO 1412-CHECK-TO-DAY
 11971           ELSE
 11972               GO TO 1412-CHECK-TO-DAY.
 11973
 11974     IF WDF-MONTH NOT = WDT-MONTH
 11975        IF WDF-MONTH = 02
 11976           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11977           IF WDF-DAY = 29
 11978              ADD 1              TO SAVE-ODD-DAYS-OVER
 11979           ELSE
 11980              ADD 2              TO SAVE-ODD-DAYS-OVER
 11981        ELSE
 11982           IF FROM-DAYS-IN-MONTH = 31
 11983              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11984
 11985 1412-CHECK-TO-DAY.
 11986        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11987           IF WDT-DAY = 28
 11988              ADD 2              TO SAVE-ODD-DAYS-OVER
 11989           ELSE
 11990              IF WDT-DAY = 29
 11991                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11992              ELSE
 11993                 NEXT SENTENCE
 11994        ELSE
 11995           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11996              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11997
 11998     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11999     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12000     COMPUTE PI-CPYAMT ROUNDED =
 12001         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12002         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12003
 12004     GO TO 1420-CHECK-AIG-BENEFIT.
 12005
 12006 1415-CHECK-LEAP-YEAR.
 12007     IF FROM-DAYS-IN-MONTH = 29
 12008        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12009
 12010 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 228
* EL156.cbl
 12011     EXIT.
 12012
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 229
* EL156.cbl
 12014 1420-CHECK-AIG-BENEFIT.
 12015
 12016     IF WS-SPECIAL-CALC-CD = 'Q'
 12017         GO TO 1425-CHECK-WHOLE-MONTH.
 12018
 12019*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12020*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12021*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12022*       (PI-PMTTYPE = '1' OR '2')
 12023*        NEXT SENTENCE
 12024*    ELSE
 12025         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12026         GO TO 1430-CHECK-AH-TOLERANCE.
 12027
 12028******************AIG LOGIC STARTS**********************
 12029*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12030*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12031*    MOVE ER-3533      TO EMI-ERROR.
 12032*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12033*    GO TO 1430-CHECK-AH-TOLERANCE.
 12034******************AIG LOGIC ENDS************************
 12035
 12036 1425-CHECK-WHOLE-MONTH.
 12037******************************************************************
 12038****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12039****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12040****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12041****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12042****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12043****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12044****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12045****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12046****          PAID * MONTHLY BENEFIT.                         ****
 12047******************************************************************
 12048
 12049     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12050
 12051     IF CL-NO-OF-PMTS-MADE > +0
 12052         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12053
 12054     IF PI-CDAYS < WS-BEN-DAYS
 12055         GO TO 1430-CHECK-AH-TOLERANCE.
 12056
 12057     IF PI-CDAYS = WS-BEN-DAYS
 12058         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12059         GO TO 1430-CHECK-AH-TOLERANCE.
 12060
 12061*    IF PI-COMPANY-ID = 'ACM'
 12062*       NEXT SENTENCE
 12063*    ELSE
 12064        GO TO 1425-NOT-ACM-W15C.
 12065
 12066*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12067*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12068*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12069*    MOVE '6'                    TO  DC-OPTION-CODE.
 12070*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12071*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 230
* EL156.cbl
 12072*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12073*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12074*       MOVE '1'                 TO  DC-OPTION-CODE
 12075*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12076*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12077*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12078*       IF NO-CONVERSION-ERROR
 12079*          IF (DC-ELAPSED-MONTHS > +0) OR
 12080*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12081*             NEXT SENTENCE
 12082*          ELSE
 12083*             MOVE +0            TO  PI-CPYAMT
 12084*             MOVE ER-0846       TO  EMI-ERROR
 12085*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12086*             GO TO 1430-CHECK-AH-TOLERANCE
 12087*       ELSE
 12088*           MOVE ER-0846         TO  EMI-ERROR
 12089*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12090*           GO TO 1430-CHECK-AH-TOLERANCE.
 12091*
 12092*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12093*       ADD +1 TO DC-ELAPSED-MONTHS.
 12094*
 12095*    COMPUTE PI-CPYAMT ROUNDED =
 12096*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12097*
 12098*    GO TO 1430-CHECK-AH-TOLERANCE.
 12099
 12100 1425-NOT-ACM-W15C.
 12101
 12102     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12103     MOVE '6'                        TO  DC-OPTION-CODE.
 12104     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12105     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12106
 12107     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12108     IF NO-CONVERSION-ERROR
 12109         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12110     ELSE
 12111         MOVE ER-0846                TO  EMI-ERROR
 12112         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12113         GO TO 1430-CHECK-AH-TOLERANCE.
 12114
 12115     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12116     MOVE '1'                        TO  DC-OPTION-CODE.
 12117     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12118     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12119     IF NO-CONVERSION-ERROR
 12120         IF DC-ODD-DAYS-OVER = +0
 12121             NEXT SENTENCE
 12122         ELSE
 12123             MOVE ER-0846            TO  EMI-ERROR
 12124             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12125             GO TO 1430-CHECK-AH-TOLERANCE
 12126     ELSE
 12127         MOVE ER-0846                TO  EMI-ERROR
 12128         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12129         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 231
* EL156.cbl
 12130
 12131     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12132         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12133
 12134     GO TO 1430-CHECK-AH-TOLERANCE.
 12135
 12136 1425-CONT-WHOLE-MONTH-PMTS.
 12137******************************************************************
 12138****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12139****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12140****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12141******************************************************************
 12142
 12143     IF PI-COMPANY-ID = 'ACM'
 12144        NEXT SENTENCE
 12145     ELSE
 12146        IF DC-ODD-DAYS-OVER = +0
 12147            NEXT SENTENCE
 12148        ELSE
 12149            MOVE ER-0845            TO  EMI-ERROR
 12150            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12151            GO TO 1430-CHECK-AH-TOLERANCE.
 12152
 12153     COMPUTE PI-CPYAMT ROUNDED =
 12154                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12155
 12156 1430-CHECK-AH-TOLERANCE.
 12157     IF PI-PMT-APPR-SW = 'G'
 12158         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12159
 12160*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12161*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12162*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12163*
 12164*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12165*      IF WDF-MONTH = 02
 12166*        IF SAVE-ELAPSED-MONTHS = 0
 12167*          NEXT SENTENCE
 12168*        ELSE
 12169*          IF SAVE-ODD-DAYS-OVER > 0
 12170*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12171*            COMPUTE WS-PMT-MOS ROUNDED =
 12172*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12173*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12174*                                     WS-PMT-MOS
 12175*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12176*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12177*          ELSE
 12178*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12179*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12180*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12181*                                     WS-PMT-MOS.
 12182
 12183     IF WS-MAX-PMT-TOL NOT = ZERO
 12184        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12185           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12186            MOVE ER-0494         TO  EMI-ERROR
 12187            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 232
* EL156.cbl
 12188            GO TO 1500-EDIT-EXPENSES.
 12189
 12190 1430-CONT-CHECK-AH-TOLERANCE.
 12191
 12192     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12193        GO TO 1500-EDIT-EXPENSES.
 12194
 12195     IF CM-O-B-COVERAGE
 12196        GO TO 1500-EDIT-EXPENSES.
 12197
 12198     IF PI-COMPANY-ID = 'NCL'
 12199       IF FOUND-TOL-SW = 'Y'
 12200         IF WS-PMT-TOL NOT = ZERO
 12201           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12202              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12203                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12204                  IF WS-NCL-PMT-OPTION = SPACES
 12205                      MOVE ER-0699 TO EMI-ERROR
 12206                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12207                  ELSE
 12208                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12209                      NEXT SENTENCE
 12210                  ELSE
 12211                  IF NOT WS-VALID-NCL-OPTION
 12212                      MOVE ER-0699 TO EMI-ERROR
 12213                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12214
 12215     IF WS-PMT-TOL NOT = ZERO
 12216        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12217           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12218           MOVE ER-0495          TO EMI-ERROR
 12219           PERFORM 1490-PAYMENT-ERROR
 12220                                 THRU 1490-EXIT
 12221        end-if
 12222     end-if
 12223
 12224     GO TO 1500-EDIT-EXPENSES.
 12225
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 233
* EL156.cbl
 12227 1440-COMPUTE-LIFE-REMAINING.
 12228
 12229     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12230        IF PI-PMTTYPE = '4'
 12231          MOVE PI-EPYAMT TO PI-CPYAMT
 12232          GO TO 1460-TEST-TYPE.
 12233
 12234     IF WS-LF-COVERAGE-TYPE = 'L'
 12235        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12236                          - CL-TOTAL-PAID-AMT
 12237        GO TO 1450-CHECK-MAX.
 12238
 12239     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12240        PI-LF-COVERAGE-TYPE = 'P'
 12241          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12242                              CM-LF-ITD-DEATH-AMT
 12243          GO TO 1450-CHECK-MAX.
 12244
 12245     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12246     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12247     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12248     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12249     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12250     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12251     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12252     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12253     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12254
 12255     PERFORM 9800-LINK-REM-TERM.
 12256
 12257     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12258     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12259     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12260     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12261     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12262     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12263     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12264     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12265     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12266     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12267     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12268     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12269     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12270     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12271     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12272     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12273     IF PI-COMPANY-ID = 'DCC'
 12274        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12275        MOVE PI-CARRIER          TO ACCT-CARRIER
 12276        MOVE PI-GROUPING         TO ACCT-GROUPING
 12277        MOVE PI-STATE            TO ACCT-STATE
 12278        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12279        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12280        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12281        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12282
 12283
 12284* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 234
* EL156.cbl
 12285*          DATASET ('ERACCT')
 12286*          RIDFLD  (ERACCT-KEY)
 12287*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12288*          GTEQ
 12289*          resp    (WS-RESPONSE)
 12290*       END-EXEC
 12291     MOVE 'ERACCT' TO DFHEIV1
 12292*    MOVE '&"S        G          (  N#00011729' TO DFHEIV0
 12293     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12295     MOVE X'204E233030303131373239' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0,
 12297           DFHEIV1,
 12298           DFHEIV20,
 12299           DFHEIV99,
 12300           ERACCT-KEY,
 12301           DFHEIV99,
 12302           DFHEIV99,
 12303           DFHEIV99
 12304     SET ADDRESS OF ACCOUNT-MASTER TO
 12305         DFHEIV20
 12306     MOVE EIBRESP  TO WS-RESPONSE
 12307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12308        IF WS-RESP-NORMAL
 12309           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12310           and (pi-cert-eff-dt < am-expiration-dt)
 12311           and (pi-cert-eff-dt >= am-effective-dt)
 12312           move am-dcc-product-code to pi-dcc-product-code
 12313        else
 12314           move spaces           to pi-dcc-product-code
 12315        end-if
 12316        if pi-dcc-product-code not = spaces
 12317           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12318           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12319           PERFORM 0900-GET-DDF-limits
 12320                                 THRU 0900-EXIT
 12321           IF PDEF-FOUND
 12322              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12323                 (P1 > +8)
 12324                 OR (PD-PROD-CODE (P1) = 'L')
 12325              END-PERFORM
 12326              IF P1 < +9
 12327                 MOVE PD-MAX-AMT (P1)
 12328                                 TO CP-R-MAX-TOT-BEN
 12329              else
 12330                 move er-1674    to emi-error
 12331                 PERFORM 9900-ERROR-FORMAT
 12332                                 THRU 9900-EXIT
 12333              END-IF
 12334           else
 12335              move er-1672       to emi-error
 12336              PERFORM 9900-ERROR-FORMAT
 12337                                 THRU 9900-EXIT
 12338           END-IF
 12339        end-if
 12340     END-IF
 12341
 12342* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 235
* EL156.cbl
 12343*       PROGRAM  (LINK-REMAMT)
 12344*       COMMAREA (CALCULATION-PASS-AREA)
 12345*       LENGTH   (CP-COMM-LENGTH)
 12346*    END-EXEC.
 12347*    MOVE '."C                   (   #00011769' TO DFHEIV0
 12348     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12350     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12351     CALL 'kxdfhei1' USING DFHEIV0,
 12352           LINK-REMAMT,
 12353           CALCULATION-PASS-AREA,
 12354           CP-COMM-LENGTH,
 12355           DFHEIV99,
 12356           DFHEIV99,
 12357           DFHEIV99,
 12358           DFHEIV99
 12359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12360
 12361
 12362     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12363
 12364     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12365     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12366
 12367     IF PI-COMPANY-ID = 'BOA' AND
 12368        PI-PMTTYPE    = '2'   AND
 12369        PI-OFFLINE    = 'N'
 12370           GO TO 1441-COMPUTE-BOA-INTEREST.
 12371
 12372     IF PI-COMPANY-ID = 'NCL' AND
 12373        PI-PMTTYPE    = '2'   AND
 12374        PI-OFFLINE    = 'N'
 12375          GO TO 1442-COMPUTE-NCL-INTEREST
 12376       ELSE
 12377          GO TO 1445-CONTINUE.
 12378
 12379 1441-COMPUTE-BOA-INTEREST.
 12380     MOVE +0             TO WS-CALC-INT.
 12381
 12382     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12383     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12384     MOVE +0             TO DC-ELAPSED-MONTHS
 12385                            DC-ELAPSED-DAYS.
 12386     MOVE '1'            TO DC-OPTION-CODE.
 12387     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12388     IF NO-CONVERSION-ERROR
 12389         NEXT SENTENCE
 12390     ELSE
 12391         GO TO 1445-CONTINUE.
 12392
 12393     IF (PI-INT-RATE NOT > ZEROS)  AND
 12394        (DC-ELAPSED-DAYS > +30)
 12395         MOVE ER-3531            TO EMI-ERROR
 12396         MOVE -1                 TO PINTL
 12397         MOVE AL-UNBON           TO PINTA
 12398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12399
 12400     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 236
* EL156.cbl
 12401         GO TO 1445-CONTINUE.
 12402
 12403     IF (PI-INT-RATE NOT > ZEROS)  OR
 12404        (DC-ELAPSED-DAYS NOT > +30)
 12405         MOVE PI-EPYAMT TO PI-CPYAMT
 12406         GO TO 1441-FORMAT-NOTE.
 12407
 12408     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12409                                 *  PI-INT-RATE
 12410                                 *  DC-ELAPSED-DAYS
 12411                                 /  365
 12412                                 /  100.
 12413
 12414     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12415
 12416 1441-FORMAT-NOTE.
 12417
 12418     MOVE SPACES        TO WS-BOANOTE1.
 12419     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12420     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12421     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12422     MOVE AL-UANON      TO NOTE1A.
 12423
 12424     IF WS-CALC-INT > ZEROS
 12425         MOVE SPACES        TO WS-BOANOTE2
 12426         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12427         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12428         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12429         MOVE AL-UANON      TO NOTE2A.
 12430
 12431     GO TO 1445-CONTINUE.
 12432
 12433 1442-COMPUTE-NCL-INTEREST.
 12434     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12435     MOVE PI-STATE               TO WS-ST-ACCESS.
 12436     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12437     MOVE '3'                    TO CNTL-REC-TYPE.
 12438     MOVE +0                     TO CNTL-SEQ-NO.
 12439     MOVE 'STAT'                 TO FILE-SWITCH.
 12440
 12441     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12442
 12443     MOVE +0                 TO WS-CALC-INT.
 12444
 12445     IF ST-STAT-FROM-INCURRED
 12446         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12447       ELSE
 12448     IF ST-STAT-FROM-REPORTED
 12449         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12450       ELSE
 12451         GO TO 1445-CONTINUE.
 12452
 12453     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12454     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12455     MOVE +0                 TO DC-ELAPSED-MONTHS
 12456                                DC-ELAPSED-DAYS.
 12457     MOVE '1'                TO DC-OPTION-CODE.
 12458     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 237
* EL156.cbl
 12459     IF NO-CONVERSION-ERROR
 12460         NEXT SENTENCE
 12461     ELSE
 12462         GO TO 1445-CONTINUE.
 12463
 12464     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12465        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12466         GO TO 1445-CONTINUE.
 12467
 12468     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12469                                 *  CF-ST-STAT-INTEREST.
 12470
 12471     MOVE SPACES              TO WS-NCLNOTE1.
 12472     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12473     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12474     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12475                                 PI-PMTNOTE1
 12476                                 NOTE1I.
 12477     MOVE AL-UANON            TO NOTE1A.
 12478
 12479     IF WS-CALC-INT > ZEROS
 12480         MOVE SPACES          TO WS-NCLNOTE2
 12481         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12482         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12483         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12484                                 PI-PMTNOTE2
 12485                                 NOTE2I
 12486         MOVE AL-UANON        TO NOTE2A.
 12487
 12488     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12489
 12490 1445-CONTINUE.
 12491
 12492     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12493        GO TO 1460-TEST-TYPE.
 12494
 12495     IF CM-O-B-COVERAGE
 12496        GO TO 1460-TEST-TYPE.
 12497
 12498     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12499         GO TO 1450-CHECK-MAX.
 12500
 12501     if (pi-company-id = 'DCC')
 12502        and (pdef-found)
 12503        if pi-epyamt > pd-max-amt (p1)
 12504           move er-1657          to emi-error
 12505           perform 1490-payment-error
 12506                                 thru 1490-exit
 12507           go to 1460-test-type
 12508        end-if
 12509     else
 12510        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12511           > PI-EPYAMT)
 12512                         OR
 12513           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12514           < PI-EPYAMT)
 12515           MOVE ER-0594          TO EMI-ERROR
 12516           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 238
* EL156.cbl
 12517                                 THRU 1490-EXIT
 12518           GO TO 1460-TEST-TYPE
 12519        end-if
 12520     end-if
 12521     .
 12522 1450-CHECK-MAX.
 12523
 12524     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12525        PI-LF-COVERAGE-TYPE = 'P'
 12526         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12527                                   CM-LF-ITD-DEATH-AMT
 12528     ELSE
 12529         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12530                                   CL-TOTAL-PAID-AMT.
 12531
 12532     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12533          MOVE ER-0543           TO EMI-ERROR
 12534          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12535
 12536 1460-TEST-TYPE.
 12537
 12538     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12539        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12540           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12541                                   CM-LF-ALT-BENEFIT-AMT -
 12542                                   CL-TOTAL-PAID-AMT
 12543           IF PI-EPYAMT > WS-LF-BEN-AMT
 12544               MOVE ER-0543      TO EMI-ERROR
 12545               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12546           END-IF
 12547        END-IF
 12548     END-IF
 12549
 12550     IF PI-PMT-APPR-SW = 'G'
 12551       NEXT SENTENCE
 12552     ELSE
 12553       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12554         IF PI-EPYAMT = ZERO
 12555             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12556                 MOVE ER-0494    TO  EMI-ERROR
 12557                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12558                 GO TO 1500-EDIT-EXPENSES
 12559             ELSE
 12560                 NEXT SENTENCE
 12561         ELSE
 12562             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12563                 MOVE ER-0494    TO  EMI-ERROR
 12564                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12565                 GO TO 1500-EDIT-EXPENSES.
 12566
 12567     IF PI-PMTTYPE NOT = '2' OR
 12568        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12569         GO TO 1500-EDIT-EXPENSES.
 12570
 12571     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12572     MOVE ER-0526                TO EMI-ERROR.
 12573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12574
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 239
* EL156.cbl
 12575     IF EMI-ERROR-NUMBER (1) = '0526'
 12576        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12577
 12578     IF EMI-ERROR-NUMBER (2) = '0526'
 12579        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12580
 12581     GO TO 1500-EDIT-EXPENSES.
 12582
 12583 1490-PAYMENT-ERROR.
 12584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12585
 12586     IF EMI-MESSAGE-FORMATTED
 12587         MOVE -1                 TO EPYAMTL
 12588         MOVE AL-UNBON           TO EPYAMTA.
 12589
 12590 1490-EXIT.
 12591      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 240
* EL156.cbl
 12593 1500-EDIT-EXPENSES.
 12594     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12595         GO TO 1500-SKIP-ERROR-0556.
 12596
 12597 1500-CONTINUE-ON.
 12598
 12599     IF CM-O-B-COVERAGE
 12600        MOVE ER-0556             TO EMI-ERROR
 12601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602
 12603 1500-SKIP-ERROR-0556.
 12604     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12605        IF PI-EEXPENS NOT = ZEROS
 12606           MOVE ER-0524          TO EMI-ERROR
 12607           GO TO 1590-EXPENSE-ERROR
 12608        ELSE
 12609           GO TO 1600-EDIT-RESERVES.
 12610
 12611     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12612     MOVE '6'                    TO CNTL-REC-TYPE.
 12613
 12614     IF CONTROL-IS-ACTUAL-CARRIER
 12615         MOVE PI-CARRIER         TO WS-CARR
 12616     ELSE
 12617         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12618
 12619     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12620     MOVE +0                     TO CNTL-SEQ-NO.
 12621     MOVE 'CARR'                 TO FILE-SWITCH.
 12622
 12623     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12624
 12625     IF EXPENSE-CALC-MANUAL
 12626        GO TO 1600-EDIT-RESERVES.
 12627
 12628     IF DOLLARS-PER-PMT
 12629        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12630        GO TO 1600-EDIT-RESERVES.
 12631
 12632     IF DOLLARS-PER-MONTH AND
 12633        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12634       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12635       GO TO 1600-EDIT-RESERVES.
 12636
 12637     IF PERCENT-OF-PAYMENT
 12638        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12639
 12640     GO TO 1600-EDIT-RESERVES.
 12641
 12642 1590-EXPENSE-ERROR.
 12643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12644
 12645     IF EMI-MESSAGE-FORMATTED
 12646        MOVE -1                  TO EEXPENSL
 12647        MOVE AL-UNBON            TO EEXPENSA.
 12648
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 241
* EL156.cbl
 12650 1600-EDIT-RESERVES.
 12651     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12652        IF PI-ERESV = ZEROS
 12653           GO TO 1700-EDIT-EXPENSE-TYPE
 12654        ELSE
 12655           MOVE ER-0525          TO EMI-ERROR
 12656           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12657           GO TO 1700-EDIT-EXPENSE-TYPE.
 12658
 12659     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12660     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12661     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12662
 12663     IF NOT AT-MANUAL-RESERVES-USED
 12664        IF PI-ERESV NOT = ZEROS
 12665           MOVE ER-0518          TO EMI-ERROR
 12666           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12667
 12668     IF AT-MANUAL-RESERVES-USED
 12669        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12670        GO TO 1700-EDIT-EXPENSE-TYPE.
 12671
 12672     IF AT-FUTURE-RESERVES-USED
 12673        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12674
 12675     IF AT-FUTURE-RESERVES-USED
 12676        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12677
 12678     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12679        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12680
 12681     IF AT-IBNR-RESERVES-USED
 12682        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12683
 12684     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12685     GO TO 1700-EDIT-EXPENSE-TYPE.
 12686
 12687 1690-RESERVE-ERROR.
 12688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12689
 12690     IF EMI-MESSAGE-FORMATTED
 12691        MOVE AL-UNBON            TO ERESVA
 12692        MOVE -1                  TO ERESVL.
 12693
 12694 1690-EXIT.
 12695      EXIT.
 12696
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 242
* EL156.cbl
 12698 1700-EDIT-EXPENSE-TYPE.
 12699     IF PI-PMTTYPE NOT = '5' AND '6'
 12700        GO TO 2000-EDIT-DONE.
 12701
 12702     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12703                   '6' OR '7' OR '8' OR '9'
 12704        GO TO 2000-EDIT-DONE.
 12705
 12706 1705-EXPENSE-ERROR.
 12707     MOVE ER-0573                TO EMI-ERROR.
 12708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12709
 12710     IF EMI-MESSAGE-FORMATTED
 12711        MOVE AL-UABON            TO ETYPEA
 12712        MOVE -1                  TO ETYPEL.
 12713
 12714     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 243
* EL156.cbl
 12716 1950-NOT-FOUND.
 12717     IF FILE-SWITCH = 'MSTR'
 12718        MOVE ER-0204             TO EMI-ERROR.
 12719
 12720     IF FILE-SWITCH = 'CARR'
 12721        MOVE ER-0252             TO EMI-ERROR.
 12722
 12723     IF FILE-SWITCH = 'COMP'
 12724        MOVE ER-0254             TO EMI-ERROR.
 12725
 12726     IF FILE-SWITCH = 'STAT'
 12727        MOVE ER-0149             TO EMI-ERROR.
 12728
 12729     IF FILE-SWITCH = 'PROC'
 12730        MOVE ER-0019             TO EMI-ERROR.
 12731
 12732     IF FILE-SWITCH = 'ACCT'
 12733        MOVE ER-0198             TO EMI-ERROR.
 12734
 12735     IF FILE-SWITCH = 'BENE'
 12736        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12737           MOVE ER-0282          TO EMI-ERROR
 12738        ELSE
 12739           MOVE ER-0283          TO EMI-ERROR.
 12740
 12741     MOVE -1                     TO PMTTYPEL.
 12742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12743
 12744     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12745                                     WS-FORCE-CTR.
 12746
 12747     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12748                                     WS-FATAL-CTR.
 12749
 12750     GO TO 8200-SEND-DATAONLY.
 12751
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 244
* EL156.cbl
 12753 2000-EDIT-DONE.
 12754*********************
 12755     perform 2210-dcc-max-benes thru 2210-exit
 12756     if pi-company-id not = 'DCC'
 12757        IF (WS-SPECIAL-CALC-CD = 'C')
 12758           and (cl-critical-period > 0)
 12759           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12760              IF PI-EPYAMT > ZEROS
 12761                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12762                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12763              ELSE
 12764                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12765                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12766              END-IF
 12767              if ws-benefits-paid > cl-critical-period
 12768                 MOVE ER-0657          TO EMI-ERROR
 12769                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12770              END-IF
 12771           END-IF
 12772        END-IF
 12773     end-if
 12774     IF PI-HOLDTIL NOT = ZEROS
 12775        MOVE PI-HOLDTIL          TO HOLDTILO
 12776        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12777
 12778     IF PI-EPYFROM NOT = ZEROS
 12779        MOVE PI-EPYFROM          TO EPYFROMO
 12780        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12781
 12782     IF PI-EPYTHRU NOT = ZEROS
 12783        MOVE PI-EPYTHRU            TO EPYTHRUO
 12784        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12785        IF PI-USES-PAID-TO
 12786           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12787           MOVE '4'                TO DC-OPTION-CODE
 12788           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12789           IF NO-CONVERSION-ERROR
 12790              MOVE +1              TO DC-ELAPSED-DAYS
 12791              MOVE +0              TO DC-ELAPSED-MONTHS
 12792              MOVE '6'             TO DC-OPTION-CODE
 12793              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12794              IF NO-CONVERSION-ERROR
 12795                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12796
 12797     MOVE PI-EDAYS               TO EDAYSO.
 12798
 12799     IF PI-AIGFROM NOT = ZEROS
 12800        MOVE PI-AIGFROM          TO AIGFROMO
 12801        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12802
 12803     MOVE PI-EPYAMT              TO EPYAMTO.
 12804     MOVE PI-ERESV               TO ERESVO.
 12805     MOVE PI-EEXPENS             TO EEXPENSO.
 12806
 12807     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12808     MOVE SPACES                 TO DC-OPTION-CODE.
 12809     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12810
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 245
* EL156.cbl
 12811     IF DATE-CONVERSION-ERROR
 12812        MOVE SPACES              TO CPYFROMI
 12813     ELSE
 12814        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12815        IF PI-EPYFROM = ZEROS
 12816           MOVE AL-UANON             TO EPYFROMA
 12817           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12818           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12819
 12820     IF PI-USES-PAID-TO
 12821        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12822        MOVE +1                            TO DC-ELAPSED-DAYS
 12823        MOVE +0                            TO DC-ELAPSED-MONTHS
 12824        MOVE '6'                           TO DC-OPTION-CODE
 12825        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12826        IF NO-CONVERSION-ERROR
 12827           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12828           IF PI-EPYTHRU = ZEROS
 12829              MOVE AL-UANON                TO EPYTHRUA
 12830              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12831              MOVE ' '                     TO DC-OPTION-CODE
 12832              MOVE +0                      TO DC-ELAPSED-DAYS
 12833                                              DC-ELAPSED-MONTHS
 12834              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12835              IF NO-CONVERSION-ERROR
 12836                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12837                  GO TO 2001-CONTINUE
 12838              ELSE
 12839                  GO TO 2001-CONTINUE
 12840           ELSE
 12841              GO TO 2001-CONTINUE.
 12842
 12843     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12844     MOVE SPACES                 TO DC-OPTION-CODE.
 12845     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12846
 12847     IF DATE-CONVERSION-ERROR
 12848        MOVE SPACES              TO CPYTHRUI
 12849     ELSE
 12850        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12851        IF PI-EPYTHRU = ZEROS
 12852           MOVE AL-UANON TO EPYTHRUA
 12853           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12854           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12855
 12856 2001-CONTINUE.
 12857
 12858     MOVE PI-CDAYS               TO CDAYSO.
 12859
 12860     IF PI-EDAYS = ZEROS
 12861        MOVE AL-UNNON TO EDAYSA
 12862        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12863
 12864     MOVE PI-CPYAMT              TO CPYAMTO.
 12865
 12866     IF PI-EPYAMT = ZEROS
 12867        MOVE AL-UNNON            TO EPYAMTA
 12868        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 246
* EL156.cbl
 12869
 12870     MOVE PI-CRESV               TO CRESVO.
 12871     MOVE PI-CEXPENS             TO CEXPENSO.
 12872
 12873     IF PI-EEXPENS = ZEROS
 12874        MOVE AL-UNNON TO EEXPENSA
 12875        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12876
 12877     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12878        AND (CL-CLAIM-TYPE = 'L')
 12879        AND (PI-OFFLINE NOT EQUAL 'Y')
 12880        IF PI-PMTTYPE = '2' OR '4'
 12881           PERFORM 2200-CALC-INTEREST
 12882                                 THRU 2200-EXIT
 12883        END-IF
 12884     END-IF
 12885     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12886     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12887     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12888
 12889     IF EMI-FATAL-CTR = ZEROS
 12890        MOVE 'B'                 TO PI-PASS-SW.
 12891
 12892     IF NOT EMI-MESSAGE-FORMATTED
 12893         MOVE -1                 TO EPYFROML
 12894     ELSE
 12895         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12896            EMI-ERROR-NUMBER (2) = SPACES
 12897             MOVE -1             TO EPYFROML.
 12898
 12899     GO TO 8200-SEND-DATAONLY.
 12900
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 247
* EL156.cbl
 12902 2200-CALC-INTEREST.
 12903     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12904        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12905        MOVE '4'                 TO DC-OPTION-CODE
 12906        PERFORM 9700-LINK-DATE-CONVERT
 12907        IF DATE-CONVERSION-ERROR
 12908            MOVE LOW-VALUES      TO CP-PRF-DT
 12909        ELSE
 12910           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12911        END-IF
 12912     END-IF
 12913     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12914        IN CLAIM-INT-PASS-AREA
 12915     MOVE CL-CERT-STATE          TO CP-STATE
 12916        IN CLAIM-INT-PASS-AREA
 12917     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12918     MOVE 'LF'                   TO CP-COVERAGE
 12919     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12920     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12921     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12922     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12923     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12924     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12925
 12926* EXEC CICS LINK
 12927*       PROGRAM   ('ELCLMI')
 12928*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12929*       LENGTH    (CP-CLAIM-LENGTH)
 12930*    END-EXEC
 12931     MOVE 'ELCLMI' TO DFHEIV1
 12932*    MOVE '."C                   (   #00012338' TO DFHEIV0
 12933     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12935     MOVE X'2020233030303132333338' TO DFHEIV0(25:11)
 12936     CALL 'kxdfhei1' USING DFHEIV0,
 12937           DFHEIV1,
 12938           CLAIM-INT-PASS-AREA,
 12939           CP-CLAIM-LENGTH,
 12940           DFHEIV99,
 12941           DFHEIV99,
 12942           DFHEIV99,
 12943           DFHEIV99
 12944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12945     MOVE AL-PANOF               TO PINTHA
 12946                                    PINTA
 12947     IF NO-CI-ERROR
 12948        MOVE CP-CLM-INT-AMT      TO PINTO
 12949                                    PI-INT-AMT
 12950        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12951        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12952        MOVE AL-PANOF            TO PINTHA
 12953                                    PINTA
 12954     ELSE
 12955        IF CI-RETURN-CODE = '8'
 12956           MOVE ER-3818          TO EMI-ERROR
 12957           MOVE -1               TO ZINTL
 12958           PERFORM 9900-ERROR-FORMAT
 12959                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 248
* EL156.cbl
 12960           GO TO 2200-EXIT
 12961        ELSE
 12962           MOVE ZEROS            TO PINTO
 12963                                    PI-INT-AMT
 12964                                    PI-INT-DAYS
 12965                                    PI-INT-RATE-USED
 12966        END-IF
 12967     END-IF
 12968     IF PI-INT-AMT NOT = ZEROS
 12969        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12970           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12971           CONTINUE
 12972        ELSE
 12973           MOVE CL-SOC-SEC-NO (1:3)
 12974                                 TO WS-SSN (1:3)
 12975           MOVE CL-SOC-SEC-NO (5:2)
 12976                                 TO WS-SSN (4:2)
 12977           MOVE CL-SOC-SEC-NO (8:4)
 12978                                 TO WS-SSN (6:4)
 12979           IF (WS-SSN NUMERIC)
 12980              AND (WS-SSN NOT = ZEROS)
 12981              CONTINUE
 12982           ELSE
 12983              MOVE ER-2044       TO EMI-ERROR
 12984              PERFORM 9900-ERROR-FORMAT
 12985                                 THRU 9900-EXIT
 12986           END-IF
 12987        END-IF
 12988        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12989        MOVE +51                 TO TRLR-SEQ-NO
 12990
 12991* EXEC CICS READ
 12992*          DATASET  ('ELTRLR')
 12993*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12994*          RIDFLD   (ELTRLR-KEY)
 12995*          RESP     (WS-RESPONSE)
 12996*       END-EXEC
 12997     MOVE 'ELTRLR' TO DFHEIV1
 12998*    MOVE '&"S        E          (  N#00012388' TO DFHEIV0
 12999     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13001     MOVE X'204E233030303132333838' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           DFHEIV1,
 13004           DFHEIV20,
 13005           DFHEIV99,
 13006           ELTRLR-KEY,
 13007           DFHEIV99,
 13008           DFHEIV99,
 13009           DFHEIV99
 13010     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13011         DFHEIV20
 13012     MOVE EIBRESP  TO WS-RESPONSE
 13013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13014        IF (NOT WS-RESP-NORMAL)
 13015                    OR
 13016           ((WS-RESP-NORMAL)
 13017           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 249
* EL156.cbl
 13018           OR (AT-CITY-STATE = SPACES)))
 13019           MOVE ER-0874          TO EMI-ERROR
 13020           PERFORM 9900-ERROR-FORMAT
 13021                                 THRU 9900-EXIT
 13022        END-IF
 13023     END-IF
 13024     .
 13025 2200-EXIT.
 13026     EXIT.
 13027 2210-dcc-max-benes.
 13028
 13029     move pi-ah-term             to ws-max-bens
 13030     if cl-critical-period not = zeros and spaces
 13031        move cl-critical-period  to ws-max-bens
 13032     end-if
 13033     move cm-ah-benefit-amt      to ws-monthly-benefit
 13034     if pdef-found
 13035        and (pd-max-amt (p1) not = zeros)
 13036        if pd-ben-pct (p1) not numeric
 13037           move zeros            to pd-ben-pct (p1)
 13038        end-if
 13039        if pd-ben-pct (p1) = zeros
 13040           move +1               to ws-work-ben-pct
 13041        else
 13042           move pd-ben-pct (p1)  to ws-work-ben-pct
 13043        end-if
 13044*       compute ws-monthly-benefit =
 13045*          ws-monthly-benefit * ws-work-ben-pct
 13046*       if ws-monthly-benefit > pd-max-amt (p1)
 13047*          move pd-max-amt (p1) to ws-monthly-benefit
 13048*       end-if
 13049     end-if
 13050
 13051     move cl-cert-key-data       to elcrtt-key (2:21)
 13052     move cl-company-cd          to ctrlr-comp-cd
 13053     move cl-cert-no             to ctrlr-cert-no
 13054     move 'B'                    to ctrlr-rec-type
 13055
 13056
 13057* EXEC CICS READ
 13058*       DATASET  ('ELCRTT')
 13059*       set      (address of CERTIFICATE-TRAILERS)
 13060*       RIDFLD   (ELCRTT-KEY)
 13061*       RESP     (WS-RESPONSE)
 13062*    END-EXEC
 13063     MOVE 'ELCRTT' TO DFHEIV1
 13064*    MOVE '&"S        E          (  N#00012436' TO DFHEIV0
 13065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13067     MOVE X'204E233030303132343336' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0,
 13069           DFHEIV1,
 13070           DFHEIV20,
 13071           DFHEIV99,
 13072           ELCRTT-KEY,
 13073           DFHEIV99,
 13074           DFHEIV99,
 13075           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 250
* EL156.cbl
 13076     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13077         DFHEIV20
 13078     MOVE EIBRESP  TO WS-RESPONSE
 13079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13080     IF not WS-RESP-NORMAL
 13081        go to 2210-exit
 13082     end-if
 13083
 13084*    if instypei = 'P'
 13085*       move +1 to s1
 13086*    else
 13087*       MOVE +2 to s1
 13088*    end-if
 13089
 13090*    move +1 to s1
 13091*    evaluate cl-claim-type
 13092*       when 'A'
 13093*          move +1 to s2
 13094*       when 'I'
 13095*          move +2 to s2
 13096*       when 'G'
 13097*          move +3 to s2
 13098*       when 'L'
 13099*          move +4 to s2
 13100*       when 'P'
 13101*          move +5 to s2
 13102*    end-evaluate
 13103
 13104     move zeros                  to ws-prev-days-paid
 13105                                    ws-benefits-paid
 13106                                    ws-prev-amt-paid
 13107     perform varying s1 from +1 by +1 until
 13108        (s1 > +24)
 13109        or (cs-claim-type (s1) = spaces)
 13110        if pi-company-id not = 'DCC'
 13111           if cs-claim-type (s1) = cl-claim-type
 13112              compute ws-prev-days-paid =
 13113                 ws-prev-days-paid + cs-days-paid (s1)
 13114              compute ws-prev-amt-paid =
 13115                 ws-prev-amt-paid + cs-total-paid (s1)
 13116           end-if
 13117        else
 13118           if (cs-claim-type (s1) = cl-claim-type)
 13119              and (cs-benefit-period (s1) = cl-benefit-period)
 13120              and (cs-insured-type (s1) = cl-insured-type)
 13121              compute ws-prev-days-paid =
 13122                 ws-prev-days-paid + cs-days-paid (s1)
 13123              compute ws-prev-amt-paid =
 13124                 ws-prev-amt-paid + cs-total-paid (s1)
 13125           end-if
 13126        end-if
 13127     end-perform
 13128     if pi-epyamt > zeros
 13129        compute ws-benefits-paid =
 13130           (ws-prev-amt-paid + pi-epyamt)
 13131           / ws-monthly-benefit
 13132     else
 13133        compute ws-benefits-paid =
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 251
* EL156.cbl
 13134           (ws-prev-amt-paid + pi-cpyamt)
 13135           / ws-monthly-benefit
 13136     end-if
 13137*    if pi-company-id = 'DCC'
 13138     if cl-claim-type not = 'L' and 'P'
 13139        if ws-benefits-paid > ws-max-bens
 13140           move er-1658          to emi-error
 13141           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13142        end-if
 13143     end-if
 13144*    end-if
 13145*     if s1 < +25
 13146*        if pi-epyamt > zeros
 13147*           compute ws-benefits-paid =
 13148*              (cs-total-paid (s1) + PI-EPYAMT)
 13149*              / ws-monthly-benefit
 13150*        else
 13151*           compute ws-benefits-paid =
 13152*              (cs-total-paid (s1) + PI-CPYAMT)
 13153*              / ws-monthly-benefit
 13154*        end-if
 13155
 13156*       if ws-benefits-paid > pd-crit-period (p1)
 13157*        if ws-benefits-paid > ws-max-bens
 13158*           move er-1658          to emi-error
 13159*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160*        end-if
 13161*     end-if
 13162     .
 13163 2210-exit.
 13164     exit.
 13165
 13166 2220-update-elcrtt.
 13167
 13168
 13169* EXEC CICS GETMAIN
 13170*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13171*       LENGTH   (ELCRTT-LENGTH)
 13172*       INITIMG  (GETMAIN-SPACE)
 13173*    END-EXEC
 13174*    MOVE ',"IL                  $   #00012530' TO DFHEIV0
 13175     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13177     MOVE X'2020233030303132353330' TO DFHEIV0(25:11)
 13178     CALL 'kxdfhei1' USING DFHEIV0,
 13179           DFHEIV20,
 13180           ELCRTT-LENGTH,
 13181           GETMAIN-SPACE
 13182     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13183         DFHEIV20
 13184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13185
 13186     move cl-cert-key-data       to elcrtt-key (2:21)
 13187     move cl-company-cd          to ctrlr-comp-cd
 13188     move cl-cert-no             to ctrlr-cert-no
 13189     move 'B'                    to ctrlr-rec-type
 13190
 13191
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 252
* EL156.cbl
 13192* EXEC CICS READ
 13193*       UPDATE
 13194*       DATASET  (ELCRTT-DSID)
 13195*       into     (CERTIFICATE-TRAILERS)
 13196*       RIDFLD   (ELCRTT-KEY)
 13197*       RESP     (WS-RESPONSE)
 13198*    END-EXEC
 13199     MOVE LENGTH OF
 13200      CERTIFICATE-TRAILERS
 13201       TO DFHEIV11
 13202*    MOVE '&"IL       EU         (  N#00012541' TO DFHEIV0
 13203     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13205     MOVE X'204E233030303132353431' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
 13207           ELCRTT-DSID,
 13208           CERTIFICATE-TRAILERS,
 13209           DFHEIV11,
 13210           ELCRTT-KEY,
 13211           DFHEIV99,
 13212           DFHEIV99,
 13213           DFHEIV99
 13214     MOVE EIBRESP  TO WS-RESPONSE
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13216
 13217     IF WS-RESP-NORMAL
 13218        perform 2225-upd-crt-trlr thru 2225-exit
 13219
 13220* EXEC CICS REWRITE
 13221*          DATASET  (ELCRTT-DSID)
 13222*          from     (CERTIFICATE-TRAILERS)
 13223*          RESP     (WS-RESPONSE)
 13224*       END-EXEC
 13225     MOVE LENGTH OF
 13226      CERTIFICATE-TRAILERS
 13227       TO DFHEIV11
 13228*    MOVE '&& L                  %  N#00012551' TO DFHEIV0
 13229     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13230     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13231     MOVE X'204E233030303132353531' TO DFHEIV0(25:11)
 13232     CALL 'kxdfhei1' USING DFHEIV0,
 13233           ELCRTT-DSID,
 13234           CERTIFICATE-TRAILERS,
 13235           DFHEIV11,
 13236           DFHEIV99
 13237     MOVE EIBRESP  TO WS-RESPONSE
 13238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13239     else
 13240        if ws-resp-notfnd
 13241           move 'CS'             to certificate-trailers
 13242           move cl-company-cd    to cs-company-cd
 13243           move cl-cert-key-data to cs-control-primary (2:21)
 13244           move cl-cert-no       to cs-cert-no
 13245           move 'B'              to cs-trailer-type
 13246           perform varying s1 from +1 by +1 until s1 > +24
 13247              move zeros         to cs-benefit-period (s1)
 13248                                    cs-days-paid (s1)
 13249                                    cs-total-paid (s1)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 253
* EL156.cbl
 13250                                    cs-remaining-bens (s1)
 13251           end-perform
 13252           perform 2225-upd-crt-trlr
 13253                                 thru 2225-exit
 13254
 13255* EXEC CICS WRITE
 13256*             DATASET  (ELCRTT-DSID)
 13257*             from     (CERTIFICATE-TRAILERS)
 13258*             RIDFLD   (cs-control-primary)
 13259*             RESP     (WS-RESPONSE)
 13260*          END-EXEC
 13261     MOVE LENGTH OF
 13262      CERTIFICATE-TRAILERS
 13263       TO DFHEIV11
 13264*    MOVE '&$ L                  ''  N#00012571' TO DFHEIV0
 13265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13267     MOVE X'204E233030303132353731' TO DFHEIV0(25:11)
 13268     CALL 'kxdfhei1' USING DFHEIV0,
 13269           ELCRTT-DSID,
 13270           CERTIFICATE-TRAILERS,
 13271           DFHEIV11,
 13272           cs-control-primary,
 13273           DFHEIV99,
 13274           DFHEIV99
 13275     MOVE EIBRESP  TO WS-RESPONSE
 13276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13277        end-if
 13278     END-IF
 13279
 13280     .
 13281 2220-exit.
 13282     exit.
 13283
 13284 2225-upd-crt-trlr.
 13285
 13286*    if instypei = 'P'
 13287*       move +1 to s1
 13288*    else
 13289*       MOVE +2 to s1
 13290*    end-if
 13291
 13292*    move +1 to s1
 13293*    evaluate cl-claim-type
 13294*       when 'A'
 13295*          move +1 to s2
 13296*       when 'I'
 13297*          move +2 to s2
 13298*       when 'G'
 13299*          move +3 to s2
 13300*       when 'L'
 13301*          move +4 to s2
 13302*       when 'P'
 13303*          move +5 to s2
 13304*    end-evaluate
 13305     perform varying s1 from +1 by +1 until
 13306        (s1 > +24)
 13307        or (cl-claim-no = cs-claim-no (s1))
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 254
* EL156.cbl
 13308     end-perform
 13309     if s1 < +25
 13310        compute cs-total-paid (s1) =
 13311           cs-total-paid (s1) + at-amount-paid
 13312        compute cs-days-paid (s1) =
 13313           cs-days-paid (s1) +  at-days-in-period
 13314*       compute cs-remaining-bens (s1) =
 13315*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13316        perform 2230-accum-bens-paid thru 2230-exit
 13317     end-if
 13318
 13319     .
 13320 2225-exit.
 13321     exit.
 13322 2230-accum-bens-paid.
 13323     if cl-claim-type not = 'L' and 'P'
 13324        move pi-ah-term          to ws-max-bens
 13325        if cl-critical-period not = zeros and spaces
 13326           move cl-critical-period
 13327                                 to ws-max-bens
 13328        end-if
 13329     else
 13330        move 01                  to ws-max-bens
 13331     end-if
 13332     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13333     perform varying s2 from +1 by +1 until
 13334        (s2 > +24)
 13335        or (cs-claim-no (s2) = spaces)
 13336        if pi-company-id not = 'DCC'
 13337           if cs-claim-type (s2) = cl-claim-type
 13338              compute ws-tot-days-paid =
 13339                 ws-tot-days-paid + cs-days-paid (s2)
 13340              compute ws-tot-amt-paid =
 13341                 ws-tot-amt-paid + cs-total-paid (s2)
 13342           end-if
 13343        else
 13344           if (cs-benefit-period (s2) = cl-benefit-period)
 13345              and (cs-claim-type (s2) = cl-claim-type)
 13346              and (cs-insured-type (s2) = cl-insured-type)
 13347              compute ws-tot-days-paid =
 13348                 ws-tot-days-paid + cs-days-paid (s2)
 13349              compute ws-tot-amt-paid =
 13350                 ws-tot-amt-paid + cs-total-paid (s2)
 13351           end-if
 13352        end-if
 13353     end-perform
 13354     if cl-claim-type = 'L' and 'P'
 13355        if ws-tot-amt-paid > zeros
 13356           move zeros            to cs-remaining-bens (s1)
 13357        else
 13358           move 01               to cs-remaining-bens (s1)
 13359        end-if
 13360     else
 13361        compute ws-pd-bens rounded =
 13362           ws-tot-amt-paid / pi-ah-benefit-amt
 13363        compute cs-remaining-bens (s1) =
 13364           ws-max-bens - ws-pd-bens
 13365        if cs-remaining-bens (s1) < zeros
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 255
* EL156.cbl
 13366           move zeros            to cs-remaining-bens (s1)
 13367        end-if
 13368     end-if
 13369     .
 13370 2230-exit.
 13371     exit.
 13372 3000-MOVE-INPUT-TO-SAVE-AREA.
 13373     IF PMTTYPEL > 0
 13374         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13375
 13376     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13377
 13378     IF WS-PMTTYPE = '9'
 13379         MOVE 'P'                TO PI-PROVISIONAL-IND
 13380         MOVE '1'                TO WS-PMTTYPE.
 13381
 13382     IF PAYEEL > 0
 13383         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13384         MOVE PAYEEI             TO WS-PAYEE.
 13385
 13386     IF NOTE1L > +0
 13387         MOVE NOTE1I             TO WS-PMTNOTE1
 13388                                    WS-FLI-PMTNOTE
 13389                                    WS-HAN-PMTNOTE.
 13390
 13391     IF NOTE2L > +0
 13392         MOVE NOTE2I             TO WS-PMTNOTE2.
 13393
 13394     IF OFFLINEL > 0
 13395         MOVE OFFLINEI           TO WS-OFFLINE.
 13396
 13397     IF PROOFDTL > 0
 13398         MOVE PROOFDTI            TO DATE-WORK
 13399         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13400         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13401         MOVE '4'                 TO DC-OPTION-CODE
 13402         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13403         IF NO-CONVERSION-ERROR
 13404            MOVE NUM-WORK         TO PROOFDTO
 13405            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13406            MOVE NUM-WORK         TO WS-PROOF-DATE
 13407         ELSE
 13408            MOVE ZEROS            TO WS-PROOF-DATE
 13409         END-IF
 13410     END-IF.
 13411
 13412     IF EOBYNL > +0
 13413         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13414         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13415     END-IF
 13416
 13417     IF CLMFMYNL > +0
 13418         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13419         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13420     END-IF
 13421
 13422     IF SURVYYNL > +0
 13423         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 256
* EL156.cbl
 13424         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13425     END-IF
 13426
 13427     IF SPRELYNL > +0
 13428         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13429         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13430     END-IF
 13431*    IF GROUPEDL > +0
 13432*        MOVE GROUPEDI           TO WS-GROUPED.
 13433*
 13434*    IF CASHL > +0
 13435*       MOVE CASHI               TO WS-CASH.
 13436     IF LOANNOL > +0
 13437         MOVE LOANNOI            TO WS-LOAN-NO.
 13438
 13439     IF CHECKNOL > 0
 13440         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13441
 13442     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13443         IF WS-AIG-CREDIT-ENTERED
 13444             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13445             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13446             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13447             MOVE AL-UANON         TO CHECKNOA.
 13448
 13449     IF HOLDTILL > 0
 13450         MOVE HOLDTILI           TO DATE-WORK
 13451         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13452         MOVE NUM-WORK           TO WS-HOLDTIL.
 13453
 13454     IF ZINTL > +0
 13455
 13456* EXEC CICS BIF DEEDIT
 13457*           FIELD   (ZINTI)
 13458*           LENGTH  (07)
 13459*       END-EXEC
 13460     MOVE 07
 13461       TO DFHEIV11
 13462*    MOVE '@"L                   #   #00012755' TO DFHEIV0
 13463     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13464     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13465     MOVE X'2020233030303132373535' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0,
 13467           ZINTI,
 13468           DFHEIV11
 13469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13470        IF ZINTI NOT NUMERIC
 13471           MOVE ER-0419          TO EMI-ERROR
 13472           PERFORM 9900-ERROR-FORMAT
 13473           MOVE AL-UABON         TO ZINTA
 13474           MOVE -1               TO ZINTL
 13475        ELSE
 13476           MOVE ZINTI            TO CP-INT-RATE
 13477                                    WS-INT-RATE
 13478           MOVE CP-INT-RATE      TO ZINTO
 13479           MOVE AL-UNNON         TO ZINTA
 13480        END-IF
 13481     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 257
* EL156.cbl
 13482        MOVE ZEROS               TO CP-INT-RATE
 13483     END-IF
 13484     IF EPYFROML > 0
 13485         MOVE EPYFROMI           TO DATE-WORK
 13486         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13487         MOVE NUM-WORK           TO WS-EPYFROM.
 13488
 13489     IF AIGFROML > 0
 13490         MOVE AIGFROMI           TO DATE-WORK
 13491         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13492         MOVE NUM-WORK           TO WS-AIGFROM
 13493     ELSE
 13494         IF (AIGFROMI = LOW-VALUES) AND
 13495            (PI-AIGFROM NOT = ZEROS)
 13496              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13497
 13498     IF EPYTHRUL > +0
 13499        MOVE EPYTHRUI           TO DATE-WORK
 13500        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13501        MOVE NUM-WORK           TO WS-EPYTHRU
 13502        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13503        MOVE '4'                TO DC-OPTION-CODE
 13504        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13505        IF NO-CONVERSION-ERROR
 13506           IF PI-USES-PAID-TO
 13507              MOVE '6'                TO DC-OPTION-CODE
 13508              MOVE -1                 TO DC-ELAPSED-DAYS
 13509              MOVE +0                 TO DC-ELAPSED-MONTHS
 13510              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13511              IF NO-CONVERSION-ERROR
 13512                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13513                 MOVE ' '             TO DC-OPTION-CODE
 13514                 MOVE +0              TO DC-ELAPSED-DAYS
 13515                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13516              IF NO-CONVERSION-ERROR
 13517                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13518
 13519*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13520*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13521     IF EDAYSL > 0
 13522
 13523* EXEC CICS BIF DEEDIT
 13524*            FIELD(EDAYSI)
 13525*            LENGTH(6)
 13526*        END-EXEC
 13527     MOVE 6
 13528       TO DFHEIV11
 13529*    MOVE '@"L                   #   #00012811' TO DFHEIV0
 13530     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13531     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13532     MOVE X'2020233030303132383131' TO DFHEIV0(25:11)
 13533     CALL 'kxdfhei1' USING DFHEIV0,
 13534           EDAYSI,
 13535           DFHEIV11
 13536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13537         MOVE EDAYSI             TO WS-DY-WORK
 13538         IF WS-DY-SIGN = SPACES
 13539            MOVE WS-DY-NUM       TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 258
* EL156.cbl
 13540            ADD 0                TO WS-EDAYS
 13541         ELSE
 13542            MOVE EDAYSI          TO WS-EDAYS
 13543            ADD 0                TO WS-EDAYS.
 13544
 13545*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13546*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13547     IF EPYAMTL > 0
 13548
 13549* EXEC CICS BIF DEEDIT
 13550*            FIELD(EPYAMTI)
 13551*            LENGTH(10)
 13552*        END-EXEC
 13553     MOVE 10
 13554       TO DFHEIV11
 13555*    MOVE '@"L                   #   #00012826' TO DFHEIV0
 13556     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13557     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13558     MOVE X'2020233030303132383236' TO DFHEIV0(25:11)
 13559     CALL 'kxdfhei1' USING DFHEIV0,
 13560           EPYAMTI,
 13561           DFHEIV11
 13562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13563         MOVE EPYAMTI            TO WS-PY-WORK
 13564         IF WS-PY-SIGN = SPACES
 13565            MOVE WS-PY-NUM       TO WS-EPYAMT
 13566            ADD 0                TO WS-EPYAMT
 13567         ELSE
 13568            MOVE EPYAMTI         TO WS-EPYAMT
 13569            ADD 0                TO WS-EPYAMT.
 13570
 13571     IF ERESVL > 0
 13572
 13573* EXEC CICS BIF DEEDIT
 13574*            FIELD(ERESVI)
 13575*            LENGTH(9)
 13576*        END-EXEC
 13577     MOVE 9
 13578       TO DFHEIV11
 13579*    MOVE '@"L                   #   #00012839' TO DFHEIV0
 13580     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13582     MOVE X'2020233030303132383339' TO DFHEIV0(25:11)
 13583     CALL 'kxdfhei1' USING DFHEIV0,
 13584           ERESVI,
 13585           DFHEIV11
 13586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13587         MOVE ERESVI TO WS-ERESV.
 13588
 13589     IF EEXPENSL > 0
 13590
 13591* EXEC CICS BIF DEEDIT
 13592*            FIELD(EEXPENSI)
 13593*            LENGTH(8)
 13594*        END-EXEC
 13595     MOVE 8
 13596       TO DFHEIV11
 13597*    MOVE '@"L                   #   #00012846' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 259
* EL156.cbl
 13598     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303132383436' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
 13602           EEXPENSI,
 13603           DFHEIV11
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13605         MOVE EEXPENSI           TO WS-EEXPENS.
 13606
 13607     IF ETYPEL > ZEROS
 13608         MOVE ETYPEI             TO WS-ETYPE.
 13609
 13610     IF PI-COMPANY-ID = 'BOA'
 13611        IF PINTL > ZEROS
 13612
 13613* EXEC CICS BIF DEEDIT
 13614*            FIELD (PINTI)
 13615*            LENGTH(05)
 13616*          END-EXEC
 13617     MOVE 05
 13618       TO DFHEIV11
 13619*    MOVE '@"L                   #   #00012857' TO DFHEIV0
 13620     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13621     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13622     MOVE X'2020233030303132383537' TO DFHEIV0(25:11)
 13623     CALL 'kxdfhei1' USING DFHEIV0,
 13624           PINTI,
 13625           DFHEIV11
 13626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13627           IF PINTI NUMERIC
 13628               MOVE AL-UNNON     TO PINTA
 13629               MOVE PINTI        TO WS-INT-RATE
 13630               MOVE WS-INT-RATE  TO PINTO.
 13631
 13632 3000-EXIT.
 13633     EXIT.
 13634
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 260
* EL156.cbl
 13636 3050-REBUILD-ENTERED.
 13637
 13638     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13639
 13640     IF PI-PROV-PMT
 13641         MOVE '9'           TO PMTTYPEO
 13642     ELSE
 13643         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13644
 13645     MOVE PI-PAYEE          TO PAYEEO.
 13646     MOVE PI-PMTNOTE1       TO NOTE1O.
 13647     MOVE PI-PMTNOTE2       TO NOTE2O.
 13648     MOVE PI-OFFLINE        TO OFFLINEO.
 13649     IF PI-PROOF-DATE NOT = ZEROS
 13650         MOVE PI-PROOF-DATE TO PROOFDTO
 13651         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13652     END-IF.
 13653*    MOVE PI-GROUPED        TO GROUPEDO.
 13654
 13655*    MOVE PI-CASH           TO CASHO.
 13656
 13657     IF PI-INT-RATE > ZEROS
 13658         MOVE PI-INT-RATE   TO PINTO.
 13659
 13660     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13661        IF PI-INT-AMT > ZEROS
 13662           MOVE PI-INT-AMT       TO PINTO
 13663           MOVE AL-PANOF         TO PINTA
 13664                                    PINTHA
 13665        END-IF
 13666     END-IF
 13667     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13668     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13669     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13670     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13671     IF PI-HOLDTIL NOT = ZEROS
 13672        MOVE PI-HOLDTIL          TO HOLDTILO
 13673        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13674
 13675     IF PI-EPYFROM NOT = ZEROS
 13676        MOVE PI-EPYFROM          TO EPYFROMO
 13677        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13678
 13679     IF PI-AIGFROM NOT = ZEROS
 13680        MOVE PI-AIGFROM          TO AIGFROMO
 13681        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13682
 13683     IF PI-EPYTHRU NOT = ZEROS
 13684        MOVE PI-EPYTHRU          TO EPYTHRUO
 13685        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13686        IF PI-USES-PAID-TO
 13687           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13688           MOVE '4'                TO DC-OPTION-CODE
 13689           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13690           IF NO-CONVERSION-ERROR
 13691              MOVE +1 TO DC-ELAPSED-DAYS
 13692              MOVE +0 TO DC-ELAPSED-MONTHS
 13693              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 261
* EL156.cbl
 13694              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13695              IF NO-CONVERSION-ERROR
 13696                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13697
 13698     IF PI-EDAYS NOT = ZEROS
 13699        MOVE PI-EDAYS TO EDAYSO.
 13700
 13701     IF PI-EPYAMT NOT = ZEROS
 13702        MOVE PI-EPYAMT TO EPYAMTO.
 13703
 13704     IF PI-ERESV NOT = ZEROS
 13705        MOVE PI-ERESV TO ERESVO.
 13706
 13707     IF PI-EEXPENS NOT = ZEROS
 13708        MOVE PI-EEXPENS TO EEXPENSO.
 13709
 13710     MOVE PI-ETYPE TO ETYPEO.
 13711
 13712     IF PI-ECHECKNO NOT = SPACES
 13713        MOVE PI-ECHECKNO         TO CHECKNOO
 13714     ELSE
 13715        MOVE PI-CCHECKNO         TO CHECKNOO.
 13716
 13717     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13718     MOVE SPACES                 TO DC-OPTION-CODE.
 13719     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13720
 13721     IF DATE-CONVERSION-ERROR
 13722        MOVE SPACES              TO CPYFROMI
 13723     ELSE
 13724        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13725
 13726     IF PI-USES-PAID-TO
 13727        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13728        MOVE +1                  TO DC-ELAPSED-DAYS
 13729        MOVE +0                  TO DC-ELAPSED-MONTHS
 13730        MOVE '6'                 TO DC-OPTION-CODE
 13731        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13732        IF NO-CONVERSION-ERROR
 13733           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13734           GO TO 3051-CONTINUE.
 13735
 13736     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13737     MOVE SPACES                 TO DC-OPTION-CODE.
 13738     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13739
 13740     IF DATE-CONVERSION-ERROR
 13741        MOVE SPACES              TO CPYTHRUI
 13742     ELSE
 13743        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13744
 13745 3051-CONTINUE.
 13746
 13747     IF PI-CDAYS NOT = ZEROS
 13748        MOVE PI-CDAYS TO CDAYSO.
 13749
 13750     IF PI-CPYAMT NOT = ZEROS
 13751        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 262
* EL156.cbl
 13752
 13753     IF PI-CRESV NOT = ZEROS
 13754        MOVE PI-CRESV TO CRESVO.
 13755
 13756     IF PI-CEXPENS NOT = ZEROS
 13757        MOVE PI-CEXPENS TO CEXPENSO.
 13758
 13759 3059-EXIT.
 13760     EXIT.
 13761
 13762 3100-DEEDIT-DATE.
 13763
 13764* EXEC CICS BIF DEEDIT
 13765*        FIELD(DATE-WORK)
 13766*        LENGTH(8)
 13767*    END-EXEC.
 13768     MOVE 8
 13769       TO DFHEIV11
 13770*    MOVE '@"L                   #   #00012997' TO DFHEIV0
 13771     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13772     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13773     MOVE X'2020233030303132393937' TO DFHEIV0(25:11)
 13774     CALL 'kxdfhei1' USING DFHEIV0,
 13775           DATE-WORK,
 13776           DFHEIV11
 13777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13778
 13779
 13780 3100-EXIT.
 13781     EXIT.
 13782
 13783 3200-CALC-AIG-DAYS.
 13784
 13785     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13786
 13787     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13788     MOVE ' '                    TO DC-OPTION-CODE.
 13789     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13790     IF NO-CONVERSION-ERROR
 13791         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13792     ELSE
 13793         GO TO 3290-ERROR.
 13794
 13795     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13796         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13797                                WS-BIN-FROM-DT
 13798     ELSE
 13799         IF CL-TOTAL-PAID-AMT > ZEROS
 13800             IF WS-SV-EPYFROM = LOW-VALUES
 13801                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13802                                        WS-BIN-FROM-DT
 13803             ELSE
 13804                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13805                                        WS-BIN-FROM-DT
 13806         ELSE
 13807             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13808                                        WS-BIN-FROM-DT.
 13809
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 263
* EL156.cbl
 13810 3210-CONTINUE.
 13811
 13812     MOVE ' '                    TO DC-OPTION-CODE.
 13813     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13814     IF DATE-CONVERSION-ERROR
 13815         GO TO 3290-ERROR.
 13816
 13817     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13818
 13819     IF PI-LOAN-DUE-DAY = 31
 13820         MOVE 30              TO WS-PMT-DUE-DA
 13821                                 WS-SAVE-DUE-DA
 13822     ELSE
 13823         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13824                                 WS-SAVE-DUE-DA.
 13825
 13826     IF (PI-LOAN-DUE-DAY > 28) AND
 13827        (WS-PMT-DUE-MO = 2)
 13828         MOVE 'Y'                TO WS-DUE-DAY-SW
 13829         MOVE 28                 TO WS-PMT-DUE-DA.
 13830
 13831     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13832     MOVE '4'                    TO DC-OPTION-CODE.
 13833     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13834     IF NO-CONVERSION-ERROR
 13835         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13836     ELSE
 13837         GO TO 3290-ERROR.
 13838
 13839*--------------------------------------------------------------*
 13840*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13841*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13842*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13843*                                                              *
 13844*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13845*             INCURRED DATE      - 04/15/91                    *
 13846*             PMT DUE DATE       - 04/03/91                    *
 13847*             PMT DUE DATE       - 05/03/91                    *
 13848*--------------------------------------------------------------*
 13849
 13850     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13851        (WS-SV-AIGFROM = LOW-VALUES)
 13852         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13853            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13854             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13855             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13856             IF NO-CONVERSION-ERROR
 13857                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13858                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13859             ELSE
 13860                 GO TO 3290-ERROR.
 13861
 13862     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13863        (WS-SV-AIGFROM = LOW-VALUES)
 13864         GO TO 3205-CONT-CALC-PMT.
 13865
 13866     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13867     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 264
* EL156.cbl
 13868     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13869     IF NO-CONVERSION-ERROR
 13870         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13871     ELSE
 13872         GO TO 3290-ERROR.
 13873
 13874     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13875        (WS-PMT-DUE-DA < WS-FROM-DA)
 13876          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13877          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13878          IF NO-CONVERSION-ERROR
 13879              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13880              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13881          ELSE
 13882              GO TO 3290-ERROR.
 13883
 13884 3205-CONT-CALC-PMT.
 13885
 13886*--------------------------------------------------------------*
 13887*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13888*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13889*--------------------------------------------------------------*
 13890
 13891     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13892        PI-PMTTYPE = '2'
 13893          NEXT SENTENCE
 13894     ELSE
 13895        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13896           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13897             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13898             MOVE ER-3527            TO EMI-ERROR
 13899             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13900             MOVE -1                 TO EPYTHRUL
 13901             MOVE AL-UNBON           TO EPYTHRUA
 13902                                        EPYFROMA
 13903             GO TO 3299-EXIT.
 13904
 13905*--------------------------------------------------------------*
 13906*    CALCULATE RETRO ELIMINATION DATE                          *
 13907*--------------------------------------------------------------*
 13908
 13909     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13910         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13911     ELSE
 13912         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13913
 13914     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13915     MOVE +0             TO DC-ELAPSED-MONTHS.
 13916     MOVE '6'            TO DC-OPTION-CODE.
 13917     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13918     IF NO-CONVERSION-ERROR
 13919         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13920     ELSE
 13921         GO TO 3290-ERROR.
 13922
 13923 3210-CHECK-PMT-DATE.
 13924
 13925*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 265
* EL156.cbl
 13926*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13927*    THE ENTERED PAY FROM DATE                                 *
 13928*--------------------------------------------------------------*
 13929
 13930     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13931         NEXT SENTENCE
 13932     ELSE
 13933         GO TO 3220-COMPUTE-DAYS.
 13934
 13935     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13936     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13937     IF NO-CONVERSION-ERROR
 13938         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13939         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13940         GO TO 3210-CHECK-PMT-DATE
 13941     ELSE
 13942         GO TO 3290-ERROR.
 13943
 13944 3220-COMPUTE-DAYS.
 13945
 13946     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13947     MOVE ZEROS         TO WS-CDAYS.
 13948     MOVE 'N'           TO WS-ELIMINATION-SW.
 13949
 13950*--------------------------------------------------------------*
 13951*    COMPUTE CALIFORNIA DUE DAYS                               *
 13952*--------------------------------------------------------------*
 13953
 13954     IF CL-TOTAL-PAID-AMT > ZEROS
 13955         MOVE 'Y' TO WS-ELIMINATION-SW
 13956         GO TO 3240-FIRST-PMT-DUE
 13957     ELSE
 13958        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13959            NEXT SENTENCE
 13960        ELSE
 13961            GO TO 3240-FIRST-PMT-DUE.
 13962
 13963 3230-NEXT-PMT-DUE.
 13964
 13965     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13966     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13967     IF NO-CONVERSION-ERROR
 13968         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13969         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13970     ELSE
 13971         GO TO 3290-ERROR.
 13972
 13973 3240-FIRST-PMT-DUE.
 13974
 13975     IF CL-TOTAL-PAID-AMT > ZEROS
 13976         NEXT SENTENCE
 13977     ELSE
 13978        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13979            GO TO 3230-NEXT-PMT-DUE.
 13980
 13981     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13982         GO TO 3250-VERIFY-ELIMINATION.
 13983
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 266
* EL156.cbl
 13984     ADD +30 TO WS-CDAYS.
 13985     MOVE 'Y' TO WS-ELIMINATION-SW.
 13986     GO TO 3230-NEXT-PMT-DUE.
 13987
 13988 3250-VERIFY-ELIMINATION.
 13989
 13990     IF ELIM-SATISFIED
 13991         GO TO 3260-END-CALC.
 13992
 13993     IF PI-PMTTYPE = '1'
 13994         MOVE ZEROS TO WS-CDAYS
 13995         GO TO 3260-END-CALC.
 13996
 13997     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13998         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13999     ELSE
 14000         IF CL-TOTAL-PAID-AMT > ZEROS
 14001             IF WS-SV-EPYFROM = LOW-VALUES
 14002                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14003             ELSE
 14004                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14005         ELSE
 14006             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14007
 14008     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14009     MOVE '1'                    TO DC-OPTION-CODE.
 14010     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14011     IF NO-CONVERSION-ERROR
 14012         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14013     ELSE
 14014         GO TO 3290-ERROR.
 14015
 14016     IF CL-TOTAL-PAID-AMT > ZEROS
 14017         MOVE WS-DAYS-OFF TO WS-CDAYS
 14018     ELSE
 14019         IF PI-BEN-DAYS > WS-DAYS-OFF
 14020             MOVE ZEROS TO WS-CDAYS
 14021         ELSE
 14022             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14023
 14024 3260-END-CALC.
 14025
 14026     MOVE WS-CDAYS TO PI-CDAYS.
 14027
 14028     IF PI-EDAYS = ZEROS
 14029         MOVE PI-CDAYS TO PI-EDAYS
 14030         MOVE AL-UNNON TO EDAYSA.
 14031
 14032     GO TO 3299-EXIT.
 14033
 14034 3290-ERROR.
 14035
 14036     MOVE ER-3528            TO EMI-ERROR.
 14037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14038     MOVE -1                 TO CDAYSL.
 14039     MOVE AL-UNBON           TO CDAYSA.
 14040
 14041 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 267
* EL156.cbl
 14042     EXIT.
 14043
 14044 3300-BUMP-DATE.
 14045
 14046     IF WS-RESTORE-DUE-DAY
 14047         MOVE 'N'              TO WS-DUE-DAY-SW
 14048         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14049         ADD 1                 TO WS-PMT-DUE-MO
 14050         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14051         MOVE '4'              TO DC-OPTION-CODE
 14052         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14053         IF NO-CONVERSION-ERROR
 14054             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14055             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14056             GO TO 3399-EXIT
 14057         ELSE
 14058             MOVE '9'          TO DC-ERROR-CODE
 14059             GO TO 3399-EXIT.
 14060
 14061     IF (WS-PMT-DUE-MO = 1) AND
 14062        (WS-SAVE-DUE-DA > 28)
 14063           MOVE 'Y' TO WS-DUE-DAY-SW.
 14064
 14065     MOVE +0                 TO DC-ELAPSED-DAYS.
 14066     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14067     MOVE '6'                TO DC-OPTION-CODE.
 14068     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14069
 14070 3399-EXIT.
 14071     EXIT.
 14072
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 268
* EL156.cbl
 14074 3400-COMPUTE-EXPIRY.
 14075
 14076     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14077     MOVE +0                    TO DC-ELAPSED-DAYS
 14078                                   DC-ODD-DAYS-OVER.
 14079     MOVE '1'                   TO DC-END-OF-MONTH.
 14080     MOVE '6'                   TO DC-OPTION-CODE.
 14081
 14082     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14083         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14084     ELSE
 14085         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14086
 14087     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14088     IF NO-CONVERSION-ERROR
 14089         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14090     ELSE
 14091         GO TO 3390-CONTINUE.
 14092
 14093     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14094         GO TO 3390-CONTINUE.
 14095
 14096     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14097     MOVE '4'                    TO CNTL-REC-TYPE.
 14098     MOVE +0                     TO CNTL-SEQ-NO.
 14099     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14100     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14101     MOVE 'BENE'                 TO FILE-SWITCH.
 14102
 14103     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14104
 14105     IF NO-BENEFIT-FOUND
 14106         GO TO 3390-CONTINUE.
 14107
 14108     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14109        IF (PI-OFFLINE = 'Y') OR
 14110           (PI-PMTTYPE = '7')
 14111           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14112                                     THRU 9870-EXIT
 14113           IF ERROR-ON-OUTPUT
 14114             MOVE -1                 TO ENTERPFL
 14115             MOVE AL-UANON           TO ENTERPFA
 14116             MOVE MAP-NAMEA          TO MAP-NAME
 14117             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14118             GO TO 8200-SEND-DATAONLY.
 14119
 14120     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14121        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14122        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14123          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14124          MOVE +0        TO DC-ELAPSED-DAYS
 14125          MOVE +1        TO DC-ELAPSED-MONTHS
 14126          MOVE 6         TO DC-OPTION-CODE
 14127          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14128          IF NO-CONVERSION-ERROR
 14129              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14130
 14131 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 269
* EL156.cbl
 14132
 14133      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14134         MOVE CM-AH-LOAN-EXPIRE-DT
 14135                                 TO DC-BIN-DATE-1
 14136      ELSE
 14137         MOVE CM-LF-LOAN-EXPIRE-DT
 14138                                 TO DC-BIN-DATE-1
 14139      END-IF
 14140
 14141      MOVE ' '                    TO DC-OPTION-CODE.
 14142      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14143      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14144      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14145
 14146 3499-EXIT.
 14147     EXIT.
 14148
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 270
* EL156.cbl
 14150
 14151 3600-CHECK-VERIFICATION.
 14152
 14153     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14154
 14155     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14156
 14157     IF PI-PAYEE-TYPE = 'I'
 14158        GO TO 3600-READ-TRAILER.
 14159
 14160     IF PI-PAYEE-TYPE = 'B'
 14161        ADD +10                  TO TRLR-SEQ-NO
 14162        GO TO 3600-READ-TRAILER.
 14163
 14164     IF PI-PAYEE-TYPE = 'A'
 14165        ADD +20                  TO TRLR-SEQ-NO
 14166        GO TO 3600-READ-TRAILER.
 14167
 14168     IF PI-PAYEE-TYPE = 'O'
 14169        ADD +50                  TO TRLR-SEQ-NO
 14170        GO TO 3600-READ-TRAILER.
 14171
 14172     IF PI-PAYEE-TYPE = 'Q'
 14173        ADD +60                  TO TRLR-SEQ-NO
 14174        GO TO 3600-READ-TRAILER.
 14175
 14176     IF PI-PAYEE-TYPE = 'P'
 14177        ADD +30                  TO TRLR-SEQ-NO
 14178        GO TO 3600-READ-TRAILER.
 14179
 14180     IF PI-PAYEE-TYPE = 'E'
 14181        ADD +40                  TO TRLR-SEQ-NO.
 14182
 14183 3600-READ-TRAILER.
 14184
 14185
 14186* EXEC CICS HANDLE CONDITION
 14187*         NOTFND(3600-CONTINUE)
 14188*    END-EXEC.
 14189*    MOVE '"$I                   ! - #00013407' TO DFHEIV0
 14190     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14192     MOVE X'2D20233030303133343037' TO DFHEIV0(25:11)
 14193     CALL 'kxdfhei1' USING DFHEIV0
 14194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14195
 14196
 14197     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14198
 14199 3600-CONTINUE.
 14200
 14201     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14202         GO TO 3600-AH-VERIFY
 14203     END-IF.
 14204
 14205     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14206       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14207         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 271
* EL156.cbl
 14208           MOVE ER-7576            TO EMI-ERROR
 14209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14210           MOVE -1                 TO PAYEEL
 14211           MOVE AL-UABON           TO PAYEEA
 14212           GO TO 3600-EXIT
 14213         END-IF
 14214       END-IF
 14215     END-IF.
 14216
 14217     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14218     MOVE 1 TO WS-SUB2
 14219     MOVE SPACES TO WS-PAYEE-NAME
 14220     PERFORM VARYING WS-SUB FROM 1 BY 1
 14221             UNTIL WS-SUB > 30
 14222         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14223            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14224                 WS-PAYEE-NAME-X (WS-SUB2)
 14225            ADD +1 TO WS-SUB2
 14226         END-IF
 14227     END-PERFORM.
 14228
 14229     STRING CL-INSURED-1ST-NAME
 14230            CL-INSURED-MID-INIT
 14231            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14232     MOVE 1 TO WS-SUB2
 14233     MOVE SPACES TO WS-INSURED-NAME
 14234     PERFORM VARYING WS-SUB FROM 1 BY 1
 14235             UNTIL WS-SUB > 30
 14236         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14237            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14238                 WS-INSURED-NAME-X (WS-SUB2)
 14239            ADD +1 TO WS-SUB2
 14240         END-IF
 14241     END-PERFORM.
 14242
 14243     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14244        MOVE ER-7579            TO EMI-ERROR
 14245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246        MOVE -1                 TO PAYEEL
 14247        MOVE AL-UABON           TO PAYEEA
 14248     END-IF.
 14249
 14250     IF PI-PMTTYPE = '4'  AND
 14251        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14252        PI-PAYEE-TYPE <> 'I'
 14253          MOVE ER-7580          TO EMI-ERROR
 14254          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14255          MOVE -1               TO PAYEEL
 14256          MOVE AL-UABON         TO PAYEEA
 14257     END-IF.
 14258
 14259     GO TO 3600-EXIT.
 14260
 14261 3600-AH-VERIFY.
 14262
 14263     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14264        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14265           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 272
* EL156.cbl
 14266           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14267           MOVE -1                 TO PAYEEL
 14268           MOVE AL-UABON           TO PAYEEA
 14269        END-IF
 14270     END-IF.
 14271
 14272
 14273 3600-EXIT.
 14274     EXIT.
 14275
 14276 5000-UPDATE.
 14277
 14278     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14279
 14280     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14281
 14282     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14283        PI-OFFLINE = 'Y'
 14284        NEXT SENTENCE
 14285     ELSE
 14286        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14287
 14288*    IF PI-COMPANY-ID = 'CRI'
 14289*       IF PI-PMTTYPE = '1' OR  '2'
 14290*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14291*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14292*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14293
 14294*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14295*       IF PI-PMTTYPE = '1'
 14296*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14297*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14298
 14299     IF PI-PMTTYPE      = '2' AND
 14300        PI-SPLIT-PMT-SW = 'Y' AND
 14301        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14302          MOVE ER-3530                TO EMI-ERROR
 14303          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14306        AND (CL-CLAIM-TYPE = 'L')
 14307        IF PI-PMTTYPE = '2' OR '4'
 14308           IF PI-INT-AMT NOT = ZEROS
 14309              PERFORM 7110-BUILD-PMT-TRLR
 14310                                 THRU 7130-EXIT
 14311           ELSE
 14312              IF PI-PMTTYPE = '2'
 14313                 PERFORM 7140-BUILD-NOTE-TRLR
 14314                                 THRU 7170-EXIT
 14315              END-IF
 14316           END-IF
 14317        END-IF
 14318     END-IF
 14319*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14320*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14321*            MOVE 'N'                 TO  WS-LETTER-SW.
 14322
 14323*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 273
* EL156.cbl
 14324*        IF CL-NO-OF-PMTS-MADE = +1
 14325*                OR
 14326*           PI-PMTTYPE = '2'
 14327*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14328
 14329     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14330
 14331*    IF PI-COMPANY-ID = 'DMD'
 14332*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14333*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14334
 14335
 14336* EXEC CICS REWRITE
 14337*         DATASET('ELMSTR')
 14338*         FROM(CLAIM-MASTER)
 14339*     END-EXEC.
 14340     MOVE LENGTH OF
 14341      CLAIM-MASTER
 14342       TO DFHEIV11
 14343     MOVE 'ELMSTR' TO DFHEIV1
 14344*    MOVE '&& L                  %   #00013549' TO DFHEIV0
 14345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14347     MOVE X'2020233030303133353439' TO DFHEIV0(25:11)
 14348     CALL 'kxdfhei1' USING DFHEIV0,
 14349           DFHEIV1,
 14350           CLAIM-MASTER,
 14351           DFHEIV11,
 14352           DFHEIV99
 14353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14354
 14355
 14356     IF WS-LETTER-SW = 'N'
 14357         GO TO 5000-END-UPDATE.
 14358
 14359 5000-GENERATE-AUTO-LETTER.
 14360
 14361
 14362* EXEC CICS LINK
 14363*        PROGRAM    (LINK-1523)
 14364*        COMMAREA   (W-1523-LINKDATA)
 14365*        LENGTH     (W-1523-COMM-LENGTH)
 14366*    END-EXEC.
 14367*    MOVE '."C                   (   #00013559' TO DFHEIV0
 14368     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14370     MOVE X'2020233030303133353539' TO DFHEIV0(25:11)
 14371     CALL 'kxdfhei1' USING DFHEIV0,
 14372           LINK-1523,
 14373           W-1523-LINKDATA,
 14374           W-1523-COMM-LENGTH,
 14375           DFHEIV99,
 14376           DFHEIV99,
 14377           DFHEIV99,
 14378           DFHEIV99
 14379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14380
 14381
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 274
* EL156.cbl
 14382     IF W-1523-FATAL-ERROR
 14383         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14385         MOVE ER-0802                TO  EMI-ERROR
 14386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14387
 14388     IF W-1523-ERROR-CODE = 0191
 14389         MOVE ER-0803                TO  EMI-ERROR
 14390         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14391
 14392     IF PI-COMPANY-ID      = 'HAN' AND
 14393        PI-PMTTYPE         = '1'   AND
 14394        PI-3RD-PARTY-SW    = 'Y'   AND
 14395        W-1523-FORM-NUMBER = 'EOB1'
 14396           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14397           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14398           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14399           GO TO 5000-GENERATE-AUTO-LETTER.
 14400
 14401 5000-END-UPDATE.
 14402
 14403     MOVE ER-0000                TO EMI-ERROR.
 14404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14405     GO TO 7000-SHOW-CLAIM.
 14406
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 275
* EL156.cbl
 14408 5000-MOVE-NAME.
 14409     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14410     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14411     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14412
 14413 5000-EXIT.
 14414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 276
* EL156.cbl
 14416 5300-CREATE-DMO.
 14417
 14418     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14419     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14420     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14421
 14422
 14423* EXEC CICS HANDLE CONDITION
 14424*         NOTFND   (5300-NOTE-NOT-FOUND)
 14425*    END-EXEC.
 14426*    MOVE '"$I                   ! . #00013605' TO DFHEIV0
 14427     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14429     MOVE X'2E20233030303133363035' TO DFHEIV0(25:11)
 14430     CALL 'kxdfhei1' USING DFHEIV0
 14431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14432
 14433
 14434
 14435* EXEC CICS READ
 14436*         DATASET('ERNOTE')
 14437*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14438*         RIDFLD (W-NOTE-KEY)
 14439*    END-EXEC.
 14440     MOVE 'ERNOTE' TO DFHEIV1
 14441*    MOVE '&"S        E          (   #00013609' TO DFHEIV0
 14442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14444     MOVE X'2020233030303133363039' TO DFHEIV0(25:11)
 14445     CALL 'kxdfhei1' USING DFHEIV0,
 14446           DFHEIV1,
 14447           DFHEIV20,
 14448           DFHEIV99,
 14449           W-NOTE-KEY,
 14450           DFHEIV99,
 14451           DFHEIV99,
 14452           DFHEIV99
 14453     SET ADDRESS OF CERTIFICATE-NOTE TO
 14454         DFHEIV20
 14455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14456
 14457
 14458     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14459     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14460     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14461
 14462     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14463         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14464     ELSE
 14465         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14466
 14467     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14468     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14469     MOVE 'DLO006'               TO PGM-NAME.
 14470
 14471
 14472* EXEC CICS LINK
 14473*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 277
* EL156.cbl
 14474*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14475*        LENGTH     (DCT-RCRD-LENGTH)
 14476*    END-EXEC.
 14477*    MOVE '."C                   (   #00013628' TO DFHEIV0
 14478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14480     MOVE X'2020233030303133363238' TO DFHEIV0(25:11)
 14481     CALL 'kxdfhei1' USING DFHEIV0,
 14482           PGM-NAME,
 14483           DCT-COMMUNICATION-AREA,
 14484           DCT-RCRD-LENGTH,
 14485           DFHEIV99,
 14486           DFHEIV99,
 14487           DFHEIV99,
 14488           DFHEIV99
 14489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14490
 14491
 14492     IF DCT-RETURN-CODE = 'OK'
 14493         GO TO 5300-CONT.
 14494
 14495     IF DCT-RETURN-CODE = '01' OR '02'
 14496         GO TO 5300-EXIT.
 14497
 14498     IF DCT-RETURN-CODE = '03'
 14499         MOVE ER-0951            TO EMI-ERROR
 14500         GO TO 5300-BAD-EXIT.
 14501
 14502     IF DCT-RETURN-CODE = '04'
 14503         MOVE ER-0946            TO EMI-ERROR
 14504         GO TO 5300-BAD-EXIT.
 14505
 14506     IF DCT-RETURN-CODE = '05'
 14507         MOVE ER-0947            TO EMI-ERROR
 14508         GO TO 5300-BAD-EXIT.
 14509
 14510     IF DCT-RETURN-CODE = '06'
 14511         MOVE ER-0921            TO EMI-ERROR
 14512         GO TO 5300-BAD-EXIT.
 14513
 14514     IF DCT-RETURN-CODE = '07'
 14515         MOVE ER-0849            TO EMI-ERROR
 14516         GO TO 5300-BAD-EXIT.
 14517
 14518     IF DCT-RETURN-CODE = '08'
 14519         MOVE ER-0948            TO EMI-ERROR
 14520         GO TO 5300-BAD-EXIT.
 14521
 14522     IF DCT-RETURN-CODE = 'N1'
 14523         MOVE ER-0950            TO EMI-ERROR
 14524         GO TO 5300-BAD-EXIT.
 14525
 14526     IF DCT-RETURN-CODE = 'E1'
 14527         MOVE ER-0974            TO EMI-ERROR
 14528         GO TO 5300-BAD-EXIT.
 14529
 14530     IF DCT-RETURN-CODE = 'E2'
 14531         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 278
* EL156.cbl
 14532         GO TO 5300-BAD-EXIT.
 14533
 14534     IF DCT-RETURN-CODE NOT = 'OK'
 14535         MOVE ER-0949            TO EMI-ERROR
 14536         GO TO 5300-BAD-EXIT.
 14537
 14538 5300-CONT.
 14539
 14540     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14541     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14542     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14543     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14544     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14545     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14546     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14547     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14548
 14549     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14550     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14551     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14552     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14553     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14554
 14555     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14556
 14557     IF PI-PMTTYPE = '2'
 14558         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14559         MOVE '4'                TO DM-CLAIM-STATUS
 14560     ELSE
 14561         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14562         MOVE '2'                TO DM-CLAIM-STATUS.
 14563
 14564     MOVE 'DLO025'               TO PGM-NAME.
 14565
 14566
 14567* EXEC CICS LINK
 14568*        PROGRAM    (PGM-NAME)
 14569*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14570*        LENGTH     (DM-DMO-LENGTH)
 14571*    END-EXEC.
 14572*    MOVE '."C                   (   #00013708' TO DFHEIV0
 14573     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14575     MOVE X'2020233030303133373038' TO DFHEIV0(25:11)
 14576     CALL 'kxdfhei1' USING DFHEIV0,
 14577           PGM-NAME,
 14578           DMO-COMMUNICATION-AREA,
 14579           DM-DMO-LENGTH,
 14580           DFHEIV99,
 14581           DFHEIV99,
 14582           DFHEIV99,
 14583           DFHEIV99
 14584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14585
 14586
 14587     IF DM-RETURN-CODE = 'OK'
 14588         GO TO 5300-EXIT.
 14589
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 279
* EL156.cbl
 14590     IF DM-RETURN-CODE = '01'
 14591         MOVE ER-8051            TO EMI-ERROR
 14592         GO TO 5300-BAD-EXIT.
 14593
 14594     IF DM-RETURN-CODE = '02'
 14595         MOVE ER-8052            TO EMI-ERROR
 14596         GO TO 5300-BAD-EXIT.
 14597
 14598     IF DM-RETURN-CODE = '03'
 14599         MOVE ER-8053            TO EMI-ERROR
 14600         GO TO 5300-BAD-EXIT.
 14601
 14602     IF DM-RETURN-CODE = '04'
 14603         MOVE ER-8054            TO EMI-ERROR
 14604         GO TO 5300-BAD-EXIT.
 14605
 14606     IF DM-RETURN-CODE = '05'
 14607         MOVE ER-8055            TO EMI-ERROR
 14608         GO TO 5300-BAD-EXIT.
 14609
 14610     IF DM-RETURN-CODE = '06'
 14611         MOVE ER-8056            TO EMI-ERROR
 14612         GO TO 5300-BAD-EXIT.
 14613
 14614     IF DM-RETURN-CODE = '07'
 14615         MOVE ER-8057            TO EMI-ERROR
 14616         GO TO 5300-BAD-EXIT.
 14617
 14618     IF DM-RETURN-CODE = '08'
 14619         MOVE ER-8058            TO EMI-ERROR
 14620         GO TO 5300-BAD-EXIT.
 14621
 14622     IF DM-RETURN-CODE = '09'
 14623         MOVE ER-8059            TO EMI-ERROR
 14624         GO TO 5300-BAD-EXIT.
 14625
 14626     IF DM-RETURN-CODE = '10'
 14627         MOVE ER-8060            TO EMI-ERROR
 14628         GO TO 5300-BAD-EXIT.
 14629
 14630     IF DM-RETURN-CODE = '11'
 14631         MOVE ER-8061            TO EMI-ERROR
 14632         GO TO 5300-BAD-EXIT.
 14633
 14634     IF DM-RETURN-CODE = '12'
 14635         MOVE ER-8062            TO EMI-ERROR
 14636         GO TO 5300-BAD-EXIT.
 14637
 14638     IF DM-RETURN-CODE = '13'
 14639         MOVE ER-8063            TO EMI-ERROR
 14640         GO TO 5300-BAD-EXIT.
 14641
 14642     IF DM-RETURN-CODE = '14'
 14643         MOVE ER-8064            TO EMI-ERROR
 14644         GO TO 5300-BAD-EXIT.
 14645
 14646     IF DM-RETURN-CODE = '15'
 14647         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 280
* EL156.cbl
 14648         GO TO 5300-BAD-EXIT.
 14649
 14650     IF DM-RETURN-CODE = '16'
 14651         MOVE ER-8154            TO EMI-ERROR
 14652         GO TO 5300-BAD-EXIT.
 14653
 14654     IF DM-RETURN-CODE = '17'
 14655         MOVE ER-8155            TO EMI-ERROR
 14656         GO TO 5300-BAD-EXIT.
 14657
 14658     IF DM-RETURN-CODE = 'N1'
 14659         MOVE ER-8152            TO EMI-ERROR
 14660         GO TO 5300-BAD-EXIT.
 14661
 14662     IF DM-RETURN-CODE = 'E1'
 14663         MOVE ER-8153            TO EMI-ERROR
 14664         GO TO 5300-BAD-EXIT.
 14665
 14666     MOVE ER-8066            TO EMI-ERROR.
 14667     GO TO 5300-BAD-EXIT.
 14668
 14669 5300-NOTE-NOT-FOUND.
 14670
 14671     MOVE ER-0954                TO EMI-ERROR.
 14672     GO TO 5300-BAD-EXIT.
 14673
 14674 5300-BAD-EXIT.
 14675
 14676* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14677*    MOVE '6"R                   !   #00013802' TO DFHEIV0
 14678     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14680     MOVE X'2020233030303133383032' TO DFHEIV0(25:11)
 14681     CALL 'kxdfhei1' USING DFHEIV0
 14682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14683
 14684     IF MAP-NAME = 'EL156A'
 14685         MOVE -1             TO ENTERPFL
 14686       ELSE
 14687         MOVE LOW-VALUES     TO EL156BI
 14688         MOVE -1             TO ENTPFBL.
 14689
 14690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14691     GO TO 8200-SEND-DATAONLY.
 14692
 14693 5300-EXIT.
 14694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 281
* EL156.cbl
 14696 5350-FORMAT-LAST-NAME-1ST.
 14697*****************************************************************
 14698*             M O V E   N A M E   R O U T I N E                 *
 14699*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14700*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14701*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14702*                  FIELD                   VALUE                *
 14703*           W-NAME-LAST    (CL15)      SMITH                    *
 14704*           W-NAME-FIRST   (CL15)      JOHN                     *
 14705*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14706*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14707*     CONTAIN                                                   *
 14708*                SMITH, JOHN ALLEN                              *
 14709*     OR                                                        *
 14710*                SMITH, JOHN A.                                 *
 14711*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14712*     COPYBOOK, ELCNWA.                                         *
 14713*****************************************************************.
 14714
 14715     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14716     MOVE ZERO                   TO  WS-NAME-SW.
 14717     SET NWA-INDEX               TO +1.
 14718
 14719     IF W-NAME-LAST   = SPACES AND
 14720        W-NAME-MIDDLE = SPACES
 14721         MOVE +1                 TO WS-NAME-SW.
 14722
 14723     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14724     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14725
 14726     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14727     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14728
 14729     SET NWA-INDEX UP BY +1.
 14730
 14731     IF W-NAME-MIDDLE NOT = SPACES
 14732         IF W-NAME-MIDDLE-2 = SPACES
 14733             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14734             SET NWA-INDEX UP BY +1
 14735             MOVE '.'            TO WS-NW (NWA-INDEX)
 14736             SET NWA-INDEX UP BY +2
 14737         ELSE
 14738             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14739             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14740
 14741 5350-EXIT.
 14742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 282
* EL156.cbl
 14744 5360-MOVE-NAME.
 14745
 14746     IF WS-NAME-SW > +1
 14747         GO TO 5360-EXIT.
 14748
 14749     IF WS-NAME-WORK2 = SPACES
 14750         GO TO 5360-EXIT.
 14751
 14752     SET NWA-INDEX2            TO +1.
 14753     SET NWA-INDEX3            TO +2.
 14754
 14755 5360-MOVE-NAME-CYCLE.
 14756
 14757     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14758
 14759     IF NWA-INDEX < +30
 14760         SET NWA-INDEX UP BY +1
 14761     ELSE
 14762         ADD +2                TO  WS-NAME-SW
 14763         GO TO 5360-EXIT.
 14764
 14765     IF NWA-INDEX2 < +20
 14766         SET NWA-INDEX3 UP BY +1
 14767         SET NWA-INDEX2 UP BY +1.
 14768
 14769     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14770        WS-NW2 (NWA-INDEX3) = SPACES
 14771         IF WS-NAME-SW = ZERO
 14772             MOVE ','            TO  WS-NW (NWA-INDEX)
 14773             SET NWA-INDEX UP BY +2
 14774             MOVE +1             TO  WS-NAME-SW
 14775             GO TO 5360-EXIT
 14776         ELSE
 14777             GO TO 5360-EXIT.
 14778
 14779     GO TO 5360-MOVE-NAME-CYCLE.
 14780
 14781 5360-EXIT.
 14782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 283
* EL156.cbl
 14784 6000-BUILD-SCREEN-B.
 14785     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14786     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14787     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14788     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14789
 14790     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14791
 14792 6050-BUILD-SCREEN.
 14793     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14794     MOVE LOW-VALUES             TO EL156BI.
 14795     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14796
 14797     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14798
 14799     IF PI-PAYEE-TYPE = 'I'
 14800        GO TO 6060-READ-TRAILER.
 14801
 14802     IF PI-PAYEE-TYPE = 'B'
 14803        ADD +10                  TO TRLR-SEQ-NO
 14804        GO TO 6060-READ-TRAILER.
 14805
 14806     IF PI-PAYEE-TYPE = 'A'
 14807        ADD +20                  TO TRLR-SEQ-NO
 14808        GO TO 6060-READ-TRAILER.
 14809
 14810     IF PI-PAYEE-TYPE = 'O'
 14811        ADD +50                  TO TRLR-SEQ-NO
 14812        GO TO 6060-READ-TRAILER.
 14813
 14814     IF PI-PAYEE-TYPE = 'Q'
 14815        ADD +60                  TO TRLR-SEQ-NO
 14816        GO TO 6060-READ-TRAILER.
 14817
 14818     IF PI-PAYEE-TYPE = 'P'
 14819        ADD +30                  TO TRLR-SEQ-NO
 14820        GO TO 6060-READ-TRAILER.
 14821
 14822     IF PI-PAYEE-TYPE = 'E'
 14823        ADD +40                  TO TRLR-SEQ-NO.
 14824
 14825 6060-READ-TRAILER.
 14826
 14827     IF PI-PAYEE-TYPE    = 'A' AND
 14828        PI-PAYEE-SEQ-NUM = 0
 14829          GO TO 6061-READ-ACCOUNT.
 14830
 14831     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14832        (PI-PAYEE-TYPE    = 'B')             AND
 14833        (PI-PAYEE-SEQ-NUM = 9)
 14834          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14835          IF BENE-FOUND-SW = 'N'
 14836            GO TO 6065-NOT-FOUND
 14837          ELSE
 14838            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14839            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14840            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14841*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 284
* EL156.cbl
 14842            STRING BE-CITY ' ' BE-STATE
 14843               DELIMITED BY '  ' INTO CITYSTBO
 14844            END-STRING
 14845            MOVE BE-ZIP-CODE       TO ZIPBO
 14846            GO TO 6061-READ-ACCOUNT.
 14847
 14848     IF PI-PAYEE-TYPE    = 'B' AND
 14849        PI-PAYEE-SEQ-NUM = 0
 14850          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14851          IF BENE-FOUND-SW = 'N'
 14852            GO TO 6065-NOT-FOUND
 14853          ELSE
 14854            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14855            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14856            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14857*           MOVE BE-CITY-STATE     TO CITYSTBO
 14858            STRING BE-CITY ' ' BE-STATE
 14859               DELIMITED BY '  ' INTO CITYSTBO
 14860            END-STRING
 14861            MOVE BE-ZIP-CODE       TO ZIPBO
 14862            GO TO 6061-READ-ACCOUNT.
 14863
 14864
 14865* EXEC CICS HANDLE CONDITION
 14866*         NOTFND(6065-NOT-FOUND)
 14867*     END-EXEC.
 14868*    MOVE '"$I                   ! / #00013983' TO DFHEIV0
 14869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14871     MOVE X'2F20233030303133393833' TO DFHEIV0(25:11)
 14872     CALL 'kxdfhei1' USING DFHEIV0
 14873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14874
 14875
 14876     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14877
 14878     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14879     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14880     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14881     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14882*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14883     STRING AT-CITY ' ' AT-STATE
 14884        DELIMITED BY '  ' INTO CITYSTBO
 14885     END-STRING
 14886     MOVE AT-ZIP-CODE            TO ZIPBO.
 14887
 14888 6061-READ-ACCOUNT.
 14889
 14890* EXEC CICS HANDLE CONDITION
 14891*         NOTFND(6068-ACCT-NOT-FND)
 14892*     END-EXEC.
 14893*    MOVE '"$I                   ! 0 #00014000' TO DFHEIV0
 14894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14896     MOVE X'3020233030303134303030' TO DFHEIV0(25:11)
 14897     CALL 'kxdfhei1' USING DFHEIV0
 14898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14899
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 285
* EL156.cbl
 14900
 14901
 14902* EXEC CICS READ
 14903*         DATASET('ERACCT')
 14904*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14905*         RIDFLD (PI-ACCT-KEY)
 14906*     END-EXEC.
 14907     MOVE 'ERACCT' TO DFHEIV1
 14908*    MOVE '&"S        E          (   #00014004' TO DFHEIV0
 14909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14911     MOVE X'2020233030303134303034' TO DFHEIV0(25:11)
 14912     CALL 'kxdfhei1' USING DFHEIV0,
 14913           DFHEIV1,
 14914           DFHEIV20,
 14915           DFHEIV99,
 14916           PI-ACCT-KEY,
 14917           DFHEIV99,
 14918           DFHEIV99,
 14919           DFHEIV99
 14920     SET ADDRESS OF ACCOUNT-MASTER TO
 14921         DFHEIV20
 14922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14923
 14924
 14925     MOVE AM-CARRIER             TO ACARRBO.
 14926     MOVE AM-GROUPING            TO GROUPBO.
 14927     MOVE AM-STATE               TO STATEBO.
 14928     MOVE AM-ACCOUNT             TO ACCTBO.
 14929     MOVE AM-NAME                TO ACCTNMBO.
 14930
 14931     IF PI-PAYEE-TYPE = 'A' AND
 14932        PI-PAYEE-SEQ-NUM = 0
 14933          MOVE AM-NAME             TO NAMEBO
 14934                                      PI-PAYEE-NAME
 14935          MOVE AM-ADDRS            TO ADDR1BO
 14936          MOVE SPACES              TO ADDR2BO
 14937*         MOVE AM-CITY             TO CITYSTBO
 14938          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14939             DELIMITED BY '  ' INTO CITYSTBO
 14940          END-STRING
 14941          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14942          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14943          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14944          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14945
 14946     IF CITYSTBO EQUAL SPACES
 14947         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14948         GO TO 6070-FORMAT-DATA
 14949     END-IF.
 14950
 14951     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14952     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14953     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14954     PERFORM VARYING WS-SUB FROM 30 BY -1
 14955          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14956        IF WS-END-SUB = 0  AND
 14957           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 286
* EL156.cbl
 14958              OR LOW-VALUES  OR '.')
 14959            CONTINUE
 14960        ELSE
 14961            IF WS-END-SUB = 0
 14962                MOVE WS-SUB TO WS-END-SUB
 14963            ELSE
 14964                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14965                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14966                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14967                END-IF
 14968            END-IF
 14969        END-IF
 14970        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14971            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14972            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14973        END-IF
 14974     END-PERFORM.
 14975
 14976     IF WS-BEG-SUB > 0
 14977         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14978         IF WS-STATE-LENGTH = 2
 14979             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14980                  TO PI-CHECK-STATE-FOR-AK
 14981         ELSE
 14982             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14983                'ALASKA'
 14984                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14985             ELSE
 14986                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14987             END-IF
 14988         END-IF
 14989     ELSE
 14990         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14991     END-IF.
 14992
 14993     GO TO 6070-FORMAT-DATA.
 14994
 14995 6065-NOT-FOUND.
 14996     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14997     GO TO 6061-READ-ACCOUNT.
 14998
 14999 6068-ACCT-NOT-FND.
 15000     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15001
 15002 6070-FORMAT-DATA.
 15003     IF PI-HOLDTIL = ZEROS
 15004        MOVE SAVE-DATE           TO PAYDTBI
 15005       ELSE
 15006        MOVE PI-HOLDTIL          TO PAYDTBO
 15007        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15008
 15009     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15010     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15011
 15012     IF EIBAID = DFHPF3 OR DFHPF4
 15013        NEXT SENTENCE
 15014     ELSE
 15015       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 287
* EL156.cbl
 15016
 15017     MOVE PI-EPYFROM          TO PYFROMBO.
 15018     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15019
 15020     IF NOT PI-USES-PAID-TO
 15021        MOVE PI-EPYTHRU          TO PYTHRUBO
 15022        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15023     ELSE
 15024        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15025        MOVE '4'              TO DC-OPTION-CODE
 15026        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15027        IF NO-CONVERSION-ERROR
 15028           MOVE +1            TO DC-ELAPSED-DAYS
 15029           MOVE +0            TO DC-ELAPSED-MONTHS
 15030           MOVE '6'           TO DC-OPTION-CODE
 15031           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15032           IF NO-CONVERSION-ERROR
 15033              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15034
 15035     MOVE PI-EDAYS            TO DAYSBO.
 15036     MOVE PI-EPYAMT           TO PAYAMTBO.
 15037     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15038        IF PI-INT-AMT > ZEROS
 15039           MOVE PI-INT-AMT       TO INTAMTBO
 15040        END-IF
 15041     END-IF
 15042     GO TO 6072-SET-TYPE.
 15043
 15044 6071-CONTINUE.
 15045
 15046     IF PI-CPYFROM NOT = LOW-VALUES
 15047        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15048        MOVE SPACES              TO DC-OPTION-CODE
 15049        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15050        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15051
 15052     IF PI-CPYTHRU NOT = LOW-VALUES
 15053        IF NOT PI-USES-PAID-TO
 15054           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15055           MOVE SPACES             TO DC-OPTION-CODE
 15056           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15057           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15058        ELSE
 15059           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15060           MOVE '6'                TO DC-OPTION-CODE
 15061           MOVE +1                 TO DC-ELAPSED-DAYS
 15062           MOVE +0                 TO DC-ELAPSED-MONTHS
 15063           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15064           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15065
 15066     MOVE PI-CDAYS               TO DAYSBO.
 15067     MOVE PI-CPYAMT              TO PAYAMTBO.
 15068     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15069        IF PI-INT-AMT > ZEROS
 15070           MOVE PI-INT-AMT       TO INTAMTBO
 15071        END-IF
 15072     END-IF
 15073     .
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 288
* EL156.cbl
 15074 6072-SET-TYPE.
 15075     IF PI-PMTTYPE = '1'
 15076        MOVE 'PARTIAL'           TO PAYTYPBO.
 15077
 15078     IF PI-PMTTYPE = '2'
 15079        MOVE 'FINAL'             TO PAYTYPBO.
 15080
 15081     IF PI-PMTTYPE = '3'
 15082        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15083
 15084     IF PI-PMTTYPE = '4'
 15085        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15086
 15087     IF PI-PMTTYPE = '5'
 15088        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15089
 15090     IF PI-PMTTYPE = '6'
 15091        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15092
 15093     IF PI-PROV-PMT
 15094        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15095
 15096     IF PI-ECHECKNO NOT = SPACES
 15097        MOVE PI-ECHECKNO         TO CKNUMBO
 15098     ELSE
 15099        MOVE PI-CCHECKNO         TO CKNUMBO.
 15100
 15101     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15102        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15103        MOVE +91                 TO  TRLR-SEQ-NO
 15104
 15105* EXEC CICS READ
 15106*           DATASET  ('ELTRLR')
 15107*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15108*           RIDFLD   (ELTRLR-KEY)
 15109*           RESP     (WS-RESPONSE)
 15110*       END-EXEC
 15111     MOVE 'ELTRLR' TO DFHEIV1
 15112*    MOVE '&"S        E          (  N#00014189' TO DFHEIV0
 15113     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15115     MOVE X'204E233030303134313839' TO DFHEIV0(25:11)
 15116     CALL 'kxdfhei1' USING DFHEIV0,
 15117           DFHEIV1,
 15118           DFHEIV20,
 15119           DFHEIV99,
 15120           ELTRLR-KEY,
 15121           DFHEIV99,
 15122           DFHEIV99,
 15123           DFHEIV99
 15124     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15125         DFHEIV20
 15126     MOVE EIBRESP  TO WS-RESPONSE
 15127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15128
 15129        IF WS-RESP-NORMAL
 15130           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15131        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 289
* EL156.cbl
 15132           MOVE SPACES           TO  LOANNBO
 15133        END-IF
 15134     END-IF
 15135
 15136*       MOVE PI-LOAN-NO          TO LOANNBO
 15137
 15138     IF CKNUMBO = SPACES
 15139         MOVE SPACES             TO CKNUMHDO.
 15140
 15141     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15142     MOVE CL-CARRIER             TO CARRBO.
 15143     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15144     MOVE CL-CERT-SFX            TO SUFXBO.
 15145
 15146     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15147        EVALUATE CL-CLAIM-TYPE
 15148           WHEN 'I'
 15149              MOVE '  IU  '      TO CLMTYPBO
 15150           WHEN 'G'
 15151              MOVE ' GAP  '      TO CLMTYPBO
 15152           WHEN 'F'
 15153              MOVE ' FMLA '      TO CLMTYPBO
 15154           WHEN OTHER
 15155              MOVE PI-AH-OVERRIDE-L6
 15156                                 TO CLMTYPBO
 15157        END-EVALUATE
 15158        MOVE ZEROS               TO UNDISBO
 15159*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15160        IF PI-PMTTYPE = '5' OR '6'
 15161           GO TO 6073-GET-NOTIFY-DATA
 15162        ELSE
 15163           MOVE PI-DAILY-RATE    TO RATEBO
 15164           GO TO 6073-GET-NOTIFY-DATA.
 15165
 15166     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15167
 15168     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15169        MOVE ZEROS               TO UNDISBO
 15170     ELSE
 15171        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15172
 15173 6073-GET-NOTIFY-DATA.
 15174
 15175     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15176
 15177     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15178         MOVE SPACES             TO  NAMEB2O
 15179                                     ADDR1B2O
 15180                                     ADDR2B2O
 15181                                     CITYST2O
 15182                                     AGTHDGO
 15183         MOVE ZEROS              TO  ZIPB2O
 15184         GO TO 6080-SET-INCURRED.
 15185
 15186     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15187     MOVE +29                    TO  TRLR-SEQ-NO.
 15188
 15189
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 290
* EL156.cbl
 15190* EXEC CICS HANDLE CONDITION
 15191*        NOTFND   (6074-GET-COMP-DATA)
 15192*    END-EXEC.
 15193*    MOVE '"$I                   ! 1 #00014256' TO DFHEIV0
 15194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15196     MOVE X'3120233030303134323536' TO DFHEIV0(25:11)
 15197     CALL 'kxdfhei1' USING DFHEIV0
 15198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15199
 15200
 15201     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15202
 15203     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15204     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15205     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15206*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15207     STRING AT-CITY ' ' AT-STATE
 15208        DELIMITED BY '  ' INTO CITYST2O
 15209     END-STRING
 15210     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15211     GO TO 6080-SET-INCURRED.
 15212
 15213 6074-GET-COMP-DATA.
 15214
 15215     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15216         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15217
 15218     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15219         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15220                                         ADDR1B2O
 15221                                         ADDR2B2O
 15222                                         CITYST2O
 15223         MOVE ZEROS                  TO  ZIPB2O
 15224         GO TO 6080-SET-INCURRED.
 15225
 15226     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15227     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15228     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15229     MOVE AM-GROUPING            TO  COMP-GROUP.
 15230     MOVE 'A'                    TO  COMP-TYPE.
 15231     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15232                                 TO  COMP-FIN-RESP.
 15233
 15234     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15235         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15236                                       'G' OR 'B' or 'S'
 15237             MOVE 'G'            TO  COMP-TYPE
 15238             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15239         ELSE
 15240             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15241                                 TO  COMP-ACCOUNT
 15242     ELSE
 15243         MOVE 'G'                TO  COMP-TYPE
 15244         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15245
 15246     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15247
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 291
* EL156.cbl
 15248     IF COMP-REC-FOUND
 15249         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15250         MOVE CO-ADDR-1          TO  ADDR1B2O
 15251         MOVE CO-ADDR-2          TO  ADDR2B2O
 15252*        MOVE CO-ADDR-3          TO  CITYST2O
 15253         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15254            DELIMITED BY '  ' INTO CITYST2O
 15255         END-STRING
 15256         MOVE CO-ZIP             TO  ZIPB2O
 15257     ELSE
 15258         MOVE 'NO COMP ADDRESS AVAILABLE'
 15259                                 TO  NAMEB2O
 15260                                     ADDR1B2O
 15261                                     ADDR2B2O
 15262                                     CITYST2O
 15263         MOVE ZEROS               TO ZIPB2O.
 15264
 15265 6080-SET-INCURRED.
 15266     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15267     MOVE SPACES                 TO DC-OPTION-CODE.
 15268     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15269     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15270     MOVE PI-PROCESSOR-ID        TO BYBO.
 15271     MOVE MAP-NAMEB              TO MAP-NAME.
 15272     MOVE 'C'                    TO PI-PASS-SW.
 15273     MOVE EIBAID                 TO PI-PFKEY-USED.
 15274     MOVE -1                     TO ENTPFBL.
 15275     GO TO 8100-SEND-INITIAL-MAP.
 15276
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 292
* EL156.cbl
 15278 6100-BUILD-PAYMENT-TRAILER.
 15279
 15280     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15281       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15282         GO TO 6105-STATE-CHECK-NUMBER
 15283     END-IF.
 15284
 15285     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15286     MOVE '6'                    TO CNTL-REC-TYPE.
 15287
 15288     IF CONTROL-IS-ACTUAL-CARRIER
 15289         MOVE PI-CARRIER         TO WS-CARR
 15290     ELSE
 15291         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15292
 15293     IF PI-COMPANY-ID = 'FIA'
 15294         MOVE PI-CARRIER         TO  WS-CARR.
 15295
 15296     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15297     MOVE 0                      TO CNTL-SEQ-NO.
 15298     MOVE 'CARR'                 TO FILE-SWITCH.
 15299
 15300     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15301
 15302     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15303         IF PI-OFFLINE     = 'Y' AND
 15304            PI-ECHECKNO-CR = 'CR'
 15305              GO TO 6110-READ-CONTROL
 15306         ELSE
 15307            IF PI-CASH = 'N'
 15308                GO TO 6110-READ-CONTROL.
 15309
 15310     IF CHECK-NO-MANUAL    OR
 15311        CHECK-NO-AT-PRINT  OR
 15312        PI-OFFLINE = 'Y'
 15313          GO TO 6130-BUILD-TRAILER.
 15314
 15315     IF PI-COMPANY-ID = 'FIA'
 15316         NEXT SENTENCE
 15317     ELSE
 15318         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15319             GO TO 6110-READ-CONTROL.
 15320
 15321     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15322
 15323     IF CHECK-CNT-RESET-VALUE
 15324        MOVE +1                  TO CF-CHECK-COUNTER
 15325     ELSE
 15326        ADD +1                   TO CF-CHECK-COUNTER.
 15327
 15328     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15329
 15330     IF CHECK-NO-CARR-SEQ
 15331        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15332
 15333     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15334
 15335     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 293
* EL156.cbl
 15336     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15337        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15338         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15339         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15340            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15341         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15342                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15343     END-IF.
 15344
 15345     GO TO 6120-REWRITE.
 15346
 15347 6105-STATE-CHECK-NUMBER.
 15348     IF CHECK-NO-MANUAL    OR
 15349        CHECK-NO-AT-PRINT  OR
 15350        PI-OFFLINE = 'Y'
 15351           GO TO 6130-BUILD-TRAILER
 15352     END-IF.
 15353
 15354     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15355     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15356     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15357     MOVE '3'                TO CNTL-REC-TYPE.
 15358     MOVE +0                 TO CNTL-SEQ-NO.
 15359     MOVE 'STAT'             TO FILE-SWITCH.
 15360     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15361
 15362     IF CF-ST-CHECK-CNT-RESET
 15363         MOVE +1             TO CF-ST-CHECK-COUNTER
 15364     ELSE
 15365         ADD +1              TO CF-ST-CHECK-COUNTER
 15366     END-IF.
 15367
 15368     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15369     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15370     GO TO 6120-REWRITE.
 15371
 15372 6110-READ-CONTROL.
 15373     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15374     MOVE '1'                    TO CNTL-REC-TYPE.
 15375     MOVE SPACES                 TO CNTL-ACCESS.
 15376     MOVE 0                      TO CNTL-SEQ-NO.
 15377
 15378     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15379
 15380     IF CO-CHECK-COUNT-RESET
 15381        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15382     ELSE
 15383        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15384
 15385     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15386
 15387     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15388         IF PI-OFFLINE     = 'Y'  AND
 15389            PI-ECHECKNO-CR = 'CR'
 15390              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15391              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15392              MOVE AL-UANON           TO CHECKNOA
 15393              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 294
* EL156.cbl
 15394         ELSE
 15395         IF PI-CASH = 'N'
 15396             MOVE 'N'                TO PI-ECHECKNO-N
 15397             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15398             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15399             MOVE AL-UANON           TO CHECKNOA
 15400             GO TO 6120-REWRITE.
 15401
 15402     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15403
 15404 6120-REWRITE.
 15405
 15406* EXEC CICS REWRITE
 15407*         DATASET('ELCNTL')
 15408*         FROM(CONTROL-FILE)
 15409*     END-EXEC.
 15410     MOVE LENGTH OF
 15411      CONTROL-FILE
 15412       TO DFHEIV11
 15413     MOVE 'ELCNTL' TO DFHEIV1
 15414*    MOVE '&& L                  %   #00014464' TO DFHEIV0
 15415     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15416     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15417     MOVE X'2020233030303134343634' TO DFHEIV0(25:11)
 15418     CALL 'kxdfhei1' USING DFHEIV0,
 15419           DFHEIV1,
 15420           CONTROL-FILE,
 15421           DFHEIV11,
 15422           DFHEIV99
 15423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15424
 15425
 15426     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15427
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 295
* EL156.cbl
 15429 6130-BUILD-TRAILER.
 15430
 15431
 15432* EXEC CICS GETMAIN
 15433*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15434*         LENGTH    (200)
 15435*         INITIMG   (GETMAIN-SPACE)
 15436*     END-EXEC.
 15437     MOVE 200
 15438       TO DFHEIV11
 15439*    MOVE ',"IL                  $   #00014474' TO DFHEIV0
 15440     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15441     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15442     MOVE X'2020233030303134343734' TO DFHEIV0(25:11)
 15443     CALL 'kxdfhei1' USING DFHEIV0,
 15444           DFHEIV20,
 15445           DFHEIV11,
 15446           GETMAIN-SPACE
 15447     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15448         DFHEIV20
 15449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15450
 15451
 15452     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15453                                    AT-PREV-PAID-THRU-DT.
 15454     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15455     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15456     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15457     MOVE 'AT'                   TO AT-RECORD-ID.
 15458     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15459
 15460     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15461        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15462           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15463     ELSE
 15464           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15465           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15466
 15467     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15468         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15469             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15470             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15471           ELSE
 15472             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15473             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15474
 15475     MOVE '2'                    TO AT-TRAILER-TYPE.
 15476     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15477                                    AT-PAYMENT-LAST-MAINT-DT.
 15478     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15479                                    AT-PAYMENT-LAST-UPDATED-BY.
 15480     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15481     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15482     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15483     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15484
 15485     IF PI-PMT-APPROVED
 15486        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 296
* EL156.cbl
 15487           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15488
 15489     IF PI-PFKEY-USED = DFHPF5
 15490        GO TO 6140-PF5-ENTERED.
 15491
 15492     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15493     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15494
 15495     IF PI-AIG-SPECIAL-BENEFIT
 15496         IF WS-1ST-SPECIAL-PMT
 15497             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15498             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15499                                        AT-AMOUNT-PAID
 15500         ELSE
 15501             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15502
 15503     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15504
 15505     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15506     MOVE '4'                    TO DC-OPTION-CODE.
 15507     PERFORM 9700-LINK-DATE-CONVERT.
 15508
 15509     IF DATE-CONVERSION-ERROR
 15510        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15511     ELSE
 15512        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15513
 15514     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15515     MOVE '4'                    TO DC-OPTION-CODE.
 15516     PERFORM 9700-LINK-DATE-CONVERT.
 15517
 15518     IF DATE-CONVERSION-ERROR
 15519        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15520     ELSE
 15521        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15522
 15523     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15524     GO TO 6150-FINISH-MOVE.
 15525
 15526 6140-PF5-ENTERED.
 15527     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15528     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15529
 15530     IF PI-AIG-SPECIAL-BENEFIT
 15531         IF WS-1ST-SPECIAL-PMT
 15532             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15533             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15534                                        AT-AMOUNT-PAID
 15535         ELSE
 15536             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15537
 15538     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15539     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15540     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15541
 15542 6150-FINISH-MOVE.
 15543
 15544     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 297
* EL156.cbl
 15545         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15546     ELSE
 15547         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15548
 15549     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15550     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15551
 15552*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15553*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15554
 15555     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15556         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15557
 15558     IF PI-OFFLINE = 'N'
 15559        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15560        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15561     ELSE
 15562        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15563        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15564
 15565     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15566
 15567     IF WS-2ND-SPECIAL-PMT
 15568         MOVE 'Y'                TO AT-CASH-PAYMENT
 15569         MOVE SPACES             TO AT-CHECK-NO
 15570         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15571         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15572         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15573         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15574
 15575     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15576                                    AT-TO-BE-WRITTEN-DT.
 15577
 15578     IF PI-HOLDTIL NOT = ZEROS
 15579        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15580        MOVE '4'                 TO DC-OPTION-CODE
 15581        PERFORM 9700-LINK-DATE-CONVERT
 15582        IF PI-OFFLINE = 'N'
 15583           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15584        ELSE
 15585           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15586
 15587     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15588     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15589                                    AT-CHECK-QUE-SEQUENCE.
 15590
 15591     IF PI-PFKEY-USED = DFHPF4
 15592        MOVE '1'                 TO AT-FORCE-CONTROL.
 15593
 15594     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15595        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15596        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15597        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15598
 15599     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15600                                    AT-VOID-SELECT-DT
 15601                                    AT-VOID-ACCEPT-DT
 15602                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 298
* EL156.cbl
 15603     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15604        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15605        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15606        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15607        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15608     ELSE
 15609        MOVE ZEROS               TO AT-DAILY-RATE
 15610                                    AT-ELIMINATION-DAYS
 15611        MOVE SPACES              TO AT-BENEFIT-TYPE
 15612     END-IF
 15613     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15614     MOVE '4'                    TO DC-OPTION-CODE.
 15615     PERFORM 9700-LINK-DATE-CONVERT.
 15616     IF DATE-CONVERSION-ERROR
 15617         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15618     ELSE
 15619         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15620     END-IF.
 15621     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15622     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15623     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15624     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15625     IF (PI-REAUDIT-NEEDED = 'Y')
 15626        or (pi-max-ext-used = 'Y')
 15627        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15628         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15629         MOVE 'Y' TO WS-NEED-APPROVAL
 15630         GO TO 6170-WRITE
 15631     END-IF.
 15632*******************************************************
 15633     IF NOT PI-PMT-GRADUATED
 15634         GO TO 6170-WRITE.
 15635
 15636     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15637     MOVE '1'                    TO CNTL-REC-TYPE.
 15638     MOVE SPACES                 TO CNTL-ACCESS.
 15639     MOVE +0                     TO CNTL-SEQ-NO.
 15640     MOVE 'COMP'                 TO FILE-SWITCH.
 15641
 15642     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15643
 15644     IF PAID-FOR-LIFE
 15645         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15646             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15647                                     WS-PMT-APPROVAL-SW
 15648             GO TO 6170-WRITE.
 15649
 15650*05999      IF PAID-FOR-AH
 15651     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15652         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15653             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15654                                     WS-PMT-APPROVAL-SW
 15655             GO TO 6170-WRITE.
 15656
 15657     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15658
 15659******A&H Limits are set as a monthly payment.  Calculate the mont
 15660******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 299
* EL156.cbl
 15661     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15662        PI-SAVE-ODD-DAYS-OVER > 0
 15663           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15664                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15665           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15666                                  WS-CALC-PMT-MONTHS
 15667     ELSE
 15668           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15669     END-IF.
 15670*06007      IF ((PAID-FOR-AH) AND
 15671     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15672*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15673        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15674              OR
 15675        ((PAID-FOR-LIFE) AND
 15676        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15677            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15678       ELSE
 15679*06014      IF ((PAID-FOR-AH)  AND
 15680         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15681*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15682           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15683              OR
 15684        ((PAID-FOR-LIFE) AND
 15685        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15686            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15687         ELSE
 15688*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15689           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15690               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15691              OR
 15692          ((PAID-FOR-LIFE) AND
 15693          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15694            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15695       ELSE
 15696           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15697               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15698              OR
 15699          ((PAID-FOR-LIFE) AND
 15700          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15701            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15702       ELSE
 15703            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15704
 15705     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15706        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15707        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15708            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15709        END-IF
 15710     ELSE
 15711     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15712        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15713        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15714            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15715        END-IF
 15716     ELSE
 15717     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15718        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 300
* EL156.cbl
 15719        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15720            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15721        END-IF
 15722     ELSE
 15723     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15724        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15725        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15726            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15727        END-IF
 15728     ELSE
 15729     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15730            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15731
 15732     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15733
 15734     IF NOT PI-PMT-GRADUATED
 15735         GO TO 6170-WRITE.
 15736
 15737
 15738* EXEC CICS HANDLE CONDITION
 15739*        NOTFND   (6170-WRITE)
 15740*    END-EXEC.
 15741*    MOVE '"$I                   ! 2 #00014765' TO DFHEIV0
 15742     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15744     MOVE X'3220233030303134373635' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0
 15746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15747
 15748
 15749     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15750     MOVE '2'                    TO CNTL-REC-TYPE.
 15751     MOVE +0                     TO CNTL-SEQ-NO.
 15752     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15753
 15754
 15755* EXEC CICS READ
 15756*         DATASET  ('ELCNTL')
 15757*         SET      (ADDRESS OF CONTROL-FILE)
 15758*         RIDFLD   (ELCNTL-KEY)
 15759*    END-EXEC.
 15760     MOVE 'ELCNTL' TO DFHEIV1
 15761*    MOVE '&"S        E          (   #00014774' TO DFHEIV0
 15762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15764     MOVE X'2020233030303134373734' TO DFHEIV0(25:11)
 15765     CALL 'kxdfhei1' USING DFHEIV0,
 15766           DFHEIV1,
 15767           DFHEIV20,
 15768           DFHEIV99,
 15769           ELCNTL-KEY,
 15770           DFHEIV99,
 15771           DFHEIV99,
 15772           DFHEIV99
 15773     SET ADDRESS OF CONTROL-FILE TO
 15774         DFHEIV20
 15775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15776
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 301
* EL156.cbl
 15777
 15778     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15779
 15780     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15781                         OR '4' OR '5'
 15782         NEXT SENTENCE
 15783     ELSE
 15784         MOVE 'Y' TO WS-NEED-APPROVAL
 15785         GO TO 6170-WRITE.
 15786
 15787     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15788         MOVE 'Y' TO WS-NEED-APPROVAL
 15789         IF WS-APPROVAL-LEVEL = '1'
 15790             MOVE '2'        TO  AT-APPROVED-LEVEL
 15791                            WS-SAVE-APPROVED-LEVEL
 15792             GO TO 6170-WRITE
 15793         ELSE
 15794             IF WS-APPROVAL-LEVEL = '2'
 15795                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15796                                WS-SAVE-APPROVED-LEVEL
 15797                 GO TO 6170-WRITE
 15798             ELSE IF WS-APPROVAL-LEVEL = '3'
 15799                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15800                                WS-SAVE-APPROVED-LEVEL
 15801                 GO TO 6170-WRITE
 15802             ELSE IF WS-APPROVAL-LEVEL = '4'
 15803                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15804                                WS-SAVE-APPROVED-LEVEL
 15805                 GO TO 6170-WRITE.
 15806
 15807     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15808                             WS-PMT-APPROVAL-SW.
 15809     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15810                             AT-APPROVAL-LEVEL-REQD.
 15811
 15812*******************************************************
 15813
 15814 6170-WRITE.
 15815
 15816     if pi-company-id = 'DCC'
 15817        PERFORM 0900-GET-DDF-limits
 15818                                 THRU 0900-EXIT
 15819     end-if
 15820     perform 2220-update-elcrtt  thru 2220-exit
 15821     IF PI-COMPANY-ID = 'DMD'
 15822        IF PI-AT-EOB-CODES NOT = SPACES
 15823           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15824           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15825           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15826           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15827           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15828
 15829
 15830* EXEC CICS HANDLE CONDITION
 15831*        DUPREC    (6180-DUPREC)
 15832*    END-EXEC.
 15833*    MOVE '"$%                   ! 3 #00014831' TO DFHEIV0
 15834     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 302
* EL156.cbl
 15835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15836     MOVE X'3320233030303134383331' TO DFHEIV0(25:11)
 15837     CALL 'kxdfhei1' USING DFHEIV0
 15838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15839
 15840
 15841
 15842* EXEC CICS WRITE
 15843*         DATASET       ('ELTRLR')
 15844*         FROM          (ACTIVITY-TRAILERS)
 15845*         RIDFLD        (AT-CONTROL-PRIMARY)
 15846*     END-EXEC.
 15847     MOVE LENGTH OF
 15848      ACTIVITY-TRAILERS
 15849       TO DFHEIV11
 15850     MOVE 'ELTRLR' TO DFHEIV1
 15851*    MOVE '&$ L                  ''   #00014835' TO DFHEIV0
 15852     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15854     MOVE X'2020233030303134383335' TO DFHEIV0(25:11)
 15855     CALL 'kxdfhei1' USING DFHEIV0,
 15856           DFHEIV1,
 15857           ACTIVITY-TRAILERS,
 15858           DFHEIV11,
 15859           AT-CONTROL-PRIMARY,
 15860           DFHEIV99,
 15861           DFHEIV99
 15862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15863
 15864
 15865     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15866        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15867*06088           GO TO 6199-EXIT.
 15868           GO TO 6176-APPROVAL-NOTE.
 15869
 15870
 15871* EXEC CICS GETMAIN
 15872*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15873*         LENGTH    (200)
 15874*         INITIMG   (GETMAIN-SPACE)
 15875*     END-EXEC.
 15876     MOVE 200
 15877       TO DFHEIV11
 15878*    MOVE ',"IL                  $   #00014846' TO DFHEIV0
 15879     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15881     MOVE X'2020233030303134383436' TO DFHEIV0(25:11)
 15882     CALL 'kxdfhei1' USING DFHEIV0,
 15883           DFHEIV20,
 15884           DFHEIV11,
 15885           GETMAIN-SPACE
 15886     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15887         DFHEIV20
 15888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15889
 15890
 15891     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15892
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 303
* EL156.cbl
 15893     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15894     MOVE 'AT'                   TO AT-RECORD-ID.
 15895     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15896     MOVE '6'                    TO AT-TRAILER-TYPE.
 15897     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15898                                    AT-GEN-INFO-LAST-MAINT-DT
 15899     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15900                                    AT-GEN-INFO-LAST-UPDATED-BY
 15901     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15902
 15903     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15904     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15905     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15906
 15907     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15908
 15909 6175-WRITE.
 15910
 15911
 15912* EXEC CICS HANDLE CONDITION
 15913*        DUPREC    (6190-DUPREC)
 15914*    END-EXEC.
 15915*    MOVE '"$%                   ! 4 #00014872' TO DFHEIV0
 15916     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15918     MOVE X'3420233030303134383732' TO DFHEIV0(25:11)
 15919     CALL 'kxdfhei1' USING DFHEIV0
 15920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15921
 15922
 15923
 15924* EXEC CICS WRITE
 15925*         DATASET     ('ELTRLR')
 15926*         FROM        (ACTIVITY-TRAILERS)
 15927*         RIDFLD      (AT-CONTROL-PRIMARY)
 15928*     END-EXEC.
 15929     MOVE LENGTH OF
 15930      ACTIVITY-TRAILERS
 15931       TO DFHEIV11
 15932     MOVE 'ELTRLR' TO DFHEIV1
 15933*    MOVE '&$ L                  ''   #00014876' TO DFHEIV0
 15934     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15935     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15936     MOVE X'2020233030303134383736' TO DFHEIV0(25:11)
 15937     CALL 'kxdfhei1' USING DFHEIV0,
 15938           DFHEIV1,
 15939           ACTIVITY-TRAILERS,
 15940           DFHEIV11,
 15941           AT-CONTROL-PRIMARY,
 15942           DFHEIV99,
 15943           DFHEIV99
 15944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15945
 15946
 15947 6176-APPROVAL-NOTE.
 15948
 15949     IF NOT APPROVAL-NEEDED
 15950         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 304
* EL156.cbl
 15951
 15952
 15953* EXEC CICS GETMAIN
 15954*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15955*        LENGTH    (200)
 15956*        INITIMG   (GETMAIN-SPACE)
 15957*    END-EXEC.
 15958     MOVE 200
 15959       TO DFHEIV11
 15960*    MOVE ',"IL                  $   #00014887' TO DFHEIV0
 15961     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15963     MOVE X'2020233030303134383837' TO DFHEIV0(25:11)
 15964     CALL 'kxdfhei1' USING DFHEIV0,
 15965           DFHEIV20,
 15966           DFHEIV11,
 15967           GETMAIN-SPACE
 15968     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15969         DFHEIV20
 15970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15971
 15972
 15973     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15974
 15975     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15976     MOVE 'AT'               TO AT-RECORD-ID
 15977     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15978     MOVE '6'                TO AT-TRAILER-TYPE
 15979     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15980                                AT-GEN-INFO-LAST-MAINT-DT
 15981     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15982                                AT-GEN-INFO-LAST-UPDATED-BY
 15983     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15984
 15985     IF PI-REAUDIT-NEEDED = 'Y'
 15986         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15987     ELSE
 15988         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15989     END-IF
 15990     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15991         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15992     END-IF
 15993     MOVE SPACES             TO AT-INFO-LINE-2
 15994
 15995     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15996 6177-WRITE.
 15997
 15998
 15999* EXEC CICS HANDLE CONDITION
 16000*        DUPREC    (6185-DUPREC)
 16001*    END-EXEC.
 16002*    MOVE '"$%                   ! 5 #00014918' TO DFHEIV0
 16003     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16005     MOVE X'3520233030303134393138' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0
 16007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16008
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 305
* EL156.cbl
 16009
 16010
 16011* EXEC CICS WRITE
 16012*         DATASET     ('ELTRLR')
 16013*         FROM        (ACTIVITY-TRAILERS)
 16014*         RIDFLD      (AT-CONTROL-PRIMARY)
 16015*     END-EXEC.
 16016     MOVE LENGTH OF
 16017      ACTIVITY-TRAILERS
 16018       TO DFHEIV11
 16019     MOVE 'ELTRLR' TO DFHEIV1
 16020*    MOVE '&$ L                  ''   #00014922' TO DFHEIV0
 16021     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16022     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16023     MOVE X'2020233030303134393232' TO DFHEIV0(25:11)
 16024     CALL 'kxdfhei1' USING DFHEIV0,
 16025           DFHEIV1,
 16026           ACTIVITY-TRAILERS,
 16027           DFHEIV11,
 16028           AT-CONTROL-PRIMARY,
 16029           DFHEIV99,
 16030           DFHEIV99
 16031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16032
 16033
 16034
 16035     GO TO 6199-EXIT.
 16036
 16037 6180-DUPREC.
 16038
 16039     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16040     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16041     GO TO 6170-WRITE.
 16042
 16043 6185-DUPREC.
 16044     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16045     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16046     GO TO 6177-WRITE.
 16047
 16048 6190-DUPREC.
 16049     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16050     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16051     GO TO 6175-WRITE.
 16052
 16053 6199-EXIT.
 16054      EXIT.
 16055
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 306
* EL156.cbl
 16057 6200-UPDATE-CLAIM-MSTR.
 16058     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16059     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16060     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16061     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16062
 16063     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16064
 16065     MOVE ZEROS                  TO W-INTEREST.
 16066
 16067     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16068        IF (PI-OFFLINE = 'Y') OR
 16069           (PI-PMTTYPE = '7')
 16070           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16071                                 THRU 9870-EXIT
 16072        END-IF
 16073     END-IF
 16074     IF NOT ERROR-ON-OUTPUT
 16075        CONTINUE
 16076     ELSE
 16077
 16078* EXEC CICS REWRITE
 16079*          DATASET('ELMSTR')
 16080*          FROM(CLAIM-MASTER)
 16081*       END-EXEC
 16082     MOVE LENGTH OF
 16083      CLAIM-MASTER
 16084       TO DFHEIV11
 16085     MOVE 'ELMSTR' TO DFHEIV1
 16086*    MOVE '&& L                  %   #00014971' TO DFHEIV0
 16087     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16088     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16089     MOVE X'2020233030303134393731' TO DFHEIV0(25:11)
 16090     CALL 'kxdfhei1' USING DFHEIV0,
 16091           DFHEIV1,
 16092           CLAIM-MASTER,
 16093           DFHEIV11,
 16094           DFHEIV99
 16095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16096
 16097        MOVE -1                  TO ENTPFBL
 16098        MOVE AL-UANON            TO ENTPFBA
 16099        MOVE MAP-NAMEB           TO MAP-NAME
 16100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16101        GO TO 8200-SEND-DATAONLY
 16102     END-IF
 16103
 16104     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16105
 16106     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16107
 16108     IF PI-AIG-SPECIAL-BENEFIT
 16109         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16110
 16111     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16112
 16113     IF PI-SPECIAL-BEN-SW = 'Y'
 16114         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 307
* EL156.cbl
 16115         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16116
 16117     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16118         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16119     ELSE
 16120         IF PI-PMTTYPE NOT = '4'
 16121            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16122
 16123     IF PI-PMTTYPE = '5' OR '6'
 16124        GO TO  6250-SET-MAINT.
 16125
 16126     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16127                                         CL-LAG-REPORT-CODE.
 16128
 16129     IF CL-ACTIVITY-CODE = 09
 16130         GO TO 6200-CONT-UPDATE.
 16131
 16132     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16133         IF CL-ACTIVITY-CODE = 11
 16134             GO TO 6200-CONT-UPDATE.
 16135
 16136     IF WS-ACT-REC-FOUND-SW = 'N'
 16137         GO TO 6200-CONT-UPDATE.
 16138
 16139     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16140         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16141         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16142         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16143
 16144     IF WS-UPDATE-SW = 'Y'
 16145         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16146                                         CL-NEXT-FOLLOWUP-DT.
 16147
 16148 6200-CONT-UPDATE.
 16149
 16150     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16151       IF CLAIM-IS-CLOSED
 16152         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16153           IF WS-OPEN-CLOSE-SW = '2'
 16154             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16155                                        CL-LAST-CLOSE-DT.
 16156
 16157     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16158        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16159        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16160
 16161     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16162        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16163        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16164        MOVE 'C'                 TO CL-CLAIM-STATUS
 16165        IF PI-PMTTYPE = '2'
 16166           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16167              or 'F')
 16168           CONTINUE
 16169        ELSE
 16170           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16171        END-IF
 16172     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 308
* EL156.cbl
 16173        IF PI-PMTTYPE = '2' OR '3'
 16174           IF PI-PMTTYPE = '2' AND
 16175              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16176                 or 'F')
 16177              CONTINUE
 16178           ELSE
 16179              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16180           END-IF
 16181        END-IF
 16182     END-IF
 16183
 16184     IF PI-PMTTYPE = '4'
 16185        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16186
 16187     IF PI-COMPANY-ID = 'CVL'
 16188         IF PI-LOAN-UPDATE-SW = 'Y'
 16189             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16190             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16191             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16192             MOVE CL-CERT-STATE      TO  CERT-STATE
 16193             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16194             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16195             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16196             MOVE 'CERT'             TO  FILE-SWITCH
 16197             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16198             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16199             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16200
 16201     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16202        GO TO 6220-USE-COMPUTED.
 16203
 16204     IF (PI-PMTTYPE = '4')  AND
 16205        (PI-EPYAMT < ZEROS)
 16206          COMPUTE CL-NO-OF-DAYS-PAID =
 16207                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16208          IF CL-NO-OF-DAYS-PAID < +0
 16209              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16210          ELSE
 16211              NEXT SENTENCE
 16212     ELSE
 16213          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16214
 16215     IF PI-PROCESSOR-ID = 'FIX '
 16216        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16217           NEXT SENTENCE
 16218        ELSE
 16219           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16220     ELSE
 16221        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16222
 16223     IF PI-PMTTYPE = '4'
 16224        GO TO 6250-SET-MAINT.
 16225
 16226     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16227
 16228     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16229     MOVE '4'                    TO DC-OPTION-CODE.
 16230     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 309
* EL156.cbl
 16231     IF DATE-CONVERSION-ERROR
 16232        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16233     ELSE
 16234        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16235           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16236           IF PI-AIG-SPECIAL-BENEFIT
 16237               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16238           ELSE
 16239               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16240
 16241     GO TO 6250-SET-MAINT.
 16242
 16243 6220-USE-COMPUTED.
 16244
 16245     IF (PI-PMTTYPE = '4')  AND
 16246        (PI-CPYAMT < ZEROS)
 16247          COMPUTE CL-NO-OF-DAYS-PAID =
 16248                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16249          IF CL-NO-OF-DAYS-PAID < +0
 16250              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16251          ELSE
 16252              NEXT SENTENCE
 16253     ELSE
 16254          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16255
 16256     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16257
 16258     IF PI-PMTTYPE = '4'
 16259        GO TO 6250-SET-MAINT.
 16260
 16261     IF PI-AIG-SPECIAL-BENEFIT
 16262         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16263     ELSE
 16264         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16265
 16266     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16267
 16268     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16269        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16270
 16271 6250-SET-MAINT.
 16272     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16273
 16274     IF PI-PROCESSOR-ID = 'FIX '
 16275        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16276           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16277        ELSE
 16278           NEXT SENTENCE
 16279     ELSE
 16280        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16281
 16282     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16283     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16284     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16285
 16286 6299-EXIT.
 16287      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 310
* EL156.cbl
 16289 6300-UPDATE-CERT.
 16290
 16291*  ADD CERTNOTE FOR SC NP+6
 16292     IF PI-COMPANY-ID = 'CID' AND
 16293       (PI-PMTTYPE = '2' OR '3') AND
 16294        CL-CERT-STATE = 'SC'  AND
 16295        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16296           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16297     END-IF.
 16298
 16299     IF PI-COMPANY-ID = 'AHL' AND
 16300       (PI-PMTTYPE = '2' OR '3') AND
 16301        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16302           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16303           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16304     END-IF.
 16305
 16306     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16307     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16308     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16309     MOVE CL-CERT-STATE    TO CERT-STATE.
 16310     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16311     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16312     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16313     MOVE 'CERT'           TO FILE-SWITCH.
 16314
 16315     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16316
 16317     IF CERT-NOTE-ADDED
 16318        IF CM-NOTE-SW = ' '
 16319           MOVE '4'             TO CM-NOTE-SW
 16320        ELSE
 16321           IF CM-NOTE-SW = '1'
 16322               MOVE '5'           TO CM-NOTE-SW
 16323           ELSE
 16324              IF CM-NOTE-SW = '2'
 16325                 MOVE '6'         TO CM-NOTE-SW
 16326              ELSE
 16327                 IF CM-NOTE-SW = '3'
 16328                    MOVE '7'      TO CM-NOTE-SW
 16329                 END-IF
 16330              END-IF
 16331           END-IF
 16332        END-IF
 16333     END-IF.
 16334
 16335     IF PI-COMPANY-ID = 'CVL'
 16336         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16337         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16338
 16339     IF PI-PMTTYPE NOT = '4'
 16340        GO TO 6340-UPDATE-CERT.
 16341
 16342     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16343        IF PI-PFKEY-USED = DFHPF5
 16344           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16345        ELSE
 16346           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 311
* EL156.cbl
 16347
 16348*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16349*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16350*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16351*               PI-LF-COVERAGE-TYPE = 'P'
 16352*                GO TO 6350-REWRITE-CERT.
 16353
 16354     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16355       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16356          PI-LF-COVERAGE-TYPE = 'P'
 16357           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16358                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16359                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16360                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16361                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16362                GO TO 6350-REWRITE-CERT
 16363            ELSE
 16364                GO TO 6350-REWRITE-CERT.
 16365
 16366     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16367         GO TO 6350-REWRITE-CERT.
 16368
 16369     IF NOT CM-AH-LUMP-SUM-DISAB
 16370        GO TO 6380-UNLOCK-CERT.
 16371
 16372     IF PI-PFKEY-USED = DFHPF5
 16373        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16374                                    CM-AH-ITD-AH-PMT
 16375        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16376        GO TO 6350-REWRITE-CERT
 16377     ELSE
 16378        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16379                                    CM-AH-ITD-AH-PMT
 16380        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16381        GO TO 6350-REWRITE-CERT.
 16382
 16383 6340-UPDATE-CERT.
 16384
 16385     IF CL-CLAIM-TYPE = 'L'
 16386         IF PI-PFKEY-USED = DFHPF5
 16387             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16388         ELSE
 16389             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16390
 16391     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16392         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16393             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16394                PI-LF-COVERAGE-TYPE = 'P'
 16395                 GO TO 6350-REWRITE-CERT.
 16396
 16397     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16398       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16399          PI-LF-COVERAGE-TYPE = 'P'
 16400           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16401                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16402                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16403                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16404                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 312
* EL156.cbl
 16405                GO TO 6350-REWRITE-CERT.
 16406
 16407     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16408         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16409            PI-LF-COVERAGE-TYPE NOT = 'P'
 16410             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16411             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16412             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16413             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16414             GO TO 6350-REWRITE-CERT.
 16415
 16416     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16417         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16418         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16419         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16420         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16421         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16422         IF PI-PFKEY-USED = DFHPF5
 16423             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16424                                        CM-AH-ITD-AH-PMT
 16425             GO TO 6350-REWRITE-CERT
 16426         ELSE
 16427             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16428                                        CM-AH-ITD-AH-PMT
 16429             GO TO 6350-REWRITE-CERT.
 16430
 16431 6350-REWRITE-CERT.
 16432
 16433
 16434* EXEC CICS REWRITE
 16435*         DATASET  ('ELCERT')
 16436*         FROM(CERTIFICATE-MASTER)
 16437*     END-EXEC.
 16438     MOVE LENGTH OF
 16439      CERTIFICATE-MASTER
 16440       TO DFHEIV11
 16441     MOVE 'ELCERT' TO DFHEIV1
 16442*    MOVE '&& L                  %   #00015312' TO DFHEIV0
 16443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16445     MOVE X'2020233030303135333132' TO DFHEIV0(25:11)
 16446     CALL 'kxdfhei1' USING DFHEIV0,
 16447           DFHEIV1,
 16448           CERTIFICATE-MASTER,
 16449           DFHEIV11,
 16450           DFHEIV99
 16451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16452
 16453
 16454     GO TO 6399-EXIT.
 16455
 16456 6380-UNLOCK-CERT.
 16457
 16458* EXEC CICS UNLOCK
 16459*         DATASET  ('ELCERT')
 16460*     END-EXEC.
 16461     MOVE 'ELCERT' TO DFHEIV1
 16462*    MOVE '&*                    #   #00015320' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 313
* EL156.cbl
 16463     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16464     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16465     MOVE X'2020233030303135333230' TO DFHEIV0(25:11)
 16466     CALL 'kxdfhei1' USING DFHEIV0,
 16467           DFHEIV1,
 16468           DFHEIV99
 16469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16470
 16471
 16472 6399-EXIT.
 16473      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 314
* EL156.cbl
 16475 6400-UPDATE-ZERO-TRAILER.
 16476     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16477     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16478
 16479     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16480
 16481     IF PI-EPYAMT NOT = ZEROS
 16482         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16483     ELSE
 16484         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16485
 16486     IF PI-ERESV NOT = ZEROS
 16487        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16488
 16489     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16490        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16491
 16492     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16493        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16494     ELSE
 16495        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16496
 16497     IF PI-PMTTYPE = '5'
 16498        IF PI-EPYAMT = ZEROS
 16499           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16500        ELSE
 16501           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16502
 16503     IF PI-PMTTYPE = '6'
 16504        IF PI-EPYAMT = ZEROS
 16505           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16506        ELSE
 16507           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16508
 16509 6420-CHECK-OPEN-CLOSE.
 16510     IF PI-PMTTYPE = '5' OR '6'
 16511        GO TO 6450-REWRITE.
 16512
 16513     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16514         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16515             IF CLAIM-IS-CLOSED
 16516                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16517                 MOVE 1          TO  SUB-1
 16518                 GO TO 6440-AIG-LOOP.
 16519
 16520     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16521        GO TO 6450-REWRITE.
 16522
 16523     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16524        GO TO 6450-REWRITE.
 16525
 16526     MOVE 1                      TO SUB-1.
 16527
 16528 6430-LOOP.
 16529     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16530        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16531        IF PI-PMTTYPE = '1' OR '4'
 16532           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 315
* EL156.cbl
 16533           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16534           GO TO 6450-REWRITE
 16535        ELSE
 16536           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16537           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16538           GO TO 6450-REWRITE.
 16539
 16540     IF SUB-1 = 6
 16541      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16542      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16543      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16544      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16545      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16546      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16547      GO TO 6430-LOOP.
 16548
 16549     ADD 1                       TO SUB-1.
 16550     GO TO 6430-LOOP.
 16551
 16552
 16553 6440-AIG-LOOP.
 16554
 16555     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16556       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16557       IF WS-OPEN-CLOSE-SW = '1'
 16558         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16559         IF PI-PMTTYPE = '2'
 16560           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16561           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16562         ELSE
 16563           IF PI-PMTTYPE = '3'
 16564             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16565             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16566           ELSE
 16567             IF PI-PMTTYPE = '4'
 16568               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16569               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16570             ELSE
 16571               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16572               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16573       ELSE
 16574         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16575         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16576         GO TO 6450-REWRITE.
 16577
 16578     IF SUB-1 = 6
 16579      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16580      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16581      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16582      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16583      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16584      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16585      GO TO 6440-AIG-LOOP.
 16586
 16587     ADD 1                       TO SUB-1.
 16588     GO TO 6440-AIG-LOOP.
 16589
 16590 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 316
* EL156.cbl
 16591     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16592     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16593     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16594
 16595     IF PI-COMPANY-ID = 'DMD'
 16596         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16597         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16598         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16599         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16600         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16601
 16602
 16603* EXEC CICS REWRITE
 16604*         DATASET  ('ELTRLR')
 16605*         FROM     (ACTIVITY-TRAILERS)
 16606*     END-EXEC.
 16607     MOVE LENGTH OF
 16608      ACTIVITY-TRAILERS
 16609       TO DFHEIV11
 16610     MOVE 'ELTRLR' TO DFHEIV1
 16611*    MOVE '&& L                  %   #00015454' TO DFHEIV0
 16612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16614     MOVE X'2020233030303135343534' TO DFHEIV0(25:11)
 16615     CALL 'kxdfhei1' USING DFHEIV0,
 16616           DFHEIV1,
 16617           ACTIVITY-TRAILERS,
 16618           DFHEIV11,
 16619           DFHEIV99
 16620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16621
 16622
 16623 6499-EXIT.
 16624      EXIT.
 16625
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 317
* EL156.cbl
 16627 6500-READ-DLO035.
 16628     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16629     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16630     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16631     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16632
 16633
 16634* EXEC CICS LINK
 16635*        PROGRAM    ('DLO035')
 16636*        COMMAREA   (DLO035-KEY)
 16637*        LENGTH     (DL35-LENGTH)
 16638*    END-EXEC.
 16639     MOVE 'DLO035' TO DFHEIV1
 16640*    MOVE '."C                   (   #00015469' TO DFHEIV0
 16641     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16643     MOVE X'2020233030303135343639' TO DFHEIV0(25:11)
 16644     CALL 'kxdfhei1' USING DFHEIV0,
 16645           DFHEIV1,
 16646           DLO035-KEY,
 16647           DL35-LENGTH,
 16648           DFHEIV99,
 16649           DFHEIV99,
 16650           DFHEIV99,
 16651           DFHEIV99
 16652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16653
 16654
 16655     IF DL35-RETURN-CODE = 'OK'
 16656         GO TO 6500-EXIT.
 16657
 16658     IF DL35-RETURN-CODE = '01'
 16659         MOVE ER-7830            TO EMI-ERROR
 16660         GO TO 6500-BAD-EXIT.
 16661
 16662     IF DL35-RETURN-CODE = '02'
 16663         MOVE ER-7831            TO EMI-ERROR
 16664         GO TO 6500-BAD-EXIT.
 16665
 16666     IF DL35-RETURN-CODE = '03'
 16667         MOVE ER-7832            TO EMI-ERROR
 16668         GO TO 6500-BAD-EXIT.
 16669
 16670     IF DL35-RETURN-CODE = '04'
 16671         MOVE ER-7833            TO EMI-ERROR
 16672         GO TO 6500-BAD-EXIT.
 16673
 16674     IF DL35-RETURN-CODE = '05'
 16675         MOVE ER-7834            TO EMI-ERROR
 16676         GO TO 6500-BAD-EXIT.
 16677
 16678     IF DL35-RETURN-CODE = '06'
 16679         MOVE ER-7835            TO EMI-ERROR
 16680         GO TO 6500-BAD-EXIT.
 16681
 16682     IF DL35-RETURN-CODE = '07'
 16683         MOVE ER-7836            TO EMI-ERROR
 16684         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 318
* EL156.cbl
 16685
 16686     IF DL35-RETURN-CODE = 'E1'
 16687         MOVE ER-7837            TO EMI-ERROR
 16688         GO TO 6500-BAD-EXIT.
 16689
 16690     IF DL35-RETURN-CODE NOT = 'OK'
 16691         MOVE ER-7838            TO EMI-ERROR
 16692         GO TO 6500-BAD-EXIT.
 16693
 16694 6500-EXIT.
 16695      EXIT.
 16696
 16697 6500-BAD-EXIT.
 16698
 16699* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16700*    MOVE '6"R                   !   #00015518' TO DFHEIV0
 16701     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16703     MOVE X'2020233030303135353138' TO DFHEIV0(25:11)
 16704     CALL 'kxdfhei1' USING DFHEIV0
 16705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16706
 16707     MOVE -1                 TO PMTTYPEL.
 16708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16709     GO TO 8200-SEND-DATAONLY.
 16710
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 319
* EL156.cbl
 16712 6600-UPDATE-DLO035.
 16713     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16714     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16715     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16716     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16717
 16718
 16719* EXEC CICS LINK
 16720*        PROGRAM    ('DLO035')
 16721*        COMMAREA   (DLO035-KEY)
 16722*        LENGTH     (DL35-LENGTH)
 16723*    END-EXEC.
 16724     MOVE 'DLO035' TO DFHEIV1
 16725*    MOVE '."C                   (   #00015530' TO DFHEIV0
 16726     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16728     MOVE X'2020233030303135353330' TO DFHEIV0(25:11)
 16729     CALL 'kxdfhei1' USING DFHEIV0,
 16730           DFHEIV1,
 16731           DLO035-KEY,
 16732           DL35-LENGTH,
 16733           DFHEIV99,
 16734           DFHEIV99,
 16735           DFHEIV99,
 16736           DFHEIV99
 16737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16738
 16739
 16740     IF DL35-RETURN-CODE = 'OK'
 16741         GO TO 6600-EXIT.
 16742
 16743     IF DL35-RETURN-CODE = '01'
 16744         MOVE ER-7830            TO EMI-ERROR
 16745         GO TO 6500-BAD-EXIT.
 16746
 16747     IF DL35-RETURN-CODE = '02'
 16748         MOVE ER-7831            TO EMI-ERROR
 16749         GO TO 6500-BAD-EXIT.
 16750
 16751     IF DL35-RETURN-CODE = '03'
 16752         MOVE ER-7832            TO EMI-ERROR
 16753         GO TO 6500-BAD-EXIT.
 16754
 16755     IF DL35-RETURN-CODE = '04'
 16756         MOVE ER-7833            TO EMI-ERROR
 16757         GO TO 6500-BAD-EXIT.
 16758
 16759     IF DL35-RETURN-CODE = '05'
 16760         MOVE ER-7834            TO EMI-ERROR
 16761         GO TO 6500-BAD-EXIT.
 16762
 16763     IF DL35-RETURN-CODE = '06'
 16764         MOVE ER-7835            TO EMI-ERROR
 16765         GO TO 6500-BAD-EXIT.
 16766
 16767     IF DL35-RETURN-CODE = '07'
 16768         MOVE ER-7836            TO EMI-ERROR
 16769         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 320
* EL156.cbl
 16770
 16771     IF DL35-RETURN-CODE = 'E1'
 16772         MOVE ER-7837            TO EMI-ERROR
 16773         GO TO 6500-BAD-EXIT.
 16774
 16775     IF DL35-RETURN-CODE NOT = 'OK'
 16776         MOVE ER-7838            TO EMI-ERROR
 16777         GO TO 6500-BAD-EXIT.
 16778
 16779 6600-EXIT.
 16780      EXIT.
 16781
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 321
* EL156.cbl
 16783 6700-UPDATE-ACTQ.
 16784***************************************************************
 16785*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16786*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16787*    ONE ALREADY THERE.                                       *
 16788***************************************************************
 16789
 16790
 16791* EXEC CICS HANDLE CONDITION
 16792*         NOTFND(6720-BUILD-NEW-RECORD)
 16793*     END-EXEC.
 16794*    MOVE '"$I                   ! 6 #00015586' TO DFHEIV0
 16795     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16797     MOVE X'3620233030303135353836' TO DFHEIV0(25:11)
 16798     CALL 'kxdfhei1' USING DFHEIV0
 16799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16800
 16801
 16802
 16803* EXEC CICS READ
 16804*         DATASET('ELACTQ')
 16805*         RIDFLD (ELMSTR-KEY)
 16806*         SET    (ADDRESS OF ACTIVITY-QUE)
 16807*         UPDATE
 16808*     END-EXEC.
 16809     MOVE 'ELACTQ' TO DFHEIV1
 16810*    MOVE '&"S        EU         (   #00015590' TO DFHEIV0
 16811     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16813     MOVE X'2020233030303135353930' TO DFHEIV0(25:11)
 16814     CALL 'kxdfhei1' USING DFHEIV0,
 16815           DFHEIV1,
 16816           DFHEIV20,
 16817           DFHEIV99,
 16818           ELMSTR-KEY,
 16819           DFHEIV99,
 16820           DFHEIV99,
 16821           DFHEIV99
 16822     SET ADDRESS OF ACTIVITY-QUE TO
 16823         DFHEIV20
 16824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16825
 16826
 16827     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16828
 16829     IF PI-AIG-SPECIAL-BENEFIT AND
 16830        PI-CASH = 'Y'
 16831         ADD 2                   TO AQ-PAYMENT-COUNTER
 16832     ELSE
 16833         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16834
 16835     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16836         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16837
 16838     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16839
 16840     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 322
* EL156.cbl
 16841         IF WS-PMT-APPROVAL-SW = 'A'
 16842             NEXT SENTENCE
 16843         ELSE
 16844            IF PI-AIG-SPECIAL-BENEFIT AND
 16845               PI-CASH = 'Y'
 16846                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16847                                     WS-PMT-UNAPPROVED-CNT
 16848            ELSE
 16849                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16850                                     WS-PMT-UNAPPROVED-CNT
 16851     ELSE
 16852         IF PI-PMT-APPR-SW = 'Y'
 16853            IF PI-AIG-SPECIAL-BENEFIT AND
 16854               PI-CASH = 'Y'
 16855                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16856                                     WS-PMT-UNAPPROVED-CNT
 16857            ELSE
 16858                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16859                                     WS-PMT-UNAPPROVED-CNT.
 16860
 16861     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16862         MOVE ER-3536 TO EMI-ERROR
 16863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16864
 16865     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16866
 16867
 16868* EXEC CICS REWRITE
 16869*         DATASET('ELACTQ')
 16870*         FROM   (ACTIVITY-QUE)
 16871*     END-EXEC.
 16872     MOVE LENGTH OF
 16873      ACTIVITY-QUE
 16874       TO DFHEIV11
 16875     MOVE 'ELACTQ' TO DFHEIV1
 16876*    MOVE '&& L                  %   #00015637' TO DFHEIV0
 16877     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16878     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16879     MOVE X'2020233030303135363337' TO DFHEIV0(25:11)
 16880     CALL 'kxdfhei1' USING DFHEIV0,
 16881           DFHEIV1,
 16882           ACTIVITY-QUE,
 16883           DFHEIV11,
 16884           DFHEIV99
 16885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16886
 16887
 16888     GO TO 6799-EXIT.
 16889
 16890 6720-BUILD-NEW-RECORD.
 16891
 16892* EXEC CICS GETMAIN
 16893*         SET    (ADDRESS OF ACTIVITY-QUE)
 16894*         LENGTH (60)
 16895*         INITIMG(GETMAIN-SPACE)
 16896*     END-EXEC.
 16897     MOVE 60
 16898       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 323
* EL156.cbl
 16899*    MOVE ',"IL                  $   #00015645' TO DFHEIV0
 16900     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16902     MOVE X'2020233030303135363435' TO DFHEIV0(25:11)
 16903     CALL 'kxdfhei1' USING DFHEIV0,
 16904           DFHEIV20,
 16905           DFHEIV11,
 16906           GETMAIN-SPACE
 16907     SET ADDRESS OF ACTIVITY-QUE TO
 16908         DFHEIV20
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16910
 16911
 16912     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16913
 16914     IF PI-AIG-SPECIAL-BENEFIT AND
 16915        PI-CASH = 'Y'
 16916         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16917     ELSE
 16918         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16919
 16920     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16921     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16922     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16923     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16924                                    AQ-FOLLOWUP-DATE.
 16925     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16926     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16927
 16928     IF PI-PMT-GRADUATED
 16929         IF WS-PMT-APPROVAL-SW = 'A'
 16930             NEXT SENTENCE
 16931         ELSE
 16932            IF PI-AIG-SPECIAL-BENEFIT AND
 16933               PI-CASH = 'Y'
 16934                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16935            ELSE
 16936                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16937     ELSE
 16938         IF PI-PMT-APPR-SW = 'Y'
 16939            IF PI-AIG-SPECIAL-BENEFIT AND
 16940               PI-CASH = 'Y'
 16941                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16942            ELSE
 16943                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16944
 16945     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16946         MOVE ER-3536 TO EMI-ERROR
 16947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16948
 16949
 16950* EXEC CICS WRITE
 16951*         DATASET('ELACTQ')
 16952*         RIDFLD (ELMSTR-KEY)
 16953*         FROM   (ACTIVITY-QUE)
 16954*     END-EXEC.
 16955     MOVE LENGTH OF
 16956      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 324
* EL156.cbl
 16957       TO DFHEIV11
 16958     MOVE 'ELACTQ' TO DFHEIV1
 16959*    MOVE '&$ L                  ''   #00015688' TO DFHEIV0
 16960     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16962     MOVE X'2020233030303135363838' TO DFHEIV0(25:11)
 16963     CALL 'kxdfhei1' USING DFHEIV0,
 16964           DFHEIV1,
 16965           ACTIVITY-QUE,
 16966           DFHEIV11,
 16967           ELMSTR-KEY,
 16968           DFHEIV99,
 16969           DFHEIV99
 16970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16971
 16972
 16973 6799-EXIT.
 16974      EXIT.
 16975
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 325
* EL156.cbl
 16977 6800-BUILD-FORM-TRAILER.
 16978
 16979
 16980* EXEC CICS GETMAIN
 16981*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16982*         LENGTH   (200)
 16983*         INITIMG  (GETMAIN-SPACE)
 16984*    END-EXEC.
 16985     MOVE 200
 16986       TO DFHEIV11
 16987*    MOVE ',"IL                  $   #00015700' TO DFHEIV0
 16988     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16989     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16990     MOVE X'2020233030303135373030' TO DFHEIV0(25:11)
 16991     CALL 'kxdfhei1' USING DFHEIV0,
 16992           DFHEIV20,
 16993           DFHEIV11,
 16994           GETMAIN-SPACE
 16995     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16996         DFHEIV20
 16997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16998
 16999
 17000     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17001
 17002     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17003     MOVE 'AT'                   TO AT-RECORD-ID.
 17004     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17005
 17006     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17007     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17008                                    AT-FORM-LAST-MAINT-DT
 17009                                    AT-FORM-SEND-ON-DT.
 17010     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17011                                    AT-FORM-LAST-UPDATED-BY.
 17012     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17013     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17014     MOVE '6'                    TO DC-OPTION-CODE.
 17015     MOVE +29                    TO DC-ELAPSED-DAYS.
 17016     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17018     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17019
 17020     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17021         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17022
 17023     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17024                                    AT-FORM-RE-SEND-DT
 17025                                    AT-EMP-FORM-ANSWERED-DT
 17026                                    AT-PHY-FORM-ANSWERED-DT
 17027                                    AT-EMP-FORM-SEND-ON-DT
 17028                                    AT-PHY-FORM-SEND-ON-DT
 17029                                    AT-FORM-PRINTED-DT
 17030                                    AT-FORM-REPRINT-DT.
 17031     MOVE '2'                    TO AT-FORM-TYPE.
 17032
 17033     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17034     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 326
* EL156.cbl
 17035
 17036     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17037         NEXT SENTENCE
 17038     ELSE
 17039         IF CL-PROG-FORM-TYPE NOT = 'S'
 17040            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17041
 17042
 17043* EXEC CICS WRITE
 17044*         DATASET  ('ELTRLR')
 17045*         FROM     (ACTIVITY-TRAILERS)
 17046*         RIDFLD   (AT-CONTROL-PRIMARY)
 17047*     END-EXEC.
 17048     MOVE LENGTH OF
 17049      ACTIVITY-TRAILERS
 17050       TO DFHEIV11
 17051     MOVE 'ELTRLR' TO DFHEIV1
 17052*    MOVE '&$ L                  ''   #00015748' TO DFHEIV0
 17053     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17054     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17055     MOVE X'2020233030303135373438' TO DFHEIV0(25:11)
 17056     CALL 'kxdfhei1' USING DFHEIV0,
 17057           DFHEIV1,
 17058           ACTIVITY-TRAILERS,
 17059           DFHEIV11,
 17060           AT-CONTROL-PRIMARY,
 17061           DFHEIV99,
 17062           DFHEIV99
 17063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17064
 17065
 17066 6899-EXIT.
 17067      EXIT.
 17068
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 327
* EL156.cbl
 17070 6900-BUILD-ARCHIVE-HEADER.
 17071
 17072     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17073     MOVE '1'                    TO CNTL-REC-TYPE.
 17074     MOVE +0                     TO CNTL-SEQ-NO.
 17075     MOVE SPACES                 TO CNTL-ACCESS.
 17076
 17077
 17078* EXEC CICS READ
 17079*         DATASET  ('ELCNTL')
 17080*         SET      (ADDRESS OF CONTROL-FILE)
 17081*         RIDFLD   (ELCNTL-KEY)
 17082*         UPDATE
 17083*    END-EXEC.
 17084     MOVE 'ELCNTL' TO DFHEIV1
 17085*    MOVE '&"S        EU         (   #00015765' TO DFHEIV0
 17086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17087     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17088     MOVE X'2020233030303135373635' TO DFHEIV0(25:11)
 17089     CALL 'kxdfhei1' USING DFHEIV0,
 17090           DFHEIV1,
 17091           DFHEIV20,
 17092           DFHEIV99,
 17093           ELCNTL-KEY,
 17094           DFHEIV99,
 17095           DFHEIV99,
 17096           DFHEIV99
 17097     SET ADDRESS OF CONTROL-FILE TO
 17098         DFHEIV20
 17099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17100
 17101
 17102     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17103     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17104
 17105
 17106* EXEC CICS REWRITE
 17107*         FROM     (CONTROL-FILE)
 17108*         DATASET  ('ELCNTL')
 17109*    END-EXEC.
 17110     MOVE LENGTH OF
 17111      CONTROL-FILE
 17112       TO DFHEIV11
 17113     MOVE 'ELCNTL' TO DFHEIV1
 17114*    MOVE '&& L                  %   #00015775' TO DFHEIV0
 17115     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17117     MOVE X'2020233030303135373735' TO DFHEIV0(25:11)
 17118     CALL 'kxdfhei1' USING DFHEIV0,
 17119           DFHEIV1,
 17120           CONTROL-FILE,
 17121           DFHEIV11,
 17122           DFHEIV99
 17123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17124
 17125
 17126
 17127* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 328
* EL156.cbl
 17128*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17129*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17130*    END-EXEC.
 17131*    MOVE '"$$%                  ! 7 #00015780' TO DFHEIV0
 17132     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17134     MOVE X'3720233030303135373830' TO DFHEIV0(25:11)
 17135     CALL 'kxdfhei1' USING DFHEIV0
 17136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17137
 17138
 17139
 17140* EXEC CICS GETMAIN
 17141*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17142*         LENGTH  (ELARCH-LENGTH)
 17143*         INITIMG (GETMAIN-SPACE)
 17144*    END-EXEC.
 17145*    MOVE ',"IL                  $   #00015785' TO DFHEIV0
 17146     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17147     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17148     MOVE X'2020233030303135373835' TO DFHEIV0(25:11)
 17149     CALL 'kxdfhei1' USING DFHEIV0,
 17150           DFHEIV20,
 17151           ELARCH-LENGTH,
 17152           GETMAIN-SPACE
 17153     SET ADDRESS OF LETTER-ARCHIVE TO
 17154         DFHEIV20
 17155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17156
 17157
 17158     MOVE 'LA'                   TO LA-RECORD-ID.
 17159     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17160                                    LA-ARCHIVE-NO-A1.
 17161     MOVE '4'                    TO LA-RECORD-TYPE
 17162                                    LA-RECORD-TYPE-A1.
 17163     MOVE +0                     TO LA-LINE-SEQ-NO
 17164                                    LA-LINE-SEQ-NO-A1.
 17165     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17166                                    LA-COMPANY-CD-A1.
 17167     MOVE CL-CARRIER             TO LA4-CARRIER.
 17168     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17169     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17170     MOVE CL-CERT-STATE          TO LA4-STATE.
 17171     MOVE +0                     TO LA4-NO-OF-COPIES.
 17172     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17173     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17174     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17175                                    LA4-INITIAL-PRINT-DATE
 17176                                    LA4-RESEND-PRINT-DATE
 17177                                    LA4-FORM-REM-PRINT-DT.
 17178     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17179     MOVE '2'                    TO LA4-FORM-TYPE.
 17180
 17181
 17182* EXEC CICS WRITE
 17183*         DATASET  ('ELARCH')
 17184*         FROM     (LETTER-ARCHIVE)
 17185*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 329
* EL156.cbl
 17186*    END-EXEC.
 17187     MOVE LENGTH OF
 17188      LETTER-ARCHIVE
 17189       TO DFHEIV11
 17190     MOVE 'ELARCH' TO DFHEIV1
 17191*    MOVE '&$ L                  ''   #00015814' TO DFHEIV0
 17192     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17194     MOVE X'2020233030303135383134' TO DFHEIV0(25:11)
 17195     CALL 'kxdfhei1' USING DFHEIV0,
 17196           DFHEIV1,
 17197           LETTER-ARCHIVE,
 17198           DFHEIV11,
 17199           LA-CONTROL-PRIMARY,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205 6999-EXIT.
 17206      EXIT.
 17207
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 330
* EL156.cbl
 17209 7000-SHOW-CLAIM.
 17210     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17211     MOVE 'A'                    TO PI-PASS-SW.
 17212     MOVE LOW-VALUES             TO PI-CPYFROM
 17213                                    PI-MONTH-END-SAVE
 17214                                    PI-CPYTHRU.
 17215
 17216     MOVE ZEROS                  TO PI-FATAL-COUNT
 17217                                    PI-DAILY-RATE
 17218                                    PI-BEN-DAYS
 17219                                    PI-MANUAL-SW
 17220                                    PI-SAVE-CURSOR
 17221                                    PI-FORCE-COUNT
 17222                                    PI-HOLDTIL
 17223                                    PI-EPYFROM
 17224                                    PI-EPYTHRU
 17225                                    PI-EDAYS
 17226                                    PI-EPYAMT
 17227                                    PI-ERESV
 17228                                    PI-EEXPENS
 17229                                    PI-CDAYS
 17230                                    PI-CPYAMT
 17231                                    PI-CRESV
 17232                                    PI-CEXPENS
 17233                                    PI-INT-RATE
 17234                                    PI-AIGFROM.
 17235     MOVE ZEROS                  TO PI-PROOF-DATE.
 17236     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17237                                    PI-REM-BEN-AMT
 17238                                    PI-MO-BEN-AMT
 17239                                    pi-ah-term.
 17240
 17241     MOVE LOW-VALUES             TO EL156AI.
 17242     MOVE MAP-NAMEA              TO MAP-NAME.
 17243
 17244* EXEC CICS HANDLE CONDITION
 17245*        NOTFND   (7010-BUILD-MAP)
 17246*    END-EXEC.
 17247*    MOVE '"$I                   ! 8 #00015858' TO DFHEIV0
 17248     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17250     MOVE X'3820233030303135383538' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0
 17252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17253
 17254
 17255     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17256     MOVE '2'                    TO CNTL-REC-TYPE.
 17257     MOVE +0                     TO CNTL-SEQ-NO.
 17258     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17259
 17260
 17261* EXEC CICS READ
 17262*         DATASET  ('ELCNTL')
 17263*         SET      (ADDRESS OF CONTROL-FILE)
 17264*         RIDFLD   (ELCNTL-KEY)
 17265*    END-EXEC.
 17266     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 331
* EL156.cbl
 17267*    MOVE '&"S        E          (   #00015867' TO DFHEIV0
 17268     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17270     MOVE X'2020233030303135383637' TO DFHEIV0(25:11)
 17271     CALL 'kxdfhei1' USING DFHEIV0,
 17272           DFHEIV1,
 17273           DFHEIV20,
 17274           DFHEIV99,
 17275           ELCNTL-KEY,
 17276           DFHEIV99,
 17277           DFHEIV99,
 17278           DFHEIV99
 17279     SET ADDRESS OF CONTROL-FILE TO
 17280         DFHEIV20
 17281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17282
 17283
 17284     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17285
 17286     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17287         MOVE AL-UANON      TO SURVYYNA
 17288     END-IF.
 17289
 17290
 17291     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17292     MOVE '1'                    TO CNTL-REC-TYPE.
 17293     MOVE SPACES                 TO CNTL-ACCESS.
 17294     MOVE +0                     TO CNTL-SEQ-NO.
 17295
 17296
 17297* EXEC CICS READ
 17298*         DATASET  ('ELCNTL')
 17299*         SET      (ADDRESS OF CONTROL-FILE)
 17300*         RIDFLD   (ELCNTL-KEY)
 17301*    END-EXEC.
 17302     MOVE 'ELCNTL' TO DFHEIV1
 17303*    MOVE '&"S        E          (   #00015885' TO DFHEIV0
 17304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17306     MOVE X'2020233030303135383835' TO DFHEIV0(25:11)
 17307     CALL 'kxdfhei1' USING DFHEIV0,
 17308           DFHEIV1,
 17309           DFHEIV20,
 17310           DFHEIV99,
 17311           ELCNTL-KEY,
 17312           DFHEIV99,
 17313           DFHEIV99,
 17314           DFHEIV99
 17315     SET ADDRESS OF CONTROL-FILE TO
 17316         DFHEIV20
 17317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17318
 17319
 17320     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17321
 17322 7010-BUILD-MAP.
 17323
 17324
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 332
* EL156.cbl
 17325* EXEC CICS HANDLE CONDITION
 17326*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17327*    END-EXEC.
 17328*    MOVE '"$I                   ! 9 #00015895' TO DFHEIV0
 17329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17331     MOVE X'3920233030303135383935' TO DFHEIV0(25:11)
 17332     CALL 'kxdfhei1' USING DFHEIV0
 17333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17334
 17335
 17336     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17337     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17338     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17339     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17340     MOVE 'MSTR'                 TO FILE-SWITCH.
 17341
 17342     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17343
 17344     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17345     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17346     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17347     MOVE CL-CCN                 TO PI-SV-CCN.
 17348
 17349     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17350     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17351     MOVE CL-CLAIM-NO            TO CLMNOO.
 17352     MOVE CL-CARRIER             TO CARRO.
 17353     MOVE CL-CERT-PRIME          TO CERTNOO.
 17354     MOVE CL-CERT-SFX            TO SUFXO.
 17355
 17356     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17357        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17358        CONTINUE
 17359     ELSE
 17360        MOVE AL-SADOF            TO ZINTHA
 17361                                    ZINTA
 17362                                    PINTHA
 17363                                    PINTA
 17364     END-IF
 17365     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17366     EVALUATE TRUE
 17367     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17368         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17369     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17370         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17371
 17372     WHEN CL-CLAIM-TYPE = 'I'
 17373         MOVE '  IU  '           TO CLMTYPO
 17374     WHEN CL-CLAIM-TYPE = 'G'
 17375         MOVE ' GAP  '           TO CLMTYPO
 17376     WHEN CL-CLAIM-TYPE = 'F'
 17377         MOVE ' FMLA '           TO CLMTYPO
 17378     END-EVALUATE.
 17379     IF CLAIM-IS-OPEN
 17380         MOVE ' OPEN'            TO CLMSTATO
 17381     ELSE
 17382         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 333
* EL156.cbl
 17383
 17384     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17385
 17386     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17387         MOVE SPACES             TO  PCERTNOO
 17388                                     PSUFXO
 17389                                     PRIMHDGO
 17390                                     SEQUO
 17391         MOVE AL-SADOF           TO  PCERTNOA
 17392                                     PSUFXA
 17393                                     PRIMHDGA
 17394                                     SEQUA
 17395     ELSE
 17396         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17397         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17398         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17399         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17400         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17401         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17402         MOVE AL-SANON               TO  PCERTNOA
 17403                                         PSUFXA
 17404                                         PRIMHDGA
 17405         MOVE AL-SABON               TO  SEQUA.
 17406
 17407     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17408
 17409     IF CL-NO-OF-PMTS-MADE = 0 AND
 17410        CL-TOTAL-PAID-AMT = 0
 17411         NEXT SENTENCE
 17412     ELSE
 17413         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17414             IF NOT PI-USES-PAID-TO
 17415                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17416                 MOVE ' '                 TO DC-OPTION-CODE
 17417                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17418                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17419             ELSE
 17420                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17421                 MOVE '6'                 TO DC-OPTION-CODE
 17422                 MOVE +1                  TO DC-ELAPSED-DAYS
 17423                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17424                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17425                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17426
 17427     IF MAP-NAME = 'EL156A'
 17428        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17429           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17430             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17431           end-if
 17432        end-if
 17433     end-if
 17434     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17435         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17436         MOVE ' '                TO DC-OPTION-CODE
 17437         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17438         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17439
 17440     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 334
* EL156.cbl
 17441         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17442         MOVE ' '                TO DC-OPTION-CODE
 17443         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17444         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17445
 17446     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17447
 17448     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17449         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17450         MOVE ' '                TO DC-OPTION-CODE
 17451         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17452         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17453
 17454     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17455         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17456         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17457     ELSE
 17458         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17459         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17460
 17461     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17462     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17463     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17464     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17465                                    PI-GROUPING.
 17466     MOVE CL-CERT-STATE          TO CERT-STATE
 17467                                    PI-STATE.
 17468     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17469                                    PI-ACCOUNT.
 17470     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17471     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17472     MOVE 'CERT'                 TO FILE-SWITCH.
 17473
 17474     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17475     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17476        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17477        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17478            MOVE 'N' TO PI-JOINT-INSURED-IND
 17479     ELSE
 17480            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17481     END-IF.
 17482
 17483     perform 7975-read-acct      thru 7975-exit
 17484     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17485     MOVE PI-STATE               TO WS-ST-ACCESS.
 17486     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17487     MOVE '3'                    TO CNTL-REC-TYPE.
 17488     MOVE +0                     TO CNTL-SEQ-NO.
 17489     MOVE 'STAT'                 TO FILE-SWITCH.
 17490
 17491     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17492
 17493     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17494     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17495
 17496     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17497        GO TO 7020-BYPASS-BENEFIT.
 17498
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 335
* EL156.cbl
 17499     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17500     MOVE '4'                    TO CNTL-REC-TYPE.
 17501     MOVE +0                     TO CNTL-SEQ-NO.
 17502     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17503     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17504     MOVE 'BENE'                 TO FILE-SWITCH.
 17505
 17506     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17507
 17508     IF NO-BENEFIT-FOUND
 17509        GO TO 7020-BYPASS-BENEFIT.
 17510
 17511     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17512     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17513     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17514
 17515 7020-BYPASS-BENEFIT.
 17516
 17517*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17518*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17519*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17520
 17521     move zeros                  to PI-MAX-BENEFIT-AMT
 17522     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17523     move cm-ah-orig-term        to pi-ah-term
 17524     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17525     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17526          'G' and 'F'
 17527         GO TO 7021-GO-TO-LIFE.
 17528
 17529     IF (PI-COMPANY-ID = 'DCC')
 17530        and (acct-found)
 17531        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17532        PERFORM 0900-GET-DDF-limits
 17533                                 THRU 0900-EXIT
 17534        IF PDEF-FOUND
 17535           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17536              (P1 > +8)
 17537              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17538           END-PERFORM
 17539           IF P1 < +9
 17540              if pd-ben-pct (p1) not numeric
 17541                 move zeros      to pd-ben-pct (p1)
 17542              end-if
 17543              if pd-ben-pct (p1) = zeros
 17544                 move +1         to ws-work-ben-pct
 17545              else
 17546                 move pd-ben-pct (p1)
 17547                                 to ws-work-ben-pct
 17548              end-if
 17549              compute cm-ah-benefit-amt =
 17550                 cm-ah-benefit-amt * ws-work-ben-pct
 17551              move pd-max-amt (p1) to pi-max-benefit-amt
 17552           END-IF
 17553        END-IF
 17554     end-if
 17555     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17556     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 336
* EL156.cbl
 17557     if (pi-max-benefit-amt not = zeros)
 17558        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17559        move pi-max-benefit-amt  to beneo
 17560     else
 17561        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17562     end-if
 17563     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17564     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17565                                    CP-ORIGINAL-TERM.
 17566     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17567
 17568*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17569*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17570*    ELSE
 17571         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17572
 17573     MOVE ' '                    TO DC-OPTION-CODE.
 17574     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17575     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17576
 17577     IF PI-COMPANY-ID = 'DMD'
 17578         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17579         GO TO 7023-BYPASS-REMAINING-TERM.
 17580
 17581     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17582     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17583     GO TO 7022-AROUND-LIFE.
 17584
 17585 7021-GO-TO-LIFE.
 17586
 17587     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17588     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17589     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17590                                    CP-ORIGINAL-TERM.
 17591     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17592     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17593     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17594     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17595
 17596     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17597         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17598     ELSE
 17599         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17600
 17601     MOVE ' '                    TO DC-OPTION-CODE.
 17602     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17603     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17604
 17605 7022-AROUND-LIFE.
 17606
 17607     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17608     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17609     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17610     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17611     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17612     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17613     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17614
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 337
* EL156.cbl
 17615     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17616
 17617     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17618        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17619           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17620
 17621     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17622        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17623           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17624
 17625 7023-BYPASS-REMAINING-TERM.
 17626     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17627       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17628          MOVE ZEROS                  TO BENEO
 17629       ELSE
 17630          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17631          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17632          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17633          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17634          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17635          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17636          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17637          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17638          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17639          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17640          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17641          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17642          IF (PI-COMPANY-ID = 'DCC')
 17643             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17644             PERFORM 0900-GET-DDF-limits
 17645                                 THRU 0900-EXIT
 17646             IF PDEF-FOUND
 17647                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17648                   (P1 > +8)
 17649                   OR (PD-PROD-CODE (P1) = 'L')
 17650                END-PERFORM
 17651                IF P1 < +9
 17652                   MOVE PD-MAX-AMT (P1)
 17653                                 TO CP-R-MAX-TOT-BEN
 17654                END-IF
 17655             END-IF
 17656          END-IF
 17657
 17658* EXEC CICS LINK
 17659*            PROGRAM  (LINK-REMAMT)
 17660*            COMMAREA (CALCULATION-PASS-AREA)
 17661*            LENGTH   (CP-COMM-LENGTH)
 17662*         END-EXEC
 17663*    MOVE '."C                   (   #00016220' TO DFHEIV0
 17664     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17666     MOVE X'2020233030303136323230' TO DFHEIV0(25:11)
 17667     CALL 'kxdfhei1' USING DFHEIV0,
 17668           LINK-REMAMT,
 17669           CALCULATION-PASS-AREA,
 17670           CP-COMM-LENGTH,
 17671           DFHEIV99,
 17672           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 338
* EL156.cbl
 17673           DFHEIV99,
 17674           DFHEIV99
 17675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17676          MOVE CP-REMAINING-AMT       TO BENEO
 17677       end-if
 17678     end-if
 17679     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17680     MOVE +95                    TO TRLR-SEQ-NO
 17681
 17682* EXEC CICS READ
 17683*       DATASET  ('ELTRLR')
 17684*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17685*       RIDFLD   (ELTRLR-KEY)
 17686*       RESP     (WS-RESPONSE)
 17687*    END-EXEC
 17688     MOVE 'ELTRLR' TO DFHEIV1
 17689*    MOVE '&"S        E          (  N#00016230' TO DFHEIV0
 17690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17692     MOVE X'204E233030303136323330' TO DFHEIV0(25:11)
 17693     CALL 'kxdfhei1' USING DFHEIV0,
 17694           DFHEIV1,
 17695           DFHEIV20,
 17696           DFHEIV99,
 17697           ELTRLR-KEY,
 17698           DFHEIV99,
 17699           DFHEIV99,
 17700           DFHEIV99
 17701     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17702         DFHEIV20
 17703     MOVE EIBRESP  TO WS-RESPONSE
 17704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17705
 17706     if ws-resp-normal
 17707        perform varying s1 from +1 by +1 until
 17708           at-note-error-no (s1) = spaces
 17709           move at-note-error-no (s1)
 17710                                 to emi-error
 17711           if at-note-error-no (s1) = '1653'
 17712              evaluate true
 17713                 when cl-claim-type = 'L'
 17714                    move '  LF  '
 17715                                 to emi-claim-type
 17716                 when cl-claim-type = 'I'
 17717                    move '  IU  '
 17718                                 to emi-claim-type
 17719                 when cl-claim-type = 'F'
 17720                    move ' FMLA '
 17721                                 to emi-claim-type
 17722                 when other
 17723                    move '  AH  '
 17724                                 to emi-claim-type
 17725              end-evaluate
 17726           end-if
 17727           PERFORM 9900-ERROR-FORMAT
 17728                                 THRU 9900-EXIT
 17729        end-perform
 17730     end-if
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 339
* EL156.cbl
 17731     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17732         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17733            WS-LF-COVERAGE-TYPE = 'P'
 17734             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17735                                        CM-LF-ITD-DEATH-AMT
 17736             MOVE WS-REMAINING-AMT  TO  BENEO.
 17737
 17738     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17739     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17740     MOVE WS-TERMS               TO TERMSO.
 17741
 17742     IF WS-STATUS = '6' OR '7' OR '8'
 17743         MOVE AL-SABOF           TO CRTSTATA.
 17744
 17745     IF WS-STATUS = '1' OR '4'
 17746        IF CP-REMAINING-TERM-3 = ZEROS
 17747           MOVE 'EXPIRED'        TO CRTSTATO
 17748        ELSE
 17749           MOVE 'ACTIVE  '       TO CRTSTATO.
 17750
 17751     IF WS-STATUS = '2'
 17752         MOVE 'PEND    '         TO CRTSTATO.
 17753
 17754     IF WS-STATUS = '3'
 17755         MOVE 'RESTORE '         TO CRTSTATO.
 17756
 17757     IF WS-STATUS = '5'
 17758         MOVE 'REISSUE '         TO CRTSTATO.
 17759
 17760     IF WS-STATUS = '6'
 17761         MOVE 'LMP DIS'          TO CRTSTATO.
 17762
 17763     IF WS-STATUS = '7'
 17764         MOVE 'DEATH'            TO CRTSTATO.
 17765
 17766     IF WS-STATUS = '8'
 17767         MOVE 'CANCEL'           TO CRTSTATO.
 17768
 17769     IF WS-STATUS = '9'
 17770         MOVE 'RE-ONLY '         TO CRTSTATO.
 17771
 17772     IF WS-STATUS = 'V'
 17773         MOVE 'VOID  '           TO CRTSTATO.
 17774
 17775     IF WS-STATUS = 'D'
 17776         MOVE 'DECLINE '         TO CRTSTATO.
 17777
 17778     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17779         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17780         MOVE '5'                TO CNTL-REC-TYPE
 17781     ELSE
 17782         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17783         MOVE '4'                TO CNTL-REC-TYPE.
 17784
 17785     MOVE '** NONE **'           TO COVERO.
 17786     MOVE AL-SABON               TO COVERA.
 17787
 17788     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 340
* EL156.cbl
 17789         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17790             MOVE CM-BENEFICIARY TO LOANNOO
 17791             MOVE AL-UANON       TO LOANNOA.
 17792
 17793     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17794        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17795        MOVE +91                 TO  TRLR-SEQ-NO
 17796
 17797* EXEC CICS READ
 17798*           DATASET  ('ELTRLR')
 17799*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17800*           RIDFLD   (ELTRLR-KEY)
 17801*           RESP     (WS-RESPONSE)
 17802*       END-EXEC
 17803     MOVE 'ELTRLR' TO DFHEIV1
 17804*    MOVE '&"S        E          (  N#00016327' TO DFHEIV0
 17805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17807     MOVE X'204E233030303136333237' TO DFHEIV0(25:11)
 17808     CALL 'kxdfhei1' USING DFHEIV0,
 17809           DFHEIV1,
 17810           DFHEIV20,
 17811           DFHEIV99,
 17812           ELTRLR-KEY,
 17813           DFHEIV99,
 17814           DFHEIV99,
 17815           DFHEIV99
 17816     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17817         DFHEIV20
 17818     MOVE EIBRESP  TO WS-RESPONSE
 17819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17820
 17821        IF WS-RESP-NORMAL
 17822           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17823        ELSE
 17824           MOVE SPACES           TO  LOANNOO
 17825        END-IF
 17826*052506
 17827*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17828*052506
 17829     END-IF
 17830
 17831     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17832        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17833
 17834     IF WS-BEN-CD = ZEROS
 17835         GO TO 7050-SHOW-CONTINUE.
 17836
 17837     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17838     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17839     MOVE +0                     TO CNTL-SEQ-NO.
 17840     MOVE 'BENE'                 TO FILE-SWITCH.
 17841
 17842     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17843
 17844     IF BENEFIT-FOUND
 17845         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17846         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 341
* EL156.cbl
 17847         MOVE AL-SANON                    TO COVERA.
 17848
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 342
* EL156.cbl
 17850 7050-SHOW-CONTINUE.
 17851
 17852     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17853        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17854            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17855     END-IF
 17856
 17857     IF PI-COMPANY-ID = 'DMD'
 17858         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17859
 17860     MOVE -1                     TO PMTTYPEL.
 17861     GO TO 8100-SEND-INITIAL-MAP.
 17862
 17863 7100-SHOW-RECORD-NOT-FOUND.
 17864     IF FILE-SWITCH = 'MSTR'
 17865         MOVE ER-0204            TO EMI-ERROR.
 17866
 17867     IF FILE-SWITCH = 'CERT'
 17868         MOVE ER-0206            TO EMI-ERROR.
 17869
 17870     IF FILE-SWITCH = 'STAT'
 17871         MOVE ER-0149            TO EMI-ERROR.
 17872
 17873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17874
 17875     MOVE -1                     TO PMTTYPEL.
 17876     GO TO 8100-SEND-INITIAL-MAP
 17877
 17878     .
 17879 7110-BUILD-PMT-TRLR.
 17880     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17881     MOVE +51                    TO TRLR-SEQ-NO
 17882
 17883* EXEC CICS READ
 17884*        DATASET  ('ELTRLR')
 17885*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17886*        RIDFLD   (ELTRLR-KEY)
 17887*        RESP     (WS-RESPONSE)
 17888*    END-EXEC
 17889     MOVE 'ELTRLR' TO DFHEIV1
 17890*    MOVE '&"S        E          (  N#00016395' TO DFHEIV0
 17891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17893     MOVE X'204E233030303136333935' TO DFHEIV0(25:11)
 17894     CALL 'kxdfhei1' USING DFHEIV0,
 17895           DFHEIV1,
 17896           DFHEIV20,
 17897           DFHEIV99,
 17898           ELTRLR-KEY,
 17899           DFHEIV99,
 17900           DFHEIV99,
 17901           DFHEIV99
 17902     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17903         DFHEIV20
 17904     MOVE EIBRESP  TO WS-RESPONSE
 17905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17906     IF WS-RESP-NORMAL
 17907        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 343
* EL156.cbl
 17908     END-IF
 17909     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17910
 17911* EXEC CICS GETMAIN
 17912*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17913*         LENGTH    (200)
 17914*         INITIMG   (GETMAIN-SPACE)
 17915*     END-EXEC
 17916     MOVE 200
 17917       TO DFHEIV11
 17918*    MOVE ',"IL                  $   #00016405' TO DFHEIV0
 17919     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17921     MOVE X'2020233030303136343035' TO DFHEIV0(25:11)
 17922     CALL 'kxdfhei1' USING DFHEIV0,
 17923           DFHEIV20,
 17924           DFHEIV11,
 17925           GETMAIN-SPACE
 17926     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17927         DFHEIV20
 17928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17929     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17930                                    AT-PREV-PAID-THRU-DT
 17931     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17932     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17933     MOVE 'AT'                   TO AT-RECORD-ID
 17934     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17935     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17936     MOVE '2'                    TO AT-TRAILER-TYPE
 17937     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17938                                    AT-PAYMENT-LAST-MAINT-DT
 17939     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17940                                    AT-PAYMENT-LAST-UPDATED-BY
 17941     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17942     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17943     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17944     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17945     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17946     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17947     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17948     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17949     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17950     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17951     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17952     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17953     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17954     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17955     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17956     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17957                                    AT-TO-BE-WRITTEN-DT
 17958     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17959                                    AT-CHECK-QUE-SEQUENCE
 17960                                    AT-ADDL-RESERVE
 17961     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17962                                    AT-VOID-SELECT-DT
 17963                                    AT-VOID-ACCEPT-DT
 17964                                    AT-VOID-DT
 17965                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 344
* EL156.cbl
 17966                                    AT-INT-PMT-SELECT-DT
 17967     MOVE ZEROS                  TO AT-DAILY-RATE
 17968                                    AT-ELIMINATION-DAYS
 17969     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17970*    EXEC CICS HANDLE CONDITION
 17971*        DUPREC    (7120-DUPREC)
 17972*    END-EXEC
 17973     .
 17974 7115-WRITE-INT-TRLR.
 17975
 17976* EXEC CICS WRITE
 17977*         DATASET       ('ELTRLR')
 17978*         FROM          (ACTIVITY-TRAILERS)
 17979*         RIDFLD        (AT-CONTROL-PRIMARY)
 17980*         RESP          (WS-RESPONSE)
 17981*     END-EXEC
 17982     MOVE LENGTH OF
 17983      ACTIVITY-TRAILERS
 17984       TO DFHEIV11
 17985     MOVE 'ELTRLR' TO DFHEIV1
 17986*    MOVE '&$ L                  ''  N#00016456' TO DFHEIV0
 17987     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17989     MOVE X'204E233030303136343536' TO DFHEIV0(25:11)
 17990     CALL 'kxdfhei1' USING DFHEIV0,
 17991           DFHEIV1,
 17992           ACTIVITY-TRAILERS,
 17993           DFHEIV11,
 17994           AT-CONTROL-PRIMARY,
 17995           DFHEIV99,
 17996           DFHEIV99
 17997     MOVE EIBRESP  TO WS-RESPONSE
 17998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17999      IF WS-RESP-DUPREC
 18000         GO TO 7120-DUPREC
 18001      END-IF
 18002     GO TO 7130-EXIT
 18003     .
 18004 7120-DUPREC.
 18005     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18006     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18007     GO TO 7115-WRITE-INT-TRLR
 18008     .
 18009 7130-EXIT.
 18010      EXIT.
 18011 7140-BUILD-NOTE-TRLR.
 18012
 18013
 18014* EXEC CICS GETMAIN
 18015*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18016*         LENGTH    (200)
 18017*         INITIMG   (GETMAIN-SPACE)
 18018*     END-EXEC
 18019     MOVE 200
 18020       TO DFHEIV11
 18021*    MOVE ',"IL                  $   #00016476' TO DFHEIV0
 18022     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 345
* EL156.cbl
 18024     MOVE X'2020233030303136343736' TO DFHEIV0(25:11)
 18025     CALL 'kxdfhei1' USING DFHEIV0,
 18026           DFHEIV20,
 18027           DFHEIV11,
 18028           GETMAIN-SPACE
 18029     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18030         DFHEIV20
 18031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18032     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18033     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18034     MOVE 'AT'                   TO AT-RECORD-ID
 18035     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18036     MOVE '6'                    TO AT-TRAILER-TYPE
 18037     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18038                                    AT-GEN-INFO-LAST-MAINT-DT
 18039     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18040                                    AT-GEN-INFO-LAST-UPDATED-BY
 18041     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18042     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18043     .
 18044 7150-WRITE.
 18045
 18046* EXEC CICS HANDLE CONDITION
 18047*        DUPREC    (7160-DUPREC)
 18048*    END-EXEC
 18049*    MOVE '"$%                   ! : #00016494' TO DFHEIV0
 18050     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18052     MOVE X'3A20233030303136343934' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0
 18054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18055
 18056* EXEC CICS WRITE
 18057*         DATASET     ('ELTRLR')
 18058*         FROM        (ACTIVITY-TRAILERS)
 18059*         RIDFLD      (AT-CONTROL-PRIMARY)
 18060*         RESP        (WS-RESPONSE)
 18061*     END-EXEC
 18062     MOVE LENGTH OF
 18063      ACTIVITY-TRAILERS
 18064       TO DFHEIV11
 18065     MOVE 'ELTRLR' TO DFHEIV1
 18066*    MOVE '&$ L                  ''  N#00016497' TO DFHEIV0
 18067     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18068     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18069     MOVE X'204E233030303136343937' TO DFHEIV0(25:11)
 18070     CALL 'kxdfhei1' USING DFHEIV0,
 18071           DFHEIV1,
 18072           ACTIVITY-TRAILERS,
 18073           DFHEIV11,
 18074           AT-CONTROL-PRIMARY,
 18075           DFHEIV99,
 18076           DFHEIV99
 18077     MOVE EIBRESP  TO WS-RESPONSE
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18079      IF WS-RESP-DUPREC
 18080         GO TO 7160-DUPREC
 18081      END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 346
* EL156.cbl
 18082     GO TO 7170-EXIT
 18083     .
 18084 7160-DUPREC.
 18085     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18086     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18087     GO TO 7150-WRITE
 18088     .
 18089 7170-EXIT.
 18090      EXIT.
 18091
 18092 7180-ADD-CERT-NOTE.
 18093*ADD CERT NOTE FOR SC NP+6
 18094
 18095
 18096* EXEC CICS GETMAIN
 18097*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18098*         LENGTH    (150)
 18099*         INITIMG   (GETMAIN-SPACE)
 18100*     END-EXEC.
 18101     MOVE 150
 18102       TO DFHEIV11
 18103*    MOVE ',"IL                  $   #00016519' TO DFHEIV0
 18104     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18105     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18106     MOVE X'2020233030303136353139' TO DFHEIV0(25:11)
 18107     CALL 'kxdfhei1' USING DFHEIV0,
 18108           DFHEIV20,
 18109           DFHEIV11,
 18110           GETMAIN-SPACE
 18111     SET ADDRESS OF CERT-NOTE-FILE TO
 18112         DFHEIV20
 18113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18114
 18115
 18116     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18117     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18118     MOVE +1                     TO WRK-NOTE-SEQ.
 18119     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18120     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18121     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18122     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18123     MOVE CL-CERT-STATE          TO CZ-STATE.
 18124     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18125     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18126     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18127     MOVE '2'                    TO CZ-RECORD-TYPE.
 18128     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18129     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18130     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18131     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18132     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18133     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18134     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18135     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18136     IF PI-COMPANY-ID = 'AHL'
 18137        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18138           CONTINUE
 18139        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 347
* EL156.cbl
 18140           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18141              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18142           ELSE
 18143              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18144           END-IF
 18145        END-IF
 18146     END-IF
 18147     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18148     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18149
 18150 7181-WRITE.
 18151
 18152
 18153* EXEC CICS WRITE
 18154*         DATASET     ('ERCNOT')
 18155*         FROM        (CERT-NOTE-FILE)
 18156*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18157*         RESP        (WS-RESPONSE)
 18158*    END-EXEC.
 18159     MOVE LENGTH OF
 18160      CERT-NOTE-FILE
 18161       TO DFHEIV11
 18162     MOVE 'ERCNOT' TO DFHEIV1
 18163*    MOVE '&$ L                  ''  N#00016561' TO DFHEIV0
 18164     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18166     MOVE X'204E233030303136353631' TO DFHEIV0(25:11)
 18167     CALL 'kxdfhei1' USING DFHEIV0,
 18168           DFHEIV1,
 18169           CERT-NOTE-FILE,
 18170           DFHEIV11,
 18171           CZ-CONTROL-PRIMARY,
 18172           DFHEIV99,
 18173           DFHEIV99
 18174     MOVE EIBRESP  TO WS-RESPONSE
 18175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18176
 18177
 18178     IF WS-RESP-DUPREC
 18179         GO TO 7182-DUPREC
 18180     END-IF.
 18181
 18182     SET CERT-NOTE-ADDED TO TRUE.
 18183
 18184     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18185         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18186     END-IF.
 18187
 18188     GO TO 7189-EXIT.
 18189
 18190 7182-DUPREC.
 18191
 18192     ADD +1                      TO  WRK-NOTE-SEQ.
 18193     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18194     GO TO 7181-WRITE.
 18195
 18196 7189-EXIT.
 18197      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 348
* EL156.cbl
 18198
 18199 7190-ADD-ORIG-NOTE.
 18200
 18201
 18202* EXEC CICS GETMAIN
 18203*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18204*         LENGTH    (150)
 18205*         INITIMG   (GETMAIN-SPACE)
 18206*     END-EXEC.
 18207     MOVE 150
 18208       TO DFHEIV11
 18209*    MOVE ',"IL                  $   #00016591' TO DFHEIV0
 18210     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18212     MOVE X'2020233030303136353931' TO DFHEIV0(25:11)
 18213     CALL 'kxdfhei1' USING DFHEIV0,
 18214           DFHEIV20,
 18215           DFHEIV11,
 18216           GETMAIN-SPACE
 18217     SET ADDRESS OF CERT-NOTE-FILE TO
 18218         DFHEIV20
 18219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18220
 18221
 18222     ADD +1                      TO WRK-NOTE-SEQ.
 18223     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18224     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18225     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18226     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18227     MOVE CL-CERT-STATE          TO CZ-STATE.
 18228     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18229     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18230     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18231     MOVE '2'                    TO CZ-RECORD-TYPE.
 18232     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18233     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18234     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18235     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18236     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18237     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18238
 18239 7191-WRITE.
 18240
 18241
 18242* EXEC CICS WRITE
 18243*         DATASET     ('ERCNOT')
 18244*         FROM        (CERT-NOTE-FILE)
 18245*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18246*         RESP        (WS-RESPONSE)
 18247*    END-EXEC.
 18248     MOVE LENGTH OF
 18249      CERT-NOTE-FILE
 18250       TO DFHEIV11
 18251     MOVE 'ERCNOT' TO DFHEIV1
 18252*    MOVE '&$ L                  ''  N#00016616' TO DFHEIV0
 18253     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18255     MOVE X'204E233030303136363136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 349
* EL156.cbl
 18256     CALL 'kxdfhei1' USING DFHEIV0,
 18257           DFHEIV1,
 18258           CERT-NOTE-FILE,
 18259           DFHEIV11,
 18260           CZ-CONTROL-PRIMARY,
 18261           DFHEIV99,
 18262           DFHEIV99
 18263     MOVE EIBRESP  TO WS-RESPONSE
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18265
 18266
 18267     IF WS-RESP-DUPREC
 18268         GO TO 7192-DUPREC
 18269     END-IF.
 18270
 18271     GO TO 7199-EXIT.
 18272
 18273 7192-DUPREC.
 18274
 18275     ADD +1                      TO  WRK-NOTE-SEQ.
 18276     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18277     GO TO 7191-WRITE.
 18278
 18279 7199-EXIT.
 18280      EXIT.
 18281 7200-FIND-BENEFIT.
 18282     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18283
 18284
 18285* EXEC CICS HANDLE CONDITION
 18286*        ENDFILE(7200-EXIT)
 18287*        NOTFND(7200-EXIT)
 18288*    END-EXEC.
 18289*    MOVE '"$''I                  ! ; #00016640' TO DFHEIV0
 18290     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18292     MOVE X'3B20233030303136363430' TO DFHEIV0(25:11)
 18293     CALL 'kxdfhei1' USING DFHEIV0
 18294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18295
 18296
 18297
 18298* EXEC CICS READ
 18299*        DATASET('ELCNTL')
 18300*        SET(ADDRESS OF CONTROL-FILE)
 18301*        RIDFLD(ELCNTL-KEY)
 18302*        GTEQ
 18303*    END-EXEC.
 18304     MOVE 'ELCNTL' TO DFHEIV1
 18305*    MOVE '&"S        G          (   #00016645' TO DFHEIV0
 18306     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18308     MOVE X'2020233030303136363435' TO DFHEIV0(25:11)
 18309     CALL 'kxdfhei1' USING DFHEIV0,
 18310           DFHEIV1,
 18311           DFHEIV20,
 18312           DFHEIV99,
 18313           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 350
* EL156.cbl
 18314           DFHEIV99,
 18315           DFHEIV99,
 18316           DFHEIV99
 18317     SET ADDRESS OF CONTROL-FILE TO
 18318         DFHEIV20
 18319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18320
 18321
 18322     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18323        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18324           GO TO 7200-EXIT.
 18325
 18326     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18327         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18328            ((SUB-1 > 8) OR
 18329            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18330
 18331     IF SUB-1 NOT = 9
 18332         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18333
 18334     GO TO 7200-EXIT.
 18335
 18336 7200-BENEFIT-DUMMY.
 18337
 18338 7200-DUMMY-EXIT.
 18339     EXIT.
 18340
 18341 7200-EXIT.
 18342     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 351
* EL156.cbl
 18344*052506
 18345*052506 7250-FIND-LETTER-TRLR.
 18346*052506     EXEC CICS HANDLE CONDITION
 18347*052506         ENDFILE  (7250-END)
 18348*052506         NOTFND   (7250-END)
 18349*052506     END-EXEC.
 18350*052506
 18351*052506     EXEC CICS STARTBR
 18352*052506         DATASET   ('ELTRLR')
 18353*052506         RIDFLD    (ELTRLR-KEY)
 18354*052506         GTEQ
 18355*052506     END-EXEC.
 18356*052506
 18357*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18358*052506
 18359*052506 7250-FIND-LOOP.
 18360*052506     EXEC CICS READNEXT
 18361*052506         DATASET   ('ELTRLR')
 18362*052506         RIDFLD    (ELTRLR-KEY)
 18363*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18364*052506     END-EXEC.
 18365*052506
 18366*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18367*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18368*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18369*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18370*052506        GO TO 7250-END
 18371*052506     END-IF.
 18372*052506
 18373*052506     IF AT-TRAILER-TYPE NOT = '4'
 18374*052506         GO TO 7250-FIND-LOOP
 18375*052506     END-IF.
 18376*052506
 18377*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18378*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18379*052506     END-IF.
 18380*052506
 18381*052506     GO TO 7250-FIND-LOOP.
 18382*052506
 18383*052506 7250-END.
 18384*052506
 18385*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18386*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18387*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18388*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18389*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18390*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18391*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18392*052506     END-IF.
 18393*052506
 18394*052506     EXEC CICS ENDBR
 18395*052506          DATASET    ('ELTRLR')
 18396*052506     END-EXEC.
 18397*052506
 18398*052506 7250-EXIT.
 18399*052506     EXIT.
 18400*052506     EJECT
 18401*052506
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 352
* EL156.cbl
 18402 7300-CHECK-AUTO-ACTIVITY.
 18403
 18404     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18405         NEXT SENTENCE
 18406     ELSE
 18407         GO TO 7399-EXIT.
 18408
 18409     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18410
 18411     IF WS-ACT-REC-FOUND-SW = 'N'
 18412         GO TO 7399-EXIT.
 18413
 18414     IF PI-ACTIVITY-CODE = 09
 18415         GO TO 7300-CONT-AUTO-ACTIVITY.
 18416
 18417     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18418        (PI-ACTIVITY-CODE = 11)
 18419         GO TO 7300-CONT-AUTO-ACTIVITY.
 18420
 18421     IF PI-PROVISIONAL-IND = 'P'
 18422         IF PI-PMTTYPE = '1'
 18423             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18424                 MOVE 'N'    TO  PI-RESET-SW
 18425                 GO TO 7399-EXIT.
 18426
 18427     IF PI-PMTTYPE = '1'
 18428         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18429             MOVE 'N'        TO  PI-RESET-SW
 18430             GO TO 7399-EXIT.
 18431
 18432     IF PI-PMTTYPE = '2' OR '3'
 18433         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18434             MOVE 'N'        TO  PI-RESET-SW
 18435             GO TO 7399-EXIT.
 18436
 18437     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18438         IF PI-PROVISIONAL-IND = 'P'
 18439             NEXT SENTENCE
 18440         ELSE
 18441             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18442
 18443 7300-CONT-AUTO-ACTIVITY.
 18444
 18445     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18446         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18447         MOVE '4'            TO DC-OPTION-CODE
 18448         MOVE +0             TO DC-ELAPSED-DAYS
 18449                                DC-ELAPSED-MONTHS
 18450         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18451         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18452         IF PI-USES-PAID-TO
 18453             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18454             IF NO-CONVERSION-ERROR
 18455                 MOVE +1     TO DC-ELAPSED-DAYS
 18456                 MOVE +0     TO DC-ELAPSED-MONTHS
 18457                 MOVE '6'    TO DC-OPTION-CODE
 18458                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18459                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 353
* EL156.cbl
 18460                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18461
 18462     IF PI-PFKEY-USED = DFHPF5
 18463         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18464         IF PI-USES-PAID-TO
 18465             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18466             MOVE +1                  TO DC-ELAPSED-DAYS
 18467             MOVE +0                  TO DC-ELAPSED-MONTHS
 18468             MOVE '6'                 TO DC-OPTION-CODE
 18469             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18470             IF NO-CONVERSION-ERROR
 18471                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18472
 18473     IF WS-CHK-THRU-DT < PI-EXP-DT
 18474         NEXT SENTENCE
 18475     ELSE
 18476         MOVE 03                     TO  WS-ACTIVITY-CODE
 18477         GO TO 7390-PROCESS-ACTIVITY.
 18478
 18479     IF PI-PROV-PMT
 18480         MOVE 09                     TO  WS-ACTIVITY-CODE
 18481     ELSE
 18482        IF PI-PMTTYPE = '1'
 18483            MOVE 02                  TO  WS-ACTIVITY-CODE
 18484        ELSE
 18485        IF PI-PMTTYPE = '2' OR '3'
 18486            MOVE 07                  TO  WS-ACTIVITY-CODE
 18487        ELSE
 18488        IF PI-PMTTYPE = '4'
 18489            MOVE 00                  TO  WS-ACTIVITY-CODE
 18490        ELSE
 18491            MOVE 'N'                 TO  PI-RESET-SW
 18492            GO TO 7399-EXIT.
 18493
 18494 7390-PROCESS-ACTIVITY.
 18495
 18496     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18497
 18498 7399-EXIT.
 18499     EXIT.
 18500
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 354
* EL156.cbl
 18502 7400-CHECK-AUTO-ACTIVITY.
 18503
 18504
 18505* EXEC CICS HANDLE CONDITION
 18506*        NOTFND   (7400-NOT-FOUND)
 18507*    END-EXEC.
 18508*    MOVE '"$I                   ! < #00016834' TO DFHEIV0
 18509     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18511     MOVE X'3C20233030303136383334' TO DFHEIV0(25:11)
 18512     CALL 'kxdfhei1' USING DFHEIV0
 18513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18514
 18515
 18516     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18517     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18518     MOVE SPACES                 TO  CNTL-ACCESS.
 18519     MOVE +0                     TO  CNTL-SEQ-NO.
 18520
 18521
 18522* EXEC CICS READ
 18523*        DATASET   ('ELCNTL')
 18524*        RIDFLD    (ELCNTL-KEY)
 18525*        SET       (ADDRESS OF CONTROL-FILE)
 18526*    END-EXEC.
 18527     MOVE 'ELCNTL' TO DFHEIV1
 18528*    MOVE '&"S        E          (   #00016843' TO DFHEIV0
 18529     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18531     MOVE X'2020233030303136383433' TO DFHEIV0(25:11)
 18532     CALL 'kxdfhei1' USING DFHEIV0,
 18533           DFHEIV1,
 18534           DFHEIV20,
 18535           DFHEIV99,
 18536           ELCNTL-KEY,
 18537           DFHEIV99,
 18538           DFHEIV99,
 18539           DFHEIV99
 18540     SET ADDRESS OF CONTROL-FILE TO
 18541         DFHEIV20
 18542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18543
 18544
 18545     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18546     GO TO 7400-EXIT.
 18547
 18548 7400-NOT-FOUND.
 18549     MOVE 'N'                        TO  PI-RESET-SW
 18550                                         WS-LETTER-SW
 18551                                         WS-ACT-REC-FOUND-SW.
 18552
 18553     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18554
 18555 7400-EXIT.
 18556     EXIT.
 18557
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 355
* EL156.cbl
 18559 7450-FORMAT-AUTO-LETTER.
 18560
 18561     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18562         MOVE 'Y'                    TO PI-RESET-SW
 18563         GO TO 7450-CONTINUE-PROCESS.
 18564
 18565     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18566
 18567     IF SUB > 9
 18568         SUBTRACT 9 FROM SUB
 18569         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18570     ELSE
 18571         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18572
 18573 7450-CONTINUE-PROCESS.
 18574
 18575     IF WS-ACTIVITY-CODE = ZEROS
 18576         MOVE 'N'                    TO  WS-LETTER-SW
 18577         GO TO 7450-EXIT.
 18578
 18579     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18580
 18581     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18582         MOVE 'N'                    TO  PI-RESET-SW
 18583                                         WS-LETTER-SW
 18584         GO TO 7450-EXIT.
 18585
 18586     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18587         MOVE 'N'                    TO  WS-LETTER-SW
 18588         GO TO 7450-EXIT.
 18589
 18590     MOVE 'Y'                        TO  WS-LETTER-SW.
 18591     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18592     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18593
 18594     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18595
 18596     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18597         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18598         MOVE '6'                    TO  DC-OPTION-CODE
 18599         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18600         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18601         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18602         IF NO-CONVERSION-ERROR
 18603             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18604         ELSE
 18605              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18606
 18607     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18608         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18609         MOVE '6'                    TO  DC-OPTION-CODE
 18610         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18611         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18612         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18613         IF NO-CONVERSION-ERROR
 18614             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18615         ELSE
 18616             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 356
* EL156.cbl
 18617
 18618 7450-EXIT.
 18619     EXIT.
 18620
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 357
* EL156.cbl
 18622 7500-RESET-AUTO-ACTIVITY.
 18623
 18624     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18625     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18626     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18627     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18628     MOVE +100                   TO  TRLR-SEQ-NO.
 18629
 18630 7500-STARTBR-TRLR.
 18631
 18632
 18633* EXEC CICS HANDLE CONDITION
 18634*        ENDFILE  (7590-END)
 18635*        NOTFND   (7590-END)
 18636*    END-EXEC.
 18637*    MOVE '"$''I                  ! = #00016936' TO DFHEIV0
 18638     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18640     MOVE X'3D20233030303136393336' TO DFHEIV0(25:11)
 18641     CALL 'kxdfhei1' USING DFHEIV0
 18642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18643
 18644
 18645
 18646* EXEC CICS STARTBR
 18647*        DATASET   ('ELTRLR')
 18648*        RIDFLD    (ELTRLR-KEY)
 18649*        GTEQ
 18650*    END-EXEC.
 18651     MOVE 'ELTRLR' TO DFHEIV1
 18652     MOVE 0
 18653       TO DFHEIV11
 18654*    MOVE '&,         G          &   #00016941' TO DFHEIV0
 18655     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18656     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18657     MOVE X'2020233030303136393431' TO DFHEIV0(25:11)
 18658     CALL 'kxdfhei1' USING DFHEIV0,
 18659           DFHEIV1,
 18660           ELTRLR-KEY,
 18661           DFHEIV99,
 18662           DFHEIV11,
 18663           DFHEIV99
 18664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18665
 18666
 18667     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18668
 18669 7500-READ-NEXT.
 18670
 18671
 18672* EXEC CICS READNEXT
 18673*        DATASET   ('ELTRLR')
 18674*        RIDFLD    (ELTRLR-KEY)
 18675*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18676*    END-EXEC.
 18677     MOVE 'ELTRLR' TO DFHEIV1
 18678     MOVE 0
 18679       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 358
* EL156.cbl
 18680*    MOVE '&.S                   )   #00016951' TO DFHEIV0
 18681     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18682     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18683     MOVE X'2020233030303136393531' TO DFHEIV0(25:11)
 18684     CALL 'kxdfhei1' USING DFHEIV0,
 18685           DFHEIV1,
 18686           DFHEIV20,
 18687           DFHEIV99,
 18688           ELTRLR-KEY,
 18689           DFHEIV99,
 18690           DFHEIV11,
 18691           DFHEIV99,
 18692           DFHEIV99
 18693     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18694         DFHEIV20
 18695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18696
 18697
 18698     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18699        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18700        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18701        PI-CERT-NO    NOT = TRLR-CERT-NO
 18702         GO TO 7590-END.
 18703
 18704     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18705         GO TO 7500-READ-NEXT.
 18706
 18707     IF AT-TRAILER-TYPE NOT = '4'
 18708         GO TO 7500-READ-NEXT.
 18709
 18710     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18711         GO TO 7500-READ-NEXT.
 18712
 18713     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18714        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18715         GO TO 7500-READ-NEXT.
 18716
 18717     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18718        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18719        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18720         GO TO 7500-READ-NEXT.
 18721
 18722     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18723                         AND
 18724        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18725                         AND
 18726        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18727            GO TO 7500-READ-NEXT.
 18728
 18729     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18730
 18731
 18732* EXEC CICS ENDBR
 18733*        DATASET   ('ELTRLR')
 18734*    END-EXEC.
 18735     MOVE 'ELTRLR' TO DFHEIV1
 18736     MOVE 0
 18737       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 359
* EL156.cbl
 18738*    MOVE '&2                    $   #00016990' TO DFHEIV0
 18739     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18740     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18741     MOVE X'2020233030303136393930' TO DFHEIV0(25:11)
 18742     CALL 'kxdfhei1' USING DFHEIV0,
 18743           DFHEIV1,
 18744           DFHEIV11,
 18745           DFHEIV99
 18746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18747
 18748
 18749     MOVE 'N'                        TO  WS-BROWSE-SW.
 18750
 18751
 18752* EXEC CICS READ
 18753*        DATASET   ('ELTRLR')
 18754*        RIDFLD    (ELTRLR-KEY)
 18755*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18756*        UPDATE
 18757*    END-EXEC.
 18758     MOVE 'ELTRLR' TO DFHEIV1
 18759*    MOVE '&"S        EU         (   #00016996' TO DFHEIV0
 18760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18762     MOVE X'2020233030303136393936' TO DFHEIV0(25:11)
 18763     CALL 'kxdfhei1' USING DFHEIV0,
 18764           DFHEIV1,
 18765           DFHEIV20,
 18766           DFHEIV99,
 18767           ELTRLR-KEY,
 18768           DFHEIV99,
 18769           DFHEIV99,
 18770           DFHEIV99
 18771     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18772         DFHEIV20
 18773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18774
 18775
 18776     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18777
 18778     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18779         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18780     ELSE
 18781         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18782             NEXT SENTENCE
 18783         ELSE
 18784             GO TO 7500-REWRITE-TRLR.
 18785
 18786     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18787
 18788     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18789     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18790     MOVE '1'                        TO  ARCH-REC-TYPE.
 18791     MOVE +0                         TO  ARCH-SEQ.
 18792
 18793     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18794
 18795 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 360
* EL156.cbl
 18796
 18797
 18798* EXEC CICS REWRITE
 18799*        DATASET   ('ELTRLR')
 18800*        FROM      (ACTIVITY-TRAILERS)
 18801*    END-EXEC.
 18802     MOVE LENGTH OF
 18803      ACTIVITY-TRAILERS
 18804       TO DFHEIV11
 18805     MOVE 'ELTRLR' TO DFHEIV1
 18806*    MOVE '&& L                  %   #00017024' TO DFHEIV0
 18807     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18809     MOVE X'2020233030303137303234' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0,
 18811           DFHEIV1,
 18812           ACTIVITY-TRAILERS,
 18813           DFHEIV11,
 18814           DFHEIV99
 18815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18816
 18817
 18818     GO TO 7500-STARTBR-TRLR.
 18819
 18820 7590-END.
 18821
 18822     IF WS-BROWSE-SW = 'Y'
 18823         MOVE 'N'                    TO  WS-BROWSE-SW
 18824
 18825* EXEC CICS ENDBR
 18826*            DATASET   ('ELTRLR')
 18827*        END-EXEC.
 18828     MOVE 'ELTRLR' TO DFHEIV1
 18829     MOVE 0
 18830       TO DFHEIV11
 18831*    MOVE '&2                    $   #00017035' TO DFHEIV0
 18832     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303137303335' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           DFHEIV1,
 18837           DFHEIV11,
 18838           DFHEIV99
 18839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18840
 18841
 18842 7599-EXIT.
 18843     EXIT.
 18844
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 361
* EL156.cbl
 18846 7600-READ-ARCH-UPDATE.
 18847
 18848
 18849* EXEC CICS HANDLE CONDITION
 18850*        NOTFND   (7699-EXIT)
 18851*    END-EXEC.
 18852*    MOVE '"$I                   ! > #00017045' TO DFHEIV0
 18853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18855     MOVE X'3E20233030303137303435' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0
 18857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18858
 18859
 18860
 18861* EXEC CICS READ
 18862*        DATASET   ('ELARCH')
 18863*        RIDFLD    (ELARCH-KEY)
 18864*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18865*        UPDATE
 18866*    END-EXEC.
 18867     MOVE 'ELARCH' TO DFHEIV1
 18868*    MOVE '&"S        EU         (   #00017049' TO DFHEIV0
 18869     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18870     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18871     MOVE X'2020233030303137303439' TO DFHEIV0(25:11)
 18872     CALL 'kxdfhei1' USING DFHEIV0,
 18873           DFHEIV1,
 18874           DFHEIV20,
 18875           DFHEIV99,
 18876           ELARCH-KEY,
 18877           DFHEIV99,
 18878           DFHEIV99,
 18879           DFHEIV99
 18880     SET ADDRESS OF LETTER-ARCHIVE TO
 18881         DFHEIV20
 18882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18883
 18884
 18885     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18886
 18887
 18888* EXEC CICS REWRITE
 18889*        DATASET   ('ELARCH')
 18890*        FROM      (LETTER-ARCHIVE)
 18891*    END-EXEC.
 18892     MOVE LENGTH OF
 18893      LETTER-ARCHIVE
 18894       TO DFHEIV11
 18895     MOVE 'ELARCH' TO DFHEIV1
 18896*    MOVE '&& L                  %   #00017058' TO DFHEIV0
 18897     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18898     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18899     MOVE X'2020233030303137303538' TO DFHEIV0(25:11)
 18900     CALL 'kxdfhei1' USING DFHEIV0,
 18901           DFHEIV1,
 18902           LETTER-ARCHIVE,
 18903           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 362
* EL156.cbl
 18904           DFHEIV99
 18905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18906
 18907
 18908 7699-EXIT.
 18909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 363
* EL156.cbl
 18911 7700-GET-DCT.
 18912
 18913     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18914     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18915     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18916     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18917                                    PI-MAX-BENEFIT-AMT
 18918                                    PI-MAX-BENEFIT-PYMT
 18919                                    PI-MIN-PAYMENT-AMT
 18920                                    PI-TIME-OF-LOSS-BAL.
 18921
 18922
 18923* EXEC CICS HANDLE CONDITION
 18924*         NOTFND (5300-NOTE-NOT-FOUND)
 18925*     END-EXEC.
 18926*    MOVE '"$I                   ! ? #00017077' TO DFHEIV0
 18927     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18929     MOVE X'3F20233030303137303737' TO DFHEIV0(25:11)
 18930     CALL 'kxdfhei1' USING DFHEIV0
 18931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18932
 18933
 18934
 18935* EXEC CICS READ
 18936*         DATASET('ERNOTE')
 18937*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18938*         RIDFLD (W-NOTE-KEY)
 18939*     END-EXEC.
 18940     MOVE 'ERNOTE' TO DFHEIV1
 18941*    MOVE '&"S        E          (   #00017081' TO DFHEIV0
 18942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18944     MOVE X'2020233030303137303831' TO DFHEIV0(25:11)
 18945     CALL 'kxdfhei1' USING DFHEIV0,
 18946           DFHEIV1,
 18947           DFHEIV20,
 18948           DFHEIV99,
 18949           W-NOTE-KEY,
 18950           DFHEIV99,
 18951           DFHEIV99,
 18952           DFHEIV99
 18953     SET ADDRESS OF CERTIFICATE-NOTE TO
 18954         DFHEIV20
 18955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18956
 18957
 18958     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18959     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18960     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18961     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18962     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18963
 18964     IF PI-PAYEE-TYPE NOT = 'B'
 18965         GO TO 7700-EXIT.
 18966
 18967     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18968     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 364
* EL156.cbl
 18969     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18970
 18971     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18972         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18973     ELSE
 18974         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18975
 18976     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18977     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18978     MOVE 'DLO006'               TO PGM-NAME.
 18979
 18980
 18981* EXEC CICS LINK
 18982*        PROGRAM    (PGM-NAME)
 18983*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18984*        LENGTH     (DCT-RCRD-LENGTH)
 18985*    END-EXEC.
 18986*    MOVE '."C                   (   #00017109' TO DFHEIV0
 18987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18989     MOVE X'2020233030303137313039' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0,
 18991           PGM-NAME,
 18992           DCT-COMMUNICATION-AREA,
 18993           DCT-RCRD-LENGTH,
 18994           DFHEIV99,
 18995           DFHEIV99,
 18996           DFHEIV99,
 18997           DFHEIV99
 18998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18999
 19000
 19001     IF DCT-RETURN-CODE = 'OK'
 19002         GO TO 7700-CONT.
 19003
 19004     IF DCT-RETURN-CODE = '01' OR '02'
 19005         GO TO 7700-SET-TO-YES.
 19006
 19007     IF DCT-RETURN-CODE = '03'
 19008
 19009* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19010*    MOVE '6"R                   !   #00017122' TO DFHEIV0
 19011     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19013     MOVE X'2020233030303137313232' TO DFHEIV0(25:11)
 19014     CALL 'kxdfhei1' USING DFHEIV0
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19016         MOVE ER-0951            TO EMI-ERROR
 19017         MOVE -1                 TO PMTTYPEL
 19018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19019         GO TO 8200-SEND-DATAONLY.
 19020
 19021     IF DCT-RETURN-CODE = '04'
 19022
 19023* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19024*    MOVE '6"R                   !   #00017129' TO DFHEIV0
 19025     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 365
* EL156.cbl
 19027     MOVE X'2020233030303137313239' TO DFHEIV0(25:11)
 19028     CALL 'kxdfhei1' USING DFHEIV0
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19030         MOVE ER-0946            TO EMI-ERROR
 19031         MOVE -1                 TO PMTTYPEL
 19032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19033         GO TO 8200-SEND-DATAONLY.
 19034
 19035     IF DCT-RETURN-CODE = '05'
 19036
 19037* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19038*    MOVE '6"R                   !   #00017136' TO DFHEIV0
 19039     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19041     MOVE X'2020233030303137313336' TO DFHEIV0(25:11)
 19042     CALL 'kxdfhei1' USING DFHEIV0
 19043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19044         MOVE ER-0947            TO EMI-ERROR
 19045         MOVE -1                 TO PMTTYPEL
 19046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19047         GO TO 8200-SEND-DATAONLY.
 19048
 19049     IF DCT-RETURN-CODE = '06'
 19050
 19051* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19052*    MOVE '6"R                   !   #00017143' TO DFHEIV0
 19053     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19055     MOVE X'2020233030303137313433' TO DFHEIV0(25:11)
 19056     CALL 'kxdfhei1' USING DFHEIV0
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19058         MOVE ER-0921            TO EMI-ERROR
 19059         MOVE -1                 TO PMTTYPEL
 19060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19061         GO TO 8200-SEND-DATAONLY.
 19062
 19063     IF DCT-RETURN-CODE = '07'
 19064
 19065* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19066*    MOVE '6"R                   !   #00017150' TO DFHEIV0
 19067     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19069     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 19070     CALL 'kxdfhei1' USING DFHEIV0
 19071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19072         MOVE ER-0919            TO EMI-ERROR
 19073         MOVE -1                 TO PMTTYPEL
 19074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19075         GO TO 8200-SEND-DATAONLY.
 19076
 19077     IF DCT-RETURN-CODE = '08'
 19078
 19079* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19080*    MOVE '6"R                   !   #00017157' TO DFHEIV0
 19081     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19083     MOVE X'2020233030303137313537' TO DFHEIV0(25:11)
 19084     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 366
* EL156.cbl
 19085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19086         MOVE ER-0948            TO EMI-ERROR
 19087         MOVE -1                 TO PMTTYPEL
 19088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19089         GO TO 8200-SEND-DATAONLY.
 19090
 19091     IF DCT-RETURN-CODE = 'N1'
 19092
 19093* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19094*    MOVE '6"R                   !   #00017164' TO DFHEIV0
 19095     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19097     MOVE X'2020233030303137313634' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19100         MOVE ER-0950            TO EMI-ERROR
 19101         MOVE -1                 TO PMTTYPEL
 19102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19103         GO TO 8200-SEND-DATAONLY.
 19104
 19105     IF DCT-RETURN-CODE = 'E1'
 19106
 19107* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19108*    MOVE '6"R                   !   #00017171' TO DFHEIV0
 19109     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303137313731' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0
 19113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19114         MOVE ER-0974            TO EMI-ERROR
 19115         MOVE -1                 TO PMTTYPEL
 19116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19117         GO TO 8200-SEND-DATAONLY.
 19118
 19119     IF DCT-RETURN-CODE = 'E2'
 19120
 19121* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19122*    MOVE '6"R                   !   #00017178' TO DFHEIV0
 19123     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303137313738' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0
 19127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19128         MOVE ER-0975            TO EMI-ERROR
 19129         MOVE -1                 TO PMTTYPEL
 19130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19131         GO TO 8200-SEND-DATAONLY.
 19132
 19133     IF DCT-RETURN-CODE NOT = 'OK'
 19134
 19135* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19136*    MOVE '6"R                   !   #00017185' TO DFHEIV0
 19137     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19139     MOVE X'2020233030303137313835' TO DFHEIV0(25:11)
 19140     CALL 'kxdfhei1' USING DFHEIV0
 19141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19142         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 367
* EL156.cbl
 19143         MOVE -1                 TO PMTTYPEL
 19144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19145         GO TO 8200-SEND-DATAONLY.
 19146
 19147 7700-CONT.
 19148
 19149*    MOVE 'N'                    TO CASHO.
 19150*    MOVE +1                     TO CASHL.
 19151*    MOVE AL-UANON               TO CASHA.
 19152
 19153     IF PI-OFFLINE = 'Y'
 19154         GO TO 7700-EXIT.
 19155
 19156     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19157     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19158     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19159     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19160     MOVE +7                     TO CHECKNOL.
 19161     MOVE AL-UANON               TO CHECKNOA.
 19162     GO TO 7700-EXIT.
 19163
 19164 7700-SET-TO-YES.
 19165
 19166*    MOVE 'Y'                    TO CASHO.
 19167*    MOVE +1                     TO CASHL.
 19168*    MOVE AL-UANON               TO CASHA.
 19169
 19170 7700-EXIT.
 19171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 368
* EL156.cbl
 19173 7800-READ-COMP-MSTR.
 19174
 19175
 19176* EXEC CICS HANDLE CONDITION
 19177*        NOTFND   (7800-COMP-NOTFND)
 19178*    END-EXEC.
 19179*    MOVE '"$I                   ! @ #00017219' TO DFHEIV0
 19180     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19182     MOVE X'4020233030303137323139' TO DFHEIV0(25:11)
 19183     CALL 'kxdfhei1' USING DFHEIV0
 19184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19185
 19186
 19187
 19188* EXEC CICS READ
 19189*        DATASET   ('ERCOMP')
 19190*        RIDFLD    (ERCOMP-KEY)
 19191*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19192*    END-EXEC.
 19193     MOVE 'ERCOMP' TO DFHEIV1
 19194*    MOVE '&"S        E          (   #00017223' TO DFHEIV0
 19195     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19197     MOVE X'2020233030303137323233' TO DFHEIV0(25:11)
 19198     CALL 'kxdfhei1' USING DFHEIV0,
 19199           DFHEIV1,
 19200           DFHEIV20,
 19201           DFHEIV99,
 19202           ERCOMP-KEY,
 19203           DFHEIV99,
 19204           DFHEIV99,
 19205           DFHEIV99
 19206     SET ADDRESS OF COMPENSATION-MASTER TO
 19207         DFHEIV20
 19208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19209
 19210
 19211     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19212     GO TO 7800-COMP-EXIT.
 19213
 19214 7800-COMP-NOTFND.
 19215     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19216
 19217 7800-COMP-EXIT.
 19218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 369
* EL156.cbl
 19220 7900-READ-CLAIM.
 19221
 19222* EXEC CICS READ
 19223*        DATASET  ('ELMSTR')
 19224*        SET      (ADDRESS OF CLAIM-MASTER)
 19225*        RIDFLD   (ELMSTR-KEY)
 19226*    END-EXEC.
 19227     MOVE 'ELMSTR' TO DFHEIV1
 19228*    MOVE '&"S        E          (   #00017239' TO DFHEIV0
 19229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19231     MOVE X'2020233030303137323339' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0,
 19233           DFHEIV1,
 19234           DFHEIV20,
 19235           DFHEIV99,
 19236           ELMSTR-KEY,
 19237           DFHEIV99,
 19238           DFHEIV99,
 19239           DFHEIV99
 19240     SET ADDRESS OF CLAIM-MASTER TO
 19241         DFHEIV20
 19242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19243
 19244
 19245 7900-EXIT.
 19246      EXIT.
 19247
 19248 7910-READ-CLAIM-UPDATE.
 19249
 19250* EXEC CICS READ
 19251*        DATASET  ('ELMSTR')
 19252*        SET      (ADDRESS OF CLAIM-MASTER)
 19253*        RIDFLD   (ELMSTR-KEY)
 19254*        UPDATE
 19255*    END-EXEC.
 19256     MOVE 'ELMSTR' TO DFHEIV1
 19257*    MOVE '&"S        EU         (   #00017249' TO DFHEIV0
 19258     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19259     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19260     MOVE X'2020233030303137323439' TO DFHEIV0(25:11)
 19261     CALL 'kxdfhei1' USING DFHEIV0,
 19262           DFHEIV1,
 19263           DFHEIV20,
 19264           DFHEIV99,
 19265           ELMSTR-KEY,
 19266           DFHEIV99,
 19267           DFHEIV99,
 19268           DFHEIV99
 19269     SET ADDRESS OF CLAIM-MASTER TO
 19270         DFHEIV20
 19271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19272
 19273
 19274 7910-EXIT.
 19275      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 370
* EL156.cbl
 19277 7920-READ-BENE.
 19278     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19279     MOVE 'B'                TO BENE-RECORD-TYPE.
 19280     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19281
 19282     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19283        IF PI-PAYEE-TYPE    = 'B' AND
 19284           PI-PAYEE-SEQ-NUM = 9
 19285             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19286             MOVE WS-A-BENE           TO BENE-NUMBER.
 19287
 19288
 19289* EXEC CICS HANDLE CONDITION
 19290*        NOTFND   (7920-NOT-FOUND)
 19291*    END-EXEC.
 19292*    MOVE '"$I                   ! A #00017270' TO DFHEIV0
 19293     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19295     MOVE X'4120233030303137323730' TO DFHEIV0(25:11)
 19296     CALL 'kxdfhei1' USING DFHEIV0
 19297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19298
 19299
 19300
 19301* EXEC CICS READ
 19302*        DATASET  ('ELBENE')
 19303*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19304*        RIDFLD   (ELBENE-KEY)
 19305*    END-EXEC.
 19306     MOVE 'ELBENE' TO DFHEIV1
 19307*    MOVE '&"S        E          (   #00017274' TO DFHEIV0
 19308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19310     MOVE X'2020233030303137323734' TO DFHEIV0(25:11)
 19311     CALL 'kxdfhei1' USING DFHEIV0,
 19312           DFHEIV1,
 19313           DFHEIV20,
 19314           DFHEIV99,
 19315           ELBENE-KEY,
 19316           DFHEIV99,
 19317           DFHEIV99,
 19318           DFHEIV99
 19319     SET ADDRESS OF BENEFICIARY-MASTER TO
 19320         DFHEIV20
 19321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19322
 19323
 19324     MOVE 'Y' TO BENE-FOUND-SW.
 19325     GO TO 7920-EXIT.
 19326
 19327 7920-NOT-FOUND.
 19328     MOVE 'N'                    TO BENE-FOUND-SW.
 19329
 19330 7920-EXIT.
 19331      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 371
* EL156.cbl
 19333 7930-READ-CONTROL.
 19334
 19335* EXEC CICS READ
 19336*        DATASET  ('ELCNTL')
 19337*        SET      (ADDRESS OF CONTROL-FILE)
 19338*        RIDFLD   (ELCNTL-KEY)
 19339*    END-EXEC.
 19340     MOVE 'ELCNTL' TO DFHEIV1
 19341*    MOVE '&"S        E          (   #00017290' TO DFHEIV0
 19342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19344     MOVE X'2020233030303137323930' TO DFHEIV0(25:11)
 19345     CALL 'kxdfhei1' USING DFHEIV0,
 19346           DFHEIV1,
 19347           DFHEIV20,
 19348           DFHEIV99,
 19349           ELCNTL-KEY,
 19350           DFHEIV99,
 19351           DFHEIV99,
 19352           DFHEIV99
 19353     SET ADDRESS OF CONTROL-FILE TO
 19354         DFHEIV20
 19355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19356
 19357
 19358 7930-EXIT.
 19359      EXIT.
 19360
 19361 7940-READ-CONTROL-UPDATE.
 19362
 19363* EXEC CICS READ
 19364*        DATASET  ('ELCNTL')
 19365*        SET      (ADDRESS OF CONTROL-FILE)
 19366*        RIDFLD   (ELCNTL-KEY)
 19367*        UPDATE
 19368*    END-EXEC.
 19369     MOVE 'ELCNTL' TO DFHEIV1
 19370*    MOVE '&"S        EU         (   #00017300' TO DFHEIV0
 19371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19372     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19373     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 19374     CALL 'kxdfhei1' USING DFHEIV0,
 19375           DFHEIV1,
 19376           DFHEIV20,
 19377           DFHEIV99,
 19378           ELCNTL-KEY,
 19379           DFHEIV99,
 19380           DFHEIV99,
 19381           DFHEIV99
 19382     SET ADDRESS OF CONTROL-FILE TO
 19383         DFHEIV20
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387 7940-EXIT.
 19388      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 372
* EL156.cbl
 19390 7950-READ-TRAILER.
 19391
 19392* EXEC CICS READ
 19393*        DATASET  ('ELTRLR')
 19394*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19395*        RIDFLD   (ELTRLR-KEY)
 19396*    END-EXEC.
 19397     MOVE 'ELTRLR' TO DFHEIV1
 19398*    MOVE '&"S        E          (   #00017311' TO DFHEIV0
 19399     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19401     MOVE X'2020233030303137333131' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0,
 19403           DFHEIV1,
 19404           DFHEIV20,
 19405           DFHEIV99,
 19406           ELTRLR-KEY,
 19407           DFHEIV99,
 19408           DFHEIV99,
 19409           DFHEIV99
 19410     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19411         DFHEIV20
 19412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19413
 19414
 19415 7950-EXIT.
 19416      EXIT.
 19417
 19418 7960-READ-TRAILER-UPDATE.
 19419
 19420* EXEC CICS READ
 19421*        DATASET  ('ELTRLR')
 19422*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19423*        RIDFLD   (ELTRLR-KEY)
 19424*        UPDATE
 19425*    END-EXEC.
 19426     MOVE 'ELTRLR' TO DFHEIV1
 19427*    MOVE '&"S        EU         (   #00017321' TO DFHEIV0
 19428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19429     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19430     MOVE X'2020233030303137333231' TO DFHEIV0(25:11)
 19431     CALL 'kxdfhei1' USING DFHEIV0,
 19432           DFHEIV1,
 19433           DFHEIV20,
 19434           DFHEIV99,
 19435           ELTRLR-KEY,
 19436           DFHEIV99,
 19437           DFHEIV99,
 19438           DFHEIV99
 19439     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19440         DFHEIV20
 19441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19442
 19443
 19444 7960-EXIT.
 19445      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 373
* EL156.cbl
 19447 7970-READ-CERT.
 19448
 19449* EXEC CICS READ
 19450*        DATASET  ('ELCERT')
 19451*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19452*        RIDFLD   (ELCERT-KEY)
 19453*    END-EXEC.
 19454     MOVE 'ELCERT' TO DFHEIV1
 19455*    MOVE '&"S        E          (   #00017332' TO DFHEIV0
 19456     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19458     MOVE X'2020233030303137333332' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0,
 19460           DFHEIV1,
 19461           DFHEIV20,
 19462           DFHEIV99,
 19463           ELCERT-KEY,
 19464           DFHEIV99,
 19465           DFHEIV99,
 19466           DFHEIV99
 19467     SET ADDRESS OF CERTIFICATE-MASTER TO
 19468         DFHEIV20
 19469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19470
 19471
 19472 7970-EXIT.
 19473      EXIT.
 19474 7975-read-acct.
 19475
 19476     move spaces              to WS-ACCT-RECORD-SW
 19477                                 pi-dcc-product-code
 19478
 19479     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19480     MOVE PI-CARRIER          TO ACCT-CARRIER
 19481     MOVE PI-GROUPING         TO ACCT-GROUPING
 19482     MOVE PI-STATE            TO ACCT-STATE
 19483     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19484     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19485     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19486     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19487
 19488
 19489* EXEC CICS READ
 19490*       DATASET ('ERACCT')
 19491*       RIDFLD  (ERACCT-KEY)
 19492*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19493*       GTEQ
 19494*       resp    (WS-RESPONSE)
 19495*    END-EXEC
 19496     MOVE 'ERACCT' TO DFHEIV1
 19497*    MOVE '&"S        G          (  N#00017354' TO DFHEIV0
 19498     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19500     MOVE X'204E233030303137333534' TO DFHEIV0(25:11)
 19501     CALL 'kxdfhei1' USING DFHEIV0,
 19502           DFHEIV1,
 19503           DFHEIV20,
 19504           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 374
* EL156.cbl
 19505           ERACCT-KEY,
 19506           DFHEIV99,
 19507           DFHEIV99,
 19508           DFHEIV99
 19509     SET ADDRESS OF ACCOUNT-MASTER TO
 19510         DFHEIV20
 19511     MOVE EIBRESP  TO WS-RESPONSE
 19512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19513     IF WS-RESP-NORMAL
 19514        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19515        and pi-cert-eff-dt < am-expiration-dt
 19516        and pi-cert-eff-dt >= am-effective-dt
 19517        move am-dcc-product-code to pi-dcc-product-code
 19518        set acct-found to true
 19519     end-if
 19520
 19521     .
 19522 7975-exit.
 19523     exit.
 19524 7980-READ-CERT-UPDATE.
 19525
 19526* EXEC CICS READ
 19527*        DATASET  ('ELCERT')
 19528*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19529*        RIDFLD   (ELCERT-KEY)
 19530*        UPDATE
 19531*    END-EXEC.
 19532     MOVE 'ELCERT' TO DFHEIV1
 19533*    MOVE '&"S        EU         (   #00017373' TO DFHEIV0
 19534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19536     MOVE X'2020233030303137333733' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0,
 19538           DFHEIV1,
 19539           DFHEIV20,
 19540           DFHEIV99,
 19541           ELCERT-KEY,
 19542           DFHEIV99,
 19543           DFHEIV99,
 19544           DFHEIV99
 19545     SET ADDRESS OF CERTIFICATE-MASTER TO
 19546         DFHEIV20
 19547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19548
 19549
 19550 7980-EXIT.
 19551      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 375
* EL156.cbl
 19553 8000-LOAD-ERROR-MESSAGES.
 19554     IF PI-PASS-SW = 'C'
 19555        MOVE EMI-LINE1           TO ERMSG1BO
 19556     ELSE
 19557        MOVE EMI-LINE1           TO ERRMSG1O
 19558        MOVE EMI-LINE2           TO ERRMSG2O.
 19559
 19560 8000-EXIT.
 19561     EXIT.
 19562
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 376
* EL156.cbl
 19564
 19565 8010-DMD-ERROR-CHECKS.
 19566     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19567
 19568     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19569         GO TO 8051-ISSUE-ERROR.
 19570
 19571     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19572     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19573     MOVE '3'                    TO DC-OPTION-CODE.
 19574     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19575     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19576         GO TO 8051-ISSUE-ERROR.
 19577
 19578     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19579       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19580                           OR
 19581          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19582           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19583             MOVE ER-0851         TO EMI-ERROR
 19584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19585       END-IF
 19586       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19587             MOVE ER-8147         TO EMI-ERROR
 19588             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19589
 19590     GO TO 8090-EXIT.
 19591
 19592 8051-ISSUE-ERROR.
 19593     MOVE ER-8146            TO EMI-ERROR.
 19594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19595     GO TO 8090-EXIT.
 19596
 19597 8090-EXIT.
 19598      EXIT.
 19599
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 377
* EL156.cbl
 19601 8100-SEND-INITIAL-MAP.
 19602
 19603     MOVE SAVE-DATE              TO RUNDTEAO.
 19604     MOVE EIBTIME                TO TIME-IN.
 19605     MOVE TIME-OUT               TO RUNTIMAO.
 19606     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19607
 19608     IF MAP-NAME = 'EL156A'
 19609        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19610           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19611        END-IF
 19612     END-IF
 19613*    IF MAP-NAME = 'EL156A'
 19614*       IF PI-COMPANY-ID = 'CRI'
 19615*          NEXT SENTENCE
 19616*       ELSE
 19617*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19618
 19619     IF MAP-NAME = 'EL156A'
 19620        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19621           NEXT SENTENCE
 19622        ELSE
 19623           MOVE AL-SADOF TO  PINTA    PINTHA.
 19624
 19625     IF MAP-NAME = 'EL156A'
 19626        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19627            NEXT SENTENCE
 19628        ELSE
 19629           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19630
 19631*    IF MAP-NAME = 'EL156A'
 19632*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19633*          NEXT SENTENCE
 19634*       ELSE
 19635*          MOVE AL-SADOF TO CASHHA CASHA.
 19636
 19637     IF MAP-NAME = 'EL156A'
 19638        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19639           NEXT SENTENCE
 19640        ELSE
 19641           MOVE AL-SADOF        TO  LOANHA
 19642                                    LOANNOA.
 19643
 19644     IF MAP-NAME = 'EL156A'
 19645        MOVE -1                 TO  ENTERPFL
 19646        IF PI-USES-PAID-TO
 19647           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19648           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19649           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19650        ELSE
 19651           NEXT SENTENCE
 19652     ELSE
 19653        IF MAP-NAME = 'EL156B'
 19654           IF PI-USES-PAID-TO
 19655              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19656              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19657
 19658
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 378
* EL156.cbl
 19659* EXEC CICS SEND
 19660*        MAP   (MAP-NAME)
 19661*        MAPSET(MAPSET-NAME)
 19662*        FROM  (EL156AI)
 19663*        ERASE
 19664*        CURSOR
 19665*    END-EXEC.
 19666     MOVE LENGTH OF
 19667      EL156AI
 19668       TO DFHEIV12
 19669     MOVE -1
 19670       TO DFHEIV11
 19671*    MOVE '8$     CT  E    H L F ,   #00017488' TO DFHEIV0
 19672     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19673     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19674     MOVE X'2020233030303137343838' TO DFHEIV0(25:11)
 19675     CALL 'kxdfhei1' USING DFHEIV0,
 19676           MAP-NAME,
 19677           EL156AI,
 19678           DFHEIV12,
 19679           MAPSET-NAME,
 19680           DFHEIV99,
 19681           DFHEIV99,
 19682           DFHEIV99,
 19683           DFHEIV11,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690     GO TO 9100-RETURN-TRAN.
 19691
 19692 8200-SEND-DATAONLY.
 19693
 19694     IF FIRST-ENTRY = 'Y'
 19695         GO TO 8100-SEND-INITIAL-MAP.
 19696
 19697     IF RETURNED-FROM-B = 'Y'
 19698         GO TO 8100-SEND-INITIAL-MAP.
 19699
 19700     MOVE SAVE-DATE              TO RUNDTEAO.
 19701     MOVE EIBTIME                TO TIME-IN.
 19702     MOVE TIME-OUT               TO RUNTIMAO.
 19703
 19704     IF EIBAID = DFHPF11
 19705        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19707        MOVE 'EL001   '          TO RETURNED-FROM
 19708        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19709        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19710        GO TO 8100-SEND-INITIAL-MAP.
 19711
 19712     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19713
 19714     IF MAP-NAME =  'EL156A'
 19715        MOVE -1                 TO  ENTERPFL
 19716        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 379
* EL156.cbl
 19717           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19718           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19719           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19720        ELSE
 19721           NEXT SENTENCE
 19722     ELSE
 19723        IF MAP-NAME = 'EL156B'
 19724           IF PI-USES-PAID-TO
 19725              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19726              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19727
 19728     IF MAP-NAME =  'EL156A'
 19729        IF PI-COMPANY-ID = 'BOA'
 19730            IF PI-INT-RATE NUMERIC
 19731                MOVE PI-INT-RATE TO PINTO.
 19732     IF MAP-NAME = 'EL156A'
 19733        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19734           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19735*          MOVE 'Y'              TO EOBYNO
 19736        END-IF
 19737     END-IF
 19738
 19739
 19740* EXEC CICS SEND
 19741*        MAP   (MAP-NAME)
 19742*        MAPSET(MAPSET-NAME)
 19743*        FROM  (EL156AI)
 19744*        DATAONLY
 19745*        CURSOR
 19746*    END-EXEC.
 19747     MOVE LENGTH OF
 19748      EL156AI
 19749       TO DFHEIV12
 19750     MOVE -1
 19751       TO DFHEIV11
 19752*    MOVE '8$D    CT       H L F ,   #00017545' TO DFHEIV0
 19753     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19754     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303137353435' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           MAP-NAME,
 19758           EL156AI,
 19759           DFHEIV12,
 19760           MAPSET-NAME,
 19761           DFHEIV99,
 19762           DFHEIV99,
 19763           DFHEIV99,
 19764           DFHEIV11,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771     GO TO 9100-RETURN-TRAN.
 19772
 19773 8300-SEND-TEXT.
 19774
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 380
* EL156.cbl
 19775* EXEC CICS SEND TEXT
 19776*        FROM(LOGOFF-TEXT)
 19777*        LENGTH(LOGOFF-LENGTH)
 19778*        ERASE
 19779*        FREEKB
 19780*    END-EXEC.
 19781*    MOVE '8&      T  E F  H   F -   #00017556' TO DFHEIV0
 19782     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19783     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19784     MOVE X'2020233030303137353536' TO DFHEIV0(25:11)
 19785     CALL 'kxdfhei1' USING DFHEIV0,
 19786           LOGOFF-TEXT,
 19787           LOGOFF-LENGTH,
 19788           DFHEIV99,
 19789           DFHEIV99,
 19790           DFHEIV99,
 19791           DFHEIV99,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801
 19802* EXEC CICS RETURN
 19803*    END-EXEC.
 19804*    MOVE '.(                    ''   #00017563' TO DFHEIV0
 19805     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303137353633' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           DFHEIV99,
 19810           DFHEIV99,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99,
 19814           DFHEIV99
 19815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19816
 19817
 19818 8500-FILE-NOTOPEN.
 19819     IF FILE-SWITCH = 'MSTR'
 19820         MOVE ER-0154            TO EMI-ERROR.
 19821     IF FILE-SWITCH = 'TRLR'
 19822         MOVE ER-0172            TO EMI-ERROR.
 19823     IF FILE-SWITCH = 'CERT'
 19824         MOVE ER-0169            TO EMI-ERROR.
 19825     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19826                      'PROC' OR 'STAT'
 19827         MOVE ER-0042            TO EMI-ERROR.
 19828     IF FILE-SWITCH = 'ACTQ'
 19829         MOVE ER-0338            TO EMI-ERROR.
 19830     IF FILE-SWITCH = 'ACCT'
 19831         MOVE ER-0168            TO EMI-ERROR.
 19832
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 381
* EL156.cbl
 19833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19834     MOVE -1                     TO PMTTYPEL.
 19835
 19836     IF FIRST-ENTRY = 'Y'
 19837         GO TO 8100-SEND-INITIAL-MAP.
 19838
 19839     GO TO 8200-SEND-DATAONLY.
 19840
 19841 8600-PGRM-NOT-FOUND.
 19842
 19843     MOVE ER-0923                TO EMI-ERROR.
 19844     MOVE -1                     TO ENTPFBL.
 19845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19846
 19847     IF FIRST-ENTRY = 'Y'
 19848         GO TO 8100-SEND-INITIAL-MAP
 19849     ELSE
 19850         GO TO 8200-SEND-DATAONLY.
 19851
 19852 8800-UNAUTHORIZED-ACCESS.
 19853     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19854     GO TO 8300-SEND-TEXT.
 19855
 19856 8810-PF23.
 19857     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19858     MOVE XCTL-005               TO PGM-NAME.
 19859     GO TO 9300-XCTL.
 19860
 19861 8820-PF7-8.
 19862     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19863     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19864                                    PI-SAVED-PROGRAM-2
 19865                                    PI-SAVED-PROGRAM-3
 19866                                    PI-SAVED-PROGRAM-4
 19867                                    PI-SAVED-PROGRAM-5
 19868                                    PI-SAVED-PROGRAM-6
 19869                                    PI-RETURN-TO-PROGRAM.
 19870     IF EIBAID = DFHPF8
 19871        MOVE XCTL-132            TO PGM-NAME
 19872     ELSE
 19873        MOVE XCTL-130            TO PGM-NAME.
 19874
 19875     GO TO 9300-XCTL.
 19876
 19877 9100-RETURN-TRAN.
 19878     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19879     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19880
 19881
 19882* EXEC CICS RETURN
 19883*        TRANSID(TRANS-ID)
 19884*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19885*        LENGTH(PI-COMM-LENGTH)
 19886*    END-EXEC.
 19887*    MOVE '.(CT                  ''   #00017629' TO DFHEIV0
 19888     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19890     MOVE X'2020233030303137363239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 382
* EL156.cbl
 19891     CALL 'kxdfhei1' USING DFHEIV0,
 19892           TRANS-ID,
 19893           PROGRAM-INTERFACE-BLOCK,
 19894           PI-COMM-LENGTH,
 19895           DFHEIV99,
 19896           DFHEIV99,
 19897           DFHEIV99
 19898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19899
 19900
 19901 9200-RETURN-MAIN-MENU.
 19902     MOVE XCTL-126               TO PGM-NAME.
 19903     GO TO 9300-XCTL.
 19904
 19905 9300-XCTL.
 19906
 19907* EXEC CICS XCTL
 19908*        PROGRAM(PGM-NAME)
 19909*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19910*        LENGTH(PI-COMM-LENGTH)
 19911*    END-EXEC.
 19912*    MOVE '.$C                   %   #00017640' TO DFHEIV0
 19913     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19914     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19915     MOVE X'2020233030303137363430' TO DFHEIV0(25:11)
 19916     CALL 'kxdfhei1' USING DFHEIV0,
 19917           PGM-NAME,
 19918           PROGRAM-INTERFACE-BLOCK,
 19919           PI-COMM-LENGTH,
 19920           DFHEIV99
 19921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19922
 19923
 19924 9400-CLEAR.
 19925     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19926     GO TO 9300-XCTL.
 19927
 19928 9500-PF12.
 19929     MOVE XCTL-010               TO PGM-NAME.
 19930     GO TO 9300-XCTL.
 19931
 19932 9700-LINK-DATE-CONVERT.
 19933     MOVE LINK-ELDATCV           TO PGM-NAME.
 19934
 19935* EXEC CICS LINK
 19936*        PROGRAM   (PGM-NAME)
 19937*        COMMAREA  (DATE-CONVERSION-DATA)
 19938*        LENGTH    (DC-COMM-LENGTH)
 19939*    END-EXEC.
 19940*    MOVE '."C                   (   #00017656' TO DFHEIV0
 19941     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19943     MOVE X'2020233030303137363536' TO DFHEIV0(25:11)
 19944     CALL 'kxdfhei1' USING DFHEIV0,
 19945           PGM-NAME,
 19946           DATE-CONVERSION-DATA,
 19947           DC-COMM-LENGTH,
 19948           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 383
* EL156.cbl
 19949           DFHEIV99,
 19950           DFHEIV99,
 19951           DFHEIV99
 19952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19953
 19954
 19955 9700-EXIT.
 19956     EXIT.
 19957
 19958 9800-LINK-REM-TERM.
 19959     MOVE LINK-REMTERM TO PGM-NAME.
 19960
 19961
 19962* EXEC CICS LINK
 19963*        PROGRAM   (PGM-NAME)
 19964*        COMMAREA  (CALCULATION-PASS-AREA)
 19965*        LENGTH    (CP-COMM-LENGTH)
 19966*    END-EXEC.
 19967*    MOVE '."C                   (   #00017668' TO DFHEIV0
 19968     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19970     MOVE X'2020233030303137363638' TO DFHEIV0(25:11)
 19971     CALL 'kxdfhei1' USING DFHEIV0,
 19972           PGM-NAME,
 19973           CALCULATION-PASS-AREA,
 19974           CP-COMM-LENGTH,
 19975           DFHEIV99,
 19976           DFHEIV99,
 19977           DFHEIV99,
 19978           DFHEIV99
 19979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19980
 19981
 19982 9800-EXIT.
 19983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 384
* EL156.cbl
 19985 9830-DMD-REMAINING-TERM.
 19986
 19987     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19988         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19989
 19990     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19991                              CM-PMT-EXTENSION-DAYS.
 19992
 19993     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19994                                  CL-NO-OF-DAYS-PAID.
 19995
 19996     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19997         GIVING W-REM REMAINDER W-REM-DAYS.
 19998
 19999     MOVE W-REM                  TO WST-REM.
 20000
 20001     IF W-REM-DAYS > ZEROS
 20002         MOVE '/'                TO WST-SLASH
 20003         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20004     ELSE
 20005         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20006
 20007 9830-EXIT.
 20008     EXIT.
 20009
 20010 9870-OUTPUT-ACTIVITY-RECORD.
 20011
 20012
 20013* EXEC CICS GETMAIN
 20014*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20015*         LENGTH(25)
 20016*         INITIMG(WS-BLANK)
 20017*    END-EXEC.
 20018     MOVE 25
 20019       TO DFHEIV11
 20020*    MOVE ',"IL                  $   #00017704' TO DFHEIV0
 20021     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20023     MOVE X'2020233030303137373034' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0,
 20025           DFHEIV20,
 20026           DFHEIV11,
 20027           WS-BLANK
 20028     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20029         DFHEIV20
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20034     MOVE ELMSTR-KEY             TO DA-KEY.
 20035     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20036
 20037     IF PI-PMTTYPE EQUAL '7'
 20038         MOVE 'V'                TO DA-RECORD-TYPE
 20039     ELSE
 20040         MOVE 'P'                TO DA-RECORD-TYPE.
 20041
 20042
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 385
* EL156.cbl
 20043* EXEC CICS HANDLE CONDITION
 20044*         NOTOPEN(9870-NOTOPEN)
 20045*         DUPREC(9870-EXIT)
 20046*    END-EXEC.
 20047*    MOVE '"$J%                  ! B #00017719' TO DFHEIV0
 20048     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20050     MOVE X'4220233030303137373139' TO DFHEIV0(25:11)
 20051     CALL 'kxdfhei1' USING DFHEIV0
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055
 20056* EXEC CICS WRITE
 20057*         DATASET('DLYACTV')
 20058*         RIDFLD(DA-KEY)
 20059*         FROM(DAILY-ACTIVITY-RECORD)
 20060*         LENGTH(25)
 20061*    END-EXEC.
 20062     MOVE 'DLYACTV' TO DFHEIV1
 20063     MOVE 25
 20064       TO DFHEIV11
 20065*    MOVE '&$ L                  ''   #00017724' TO DFHEIV0
 20066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20068     MOVE X'2020233030303137373234' TO DFHEIV0(25:11)
 20069     CALL 'kxdfhei1' USING DFHEIV0,
 20070           DFHEIV1,
 20071           DAILY-ACTIVITY-RECORD,
 20072           DFHEIV11,
 20073           DA-KEY,
 20074           DFHEIV99,
 20075           DFHEIV99
 20076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20077
 20078     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20079     GO TO 9870-EXIT.
 20080
 20081 9870-NOTOPEN.
 20082
 20083     MOVE '2955'                 TO EMI-ERROR.
 20084     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20085
 20086 9870-EXIT.
 20087     EXIT.
 20088
 20089 9900-ERROR-FORMAT.
 20090
 20091     IF EMI-ERROR = ER-0923
 20092         MOVE PGM-NAME           TO W-CALLED-NAME.
 20093
 20094     MOVE LINK-001      TO PGM-NAME.
 20095     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20096
 20097
 20098* EXEC CICS LINK
 20099*        PROGRAM (PGM-NAME)
 20100*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 386
* EL156.cbl
 20101*        LENGTH  (EMI-COMM-LENGTH)
 20102*    END-EXEC.
 20103*    MOVE '."C                   (   #00017749' TO DFHEIV0
 20104     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20106     MOVE X'2020233030303137373439' TO DFHEIV0(25:11)
 20107     CALL 'kxdfhei1' USING DFHEIV0,
 20108           PGM-NAME,
 20109           ERROR-MESSAGE-INTERFACE-BLOCK,
 20110           EMI-COMM-LENGTH,
 20111           DFHEIV99,
 20112           DFHEIV99,
 20113           DFHEIV99,
 20114           DFHEIV99
 20115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20116
 20117
 20118     IF EMI-ERROR = ER-0923
 20119         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20120
 20121 9900-EXIT.
 20122     EXIT.
 20123
 20124 9990-ABEND.
 20125     MOVE LINK-004               TO PGM-NAME.
 20126     MOVE DFHEIBLK               TO EMI-LINE1.
 20127
 20128* EXEC CICS LINK
 20129*        PROGRAM   (PGM-NAME)
 20130*        COMMAREA  (EMI-LINE1)
 20131*        LENGTH    (64)
 20132*    END-EXEC.
 20133     MOVE 64
 20134       TO DFHEIV11
 20135*    MOVE '."C                   (   #00017764' TO DFHEIV0
 20136     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20138     MOVE X'2020233030303137373634' TO DFHEIV0(25:11)
 20139     CALL 'kxdfhei1' USING DFHEIV0,
 20140           PGM-NAME,
 20141           EMI-LINE1,
 20142           DFHEIV11,
 20143           DFHEIV99,
 20144           DFHEIV99,
 20145           DFHEIV99,
 20146           DFHEIV99
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150     MOVE 'EL156A'               TO  MAP-NAME.
 20151     MOVE LOW-VALUES             TO  EL156AO.
 20152     GO TO 8100-SEND-INITIAL-MAP.
 20153
 20154 9995-SECURITY-VIOLATION.
 20155*    COPY ELCSCTP.
 20156******************************************************************
 20157*                                                                *
 20158*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 387
* EL156.cbl
 20159*                            VMOD=2.001                          *
 20160*                                                                *
 20161*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20162******************************************************************
 20163
 20164
 20165     MOVE EIBDATE          TO SM-JUL-DATE.
 20166     MOVE EIBTRMID         TO SM-TERMID.
 20167     MOVE THIS-PGM         TO SM-PGM.
 20168     MOVE EIBTIME          TO TIME-IN.
 20169     MOVE TIME-OUT         TO SM-TIME.
 20170     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20171
 20172
 20173* EXEC CICS LINK
 20174*         PROGRAM  ('EL003')
 20175*         COMMAREA (SECURITY-MESSAGE)
 20176*         LENGTH   (80)
 20177*    END-EXEC.
 20178     MOVE 'EL003' TO DFHEIV1
 20179     MOVE 80
 20180       TO DFHEIV11
 20181*    MOVE '."C                   (   #00017792' TO DFHEIV0
 20182     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20184     MOVE X'2020233030303137373932' TO DFHEIV0(25:11)
 20185     CALL 'kxdfhei1' USING DFHEIV0,
 20186           DFHEIV1,
 20187           SECURITY-MESSAGE,
 20188           DFHEIV11,
 20189           DFHEIV99,
 20190           DFHEIV99,
 20191           DFHEIV99,
 20192           DFHEIV99
 20193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20194
 20195
 20196******************************************************************
 20197
 20198
 20199
 20200 9999-DFHBACK SECTION.
 20201     MOVE '9%                    "   ' TO DFHEIV0
 20202     MOVE 'EL156' TO DFHEIV1
 20203     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20204     GOBACK.
 20205 9999-DFHEXIT.
 20206     IF DFHEIGDJ EQUAL 0001
 20207         NEXT SENTENCE
 20208     ELSE IF DFHEIGDJ EQUAL 2
 20209         GO TO 9990-ABEND,
 20210               8600-PGRM-NOT-FOUND,
 20211               0400-FIRST-TIME,
 20212               6180-DUPREC,
 20213               9990-ABEND
 20214         DEPENDING ON DFHEIGDI
 20215     ELSE IF DFHEIGDJ EQUAL 3
 20216         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 388
* EL156.cbl
 20217               0380-CLAIM-END-FILE
 20218         DEPENDING ON DFHEIGDI
 20219     ELSE IF DFHEIGDJ EQUAL 4
 20220         GO TO 0380-CLAIM-END-FILE,
 20221               0380-CLAIM-END-FILE
 20222         DEPENDING ON DFHEIGDI
 20223     ELSE IF DFHEIGDJ EQUAL 5
 20224         GO TO 0800-EXIT
 20225         DEPENDING ON DFHEIGDI
 20226     ELSE IF DFHEIGDJ EQUAL 6
 20227         GO TO 1950-NOT-FOUND,
 20228               1950-NOT-FOUND
 20229         DEPENDING ON DFHEIGDI
 20230     ELSE IF DFHEIGDJ EQUAL 7
 20231         GO TO 1950-NOT-FOUND
 20232         DEPENDING ON DFHEIGDI
 20233     ELSE IF DFHEIGDJ EQUAL 8
 20234         GO TO 1950-NOT-FOUND,
 20235               1950-NOT-FOUND
 20236         DEPENDING ON DFHEIGDI
 20237     ELSE IF DFHEIGDJ EQUAL 9
 20238         GO TO 1166-END-CHECK,
 20239               1166-END-CHECK
 20240         DEPENDING ON DFHEIGDI
 20241     ELSE IF DFHEIGDJ EQUAL 10
 20242         GO TO 1950-NOT-FOUND,
 20243               1950-NOT-FOUND
 20244         DEPENDING ON DFHEIGDI
 20245     ELSE IF DFHEIGDJ EQUAL 11
 20246         GO TO 1950-NOT-FOUND,
 20247               1950-NOT-FOUND
 20248         DEPENDING ON DFHEIGDI
 20249     ELSE IF DFHEIGDJ EQUAL 12
 20250         GO TO 1950-NOT-FOUND
 20251         DEPENDING ON DFHEIGDI
 20252     ELSE IF DFHEIGDJ EQUAL 13
 20253         GO TO 3600-CONTINUE
 20254         DEPENDING ON DFHEIGDI
 20255     ELSE IF DFHEIGDJ EQUAL 14
 20256         GO TO 5300-NOTE-NOT-FOUND
 20257         DEPENDING ON DFHEIGDI
 20258     ELSE IF DFHEIGDJ EQUAL 15
 20259         GO TO 6065-NOT-FOUND
 20260         DEPENDING ON DFHEIGDI
 20261     ELSE IF DFHEIGDJ EQUAL 16
 20262         GO TO 6068-ACCT-NOT-FND
 20263         DEPENDING ON DFHEIGDI
 20264     ELSE IF DFHEIGDJ EQUAL 17
 20265         GO TO 6074-GET-COMP-DATA
 20266         DEPENDING ON DFHEIGDI
 20267     ELSE IF DFHEIGDJ EQUAL 18
 20268         GO TO 6170-WRITE
 20269         DEPENDING ON DFHEIGDI
 20270     ELSE IF DFHEIGDJ EQUAL 19
 20271         GO TO 6180-DUPREC
 20272         DEPENDING ON DFHEIGDI
 20273     ELSE IF DFHEIGDJ EQUAL 20
 20274         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 389
* EL156.cbl
 20275         DEPENDING ON DFHEIGDI
 20276     ELSE IF DFHEIGDJ EQUAL 21
 20277         GO TO 6185-DUPREC
 20278         DEPENDING ON DFHEIGDI
 20279     ELSE IF DFHEIGDJ EQUAL 22
 20280         GO TO 6720-BUILD-NEW-RECORD
 20281         DEPENDING ON DFHEIGDI
 20282     ELSE IF DFHEIGDJ EQUAL 23
 20283         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20284               6900-BUILD-ARCHIVE-HEADER
 20285         DEPENDING ON DFHEIGDI
 20286     ELSE IF DFHEIGDJ EQUAL 24
 20287         GO TO 7010-BUILD-MAP
 20288         DEPENDING ON DFHEIGDI
 20289     ELSE IF DFHEIGDJ EQUAL 25
 20290         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20291         DEPENDING ON DFHEIGDI
 20292     ELSE IF DFHEIGDJ EQUAL 26
 20293         GO TO 7160-DUPREC
 20294         DEPENDING ON DFHEIGDI
 20295     ELSE IF DFHEIGDJ EQUAL 27
 20296         GO TO 7200-EXIT,
 20297               7200-EXIT
 20298         DEPENDING ON DFHEIGDI
 20299     ELSE IF DFHEIGDJ EQUAL 28
 20300         GO TO 7400-NOT-FOUND
 20301         DEPENDING ON DFHEIGDI
 20302     ELSE IF DFHEIGDJ EQUAL 29
 20303         GO TO 7590-END,
 20304               7590-END
 20305         DEPENDING ON DFHEIGDI
 20306     ELSE IF DFHEIGDJ EQUAL 30
 20307         GO TO 7699-EXIT
 20308         DEPENDING ON DFHEIGDI
 20309     ELSE IF DFHEIGDJ EQUAL 31
 20310         GO TO 5300-NOTE-NOT-FOUND
 20311         DEPENDING ON DFHEIGDI
 20312     ELSE IF DFHEIGDJ EQUAL 32
 20313         GO TO 7800-COMP-NOTFND
 20314         DEPENDING ON DFHEIGDI
 20315     ELSE IF DFHEIGDJ EQUAL 33
 20316         GO TO 7920-NOT-FOUND
 20317         DEPENDING ON DFHEIGDI
 20318     ELSE IF DFHEIGDJ EQUAL 34
 20319         GO TO 9870-NOTOPEN,
 20320               9870-EXIT
 20321         DEPENDING ON DFHEIGDI.
 20322     MOVE '9%                    "   ' TO DFHEIV0
 20323     MOVE 'EL156' TO DFHEIV1
 20324     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20325     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12188     Code:       75458
