* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53******************************************************************
    54 ENVIRONMENT DIVISION.
    55
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   3
* EL050.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER   PIC X(32) VALUE '********************************'.
    62 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    63 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    64
    65 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    66 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    67                                   USAGE POINTER.
    68 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    69 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    71                                   USAGE IS POINTER.
    72 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83*    COPY ELC50WS.
    84*****************************************************************
    85*                                                               *
    86*                            ELC50WS.                           *
    87*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    88*                            VMOD=2.061.                        *
    89*                                                               *
    90*   THIS IS THE WORKING STORAGE FOR EL050                       *
    91*                                   EL517                       *
    92*****************************************************************
    93******************************************************************
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 123102                   PEMA  ADD DCC PROCESSING
   102* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   103* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   104* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   105* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   106* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   107* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   108* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   109* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   110* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   111* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   112* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   113* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   114* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   115* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   4
* EL050.cbl
   116* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   117* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   119* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   120* 030309  CR2009021700001  PEMA  ADD ER-2883
   121* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   122* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   124* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   125* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   126* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   127* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   128* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   129* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   131* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   132* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   133* 061412  CR2011022800001  AJRA  NAPERSOFT
   134* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   135* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   136* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   137* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   138* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   139* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   140* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   141* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   142* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   143* 091114  IR2014091000001  TANA  ADD ERROR 2898
   144*-----------------------------------------------------------------
   145
   146 01  WORK-AREAS.
   147
   148*****************************************************************
   149*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   150*****************************************************************
   151
   152     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   153     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-NAME-EDIT-WORK-AREA.
   156         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   157         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   158             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   159         16  WS-WORK-NAME.
   160             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   161             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   162             20  FILLER           PIC X(10)     VALUE SPACES.
   163         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   164             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   165
   166*****************************************************************
   167*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   168*****************************************************************
   169
   170     12  WS-ERRESC-KEY.
   171         16 WS-ERRESC-SEARCH-KEY.
   172             20  WS-ERRESC-COMPANY-CD PIC  X.
   173             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   5
* EL050.cbl
   174             20  WS-ERRESC-GROUP      PIC X(6).
   175             20  WS-ERRESC-STATE      PIC XX.
   176             20  WS-ERRESC-ACCOUNT    PIC X(10).
   177         16 WS-ERRESC-RESIDUAL-KEY.
   178             20  WS-ERRESC-AGENT      PIC X(10).
   179             20  WS-ERRESC-RES-STATE  PIC XX.
   180             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   181*                                          YYYYMMDD
   182     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   183     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   184
   185*RESIDENT STATE TAX MASTER(ERRESS)
   186*
   187     12  WS-ERRESS-KEY.
   188         16  WS-ERRESS-COMPANY-CD      PIC  X.
   189         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   190         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   191         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   192*                                          YYYYMMDD
   193
   194     12  WS-CONTRACT-DATE              PIC 9(8).
   195*                                          YYYYMMDD
   196     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   197     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   198         16 WS-YEAR-YY                 PIC   9999.
   199         16 FILLER                     PIC 9(4).
   200*                                          YYYYMMDD
   201     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   202     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   203     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   204     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   205
   206     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   207         88  DPRB-1ST-TIME                      VALUE ' '.
   208
   209*****************************************************************
   210*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   211*****************************************************************
   212
   213     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   214     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   215     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   216     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   219     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   220     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   221     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   222     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   223     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   225         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   226     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   228         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   229     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   230
   231     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   6
* EL050.cbl
   232     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   233
   234     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   235     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   248     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   249     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   270     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   271     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   272     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   273     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   282     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   283     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   284     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   285     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   286     12  WS-2671-SW               PIC X         VALUE SPACE.
   287     12  WS-2672-SW               PIC X         VALUE SPACE.
   288     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   289         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   7
* EL050.cbl
   290     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   291         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   292     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   293
   294     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   295         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   296         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   297         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   298         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   299
   300     12  WS-CREDIT-EDIT-CONTROLS.
   301         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   302         16  WS-MIN-AGE           PIC 99                VALUE  0.
   303         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   304         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   305         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   306         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   307
   308     12  WS-AGE-FIELDS.
   309         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   310         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   311         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   313
   314     12  WS-SAVE-ALLOWABLE-BENEFIT.
   315         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   316         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   317         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   318         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   319         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   320         16  FILLER                      PIC XX.
   321
   322     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   323     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   324     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   325     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   326     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   327     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   328     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   329     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   330     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   331     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   332
   333     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   334     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   335     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   336     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   337     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   338     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   339     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   340     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   341         88  WS-REDUCING              VALUE 'R'.
   342         88  WS-LEVEL                 VALUE 'L' 'P'.
   343     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   344
   345     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   8
* EL050.cbl
   348     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   349     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   350     12  ws-ah-max-bens           pic 99        value zeros.
   351     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   352     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   353     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   354     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   355
   356     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   357     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   358     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   359     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   360     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   361     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   364     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   365     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   366     12  WS-ACCT-SIG-SW.
   367         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   368         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   369     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   371     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   373     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   376     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-INITIALS.
   379         16  WS-INIT-1            PIC X         VALUE SPACES.
   380         16  WS-INIT-2            PIC X         VALUE SPACES.
   381
   382     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   383     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   384     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   385     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   386     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   387*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   388     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   395     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   396     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   398     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   399     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   400     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   402     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   404     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page   9
* EL050.cbl
   406     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410******** FLA
   411     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   415     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   416********
   417     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   418     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   419     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   421     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   422     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   423     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   424     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   425     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   426     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   427
   428     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   429         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   430                                         '0' THRU '9'.
   431
   432     12  NUMBER-OF-MONTHS.
   433         16  SK-MO OCCURS 12 TIMES PIC X.
   434
   435     12  WS-WORK-DATE.
   436         16  WS-YEAR            PIC 99    VALUE 00.
   437         16  WS-MONTH           PIC 99    VALUE 00.
   438         16  WS-DAY             PIC 99    VALUE 00.
   439
   440     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   441     12  WS-WORK-CRIT-DEV       REDEFINES
   442         WS-WORK-LF-CRIT-PER    PIC X(03).
   443
   444     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   445     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   446
   447     12  WS-WORK-DATE-FROM.
   448         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   449         16  FILLER             PIC X  VALUE SPACE.
   450         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X         VALUE SPACE.
   452         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   453
   454     12  WS-WORK-DATE-THRU.
   455         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   456         16  FILLER             PIC X         VALUE SPACE.
   457         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   460
   461     12  WS-LF-INPUT-CD.
   462         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   463         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  10
* EL050.cbl
   464
   465     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   466     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   467         16  WS-AH-INPUT-CD-1   PIC X.
   468         16  WS-AH-INPUT-CD-2-3 PIC XX.
   469
   470     12  WS-SWITCHES.
   471         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   472         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   473             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   474         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   475             88  BANK-ACCT-FOUND          VALUE 'Y'.
   476         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   477             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   478         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   479             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   480         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   481             88  COMP-MASTER-FOUND        VALUE 'Y'.
   482         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   484         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   486         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   487             88  STAT-MASTER-FOUND        VALUE 'Y'.
   488         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   489             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   491             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   492         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   493             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   495             88  FORM-MASTER-FOUND        VALUE 'Y'.
   496         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   497             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   498         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   499             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   501             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   502         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   503             88  NO-BENEFIT-FOUND         VALUE 'N'.
   504         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   505             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   506         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   508         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  AH-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   511         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  LF-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   514         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   515             88  NO-STATE-RECORD          VALUE '1'.
   516         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   517             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   518         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   519             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   521             88  CERT-WAS-FOUND           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  11
* EL050.cbl
   522             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   523         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   524             88  BROWSE-STARTED           VALUE 'Y'.
   525         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   526             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   527         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   528             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   529         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   530             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   531         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   532             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   533         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   536             88  APP-CERT-USED            VALUE 'Y' 'A'.
   537         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   538             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   539             88  FIRST-TIME-THROUGH       VALUE '1'.
   540             88  CTBL-NOT-FOUND           VALUE '2'.
   541
   542         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   543             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   544
   545         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   546             88  DLO-ERROR-FOUND          VALUE 'Y'.
   547
   548********FLA
   549     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   550     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   551********
   552     12  RC-SW-1                  PIC X           VALUE '0'.
   553     12  RC-SW-2                  PIC X           VALUE '0'.
   554     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   555     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   556     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   564     12  LIT-SPACES               PIC X           VALUE SPACES.
   565     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   566     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   567     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   568     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   569     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   570     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   571     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   572         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   573         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   574     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   575         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   576
   577 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   578     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   579     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  12
* EL050.cbl
   580 01  WS-CRI-SSN-WORK-AREA.
   581     05  WS-CRI-SOC-SEC-NO.
   582         10  WS-SS-REPT-CD       PIC X(5).
   583         10  WS-SS-LAST-NAME     PIC X(5).
   584         10  WS-SS-INITIAL       PIC X.
   585
   586     05  WS-CRI-REPORT-CODE.
   587         10  FILLER              PIC X(5).
   588         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   589
   590     05  WS-CRI-LAST-NAME.
   591         10  WS-CRI-NAME-MOVE    PIC X(5).
   592         10  FILLER              PIC X(10).
   593
   594 01  WS-NUM-TABLE                PIC X(26)  VALUE
   595     '12345678012345070923456789'.
   596 01  FILLER REDEFINES WS-NUM-TABLE.
   597     05  WS-NUM OCCURS 26        PIC 9.
   598 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   599 01  V1                          PIC S999 COMP-3.
   600 01  V2                          PIC S999 COMP-3.
   601 01  V3                          PIC S999 COMP-3.
   602 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   603 01  FILLER REDEFINES WS-WORK-VIN.
   604     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   605 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   606 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   607 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   608 01  WS-HEX-WORK.
   609     05  FILLER                  PIC X  VALUE LOW-VALUES.
   610     05  WS-HEX-BYTE             PIC X.
   611 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   612 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   613 01  WS-WORK-HIN-ROW-B.
   614     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   615
   616 01  ws-benefit-cd-chg-sw      pic x value spaces.
   617     88  benefit-code-chg           value 'Y'.
   618 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   619 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   620     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   621 01  WS-ROW-D-TABLE.
   622     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   623
   624 01  WS-HIN-TABLE-B.
   625     05  F                       PIC XX VALUE 'A2'.
   626     05  F                       PIC XX VALUE 'B3'.
   627     05  F                       PIC XX VALUE 'C4'.
   628     05  F                       PIC XX VALUE 'D5'.
   629     05  F                       PIC XX VALUE 'E6'.
   630     05  F                       PIC XX VALUE 'F7'.
   631     05  F                       PIC XX VALUE 'G8'.
   632     05  F                       PIC XX VALUE 'H9'.
   633     05  F                       PIC XX VALUE 'I1'.
   634     05  F                       PIC XX VALUE 'J2'.
   635     05  F                       PIC XX VALUE 'K3'.
   636     05  F                       PIC XX VALUE 'L4'.
   637     05  F                       PIC XX VALUE 'M5'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  13
* EL050.cbl
   638     05  F                       PIC XX VALUE 'N6'.
   639     05  F                       PIC XX VALUE 'O0'.
   640     05  F                       PIC XX VALUE 'P7'.
   641     05  F                       PIC XX VALUE 'Q0'.
   642     05  F                       PIC XX VALUE 'R8'.
   643     05  F                       PIC XX VALUE 'S9'.
   644     05  F                       PIC XX VALUE 'T2'.
   645     05  F                       PIC XX VALUE 'U3'.
   646     05  F                       PIC XX VALUE 'V4'.
   647     05  F                       PIC XX VALUE 'W5'.
   648     05  F                       PIC XX VALUE 'X6'.
   649     05  F                       PIC XX VALUE 'Y7'.
   650     05  F                       PIC XX VALUE 'Z8'.
   651 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   652     05  WS-VAL-IN               PIC X.
   653     05  WS-VAL-OUT              PIC 9.
   654 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   655 01  WS-COMPARE-BINARY-DATES.
   656     05  WS-971231                PIC XX VALUE X'92FF'.
   657     05  WS-931231                PIC XX VALUE X'8CFF'.
   658     05  WS-791231                PIC XX VALUE X'77FF'.
   659     05  WS-771001                PIC XX VALUE X'74A1'.
   660     05  WS-820301                PIC XX VALUE X'7B41'.
   661     05  WS-831031                PIC XX VALUE X'7DBF'.
   662     05  WS-831231                PIC XX VALUE X'7DFF'.
   663     05  WS-810831                PIC XX VALUE X'7A7F'.
   664     05  WS-830901                PIC XX VALUE X'7D81'.
   665
   666 01  FILE-ACCESS-IDS.
   667     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   668     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   669     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   670     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   671     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   672     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   673     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   674     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   675     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   676     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   677     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   678     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   679     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   680     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   681     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   682     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   683     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   684 01  DD-IU-SW                    PIC X   VALUE ' '.
   685     88  DD-IU-PRESENT                 VALUE 'Y'.
   686
   687 01  ACCESS-KEYS.
   688     12  ELMSTR-KEY.
   689         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   691     12  W-CLAIM-KEY.
   692         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  14
* EL050.cbl
   696         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   697         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   698         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   699         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   700
   701     12  ELCERT-KEY.
   702         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  CERT-CARRIER         PIC X       VALUE SPACE.
   704         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   705         16  CERT-STATE           PIC XX      VALUE SPACES.
   706         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   707         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   708         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   709
   710     12  ELCERT2-KEY.
   711         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   712         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   713
   714     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   715
   716     12  ELCERT-SAVE.
   717         16  FILLER                      PIC XX    VALUE SPACES.
   718
   719         16  WCS-CONTROL-PRIMARY.
   720             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   721             20  WCS-CARRIER             PIC X     VALUE SPACE.
   722             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   723             20  WCS-STATE               PIC XX    VALUE SPACES.
   724             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   725             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   726             20  WCS-CERT-NO.
   727                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   728                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   729
   730         16  CS-CONTROL-BY-NAME.
   731             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   732             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   733             20  CS-INSURED-INITIALS.
   734                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   735                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-SSN.
   738             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   739             20  CS-SOC-SEC-NO.
   740                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   741                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   742                 24  CS-SSN-LN3.
   743                     28 CS-INSURED-INITIALS-A2   PIC XX
   744                                     VALUE SPACES.
   745                     28 CS-PART-LAST-NAME-A2     PIC X
   746                                     VALUE SPACE.
   747
   748         16  CS-CONTROL-BY-CERT-NO.
   749             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   750             20  CS-CERT-NO-A4           PIC X(11)
   751                                     VALUE SPACES.
   752
   753         16  CS-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  15
* EL050.cbl
   754             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   755             20  CS-MEMBER-NO.
   756                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   757                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   758                 24  CS-MEMB-LN4.
   759                     28 CS-INSURED-INITIALS-A5   PIC XX
   760                                      VALUE SPACES.
   761                     28 CS-PART-LAST-NAME-A5     PIC XX
   762                                      VALUE SPACES.
   763
   764         16  FILLER              PIC X(360) VALUE SPACES.
   765
   766     12  ERACCT-KEY.
   767         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   768         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   769         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   770         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   771         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   772         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   773
   774     12  ERCOMP-KEY.
   775         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  COMP-CARRIER         PIC X     VALUE SPACES.
   777         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   778         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   779         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   780         16  COMP-TYPE            PIC X     VALUE SPACES.
   781
   782     12  ERLOFC-KEY.
   783         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   784         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   785         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   786         16  LOFC-STATE           PIC XX    VALUE SPACES.
   787         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   788         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   789
   790     12  WS-ELCRTT-KEY.
   791         16  WS-ELCRTT-PRIMARY       PIC X(33).
   792         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   793
   794     12  ERBXRF-KEY.
   795         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   797         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   798         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   799
   800     12  ERAGTC-KEY.
   801         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   803         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   804         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   805         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   806         16  AGTC-TYPE            PIC X     VALUE SPACES.
   807
   808     12  ERPLAN-KEY.
   809         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   811         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  16
* EL050.cbl
   812         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   813         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   814         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   815         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   816         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   817
   818     12  ERFORM-KEY.
   819         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   821         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   822         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   823
   824     12  ERREIN-KEY.
   825         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   826         16  REIN-TYPE            PIC X     VALUE SPACES.
   827         16  REIN-TABLE-CO.
   828             20  REIN-CODE-1      PIC X     VALUE SPACE.
   829             20  REIN-CODE-2      PIC X     VALUE SPACE.
   830             20  REIN-CODE-3      PIC X     VALUE SPACE.
   831         16  FILLER               PIC X(3)  VALUE SPACES.
   832
   833     12  ERCTBL-KEY.
   834         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   835         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   836         16  CTBL-CNTRL-2.
   837             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   838             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   839
   840     12  ELCRTO-KEY.
   841         16  ELCRTO-COMPANY-CD       PIC X.
   842         16  ELCRTO-CARRIER          PIC X.
   843         16  ELCRTO-GROUPING         PIC X(6).
   844         16  ELCRTO-STATE            PIC XX.
   845         16  ELCRTO-ACCOUNT          PIC X(10).
   846         16  ELCRTO-CERT-EFF-DT      PIC XX.
   847         16  ELCRTO-CERT-NO.
   848             20  ELCRTO-CERT-PRIME   PIC X(10).
   849             20  ELCRTO-CERT-SFX     PIC X.
   850         16  ELCRTO-RECORD-TYPE      PIC X.
   851         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   852
   853
   854     12  WS-ACCESS.
   855         16  FILLER               PIC XX    VALUE SPACES.
   856         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   857
   858     12  WS-CARR-ACCESS.
   859         16  FILLER               PIC X(3)  VALUE SPACES.
   860         16  WS-CARR              PIC X     VALUE SPACE.
   861*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   862*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   863     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   864         88  WS-DMD-LF-RATING   VALUE 'Y'.
   865         88  WS-DMD-AH-RATING   VALUE 'Y'.
   866         88  WS-DMD-NO-RATING   VALUE 'N'.
   867
   868     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   869         88  WS-LF-CASH            VALUE 'MJ' 'MS'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  17
* EL050.cbl
   870                                         'NJ' 'NL'
   871                                         'PJ' 'PL'
   872                                         'SJ' 'SL'.
   873     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   874         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   875                                         'NI' 'NJ' 'NL' 'NU'
   876                                         'PJ' 'PL' 'PI' 'PU'
   877                                         'SI' 'SJ' 'SL' 'SU'
   878                                         'MX' 'MY' 'MZ'.
   879 01  ERPDEF-KEY-SAVE             PIC X(18).
   880 01  ERPDEF-KEY.
   881     12  ERPDEF-COMPANY-CD       PIC X.
   882     12  ERPDEF-STATE            PIC XX.
   883     12  ERPDEF-PROD-CD          PIC XXX.
   884     12  F                       PIC X(7).
   885     12  ERPDEF-BEN-TYPE         PIC X.
   886     12  ERPDEF-BEN-CODE         PIC XX.
   887     12  ERPDEF-EXP-DT           PIC XX.
   888
   889 01  ELSTAT-KEY-SAVE             PIC X(20).
   890 01  ELSTAT-KEY.
   891     12  ELSTAT-COMPANY-ID       PIC XXX.
   892     12  ELSTAT-CARRIER          PIC X.
   893     12  ELSTAT-GROUP            PIC X(6).
   894     12  ELSTAT-STATE            PIC XX.
   895     12  ELSTAT-EXP-DT           PIC 9(8).
   896 01  WS-ERROR-VALUES.
   897     12  ER-1570                     PIC S9(4)   VALUE +1570.
   898     12  ER-1571                     PIC S9(4)   VALUE +1571.
   899     12  er-1572                     pic s9(4)   value +1572.
   900     12  er-1573                     pic s9(4)   value +1573.
   901     12  er-1574                     pic s9(4)   value +1574.
   902     12  ER-1575                     PIC S9(4)   VALUE +1575.
   903     12  er-1576                     pic s9(4)   value +1576.
   904     12  ER-1891                     PIC S9(4)   VALUE +1891.
   905     12  ER-1892                     PIC S9(4)   VALUE +1892.
   906     12  ER-1893                     PIC S9(4)   VALUE +1893.
   907     12  ER-1894                     PIC S9(4)   VALUE +1894.
   908     12  ER-1895                     PIC S9(4)   VALUE +1895.
   909     12  ER-1896                     PIC S9(4)   VALUE +1896.
   910     12  ER-1897                     PIC S9(4)   VALUE +1897.
   911     12  ER-1898                     PIC S9(4)   VALUE +1898.
   912     12  ER-1899                     PIC S9(4)   VALUE +1899.
   913     12  ER-1900                     PIC S9(4)   VALUE +1900.
   914     12  ER-1901                     PIC S9(4)   VALUE +1901.
   915     12  ER-1902                     PIC S9(4)   VALUE +1902.
   916     12  ER-1903                     PIC S9(4)   VALUE +1903.
   917     12  ER-1904                     PIC S9(4)   VALUE +1904.
   918     12  ER-1905                     PIC S9(4)   VALUE +1905.
   919     12  ER-1906                     PIC S9(4)   VALUE +1906.
   920     12  ER-1907                     PIC S9(4)   VALUE +1907.
   921     12  ER-1909                     PIC S9(4)   VALUE +1909.
   922     12  ER-1910                     PIC S9(4)   VALUE +1910.
   923     12  ER-1911                     PIC S9(4)   VALUE +1911.
   924     12  ER-1912                     PIC S9(4)   VALUE +1912.
   925     12  ER-1913                     PIC S9(4)   VALUE +1913.
   926     12  ER-1914                     PIC S9(4)   VALUE +1914.
   927     12  ER-1915                     PIC S9(4)   VALUE +1915.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  18
* EL050.cbl
   928     12  ER-1916                     PIC S9(4)   VALUE +1916.
   929     12  ER-1917                     PIC S9(4)   VALUE +1917.
   930     12  ER-1918                     PIC S9(4)   VALUE +1918.
   931     12  ER-1919                     PIC S9(4)   VALUE +1919.
   932     12  ER-1920                     PIC S9(4)   VALUE +1920.
   933     12  ER-1921                     PIC S9(4)   VALUE +1921.
   934     12  ER-1922                     PIC S9(4)   VALUE +1922.
   935     12  ER-1923                     PIC S9(4)   VALUE +1923.
   936     12  ER-1924                     PIC S9(4)   VALUE +1924.
   937     12  ER-1925                     PIC S9(4)   VALUE +1925.
   938     12  ER-1926                     PIC S9(4)   VALUE +1926.
   939     12  ER-1927                     PIC S9(4)   VALUE +1927.
   940     12  ER-2393                     PIC S9(4)   VALUE +2393.
   941     12  ER-2600                     PIC S9(4)   VALUE +2600.
   942     12  ER-2601                     PIC S9(4)   VALUE +2601.
   943     12  ER-2602                     PIC S9(4)   VALUE +2602.
   944     12  ER-2603                     PIC S9(4)   VALUE +2603.
   945     12  ER-2604                     PIC S9(4)   VALUE +2604.
   946     12  ER-2605                     PIC S9(4)   VALUE +2605.
   947     12  ER-2606                     PIC S9(4)   VALUE +2606.
   948     12  ER-2607                     PIC S9(4)   VALUE +2607.
   949     12  ER-2608                     PIC S9(4)   VALUE +2608.
   950     12  ER-2609                     PIC S9(4)   VALUE +2609.
   951     12  ER-2610                     PIC S9(4)   VALUE +2610.
   952     12  ER-2611                     PIC S9(4)   VALUE +2611.
   953     12  ER-2612                     PIC S9(4)   VALUE +2612.
   954     12  ER-2613                     PIC S9(4)   VALUE +2613.
   955     12  ER-2614                     PIC S9(4)   VALUE +2614.
   956     12  ER-2615                     PIC S9(4)   VALUE +2615.
   957     12  ER-2616                     PIC S9(4)   VALUE +2616.
   958     12  ER-2617                     PIC S9(4)   VALUE +2617.
   959     12  ER-2618                     PIC S9(4)   VALUE +2618.
   960     12  ER-2619                     PIC S9(4)   VALUE +2619.
   961     12  ER-2620                     PIC S9(4)   VALUE +2620.
   962     12  ER-2621                     PIC S9(4)   VALUE +2621.
   963     12  ER-2622                     PIC S9(4)   VALUE +2622.
   964     12  ER-2623                     PIC S9(4)   VALUE +2623.
   965     12  ER-2624                     PIC S9(4)   VALUE +2624.
   966     12  ER-2625                     PIC S9(4)   VALUE +2625.
   967     12  ER-2626                     PIC S9(4)   VALUE +2626.
   968     12  ER-2627                     PIC S9(4)   VALUE +2627.
   969     12  ER-2628                     PIC S9(4)   VALUE +2628.
   970     12  ER-2629                     PIC S9(4)   VALUE +2629.
   971     12  ER-2630                     PIC S9(4)   VALUE +2630.
   972     12  ER-2631                     PIC S9(4)   VALUE +2631.
   973     12  ER-2632                     PIC S9(4)   VALUE +2632.
   974     12  ER-2633                     PIC S9(4)   VALUE +2633.
   975     12  ER-2634                     PIC S9(4)   VALUE +2634.
   976     12  ER-2635                     PIC S9(4)   VALUE +2635.
   977     12  ER-2636                     PIC S9(4)   VALUE +2636.
   978     12  ER-2637                     PIC S9(4)   VALUE +2637.
   979     12  ER-2638                     PIC S9(4)   VALUE +2638.
   980     12  ER-2639                     PIC S9(4)   VALUE +2639.
   981     12  ER-2640                     PIC S9(4)   VALUE +2640.
   982     12  ER-2641                     PIC S9(4)   VALUE +2641.
   983     12  ER-2642                     PIC S9(4)   VALUE +2642.
   984     12  ER-2643                     PIC S9(4)   VALUE +2643.
   985     12  ER-2644                     PIC S9(4)   VALUE +2644.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  19
* EL050.cbl
   986     12  ER-2645                     PIC S9(4)   VALUE +2645.
   987     12  ER-2646                     PIC S9(4)   VALUE +2646.
   988     12  ER-2647                     PIC S9(4)   VALUE +2647.
   989     12  ER-2648                     PIC S9(4)   VALUE +2648.
   990     12  ER-2649                     PIC S9(4)   VALUE +2649.
   991     12  ER-2650                     PIC S9(4)   VALUE +2650.
   992     12  ER-2651                     PIC S9(4)   VALUE +2651.
   993     12  ER-2652                     PIC S9(4)   VALUE +2652.
   994     12  ER-2653                     PIC S9(4)   VALUE +2653.
   995     12  ER-2654                     PIC S9(4)   VALUE +2654.
   996     12  ER-2655                     PIC S9(4)   VALUE +2655.
   997     12  ER-2656                     PIC S9(4)   VALUE +2656.
   998     12  ER-2657                     PIC S9(4)   VALUE +2657.
   999     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1000     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1001     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1002     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1003     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1004     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1005     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1006     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1007     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1008     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1009     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1010     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1011     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1012     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1013     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1014     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1015     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1016     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1017     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1018     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1019     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1020     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1021     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1022     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1023     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1024     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1025     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1026     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1027     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1028     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1029     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1030     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1031     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1032     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1033     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1034     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1035     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1036     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1037     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1038     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1039     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1040     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1041     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1042     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1043     12  ER-2702                     PIC S9(4)   VALUE +2702.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  20
* EL050.cbl
  1044     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1045     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1046     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1047     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1048     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1049     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1050     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1051     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1052     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1053     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1054     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1055     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1056     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1057     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1058     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1059     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1060     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1061     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1062     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1063     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1064     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1065     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1066     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1067     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1068     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1069     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1070     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1071     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1072     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1073     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1074     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1075     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1076     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1077     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1078     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1079     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1080     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1081     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1082     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1083     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1084     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1085     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1086     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1087     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1088     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1089     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1090     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1091     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1092     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1093     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1094     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1095     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1096     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1097     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1098     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1099     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1100     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1101     12  ER-2770                     PIC S9(4)   VALUE +2770.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  21
* EL050.cbl
  1102     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1103     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1104     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1105     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1106     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1107     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1108     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1109     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1110     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1111     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1112     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1113     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1114     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1115     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1116     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1117     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1118     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1119     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1120     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1121     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1122     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1123     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1124     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1125     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1126     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1127     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1128     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1129     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1130     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1131     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1132     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1133     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1134     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1135     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1136     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1137     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1138     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1139     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1140     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1141     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1142     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1143     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1144     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1145     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1146     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1147     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1148     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1149     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1150     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1151     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1152     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1153     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1154     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1155     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1156     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1157     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1158     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1159     12  ER-3825                     PIC S9(4)   VALUE +3825.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  22
* EL050.cbl
  1160     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1161     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1162     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1163     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1164     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1165     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1166     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1167     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1168     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1169     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1170     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1171     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1172     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1173     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1174     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1175     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1176     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1177     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1178     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1179     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1180     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1181     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1182     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1183     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1184     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1185     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1186     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1187     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1188     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1189     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1190     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1191     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1192     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1193     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1194     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1195     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1196     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1197     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1198     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1199     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1200     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1201     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1202     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1203     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1204     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1205     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1206     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1207     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1208     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1209     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1210     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1211     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1212     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1213     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1214     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1215     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1216     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1217     12  ER-8098                     PIC S9(4)   VALUE +8098.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  23
* EL050.cbl
  1218     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1219     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1220     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1221     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1222     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1223     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1224     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1225     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1226     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1227     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1228     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1229     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1230     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1231     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1232     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1233     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1234     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1235     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1236     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1237     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1238     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1239     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1240     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1241     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1242     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1243     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1244     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1245     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1246******************************************************************
  1247***************   END OF ELC50WS     ****************************
  1248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  24
* EL050.cbl
  1251 01  WORKING-STORAGE-WORK-AREAS.
  1252     12  WS-RESPONSE             PIC S9(8)  COMP.
  1253         88  WS-RESP-NORMAL           VALUE +00.
  1254         88  WS-RESP-ERROR            VALUE +01.
  1255         88  WS-RESP-NOTFND           VALUE +13.
  1256         88  WS-RESP-DUPREC           VALUE +14.
  1257         88  WS-RESP-ENDFILE          VALUE +20.
  1258     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1259     12  WORK-AREAS.
  1260         16  WK-CONV-GREG.
  1261             24  WCG-CENT             PIC XX.
  1262             24  WCG-REST             PIC X(4).
  1263         16  WORK-GREGORIAN-DATE.
  1264             24  WK-GREG-CENT         PIC XX.
  1265             24  WK-GREG-DATE-YYMMDD.
  1266                 28  WK-GREG-YYMM     PIC X(4).
  1267                 28  WK-GREG-DD       PIC XX.
  1268
  1269         16  WORK-SELECT-DATE.
  1270             24  WK-SELECT-CENT            PIC XX.
  1271             24  WK-SELECT-DATE-YYMMDD.
  1272                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1273                 28  FILLER                PIC XX.
  1274
  1275         16  WK-FORM-NO.
  1276             24  WK-FORM-BANK-ID       PIC X(5).
  1277             24  WK-FORM-UNDRWRTR      PIC X(1).
  1278             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1279
  1280         16  WK-MEMBER-NO.
  1281             24  WK-MEMBER-1-6        PIC X(6).
  1282             24  WK-MEMBER-7-12       PIC X(6).
  1283
  1284         16  WK-FULL-CERT-NO.
  1285             24  WK-CERT-POS-1-2      PIC X(2).
  1286             24  WK-CERT-POS-3        PIC X(1).
  1287             24  WK-CERT-POS-4        PIC X(1).
  1288             24  WK-CERT-POS-5-6      PIC X(2).
  1289             24  WK-CERT-POS-7        PIC X(1).
  1290             24  WK-CERT-POS-8-11     PIC X(4).
  1291
  1292         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1293             88  VALID-RATE-CODE        VALUE 'Y'.
  1294             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1295
  1296         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1297         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1298         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1299         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1300         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1301         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1302         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1303         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1304         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1305         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1306
  1307* DLO001
  1308 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  25
* EL050.cbl
  1309     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1310     12  DMPF-RETURN-CODE          PIC XX.
  1311         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1312         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1313         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1314         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1315         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1316         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1317
  1318* DLO002
  1319 01  WS-DLO-INTERNAL-POLICY-FORM.
  1320     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1321     12  DIPF-RETURN-CODE          PIC XX.
  1322         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1324         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1325         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1326         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1327         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1328
  1329* DLO003
  1330 01  WS-DLO-VALID-BANK-ID.
  1331     12  DVBI-BANK-ID              PIC X(5).
  1332     12  DVBI-BANK-ID-TYPE         PIC X.
  1333         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1334         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1335         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1336         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1337         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1338     12  DVBI-RETURN-CODE          PIC XX.
  1339         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1340         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1341         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1342         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1343         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1344         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1345         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1346         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1347         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1348
  1349* DLO007
  1350 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1351     12  DCUA-RES-STATE            PIC XX.
  1352     12  DCUA-BEN-TYPE             PIC XX.
  1353     12  DCUA-SYS-IDENT            PIC X.
  1354         88  DCUA-CLAIM                        VALUE 'C'.
  1355         88  DCUA-PREMIUM                      VALUE 'P'.
  1356     12  DCUA-COVERAGE-RULE        PIC X.
  1357     12  DCUA-CLIENT-ID            PIC X(10).
  1358     12  DCUA-EFF-DATE             PIC X(8).
  1359     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1360     12  DCUA-RETURN-CODE          PIC XX.
  1361         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1362     12  DCUA-CERT-NUMBER          PIC X(11).
  1363     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1364     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1365
  1366* DLO011
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  26
* EL050.cbl
  1367 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1368     12  DPRB-RATE-CODE            PIC X(4).
  1369     12  DPRB-COVERAGE-CATEG       PIC X.
  1370     12  DPRB-RETURN-CODE          PIC XX.
  1371         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1372         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1373         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1374         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1375         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1376         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1377         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1378         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1379         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1380     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1381     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1382     12  DPRB-BEN-TYPE             PIC XX.
  1383
  1384* DLO017
  1385 01  WS-DLO-VALID-RATE-CODE.
  1386     12  DVRC-RATE-CODE            PIC X(4).
  1387     12  DVRC-RETURN-CODE          PIC XX.
  1388         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1389         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1390         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1391         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1392         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1393         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394
  1395* DLO019
  1396 01  WS-DLO-ORIG-COV-CAT.
  1397     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1398     12  DOCC-RETURN-CODE          PIC XX.
  1399     12  DOCC-ORIG-COV-CAT         PIC X.
  1400     12  DOCC-UNDERWITER           PIC XX.
  1401     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1402     12  DOCC-FILLER               PIC X(6).
  1403
  1404* DLO021
  1405 01  WS-DLO-VALID-LOAN-OFFICER.
  1406     12  DVLO-LOAN-OFFICER.
  1407         16  DVLO-BILL-TYPE        PIC X.
  1408         16  DVLO-BILL-SOURCE      PIC X.
  1409         16  DVLO-BATCH-TYPE       PIC X.
  1410     12  DVLO-RETURN-CODE          PIC XX.
  1411         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1413         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1414         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1415         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1416         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1417
  1418* DLO022
  1419 01  WS-DLO-VALID-STATE-CODE.
  1420     12  DVSC-STATE-CODE           PIC XX.
  1421     12  DVSC-RETURN-CODE          PIC XX.
  1422         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1423
  1424* DLO023
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  27
* EL050.cbl
  1425 01  WS-DLO-VALID-CODE-VALUES.
  1426     12  DVCV-SYSTEM-ID            PIC XX.
  1427         88  DVCV-CLAIMS                       VALUE 'CL'.
  1428         88  DVCV-CREDIT                       VALUE 'CR'.
  1429     12  DVCV-RECORD-TYPE          PIC XX.
  1430         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1431         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1432         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1433         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1434         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1435         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1436         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1437         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1438     12  DVCV-RECORD-KEY           PIC X(6).
  1439     12  DVCV-RETURN-CODE          PIC XX.
  1440         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1441         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1442         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1443         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1444         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1445         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1446         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1447     12  DVCV-CODE-DESC            PIC X(60).
  1448     12  DVCV-GEN-DESC-1           PIC X(20).
  1449     12  DVCV-GEN-DESC-2           PIC X(20).
  1450     12  DVCV-GEN-DESC-3           PIC X(20).
  1451
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  28
* EL050.cbl
  1453*    COPY ERCBXRF.
  1454******************************************************************
  1455*                                                                *
  1456*                                                                *
  1457*                            ERCBXRF                             *
  1458*                                                                *
  1459*   ONLINE CREDIT SYSTEM                                         *
  1460*                                                                *
  1461*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1462*                                                                *
  1463*   FILE TYPE = VSAM,KSDS                                        *
  1464*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1465*                                                                *
  1466*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1467*       ALTERNATE PATH = NONE                                    *
  1468*                                                                *
  1469*   LOG = NO                                                     *
  1470*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1471*                                                                *
  1472******************************************************************
  1473
  1474 01  BANK-CROSS-REFERENCE.
  1475     12  BK-RECORD-ID                PIC XX.
  1476         88  VALID-BK-ID             VALUE 'BK'.
  1477
  1478     12  BK-CONTROL-PRIMARY.
  1479         16  BK-COMPANY-CD           PIC X.
  1480         16  BK-CARRIER              PIC X.
  1481         16  BK-GROUPING             PIC X(6).
  1482         16  BK-BANK-NO              PIC X(10).
  1483
  1484     12  BK-MAINT-INFORMATION.
  1485         16  BK-LAST-MAINT-DT        PIC XX.
  1486         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1487         16  BK-LAST-MAINT-USER      PIC X(4).
  1488         16  FILLER                  PIC X(9).
  1489
  1490     12  FILLER                      PIC X(37).
  1491
  1492     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1493
  1494     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1495                            DEPENDING ON BK-BANK-POINTER-CNT.
  1496         16  BK-AM-ACCOUNT           PIC X(10).
  1497         16  BK-AM-EXP-DT            PIC XX.
  1498         16  BK-AM-EFF-DT            PIC XX.
  1499         16  BK-AM-STATE             PIC XX.
  1500         16  FILLER                  PIC X(20).
  1501
  1502******************************************************************
  1503
  1504*    COPY ERCCOMP.
  1505******************************************************************
  1506*                                                                *
  1507*                                                                *
  1508*                            ERCCOMP                             *
  1509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1510*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  29
* EL050.cbl
  1511*                                                                *
  1512*   ONLINE CREDIT SYSTEM                                         *
  1513*                                                                *
  1514*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1515*                                                                *
  1516*   FILE TYPE = VSAM,KSDS                                        *
  1517*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1518*                                                                *
  1519*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1520*       ALTERNATE PATH = NONE                                    *
  1521*                                                                *
  1522*   LOG = NO                                                     *
  1523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1524*                                                                *
  1525******************************************************************
  1526*                   C H A N G E   L O G
  1527*
  1528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1529*-----------------------------------------------------------------
  1530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1531* EFFECTIVE    NUMBER
  1532*-----------------------------------------------------------------
  1533* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1534* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1535* 092205    2005050300006  PEMA  ADD LEASE FEE
  1536* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1537* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1538* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1539* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1540* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1541* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1542******************************************************************
  1543
  1544 01  COMPENSATION-MASTER.
  1545     12  CO-RECORD-ID                          PIC XX.
  1546         88  VALID-CO-ID                          VALUE 'CO'.
  1547
  1548     12  CO-CONTROL-PRIMARY.
  1549         16  CO-COMPANY-CD                     PIC X.
  1550         16  CO-CONTROL.
  1551             20  CO-CTL-1.
  1552                 24  CO-CARR-GROUP.
  1553                     28  CO-CARRIER            PIC X.
  1554                     28  CO-GROUPING.
  1555                         32  CO-GROUP-PREFIX   PIC XXX.
  1556                         32  CO-GROUP-PRIME    PIC XXX.
  1557                 24  CO-RESP-NO.
  1558                     28  CO-RESP-PREFIX        PIC X(4).
  1559                     28  CO-RESP-PRIME         PIC X(6).
  1560             20  CO-CTL-2.
  1561                 24  CO-ACCOUNT.
  1562                     28  CO-ACCT-PREFIX        PIC X(4).
  1563                     28  CO-ACCT-PRIME         PIC X(6).
  1564         16  CO-TYPE                           PIC X.
  1565             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1566             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1567             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1568
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  30
* EL050.cbl
  1569     12  CO-MAINT-INFORMATION.
  1570         16  CO-LAST-MAINT-DT                  PIC XX.
  1571         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1572         16  CO-LAST-MAINT-USER                PIC X(4).
  1573     12  FILLER                                PIC XX.
  1574     12  CO-STMT-TYPE                          PIC XXX.
  1575     12  CO-COMP-TYPE                          PIC X.
  1576         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1577     12  CO-STMT-OWNER                         PIC X(4).
  1578     12  CO-BALANCE-CONTROL                    PIC X.
  1579         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1580         88  CO-NO-BALANCE                        VALUE 'N'.
  1581
  1582     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1583         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1584         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1585         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1586
  1587     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1588         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1589         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1590
  1591     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1592     12  CO-GA-DIRECT-DEP                      PIC X.
  1593     12  CO-FUTURE-SPACE                       PIC X.
  1594         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1595
  1596     12  CO-ACCT-NAME                          PIC X(30).
  1597     12  CO-MAIL-NAME                          PIC X(30).
  1598     12  CO-ADDR-1                             PIC X(30).
  1599     12  CO-ADDR-2                             PIC X(30).
  1600     12  CO-ADDR-3.
  1601         16  CO-ADDR-CITY                      PIC X(27).
  1602         16  CO-ADDR-STATE                     PIC XX.
  1603     12  CO-CSO-1099                           PIC X.
  1604     12  CO-ZIP.
  1605         16  CO-ZIP-PRIME.
  1606             20  CO-ZIP-PRI-1ST                PIC X.
  1607                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1608             20  FILLER                        PIC X(4).
  1609         16  CO-ZIP-PLUS4                      PIC X(4).
  1610     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1611         16  CO-CAN-POSTAL-1                   PIC XXX.
  1612         16  CO-CAN-POSTAL-2                   PIC XXX.
  1613         16  FILLER                            PIC XXX.
  1614     12  CO-SOC-SEC                            PIC X(13).
  1615     12  CO-TELEPHONE.
  1616         16  CO-AREA-CODE                      PIC XXX.
  1617         16  CO-PREFIX                         PIC XXX.
  1618         16  CO-PHONE                          PIC X(4).
  1619
  1620     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1621
  1622     12  CO-AR-BAL-LEVEL                       PIC X.
  1623         88  CO-AR-REF-LVL                        VALUE '1'.
  1624         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1625         88  CO-AR-BILL-LVL                       VALUE '2'.
  1626         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  31
* EL050.cbl
  1627         88  CO-AR-FR-LVL                         VALUE '4'.
  1628
  1629     12  CO-AR-NORMAL-PRINT                    PIC X.
  1630         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1631         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1632
  1633     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1634
  1635     12  CO-AR-REPORTING                       PIC X.
  1636         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1637         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1638
  1639     12  CO-AR-PULL-CHECK                      PIC X.
  1640         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1641         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1642
  1643     12  CO-AR-BALANCE-PRINT                   PIC X.
  1644         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1645
  1646     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1647         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1648         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1649         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1650
  1651     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1652
  1653     12  CO-USER-CODE                          PIC X.
  1654     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1655
  1656******************************************************************
  1657*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1658*    THE LAST MONTH END RUN.
  1659******************************************************************
  1660
  1661     12  CO-LAST-ACTIVITY-DATE.
  1662         16  CO-ACT-YEAR                       PIC 99.
  1663         16  CO-ACT-MONTH                      PIC 99.
  1664         16  CO-ACT-DAY                        PIC 99.
  1665
  1666     12  CO-LAST-STMT-DT.
  1667         16  CO-LAST-STMT-YEAR                 PIC 99.
  1668         16  CO-LAST-STMT-MONTH                PIC 99.
  1669         16  CO-LAST-STMT-DAY                  PIC 99.
  1670
  1671     12  CO-MO-END-TOTALS.
  1672         16  CO-MONTHLY-TOTALS.
  1673             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1674             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1675             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1676             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1677             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1678
  1679         16  CO-AGING-TOTALS.
  1680             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1681             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1682             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1683             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1684
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  32
* EL050.cbl
  1685         16  CO-YTD-TOTALS.
  1686             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1688
  1689         16  CO-OVER-UNDER-TOTALS.
  1690             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1691             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1692
  1693     12  CO-MISCELLANEOUS-TOTALS.
  1694         16  CO-FICA-TOTALS.
  1695             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1696             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1697
  1698         16  CO-CLAIM-TOTALS.
  1699             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1700             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1701
  1702******************************************************************
  1703*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1704*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1705******************************************************************
  1706
  1707     12  CO-CURRENT-TOTALS.
  1708         16  CO-CURRENT-LAST-STMT-DT.
  1709             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1710             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1711             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1712
  1713         16  CO-CURRENT-MONTHLY-TOTALS.
  1714             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1716             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1717             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CURRENT-AGING-TOTALS.
  1721             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1722             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1723             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1725
  1726         16  CO-CURRENT-YTD-TOTALS.
  1727             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1728             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1729
  1730     12  CO-PAID-COMM-TOTALS.
  1731         16  CO-YTD-PAID-COMMS.
  1732             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1733             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1734
  1735     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1736         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1737         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1738
  1739     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1740         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1741         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1742         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  33
* EL050.cbl
  1743         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1744         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1745         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1746         88  CO-FINAL-LETTER                  VALUE 'F'.
  1747         88  CO-RECONCILING                   VALUE 'R'.
  1748         88  CO-PHONE-CALL                    VALUE 'P'.
  1749         88  CO-LEGAL                         VALUE 'L'.
  1750         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1751         88  CO-WRITE-OFF                     VALUE 'W'.
  1752         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1753
  1754     12  CO-CSR-CODE                       PIC X(4).
  1755
  1756     12  CO-GA-STATUS-INFO.
  1757         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1758         16  CO-GA-TERMINATION-DT          PIC XX.
  1759         16  CO-GA-STATUS-CODE             PIC X.
  1760             88  CO-GA-ACTIVE                 VALUE 'A'.
  1761             88  CO-GA-INACTIVE               VALUE 'I'.
  1762             88  CO-GA-PENDING                VALUE 'P'.
  1763         16  CO-GA-COMMENTS.
  1764             20  CO-GA-COMMENT-1           PIC X(40).
  1765             20  CO-GA-COMMENT-2           PIC X(40).
  1766             20  CO-GA-COMMENT-3           PIC X(40).
  1767             20  CO-GA-COMMENT-4           PIC X(40).
  1768
  1769     12  CO-RPTCD2                         PIC X(10).
  1770     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1771         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1772         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-TYPE-AGENT                     PIC X(01).
  1775         88  CO-CORPORATION                   VALUE 'C'.
  1776         88  CO-PARTNERSHIP                   VALUE 'P'.
  1777         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1778         88  CO-TRUST                         VALUE 'T'.
  1779         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1780
  1781     12  CO-FAXNO.
  1782         16  CO-FAX-AREA-CODE                  PIC XXX.
  1783         16  CO-FAX-PREFIX                     PIC XXX.
  1784         16  CO-FAX-PHONE                      PIC X(4).
  1785
  1786     12  CO-BANK-INFORMATION.
  1787         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1788         16  CO-BANK-TRANSIT-NON REDEFINES
  1789             CO-BANK-TRANSIT-NO                PIC 9(8).
  1790
  1791         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1792     12  CO-MISC-DEDUCT-INFO REDEFINES
  1793                  CO-BANK-INFORMATION.
  1794         16  CO-MD-GL-ACCT                     PIC X(10).
  1795         16  CO-MD-DIV                         PIC XX.
  1796         16  CO-MD-CENTER                      PIC X(4).
  1797         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1798         16  CO-CREATE-AP-CHECK                PIC X.
  1799         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1800         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  34
* EL050.cbl
  1801     12  CO-ACH-STATUS                         PIC X.
  1802         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1803         88  CO-ACH-PENDING                        VALUE 'P'.
  1804
  1805     12  CO-BILL-SW                            PIC X.
  1806     12  CO-CONTROL-NAME                       PIC X(30).
  1807     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1808     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1809     12  CO-CLP-STATE                          PIC XX.
  1810     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1811     12  CO-SPP-REFUND-EDIT                    PIC X.
  1812
  1813******************************************************************
  1814
  1815*    COPY ERCAGTC.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ERCAGTC                             *
  1820*                            VMOD=2.001                          *
  1821*                                                                *
  1822*   ONLINE CREDIT SYSTEM                                         *
  1823*                                                                *
  1824*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1825*                                                                *
  1826*   FILE TYPE = VSAM,KSDS                                        *
  1827*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1828*                                                                *
  1829*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1830*       ALTERNATE PATH = NONE                                    *
  1831*                                                                *
  1832*   LOG = NO                                                     *
  1833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1834*                                                                *
  1835******************************************************************
  1836*                   C H A N G E   L O G
  1837*
  1838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1839*-----------------------------------------------------------------
  1840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1841* EFFECTIVE    NUMBER
  1842*-----------------------------------------------------------------
  1843* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1844* 111004                         NEW FILE AND COPYBOOK
  1845* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1846******************************************************************
  1847 01  AGENT-COMMISSIONS.
  1848     12  AG-RECORD-ID                          PIC XX.
  1849         88  VALID-CO-ID                          VALUE 'AG'.
  1850     12  AG-CONTROL-PRIMARY.
  1851         16  AG-COMPANY-CD                     PIC X.
  1852         16  AG-CONTROL.
  1853             20  AG-CTL-1.
  1854                 24  AG-CARR-GROUP.
  1855                     28  AG-CARRIER            PIC X.
  1856                     28  AG-GROUPING           PIC X(6).
  1857                 24  AG-BANK                   PIC X(10).
  1858             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  35
* EL050.cbl
  1859                 24  AG-EXP-DT                 PIC XX.
  1860         16  AG-TYPE                           PIC X.
  1861             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1862             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1863     12  AG-MAINT-INFORMATION.
  1864         16  AG-LAST-MAINT-DT                  PIC XX.
  1865         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1866         16  AG-LAST-MAINT-USER                PIC X(4).
  1867         16  FILLER                            PIC X(10).
  1868     12  AG-EFF-DT                             PIC XX.
  1869     12  AG-COMM-STRUCTURE.
  1870         16  AG-AGT-COMMS OCCURS 10.
  1871             20  AG-AGT                PIC X(10).
  1872             20  AG-COM-TYP            PIC X.
  1873             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1874             20  AG-RECALC-LV-INDIC    PIC X.
  1875             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1876             20  AG-LRCALC-LV-INDIC    PIC X.
  1877             20  FILLER                PIC X(05).
  1878     12  FILLER                  PIC X(145).
  1879******************************************************************
  1880*    COPY ERCRESS.
  1881******************************************************************
  1882*                                                                *
  1883*                            ERCRESS                             *
  1884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1885*                            VMOD=2.002                          *
  1886*                                                                *
  1887*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1888*                                                                *
  1889*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1890*   VSAM RESIDENT STATE TAX MASTER                              *
  1891*                                                                *
  1892*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1893*                                                                *
  1894*   FILE TYPE = VSAM,KSDS                                        *
  1895*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1896*                                                                *
  1897*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1898*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1899*                                                                *
  1900*   LOG = NO                                                     *
  1901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1902*                                                                *
  1903*                                                                *
  1904******************************************************************
  1905
  1906 01  RESIDENT-STATE-TAX-MASTER.
  1907
  1908     10  ERRESS-PRIMARY-KEY.
  1909         15  RES-COMPANY-CD        PIC X.
  1910         15  RES-RESIDENT-STATE    PIC XX.
  1911         15  RES-COVERAGE-CATEGORY PIC X.
  1912         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1913*                                      YYYYMMDD
  1914*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1915
  1916     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  36
* EL050.cbl
  1917
  1918         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1919         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1920         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1921         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1922
  1923     10 RES-RECALC-SW              PIC   X.
  1924         88 RECALC                VALUE 'Y'.
  1925         88 NO-RECALC             VALUE 'N'.
  1926     10  RES-MAINT-BY              PIC X(4).
  1927     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1928     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1929*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  37
* EL050.cbl
  1931*    COPY ERCRESC.
  1932******************************************************************
  1933*                                                                *
  1934*                            ERCRESC                             *
  1935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1936*                            VMOD=2.003                          *
  1937*                                                                *
  1938*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1939*                                                                *
  1940*   FILE TYPE = VSAM,KSDS                                        *
  1941*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1942*                                                                *
  1943*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1944*       ALTERNATE PATH1 = NONE                                   *
  1945*                                                                *
  1946*   LOG = NO                                                     *
  1947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1948*                                                                *
  1949******************************************************************
  1950
  1951 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1952
  1953     10  ERRESC-RECORD-KEY.
  1954         15  RESC-COMPANY-CD           PIC   X.
  1955         15  RESC-CARRIER              PIC   X.
  1956         15  RESC-GROUP                PIC   X(6).
  1957         15  RESC-STATE                PIC   XX.
  1958         15  RESC-ACCOUNT              PIC   X(10).
  1959         15  RESC-AGENT                PIC   X(10).
  1960         15  RESC-RESIDENT-STATE       PIC   XX.
  1961         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1962*                                           YYYYMMDD
  1963     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1964
  1965     10  RESC-COMM-RECORD-DATA.
  1966         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1967             20 RESC-COVERAGE-CAT      PIC    X.
  1968             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1969             20 RESC-COMMISSION-TAB REDEFINES
  1970                RESC-COMMISSION-PER    PIC  XXX.
  1971
  1972     10  RESC-MAINT-BY                 PIC X(4).
  1973     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1974     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1975*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  38
* EL050.cbl
  1977*    COPY ERCPLAN.
  1978******************************************************************
  1979*                                                                *
  1980*                                                                *
  1981*                            ERCPLAN                             *
  1982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1983*                            VMOD=2.003                          *
  1984*                                                                *
  1985*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1986*                                                                *
  1987*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1988*   PLAN MASTER                                                  *
  1989*                                                                *
  1990*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1991*                                                                *
  1992*   FILE TYPE = VSAM,KSDS                                        *
  1993*   RECORD SIZE = 420   RECFORM = FIX                            *
  1994*                                                                *
  1995*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1996*       ALTERNATE PATH1 = N/A                                    *
  1997*                                                                *
  1998*   LOG = NO                                                     *
  1999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2000*                                                                *
  2001*                                                                *
  2002******************************************************************
  2003
  2004 01  PLAN-MASTER.
  2005     12  PL-RECORD-ID                      PIC XX.
  2006         88  VALID-PL-ID                      VALUE 'PL'.
  2007
  2008     12  PL-CONTROL-PRIMARY.
  2009         16  PL-COMPANY-CD                 PIC X.
  2010         16  PL-MSTR-CNTRL.
  2011             20  PL-CONTROL-A.
  2012                 24  PL-CARRIER            PIC X.
  2013                 24  PL-GROUPING           PIC X(6).
  2014                 24  PL-STATE              PIC XX.
  2015                 24  PL-ACCOUNT            PIC X(10).
  2016             20  PL-BENEFIT-TYPE           PIC X.
  2017             20  PL-BENEFIT-CODE           PIC XX.
  2018             20  PL-REVISION-NO            PIC X(3).
  2019
  2020     12  PL-CONTROL-BY-VAR-GRP.
  2021         16  PL-COMPANY-CD-A1              PIC X.
  2022         16  PL-VG-CARRIER                 PIC X.
  2023         16  PL-VG-GROUPING                PIC X(6).
  2024         16  PL-VG-STATE                   PIC XX.
  2025         16  PL-VG-ACCOUNT                 PIC X(10).
  2026         16  PL-BENEFIT-TYPE-A1            PIC X.
  2027         16  PL-BENEFIT-CODE-A1            PIC XX.
  2028         16  PL-REVISION-NO-A1             PIC 999.
  2029
  2030     12  PL-MAINT-INFORMATION.
  2031         16  PL-LAST-MAINT-DT              PIC XX.
  2032         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2033         16  PL-LAST-MAINT-USER            PIC X(4).
  2034         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  39
* EL050.cbl
  2035
  2036     12  PL-LIABILITY-LIMITS.
  2037         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2038         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2039             20  PL-LM-AGE                 PIC S99        COMP-3.
  2040             20  PL-LM-DUR                 PIC S999       COMP-3.
  2041             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2042             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2043
  2044     12  FILLER                            PIC X(30).
  2045
  2046     12  PL-GL-ACCOUNT-NOS.
  2047         16  PL-PREMIUM-GL                 PIC X(8).
  2048         16  PL-COMM-GL                    PIC X(8).
  2049         16  PL-CLAIM-GL                   PIC X(8).
  2050     12  FILLER                            PIC X(24).
  2051     12  PL-TOLERANCES.
  2052         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2053         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2054         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2055         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2056         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2057         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2058     12  PL-OVER-SHORT.
  2059         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2060         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2061     12  FILLER                            PIC X(24).
  2062     12  PLAN-MISC.
  2063         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2064         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2065         16  PL-IG                         PIC X.
  2066         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2067         16  PL-POLICY-FORM                PIC X(12).
  2068         16  PL-EDIT-FOR-FORM              PIC X(01).
  2069         16  PL-DEV-CODE                   PIC XXX.
  2070         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2071         16  PL-CALC-METHOD                PIC X.
  2072         16  PL-BENEFIT-GROUP              PIC X(05).
  2073         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2074
  2075         16  FILLER                        PIC X(99).
  2076******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  40
* EL050.cbl
  2078*    COPY ELCCERT.
  2079******************************************************************
  2080*                                                                *
  2081*                            ELCCERT.                            *
  2082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2083*                            VMOD=2.013                          *
  2084*                                                                *
  2085*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2086*                                                                *
  2087*   FILE TYPE = VSAM,KSDS                                        *
  2088*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2089*                                                                *
  2090*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2091*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2092*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2093*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2094*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2095*                                                                *
  2096*   LOG = YES                                                    *
  2097*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2098******************************************************************
  2099*                   C H A N G E   L O G
  2100*
  2101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2102*-----------------------------------------------------------------
  2103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2104* EFFECTIVE    NUMBER
  2105*-----------------------------------------------------------------
  2106* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2108* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2109* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2110* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2111* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2113* 032612  CR2011110200001  PEMA  AHL CHANGES
  2114* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2115******************************************************************
  2116
  2117 01  CERTIFICATE-MASTER.
  2118     12  CM-RECORD-ID                      PIC XX.
  2119         88  VALID-CM-ID                      VALUE 'CM'.
  2120
  2121     12  CM-CONTROL-PRIMARY.
  2122         16  CM-COMPANY-CD                 PIC X.
  2123         16  CM-CARRIER                    PIC X.
  2124         16  CM-GROUPING.
  2125             20  CM-GROUPING-PREFIX        PIC X(3).
  2126             20  CM-GROUPING-PRIME         PIC X(3).
  2127         16  CM-STATE                      PIC XX.
  2128         16  CM-ACCOUNT.
  2129             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2130             20  CM-ACCOUNT-PRIME          PIC X(6).
  2131         16  CM-CERT-EFF-DT                PIC XX.
  2132         16  CM-CERT-NO.
  2133             20  CM-CERT-PRIME             PIC X(10).
  2134             20  CM-CERT-SFX               PIC X.
  2135
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  41
* EL050.cbl
  2136     12  CM-CONTROL-BY-NAME.
  2137         16  CM-COMPANY-CD-A1              PIC X.
  2138         16  CM-INSURED-LAST-NAME          PIC X(15).
  2139         16  CM-INSURED-INITIALS.
  2140             20  CM-INSURED-INITIAL1       PIC X.
  2141             20  CM-INSURED-INITIAL2       PIC X.
  2142
  2143     12  CM-CONTROL-BY-SSN.
  2144         16  CM-COMPANY-CD-A2              PIC X.
  2145         16  CM-SOC-SEC-NO.
  2146             20  CM-SSN-STATE              PIC XX.
  2147             20  CM-SSN-ACCOUNT            PIC X(6).
  2148             20  CM-SSN-LN3.
  2149                 25  CM-INSURED-INITIALS-A2.
  2150                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2151                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2152                 25 CM-PART-LAST-NAME-A2         PIC X.
  2153
  2154     12  CM-CONTROL-BY-CERT-NO.
  2155         16  CM-COMPANY-CD-A4              PIC X.
  2156         16  CM-CERT-NO-A4                 PIC X(11).
  2157
  2158     12  CM-CONTROL-BY-MEMB.
  2159         16  CM-COMPANY-CD-A5              PIC X.
  2160         16  CM-MEMBER-NO.
  2161             20  CM-MEMB-STATE             PIC XX.
  2162             20  CM-MEMB-ACCOUNT           PIC X(6).
  2163             20  CM-MEMB-LN4.
  2164                 25  CM-INSURED-INITIALS-A5.
  2165                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2166                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2167                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2168
  2169     12  CM-INSURED-PROFILE-DATA.
  2170         16  CM-INSURED-FIRST-NAME.
  2171             20  CM-INSURED-1ST-INIT       PIC X.
  2172             20  FILLER                    PIC X(9).
  2173         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2174         16  CM-INSURED-SEX                PIC X.
  2175             88  CM-SEX-MALE                  VALUE 'M'.
  2176             88  CM-SEX-FEMAL                 VALUE 'F'.
  2177         16  CM-INSURED-JOINT-AGE          PIC 99.
  2178         16  CM-JOINT-INSURED-NAME.
  2179             20  CM-JT-LAST-NAME           PIC X(15).
  2180             20  CM-JT-FIRST-NAME.
  2181                 24  CM-JT-1ST-INIT        PIC X.
  2182                 24  FILLER                PIC X(9).
  2183             20  CM-JT-INITIAL             PIC X.
  2184
  2185     12  CM-LIFE-DATA.
  2186         16  CM-LF-BENEFIT-CD              PIC XX.
  2187         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2188         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2189         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2190         16  CM-LF-DEV-CODE                PIC XXX.
  2191         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2192         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  42
* EL050.cbl
  2194         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2197         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2198         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2199         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2200         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2201         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2202         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2203         16  cm-temp-epiq                  pic xx.
  2204             88  EPIQ-CLASS                  value 'EQ'.
  2205*        16  FILLER                        PIC XX.
  2206
  2207     12  CM-AH-DATA.
  2208         16  CM-AH-BENEFIT-CD              PIC XX.
  2209         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-AH-DEV-CODE                PIC XXX.
  2212         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2213         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2214         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2215         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2218         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2219         16  CM-AH-PAID-THRU-DT            PIC XX.
  2220             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2221         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2222         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2223         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2224         16  FILLER                        PIC X.
  2225
  2226     12  CM-LOAN-INFORMATION.
  2227         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2228         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2229                                           PIC S9(5)V99  COMP-3.
  2230         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2231         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2232         16  CM-PAY-FREQUENCY              PIC S99.
  2233         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2234         16  CM-RATE-CLASS                 PIC XX.
  2235         16  CM-BENEFICIARY                PIC X(25).
  2236         16  CM-POLICY-FORM-NO             PIC X(12).
  2237         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2238         16  CM-LAST-ADD-ON-DT             PIC XX.
  2239         16  CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2241             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2242         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2243             20  CM-RESIDENT-STATE         PIC XX.
  2244             20  CM-RATE-CODE              PIC X(4).
  2245             20  FILLER                    PIC XX.
  2246         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2247             20  CM-LOAN-OFFICER           PIC X(5).
  2248             20  FILLER                    PIC XXX.
  2249         16  CM-CSR-CODE                   PIC XXX.
  2250         16  CM-UNDERWRITING-CODE          PIC X.
  2251             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  43
* EL050.cbl
  2252         16  CM-POST-CARD-IND              PIC X.
  2253         16  CM-NH-INTERFACE-SW            PIC X.
  2254         16  CM-PREMIUM-TYPE               PIC X.
  2255             88  CM-SING-PRM                  VALUE '1'.
  2256             88  CM-O-B-COVERAGE              VALUE '2'.
  2257             88  CM-OPEN-END                  VALUE '3'.
  2258         16  CM-IND-GRP-TYPE               PIC X.
  2259             88  CM-INDIVIDUAL                VALUE 'I'.
  2260             88  CM-GROUP                     VALUE 'G'.
  2261         16  CM-SKIP-CODE                  PIC X.
  2262             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2263             88  SKIP-JULY                    VALUE '1'.
  2264             88  SKIP-AUGUST                  VALUE '2'.
  2265             88  SKIP-SEPTEMBER               VALUE '3'.
  2266             88  SKIP-JULY-AUG                VALUE '4'.
  2267             88  SKIP-AUG-SEPT                VALUE '5'.
  2268             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2269             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2270             88  SKIP-JUNE                    VALUE '8'.
  2271             88  SKIP-JUNE-JULY               VALUE '9'.
  2272             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2273             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2274         16  CM-PAYMENT-MODE               PIC X.
  2275             88  PAY-MONTHLY                  VALUE SPACE.
  2276             88  PAY-WEEKLY                   VALUE '1'.
  2277             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2278             88  PAY-BI-WEEKLY                VALUE '3'.
  2279             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2280         16  CM-LOAN-NUMBER                PIC X(8).
  2281         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2282         16  CM-OLD-LOF                    PIC XXX.
  2283*        16  CM-LOAN-OFFICER               PIC XXX.
  2284         16  CM-REIN-TABLE                 PIC XXX.
  2285         16  CM-SPECIAL-REIN-CODE          PIC X.
  2286         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2287         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2288         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2289
  2290     12  CM-STATUS-DATA.
  2291         16  CM-ENTRY-STATUS               PIC X.
  2292         16  CM-ENTRY-DT                   PIC XX.
  2293
  2294         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-LF-CANCEL-DT               PIC XX.
  2296         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2299         16  CM-LF-DEATH-DT                PIC XX.
  2300         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2301
  2302         16  CM-LF-CURRENT-STATUS          PIC X.
  2303             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2307             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  44
* EL050.cbl
  2310             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2311             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2312             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2313             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2314             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2315             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2316             88  CM-LF-DECLINED               VALUE 'D'.
  2317             88  CM-LF-VOIDED                 VALUE 'V'.
  2318
  2319         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2320         16  CM-AH-CANCEL-DT               PIC XX.
  2321         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2322
  2323         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2324         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2325         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2326
  2327         16  CM-AH-CURRENT-STATUS          PIC X.
  2328             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2329                                                'M' '4' '5' '9'.
  2330             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2331             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2332             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2333             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2334             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2335             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2336             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2337             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2338             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2339             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2340             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2341             88  CM-AH-DECLINED               VALUE 'D'.
  2342             88  CM-AH-VOIDED                 VALUE 'V'.
  2343
  2344         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2345             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2346             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2347             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2348         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2349
  2350         16  CM-ENTRY-BATCH                PIC X(6).
  2351         16  CM-LF-EXIT-BATCH              PIC X(6).
  2352         16  CM-AH-EXIT-BATCH              PIC X(6).
  2353         16  CM-LAST-MONTH-END             PIC XX.
  2354
  2355     12  CM-NOTE-SW                        PIC X.
  2356         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2357         88  CERT-NOTES-PRESENT               VALUE '1'.
  2358         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2359         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2360         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2361         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2362         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2363         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2364     12  CM-COMP-EXCP-SW                   PIC X.
  2365         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2366         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2367     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  45
* EL050.cbl
  2368         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2369         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2370
  2371*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2372     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2373     12  FILLER                            PIC X.
  2374
  2375*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2376     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2377     12  FILLER                            PIC X.
  2378*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2379     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2380
  2381     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2382         88  CERT-ADDED-BATCH                 VALUE ' '.
  2383         88  CERT-ADDED-ONLINE                VALUE '1'.
  2384         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2385         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2386         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2387     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2388         88  CERT-AS-LOADED                   VALUE ' '.
  2389         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2390         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2391         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2392         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2393         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2394         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2395         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2396
  2397     12  CM-ACCOUNT-COMM-PCTS.
  2398         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2399         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2400
  2401     12  CM-USER-FIELD                     PIC X.
  2402     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2403     12  CM-CLP-STATE                      PIC XX.
  2404     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2405     12  CM-USER-RESERVED                  PIC XXX.
  2406     12  FILLER REDEFINES CM-USER-RESERVED.
  2407         16  CM-AH-CLASS-CD                PIC XX.
  2408         16  F                             PIC X.
  2409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  46
* EL050.cbl
  2411*    COPY ERCMAIL.
  2412******************************************************************
  2413*                                                                *
  2414*                                                                *
  2415*                            ERCMAIL                             *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.003                          *
  2418*                                                                *
  2419*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2420*                                                                *
  2421*   FILE TYPE = VSAM,KSDS                                        *
  2422*   RECORD SIZE = 374   RECFORM = FIX                            *
  2423*                                                                *
  2424*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2425*   ALTERNATE PATH    = NOT USED                                 *
  2426*                                                                *
  2427*   LOG = YES                                                    *
  2428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2429******************************************************************
  2430*                   C H A N G E   L O G
  2431*
  2432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2433*-----------------------------------------------------------------
  2434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2435* EFFECTIVE    NUMBER
  2436*-----------------------------------------------------------------
  2437* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2438* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2439* 111108                   PEMA  ADD CRED BENE ADDR2
  2440******************************************************************
  2441
  2442 01  MAILING-DATA.
  2443     12  MA-RECORD-ID                      PIC XX.
  2444         88  VALID-MA-ID                       VALUE 'MA'.
  2445
  2446     12  MA-CONTROL-PRIMARY.
  2447         16  MA-COMPANY-CD                 PIC X.
  2448         16  MA-CARRIER                    PIC X.
  2449         16  MA-GROUPING.
  2450             20  MA-GROUPING-PREFIX        PIC XXX.
  2451             20  MA-GROUPING-PRIME         PIC XXX.
  2452         16  MA-STATE                      PIC XX.
  2453         16  MA-ACCOUNT.
  2454             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2455             20  MA-ACCOUNT-PRIME          PIC X(6).
  2456         16  MA-CERT-EFF-DT                PIC XX.
  2457         16  MA-CERT-NO.
  2458             20  MA-CERT-PRIME             PIC X(10).
  2459             20  MA-CERT-SFX               PIC X.
  2460
  2461     12  FILLER                            PIC XX.
  2462
  2463     12  MA-ACCESS-CONTROL.
  2464         16  MA-SOURCE-SYSTEM              PIC XX.
  2465             88  MA-FROM-CREDIT                VALUE 'CR'.
  2466             88  MA-FROM-VSI                   VALUE 'VS'.
  2467             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2468             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  47
* EL050.cbl
  2469         16  MA-RECORD-ADD-DT              PIC XX.
  2470         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2471         16  MA-LAST-MAINT-DT              PIC XX.
  2472         16  MA-LAST-MAINT-BY              PIC XXXX.
  2473         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2474
  2475     12  MA-PROFILE-INFO.
  2476         16  MA-QUALIFY-CODE-1             PIC XX.
  2477         16  MA-QUALIFY-CODE-2             PIC XX.
  2478         16  MA-QUALIFY-CODE-3             PIC XX.
  2479         16  MA-QUALIFY-CODE-4             PIC XX.
  2480         16  MA-QUALIFY-CODE-5             PIC XX.
  2481
  2482         16  MA-INSURED-LAST-NAME          PIC X(15).
  2483         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2484         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2485         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2486         16  MA-INSURED-BIRTH-DT           PIC XX.
  2487         16  MA-INSURED-SEX                PIC X.
  2488             88  MA-SEX-MALE                   VALUE 'M'.
  2489             88  MA-SEX-FEMALE                 VALUE 'F'.
  2490         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2491
  2492         16  MA-ADDRESS-CORRECTED          PIC X.
  2493         16  MA-JOINT-BIRTH-DT             PIC XX.
  2494*        16  FILLER                        PIC X(12).
  2495
  2496         16  MA-ADDRESS-LINE-1             PIC X(30).
  2497         16  MA-ADDRESS-LINE-2             PIC X(30).
  2498         16  MA-CITY-STATE.
  2499             20  MA-CITY                   PIC X(28).
  2500             20  MA-ADDR-STATE             PIC XX.
  2501         16  MA-ZIP.
  2502             20  MA-ZIP-CODE.
  2503                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2504                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2505                 24  FILLER                PIC X(4).
  2506             20  MA-ZIP-PLUS4              PIC X(4).
  2507         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2508             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2509             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2510             20  FILLER                    PIC X(3).
  2511
  2512         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2513
  2514         16  FILLER                        PIC XXX.
  2515*        16  FILLER                        PIC X(10).
  2516
  2517     12  MA-CRED-BENE-INFO.
  2518         16  MA-CRED-BENE-NAME                 PIC X(25).
  2519         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2520         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2521         16  MA-CRED-BENE-CTYST.
  2522             20  MA-CRED-BENE-CITY             PIC X(28).
  2523             20  MA-CRED-BENE-STATE            PIC XX.
  2524         16  MA-CRED-BENE-ZIP.
  2525             20  MA-CB-ZIP-CODE.
  2526                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  48
* EL050.cbl
  2527                     88  MA-CB-CANADIAN-POST-CODE
  2528                                           VALUE 'A' THRU 'Z'.
  2529                 24  FILLER                    PIC X(4).
  2530             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2531         16  MA-CB-CANADIAN-POSTAL-CODE
  2532                            REDEFINES MA-CRED-BENE-ZIP.
  2533             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2534             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2535             20  FILLER                        PIC X(3).
  2536     12  MA-POST-CARD-MAIL-DATA.
  2537         16  MA-MAIL-DATA OCCURS 7.
  2538             20  MA-MAIL-TYPE              PIC X.
  2539                 88  MA-12MO-MAILING           VALUE '1'.
  2540                 88  MA-EXP-MAILING            VALUE '2'.
  2541             20  MA-MAIL-STATUS            PIC X.
  2542                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2543                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2544                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2545             20  MA-MAIL-DATE              PIC XX.
  2546     12  FILLER                            PIC XX.
  2547     12  FILLER                            PIC XX.
  2548*    12  FILLER                            PIC X(30).
  2549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  49
* EL050.cbl
  2551*    COPY ERCPNDM.
  2552******************************************************************
  2553*                                                                *
  2554*                                                                *
  2555*                            ERCPNDM                             *
  2556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2557*                            VMOD=2.003                          *
  2558*                                                                *
  2559*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2560*                                                                *
  2561*   FILE TYPE = VSAM,KSDS                                        *
  2562*   RECORD SIZE = 374   RECFORM = FIX                            *
  2563*                                                                *
  2564*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2565*   ALTERNATE PATH    = NOT USED                                 *
  2566*                                                                *
  2567*   LOG = YES                                                    *
  2568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2578* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2579* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2580******************************************************************
  2581
  2582 01  PENDING-MAILING-DATA.
  2583     12  PM-RECORD-ID                      PIC XX.
  2584         88  VALID-MA-ID                       VALUE 'PM'.
  2585
  2586     12  PM-CONTROL-PRIMARY.
  2587         16  PM-COMPANY-CD                 PIC X.
  2588         16  PM-ENTRY-BATCH                PIC X(6).
  2589         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2590         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2591
  2592     12  FILLER                            PIC X(14).
  2593
  2594     12  PM-ACCESS-CONTROL.
  2595         16  PM-SOURCE-SYSTEM              PIC XX.
  2596             88  PM-FROM-CREDIT                VALUE 'CR'.
  2597             88  PM-FROM-VSI                   VALUE 'VS'.
  2598             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2599             88  PM-FROM-OTHER                 VALUE 'OT'.
  2600         16  PM-RECORD-ADD-DT              PIC XX.
  2601         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2602         16  PM-LAST-MAINT-DT              PIC XX.
  2603         16  PM-LAST-MAINT-BY              PIC XXXX.
  2604         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2605
  2606     12  PM-PROFILE-INFO.
  2607         16  PM-QUALIFY-CODE-1             PIC XX.
  2608         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  50
* EL050.cbl
  2609         16  PM-QUALIFY-CODE-3             PIC XX.
  2610         16  PM-QUALIFY-CODE-4             PIC XX.
  2611         16  PM-QUALIFY-CODE-5             PIC XX.
  2612
  2613         16  PM-INSURED-LAST-NAME          PIC X(15).
  2614         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2615         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2616         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2617         16  PM-INSURED-BIRTH-DT           PIC XX.
  2618         16  PM-INSURED-SEX                PIC X.
  2619             88  PM-SEX-MALE                   VALUE 'M'.
  2620             88  PM-SEX-FEMALE                 VALUE 'F'.
  2621         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2622
  2623         16  PM-ADDRESS-CORRECTED          PIC X.
  2624         16  PM-JOINT-BIRTH-DT             PIC XX.
  2625*        16  FILLER                        PIC X(12).
  2626
  2627         16  PM-ADDRESS-LINE-1             PIC X(30).
  2628         16  PM-ADDRESS-LINE-2             PIC X(30).
  2629         16  PM-CITY-STATE.
  2630             20  PM-CITY                   PIC X(28).
  2631             20  PM-STATE                  PIC XX.
  2632         16  PM-ZIP.
  2633             20  PM-ZIP-CODE.
  2634                 24  PM-ZIP-1              PIC X.
  2635                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2636                 24  FILLER                PIC X(4).
  2637             20  PM-ZIP-PLUS4              PIC X(4).
  2638         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2639             20  PM-CAN-POST1              PIC XXX.
  2640             20  PM-CAN-POST2              PIC XXX.
  2641             20  FILLER                    PIC XXX.
  2642
  2643         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2644
  2645         16  FILLER                        PIC X(03).
  2646
  2647     12  PM-CRED-BENE-INFO.
  2648         16  PM-CRED-BENE-NAME             PIC X(25).
  2649         16  PM-CRED-BENE-ADDR             PIC X(30).
  2650         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2651         16  PM-CRED-BENE-CTYST.
  2652             20  PM-CRED-BENE-CITY         PIC X(28).
  2653             20  PM-CRED-BENE-STATE        PIC XX.
  2654         16  PM-CRED-BENE-ZIP.
  2655             20  PM-CB-ZIP-CODE.
  2656                 24  PM-CB-ZIP-1           PIC X.
  2657                     88  PM-CB-CANADIAN-POST-CODE
  2658                                  VALUE 'A' THRU 'Z'.
  2659                 24  FILLER                PIC X(4).
  2660             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2661         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2662             20  PM-CB-CAN-POST1           PIC XXX.
  2663             20  PM-CB-CAN-POST2           PIC XXX.
  2664             20  FILLER                    PIC XXX.
  2665     12  PM-POST-CARD-MAIL-DATA.
  2666         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  51
* EL050.cbl
  2667             20  PM-MAIL-TYPE              PIC X.
  2668                 88  PM-12MO-MAILING           VALUE '1'.
  2669                 88  PM-EXP-MAILING            VALUE '2'.
  2670             20  PM-MAIL-STATUS            PIC X.
  2671                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2672                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2673                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2674             20  PM-MAIL-DATE              PIC XX.
  2675     12  FILLER                            PIC XX.
  2676     12  FILLER                            PIC X(12).
  2677*    12  FILLER                            PIC X(30).
  2678
  2679******************************************************************
  2680*                                COPY ERCLOFC.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCLOFC                             *
  2685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2686*                            VMOD=2.003                          *
  2687*                                                                *
  2688*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2689*                                                                *
  2690*   FILE TYPE = VSAM,KSDS                                        *
  2691*   RECORD SIZE = 670   RECFORM = FIX                            *
  2692*                                                                *
  2693*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2694*                                                                *
  2695*   LOG = YES                                                    *
  2696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2697*                                                                *
  2698******************************************************************
  2699
  2700 01  LOAN-OFFICER-MASTER.
  2701     12  LO-RECORD-ID                PIC XX.
  2702         88  VALID-LO-ID                VALUE 'LO'.
  2703
  2704     12  LO-CONTROL-PRIMARY.
  2705         16  LO-COMPANY-CD           PIC X.
  2706         16  LO-CARRIER              PIC X.
  2707         16  LO-GROUPING.
  2708             20  LO-GROUPING-PREFIX  PIC XXX.
  2709             20  LO-GROUPING-PRIME   PIC XXX.
  2710         16  LO-STATE                PIC XX.
  2711         16  LO-ACCOUNT.
  2712             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2713             20  LO-ACCOUNT-PRIME    PIC X(6).
  2714         16  LO-OFFICER-CODE         PIC X(5).
  2715
  2716     12  LO-OFFICER-NAME             PIC X(30).
  2717
  2718     12  LO-LAST-MAINT-DT            PIC XX.
  2719     12  LO-LAST-USER                PIC X(4).
  2720     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2721
  2722     12  LO-COMP-CONTROL             PIC X.
  2723             88  LO-SHOW-COMP           VALUE 'Y'.
  2724             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  52
* EL050.cbl
  2725     12  LO-DETAIL-CONTROL           PIC X.
  2726             88  LO-PRINT-DETAIL        VALUE 'D'.
  2727             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2728
  2729     12  LO-SV-CARRIER               PIC X.
  2730     12  LO-SV-GROUPING              PIC X(6).
  2731     12  LO-SV-STATE                 PIC XX.
  2732
  2733     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2734     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2735
  2736     12  LO-OFFICER-INFO.
  2737         16  FILLER OCCURS 12 TIMES.
  2738             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2739             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2740             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2741             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2742             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2743             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2744             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2745             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2746     12  FILLER                      PIC X(198).
  2747******************************************************************
  2748*                                COPY ERCPDEF.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ERCPDEF.                            *
  2753*                                                                *
  2754*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2755*                                                                *
  2756*    FILE TYPE = VSAM,KSDS                                       *
  2757*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2758*                                                                *
  2759*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2760*                                                                *
  2761*    LOG = YES                                                   *
  2762*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2763******************************************************************
  2764*                   C H A N G E   L O G
  2765*
  2766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2767*-----------------------------------------------------------------
  2768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2769* EFFECTIVE    NUMBER
  2770*-----------------------------------------------------------------
  2771* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2772* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2773* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2774******************************************************************
  2775 01  PRODUCT-MASTER.
  2776    12  PD-RECORD-ID                 PIC X(02).
  2777        88  VALID-PD-ID                  VALUE 'PD'.
  2778    12  PD-CONTROL-PRIMARY.
  2779        16  PD-COMPANY-CD            PIC X.
  2780        16  PD-STATE                 PIC XX.
  2781        16  PD-PRODUCT-CD            PIC XXX.
  2782        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  53
* EL050.cbl
  2783        16  PD-BEN-TYPE              PIC X.
  2784        16  PD-BEN-CODE              PIC XX.
  2785        16  PD-PROD-EXP-DT           PIC XX.
  2786    12  FILLER                       PIC X(50).
  2787    12  PD-PRODUCT-DATA OCCURS 8.
  2788        16  PD-PROD-CODE             PIC X.
  2789            88  PD-PROD-LIFE           VALUE 'L'.
  2790            88  PD-PROD-PROP           VALUE 'P'.
  2791            88  PD-PROD-AH             VALUE 'A'.
  2792            88  PD-PROD-IU             VALUE 'I'.
  2793            88  PD-PROD-GAP            VALUE 'G'.
  2794            88  PD-PROD-FAML           VALUE 'F'.
  2795        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2796        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2797        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2798        16  PD-MAX-TERM              PIC S999        COMP-3.
  2799        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2800        16  FILLER                   PIC X.
  2801        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2802        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2803        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2804        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2805        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2806        16  PD-REC-CRIT-PERIOD       PIC 99.
  2807        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2808            20  PD-RECURRING-YN      PIC X.
  2809            20  FILLER               PIC X.
  2810        16  PD-RTW-MOS               PIC 99.
  2811        16  PD-MAX-EXTENSION         PIC 99.
  2812        16  pd-ben-pct               pic sv999 comp-3.
  2813*       16  FILLER                   PIC XX.
  2814    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2815    12  PD-TERM-LIMITS OCCURS 15.
  2816        16  PD-LOW-TERM              PIC S999        COMP-3.
  2817        16  PD-HI-TERM               PIC S999        COMP-3.
  2818*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2819    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2820        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2821        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2822    12  PD-EARN-FACTORS.
  2823        16  FILLER OCCURS 15.
  2824            20  FILLER OCCURS 15.
  2825                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2826    12  PD-PRODUCT-DESC              PIC X(80).
  2827    12  PD-TRUNCATED                 PIC X.
  2828    12  FILLER                       PIC X(59).
  2829    12  PD-MAINT-INFORMATION.
  2830        16  PD-LAST-MAINT-DT         PIC X(02).
  2831        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2832        16  PD-LAST-MAINT-BY         PIC X(04).
  2833*                                COPY ELCSTATE.
  2834******************************************************************
  2835*                                                                *
  2836*                                                                *
  2837*                            ELCSTATE.                           *
  2838*                                                                *
  2839*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2840*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  54
* EL050.cbl
  2841*   FILE TYPE = VSAM,KSDS                                        *
  2842*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2843*                                                                *
  2844*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2845*       ALTERNATE INDEX = NONE                                   *
  2846*                                                                *
  2847*   LOG = YES                                                    *
  2848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2849******************************************************************
  2850*                   C H A N G E   L O G
  2851*
  2852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2853*-----------------------------------------------------------------
  2854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2855* EFFECTIVE    NUMBER
  2856*-----------------------------------------------------------------
  2857* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2858******************************************************************
  2859*
  2860 01  STATE-FILE.
  2861     12  SF-RECORD-ID                       PIC XX.
  2862         88  VALID-CF-ID                        VALUE 'SF'.
  2863     12  SF-CONTROL-PRIMARY.
  2864         16  SF-COMPANY-ID                  PIC XXX.
  2865         16  SF-CARRIER-CODE                PIC X.
  2866         16  SF-GROUPING                    PIC X(6).
  2867         16  SF-STATE-CODE                  PIC XX.
  2868         16  SF-EXPIRE-DATE                 PIC 9(8).
  2869****************************************************************
  2870*             STATE CONTROLS
  2871****************************************************************
  2872     12  SF-LAST-MAINT-DT                   PIC XX.
  2873     12  SF-LAST-MAINT-BY                   PIC X(4).
  2874     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2875     12  SF-STATE-RT-CONTROLS.
  2876         16  SF-ST-RT-CALC                  PIC X.
  2877     12  SF-ST-TAX-CONTROLS.
  2878         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2879         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2880         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2881     12  SF-ST-REFUND-OPTIONS.
  2882         16  SF-ST-RF-LR-CALC               PIC X.
  2883         16  SF-ST-RF-LL-CALC               PIC X.
  2884         16  SF-ST-RF-LN-CALC               PIC X.
  2885         16  SF-ST-RF-AH-CALC               PIC X.
  2886         16  SF-ST-RF-CP-CALC               PIC X.
  2887     12  SF-ST-UNEARN-PREM-OPTIONS.
  2888         16  SF-ST-LUEP-R78                 PIC X.
  2889         16  SF-ST-LUEP-PRO                 PIC X.
  2890         16  SF-ST-LUEP-ST                  PIC X.
  2891         16  SF-ST-LUEP-DOM                 PIC X.
  2892         16  SF-ST-AUEP-R78                 PIC X.
  2893         16  SF-ST-AUEP-PRO                 PIC X.
  2894         16  SF-ST-AUEP-ST                  PIC X.
  2895         16  SF-ST-AUEP-DOM                 PIC X.
  2896         16  SF-ST-CUEP-R78                 PIC X.
  2897         16  SF-ST-CUEP-PRO                 PIC X.
  2898         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  55
* EL050.cbl
  2899         16  SF-ST-CUEP-DOM                 PIC X.
  2900     12  SF-ST-EARN-PREM-OPTIONS.
  2901         16  SF-ST-LEP-R78                  PIC X.
  2902         16  SF-ST-LEP-PRO                  PIC X.
  2903         16  SF-ST-LEP-ST                   PIC X.
  2904         16  SF-ST-LEP-DOM                  PIC X.
  2905         16  SF-ST-AEP-R78                  PIC X.
  2906         16  SF-ST-AEP-PRO                  PIC X.
  2907         16  SF-ST-AEP-ST                   PIC X.
  2908         16  SF-ST-AEP-DOM                  PIC X.
  2909         16  SF-ST-CEP-R78                  PIC X.
  2910         16  SF-ST-CEP-PRO                  PIC X.
  2911         16  SF-ST-CEP-ST                   PIC X.
  2912         16  SF-ST-CEP-DOM                  PIC X.
  2913     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  56
* EL050.cbl
  2915*    COPY ELCCRTT.
  2916******************************************************************
  2917*                                                                *
  2918*                            ELCCRTT.                            *
  2919*                                                                *
  2920*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2921*                                                                *
  2922*   FILE TYPE = VSAM,KSDS                                        *
  2923*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2924*                                                                *
  2925*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2926*                                                                *
  2927*   LOG = YES                                                    *
  2928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2929******************************************************************
  2930*                   C H A N G E   L O G
  2931*
  2932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2933*-----------------------------------------------------------------
  2934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2935* EFFECTIVE    NUMBER
  2936*-----------------------------------------------------------------
  2937* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2938* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2939* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2940* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2941* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2942* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2943* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2944******************************************************************
  2945
  2946 01  CERTIFICATE-TRAILERS.
  2947     12  CS-RECORD-ID                      PIC XX.
  2948         88  VALID-CS-ID                      VALUE 'CS'.
  2949
  2950     12  CS-CONTROL-PRIMARY.
  2951         16  CS-COMPANY-CD                 PIC X.
  2952         16  CS-CARRIER                    PIC X.
  2953         16  CS-GROUPING                   PIC X(6).
  2954         16  CS-STATE                      PIC XX.
  2955         16  CS-ACCOUNT                    PIC X(10).
  2956         16  CS-CERT-EFF-DT                PIC XX.
  2957         16  CS-CERT-NO.
  2958             20  CS-CERT-PRIME             PIC X(10).
  2959             20  CS-CERT-SFX               PIC X.
  2960         16  CS-TRAILER-TYPE               PIC X.
  2961             88  COMM-TRLR           VALUE 'A'.
  2962             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2963             88  CERT-DATA-TRLR      VALUE 'C'.
  2964
  2965     12  CS-DATA-AREA                      PIC X(516).
  2966
  2967     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2968         16  CS-BANK-COMMISSION-AREA.
  2969             20  CS-BANK-COMMS       OCCURS 10.
  2970                 24  CS-AGT                PIC X(10).
  2971                 24  CS-COM-TYP            PIC X.
  2972                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  57
* EL050.cbl
  2973                 24  CS-RECALC-LV-INDIC    PIC X.
  2974                 24  FILLER                PIC X(10).
  2975         16  FILLER                        PIC X(256).
  2976
  2977     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2978****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2979         16  CS-MB-CLAIM-DATA OCCURS 24.
  2980             20  CS-CLAIM-NO               PIC X(7).
  2981             20  CS-CLAIM-TYPE             PIC X.
  2982                 88  CS-AH-CLM               VALUE 'A'.
  2983                 88  CS-IU-CLM               VALUE 'I'.
  2984                 88  CS-GP-CLM               VALUE 'G'.
  2985                 88  CS-LF-CLM               VALUE 'L'.
  2986                 88  CS-PR-CLM               VALUE 'P'.
  2987                 88  CS-FL-CLM               VALUE 'F'.
  2988             20  CS-INSURED-TYPE           PIC X.
  2989                 88  CS-PRIM-INSURED          VALUE 'P'.
  2990                 88  CS-CO-BORROWER           VALUE 'C'.
  2991             20  CS-BENEFIT-PERIOD         PIC 99.
  2992             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2993             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2994             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2995         16  FILLER                        PIC X(12).
  2996     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2997         16  CS-VIN-NUMBER                 PIC X(17).
  2998         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2999         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3000         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3001         16  FILLER                        PIC X(496).
  3002*    COPY ELCCRTO.
  3003******************************************************************
  3004*                                                                *
  3005*                            ELCCRTO.                            *
  3006*                                                                *
  3007*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3008*                                                                *
  3009*   FILE TYPE = VSAM,KSDS                                        *
  3010*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3011*                                                                *
  3012*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3013*                                                                *
  3014*   LOG = YES                                                    *
  3015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3016******************************************************************
  3017*                   C H A N G E   L O G
  3018*
  3019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3020*-----------------------------------------------------------------
  3021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3022* EFFECTIVE    NUMBER
  3023*-----------------------------------------------------------------
  3024* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3025* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3026* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3027* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3028* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3029******************************************************************
  3030 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  58
* EL050.cbl
  3031     12  OC-RECORD-ID                      PIC XX.
  3032         88  VALID-OC-ID                      VALUE 'OC'.
  3033     12  OC-CONTROL-PRIMARY.
  3034         16  OC-COMPANY-CD                 PIC X.
  3035         16  OC-CARRIER                    PIC X.
  3036         16  OC-GROUPING                   PIC X(6).
  3037         16  OC-STATE                      PIC XX.
  3038         16  OC-ACCOUNT                    PIC X(10).
  3039         16  OC-CERT-EFF-DT                PIC XX.
  3040         16  OC-CERT-NO.
  3041             20  OC-CERT-PRIME             PIC X(10).
  3042             20  OC-CERT-SFX               PIC X.
  3043         16  OC-RECORD-TYPE                PIC X.
  3044         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3045     12  OC-LAST-MAINT-DT                  PIC XX.
  3046     12  OC-LAST-MAINT-BY                  PIC X(4).
  3047     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3048     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3049     12  FILLER                            PIC X(49).
  3050     12  OC-ORIG-REC.
  3051         16  OC-INS-LAST-NAME              PIC X(15).
  3052         16  OC-INS-FIRST-NAME             PIC X(10).
  3053         16  OC-INS-MIDDLE-INIT            PIC X.
  3054         16  OC-INS-AGE                    PIC S999     COMP-3.
  3055         16  OC-JNT-LAST-NAME              PIC X(15).
  3056         16  OC-JNT-FIRST-NAME             PIC X(10).
  3057         16  OC-JNT-MIDDLE-INIT            PIC X.
  3058         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3059         16  OC-LF-BENCD                   PIC XX.
  3060         16  OC-LF-TERM                    PIC S999      COMP-3.
  3061         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3062         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3063         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3064         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3065         16  OC-LF-EXP-DT                  PIC XX.
  3066         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3067         16  OC-LF-CANCEL-DT               PIC XX.
  3068         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3069         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3070         16  OC-AH-BENCD                   PIC XX.
  3071         16  OC-AH-TERM                    PIC S999      COMP-3.
  3072         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3073         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3074         16  OC-AH-EXP-DT                  PIC XX.
  3075         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3076         16  OC-AH-CP                      PIC 99.
  3077         16  OC-AH-CANCEL-DT               PIC XX.
  3078         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3079         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3080         16  OC-CRED-BENE-NAME             PIC X(25).
  3081         16  OC-1ST-PMT-DT                 PIC XX.
  3082         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3083         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3084         16  OC-ISSUE-TRAN-IND             PIC X.
  3085         16  OC-CANCEL-TRAN-IND            PIC X.
  3086         16  FILLER                        PIC X(211).
  3087
  3088     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  59
* EL050.cbl
  3089******************************************************************
  3090
  3091*    COPY ELCDATE.
  3092******************************************************************
  3093*                                                                *
  3094*                                                                *
  3095*                            ELCDATE.                            *
  3096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3097*                            VMOD=2.003
  3098*                                                                *
  3099*                                                                *
  3100*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3101*                 LENGTH = 200                                   *
  3102******************************************************************
  3103
  3104 01  DATE-CONVERSION-DATA.
  3105     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3106     12  DC-OPTION-CODE                PIC X.
  3107         88  BIN-TO-GREG                VALUE ' '.
  3108         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3109         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3110         88  YMD-GREG-TO-BIN            VALUE '3'.
  3111         88  MDY-GREG-TO-BIN            VALUE '4'.
  3112         88  JULIAN-TO-BIN              VALUE '5'.
  3113         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3114         88  FIND-CENTURY               VALUE '7'.
  3115         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3116         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3117         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3118         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3119         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3120         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3121         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3122         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3123         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3124         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3125         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3126         88  BIN-3-TO-GREG              VALUE 'I'.
  3127         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3128         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3129         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3130         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3131         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3132         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3133         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3134         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3135         88  THREE-CHARACTER-BIN
  3136                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3137         88  GREGORIAN-TO-BIN
  3138                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3139         88  BIN-TO-GREGORIAN
  3140                  VALUES ' ' '1' 'I' '8' 'G'.
  3141         88  JULIAN-TO-BINARY
  3142                  VALUES '5' 'C' 'E' 'F'.
  3143     12  DC-ERROR-CODE                 PIC X.
  3144         88  NO-CONVERSION-ERROR        VALUE ' '.
  3145         88  DATE-CONVERSION-ERROR
  3146                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  60
* EL050.cbl
  3147         88  DATE-IS-ZERO               VALUE '1'.
  3148         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3149         88  DATE-IS-INVALID            VALUE '3'.
  3150         88  DATE1-GREATER-DATE2        VALUE '4'.
  3151         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3152         88  DATE-INVALID-OPTION        VALUE '9'.
  3153         88  INVALID-CENTURY            VALUE 'A'.
  3154         88  ONLY-CENTURY               VALUE 'B'.
  3155         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3156         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3157     12  DC-END-OF-MONTH               PIC X.
  3158         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3159     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3160         88  USE-NORMAL-PROCESS         VALUE ' '.
  3161         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3162         88  ADJUST-UP-100-YRS          VALUE '2'.
  3163     12  FILLER                        PIC X.
  3164     12  DC-CONVERSION-DATES.
  3165         16  DC-BIN-DATE-1             PIC XX.
  3166         16  DC-BIN-DATE-2             PIC XX.
  3167         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3168         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3169                       DC-GREG-DATE-1-EDIT.
  3170             20  DC-EDIT1-MONTH        PIC 99.
  3171             20  SLASH1-1              PIC X.
  3172             20  DC-EDIT1-DAY          PIC 99.
  3173             20  SLASH1-2              PIC X.
  3174             20  DC-EDIT1-YEAR         PIC 99.
  3175         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3176         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3177                     DC-GREG-DATE-2-EDIT.
  3178             20  DC-EDIT2-MONTH        PIC 99.
  3179             20  SLASH2-1              PIC X.
  3180             20  DC-EDIT2-DAY          PIC 99.
  3181             20  SLASH2-2              PIC X.
  3182             20  DC-EDIT2-YEAR         PIC 99.
  3183         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3184         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3185                     DC-GREG-DATE-1-YMD.
  3186             20  DC-YMD-YEAR           PIC 99.
  3187             20  DC-YMD-MONTH          PIC 99.
  3188             20  DC-YMD-DAY            PIC 99.
  3189         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3190         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3191                      DC-GREG-DATE-1-MDY.
  3192             20  DC-MDY-MONTH          PIC 99.
  3193             20  DC-MDY-DAY            PIC 99.
  3194             20  DC-MDY-YEAR           PIC 99.
  3195         16  DC-GREG-DATE-1-ALPHA.
  3196             20  DC-ALPHA-MONTH        PIC X(10).
  3197             20  DC-ALPHA-DAY          PIC 99.
  3198             20  FILLER                PIC XX.
  3199             20  DC-ALPHA-CENTURY.
  3200                 24 DC-ALPHA-CEN-N     PIC 99.
  3201             20  DC-ALPHA-YEAR         PIC 99.
  3202         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3203         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3204         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  61
* EL050.cbl
  3205         16  DC-JULIAN-DATE            PIC 9(05).
  3206         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3207                                       PIC 9(05).
  3208         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3209             20  DC-JULIAN-YEAR        PIC 99.
  3210             20  DC-JULIAN-DAYS        PIC 999.
  3211         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3212         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3213         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3214     12  DATE-CONVERSION-VARIBLES.
  3215         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3216         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3217             20  FILLER                PIC 9(3).
  3218             20  HOLD-CEN-1-CCYY.
  3219                 24  HOLD-CEN-1-CC     PIC 99.
  3220                 24  HOLD-CEN-1-YY     PIC 99.
  3221             20  HOLD-CEN-1-MO         PIC 99.
  3222             20  HOLD-CEN-1-DA         PIC 99.
  3223         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3224             20  HOLD-CEN-1-R-MO       PIC 99.
  3225             20  HOLD-CEN-1-R-DA       PIC 99.
  3226             20  HOLD-CEN-1-R-CCYY.
  3227                 24  HOLD-CEN-1-R-CC   PIC 99.
  3228                 24  HOLD-CEN-1-R-YY   PIC 99.
  3229             20  FILLER                PIC 9(3).
  3230         16  HOLD-CENTURY-1-X.
  3231             20  FILLER                PIC X(3)  VALUE SPACES.
  3232             20  HOLD-CEN-1-X-CCYY.
  3233                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3234                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3235             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3236             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3237         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3238             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3239             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3240             20  HOLD-CEN-1-R-X-CCYY.
  3241                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3242                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3243             20  FILLER                PIC XXX.
  3244         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3245         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3246         16  DC-JULIAN-DATE-1          PIC 9(07).
  3247         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3248             20  DC-JULIAN-1-CCYY.
  3249                 24  DC-JULIAN-1-CC    PIC 99.
  3250                 24  DC-JULIAN-1-YR    PIC 99.
  3251             20  DC-JULIAN-DA-1        PIC 999.
  3252         16  DC-JULIAN-DATE-2          PIC 9(07).
  3253         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3254             20  DC-JULIAN-2-CCYY.
  3255                 24  DC-JULIAN-2-CC    PIC 99.
  3256                 24  DC-JULIAN-2-YR    PIC 99.
  3257             20  DC-JULIAN-DA-2        PIC 999.
  3258         16  DC-GREG-DATE-A-EDIT.
  3259             20  DC-EDITA-MONTH        PIC 99.
  3260             20  SLASHA-1              PIC X VALUE '/'.
  3261             20  DC-EDITA-DAY          PIC 99.
  3262             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  62
* EL050.cbl
  3263             20  DC-EDITA-CCYY.
  3264                 24  DC-EDITA-CENT     PIC 99.
  3265                 24  DC-EDITA-YEAR     PIC 99.
  3266         16  DC-GREG-DATE-B-EDIT.
  3267             20  DC-EDITB-MONTH        PIC 99.
  3268             20  SLASHB-1              PIC X VALUE '/'.
  3269             20  DC-EDITB-DAY          PIC 99.
  3270             20  SLASHB-2              PIC X VALUE '/'.
  3271             20  DC-EDITB-CCYY.
  3272                 24  DC-EDITB-CENT     PIC 99.
  3273                 24  DC-EDITB-YEAR     PIC 99.
  3274         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3275         16  DC-GREG-DATE-CYMD-R REDEFINES
  3276                              DC-GREG-DATE-CYMD.
  3277             20  DC-CYMD-CEN           PIC 99.
  3278             20  DC-CYMD-YEAR          PIC 99.
  3279             20  DC-CYMD-MONTH         PIC 99.
  3280             20  DC-CYMD-DAY           PIC 99.
  3281         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3282         16  DC-GREG-DATE-MDCY-R REDEFINES
  3283                              DC-GREG-DATE-MDCY.
  3284             20  DC-MDCY-MONTH         PIC 99.
  3285             20  DC-MDCY-DAY           PIC 99.
  3286             20  DC-MDCY-CEN           PIC 99.
  3287             20  DC-MDCY-YEAR          PIC 99.
  3288    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3289        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3290    12  DC-EL310-DATE                  PIC X(21).
  3291    12  FILLER                         PIC X(28).
  3292
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  63
* EL050.cbl
  3294*    COPY ELCCALC.
  3295******************************************************************
  3296*                                                                *
  3297*                           ELCCALC.                            *
  3298*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3299*                            VMOD=2.025                          *
  3300*                                                                *
  3301*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3302*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3303*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3304*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3305*                                                                *
  3306*  PASSED TO ELRTRM                                              *
  3307*  -----------------                                             *
  3308*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3309*  ORIGINAL TERM                                                 *
  3310*  BEGINNING DATE                                                *
  3311*  ENDING DATE                                                   *
  3312*  COMPANY I.D.                                                  *
  3313*  ACCOUNT MASTER USER FIELD                                     *
  3314*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3315*  FREE LOOK DAYS                                                *
  3316*                                                                *
  3317*  RETURNED FROM ELRTRM                                          *
  3318*  ---------------------                                         *
  3319*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3320*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3321*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3322*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3323*----------------------------------------------------------------*
  3324*  PASSED TO ELRAMT                                              *
  3325*  ----------------                                              *
  3326*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3327*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3328*  ORIGINAL AMOUNT                                               *
  3329*  ALTERNATE BENEFIT (BALLON)                                    *
  3330*  A.P.R. - NET PAY ONLY                                         *
  3331*  METHOD
  3332*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3333*  COMPANY I.D.                                                  *
  3334*  BENEFIT TYPE                                                  *
  3335*                                                                *
  3336*  RETURNED FROM ELRAMT                                          *
  3337*  --------------------                                          *
  3338*  REMAINING AMOUNT 1 - CURRENT                                  *
  3339*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3340*  REMAINING AMOUNT FACTOR
  3341*----------------------------------------------------------------*
  3342*  PASSED TO ELRESV                                              *
  3343*  -----------------                                             *
  3344*  CERTIFICATE EFFECTIVE DATE                                    *
  3345*  VALUATION DATE                                                *
  3346*  PAID THRU DATE                                                *
  3347*  BENEFIT                                                       *
  3348*  INCURRED DATE                                                 *
  3349*  REPORTED DATE                                                 *
  3350*  ISSUE AGE                                                     *
  3351*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  64
* EL050.cbl
  3352*  CDT PERCENT                                                   *
  3353*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3354* *CLAIM TYPE (LIFE, A/H)                                        *
  3355* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3356* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3357*                                                                *
  3358*  RETURNED FROM ELRESV                                          *
  3359*  --------------------                                          *
  3360*  CDT TABLE USED                                                *
  3361*  CDT FACTOR USED                                               *
  3362*  PAY TO CURRENT RESERVE                                        *
  3363*  I.B.N.R. - A/H ONLY                                           *
  3364*  FUTURE (ACCRUED) AH ONLY                                      *
  3365*----------------------------------------------------------------*
  3366*  PASSED TO ELRATE                                              *
  3367*  ----------------                                              *
  3368*  CERT ISSUE DATE                                               *
  3369*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3370*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3371*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3372*  STATE CODE (CLIENT DEFINED)                                   *
  3373*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3374*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3375*  DEVIATION CODE                                                *
  3376*  ISSUE AGE                                                     *
  3377*  ORIGINAL BENEFIT AMOUNT                                       *
  3378*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3379*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3380*  BENEFIT KIND (LIFE OR A/H)                                    *
  3381*  A.P.R.                                                        *
  3382*  METHOD
  3383*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3384*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3385*  COMPANY I.D. (3 CHARACTER)                                    *
  3386*  BENEFIT CODE                                                  *
  3387*  BENEFIT OVERRIDE CODE                                         *
  3388*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3389*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3390*  JOINT INDICATOR (CSL ONLY)                                    *
  3391*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3392*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3393*                                                                *
  3394*  RETURNED FROM ELRATE                                          *
  3395*  --------------------                                          *
  3396*  CALCULATED PREMIUM                                            *
  3397*  PREMIUM RATE                                                  *
  3398*  MORTALITY CODE                                                *
  3399*  MAX ATTAINED AGE                                              *
  3400*  MAX AGE                                                       *
  3401*  MAX TERM                                                      *
  3402*  MAX MONTHLY BENEFIT                                           *
  3403*  MAX TOTAL BENIFIT                                             *
  3404*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3405*----------------------------------------------------------------*
  3406*  PASSED TO ELRFND                                              *
  3407*  ----------------                                              *
  3408*  CERT ISSUE DATE                                               *
  3409*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  65
* EL050.cbl
  3410*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3411*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3412*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3413*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3414*  STATE CODE (CLIENT DEFINED)                                   *
  3415*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3416*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3417*  DEVIATION CODE                                                *
  3418*  ISSUE AGE                                                     *
  3419*  ORIGINAL BENEFIT AMOUNT                                       *
  3420*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3421*  PROCESS TYPE (CANCEL)                                         *
  3422*  BENEFIT KIND (LIFE OR A/H)                                    *
  3423*  A.P.R.                                                        *
  3424*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3425*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3426*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3427*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3428*  COMPANY I.D. (3 CHARACTER)                                    *
  3429*  BENEFIT CODE                                                  *
  3430*  BENEFIT OVERRIDE CODE                                         *
  3431*                                                                *
  3432*  RETURNED FROM ELRFND                                          *
  3433*  --------------------                                          *
  3434*  CALCULATED REFUND                                             *
  3435*----------------------------------------------------------------*
  3436*  PASSED TO ELEARN                                              *
  3437*  ----------------                                              *
  3438*  CERT ISSUE DATE                                               *
  3439*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3440*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3441*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3442*  STATE CODE (CLIENT DEFINED)                                   *
  3443*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3444*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3445*  DEVIATION CODE                                                *
  3446*  ISSUE AGE                                                     *
  3447*  ORIGINAL BENEFIT AMOUNT                                       *
  3448*  BENEFIT KIND (LIFE OR A/H)                                    *
  3449*  A.P.R.                                                        *
  3450*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3451*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3452*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3453*  COMPANY I.D. (3 CHARACTER)                                    *
  3454*  BENEFIT CODE                                                  *
  3455*  BENEFIT OVERRIDE CODE                                         *
  3456*                                                                *
  3457*  RETURNED FROM ELEARN                                          *
  3458*  --------------------                                          *
  3459*  INDICATED  EARNINGS                                           *
  3460*----------------------------------------------------------------*
  3461*                 LENGTH = 450                                   *
  3462*                                                                *
  3463******************************************************************
  3464******************************************************************
  3465*                   C H A N G E   L O G
  3466*
  3467* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  66
* EL050.cbl
  3468*-----------------------------------------------------------------
  3469*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3470* EFFECTIVE    NUMBER
  3471*-----------------------------------------------------------------
  3472* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3473* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3474* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3475* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3476* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3477* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3478* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3479* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3480* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3481******************************************************************
  3482
  3483 01  CALCULATION-PASS-AREA.
  3484     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3485                                     COMP.
  3486
  3487     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3488       88  NO-CP-ERROR                             VALUE ZERO.
  3489       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3490                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3491       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3492       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3493       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3494       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3495       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3496       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3497       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3498       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3499       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3500       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3501       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3502       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3503       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3504       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3505       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3506       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3507       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3508
  3509     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3510       88  NO-CP-ERROR-2                           VALUE ZERO.
  3511***********************  INPUT AREAS ****************************
  3512
  3513     12  CP-CALCULATION-AREA.
  3514         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3515         16  CP-CERT-EFF-DT        PIC XX.
  3516         16  CP-VALUATION-DT       PIC XX.
  3517         16  CP-PAID-THRU-DT       PIC XX.
  3518         16  CP-BENEFIT-TYPE       PIC X.
  3519           88  CP-AH                               VALUE 'A' 'D'
  3520                                                   'I' 'U'.
  3521           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3522           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3523         16  CP-INCURRED-DT        PIC XX.
  3524         16  CP-REPORTED-DT        PIC XX.
  3525         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  67
* EL050.cbl
  3526         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3527         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3530                                     COMP-3.
  3531         16  CP-CDT-METHOD         PIC X.
  3532           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3533           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3534           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3535         16  CP-CLAIM-TYPE         PIC X.
  3536           88  CP-AH-CLAIM                         VALUE 'A'.
  3537           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3538         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3539                                     COMP-3.
  3540         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3547                                     COMP-3.
  3548         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-REM-TERM-METHOD    PIC X.
  3553           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3554           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3555           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3556           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3557           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3558           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3559           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3560         16  CP-EARNING-METHOD     PIC X.
  3561           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3562           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3563           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3564           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3565           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3566           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3567           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3568           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3569           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3570           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3571           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3572           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3573           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3574           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3575         16  CP-PROCESS-TYPE       PIC X.
  3576           88  CP-CLAIM                            VALUE '1'.
  3577           88  CP-CANCEL                           VALUE '2'.
  3578           88  CP-ISSUE                            VALUE '3'.
  3579         16  CP-SPECIAL-CALC-CD    PIC X.
  3580           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3581           88  CP-1-MTH-INTEREST               VALUE ' '.
  3582           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3583           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  68
* EL050.cbl
  3584           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3585           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3586           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3587           88  CP-FARM-PLAN                    VALUE 'F'.
  3588           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3589           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3590           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3591           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3592           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3593           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3594           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3595           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3596           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3597           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3598                                                     'W' 'X'.
  3599           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3600           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3601           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3602           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3603           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3604           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3605           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3606           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3607           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3608           88  CP-CSL-METH-1                   VALUE '5'.
  3609           88  CP-CSL-METH-2                   VALUE '6'.
  3610           88  CP-CSL-METH-3                   VALUE '7'.
  3611           88  CP-CSL-METH-4                   VALUE '8'.
  3612
  3613         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3616         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3617         16  CP-STATE              PIC XX          VALUE SPACE.
  3618         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3619         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3620           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3621               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3622         16  CP-R78-OPTION         PIC X.
  3623           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3624           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3625
  3626         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3627         16  CP-IBNR-RESERVE-SW    PIC X.
  3628         16  CP-CLAIM-STATUS       PIC X.
  3629         16  CP-RATE-FILE          PIC X.
  3630         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3631                                     COMP-3.
  3632
  3633         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3634         16  CP-AH-OVERRIDE-CODE   PIC X.
  3635
  3636         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3639                                   PIC S9(5)V99 COMP-3.
  3640         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3641                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  69
* EL050.cbl
  3642         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3645                                     COMP-3.
  3646         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3647                                  PIC S9(7)V99 COMP-3.
  3648
  3649         16  CP-PAID-FROM-DATE     PIC X(02).
  3650         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3651         16  CP-EXT-DAYS-CALC      PIC X.
  3652           88  CP-EXT-NO-CHG                   VALUE ' '.
  3653           88  CP-EXT-CHG-LF                   VALUE '1'.
  3654           88  CP-EXT-CHG-AH                   VALUE '2'.
  3655           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3656         16  CP-DOMICILE-STATE     PIC XX.
  3657         16  CP-CARRIER            PIC X.
  3658         16  CP-REIN-FLAG          PIC X.
  3659         16  CP-REM-TRM-CALC-OPTION PIC X.
  3660           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3661                      '2' '3' '4' '5'.
  3662           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3663           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3664           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3665           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3666           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3667           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3668           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3669           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3670         16  CP-SIG-SWITCH         PIC X.
  3671         16  CP-RATING-METHOD      PIC X.
  3672           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3673           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3674           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3675           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3676           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3677           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3678           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3679           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3680           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3681         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3682                                     COMP-3.
  3683         16  CP-BEN-CATEGORY       PIC X.
  3684         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3685         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3686                                   PIC S99V9(5) COMP-3.
  3687         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3688         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3689                                   PIC S99V9(5) COMP-3.
  3690         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3691         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3692         16  CP-EXPIRE-DT          PIC XX.
  3693         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3694         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3695         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3696         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3697         16  CP-DDF-SPEC-CALC      PIC X.
  3698             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3699             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  70
* EL050.cbl
  3700         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3701         16  CP-CANCEL-REASON      PIC X.
  3702         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3703         16  CP-PMT-MODE           PIC X.
  3704         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3705         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3706         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3707         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3708         16  FILLER                PIC X.
  3709
  3710***************    OUTPUT FROM ELRESV   ************************
  3711
  3712         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3713
  3714         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3721                                     COMP-3.
  3722         16  FILLER                PIC X(09).
  3723***************    OUTPUT FROM ELRTRM   *************************
  3724
  3725         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3726                                     COMP-3.
  3727         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3732                                     COMP-3.
  3733         16  FILLER                PIC X(12).
  3734
  3735***************    OUTPUT FROM ELRAMT   *************************
  3736
  3737         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  FILLER                PIC X(12).
  3742
  3743***************    OUTPUT FROM ELRATE   *************************
  3744
  3745         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-MORTALITY-CODE     PIC X(4).
  3750         16  CP-RATE-EDIT-FLAG     PIC X.
  3751             88  CP-RATES-NEED-APR                  VALUE '1'.
  3752         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3755         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3756         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3757                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  71
* EL050.cbl
  3758         16  FILLER                PIC X(07).
  3759
  3760***************    OUTPUT FROM ELRFND   *************************
  3761
  3762         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-REFUND-TYPE-USED   PIC X.
  3765           88  CP-R-AS-R78                         VALUE '1'.
  3766           88  CP-R-AS-PRORATA                     VALUE '2'.
  3767           88  CP-R-AS-CALIF                       VALUE '3'.
  3768           88  CP-R-AS-TEXAS                       VALUE '4'.
  3769           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3770           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3771           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3772           88  CP-R-AS-MEAN                        VALUE '8'.
  3773           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3774           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3775           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3776           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3777           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3778           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3779         16  FILLER                PIC X(12).
  3780
  3781***************    OUTPUT FROM ELEARN   *************************
  3782
  3783         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-EARNING-TYPE-USED  PIC X.
  3796           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3797           88  CP-E-AS-R78                         VALUE '1'.
  3798           88  CP-E-AS-PRORATA                     VALUE '2'.
  3799           88  CP-E-AS-TEXAS                       VALUE '4'.
  3800           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3801           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3802           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3803           88  CP-E-AS-MEAN                        VALUE '8'.
  3804           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3805         16  FILLER                PIC X(12).
  3806
  3807***************    OUTPUT FROM ELPMNT   *************************
  3808
  3809         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3812                                     COMP-3.
  3813         16  FILLER                PIC X(12).
  3814
  3815***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  72
* EL050.cbl
  3816         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3829             88  OPEN-RATE-FILE                   VALUE 'O'.
  3830             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3831             88  IO-ERROR                         VALUE 'E'.
  3832
  3833         16  CP-FIRST-PAY-DATE     PIC XX.
  3834
  3835         16  CP-JOINT-INDICATOR    PIC X.
  3836
  3837         16  CP-RESERVE-REMAINING-TERM
  3838                                   PIC S9(4)V9    VALUE ZERO
  3839                                     COMP-3.
  3840
  3841         16  CP-INSURED-BIRTH-DT   PIC XX.
  3842
  3843         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3844                                     COMP-3.
  3845
  3846         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3847                                     COMP-3.
  3848
  3849         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3850                                     COMP-3.
  3851
  3852         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3853                                     COMP-3.
  3854
  3855         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3856                                     COMP-3.
  3857
  3858         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3859                                     COMP-3.
  3860
  3861         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3862                                     COMP-3.
  3863
  3864         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3865             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3866
  3867         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3872         16  FILLER                PIC X(15).
  3873******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  73
* EL050.cbl
  3875******************************************************************
  3876*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3877*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3878*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3879*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3880*** MODIFICATION.                                              ***
  3881*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3882*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3883******************************************************************
  3884*    COPY ERCPNDB.
  3885******************************************************************
  3886*                                                                *
  3887*                                                                *
  3888*                            ERCPNDB.                            *
  3889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3890*                            VMOD=2.025                          *
  3891*                                                                *
  3892*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3893*                                                                *
  3894******************************************************************
  3895*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3896*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3897******************************************************************
  3898*                                                                *
  3899*                                                                *
  3900*   FILE TYPE = VSAM,KSDS                                        *
  3901*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3902*                                                                *
  3903*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3904*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3905*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3906*                                                 RKP=13,LEN=36  *
  3907*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3908*                                      AND CHG-SEQ.)             *
  3909*                                                RKP=49,LEN=11   *
  3910*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3911*                                      AND CHG-SEQ.)             *
  3912*                                                RKP=60,LEN=15   *
  3913*                                                                *
  3914*   LOG = NO                                                     *
  3915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3916******************************************************************
  3917******************************************************************
  3918*                   C H A N G E   L O G
  3919*
  3920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3921*-----------------------------------------------------------------
  3922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3923* EFFECTIVE    NUMBER
  3924*-----------------------------------------------------------------
  3925* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3926* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3927* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3928* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3929* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3930* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3931* 032306                   PEMA  ADD BOW LOAN NUMBER
  3932* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  74
* EL050.cbl
  3933* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3934* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3935* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3936* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3937* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3938* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3939* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3940* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3941******************************************************************
  3942
  3943 01  PENDING-BUSINESS.
  3944     12  PB-RECORD-ID                     PIC XX.
  3945         88  VALID-PB-ID                        VALUE 'PB'.
  3946
  3947     12  PB-CONTROL-PRIMARY.
  3948         16  PB-COMPANY-CD                PIC X.
  3949         16  PB-ENTRY-BATCH               PIC X(6).
  3950         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3951         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3952
  3953     12  PB-CONTROL-BY-ACCOUNT.
  3954         16  PB-COMPANY-CD-A1             PIC X.
  3955         16  PB-CARRIER                   PIC X.
  3956         16  PB-GROUPING.
  3957             20  PB-GROUPING-PREFIX       PIC XXX.
  3958             20  PB-GROUPING-PRIME        PIC XXX.
  3959         16  PB-STATE                     PIC XX.
  3960         16  PB-ACCOUNT.
  3961             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3962             20  PB-ACCOUNT-PRIME         PIC X(6).
  3963         16  PB-CERT-EFF-DT               PIC XX.
  3964         16  PB-CERT-NO.
  3965             20  PB-CERT-PRIME            PIC X(10).
  3966             20  PB-CERT-SFX              PIC X.
  3967         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3968
  3969         16  PB-RECORD-TYPE               PIC X.
  3970             88  PB-MAILING-DATA                VALUE '0'.
  3971             88  PB-ISSUE                       VALUE '1'.
  3972             88  PB-CANCELLATION                VALUE '2'.
  3973             88  PB-BATCH-TRAILER               VALUE '9'.
  3974
  3975     12  PB-CONTROL-BY-ORIG-BATCH.
  3976         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3977         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3978         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3979         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3980
  3981     12  PB-CONTROL-BY-CSR.
  3982         16  PB-CSR-COMPANY-CD            PIC X.
  3983         16  PB-CSR-ID                    PIC X(4).
  3984         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3985         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3986         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3987******************************************************************
  3988*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3989******************************************************************
  3990
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  75
* EL050.cbl
  3991     12  PB-LAST-MAINT-DT                 PIC XX.
  3992     12  PB-LAST-MAINT-BY                 PIC X(4).
  3993     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3994
  3995     12  PB-RECORD-BODY                   PIC X(375).
  3996
  3997     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3998         16  PB-CERT-ORIGIN               PIC X.
  3999             88  CLASIC-CREATED-CERT         VALUE '1'.
  4000         16  PB-I-NAME.
  4001             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4002             20  PB-I-INSURED-FIRST-NAME.
  4003                 24  PB-I-INSURED-1ST-INIT PIC X.
  4004                 24  FILLER                PIC X(9).
  4005             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4006         16  PB-I-AGE                     PIC S99   COMP-3.
  4007         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4008         16  PB-I-BIRTHDAY                PIC XX.
  4009         16  PB-I-INSURED-SEX             PIC X.
  4010             88  PB-SEX-MALE     VALUE 'M'.
  4011             88  PB-SEX-FEMALE   VALUE 'F'.
  4012
  4013         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4014         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4015         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4016         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4017         16  PB-I-SKIP-CODE               PIC X.
  4018             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4019             88  PB-SKIP-JULY              VALUE '1'.
  4020             88  PB-SKIP-AUGUST            VALUE '2'.
  4021             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4022             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4023             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4024             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4025             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4026             88  PB-SKIP-JUNE              VALUE '8'.
  4027             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4028             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4029             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4030         16  PB-I-TERM-TYPE               PIC X.
  4031             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4032             88  PB-PAID-WEEKLY            VALUE 'W'.
  4033             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4034             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4035             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4036         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4037         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4038         16  PB-I-DATA-ENTRY-SW           PIC X.
  4039             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4040             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4041             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4042             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4043         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4044         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4045*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4046         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4047         16  FILLER                       PIC X.
  4048
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  76
* EL050.cbl
  4049         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4050             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4051             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4052                                                   '90' THRU '99'.
  4053         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4054                                          PIC XX.
  4055         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4056         16  PB-I-AMOUNT-FINANCED REDEFINES
  4057                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4058         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4059         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4060                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4061         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4062         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4063         16  PB-I-CLP-AMOUNT REDEFINES
  4064                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4065         16  PB-I-LF-CALC-FLAG            PIC X.
  4066             88 PB-COMP-LF-PREM               VALUE '?'.
  4067         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4068         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4069         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4070         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4071         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4072         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4073         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4074         16  PB-I-LF-ABBR                 PIC XXX.
  4075         16  PB-I-LF-INPUT-CD             PIC XX.
  4076
  4077         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4078             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4079             88  PB-INVALID-AH               VALUE '  ' '00'
  4080                                                   '90' THRU '99'.
  4081         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4082         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4083         16  PB-I-AH-CALC-FLAG            PIC X.
  4084             88 PB-COMP-AH-PREM                  VALUE '?'.
  4085         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4086         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4087         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4088         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4089         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4090         16  PB-I-AH-ABBR                 PIC XXX.
  4091         16  PB-I-AH-INPUT-CD             PIC XXX.
  4092
  4093         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4094         16  PB-I-REIN-TABLE              PIC XXX.
  4095         16  PB-I-BUSINESS-TYPE           PIC 99.
  4096         16  PB-I-INDV-GRP-CD             PIC X.
  4097         16  PB-I-MORT-CODE.
  4098             20  PB-I-TABLE               PIC X.
  4099             20  PB-I-INTEREST            PIC XX.
  4100             20  PB-I-MORT-TYP            PIC X.
  4101         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4102         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4103         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4104         16  PB-I-INDV-GRP-OVRD           PIC X.
  4105         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4106         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  77
* EL050.cbl
  4107             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4108         16  PB-I-RATE-CLASS              PIC XX.
  4109         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4110         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4111         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4112         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4113         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4114         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4115         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4116         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4117         16  PB-I-OB-FLAG                 PIC X.
  4118             88  PB-I-OB                      VALUE 'B'.
  4119             88  PB-I-SUMMARY                 VALUE 'Z'.
  4120         16  PB-I-ENTRY-STATUS            PIC X.
  4121             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4122                                              'M' '5' '9' '2'.
  4123             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4124             88  PB-I-POLICY-PENDING          VALUE '2'.
  4125             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4126             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4127             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4128             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4129             88  PB-I-REIN-ONLY               VALUE '9'.
  4130             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4131             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4132             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4133             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4134         16  PB-I-INT-CODE                PIC X.
  4135             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4136             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4137         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4138         16  PB-I-SOC-SEC-NO              PIC X(11).
  4139         16  PB-I-MEMBER-NO               PIC X(12).
  4140         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4141*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4142         16  PB-I-OLD-LOF                 PIC XXX.
  4143         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4144         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4145         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4146         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4147         16  PB-I-LIFE-INDICATOR          PIC X.
  4148             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4149         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4150         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4151                                          PIC S9(5)V99    COMP-3.
  4152         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4153             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4154             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4155         16  PB-I-1ST-PMT-DT              PIC XX.
  4156         16  PB-I-JOINT-INSURED.
  4157             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4158             20 PB-I-JOINT-FIRST-NAME.
  4159                24  PB-I-JOINT-FIRST-INIT PIC X.
  4160                24  FILLER                PIC X(9).
  4161             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4162*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4163         16  PB-I-BENEFICIARY-NAME.
  4164             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  78
* EL050.cbl
  4165             20  FILLER                   PIC X(15).
  4166         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4167         16  PB-I-REFERENCE               PIC X(12).
  4168         16  FILLER REDEFINES PB-I-REFERENCE.
  4169             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4170             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4171             20  PB-I-CLP-STATE           PIC XX.
  4172         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4173             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4174             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4175             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4176         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4177         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4178         16  PB-I-RESIDENT-STATE          PIC XX.
  4179         16  PB-I-RATE-CODE               PIC X(4).
  4180         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4181         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4182         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4183         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4184         16  PB-I-BANK-NOCHRGB            PIC 99.
  4185         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4186         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4187
  4188     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4189         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4190             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4191         16  PB-C-CANCEL-ORIGIN           PIC X.
  4192             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4193         16  PB-C-LF-CANCEL-DT            PIC XX.
  4194         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4195         16  PB-C-LF-CALC-REQ             PIC X.
  4196             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4197         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4198         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4199         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4200             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4201         16  PB-C-AH-CANCEL-DT            PIC XX.
  4202         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4203         16  PB-C-AH-CALC-REQ             PIC X.
  4204             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4205         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4206         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4207         16  PB-C-LAST-NAME               PIC X(15).
  4208         16  PB-C-REFUND-SW               PIC X.
  4209             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4210             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4211         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4212         16  PB-C-PAYEE-CODE              PIC X(6).
  4213         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4214         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4215         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4216         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4217         16  PB-C-REFERENCE               PIC X(12).
  4218         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4219         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4220         16  PB-C-POST-CARD-IND           PIC X.
  4221         16  PB-C-CANCEL-REASON           PIC X.
  4222         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  79
* EL050.cbl
  4223         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4224         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4225         16  FILLER                       PIC X(01).
  4226*        16  FILLER                       PIC X(18).
  4227         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4228*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4229         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4230         16  PB-CANCELED-CERT-DATA.
  4231             20  PB-CI-INSURED-NAME.
  4232                 24  PB-CI-LAST-NAME      PIC X(15).
  4233                 24  PB-CI-INITIALS       PIC XX.
  4234             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4235             20  PB-CI-INSURED-SEX        PIC X.
  4236             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4237             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4238             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4239             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4240             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4241             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4242             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4243             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4244             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4245             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4246             20  PB-CI-RATE-CLASS         PIC XX.
  4247             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4248             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4249             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4250             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4251             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4252             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4253             20  PB-CI-LF-ABBR            PIC X(3).
  4254             20  PB-CI-AH-ABBR            PIC X(3).
  4255             20  PB-CI-OB-FLAG            PIC X.
  4256                 88  PB-CI-OB                VALUE 'B'.
  4257             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4258                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4259                                           'M' '4' '5' '9' '2'.
  4260                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4261                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4262                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4263                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4264                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4265                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4266                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4267                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4268                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4269                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4270                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4271                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4272                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4273             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4274                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4275                                           'M' '4' '5' '9' '2'.
  4276                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4277                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4278                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4279                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4280                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  80
* EL050.cbl
  4281                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4282                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4283                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4284                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4285                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4286                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4287                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4288                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4289             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4290             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4291             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4292             20  PB-CI-MEMBER-NO          PIC X(12).
  4293             20  PB-CI-INT-CODE           PIC X.
  4294                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4295                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4296             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4297             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4298             20  PB-CI-COMP-EXCP-SW       PIC X.
  4299                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4300                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4301             20  PB-CI-ENTRY-STATUS       PIC X.
  4302             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4303             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4304             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4305             20  PB-CI-DEATH-DT           PIC XX.
  4306             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4307             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4308             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4309             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4310             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4311             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4312             20  PB-CI-ENTRY-DT              PIC XX.
  4313             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4314             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4315             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4316             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4317             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4318             20  PB-CI-OLD-LOF               PIC XXX.
  4319*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4320             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4321             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4322             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4323             20  PB-CI-INDV-GRP-CD           PIC X.
  4324             20  PB-CI-BENEFICIARY-NAME.
  4325                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4326                 24  FILLER                  PIC X(15).
  4327             20  PB-CI-NOTE-SW               PIC X.
  4328             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4329             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4330             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4331             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4332             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4333             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4334             20  PB-CI-FIRST-NAME            PIC X(10).
  4335             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4336
  4337         16  FILLER                       PIC X(13).
  4338*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  81
* EL050.cbl
  4339*        16  FILLER                       PIC X(46).
  4340
  4341     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4342         16  FILLER                       PIC X(10).
  4343         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4344         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4345         16  PB-M-INSURED-MID-INIT        PIC X.
  4346         16  PB-M-INSURED-AGE             PIC 99.
  4347         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4348         16  PB-M-INSURED-SEX             PIC X.
  4349         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4350         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4351         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4352         16  PB-M-INSURED-CITY-STATE.
  4353             20  PB-M-INSURED-CITY        PIC X(28).
  4354             20  PB-M-INSURED-STATE       PIC XX.
  4355         16  PB-M-INSURED-ZIP-CODE.
  4356             20  PB-M-INSURED-ZIP-PRIME.
  4357                 24  PB-M-INSURED-ZIP-1   PIC X.
  4358                     88  PB-M-CANADIAN-POST-CODE
  4359                                             VALUE 'A' THRU 'Z'.
  4360                 24  FILLER               PIC X(4).
  4361             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4362         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4363                                        PB-M-INSURED-ZIP-CODE.
  4364             20  PM-M-INS-CAN-POST1       PIC XXX.
  4365             20  PM-M-INS-CAN-POST2       PIC XXX.
  4366             20  FILLER                   PIC XXX.
  4367         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4368         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4369         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4370         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4371         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4372         16  PB-M-CRED-BENE-CITYST.
  4373             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4374             20  PB-M-CRED-BENE-STATE     PIC XX.
  4375         16  FILLER                       PIC X(92).
  4376
  4377     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4378         16  FILLER                       PIC X(10).
  4379         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4381         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4382         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4384         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4387         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4388         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4389         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4390         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4391         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4392         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4393         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4394         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4395         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4396         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  82
* EL050.cbl
  4397         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4398         16  PB-REFERENCE                 PIC X(12).
  4399         16  PB-B-RECEIVED-DT             PIC XX.
  4400         16  FILLER                       PIC X(234).
  4401
  4402     12  PB-RECORD-STATUS.
  4403         16  PB-CREDIT-SELECT-DT          PIC XX.
  4404         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4405         16  PB-BILLED-DT                 PIC XX.
  4406         16  PB-BILLING-STATUS            PIC X.
  4407             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4408             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4409             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4410         16  PB-RECORD-BILL               PIC X.
  4411             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4412             88  PB-RECORD-RETURNED           VALUE 'R'.
  4413             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4414             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4415             88  PB-OVERRIDE-AH               VALUE 'A'.
  4416             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4417         16  PB-BATCH-ENTRY               PIC X.
  4418             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4419             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4420             88  PB-REISSUED-CERT             VALUE 'E'.
  4421             88  PB-CASH-CERT                 VALUE 'C'.
  4422             88  PB-MONTHLY-CERT              VALUE 'M'.
  4423             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4424             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4425             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4426         16  PB-FORCE-CODE                PIC X.
  4427             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4428             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4429             88  PB-CANCEL-FORCE              VALUE '8'.
  4430             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4431             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4432             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4433             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4434             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4435             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4436             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4437         16  PB-FATAL-FLAG                PIC X.
  4438             88  PB-FATAL-ERRORS              VALUE 'X'.
  4439         16  PB-FORCE-ER-CD               PIC X.
  4440             88  PB-FORCE-ERRORS              VALUE 'F'.
  4441             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4442         16  PB-WARN-ER-CD                PIC X.
  4443             88  PB-WARNING-ERRORS            VALUE 'W'.
  4444         16  FILLER                       PIC X.
  4445         16  PB-OUT-BAL-CD                PIC X.
  4446             88  PB-OUT-OF-BAL                VALUE 'O'.
  4447         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4448         16  PB-AH-OVERRIDE-L1            PIC X.
  4449         16  PB-INPUT-DT                  PIC XX.
  4450         16  PB-INPUT-BY                  PIC X(4).
  4451         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4452         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4453         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4454         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  83
* EL050.cbl
  4455         16  PB-AH-EARNING-METHOD         PIC X.
  4456         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4457         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4458         16  PB-REIN-CD                   PIC XXX.
  4459         16  PB-LF-REFUND-TYPE            PIC X.
  4460         16  PB-AH-REFUND-TYPE            PIC X.
  4461         16  PB-ACCT-EFF-DT               PIC XX.
  4462         16  PB-ACCT-EXP-DT               PIC XX.
  4463         16  PB-COMPANY-ID                PIC X(3).
  4464         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4465         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4466         16  PB-SV-CARRIER                PIC X.
  4467         16  PB-SV-GROUPING               PIC X(6).
  4468         16  PB-SV-STATE                  PIC XX.
  4469         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4470         16  PB-GA-BILLING-INFO.
  4471             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4472                                          PIC XX.
  4473         16  PB-SV-REMIT-TO  REDEFINES
  4474             PB-GA-BILLING-INFO           PIC X(10).
  4475         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4476         16  PB-I-LOAN-OFFICER            PIC X(5).
  4477         16  PB-I-VIN                     PIC X(17).
  4478
  4479         16  FILLER                       PIC X(04).
  4480         16  IMNET-BYPASS-SW              PIC X.
  4481
  4482******************************************************************
  4483*                COMMON EDIT ERRORS                              *
  4484******************************************************************
  4485
  4486     12  PB-COMMON-ERRORS.
  4487         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4488                                           PIC S9(4)     COMP.
  4489
  4490******************************************************************
  4491
  4492* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4493*    COPY ELC50W1.
  4494******************************************************************
  4495*                                                                *
  4496*                                                                *
  4497*                             ELC50W1                            *
  4498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4499*                            VMOD=2.004                          *
  4500*                                                                *
  4501*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4502*                                                                *
  4503*                                                                *
  4504******************************************************************
  4505
  4506     12  WK-WORK-AREA.
  4507         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4508         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4509         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4510         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4511         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4512         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  84
* EL050.cbl
  4513         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4514         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4515         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4516         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4517         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4518         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4519         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4520         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4521         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4522         16  WK-CREDIT-EDIT-CONTROLS.
  4523             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4524             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4525             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4526             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4527             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4528             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4529         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4530         16  WK-SAVE-REIN-DATA.
  4531             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4532             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4533             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4534         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4535             88  ENTRY-FROM-EL6311       VALUE '6'.
  4536         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4537         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4538     12  WK-RECORD-ADDRESSES.
  4539         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4540         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4541         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4542         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4543         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4544         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4545         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4546         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4547     12  WK-OVER-SHORT-AREA.
  4548         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4549         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4550         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4551             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4552         16  FILLER                   PIC X(5) VALUE SPACES.
  4553
  4554*    COPY ELCEDITC.
  4555******************************************************************
  4556*                                                                *
  4557*                                                                *
  4558*                            ELCEDITC                            *
  4559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4560*                            VMOD=2.012                          *
  4561*                                                                *
  4562*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4563*                     EL6313, EL050 AND EL517.                   *
  4564*                                                                *
  4565******************************************************************
  4566******************************************************************
  4567*                   C H A N G E   L O G
  4568*
  4569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4570*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  85
* EL050.cbl
  4571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4572* EFFECTIVE    NUMBER
  4573*-----------------------------------------------------------------
  4574* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4575******************************************************************
  4576
  4577     12  EDIT-CRITERIA-DATA.
  4578         16  EC-CO-MONTH-END-DT       PIC XX.
  4579         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4580         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4581         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4582         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4583         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4584         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4585         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4586         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4587         16  EC-CO-REM-TERM-CALC      PIC X.
  4588               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4589               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4590               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4591               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4592
  4593         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4594               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4595               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4596               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4597               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4598               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4599               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4600               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4601               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4602               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4603               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4604
  4605         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4606               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4607               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4608               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4609               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4610               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4611               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4612               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4613               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4614
  4615         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4616                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4617                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4618
  4619         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4620                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4621                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4622                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4623                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4624                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4625                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4626                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4627                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4628
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  86
* EL050.cbl
  4629         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4630               88  EC-BR-REDUCING                   VALUE 'R'.
  4631               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4632
  4633         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4634         16  EC-BR-LF-DESC             PIC X(10).
  4635         16  EC-BR-AH-DESC             PIC X(10).
  4636         16  EC-BR-LF-COMMENT          PIC X(10).
  4637         16  EC-BR-AH-COMMENT          PIC X(10).
  4638
  4639         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4640               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4641               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4642               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4643               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4644
  4645         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4646               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4647               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4648               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4649               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4650
  4651         16  EC-BR-LF-REFUND-CALC      PIC X.
  4652                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4653                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4654                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4655                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4656                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4657                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4658                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4659
  4660         16  EC-BR-AH-REFUND-CALC      PIC X.
  4661                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4662                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4663                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4664                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4665                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4666                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4667                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4668                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4669
  4670         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4671                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4672                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4673                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4674
  4675         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4676                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4677                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4678                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4679
  4680         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4681         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4682         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4683         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4684
  4685         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4686         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  87
* EL050.cbl
  4687                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4688                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4689                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4690                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4691
  4692         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4693               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4694               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4695               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4696               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4697               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4698
  4699         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4705
  4706         16  EC-ST-LF-REFUND-CALC      PIC X.
  4707                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4708                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4709                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4710                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4711                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4712                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4713                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4714                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4715
  4716         16  EC-ST-AH-REFUND-CALC      PIC X.
  4717                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4718                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4719                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4720                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4721                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4722                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4723                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4724                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4725
  4726         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4727         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4728         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4729         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4730         16  EC-AM-EXPIRATION-DT       PIC XX.
  4731         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4732         16  EC-AM-CLASS-CD            PIC XX.
  4733         16  EC-AM-LF-DEVIATION        PIC XXX.
  4734         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4735         16  EC-AM-AH-DEVIATION        PIC XXX.
  4736         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4737         16  EC-AM-PHONE-NO            PIC X(10).
  4738
  4739         16  EC-AM-LF-REFUND-CALC      PIC X.
  4740                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4741                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4742                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4743                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4744                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  88
* EL050.cbl
  4745                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4746                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4747
  4748         16  EC-AM-AH-REFUND-CALC      PIC X.
  4749                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4750                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4751                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4752                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4753                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4754                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4755                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4756
  4757         16  EC-AM-BEN-I-G-CD          PIC X.
  4758                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4759                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4760                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4761
  4762         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4763         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4764         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4765         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4766         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4767         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4768         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4769         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4770         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4771
  4772         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4773         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4774         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4775         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4776         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4777         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4778         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4779         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4780         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4781         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4782         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4783         16  EC-RT-LF-NSP-ST           PIC XX.
  4784         16  EC-RT-AH-NSP-ST           PIC XX.
  4785         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4786         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4787
  4788         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4789             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4790                                             'M' '5' '9' '2'.
  4791             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4792             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4793             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4794             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4795             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4796             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4797             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4798             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4799             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4800             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4801
  4802         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  89
* EL050.cbl
  4803             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4804                                             'M' '5' '9' '2'.
  4805             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4806             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4807             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4808             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4809             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4810             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4811             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4812             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4813             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4814             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4815
  4816         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4817         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4818         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4819         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4820         16  EC-CM-DEATH-DT            PIC XX.
  4821
  4822*DMD CUSTOM CODING FIELDS BELOW
  4823*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4824         16  EC-BR-DMD-RATING-SW       PIC X.
  4825                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4826                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4827                 88  NO-DMD-RATING               VALUE 'N'.
  4828
  4829         16  EC-NEW-CERT               PIC X(11).
  4830         16  EC-NEW-STATE              PIC XX.
  4831         16  FILLER                    PIC X.
  4832*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4833         16  OVER-SHORT-EDIT-FIELDS.
  4834             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4835             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4836             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4837             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4838             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4839             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4840             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4841             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4842             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4843         16  FILLER                    PIC X(71).
  4844******************************************************************
  4845
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  90
* EL050.cbl
  4847*    COPY ELCDIFRD.
  4848******************************************************************
  4849*                                                                *
  4850*                                                                *
  4851*                            ELCDIFRD.                           *
  4852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4853*                            VMOD=2.004                          *
  4854*                                                                *
  4855*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4856*                                                                *
  4857******************************************************************
  4858*
  4859  01  WS-DIFFERENCE-CALCULATION.
  4860        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4861        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4862        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4863        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4864        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4865        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4866        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4867        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4868        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4869        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4870        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4871
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  91
* EL050.cbl
  4873****************************************************************
  4874*
  4875* Copyright (c) 2007 by Clerity Solutions, Inc.
  4876* All rights reserved.
  4877*
  4878****************************************************************
  4879 01  DFHEIV.
  4880   02  DFHEIV0               PIC X(35).
  4881   02  DFHEIV1               PIC X(08).
  4882   02  DFHEIV2               PIC X(08).
  4883   02  DFHEIV3               PIC X(08).
  4884   02  DFHEIV4               PIC X(06).
  4885   02  DFHEIV5               PIC X(04).
  4886   02  DFHEIV6               PIC X(04).
  4887   02  DFHEIV7               PIC X(02).
  4888   02  DFHEIV8               PIC X(02).
  4889   02  DFHEIV9               PIC X(01).
  4890   02  DFHEIV10              PIC S9(7) COMP-3.
  4891   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4892   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4893   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4894   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4895   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4896   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4897   02  DFHEIV17              PIC X(04).
  4898   02  DFHEIV18              PIC X(04).
  4899   02  DFHEIV19              PIC X(04).
  4900   02  DFHEIV20              USAGE IS POINTER.
  4901   02  DFHEIV21              USAGE IS POINTER.
  4902   02  DFHEIV22              USAGE IS POINTER.
  4903   02  DFHEIV23              USAGE IS POINTER.
  4904   02  DFHEIV24              USAGE IS POINTER.
  4905   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4906   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4907   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4908   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4909   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4910   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4911   02  FILLER                PIC X(02).
  4912   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4913   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4914   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4915   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4916   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4917 LINKAGE  SECTION.
  4918*****************************************************************
  4919*                                                               *
  4920* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4921* All rights reserved.                                          *
  4922*                                                               *
  4923*****************************************************************
  4924 01  dfheiblk.
  4925     02  eibtime          pic s9(7) comp-3.
  4926     02  eibdate          pic s9(7) comp-3.
  4927     02  eibtrnid         pic x(4).
  4928     02  eibtaskn         pic s9(7) comp-3.
  4929     02  eibtrmid         pic x(4).
  4930     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  92
* EL050.cbl
  4931     02  eibcposn         pic s9(4) comp.
  4932     02  eibcalen         pic s9(4) comp.
  4933     02  eibaid           pic x(1).
  4934     02  eibfiller1       pic x(1).
  4935     02  eibfn            pic x(2).
  4936     02  eibfiller2       pic x(2).
  4937     02  eibrcode         pic x(6).
  4938     02  eibfiller3       pic x(2).
  4939     02  eibds            pic x(8).
  4940     02  eibreqid         pic x(8).
  4941     02  eibrsrce         pic x(8).
  4942     02  eibsync          pic x(1).
  4943     02  eibfree          pic x(1).
  4944     02  eibrecv          pic x(1).
  4945     02  eibsend          pic x(1).
  4946     02  eibatt           pic x(1).
  4947     02  eibeoc           pic x(1).
  4948     02  eibfmh           pic x(1).
  4949     02  eibcompl         pic x(1).
  4950     02  eibsig           pic x(1).
  4951     02  eibconf          pic x(1).
  4952     02  eiberr           pic x(1).
  4953     02  eibrldbk         pic x(1).
  4954     02  eiberrcd         pic x(4).
  4955     02  eibsynrb         pic x(1).
  4956     02  eibnodat         pic x(1).
  4957     02  eibfiller5       pic x(2).
  4958     02  eibresp          pic 9(09) comp.
  4959     02  eibresp2         pic 9(09) comp.
  4960     02  dfheigdj         pic s9(4) comp.
  4961     02  dfheigdk         pic s9(4) comp.
  4962
  4963 01  DFHCOMMAREA                   PIC X(1036).
  4964
  4965*01 PARMLIST .
  4966*    02  FILLER                    PIC S9(8)   COMP.
  4967*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4968*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4969*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4970*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4971*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4972*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4973*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4974
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  93
* EL050.cbl
  4976*    COPY ELCCNTL.
  4977******************************************************************
  4978*                                                                *
  4979*                                                                *
  4980*                            ELCCNTL.                            *
  4981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4982*                            VMOD=2.059                          *
  4983*                                                                *
  4984*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4985*                                                                *
  4986*   FILE TYPE = VSAM,KSDS                                        *
  4987*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4988*                                                                *
  4989*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4990*       ALTERNATE INDEX = NONE                                   *
  4991*                                                                *
  4992*   LOG = YES                                                    *
  4993*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4994******************************************************************
  4995*                   C H A N G E   L O G
  4996*
  4997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4998*-----------------------------------------------------------------
  4999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5000* EFFECTIVE    NUMBER
  5001*-----------------------------------------------------------------
  5002* 082503                   PEMA  ADD BENEFIT GROUP
  5003* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5004* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5005* 092705    2005050300006  PEMA  ADD SPP LEASES
  5006* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5007* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5008* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5009* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5010* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5011* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5012* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5013* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5014* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5015* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5016******************************************************************
  5017*
  5018 01  CONTROL-FILE.
  5019     12  CF-RECORD-ID                       PIC XX.
  5020         88  VALID-CF-ID                        VALUE 'CF'.
  5021
  5022     12  CF-CONTROL-PRIMARY.
  5023         16  CF-COMPANY-ID                  PIC XXX.
  5024         16  CF-RECORD-TYPE                 PIC X.
  5025             88  CF-COMPANY-MASTER              VALUE '1'.
  5026             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5027             88  CF-STATE-MASTER                VALUE '3'.
  5028             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5029             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5030             88  CF-CARRIER-MASTER              VALUE '6'.
  5031             88  CF-MORTALITY-MASTER            VALUE '7'.
  5032             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5033             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  94
* EL050.cbl
  5034             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5035             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5036             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5037             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5038             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5039             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5040             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5041             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5042             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5043         16  CF-ACCESS-CD-GENL              PIC X(4).
  5044         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5045             20  CF-PROCESSOR               PIC X(4).
  5046         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5047             20  CF-STATE-CODE              PIC XX.
  5048             20  FILLER                     PIC XX.
  5049         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5050             20  FILLER                     PIC XX.
  5051             20  CF-HI-BEN-IN-REC           PIC XX.
  5052         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5053             20  FILLER                     PIC XXX.
  5054             20  CF-CARRIER-CNTL            PIC X.
  5055         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5056             20  FILLER                     PIC XX.
  5057             20  CF-HI-TYPE-IN-REC          PIC 99.
  5058         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5059             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5060                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5061             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5062             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5063         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5064             20  FILLER                     PIC X.
  5065             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5066         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5067             20  FILLER                     PIC XX.
  5068             20  CF-MORTGAGE-PLAN           PIC XX.
  5069         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5070
  5071     12  CF-LAST-MAINT-DT                   PIC XX.
  5072     12  CF-LAST-MAINT-BY                   PIC X(4).
  5073     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5074
  5075     12  CF-RECORD-BODY                     PIC X(728).
  5076
  5077
  5078****************************************************************
  5079*             COMPANY MASTER RECORD                            *
  5080****************************************************************
  5081
  5082     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5083         16  CF-COMPANY-ADDRESS.
  5084             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5085             20  CF-CL-IN-CARE-OF           PIC X(30).
  5086             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5087             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5088             20  CF-CL-CITY-STATE           PIC X(30).
  5089             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5090             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5091         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  95
* EL050.cbl
  5092         16  CF-COMPANY-PASSWORD            PIC X(8).
  5093         16  CF-SECURITY-OPTION             PIC X.
  5094             88  ALL-SECURITY                   VALUE '1'.
  5095             88  COMPANY-VERIFY                 VALUE '2'.
  5096             88  PROCESSOR-VERIFY               VALUE '3'.
  5097             88  NO-SECURITY                    VALUE '4'.
  5098             88  ALL-BUT-TERM                   VALUE '5'.
  5099         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5100             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5101         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5102             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5103         16  CF-INFORCE-LOCATION            PIC X.
  5104             88  CERTS-ARE-ONLINE               VALUE '1'.
  5105             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5106             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5107         16  CF-LOWER-CASE-LETTERS          PIC X.
  5108         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5109             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5110             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5111             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5112             88  CF-ACCNT-CNTL                  VALUE '3'.
  5113             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5114
  5115         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5116         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5117
  5118         16  CF-LGX-CREDIT-USER             PIC X.
  5119             88  CO-IS-NOT-USER                 VALUE 'N'.
  5120             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5121
  5122         16 CF-CREDIT-CALC-CODES.
  5123             20  CF-CR-REM-TERM-CALC PIC X.
  5124               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5125               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5126               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5127               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5128               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5129               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5130               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5131             20  CF-CR-R78-METHOD           PIC X.
  5132               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5133               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5134
  5135         16  CF-CLAIM-CONTROL-COUNTS.
  5136             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5137                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5138
  5139             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5140                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5141
  5142             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5143                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5144
  5145             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5146                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5147
  5148         16  CF-CURRENT-MONTH-END           PIC XX.
  5149
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  96
* EL050.cbl
  5150         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5151             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5152             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5153             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5154             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5155                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5156                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5157             20  CF-CO-PREM-REJECT-SW       PIC X.
  5158                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5159                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5160             20  CF-CO-REF-REJECT-SW        PIC X.
  5161                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5162                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5163
  5164         16  CF-CO-REPORTING-DT             PIC XX.
  5165         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5166         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5167           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5168           88  CF-CO-MONTH-END                  VALUE '1'.
  5169
  5170         16  CF-LGX-CLAIM-USER              PIC X.
  5171             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5172             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5173
  5174         16  CF-CREDIT-EDIT-CONTROLS.
  5175             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5176             20  CF-MIN-AGE                 PIC 99.
  5177             20  CF-DEFAULT-AGE             PIC 99.
  5178             20  CF-MIN-TERM                PIC S999      COMP-3.
  5179             20  CF-MAX-TERM                PIC S999      COMP-3.
  5180             20  CF-DEFAULT-SEX             PIC X.
  5181             20  CF-JOINT-AGE-INPUT         PIC X.
  5182                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5183             20  CF-BIRTH-DATE-INPUT        PIC X.
  5184                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5185             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5186                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5187                 88  CF-ZERO-CARRIER            VALUE '1'.
  5188                 88  CF-ZERO-GROUPING           VALUE '2'.
  5189                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5190             20  CF-EDIT-SW                 PIC X.
  5191                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5192             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5193             20  CF-CR-PR-METHOD            PIC X.
  5194               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5195               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5196             20  FILLER                     PIC X.
  5197
  5198         16  CF-CREDIT-MISC-CONTROLS.
  5199             20  CF-REIN-TABLE-SW           PIC X.
  5200                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5201             20  CF-COMP-TABLE-SW           PIC X.
  5202                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5203             20  CF-EXPERIENCE-RETENTION-AGE
  5204                                            PIC S9        COMP-3.
  5205             20  CF-CONVERSION-DT           PIC XX.
  5206             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5207             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  97
* EL050.cbl
  5208                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5209                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5210
  5211             20  CF-CR-CHECK-NO-CONTROL.
  5212                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5213                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5214                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5215                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5216                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5217                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5218
  5219                 24  CF-CR-CHECK-COUNT       REDEFINES
  5220                     CF-CR-CHECK-COUNTER      PIC X(4).
  5221
  5222                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5223                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5224
  5225                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5226                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5227                 24  CF-MAIL-PROCESSING       PIC X.
  5228                     88  MAIL-PROCESSING          VALUE 'Y'.
  5229
  5230         16  CF-MISC-SYSTEM-CONTROL.
  5231             20  CF-SYSTEM-C                 PIC X.
  5232                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5233             20  CF-SYSTEM-D                 PIC X.
  5234                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5235             20  CF-SOC-SEC-NO-SW            PIC X.
  5236                 88  SOC-SEC-NO-USED             VALUE '1'.
  5237             20  CF-MEMBER-NO-SW             PIC X.
  5238                 88  MEMBER-NO-USED              VALUE '1'.
  5239             20  CF-TAX-ID-NUMBER            PIC X(11).
  5240             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5241             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5242                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5243                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5244                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5245                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5246             20  CF-SYSTEM-E                 PIC X.
  5247                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5248
  5249         16  CF-LGX-LIFE-USER               PIC X.
  5250             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5251             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5252
  5253         16  CF-CR-MONTH-END-DT             PIC XX.
  5254
  5255         16  CF-FILE-MAINT-DATES.
  5256             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5257                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5258             20  CF-LAST-BATCH       REDEFINES
  5259                 CF-LAST-BATCH-NO               PIC X(4).
  5260             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5261             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5262             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5263             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5264             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5265             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  98
* EL050.cbl
  5266             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5267             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5268             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5269             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5270
  5271         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5272         16  FILLER                         PIC X.
  5273
  5274         16  CF-ALT-MORT-CODE               PIC X(4).
  5275         16  CF-MEMBER-CAPTION              PIC X(10).
  5276
  5277         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5278             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5279             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5280             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5281             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5282             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5283
  5284         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5285
  5286         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5287         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5288         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5289         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5290
  5291         16  CF-AH-OVERRIDE-L1              PIC X.
  5292         16  CF-AH-OVERRIDE-L2              PIC XX.
  5293         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5294         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5295
  5296         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5297         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5298
  5299         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5300         16  CF-AR-LAST-EL860-DT            PIC XX.
  5301         16  CF-MP-MONTH-END-DT             PIC XX.
  5302
  5303         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5304         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5305             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5306
  5307         16  CF-AR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-CRDTCRD-USER                PIC X.
  5310             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5311             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5312
  5313         16  CF-CC-MONTH-END-DT             PIC XX.
  5314
  5315         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5316
  5317         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5318             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5319             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5320             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5321         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5322         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5323         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page  99
* EL050.cbl
  5324         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5325             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5326             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5327         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5328         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5329         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5330             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5331         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5332
  5333         16  CF-CL-ZIP-CODE.
  5334             20  CF-CL-ZIP-PRIME.
  5335                 24  CF-CL-ZIP-1ST          PIC X.
  5336                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5337                 24  FILLER                 PIC X(4).
  5338             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5339         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5340             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5341             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5342             20  FILLER                     PIC XXX.
  5343
  5344         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5345         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5346         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5347         16  CF-CO-OPTION-START-DATE        PIC XX.
  5348         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5349           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5350                                                      '3' '4'.
  5351           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5352           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5353           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5354           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5355           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5356           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5357
  5358         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5359
  5360         16  CF-PAYMENT-APPROVAL-LEVELS.
  5361             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5362             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5363             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5364             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5365             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5366             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5367
  5368         16  CF-END-USER-REPORTING-USER     PIC X.
  5369             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5370             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5371
  5372         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5373             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5374             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5375
  5376         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5377
  5378         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5379         16  FILLER                         PIC X.
  5380
  5381         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 100
* EL050.cbl
  5382             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5383             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5384             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5385
  5386         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5387
  5388         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5389             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5390             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5391
  5392         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5393             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5394             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5395
  5396         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5397
  5398         16  CF-CO-ACH-ID-CODE              PIC  X.
  5399             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5400             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5401             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5402         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5403         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5404         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5405         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5406         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5407         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5408         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5409         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5410         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5411                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5412         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5413                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5414
  5415         16  CF-CO-OVER-SHORT.
  5416             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5417             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5418
  5419*         16  FILLER                         PIC X(102).
  5420         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5421             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5422             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5423
  5424         16  CF-AH-APPROVAL-DAYS.
  5425             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5426             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5427             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5428             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5429
  5430         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5431
  5432         16  CF-APPROV-LEV-5.
  5433             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5434             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5435             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5436
  5437         16  FILLER                         PIC X(68).
  5438****************************************************************
  5439*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 101
* EL050.cbl
  5440****************************************************************
  5441
  5442     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5443         16  CF-PROCESSOR-NAME              PIC X(30).
  5444         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5445         16  CF-PROCESSOR-TITLE             PIC X(26).
  5446         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5447                 88  MESSAGE-YES                VALUE 'Y'.
  5448                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5449
  5450*****************************************************
  5451****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5452****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5453****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5454****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5455*****************************************************
  5456
  5457         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5458             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5459             20  CF-APPLICATION-FORCE       PIC X.
  5460             20  CF-INDIVIDUAL-APP.
  5461                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5462                     28  CF-BROWSE-APP      PIC X.
  5463                     28  CF-UPDATE-APP      PIC X.
  5464
  5465         16  CF-CURRENT-TERM-ON             PIC X(4).
  5466         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5467             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5468             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5469             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5470             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5471             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5472             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5473             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5474         16  CF-PROCESSOR-CARRIER           PIC X.
  5475             88  NO-CARRIER-SECURITY            VALUE ' '.
  5476         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5477             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5478         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5479             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5480         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5481             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5482
  5483         16  CF-PROC-SYS-ACCESS-SW.
  5484             20  CF-PROC-CREDIT-CLAIMS-SW.
  5485                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5486                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5487                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5488                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5489             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5490                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5491                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5492             20  CF-PROC-LIFE-GNRLDGR-SW.
  5493                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5494                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5495                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5496                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5497             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 102
* EL050.cbl
  5498                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5499                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5500         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5501             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5502             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5503         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5504
  5505         16  CF-APPROVAL-LEVEL                  PIC X.
  5506             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5507             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5508             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5509             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5510             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5511
  5512         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5513
  5514         16  CF-LANGUAGE-TYPE                   PIC X.
  5515             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5516             88  CF-LANG-IS-FR                      VALUE 'F'.
  5517
  5518         16  CF-CSR-IND                         PIC X.
  5519         16  FILLER                             PIC X(239).
  5520
  5521****************************************************************
  5522*             PROCESSOR/REMINDERS RECORD                       *
  5523****************************************************************
  5524
  5525     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5526         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5527             20  CF-START-REMIND-DT         PIC XX.
  5528             20  CF-END-REMIND-DT           PIC XX.
  5529             20  CF-REMINDER-TEXT           PIC X(50).
  5530         16  FILLER                         PIC X(296).
  5531
  5532
  5533****************************************************************
  5534*             STATE MASTER RECORD                              *
  5535****************************************************************
  5536
  5537     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5538         16  CF-STATE-ABBREVIATION          PIC XX.
  5539         16  CF-STATE-NAME                  PIC X(25).
  5540         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5541         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5542             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5543             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5544             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5545             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5546                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5547                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5548             20  CF-ST-PREM-REJECT-SW       PIC X.
  5549                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5550                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5551             20  CF-ST-REF-REJECT-SW        PIC X.
  5552                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5553                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5554         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5555         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 103
* EL050.cbl
  5556         16  CF-ST-REFUND-RULES.
  5557             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5558             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5559             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5560         16  CF-ST-FST-PMT-EXTENSION.
  5561             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5562             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5563                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5564                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5565                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5566                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5567         16  CF-ST-STATE-CALL.
  5568             20  CF-ST-CALL-UNEARNED        PIC X.
  5569             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5570             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5571         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5572             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5573             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5574         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5575         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5576         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5577         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5578         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5579         16  FILLER                         PIC X.
  5580         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5581             20  CF-ST-BENEFIT-CD           PIC XX.
  5582             20  CF-ST-BENEFIT-KIND         PIC X.
  5583                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5584                 88  CF-ST-AH-KIND              VALUE 'A'.
  5585             20  CF-ST-REM-TERM-CALC        PIC X.
  5586                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5587                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5588                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5589                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5590                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5591                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5592                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5593                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5594
  5595             20  CF-ST-REFUND-CALC          PIC X.
  5596                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5597                 88  ST-REFD-BY-R78             VALUE '1'.
  5598                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5599                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5600                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5601                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5602                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5603                 88  ST-REFD-UTAH               VALUE '7'.
  5604                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5605                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5606                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5607
  5608             20  CF-ST-EARNING-CALC         PIC X.
  5609                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5610                 88  ST-EARN-BY-R78             VALUE '1'.
  5611                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5612                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5613                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 104
* EL050.cbl
  5614                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5615                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5616                 88  ST-EARN-MEAN               VALUE '8'.
  5617                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5618
  5619             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5620                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5621                 88  ST-OVRD-BY-R78             VALUE '1'.
  5622                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5623                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5624                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5625                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5626                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5627                 88  ST-OVRD-MEAN               VALUE '8'.
  5628                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5629             20  FILLER                     PIC X.
  5630
  5631         16  CF-ST-COMMISSION-CAPS.
  5632             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5633             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5634             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5635             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5636         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5637                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5638
  5639         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5640
  5641         16  CF-ST-STATUTORY-INTEREST.
  5642             20  CF-ST-STAT-DATE-FROM       PIC X.
  5643                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5644                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5645             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5646             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5647             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5648             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5649             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5650
  5651         16  CF-ST-OVER-SHORT.
  5652             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5653             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5654
  5655         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5656
  5657         16  CF-ST-RT-CALC                  PIC X.
  5658
  5659         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5660         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5661         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5662         16  CF-ST-RF-LR-CALC               PIC X.
  5663         16  CF-ST-RF-LL-CALC               PIC X.
  5664         16  CF-ST-RF-LN-CALC               PIC X.
  5665         16  CF-ST-RF-AH-CALC               PIC X.
  5666         16  CF-ST-RF-CP-CALC               PIC X.
  5667*        16  FILLER                         PIC X(206).
  5668*CIDMOD         16  FILLER                         PIC X(192).
  5669         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5670             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5671         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 105
* EL050.cbl
  5672         16  CF-ST-VFY-2ND-BENE             PIC X.
  5673         16  CF-ST-CAUSAL-STATE             PIC X.
  5674         16  FILLER                         PIC X(185).
  5675
  5676****************************************************************
  5677*             BENEFIT MASTER RECORD                            *
  5678****************************************************************
  5679
  5680     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5681         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5682             20  CF-BENEFIT-CODE            PIC XX.
  5683             20  CF-BENEFIT-NUMERIC  REDEFINES
  5684                 CF-BENEFIT-CODE            PIC XX.
  5685             20  CF-BENEFIT-ALPHA           PIC XXX.
  5686             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5687             20  CF-BENEFIT-COMMENT         PIC X(10).
  5688
  5689             20  CF-LF-COVERAGE-TYPE        PIC X.
  5690                 88  CF-REDUCING                VALUE 'R'.
  5691                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5692
  5693             20  CF-SPECIAL-CALC-CD         PIC X.
  5694                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5695                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5696                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5697                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5698                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5699                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5700                 88  CF-FARM-PLAN               VALUE 'F'.
  5701                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5702                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5703                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5704                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5705                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5706                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5707                 88  CF-PRUDENTIAL              VALUE 'P'.
  5708                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5709                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5710                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5711                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5712                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5713                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5714
  5715             20  CF-JOINT-INDICATOR         PIC X.
  5716                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5717
  5718*            20  FILLER                     PIC X(12).
  5719             20  cf-maximum-benefits        pic s999 comp-3.
  5720             20  FILLER                     PIC X(09).
  5721             20  CF-BENEFIT-CATEGORY        PIC X.
  5722             20  CF-LOAN-TYPE               PIC X(8).
  5723
  5724             20  CF-CO-REM-TERM-CALC        PIC X.
  5725                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5726                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5727                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5728                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5729                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 106
* EL050.cbl
  5730
  5731             20  CF-CO-EARNINGS-CALC        PIC X.
  5732                 88  CO-EARN-BY-R78             VALUE '1'.
  5733                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5734                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5735                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5736                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5737                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5738                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5739                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5740
  5741             20  CF-CO-REFUND-CALC          PIC X.
  5742                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5743                 88  CO-REFD-BY-R78             VALUE '1'.
  5744                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5745                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5746                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5747                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5748                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5749                 88  CO-REFD-MEAN               VALUE '8'.
  5750                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5751                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5752                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5753
  5754             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5755                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5756                 88  CO-OVRD-BY-R78             VALUE '1'.
  5757                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5758                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5759                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5760                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5761                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5762                 88  CO-OVRD-MEAN               VALUE '8'.
  5763                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5764
  5765             20  CF-CO-BEN-I-G-CD           PIC X.
  5766                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5767                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5768                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5769
  5770         16  FILLER                         PIC X(304).
  5771
  5772
  5773****************************************************************
  5774*             CARRIER MASTER RECORD                            *
  5775****************************************************************
  5776
  5777     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5778         16  CF-ADDRESS-DATA.
  5779             20  CF-MAIL-TO-NAME            PIC X(30).
  5780             20  CF-IN-CARE-OF              PIC X(30).
  5781             20  CF-ADDRESS-LINE-1          PIC X(30).
  5782             20  CF-ADDRESS-LINE-2          PIC X(30).
  5783             20  CF-CITY-STATE              PIC X(30).
  5784             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5785             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5786
  5787         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 107
* EL050.cbl
  5788             20  CF-CLAIM-NO-METHOD         PIC X.
  5789                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5790                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5791                 88  CLAIM-NO-SEQ               VALUE '3'.
  5792                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5793             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5794                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5795                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5796                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5797
  5798         16  CF-CHECK-NO-CONTROL.
  5799             20  CF-CHECK-NO-METHOD         PIC X.
  5800                 88  CHECK-NO-MANUAL            VALUE '1'.
  5801                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5802                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5803                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5804             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5805                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5806
  5807         16  CF-DOMICILE-STATE              PIC XX.
  5808
  5809         16  CF-EXPENSE-CONTROLS.
  5810             20  CF-EXPENSE-METHOD          PIC X.
  5811                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5812                 88  DOLLARS-PER-PMT            VALUE '2'.
  5813                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5814                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5815             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5816             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5817
  5818         16  CF-CORRESPONDENCE-CONTROL.
  5819             20  CF-LETTER-RESEND-OPT       PIC X.
  5820                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5821                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5822             20  FILLER                     PIC X(4).
  5823
  5824         16  CF-RESERVE-CONTROLS.
  5825             20  CF-MANUAL-SW               PIC X.
  5826                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5827             20  CF-FUTURE-SW               PIC X.
  5828                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5829             20  CF-PTC-SW                  PIC X.
  5830                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5831             20  CF-IBNR-SW                 PIC X.
  5832                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5833             20  CF-PTC-LF-SW               PIC X.
  5834                 88  CF-LF-PTC-USED             VALUE '1'.
  5835             20  CF-CDT-ACCESS-METHOD       PIC X.
  5836                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5837                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5838                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5839             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5840
  5841         16  CF-CLAIM-CALC-METHOD           PIC X.
  5842             88  360-PLUS-MONTHS                VALUE '1'.
  5843             88  365-PLUS-MONTHS                VALUE '2'.
  5844             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5845             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 108
* EL050.cbl
  5846             88  365-DAILY                      VALUE '5'.
  5847
  5848         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5849         16  FILLER                         PIC X(11).
  5850
  5851         16  CF-LIMIT-AMOUNTS.
  5852             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5853             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5854             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5855             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5856             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5857             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5858             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5859             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5860             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5861             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5862
  5863         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5864         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5865         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5866
  5867         16  CF-ZIP-CODE.
  5868             20  CF-ZIP-PRIME.
  5869                 24  CF-ZIP-1ST             PIC X.
  5870                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5871                 24  FILLER                 PIC X(4).
  5872             20  CF-ZIP-PLUS4               PIC X(4).
  5873         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5874             20  CF-CAN-POSTAL-1            PIC XXX.
  5875             20  CF-CAN-POSTAL-2            PIC XXX.
  5876             20  FILLER                     PIC XXX.
  5877
  5878         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5879         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5880         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5881
  5882         16  CF-RATING-SWITCH               PIC X.
  5883             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5884             88  CF-NO-RATING                   VALUE 'N'.
  5885
  5886         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5887
  5888         16  CF-CARRIER-OVER-SHORT.
  5889             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5890             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5891
  5892         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5893         16  CF-SECPAY-SWITCH               PIC X.
  5894             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5895             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5896         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5897         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5898         16  FILLER                         PIC X(444).
  5899*        16  FILLER                         PIC X(452).
  5900
  5901
  5902****************************************************************
  5903*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 109
* EL050.cbl
  5904****************************************************************
  5905
  5906     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5907         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5908                                INDEXED BY CF-MORT-NDX.
  5909             20  CF-MORT-TABLE              PIC X(5).
  5910             20  CF-MORT-TABLE-TYPE         PIC X.
  5911                 88  CF-MORT-JOINT              VALUE 'J'.
  5912                 88  CF-MORT-SINGLE             VALUE 'S'.
  5913                 88  CF-MORT-COMBINED           VALUE 'C'.
  5914                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5915                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5916             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5917             20  CF-MORT-AGE-METHOD         PIC XX.
  5918                 88  CF-AGE-LAST                VALUE 'AL'.
  5919                 88  CF-AGE-NEAR                VALUE 'AN'.
  5920             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5921             20  CF-MORT-ADJUSTMENT-DIRECTION
  5922                                            PIC X.
  5923                 88  CF-MINUS                   VALUE '-'.
  5924                 88  CF-PLUS                    VALUE '+'.
  5925             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5926             20  CF-MORT-JOINT-CODE         PIC X.
  5927                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5928             20  CF-MORT-PC-Q               PIC X.
  5929                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5930             20  CF-MORT-TABLE-CODE         PIC X(4).
  5931             20  CF-MORT-COMMENTS           PIC X(15).
  5932             20  FILLER                     PIC X(14).
  5933
  5934         16  FILLER                         PIC X(251).
  5935
  5936
  5937****************************************************************
  5938*             BUSSINESS TYPE MASTER RECORD                     *
  5939****************************************************************
  5940
  5941     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5942* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5943* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5944* AND RECORD 05 IS TYPES 81-99
  5945         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5946             20  CF-BUSINESS-TITLE          PIC  X(19).
  5947             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5948                                            PIC S9V9(4) COMP-3.
  5949             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5950             20  FILLER                     PIC  X.
  5951         16  FILLER                         PIC  X(248).
  5952
  5953
  5954****************************************************************
  5955*             TERMINAL MASTER RECORD                           *
  5956****************************************************************
  5957
  5958     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5959
  5960         16  CF-COMPANY-TERMINALS.
  5961             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 110
* EL050.cbl
  5962                                  PIC X(4).
  5963         16  FILLER               PIC X(248).
  5964
  5965
  5966****************************************************************
  5967*             LIFE EDIT MASTER RECORD                          *
  5968****************************************************************
  5969
  5970     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5971         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5972             20  CF-LIFE-CODE-IN            PIC XX.
  5973             20  CF-LIFE-CODE-OUT           PIC XX.
  5974         16  FILLER                         PIC X(248).
  5975
  5976
  5977****************************************************************
  5978*             AH EDIT MASTER RECORD                            *
  5979****************************************************************
  5980
  5981     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5982         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5983             20  CF-AH-CODE-IN              PIC XXX.
  5984             20  CF-AH-CODE-OUT             PIC XX.
  5985         16  FILLER                         PIC X(248).
  5986
  5987
  5988****************************************************************
  5989*             CREDIBILITY TABLES                               *
  5990****************************************************************
  5991
  5992     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5993         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5994                             INDEXED BY CF-CRDB-NDX.
  5995             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5996             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5997             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5998         16  FILLER                         PIC  X(332).
  5999
  6000
  6001****************************************************************
  6002*             REPORT CUSTOMIZATION RECORD                      *
  6003****************************************************************
  6004
  6005     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6006         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6007             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6008             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6009             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6010**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6011****       A T-TRANSFER.                                   ****
  6012             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6013
  6014         16  FILLER                         PIC XX.
  6015
  6016         16  CF-CARRIER-CNTL-OPT.
  6017             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6018                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6019                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 111
* EL050.cbl
  6020             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6021                                            PIC X.
  6022         16  CF-GROUP-CNTL-OPT.
  6023             20  CF-GROUP-OPT-SEQ           PIC 9.
  6024                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6025                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6026             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6027                                            PIC X(6).
  6028         16  CF-STATE-CNTL-OPT.
  6029             20  CF-STATE-OPT-SEQ           PIC 9.
  6030                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6031                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6032             20  CF-STATE-SELECT OCCURS 3 TIMES
  6033                                            PIC XX.
  6034         16  CF-ACCOUNT-CNTL-OPT.
  6035             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6036                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6037                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6038             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-BUS-TYP-CNTL-OPT.
  6041             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6042                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6043                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6044             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6045                                            PIC XX.
  6046         16  CF-LF-TYP-CNTL-OPT.
  6047             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6048                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6049                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6050             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6051                                            PIC XX.
  6052         16  CF-AH-TYP-CNTL-OPT.
  6053             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6054                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6055                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6056             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6057                                            PIC XX.
  6058         16  CF-REPTCD1-CNTL-OPT.
  6059             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6060                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6061                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6062             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6063                                            PIC X(10).
  6064         16  CF-REPTCD2-CNTL-OPT.
  6065             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6066                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6067                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6068             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6069                                            PIC X(10).
  6070         16  CF-USER1-CNTL-OPT.
  6071             20  CF-USER1-OPT-SEQ           PIC 9.
  6072                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6073                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6074             20  CF-USER1-SELECT OCCURS 3 TIMES
  6075                                            PIC X(10).
  6076         16  CF-USER2-CNTL-OPT.
  6077             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 112
* EL050.cbl
  6078                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6079                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6080             20  CF-USER2-SELECT OCCURS 3 TIMES
  6081                                            PIC X(10).
  6082         16  CF-USER3-CNTL-OPT.
  6083             20  CF-USER3-OPT-SEQ           PIC 9.
  6084                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6085                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6086             20  CF-USER3-SELECT OCCURS 3 TIMES
  6087                                            PIC X(10).
  6088         16  CF-USER4-CNTL-OPT.
  6089             20  CF-USER4-OPT-SEQ           PIC 9.
  6090                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6091                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6092             20  CF-USER4-SELECT OCCURS 3 TIMES
  6093                                            PIC X(10).
  6094         16  CF-USER5-CNTL-OPT.
  6095             20  CF-USER5-OPT-SEQ           PIC 9.
  6096                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6097                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6098             20  CF-USER5-SELECT OCCURS 3 TIMES
  6099                                            PIC X(10).
  6100         16  CF-REINS-CNTL-OPT.
  6101             20  CF-REINS-OPT-SEQ           PIC 9.
  6102                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6103                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6104             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6105                 24  CF-REINS-PRIME         PIC XXX.
  6106                 24  CF-REINS-SUB           PIC XXX.
  6107
  6108         16  CF-AGENT-CNTL-OPT.
  6109             20  CF-AGENT-OPT-SEQ           PIC 9.
  6110                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6111                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6112             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6113                                            PIC X(10).
  6114
  6115         16  FILLER                         PIC X(43).
  6116
  6117         16  CF-LOSS-RATIO-SELECT.
  6118             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6119             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6120         16  CF-ENTRY-DATE-SELECT.
  6121             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6122             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6123         16  CF-EFFECTIVE-DATE-SELECT.
  6124             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6125             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6126
  6127         16  CF-EXCEPTION-LIST-IND          PIC X.
  6128             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6129
  6130         16  FILLER                         PIC X(318).
  6131
  6132****************************************************************
  6133*                  EXCEPTION REPORTING RECORD                  *
  6134****************************************************************
  6135
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 113
* EL050.cbl
  6136     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6137         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6138             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6139
  6140         16  CF-COMBINED-LIFE-AH-OPT.
  6141             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6142             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6143             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6144             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6145
  6146         16  CF-LIFE-OPT.
  6147             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6148             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6149             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6150             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6151             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6152             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6153             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6154             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6155             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6156             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6157
  6158         16  CF-AH-OPT.
  6159             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6160             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6161             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6162             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6163             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6164             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6165             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6166             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6167             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6168             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6169
  6170         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6171             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6172             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6173             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6174
  6175         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6176
  6177         16  FILLER                         PIC X(673).
  6178
  6179
  6180****************************************************************
  6181*             MORTGAGE SYSTEM PLAN RECORD                      *
  6182****************************************************************
  6183
  6184     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6185         16  CF-PLAN-TYPE                   PIC X.
  6186             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6187             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6188             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6189         16  CF-PLAN-ABBREV                 PIC XXX.
  6190         16  CF-PLAN-DESCRIPT               PIC X(10).
  6191         16  CF-PLAN-NOTES                  PIC X(20).
  6192         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6193         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 114
* EL050.cbl
  6194             20  CF-PLAN-TERM-DATA.
  6195                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6196                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6197             20  CF-PLAN-AGE-DATA.
  6198                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6199                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6200                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6201             20  CF-PLAN-BENEFIT-DATA.
  6202                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6203                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6204                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6205                                            PIC S9(7)V99  COMP-3.
  6206         16  CF-PLAN-POLICY-FORMS.
  6207             20  CF-POLICY-FORM             PIC X(12).
  6208             20  CF-MASTER-APPLICATION      PIC X(12).
  6209             20  CF-MASTER-POLICY           PIC X(12).
  6210         16  CF-PLAN-RATING.
  6211             20  CF-RATE-CODE               PIC X(5).
  6212             20  CF-SEX-RATING              PIC X.
  6213                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6214                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6215             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6216             20  CF-SUB-STD-TYPE            PIC X.
  6217                 88  CF-PCT-OF-PREM            VALUE '1'.
  6218                 88  CF-PCT-OF-BENE            VALUE '2'.
  6219         16  CF-PLAN-PREM-TOLERANCES.
  6220             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6221             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6222         16  CF-PLAN-PYMT-TOLERANCES.
  6223             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6224             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6225         16  CF-PLAN-MISC-DATA.
  6226             20  FILLER                     PIC X.
  6227             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6228             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6229         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6230         16  CF-PLAN-IND-GRP                PIC X.
  6231             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6232                                                     '1'.
  6233             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6234                                                     '2'.
  6235         16  CF-MIB-SEARCH-SW               PIC X.
  6236             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6237             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6238             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6239             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6240         16  CF-ALPHA-SEARCH-SW             PIC X.
  6241             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6242             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6243             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6244             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6245             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6246             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6247             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6248             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6249             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6250             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6251                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 115
* EL050.cbl
  6252                                                     'X' 'Y' 'Z'.
  6253         16  CF-EFF-DT-RULE-SW              PIC X.
  6254             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6255             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6256             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6257             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6258             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6259         16  FILLER                         PIC X(4).
  6260         16  CF-HEALTH-QUESTIONS            PIC X.
  6261             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6262         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6263         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6264         16  CF-PLAN-SNGL-JNT               PIC X.
  6265             88  CF-COMBINED-PLAN              VALUE 'C'.
  6266             88  CF-JNT-PLAN                   VALUE 'J'.
  6267             88  CF-SNGL-PLAN                  VALUE 'S'.
  6268         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6269         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6270         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6271         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6272         16  CF-RERATE-CNTL                 PIC  X.
  6273             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6274             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6275             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6276             88  CF-AUTO-RECALC                 VALUE '4'.
  6277         16  CF-BENEFIT-TYPE                PIC  X.
  6278             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6279             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6280         16  CF-POLICY-FEE                  PIC S999V99
  6281                                                    COMP-3.
  6282         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6283         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6284         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6285         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6286         16  FILLER                         PIC  X(32).
  6287         16  CF-TERMINATION-FORM            PIC  X(04).
  6288         16  FILLER                         PIC  X(08).
  6289         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6290                                                       COMP-3.
  6291         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6292         16  CF-ISSUE-LETTER                PIC  X(4).
  6293         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6294         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6295             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6296             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6297         16  CF-MP-REFUND-CALC              PIC X.
  6298             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6299             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6300             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6301             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6302             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6303             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6304             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6305             88  CF-MP-REFD-MEAN                VALUE '8'.
  6306         16  CF-ALT-RATE-CODE               PIC  X(5).
  6307
  6308
  6309         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 116
* EL050.cbl
  6310****************************************************************
  6311*             MORTGAGE COMPANY MASTER RECORD                   *
  6312****************************************************************
  6313
  6314     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6315         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6316         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6317             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6318             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6319             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6320             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6321             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6322
  6323         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6324         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6325         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6326         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6327         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6328
  6329         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6330             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6331         16  CF-MP-RECON-USE-IND            PIC X(1).
  6332             88  CF-MP-USE-RECON             VALUE 'Y'.
  6333         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6334             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6335         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6336             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6337             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6338         16  FILLER                         PIC X(1).
  6339         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6340             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6341         16  CF-MORTG-MIB-VERSION           PIC X.
  6342             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6343             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6344             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6345         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6346             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6347                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6348             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6349                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6350             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6351                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6352             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6353                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6354             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6355                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6356             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6357                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6358         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6359         16  FILLER                         PIC X(7).
  6360         16  CF-MORTG-DESTINATION-SYMBOL.
  6361             20  CF-MORTG-MIB-COMM          PIC X(5).
  6362             20  CF-MORTG-MIB-TERM          PIC X(5).
  6363         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6364             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6365         16  FILLER                         PIC X(03).
  6366         16  CF-MP-CHECK-NO-CONTROL.
  6367             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 117
* EL050.cbl
  6368                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6369                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6370                                                ' ' LOW-VALUES.
  6371                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6372                                               VALUE '3'.
  6373         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6374         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6375         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6376             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6377                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6378             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6379                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6380             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6381                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6382             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6383                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6384             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6385                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6386             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6387                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6388         16  CF-MORTG-BILLING-AREA.
  6389             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6390                                            PIC X.
  6391         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6392         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6393         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6394         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6395             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6396             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6397         16  FILLER                         PIC X.
  6398         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6399             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6400             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6401         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6402         16  FILLER                         PIC X(8).
  6403         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6404         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6405         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6406         16  CF-ACH-COMPANY-ID.
  6407             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6408                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6409                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6410                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6411             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6412         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6413             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6414         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6415             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6416             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6417         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6418         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6419         16  FILLER                         PIC X(536).
  6420
  6421****************************************************************
  6422*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6423****************************************************************
  6424
  6425     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 118
* EL050.cbl
  6426         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6427             20  CF-FEMALE-HEIGHT.
  6428                 24  CF-FEMALE-FT           PIC 99.
  6429                 24  CF-FEMALE-IN           PIC 99.
  6430             20  CF-FEMALE-MIN-WT           PIC 999.
  6431             20  CF-FEMALE-MAX-WT           PIC 999.
  6432         16  FILLER                         PIC X(428).
  6433
  6434     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6435         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6436             20  CF-MALE-HEIGHT.
  6437                 24  CF-MALE-FT             PIC 99.
  6438                 24  CF-MALE-IN             PIC 99.
  6439             20  CF-MALE-MIN-WT             PIC 999.
  6440             20  CF-MALE-MAX-WT             PIC 999.
  6441         16  FILLER                         PIC X(428).
  6442******************************************************************
  6443*             AUTOMATIC ACTIVITY RECORD                          *
  6444******************************************************************
  6445     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6446         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6447             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6448             20  CF-SYS-LETTER-ID           PIC X(04).
  6449             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6450             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6451             20  CF-SYS-RESET-SW            PIC X(01).
  6452             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6453             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6454
  6455         16  FILLER                         PIC X(50).
  6456
  6457         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6458             20  CF-USER-ACTIVE-SW          PIC X(01).
  6459             20  CF-USER-LETTER-ID          PIC X(04).
  6460             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6461             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6462             20  CF-USER-RESET-SW           PIC X(01).
  6463             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6464             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6465             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6466
  6467         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 119
* EL050.cbl
  6469*    COPY ERCACCT.
  6470******************************************************************
  6471*                                                                *
  6472*                                                                *
  6473*                            ERCACCT                             *
  6474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6475*                            VMOD=2.031                          *
  6476*                                                                *
  6477*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6478*                                                                *
  6479*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6480*   VSAM ACCOUNT MASTER FILES.                                   *
  6481*                                                                *
  6482*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6483*                                                                *
  6484*   FILE TYPE = VSAM,KSDS                                        *
  6485*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6486*                                                                *
  6487*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6488*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6489*                                                                *
  6490*   LOG = NO                                                     *
  6491*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6492*                                                                *
  6493*                                                                *
  6494******************************************************************
  6495*                   C H A N G E   L O G
  6496*
  6497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6498*-----------------------------------------------------------------
  6499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6500* EFFECTIVE    NUMBER
  6501*-----------------------------------------------------------------
  6502* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6503* 092705    2005050300006  PEMA  ADD SPP LEASES
  6504* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6505* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6506* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6507* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6508* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6509******************************************************************
  6510
  6511 01  ACCOUNT-MASTER.
  6512     12  AM-RECORD-ID                      PIC XX.
  6513         88  VALID-AM-ID                      VALUE 'AM'.
  6514
  6515     12  AM-CONTROL-PRIMARY.
  6516         16  AM-COMPANY-CD                 PIC X.
  6517         16  AM-MSTR-CNTRL.
  6518             20  AM-CONTROL-A.
  6519                 24  AM-CARRIER            PIC X.
  6520                 24  AM-GROUPING.
  6521                     28 AM-GROUPING-PREFIX PIC XXX.
  6522                     28 AM-GROUPING-PRIME  PIC XXX.
  6523                 24  AM-STATE              PIC XX.
  6524                 24  AM-ACCOUNT.
  6525                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6526                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 120
* EL050.cbl
  6527             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6528                                           PIC X(19).
  6529             20  AM-CNTRL-B.
  6530                 24  AM-EXPIRATION-DT      PIC XX.
  6531                 24  FILLER                PIC X(4).
  6532             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6533                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6534
  6535     12  AM-CONTROL-BY-VAR-GRP.
  6536         16  AM-COMPANY-CD-A1              PIC X.
  6537         16  AM-VG-CARRIER                 PIC X.
  6538         16  AM-VG-GROUPING                PIC X(6).
  6539         16  AM-VG-STATE                   PIC XX.
  6540         16  AM-VG-ACCOUNT                 PIC X(10).
  6541         16  AM-VG-DATE.
  6542             20  AM-VG-EXPIRATION-DT       PIC XX.
  6543             20  FILLER                    PIC X(4).
  6544         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6545                                           PIC 9(11)      COMP-3.
  6546     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6547         16  FILLER                        PIC X(10).
  6548         16  AM-VG-KEY3.
  6549             20  AM-VG3-ACCOUNT            PIC X(10).
  6550             20  AM-VG3-EXP-DT             PIC XX.
  6551         16  FILLER                        PIC X(4).
  6552     12  AM-MAINT-INFORMATION.
  6553         16  AM-LAST-MAINT-DT              PIC XX.
  6554         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6555         16  AM-LAST-MAINT-USER            PIC X(4).
  6556         16  FILLER                        PIC XX.
  6557
  6558     12  AM-EFFECTIVE-DT                   PIC XX.
  6559     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6560
  6561     12  AM-PREV-DATES  COMP-3.
  6562         16  AM-PREV-EXP-DT                PIC 9(11).
  6563         16  AM-PREV-EFF-DT                PIC 9(11).
  6564
  6565     12  AM-REPORT-CODE-1                  PIC X(10).
  6566     12  AM-REPORT-CODE-2                  PIC X(10).
  6567
  6568     12  AM-CITY-CODE                      PIC X(4).
  6569     12  AM-COUNTY-PARISH                  PIC X(6).
  6570
  6571     12  AM-NAME                           PIC X(30).
  6572     12  AM-PERSON                         PIC X(30).
  6573     12  AM-ADDRS                          PIC X(30).
  6574     12  AM-CITY.
  6575         16  AM-ADDR-CITY                  PIC X(28).
  6576         16  AM-ADDR-STATE                 PIC XX.
  6577     12  AM-ZIP.
  6578         16  AM-ZIP-PRIME.
  6579             20  AM-ZIP-PRI-1ST            PIC X.
  6580                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6581             20  FILLER                    PIC X(4).
  6582         16  AM-ZIP-PLUS4                  PIC X(4).
  6583     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6584         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 121
* EL050.cbl
  6585         16  AM-CAN-POSTAL-2               PIC XXX.
  6586         16  FILLER                        PIC XXX.
  6587     12  AM-TEL-NO.
  6588         16  AM-AREA-CODE                  PIC 999.
  6589         16  AM-TEL-PRE                    PIC 999.
  6590         16  AM-TEL-NBR                    PIC 9(4).
  6591     12  AM-TEL-LOC                        PIC X.
  6592         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6593         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6594
  6595     12  AM-COMM-STRUCTURE.
  6596         16  AM-DEFN-1.
  6597             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6598                 24  AM-AGT.
  6599                     28  AM-AGT-PREFIX     PIC X(4).
  6600                     28  AM-AGT-PRIME      PIC X(6).
  6601                 24  AM-COM-TYP            PIC X.
  6602                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6603                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6604                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6605                 24  AM-RECALC-LV-INDIC    PIC X.
  6606                 24  AM-RETRO-LV-INDIC     PIC X.
  6607                 24  AM-GL-CODES           PIC X.
  6608                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6609                 24  FILLER                PIC X(01).
  6610         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6611             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6612                 24  FILLER                PIC X(11).
  6613                 24  AM-L-COMA             PIC XXX.
  6614                 24  AM-J-COMA             PIC XXX.
  6615                 24  AM-A-COMA             PIC XXX.
  6616                 24  FILLER                PIC X(6).
  6617
  6618     12  AM-COMM-CHANGE-STATUS             PIC X.
  6619         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6620
  6621     12  AM-CSR-CODE                       PIC X(4).
  6622
  6623     12  AM-BILLING-STATUS                 PIC X.
  6624         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6625         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6626     12  AM-AUTO-REFUND-SW                 PIC X.
  6627         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6628         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6629     12  AM-GPCD                           PIC 99.
  6630     12  AM-IG                             PIC X.
  6631         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6632         88  AM-HAS-GROUP                     VALUE '2'.
  6633     12  AM-STATUS                         PIC X.
  6634         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6635         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6636         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6637         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6638         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6639         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6640     12  AM-REMIT-TO                       PIC 99.
  6641     12  AM-ID-NO                          PIC X(11).
  6642
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 122
* EL050.cbl
  6643     12  AM-CAL-TABLE                      PIC XX.
  6644     12  AM-LF-DEVIATION                   PIC XXX.
  6645     12  AM-AH-DEVIATION                   PIC XXX.
  6646     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6647     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6648     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6649     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6650     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6651     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6652
  6653     12  AM-USER-FIELDS.
  6654         16  AM-FLD-1                      PIC XX.
  6655         16  AM-FLD-2                      PIC XX.
  6656         16  AM-FLD-3                      PIC XX.
  6657         16  AM-FLD-4                      PIC XX.
  6658         16  AM-FLD-5                      PIC XX.
  6659
  6660     12  AM-1ST-PROD-DATE.
  6661         16  AM-1ST-PROD-YR                PIC XX.
  6662         16  AM-1ST-PROD-MO                PIC XX.
  6663         16  AM-1ST-PROD-DA                PIC XX.
  6664     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6665     12  AM-CERTS-PURGED-DATE.
  6666         16  AM-PUR-YR                     PIC XX.
  6667         16  AM-PUR-MO                     PIC XX.
  6668         16  AM-PUR-DA                     PIC XX.
  6669     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6670     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6671     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6672     12  AM-INACTIVE-DATE.
  6673         16  AM-INA-MO                     PIC 99.
  6674         16  AM-INA-DA                     PIC 99.
  6675         16  AM-INA-YR                     PIC 99.
  6676     12  AM-AR-HI-CERT-DATE                PIC XX.
  6677
  6678     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6679     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6680
  6681     12  AM-OB-PAYMENT-MODE                PIC X.
  6682         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6683         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6684         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6685         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6686
  6687     12  AM-AH-ONLY-INDICATOR              PIC X.
  6688         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6689         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6690
  6691     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6692
  6693     12  AM-OVER-SHORT.
  6694         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6695         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6696
  6697     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6698     12  AM-DCC-CLP-STATE                  PIC XX.
  6699
  6700     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 123
* EL050.cbl
  6701     12  AM-RECALC-REIN                    PIC X.
  6702
  6703     12  AM-REI-TABLE                      PIC XXX.
  6704     12  AM-REI-ET-LF                      PIC X.
  6705     12  AM-REI-ET-AH                      PIC X.
  6706     12  AM-REI-PE-LF                      PIC X.
  6707     12  AM-REI-PE-AH                      PIC X.
  6708     12  AM-REI-PRT-ST                     PIC X.
  6709     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6711     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6712     12  AM-REI-GROUP-A                    PIC X(6).
  6713     12  AM-REI-MORT                       PIC X(4).
  6714     12  AM-REI-PRT-OW                     PIC X.
  6715     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6717     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6718     12  AM-REI-GROUP-B                    PIC X(6).
  6719
  6720     12  AM-TRUST-TYPE                     PIC X(2).
  6721
  6722     12  AM-EMPLOYER-STMT-USED             PIC X.
  6723     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6724
  6725     12  AM-STD-AH-TYPE                    PIC XX.
  6726     12  AM-EARN-METHODS.
  6727         16  AM-EARN-METHOD-R              PIC X.
  6728             88 AM-REF-RL-R78                 VALUE 'R'.
  6729             88 AM-REF-RL-PR                  VALUE 'P'.
  6730             88 AM-REF-RL-MEAN                VALUE 'M'.
  6731             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6732         16  AM-EARN-METHOD-L              PIC X.
  6733             88 AM-REF-LL-R78                 VALUE 'R'.
  6734             88 AM-REF-LL-PR                  VALUE 'P'.
  6735             88 AM-REF-LL-MEAN                VALUE 'M'.
  6736             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6737         16  AM-EARN-METHOD-A              PIC X.
  6738             88 AM-REF-AH-R78                 VALUE 'R'.
  6739             88 AM-REF-AH-PR                  VALUE 'P'.
  6740             88 AM-REF-AH-MEAN                VALUE 'M'.
  6741             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6742             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6743             88 AM-REF-AH-NET                 VALUE 'N'.
  6744
  6745     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6746     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6747     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6748
  6749     12  AM-RET-Y-N                        PIC X.
  6750     12  AM-RET-P-E                        PIC X.
  6751     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6752     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6753     12  AM-RET-GRP                        PIC X(6).
  6754     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6755         16  AM-POOL-PRIME                 PIC XXX.
  6756         16  AM-POOL-SUB                   PIC XXX.
  6757     12  AM-RETRO-EARNINGS.
  6758         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 124
* EL050.cbl
  6759         16  AM-RET-EARN-L                 PIC X.
  6760         16  AM-RET-EARN-A                 PIC X.
  6761     12  AM-RET-ST-TAX-USE                 PIC X.
  6762         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6763         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6764     12  AM-RETRO-BEG-EARNINGS.
  6765         16  AM-RET-BEG-EARN-R             PIC X.
  6766         16  AM-RET-BEG-EARN-L             PIC X.
  6767         16  AM-RET-BEG-EARN-A             PIC X.
  6768     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6769     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6770
  6771     12  AM-USER-SELECT-OPTIONS.
  6772         16  AM-USER-SELECT-1              PIC X(10).
  6773         16  AM-USER-SELECT-2              PIC X(10).
  6774         16  AM-USER-SELECT-3              PIC X(10).
  6775         16  AM-USER-SELECT-4              PIC X(10).
  6776         16  AM-USER-SELECT-5              PIC X(10).
  6777
  6778     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6779
  6780     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6781
  6782     12  AM-RPT045A-SWITCH                 PIC X.
  6783         88  RPT045A-OFF                   VALUE 'N'.
  6784
  6785     12  AM-INSURANCE-LIMITS.
  6786         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6787         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6788
  6789     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6790         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6791
  6792     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6793         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6794         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6795
  6796     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6797
  6798     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6799     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6800     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6801     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6802     12  AM-DCC-UEF-STATE                  PIC XX.
  6803     12  FILLER                            PIC XXX.
  6804     12  AM-REPORT-CODE-3                  PIC X(10).
  6805*    12  FILLER                            PIC X(22).
  6806
  6807     12  AM-RESERVE-DATE.
  6808         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6809         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6810         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6811
  6812     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6813     12  AM-NOTIFICATION-TYPES.
  6814         16  AM-NOTIF-OF-LETTERS           PIC X.
  6815         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6816         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 125
* EL050.cbl
  6817         16  AM-NOTIF-OF-STATUS            PIC X.
  6818
  6819     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6820         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6821         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6822         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6823         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6824
  6825     12  AM-BENEFIT-CONTROLS.
  6826         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6827             20  AM-BENEFIT-CODE           PIC XX.
  6828             20  AM-BENEFIT-TYPE           PIC X.
  6829             20  AM-BENEFIT-REVISION       PIC XXX.
  6830             20  AM-BENEFIT-REM-TERM       PIC X.
  6831             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6832             20  FILLER                    PIC XX.
  6833         16  FILLER                        PIC X(80).
  6834
  6835     12  AM-TRANSFER-DATA.
  6836         16  AM-TRANSFERRED-FROM.
  6837             20  AM-TRNFROM-CARRIER        PIC X.
  6838             20  AM-TRNFROM-GROUPING.
  6839                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6840                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6841             20  AM-TRNFROM-STATE          PIC XX.
  6842             20  AM-TRNFROM-ACCOUNT.
  6843                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6844                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6845             20  AM-TRNFROM-DTE            PIC XX.
  6846         16  AM-TRANSFERRED-TO.
  6847             20  AM-TRNTO-CARRIER          PIC X.
  6848             20  AM-TRNTO-GROUPING.
  6849                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6850                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6851             20  AM-TRNTO-STATE            PIC XX.
  6852             20  AM-TRNTO-ACCOUNT.
  6853                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6854                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6855             20  AM-TRNTO-DTE              PIC XX.
  6856         16  FILLER                        PIC X(10).
  6857
  6858     12  AM-SAVED-REMIT-TO                 PIC 99.
  6859
  6860     12  AM-COMM-STRUCTURE-SAVED.
  6861         16  AM-DEFN-1-SAVED.
  6862             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6863                 24  AM-AGT-SV             PIC X(10).
  6864                 24  AM-COM-TYP-SV         PIC X.
  6865                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6866                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6867                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6868                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6869                 24  FILLER                PIC X.
  6870                 24  AM-GL-CODES-SV        PIC X.
  6871                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6872                 24  FILLER                PIC X.
  6873         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6874             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 126
* EL050.cbl
  6875                 24  FILLER                PIC X(11).
  6876                 24  AM-L-COMA-SV          PIC XXX.
  6877                 24  AM-J-COMA-SV          PIC XXX.
  6878                 24  AM-A-COMA-SV          PIC XXX.
  6879                 24  FILLER                PIC X(6).
  6880
  6881     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6882         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6883            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6884            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6885            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6886
  6887     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6888     12  FILLER                            PIC X(120).
  6889
  6890     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6891         16  AM-CONTROL-NAME               PIC X(30).
  6892         16  AM-EXECUTIVE-ONE.
  6893             20  AM-EXEC1-NAME             PIC X(15).
  6894             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6895                                                          COMP-3.
  6896             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6897                                                          COMP-3.
  6898         16  AM-EXECUTIVE-TWO.
  6899             20  AM-EXEC2-NAME             PIC X(15).
  6900             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6901                                                          COMP-3.
  6902             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6903                                                          COMP-3.
  6904
  6905     12  AM-RETRO-ADDITIONAL-DATA.
  6906         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6907         16  AM-RETRO-PREM-P-E             PIC X.
  6908         16  AM-RETRO-CLMS-P-I             PIC X.
  6909         16  AM-RETRO-RET-BRACKET-LF.
  6910             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6911                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6912                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6913             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6914                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6915                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6916             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6917                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6918                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6919         16  AM-RETRO-RET-BRACKET-AH.
  6920             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6921                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6922                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6923                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6924             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6925                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6926                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6927             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6928                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6929                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6930
  6931     12  AM-COMMENTS.
  6932         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 127
* EL050.cbl
  6933
  6934     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6935         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6936         16  AM-FLI-BILLING-CODE           PIC X.
  6937         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6938         16  AM-FLI-UNITED-IDENT           PIC X.
  6939         16  AM-FLI-INTEREST-LOST-DATA.
  6940             20  AM-FLI-BANK-NO            PIC X(5).
  6941             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6942             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6943             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6944         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6945             20  AM-FLI-AGT                PIC X(9).
  6946             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6947             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6948         16  FILLER                        PIC X(102).
  6949
  6950     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6951         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6952             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6953             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6954             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6955             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6956             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6957         16  FILLER                          PIC X(10).
  6958******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 128
* EL050.cbl
  6960*    COPY ERCREIN.
  6961******************************************************************
  6962*                                                                *
  6963*                            ERCREIN                             *
  6964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6965*                            VMOD=2.010                          *
  6966*                                                                *
  6967*   ONLINE CREDIT SYSTEM                                         *
  6968*                                                                *
  6969*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6970*                                                                *
  6971*   FILE TYPE = VSAM,KSDS                                        *
  6972*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6973*                                                                *
  6974*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6975*       ALTERNATE PATH = NONE                                    *
  6976*                                                                *
  6977*   LOG = NO                                                     *
  6978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6979*                                                                *
  6980******************************************************************
  6981*                   C H A N G E   L O G
  6982*
  6983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6984*-----------------------------------------------------------------
  6985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6986* EFFECTIVE    NUMBER
  6987*-----------------------------------------------------------------
  6988* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6989* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6990******************************************************************
  6991 01  REINSURANCE-RECORD.
  6992     12  RE-RECORD-ID                      PIC XX.
  6993         88  VALID-RE-ID                      VALUE 'RE'.
  6994
  6995     12  RE-CONTROL-PRIMARY.
  6996         16  RE-COMPANY-CD                 PIC X.
  6997         16  RE-KEY.
  6998             20  RE-CODE                   PIC X.
  6999                 88  RE-TABLE-RECORD          VALUE 'A'.
  7000                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7001             20  RE-TABLE                  PIC XXX.
  7002             20  FILLER                    PIC XXX.
  7003         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7004             20  FILLER                    PIC X.
  7005             20  RE-COMPANY.
  7006                 24  RE-COMP-PRIME         PIC XXX.
  7007                 24  RE-COMP-SUB           PIC XXX.
  7008
  7009     12  RE-MAINT-INFORMATION.
  7010         16  RE-LAST-MAINT-DT              PIC XX.
  7011         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7012         16  RE-LAST-MAINT-USER            PIC X(4).
  7013         16  FILLER                        PIC X(10).
  7014
  7015     12  RE-TABLE-DATA.
  7016         16  RE-100-COMP                   PIC 99.
  7017
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 129
* EL050.cbl
  7018         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7019             20  RE-REI-COMP-NO.
  7020                 24  RE-REI-COMP           PIC XXX.
  7021                 24  RE-REI-COMP-SUB       PIC XXX.
  7022             20  RE-LF-QC                  PIC X.
  7023             20  RE-AH-QC                  PIC X.
  7024             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7025             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7026             20  RE-LFAGE-LO               PIC 99.
  7027             20  RE-LFAGE-HI               PIC 99.
  7028             20  RE-AHAGE-LO               PIC 99.
  7029             20  RE-AHAGE-HI               PIC 99.
  7030             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7031             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7032             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7033             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7034             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7035             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7036             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7037             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7038             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7039             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7040             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7041             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7042             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7043             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7044             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7045             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7046             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7047             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7048             20  RE-LF-BEN-CODE            PIC X.
  7049             20  RE-AH-BEN-CODE            PIC X.
  7050             20  RE-INTERACTIVE            PIC X.
  7051             20  RE-REMAINING              PIC X.
  7052             20  RE-LF-RUNOFF-SW           PIC X.
  7053             20  RE-AH-RUNOFF-SW           PIC X.
  7054             20  FILLER                    PIC X(19).
  7055
  7056         16  RE-COMP-INFO-END              PIC X(6).
  7057         16  RE-NSP-ST-CD-LF               PIC XX.
  7058         16  RE-NSP-ST-CD-AH               PIC XX.
  7059         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7060             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7061
  7062         16  FILLER                        PIC X(27).
  7063
  7064     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7065         16  RE-NAME                       PIC X(30).
  7066         16  RE-LF-PE                      PIC X.
  7067         16  RE-AH-PE                      PIC X.
  7068         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7069         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7070         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7071         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7072         16  RE-PRT-ST                     PIC X.
  7073         16  RE-PRT-OW                     PIC X.
  7074         16  RE-MORT-CODE                  PIC X(4).
  7075         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 130
* EL050.cbl
  7076         16  RE-ZERO-LF-FEE                PIC X.
  7077         16  RE-ZERO-AH-FEE                PIC X.
  7078         16  RE-CEDE-NAME                  PIC X(30).
  7079         16  RE-LF-COMM                    PIC X.
  7080         16  RE-AH-COMM                    PIC X.
  7081         16  RE-LF-TAX                     PIC X.
  7082         16  RE-AH-TAX                     PIC X.
  7083         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7084         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7085         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7086
  7087         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7088             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7089
  7090         16  RE-LF-CEDING-FEE-BRACKETS.
  7091             20  RE-LF-FEE-METHOD          PIC X.
  7092                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7093                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7094                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7095                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7096             20  RE-LF-FEE-BASIS           PIC X.
  7097                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7098                 88  RE-LF-NET-CEDED               VALUE '2'.
  7099                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7100                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7101                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7102                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7103                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7104                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7105             20  FILLER                    PIC XXX.
  7106             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7107                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7108                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7109
  7110         16  RE-AH-CEDING-FEE-BRACKETS.
  7111             20  RE-AH-FEE-METHOD          PIC X.
  7112                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7113                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7114                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7115                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7116             20  RE-AH-FEE-BASIS           PIC X.
  7117                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7118                 88  RE-AH-NET-CEDED               VALUE '2'.
  7119                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7120                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7121                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7122                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7123                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7124                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7125             20  FILLER                    PIC XXX.
  7126             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7127                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7128                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7129
  7130         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7131
  7132         16  RE-OLD-CEDING-STMT            PIC X.
  7133
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 131
* EL050.cbl
  7134         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7135         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7136         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7137         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7138         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7139         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7140         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7141         16  RE-MORT-SW                    PIC X.
  7142         16  RE-CEDING-TYPE-FLAG           PIC X.
  7143             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7144             88  RE-CEDED                          VALUE 'C'.
  7145             88  RE-ASSUMED                        VALUE 'A'.
  7146             88  RE-PHANTOM                        VALUE 'P'.
  7147
  7148         16  RE-CEDING-STMT-OPT-A          PIC X.
  7149             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7150         16  RE-CEDING-STMT-OPT-B          PIC X.
  7151             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7152         16  RE-CEDING-STMT-OPT-C          PIC X.
  7153             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7154         16  RE-CEDING-STMT-OPT-D          PIC X.
  7155             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7156         16  RE-CEDING-STMT-OPT-E          PIC X.
  7157             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7158
  7159         16  RE-PRT-CRSV                   PIC X.
  7160
  7161         16  RE-GL-CENTER                  PIC X(4).
  7162
  7163         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7164
  7165         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7166
  7167         16  RE-EARN-STOP-CODE             PIC X.
  7168             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7169             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7170
  7171         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7172             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7173
  7174         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7175         16  FILLER                        PIC X(2281).
  7176
  7177         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7178
  7179******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 132
* EL050.cbl
  7181*    COPY ERCCTBL.
  7182******************************************************************
  7183*                                                                *
  7184*                                                                *
  7185*                            ERCCTBL                             *
  7186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7187*                            VMOD=2.003
  7188*                                                                *
  7189*   ONLINE CREDIT SYSTEM                                         *
  7190*                                                                *
  7191*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7192*                                                                *
  7193*   FILE TYPE = VSAM,KSDS                                        *
  7194*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7195*                                                                *
  7196*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7197*       ALTERNATE PATH = NONE                                    *
  7198*                                                                *
  7199*   LOG = NO                                                     *
  7200*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7201*                                                                *
  7202*                                                                *
  7203******************************************************************
  7204
  7205 01  COMM-TABLE-RECORD.
  7206     12  CT-RECORD-ID                      PIC XX.
  7207         88  VALID-CT-ID                      VALUE 'CT'.
  7208
  7209     12  CT-CONTROL-PRIMARY.
  7210         16  CT-COMPANY-CD                 PIC X.
  7211         16  CT-TABLE                      PIC XXX.
  7212         16  CT-CNTRL-2.
  7213             20  CT-BEN-TYPE               PIC X.
  7214             20  CT-BEN-CODE               PIC XX.
  7215
  7216     12  CT-MAINT-INFORMATION.
  7217         16  CT-LAST-MAINT-DT              PIC XX.
  7218         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7219         16  CT-LAST-MAINT-USER            PIC X(4).
  7220         16  FILLER                        PIC X(31).
  7221
  7222     12  CT-LIMITS.
  7223         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7224
  7225         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7226
  7227         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7228
  7229     12  CT-RATES.
  7230         16  CT-RTX          OCCURS 27 TIMES.
  7231             20  CT-RT                     PIC SV9(5)     COMP-3.
  7232             20  CT-RT-R   REDEFINES
  7233                 CT-RT                     PIC XXX.
  7234
  7235     12  FILLER                            PIC  X(42).
  7236
  7237******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 133
* EL050.cbl
  7239*    COPY ERCFORM.
  7240******************************************************************
  7241*                                                                *
  7242*                                                                *
  7243*                            ERCFORM.                            *
  7244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7245*                            VMOD=2.003                          *
  7246*                                                                *
  7247*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7248*                                                                *
  7249*    FILE TYPE = VSAM,KSDS                                       *
  7250*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7251*                                                                *
  7252*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7253*                                                                *
  7254*    LOG = YES                                                   *
  7255*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7256******************************************************************
  7257 01  FORM-MASTER.
  7258    12  FO-RECORD-ID                 PIC X(02).
  7259        88  VALID-FO-ID                  VALUE 'FO'.
  7260
  7261    12  FO-CONTROL-PRIMARY.
  7262        16  FO-COMPANY-CD            PIC X(01).
  7263        16  FO-STATE                 PIC X(02).
  7264        16  FO-FORM-ID               PIC X(12).
  7265        16  FO-FORM-EXP-DT           PIC X(02).
  7266
  7267    12  FO-POLICY-FORM-DATA.
  7268        16  FO-IND-GRP-CD            PIC X(01).
  7269        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7270        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7271        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7272        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7273        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7274        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7275        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7276        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7277        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7278        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7279        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7280        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7281        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7282        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7283        16  FO-APP-CERT-USE-CD       PIC X(01).
  7284
  7285    12  FILLER                       PIC X(29).
  7286
  7287    12  FO-FORM-PLAN-TABLE.
  7288        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7289            20  FO-PLAN-TYPE         PIC X(01).
  7290            20  FO-PLAN-ID           PIC X(02).
  7291            20  FO-PLAN-TERM         PIC 9(03).
  7292            20  FO-PLAN-REFUND-METHOD
  7293                                     PIC X.
  7294
  7295    12  FILLER                       PIC X(30).
  7296
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 134
* EL050.cbl
  7297    12  FO-COMMENTS-AREA.
  7298        16  FO-COMMENT-LINE-1        PIC X(78).
  7299
  7300    12  FILLER                       PIC X(20).
  7301
  7302    12  FO-MAINT-INFORMATION.
  7303        16  FO-LAST-MAINT-DT         PIC X(02).
  7304        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7305        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 135
* EL050.cbl
  7307*    COPY ELCMSTR.
  7308******************************************************************
  7309*                                                                *
  7310*                            ELCMSTR.                            *
  7311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7312*                            VMOD=2.012                          *
  7313*                                                                *
  7314*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7315*                                                                *
  7316*   FILE TYPE = VSAM,KSDS                                        *
  7317*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7318*                                                                *
  7319*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7320*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7321*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7322*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7323*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7324*                                                 RKP=75,LEN=21  *
  7325*                                                                *
  7326*   **** NOTE ****                                               *
  7327*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7328*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7329*                                                                *
  7330*   LOG = YES                                                    *
  7331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7332******************************************************************
  7333*                   C H A N G E   L O G
  7334*
  7335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7336*-----------------------------------------------------------------
  7337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7338* EFFECTIVE    NUMBER
  7339*-----------------------------------------------------------------
  7340* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7341* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7342* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7343* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7344* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7345******************************************************************
  7346 01  CLAIM-MASTER.
  7347     12  CL-RECORD-ID                PIC XX.
  7348         88  VALID-CL-ID         VALUE 'CL'.
  7349
  7350     12  CL-CONTROL-PRIMARY.
  7351         16  CL-COMPANY-CD           PIC X.
  7352         16  CL-CARRIER              PIC X.
  7353         16  CL-CLAIM-NO             PIC X(7).
  7354         16  CL-CERT-NO.
  7355             20  CL-CERT-PRIME       PIC X(10).
  7356             20  CL-CERT-SFX         PIC X.
  7357
  7358     12  CL-CONTROL-BY-NAME.
  7359         16  CL-COMPANY-CD-A1        PIC X.
  7360         16  CL-INSURED-LAST-NAME    PIC X(15).
  7361         16  CL-INSURED-NAME.
  7362             20  CL-INSURED-1ST-NAME PIC X(12).
  7363             20  CL-INSURED-MID-INIT PIC X.
  7364
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 136
* EL050.cbl
  7365     12  CL-CONTROL-BY-SSN.
  7366         16  CL-COMPANY-CD-A2        PIC X.
  7367         16  CL-SOC-SEC-NO.
  7368             20  CL-SSN-STATE        PIC XX.
  7369             20  CL-SSN-ACCOUNT      PIC X(6).
  7370             20  CL-SSN-LN3          PIC X(3).
  7371
  7372     12  CL-CONTROL-BY-CERT-NO.
  7373         16  CL-COMPANY-CD-A4        PIC X.
  7374         16  CL-CERT-NO-A4.
  7375             20  CL-CERT-A4-PRIME    PIC X(10).
  7376             20  CL-CERT-A4-SFX      PIC X.
  7377
  7378     12  CL-CONTROL-BY-CCN.
  7379         16  CL-COMPANY-CD-A5        PIC X.
  7380         16  CL-CCN-A5.
  7381             20  CL-CCN.
  7382                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7383                 24  CL-CCN-PRIME-A5 PIC X(12).
  7384             20  CL-CCN-FILLER-A5    PIC X(4).
  7385
  7386     12  CL-INSURED-PROFILE-DATA.
  7387         16  CL-INSURED-BIRTH-DT     PIC XX.
  7388         16  CL-INSURED-SEX-CD       PIC X.
  7389             88  INSURED-IS-MALE        VALUE 'M'.
  7390             88  INSURED-IS-FEMALE      VALUE 'F'.
  7391             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7392         16  CL-INSURED-OCC-CD       PIC X(6).
  7393         16  FILLER                  PIC X(5).
  7394
  7395     12  CL-PROCESSING-INFO.
  7396         16  CL-PROCESSOR-ID         PIC X(4).
  7397         16  CL-CLAIM-STATUS         PIC X.
  7398             88  CLAIM-IS-OPEN          VALUE 'O'.
  7399             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7400         16  CL-CLAIM-TYPE           PIC X.
  7401*            88  AH-CLAIM               VALUE 'A'.
  7402*            88  LIFE-CLAIM             VALUE 'L'.
  7403*            88  PROPERTY-CLAIM         VALUE 'P'.
  7404*            88  IUI-CLAIM              VALUE 'I'.
  7405*            88  GAP-CLAIM              VALUE 'G'.
  7406*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7407         16  CL-CLAIM-PREM-TYPE      PIC X.
  7408             88  SINGLE-PREMIUM         VALUE '1'.
  7409             88  O-B-COVERAGE           VALUE '2'.
  7410             88  OPEN-END-COVERAGE      VALUE '3'.
  7411         16  CL-INCURRED-DT          PIC XX.
  7412         16  CL-REPORTED-DT          PIC XX.
  7413         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7414         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7415         16  CL-LAST-PMT-DT          PIC XX.
  7416         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7417         16  CL-PAID-THRU-DT         PIC XX.
  7418         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7419         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7420         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7421         16  CL-PMT-CALC-METHOD      PIC X.
  7422             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 137
* EL050.cbl
  7423             88  CL-365-DAY-YR          VALUE '2'.
  7424             88  CL-FULL-MONTHS         VALUE '3'.
  7425         16  CL-CAUSE-CD             PIC X(6).
  7426
  7427         16  CL-PRIME-CERT-NO.
  7428             20  CL-PRIME-CERT-PRIME PIC X(10).
  7429             20  CL-PRIME-CERT-SFX   PIC X.
  7430
  7431         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7432             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7433             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7434
  7435         16  CL-MICROFILM-NO         PIC X(10).
  7436         16  FILLER REDEFINES CL-MICROFILM-NO.
  7437             20  CL-BENEFIT-PERIOD   PIC 99.
  7438             20  FILLER              PIC X(8).
  7439         16  CL-PROG-FORM-TYPE       PIC X.
  7440         16  CL-LAST-ADD-ON-DT       PIC XX.
  7441
  7442         16  CL-LAST-REOPEN-DT       PIC XX.
  7443         16  CL-LAST-CLOSE-DT        PIC XX.
  7444         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7445             88  FINAL-PAID             VALUE '1'.
  7446             88  CLAIM-DENIED           VALUE '2'.
  7447             88  AUTO-CLOSE             VALUE '3'.
  7448             88  MANUAL-CLOSE           VALUE '4'.
  7449             88  BENEFITS-CHANGED       VALUE 'C'.
  7450             88  SETUP-ERRORS           VALUE 'E'.
  7451         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7452         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7453         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7454             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7455         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7456         16  FILLER                  PIC X.
  7457
  7458     12  CL-CERTIFICATE-DATA.
  7459         16  CL-CERT-ORIGIN          PIC X.
  7460             88  CERT-WAS-ONLINE        VALUE '1'.
  7461             88  CERT-WAS-CREATED       VALUE '2'.
  7462             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7463         16  CL-CERT-KEY-DATA.
  7464             20  CL-CERT-CARRIER     PIC X.
  7465             20  CL-CERT-GROUPING    PIC X(6).
  7466             20  CL-CERT-STATE       PIC XX.
  7467             20  CL-CERT-ACCOUNT.
  7468                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7469                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7470             20  CL-CERT-EFF-DT      PIC XX.
  7471
  7472     12  CL-STATUS-CONTROLS.
  7473         16  CL-PRIORITY-CD          PIC X.
  7474             88  CONFIDENTIAL-DATA      VALUE '8'.
  7475             88  HIGHEST-PRIORITY       VALUE '9'.
  7476         16  CL-SUPV-ATTN-CD         PIC X.
  7477             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7478             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7479         16  CL-PURGED-DT            PIC XX.
  7480         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 138
* EL050.cbl
  7481         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7482         16  CL-NEXT-RESEND-DT       PIC XX.
  7483         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7484         16  CL-CRITICAL-PERIOD      PIC 99.
  7485*        16  FILLER                  PIC XX.
  7486         16  CL-LAST-MAINT-DT        PIC XX.
  7487         16  CL-LAST-MAINT-USER      PIC X(4).
  7488         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7489         16  CL-LAST-MAINT-TYPE      PIC X.
  7490             88  CLAIM-SET-UP           VALUE ' '.
  7491             88  PAYMENT-MADE           VALUE '1'.
  7492             88  LETTER-SENT            VALUE '2'.
  7493             88  MASTER-WAS-ALTERED     VALUE '3'.
  7494             88  MASTER-WAS-RESTORED    VALUE '4'.
  7495             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7496             88  FILE-CONVERTED         VALUE '6'.
  7497             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7498             88  ERROR-CORRECTION       VALUE 'E'.
  7499         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7500         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7501         16  CL-BENEFICIARY          PIC X(10).
  7502         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7503         16  CL-DENIAL-TYPE          PIC X.
  7504             88  CL-TYPE-DENIAL          VALUE '1'.
  7505             88  CL-TYPE-RESCISSION      VALUE '2'.
  7506             88  CL-TYPE-REFORMATION     VALUE '3'.
  7507             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7508             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7509         16  filler                  pic x(5).
  7510*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7511*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7512*        16  CL-RTW-DT               PIC XX.
  7513
  7514     12  CL-TRAILER-CONTROLS.
  7515         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7516             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7517             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7518             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7519         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7520         16  FILLER                  PIC XX.
  7521         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7522         16  CL-ADDRESS-TRAILER-CNT.
  7523             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7524                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7525             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7526                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7527             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7528                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7529             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7530                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7531             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7532                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7533             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7534                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7535             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7536                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7537
  7538     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 139
* EL050.cbl
  7539         16  CL-CV-REFNO-PRIME       PIC X(18).
  7540         16  CL-CV-REFNO-SFX         PIC XX.
  7541
  7542     12  CL-FILE-LOCATION            PIC X(4).
  7543
  7544     12  CL-PROCESS-ERRORS.
  7545         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7546             88  NO-FATAL-ERRORS        VALUE ZERO.
  7547         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7548             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7549
  7550     12  CL-PRODUCT-CD               PIC X.
  7551
  7552     12  CL-CURRENT-KEY-DATA.
  7553         16  CL-CURRENT-CARRIER      PIC X.
  7554         16  CL-CURRENT-GROUPING     PIC X(6).
  7555         16  CL-CURRENT-STATE        PIC XX.
  7556         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7557
  7558     12  CL-ASSOCIATES               PIC X.
  7559         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7560         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7561         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7562         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7563
  7564     12  CL-ACTIVITY-CODE            PIC 99.
  7565     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7566     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7567
  7568     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7569     12  CL-LAG-REPORT-CODE          PIC 9.
  7570     12  CL-LOAN-TYPE                PIC XX.
  7571     12  CL-LEGAL-STATE              PIC XX.
  7572
  7573     12  CL-YESNOSW                  PIC X.
  7574     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7575         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7576         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7577         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7578     12  cl-insured-type             pic x.
  7579         88  cl-claim-on-primary         value 'P'.
  7580         88  cl-claim-on-co-borrower     value 'C'.
  7581     12  cl-benefit-expiration-dt    PIC XX.
  7582
  7583 01  PLAN-RECORDS.
  7584     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7585     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7586
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 140
* EL050.cbl
  7588 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7589                          ACCOUNT-MASTER REINSURANCE-RECORD
  7590                          COMM-TABLE-RECORD FORM-MASTER
  7591                          CLAIM-MASTER PLAN-RECORDS.
  7592 0000-DFHEXIT SECTION.
  7593     MOVE '9#                    $   ' TO DFHEIV0.
  7594     MOVE 'EL050' TO DFHEIV1.
  7595     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7596
  7597     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7598
  7599
  7600* EXEC CICS  HANDLE CONDITION
  7601*           ERROR    (9300-ABEND)
  7602*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7603*    END-EXEC.
  7604*    MOVE '"$.J                  ! " #00007595' TO DFHEIV0
  7605     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7607     MOVE X'2220233030303037353935' TO DFHEIV0(25:11)
  7608     CALL 'kxdfhei1' USING DFHEIV0
  7609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7610
  7611
  7612 0000-COPY-PROCEDURE-DIV.
  7613*                          COPY ELC50PD.
  7614******************************************************************
  7615*                                                                *
  7616*                            ELC50PD                             *
  7617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7618*                            VMOD=2.188                          *
  7619*                                                                *
  7620******************************************************************
  7621*                   C H A N G E   L O G
  7622*
  7623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7624*-----------------------------------------------------------------
  7625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7626* EFFECTIVE    NUMBER
  7627*-----------------------------------------------------------------
  7628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7629* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7630* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7631*                             2709 AND 2718
  7632* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7633* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7634* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7635* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7636* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7637*                                IS OPEN OR CNC DT < PD THRU
  7638* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7639* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7640* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7641* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7642* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7643* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7644* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7645* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 141
* EL050.cbl
  7646* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7647* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7648* 020906                   PEMA  EXPAND LOAN OFFICER
  7649* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7650* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7651* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7652* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7653* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7654* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7655* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7656* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7657* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7658* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7659* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7660* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7661* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7662* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7663* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7664* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7665* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7666* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7667* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7668* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7669* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7670* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7671* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7672* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7673* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7674*                                UPDATE VIN ON CERT TRAILER
  7675* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7676* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7677* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7678* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7679* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7680* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7681* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7682* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7683* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7684* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7685* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7686* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7687* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7688* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7689* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7690* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7691* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7692* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7693* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7694* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7695* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7696* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7697* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7698* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7699* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7700* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7701* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7702* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7703* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 142
* EL050.cbl
  7704* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7705* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7706* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7707* 032912  CR2011110200001  PEMA  AHL CHANGES
  7708* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7709* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7710* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7711* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7712* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7713* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7714* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7715* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7716* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7717* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7718* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7719* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7720* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7721* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7722* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7723* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7724* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7725* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7726* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7727* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7728* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7729* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7730* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7731* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7732* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7733* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7734* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7735*                                CERT #, ADD 2898 FORCIBLE ERROR
  7736* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7737* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7738******************************************************************
  7739************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7740******************************************************************
  7741
  7742     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7743
  7744     MOVE SPACES                 TO PB-FATAL-FLAG
  7745                                    PB-FORCE-ER-CD
  7746                                    PB-WARN-ER-CD
  7747                                    PB-OUT-BAL-CD.
  7748
  7749     MOVE SPACE                  TO WS-IG-OVRD-AH
  7750                                    WS-IG-OVRD-LF
  7751                                    WS-IG-OVRD-AM
  7752                                    WS-IG-OVRD
  7753                                    WS-IG-OVRD-AH-PL
  7754                                    WS-IG-OVRD-LF-PL
  7755                                    WS-IG-OVRD-AH-BEN
  7756                                    WS-IG-OVRD-LF-BEN.
  7757
  7758******************************************************************
  7759*************       INITIALIZE COMMON ERRORS       ***************
  7760******************************************************************
  7761
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 143
* EL050.cbl
  7762     MOVE +0                     TO PB-NO-OF-ERRORS.
  7763     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7764
  7765******************************************************************
  7766
  7767     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7768     SET JULIAN-TO-BIN           TO TRUE.
  7769*    MOVE 5                      TO DC-OPTION-CODE.
  7770     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7771     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7772
  7773     MOVE ZERO                   TO  SUB4.
  7774
  7775 0040-INITIALIZE-GA-BILL-DT.
  7776
  7777     ADD +1                      TO  SUB4.
  7778
  7779     IF  SUB4 GREATER THAN +5
  7780         GO TO 0050-CHECK-CNTL-FOUND.
  7781
  7782     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7783         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7784
  7785     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7786
  7787 0050-CHECK-CNTL-FOUND.
  7788
  7789     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7790        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7791                                         WS-AH-REM-TERM-CALC
  7792                                         EC-CO-REM-TERM-CALC
  7793        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7794        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7795        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7796                                         WS-TOL-AH-CLAIM
  7797        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7798                                         WS-TOL-AH-PREM
  7799                                         EC-CO-TOL-PREM
  7800        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7801                                         WS-TOL-AH-REFUND
  7802                                         EC-CO-TOL-REFUND
  7803        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7804                                         WS-AH-REFUND-OVS-AMT
  7805                                         EC-CO-OVR-SHT-AMT
  7806        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7807                                         WS-TOL-AH-PREM-PCT
  7808                                         EC-CO-TOL-PREM-PCT
  7809        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7810                                         WS-TOL-AH-REFUND-PCT
  7811                                         EC-CO-TOL-REFUND-PCT
  7812        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7813                                         WS-AH-REFUND-OVS-PCT
  7814                                         EC-CO-OVR-SHT-PCT
  7815        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7816        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7817        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7818        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7819        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 144
* EL050.cbl
  7820        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7821        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7822        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7823        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7824        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7825        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7826        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7827                                         EC-CO-MONTH-END-DT
  7828        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7829          GO TO 0100-READ-ACCT.
  7830
  7831     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7832     MOVE SPACES                 TO CNTL-ACCESS.
  7833     MOVE '1'                    TO CNTL-REC-TYPE.
  7834     MOVE +0                     TO CNTL-SEQ-NO.
  7835
  7836     MOVE '1' TO RC-SW-1.
  7837     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7838     IF NOT CF-COMPANY-MASTER
  7839         MOVE ZEROS             TO WK-CO-TOL-PREM
  7840                                   WK-CO-TOL-CLAIM
  7841                                   WK-CO-TOL-REFUND
  7842                                   WK-REFUND-OVS-AMT
  7843                                   WK-REFUND-OVS-PCT
  7844                                   WK-CO-TOL-PREM-PCT
  7845                                   WK-CO-TOL-REFUND-PCT
  7846                                   WK-DEFAULT-APR
  7847                                   WK-CO-MAX-CAP
  7848        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7849                                   WK-CR-R78-METHOD
  7850                                   WK-CO-REF-REJECT-SW
  7851                                   WK-CO-PREM-REJECT-SW
  7852                                   WK-REM-TRM-CALC-OPTION
  7853                                   WK-BIRTH-DATE-INPUT
  7854                                   WK-JOINT-AGE-INPUT
  7855        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7856        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7857        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7858        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7859          GO TO 0099-COMPANY-NOT-FOUND.
  7860
  7861     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7862        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7863     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7864        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7865     IF CF-CO-TOL-CAP NOT NUMERIC
  7866        MOVE +0                    TO CF-CO-TOL-CAP.
  7867     IF CF-DEFAULT-APR NOT NUMERIC
  7868        MOVE +0                    TO CF-DEFAULT-APR.
  7869
  7870     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7871     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7872     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7873     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7874     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7875     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7876     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7877     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 145
* EL050.cbl
  7878     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7879     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7880     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7881     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7882
  7883     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7884          CF-CO-OVR-SHT-AMT > +0
  7885        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7886
  7887     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7888          CF-CO-OVR-SHT-PCT > +0
  7889        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7890
  7891     IF CF-VALID-REM-TRM-OPTION
  7892         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7893     ELSE
  7894         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7895
  7896     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7897     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7898     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7899     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7900
  7901     GO TO 0050-CHECK-CNTL-FOUND.
  7902
  7903 0099-COMPANY-NOT-FOUND.
  7904
  7905     MOVE ER-2616                TO WS-ERROR.
  7906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7907
  7908 0100-READ-ACCT.
  7909
  7910     MOVE SPACES                 TO DATE-RANGE-SW.
  7911
  7912     IF WK-ACCT-ADDR = ZEROS
  7913        GO TO 0102-ACCT-GETMAIN.
  7914
  7915     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7916     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7917     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7918
  7919     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7920        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7921        GO TO 0105-READ-ACCT
  7922     END-IF
  7923
  7924     IF PB-CARRIER NOT = SPACES
  7925        IF PB-CARRIER NOT = AM-VG-CARRIER
  7926           GO TO 0105-READ-ACCT.
  7927
  7928     IF PB-STATE NOT = SPACES
  7929        IF PB-STATE NOT = AM-VG-STATE
  7930           GO TO 0105-READ-ACCT.
  7931
  7932     IF PB-GROUPING NOT = SPACES
  7933        IF PB-GROUPING NOT = AM-VG-GROUPING
  7934           GO TO 0105-READ-ACCT.
  7935
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 146
* EL050.cbl
  7936     MOVE 'X'                 TO DATE-RANGE-SW.
  7937
  7938     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7939        MOVE 'X'                 TO DATE-RANGE-SW
  7940        GO TO 0105-READ-ACCT.
  7941
  7942     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7943        GO TO 0105-READ-ACCT.
  7944
  7945     GO TO 0180-ACCOUNT-FOUND.
  7946
  7947 0102-ACCT-GETMAIN.
  7948     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7949     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7950
  7951 0105-READ-ACCT.
  7952     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7953     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7954     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7955     MOVE PB-STATE               TO ACCT-STATE.
  7956     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7957     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7958
  7959     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7960
  7961     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7962
  7963 0110-FIND-ACCT-TOLERANCES-LOOP.
  7964     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7965
  7966     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7967        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7968        GO TO 0199-ACCT-NOT-FOUND
  7969     END-IF
  7970     IF PB-CARRIER NOT = SPACES
  7971        IF PB-CARRIER NOT = AM-VG-CARRIER
  7972           GO TO 0199-ACCT-NOT-FOUND.
  7973
  7974     IF PB-STATE NOT = SPACES
  7975        IF PB-STATE NOT = AM-VG-STATE
  7976           GO TO 0199-ACCT-NOT-FOUND.
  7977
  7978     IF PB-GROUPING NOT = SPACES
  7979        IF PB-GROUPING NOT = AM-VG-GROUPING
  7980           GO TO 0199-ACCT-NOT-FOUND.
  7981
  7982     MOVE 'X'                    TO DATE-RANGE-SW.
  7983
  7984     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7985        MOVE 'X'                 TO DATE-RANGE-SW
  7986        GO TO 0199-ACCT-NOT-FOUND.
  7987
  7988     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7989        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7990
  7991 0180-ACCOUNT-FOUND.
  7992     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7993     MOVE AM-CARRIER             TO PB-SV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 147
* EL050.cbl
  7994     MOVE AM-STATE               TO PB-SV-STATE.
  7995     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7996
  7997     IF AM-CANCEL-FEE  NOT NUMERIC
  7998        MOVE ZEROS TO AM-CANCEL-FEE.
  7999
  8000     IF AM-MAX-MON-BEN NOT NUMERIC
  8001        MOVE ZEROS TO AM-MAX-MON-BEN.
  8002
  8003     IF AM-MAX-TOT-BEN NOT NUMERIC
  8004        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8005
  8006     IF AM-CLP-TOL-PCT NOT NUMERIC
  8007        MOVE +0                  TO AM-CLP-TOL-PCT
  8008     END-IF
  8009     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8010        MOVE +0                  TO AM-SPP-LEASE-COMM
  8011     END-IF
  8012     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8013        MOVE ER-2611             TO   WS-ERROR
  8014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8015
  8016     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8017        MOVE ER-2621             TO   WS-ERROR
  8018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8019
  8020     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8021        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8022        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8023        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8024         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8025
  8026     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8027     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8028     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8029     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8030     IF AM-CLP-TOL-PCT NOT = ZEROS
  8031        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8032     END-IF
  8033     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8034        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8035     END-IF
  8036*    IF PB-COMPANY-ID = 'DCC'
  8037*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8038*                                   WS-ADMIN-FEES
  8039*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8040*          (SUB5 > +10)
  8041*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8042*             AND (AM-A-COM (SUB5) NUMERIC)
  8043*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8044*                + (AM-A-COM (SUB5) * 1000)
  8045*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8046*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8047*                + (AM-A-COM (SUB5) * 1000)
  8048*             END-IF
  8049*             IF AM-COM-TYP (SUB5) = 'N'
  8050*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8051*                + (AM-A-COM (SUB5) * 1000)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 148
* EL050.cbl
  8052*             END-IF
  8053*          END-IF
  8054*       END-PERFORM
  8055*    END-IF
  8056     IF (PB-COMPANY-ID = 'DCC')
  8057        AND (PB-ISSUE)
  8058        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8059                                    ws-cred-union-fees
  8060        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8061           (SUB5 > +10)
  8062           MOVE +0 TO WS-WK-RATE
  8063           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8064                                   'O' OR 'S')
  8065              IF (AM-A-COM (SUB5) NUMERIC)
  8066                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8067                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8068              ELSE
  8069                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8070                 IF PB-ISSUE
  8071                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8072                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8073                 ELSE
  8074                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8075                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8076                 END-IF
  8077                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8078                 MOVE ZEROS             TO WS-SUB1
  8079                                           WS-COMMISSION
  8080                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8081                 MOVE '0530'               TO CTBL-SW
  8082                 MOVE ' '                  TO WS-CTBL-READ-SW
  8083                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8084                 IF FIRST-TIME-THROUGH
  8085                    MOVE 'AA'              TO CTBL-BEN-CODE
  8086                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8087                 END-IF
  8088                 IF CTBL-TABLE-FOUND
  8089                    IF PB-ISSUE
  8090                       COMPUTE WS-COMM-CK-AMT =
  8091                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8092                    ELSE
  8093                       COMPUTE WS-COMM-CK-AMT =
  8094                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8095                    END-IF
  8096                    PERFORM 8800-GET-COMP-RATE
  8097                              THRU 8800-EXIT
  8098                 END-IF
  8099              END-IF
  8100              if am-com-typ (sub5) = 'O' or 'S'
  8101                 compute ws-cred-union-fees rounded =
  8102                    ws-cred-union-fees +
  8103                    (pb-i-ah-premium-amt * ws-wk-rate)
  8104              else
  8105                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8106                + (WS-WK-RATE * 1000)
  8107              end-if
  8108           END-IF
  8109        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 149
* EL050.cbl
  8110     END-IF
  8111     IF PB-COMPANY-ID EQUAL 'CRI'
  8112         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8113
  8114     IF PB-COMPANY-ID EQUAL 'NCL'
  8115         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8116     END-IF
  8117
  8118     GO TO 0200-READ-CERT.
  8119
  8120 0199-ACCT-NOT-FOUND.
  8121
  8122     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8123
  8124     IF DATE-RANGE-SW NOT = SPACES
  8125        MOVE ER-2601             TO WS-ERROR
  8126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8127     ELSE
  8128        MOVE ER-2619             TO WS-ERROR
  8129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8130
  8131     GO TO 9990-RETURN.
  8132
  8133 0200-READ-CERT.
  8134
  8135     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8136     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8137     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8138     MOVE PB-SV-STATE            TO CERT-STATE.
  8139     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8140     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8141     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8142
  8143     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8144
  8145     IF CERT-WAS-NOT-FOUND
  8146        GO TO 0299-CERT-NOT-FOUND.
  8147
  8148     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8149        MOVE ER-2759             TO WS-ERROR
  8150        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8151        GO TO 0298-UNLOCK-RETURN.
  8152
  8153     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8154         MOVE ER-2758            TO WS-ERROR
  8155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8156         GO TO 0298-UNLOCK-RETURN.
  8157
  8158     IF PB-ISSUE
  8159        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8160           IF CERT-WAS-CREATED-FOR-CLAIM
  8161              NEXT SENTENCE
  8162            ELSE
  8163              MOVE ER-2626       TO WS-ERROR
  8164              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8165              GO TO 0298-UNLOCK-RETURN.
  8166
  8167     IF NOT PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 150
* EL050.cbl
  8168        GO TO 0300-CONTINUE-EDIT.
  8169
  8170     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8171     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8172     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8173     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8174     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8175     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8176
  8177     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8178     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8179     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8180     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8181     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8182     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8183     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8184     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8185     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8186
  8187     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8188     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8189     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8190     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8191     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8192     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8193     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8194
  8195     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8196     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8197
  8198     MOVE CM-CREDIT-INTERFACE-SW-1
  8199                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8200     MOVE CM-CREDIT-INTERFACE-SW-2
  8201                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8202
  8203     IF CM-O-B-COVERAGE
  8204         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8205
  8206     IF CM-LIVES NOT NUMERIC
  8207         MOVE ZERO                TO CM-LIVES.
  8208
  8209     IF CM-BILLED NOT NUMERIC
  8210         MOVE ZERO                TO CM-BILLED.
  8211
  8212     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8213         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8214         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8215         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8216         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8217         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8218         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8219         MOVE CM-LIVES             TO PB-CI-LIVES
  8220*The next line causes a problem with my change  I dont think it is
  8221*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8222
  8223     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8224     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8225     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 151
* EL050.cbl
  8226     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8227     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8228     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8229
  8230     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8231     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8232     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8233     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8234
  8235     IF CM-LIFE-COMM-PCT NUMERIC
  8236         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8237     ELSE
  8238         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8239
  8240     IF CM-AH-COMM-PCT NUMERIC
  8241         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8242     ELSE
  8243         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8244
  8245     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8246
  8247     IF CM-LOAN-APR       NOT NUMERIC
  8248           MOVE ZERO               TO CM-LOAN-APR.
  8249
  8250     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8251           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8252
  8253     IF CM-LOAN-TERM      NOT NUMERIC
  8254           MOVE ZERO               TO CM-LOAN-TERM.
  8255
  8256     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8257           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8258
  8259     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8260           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8261
  8262     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8263     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8264     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8265     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8266     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8267     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8268     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8269     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8270     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8271     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8272     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8273     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8274
  8275     IF CM-STATE = CM-SSN-STATE
  8276         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8277
  8278     IF CM-STATE NOT = CM-MEMB-STATE
  8279         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8280
  8281     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8282
  8283     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 152
* EL050.cbl
  8284        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8285        IF CM-ADDL-CLP NOT NUMERIC
  8286           MOVE +0               TO CM-ADDL-CLP
  8287        END-IF
  8288        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8289        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8290           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8291        END-IF
  8292     END-IF
  8293     IF PB-COMPANY-ID = 'DCC'
  8294        MOVE +0                  TO WS-ADMIN-FEES
  8295                                    WS-CSO-ADMIN-FEE
  8296                                    WS-COMM-AND-MFEE
  8297                                    WS-1ST-YR-ALLOW
  8298        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8299           (SUB5 > +10)
  8300           MOVE +0 TO WS-WK-RATE
  8301           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8302              IF (AM-A-COM (SUB5) NUMERIC)
  8303                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8304                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8305              ELSE
  8306                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8307                 IF PB-ISSUE
  8308                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8309                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8310                 ELSE
  8311                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8312                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8313                 END-IF
  8314                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8315                 MOVE ZEROS             TO WS-SUB1
  8316                                           WS-COMMISSION
  8317                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8318                 MOVE '0530'               TO CTBL-SW
  8319                 MOVE ' '                  TO WS-CTBL-READ-SW
  8320                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8321                 IF FIRST-TIME-THROUGH
  8322                    MOVE 'AA'              TO CTBL-BEN-CODE
  8323                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8324                 END-IF
  8325                 IF CTBL-TABLE-FOUND
  8326                    IF PB-ISSUE
  8327                       COMPUTE WS-COMM-CK-AMT =
  8328                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8329                    ELSE
  8330                       COMPUTE WS-COMM-CK-AMT =
  8331                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8332                    END-IF
  8333                    PERFORM 8800-GET-COMP-RATE
  8334                              THRU 8800-EXIT
  8335                 END-IF
  8336              END-IF
  8337              IF AM-COM-TYP (SUB5) = 'I'
  8338                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8339                   + (WS-WK-RATE * 1000)
  8340              END-IF
  8341              IF AM-COM-TYP (SUB5) = 'N'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 153
* EL050.cbl
  8342                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8343                   + (WS-WK-RATE * 1000)
  8344              END-IF
  8345              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8346                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8347                   + (WS-WK-RATE * 1000)
  8348              END-IF
  8349              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8350                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8351                   + (WS-WK-RATE * 1000)
  8352              END-IF
  8353           END-IF
  8354        END-PERFORM
  8355     END-IF
  8356     GO TO 0300-CONTINUE-EDIT.
  8357
  8358 0298-UNLOCK-RETURN.
  8359      PERFORM 9250-UNLOCK-RETURN
  8360      GO TO 9990-RETURN.
  8361
  8362 0299-CERT-NOT-FOUND.
  8363
  8364     MOVE '1'                     TO CERT-STATUS-SW.
  8365
  8366     IF PB-COMPANY-ID = 'UCL'
  8367         IF WS-ERROR = ER-2799
  8368             GO TO 3000-CONTINUE-EDIT.
  8369
  8370     IF NOT PB-CANCELLATION
  8371         GO TO 0300-CONTINUE-EDIT.
  8372
  8373     MOVE ER-2726                  TO  WS-ERROR.
  8374     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8375     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8376     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8377                                    PB-CI-LF-TERM
  8378                                    PB-C-LF-REM-TERM
  8379                                    PB-CI-AH-TERM
  8380                                    PB-C-AH-REM-TERM
  8381                                    PB-CI-LF-BENEFIT-CD
  8382                                    PB-CI-LF-BENEFIT-AMT
  8383                                    PB-CI-LF-ALT-BENEFIT-AMT
  8384                                    PB-CI-LF-PREMIUM-AMT
  8385                                    PB-CI-LF-ALT-PREMIUM-AMT
  8386                                    PB-CI-AH-BENEFIT-CD
  8387                                    PB-CI-AH-BENEFIT-AMT
  8388                                    PB-CI-AH-PREMIUM-AMT
  8389                                    PB-CI-PAY-FREQUENCY
  8390                                    PB-CI-LOAN-APR
  8391                                    PB-CI-LOAN-TERM
  8392                                    PB-CI-LIFE-COMMISSION
  8393                                    PB-CI-AH-COMMISSION
  8394                                    PB-CI-CURR-SEQ
  8395                                    PB-CI-AH-CANCEL-AMT
  8396                                    PB-CI-LF-CANCEL-AMT
  8397                                    PB-CI-RATE-DEV-PCT-LF
  8398                                    PB-CI-RATE-DEV-PCT-AH
  8399                                    PB-CI-EXTENTION-DAYS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 154
* EL050.cbl
  8400                                    PB-CI-TERM-IN-DAYS
  8401                                    PB-CI-LIVES
  8402                                    PB-CI-LF-CRIT-PER
  8403                                    PB-CI-AH-CRIT-PER
  8404                                    PB-CI-ADDL-CLP
  8405                                    PB-CI-DDF-IU-RATE-UP.
  8406
  8407     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8408                                    PB-CI-AH-SETTLEMENT-DT
  8409                                    PB-CI-DEATH-DT
  8410                                    PB-CI-LF-PRIOR-CANCEL-DT
  8411                                    PB-CI-AH-PRIOR-CANCEL-DT
  8412                                    PB-CI-ENTRY-DT
  8413                                    PB-CI-LF-EXPIRE-DT
  8414                                    PB-CI-AH-EXPIRE-DT
  8415                                    PB-CI-LOAN-1ST-PMT-DT.
  8416
  8417     IF ACCOUNT-MAST-FOUND
  8418        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8419        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8420
  8421
  8422 0300-CONTINUE-EDIT.
  8423
  8424     IF PB-ISSUE
  8425        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8426            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8427
  8428     IF PB-ISSUE
  8429        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8430            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8431
  8432     IF PB-ISSUE
  8433       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8434          (AM-NO-AH-ONLY)
  8435           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8436               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8437                   MOVE ER-2679 TO WS-ERROR
  8438                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8439
  8440     IF PB-ISSUE
  8441        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8442        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8443        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8444     ELSE
  8445        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8446        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8447        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8448
  8449     MOVE 'N'                    TO PLAN-MASTER-SW
  8450                                    PLAN-MASTER-LIFE-SW
  8451                                    FORM-MASTER-SW
  8452                                    WS-APP-CERT-SW.
  8453
  8454     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8455                                    WS-PL-TOL-LF-REFUND
  8456                                    WS-PL-REF-OVS-AMT
  8457                                    WS-PL-TOL-LF-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 155
* EL050.cbl
  8458                                    WS-PL-TOL-LF-REFUND-PCT
  8459                                    WS-PL-REF-OVS-PCT
  8460                                    WS-PL-TOL-LF-CLAIM.
  8461
  8462     IF PB-COMPANY-ID = 'NCL'
  8463       IF PB-ISSUE
  8464         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8465             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8466             IF FORM-MASTER-FOUND
  8467                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8468
  8469     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8470        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8471
  8472********************** MON CODE **********************
  8473     IF PB-COMPANY-ID = 'MON'
  8474     IF PB-ISSUE
  8475     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8476        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8477             PB-I-LOAN-APR = ZERO)
  8478               MOVE 14.0         TO PB-I-LOAN-APR.
  8479******************************************************
  8480
  8481     IF PB-COMPANY-ID = 'NCL'
  8482       IF PB-ISSUE
  8483           IF FORM-MASTER-FOUND
  8484             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8485                AM-DISMBR-COVERAGE
  8486                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8487                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8488                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8489                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8490                                           PB-I-LIFE-BENEFIT-CD.
  8491
  8492     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8493
  8494     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8495         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8496         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8497         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8498         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8499         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8500           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8501             GO TO 0301-LIFE-BENEFIT-SEARCH
  8502         ELSE
  8503             NEXT SENTENCE
  8504     ELSE
  8505         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8506
  8507     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8508     MOVE '4'                    TO CNTL-REC-TYPE.
  8509     MOVE +0                     TO CNTL-SEQ-NO.
  8510     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8511
  8512     MOVE '1' TO RC-SW-2.
  8513     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8514
  8515     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 156
* EL050.cbl
  8516        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8517         GO TO 0305-BENEFIT-NOT-FOUND.
  8518
  8519     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8520
  8521 0301-LIFE-BENEFIT-SEARCH.
  8522
  8523     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8524
  8525     IF NO-BENEFIT-FOUND
  8526        GO TO 0305-BENEFIT-NOT-FOUND.
  8527
  8528     IF WS-BEN-CD = '99'
  8529        GO TO 0305-BENEFIT-NOT-FOUND.
  8530
  8531     IF PB-COMPANY-ID = 'NCL'
  8532         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8533             GO TO 0304-LIFE-BENEFIT-FOUND.
  8534
  8535     MOVE +1                     TO SUB5.
  8536     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8537
  8538* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8539* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8540     IF PB-COMPANY-ID = 'DMD'
  8541         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8542
  8543 0302-EDIT-ACCT-LF-BENEFITS.
  8544
  8545     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8546        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8547           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8548                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8549           GO TO 03XX-GET-LIFE-ERPLAN.
  8550
  8551     IF SUB5 LESS THAN +20
  8552        ADD +1                   TO SUB5
  8553        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8554
  8555     MOVE +1                     TO SUB5.
  8556
  8557     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8558        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8559
  8560 0303-EDIT-DMD-EXTRA-BENEFITS.
  8561
  8562     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8563        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8564           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8565                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8566           GO TO 03XX-GET-LIFE-ERPLAN.
  8567
  8568     IF SUB5 LESS THAN +30
  8569        ADD +1                   TO SUB5
  8570        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8571
  8572     MOVE +1                     TO SUB5.
  8573
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 157
* EL050.cbl
  8574 03XX-EDIT-FOR-NINETY-LF.
  8575
  8576***************************************************************
  8577*                                                             *
  8578*    NINETY BENEFIT PLAN TYPES:                               *
  8579*                                                             *
  8580*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8581*      92 = ALL GROUP REDUCING BENEFITS                       *
  8582*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8583*      94 = ALL GROUP LEVEL BENEFITS                          *
  8584*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8585*           BENEFIT CONTROLS.                                 *
  8586*      99 = ALL BENEFITS                                      *
  8587*                                                             *
  8588***************************************************************
  8589
  8590     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8591                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8592
  8593     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8594       AND
  8595        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8596        GO TO 03XX-GET-LIFE-ERPLAN.
  8597
  8598     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8599       AND
  8600        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8601        IF CF-REDUCING (SUB3)
  8602           IF (PB-I-INDV-GRP-OVRD = 'I')
  8603              OR
  8604           ((AM-IG = '1') AND
  8605           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8606              OR
  8607           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8608           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8609           (AM-IG NOT = '2'))
  8610              GO TO 03XX-GET-LIFE-ERPLAN.
  8611
  8612     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8613       AND
  8614        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8615        IF CF-REDUCING (SUB3)
  8616           IF (PB-I-INDV-GRP-OVRD = 'G')
  8617              OR
  8618           ((AM-IG = '2') AND
  8619           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8620              OR
  8621           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8622           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8623           (AM-IG NOT = '1'))
  8624              GO TO 03XX-GET-LIFE-ERPLAN.
  8625
  8626     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8627       AND
  8628        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8629        IF CF-LEVEL    (SUB3)
  8630           IF (PB-I-INDV-GRP-OVRD = 'I')
  8631              OR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 158
* EL050.cbl
  8632           ((AM-IG = '1') AND
  8633           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8634              OR
  8635           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8636           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8637            (AM-IG NOT = '2'))
  8638              GO TO 03XX-GET-LIFE-ERPLAN.
  8639
  8640     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8641       AND
  8642        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8643        IF CF-LEVEL    (SUB3)
  8644           IF (PB-I-INDV-GRP-OVRD = 'G')
  8645              OR
  8646           ((AM-IG = '2') AND
  8647           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8648              OR
  8649           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8650           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8651           (AM-IG NOT = '1'))
  8652              GO TO 03XX-GET-LIFE-ERPLAN.
  8653
  8654     IF SUB5 LESS THAN +20
  8655        ADD +1                   TO SUB5
  8656        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8657
  8658     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8659
  8660     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8661        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8662
  8663     MOVE +1                     TO SUB5.
  8664
  8665 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8666
  8667     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8668                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8669
  8670     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8671       AND
  8672        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8673        GO TO 03XX-GET-LIFE-ERPLAN.
  8674
  8675     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8676       AND
  8677        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8678        IF CF-REDUCING (SUB3)
  8679           IF (PB-I-INDV-GRP-OVRD = 'I')
  8680              OR
  8681           ((AM-IG = '1') AND
  8682           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8683              OR
  8684           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8685           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8686           (AM-IG NOT = '2'))
  8687              GO TO 03XX-GET-LIFE-ERPLAN.
  8688
  8689     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 159
* EL050.cbl
  8690       AND
  8691        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8692        IF CF-REDUCING (SUB3)
  8693           IF (PB-I-INDV-GRP-OVRD = 'G')
  8694              OR
  8695           ((AM-IG = '2') AND
  8696           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8697              OR
  8698           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8699           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8700           (AM-IG NOT = '1'))
  8701              GO TO 03XX-GET-LIFE-ERPLAN.
  8702
  8703     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8704       AND
  8705        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8706        IF CF-LEVEL    (SUB3)
  8707           IF (PB-I-INDV-GRP-OVRD = 'I')
  8708              OR
  8709           ((AM-IG = '1') AND
  8710           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8711              OR
  8712           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8713           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8714            (AM-IG NOT = '2'))
  8715              GO TO 03XX-GET-LIFE-ERPLAN.
  8716
  8717     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8718       AND
  8719        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8720        IF CF-LEVEL    (SUB3)
  8721           IF (PB-I-INDV-GRP-OVRD = 'G')
  8722              OR
  8723           ((AM-IG = '2') AND
  8724           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8725              OR
  8726           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8727           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8728           (AM-IG NOT = '1'))
  8729              GO TO 03XX-GET-LIFE-ERPLAN.
  8730
  8731     IF SUB5 LESS THAN +30
  8732        ADD +1                   TO SUB5
  8733        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8734
  8735     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8736
  8737 03XX-EDIT-FOR-NINETY-LF-CONT.
  8738
  8739     MOVE +99                    TO SUB5.
  8740
  8741     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8742        IF PB-ISSUE
  8743           MOVE ER-1924          TO  WS-ERROR
  8744           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8745
  8746     GO TO 0304-LIFE-BENEFIT-FOUND.
  8747
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 160
* EL050.cbl
  8748 03XX-GET-LIFE-ERPLAN.
  8749
  8750     IF WK-PLAN-ADDR EQUAL +0
  8751        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8752
  8753     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8754     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8755     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8756     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8757     MOVE 'Y'                    TO PLAN-MASTER-SW
  8758                                    PLAN-MASTER-LIFE-SW.
  8759     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8760
  8761 03XX-ERPLAN-LIFE-GETMAIN.
  8762
  8763     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8764     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8765
  8766 03XX-ERPLAN-LIFE-READ.
  8767
  8768     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8769     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8770     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8771     MOVE PB-SV-STATE            TO PLAN-STATE.
  8772     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8773     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8774     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8775     MOVE WS-SAVE-BENEFIT-REVISION
  8776                                 TO PLAN-REVISION-NO.
  8777
  8778     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8779     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8780
  8781     IF PB-COMPANY-ID = 'NCL'
  8782       IF NOT LF-PLAN-MASTER-FOUND
  8783         IF NOT PB-POLICY-IS-DECLINED  AND
  8784            NOT PB-POLICY-IS-VOIDED
  8785             MOVE  ER-1921         TO  WS-ERROR
  8786             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8787             GO TO 0304-LIFE-BENEFIT-FOUND.
  8788
  8789     IF NOT LF-PLAN-MASTER-FOUND
  8790        GO TO 0304-LIFE-BENEFIT-FOUND.
  8791
  8792 XXXX-CHECK-LF-PLAN-KEY.
  8793
  8794     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8795        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8796        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8797        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8798        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8799        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8800        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8801        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8802        MOVE 'N'                 TO PLAN-MASTER-SW
  8803          GO TO 03XX-ERPLAN-LIFE-READ.
  8804
  8805     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 161
* EL050.cbl
  8806
  8807     IF  PB-CANCELLATION
  8808         GO TO  0303-LF-ACCT-BEN-FOUND.
  8809
  8810     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8811        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8812           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8813           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8814              MOVE ER-2644             TO WS-ERROR
  8815              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8816           ELSE
  8817              NEXT SENTENCE
  8818        ELSE
  8819           IF PB-COMPANY-ID NOT = 'NCL'
  8820              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8821                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8822
  8823 0303-LF-ACCT-BEN-FOUND.
  8824
  8825     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8826
  8827     IF PL-DEV-CODE NOT = SPACES
  8828        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8829
  8830     IF PL-DEV-PCT NUMERIC AND
  8831        PL-DEV-PCT NOT = ZEROS
  8832        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8833
  8834     IF PL-TOL-PREM-AMT GREATER THAN +0
  8835        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8836
  8837     IF PL-TOL-REF-AMT GREATER THAN +0
  8838        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8839
  8840     IF PL-TOL-PREM-PCT GREATER THAN +0
  8841        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8842
  8843     IF PL-TOL-REF-PCT GREATER THAN +0
  8844        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8845
  8846     IF PL-TOL-CLM-AMT GREATER THAN +0
  8847        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8848
  8849     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8850                          PL-OVER-SHORT-AMT > +0
  8851        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8852
  8853     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8854                          PL-OVER-SHORT-PCT > +0
  8855        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8856
  8857     IF PL-SALES-TAX NUMERIC AND
  8858                          PL-SALES-TAX > +0
  8859         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8860
  8861     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8862        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8863                                    WS-IG-OVRD-AM.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 162
* EL050.cbl
  8864
  8865 0304-LIFE-BENEFIT-FOUND.
  8866
  8867     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8868
  8869     IF PB-ISSUE
  8870        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8871     ELSE
  8872        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8873
  8874     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8875     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8876     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8877     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8878     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8879                                         WS-LF-REFUND-CALC.
  8880     if (ws-lf-earnings-calc = '5')
  8881        and (pb-i-loan-apr = zeros)
  8882        and (benefit-code-chg)
  8883        move +99.9999 to pb-i-loan-apr
  8884     end-if
  8885
  8886     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8887        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8888
  8889     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8890        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8891     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8892
  8893     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8894     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8895     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8896     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8897     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8898     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8899
  8900     IF PB-COMPANY-ID = 'NCL'  AND
  8901        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8902         NEXT SENTENCE
  8903     ELSE
  8904         IF SUB5 NOT GREATER THAN +20
  8905            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8906               MOVE WS-SAVE-BENEFIT-REM-TERM
  8907                                      TO WS-AM-LF-BENE-REM-TERM
  8908                                         EC-BR-LF-REM-TERM-CALC.
  8909
  8910     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8911     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8912
  8913     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8914
  8915 0305-BENEFIT-NOT-FOUND.
  8916
  8917     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8918     MOVE ER-2604                TO WS-ERROR.
  8919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8920
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 163
* EL050.cbl
  8922
  8923 0310-FIND-AH-BENEFIT-RECORD.
  8924
  8925     MOVE 'N'                    TO PLAN-MASTER-SW
  8926                                    PLAN-MASTER-AH-SW.
  8927
  8928     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8929                                    WS-PL-TOL-AH-REFUND
  8930                                    WS-AH-PL-REF-OVS-AMT
  8931                                    WS-PL-TOL-AH-PREM-PCT
  8932                                    WS-PL-TOL-AH-REFUND-PCT
  8933                                    WS-AH-PL-REF-OVS-PCT
  8934                                    WS-PL-TOL-AH-CLAIM.
  8935     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8936
  8937
  8938     if pb-issue
  8939        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8940           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8941        end-if
  8942        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8943           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8944           GO TO 0399-BENEFIT-NOT-FOUND
  8945        end-if
  8946     end-if
  8947
  8948     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8949        GO TO 0400-FIND-CARRIER.
  8950
  8951     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8952
  8953     IF WK-AH-BEN-ADDR NOT = ZEROS
  8954         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8955         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8956         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8957         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8958           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8959             GO TO 0311-AH-BENEFIT-SEARCH
  8960         ELSE
  8961             NEXT SENTENCE
  8962     ELSE
  8963         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8964
  8965     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8966     MOVE '5'                    TO CNTL-REC-TYPE.
  8967     MOVE +0                     TO CNTL-SEQ-NO.
  8968     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8969
  8970     MOVE '2' TO RC-SW-2.
  8971     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8972
  8973     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8974        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8975          GO TO 0399-BENEFIT-NOT-FOUND.
  8976
  8977     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8978
  8979 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 164
* EL050.cbl
  8980
  8981     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8982
  8983     IF NO-BENEFIT-FOUND
  8984         GO TO 0399-BENEFIT-NOT-FOUND.
  8985
  8986     IF WS-BEN-CD = '99'
  8987        GO TO 0399-BENEFIT-NOT-FOUND.
  8988
  8989     IF PB-COMPANY-ID  =  'NCL'
  8990         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8991             GO TO 0314-A-H-BENEFIT-FOUND.
  8992
  8993     MOVE +1                     TO SUB5.
  8994     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8995
  8996* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8997* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8998     IF PB-COMPANY-ID = 'DMD'
  8999         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9000
  9001 0312-EDIT-ACCT-AH-BENEFITS.
  9002
  9003     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9004        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9005           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9006                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9007           GO TO 03XX-GET-AH-ERPLAN.
  9008
  9009     IF SUB5 LESS THAN +20
  9010        ADD +1                   TO SUB5
  9011        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9012
  9013     MOVE +1                     TO SUB5.
  9014
  9015     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9016        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9017
  9018 0313-EDIT-DMD-EXTRA-BENEFITS.
  9019
  9020     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9021        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9022           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9023                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9024           GO TO 03XX-GET-AH-ERPLAN.
  9025
  9026     IF SUB5 LESS THAN +30
  9027        ADD +1                   TO SUB5
  9028        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9029
  9030     MOVE +1                     TO SUB5.
  9031
  9032 03XX-EDIT-FOR-NINETY-AH.
  9033
  9034***************************************************************
  9035*                                                             *
  9036*    NINETY BENEFIT PLAN TYPES:                               *
  9037*                                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 165
* EL050.cbl
  9038*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9039*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9040*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9041*           BENEFIT CONTROLS.                                 *
  9042*      99 = ALL BENEFITS.                                     *
  9043*                                                             *
  9044***************************************************************
  9045
  9046     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9047                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9048
  9049     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9050       AND
  9051        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9052        GO TO 03XX-GET-AH-ERPLAN.
  9053
  9054     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9055       AND
  9056        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9057           IF (PB-I-INDV-GRP-OVRD = 'I')
  9058              OR
  9059           ((AM-IG = '1') AND
  9060           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9061              OR
  9062           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9063           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9064           (AM-IG NOT = '2'))
  9065              GO TO 03XX-GET-AH-ERPLAN.
  9066
  9067     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9068       AND
  9069        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9070           IF (PB-I-INDV-GRP-OVRD = 'G')
  9071              OR
  9072           ((AM-IG = '2') AND
  9073           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9074              OR
  9075           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9076           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9077           (AM-IG NOT = '1'))
  9078              GO TO 03XX-GET-AH-ERPLAN.
  9079
  9080     IF SUB5 LESS THAN +20
  9081        ADD +1                   TO SUB5
  9082        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9083
  9084     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9085        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9086
  9087     MOVE +1                    TO SUB5.
  9088
  9089 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9090
  9091     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9092                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9093
  9094     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9095       AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 166
* EL050.cbl
  9096        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9097        GO TO 03XX-GET-AH-ERPLAN.
  9098
  9099     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9100       AND
  9101        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9102           IF (PB-I-INDV-GRP-OVRD = 'I')
  9103              OR
  9104           ((AM-IG = '1') AND
  9105           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9106              OR
  9107           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9108           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9109           (AM-IG NOT = '2'))
  9110              GO TO 03XX-GET-AH-ERPLAN.
  9111
  9112     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9113       AND
  9114        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9115           IF (PB-I-INDV-GRP-OVRD = 'G')
  9116              OR
  9117           ((AM-IG = '2') AND
  9118           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9119              OR
  9120           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9121           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9122           (AM-IG NOT = '1'))
  9123              GO TO 03XX-GET-AH-ERPLAN.
  9124
  9125     IF SUB5 LESS THAN +30
  9126        ADD +1                   TO SUB5
  9127        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9128
  9129 03XX-EDIT-FOR-NINETY-AH-CONT.
  9130
  9131     MOVE +99                    TO SUB5.
  9132
  9133     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9134
  9135     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9136        IF PB-ISSUE
  9137           MOVE ER-1925          TO  WS-ERROR
  9138           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9139
  9140     GO TO 0314-A-H-BENEFIT-FOUND.
  9141
  9142 03XX-GET-AH-ERPLAN.
  9143
  9144     IF WK-PLAN-ADDR EQUAL +0
  9145         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9146
  9147     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9148     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9149     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9150     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9151     MOVE 'Y'                    TO PLAN-MASTER-SW
  9152                                    PLAN-MASTER-AH-SW.
  9153*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 167
* EL050.cbl
  9154     GO TO 03XX-ERPLAN-AH-READ.
  9155
  9156 03XX-ERPLAN-AH-GETMAIN.
  9157
  9158     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9159     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9160
  9161 03XX-ERPLAN-AH-READ.
  9162
  9163     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9164     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9165     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9166     MOVE PB-SV-STATE            TO PLAN-STATE.
  9167     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9168     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9169     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9170     MOVE WS-SAVE-BENEFIT-REVISION
  9171                                 TO PLAN-REVISION-NO.
  9172
  9173     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9174     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9175
  9176     IF PB-COMPANY-ID = 'NCL'
  9177       IF NOT AH-PLAN-MASTER-FOUND
  9178         IF NOT PB-POLICY-IS-DECLINED  AND
  9179            NOT PB-POLICY-IS-VOIDED
  9180             MOVE  ER-1922         TO  WS-ERROR
  9181             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9182             GO TO 0314-A-H-BENEFIT-FOUND.
  9183
  9184     IF NOT AH-PLAN-MASTER-FOUND
  9185        GO TO 0314-A-H-BENEFIT-FOUND.
  9186
  9187 XXXX-CHECK-AH-PLAN-KEY.
  9188
  9189     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9190        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9191        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9192        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9193        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9194        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9195        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9196        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9197        MOVE 'N'                 TO PLAN-MASTER-SW
  9198          GO TO 03XX-ERPLAN-AH-READ.
  9199
  9200     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9201
  9202     IF  PB-CANCELLATION
  9203         GO TO  0313-AH-ACCT-BEN-FOUND.
  9204
  9205     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9206       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9207          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9208          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9209             MOVE ER-2644             TO WS-ERROR
  9210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9211          ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 168
* EL050.cbl
  9212             NEXT SENTENCE
  9213       ELSE
  9214          IF PB-COMPANY-ID NOT = 'NCL'
  9215             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9216                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9217
  9218 0313-AH-ACCT-BEN-FOUND.
  9219
  9220     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9221
  9222     IF PL-DEV-CODE NOT = SPACES
  9223        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9224
  9225     IF PL-DEV-PCT NUMERIC AND
  9226        PL-DEV-PCT NOT = ZEROS
  9227        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9228
  9229     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9230        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9231
  9232     IF PL-TOL-REF-AMT NOT EQUAL +0
  9233        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9234
  9235     IF PL-TOL-PREM-PCT GREATER THAN +0
  9236        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9237
  9238     IF PL-TOL-REF-PCT GREATER THAN +0
  9239        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9240
  9241     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9242        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9243
  9244     IF PL-OVER-SHORT-AMT NUMERIC AND
  9245                          PL-OVER-SHORT-AMT > +0
  9246        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9247
  9248     IF PL-OVER-SHORT-PCT NUMERIC AND
  9249                          PL-OVER-SHORT-PCT > +0
  9250        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9251
  9252     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9253        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9254        IF WS-IG-OVRD-AM EQUAL SPACES
  9255            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9256
  9257 0314-A-H-BENEFIT-FOUND.
  9258
  9259     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9260
  9261     IF PB-ISSUE
  9262        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9263       ELSE
  9264        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9265
  9266     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9267     if cf-maximum-benefits (sub3) numeric
  9268        move cf-maximum-benefits (sub3)
  9269                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 169
* EL050.cbl
  9270     else
  9271        move zeros               to ws-ah-max-bens
  9272     end-if
  9273     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9274     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9275     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9276                                         WS-AH-REFUND-CALC.
  9277
  9278     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9279        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9280
  9281     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9282        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9283     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9284
  9285     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9286     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9287     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9288     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9289     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9290     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9291
  9292     IF PB-COMPANY-ID = 'NCL'  AND
  9293        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9294         NEXT SENTENCE
  9295     ELSE
  9296         IF SUB5 NOT GREATER THAN +20
  9297            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9298                MOVE WS-SAVE-BENEFIT-REM-TERM
  9299                                      TO WS-AM-AH-BENE-REM-TERM
  9300                                         EC-BR-AH-REM-TERM-CALC.
  9301
  9302     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9303     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9304
  9305     GO TO 0400-FIND-CARRIER.
  9306
  9307 0399-BENEFIT-NOT-FOUND.
  9308
  9309     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9310     MOVE ER-2605                TO WS-ERROR.
  9311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9312
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 170
* EL050.cbl
  9314
  9315 0400-FIND-CARRIER.
  9316
  9317     MOVE PB-SV-CARRIER          TO WS-CARR.
  9318
  9319     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9320     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9321     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9322     MOVE '6'                    TO CNTL-REC-TYPE.
  9323
  9324*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9325     MOVE SPACE                  TO WS-DMD-RATING-SW
  9326                                    EC-BR-DMD-RATING-SW.
  9327
  9328     MOVE '2'                    TO RC-SW-1.
  9329     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9330
  9331     IF NOT CF-CARRIER-MASTER
  9332        GO TO 0400-CARRIER-NOT-FOUND.
  9333
  9334 0400-BUILD-CARR-TOL.
  9335
  9336     IF CF-CR-TOL-PREM NUMERIC AND
  9337        CF-CR-TOL-PREM GREATER THAN +0
  9338        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9339                                    WS-TOL-AH-PREM.
  9340
  9341     IF CF-CR-TOL-REFUND NUMERIC AND
  9342        CF-CR-TOL-REFUND GREATER THAN +0
  9343        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9344                                    WS-TOL-AH-REFUND.
  9345
  9346     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9347        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9348        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9349                                    WS-AH-REFUND-OVS-AMT.
  9350
  9351     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9352        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9353        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9354                                    WS-AH-REFUND-OVS-PCT.
  9355
  9356     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9357        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9358        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9359                                    WS-TOL-AH-PREM-PCT.
  9360
  9361     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9362        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9363        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9364                                     WS-TOL-AH-REFUND-PCT.
  9365
  9366     IF CF-COMPANY-ID EQUAL 'DMD'
  9367         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9368                                    EC-BR-DMD-RATING-SW.
  9369
  9370     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9371     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 171
* EL050.cbl
  9372        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9373     END-IF
  9374     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9375        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9376     END-IF
  9377     IF WS-TOL-CLP-PCT = ZEROS
  9378        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9379     END-IF
  9380
  9381     IF WS-SPP-LEASE-COMM = ZEROS
  9382        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9383     END-IF
  9384     GO TO 0400-FIND-ERPDEF.
  9385
  9386 0400-CARRIER-NOT-FOUND.
  9387
  9388     MOVE ER-2602                TO WS-ERROR.
  9389     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9390
  9391 0400-FIND-ERPDEF.
  9392     IF PB-COMPANY-ID = 'DCC'
  9393        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9394        CONTINUE
  9395     ELSE
  9396        GO TO 0400-FIND-ERCOMP
  9397     END-IF
  9398     MOVE ' '                    TO PDEF-MASTER-SW
  9399     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9400     MOVE PB-STATE               TO ERPDEF-STATE
  9401     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9402     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9403     IF PB-ISSUE
  9404        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9405     ELSE
  9406        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9407     END-IF
  9408     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9409     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9410     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9411     IF PDEF-MASTER-FOUND
  9412        MOVE 'N'                 TO PDEF-MASTER-SW
  9413        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9414        IF PDEF-MASTER-FOUND
  9415           IF (ERPDEF-KEY-SAVE (1:16) =
  9416                        PD-CONTROL-PRIMARY (1:16))
  9417              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9418              CONTINUE
  9419           ELSE
  9420              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9421              IF (ERPDEF-KEY-SAVE (1:16) =
  9422                        PD-CONTROL-PRIMARY (1:16))
  9423                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9424                 CONTINUE
  9425              ELSE
  9426                 MOVE 'N'        TO PDEF-MASTER-SW
  9427              END-IF
  9428           END-IF
  9429        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 172
* EL050.cbl
  9430        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9431     END-IF
  9432     IF PDEF-MASTER-FOUND
  9433        IF PD-TRUNCATED = 'Y'
  9434           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9435        END-IF
  9436     END-IF
  9437     .
  9438 0400-FIND-ERCOMP.
  9439     IF PB-COMPANY-ID = 'DCC'
  9440        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9441           (WS-SUB1 > +10)
  9442           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9443                 OR 'A' OR 'N'
  9444              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9445              MOVE PB-CARRIER    TO COMP-CARRIER
  9446              MOVE PB-GROUPING   TO COMP-GROUPING
  9447              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9448              MOVE AM-AGT (WS-SUB1)
  9449                                 TO COMP-FIN-RESP
  9450              MOVE 'G'           TO COMP-TYPE
  9451              PERFORM 8582-READ-COMPENSATION-MASTER
  9452                                 THRU 8582-EXIT
  9453              IF COMP-MASTER-FOUND
  9454                 IF CO-GA-INACTIVE
  9455                    MOVE ER-2763 TO WS-ERROR
  9456                    PERFORM 9900-ERROR-FORMAT
  9457                                 THRU 9900-EXIT
  9458                    MOVE +11     TO WS-SUB1
  9459                 END-IF
  9460                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9461                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9462                    MOVE ER-2788 TO WS-ERROR
  9463                    PERFORM 9900-ERROR-FORMAT
  9464                                 THRU 9900-EXIT
  9465                    MOVE +11     TO WS-SUB1
  9466                 END-IF
  9467              END-IF
  9468           END-IF
  9469        END-PERFORM
  9470     END-IF
  9471     IF PB-COMPANY-ID = 'DCC'
  9472        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9473           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9474                                    WS-CLP-STATE
  9475        ELSE
  9476           MOVE SPACES           TO PB-I-CLP-STATE
  9477                                    WS-CLP-STATE
  9478        END-IF
  9479     END-IF
  9480
  9481     IF (PB-COMPANY-ID = 'DCC')
  9482        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9483        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9484        CONTINUE
  9485     ELSE
  9486        GO TO 0400-FIND-STATE-RECORD
  9487     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 173
* EL050.cbl
  9488     MOVE SPACES                 TO WS-CLP-STATE
  9489     MOVE +0                     TO WS-BANK-FEE
  9490                                    WS-BANK-LFEE
  9491                                    WS-BANK-NOCHRGB
  9492
  9493     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9494     IF (PB-ISSUE)
  9495        AND (PB-I-BANK-NUMBER NOT =
  9496            SPACES AND ZEROS AND LOW-VALUES)
  9497        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9498     ELSE
  9499        IF (PB-CANCELLATION)
  9500           AND (PB-CI-BANK-NUMBER NOT =
  9501                SPACES AND ZEROS AND LOW-VALUES)
  9502           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9503        END-IF
  9504     END-IF
  9505     IF COMP-FIN-RESP NOT = LOW-VALUES
  9506        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9507        MOVE PB-CARRIER          TO COMP-CARRIER
  9508        MOVE PB-GROUPING         TO COMP-GROUPING
  9509        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9510        MOVE 'B'                 TO COMP-TYPE
  9511        PERFORM 8582-READ-COMPENSATION-MASTER
  9512                                 THRU 8582-EXIT
  9513        IF COMP-MASTER-FOUND
  9514           IF CO-MAX-BANK-FEE NOT NUMERIC
  9515              MOVE +0            TO CO-MAX-BANK-FEE
  9516           END-IF
  9517           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9518              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9519           END-IF
  9520           IF CO-GA-INACTIVE
  9521              MOVE ER-2763       TO WS-ERROR
  9522              PERFORM 9900-ERROR-FORMAT
  9523                                 THRU 9900-EXIT
  9524           END-IF
  9525           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9526              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9527              MOVE ER-2788 TO WS-ERROR
  9528              PERFORM 9900-ERROR-FORMAT
  9529                                 THRU 9900-EXIT
  9530              MOVE +11     TO WS-SUB1
  9531           END-IF
  9532           IF WS-AH-BEN-CATEGORY = 'G'
  9533              MOVE CO-MAX-BANK-FEE
  9534                                 TO WS-BANK-FEE
  9535                                    PB-I-BANK-FEE
  9536           ELSE
  9537              MOVE CO-MAX-BANK-FEE-LEASE
  9538                                 TO WS-BANK-LFEE
  9539                                    PB-I-BANK-FEE
  9540           END-IF
  9541           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9542              AND (WS-AH-REFUND-CALC = 'G'))
  9543                        OR
  9544              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9545              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 174
* EL050.cbl
  9546              CONTINUE
  9547           ELSE
  9548              MOVE ER-2789 TO WS-ERROR
  9549              PERFORM 9900-ERROR-FORMAT
  9550                                 THRU 9900-EXIT
  9551           END-IF
  9552           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9553                                    PB-I-CLP-STATE
  9554           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9555           MOVE CO-CARRIER       TO BXRF-CARRIER
  9556           MOVE CO-GROUPING      TO BXRF-GROUPING
  9557           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9558           MOVE BXRF-MAX-REC-LENGTH
  9559                                 TO BXRF-REC-LENGTH
  9560           PERFORM 8584-READ-BANK-CROSS-REF
  9561                                 THRU 8584-EXIT
  9562           IF BXRF-MASTER-FOUND
  9563              MOVE ' '           TO BANK-ACCT-SW
  9564              MOVE BK-BANK-POINTER-CNT
  9565                                 TO BK-BANK-POINTER-CNT
  9566              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9567                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9568                 OR (BANK-ACCT-FOUND)
  9569                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9570                    AND (BK-AM-EXP-DT (WS-SUB1)
  9571                                 > PB-CERT-EFF-DT)
  9572                    AND (BK-AM-EFF-DT (WS-SUB1)
  9573                                 NOT > PB-CERT-EFF-DT)
  9574                    SET BANK-ACCT-FOUND TO TRUE
  9575                 END-IF
  9576              END-PERFORM
  9577              IF NOT BANK-ACCT-FOUND
  9578                 MOVE ZEROS      TO WS-BANK-FEE
  9579                                    WS-BANK-LFEE
  9580                 MOVE ER-2869    TO WS-ERROR
  9581                 PERFORM 9900-ERROR-FORMAT
  9582                                 THRU 9900-EXIT
  9583              ELSE
  9584                 PERFORM 5000-PROCESS-REPS
  9585                                 THRU 5000-EXIT
  9586                 IF AGENT-MASTER-FOUND
  9587                    MOVE +0      TO WS-BANK-FEE
  9588                                    WS-BANK-LFEE
  9589*                   MOVE AG-SPP-FEES (1)
  9590*                                TO PB-I-BANK-FEE
  9591*                                   WS-BANK-FEE
  9592                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9593                       (WS-SUB1 > +10)
  9594                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9595                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9596                       END-IF
  9597                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9598                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9599                       END-IF
  9600                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9601                          AG-SPP-FEES (WS-SUB1)
  9602                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9603                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 175
* EL050.cbl
  9604                    END-PERFORM
  9605                    IF WS-AH-BEN-CATEGORY = 'G'
  9606                       MOVE WS-BANK-FEE
  9607                                 TO PB-I-BANK-FEE
  9608                    ELSE
  9609                       MOVE WS-BANK-LFEE
  9610                                 TO PB-I-BANK-FEE
  9611                    END-IF
  9612                 END-IF
  9613              END-IF
  9614           END-IF
  9615        ELSE
  9616           MOVE ER-2879          TO WS-ERROR
  9617           PERFORM 9900-ERROR-FORMAT
  9618                                 THRU 9900-EXIT
  9619        END-IF
  9620     ELSE
  9621        MOVE ER-2879             TO WS-ERROR
  9622        PERFORM 9900-ERROR-FORMAT
  9623                                 THRU 9900-EXIT
  9624     END-IF
  9625     IF WS-AH-BEN-CATEGORY = 'G'
  9626        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9627        + WS-BANK-FEE
  9628     ELSE
  9629        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9630        + WS-BANK-LFEE
  9631     END-IF
  9632     .
  9633 0400-FIND-STATE-RECORD.
  9634
  9635     IF WK-STATE-ADDR NOT = ZEROS
  9636         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9637         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9638         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9639         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9640         IF PB-SV-STATE = CF-STATE-CODE
  9641             GO TO 0405-CONTINUE-EDIT
  9642         ELSE
  9643             NEXT SENTENCE
  9644     ELSE
  9645         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9646
  9647     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9648     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9649     MOVE '3'                    TO CNTL-REC-TYPE.
  9650     MOVE +0                     TO CNTL-SEQ-NO.
  9651
  9652     MOVE '3'                    TO RC-SW-2.
  9653     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9654
  9655     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9656        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9657        PB-SV-STATE   NOT = CF-STATE-CODE)
  9658        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9659                                    WS-TOL-AH-CLAIM
  9660                                    WS-MINIMUM-REFUND
  9661                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 176
* EL050.cbl
  9662                                    WS-TOL-AH-PREM
  9663                                    WS-TOL-LF-REFUND
  9664                                    WS-TOL-AH-REFUND
  9665                                    EC-ST-TOL-PREM-PCT
  9666                                    WS-TOL-LF-PREM-PCT
  9667                                    WS-TOL-AH-PREM-PCT
  9668                                    EC-ST-TOL-REFUND-PCT
  9669                                    WS-TOL-LF-REFUND-PCT
  9670                                    WS-TOL-AH-REFUND-PCT
  9671                                    EC-ST-TOL-PREM
  9672                                    EC-ST-TOL-REFUND
  9673                                    EC-ST-FST-PMT-DAYS-MAX
  9674                                    WS-FREE-LOOK-PERIOD
  9675                                    WS-ST-LF-PREM-TAX
  9676                                    WS-ST-AH-PREM-TAX-I
  9677                                    WS-ST-AH-PREM-TAX-G
  9678                                    WS-BANK-FEE
  9679                                    WS-BANK-LFEE
  9680                                    WS-TOL-CLP-PCT
  9681                                    WS-SPP-LEASE-COMM
  9682        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9683                                    EC-ST-FST-PMT-DAYS-CHG
  9684                                    WS-LF-REM-TERM-CALC
  9685                                    WS-LF-REFUND-CALC
  9686                                    EC-ST-LF-REM-TERM-CALC
  9687                                    EC-ST-LF-REFUND-CALC
  9688                                    WS-AH-REM-TERM-CALC
  9689                                    WS-AH-REFUND-CALC
  9690                                    WS-LF-BEN-CATEGORY
  9691                                    WS-AH-BEN-CATEGORY
  9692                                    WS-CLP-STATE
  9693                                    WS-ST-REFUND-CLAIM-FLAG
  9694                                    WS-ST-CAUSAL-STATE
  9695                                    EC-ST-AH-REM-TERM-CALC
  9696                                    EC-ST-AH-REFUND-CALC
  9697          GO TO 0499-STATE-NOT-FOUND.
  9698
  9699     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9700
  9701 0405-CONTINUE-EDIT.
  9702
  9703     if pb-company-id = 'AHL'
  9704        continue
  9705     else
  9706        IF PB-CERT-PRIME NOT NUMERIC
  9707           MOVE ER-2722          TO WS-ERROR
  9708           PERFORM 9900-ERROR-FORMAT
  9709                                 THRU 9900-EXIT
  9710        end-if
  9711     END-IF
  9712*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9713*       MOVE +0                  TO SUB3
  9714*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9715*       IF SUB3 > +0
  9716*          MOVE ER-2722          TO WS-ERROR
  9717*          PERFORM 9900-ERROR-FORMAT
  9718*                                THRU 9900-EXIT
  9719*       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 177
* EL050.cbl
  9720*    END-IF
  9721*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9722*       IF PB-CERT-PRIME NOT NUMERIC
  9723*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9724*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9725*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9726*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9727*
  9728*          MOVE ER-2722          TO WS-ERROR
  9729*          PERFORM 9900-ERROR-FORMAT
  9730*                                THRU 9900-EXIT
  9731*       END-IF
  9732*    END-IF
  9733
  9734     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9735
  9736     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9737        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9738                                    WS-TOL-AH-CLAIM.
  9739
  9740     IF CF-ST-REFUND-MIN NOT NUMERIC
  9741        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9742
  9743     IF CF-ST-REFUND-MIN NOT = ZEROS
  9744        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9745
  9746     IF CF-ST-TOL-PREM  NOT = ZEROS
  9747        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9748                                    WS-TOL-AH-PREM
  9749        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9750
  9751     IF CF-ST-TOL-REFUND NOT = ZEROS
  9752        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9753                                    WS-TOL-AH-REFUND
  9754        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9755
  9756     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9757        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9758        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9759                                    WS-AH-REFUND-OVS-AMT
  9760                                    EC-ST-OVR-SHT-AMT.
  9761
  9762     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9763        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9764        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9765                                    WS-TOL-LF-PREM-PCT
  9766                                    WS-TOL-AH-PREM-PCT.
  9767
  9768     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9769        CF-ST-TOL-REF-PCT GREATER THAN +0
  9770        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9771                                    WS-TOL-LF-REFUND-PCT
  9772                                    WS-TOL-AH-REFUND-PCT.
  9773
  9774     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9775        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9776        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9777                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 178
* EL050.cbl
  9778                                    EC-ST-OVR-SHT-PCT.
  9779
  9780     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9781     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9782
  9783     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9784          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9785
  9786     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9787     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9788     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9789
  9790     IF CF-ST-LF-PREM-TAX NUMERIC
  9791        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9792     END-IF
  9793     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9794        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9795     END-IF
  9796     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9797        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9798     END-IF
  9799
  9800     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9801         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9802     END-IF.
  9803
  9804     IF CF-ST-CAUSAL-STATE > SPACES
  9805         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9806     END-IF.
  9807
  9808     IF WS-LF-BENEFIT-CD = ZEROS
  9809        GO TO 0410-CHECK-AH.
  9810
  9811     IF CF-ST-RT-CALC NOT = SPACES
  9812        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9813                                    EC-ST-LF-REM-TERM-CALC
  9814     END-IF
  9815
  9816     IF WS-LF-COVERAGE-TYPE = 'R'
  9817        IF WS-LF-EARNINGS-CALC = '5'
  9818           IF CF-ST-RF-LN-CALC > '0'
  9819              MOVE CF-ST-RF-LN-CALC
  9820                                 TO WS-LF-REFUND-CALC
  9821                                    EC-ST-LF-REFUND-CALC
  9822           END-IF
  9823        ELSE
  9824           IF CF-ST-RF-LR-CALC > '0'
  9825              MOVE CF-ST-RF-LR-CALC
  9826                                 TO WS-LF-REFUND-CALC
  9827                                    EC-ST-LF-REFUND-CALC
  9828           END-IF
  9829        END-IF
  9830     ELSE
  9831        IF CF-ST-RF-LL-CALC > '0'
  9832           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9833                                    EC-ST-LF-REFUND-CALC
  9834        END-IF
  9835     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 179
* EL050.cbl
  9836
  9837     IF CF-ST-RT-CALC NOT = SPACES
  9838        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9839                                    EC-ST-LF-REM-TERM-CALC
  9840     END-IF
  9841
  9842     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9843     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9844
  9845     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9846
  9847     IF NO-BENEFIT-FOUND
  9848        GO TO 0410-CHECK-AH.
  9849
  9850     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9851        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9852                                 TO EC-ST-LF-REM-TERM-CALC
  9853                                    WS-LF-REM-TERM-CALC
  9854     END-IF
  9855
  9856     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9857        MOVE CF-ST-REFUND-CALC (SUB3)
  9858                                 TO WS-LF-REFUND-CALC
  9859                                    EC-ST-LF-REFUND-CALC
  9860     END-IF
  9861*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9862
  9863     .
  9864 0410-CHECK-AH.
  9865
  9866     IF WS-AH-BENEFIT-CD = ZEROS
  9867        GO TO 0500-SET-ACCOUNT.
  9868
  9869     IF CF-ST-RT-CALC NOT = SPACES
  9870        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9871                                    EC-ST-AH-REM-TERM-CALC
  9872     END-IF
  9873
  9874     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9875        IF CF-ST-RF-CP-CALC > '0'
  9876           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9877                                    EC-ST-AH-REFUND-CALC
  9878        END-IF
  9879     ELSE
  9880        IF CF-ST-RF-AH-CALC > '0'
  9881           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9882                                    EC-ST-AH-REFUND-CALC
  9883        END-IF
  9884     END-IF
  9885     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9886     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9887
  9888     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9889
  9890     IF NO-BENEFIT-FOUND
  9891        GO TO 0500-SET-ACCOUNT.
  9892
  9893     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 180
* EL050.cbl
  9894        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9895                                 TO WS-AH-REM-TERM-CALC
  9896                                    EC-ST-AH-REM-TERM-CALC
  9897     END-IF
  9898
  9899     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9900        MOVE CF-ST-REFUND-CALC (SUB3)
  9901                                 TO WS-AH-REFUND-CALC
  9902                                    EC-ST-AH-REFUND-CALC
  9903     END-IF
  9904
  9905*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9906
  9907     GO TO 0500-SET-ACCOUNT.
  9908
  9909 0499-STATE-NOT-FOUND.
  9910
  9911     MOVE ER-2603                TO WS-ERROR.
  9912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9913
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 181
* EL050.cbl
  9915
  9916 0500-SET-ACCOUNT.
  9917*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9918     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9919        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9920        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9921        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9922        MOVE '3'                 TO CNTL-REC-TYPE
  9923        MOVE +0                  TO CNTL-SEQ-NO
  9924
  9925        MOVE '3'                 TO RC-SW-2
  9926        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9927
  9928        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9929           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9930           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9931           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9932                                    WS-ST-AH-PREM-TAX-I
  9933                                    WS-ST-AH-PREM-TAX-G
  9934        ELSE
  9935           IF CF-ST-LF-PREM-TAX NUMERIC
  9936              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9937           END-IF
  9938           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9939              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9940           END-IF
  9941           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9942              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9943           END-IF
  9944        END-IF
  9945        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9946     END-IF
  9947*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9948*  FOR DCC ONLY
  9949     IF PB-COMPANY-ID = 'DCC'
  9950
  9951     MOVE ' '                    TO STAT-MASTER-SW
  9952     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9953     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9954     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9955     MOVE PB-STATE               TO ELSTAT-STATE
  9956     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9957        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9958     END-IF
  9959
  9960     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9961     SET BIN-TO-GREG             TO TRUE
  9962     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9963     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9964     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9965
  9966     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9967     IF STAT-MASTER-FOUND
  9968        MOVE 'N'                 TO STAT-MASTER-SW
  9969        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9970        IF STAT-MASTER-FOUND
  9971           IF (ELSTAT-KEY-SAVE (1:12) =
  9972                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 182
* EL050.cbl
  9973              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9974                 MOVE 'F'        TO STAT-MASTER-SW
  9975              ELSE
  9976                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9977                 IF (STAT-MASTER-FOUND)
  9978                    AND (ELSTAT-KEY-SAVE (1:12) =
  9979                        SF-CONTROL-PRIMARY (1:12))
  9980                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9981                    MOVE 'F'     TO STAT-MASTER-SW
  9982                 END-IF
  9983              END-IF
  9984           END-IF
  9985        END-IF
  9986     END-IF
  9987
  9988     IF STAT-MASTER-SW = 'F'
  9989        IF SF-ST-LF-PREM-TAX NUMERIC
  9990           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9991        END-IF
  9992        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9993           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9994        END-IF
  9995        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9996           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9997        END-IF
  9998     END-IF
  9999
 10000     END-IF
 10001     IF (PB-COMPANY-ID = 'DCC')
 10002        AND (PB-ISSUE)
 10003        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10004        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10005        AND (AM-GPCD = 06)
 10006        MOVE 'Y'                 TO WS-GOOD-HIN
 10007        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10008           MOVE PB-I-VIN         TO WS-WORK-VIN
 10009           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10010              (V1 > 16)
 10011              IF WS-WORK-VIN (V1:1) NUMERIC
 10012                 MOVE WS-WORK-VIN-N (V1)
 10013                                 TO WS-ROW-B-VAL (V1)
 10014              ELSE
 10015                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10016                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10017                    OR (V2 > 26)
 10018                 END-PERFORM
 10019                 IF V2 < 27
 10020                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10021                 ELSE
 10022                    MOVE 'N'     TO WS-GOOD-HIN
 10023                 END-IF
 10024              END-IF
 10025              COMPUTE WS-ROW-D-VAL (V1) =
 10026                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10027              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10028                 WS-ROW-D-VAL (V1)
 10029           END-PERFORM
 10030           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 183
* EL050.cbl
 10031           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10032             REMAINDER WS-VIN-REMAINDER
 10033           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10034              CONTINUE
 10035           ELSE
 10036              MOVE 'N'           TO WS-GOOD-HIN
 10037           END-IF
 10038        ELSE
 10039           MOVE 'N'              TO WS-GOOD-HIN
 10040        END-IF
 10041        IF WS-GOOD-HIN NOT = 'Y'
 10042           MOVE ER-3826           TO WS-ERROR
 10043           PERFORM 9900-ERROR-FORMAT
 10044                                 THRU 9900-EXIT
 10045        END-IF
 10046     END-IF
 10047     IF (PB-COMPANY-ID = 'DCC')
 10048        AND (PB-ISSUE)
 10049        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10050        AND (AM-GPCD NOT = 06)
 10051        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10052          MOVE PB-I-VIN          TO WS-WORK-VIN
 10053          MOVE +8                TO V2
 10054          MOVE ZEROS             TO WS-VIN-TOTAL
 10055          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10056           (V1 > 17)
 10057             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10058                MOVE ER-3825     TO WS-ERROR
 10059                PERFORM 9900-ERROR-FORMAT
 10060                                 THRU 9900-EXIT
 10061             ELSE
 10062                IF V1 = 8
 10063                   MOVE 10       TO V2
 10064                END-IF
 10065                IF V1 = 9
 10066                   MOVE 0        TO V2
 10067                END-IF
 10068                IF V1 = 10
 10069                   MOVE 9        TO V2
 10070                END-IF
 10071                IF WS-WORK-VIN (V1:1) NUMERIC
 10072                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10073                    + (WS-WORK-VIN-N (V1) * V2)
 10074                ELSE
 10075                   MOVE WS-WORK-VIN (V1:1)
 10076                                 TO WS-HEX-BYTE
 10077                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10078                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10079                    + (WS-NUM (V3) * V2)
 10080                END-IF
 10081                COMPUTE V2 = V2 - 1
 10082             END-IF
 10083          END-PERFORM
 10084          MOVE ZEROS TO WS-VIN-REMAINDER
 10085          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10086             REMAINDER WS-VIN-REMAINDER
 10087          IF ((WS-WORK-VIN (9:1) = 'X')
 10088             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 184
* EL050.cbl
 10089                     OR
 10090             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10091             CONTINUE
 10092          ELSE
 10093             MOVE ER-3826        TO WS-ERROR
 10094             PERFORM 9900-ERROR-FORMAT
 10095                                 THRU 9900-EXIT
 10096          END-IF
 10097        ELSE
 10098          MOVE ER-3826           TO WS-ERROR
 10099          PERFORM 9900-ERROR-FORMAT
 10100                                 THRU 9900-EXIT
 10101        END-IF
 10102     END-IF
 10103******************************************************************
 10104******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10105******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10106******* METHODS.
 10107******************************************************************
 10108     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10109        IF PB-CANCELLATION
 10110           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10111              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10112                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10113                IF FORM-MASTER-FOUND
 10114                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10115******************************************************************
 10116
 10117     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10118     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10119
 10120     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10121     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10122     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10123     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10124
 10125
 10126     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10127     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10128     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10129
 10130     IF AM-LF-OB-RATE NOT NUMERIC
 10131         MOVE ZERO               TO AM-LF-OB-RATE.
 10132
 10133     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10134         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10135
 10136     IF AM-AH-OB-RATE NOT NUMERIC
 10137         MOVE ZERO               TO AM-AH-OB-RATE.
 10138
 10139     IF WS-LF-JOINT-INDICATOR = 'J'
 10140         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10141     ELSE
 10142         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10143
 10144     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10145
 10146     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 185
* EL050.cbl
 10147         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10148
 10149     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10150         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10151                                       WS-IG-OVRD
 10152     ELSE
 10153         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10154             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10155                                       WS-IG-OVRD
 10156         ELSE
 10157             MOVE AM-IG             TO WS-IG-OVRD-AH
 10158                                       WS-IG-OVRD.
 10159
 10160     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10161         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10162                                       WS-IG-OVRD
 10163     ELSE
 10164         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10165             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10166                                       WS-IG-OVRD
 10167         ELSE
 10168             MOVE AM-IG             TO WS-IG-OVRD-LF
 10169                                       WS-IG-OVRD.
 10170
 10171     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10172     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10173     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10174     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10175     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10176
 10177     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10178     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10179     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10180     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10181
 10182     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10183     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10184     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10185     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10186     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10187     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10188     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10189
 10190     IF WS-ACCT-AH-DEV-PCT > +0
 10191        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10192     ELSE
 10193        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10194
 10195     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10196        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10197     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10198        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10199
 10200        IF AM-EARN-METHOD-L = 'S'
 10201            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10202                                        WS-LF-REFUND-CALC.
 10203
 10204        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 186
* EL050.cbl
 10205            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10206                                        WS-LF-REFUND-CALC.
 10207
 10208     IF WS-LF-COVERAGE-TYPE = 'R'
 10209         IF AM-EARN-METHOD-R = 'R'
 10210            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10211                                    WS-LF-REFUND-CALC.
 10212     IF WS-LF-COVERAGE-TYPE = 'R'
 10213         IF AM-EARN-METHOD-R = 'P'
 10214            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10215                                    WS-LF-REFUND-CALC.
 10216     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10217         IF AM-EARN-METHOD-L = 'R'
 10218            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10219                                    WS-LF-REFUND-CALC.
 10220     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10221         IF AM-EARN-METHOD-L = 'P'
 10222            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10223                                    WS-LF-REFUND-CALC.
 10224     IF WS-LF-COVERAGE-TYPE = 'R'
 10225         IF AM-EARN-METHOD-R = 'A'
 10226            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10227                                    WS-LF-REFUND-CALC.
 10228     IF WS-LF-COVERAGE-TYPE = 'R'
 10229         IF AM-EARN-METHOD-R = 'M'
 10230            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10231                                    WS-LF-REFUND-CALC.
 10232     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10233         IF AM-EARN-METHOD-L = 'A'
 10234            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10235                                    WS-LF-REFUND-CALC.
 10236     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10237         IF AM-EARN-METHOD-L = 'M'
 10238            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10239                                    WS-LF-REFUND-CALC.
 10240
 10241     IF AM-EARN-METHOD-A = 'R'
 10242        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10243                                    WS-AH-REFUND-CALC.
 10244     IF AM-EARN-METHOD-A = 'P'
 10245        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10246                                    WS-AH-REFUND-CALC.
 10247     IF AM-EARN-METHOD-A = 'C'
 10248        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10249                                    WS-AH-REFUND-CALC.
 10250     IF AM-EARN-METHOD-A = 'A'
 10251        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10252                                    WS-AH-REFUND-CALC.
 10253     IF AM-EARN-METHOD-A = 'M'
 10254        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10255                                    WS-AH-REFUND-CALC.
 10256     IF AM-EARN-METHOD-A = 'N'
 10257        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10258                                    WS-AH-REFUND-CALC.
 10259     IF AM-EARN-METHOD-A = 'S'
 10260        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10261                                    WS-AH-REFUND-CALC.
 10262
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 187
* EL050.cbl
 10263     IF AM-TOL-PREM NOT = ZEROS
 10264        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10265                                    WS-TOL-AH-PREM.
 10266
 10267     IF AM-OVR-SHT-AMT NUMERIC AND
 10268                  AM-OVR-SHT-AMT > 0
 10269        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10270                                    EC-AM-LF-OVR-SHT-AMT
 10271                                    WS-AH-REFUND-OVS-AMT
 10272                                    EC-AM-AH-OVR-SHT-AMT.
 10273
 10274     IF AM-OVR-SHT-PCT NUMERIC AND
 10275                    AM-OVR-SHT-PCT > 0
 10276        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10277                                    EC-AM-LF-OVR-SHT-PCT
 10278                                    WS-AH-REFUND-OVS-PCT
 10279                                    EC-AM-AH-OVR-SHT-PCT.
 10280
 10281     IF AM-TOL-REF-PCT NUMERIC AND
 10282                  AM-TOL-REF-PCT > 0
 10283        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10284                                    WS-TOL-AH-REFUND-PCT.
 10285
 10286     IF AM-TOL-REF  NOT = ZEROS  AND
 10287                  AM-TOL-REF NUMERIC
 10288        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10289                                    EC-AM-LF-TOL-REFUND
 10290                                    WS-TOL-AH-REFUND
 10291                                    EC-AM-AH-TOL-REFUND.
 10292
 10293     IF AM-TOL-CLM  NOT = ZEROS
 10294        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10295                                    WS-TOL-AH-CLAIM.
 10296
 10297     IF AM-CLP-TOL-PCT NOT NUMERIC
 10298        MOVE +0                  TO AM-CLP-TOL-PCT
 10299     END-IF
 10300
 10301     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10302        MOVE +0                  TO AM-SPP-LEASE-COMM
 10303     END-IF
 10304     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10305        MOVE WS-PL-TOL-LF-PREM-PCT
 10306                                 TO WS-TOL-LF-PREM-PCT.
 10307
 10308     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10309        MOVE WS-PL-TOL-AH-PREM-PCT
 10310                                 TO WS-TOL-AH-PREM-PCT.
 10311
 10312     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10313        MOVE WS-PL-TOL-LF-REFUND-PCT
 10314                                 TO WS-TOL-LF-REFUND-PCT.
 10315
 10316     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10317        MOVE WS-PL-TOL-AH-REFUND-PCT
 10318                                 TO WS-TOL-AH-REFUND-PCT.
 10319
 10320     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 188
* EL050.cbl
 10321        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10322
 10323     IF WS-PL-REF-OVS-PCT > +0
 10324        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10325
 10326     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10327        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10328     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10329        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10330     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10331        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10332     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10333        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10334     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10335        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10336     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10337        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10338
 10339     IF WS-AH-PL-REF-OVS-AMT > +0
 10340        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10341
 10342     IF WS-AH-PL-REF-OVS-PCT > +0
 10343        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10344
 10345     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10346     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10347
 10348     IF PB-CANCELLATION
 10349        GO TO 3000-CONTINUE-EDIT.
 10350
 10351     MOVE +1 TO SUB1.
 10352     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10353     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10354
 10355     IF CF-COMPANY-ID = 'DMD'
 10356       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10357         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10358        ELSE
 10359         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10360
 10361  0525-FIND-ACCT-COMM.
 10362     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10363        NEXT SENTENCE
 10364      ELSE
 10365         ADD +1 TO SUB1
 10366         IF SUB1 LESS +11
 10367            GO TO 0525-FIND-ACCT-COMM
 10368          ELSE
 10369             GO TO 0560-EDIT-CONTINUE.
 10370
 10371     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10372     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10373                                    PB-I-LIFE-COMMISSION.
 10374***  IF PB-COMPANY-ID = 'CRI'
 10375     IF PB-PREM-ACCTNG-ONLY
 10376         GO TO 0560-EDIT-CONTINUE.
 10377
 10378     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 189
* EL050.cbl
 10379     MOVE ' '    TO WS-CTBL-READ-SW.
 10380
 10381
 10382 0530-GET-AH-COMP.
 10383     IF NO-AH-COVERAGE  OR
 10384        NO-AH-BENEFIT-MATCH
 10385           GO TO 0540-NEXT-READ-STEP.
 10386
 10387     IF AM-A-COM (SUB1) NUMERIC
 10388        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10389         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10390         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10391         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10392         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10393     ELSE
 10394          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10395          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10396          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10397          MOVE ZEROS             TO WS-SUB1
 10398                                    WS-COMMISSION
 10399          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10400          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10401          IF WS-COMMISSION > ZEROS
 10402             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10403             GO TO 0540-NEXT-READ-STEP
 10404          END-IF
 10405          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10406          IF CTBL-TABLE-FOUND
 10407             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10408                                        PB-I-AH-TERM
 10409             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10410             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10411             GO TO 0540-NEXT-READ-STEP
 10412          ELSE
 10413             IF FIRST-TIME-THROUGH
 10414                 GO TO 0530-GET-AH-COMP
 10415             ELSE
 10416                 MOVE ER-2609                TO WS-ERROR
 10417                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10418
 10419 0540-NEXT-READ-STEP.
 10420     MOVE '0540' TO CTBL-SW.
 10421     MOVE ' '    TO WS-CTBL-READ-SW.
 10422
 10423 0540-GET-LF-COMP.
 10424     IF NO-LIFE-COVERAGE  OR
 10425        NO-LF-BENEFIT-MATCH
 10426           GO TO 0560-EDIT-CONTINUE.
 10427
 10428     IF WS-LF-JOINT-INDICATOR = 'J'
 10429        IF AM-J-COM (SUB1) NUMERIC
 10430           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10431           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10432           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10433           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10434           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10435        ELSE
 10436           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 190
* EL050.cbl
 10437           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10438           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10439           MOVE ZEROS                TO WS-SUB1
 10440                                        WS-COMMISSION
 10441           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10442           IF WS-COMMISSION > ZEROS
 10443              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10444              GO TO 0560-EDIT-CONTINUE
 10445           END-IF
 10446           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10447           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10448           IF CTBL-TABLE-FOUND
 10449              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10450              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10451              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10452              GO TO 0560-EDIT-CONTINUE
 10453           ELSE
 10454              IF FIRST-TIME-THROUGH
 10455                  GO TO 0540-GET-LF-COMP
 10456              ELSE
 10457                  MOVE ER-2609                TO WS-ERROR
 10458                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10459                  GO TO 0560-EDIT-CONTINUE.
 10460
 10461     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10462        IF AM-L-COM (SUB1) NUMERIC
 10463           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10464           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10465           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10466           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10467           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10468        ELSE
 10469           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10470           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10471           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10472           MOVE ZEROS                TO WS-SUB1
 10473                                        WS-COMMISSION
 10474           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10475           IF WS-COMMISSION IS GREATER THAN ZEROS
 10476              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10477              GO TO 0560-EDIT-CONTINUE
 10478           END-IF
 10479           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10480           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10481           IF CTBL-TABLE-FOUND
 10482              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10483              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10484              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10485              GO TO 0560-EDIT-CONTINUE
 10486           ELSE
 10487              IF FIRST-TIME-THROUGH
 10488                  GO TO 0540-GET-LF-COMP
 10489              ELSE
 10490                  MOVE ER-2609                TO WS-ERROR
 10491                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10492
 10493*    GO TO 0560-EDIT-CONTINUE.
 10494
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 191
* EL050.cbl
 10495 0560-EDIT-CONTINUE.
 10496     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10497                                    WS-AH-PMF-COMM
 10498*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10499*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10500     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10501        (SUB1 > +10)
 10502        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10503           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10504           MOVE '0530'           TO CTBL-SW
 10505           MOVE ' '              TO WS-CTBL-READ-SW
 10506           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10507           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10508           MOVE '0540'           TO CTBL-SW
 10509           MOVE ' '              TO WS-CTBL-READ-SW
 10510           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10511        END-IF
 10512     END-PERFORM
 10513     GO TO 0564-EDIT-CONTINUE
 10514     .
 10515 0561-CHECK-AH.
 10516     IF (NO-AH-COVERAGE)
 10517        OR (NO-AH-BENEFIT-MATCH)
 10518        CONTINUE
 10519     ELSE
 10520        IF (AM-A-COM (SUB1) NUMERIC)
 10521           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10522           IF (AM-COM-TYP (SUB1) = 'A')
 10523              AND (WS-AH-PMF-COMM = ZEROS)
 10524              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10525           END-IF
 10526           CONTINUE
 10527        ELSE
 10528           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10529           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10530           MOVE PB-AH-OVERRIDE-L1
 10531                                 TO CTBL-BEN-TYPE
 10532           MOVE ZEROS            TO WS-SUB1
 10533                                    WS-COMMISSION
 10534           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10535           PERFORM 8300-READ-CTBL-TABLE
 10536                                 THRU 8300-EXIT
 10537           IF CTBL-TABLE-FOUND
 10538              IF (AM-COM-TYP (SUB1) = 'A')
 10539                 AND (WS-AH-PMF-COMM = ZEROS)
 10540                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10541                                        PB-I-AH-TERM
 10542                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10543                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10544              END-IF
 10545              CONTINUE
 10546           ELSE
 10547              IF FIRST-TIME-THROUGH
 10548                 GO TO 0561-CHECK-AH
 10549              ELSE
 10550                 MOVE ER-2609    TO WS-ERROR
 10551                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10552              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 192
* EL050.cbl
 10553           END-IF
 10554        END-IF
 10555     END-IF
 10556     .
 10557 0561-EXIT.
 10558     EXIT.
 10559 0563-CHECK-LF.
 10560     IF (NO-LIFE-COVERAGE)
 10561        OR (NO-LF-BENEFIT-MATCH)
 10562        CONTINUE
 10563     ELSE
 10564        IF WS-LF-JOINT-INDICATOR = 'J'
 10565           IF AM-J-COM (SUB1) NUMERIC
 10566              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10567              IF (AM-COM-TYP (SUB1) = 'A')
 10568                 AND (WS-LF-PMF-COMM = ZEROS)
 10569                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10570              END-IF
 10571              CONTINUE
 10572           ELSE
 10573              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10574              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10575              MOVE PB-LIFE-OVERRIDE-L1
 10576                                 TO CTBL-BEN-TYPE
 10577              MOVE ZEROS         TO WS-SUB1
 10578                                    WS-COMMISSION
 10579              MOVE AM-J-COMA (SUB1)
 10580                                 TO CTBL-TABLE
 10581              PERFORM 8300-READ-CTBL-TABLE
 10582                                 THRU 8300-EXIT
 10583              IF CTBL-TABLE-FOUND
 10584                 IF (AM-COM-TYP (SUB1) = 'A')
 10585                    AND (WS-LF-PMF-COMM = ZEROS)
 10586                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10587                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10588                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10589                 END-IF
 10590                 CONTINUE
 10591              ELSE
 10592                 IF FIRST-TIME-THROUGH
 10593                    GO TO 0563-CHECK-LF
 10594                 ELSE
 10595                    MOVE ER-2609 TO WS-ERROR
 10596                    PERFORM 9900-ERROR-FORMAT
 10597                                 THRU 9900-EXIT
 10598*                   GO TO 0560-EDIT-CONTINUE
 10599                 END-IF
 10600              END-IF
 10601           END-IF
 10602        ELSE
 10603           IF AM-L-COM (SUB1) NUMERIC
 10604              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10605              IF (AM-COM-TYP (SUB1) = 'A')
 10606                 AND (WS-LF-PMF-COMM = ZEROS)
 10607                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10608              END-IF
 10609              CONTINUE
 10610           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 193
* EL050.cbl
 10611              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10612              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10613              MOVE PB-LIFE-OVERRIDE-L1
 10614                                 TO CTBL-BEN-TYPE
 10615              MOVE ZEROS         TO WS-SUB1
 10616                                    WS-COMMISSION
 10617              MOVE AM-L-COMA (SUB1)
 10618                                 TO CTBL-TABLE
 10619              PERFORM 8300-READ-CTBL-TABLE
 10620                                 THRU 8300-EXIT
 10621              IF CTBL-TABLE-FOUND
 10622                 CONTINUE
 10623              ELSE
 10624                 IF FIRST-TIME-THROUGH
 10625                    GO TO 0563-CHECK-LF
 10626                 ELSE
 10627                    MOVE ER-2609 TO WS-ERROR
 10628                    PERFORM 9900-ERROR-FORMAT
 10629                                 THRU 9900-EXIT
 10630                 END-IF
 10631              END-IF
 10632           END-IF
 10633        END-IF
 10634     END-IF
 10635     .
 10636 0563-EXIT.
 10637     EXIT.
 10638 0564-EDIT-CONTINUE.
 10639
 10640     IF  PB-COMPANY-ID EQUAL 'DMD'
 10641         IF PB-I-NUM-BILLED EQUAL ZEROS
 10642            MOVE ER-8148       TO WS-ERROR
 10643            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10644
 10645*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10646*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10647*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10648*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10649*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10650*         IF NO-CONVERSION-ERROR
 10651*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10652*         ELSE
 10653*             IF PB-COMPANY-ID EQUAL 'HAN'
 10654*                 MOVE ZEROS     TO PB-I-AGE.
 10655     IF PB-I-BIRTHDAY > LOW-VALUES
 10656        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10657        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10658        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10659        PERFORM 8500-DATE-CONVERT
 10660                                 THRU 8500-EXIT
 10661        IF NO-CONVERSION-ERROR
 10662           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10663           IF PB-I-AGE > ZEROS
 10664              IF WS-WORK-AGE NOT = PB-I-AGE
 10665                 MOVE ER-9501    TO WS-ERROR
 10666                 PERFORM 9900-ERROR-FORMAT
 10667                                 THRU 9900-EXIT
 10668              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 194
* EL050.cbl
 10669           ELSE
 10670              MOVE WS-WORK-AGE   TO PB-I-AGE
 10671           END-IF
 10672        END-IF
 10673     END-IF
 10674     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10675                                   WS-INS-AGE-SET
 10676     IF PB-I-AGE = ZEROS
 10677        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10678           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10679                                   WS-INS-AGE-SET
 10680           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10681
 10682     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10683                                   WS-AH-EDIT-AGE.
 10684
 10685     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10686        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10687        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10688        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10689        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10690        IF NO-CONVERSION-ERROR
 10691           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10692           IF PB-I-JOINT-AGE > 0
 10693              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10694                 MOVE ER-9503    TO WS-ERROR
 10695                 PERFORM 9900-ERROR-FORMAT
 10696                                 THRU 9900-EXIT
 10697              END-IF
 10698           ELSE
 10699              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10700           END-IF
 10701        ELSE
 10702           MOVE ZEROS            TO PB-I-JOINT-AGE
 10703        END-IF
 10704     END-IF
 10705     IF PB-I-JOINT-AGE NOT NUMERIC
 10706        MOVE ZERO               TO PB-I-JOINT-AGE.
 10707
 10708     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10709                                   WS-JNT-AGE-SET
 10710     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10711        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10712           (WS-AH-JOINT-INDICATOR = 'J')
 10713           IF PB-I-JOINT-AGE = ZEROS
 10714               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10715                                          WS-JNT-AGE-SET
 10716               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10717           END-IF
 10718        END-IF
 10719     END-IF
 10720
 10721     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10722     IF WS-LF-JOINT-INDICATOR = 'J'
 10723        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10724        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10725            IF  PB-I-JOINT-AGE = ZERO
 10726                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 195
* EL050.cbl
 10727                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10728            ELSE
 10729                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10730                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10731                    IF PB-COMPANY-ID NOT = 'LBL'
 10732                        MOVE ER-2685    TO WS-ERROR
 10733                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10734
 10735     IF WS-AH-JOINT-INDICATOR = 'J'
 10736        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10737            IF  PB-I-JOINT-AGE = ZERO
 10738                MOVE ER-2686       TO WS-ERROR
 10739                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10740            ELSE
 10741                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10742                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10743                                           WS-EDIT-AGE
 10744                    IF PB-COMPANY-ID NOT = 'LBL'
 10745                        MOVE ER-2685    TO WS-ERROR
 10746                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10747
 10748******************************************************************
 10749*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10750******************************************************************
 10751
 10752     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10753        (WS-AH-SPECIAL-CALC-CD = 'O')
 10754        NEXT SENTENCE
 10755     ELSE
 10756        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10757          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10758           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10759            WS-AH-JOINT-INDICATOR = 'J')  AND
 10760           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10761            MOVE ER-2627             TO WS-ERROR
 10762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10763
 10764     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10765        (WS-AH-SPECIAL-CALC-CD = 'O')
 10766         NEXT SENTENCE
 10767     ELSE
 10768         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10769            WS-AH-JOINT-INDICATOR = 'J'
 10770             IF PB-I-JOINT-INSURED = SPACES
 10771                 IF PB-COMPANY-ID NOT = 'JAL'
 10772                     MOVE ER-2696    TO WS-ERROR
 10773                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10774
 10775     IF PB-COMPANY-ID NOT = 'BOA'
 10776        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10777           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10778           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10779               PB-I-JOINT-INSURED NOT = SPACES)
 10780                MOVE ER-2691         TO WS-ERROR
 10781                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10782
 10783     IF PB-COMPANY-ID = 'BOA'
 10784        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 196
* EL050.cbl
 10785           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10786            IF PB-I-JOINT-AGE NOT = ZEROS
 10787                MOVE ER-2691         TO WS-ERROR
 10788                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10789
 10790     IF PB-COMPANY-ID = 'CRI'
 10791        IF PB-I-SIG-SW = 'J'
 10792           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10793              WS-AH-JOINT-INDICATOR NOT = 'J'
 10794              MOVE ER-2675       TO WS-ERROR
 10795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10796
 10797     IF PB-COMPANY-ID = 'CRI'
 10798        IF PB-I-SIG-SW = 'S'
 10799           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10800              WS-AH-JOINT-INDICATOR = 'J'
 10801              MOVE ER-2676       TO WS-ERROR
 10802              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10803
 10804     IF PB-COMPANY-ID = 'CVL'
 10805         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10806            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10807              MOVE ER-2783           TO WS-ERROR
 10808              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10809     IF (WS-LF-JOINT-INDICATOR = 'J')
 10810        AND (WS-AH-JOINT-INDICATOR = 'J')
 10811        AND (PB-I-LF-TERM > 120)
 10812        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10813        MOVE ER-2783             TO WS-ERROR
 10814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10815     END-IF
 10816     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10817
 10818     IF PB-I-INDV-GRP-OVRD = 'I'
 10819        MOVE ER-2666             TO WS-ERROR
 10820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10821        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10822
 10823     IF PB-I-INDV-GRP-OVRD = 'G'
 10824        MOVE ER-2666             TO WS-ERROR
 10825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10826        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10827
 10828     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10829        NEXT SENTENCE
 10830     ELSE
 10831        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10832
 10833     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10834        IF WS-ERROR = ER-2666
 10835           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10836           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10837
 10838     IF PB-COMPANY-ID = 'CID'
 10839        IF PB-STATE = 'UT' OR 'MO'
 10840           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10841                 OR '76' OR '77')
 10842                      OR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 197
* EL050.cbl
 10843               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10844                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10845                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10846                   OR '2K' OR '2L'))
 10847              AND PB-I-INDV-GRP-CD = 'I'
 10848              MOVE ER-2721             TO WS-ERROR
 10849              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10850           END-IF
 10851        END-IF
 10852     END-IF
 10853
 10854     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10855     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10856        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10857     ELSE
 10858        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10859     END-IF
 10860
 10861*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10862*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10863     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10864                                    ACCOUNT-AH-CK-SW.
 10865
 10866     IF PB-REISSUED-CERT       OR
 10867        PB-REIN-ONLY-CERT      OR
 10868        PB-POLICY-IS-DECLINED  OR
 10869        PB-POLICY-IS-VOIDED
 10870*       OR PB-MONTHLY-CERT
 10871         GO TO 3000-CONTINUE-EDIT.
 10872
 10873     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10874        IF WS-EDIT-AGE           > +65
 10875           MOVE ER-2709          TO WS-ERROR
 10876           PERFORM 9900-ERROR-FORMAT
 10877                                 THRU 9900-EXIT
 10878        ELSE
 10879           IF WS-EDIT-AGE        > +55
 10880              MOVE ER-2718       TO WS-ERROR
 10881              PERFORM 9900-ERROR-FORMAT
 10882                                 THRU 9900-EXIT
 10883           END-IF
 10884        END-IF
 10885     IF PB-COMPANY-ID = 'DCC'
 10886        IF WS-EDIT-AGE           > +65
 10887           MOVE ER-2709          TO WS-ERROR
 10888           PERFORM 9900-ERROR-FORMAT
 10889                                 THRU 9900-EXIT
 10890        END-IF
 10891     END-IF
 10892     .
 10893
 10894 0565-LIFE-PLAN-LIMIT-EDITS.
 10895
 10896     IF NOT LF-PLAN-MASTER-FOUND
 10897        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10898                                    EC-AM-LF-MAX-TOT-BEN
 10899        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10900
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 198
* EL050.cbl
 10901     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10902
 10903     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10904         IF PL-LM-AGE (1) = ZEROS
 10905             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10906
 10907     IF NO-LF-BENEFIT-MATCH          OR
 10908        WS-LF-BENEFIT-CD = ZEROS     OR
 10909        WS-LF-SPECIAL-CALC-CD = 'M'
 10910        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10911
 10912     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10913     MOVE +1                     TO SUB2.
 10914
 10915     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10916        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10917           MOVE +5   TO SUB2
 10918           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10919              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10920              (PL-LM-AGE (SUB2) EQUAL +0)
 10921              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10922              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10923
 10924     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10925
 10926     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10927                               + PB-I-LF-ALT-BENEFIT-AMT.
 10928
 10929 0568-CHECK-LIFE-ATT-AGE.
 10930
 10931     IF PL-ATT-AGE NUMERIC AND
 10932        PL-ATT-AGE > +0
 10933        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10934     END-IF
 10935*    IF PL-ATT-AGE NUMERIC AND
 10936*       PL-ATT-AGE > +0
 10937*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10938*       IF PB-I-BIRTHDAY > LOW-VALUES
 10939*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10940*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10941*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10942*          SET BIN-PLUS-ELAPSED  TO TRUE
 10943*          PERFORM 8500-DATE-CONVERT
 10944*                                THRU 8500-EXIT
 10945*          IF NO-CONVERSION-ERROR
 10946*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10947*             MOVE ER-2669       TO WS-ERROR
 10948*             PERFORM 9900-ERROR-FORMAT
 10949*                                THRU 9900-EXIT
 10950*          END-IF
 10951*       ELSE
 10952*          IF WS-ATT-AGE >= PL-ATT-AGE
 10953*             MOVE ER-2669       TO WS-ERROR
 10954*             PERFORM 9900-ERROR-FORMAT
 10955*                                THRU 9900-EXIT
 10956*          END-IF
 10957*       END-IF
 10958*    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 199
* EL050.cbl
 10959     .
 10960 0570-CHECK-LIFE-LIMITS.
 10961
 10962     IF PB-COMPANY-ID EQUAL 'CRI'
 10963        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10964           IF SUB2 GREATER THAN +4
 10965              MOVE ER-2637 TO WS-ERROR
 10966              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10967              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10968
 10969     IF PB-COMPANY-ID  =  'NCL'
 10970        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10971            SUB2 GREATER THAN +8
 10972             MOVE 'U'         TO PB-BATCH-ENTRY
 10973             MOVE ER-2637     TO WS-ERROR
 10974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10975             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10976
 10977     IF SUB2 > +8
 10978        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10979           AND (PB-I-SIG-SW = 'Y')
 10980           CONTINUE
 10981        ELSE
 10982           MOVE ER-2637          TO WS-ERROR
 10983           PERFORM 9900-ERROR-FORMAT
 10984                                 THRU 9900-EXIT
 10985        END-IF
 10986        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10987     END-IF
 10988     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10989     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10990     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10991
 10992     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10993        ADD +1  TO SUB2
 10994        GO TO 0570-CHECK-LIFE-LIMITS.
 10995
 10996     IF PB-COMPANY-ID = 'NCL'
 10997         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10998
 10999     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11000        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11001        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11002           AND (PB-I-SIG-SW = 'Y')
 11003           CONTINUE
 11004        ELSE
 11005           MOVE ER-2637          TO WS-ERROR
 11006           PERFORM 9900-ERROR-FORMAT
 11007                                 THRU 9900-EXIT
 11008        END-IF
 11009     END-IF
 11010     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11011
 11012
 11013 0570-CHECK-NCL-LIFE-LIMITS.
 11014
 11015     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11016        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 200
* EL050.cbl
 11017         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11018
 11019     IF APP-CERT-USED
 11020         IF SUB2  LESS THAN  +5
 11021             MOVE +5          TO SUB2
 11022             GO TO 0570-CHECK-LIFE-LIMITS.
 11023
 11024     MOVE ER-2637             TO WS-ERROR.
 11025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11026
 11027     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11028
 11029 0575-CHECK-NCL-SIG-SWITCH.
 11030
 11031     IF NOT APP-CERT-USED
 11032         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11033
 11034     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11035        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11036        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11037        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11038         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11039
 11040     IF SUB2 GREATER THAN +4
 11041         IF PL-LM-AGE (5) = ZEROS  AND
 11042            PL-LM-AGE (6) = ZEROS  AND
 11043            PL-LM-AGE (7) = ZEROS  AND
 11044            PL-LM-AGE (8) = ZEROS
 11045             MOVE  ER-1927        TO WS-ERROR
 11046             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11047             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11048         ELSE
 11049             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11050                 MOVE  ER-1920    TO WS-ERROR
 11051                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11052
 11053     IF PB-I-SIG-SW  = 'Y'
 11054       IF NOT PB-I-POLICY-ACCEPTED  AND
 11055          NOT PB-I-POLICY-DECLINED
 11056           MOVE 'U'               TO PB-BATCH-ENTRY
 11057           MOVE  ER-1926          TO WS-ERROR
 11058           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11059
 11060
 11061 0580-AH-PLAN-LIMIT-EDITS.
 11062
 11063     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11064        IF PB-I-AH-BENEFIT-AMT > +1250
 11065           MOVE ER-2702          TO WS-ERROR
 11066           PERFORM 9900-ERROR-FORMAT
 11067                                 THRU 9900-EXIT
 11068        END-IF
 11069     END-IF
 11070
 11071     IF (PB-COMPANY-ID = 'DCC')
 11072        AND (PB-MONTHLY-CERT)
 11073        IF PB-I-AH-BENEFIT-AMT > +3000
 11074           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 201
* EL050.cbl
 11075           PERFORM 9900-ERROR-FORMAT
 11076                                 THRU 9900-EXIT
 11077        END-IF
 11078     END-IF
 11079     IF NOT AH-PLAN-MASTER-FOUND
 11080        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11081        GO TO 3000-CONTINUE-EDIT.
 11082
 11083     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11084
 11085     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11086         IF PL-LM-AGE (1) = ZEROS
 11087             GO TO 3000-CONTINUE-EDIT.
 11088
 11089     IF NO-AH-BENEFIT-MATCH          OR
 11090        WS-AH-BENEFIT-CD = ZEROS     OR
 11091        WS-AH-SPECIAL-CALC-CD = 'M'
 11092        GO TO 3000-CONTINUE-EDIT.
 11093
 11094     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11095     MOVE +1                     TO SUB2.
 11096
 11097     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11098        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11099           MOVE +5 TO SUB2
 11100           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11101              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11102              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11103              (PL-LM-AGE (SUB2) EQUAL +0)
 11104              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11105              GO TO 3000-CONTINUE-EDIT.
 11106
 11107     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11108
 11109 0590-CHECK-AH-ATT-AGE.
 11110
 11111     IF PL-ATT-AGE NUMERIC AND
 11112        PL-ATT-AGE GREATER THAN +0
 11113        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11114     END-IF
 11115*       IF WS-ATT-AGE >= PL-ATT-AGE
 11116*          MOVE ER-3054          TO WS-ERROR
 11117*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118     .
 11119 0597-CHECK-AH-LIMITS.
 11120
 11121     IF PB-COMPANY-ID EQUAL 'CRI'
 11122        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11123           IF SUB2 GREATER THAN +4
 11124              MOVE ER-2638       TO WS-ERROR
 11125              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11126              GO TO 3000-CONTINUE-EDIT.
 11127
 11128     IF PB-COMPANY-ID  =  'NCL'
 11129        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11130            SUB2 GREATER THAN +8
 11131             MOVE 'U'            TO PB-BATCH-ENTRY
 11132             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 202
* EL050.cbl
 11133             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11134             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11135
 11136     IF SUB2 > +8
 11137        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11138           AND (PB-I-SIG-SW = 'Y')
 11139           CONTINUE
 11140        ELSE
 11141           MOVE ER-2638          TO WS-ERROR
 11142           PERFORM 9900-ERROR-FORMAT
 11143                                 THRU 9900-EXIT
 11144        END-IF
 11145        GO TO 3000-CONTINUE-EDIT
 11146     END-IF
 11147
 11148     IF PB-COMPANY-ID = 'CRI'
 11149        IF WS-ERROR = ER-2638
 11150           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11151
 11152     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11153     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11154     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11155     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11156
 11157     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11158        ADD +1                   TO SUB2
 11159        GO TO 0597-CHECK-AH-LIMITS.
 11160
 11161     IF PB-COMPANY-ID = 'NCL'
 11162         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11163
 11164     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11165        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11166        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11167                                 > PL-LM-AMT (SUB2))
 11168        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11169           AND (PB-I-SIG-SW = 'Y')
 11170           CONTINUE
 11171        ELSE
 11172           MOVE ER-2638          TO WS-ERROR
 11173           PERFORM 9900-ERROR-FORMAT
 11174                                 THRU 9900-EXIT
 11175        END-IF
 11176     END-IF
 11177
 11178     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11179         IF  WS-ERROR    EQUAL    ER-2638
 11180             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11181                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11182                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11183                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11184                MOVE  ER-1910    TO  WS-ERROR
 11185                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11186
 11187     IF PB-COMPANY-ID = 'CRI'
 11188        IF WS-ERROR = ER-2638
 11189            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11190            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 203
* EL050.cbl
 11191            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11192
 11193     GO TO 3000-CONTINUE-EDIT.
 11194
 11195 0597-CHECK-NCL-AH-LIMITS.
 11196
 11197     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11198        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11199        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11200                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11201         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11202
 11203     IF APP-CERT-USED
 11204         IF SUB2  LESS THAN  +5
 11205             MOVE +5             TO SUB2
 11206             GO TO 0597-CHECK-AH-LIMITS.
 11207
 11208     MOVE ER-2638                TO WS-ERROR.
 11209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11210
 11211     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11212
 11213 0599-CHECK-NCL-SIG-SWITCH.
 11214
 11215     IF NOT APP-CERT-USED
 11216         GO TO 3000-CONTINUE-EDIT.
 11217
 11218     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11219        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11220        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11221        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11222         GO TO 3000-CONTINUE-EDIT.
 11223
 11224     IF SUB2 GREATER THAN +4
 11225         IF PL-LM-AGE (5) = ZEROS  AND
 11226            PL-LM-AGE (6) = ZEROS  AND
 11227            PL-LM-AGE (7) = ZEROS  AND
 11228            PL-LM-AGE (8) = ZEROS
 11229             MOVE  ER-1927        TO WS-ERROR
 11230             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11231             GO TO 3000-CONTINUE-EDIT
 11232         ELSE
 11233             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11234                 MOVE  ER-1920    TO WS-ERROR
 11235                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11236
 11237     IF PB-I-SIG-SW  = 'Y'
 11238       IF NOT PB-I-POLICY-ACCEPTED  AND
 11239          NOT PB-I-POLICY-DECLINED
 11240           MOVE 'U'               TO PB-BATCH-ENTRY
 11241           MOVE  ER-1926          TO WS-ERROR
 11242           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11243
 11244******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 204
* EL050.cbl
 11246
 11247 3000-CONTINUE-EDIT.
 11248
 11249     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11250     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11251     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11252     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11253     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11254
 11255     IF BROWSE-STARTED
 11256        PERFORM 9990-RETURN THRU 9990-EXIT
 11257        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11258
 11259     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11260        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11261        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11262        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11263*       MOVE 1                   TO DC-OPTION-CODE
 11264        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11265        IF DATE-CONVERSION-ERROR
 11266           MOVE ER-2622          TO WS-ERROR
 11267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11268        ELSE
 11269           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11270              MOVE ER-2623       TO WS-ERROR
 11271              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11272           ELSE
 11273              MOVE ER-2622       TO WS-ERROR
 11274              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11275
 11276     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11277     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11278     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11279*    MOVE 1                      TO DC-OPTION-CODE.
 11280     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11281     IF DATE-CONVERSION-ERROR
 11282        GO TO 3005-EDIT-CONTINUE
 11283     ELSE
 11284        IF DC-ELAPSED-DAYS GREATER +180
 11285           MOVE ER-2613          TO WS-ERROR
 11286           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11287        ELSE
 11288           IF DC-ELAPSED-DAYS GREATER +90
 11289              MOVE ER-2612       TO WS-ERROR
 11290              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11291           ELSE
 11292             IF DC-ELAPSED-DAYS GREATER +60
 11293                MOVE ER-2614     TO WS-ERROR
 11294                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11295
 11296 3005-EDIT-CONTINUE.
 11297
 11298     IF PB-CANCELLATION
 11299         GO TO 3700-EDIT-CANCEL.
 11300
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 205
* EL050.cbl
 11302******************************************************************
 11303*                  E D I T   I S S U E                           *
 11304******************************************************************
 11305
 11306 3020-EDIT-ISSUE.
 11307
 11308      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11309      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11310      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11311      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11312      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11313
 11314     IF PB-ISSUE-FORCE
 11315        OR PB-ISSUE-DATE-FORCED
 11316        OR PB-FORCE-OFF
 11317        OR PB-OVERCHARGE-FORCE
 11318        CONTINUE
 11319     ELSE
 11320        MOVE ER-2670             TO WS-ERROR
 11321        PERFORM 9900-ERROR-FORMAT
 11322                                 THRU 9900-EXIT
 11323     END-IF
 11324     .
 11325 3022-SET-POLICY-STATUS.
 11326
 11327     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11328
 11329     IF (PB-REISSUED-CERT)
 11330             OR
 11331        ((PB-COMPANY-ID NOT = 'DCC')
 11332         AND (PB-MONTHLY-CERT))
 11333         MOVE '5'                TO PB-I-ENTRY-STATUS
 11334         MOVE 'E'                TO PB-BATCH-ENTRY
 11335     END-IF
 11336
 11337     IF PB-COMPANY-ID = 'DCC'
 11338        IF PB-MONTHLY-CERT
 11339           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11340        END-IF
 11341        IF PB-CASH-CERT
 11342           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11343        END-IF
 11344     END-IF
 11345     IF PB-POLICY-IS-DECLINED
 11346         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11347     IF PB-POLICY-IS-VOIDED
 11348         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11349     IF PB-NEEDS-UNDERWRITING
 11350         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11351     IF PB-REIN-ONLY-CERT
 11352         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11353     IF PB-PREM-ACCTNG-ONLY
 11354         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11355
 11356     MOVE SPACE                  TO PB-I-OB-FLAG.
 11357
 11358     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11359         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 206
* EL050.cbl
 11360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11361         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11362
 11363     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11364        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11365           MOVE 'Z'             TO PB-I-OB-FLAG.
 11366
 11367     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11368        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11369           MOVE 'Z'             TO PB-I-OB-FLAG.
 11370
 11371     IF ACCOUNT-MAST-FOUND
 11372         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11373         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11374         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11375         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11376         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11377         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11378         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11379     END-IF
 11380
 11381     IF ACCOUNT-MAST-FOUND
 11382        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11383         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11384
 11385     IF (ACCOUNT-MAST-FOUND)
 11386        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11387        IF PB-REISSUED-CERT
 11388           CONTINUE
 11389        ELSE
 11390           MOVE ER-2608          TO WS-ERROR
 11391           PERFORM 9900-ERROR-FORMAT
 11392                                 THRU 9900-EXIT
 11393         END-IF
 11394     END-IF
 11395
 11396     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11397        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11398        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11399
 11400**********   DMD CUSTOM CODE FOLLOWS  **********
 11401 3024-EDIT-DMD-FIELDS.
 11402     IF PB-COMPANY-ID NOT = 'DMD'
 11403        GO TO 3025-EDIT-REINSURANCE.
 11404
 11405*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11406*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11407*** ERROR IF THEY ARE NOT EQUAL.
 11408
 11409     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11410     SET BIN-TO-GREG               TO TRUE.
 11411     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11412     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11413**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11414
 11415     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11416     SET BIN-TO-GREG               TO TRUE.
 11417     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 207
* EL050.cbl
 11418     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11419**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11420
 11421     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11422        MOVE ER-8116               TO WS-ERROR
 11423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11424
 11425     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11426
 11427     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11428                                      WK-FULL-CERT-NO.
 11429     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11430
 11431     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11432
 11433     IF PB-VALID-LIFE
 11434        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11435     ELSE
 11436        IF PB-VALID-AH
 11437          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11438
 11439
 11440     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11441     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11442     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11443                                      DCUA-UNDRWRTR-CODE
 11444                                      DCUA-UNDRWRTR-GROUP-CODE
 11445                                      DCUA-RETURN-CODE.
 11446
 11447****************************************************************
 11448*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11449***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11450***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11451***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11452***   TO THIS RECORD.                                        ***
 11453****************************************************************
 11454     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11455     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11456     IF DCUA-SUCCESSFUL-PROCESS
 11457        GO TO 3024-EDIT-DL7-CONT.
 11458
 11459     IF DCUA-RETURN-CODE EQUAL '01'
 11460        MOVE ER-8110               TO WS-ERROR
 11461        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 3024-EDIT-DL7-CONT.
 11464
 11465     IF DCUA-RETURN-CODE EQUAL '02'
 11466        MOVE ER-8111               TO WS-ERROR
 11467        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469        GO TO 3024-EDIT-DL7-CONT.
 11470
 11471     IF DCUA-RETURN-CODE EQUAL '03'
 11472        MOVE ER-8074               TO WS-ERROR
 11473        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 208
* EL050.cbl
 11476
 11477     IF DCUA-RETURN-CODE EQUAL '04'
 11478        MOVE ER-8075               TO WS-ERROR
 11479        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL7-CONT.
 11482
 11483     IF DCUA-RETURN-CODE EQUAL '05'
 11484        MOVE ER-8076               TO WS-ERROR
 11485        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487        GO TO 3024-EDIT-DL7-CONT.
 11488
 11489     IF DCUA-RETURN-CODE EQUAL '06'
 11490        MOVE ER-8077               TO WS-ERROR
 11491        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11493        GO TO 3024-EDIT-DL7-CONT.
 11494
 11495     IF DCUA-RETURN-CODE EQUAL '07'
 11496        MOVE ER-8078               TO WS-ERROR
 11497        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499        GO TO 3024-EDIT-DL7-CONT.
 11500
 11501     IF DCUA-RETURN-CODE EQUAL 'E1'
 11502        MOVE ER-8079               TO WS-ERROR
 11503        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11505        GO TO 3024-EDIT-DL7-CONT.
 11506
 11507     IF DCUA-RETURN-CODE EQUAL 'E2'
 11508        MOVE ER-8080               TO WS-ERROR
 11509        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511        GO TO 3024-EDIT-DL7-CONT.
 11512
 11513     IF DCUA-RETURN-CODE EQUAL 'E3'
 11514        MOVE ER-8098               TO WS-ERROR
 11515        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL7-CONT.
 11518
 11519     IF DCUA-RETURN-CODE EQUAL 'C1'
 11520        MOVE ER-8099               TO WS-ERROR
 11521        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL7-CONT.
 11524
 11525     IF DCUA-RETURN-CODE EQUAL 'U1'
 11526        MOVE ER-8109               TO WS-ERROR
 11527        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529        GO TO 3024-EDIT-DL7-CONT.
 11530
 11531     IF DCUA-RETURN-CODE EQUAL 'N1'
 11532        MOVE ER-8112               TO WS-ERROR
 11533        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 209
* EL050.cbl
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL7-CONT.
 11536
 11537     IF DCUA-RETURN-CODE EQUAL 'N2'
 11538        MOVE ER-8113               TO WS-ERROR
 11539        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL7-CONT.
 11542
 11543     IF DCUA-RETURN-CODE EQUAL 'N3'
 11544        MOVE ER-8114               TO WS-ERROR
 11545        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL7-CONT.
 11548
 11549     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11550     MOVE ER-8097                  TO WS-ERROR.
 11551     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11552     GO TO 3024-EDIT-DL7-CONT.
 11553
 11554 3024-EDIT-DL7-CONT.
 11555
 11556     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11557     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11558     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11559        NEXT SENTENCE
 11560     ELSE
 11561        MOVE ER-9263               TO WS-ERROR
 11562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11563
 11564******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11565******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11566     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11567        NEXT SENTENCE
 11568     ELSE
 11569        MOVE ER-8039               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11571
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 210
* EL050.cbl
 11573****************************************************************
 11574*** VALIDATE STATE  : DLO022                                 ***
 11575****************************************************************
 11576     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11577     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11578
 11579     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11580     IF DVSC-SUCCESSFUL-EDIT
 11581        GO TO 3024-EDIT-DL22-CONT.
 11582
 11583     IF DVSC-RETURN-CODE EQUAL '01'
 11584        MOVE ER-8300               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 3024-EDIT-DL22-CONT.
 11587
 11588     IF DVSC-RETURN-CODE EQUAL '02'
 11589        MOVE ER-8301               TO WS-ERROR
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        GO TO 3024-EDIT-DL22-CONT.
 11592
 11593     IF DVSC-RETURN-CODE EQUAL '03'
 11594        MOVE ER-8302               TO WS-ERROR
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL22-CONT.
 11597
 11598     IF DVSC-RETURN-CODE EQUAL 'N1'
 11599        MOVE ER-8304               TO WS-ERROR
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL22-CONT.
 11602
 11603     MOVE ER-8303                  TO WS-ERROR
 11604     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11605
 11606 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 211
* EL050.cbl
 11608****************************************************************
 11609*** VALIDATE LOAN OFFICER : DLO021                           ***
 11610****************************************************************
 11611
 11612     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11613     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11614     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11615     IF DVLO-SUCCESSFUL-EDIT
 11616        GO TO 3024-EDIT-DL21-CONT.
 11617
 11618     IF DVLO-RETURN-CODE EQUAL '01'
 11619        MOVE ER-8081               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL21-CONT.
 11622
 11623     IF DVLO-RETURN-CODE EQUAL '02'
 11624        MOVE ER-8082               TO WS-ERROR
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626        GO TO 3024-EDIT-DL21-CONT.
 11627
 11628     IF DVLO-RETURN-CODE EQUAL '03'
 11629        MOVE ER-8083               TO WS-ERROR
 11630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11631        GO TO 3024-EDIT-DL21-CONT.
 11632
 11633     IF DVLO-RETURN-CODE EQUAL '04'
 11634        MOVE ER-8084               TO WS-ERROR
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11636        GO TO 3024-EDIT-DL21-CONT.
 11637
 11638     IF DVLO-RETURN-CODE EQUAL '05'
 11639        MOVE ER-8085               TO WS-ERROR
 11640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11641        GO TO 3024-EDIT-DL21-CONT.
 11642
 11643     MOVE ER-7825                  TO WS-ERROR
 11644     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11645     GO TO 3024-EDIT-DL21-CONT.
 11646
 11647 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 212
* EL050.cbl
 11649
 11650****************************************************************
 11651*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11652****************************************************************
 11653
 11654     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11655     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11656     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11657     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11658     IF DIPF-SUCCESSFUL-EDIT
 11659        GO TO 3024-EDIT-DL02-CONT.
 11660
 11661     IF DIPF-RETURN-CODE EQUAL '01'
 11662        MOVE ER-8086               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL02-CONT.
 11665
 11666     IF DIPF-RETURN-CODE EQUAL '02'
 11667        MOVE ER-8087               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL02-CONT.
 11670
 11671     IF DIPF-RETURN-CODE EQUAL '03'
 11672        MOVE ER-8088               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL02-CONT.
 11675
 11676     MOVE ER-8095                  TO WS-ERROR
 11677     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11678     GO TO 3024-EDIT-DL02-CONT.
 11679
 11680 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 213
* EL050.cbl
 11682
 11683****************************************************************
 11684*** VALIDATE BANK ID : DLO003                                ***
 11685****************************************************************
 11686
 11687     MOVE WK-GREG-CENT           TO WCG-CENT.
 11688     MOVE WK-GREG-YYMM           TO WCG-REST.
 11689     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11690        MOVE ER-8040               TO WS-ERROR
 11691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11692
 11693     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11694     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11695     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11696     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11697     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11698     IF DVBI-SUCCESSFUL-EDIT
 11699        GO TO 3024-EDIT-DL03-CONT.
 11700
 11701     IF DVBI-RETURN-CODE EQUAL '01'
 11702        MOVE ER-8089               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL03-CONT.
 11705
 11706     IF DVBI-RETURN-CODE EQUAL '02'
 11707        MOVE ER-8090               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709        GO TO 3024-EDIT-DL03-CONT.
 11710
 11711     IF DVBI-RETURN-CODE EQUAL '03'
 11712        MOVE ER-8091               TO WS-ERROR
 11713        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11714        GO TO 3024-EDIT-DL03-CONT.
 11715
 11716     IF DVBI-RETURN-CODE EQUAL '04'
 11717        MOVE ER-8092               TO WS-ERROR
 11718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11719        GO TO 3024-EDIT-DL03-CONT.
 11720
 11721     IF DVBI-RETURN-CODE EQUAL '05'
 11722        MOVE ER-8093               TO WS-ERROR
 11723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11724        GO TO 3024-EDIT-DL03-CONT.
 11725
 11726     IF DVBI-RETURN-CODE EQUAL '06'
 11727        MOVE ER-8094               TO WS-ERROR
 11728        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729        GO TO 3024-EDIT-DL03-CONT.
 11730
 11731     MOVE ER-8096                  TO WS-ERROR
 11732     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11733     GO TO 3024-EDIT-DL03-CONT.
 11734
 11735 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 214
* EL050.cbl
 11737
 11738     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11739        NEXT SENTENCE
 11740     ELSE
 11741        MOVE ER-8042               TO WS-ERROR
 11742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11743
 11744     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11745     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11746     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11747
 11748     IF DMPF-RETURN-CODE = '01'
 11749        MOVE ER-8067               TO WS-ERROR
 11750        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11751        GO TO 3024-EDIT-DL01-CONT.
 11752
 11753     IF DMPF-RETURN-CODE = '02'
 11754        MOVE ER-8068               TO WS-ERROR
 11755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11756        GO TO 3024-EDIT-DL01-CONT.
 11757
 11758     IF DMPF-RETURN-CODE = '03'
 11759        MOVE ER-8069               TO WS-ERROR
 11760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11761        GO TO 3024-EDIT-DL01-CONT.
 11762
 11763     IF DMPF-RETURN-CODE = 'E1'
 11764        MOVE ER-8070               TO WS-ERROR
 11765        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11766        GO TO 3024-EDIT-DL01-CONT.
 11767
 11768     IF DMPF-RETURN-CODE = 'N1'
 11769        MOVE ER-8071               TO WS-ERROR
 11770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11771        GO TO 3024-EDIT-DL01-CONT.
 11772
 11773     IF DMPF-RETURN-CODE NOT = 'OK'
 11774        MOVE ER-8072               TO WS-ERROR
 11775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11776
 11777 3024-EDIT-DL01-CONT.
 11778******************************************************************
 11779***  VALIDATES RATE CODES : DLO017                             ***
 11780******************************************************************
 11781
 11782      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11783      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11784      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11785      IF DVRC-SUCCESSFUL-EDIT
 11786        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11787        GO TO 3024-CHECK-VALID-RATE.
 11788
 11789      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11790
 11791      IF DVRC-RETURN-CODE EQUAL '01'
 11792         MOVE ER-7817                   TO WS-ERROR
 11793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11794         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 215
* EL050.cbl
 11795
 11796      IF DVRC-RETURN-CODE EQUAL '02'
 11797         MOVE ER-7818                   TO WS-ERROR
 11798         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799         GO TO 3025-EDIT-REINSURANCE.
 11800
 11801      IF DVRC-RETURN-CODE EQUAL '03'
 11802         MOVE ER-7819                   TO WS-ERROR
 11803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804         GO TO 3025-EDIT-REINSURANCE.
 11805
 11806       MOVE ER-7820                     TO WS-ERROR.
 11807       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11808       GO TO 3025-EDIT-REINSURANCE.
 11809
 11810******************************************************************
 11811***  GET PREMIUM RATES : DLO011                                ***
 11812******************************************************************
 11813
 11814 3024-CHECK-VALID-RATE.
 11815
 11816     IF VALID-RATE-CODE
 11817        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11818        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11819        MOVE SPACES                TO DPRB-RETURN-CODE
 11820        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11821     ELSE
 11822         GO TO 3025-EDIT-REINSURANCE.
 11823
 11824      IF DPRB-SUCCESSFUL-PROCESS
 11825         IF PB-VALID-LIFE
 11826             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11827             GO TO 3025-EDIT-REINSURANCE
 11828         ELSE
 11829             IF PB-VALID-AH
 11830                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11831                 GO TO 3025-EDIT-REINSURANCE.
 11832
 11833      IF DPRB-RETURN-CODE EQUAL '01'
 11834         MOVE ER-7812                   TO WS-ERROR
 11835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11836         GO TO 3025-EDIT-REINSURANCE.
 11837
 11838      IF DPRB-RETURN-CODE EQUAL '02'
 11839         MOVE ER-7813                   TO WS-ERROR
 11840         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11841         GO TO 3025-EDIT-REINSURANCE.
 11842
 11843      IF DPRB-RETURN-CODE EQUAL '03'
 11844         MOVE ER-7814                   TO WS-ERROR
 11845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11846         GO TO 3025-EDIT-REINSURANCE.
 11847
 11848      IF DPRB-RETURN-CODE EQUAL '04'
 11849         IF NOT DPRB-1ST-TIME
 11850            MOVE ER-7815                   TO WS-ERROR
 11851            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11852            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 216
* EL050.cbl
 11853          ELSE
 11854         IF PB-VALID-LIFE
 11855            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11856          ELSE
 11857            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11858         END-IF
 11859         MOVE SPACES                TO DOCC-RETURN-CODE
 11860         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11861         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11862         IF DOCC-RETURN-CODE = 'OK'
 11863             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11864             GO TO 3024-CHECK-VALID-RATE
 11865           ELSE
 11866             MOVE ER-7823               TO WS-ERROR
 11867             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11868             GO TO 3025-EDIT-REINSURANCE.
 11869
 11870       MOVE ER-7816                     TO WS-ERROR.
 11871       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11872       GO TO 3025-EDIT-REINSURANCE.
 11873
 11874**********   DMD CUSTOM CODE ABOVE    **********
 11875
 11876 3025-EDIT-REINSURANCE.
 11877     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11878         GO TO 3027-EDIT-CONTINUE.
 11879
 11880     MOVE LOW-VALUES               TO ERREIN-KEY.
 11881     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11882     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11883                                      REIN-CODE-2
 11884                                      REIN-CODE-3.
 11885     MOVE 'A'                      TO REIN-TYPE.
 11886
 11887     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11888
 11889     MOVE '3026' TO REIN-SW.
 11890     MOVE ' '                   TO WS-REIN-READ-SW.
 11891
 11892     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11893     IF REIN-TABLE-NOT-FOUND
 11894         GO TO 3026-NO-SPEC-TABLE.
 11895
 11896     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11897     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11898                                   WS-NSP-ST-CD-LF.
 11899     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11900                                   WS-NSP-ST-CD-AH.
 11901
 11902     GO TO 3040-EDIT-CONTINUE.
 11903
 11904 3026-NO-SPEC-TABLE.
 11905
 11906     MOVE ER-2664                TO WS-ERROR.
 11907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11908     GO TO 3040-EDIT-CONTINUE.
 11909
 11910 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 217
* EL050.cbl
 11911
 11912     IF PB-I-REIN-TABLE = SPACES
 11913       GO TO 3040-EDIT-CONTINUE.
 11914
 11915     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11916          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11917          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11918           GO TO 3040-EDIT-CONTINUE.
 11919
 11920     MOVE LOW-VALUES            TO ERREIN-KEY.
 11921     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11922     MOVE 'A'                   TO REIN-TYPE.
 11923     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11924
 11925     MOVE '3028'                TO REIN-SW.
 11926     MOVE ' '                   TO WS-REIN-READ-SW.
 11927
 11928     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11929     IF REIN-TABLE-NOT-FOUND
 11930         GO TO 3028-NO-REIN-TABLE.
 11931
 11932     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11933     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11934                                   WS-NSP-ST-CD-LF.
 11935     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11936                                   WS-NSP-ST-CD-AH.
 11937
 11938     GO TO 3040-EDIT-CONTINUE.
 11939
 11940 3028-NO-REIN-TABLE.
 11941
 11942     MOVE ER-2615                TO WS-ERROR.
 11943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11944     GO TO 3040-EDIT-CONTINUE.
 11945
 11946 3040-EDIT-CONTINUE.
 11947
 11948     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11949         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11950
 11951     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11952         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11953
 11954     IF (NOT PB-REISSUED-CERT)
 11955        AND (NOT PB-MONTHLY-CERT)
 11956        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11957            MOVE '001'           TO PB-I-LF-TERM
 11958            MOVE 'M'             TO PB-I-INSURED-SEX.
 11959
 11960     IF (NOT PB-REISSUED-CERT)
 11961        AND (NOT PB-MONTHLY-CERT)
 11962        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11963            MOVE '001'           TO PB-I-AH-TERM
 11964            MOVE 'M'             TO PB-I-INSURED-SEX.
 11965
 11966 3040-EDIT-1ST-PMT-DT.
 11967     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11968     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 218
* EL050.cbl
 11969         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11970
 11971******************************************************************
 11972*                                                                *
 11973*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11974*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11975*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11976*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11977*                                                                *
 11978******************************************************************
 11979
 11980     IF PB-EFF-DT-PROCESSING
 11981        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11982                                    PB-I-LF-EXPIRE-DT
 11983                                    PB-I-AH-EXPIRE-DT
 11984        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11985        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11986        MOVE ZERO                TO DC-ELAPSED-DAYS
 11987        MOVE +1                  TO DC-ELAPSED-MONTHS
 11988        SET BIN-PLUS-ELAPSED     TO TRUE
 11989*       MOVE 6                   TO DC-OPTION-CODE
 11990        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11991        IF NO-CONVERSION-ERROR
 11992           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11993
 11994******************************************************************
 11995*                                                                *
 11996*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11997*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11998*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11999*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12000*                                                                *
 12001******************************************************************
 12002
 12003     IF PB-EXT-DAYS-PROCESSING
 12004          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12005                                         PB-I-LF-EXPIRE-DT
 12006                                         PB-I-AH-EXPIRE-DT
 12007          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12008          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12009          MOVE +1                     TO DC-ELAPSED-MONTHS
 12010          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12011          SET BIN-PLUS-ELAPSED        TO TRUE
 12012*         MOVE 6                      TO DC-OPTION-CODE
 12013          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12014          IF NO-CONVERSION-ERROR
 12015             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12016
 12017******************************************************************
 12018*                                                                *
 12019*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12020*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12021*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12022*        (EXPIRE DATE - (TERM -1))  *  -1.
 12023*                                                                *
 12024******************************************************************
 12025
 12026     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 219
* EL050.cbl
 12027        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12028           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12029              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12030              MOVE PB-I-AH-TERM      TO WS-TERM
 12031           ELSE
 12032              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12033              MOVE PB-I-LF-TERM      TO WS-TERM
 12034        ELSE
 12035           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12036              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12037              MOVE PB-I-LF-TERM      TO WS-TERM
 12038           ELSE
 12039              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12040              MOVE PB-I-AH-TERM      TO WS-TERM.
 12041
 12042     IF PB-EXPIRE-DT-PROCESSING
 12043        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12044        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12045        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12046        MOVE ZERO                TO DC-ELAPSED-DAYS
 12047                                    DC-ODD-DAYS-OVER
 12048          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12049          SET BIN-PLUS-ELAPSED    TO TRUE
 12050*         MOVE 6                  TO DC-OPTION-CODE
 12051          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12052          IF NO-CONVERSION-ERROR
 12053             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12054
 12055******************************************************************
 12056*                                                                *
 12057*            1ST PAYMENT DATE PROCESSING                         *
 12058*                                                                *
 12059******************************************************************
 12060
 12061     IF PB-1ST-PMT-DT-PROCESSING
 12062        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12063                                    PB-I-AH-EXPIRE-DT
 12064        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12065
 12066     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12067         NEXT SENTENCE
 12068     ELSE
 12069         MOVE ER-2680                 TO WS-ERROR
 12070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12071         GO TO 3060-ORIG-TERM-CHECK.
 12072
 12073     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12074     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12075     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12076*    MOVE 1                      TO DC-OPTION-CODE.
 12077     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12078                                    DC-ELAPSED-DAYS
 12079                                    DC-ODD-DAYS-OVER.
 12080
 12081     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12082
 12083     IF DATE-CONVERSION-ERROR
 12084        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 220
* EL050.cbl
 12085
 12086     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12087     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12088        AND (WS-LF-COVERAGE-TYPE = 'L')
 12089        IF (DC-ELAPSED-MONTHS > 1)
 12090                      OR
 12091           ((DC-ELAPSED-MONTHS = 1)
 12092           AND (DC-ODD-DAYS-OVER > 0))
 12093           MOVE ER-2882          TO WS-ERROR
 12094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095        END-IF
 12096     END-IF
 12097     if dc-elapsed-months > 0
 12098        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12099        + dc-odd-days-over
 12100     end-if
 12101     IF PB-EXT-DAYS-PROCESSING
 12102        CONTINUE
 12103     ELSE
 12104        IF DC-ELAPSED-MONTHS = +0
 12105           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12106        ELSE
 12107           IF (WS-LF-EARNINGS-CALC = '4')
 12108              AND (DC-ELAPSED-MONTHS > ZERO)
 12109              AND (DC-ELAPSED-DAYS > ZERO)
 12110              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12111           ELSE
 12112              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12113                                 THRU 6499-EXIT
 12114              MOVE WS-ODD-DAYS-OVER
 12115                                 TO PB-I-EXTENTION-DAYS
 12116           END-IF
 12117        END-IF
 12118     END-IF
 12119******************************************************************
 12120*                                                                *
 12121*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12122*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12123*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12124*            AND ANY ODD DAYS.                                   *
 12125*                                                                *
 12126******************************************************************
 12127
 12128     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12129                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12130     IF WS-LF-EARNINGS-CALC NOT = '4'
 12131        IF DC-ELAPSED-DAYS > ZEROS
 12132           MOVE ER-2681          TO WS-ERROR
 12133           PERFORM 9900-ERROR-FORMAT
 12134                                 THRU 9900-EXIT
 12135        END-IF
 12136     END-IF
 12137
 12138     IF WS-LF-EARNINGS-CALC NOT = '4'
 12139        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12140           MOVE ER-2681          TO WS-ERROR
 12141           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12142
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 221
* EL050.cbl
 12143     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12144        (PB-I-LF-TERM NOT = ZERO) AND
 12145         NOT NO-LIFE-COVERAGE
 12146          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12147          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12148          IF WS-LF-EARNINGS-CALC = '4'
 12149             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12150             PB-I-PAY-FREQUENCY
 12151          END-IF
 12152          MOVE ZERO              TO DC-ELAPSED-DAYS
 12153                                    DC-ODD-DAYS-OVER
 12154          MOVE 1                 TO DC-END-OF-MONTH
 12155          SET BIN-PLUS-ELAPSED        TO TRUE
 12156*         MOVE 6                 TO DC-OPTION-CODE
 12157          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12158          IF NO-CONVERSION-ERROR
 12159             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12160             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12161                (WS-LF-SPECIAL-CALC-CD = 'L')
 12162                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12163                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12164                  MOVE +1             TO DC-ELAPSED-MONTHS
 12165                  SET BIN-PLUS-ELAPSED  TO TRUE
 12166*                 MOVE 6              TO DC-OPTION-CODE
 12167                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12168                  IF NO-CONVERSION-ERROR
 12169                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12170
 12171* okay, i had to move the new att age edit down here because the
 12172* expiration date could get recalculated and i need the exp date
 12173     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12174        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12175        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12176        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12177           AND ZEROS
 12178           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12179           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12180           SET ELAPSED-BETWEEN-BIN TO TRUE
 12181           PERFORM 8500-DATE-CONVERT
 12182                                 THRU 8500-EXIT
 12183           IF NO-CONVERSION-ERROR
 12184              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12185                 MOVE ER-2669       TO WS-ERROR
 12186*                PERFORM 9900-ERROR-FORMAT
 12187*                                THRU 9900-EXIT
 12188              END-IF
 12189           END-IF
 12190        ELSE
 12191           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12192           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12193              MOVE ER-2669       TO WS-ERROR
 12194*             PERFORM 9900-ERROR-FORMAT
 12195*                                THRU 9900-EXIT
 12196           ELSE
 12197              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12198                 MOVE ER-1570    TO WS-ERROR
 12199                 PERFORM 9900-ERROR-FORMAT
 12200                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 222
* EL050.cbl
 12201              END-IF
 12202           END-IF
 12203        END-IF
 12204        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12205           AND ZEROS
 12206           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12207           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12208           SET ELAPSED-BETWEEN-BIN TO TRUE
 12209           PERFORM 8500-DATE-CONVERT
 12210                                 THRU 8500-EXIT
 12211           IF NO-CONVERSION-ERROR
 12212              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12213                 MOVE ER-2669       TO WS-ERROR
 12214*                PERFORM 9900-ERROR-FORMAT
 12215*                                THRU 9900-EXIT
 12216              END-IF
 12217           END-IF
 12218        ELSE
 12219           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12220             (PB-I-LF-TERM / 12)
 12221           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12222              MOVE ER-2669       TO WS-ERROR
 12223*             PERFORM 9900-ERROR-FORMAT
 12224*                                THRU 9900-EXIT
 12225           ELSE
 12226              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12227                 MOVE ER-1571    TO WS-ERROR
 12228                 PERFORM 9900-ERROR-FORMAT
 12229                                 THRU 9900-EXIT
 12230              END-IF
 12231           END-IF
 12232        END-IF
 12233        IF WS-ERROR = ER-2669
 12234           PERFORM 9900-ERROR-FORMAT
 12235                                 THRU 9900-EXIT
 12236        END-IF
 12237     END-IF
 12238     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12239        (PB-I-AH-TERM NOT = ZERO) AND
 12240         NOT NO-AH-COVERAGE
 12241          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12242             AND (PB-COMPANY-ID = 'DCC')
 12243             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12244             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12245          ELSE
 12246             IF WS-LF-EARNINGS-CALC = '4'
 12247                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12248                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12249                PB-I-PAY-FREQUENCY
 12250             ELSE
 12251                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12252                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12253             END-IF
 12254          END-IF
 12255          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12256                                         DC-ODD-DAYS-OVER
 12257          MOVE 1                      TO DC-END-OF-MONTH
 12258          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 223
* EL050.cbl
 12259*         MOVE 6                      TO DC-OPTION-CODE
 12260          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12261          IF NO-CONVERSION-ERROR
 12262             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12263     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12264        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12265        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12266        IF PB-I-BIRTHDAY > LOW-VALUES
 12267           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12268           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12269           SET ELAPSED-BETWEEN-BIN TO TRUE
 12270           PERFORM 8500-DATE-CONVERT
 12271                                 THRU 8500-EXIT
 12272           IF NO-CONVERSION-ERROR
 12273              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12274                 MOVE ER-3054       TO WS-ERROR
 12275*                PERFORM 9900-ERROR-FORMAT
 12276*                                THRU 9900-EXIT
 12277              END-IF
 12278           END-IF
 12279        ELSE
 12280           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12281           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12282              MOVE ER-3054       TO WS-ERROR
 12283*             PERFORM 9900-ERROR-FORMAT
 12284*                                THRU 9900-EXIT
 12285           END-IF
 12286        END-IF
 12287        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12288           AND ZEROS
 12289           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12290           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12291           SET ELAPSED-BETWEEN-BIN TO TRUE
 12292           PERFORM 8500-DATE-CONVERT
 12293                                 THRU 8500-EXIT
 12294           IF NO-CONVERSION-ERROR
 12295              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12296                 MOVE ER-3054       TO WS-ERROR
 12297*                PERFORM 9900-ERROR-FORMAT
 12298*                                THRU 9900-EXIT
 12299              END-IF
 12300           END-IF
 12301        ELSE
 12302           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12303             (PB-I-AH-TERM / 12)
 12304           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12305              MOVE ER-3054       TO WS-ERROR
 12306*             PERFORM 9900-ERROR-FORMAT
 12307*                                THRU 9900-EXIT
 12308           END-IF
 12309        END-IF
 12310        IF WS-ERROR = ER-3054
 12311           PERFORM 9900-ERROR-FORMAT
 12312                                 THRU 9900-EXIT
 12313        END-IF
 12314     END-IF
 12315     MOVE SPACE                       TO DC-END-OF-MONTH.
 12316
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 224
* EL050.cbl
 12317     IF PB-COMPANY-ID = 'NCB'
 12318        GO TO 3040-EDIT-EXTENSION-DAYS.
 12319
 12320     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12321       AND
 12322        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12323        NEXT SENTENCE
 12324     ELSE
 12325        GO TO 3040-EDIT-EXTENSION-DAYS.
 12326
 12327     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12328        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12329        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12330     ELSE
 12331        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12332        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12333
 12334     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12335*    MOVE '1'      TO DC-OPTION-CODE
 12336     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12337     IF (NO-CONVERSION-ERROR)
 12338        AND (DC-ELAPSED-MONTHS > +1)
 12339        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12340        MOVE ER-2668   TO WS-ERROR
 12341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12342
 12343 3040-EDIT-EXTENSION-DAYS.
 12344
 12345     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12346        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12347         GO TO 3050-EDIT-TERM-IN-DAYS
 12348     ELSE
 12349         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12350
 12351     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12352         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12353     ELSE
 12354        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12355           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12356           MOVE ER-2681         TO WS-ERROR
 12357           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12358
 12359     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12360        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12361        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12362         GO TO 3060-ORIG-TERM-CHECK.
 12363
 12364     GO TO 3060-ORIG-TERM-CHECK.
 12365
 12366 3050-EDIT-TERM-IN-DAYS.
 12367
 12368     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12369
 12370     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12371         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12372     ELSE
 12373         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12374            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 225
* EL050.cbl
 12375            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12376
 12377     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12378                                       REMAINDER WS-WORK-TERM.
 12379     IF WS-WORK-TERM GREATER THAN ZERO
 12380         ADD +1 TO PB-I-LF-TERM.
 12381
 12382     IF NOT NO-AH-COVERAGE
 12383         MOVE ER-2684            TO WS-ERROR
 12384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12385
 12386
 12387 3060-ORIG-TERM-CHECK.
 12388
 12389******************************************************************
 12390*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12391******************************************************************
 12392
 12393     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12394        NEXT SENTENCE
 12395     ELSE
 12396        IF NOT NO-LIFE-COVERAGE
 12397           IF PB-I-LF-TERM NUMERIC
 12398              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12399              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12400              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12401                  NEXT SENTENCE
 12402           ELSE
 12403              MOVE ER-2647       TO WS-ERROR
 12404              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12405
 12406     IF NOT NO-AH-COVERAGE
 12407         IF PB-I-AH-TERM NUMERIC
 12408            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12409            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12410            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12411             NEXT SENTENCE
 12412          ELSE
 12413              MOVE ER-2658       TO WS-ERROR
 12414              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415
 12416     IF PB-COMPANY-ID = 'NCB'
 12417        GO TO 3070-LOAN-TERM-CHECK.
 12418
 12419     IF POLICY-HAS-AH
 12420       AND
 12421        POLICY-HAS-LIFE
 12422       AND
 12423        PB-I-LF-TERM NUMERIC
 12424       AND
 12425        PB-I-AH-TERM NUMERIC
 12426        NEXT SENTENCE
 12427     ELSE
 12428        GO TO 3070-LOAN-TERM-CHECK.
 12429
 12430     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12431     IF WS-TEX-FACT-2 LESS THAN +0
 12432        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 226
* EL050.cbl
 12433
 12434     IF WS-TEX-FACT-2 GREATER THAN +1
 12435        MOVE ER-2668             TO WS-ERROR
 12436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12437
 12438 3070-LOAN-TERM-CHECK.
 12439
 12440     IF (WS-LF-BENEFIT-CD = ZERO)
 12441         OR (NO-LF-BENEFIT-MATCH)
 12442            GO TO 3125-EDIT-PMT-FREQ.
 12443*    IF PB-COMPANY-ID NOT = 'DCC'
 12444*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12445*          AND 'V' AND 'W' AND 'X'
 12446*          GO TO 3125-EDIT-PMT-FREQ
 12447*       END-IF
 12448*    ELSE
 12449*       IF WS-AH-DCC-TRUNC = 'T'
 12450*          CONTINUE
 12451*       ELSE
 12452*          GO TO 3125-EDIT-PMT-FREQ
 12453*       END-IF
 12454*    END-IF
 12455     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12456                    OR
 12457        ((PB-COMPANY-ID = 'DCC')
 12458        AND (WS-AH-DCC-TRUNC = 'T'))
 12459        CONTINUE
 12460     ELSE
 12461        GO TO 3125-EDIT-PMT-FREQ
 12462     END-IF
 12463     IF PB-I-LOAN-TERM NOT NUMERIC
 12464         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12465
 12466     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12467        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12468*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12469        PB-I-LOAN-TERM NOT GREATER THAN +360
 12470         NEXT SENTENCE
 12471     ELSE
 12472         MOVE ER-2648            TO WS-ERROR
 12473         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12474
 12475     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12476        MOVE ER-3058             TO WS-ERROR
 12477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12478     end-if
 12479
 12480     IF WS-STATE-ABBREVIATION = 'NC'
 12481        IF PB-I-LOAN-TERM > +59
 12482           CONTINUE
 12483        ELSE
 12484           MOVE ER-2792          TO WS-ERROR
 12485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12486        END-IF
 12487     END-IF
 12488
 12489     .
 12490 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 227
* EL050.cbl
 12491     IF (WS-LF-BENEFIT-CD = ZERO)
 12492         OR (NO-LF-BENEFIT-MATCH)
 12493            GO TO 3127-EDIT-LOAN-OFFICER.
 12494     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12495                    OR
 12496        ((PB-COMPANY-ID = 'DCC')
 12497        AND (WS-AH-DCC-TRUNC = 'T'))
 12498                    OR
 12499         (PB-COMPANY-ID = 'AHL')
 12500        CONTINUE
 12501     ELSE
 12502        IF (PB-I-LOAN-TERM > ZEROS)
 12503           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12504           MOVE ER-1575          TO WS-ERROR
 12505           PERFORM 9900-ERROR-FORMAT
 12506                                 THRU 9900-EXIT
 12507        END-IF
 12508     END-IF
 12509     IF WS-LF-EARNINGS-CALC NOT = '4'
 12510         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12511            MOVE ER-2653         TO WS-ERROR
 12512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12513            GO TO 3127-EDIT-LOAN-OFFICER
 12514         ELSE
 12515            GO TO 3127-EDIT-LOAN-OFFICER.
 12516
 12517     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12518         MOVE ER-2655            TO WS-ERROR
 12519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12520         GO TO 3127-EDIT-LOAN-OFFICER.
 12521
 12522     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12523         MOVE ER-2654            TO WS-ERROR
 12524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12525         GO TO 3127-EDIT-LOAN-OFFICER.
 12526
 12527     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12528         GIVING WS-TEX-FACT-2
 12529             REMAINDER WS-TEX-FACT-3.
 12530
 12531*    IF WS-TEX-FACT-3 NOT = ZERO
 12532*       MOVE ER-2654             TO WS-ERROR
 12533*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12534
 12535
 12536 3127-EDIT-LOAN-OFFICER.
 12537
 12538     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12539        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12540           MOVE ER-2690          TO WS-ERROR
 12541           PERFORM 9900-ERROR-FORMAT
 12542                                 THRU 9900-EXIT
 12543        ELSE
 12544           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12545           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12546           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12547           MOVE PB-SV-STATE      TO LOFC-STATE
 12548           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 228
* EL050.cbl
 12549           MOVE PB-I-LOAN-OFFICER
 12550                                 TO LOFC-CODE
 12551           PERFORM 8586-READ-LOAN-OFFICER
 12552                                 THRU 8586-EXIT
 12553           IF (NOT LOFC-MASTER-FOUND)
 12554              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12555              MOVE ER-3006       TO WS-ERROR
 12556              PERFORM 9900-ERROR-FORMAT
 12557                                 THRU 9900-EXIT
 12558           END-IF
 12559        END-IF
 12560     END-IF
 12561     .
 12562 3129-EDIT-APR.
 12563
 12564     IF (WS-LF-BENEFIT-CD = ZERO)
 12565        OR (NO-LF-BENEFIT-MATCH)
 12566        IF PB-COMPANY-ID NOT = 'DCC'
 12567           GO TO 3130-EDIT-AGE
 12568*       ELSE
 12569*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12570*             GO TO 3130-EDIT-AGE
 12571*          END-IF
 12572        END-IF
 12573     END-IF
 12574
 12575     IF (WS-STATE-ABBREVIATION = 'OH')
 12576         AND (PB-I-RATE-CLASS NOT = 'L ')
 12577         AND (PB-I-LF-TERM GREATER THAN 60)
 12578         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12579         GO TO 3129-APR-CONT.
 12580
 12581     IF (WS-STATE-ABBREVIATION = 'RI')
 12582         AND (PB-I-LF-TERM GREATER THAN 60)
 12583         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12584         GO TO 3129-APR-CONT.
 12585
 12586     IF (WS-STATE-ABBREVIATION = 'UT')
 12587         AND (PB-I-LF-TERM GREATER THAN 62)
 12588         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12589         AND (PB-CERT-EFF-DT LESS WS-830901)
 12590         GO TO 3129-APR-CONT.
 12591
 12592     IF PB-COMPANY-ID = 'LAP'
 12593        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12594           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12595              MOVE ER-2656         TO WS-ERROR
 12596              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12597              GO TO 3130-EDIT-AGE.
 12598
 12599     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12600        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12601        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12602        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12603        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12604        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12605         GO TO 3130-EDIT-AGE.
 12606
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 229
* EL050.cbl
 12607 3129-APR-CONT.
 12608     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12609         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12610         GO TO 3130-EDIT-AGE.
 12611
 12612     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12613         WS-AH-BENEFIT-CD (1:1) = 'S')
 12614        AND (PB-COMPANY-ID = 'DCC')
 12615        AND (PB-I-LOAN-APR = ZERO)
 12616        MOVE ER-2657             TO WS-ERROR
 12617        PERFORM 9900-ERROR-FORMAT
 12618                                 THRU 9900-EXIT
 12619        GO TO 3130-EDIT-AGE
 12620     END-IF
 12621*    IF PB-I-LOAN-APR = ZERO
 12622*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12623*    END-IF
 12624
 12625     if pb-i-loan-apr = +99.9999
 12626        move er-2656             to ws-error
 12627        PERFORM 9900-ERROR-FORMAT
 12628                                 THRU 9900-EXIT
 12629        GO TO 3130-EDIT-AGE
 12630     end-if
 12631*    IF PB-I-LOAN-APR = ZERO
 12632*       MOVE ER-2656             TO WS-ERROR
 12633*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12634*       GO TO 3130-EDIT-AGE.
 12635
 12636*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12637     if pb-i-loan-apr not = +99.9999
 12638        IF PB-I-LOAN-APR > +30.000
 12639           MOVE ER-2657          TO WS-ERROR
 12640           PERFORM 9900-ERROR-FORMAT
 12641                                 THRU 9900-EXIT
 12642        end-if
 12643     end-if
 12644     .
 12645 3130-EDIT-AGE.
 12646
 12647******************************************************************
 12648*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12649******************************************************************
 12650
 12651     IF NOT NO-LIFE-COVERAGE
 12652        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12653           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12654               MOVE ER-2628             TO WS-ERROR
 12655               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12656
 12657     IF NOT NO-AH-COVERAGE
 12658        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12659           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12660               MOVE ER-2628         TO WS-ERROR
 12661               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12662
 12663 3133-SEX-CODE.
 12664     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 230
* EL050.cbl
 12665         IF WS-DEFAULT-SEX = 'M'
 12666             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12667          ELSE
 12668             IF WS-DEFAULT-SEX = 'F'
 12669             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12670
 12671     IF PB-I-INSURED-SEX = '1'
 12672         MOVE 'M' TO PB-I-INSURED-SEX.
 12673
 12674     IF PB-I-INSURED-SEX = '2'
 12675         MOVE 'F' TO PB-I-INSURED-SEX.
 12676
 12677 3134-SIG-SW-EDIT.
 12678     IF PB-I-SIG-SW = SPACE
 12679         MOVE 'N'                TO  PB-I-SIG-SW.
 12680
 12681     IF PB-COMPANY-ID = 'NCL'
 12682         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12683             NEXT SENTENCE
 12684         ELSE
 12685             MOVE ER-1923        TO  WS-ERROR
 12686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12687     ELSE
 12688     IF PB-COMPANY-ID = 'CRI'
 12689         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12690             NEXT SENTENCE
 12691         ELSE
 12692             MOVE ER-2606        TO  WS-ERROR
 12693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12694     ELSE
 12695     IF PB-COMPANY-ID = 'TMS'
 12696         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12697             NEXT SENTENCE
 12698         ELSE
 12699             MOVE ER-2689        TO  WS-ERROR
 12700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12701     ELSE
 12702         IF PB-I-SIG-SW = 'Y' OR 'N'
 12703             NEXT SENTENCE
 12704         ELSE
 12705             MOVE ER-2651        TO  WS-ERROR
 12706             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12707
 12708     IF PB-COMPANY-ID = 'FLA'
 12709         IF (WS-EDIT-AGE GREATER 54  OR
 12710             WS-AH-EDIT-AGE GREATER 54)  AND
 12711            PB-I-SIG-SW = 'N'
 12712            MOVE ER-2651         TO  WS-ERROR
 12713            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12714
 12715 3135-NAME-EDIT.
 12716
 12717     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12718        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12719        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12720           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12721                                 TO PB-I-JOINT-FIRST-NAME
 12722        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 231
* EL050.cbl
 12723     END-IF
 12724     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12725        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12726        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12727           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12728                                 TO PB-I-JOINT-LAST-NAME
 12729        END-PERFORM
 12730     END-IF
 12731     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12732        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12733        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12734           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12735                                 TO PB-I-INSURED-FIRST-NAME
 12736        END-PERFORM
 12737     END-IF
 12738     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12739        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12740        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12741           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12742                                 TO PB-I-INSURED-LAST-NAME
 12743        END-PERFORM
 12744     END-IF
 12745     IF PB-I-INSURED-LAST-NAME = SPACES
 12746       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12747       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12748           MOVE ER-2660    TO WS-ERROR
 12749           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12750
 12751 3136-EDIT-SEX.
 12752
 12753******************************************************************
 12754*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12755******************************************************************
 12756
 12757     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12758        (WS-AH-SPECIAL-CALC-CD = 'O')
 12759        NEXT SENTENCE
 12760     ELSE
 12761        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12762           NEXT SENTENCE
 12763        ELSE
 12764           MOVE ER-2629            TO WS-ERROR
 12765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12766
 12767 3137-EDIT-EFF-DATE.
 12768
 12769     IF PB-REISSUED-CERT       OR
 12770        PB-POLICY-IS-DECLINED  OR
 12771        PB-POLICY-IS-VOIDED
 12772         GO TO 3139-EDIT-COVERAGE-CODES.
 12773
 12774     MOVE SPACE                  TO WS-2671-SW
 12775                                    WS-2672-SW.
 12776
 12777     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12778         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12779             MOVE ER-2703        TO WS-ERROR
 12780             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 232
* EL050.cbl
 12781             GO TO 3139-EDIT-COVERAGE-CODES.
 12782
 12783     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12784         GO TO 3139-EDIT-COVERAGE-CODES.
 12785
 12786     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12787     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12788*    MOVE '1'                    TO DC-OPTION-CODE.
 12789     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12790     MOVE +0                     TO DC-ELAPSED-MONTHS
 12791                                    DC-ELAPSED-DAYS.
 12792     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12793
 12794     IF DATE-CONVERSION-ERROR
 12795         GO TO 3139-EDIT-COVERAGE-CODES.
 12796
 12797     IF DC-ELAPSED-DAYS GREATER +180
 12798         MOVE ER-2672            TO WS-ERROR
 12799         MOVE 'Y'                TO WS-2672-SW
 12800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12801     END-IF
 12802
 12803     IF WS-ERROR = ER-2671  AND
 12804        PB-COMPANY-ID  = 'LBL'
 12805        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12806        MOVE SPACE               TO WS-2671-SW
 12807        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12808
 12809     IF PB-ISSUE-DATE-FORCED  AND
 12810      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12811         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12812         MOVE ER-2673            TO WS-ERROR
 12813         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12814         MOVE SPACE              TO WS-2671-SW
 12815                                    WS-2672-SW.
 12816
 12817     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12818         IF PB-ISSUE-DATE-FORCED
 12819             MOVE ER-2600          TO  WS-ERROR
 12820             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12821         ELSE
 12822             MOVE ER-2692          TO  WS-ERROR
 12823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12824
 12825
 12826 3139-EDIT-COVERAGE-CODES.
 12827
 12828     if pb-company-id not = 'AHL'
 12829        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12830           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12831           MOVE ER-2787          TO WS-ERROR
 12832           PERFORM 9900-ERROR-FORMAT
 12833                                 THRU 9900-EXIT
 12834        END-IF
 12835     end-if
 12836     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12837        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12838                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 233
* EL050.cbl
 12839           MOVE ER-2719          TO WS-ERROR
 12840           PERFORM 9900-ERROR-FORMAT
 12841                                 THRU 9900-EXIT
 12842        END-IF
 12843     END-IF
 12844
 12845     IF PB-POLICY-IS-DECLINED  OR
 12846        PB-POLICY-IS-VOIDED
 12847         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12848
 12849     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12850        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12851         MOVE ER-2630                TO WS-ERROR
 12852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12853
 12854     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12855        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12856        PB-I-LF-PREMIUM-AMT = ZERO
 12857         GO TO 3140-CHECK-AH-FOR-ZERO.
 12858
 12859     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12860        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12861        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12862         GO TO 3140-CHECK-AH-FOR-ZERO.
 12863
 12864     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12865        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12866        MOVE ER-2631             TO WS-ERROR
 12867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12868     END-IF
 12869
 12870
 12871******************************************************************
 12872*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12873******************************************************************
 12874
 12875     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12876        NEXT SENTENCE
 12877     ELSE
 12878        IF PB-I-LF-BENEFIT-AMT = ZERO
 12879           MOVE ER-2632             TO WS-ERROR
 12880           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12881
 12882
 12883******************************************************************
 12884*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12885******************************************************************
 12886
 12887     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12888        CONTINUE
 12889     ELSE
 12890        IF PB-I-LF-PREMIUM-AMT = ZERO
 12891           IF (NOT PB-COMP-LF-PREM)
 12892              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12893              and (ws-lf-ben-category not = 'C')
 12894              MOVE ER-2633       TO WS-ERROR
 12895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12896           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 234
* EL050.cbl
 12897        END-IF
 12898     END-IF
 12899     .
 12900 3140-CHECK-AH-FOR-ZERO.
 12901
 12902     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12903        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12904        PB-I-AH-PREMIUM-AMT = ZERO
 12905         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12906
 12907     IF PB-COMPANY-ID = 'CSL'  AND
 12908        PB-I-AH-BENEFIT-CD = ZERO  AND
 12909        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12910        PB-I-AH-PREMIUM-AMT = ZERO
 12911         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12912
 12913     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12914        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12915        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12916         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12917
 12918     IF PB-I-AH-BENEFIT-CD = ZERO
 12919         MOVE ER-2634            TO WS-ERROR
 12920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12921
 12922******************************************************************
 12923*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12924******************************************************************
 12925
 12926     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12927        NEXT SENTENCE
 12928     ELSE
 12929        IF PB-I-AH-BENEFIT-AMT = ZERO
 12930           MOVE ER-2635             TO WS-ERROR
 12931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12932
 12933******************************************************************
 12934*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12935******************************************************************
 12936
 12937     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12938        NEXT SENTENCE
 12939     ELSE
 12940        IF PB-I-AH-PREMIUM-AMT = ZERO
 12941            IF NOT PB-COMP-AH-PREM
 12942                MOVE ER-2636    TO WS-ERROR
 12943                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12944
 12945
 12946 3140-EDIT-MAX-AMT-SIZES.
 12947* CUSTOM CODE FOR CLIENT    'DMD'
 12948     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12949                                     WS-RES-MUNI-TAX
 12950                                     PB-I-STATE-TAX
 12951                                     PB-I-MUNI-TAX.
 12952
 12953     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12954
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 235
* EL050.cbl
 12955     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12956        GO TO 3150-RATE-OUTSTAND-BAL.
 12957
 12958     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12959        GO TO 3150-RATE-OUTSTAND-BAL.
 12960
 12961     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12962        GO TO 3150-RATE-OUTSTAND-BAL.
 12963
 12964     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12965                             OR 'RIC')
 12966        GO TO 3150-RATE-OUTSTAND-BAL.
 12967
 12968     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12969        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12970            GO TO 3150-RATE-OUTSTAND-BAL
 12971        ELSE
 12972           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12973               GO TO 3150-RATE-OUTSTAND-BAL.
 12974
 12975     IF NOT PB-NO-MONTHS-SKIPPED
 12976        GO TO 3150-RATE-OUTSTAND-BAL.
 12977
 12978     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12979        GO TO 3150-RATE-OUTSTAND-BAL.
 12980
 12981     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12982        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12983           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12984             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12985           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12986           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12987              MOVE ER-2693     TO WS-ERROR
 12988              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12989              GO TO 3150-RATE-OUTSTAND-BAL
 12990           ELSE
 12991              GO TO 3150-RATE-OUTSTAND-BAL.
 12992
 12993 3150-RATE-OUTSTAND-BAL.
 12994
 12995* DMD RATING TEST
 12996     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12997         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12998         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12999         MOVE ER-2687                 TO WS-ERROR
 13000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001         MOVE 'B'                     TO PB-I-OB-FLAG
 13002         GO TO 3260-EDIT-CONTINUE.
 13003
 13004     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13005         IF  WS-ERROR    EQUAL    ER-2693
 13006             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13007                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13008                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13009                 MOVE  +0            TO  WS-ERROR.
 13010
 13011     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13012         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 236
* EL050.cbl
 13013             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13014                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13015                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13016                 MOVE  +0            TO  WS-ERROR.
 13017
 13018     IF PLAN-MASTER-AH-SW = 'Y'
 13019        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13020            IF  WS-ERROR    EQUAL    ER-2693
 13021              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13022                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13023                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13024                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13025                 MOVE  ER-1910           TO  WS-ERROR
 13026                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13027
 13028     IF PLAN-MASTER-AH-SW = 'Y'
 13029        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13030            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13031               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13032               MOVE  ER-1910           TO  WS-ERROR
 13033               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13034
 13035     IF PLAN-MASTER-AH-SW = 'Y'
 13036        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13037            IF  WS-ERROR    EQUAL    ER-2693
 13038                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13039                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13040                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13041                 MOVE  +0       TO  WS-ERROR.
 13042
 13043     IF WS-ERROR = ER-2693
 13044        IF PB-COMPANY-ID = 'JAL' AND
 13045           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13046           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13047           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13048
 13049     IF WS-ERROR = ER-2693
 13050        IF PB-COMPANY-ID = 'NCL'  AND
 13051           PB-I-AH-BENEFIT-CD = 'OA'
 13052           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13053           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13054
 13055     IF WS-ERROR = ER-2693
 13056        IF PB-COMPANY-ID = 'CNL' AND
 13057           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13058           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13059           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13060
 13061     IF WS-ERROR = ER-2693
 13062        IF PB-COMPANY-ID = 'HER'
 13063           IF WS-LEVEL
 13064              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13065              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13066
 13067     IF ((LF-BENEFIT-FOUND) AND
 13068         (NOT NO-LIFE-COVERAGE)  AND
 13069         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13070       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 237
* EL050.cbl
 13071             (NOT NO-AH-COVERAGE)    AND
 13072             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13073         NEXT SENTENCE
 13074     ELSE
 13075         GO TO 3215-EDIT-RATES.
 13076
 13077     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13078        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13079           MOVE ER-2674          TO WS-ERROR
 13080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13081           GO TO 3215-EDIT-RATES.
 13082
 13083     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13084        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13085           MOVE ER-2674          TO WS-ERROR
 13086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13087           GO TO 3215-EDIT-RATES.
 13088
 13089     MOVE 'B'                    TO PB-I-OB-FLAG.
 13090
 13091     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13092         NEXT SENTENCE
 13093     ELSE
 13094         IF NOT NO-LIFE-COVERAGE
 13095             IF WS-ACCT-LF-OB-RT = ZERO
 13096                MOVE ER-2641    TO WS-ERROR
 13097                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13098
 13099     IF PB-COMPANY-ID = 'CRI'
 13100       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13101         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13102         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13103         IF WS-ERROR = ER-2675
 13104            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13105            MOVE ER-2687              TO WS-ERROR
 13106            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13107         ELSE
 13108            MOVE ER-2687              TO WS-ERROR
 13109            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13110
 13111
 13112     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13113         NEXT SENTENCE
 13114     ELSE
 13115       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13116            NEXT SENTENCE
 13117       ELSE
 13118         IF NOT NO-AH-COVERAGE
 13119             IF WS-ACCT-AH-OB-RT = ZERO
 13120                MOVE ER-2642    TO WS-ERROR
 13121                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13122
 13123     IF PB-COMPANY-ID = 'CRI'
 13124       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13125         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13126         IF WS-ERROR = ER-2676
 13127            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13128            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 238
* EL050.cbl
 13129            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13130         ELSE
 13131            MOVE ER-2687              TO WS-ERROR
 13132            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13133
 13134     IF PB-COMPANY-ID NOT = 'GIC'
 13135         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13136            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13137     ELSE
 13138         IF PB-I-LF-PREM-CALC = ZEROS
 13139             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13140                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13141
 13142     IF PB-COMPANY-ID NOT = 'GIC'
 13143         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13144            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13145     ELSE
 13146         IF PB-I-AH-PREM-CALC = ZEROS
 13147             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13148                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13149
 13150     MOVE ZEROS TO PB-I-MORT-CODE.
 13151
 13152     GO TO 3260-EDIT-CONTINUE.
 13153
 13154
 13155 3215-EDIT-RATES.
 13156     IF ACCOUNT-MAST-FOUND
 13157         NEXT SENTENCE
 13158     ELSE
 13159         GO TO 3999-END-EDIT.
 13160
 13161 3220-CHECK-LF-RATES.
 13162
 13163     IF PB-COMPANY-ID = 'DCC'
 13164        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13165        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13166        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13167           AND (NOT WS-LF-CASH))
 13168                           OR
 13169           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13170           AND (NOT WS-AH-CASH)))
 13171                       AND
 13172           (PB-I-ENTRY-STATUS NOT = '5')
 13173           MOVE 'M'              TO PB-BATCH-ENTRY
 13174                                    PB-I-ENTRY-STATUS
 13175        END-IF
 13176     END-IF
 13177     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13178                                    PB-I-AH-PREM-CALC
 13179                                    PB-I-LF-ALT-PREM-CALC
 13180                                    PB-I-LF-ALT-RATE
 13181                                    PB-I-LF-REI-RATE
 13182                                    PB-I-LF-ALT-REI-RATE
 13183                                    PB-I-AH-REI-RATE
 13184                                    PB-I-TOT-FEES-CALC.
 13185
 13186     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 239
* EL050.cbl
 13187        NEXT SENTENCE
 13188     ELSE
 13189        MOVE ZEROS               TO PB-I-LF-RATE
 13190                                    PB-I-AH-RATE.
 13191
 13192     IF PB-I-TOT-FEES NOT NUMERIC
 13193        MOVE ZEROS               TO PB-I-TOT-FEES
 13194     END-IF
 13195     IF PB-I-LIVES NOT NUMERIC
 13196         MOVE ZERO               TO PB-I-LIVES.
 13197
 13198     IF PB-I-NUM-BILLED NOT NUMERIC
 13199         MOVE ZERO               TO PB-I-NUM-BILLED.
 13200
 13201     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13202        MOVE +0                  TO PB-I-LF-PREM-TAX
 13203     END-IF
 13204
 13205     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13206        MOVE +0                  TO PB-I-AH-PREM-TAX
 13207     END-IF
 13208
 13209     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13210        PB-I-PAY-FREQUENCY = ZEROS
 13211            MOVE 12 TO CP-PAY-FREQUENCY
 13212     ELSE
 13213            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13214
 13215     IF PB-I-STATE-TAX NOT NUMERIC
 13216         MOVE ZEROS               TO PB-I-STATE-TAX.
 13217
 13218     IF PB-I-MUNI-TAX NOT NUMERIC
 13219         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13220
 13221     MOVE SPACES                 TO CP-BEN-CATEGORY
 13222     IF PB-COMPANY-ID  = 'CSL'  AND
 13223        PB-I-LF-TERM NOT = ZERO
 13224        COMPUTE WS-PAYMENT-AMT =
 13225             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13226        COMPUTE WS-CSL-AMT1 =
 13227             PB-I-LF-TERM * AM-MAX-MON-BEN
 13228        COMPUTE WS-CSL-AMT2 =
 13229             WS-PAYMENT-AMT * PB-I-LF-TERM
 13230        IF CP-PAY-FREQUENCY NOT = 12
 13231           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13232           MOVE '8' TO WS-CSL-CALC-CD
 13233        ELSE
 13234           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13235              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13236               AM-MAX-TOT-BEN
 13237               MOVE '6' TO WS-CSL-CALC-CD
 13238           ELSE
 13239              IF (WS-CSL-AMT1  GREATER THAN
 13240                 AM-MAX-TOT-BEN) AND
 13241                 (WS-CSL-AMT2  GREATER THAN
 13242                 AM-MAX-TOT-BEN)
 13243                 MOVE '7' TO WS-CSL-CALC-CD
 13244              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 240
* EL050.cbl
 13245                 MOVE '5' TO WS-CSL-CALC-CD.
 13246
 13247     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13248         NEXT SENTENCE
 13249     ELSE
 13250         GO TO 3300-CHECK-AH-RATES.
 13251
 13252*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13253
 13254     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13255        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13256              OR
 13257           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13258           MOVE ER-2618          TO WS-ERROR
 13259           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13260           GO TO 3300-CHECK-AH-RATES.
 13261
 13262     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13263           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13264                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13265
 13266     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13267         MOVE ER-2687             TO WS-ERROR
 13268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13269         MOVE 'Z000'              TO PB-I-MORT-CODE
 13270         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13271         GO TO 3300-CHECK-AH-RATES.
 13272
 13273     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13274        IF PB-I-LIVES = ZERO
 13275           MOVE ER-2688          TO WS-ERROR
 13276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13277
 13278     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13279
 13280     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13281     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13282     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13283     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13284     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13285     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13286     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13287     MOVE '3'                    TO CP-PROCESS-TYPE.
 13288     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13289     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13290
 13291******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13292     IF PB-COMPANY-ID EQUAL 'CDL'
 13293         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13294            CP-EARN-AS-NET-PAY)
 13295             IF PB-CERT-EFF-DT GREATER  WS-931231
 13296                 MOVE '1'        TO CP-EARNING-METHOD.
 13297*******
 13298
 13299     MOVE PB-SV-STATE            TO CP-STATE.
 13300     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13301     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13302     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 241
* EL050.cbl
 13303     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13304     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13305                                    CP-RATING-BENEFIT-AMT.
 13306     IF CP-STATE-STD-ABBRV = 'OR'
 13307         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13308                                         PB-I-LF-ALT-BENEFIT-AMT.
 13309     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13310     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13311     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13312     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13313     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13314     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13315     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13316     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13317     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13318                                    CP-REMAINING-TERM
 13319                                    CP-LOAN-TERM.
 13320
 13321     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13322         NEXT SENTENCE
 13323     ELSE
 13324         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13325             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13326                                           PB-I-LF-PREMIUM-AMT.
 13327
 13328     IF PB-COMPANY-ID EQUAL 'CSL'
 13329        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13330           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13331                                         PB-I-LF-PREMIUM-AMT.
 13332
 13333     IF PB-COMPANY-ID EQUAL 'NCB'
 13334         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13335            CP-EARN-AS-NET-PAY
 13336             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13337                 PB-I-LF-PREMIUM-AMT.
 13338
 13339     IF (CP-TRUNCATED-LIFE)
 13340        or ((pb-company-id = 'AHL')
 13341           and (pb-i-loan-term > pb-i-lf-term))
 13342        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13343
 13344     IF PB-COMPANY-ID EQUAL 'CRI'
 13345        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13346
 13347     IF CP-TERM-IS-DAYS
 13348         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13349     ELSE
 13350         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13351     IF PB-COMPANY-ID = 'DCC'
 13352        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13353        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13354        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13355        IF WS-LF-BEN-CATEGORY = 'D'
 13356           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13357           MOVE PB-I-LIFE-COMMISSION
 13358                                 TO CP-DCC-ACT-COMM
 13359           MOVE WS-LF-BEN-CATEGORY
 13360                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 242
* EL050.cbl
 13361        END-IF
 13362        IF (CP-BENEFIT-CD (1:1) = 'P')
 13363           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13364           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13365           add pb-i-ah-premium-amt to cp-original-premium
 13366        END-IF
 13367     END-IF
 13368     IF PB-COMPANY-ID = 'CSL'
 13369         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13370         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13371         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13372
 13373     IF PB-COMPANY-ID = 'CSL'
 13374        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13375
 13376     IF (CP-SPECIAL-CALC-CD = 'H')
 13377        OR (PB-COMPANY-ID = 'DCC')
 13378         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13379                                    TO CP-ALTERNATE-BENEFIT
 13380         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13381     if (pb-company-id = 'CID')
 13382        and (ws-lf-earnings-calc = '4')
 13383        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13384        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13385        move pb-i-term-type      to cp-pmt-mode
 13386        move pb-i-no-of-payments to cp-no-of-pmts
 13387     end-if
 13388     IF (PB-COMPANY-ID = 'CID')
 13389        AND (WS-LF-EARNINGS-CALC = 'B')
 13390        AND (CP-STATE-STD-ABBRV = 'MN')
 13391        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13392                                 TO CP-ALTERNATE-BENEFIT
 13393        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13394     END-IF
 13395     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13396     MOVE 'R'                   TO CP-RATE-FILE.
 13397     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13398
 13399     IF CP-ERROR-RATE-NOT-FOUND
 13400        MOVE ER-2641            TO WS-ERROR
 13401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13402        GO TO 3300-CHECK-AH-RATES.
 13403
 13404     IF PB-COMPANY-ID EQUAL 'CRI'
 13405        IF CP-ERROR-NO-LIMITS-CRI
 13406           IF NOT ACCOUNT-LIFE-CHECKED
 13407              MOVE ER-2607      TO WS-ERROR
 13408              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13409
 13410******************************************************************
 13411*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13412*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13413******************************************************************
 13414
 13415* CALC LIFE AGE AT EXPIRATION.
 13416
 13417     COMPUTE WS-AGE-AT-EXPIRE =
 13418          ((PB-I-LF-TERM / 12) + PB-I-AGE).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 243
* EL050.cbl
 13419
 13420*    IF PB-STATE = 'CO' OR 'UT'
 13421*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13422*        MOVE 'F'            TO PB-FATAL-FLAG
 13423*        MOVE ER-2709        TO WS-ERROR
 13424*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13425*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13426
 13427*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13428*        MOVE 'X'            TO PB-FATAL-FLAG
 13429*        MOVE ER-2718        TO WS-ERROR
 13430*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13431*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13432
 13433* CALC A & H AGE AT EXPIRATION.
 13434
 13435     COMPUTE WS-AGE-AT-EXPIRE =
 13436          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13437
 13438*    IF PB-STATE = 'CO' OR 'UT'
 13439*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13440*        MOVE 'F'            TO PB-FATAL-FLAG
 13441*        MOVE ER-2709        TO WS-ERROR
 13442*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13443*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13444
 13445*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13446*        MOVE 'X'            TO PB-FATAL-FLAG
 13447*        MOVE ER-2718        TO WS-ERROR
 13448*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13449*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13450
 13451     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13452        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13453
 13454     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13455        and (not pb-monthly-cert)
 13456        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13457     end-if
 13458
 13459     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13460        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13461
 13462     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13463         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13464         MOVE ER-2639        TO WS-ERROR
 13465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13466
 13467
 13468******************************************************************
 13469*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13470******************************************************************
 13471
 13472 PREMIUM-EDITING-IS-BYPASSED.
 13473     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13474        AND (CP-R-MAX-ATT-AGE > +0)
 13475        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13476        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 244
* EL050.cbl
 13477           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13478           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13479           MOVE '1'              TO DC-OPTION-CODE
 13480           PERFORM 8500-DATE-CONVERT
 13481                                 THRU 8500-EXIT
 13482           IF NO-CONVERSION-ERROR
 13483              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13484                 MOVE ER-2661       TO WS-ERROR
 13485*                PERFORM 9900-ERROR-FORMAT
 13486*                                THRU 9900-EXIT
 13487              END-IF
 13488           END-IF
 13489        ELSE
 13490           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13491           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13492              MOVE ER-2661       TO WS-ERROR
 13493*             PERFORM 9900-ERROR-FORMAT
 13494*                                THRU 9900-EXIT
 13495           ELSE
 13496              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13497                 MOVE ER-1570    TO WS-ERROR
 13498                 PERFORM 9900-ERROR-FORMAT
 13499                                 THRU 9900-EXIT
 13500              END-IF
 13501           END-IF
 13502        END-IF
 13503        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13504           MOVE PB-I-JOINT-BIRTHDAY
 13505                                 TO DC-BIN-DATE-1
 13506           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13507           MOVE '1'              TO DC-OPTION-CODE
 13508           PERFORM 8500-DATE-CONVERT
 13509                                 THRU 8500-EXIT
 13510           IF NO-CONVERSION-ERROR
 13511              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13512                 MOVE ER-2661       TO WS-ERROR
 13513*                PERFORM 9900-ERROR-FORMAT
 13514*                                THRU 9900-EXIT
 13515              END-IF
 13516           ELSE
 13517              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13518           END-IF
 13519        ELSE
 13520           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13521             (PB-I-LF-TERM / 12)
 13522           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13523              MOVE ER-2661       TO WS-ERROR
 13524*             PERFORM 9900-ERROR-FORMAT
 13525*                                THRU 9900-EXIT
 13526           ELSE
 13527              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13528                 MOVE ER-1571    TO WS-ERROR
 13529                 PERFORM 9900-ERROR-FORMAT
 13530                                 THRU 9900-EXIT
 13531              END-IF
 13532           END-IF
 13533        END-IF
 13534        IF WS-ERROR = ER-2661
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 245
* EL050.cbl
 13535           PERFORM 9900-ERROR-FORMAT
 13536                                 THRU 9900-EXIT
 13537        END-IF
 13538     END-IF
 13539*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13540*       MOVE ER-2661             TO WS-ERROR
 13541*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13542
 13543     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13544        MOVE ER-2662             TO WS-ERROR
 13545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13546
 13547     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13548        MOVE ER-2677             TO WS-ERROR
 13549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13550
 13551     IF CP-ERROR-LOAN-TERM
 13552        MOVE ER-2648             TO WS-ERROR
 13553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13554
 13555 3221-CHECK-ERROR-RATE-OPEN.
 13556
 13557     IF CP-ERROR-RATE-FILE-NOTOPEN
 13558         GO TO 3990-FILES-NOT-OPEN.
 13559
 13560     IF PB-COMPANY-ID NOT = 'DMD'
 13561        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13562     END-IF
 13563     .
 13564 3221-CONTINUE.
 13565     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13566                                    WS-DCC-AH-RATE
 13567     IF PB-COMPANY-ID = 'DCC'
 13568        IF WS-LF-BEN-CATEGORY = 'D'
 13569           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13570              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13571        END-IF
 13572     END-IF
 13573     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13574*   X'A4FF' = 12/31/2009
 13575     IF (PB-COMPANY-ID = 'CID')
 13576        AND (WS-LF-EARNINGS-CALC = 'B')
 13577        AND (CP-STATE-STD-ABBRV = 'MN')
 13578        AND (PB-CERT-EFF-DT > X'A4FF')
 13579        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13580     END-IF
 13581     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13582
 13583     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13584     IF (PB-COMPANY-ID = 'DCC')
 13585        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13586        AND (PB-I-POLICY-IS-MONTHLY)
 13587        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13588        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13589     END-IF
 13590     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13591     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13592     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 246
* EL050.cbl
 13593     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13594     IF (PB-COMPANY-ID = 'DCC')
 13595        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13596        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13597        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13598        MOVE ER-2786             TO WS-ERROR
 13599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13600     END-IF
 13601
 13602     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13603
 13604******************************************************************
 13605*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13606******************************************************************
 13607     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13608        and ((not pb-monthly-cert)
 13609        or (ws-lf-ben-category = 'C'))
 13610        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13611
 13612     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13613        GO TO 3225-CHECK-ALT-LIFE-RATE
 13614     ELSE
 13615       IF PB-I-LF-RATE = ZERO
 13616          MOVE ER-2641          TO WS-ERROR
 13617          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13618
 13619 3225-CHECK-ALT-LIFE-RATE.
 13620
 13621     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13622        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13623        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13624         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13625
 13626     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13627         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13628             AND PB-COMPANY-ID NOT = 'DCC')
 13629                   OR
 13630              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13631              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13632              AND PB-COMPANY-ID NOT = 'DCC')
 13633             MOVE ER-2720        TO  WS-ERROR
 13634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13635             GO TO 3225-RATING-CONT
 13636         ELSE
 13637             GO TO 3225-RATING-CONT.
 13638     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13639        AND (AM-GPCD = 01 OR 06 OR 15)
 13640        MOVE ER-2798             TO WS-ERROR
 13641        PERFORM 9900-ERROR-FORMAT
 13642                                 THRU 9900-EXIT
 13643*       GO TO 3225-RATING-CONT
 13644     END-IF
 13645     IF (PB-COMPANY-ID = 'CID')
 13646        AND (WS-LF-EARNINGS-CALC = 'B')
 13647        AND (CP-STATE-STD-ABBRV = 'MN')
 13648        AND (PB-CERT-EFF-DT > X'A4FF')
 13649        GO TO 3225-RATING-CONT
 13650     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 247
* EL050.cbl
 13651     IF PB-COMPANY-ID = 'DCC'
 13652        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13653           AND (PB-I-POLICY-IS-MONTHLY)
 13654           GO TO 3225-RATING-CONT
 13655        END-IF
 13656     END-IF
 13657
 13658     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13659        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13660        CP-EARN-AS-REG-BALLOON
 13661        NEXT SENTENCE
 13662     ELSE
 13663        MOVE '2'                 TO CP-EARNING-METHOD.
 13664
 13665 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13666
 13667     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13668
 13669     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13670        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13671        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13672         NEXT SENTENCE
 13673     ELSE
 13674         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13675
 13676     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13677     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13678     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13679                                     CP-RATING-BENEFIT-AMT.
 13680     IF CP-STATE-STD-ABBRV = 'OR'
 13681         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13682                                         PB-I-LF-ALT-BENEFIT-AMT.
 13683     IF PB-COMPANY-ID = 'DCC'
 13684        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13685     END-IF
 13686     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13687     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13688     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13689                                    CP-REMAINING-TERM
 13690                                    CP-LOAN-TERM.
 13691     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13692        ADD +1                   TO CP-ORIGINAL-TERM
 13693                                    CP-REMAINING-TERM
 13694                                    CP-LOAN-TERM.
 13695
 13696     MOVE 'R'                   TO CP-RATE-FILE.
 13697     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13698
 13699     IF CP-ERROR-RATE-NOT-FOUND
 13700         MOVE ER-2641            TO WS-ERROR
 13701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13702         GO TO 3300-CHECK-AH-RATES.
 13703
 13704     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13705     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13706
 13707     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13708         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 248
* EL050.cbl
 13709
 13710     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13711                               + PB-I-LF-ALT-BENEFIT-AMT.
 13712
 13713     IF ACCOUNT-LIFE-CHECKED  OR
 13714        PB-POLICY-IS-VOIDED   OR
 13715        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13716        and (not pb-monthly-cert))
 13717        GO TO 3225-CONTINUE.
 13718
 13719     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13720        GO TO 3225-CONTINUE.
 13721
 13722     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13723                             EC-RT-LF-MAX-TOT-BEN
 13724        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13725        MOVE ER-2639       TO WS-ERROR
 13726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13727
 13728 3225-CONTINUE.
 13729     IF PB-I-LF-ALT-RATE = ZERO
 13730         MOVE ER-2659            TO WS-ERROR
 13731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13732
 13733     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13734        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13735        MOVE ER-2698             TO WS-ERROR
 13736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13737
 13738 3225-RATING-CONT.
 13739
 13740     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13741        and (not pb-monthly-cert)
 13742         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13743         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13744         IF (PB-COMPANY-ID = 'DCC')
 13745            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13746            CONTINUE
 13747         ELSE
 13748            MOVE ER-2687         TO WS-ERROR
 13749            PERFORM 9900-ERROR-FORMAT
 13750                                 THRU 9900-EXIT
 13751         END-IF
 13752         GO TO 3290-EDIT-LF-REIN-RATE
 13753     END-IF
 13754
 13755* DMD RATING TEST
 13756     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13757         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13758         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13759         MOVE ER-2687                 TO WS-ERROR
 13760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13761         GO TO 3290-EDIT-LF-REIN-RATE.
 13762
 13763 3230-CLIENT-MORT-CD-SPECIALS.
 13764
 13765     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13766     SET BIN-TO-GREG          TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 249
* EL050.cbl
 13767*    MOVE ' '                 TO DC-OPTION-CODE.
 13768     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13769     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13770
 13771 C-POS-3230-MORT-CD.
 13772     IF PB-COMPANY-ID = 'POS' AND
 13773        PB-SV-CARRIER = '2'
 13774         NEXT SENTENCE
 13775     ELSE
 13776         GO TO C-POS-3240-MORT-CD.
 13777
 13778     IF PB-SV-GROUPING = '030'
 13779        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13780         MOVE '2350' TO PB-I-MORT-CODE
 13781      ELSE
 13782         MOVE '3300' TO PB-I-MORT-CODE.
 13783
 13784
 13785 C-POS-3240-MORT-CD.
 13786     IF PB-COMPANY-ID = 'POS' AND
 13787        PB-SV-CARRIER = '1'
 13788         NEXT SENTENCE
 13789     ELSE
 13790         GO TO 3230-CONTINUE.
 13791
 13792     IF PB-SV-STATE = '45' OR '47'
 13793        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13794         MOVE '5200' TO PB-I-MORT-CODE
 13795     ELSE
 13796         MOVE '8300' TO PB-I-MORT-CODE.
 13797
 13798 3230-CONTINUE.
 13799
 13800     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13801        GO TO 3240-CONTINUE
 13802     END-IF
 13803
 13804     IF PB-CERT-EFF-DT > WS-971231
 13805        GO TO 3240-CONTINUE
 13806     END-IF
 13807
 13808     IF LF-BENEFIT-FOUND AND
 13809        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13810         MOVE 'F250'       TO PB-I-MORT-CODE
 13811     ELSE
 13812         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13813             MOVE '7250'   TO PB-I-MORT-CODE
 13814         ELSE
 13815             MOVE '4251'   TO PB-I-MORT-CODE
 13816         END-IF
 13817     END-IF
 13818
 13819     .
 13820 3240-CONTINUE.
 13821
 13822     IF PB-COMPANY-ID NOT = 'GNL'
 13823         GO TO 3256-CONTINUE.
 13824
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 250
* EL050.cbl
 13825     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13826         MOVE 'A300' TO PB-I-MORT-CODE
 13827     ELSE
 13828         MOVE '8350' TO PB-I-MORT-CODE.
 13829
 13830 3256-CONTINUE.
 13831     IF PB-COMPANY-ID NOT = 'ABL'
 13832         GO TO 3260-EDIT-CONTINUE.
 13833
 13834     IF PB-I-LF-TERM GREATER THAN 59
 13835         MOVE 'F550' TO PB-I-MORT-CODE
 13836     ELSE
 13837         MOVE 'E550' TO PB-I-MORT-CODE.
 13838
 13839 3260-EDIT-CONTINUE.
 13840     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13841
 13842 3290-EDIT-LF-REIN-RATE.
 13843     IF LF-REIN-NSP-NOT-USED
 13844         GO TO 3290-RATING-CONT.
 13845
 13846     IF PB-COMPANY-ID = 'DCC'
 13847        GO TO 3290-RATING-CONT.
 13848     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13849     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13850     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13851     MOVE '3'                   TO CP-PROCESS-TYPE.
 13852     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13853
 13854******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13855     IF PB-COMPANY-ID EQUAL 'CDL'
 13856         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13857            CP-EARN-AS-NET-PAY)
 13858             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13859*            MOVE SPACE          TO DC-OPTION-CODE
 13860             SET BIN-TO-GREG     TO TRUE
 13861             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13862***  Y2K PROJ 7744
 13863             IF DC-GREG-DATE-CYMD GREATER 19931231
 13864                 MOVE '1'        TO CP-EARNING-METHOD.
 13865***  Y2K PROJ 7744
 13866*******
 13867
 13868     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13869     MOVE PB-SV-STATE           TO CP-STATE.
 13870     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13871     MOVE ZERO                  TO CP-DEVIATION-CODE
 13872                                   CP-RATE-DEV-PCT.
 13873     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13874     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13875                                   CP-RATING-BENEFIT-AMT.
 13876
 13877************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13878     IF PB-COMPANY-ID EQUAL 'NCB'
 13879         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13880            CP-EARN-AS-NET-PAY
 13881             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13882                 PB-I-LF-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 251
* EL050.cbl
 13883************
 13884
 13885     IF CP-STATE-STD-ABBRV = 'OR'
 13886         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13887                                         PB-I-LF-ALT-BENEFIT-AMT.
 13888     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13889     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13890     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13891     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13892     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13893     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13894     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13895     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13896                                   CP-REMAINING-TERM
 13897                                   CP-LOAN-TERM.
 13898     IF CP-TRUNCATED-LIFE
 13899        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13900
 13901     IF CP-TERM-IS-DAYS
 13902         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13903     ELSE
 13904         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13905
 13906     IF PB-COMPANY-ID = 'DCC'
 13907        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13908     END-IF
 13909     IF PB-COMPANY-ID NOT = 'TIC'
 13910          MOVE ZERO          TO CP-CLASS-CODE.
 13911
 13912     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13913
 13914     MOVE 'R'                   TO CP-RATE-FILE.
 13915     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13916
 13917     IF CP-ERROR-RATE-NOT-FOUND
 13918        IF PB-I-OB
 13919           MOVE ER-2625      TO WS-ERROR
 13920           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13921           GO TO 3299-EDIT-CONTINUE
 13922        ELSE
 13923           MOVE ER-2643      TO WS-ERROR
 13924           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13925           GO TO 3299-EDIT-CONTINUE.
 13926
 13927     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13928
 13929     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13930     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13931
 13932     IF PB-I-LF-REI-RATE = ZERO
 13933         MOVE ER-2643        TO WS-ERROR
 13934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13935
 13936 3290-CHECK-ALT-REIN-RATE.
 13937
 13938     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13939        GO TO 3290-RATING-CONT.
 13940
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 252
* EL050.cbl
 13941     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13942     MOVE '2'                    TO CP-EARNING-METHOD.
 13943     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13944     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13945     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13946     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13947                                     CP-RATING-BENEFIT-AMT.
 13948     IF CP-STATE-STD-ABBRV = 'OR'
 13949         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13950                                         PB-I-LF-ALT-BENEFIT-AMT.
 13951     IF PB-COMPANY-ID = 'DCC'
 13952        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13953     END-IF
 13954     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13955     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13956     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13957                                    CP-REMAINING-TERM
 13958                                    CP-LOAN-TERM.
 13959     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13960        ADD +1                   TO CP-ORIGINAL-TERM
 13961                                    CP-REMAINING-TERM
 13962                                    CP-LOAN-TERM.
 13963
 13964     MOVE 'R'                   TO CP-RATE-FILE.
 13965     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13966
 13967     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13968
 13969     IF PB-I-LF-ALT-REI-RATE = ZERO
 13970         MOVE ER-2643            TO WS-ERROR
 13971         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13972
 13973 3290-RATING-CONT.
 13974
 13975     IF PB-I-OB
 13976*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13977        GO TO 3300-CHECK-AH-RATES.
 13978
 13979 3299-EDIT-CONTINUE.
 13980
 13981     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13982         NEXT SENTENCE
 13983     ELSE
 13984         MOVE ER-2620           TO WS-ERROR
 13985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13986
 13987 3300-CHECK-AH-RATES.
 13988     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13989         NEXT SENTENCE
 13990     ELSE
 13991         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13992
 13993     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 13994        and (not pb-monthly-cert))
 13995                  or
 13996        ((CF-COMPANY-ID = 'DMD') AND
 13997                (NO-DMD-RATING))
 13998         IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 253
* EL050.cbl
 13999            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14000            CONTINUE
 14001         ELSE
 14002            MOVE ER-2687         TO WS-ERROR
 14003            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14004         END-IF
 14005         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14006         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14007     END-IF
 14008
 14009     IF PB-I-OB
 14010        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14011
 14012     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14013         MOVE ER-2687             TO WS-ERROR
 14014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14015         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14016         GO TO 3999-END-EDIT.
 14017
 14018*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14019     if pb-company-id = 'AHL'
 14020        go to 3300-skip-crit-per
 14021     end-if
 14022     if (pb-i-ah-crit-per not = zeros)
 14023        and (ws-ah-special-calc-cd not = 'C')
 14024        MOVE ER-1572             TO WS-ERROR
 14025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14026        go to 3300-skip-crit-per
 14027     END-IF
 14028     if (pb-company-id = 'DCC')
 14029        and (am-dcc-product-code not = spaces)
 14030        go to 3300-skip-crit-per
 14031     end-if
 14032     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14033        IF PB-I-AH-CRIT-PER = ZERO
 14034           move ws-ah-max-bens   to pb-i-ah-crit-per
 14035*          MOVE ER-2618       TO WS-ERROR
 14036*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14037*          GO TO 3999-END-EDIT
 14038        END-IF
 14039     END-IF
 14040     if (ws-ah-special-calc-cd = 'C')
 14041        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14042        MOVE ER-1576             TO WS-ERROR
 14043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14044     end-if
 14045
 14046     .
 14047 3300-skip-crit-per.
 14048     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14049     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14050     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14051     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14052     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14053     MOVE PB-SV-STATE            TO CP-STATE.
 14054     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14055     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14056     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 254
* EL050.cbl
 14057*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14058     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14059     MOVE '3'                    TO CP-PROCESS-TYPE.
 14060     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14061     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14062                                    CP-RATING-BENEFIT-AMT.
 14063     IF PB-COMPANY-ID = 'CID'
 14064               OR
 14065        CP-STATE-STD-ABBRV = 'OR'
 14066         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14067                                         PB-I-AH-TERM.
 14068     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14069        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14070           AND (PB-I-POLICY-IS-MONTHLY)
 14071           MOVE PB-I-LF-BENEFIT-AMT
 14072                                 TO CP-NET-BENEFIT-AMT
 14073           move pb-i-ah-premium-amt to cp-original-premium
 14074           add pb-i-lf-premium-amt to cp-original-premium
 14075        END-IF
 14076     END-IF
 14077     MOVE SPACES                 TO CP-BEN-CATEGORY
 14078     IF PB-COMPANY-ID = 'DCC'
 14079        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14080        EVALUATE TRUE
 14081           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14082              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14083              MOVE PB-I-LF-BENEFIT-AMT
 14084                                 TO CP-RATING-BENEFIT-AMT
 14085              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14086           WHEN WS-AH-BEN-CATEGORY = 'G'
 14087              MOVE PB-I-UNPAID-CASH-PRICE
 14088                                 TO CP-RATING-BENEFIT-AMT
 14089           WHEN WS-AH-BEN-CATEGORY = 'D'
 14090              MOVE WS-AH-PMF-COMM
 14091                                 TO CP-DCC-PMF-COMM
 14092              MOVE PB-I-AH-COMMISSION
 14093                                 TO CP-DCC-ACT-COMM
 14094        END-EVALUATE
 14095     END-IF
 14096     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14097     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14098     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14099     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14100     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14101     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14102     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14103                                    CP-REMAINING-TERM
 14104                                    WS-WORK-TERM.
 14105     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14106
 14107     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14108     SET BIN-TO-GREG             TO TRUE.
 14109*    MOVE ' '                    TO DC-OPTION-CODE.
 14110     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14111     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14112
 14113     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14114     IF NOT VALID-SKIP-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 255
* EL050.cbl
 14115         MOVE ER-2683            TO WS-ERROR
 14116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14117         GO TO 3320-RATE-CONTINUE.
 14118
 14119     IF PB-NO-MONTHS-SKIPPED
 14120         GO TO 3320-RATE-CONTINUE.
 14121
 14122     MOVE SPACE TO NUMBER-OF-MONTHS.
 14123
 14124     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14125         MOVE 'S'                TO SK-MO (6).
 14126     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14127         MOVE 'S'                TO SK-MO (7).
 14128     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14129         MOVE 'S'                TO SK-MO (8).
 14130     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14131         MOVE 'S'                TO SK-MO (9).
 14132     IF PB-I-SKIP-CODE = 'A'
 14133         MOVE 'S'                TO SK-MO (10).
 14134
 14135     MOVE 1                      TO SUB2.
 14136     MOVE PB-I-AH-TERM           TO SUB3.
 14137     MOVE WS-MONTH               TO SUB1.
 14138     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14139     GO TO 3320-RATE-CONTINUE.
 14140
 14141 3310-GET-SKIP-MO.
 14142     IF SUB1 = 13
 14143         MOVE 1                  TO SUB1.
 14144
 14145     IF SK-MO (SUB1) = 'S'
 14146         SUBTRACT 1 FROM WS-WORK-TERM.
 14147
 14148     ADD 1 TO SUB2
 14149              SUB1.
 14150
 14151 3320-RATE-CONTINUE.
 14152
 14153     IF WS-WORK-TERM = ZERO
 14154         MOVE 1                  TO WS-WORK-TERM.
 14155
 14156     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14157                                    CP-LOAN-TERM.
 14158
 14159     IF PB-COMPANY-ID EQUAL 'DMD'
 14160         NEXT SENTENCE
 14161     ELSE
 14162         MOVE ZERO               TO PB-I-AH-RATE
 14163                                    PB-I-AH-REI-RATE.
 14164
 14165
 14166     IF PB-COMPANY-ID EQUAL 'CRI'
 14167        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14168
 14169     IF PB-COMPANY-ID = 'CSL'
 14170         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14171         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14172         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 256
* EL050.cbl
 14173         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14174
 14175     IF PB-COMPANY-ID = 'DCC'
 14176        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14177           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14178              PB-I-RATE-DEV-PCT-LF
 14179        END-IF
 14180        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14181                                 TO CP-ALTERNATE-BENEFIT
 14182        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14183        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14184        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14185     END-IF
 14186     IF (PB-COMPANY-ID = 'CID')
 14187        AND (WS-LF-EARNINGS-CALC = 'B')
 14188        AND (CP-STATE-STD-ABBRV = 'MN')
 14189        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14190     ELSE
 14191        MOVE ' '                 TO CP-AH-BALLOON-SW
 14192     END-IF
 14193     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14194     MOVE 'R'                   TO CP-RATE-FILE.
 14195     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14196
 14197     IF (CP-ERROR-RATE-NOT-FOUND)
 14198        and (not pb-monthly-cert)
 14199        IF PB-I-OB
 14200           MOVE ER-2624          TO WS-ERROR
 14201           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14202           GO TO 3340-CALCULATE-PREMIUM-AMT
 14203        ELSE
 14204          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14205              NEXT SENTENCE
 14206          ELSE
 14207           MOVE ER-2642          TO WS-ERROR
 14208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14209           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14210
 14211     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14212        CP-ERROR-DIV-BY-ZERO
 14213           MOVE ER-3782          TO WS-ERROR
 14214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14215
 14216     IF PB-COMPANY-ID EQUAL 'CRI'
 14217        IF CP-ERROR-NO-LIMITS-CRI
 14218           IF NOT ACCOUNT-AH-CHECKED
 14219              MOVE ER-2607          TO WS-ERROR
 14220              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14221
 14222     IF ACCOUNT-AH-CHECKED
 14223        NEXT SENTENCE
 14224     ELSE
 14225       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14226          MOVE ER-2640           TO WS-ERROR
 14227          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14228
 14229     IF PB-COMPANY-ID = 'CRI'
 14230         IF WS-ERROR = ER-2640
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 257
* EL050.cbl
 14231             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14232     IF ACCOUNT-AH-CHECKED
 14233        CONTINUE
 14234     ELSE
 14235        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14236           AND (CP-R-MAX-ATT-AGE > +0)
 14237           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14238           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14239              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14240              MOVE PB-I-AH-EXPIRE-DT
 14241                                 TO DC-BIN-DATE-2
 14242              MOVE '1'           TO DC-OPTION-CODE
 14243              PERFORM 8500-DATE-CONVERT
 14244                                 THRU 8500-EXIT
 14245              IF NO-CONVERSION-ERROR
 14246                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14247                    MOVE ER-2661       TO WS-ERROR
 14248*                   PERFORM 9900-ERROR-FORMAT
 14249*                                THRU 9900-EXIT
 14250                 END-IF
 14251              END-IF
 14252           ELSE
 14253              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14254              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14255                 MOVE ER-2661    TO WS-ERROR
 14256*                PERFORM 9900-ERROR-FORMAT
 14257*                                THRU 9900-EXIT
 14258              ELSE
 14259                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14260                    MOVE ER-1570 TO WS-ERROR
 14261                    PERFORM 9900-ERROR-FORMAT
 14262                                 THRU 9900-EXIT
 14263                 END-IF
 14264              END-IF
 14265           END-IF
 14266           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14267              MOVE PB-I-JOINT-BIRTHDAY
 14268                                    TO DC-BIN-DATE-1
 14269              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14270              MOVE '1'              TO DC-OPTION-CODE
 14271              PERFORM 8500-DATE-CONVERT
 14272                                    THRU 8500-EXIT
 14273              IF NO-CONVERSION-ERROR
 14274                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14275                    MOVE ER-2661       TO WS-ERROR
 14276*                   PERFORM 9900-ERROR-FORMAT
 14277*                                   THRU 9900-EXIT
 14278                 END-IF
 14279              END-IF
 14280           ELSE
 14281              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14282                (PB-I-AH-TERM / 12)
 14283              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14284                 MOVE ER-2661       TO WS-ERROR
 14285*                PERFORM 9900-ERROR-FORMAT
 14286*                                   THRU 9900-EXIT
 14287              ELSE
 14288                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 258
* EL050.cbl
 14289                    MOVE ER-1571 TO WS-ERROR
 14290                    PERFORM 9900-ERROR-FORMAT
 14291                                 THRU 9900-EXIT
 14292                 END-IF
 14293              END-IF
 14294           END-IF
 14295           IF WS-ERROR = ER-2661
 14296              PERFORM 9900-ERROR-FORMAT
 14297                                    THRU 9900-EXIT
 14298           END-IF
 14299        END-IF
 14300     END-IF
 14301*    IF ACCOUNT-AH-CHECKED
 14302*       NEXT SENTENCE
 14303*    ELSE
 14304*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14305*          MOVE ER-2661          TO WS-ERROR
 14306*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14307
 14308     IF ACCOUNT-AH-CHECKED
 14309        NEXT SENTENCE
 14310     ELSE
 14311        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14312           MOVE ER-2663          TO WS-ERROR
 14313           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     IF ACCOUNT-AH-CHECKED OR
 14316        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14317         PB-POLICY-IS-VOIDED
 14318        NEXT SENTENCE
 14319     ELSE
 14320        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14321           MOVE ER-2667            TO WS-ERROR
 14322           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14323
 14324     IF PB-COMPANY-ID = 'CRI'
 14325         IF WS-ERROR = ER-2667
 14326             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14327
 14328     IF ACCOUNT-AH-CHECKED
 14329        NEXT SENTENCE
 14330     ELSE
 14331        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14332           MOVE ER-2678            TO WS-ERROR
 14333           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14334
 14335     IF CP-ERROR-RATE-FILE-NOTOPEN
 14336         GO TO 3990-FILES-NOT-OPEN.
 14337
 14338 3321-CONTINUE.
 14339     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14340     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14341     IF (PB-COMPANY-ID = 'DCC')
 14342        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14343        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14344                                    PB-I-LF-ALT-PREM-CALC
 14345        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14346        IF WS-AH-BEN-CATEGORY = 'G'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 259
* EL050.cbl
 14347           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14348           + PB-I-ADDL-CLP)
 14349           * (1 + WS-TOL-CLP-PCT)
 14350*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14351        ELSE
 14352           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14353           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14354*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14355        END-IF
 14356        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14357                                 TO PB-I-AH-PREM-CALC
 14358        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14359           MOVE ER-8152          TO WS-ERROR
 14360           PERFORM 9900-ERROR-FORMAT
 14361                                 THRU 9900-EXIT
 14362        ELSE
 14363           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14364                 PB-I-ADDL-CLP)
 14365              MOVE ER-8148       TO WS-ERROR
 14366              PERFORM 9900-ERROR-FORMAT
 14367                                 THRU 9900-EXIT
 14368           END-IF
 14369        END-IF
 14370     END-IF
 14371     IF (PB-COMPANY-ID = 'DCC')
 14372        AND (PB-I-POLICY-IS-MONTHLY)
 14373        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14374        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14375        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14376           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14377        END-IF
 14378     END-IF
 14379     IF (PB-COMPANY-ID = 'DCC')
 14380        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14381        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14382        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14383        MOVE ER-2786             TO WS-ERROR
 14384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14385     END-IF
 14386     MOVE +0                     TO PB-I-AH-CLP
 14387     IF PB-COMPANY-ID = 'DCC'
 14388        evaluate true
 14389           when WS-AH-BEN-CATEGORY = 'D'
 14390              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14391                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14392           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14393              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14394           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14395              compute ws-cred-union-fees rounded =
 14396                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14397                    pb-i-ah-commission)
 14398              COMPUTE PB-I-AH-CLP =
 14399                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14400        end-evaluate
 14401     END-IF
 14402     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14403
 14404     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 260
* EL050.cbl
 14405         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14406
 14407     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14408         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14409
 14410     if (ws-ah-special-calc-cd = 'E')
 14411        and (pb-monthly-cert)
 14412        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14413     end-if
 14414     IF PB-COMPANY-ID = 'CRI'
 14415         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14416            PB-I-PAYMENT-AMOUNT = ZERO
 14417             NEXT SENTENCE
 14418         ELSE
 14419             COMPUTE PB-I-AH-PREM-CALC =
 14420                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14421                 (CP-PREMIUM-RATE / 100)
 14422             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14423                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14424                                             PB-I-RATE-DEV-PCT-AH.
 14425
 14426     IF (PB-I-AH-RATE  = ZERO)
 14427        and (not pb-monthly-cert)
 14428       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14429           NEXT SENTENCE
 14430       ELSE
 14431         MOVE ER-2642            TO WS-ERROR
 14432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14433
 14434     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14435     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14436     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14437     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14438     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14439     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14440
 14441     IF (PB-COMPANY-ID = 'DCC')
 14442        AND (WS-AH-BEN-CATEGORY = 'G')
 14443        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14444        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14445        IF CP-DEVIATION-CODE NOT = '000'
 14446           MOVE '000'            TO CP-DEVIATION-CODE
 14447           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14448           IF NO-CP-ERROR
 14449              COMPUTE PB-I-DDF-IU-RATE-UP =
 14450              PB-I-AH-CLP - CP-CALC-PREMIUM
 14451           ELSE
 14452              MOVE ER-3057        TO WS-ERROR
 14453              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14454           END-IF
 14455        END-IF
 14456     END-IF
 14457     .
 14458 3335-EDIT-AH-REIN-NSP-RATE.
 14459     IF PB-COMPANY-ID = 'DCC'
 14460        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14461              compute ws-cred-union-fees rounded =
 14462                 ws-cred-union-fees + (pb-i-ah-premium-amt *
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 261
* EL050.cbl
 14463                    pb-i-ah-commission)
 14464              COMPUTE PB-I-AH-CLP =
 14465                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14466        end-if
 14467     END-IF
 14468     IF AH-REIN-NSP-NOT-USED
 14469         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14470
 14471     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14472     IF PB-COMPANY-ID = 'DCC'
 14473         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14474     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14475     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14476     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14477     MOVE PB-SV-STATE            TO CP-STATE.
 14478     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14479     MOVE ZERO                   TO CP-DEVIATION-CODE
 14480                                    CP-RATE-DEV-PCT.
 14481*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14482     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14483     MOVE '3'                    TO CP-PROCESS-TYPE.
 14484     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14485     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14486                                    CP-RATING-BENEFIT-AMT.
 14487     IF CP-STATE-STD-ABBRV = 'OR'
 14488         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14489                                         PB-I-AH-TERM.
 14490     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14491     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14492     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14493     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14494     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14495     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14496                                    CP-REMAINING-TERM
 14497                                    WS-WORK-TERM.
 14498     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14499     IF PB-COMPANY-ID = 'DCC'
 14500        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14501     END-IF
 14502     IF  PB-COMPANY-ID = 'TIC'
 14503         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14504            MOVE ZERO TO CP-CLASS-CODE.
 14505
 14506     IF PB-COMPANY-ID NOT = 'TIC'
 14507          MOVE ZERO          TO CP-CLASS-CODE.
 14508
 14509     MOVE ZERO               TO CP-DEVIATION-CODE.
 14510
 14511     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14512
 14513     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14514
 14515     MOVE 'R'                   TO CP-RATE-FILE.
 14516     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14517
 14518     IF CP-ERROR-RATE-NOT-FOUND
 14519         MOVE ER-2645        TO WS-ERROR
 14520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 262
* EL050.cbl
 14521         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14522
 14523     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14524
 14525     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14526     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14527
 14528     IF PB-I-AH-REI-RATE = ZERO
 14529         MOVE ER-2645        TO WS-ERROR
 14530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14531
 14532
 14533 3340-CALCULATE-PREMIUM-AMT.
 14534
 14535     IF PB-COMPANY-ID = 'NCL'
 14536         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14537             WS-AH-SPECIAL-CALC-CD = 'O')
 14538             GO TO 3999-END-EDIT.
 14539
 14540     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14541                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14542                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14543                         OR 'AHL'
 14544         NEXT SENTENCE
 14545     ELSE
 14546         IF WS-STATE-ABBREVIATION = 'CT'
 14547             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14548                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14549                 COMPUTE PB-I-LF-PREM-CALC =
 14550                                     PB-I-LF-PREM-CALC * .90
 14551                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14552                                     PB-I-LF-ALT-PREM-CALC * .90
 14553                 COMPUTE PB-I-AH-PREM-CALC =
 14554                                     PB-I-AH-PREM-CALC * .90.
 14555
 14556     IF PB-COMP-LF-PREM
 14557        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14558        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14559
 14560     IF PB-COMP-AH-PREM
 14561        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14562
 14563 3340-CHECK-DCC-TOT-FEES.
 14564     IF (PB-COMPANY-ID = 'DCC')
 14565        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14566        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14567        AND (PB-I-POLICY-IS-MONTHLY)
 14568        CONTINUE
 14569     ELSE
 14570        GO TO 3340-EDIT-LF-AH-TOL
 14571     END-IF
 14572     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14573     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14574     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14575        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14576           PB-I-RATE-DEV-PCT-LF
 14577     END-IF
 14578     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 263
* EL050.cbl
 14579        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14580           PB-I-RATE-DEV-PCT-AH
 14581     END-IF
 14582     MOVE 'N'                    TO CP-BEN-CATEGORY
 14583     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14584
 14585     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14586     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14587     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14588     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14589     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14590     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14591     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14592     MOVE '3'                    TO CP-PROCESS-TYPE.
 14593     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14594     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14595
 14596     MOVE PB-SV-STATE            TO CP-STATE.
 14597     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14598     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14599     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14600     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14601     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14602                                    CP-RATING-BENEFIT-AMT.
 14603     IF CP-STATE-STD-ABBRV = 'OR'
 14604         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14605                                         PB-I-LF-ALT-BENEFIT-AMT.
 14606     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14607     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14608     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14609     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14610     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14611     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14612     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14613     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14614     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14615                                    CP-REMAINING-TERM
 14616                                    CP-LOAN-TERM.
 14617     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14618        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14619           PB-I-LF-PREMIUM-AMT
 14620     end-if
 14621
 14622     IF CP-TRUNCATED-LIFE
 14623        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14624
 14625     IF CP-TERM-IS-DAYS
 14626         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14627     ELSE
 14628         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14629
 14630     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14631     IF CP-SPECIAL-CALC-CD = 'H'
 14632         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14633                                    TO CP-ALTERNATE-BENEFIT
 14634         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14635     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14636     MOVE 'R'                    TO CP-RATE-FILE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 264
* EL050.cbl
 14637     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14638     IF NOT CP-ERROR-RATE-NOT-FOUND
 14639        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14640        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14641           AND (CP-BENEFIT-CD (1:1) = 'S')
 14642           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14643                                    PB-I-LF-PREMIUM-AMT
 14644        END-IF
 14645     ELSE
 14646        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14647     END-IF
 14648     .
 14649 3340-EDIT-LF-AH-TOL.
 14650
 14651***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14652***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14653***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14654***
 14655     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14656         PB-I-AH-PREMIUM-AMT
 14657          GIVING WS-CALC-WORK.
 14658
 14659     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14660        AND WS-CALC-WORK NOT = ZERO
 14661         MOVE ER-2649            TO WS-ERROR
 14662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14663
 14664     SUBTRACT PB-I-LF-PREM-CALC
 14665             FROM PB-I-LF-PREMIUM-AMT
 14666                 GIVING WS-UNSIGN-WRK1.
 14667
 14668     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14669             FROM PB-I-LF-ALT-PREMIUM-AMT
 14670                 GIVING WS-UNSIGN-WRK4.
 14671
 14672     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14673                                + WS-UNSIGN-WRK4.
 14674
 14675     SUBTRACT PB-I-AH-PREM-CALC
 14676             FROM PB-I-AH-PREMIUM-AMT
 14677                 GIVING WS-UNSIGN-WRK2.
 14678
 14679******************************************************************
 14680*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14681******************************************************************
 14682
 14683     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14684         MOVE ZERO TO WS-UNSIGN-WRK1.
 14685
 14686     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14687         MOVE ZERO TO WS-UNSIGN-WRK2.
 14688
 14689     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14690             GIVING WS-UNSIGN-WRK3.
 14691
 14692 3342-CONTINUE.
 14693
 14694     IF (PB-I-LF-RATE = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 265
* EL050.cbl
 14695         PB-I-AH-RATE = ZERO)
 14696         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14697            WS-AH-SPECIAL-CALC-CD = 'O'
 14698              NEXT SENTENCE
 14699         ELSE
 14700             GO TO 3345-EDIT-CONTINUE.
 14701
 14702     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14703         NEXT SENTENCE
 14704     ELSE
 14705     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14706        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14707           IF (PB-REISSUED-CERT         OR
 14708               PB-POLICY-IS-DECLINED    OR
 14709               PB-POLICY-IS-VOIDED)
 14710              NEXT SENTENCE
 14711           ELSE
 14712              IF WS-PREM-REJECT-SW = SPACE
 14713                 MOVE ER-2652    TO WS-ERROR
 14714                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14715                 GO TO 3344-CHECK-AH
 14716              ELSE
 14717                 MOVE ER-2650    TO WS-ERROR
 14718                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14719                 GO TO 3344-CHECK-AH.
 14720
 14721***
 14722***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14723***
 14724
 14725     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14726         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14727            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14728             (1 + WS-TOL-LF-PREM-PCT)
 14729         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14730            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14731             (1 - WS-TOL-LF-PREM-PCT)
 14732     ELSE
 14733         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14734         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14735
 14736***
 14737***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14738***
 14739
 14740     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14741         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14742          WS-TOL-LF-PREM.
 14743
 14744     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14745         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14746          WS-TOL-LF-PREM.
 14747
 14748     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14749        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14750
 14751     IF PB-REISSUED-CERT
 14752        or PB-POLICY-IS-DECLINED
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 266
* EL050.cbl
 14753        or PB-POLICY-IS-VOIDED
 14754        continue
 14755     ELSE
 14756        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14757              > WS-TOL-LF-HIGH-PREM-AMT)
 14758           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14759              < WS-TOL-LF-LOW-PREM-AMT))
 14760                      or
 14761           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14762              > WS-TOL-LF-HIGH-PREM-PCT)
 14763           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14764              < WS-TOL-LF-LOW-PREM-PCT))
 14765           IF WS-PREM-REJECT-SW = SPACE
 14766              MOVE ER-2652       TO WS-ERROR
 14767              PERFORM 9900-ERROR-FORMAT
 14768                                 THRU 9900-EXIT
 14769           ELSE
 14770              MOVE ER-2650       TO WS-ERROR
 14771              PERFORM 9900-ERROR-FORMAT
 14772                                 THRU 9900-EXIT
 14773           end-if
 14774        end-if
 14775     end-if
 14776
 14777*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14778*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14779*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14780*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14781
 14782     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14783        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14784                      OR
 14785           ((PB-COMPANY-ID = 'DCC')
 14786           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14787           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14788           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14789        END-IF
 14790     END-IF
 14791
 14792     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14793        IF WS-COMP-MAX-CAP GREATER THAN +0
 14794           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14795              IF (PB-REISSUED-CERT         OR
 14796                  PB-POLICY-IS-DECLINED    OR
 14797                  PB-POLICY-IS-VOIDED)
 14798                 NEXT SENTENCE
 14799              ELSE
 14800                  MOVE ER-2646   TO  WS-ERROR
 14801                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14802
 14803 3344-CVL-TOLERANCE-CHECK.
 14804
 14805      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14806          GO TO 3344-CHECK-AH.
 14807
 14808      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14809          GO TO 3344-CHECK-AH.
 14810
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 267
* EL050.cbl
 14811      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14812                                     WS-UNSIGN-WRK6.
 14813
 14814      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14815          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14816                                 + PB-I-LF-PREMIUM-AMT
 14817                                 - PB-I-LF-PREM-CALC.
 14818
 14819      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14820          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14821                                 + PB-I-LF-ALT-PREMIUM-AMT
 14822                                 - PB-I-LF-ALT-PREM-CALC.
 14823
 14824      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14825          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14826              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14827                 MOVE ER-2652    TO  WS-ERROR
 14828                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14829              ELSE
 14830                 MOVE ER-2650    TO  WS-ERROR
 14831                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14832
 14833      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14834          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14835              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14836                 MOVE ER-2652    TO  WS-ERROR
 14837                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14838              ELSE
 14839                 MOVE ER-2650    TO  WS-ERROR
 14840                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14841
 14842 3344-CHECK-AH.
 14843
 14844****************************************************************
 14845***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14846***
 14847
 14848     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14849         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14850             (1 + WS-TOL-AH-PREM-PCT)
 14851         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14852             (1 - WS-TOL-AH-PREM-PCT)
 14853     ELSE
 14854         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14855         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14856
 14857***
 14858***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14859***
 14860
 14861     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14862         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14863
 14864     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14865         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14866
 14867     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14868        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 268
* EL050.cbl
 14869
 14870     IF (PB-REISSUED-CERT)
 14871        OR (PB-POLICY-IS-DECLINED)
 14872        OR (PB-POLICY-IS-VOIDED)
 14873        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14874        CONTINUE
 14875     ELSE
 14876        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14877              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14878                          or
 14879           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14880              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14881           IF WS-PREM-REJECT-SW = SPACE
 14882              MOVE ER-3052       TO WS-ERROR
 14883              PERFORM 9900-ERROR-FORMAT
 14884                                 THRU 9900-EXIT
 14885           ELSE
 14886              MOVE ER-3050       TO WS-ERROR
 14887              PERFORM 9900-ERROR-FORMAT
 14888                                 THRU 9900-EXIT
 14889           END-IF
 14890        END-IF
 14891     END-IF
 14892     if (pb-company-id = 'DCC')
 14893        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14894        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14895        and (pb-i-policy-is-monthly)
 14896        compute ws-tol-ah-high-prem-amt =
 14897           pb-i-tot-fees-calc + ws-tol-ah-prem
 14898        compute ws-tol-ah-low-prem-amt =
 14899           pb-i-tot-fees-calc - ws-tol-ah-prem
 14900        if ws-tol-ah-prem-pct > zeros
 14901           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14902              (1 + ws-tol-ah-prem-pct)
 14903           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14904              (1 - ws-tol-ah-prem-pct)
 14905        else
 14906           move +9999999.99      to ws-tol-ah-high-prem-pct
 14907           move +0               to ws-tol-ah-low-prem-pct
 14908        end-if
 14909        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14910            or
 14911           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14912                          or
 14913           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14914           or
 14915           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14916            move er-3049         to ws-error
 14917           perform 9900-error-format
 14918                                 thru 9900-exit
 14919
 14920        end-if
 14921     end-if
 14922     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14923         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14924             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14925             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14926
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 269
* EL050.cbl
 14927     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14928        IF WS-COMP-MAX-CAP GREATER THAN +0
 14929           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14930              IF (PB-REISSUED-CERT         OR
 14931                  PB-POLICY-IS-DECLINED    OR
 14932                  PB-POLICY-IS-VOIDED)
 14933                 NEXT SENTENCE
 14934              ELSE
 14935                  MOVE ER-2646   TO  WS-ERROR
 14936                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14937
 14938     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14939        (WS-COMP-MAX-CAP EQUAL +0)
 14940           GO TO 3345-EDIT-CONTINUE.
 14941
 14942     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14943        GREATER THAN WS-COMP-MAX-CAP
 14944           MOVE ER-2646          TO  WS-ERROR
 14945           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14946
 14947 3345-EDIT-CONTINUE.
 14948
 14949*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14950*       IF PB-ENTRY-BATCH   NUMERIC
 14951*          IF PB-ISSUE
 14952*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14953*          ELSE
 14954*              IF PB-CANCELLATION
 14955*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14956
 14957*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14958*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14959*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14960*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14961*        ELSE
 14962*            MOVE  ER-1909            TO  WS-ERROR
 14963*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14964
 14965     IF PB-I-POLICY-ACCEPTED
 14966        IF PB-POLICY-IS-DECLINED  OR
 14967           PB-REISSUED-CERT  OR
 14968           PB-REIN-ONLY-CERT  OR
 14969           PB-POLICY-IS-VOIDED
 14970            MOVE  ER-1891         TO  WS-ERROR
 14971            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14972        ELSE
 14973            MOVE SPACE            TO  PB-BATCH-ENTRY
 14974            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14975
 14976     IF PB-I-POLICY-DECLINED
 14977        IF PB-REISSUED-CERT  OR
 14978           PB-REIN-ONLY-CERT  OR
 14979           PB-POLICY-IS-VOIDED
 14980            MOVE  ER-1906         TO  WS-ERROR
 14981            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14982        ELSE
 14983            MOVE  'D'             TO  PB-BATCH-ENTRY
 14984                                      PB-I-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 270
* EL050.cbl
 14985
 14986     IF PB-I-NEEDS-UNDERWRITING
 14987        IF PB-POLICY-IS-DECLINED OR
 14988           PB-REISSUED-CERT  OR
 14989           PB-REIN-ONLY-CERT  OR
 14990           PB-POLICY-IS-VOIDED
 14991            MOVE  ER-1907         TO  WS-ERROR
 14992            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14993        ELSE
 14994            MOVE 'U'              TO  PB-BATCH-ENTRY
 14995                                      PB-I-ENTRY-STATUS.
 14996
 14997     IF PB-NEEDS-UNDERWRITING
 14998        MOVE  ER-1901             TO  WS-ERROR
 14999        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15000     IF PB-COMPANY-ID = 'DCC'
 15001        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15002        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15003        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15004           AND (NOT WS-LF-CASH))
 15005                           OR
 15006           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15007           AND (NOT WS-AH-CASH)))
 15008                       AND
 15009           (PB-I-ENTRY-STATUS NOT = '5')
 15010           MOVE 'M'              TO PB-BATCH-ENTRY
 15011                                    PB-I-ENTRY-STATUS
 15012        END-IF
 15013     END-IF
 15014     IF  PB-COMPANY-ID NOT = 'NCL'
 15015         GO TO 3999-END-EDIT.
 15016
 15017     IF PB-REISSUED-CERT  OR
 15018        PB-POLICY-IS-DECLINED  OR
 15019        PB-POLICY-IS-VOIDED  OR
 15020        PB-I-OB
 15021         GO TO 3999-END-EDIT.
 15022
 15023     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15024         MOVE  ER-2644            TO  WS-ERROR
 15025         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15026         GO TO 3999-END-EDIT.
 15027
 15028     MOVE 'N'                     TO  FORM-MASTER-SW.
 15029     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15030
 15031     IF NOT FORM-MASTER-FOUND
 15032         GO TO 3999-END-EDIT.
 15033
 15034     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15035                                      FORM-MASTER-AH-SW.
 15036
 15037     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15038         MOVE  +1                 TO SUB6
 15039         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15040
 15041     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15042         MOVE  +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 271
* EL050.cbl
 15043         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15044
 15045     IF LF-FORM-MASTER-FOUND  OR
 15046        AH-FORM-MASTER-FOUND
 15047         GO TO 3360-CHECK-FORM-LIMITS
 15048     ELSE
 15049         GO TO 3999-END-EDIT.
 15050
 15051******************************************************************
 15052*                  3350-GET-ERFORM                               *
 15053*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15054*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15055******************************************************************
 15056
 15057 3350-GET-ERFORM.
 15058
 15059     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15060         GO TO  3350-ERFORM-GETMAIN.
 15061
 15062     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15063     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15064     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15065     MOVE 'Y'                     TO FORM-MASTER-SW.
 15066
 15067     IF PB-CANCELLATION
 15068         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15069            PB-SV-STATE          EQUAL   FO-STATE       AND
 15070            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15071              GO TO 3350-EXIT
 15072         ELSE
 15073             NEXT SENTENCE
 15074     ELSE
 15075         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15076            PB-SV-STATE          EQUAL   FO-STATE       AND
 15077            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15078              GO TO 3350-EXIT.
 15079
 15080 3350-ERFORM-GETMAIN.
 15081
 15082     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15083     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15084
 15085 3350-ERFORM-READ.
 15086
 15087     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15088     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15089     IF PB-CANCELLATION
 15090         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15091     ELSE
 15092         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15093     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15094
 15095     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15096
 15097     IF FORM-MASTER-FOUND
 15098       IF PB-CANCELLATION
 15099          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15100             PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 272
* EL050.cbl
 15101             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15102              GO  TO 3350-EXIT
 15103          ELSE
 15104              NEXT SENTENCE
 15105       ELSE
 15106          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15107             PB-SV-STATE          EQUAL   FO-STATE       AND
 15108             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15109              GO  TO 3350-EXIT.
 15110
 15111     MOVE  'N'                    TO  FORM-MASTER-SW.
 15112     MOVE  ER-1895                TO  WS-ERROR.
 15113     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15114
 15115 3350-EXIT.
 15116      EXIT.
 15117
 15118******************************************************************
 15119*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15120*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15121*   VALID FOR THE POLICY FORM USED.                              *
 15122******************************************************************
 15123
 15124 3355-EDIT-FORM-LF-BENEFITS.
 15125
 15126     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15127        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15128         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15129         GO TO   3355-EXIT.
 15130
 15131     IF  SUB6    LESS THAN   +40
 15132         ADD  +1      TO  SUB6
 15133         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15134
 15135     MOVE  ER-1896         TO  WS-ERROR.
 15136     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15137
 15138 3355-EXIT.
 15139      EXIT.
 15140
 15141******************************************************************
 15142*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15143*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15144*   VALID FOR THE POLICY FORM USED.                              *
 15145******************************************************************
 15146
 15147 3356-EDIT-FORM-AH-BENEFITS.
 15148
 15149     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15150        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15151         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15152         GO TO  3356-EXIT.
 15153
 15154      IF  SUB6    LESS THAN     +40
 15155          ADD  +1      TO  SUB6
 15156          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15157
 15158     MOVE  ER-1897         TO  WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 273
* EL050.cbl
 15159     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15160
 15161 3356-EXIT.
 15162      EXIT.
 15163
 15164******************************************************************
 15165*                  3357-BENEFIT-SEARCH                           *
 15166*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15167*   CANCELLATIONS ONLY.                                          *
 15168******************************************************************
 15169 3357-BENEFIT-SEARCH.
 15170     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15171         MOVE +1                          TO SUB6
 15172         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15173
 15174     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15175         MOVE +1                          TO SUB6
 15176         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15177
 15178 3357-EXIT.
 15179     EXIT.
 15180
 15181******************************************************************
 15182*                  3358-BENEFIT-LIFE-SEARCH                      *
 15183*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15184*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15185*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15186******************************************************************
 15187 3358-BENEFIT-LIFE-SEARCH.
 15188     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15189       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15190         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15191           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15192              IF FO-PLAN-REFUND-METHOD (SUB6)
 15193                     IS GREATER THAN SPACES
 15194                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15195                                          WS-LF-REFUND-CALC
 15196                 GO TO 3358-EXIT.
 15197
 15198     IF SUB6 LESS THAN +40
 15199         ADD +1                 TO SUB6
 15200         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15201
 15202 3358-EXIT.
 15203     EXIT.
 15204******************************************************************
 15205*                  3359-BENEFIT-AH-SEARCH                        *
 15206*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15207*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15208*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15209******************************************************************
 15210 3359-BENEFIT-AH-SEARCH.
 15211     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15212       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15213         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15214           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15215              IF FO-PLAN-REFUND-METHOD (SUB6)
 15216                      IS GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 274
* EL050.cbl
 15217                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15218                                          WS-AH-REFUND-CALC
 15219                 GO TO 3359-EXIT.
 15220
 15221     IF SUB6 LESS THAN +40
 15222         ADD +1                 TO SUB6
 15223         GO TO 3359-BENEFIT-AH-SEARCH.
 15224
 15225 3359-EXIT.
 15226     EXIT.
 15227
 15228******************************************************************
 15229*                  3360-CHECK-FORM-LIMITS                        *
 15230*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15231*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15232******************************************************************
 15233
 15234 3360-CHECK-FORM-LIMITS.
 15235
 15236     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15237         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15238
 15239     IF NOT LF-FORM-MASTER-FOUND
 15240         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15241
 15242 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15243
 15244     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15245       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15246        WS-LF-JOINT-INDICATOR = 'J'  AND
 15247        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15248         IF PB-COMPANY-ID = 'NCL'
 15249            MOVE  ER-1911          TO  WS-ERROR
 15250            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15251         ELSE
 15252            MOVE  ER-1892          TO  WS-ERROR
 15253            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15254
 15255 3360-CHECK-FORM-LF-ATT-AGE.
 15256
 15257     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15258
 15259     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15260         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15261         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15262            IF PB-COMPANY-ID = 'NCL'
 15263                MOVE  ER-1913      TO  WS-ERROR
 15264                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15265            ELSE
 15266                MOVE  ER-1894      TO  WS-ERROR
 15267                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15268
 15269 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15270
 15271     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15272         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15273         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15274            IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 275
* EL050.cbl
 15275                MOVE  ER-1914      TO  WS-ERROR
 15276                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15277            ELSE
 15278                MOVE  ER-1899      TO  WS-ERROR
 15279                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15280
 15281 3360-CHECK-FORM-LF-TERM-BAMT.
 15282
 15283     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15284         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15285         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15286           IF  PB-COMPANY-ID = 'NCL'
 15287               MOVE  ER-1916       TO  WS-ERROR
 15288               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15289           ELSE
 15290               MOVE  ER-1902       TO  WS-ERROR
 15291               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15292
 15293     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15294                                    PB-I-LF-ALT-BENEFIT-AMT.
 15295
 15296     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15297         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15298         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15299             IF  PB-COMPANY-ID = 'NCL'
 15300                 MOVE  ER-1918     TO  WS-ERROR
 15301                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15302             ELSE
 15303                 MOVE  ER-1904     TO  WS-ERROR
 15304                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15305
 15306******************************************************************
 15307*                  3360-CHECK-FORM-AH-LIMITS                     *
 15308*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15309*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15310******************************************************************
 15311
 15312 3360-CHECK-FORM-AH-LIMITS.
 15313
 15314     IF NOT AH-FORM-MASTER-FOUND
 15315         GO TO 3999-END-EDIT.
 15316
 15317 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15318
 15319     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15320       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15321        WS-AH-JOINT-INDICATOR = 'J'  AND
 15322        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15323         IF PB-COMPANY-ID = 'NCL'
 15324            MOVE  ER-1912          TO  WS-ERROR
 15325            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15326         ELSE
 15327            MOVE  ER-1893          TO  WS-ERROR
 15328            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15329
 15330 3360-CHECK-FORM-AH-ATT-AGE.
 15331
 15332     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 276
* EL050.cbl
 15333
 15334     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15335         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15336         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15337            IF PB-COMPANY-ID = 'NCL'
 15338                MOVE  ER-1913      TO  WS-ERROR
 15339                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15340            ELSE
 15341                MOVE  ER-1894      TO  WS-ERROR
 15342                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15343
 15344 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15345
 15346     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15347         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15348         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15349            IF PB-COMPANY-ID = 'NCL'
 15350                MOVE  ER-1915      TO  WS-ERROR
 15351                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15352            ELSE
 15353                MOVE  ER-1900      TO  WS-ERROR
 15354                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15355
 15356 3360-CHECK-FORM-AH-TERM-BAMT.
 15357
 15358     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15359         FO-AH-MAX-TERM    GREATER THAN  +0
 15360         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15361             IF  PB-COMPANY-ID = 'NCL'
 15362                 MOVE  ER-1917     TO  WS-ERROR
 15363                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15364             ELSE
 15365                  MOVE  ER-1903    TO  WS-ERROR
 15366                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15367
 15368     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15369         FO-MAX-AH-AMT    GREATER THAN  +0
 15370         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15371             IF  PB-COMPANY-ID = 'NCL'
 15372                 MOVE  ER-1919     TO  WS-ERROR
 15373                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15374             ELSE
 15375                 MOVE  ER-1905     TO  WS-ERROR
 15376                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15377
 15378     GO TO 3999-END-EDIT.
 15379
 15380******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 277
* EL050.cbl
 15382******************************************************************
 15383*                  E D I T   C A N C E L                         *
 15384******************************************************************
 15385
 15386 3700-EDIT-CANCEL.
 15387     IF PB-COMPANY-ID = 'DMD'
 15388         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15389                                         WS-RES-MUNI-TAX
 15390                                         PB-CI-STATE-TAX
 15391                                         PB-CI-MUNI-TAX
 15392         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15393
 15394*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15395*       IF PB-ENTRY-BATCH  NUMERIC
 15396*          IF PB-CANCELLATION
 15397*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15398*          ELSE
 15399*             IF PB-ISSUE
 15400*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15401
 15402     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15403        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15404     END-IF
 15405*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15406*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15407
 15408     IF CM-ENTRY-STATUS = 'V'
 15409        MOVE ER-2780             TO WS-ERROR
 15410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15411        GO TO 3999-END-EDIT.
 15412
 15413     IF CM-ENTRY-STATUS = 'D'
 15414        MOVE ER-2781             TO WS-ERROR
 15415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15416        GO TO 3999-END-EDIT.
 15417
 15418     IF CM-ENTRY-STATUS = 'U'
 15419        MOVE ER-2782             TO WS-ERROR
 15420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15421
 15422***************************************************************
 15423*                                                             *
 15424*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15425*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15426*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15427*   OF ANOTHER COVERAGE.                                      *
 15428*                                                             *
 15429***************************************************************
 15430
 15431     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15432                                    PB-C-AH-CANCEL-VOID-SW.
 15433
 15434     IF PB-C-LF-CANCEL-AMT = ZERO
 15435        NEXT SENTENCE
 15436     ELSE
 15437        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15438           AND
 15439           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 278
* EL050.cbl
 15440               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15441               MOVE ER-2745           TO WS-ERROR
 15442               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15443
 15444     IF PB-C-AH-CANCEL-AMT = ZERO
 15445        NEXT SENTENCE
 15446     ELSE
 15447        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15448           AND
 15449           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15450               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15451               MOVE ER-2745           TO WS-ERROR
 15452               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15453
 15454     IF WS-LF-EARNINGS-CALC = '4'
 15455        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15456
 15457     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15458     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15459     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15460     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15461     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15462     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15463
 15464     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15465                                      PB-C-AH-REF-CALC.
 15466     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15467
 15468******************************************************************
 15469*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15470*             TO VALIDATE COVERAGE.                              *
 15471******************************************************************
 15472
 15473     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15474        PB-C-LF-CANCEL-AMT = ZEROS
 15475          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15476      ELSE
 15477          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15478
 15479     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15480        PB-C-AH-CANCEL-AMT = ZEROS
 15481          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15482      ELSE
 15483          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15484
 15485     EVALUATE TRUE
 15486         WHEN PB-CANCEL-FORCE             OR
 15487              PB-CANCEL-DATE-FORCED       OR
 15488              PB-FORCE-OFF
 15489                  IF PB-COMPANY-ID = 'ACE'
 15490                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15491                  END-IF
 15492         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15493               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15494              (PB-COMPANY-ID = 'ACE' )
 15495                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15496         WHEN OTHER
 15497              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 279
* EL050.cbl
 15498                 MOVE ER-2794              TO WS-ERROR
 15499              ELSE
 15500                 MOVE ER-2749              TO WS-ERROR
 15501              END-IF
 15502              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15503     END-EVALUATE.
 15504
 15505
 15506*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15507*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15508*            MOVE  ER-1909            TO  WS-ERROR
 15509*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15510*        ELSE
 15511*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15512
 15513     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15514     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15515        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15516     ELSE
 15517        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15518     END-IF
 15519     .
 15520 3705-EDIT-CANCEL-DT.
 15521
 15522     IF LF-COVERAGE-CANCELLED
 15523        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15524         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15525         MOVE WS-CURRENT-MONTH-END
 15526                                 TO DC-BIN-DATE-2
 15527         SET ELAPSED-BETWEEN-BIN TO TRUE
 15528*        MOVE 1                  TO DC-OPTION-CODE
 15529         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15530         IF DATE-CONVERSION-ERROR
 15531            NEXT SENTENCE
 15532          ELSE
 15533             IF DC-ELAPSED-DAYS GREATER +180
 15534                IF PB-CANCEL-DATE-FORCED  OR
 15535                   PB-CANCEL-DATE-FORCED-NO-FEE
 15536                      MOVE ER-2751  TO WS-ERROR
 15537                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15538                 ELSE
 15539                   MOVE ER-2752  TO WS-ERROR
 15540                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15541
 15542     IF AH-COVERAGE-CANCELLED
 15543        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15544         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15545         MOVE WS-CURRENT-MONTH-END
 15546                                 TO DC-BIN-DATE-2
 15547         SET ELAPSED-BETWEEN-BIN TO TRUE
 15548*        MOVE 1                  TO DC-OPTION-CODE
 15549         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15550         IF DATE-CONVERSION-ERROR
 15551            NEXT SENTENCE
 15552          ELSE
 15553             IF DC-ELAPSED-DAYS GREATER +180
 15554                IF PB-CANCEL-DATE-FORCED OR
 15555                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 280
* EL050.cbl
 15556                      MOVE ER-2751  TO WS-ERROR
 15557                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15558                 ELSE
 15559                   MOVE ER-2752  TO WS-ERROR
 15560                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15561
 15562     IF WS-ERROR = ER-2752
 15563        AND (PB-COMPANY-ID = 'ABL'
 15564         OR  PB-COMPANY-ID = 'FGL'
 15565         OR  PB-COMPANY-ID = 'IST'
 15566         OR  PB-COMPANY-ID = 'JHL'
 15567         OR  PB-COMPANY-ID = 'LAP'
 15568         OR  PB-COMPANY-ID = 'LBL'
 15569         OR  PB-COMPANY-ID = 'NCB'
 15570         OR  PB-COMPANY-ID = 'NLI'
 15571         OR  PB-COMPANY-ID = 'OFI'
 15572         OR  PB-COMPANY-ID = 'PLI'
 15573         OR  PB-COMPANY-ID = 'TAO'
 15574         OR  PB-COMPANY-ID = 'TIC'
 15575         OR  PB-COMPANY-ID = 'HER'
 15576         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15577         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15578            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15579            MOVE ER-2762     TO WS-ERROR
 15580            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15581
 15582     IF LF-COVERAGE-CANCELLED
 15583        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15584        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15585             MOVE ER-2733         TO WS-ERROR
 15586             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15587
 15588     IF AH-COVERAGE-CANCELLED
 15589        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15590        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15591              MOVE ER-2733        TO WS-ERROR
 15592              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15593
 15594     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15595        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15596        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15597           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15598            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15599              IF PB-COMPANY-ID NOT = 'LAP'
 15600               MOVE ER-2704            TO WS-ERROR
 15601               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15602
 15603     IF CERT-WAS-NOT-FOUND
 15604         GO TO 3999-END-EDIT.
 15605
 15606     IF PB-COMPANY-ID EQUAL 'CDC'
 15607        IF LF-COVERAGE-CANCELLED
 15608           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15609            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15610            MOVE PB-C-LF-CANCEL-DT
 15611                                 TO DC-BIN-DATE-2
 15612            SET ELAPSED-BETWEEN-BIN TO TRUE
 15613*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 281
* EL050.cbl
 15614            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15615            IF DATE-CONVERSION-ERROR
 15616               NEXT SENTENCE
 15617             ELSE
 15618                IF DC-ELAPSED-DAYS GREATER +60
 15619                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15620
 15621     IF PB-COMPANY-ID EQUAL 'CDC'
 15622        IF AH-COVERAGE-CANCELLED
 15623           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15624            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15625            MOVE PB-C-AH-CANCEL-DT
 15626                                 TO DC-BIN-DATE-2
 15627            MOVE +0              TO DC-ELAPSED-DAYS
 15628                                    DC-ELAPSED-MONTHS
 15629            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15630*           MOVE 1               TO DC-OPTION-CODE
 15631            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15632            IF DATE-CONVERSION-ERROR
 15633               NEXT SENTENCE
 15634             ELSE
 15635                IF DC-ELAPSED-DAYS GREATER +60
 15636                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15637
 15638     MOVE +0                     TO DC-ELAPSED-DAYS
 15639                                    DC-ELAPSED-MONTHS.
 15640
 15641     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15642        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15643          MOVE 'Z'                TO PB-CI-OB-FLAG
 15644          MOVE ER-2767            TO WS-ERROR
 15645          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15646          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15647          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15648          GO TO 3775-OVER-REF-CHK
 15649        ELSE
 15650          MOVE ZEROS              TO PB-CI-LIVES
 15651                                     PB-C-LIVES
 15652          IF PB-CI-OB-FLAG NOT = 'B'
 15653             MOVE SPACE           TO PB-CI-OB-FLAG.
 15654
 15655     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15656         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15657     ELSE
 15658         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15659
 15660     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15661        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15662            MOVE ER-2760         TO WS-ERROR
 15663            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF LF-COVERAGE-CANCELLED
 15666        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15667         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15668            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15669               MOVE ER-2774       TO WS-ERROR
 15670               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15671
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 282
* EL050.cbl
 15672     IF AH-COVERAGE-CANCELLED
 15673        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15674         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15675            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15676               MOVE ER-2775       TO WS-ERROR
 15677               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15678
 15679     IF LF-COVERAGE-CANCELLED
 15680        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15681         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15682            MOVE ER-2776         TO WS-ERROR
 15683            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15684
 15685     IF AH-COVERAGE-CANCELLED
 15686        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15687         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15688            MOVE ER-2777         TO WS-ERROR
 15689            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15690
 15691     IF LF-COVERAGE-CANCELLED
 15692        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15693        if pb-ci-lf-expire-dt = low-values or spaces
 15694           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15695           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15696           MOVE PB-CI-EXTENTION-DAYS
 15697                                 TO DC-ELAPSED-DAYS
 15698           SET BIN-PLUS-ELAPSED  TO TRUE
 15699           PERFORM 8500-DATE-CONVERT
 15700                                 THRU 8500-EXIT
 15701           IF DATE-CONVERSION-ERROR
 15702              move low-values    to dc-bin-date-2
 15703           end-if
 15704        else
 15705           move pb-ci-lf-expire-dt
 15706                                 to dc-bin-date-2
 15707        end-if
 15708        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15709           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15710                             OR  'FIA'
 15711              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15712           ELSE
 15713              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15714              MOVE ER-2731       TO WS-ERROR
 15715              PERFORM 9900-ERROR-FORMAT
 15716                                 THRU 9900-EXIT
 15717           end-if
 15718        end-if
 15719     end-if
 15720*    IF LF-COVERAGE-CANCELLED
 15721*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15722*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15723*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15724*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15725*        SET BIN-PLUS-ELAPSED      TO TRUE
 15726*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15727*        IF DATE-CONVERSION-ERROR
 15728*           NEXT SENTENCE
 15729*         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 283
* EL050.cbl
 15730*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15731*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15732*                            OR  'FIA'
 15733*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15734*              ELSE
 15735*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15736*               MOVE ER-2731       TO WS-ERROR
 15737*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15738     .
 15739 3705-EDIT-AH-CANCEL-DT.
 15740     IF AH-COVERAGE-CANCELLED
 15741        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15742        if pb-ci-AH-expire-dt = low-values or spaces
 15743           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15744           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15745           MOVE PB-CI-EXTENTION-DAYS
 15746                                 TO DC-ELAPSED-DAYS
 15747           SET BIN-PLUS-ELAPSED  TO TRUE
 15748           PERFORM 8500-DATE-CONVERT
 15749                                 THRU 8500-EXIT
 15750           IF DATE-CONVERSION-ERROR
 15751              move low-values    to dc-bin-date-2
 15752           end-if
 15753        else
 15754           move pb-ci-ah-expire-dt
 15755                                 to dc-bin-date-2
 15756        end-if
 15757        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15758           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15759                             OR  'FIA'
 15760              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15761           ELSE
 15762              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15763              MOVE ER-2771       TO WS-ERROR
 15764              PERFORM 9900-ERROR-FORMAT
 15765                                 THRU 9900-EXIT
 15766           end-if
 15767        end-if
 15768     end-if
 15769*    IF AH-COVERAGE-CANCELLED
 15770*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15771*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15772*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15773*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15774**       MOVE 6                    TO DC-OPTION-CODE
 15775*        SET BIN-PLUS-ELAPSED      TO TRUE
 15776*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15777*        IF DATE-CONVERSION-ERROR
 15778*           NEXT SENTENCE
 15779*         ELSE
 15780*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15781*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15782*                             OR 'FIA'
 15783*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15784*             ELSE
 15785*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15786*              MOVE ER-2771       TO WS-ERROR
 15787*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 284
* EL050.cbl
 15788     .
 15789 3705-EDIT-CONTINUED.
 15790
 15791*    IF LF-COVERAGE-CANCELLED
 15792*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15793*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15794*            MOVE ER-2727         TO WS-ERROR
 15795*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15796*
 15797*    IF AH-COVERAGE-CANCELLED
 15798*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15799*        IF PB-COMPANY-ID = 'ACE'
 15800*           MOVE ER-2727        TO WS-ERROR
 15801*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15802*        ELSE
 15803*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15804*              MOVE ER-2727     TO WS-ERROR
 15805*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15806
 15807     IF PB-COMPANY-ID = 'ACE'
 15808       IF AH-COVERAGE-CANCELLED
 15809         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15810           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15811              MOVE ER-2732      TO WS-ERROR
 15812              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15813
 15814     IF PB-COMPANY-ID      EQUAL   'HER'
 15815        IF WS-ERROR        EQUAL   ER-2727
 15816            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15817            MOVE  ER-2725          TO  WS-ERROR
 15818            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15819
 15820     IF PB-C-CLAIM-CREATED-CANCEL
 15821            MOVE ER-2748         TO WS-ERROR
 15822            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15823
 15824     IF PB-C-LAST-NAME NOT = SPACES
 15825         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15826            MOVE ER-2747         TO WS-ERROR
 15827            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15828
 15829 3710-EDIT-LUMP-SUM-PRIOR.
 15830
 15831     IF AH-COVERAGE-CANCELLED
 15832         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15833             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15834                MOVE ER-2735    TO WS-ERROR
 15835                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15836
 15837     IF LF-COVERAGE-CANCELLED
 15838         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15839             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15840                MOVE ER-2735    TO WS-ERROR
 15841                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15842
 15843 3710-EDIT-PRIOR-DEATH.
 15844
 15845*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 285
* EL050.cbl
 15846*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15847*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15848*           (NOT PB-CI-OB)
 15849*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15850*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15851*                   MOVE ER-2732  TO WS-ERROR
 15852*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15853*
 15854*    IF AH-COVERAGE-CANCELLED
 15855*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15856*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15857*           (NOT PB-CI-OB)
 15858*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15859*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15860*                   MOVE ER-2732  TO WS-ERROR
 15861*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15862
 15863     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15864         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15865            (NOT PB-COMP-LF-CANCEL)
 15866             NEXT SENTENCE
 15867         ELSE
 15868           IF PB-C-LF-CANCEL-VOIDED
 15869              NEXT SENTENCE
 15870           ELSE
 15871              MOVE ER-2753      TO WS-ERROR
 15872              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15873
 15874     IF CANCEL-FUTURE-DT
 15875         GO TO 3999-END-EDIT.
 15876
 15877 3715-GET-REMAIN-TERM-LF.
 15878
 15879     IF NO-LF-BENEFIT-MATCH  OR
 15880        WS-LF-BENEFIT-CD = ZEROS
 15881        GO TO 3730-GET-AH-REMAIN-TERM.
 15882
 15883     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15884     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15885     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15886     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15887     MOVE PB-SV-STATE            TO CP-STATE.
 15888     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15889     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15890     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15891     MOVE '2'                    TO CP-PROCESS-TYPE.
 15892     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15893     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15894     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15895     IF (PB-COMPANY-ID = 'CID')
 15896        AND (CP-STATE-STD-ABBRV = 'WI')
 15897        MOVE '7'                 TO CP-REM-TERM-METHOD
 15898        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15899     ELSE
 15900        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15901        MOVE WS-REM-TRM-CALC-OPTION
 15902                                 TO CP-REM-TRM-CALC-OPTION
 15903     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 286
* EL050.cbl
 15904**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15905     IF (PB-COMPANY-ID = 'CID')
 15906        AND (CP-STATE-STD-ABBRV = 'MO')
 15907        AND (PB-CERT-EFF-DT >= X'9B41')
 15908        AND (PB-CERT-EFF-DT <= X'A2FB')
 15909        MOVE '7'                 TO CP-REM-TERM-METHOD
 15910        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15911     END-IF
 15912     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15913                                    CP-LOAN-TERM.
 15914     IF CP-TRUNCATED-LIFE
 15915        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15916
 15917     IF CP-TERM-IS-DAYS
 15918         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15919     ELSE
 15920         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15921
 15922     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15923
 15924     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15925
 15926     IF LF-COVERAGE-CANCELLED
 15927        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15928        NEXT SENTENCE
 15929      ELSE
 15930          GO TO 3730-GET-AH-REMAIN-TERM.
 15931
 15932 3720-GET-LF-REFUND.
 15933
 15934     IF PB-C-LF-CANCEL-VOIDED
 15935        GO TO 3730-GET-AH-REMAIN-TERM
 15936     end-if
 15937
 15938     IF PB-COMPANY-ID EQUAL 'BOA'
 15939         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15940         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15941         GO TO 3730-GET-AH-REMAIN-TERM.
 15942
 15943     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15944        (WS-AH-SPECIAL-CALC-CD = 'M')
 15945         MOVE ER-2767            TO WS-ERROR
 15946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15947         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15948         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15949         GO TO 3780-UPDATE-CANCEL-CERT.
 15950
 15951*    if (ws-lf-earnings-calc = '6')
 15952*       or (pb-c-lf-refund-override = '6')
 15953*       move cp-remaining-term-1 to cp-remaining-term-2
 15954*    end-if
 15955     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15956
 15957     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15958     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15959     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15960     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15961     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 287
* EL050.cbl
 15962     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15963     IF (PB-COMPANY-ID = 'DCC')
 15964        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15965        IF PDEF-MASTER-FOUND
 15966           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15967              (V1 > +8)
 15968              OR (PD-PROD-CODE (V1) = 'L')
 15969           END-PERFORM
 15970           IF V1 < +9
 15971              MOVE PD-MAX-AMT (V1)
 15972                           TO CP-R-MAX-TOT-BEN
 15973                              EC-AM-LF-MAX-TOT-BEN
 15974           END-IF
 15975        ELSE
 15976        MOVE ' '                 TO PDEF-MASTER-SW
 15977        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15978        MOVE PB-STATE            TO ERPDEF-STATE
 15979        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15980        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15981        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15982        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15983        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15984        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15985        IF PDEF-MASTER-FOUND
 15986           MOVE 'N'              TO PDEF-MASTER-SW
 15987           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15988           IF PDEF-MASTER-FOUND
 15989              IF (ERPDEF-KEY-SAVE (1:16) =
 15990                           PD-CONTROL-PRIMARY (1:16))
 15991                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15992                 CONTINUE
 15993              ELSE
 15994                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15995                 IF (ERPDEF-KEY-SAVE (1:16) =
 15996                           PD-CONTROL-PRIMARY (1:16))
 15997                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15998                    CONTINUE
 15999                 ELSE
 16000                    MOVE 'N'     TO PDEF-MASTER-SW
 16001                 END-IF
 16002              END-IF
 16003
 16004              IF PDEF-MASTER-FOUND
 16005                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16006                    (V1 > +8)
 16007                    OR (PD-PROD-CODE (V1) = 'L')
 16008                 END-PERFORM
 16009                 IF V1 < +9
 16010                    MOVE PD-MAX-AMT (V1)
 16011                                 TO CP-R-MAX-TOT-BEN
 16012                                    EC-AM-LF-MAX-TOT-BEN
 16013                 END-IF
 16014              END-IF
 16015           END-IF
 16016           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16017        END-IF
 16018        END-IF
 16019     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 288
* EL050.cbl
 16020     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16021
 16022     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16023
 16024     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16025                                    PB-C-LF-REM-TERM.
 16026
 16027     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16028     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16029
 16030     IF PB-COMPANY-ID EQUAL 'FLC'
 16031        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16032           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16033           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16034                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16035                    - CM-LF-ITD-DEATH-AMT
 16036           IF PB-C-LF-REF-CALC LESS THAN +0
 16037              MOVE +0            TO PB-C-LF-REF-CALC
 16038              GO TO 3730-GET-AH-REMAIN-TERM
 16039           ELSE
 16040              GO TO 3730-GET-AH-REMAIN-TERM.
 16041
 16042     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16043                            OR '4' OR '5' OR '6' OR '8'
 16044                            OR '9' OR 'G'
 16045        MOVE PB-C-LF-REFUND-OVERRIDE
 16046                                 TO CP-EARNING-METHOD.
 16047
 16048     if pb-company-id = 'AHL'
 16049        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16050        if cp-class-code = spaces
 16051           move zeros            to cp-class-code
 16052        end-if
 16053     ELSE
 16054        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16055     END-IF
 16056*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16057     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16058     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16059                                    CP-RATING-BENEFIT-AMT.
 16060     IF CP-STATE-STD-ABBRV = 'OR'
 16061         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16062                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16063     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16064     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16065     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16066     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16067     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16068     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16069     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16070     IF WS-DEFAULT-APR NOT NUMERIC
 16071         MOVE ZEROS TO WS-DEFAULT-APR.
 16072****   N O T E   ****
 16073*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16074*      THE OH HARD CODING IN ELCRFNDP
 16075
 16076     IF PB-COMPANY-ID = 'CID'
 16077        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 289
* EL050.cbl
 16078           MOVE WS-LF-EARNINGS-CALC
 16079                                 TO CP-EARNING-METHOD
 16080        END-IF
 16081     END-IF
 16082
 16083****   N O T E   ****
 16084
 16085     IF CP-EARN-AS-NET-PAY
 16086         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16087            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16088                MOVE WS-DEFAULT-APR
 16089                                 TO  CP-LOAN-APR
 16090                MOVE ER-3780     TO  WS-ERROR
 16091                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16092            ELSE
 16093                MOVE ER-3781     TO  WS-ERROR
 16094                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16095*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16096     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16097
 16098     IF CP-REFUND-TYPE-USED NOT = SPACE
 16099         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16100
 16101     IF CP-ERROR-RATE-IS-ZERO OR
 16102        CP-ERROR-RATE-NOT-FOUND
 16103        MOVE ER-2740             TO WS-ERROR
 16104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16105
 16106     IF CP-ERROR-RATE-FILE-NOTOPEN
 16107        MOVE ER-2617             TO WS-ERROR
 16108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16109
 16110     IF PB-COMPANY-ID = 'DCC'
 16111        AND PB-CI-ENTRY-STATUS = 'M'
 16112        MOVE +0                  TO PB-C-LF-REF-CALC
 16113     ELSE
 16114        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16115     END-IF
 16116
 16117     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16118         GO TO 3730-GET-AH-REMAIN-TERM.
 16119
 16120*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16121*       ADD +1                   TO PB-C-LF-REM-TERM
 16122*                                   CP-REMAINING-TERM
 16123*                                   CP-ORIGINAL-TERM.
 16124
 16125     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16126     MOVE '2'                    TO CP-EARNING-METHOD
 16127                                    CP-RATING-METHOD.
 16128     IF PB-COMPANY-ID = 'CID'
 16129        IF (CP-STATE-STD-ABBRV = 'MN')
 16130           AND (PB-CERT-EFF-DT > X'A4FF')
 16131           AND (WS-LF-EARNINGS-CALC = 'B')
 16132           MOVE '5'              TO CP-EARNING-METHOD
 16133           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16134        END-IF
 16135     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 290
* EL050.cbl
 16136     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16137                                        CP-REMAINING-BENEFIT
 16138                                        CP-RATING-BENEFIT-AMT.
 16139     IF CP-STATE-STD-ABBRV = 'OR'
 16140         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16141                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16142     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16143     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16144
 16145     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16146
 16147     IF CP-ERROR-RATE-IS-ZERO OR
 16148        CP-ERROR-RATE-NOT-FOUND
 16149        MOVE ER-2740             TO WS-ERROR
 16150        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16151
 16152     IF CP-ERROR-RATE-FILE-NOTOPEN
 16153        MOVE ER-2617             TO WS-ERROR
 16154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16155
 16156     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16157
 16158******************************************************************
 16159
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 291
* EL050.cbl
 16161 3730-GET-AH-REMAIN-TERM.
 16162     IF NO-AH-BENEFIT-MATCH  OR
 16163        WS-AH-BENEFIT-CD = ZEROS
 16164         GO TO 3770-CHECK-REFUNDS.
 16165
 16166     IF PB-CI-AH-LUMP-SUM-DISAB
 16167         IF  PB-C-AH-CANCEL-AMT = ZERO
 16168            IF NOT PB-COMP-AH-CANCEL
 16169             GO TO 3770-CHECK-REFUNDS.
 16170
 16171     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16172     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16173     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16174     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16175     MOVE PB-SV-STATE            TO CP-STATE.
 16176     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16177     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16178     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16179     MOVE '2'                    TO CP-PROCESS-TYPE.
 16180     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16181     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16182     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16183     IF (PB-COMPANY-ID = 'CID')
 16184        AND (CP-STATE-STD-ABBRV = 'WI')
 16185        MOVE '7'                 TO CP-REM-TERM-METHOD
 16186        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16187     ELSE
 16188        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16189        MOVE WS-REM-TRM-CALC-OPTION
 16190                                 TO CP-REM-TRM-CALC-OPTION
 16191     END-IF
 16192     IF (PB-COMPANY-ID = 'CID')
 16193        AND (CP-STATE-STD-ABBRV = 'MO')
 16194        AND (PB-CERT-EFF-DT >= X'9B41')
 16195        AND (PB-CERT-EFF-DT <= X'A2FB')
 16196        MOVE '7'                 TO CP-REM-TERM-METHOD
 16197        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16198     END-IF
 16199     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16200                                    CP-LOAN-TERM.
 16201     IF NOT CP-TERM-IS-DAYS
 16202         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16203
 16204     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16205
 16206     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16207
 16208     IF AH-COVERAGE-CANCELLED
 16209        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16210        NEXT SENTENCE
 16211      ELSE
 16212         GO TO 3770-CHECK-REFUNDS.
 16213
 16214 3740-GET-AH-REFUND.
 16215
 16216     IF PB-C-AH-CANCEL-VOIDED
 16217        GO TO 3780-UPDATE-CANCEL-CERT
 16218     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 292
* EL050.cbl
 16219
 16220     IF PB-COMPANY-ID = 'BOA'
 16221         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16222         GO TO 3770-CHECK-REFUNDS.
 16223
 16224     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16225*    MOVE ' '                    TO DC-OPTION-CODE
 16226     SET BIN-TO-GREG             TO TRUE
 16227     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16228     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16229                                    PB-C-AH-REM-TERM.
 16230     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16231     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16232
 16233     IF PB-COMPANY-ID EQUAL 'FLC'
 16234        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16235           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16236           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16237                    - CM-AH-ITD-AH-PMT)
 16238           IF PB-C-AH-REF-CALC LESS THAN +0
 16239              MOVE +0            TO PB-C-AH-REF-CALC
 16240              GO TO 3770-CHECK-REFUNDS
 16241           ELSE
 16242              GO TO 3770-CHECK-REFUNDS.
 16243
 16244     IF PB-COMPANY-ID = 'DCC'
 16245        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16246            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16247           MOVE 'S'              TO CP-EARNING-METHOD
 16248        END-IF
 16249     END-IF
 16250     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16251                            OR '4' OR '5' OR '6' OR '8'
 16252                            OR '9' OR 'G' OR 'S'
 16253        MOVE PB-C-AH-REFUND-OVERRIDE
 16254                                 TO CP-EARNING-METHOD.
 16255
 16256     if pb-company-id = 'AHL'
 16257        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16258        if cp-class-code = spaces
 16259           move zeros            to cp-class-code
 16260        end-if
 16261     ELSE
 16262        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16263     END-IF
 16264*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16265     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16266     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16267                                    CP-RATING-BENEFIT-AMT.
 16268     IF CP-STATE-STD-ABBRV = 'OR'
 16269         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16270                                         PB-CI-AH-TERM.
 16271     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16272     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16273     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16274     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16275     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16276     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 293
* EL050.cbl
 16277
 16278     IF CP-STATE-STD-ABBRV = 'OH'
 16279        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16280                                AND 'CID' AND 'DCC' AND 'AHL')
 16281           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16282              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16283              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16284              MOVE '6' TO CP-EARNING-METHOD
 16285           END-IF
 16286        END-IF
 16287        IF PB-COMPANY-ID = 'CID'
 16288           IF NO-LIFE-COVERAGE
 16289              IF CP-CRITICAL-PERIOD
 16290                 MOVE '2'       TO CP-EARNING-METHOD
 16291              ELSE
 16292                 MOVE '6'       TO CP-EARNING-METHOD
 16293              END-IF
 16294           ELSE
 16295              IF WS-LF-COVERAGE-TYPE = 'L'
 16296                 MOVE '2'       TO CP-EARNING-METHOD
 16297              ELSE
 16298                 IF (PB-CI-LF-TERM > +60) OR
 16299                    (WS-LF-EARNINGS-CALC = '5')
 16300                    IF CP-CRITICAL-PERIOD
 16301                       MOVE '2'  TO CP-EARNING-METHOD
 16302                    ELSE
 16303                       MOVE '6'  TO CP-EARNING-METHOD
 16304                    END-IF
 16305                 ELSE
 16306                    MOVE '1'     TO CP-EARNING-METHOD
 16307                 END-IF
 16308              END-IF
 16309           END-IF
 16310        END-IF
 16311     END-IF
 16312
 16313*    IF CP-STATE-STD-ABBRV = 'VA'
 16314*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16315*          IF CP-ORIGINAL-TERM GREATER 61
 16316*             MOVE '6' TO CP-EARNING-METHOD
 16317*          ELSE
 16318*             MOVE '1' TO CP-EARNING-METHOD.
 16319
 16320     IF WS-DEFAULT-APR NOT NUMERIC
 16321         MOVE ZEROS TO WS-DEFAULT-APR.
 16322     IF CP-EARN-AS-NET-PAY
 16323         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16324            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16325                MOVE WS-DEFAULT-APR
 16326                                 TO  CP-LOAN-APR
 16327                MOVE ER-3780     TO  WS-ERROR
 16328                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16329            ELSE
 16330                MOVE ER-3781     TO  WS-ERROR
 16331                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16332     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16333     IF PB-COMPANY-ID = 'DCC'
 16334        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 294
* EL050.cbl
 16335        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16336        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16337     END-IF
 16338     IF PB-COMPANY-ID = 'DCC'
 16339        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16340        AND (CP-EARNING-METHOD = 'D')
 16341        AND (CP-CANCEL-REASON NOT = 'R')
 16342        CONTINUE
 16343     ELSE
 16344        GO TO 3750-CONTINUE
 16345     END-IF
 16346     MOVE ' '                    TO DD-IU-SW
 16347     IF NOT PDEF-MASTER-FOUND
 16348        MOVE ' '                 TO PDEF-MASTER-SW
 16349        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16350        MOVE PB-STATE            TO ERPDEF-STATE
 16351        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16352        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16353        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16354        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16355        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16356        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16357        IF PDEF-MASTER-FOUND
 16358           MOVE 'N'              TO PDEF-MASTER-SW
 16359           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16360           IF PDEF-MASTER-FOUND
 16361              IF (ERPDEF-KEY-SAVE (1:16) =
 16362                           PD-CONTROL-PRIMARY (1:16))
 16363                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16364                 CONTINUE
 16365              ELSE
 16366                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16367                 IF (ERPDEF-KEY-SAVE (1:16) =
 16368                           PD-CONTROL-PRIMARY (1:16))
 16369                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16370                    CONTINUE
 16371                 ELSE
 16372                    MOVE ER-2740 TO WS-ERROR
 16373                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16374                    GO TO 3770-CHECK-REFUNDS
 16375                 END-IF
 16376              END-IF
 16377           END-IF
 16378           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16379        END-IF
 16380     END-IF
 16381     IF PDEF-MASTER-FOUND
 16382        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16383           (V1 > +8)
 16384           OR (PD-PROD-CODE (V1) = 'I')
 16385        END-PERFORM
 16386        IF V1 < +9
 16387           SET DD-IU-PRESENT        TO TRUE
 16388        END-IF
 16389        IF WS-AH-DCC-TRUNC = 'T'
 16390           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16391        ELSE
 16392           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 295
* EL050.cbl
 16393        END-IF
 16394        EVALUATE TRUE
 16395           WHEN WS-TERM > +168
 16396              MOVE 15               TO V1
 16397           WHEN WS-TERM > +156
 16398              MOVE 14               TO V1
 16399           WHEN WS-TERM > +144
 16400              MOVE 13               TO V1
 16401           WHEN WS-TERM > +132
 16402              MOVE 12               TO V1
 16403           WHEN WS-TERM > +120
 16404              MOVE 11               TO V1
 16405           WHEN WS-TERM > +108
 16406              MOVE 10               TO V1
 16407           WHEN WS-TERM > +96
 16408              MOVE 9                TO V1
 16409           WHEN WS-TERM > +84
 16410              MOVE 8                TO V1
 16411           WHEN WS-TERM > +72
 16412              MOVE 7                TO V1
 16413           WHEN WS-TERM > +60
 16414              MOVE 6                TO V1
 16415           WHEN WS-TERM > +48
 16416              MOVE 5                TO V1
 16417           WHEN WS-TERM > +36
 16418              MOVE 4                TO V1
 16419           WHEN WS-TERM > +24
 16420              MOVE 3                TO V1
 16421           WHEN WS-TERM > +12
 16422              MOVE 2                TO V1
 16423           WHEN OTHER
 16424              MOVE 1                TO V1
 16425        END-EVALUATE
 16426
 16427        EVALUATE TRUE
 16428*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16429*             < +13)
 16430*             AND (DD-IU-PRESENT)
 16431*             MOVE 2                TO V2
 16432*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16433*             MOVE 1                TO V2
 16434           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16435              MOVE 2                TO V2
 16436           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16437              MOVE 3                TO V2
 16438           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16439              MOVE 4                TO V2
 16440           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16441              MOVE 5                TO V2
 16442           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16443              MOVE 6                TO V2
 16444           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16445              MOVE 7                TO V2
 16446           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16447              MOVE 8                TO V2
 16448           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16449              MOVE 9                TO V2
 16450           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 296
* EL050.cbl
 16451              MOVE 10               TO V2
 16452           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16453              MOVE 11               TO V2
 16454           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16455              MOVE 12               TO V2
 16456           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16457              MOVE 13               TO V2
 16458           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16459              MOVE 14               TO V2
 16460           WHEN OTHER
 16461              MOVE 15               TO V2
 16462        END-EVALUATE
 16463
 16464        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16465                                 TO CP-DDF-LO-FACT
 16466        MOVE PD-UEP-FACTOR (V1 V2)
 16467                                 TO CP-DDF-HI-FACT
 16468
 16469        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16470        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16471        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16472           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16473        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16474        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16475        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16476           + PD-1ST-YR-ADMIN-ALLOW
 16477
 16478        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16479*       IF PI-CLP-YN = 'Y'
 16480*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16481*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16482*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16483*       END-IF
 16484
 16485        IF DD-IU-PRESENT
 16486           MOVE 'I'              TO CP-EARNING-METHOD
 16487        END-IF
 16488        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16489                                     CP-CLP-RATE-UP
 16490        IF CP-IU-RATE-UP NOT = ZEROS
 16491           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16492              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16493           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16494              / (1 - WS-WORK-FACT)
 16495        END-IF
 16496     END-IF
 16497     .
 16498 3750-CONTINUE.
 16499     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16500
 16501     IF CP-REFUND-TYPE-USED NOT = SPACE
 16502         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16503
 16504     IF CP-ERROR-RATE-IS-ZERO OR
 16505        CP-ERROR-RATE-NOT-FOUND
 16506        MOVE ER-2740             TO WS-ERROR
 16507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 297
* EL050.cbl
 16509     IF CP-ERROR-RATE-FILE-NOTOPEN
 16510        MOVE ER-2617             TO WS-ERROR
 16511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16512     IF PB-COMPANY-ID = 'DCC'
 16513        AND PB-CI-ENTRY-STATUS = 'M'
 16514        MOVE +0                  TO PB-C-AH-REF-CALC
 16515     ELSE
 16516        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16517     END-IF
 16518     IF PB-COMPANY-ID = 'DCC'
 16519        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16520        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16521        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16522        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16523        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16524        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16525        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16526        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16527*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16528     END-IF
 16529     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 298
* EL050.cbl
 16531
 16532 3770-CHECK-REFUNDS.
 16533
 16534     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16535        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16536           MOVE ER-2766          TO WS-ERROR
 16537           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16538           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16539           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16540              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16541
 16542     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16543        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16544           MOVE ER-2766          TO WS-ERROR
 16545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16546           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16547           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16548              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16549
 16550     IF PB-COMP-LF-CANCEL
 16551        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16552        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16553           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16554              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16555
 16556     IF PB-COMP-AH-CANCEL
 16557        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16558        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16559           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16560              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16561
 16562     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16563             GIVING WS-UNSIGN-WRK1
 16564     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16565             GIVING WS-UNSIGN-WRK2.
 16566
 16567     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16568         MOVE ZERO TO WS-UNSIGN-WRK1.
 16569
 16570     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16571         MOVE ZERO TO WS-UNSIGN-WRK2.
 16572
 16573     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16574
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 299
* EL050.cbl
 16576
 16577 3772-CONTINUE.
 16578
 16579**********************************
 16580*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16581*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16582*** DOUBLES THE TOLERANCE AMOUNT.
 16583***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16584**********************************
 16585     IF PB-COMPANY-ID = 'MON'
 16586     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16587         IF WS-REF-REJECT-SW = SPACE
 16588             MOVE ER-2754        TO WS-ERROR
 16589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16590           ELSE
 16591             MOVE ER-2736        TO WS-ERROR
 16592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16593**********************************
 16594
 16595 3773-CONTINUE.
 16596
 16597     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16598        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16599           MOVE ER-2723          TO WS-ERROR
 16600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16601
 16602     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16603        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16604           MOVE ER-2724          TO WS-ERROR
 16605           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16606
 16607     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16608         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16609             (1 + WS-LF-REFUND-OVS-PCT)
 16610     ELSE
 16611         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16612
 16613     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16614         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16615             (1 - WS-TOL-LF-REFUND-PCT)
 16616     ELSE
 16617         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16618
 16619     IF (PB-COMPANY-ID = 'DCC')
 16620        AND (PB-CI-ENTRY-STATUS = 'M')
 16621        AND (PB-C-LF-CANCEL-AMT > +0)
 16622        MOVE ER-3843             TO WS-ERROR
 16623        PERFORM 9900-ERROR-FORMAT
 16624                                 THRU 9900-EXIT
 16625     END-IF
 16626     EVALUATE TRUE
 16627        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16628           CONTINUE
 16629        WHEN PB-C-LF-CANCEL-AMT = +0
 16630                 AND PB-C-LF-REF-CALC > +0
 16631           CONTINUE
 16632        WHEN WS-LF-REFUND-OVS-AMT = 0
 16633                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 300
* EL050.cbl
 16634           CONTINUE
 16635        WHEN OTHER
 16636           IF WS-TOL-LF-REFUND  = +0
 16637              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16638           END-IF
 16639           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16640                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16641                          (PB-C-LF-CANCEL-AMT))
 16642              CONTINUE
 16643           ELSE
 16644              IF WS-LF-REFUND-OVS-AMT = +0
 16645                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16646              END-IF
 16647              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16648                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16649                                       PB-C-LF-CANCEL-AMT)
 16650                 CONTINUE
 16651              ELSE
 16652                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16653                   MOVE ER-2754   TO  WS-ERROR
 16654                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16655                 ELSE
 16656                    MOVE ER-2736   TO  WS-ERROR
 16657                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16658                 END-IF
 16659              END-IF
 16660           END-IF
 16661     END-EVALUATE.
 16662
 16663     EVALUATE TRUE
 16664        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16665           CONTINUE
 16666        WHEN PB-C-LF-CANCEL-AMT = +0
 16667                 AND PB-C-LF-REF-CALC > +0
 16668           CONTINUE
 16669        WHEN OTHER
 16670           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16671               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16672              CONTINUE
 16673           ELSE
 16674              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16675               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16676                CONTINUE
 16677              ELSE
 16678                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16679                     MOVE ER-2754   TO  WS-ERROR
 16680                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16681                 ELSE
 16682                     MOVE ER-2736   TO  WS-ERROR
 16683                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16684                 END-IF
 16685              END-IF
 16686           END-IF
 16687     END-EVALUATE.
 16688
 16689     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16690         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16691             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 301
* EL050.cbl
 16692     ELSE
 16693         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16694
 16695     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16696         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16697             (1 - WS-TOL-AH-REFUND-PCT)
 16698     ELSE
 16699         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16700
 16701     IF (PB-COMPANY-ID = 'DCC')
 16702        AND (PB-CI-ENTRY-STATUS = 'M')
 16703        AND (PB-C-AH-CANCEL-AMT > +0)
 16704        MOVE ER-3843             TO WS-ERROR
 16705        PERFORM 9900-ERROR-FORMAT
 16706                                 THRU 9900-EXIT
 16707     END-IF
 16708     EVALUATE TRUE
 16709        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16710           CONTINUE
 16711*       WHEN PB-C-AH-REF-CALC = +0 AND
 16712*                  PB-C-AH-CANCEL-AMT > +0
 16713        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16714                   PB-C-AH-REF-CALC > +0
 16715           CONTINUE
 16716        WHEN WS-AH-REFUND-OVS-AMT = +0
 16717                AND WS-TOL-AH-REFUND = +0
 16718           CONTINUE
 16719        WHEN OTHER
 16720           IF WS-TOL-AH-REFUND = +0
 16721              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16722           END-IF
 16723           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16724               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16725                                         PB-C-AH-CANCEL-AMT)
 16726              CONTINUE
 16727           ELSE
 16728              IF WS-AH-REFUND-OVS-AMT = +0
 16729                 MOVE +9999999.99 TO
 16730                         WS-AH-REFUND-OVS-AMT
 16731              END-IF
 16732              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16733                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16734                                         PB-C-AH-CANCEL-AMT)
 16735                 CONTINUE
 16736              ELSE
 16737                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16738                    MOVE ER-2754   TO  WS-ERROR
 16739                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16740                 ELSE
 16741                    MOVE ER-2736   TO  WS-ERROR
 16742                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16743                 END-IF
 16744              END-IF
 16745           END-IF
 16746     END-EVALUATE.
 16747
 16748     EVALUATE TRUE
 16749        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 302
* EL050.cbl
 16750           CONTINUE
 16751*       WHEN PB-C-AH-REF-CALC > +0 AND
 16752*                  PB-C-AH-CANCEL-AMT = +0
 16753        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16754                   PB-C-AH-REF-CALC = +0
 16755           CONTINUE
 16756        WHEN OTHER
 16757           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16758               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16759              CONTINUE
 16760           ELSE
 16761              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16762                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16763                 CONTINUE
 16764              ELSE
 16765                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16766                     MOVE ER-2754   TO  WS-ERROR
 16767                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16768                 ELSE
 16769                     MOVE ER-2736   TO  WS-ERROR
 16770                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16771                 END-IF
 16772              END-IF
 16773           END-IF
 16774     END-EVALUATE.
 16775
 16776     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16777        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16778        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16779           AND  PB-C-LF-REF-CALC < +1.00
 16780           AND  PB-C-AH-REF-CALC < +1.00
 16781           CONTINUE
 16782        ELSE
 16783           IF (PB-COMPANY-ID = 'DCC')
 16784              AND (PB-CI-ENTRY-STATUS = 'M')
 16785              CONTINUE
 16786           ELSE
 16787              MOVE ER-2741       TO WS-ERROR
 16788              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16789           END-IF
 16790        END-IF
 16791     END-IF
 16792
 16793     IF (PB-C-LF-CANCEL-AMT = ZERO
 16794        AND WS-LF-BENEFIT-CD NOT = ZERO
 16795        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16796        AND PB-C-LF-REF-CALC NOT = ZERO)
 16797        OR
 16798        (PB-C-LF-CANCEL-AMT = ZERO
 16799        AND WS-LF-BENEFIT-CD NOT = ZERO
 16800        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16801             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16802                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16803                NEXT SENTENCE
 16804             ELSE
 16805                MOVE ER-2739        TO WS-ERROR
 16806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16807
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 303
* EL050.cbl
 16808     IF (PB-C-AH-CANCEL-AMT = ZERO
 16809        AND WS-AH-BENEFIT-CD NOT = ZERO
 16810        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16811        AND PB-C-AH-REF-CALC NOT = ZERO)
 16812        OR
 16813        (PB-C-AH-CANCEL-AMT = ZERO
 16814        AND WS-AH-BENEFIT-CD NOT = ZERO
 16815        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16816             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16817                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16818                NEXT SENTENCE
 16819             ELSE
 16820                MOVE ER-2738        TO WS-ERROR
 16821                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16822
 16823 3775-OVER-REF-CHK.
 16824
 16825     IF PB-CI-ENTRY-STATUS = '5'
 16826        GO TO 3780-UPDATE-CANCEL-CERT.
 16827
 16828     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16829                              PB-CI-LF-ALT-PREMIUM-AMT.
 16830
 16831     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16832        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16833                                 PB-C-LF-REF-CALC
 16834      ELSE
 16835        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16836                                 PB-C-LF-CANCEL-AMT.
 16837
 16838     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16839        MOVE ER-2755             TO WS-ERROR
 16840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16841
 16842     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16843
 16844     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16845        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16846                                 PB-C-AH-REF-CALC
 16847      ELSE
 16848        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16849                                 PB-C-AH-CANCEL-AMT.
 16850
 16851     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16852        MOVE ER-2778             TO WS-ERROR
 16853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16854
 16855     IF PB-CI-OB-FLAG NOT = 'Z'
 16856        NEXT SENTENCE
 16857       ELSE
 16858         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16859            MOVE ER-2757           TO WS-ERROR
 16860            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16861
 16862 3780-UPDATE-CANCEL-CERT.
 16863
 16864     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16865        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 304
* EL050.cbl
 16866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16867
 16868     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16869         MOVE ER-2729              TO WS-ERROR
 16870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16871
 16872     IF PB-CI-LF-BENEFIT-CD = ZERO
 16873         GO TO 3780-UPDATE-CONT-1.
 16874
 16875     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16876         GO TO 3780-UPDATE-CONT-1.
 16877
 16878     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16879       AND
 16880        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16881       AND
 16882        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16883       AND
 16884        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16885            NEXT SENTENCE
 16886       ELSE
 16887        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16888          AND
 16889***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16890***       AND
 16891           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16892            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16893               MOVE ER-2730      TO WS-ERROR
 16894               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16895               GO TO 3999-END-EDIT
 16896            ELSE
 16897               GO TO 3999-END-EDIT
 16898        ELSE
 16899            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16900               MOVE ER-2765           TO WS-ERROR
 16901               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16902               GO TO 3785-CHECK-NH.
 16903*              GO TO 3999-END-EDIT.
 16904
 16905 3780-UPDATE-CONT-1.
 16906     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16907
 16908     IF PB-CI-AH-BENEFIT-CD = ZERO
 16909         GO TO 3780-UPDATE-CONT-2.
 16910
 16911     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16912         GO TO 3780-UPDATE-CONT-2.
 16913
 16914     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16915
 16916     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16917       AND
 16918        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16919       AND
 16920        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16921       AND
 16922        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16923            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 305
* EL050.cbl
 16924       ELSE
 16925        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16926          AND
 16927***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16928***       AND
 16929           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16930           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16931            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16932               MOVE ER-2773      TO WS-ERROR
 16933               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16934               GO TO 3999-END-EDIT
 16935            ELSE
 16936               GO TO 3999-END-EDIT
 16937            END-IF
 16938           ELSE
 16939             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16940                IF MSTR-CERT-NO = W-CL-CERT-NO
 16941                   MOVE ER-2890 TO WS-ERROR
 16942                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16943                   GO TO 3999-END-EDIT
 16944                ELSE
 16945                   MOVE ER-2898 TO WS-ERROR
 16946                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16947                   GO TO 3999-END-EDIT
 16948                END-IF
 16949             ELSE
 16950                GO TO 3785-CHECK-NH
 16951             END-IF
 16952           END-IF
 16953          ELSE
 16954            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16955              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16956                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16957                   IF MSTR-CERT-NO = W-CL-CERT-NO
 16958                      MOVE ER-2890 TO WS-ERROR
 16959                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16960                      GO TO 3999-END-EDIT
 16961                   ELSE
 16962                      MOVE ER-2898 TO WS-ERROR
 16963                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16964                      GO TO 3999-END-EDIT
 16965                   END-IF
 16966                ELSE
 16967                   MOVE ER-2765 TO WS-ERROR
 16968                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16969                   GO TO 3785-CHECK-NH
 16970                END-IF
 16971              ELSE
 16972               MOVE ER-2765      TO WS-ERROR
 16973               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16974               GO TO 3785-CHECK-NH.
 16975*              GO TO 3999-END-EDIT.
 16976
 16977 3780-UPDATE-CONT-2.
 16978
 16979     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16980        AND WS-LF-BENEFIT-CD = ZERO
 16981           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 306
* EL050.cbl
 16982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16983
 16984     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16985        AND WS-AH-BENEFIT-CD = ZERO
 16986           MOVE ER-2744           TO WS-ERROR
 16987           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16988
 16989     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16990        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16991        AND
 16992        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16993         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 16994           MOVE ER-2746           TO WS-ERROR
 16995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16996
 16997     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16998       AND
 16999        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17000             MOVE ER-2737        TO WS-ERROR
 17001             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17002
 17003     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17004       AND
 17005        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17006             MOVE ER-2737        TO WS-ERROR
 17007             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17008
 17009     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17010         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17011             OR 'CID' OR 'DCC' OR 'AHL'
 17012             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17013         ELSE
 17014             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17015                 MOVE ER-2768    TO WS-ERROR
 17016                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17017             ELSE
 17018                 MOVE ER-2756    TO WS-ERROR
 17019                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17020
 17021     IF CERT-PEND-ISSUE-RETURNED
 17022        MOVE ER-2772             TO WS-ERROR
 17023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17024 3785-CHECK-NH.
 17025     IF PB-STATE NOT = 'NH'
 17026        GO TO 3999-END-EDIT
 17027     END-IF
 17028
 17029     MOVE ER-2796                TO WS-ERROR
 17030     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17031     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17032        OR (CM-NH-INTERFACE-SW = 'Y')
 17033        MOVE ER-2793             TO WS-ERROR
 17034        PERFORM 9900-ERROR-FORMAT
 17035                                 THRU 9900-EXIT
 17036     END-IF
 17037     MOVE +0                     TO WS-PAYMENT-AMT
 17038     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17039        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 307
* EL050.cbl
 17040     END-IF
 17041     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17042        GO TO 3999-END-EDIT
 17043     END-IF
 17044     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17045     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17046     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17047        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17048     END-IF
 17049     MOVE '1'                    TO DC-OPTION-CODE
 17050     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17051     IF NO-CONVERSION-ERROR
 17052        IF DC-ELAPSED-DAYS < +16
 17053           GO TO 3999-END-EDIT
 17054        END-IF
 17055     END-IF
 17056     MOVE +0                     TO DC-ELAPSED-DAYS
 17057     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17058     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17059     MOVE '1'                    TO DC-OPTION-CODE
 17060     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17061     IF NO-CONVERSION-ERROR
 17062        IF DC-ELAPSED-DAYS > +30
 17063           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17064        ELSE
 17065           GO TO 3999-END-EDIT
 17066        END-IF
 17067     ELSE
 17068        GO TO 3999-END-EDIT
 17069     END-IF
 17070     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17071        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17072           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17073     IF WS-PAYMENT-AMT < 600.00
 17074        GO TO 3999-END-EDIT
 17075     END-IF
 17076     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17077
 17078     IF (ERMAIL-FOUND = ' ')
 17079         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17080         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17081        GO TO 3999-END-EDIT
 17082     END-IF
 17083     MOVE ER-2795                TO WS-ERROR
 17084     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17085
 17086     GO TO 3999-END-EDIT.
 17087******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 308
* EL050.cbl
 17089 3990-FILES-NOT-OPEN.
 17090
 17091     MOVE ER-2617                TO WS-ERROR.
 17092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17093     GO TO 9990-RETURN.
 17094
 17095 3999-END-EDIT.
 17096
 17097     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17098
 17099     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17100         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17101         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17102             PERFORM 9250-UNLOCK-RETURN
 17103             GO TO 9990-RETURN
 17104          ELSE
 17105             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17106             GO TO 9990-RETURN.
 17107
 17108     IF PB-CANCELLATION
 17109          GO TO 9990-RETURN.
 17110
 17111     IF CERT-WAS-NOT-FOUND
 17112        MOVE SPACES              TO CERTIFICATE-MASTER.
 17113
 17114     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17115
 17116     IF CERT-WAS-FOUND
 17117         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17118             PERFORM 9250-UNLOCK-RETURN
 17119          ELSE
 17120            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17121      ELSE
 17122         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17123
 17124     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17125        IF PB-COMPANY-ID = 'DCC' AND
 17126           (PB-CARRIER = '2' OR '4' OR '6')
 17127              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17128        END-IF
 17129     END-IF.
 17130
 17131     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17132         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17133     END-IF.
 17134     move ' '                    to ws-ins-age-defaulted
 17135     perform 8150-read-elcrtt    thru 8150-exit
 17136     if ws-ins-age-defaulted = 'Y'
 17137        move er-1573             to ws-error
 17138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17139     end-if
 17140
 17141     if ws-jnt-age-defaulted = 'Y'
 17142        move er-1574             to ws-error
 17143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17144     end-if
 17145
 17146     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 309
* EL050.cbl
 17147     IF ((PB-COMPANY-ID = 'DCC')
 17148        AND (WS-NO-SECURE-PAY))
 17149                  OR
 17150        (WS-LF-SPECIAL-CALC-CD = 'O'
 17151        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17152        SET SKIP-ADDR-EDIT       TO TRUE
 17153     END-IF
 17154     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17155        AND (NOT SKIP-ADDR-EDIT)
 17156        MOVE ER-2963             TO WS-ERROR
 17157        PERFORM 9900-ERROR-FORMAT
 17158                                 THRU 9900-EXIT
 17159        GO TO 9990-RETURN
 17160     END-IF
 17161     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17162     IF ERPNDM-FOUND NOT = 'X'
 17163        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17164           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17165           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17166           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17167           AND (NOT SKIP-ADDR-EDIT)
 17168           MOVE ER-2694          TO WS-ERROR
 17169           PERFORM 9900-ERROR-FORMAT
 17170                                 THRU 9900-EXIT
 17171        END-IF
 17172        MOVE ' '                 TO STATE-RECORD-ERROR
 17173        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17174        MOVE PM-STATE            TO CNTL-ACCESS
 17175        MOVE '3'                 TO CNTL-REC-TYPE
 17176        MOVE +0                  TO CNTL-SEQ-NO
 17177        MOVE '0'                 TO RC-SW-2
 17178        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17179        IF (NO-STATE-RECORD)
 17180           OR (CF-RECORD-TYPE NOT = '3')
 17181           OR (PM-STATE NOT = CF-STATE-CODE)
 17182           IF (PM-STATE = SPACES)
 17183              AND (SKIP-ADDR-EDIT)
 17184              CONTINUE
 17185           ELSE
 17186              MOVE ER-2963       TO WS-ERROR
 17187              PERFORM 9900-ERROR-FORMAT
 17188                                 THRU 9900-EXIT
 17189           END-IF
 17190        END-IF
 17191        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17192           MOVE ER-2883          TO WS-ERROR
 17193           PERFORM 9900-ERROR-FORMAT
 17194                                 THRU 9900-EXIT
 17195        END-IF
 17196        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17197           MOVE ' '                 TO STATE-RECORD-ERROR
 17198           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17199           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17200           MOVE '3'                 TO CNTL-REC-TYPE
 17201           MOVE +0                  TO CNTL-SEQ-NO
 17202           MOVE '0'                 TO RC-SW-2
 17203           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17204           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 310
* EL050.cbl
 17205              OR (CF-RECORD-TYPE NOT = '3')
 17206              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17207              MOVE ER-2964          TO WS-ERROR
 17208              PERFORM 9900-ERROR-FORMAT
 17209                                    THRU 9900-EXIT
 17210           END-IF
 17211        END-IF
 17212     ELSE
 17213        IF NOT SKIP-ADDR-EDIT
 17214           MOVE ER-2393          TO WS-ERROR
 17215           PERFORM 9900-ERROR-FORMAT
 17216                                 THRU 9900-EXIT
 17217        END-IF
 17218     END-IF
 17219
 17220     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17221
 17222     IF (ERMAIL-FOUND = ' ' AND
 17223        ERPNDM-FOUND = ' ')
 17224        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17225           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17226           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17227          OR
 17228           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17229          OR
 17230           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17231           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17232           GO TO 3999-UNLOCK-ERMAIL.
 17233
 17234     IF ERPNDM-FOUND = 'X'
 17235        GO TO 3999-UNLOCK-ERMAIL.
 17236
 17237     IF PM-INSURED-LAST-NAME      = SPACES
 17238        AND PM-INSURED-FIRST-NAME = SPACES
 17239        AND PM-ADDRESS-LINE-1     = SPACES
 17240        AND PM-ADDRESS-LINE-2     = SPACES
 17241        AND PM-CITY-STATE         = SPACES
 17242        AND PM-CRED-BENE-NAME     = SPACES
 17243        AND PM-CRED-BENE-ADDR     = SPACES
 17244        AND PM-CRED-BENE-CTYST    = SPACES
 17245        GO TO 3999-UNLOCK-ERMAIL
 17246     END-IF
 17247
 17248     MOVE SPACES                 TO MAILING-DATA.
 17249
 17250     MOVE 'MA'                   TO MA-RECORD-ID.
 17251     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17252     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17253     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17254     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17255     MOVE PB-SV-STATE            TO MA-STATE.
 17256     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17257     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17258
 17259     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17260     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17261
 17262     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 311
* EL050.cbl
 17263        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17264     ELSE
 17265        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17266        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17267        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17268
 17269     GO TO 9990-RETURN.
 17270
 17271 3999-UNLOCK-ERMAIL.
 17272     IF ERMAIL-FOUND = ' '
 17273        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17274
 17275     GO TO 9990-RETURN.
 17276******************************************************************
 17277
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 312
* EL050.cbl
 17279 4000-UPDATE-CANCELLED-CERT.
 17280     IF CERT-WAS-NOT-FOUND
 17281        GO TO 4299-EXIT.
 17282
 17283*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17284     IF PB-C-NH-INT-ON-REFS > ZEROS
 17285        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17286     END-IF
 17287     IF PB-C-REF-INTERFACE-SW = 'Y'
 17288        MOVE PB-C-REF-INTERFACE-SW
 17289                                 TO CM-NH-INTERFACE-SW
 17290     END-IF
 17291     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17292     IF ERMAIL-FOUND = 'X'
 17293        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17294        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17295        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17296        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17297           MOVE ER-2694          TO WS-ERROR
 17298           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17299     END-IF
 17300
 17301     IF PB-C-POST-CARD-IND = 'Y'
 17302        MOVE +8                  TO SUB
 17303*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17304        IF ERMAIL-FOUND = ' '
 17305           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17306              (SUB > +7)
 17307              OR (MA-MAIL-STATUS (SUB) = '1')
 17308           END-PERFORM
 17309        END-IF
 17310        IF (SUB > +7)
 17311           OR (ERMAIL-FOUND = 'X')
 17312           MOVE ER-3789          TO WS-ERROR
 17313           PERFORM 9900-ERROR-FORMAT
 17314                                 THRU 9900-EXIT
 17315        END-IF
 17316     ELSE
 17317        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17318     END-IF
 17319
 17320     IF ERMAIL-FOUND = ' '
 17321        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17322     END-IF.
 17323
 17324     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17325
 17326     IF PB-CI-OB-FLAG = 'Z'
 17327        GO TO 4150-SUMMARY-CERT-CANCEL.
 17328
 17329     IF PB-C-LF-CANCEL-VOIDED
 17330         PERFORM 4200-REVERSE-LF-CANCEL.
 17331     IF PB-C-AH-CANCEL-VOIDED
 17332         PERFORM 4200-REVERSE-AH-CANCEL.
 17333
 17334 4100-APPLY-LF-CANCEL.
 17335
 17336     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 313
* EL050.cbl
 17337
 17338 4100-CHECK-LF-ERRORS.
 17339
 17340     ADD +1                       TO WS-SUB.
 17341
 17342     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17343        IF LF-COVERAGE-CANCELLED
 17344           GO TO 4100-LF-CANCEL-CONT
 17345        ELSE
 17346           GO TO 4100-UPDATE-LF-COVERAGE.
 17347
 17348     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17349                                   ER-2729 OR
 17350                                   ER-2730 OR
 17351                                   ER-2731 OR
 17352                                   ER-2732 OR
 17353                                   ER-2737 OR
 17354                                   ER-2740 OR
 17355                                   ER-2743 OR
 17356                                   ER-2749 OR
 17357                                   ER-2750 OR
 17358                                   ER-2755 OR
 17359                                   ER-2757 OR
 17360                                   ER-2760 OR
 17361                                   ER-2772 OR
 17362                                   ER-2774 OR
 17363                                   ER-2776 OR
 17364                                   ER-2794
 17365        GO TO 4100-UPDATE-LF-COVERAGE.
 17366
 17367     GO TO 4100-CHECK-LF-ERRORS.
 17368
 17369 4100-UPDATE-LF-COVERAGE.
 17370
 17371     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17372     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17373     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17374        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17375     END-IF
 17376     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17377                                      TO CM-CREDIT-INTERFACE-SW-2.
 17378     IF CM-LF-CANCEL-DT = LOW-VALUE
 17379         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17380
 17381     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17382         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17383                                         CM-LF-STATUS-AT-CANCEL.
 17384
 17385     GO TO 4100-APPLY-AH-CANCEL.
 17386
 17387 4100-LF-CANCEL-CONT.
 17388     IF PB-C-LF-CANCEL-VOIDED
 17389         GO TO 4100-APPLY-AH-CANCEL.
 17390
 17391     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17392         GO TO 4100-APPLY-AH-CANCEL.
 17393
 17394     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 314
* EL050.cbl
 17395        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17396           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17397        ELSE
 17398           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17399
 17400     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17401     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17402
 17403     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17404         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17405
 17406     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17407        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17408         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17409         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17410
 17411     IF PB-RECORD-RETURNED
 17412        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17413      ELSE
 17414        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17415
 17416 4100-APPLY-AH-CANCEL.
 17417
 17418     MOVE +0                      TO WS-SUB.
 17419
 17420 4100-CHECK-AH-ERRORS.
 17421
 17422     ADD +1                       TO WS-SUB.
 17423
 17424     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17425        IF AH-COVERAGE-CANCELLED
 17426           GO TO 4100-AH-CANCEL-CONT
 17427        ELSE
 17428           GO TO 4100-UPDATE-AH-COVERAGE.
 17429
 17430     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17431                                   ER-2729 OR
 17432                                   ER-2732 OR
 17433                                   ER-2737 OR
 17434                                   ER-2740 OR
 17435                                   ER-2744 OR
 17436                                   ER-2749 OR
 17437                                   ER-2750 OR
 17438                                   ER-2755 OR
 17439                                   ER-2757 OR
 17440                                   ER-2760 OR
 17441                                   ER-2771 OR
 17442                                   ER-2772 OR
 17443                                   ER-2773 OR
 17444                                   ER-2775 OR
 17445                                   ER-2777 OR
 17446                                   ER-2778 OR
 17447                                   ER-2794
 17448        GO TO 4100-UPDATE-AH-COVERAGE.
 17449
 17450     GO TO 4100-CHECK-AH-ERRORS.
 17451
 17452 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 315
* EL050.cbl
 17453
 17454     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17455     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17456     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17457     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17458                                      TO CM-CREDIT-INTERFACE-SW-2.
 17459     IF CM-AH-CANCEL-DT = LOW-VALUE
 17460         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17461
 17462     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17463         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17464                                         CM-AH-STATUS-AT-CANCEL.
 17465
 17466     IF LF-COVERAGE-CANCELLED
 17467         IF PB-RECORD-RETURNED
 17468              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17469          ELSE
 17470              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17471
 17472     GO TO 4299-EXIT.
 17473
 17474 4100-AH-CANCEL-CONT.
 17475     IF PB-C-AH-CANCEL-VOIDED
 17476         GO TO 4299-EXIT.
 17477
 17478     if cm-credit-interface-sw-2 = ' '
 17479        if pb-fatal-errors or pb-unforced-errors
 17480           move '4'              to cm-credit-interface-sw-2
 17481        else
 17482           move '1'              to cm-credit-interface-sw-2
 17483        end-if
 17484     end-if
 17485     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17486         GO TO 4299-EXIT.
 17487
 17488     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17489        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17490           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17491        ELSE
 17492           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17493
 17494     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17495     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17496
 17497     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17498         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17499
 17500     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17501         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17502         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17503
 17504     IF PB-RECORD-RETURNED
 17505        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17506      ELSE
 17507        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17508
 17509     GO TO 4299-EXIT.
 17510
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 316
* EL050.cbl
 17511 4150-SUMMARY-CERT-CANCEL.
 17512     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17513
 17514     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17515        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17516                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17517     ELSE
 17518        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17519                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17520
 17521     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17522        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17523                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17524     ELSE
 17525        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17526                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17527
 17528     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17529        NEXT SENTENCE
 17530     ELSE
 17531        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17532
 17533     GO TO 4299-EXIT.
 17534
 17535 4200-REVERSE-LF-CANCEL.
 17536     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17537
 17538     IF CM-LF-CANCEL-APPLIED
 17539        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17540        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17541        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17542
 17543     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17544
 17545     IF PB-RECORD-RETURNED
 17546        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17547       ELSE
 17548        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17549
 17550 4200-REVERSE-LF-EXIT.
 17551       EXIT.
 17552
 17553 4200-REVERSE-AH-CANCEL.
 17554     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17555
 17556     IF CM-AH-CANCEL-APPLIED
 17557        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17558        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17559        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17560
 17561     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17562
 17563     IF PB-RECORD-RETURNED
 17564        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17565       ELSE
 17566        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17567
 17568 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 317
* EL050.cbl
 17569       EXIT.
 17570
 17571 4299-EXIT.
 17572       EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 318
* EL050.cbl
 17574
 17575 4500-UPDATE-NEW-CERT.
 17576     IF CERT-WAS-FOUND
 17577         NEXT SENTENCE
 17578       ELSE
 17579         GO TO 4520-BUILD-NEW-KEY.
 17580
 17581     IF  CLASIC-CREATED-CERT
 17582         GO TO 4999-EXIT.
 17583
 17584     IF  CERT-WAS-CREATED-FOR-CLAIM
 17585         GO TO 4520-BUILD-NEW-KEY.
 17586
 17587     IF CERT-ADDED-BATCH
 17588        IF CM-RECORD-ID = 'CM'
 17589            GO TO 4999-EXIT.
 17590
 17591 4520-BUILD-NEW-KEY.
 17592* BUILD CONTROL PRIMARY
 17593
 17594     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17595                                       CM-COMPANY-CD-A1
 17596                                       CM-COMPANY-CD-A2
 17597                                       CM-COMPANY-CD-A4
 17598                                       CM-COMPANY-CD-A5.
 17599
 17600     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17601     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17602     MOVE PB-SV-STATE               TO CM-STATE.
 17603     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17604     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17605     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17606     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17607
 17608     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17609
 17610     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17611     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17612     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17613     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17614
 17615     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17616        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17617
 17618     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17619         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17620         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17621         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17622         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17623     ELSE
 17624         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17625
 17626     IF PB-COMPANY-ID   EQUAL  'CRI'
 17627         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17628         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17629         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17630         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17631         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 319
* EL050.cbl
 17632
 17633     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17634        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17635         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17636
 17637     IF PB-COMPANY-ID  = 'LBL'
 17638        IF PB-I-JOINT-COVERAGE
 17639            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17640                                           PB-I-MEMBER-NO
 17641            GO TO 4550-CONT-CERT-PROCESS.
 17642
 17643     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17644        NEXT SENTENCE
 17645     ELSE
 17646        GO TO 4540-BUILD-MEMBER-NO.
 17647
 17648******************************************************************
 17649*                                                                *
 17650*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17651*    FOR 'MON'.                                                  *
 17652*                                                                *
 17653******************************************************************
 17654
 17655     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17656     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17657     MOVE +1                     TO WS-SUB1
 17658                                    WS-SUB2.
 17659
 17660 4530-EDIT-MEMB-NAME.
 17661
 17662     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17663        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17664        ADD +1                       TO WS-SUB2.
 17665
 17666     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17667        ADD +1                       TO WS-SUB1
 17668        GO TO 4530-EDIT-MEMB-NAME.
 17669
 17670     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17671     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17672     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17673*    MOVE SPACE                      TO DC-OPTION-CODE.
 17674     SET  BIN-TO-GREG                TO TRUE.
 17675     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17676     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17677
 17678     GO TO 4550-CONT-CERT-PROCESS.
 17679
 17680******************************************************************
 17681*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17682******************************************************************
 17683
 17684 4540-BUILD-MEMBER-NO.
 17685
 17686     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17687         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17688         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17689         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 320
* EL050.cbl
 17690         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17691     ELSE
 17692         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17693
 17694     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17695        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17696         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17697
 17698 4550-CONT-CERT-PROCESS.
 17699
 17700*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17701*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17702*    ELSE
 17703*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17704
 17705     IF CERT-WAS-CREATED-FOR-CLAIM
 17706        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17707        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17708
 17709     IF CERT-AND-CLAIM-ONLINE
 17710        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17711        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17712
 17713     MOVE 'CM'                     TO CM-RECORD-ID.
 17714     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17715
 17716     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17717        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17718        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17719     ELSE
 17720        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17721        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17722
 17723     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17724     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17725     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17726     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17727     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17728     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17729     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17730                                      CM-LF-ITD-CANCEL-AMT
 17731                                      CM-LF-ITD-DEATH-AMT
 17732                                      CM-AH-ITD-AH-PMT
 17733                                      CM-AH-ITD-LUMP-PMT
 17734                                      CM-AH-ITD-CANCEL-AMT
 17735                                      CM-LF-NSP-PREMIUM-AMT
 17736                                      CM-AH-NSP-PREMIUM-AMT.
 17737*                                     CM-CLAIM-DEDUCT-WITHHELD
 17738*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17739     if pb-i-loan-apr = +99.9999
 17740        move zeros                 to cm-loan-apr
 17741     else
 17742        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17743     end-if
 17744     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17745     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17746     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17747     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 321
* EL050.cbl
 17748     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17749     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17750     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17751     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17752     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17753     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17754     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17755
 17756     IF PB-I-LIVES NOT NUMERIC
 17757         MOVE ZERO                 TO PB-I-LIVES.
 17758
 17759     IF PB-I-NUM-BILLED NOT NUMERIC
 17760         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17761
 17762     MOVE PB-I-LIVES               TO CM-LIVES.
 17763     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17764
 17765     IF PB-COMPANY-ID EQUAL  'DMD'
 17766         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17767         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17768
 17769     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17770     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17771     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17772     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17773     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17774     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17775
 17776     IF PB-I-LF-POLICY-FEE NUMERIC
 17777        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17778     ELSE
 17779        MOVE +0                    TO CM-LF-POLICY-FEE.
 17780
 17781     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17782        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17783        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17784     ELSE
 17785        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17786
 17787     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17788     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17789     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17790     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17791     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17792     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17793     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17794     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17795     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17796
 17797     IF PB-I-AH-POLICY-FEE NUMERIC
 17798        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17799     ELSE
 17800        MOVE +0                    TO CM-AH-POLICY-FEE.
 17801
 17802     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17803        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17804     ELSE
 17805        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 322
* EL050.cbl
 17806
 17807     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17808     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17809
 17810     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17811                                      CM-LF-DEATH-EXIT-DT
 17812                                      CM-AH-SETTLEMENT-EXIT-DT.
 17813
 17814*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17815*                       'TIH' OR 'OFL' OR 'FLA' OR
 17816*                       'TII' OR 'TMS' OR 'CRI' OR
 17817*                       'NCL'
 17818     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17819
 17820     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17821         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17822            MOVE '2'                TO CM-PREMIUM-TYPE.
 17823
 17824     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17825         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17826            MOVE '2'                TO CM-PREMIUM-TYPE.
 17827
 17828     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17829         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17830     ELSE
 17831         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17832         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17833
 17834     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17835     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17836     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17837     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17838     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17839     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17840     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17841     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17842
 17843     IF PB-NO-MONTHS-SKIPPED
 17844         MOVE SPACE                 TO CM-SKIP-CODE
 17845     ELSE
 17846         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17847
 17848     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17849     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17850                                       CM-LF-STATUS-AT-CANCEL.
 17851
 17852     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17853     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17854                                       CM-AH-STATUS-AT-CANCEL.
 17855
 17856     MOVE '1'                       TO CM-ENTRY-STATUS.
 17857
 17858     IF PB-REISSUED-CERT
 17859        MOVE '5'                    TO CM-ENTRY-STATUS.
 17860
 17861     IF PB-MONTHLY-CERT
 17862        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17863
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 323
* EL050.cbl
 17864     IF PB-CASH-CERT
 17865        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17866
 17867     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17868     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17869     IF PB-POLICY-IS-DECLINED
 17870        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17871
 17872     IF PB-POLICY-IS-VOIDED
 17873        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17874
 17875     IF PB-NEEDS-UNDERWRITING
 17876        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17877
 17878     IF PB-REIN-ONLY-CERT
 17879        MOVE '9'                    TO CM-ENTRY-STATUS.
 17880
 17881     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17882         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17883     ELSE
 17884         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17885
 17886     IF PB-RECORD-RETURNED
 17887        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17888      ELSE
 17889        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17890
 17891     IF PB-I-MAIL-ADDRS-PRESENT
 17892        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17893
 17894     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17895                                       CM-ENTRY-DT.
 17896
 17897 4999-EXIT.
 17898     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 324
* EL050.cbl
 17900
 17901 5000-PROCESS-REPS.
 17902     MOVE ' '                    TO AGTC-MASTER-SW
 17903     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17904     MOVE CO-TYPE                TO AGTC-TYPE
 17905     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17906     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17907     IF (AGTC-MASTER-SW NOT = 'N')
 17908        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17909        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17910        PERFORM 8583-READ-ERAGTC-NEXT
 17911                                 THRU 8583-EXIT
 17912     END-IF
 17913     IF AGTC-MASTER-SW = 'N'
 17914        CONTINUE
 17915     ELSE
 17916        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17917           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17918              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17919              MOVE 'Y'           TO AGTC-MASTER-SW
 17920           END-IF
 17921        END-IF
 17922     END-IF
 17923     .
 17924 5000-EXIT.
 17925     EXIT.
 17926 6370-EDIT-INPUT-LF-CODE.
 17927     move ' ' to ws-benefit-cd-chg-sw
 17928     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17929        MOVE +1                  TO SUB
 17930        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17931        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17932        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17933        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17934        GO TO 6370-SEARCH-LOOP.
 17935
 17936     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17937
 17938     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17939     MOVE SPACES                 TO CNTL-ACCESS.
 17940*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17941     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17942     MOVE +0                     TO CNTL-SEQ-NO.
 17943     MOVE '4' TO RC-SW-2.
 17944     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17945
 17946     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17947        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17948        GO TO 6370-NO-LF-FOUND.
 17949
 17950     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17951     MOVE +1                     TO SUB.
 17952
 17953 6370-SEARCH-LOOP.
 17954     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17955         GO TO 6370-NO-LF-FOUND.
 17956
 17957     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 325
* EL050.cbl
 17958        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17959           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17960           set benefit-code-chg to true
 17961        end-if
 17962        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17963        GO TO 6370-HER-NET-PAY-CHECK.
 17964
 17965     ADD 1   TO SUB.
 17966*    IF SUB GREATER 120
 17967     IF SUB GREATER 200
 17968         GO TO 6370-NO-LF-FOUND.
 17969
 17970     GO TO 6370-SEARCH-LOOP.
 17971
 17972 6370-NO-LF-FOUND.
 17973
 17974     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17975        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17976        set benefit-code-chg to true
 17977     end-if
 17978     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17979
 17980 6370-HER-NET-PAY-CHECK.
 17981
 17982     IF PB-COMPANY-ID = 'CID'
 17983        IF PB-SV-STATE = 'CA' OR 'MN'
 17984           IF PB-I-LF-BENEFIT-CD = '02'
 17985              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17986           ELSE
 17987              IF PB-I-LF-BENEFIT-CD = '04'
 17988                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17989              END-IF
 17990           END-IF
 17991        END-IF
 17992     END-IF
 17993
 17994     IF PB-COMPANY-ID NOT = 'HER'
 17995         GO TO 6370-EXIT.
 17996
 17997     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17998         GO TO 6370-EXIT.
 17999
 18000     IF PB-I-LF-TERM NOT NUMERIC
 18001         MOVE ZEROS              TO PB-I-LF-TERM.
 18002
 18003     IF PB-I-LOAN-TERM NOT NUMERIC
 18004         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18005
 18006     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18007         GO TO 6370-EXIT.
 18008
 18009     IF PB-I-LF-BENEFIT-CD = '33'
 18010         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18011
 18012     IF PB-I-LF-BENEFIT-CD = '34'
 18013         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18014
 18015 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 326
* EL050.cbl
 18016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 327
* EL050.cbl
 18018
 18019 6380-EDIT-INPUT-AH-CODE.
 18020     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18021        MOVE +1                  TO SUB
 18022        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18023        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18024        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18025        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18026        GO TO 6380-SEARCH-LOOP.
 18027
 18028     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18029
 18030     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18031     MOVE SPACES                 TO CNTL-ACCESS.
 18032     MOVE 'A'                    TO CNTL-REC-TYPE.
 18033*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18034     MOVE +0                     TO CNTL-SEQ-NO.
 18035     MOVE '5' TO RC-SW-2.
 18036     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18037
 18038     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18039        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18040        GO TO 6380-NO-AH-FOUND.
 18041
 18042     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18043     MOVE +1 TO SUB.
 18044
 18045 6380-SEARCH-LOOP.
 18046     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18047         GO TO 6380-NO-AH-FOUND.
 18048
 18049     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18050         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18051         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18052
 18053     ADD 1   TO SUB.
 18054     IF SUB GREATER THAN 96
 18055*    IF SUB GREATER THAN 300
 18056         GO TO 6380-NO-AH-FOUND.
 18057
 18058     GO TO 6380-SEARCH-LOOP.
 18059
 18060 6380-NO-AH-FOUND.
 18061
 18062     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18063
 18064     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18065         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18066     ELSE
 18067         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18068
 18069 6380-CSO-AH-ONLY-CHECKS.
 18070
 18071     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18072        NEXT SENTENCE
 18073      ELSE
 18074        GO TO 6380-EXIT.
 18075
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 328
* EL050.cbl
 18076     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18077         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18078
 18079
 18080     GO TO 6380-EXIT
 18081     .
 18082 6380-CSO-LIFE-WITH-AH-CHECKS.
 18083
 18084
 18085     .
 18086 6380-EXIT.
 18087     EXIT.
 18088
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 329
* EL050.cbl
 18090
 18091 6400-COMPUTE-EXTENSION-DAYS.
 18092
 18093******************************************************************
 18094*                                                                *
 18095*                   COMPUTE EXTENSION DAYS                       *
 18096*                                                                *
 18097*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18098*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18099*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18100*    THE EXTENSION DAYS.                                         *
 18101*                                                                *
 18102******************************************************************
 18103
 18104     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18105     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18106
 18107******************************************************************
 18108*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18109*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18110******************************************************************
 18111
 18112     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18113        COMPUTE WS-ODD-DAYS-OVER =
 18114               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18115     ELSE
 18116        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18117
 18118     IF WS-ODD-DAYS-OVER = ZEROS
 18119           GO TO 6499-EXIT
 18120     ELSE
 18121        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18122           IF WS-WDF-MONTH = 02
 18123              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18124              ADD 2       TO  WS-ODD-DAYS-OVER
 18125              GO TO 6499-EXIT
 18126           ELSE
 18127              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18128                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18129                 GO TO 6499-EXIT
 18130               ELSE
 18131                 GO TO 6499-EXIT
 18132        ELSE
 18133           GO TO 6499-EXIT.
 18134
 18135 6412-CHECK-TO-DAY.
 18136
 18137        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18138           IF WS-WDT-DAY = 28
 18139              ADD 2              TO WS-ODD-DAYS-OVER
 18140           ELSE
 18141              IF WS-WDT-DAY = 29
 18142                 ADD 1           TO WS-ODD-DAYS-OVER
 18143              ELSE
 18144                 NEXT SENTENCE
 18145        ELSE
 18146           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18147              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 330
* EL050.cbl
 18148
 18149     GO TO 6499-EXIT.
 18150
 18151
 18152 6415-CHECK-LEAP-YEAR.
 18153
 18154     IF DC-DAYS-IN-MONTH = 29
 18155        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18156
 18157 6415-EXIT.
 18158     EXIT.
 18159
 18160 6499-EXIT.
 18161      EXIT.
 18162
 18163 6500-END.
 18164     EXIT.
 18165
 18166
 18167******************************************************************
 18168************* PROCEDURE DIVISION FOR EL050 ***********************
 18169********************** ELC50PD END *******************************
 18170
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 331
* EL050.cbl
 18172
 18173**START***********************************************************
 18174*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18175*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18176******************************************************************
 18177*
 18178 6600-GET-STATE-MUNICIPAL-TAX.
 18179
 18180     IF PB-COMPANY-ID NOT = 'DMD'
 18181         GO TO 6640-EXIT.
 18182
 18183     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18184     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18185     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18186*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18187*
 18188***  Y2K PROJ 7744
 18189     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18190     SET BIN-TO-GREG          TO TRUE.
 18191     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18192
 18193     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18194
 18195     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18196     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18197
 18198
 18199* EXEC CICS HANDLE CONDITION
 18200*        INVREQ    (6610-START-BROWSE)
 18201*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18202*        NOTFND    (6630-END-OF-FILE)
 18203*    END-EXEC.
 18204*    MOVE '"$8JI                 ! # #00018186' TO DFHEIV0
 18205     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18207     MOVE X'2320233030303138313836' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0
 18209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18210
 18211
 18212 6610-START-BROWSE.
 18213
 18214
 18215* EXEC CICS HANDLE CONDITION
 18216*        NOTFND    (6630-END-OF-FILE)
 18217*        DISABLED  (6630-ERRESS-PROBLEM)
 18218*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18219*        ENDFILE   (6630-END-OF-FILE)
 18220*    END-EXEC.
 18221*    MOVE '"$IcJ''                ! $ #00018194' TO DFHEIV0
 18222     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18224     MOVE X'2420233030303138313934' TO DFHEIV0(25:11)
 18225     CALL 'kxdfhei1' USING DFHEIV0
 18226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18227
 18228
 18229
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 332
* EL050.cbl
 18230* EXEC CICS STARTBR
 18231*        DATASET (FILE-ID-ERRESS)
 18232*        RIDFLD  (WS-ERRESS-KEY)
 18233*        GTEQ
 18234*    END-EXEC.
 18235     MOVE 0
 18236       TO DFHEIV11
 18237*    MOVE '&,         G          &   #00018201' TO DFHEIV0
 18238     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18240     MOVE X'2020233030303138323031' TO DFHEIV0(25:11)
 18241     CALL 'kxdfhei1' USING DFHEIV0,
 18242           FILE-ID-ERRESS,
 18243           WS-ERRESS-KEY,
 18244           DFHEIV99,
 18245           DFHEIV11,
 18246           DFHEIV99
 18247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18248
 18249
 18250 6620-READ-NEXT-ERRESS-MASTER.
 18251
 18252
 18253* EXEC CICS HANDLE CONDITION
 18254*        NOTFND    (6630-END-OF-FILE)
 18255*        ENDFILE   (6630-END-OF-FILE)
 18256*        DISABLED  (6630-ERRESS-PROBLEM)
 18257*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18258*    END-EXEC.
 18259*    MOVE '"$I''cJ                ! % #00018209' TO DFHEIV0
 18260     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18262     MOVE X'2520233030303138323039' TO DFHEIV0(25:11)
 18263     CALL 'kxdfhei1' USING DFHEIV0
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18265
 18266
 18267
 18268* EXEC CICS READNEXT
 18269*        DATASET (FILE-ID-ERRESS)
 18270*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18271*        RIDFLD  (WS-ERRESS-KEY)
 18272*    END-EXEC.
 18273     MOVE LENGTH OF
 18274      RESIDENT-STATE-TAX-MASTER
 18275       TO DFHEIV12
 18276     MOVE 0
 18277       TO DFHEIV11
 18278*    MOVE '&.IL                  )   #00018216' TO DFHEIV0
 18279     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18280     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18281     MOVE X'2020233030303138323136' TO DFHEIV0(25:11)
 18282     CALL 'kxdfhei1' USING DFHEIV0,
 18283           FILE-ID-ERRESS,
 18284           RESIDENT-STATE-TAX-MASTER,
 18285           DFHEIV12,
 18286           WS-ERRESS-KEY,
 18287           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 333
* EL050.cbl
 18288           DFHEIV11,
 18289           DFHEIV99,
 18290           DFHEIV99
 18291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18292
 18293
 18294     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18295
 18296* EXEC CICS ENDBR
 18297*            DATASET (FILE-ID-ERRESS)
 18298*       END-EXEC
 18299     MOVE 0
 18300       TO DFHEIV11
 18301*    MOVE '&2                    $   #00018223' TO DFHEIV0
 18302     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18304     MOVE X'2020233030303138323233' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0,
 18306           FILE-ID-ERRESS,
 18307           DFHEIV11,
 18308           DFHEIV99
 18309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18310        GO TO 6630-END-OF-FILE.
 18311
 18312     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18313        NEXT SENTENCE
 18314      ELSE
 18315        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18316
 18317*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18318*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18319*
 18320     MOVE +2                     TO WS-SUB1.
 18321
 18322     IF PB-ISSUE
 18323     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18324        MOVE +1                  TO WS-SUB1.
 18325
 18326     IF PB-CANCELLATION
 18327     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18328        MOVE +1                  TO WS-SUB1.
 18329*
 18330*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18331*
 18332***  Y2K PROJ 7744
 18333     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18334***  Y2K PROJ 7744
 18335
 18336*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18337* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18338* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18339
 18340     ADD 1                    TO WS-YEAR-YY.
 18341
 18342     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18343         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18344                              TO WS-RES-STATE-TAX
 18345         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 334
* EL050.cbl
 18346                              TO WS-RES-MUNI-TAX
 18347     ELSE
 18348         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18349                              TO WS-RES-STATE-TAX
 18350         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18351                              TO WS-RES-MUNI-TAX.
 18352
 18353*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18354
 18355     IF PB-CANCELLATION
 18356         GO TO 6640-CANCEL-TAX.
 18357
 18358     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18359         COMPUTE PB-I-STATE-TAX ROUNDED =
 18360                                   PB-I-LF-PREMIUM-AMT
 18361                                 * WS-RES-STATE-TAX
 18362         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18363                                   PB-I-LF-PREMIUM-AMT
 18364                                 * WS-RES-MUNI-TAX
 18365     ELSE
 18366     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18367         COMPUTE PB-I-STATE-TAX ROUNDED =
 18368                                   PB-I-AH-PREMIUM-AMT
 18369                                 * WS-RES-STATE-TAX
 18370         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18371                                   PB-I-AH-PREMIUM-AMT
 18372                                 * WS-RES-MUNI-TAX.
 18373
 18374
 18375* EXEC CICS ENDBR
 18376*         DATASET (FILE-ID-ERRESS)
 18377*    END-EXEC.
 18378     MOVE 0
 18379       TO DFHEIV11
 18380*    MOVE '&2                    $   #00018290' TO DFHEIV0
 18381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18383     MOVE X'2020233030303138323930' TO DFHEIV0(25:11)
 18384     CALL 'kxdfhei1' USING DFHEIV0,
 18385           FILE-ID-ERRESS,
 18386           DFHEIV11,
 18387           DFHEIV99
 18388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18389
 18390
 18391     GO TO 6640-EXIT.
 18392
 18393 6640-CANCEL-TAX.
 18394     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18395
 18396     IF PB-C-LF-CANCEL-AMT > ZEROS
 18397         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18398                                   PB-C-LF-CANCEL-AMT
 18399                                 * WS-RES-STATE-TAX
 18400         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18401                                   PB-C-LF-CANCEL-AMT
 18402                                *  WS-RES-MUNI-TAX
 18403     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 335
* EL050.cbl
 18404     IF PB-C-AH-CANCEL-AMT > ZEROS
 18405         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18406                                   PB-C-AH-CANCEL-AMT
 18407                                 * WS-RES-STATE-TAX
 18408         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18409                                   PB-C-AH-CANCEL-AMT
 18410                                *  WS-RES-MUNI-TAX.
 18411
 18412
 18413* EXEC CICS ENDBR
 18414*         DATASET (FILE-ID-ERRESS)
 18415*    END-EXEC.
 18416     MOVE 0
 18417       TO DFHEIV11
 18418*    MOVE '&2                    $   #00018315' TO DFHEIV0
 18419     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18421     MOVE X'2020233030303138333135' TO DFHEIV0(25:11)
 18422     CALL 'kxdfhei1' USING DFHEIV0,
 18423           FILE-ID-ERRESS,
 18424           DFHEIV11,
 18425           DFHEIV99
 18426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18427
 18428
 18429     GO TO 6640-EXIT.
 18430
 18431 6630-END-OF-FILE.
 18432     MOVE ER-8002              TO WS-ERROR.
 18433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18434
 18435     GO TO 6640-EXIT.
 18436
 18437 6630-ERRESS-PROBLEM.
 18438     MOVE ER-8044              TO WS-ERROR.
 18439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18440
 18441 6640-EXIT.
 18442     EXIT.
 18443
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 336
* EL050.cbl
 18445 6650-GET-RES-STATE-COMM.
 18446
 18447     IF PB-COMPANY-ID NOT = 'DMD'
 18448         GO TO 6700-COMM-EXIT.
 18449
 18450     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18451     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18452     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18453     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18454     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18455     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18456     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18457
 18458*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18459*
 18460***  Y2K PROJ 7744
 18461     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18462     SET BIN-TO-GREG          TO TRUE.
 18463     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18464
 18465     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18466***  Y2K PROJ 7744
 18467
 18468     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18469
 18470
 18471* EXEC CICS HANDLE CONDITION
 18472*        INVREQ    (6660-START-BROWSE)
 18473*        DISABLED  (6690-ERRESC-PROBLEM)
 18474*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18475*        NOTFND    (6690-END-OF-FILE)
 18476*    END-EXEC.
 18477*    MOVE '"$8cJI                ! & #00018360' TO DFHEIV0
 18478     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18480     MOVE X'2620233030303138333630' TO DFHEIV0(25:11)
 18481     CALL 'kxdfhei1' USING DFHEIV0
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18483
 18484
 18485
 18486* EXEC CICS RESETBR
 18487*        DATASET (FILE-ID-ERRESC)
 18488*        RIDFLD  (WS-ERRESC-KEY)
 18489*    END-EXEC.
 18490     MOVE 0
 18491       TO DFHEIV11
 18492*    MOVE '&4         G          &   #00018367' TO DFHEIV0
 18493     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18494     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18495     MOVE X'2020233030303138333637' TO DFHEIV0(25:11)
 18496     CALL 'kxdfhei1' USING DFHEIV0,
 18497           FILE-ID-ERRESC,
 18498           WS-ERRESC-KEY,
 18499           DFHEIV99,
 18500           DFHEIV11,
 18501           DFHEIV99
 18502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 337
* EL050.cbl
 18503
 18504
 18505 6660-START-BROWSE.
 18506
 18507
 18508* EXEC CICS HANDLE CONDITION
 18509*        NOTFND    (6690-END-OF-FILE)
 18510*        DISABLED  (6690-ERRESC-PROBLEM)
 18511*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18512*        ENDFILE   (6690-END-OF-FILE)
 18513*    END-EXEC.
 18514*    MOVE '"$IcJ''                ! '' #00018374' TO DFHEIV0
 18515     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18517     MOVE X'2720233030303138333734' TO DFHEIV0(25:11)
 18518     CALL 'kxdfhei1' USING DFHEIV0
 18519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18520
 18521
 18522
 18523* EXEC CICS STARTBR
 18524*        DATASET (FILE-ID-ERRESC)
 18525*        RIDFLD  (WS-ERRESC-KEY)
 18526*        GTEQ
 18527*    END-EXEC.
 18528     MOVE 0
 18529       TO DFHEIV11
 18530*    MOVE '&,         G          &   #00018381' TO DFHEIV0
 18531     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18533     MOVE X'2020233030303138333831' TO DFHEIV0(25:11)
 18534     CALL 'kxdfhei1' USING DFHEIV0,
 18535           FILE-ID-ERRESC,
 18536           WS-ERRESC-KEY,
 18537           DFHEIV99,
 18538           DFHEIV11,
 18539           DFHEIV99
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18544
 18545 6670-READ-NEXT-ERRESC-MASTER.
 18546
 18547
 18548* EXEC CICS HANDLE CONDITION
 18549*        NOTFND    (6690-END-OF-FILE)
 18550*        DISABLED  (6690-ERRESC-PROBLEM)
 18551*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18552*        ENDFILE   (6690-END-OF-FILE)
 18553*    END-EXEC.
 18554*    MOVE '"$IcJ''                ! ( #00018391' TO DFHEIV0
 18555     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18557     MOVE X'2820233030303138333931' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0
 18559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18560
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 338
* EL050.cbl
 18561
 18562
 18563* EXEC CICS READNEXT
 18564*        DATASET (FILE-ID-ERRESC)
 18565*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18566*        RIDFLD  (ERRESC-RECORD-KEY)
 18567*    END-EXEC.
 18568     MOVE LENGTH OF
 18569      ACCOUNT-RESIDENT-ST-COMMISSION
 18570       TO DFHEIV12
 18571     MOVE 0
 18572       TO DFHEIV11
 18573*    MOVE '&.IL                  )   #00018398' TO DFHEIV0
 18574     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18576     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0,
 18578           FILE-ID-ERRESC,
 18579           ACCOUNT-RESIDENT-ST-COMMISSION,
 18580           DFHEIV12,
 18581           ERRESC-RECORD-KEY,
 18582           DFHEIV99,
 18583           DFHEIV11,
 18584           DFHEIV99,
 18585           DFHEIV99
 18586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18587
 18588
 18589     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18590        NEXT SENTENCE
 18591     ELSE
 18592
 18593* EXEC CICS ENDBR
 18594*            DATASET (FILE-ID-ERRESC)
 18595*       END-EXEC
 18596     MOVE 0
 18597       TO DFHEIV11
 18598*    MOVE '&2                    $   #00018407' TO DFHEIV0
 18599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18601     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 18602     CALL 'kxdfhei1' USING DFHEIV0,
 18603           FILE-ID-ERRESC,
 18604           DFHEIV11,
 18605           DFHEIV99
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18607        GO TO 6690-END-OF-FILE.
 18608
 18609     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18610
 18611* EXEC CICS ENDBR
 18612*            DATASET (FILE-ID-ERRESC)
 18613*       END-EXEC
 18614     MOVE 0
 18615       TO DFHEIV11
 18616*    MOVE '&2                    $   #00018413' TO DFHEIV0
 18617     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 339
* EL050.cbl
 18619     MOVE X'2020233030303138343133' TO DFHEIV0(25:11)
 18620     CALL 'kxdfhei1' USING DFHEIV0,
 18621           FILE-ID-ERRESC,
 18622           DFHEIV11,
 18623           DFHEIV99
 18624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18625        GO TO 6690-END-OF-FILE.
 18626
 18627     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18628        NEXT SENTENCE
 18629      ELSE
 18630        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18631
 18632* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18633*
 18634     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18635
 18636     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18637
 18638     IF WS-SUB1 > ZERO
 18639         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18640             PERFORM 6680-SET-COMMISSION
 18641         ELSE
 18642             PERFORM 6680-SET-TABLE-CODE.
 18643
 18644
 18645* EXEC CICS ENDBR
 18646*         DATASET (FILE-ID-ERRESC)
 18647*    END-EXEC.
 18648     MOVE 0
 18649       TO DFHEIV11
 18650*    MOVE '&2                    $   #00018435' TO DFHEIV0
 18651     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18653     MOVE X'2020233030303138343335' TO DFHEIV0(25:11)
 18654     CALL 'kxdfhei1' USING DFHEIV0,
 18655           FILE-ID-ERRESC,
 18656           DFHEIV11,
 18657           DFHEIV99
 18658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18659
 18660
 18661     GO TO 6700-COMM-EXIT.
 18662
 18663 6680-SET-TABLE-CODE.
 18664     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18665        MOVE ZEROS             TO WS-SUB1
 18666     ELSE
 18667* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18668* TO COMPUTE AH COMMISSION.
 18669        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18670        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18671        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18672        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18673        PERFORM 6680-READ-CTBL-TABLE
 18674        IF WS-CTBL-READ-SW NOT = 'Y'
 18675           MOVE ZEROS          TO WS-SUB1.
 18676
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 340
* EL050.cbl
 18677 6680-READ-CTBL-TABLE.
 18678*
 18679* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18680* TO COMPUTE LIFE COMMISSION
 18681
 18682     IF CTBL-SW = '0540'
 18683        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18684        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18685        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18686
 18687     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18688
 18689     IF CTBL-TABLE-FOUND
 18690        IF CTBL-SW = '0530'
 18691             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18692                                    * PB-I-AH-TERM
 18693             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18694             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18695        ELSE
 18696             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18697             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18698             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18699     ELSE
 18700        IF FIRST-TIME-THROUGH
 18701            GO TO 6680-READ-CTBL-TABLE
 18702        ELSE
 18703            MOVE ZEROS         TO WS-SUB1.
 18704
 18705 6680-SET-COMMISSION.
 18706     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18707           MOVE ZEROS          TO WS-SUB1
 18708       ELSE
 18709           MOVE RESC-COMMISSION-PER (WS-SUB)
 18710                               TO WS-COMMISSION
 18711           IF CTBL-SW = '0530'
 18712               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18713           ELSE
 18714               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18715
 18716 6680-SEARCH-CATEGORY.
 18717     ADD +1                   TO WS-SUB.
 18718     IF WS-SUB > +12
 18719         GO TO 6680-EXIT.
 18720
 18721     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18722          MOVE WS-SUB         TO WS-SUB1
 18723          GO TO 6680-EXIT.
 18724
 18725     GO TO 6680-SEARCH-CATEGORY.
 18726
 18727 6680-EXIT.
 18728     EXIT.
 18729
 18730 6690-END-OF-FILE.
 18731     GO TO 6700-COMM-EXIT.
 18732
 18733 6690-ERRESC-PROBLEM.
 18734      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 341
* EL050.cbl
 18735      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18736
 18737      GO TO 6700-COMM-EXIT.
 18738
 18739 6700-COMM-EXIT.
 18740     EXIT.
 18741
 18742 7000-GET-RATE.
 18743
 18744* EXEC CICS LINK
 18745*        PROGRAM    ('ELRATE')
 18746*        COMMAREA   (CALCULATION-PASS-AREA)
 18747*        LENGTH     (CP-COMM-LENGTH)
 18748*    END-EXEC.
 18749     MOVE 'ELRATE' TO DFHEIV1
 18750*    MOVE '."C                   (   #00018521' TO DFHEIV0
 18751     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18753     MOVE X'2020233030303138353231' TO DFHEIV0(25:11)
 18754     CALL 'kxdfhei1' USING DFHEIV0,
 18755           DFHEIV1,
 18756           CALCULATION-PASS-AREA,
 18757           CP-COMM-LENGTH,
 18758           DFHEIV99,
 18759           DFHEIV99,
 18760           DFHEIV99,
 18761           DFHEIV99
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765 7000-EXIT.
 18766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 342
* EL050.cbl
 18768 7100-FIND-BENEFIT-IN-STATE.
 18769     MOVE 'N'                    TO BEN-SEARCH-SW.
 18770
 18771     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18772         VARYING SUB3 FROM 1 BY 1 UNTIL
 18773            ((SUB3 GREATER 50) OR
 18774              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18775               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18776
 18777     IF SUB3 NOT = 51
 18778         MOVE 'Y'                TO BEN-SEARCH-SW.
 18779
 18780     GO TO 7199-EXIT.
 18781
 18782 7100-BENEFIT-DUMMY.
 18783
 18784 7100-DUMMY-EXIT.
 18785     EXIT.
 18786
 18787 7199-EXIT.
 18788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 343
* EL050.cbl
 18790 7200-FIND-BENEFIT.
 18791     MOVE 'N'                    TO BEN-SEARCH-SW.
 18792
 18793     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18794         VARYING SUB3 FROM 1 BY 1 UNTIL
 18795            ((SUB3 GREATER 8) OR
 18796            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18797
 18798     IF SUB3 NOT = 9
 18799         MOVE 'Y'                TO BEN-SEARCH-SW.
 18800
 18801     GO TO 7200-EXIT.
 18802
 18803 7200-BENEFIT-DUMMY.
 18804
 18805 7200-DUMMY-EXIT.
 18806     EXIT.
 18807
 18808 7200-EXIT.
 18809     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 344
* EL050.cbl
 18811 7250-LOOK-FOR-RESCINDED-CLAIM.
 18812     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18813                                    W-CL-COMP-CD.
 18814     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18815                                    W-CL-CERT-NO.
 18816
 18817
 18818* EXEC CICS HANDLE CONDITION
 18819*        NOTFND  (7250-CONTINUE)
 18820*        ENDFILE (7250-CONTINUE)
 18821*    END-EXEC.
 18822*    MOVE '"$I''                  ! ) #00018579' TO DFHEIV0
 18823     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18825     MOVE X'2920233030303138353739' TO DFHEIV0(25:11)
 18826     CALL 'kxdfhei1' USING DFHEIV0
 18827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18828
 18829
 18830
 18831* EXEC CICS IGNORE CONDITION
 18832*        DUPKEY
 18833*    END-EXEC.
 18834*    MOVE '"*$                   !   #00018584' TO DFHEIV0
 18835     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18837     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 18838     CALL 'kxdfhei1' USING DFHEIV0
 18839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18840
 18841
 18842
 18843* EXEC CICS STARTBR
 18844*        DATASET   (CLMS-ID)
 18845*        RIDFLD    (ELMSTR-KEY)
 18846*        GENERIC   EQUAL
 18847*        KEYLENGTH (ELMSTR-LENGTH)
 18848*    END-EXEC.
 18849     MOVE 0
 18850       TO DFHEIV11
 18851*    MOVE '&,   KG    E          &   #00018588' TO DFHEIV0
 18852     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18853     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18854     MOVE X'2020233030303138353838' TO DFHEIV0(25:11)
 18855     CALL 'kxdfhei1' USING DFHEIV0,
 18856           CLMS-ID,
 18857           ELMSTR-KEY,
 18858           ELMSTR-LENGTH,
 18859           DFHEIV11,
 18860           DFHEIV99
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
 18864     MOVE 'Y'                    TO W-BROWSE-SW.
 18865
 18866 7250-NEXT-CLAIM.
 18867
 18868
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 345
* EL050.cbl
 18869* EXEC CICS READNEXT
 18870*        DATASET   (CLMS-ID)
 18871*        RIDFLD    (ELMSTR-KEY)
 18872*        SET       (ADDRESS OF CLAIM-MASTER)
 18873*    END-EXEC.
 18874     MOVE 0
 18875       TO DFHEIV11
 18876*    MOVE '&.S                   )   #00018599' TO DFHEIV0
 18877     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18879     MOVE X'2020233030303138353939' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0,
 18881           CLMS-ID,
 18882           DFHEIV20,
 18883           DFHEIV99,
 18884           ELMSTR-KEY,
 18885           DFHEIV99,
 18886           DFHEIV11,
 18887           DFHEIV99,
 18888           DFHEIV99
 18889     SET ADDRESS OF CLAIM-MASTER TO
 18890         DFHEIV20
 18891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18892
 18893
 18894     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18895        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18896         GO TO 7250-CONTINUE
 18897     END-IF.
 18898
 18899     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18900        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18901        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18902        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18903        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18904         GO TO 7250-NEXT-CLAIM
 18905     END-IF.
 18906
 18907     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18908        OR (CL-CLAIM-TYPE = 'I')
 18909        OR (CL-CLAIM-TYPE = 'G')
 18910        OR (CL-CLAIM-TYPE = 'F')
 18911          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18912              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18913              GO TO 7250-CONTINUE
 18914          END-IF
 18915     END-IF.
 18916
 18917     GO TO 7250-NEXT-CLAIM.
 18918
 18919 7250-CONTINUE.
 18920
 18921     IF W-BROWSE-SW = 'Y'
 18922
 18923* EXEC CICS ENDBR
 18924*            DATASET   (CLMS-ID)
 18925*        END-EXEC
 18926     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 346
* EL050.cbl
 18927       TO DFHEIV11
 18928*    MOVE '&2                    $   #00018633' TO DFHEIV0
 18929     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18930     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18931     MOVE X'2020233030303138363333' TO DFHEIV0(25:11)
 18932     CALL 'kxdfhei1' USING DFHEIV0,
 18933           CLMS-ID,
 18934           DFHEIV11,
 18935           DFHEIV99
 18936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18937         MOVE 'N' TO W-BROWSE-SW
 18938     END-IF.
 18939
 18940 7250-EXIT.
 18941     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 347
* EL050.cbl
 18943 7300-CHECK-FOR-OPEN-CLMS.
 18944
 18945*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18946*    MOVE SPACES                 TO CNTL-ACCESS.
 18947*    MOVE '1'                    TO CNTL-REC-TYPE.
 18948*    MOVE +0                     TO CNTL-SEQ-NO.
 18949
 18950*    MOVE '3'                    TO RC-SW-1.
 18951*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18952
 18953*    IF NOT CF-COMPANY-MASTER
 18954*         PERFORM 0099-COMPANY-NOT-FOUND
 18955*         GO TO 7300-EXIT.
 18956
 18957     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18958                                    W-CL-COMP-CD.
 18959     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18960                                    W-CL-CERT-NO.
 18961
 18962
 18963* EXEC CICS HANDLE CONDITION
 18964*        NOTFND  (7300-CONTINUE)
 18965*        ENDFILE (7300-CONTINUE)
 18966*    END-EXEC.
 18967*    MOVE '"$I''                  ! * #00018661' TO DFHEIV0
 18968     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18970     MOVE X'2A20233030303138363631' TO DFHEIV0(25:11)
 18971     CALL 'kxdfhei1' USING DFHEIV0
 18972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18973
 18974
 18975
 18976* EXEC CICS IGNORE CONDITION
 18977*        DUPKEY
 18978*    END-EXEC.
 18979*    MOVE '"*$                   !   #00018666' TO DFHEIV0
 18980     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303138363636' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0
 18984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18985
 18986
 18987
 18988* EXEC CICS STARTBR
 18989*        DATASET   (CLMS-ID)
 18990*        RIDFLD    (ELMSTR-KEY)
 18991*        GENERIC   EQUAL
 18992*        KEYLENGTH (ELMSTR-LENGTH)
 18993*    END-EXEC.
 18994     MOVE 0
 18995       TO DFHEIV11
 18996*    MOVE '&,   KG    E          &   #00018670' TO DFHEIV0
 18997     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18998     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18999     MOVE X'2020233030303138363730' TO DFHEIV0(25:11)
 19000     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 348
* EL050.cbl
 19001           CLMS-ID,
 19002           ELMSTR-KEY,
 19003           ELMSTR-LENGTH,
 19004           DFHEIV11,
 19005           DFHEIV99
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009     MOVE 'Y'                    TO W-BROWSE-SW.
 19010
 19011 7300-NEXT-CLAIM.
 19012
 19013
 19014* EXEC CICS READNEXT
 19015*        DATASET   (CLMS-ID)
 19016*        RIDFLD    (ELMSTR-KEY)
 19017*        SET       (ADDRESS OF CLAIM-MASTER)
 19018*    END-EXEC.
 19019     MOVE 0
 19020       TO DFHEIV11
 19021*    MOVE '&.S                   )   #00018681' TO DFHEIV0
 19022     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303138363831' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0,
 19026           CLMS-ID,
 19027           DFHEIV20,
 19028           DFHEIV99,
 19029           ELMSTR-KEY,
 19030           DFHEIV99,
 19031           DFHEIV11,
 19032           DFHEIV99,
 19033           DFHEIV99
 19034     SET ADDRESS OF CLAIM-MASTER TO
 19035         DFHEIV20
 19036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19037
 19038
 19039     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19040        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19041         GO TO 7300-CONTINUE.
 19042
 19043     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19044        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19045        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19046        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19047        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19048         GO TO 7300-NEXT-CLAIM.
 19049
 19050*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19051     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19052        OR (CL-CLAIM-TYPE = 'I')
 19053        OR (CL-CLAIM-TYPE = 'G')
 19054        OR (CL-CLAIM-TYPE = 'F')
 19055        IF CLAIM-IS-OPEN
 19056           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19057             AND PB-C-AH-CANCEL-DT > SPACES
 19058              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 349
* EL050.cbl
 19059              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19060           END-IF
 19061           EVALUATE TRUE
 19062             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19063                 MOVE ER-2884      TO WS-ERROR
 19064             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19065                 MOVE ER-2887      TO WS-ERROR
 19066             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19067                 MOVE ER-2886      TO WS-ERROR
 19068             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19069                 MOVE ER-2888      TO WS-ERROR
 19070             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19071                 MOVE ER-2885      TO WS-ERROR
 19072             WHEN OTHER
 19073                 MOVE ER-2768      TO WS-ERROR
 19074           END-EVALUATE
 19075           IF PB-C-AH-CANCEL-VOIDED OR
 19076              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19077                NOT AH-COVERAGE-CANCELLED)
 19078               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19079               MOVE ER-2768      TO WS-ERROR
 19080           END-IF
 19081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19082           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19083              PB-FORCE-CODE NOT EQUAL '8'
 19084               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19085           END-IF
 19086           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19087           GO TO 7300-NEXT-CLAIM
 19088        ELSE
 19089           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19090*****THIS IS A RESCISSION OR REFORMATION
 19091              IF AH-COVERAGE-CANCELLED
 19092                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19093                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19094                    MOVE 1                   TO DC-ELAPSED-DAYS
 19095                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19096                    SET BIN-PLUS-ELAPSED     TO TRUE
 19097                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19098                    IF NO-CONVERSION-ERROR
 19099                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19100                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19101                          MOVE ER-2897 TO WS-ERROR
 19102                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19103                          GO TO 7300-NEXT-CLAIM
 19104                       END-IF
 19105                    END-IF
 19106                 ELSE
 19107                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19108                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19109                         MOVE ER-2890 TO WS-ERROR
 19110                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19111                         GO TO 7300-NEXT-CLAIM
 19112                      ELSE
 19113                         MOVE ER-2898 TO WS-ERROR
 19114                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19115                         GO TO 7300-NEXT-CLAIM
 19116                      END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 350
* EL050.cbl
 19117                   END-IF
 19118                 END-IF
 19119              END-IF
 19120           ELSE
 19121              IF CL-DENIAL-TYPE = '1'  AND
 19122                 CL-TOTAL-PAID-AMT = 0
 19123                    GO TO 7300-NEXT-CLAIM
 19124              END-IF
 19125              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19126               AND PB-C-AH-CANCEL-DT > SPACES
 19127                 MOVE ER-2756        TO WS-ERROR
 19128                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19129                 GO TO 7300-NEXT-CLAIM
 19130              END-IF
 19131           END-IF
 19132        END-IF
 19133     ELSE
 19134*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19135        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19136           IF CLAIM-IS-OPEN
 19137              MOVE ER-2889      TO WS-ERROR
 19138              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19139              GO TO 7300-NEXT-CLAIM
 19140           ELSE
 19141              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19142*****THIS IS A RESCISSION OR REFORMATION
 19143                 IF (LF-COVERAGE-CANCELLED AND
 19144                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19145                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19146                         MOVE ER-2890 TO WS-ERROR
 19147                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19148                         GO TO 7300-NEXT-CLAIM
 19149                      ELSE
 19150                         MOVE ER-2898 TO WS-ERROR
 19151                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19152                         GO TO 7300-NEXT-CLAIM
 19153                      END-IF
 19154                 END-IF
 19155              ELSE
 19156                 IF CL-DENIAL-TYPE = '1'  AND
 19157                    CL-TOTAL-PAID-AMT = 0
 19158                       GO TO 7300-NEXT-CLAIM
 19159                 END-IF
 19160                 IF (AH-COVERAGE-CANCELLED AND
 19161                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19162                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19163                    (LF-COVERAGE-CANCELLED AND
 19164                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19165                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19166                       MOVE ER-2965 TO WS-ERROR
 19167                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19168                       GO TO 7300-NEXT-CLAIM
 19169                 END-IF
 19170                 IF LF-COVERAGE-CANCELLED
 19171                  IF CL-TOTAL-PAID-AMT > 0
 19172                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19173                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19174                        MOVE ER-2891 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 351
* EL050.cbl
 19175                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19176                        GO TO 7300-NEXT-CLAIM
 19177                      END-IF
 19178                    ELSE
 19179****only show this error if cert num matches exactly
 19180                      IF PB-CERT-NO = CL-CERT-NO
 19181                         MOVE ER-2892 TO WS-ERROR
 19182                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19183                         GO TO 7300-NEXT-CLAIM
 19184                      END-IF
 19185                    END-IF
 19186                  END-IF
 19187                 END-IF
 19188              END-IF
 19189           END-IF
 19190        END-IF
 19191     END-IF
 19192
 19193     GO TO 7300-NEXT-CLAIM.
 19194
 19195 7300-CONTINUE.
 19196
 19197     IF W-BROWSE-SW = 'Y'
 19198
 19199* EXEC CICS ENDBR
 19200*            DATASET   (CLMS-ID)
 19201*        END-EXEC.
 19202     MOVE 0
 19203       TO DFHEIV11
 19204*    MOVE '&2                    $   #00018846' TO DFHEIV0
 19205     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303138383436' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           CLMS-ID,
 19210           DFHEIV11,
 19211           DFHEIV99
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 7300-EXIT.
 19216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 352
* EL050.cbl
 19218
 19219 7400-GET-REMAIN-TERM.
 19220
 19221* EXEC CICS LINK
 19222*        PROGRAM    ('ELRTRM')
 19223*        COMMAREA   (CALCULATION-PASS-AREA)
 19224*        LENGTH     (CP-COMM-LENGTH)
 19225*    END-EXEC.
 19226     MOVE 'ELRTRM' TO DFHEIV1
 19227*    MOVE '."C                   (   #00018855' TO DFHEIV0
 19228     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303138383535' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           CALCULATION-PASS-AREA,
 19234           CP-COMM-LENGTH,
 19235           DFHEIV99,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19240
 19241
 19242 7400-EXIT.
 19243     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 353
* EL050.cbl
 19245
 19246 7500-GET-REMAIN-AMOUNT.
 19247
 19248* EXEC CICS LINK
 19249*        PROGRAM    ('ELRAMT')
 19250*        COMMAREA   (CALCULATION-PASS-AREA)
 19251*        LENGTH     (CP-COMM-LENGTH)
 19252*    END-EXEC.
 19253     MOVE 'ELRAMT' TO DFHEIV1
 19254*    MOVE '."C                   (   #00018866' TO DFHEIV0
 19255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19257     MOVE X'2020233030303138383636' TO DFHEIV0(25:11)
 19258     CALL 'kxdfhei1' USING DFHEIV0,
 19259           DFHEIV1,
 19260           CALCULATION-PASS-AREA,
 19261           CP-COMM-LENGTH,
 19262           DFHEIV99,
 19263           DFHEIV99,
 19264           DFHEIV99,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269 7500-EXIT.
 19270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 354
* EL050.cbl
 19272
 19273 7600-GET-REFUND.
 19274
 19275* EXEC CICS LINK
 19276*        PROGRAM    ('ELRFND')
 19277*        COMMAREA   (CALCULATION-PASS-AREA)
 19278*        LENGTH     (CP-COMM-LENGTH)
 19279*    END-EXEC.
 19280     MOVE 'ELRFND' TO DFHEIV1
 19281*    MOVE '."C                   (   #00018877' TO DFHEIV0
 19282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19284     MOVE X'2020233030303138383737' TO DFHEIV0(25:11)
 19285     CALL 'kxdfhei1' USING DFHEIV0,
 19286           DFHEIV1,
 19287           CALCULATION-PASS-AREA,
 19288           CP-COMM-LENGTH,
 19289           DFHEIV99,
 19290           DFHEIV99,
 19291           DFHEIV99,
 19292           DFHEIV99
 19293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19294
 19295
 19296 7600-EXIT.
 19297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 355
* EL050.cbl
 19299 7700-CALL-DL1.
 19300
 19301* EXEC CICS LINK
 19302*        PROGRAM    ('DLO001')
 19303*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19304*        LENGTH     (DLO001-COMM-LENGTH)
 19305*    END-EXEC.
 19306     MOVE 'DLO001' TO DFHEIV1
 19307*    MOVE '."C                   (   #00018887' TO DFHEIV0
 19308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19310     MOVE X'2020233030303138383837' TO DFHEIV0(25:11)
 19311     CALL 'kxdfhei1' USING DFHEIV0,
 19312           DFHEIV1,
 19313           WS-DLO-MASTER-POLICY-FORM,
 19314           DLO001-COMM-LENGTH,
 19315           DFHEIV99,
 19316           DFHEIV99,
 19317           DFHEIV99,
 19318           DFHEIV99
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19320
 19321
 19322 7700-EXIT.
 19323     EXIT.
 19324
 19325 7710-CALL-DL2.
 19326
 19327* EXEC CICS LINK
 19328*        PROGRAM    ('DLO002')
 19329*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19330*        LENGTH     (DLO002-COMM-LENGTH)
 19331*    END-EXEC.
 19332     MOVE 'DLO002' TO DFHEIV1
 19333*    MOVE '."C                   (   #00018897' TO DFHEIV0
 19334     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19336     MOVE X'2020233030303138383937' TO DFHEIV0(25:11)
 19337     CALL 'kxdfhei1' USING DFHEIV0,
 19338           DFHEIV1,
 19339           WS-DLO-INTERNAL-POLICY-FORM,
 19340           DLO002-COMM-LENGTH,
 19341           DFHEIV99,
 19342           DFHEIV99,
 19343           DFHEIV99,
 19344           DFHEIV99
 19345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19346
 19347
 19348 7710-EXIT.
 19349     EXIT.
 19350
 19351 7720-CALL-DL3.
 19352
 19353* EXEC CICS LINK
 19354*        PROGRAM    ('DLO003')
 19355*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19356*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 356
* EL050.cbl
 19357*    END-EXEC.
 19358     MOVE 'DLO003' TO DFHEIV1
 19359*    MOVE '."C                   (   #00018907' TO DFHEIV0
 19360     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19362     MOVE X'2020233030303138393037' TO DFHEIV0(25:11)
 19363     CALL 'kxdfhei1' USING DFHEIV0,
 19364           DFHEIV1,
 19365           WS-DLO-VALID-BANK-ID,
 19366           DLO003-COMM-LENGTH,
 19367           DFHEIV99,
 19368           DFHEIV99,
 19369           DFHEIV99,
 19370           DFHEIV99
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
 19374 7720-EXIT.
 19375     EXIT.
 19376
 19377 7730-CALL-DL7.
 19378
 19379* EXEC CICS LINK
 19380*        PROGRAM    ('DLO007')
 19381*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19382*        LENGTH     (DLO007-COMM-LENGTH)
 19383*    END-EXEC.
 19384     MOVE 'DLO007' TO DFHEIV1
 19385*    MOVE '."C                   (   #00018917' TO DFHEIV0
 19386     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19388     MOVE X'2020233030303138393137' TO DFHEIV0(25:11)
 19389     CALL 'kxdfhei1' USING DFHEIV0,
 19390           DFHEIV1,
 19391           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19392           DLO007-COMM-LENGTH,
 19393           DFHEIV99,
 19394           DFHEIV99,
 19395           DFHEIV99,
 19396           DFHEIV99
 19397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19398
 19399
 19400 7730-EXIT.
 19401     EXIT.
 19402
 19403 7740-CALL-DL11.
 19404
 19405* EXEC CICS LINK
 19406*        PROGRAM    ('DLO011')
 19407*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19408*        LENGTH     (DLO011-COMM-LENGTH)
 19409*    END-EXEC.
 19410     MOVE 'DLO011' TO DFHEIV1
 19411*    MOVE '."C                   (   #00018927' TO DFHEIV0
 19412     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19414     MOVE X'2020233030303138393237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 357
* EL050.cbl
 19415     CALL 'kxdfhei1' USING DFHEIV0,
 19416           DFHEIV1,
 19417           WS-DLO-PREM-RATES-BEN-TYPE,
 19418           DLO011-COMM-LENGTH,
 19419           DFHEIV99,
 19420           DFHEIV99,
 19421           DFHEIV99,
 19422           DFHEIV99
 19423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19424
 19425
 19426 7740-EXIT.
 19427     EXIT.
 19428
 19429 7750-CALL-DL17.
 19430
 19431* EXEC CICS LINK
 19432*        PROGRAM    ('DLO017')
 19433*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19434*        LENGTH     (DLO017-COMM-LENGTH)
 19435*    END-EXEC.
 19436     MOVE 'DLO017' TO DFHEIV1
 19437*    MOVE '."C                   (   #00018937' TO DFHEIV0
 19438     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19440     MOVE X'2020233030303138393337' TO DFHEIV0(25:11)
 19441     CALL 'kxdfhei1' USING DFHEIV0,
 19442           DFHEIV1,
 19443           WS-DLO-VALID-RATE-CODE,
 19444           DLO017-COMM-LENGTH,
 19445           DFHEIV99,
 19446           DFHEIV99,
 19447           DFHEIV99,
 19448           DFHEIV99
 19449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19450
 19451
 19452 7750-EXIT.
 19453     EXIT.
 19454
 19455 7755-CALL-DL19.
 19456
 19457* EXEC CICS LINK
 19458*        PROGRAM    ('DLO019')
 19459*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19460*        LENGTH     (DLO019-COMM-LENGTH)
 19461*    END-EXEC.
 19462     MOVE 'DLO019' TO DFHEIV1
 19463*    MOVE '."C                   (   #00018947' TO DFHEIV0
 19464     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19466     MOVE X'2020233030303138393437' TO DFHEIV0(25:11)
 19467     CALL 'kxdfhei1' USING DFHEIV0,
 19468           DFHEIV1,
 19469           WS-DLO-ORIG-COV-CAT,
 19470           DLO019-COMM-LENGTH,
 19471           DFHEIV99,
 19472           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 358
* EL050.cbl
 19473           DFHEIV99,
 19474           DFHEIV99
 19475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19476
 19477
 19478 7755-EXIT.
 19479     EXIT.
 19480
 19481 7760-CALL-DL21.
 19482
 19483* EXEC CICS LINK
 19484*        PROGRAM    ('DLO021')
 19485*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19486*        LENGTH     (DLO021-COMM-LENGTH)
 19487*    END-EXEC.
 19488     MOVE 'DLO021' TO DFHEIV1
 19489*    MOVE '."C                   (   #00018957' TO DFHEIV0
 19490     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19492     MOVE X'2020233030303138393537' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0,
 19494           DFHEIV1,
 19495           WS-DLO-VALID-LOAN-OFFICER,
 19496           DLO021-COMM-LENGTH,
 19497           DFHEIV99,
 19498           DFHEIV99,
 19499           DFHEIV99,
 19500           DFHEIV99
 19501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19502
 19503
 19504 7760-EXIT.
 19505     EXIT.
 19506
 19507 7770-CALL-DL22.
 19508
 19509* EXEC CICS LINK
 19510*        PROGRAM    ('DLO022')
 19511*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19512*        LENGTH     (DLO022-COMM-LENGTH)
 19513*    END-EXEC.
 19514     MOVE 'DLO022' TO DFHEIV1
 19515*    MOVE '."C                   (   #00018967' TO DFHEIV0
 19516     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19518     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 19519     CALL 'kxdfhei1' USING DFHEIV0,
 19520           DFHEIV1,
 19521           WS-DLO-VALID-STATE-CODE,
 19522           DLO022-COMM-LENGTH,
 19523           DFHEIV99,
 19524           DFHEIV99,
 19525           DFHEIV99,
 19526           DFHEIV99
 19527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19528
 19529
 19530 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 359
* EL050.cbl
 19531     EXIT.
 19532
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 360
* EL050.cbl
 19534
 19535 7800-REWRITE-CERT.
 19536******************************************************************
 19537*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19538*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19539******************************************************************
 19540
 19541     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19542        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19543        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19544        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19545
 19546* EXEC CICS REWRITE
 19547*                  DATASET (CERT-ID)
 19548*                  FROM    (CERTIFICATE-MASTER)
 19549*              END-EXEC
 19550     MOVE LENGTH OF
 19551      CERTIFICATE-MASTER
 19552       TO DFHEIV11
 19553*    MOVE '&& L                  %   #00018988' TO DFHEIV0
 19554     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19555     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19556     MOVE X'2020233030303138393838' TO DFHEIV0(25:11)
 19557     CALL 'kxdfhei1' USING DFHEIV0,
 19558           CERT-ID,
 19559           CERTIFICATE-MASTER,
 19560           DFHEIV11,
 19561           DFHEIV99
 19562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19563        GO TO 7800-EXIT.
 19564
 19565       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19566       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19567
 19568 7800-EXIT.
 19569      EXIT.
 19570
 19571 7900-DELETE-CERT.
 19572
 19573* EXEC CICS DELETE
 19574*        DATASET (CERT-ID)
 19575*    END-EXEC.
 19576*    MOVE '&(                    &   #00019001' TO DFHEIV0
 19577     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19579     MOVE X'2020233030303139303031' TO DFHEIV0(25:11)
 19580     CALL 'kxdfhei1' USING DFHEIV0,
 19581           CERT-ID,
 19582           DFHEIV99,
 19583           DFHEIV99,
 19584           DFHEIV99,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588
 19589 7900-EXIT.
 19590     EXIT.
 19591
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 361
* EL050.cbl
 19592 8000-WRITE-CERT.
 19593
 19594* EXEC CICS HANDLE CONDITION
 19595*        DUPKEY    (8000-FREE-MAIN)
 19596*    END-EXEC.
 19597*    MOVE '"$$                   ! + #00019009' TO DFHEIV0
 19598     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19600     MOVE X'2B20233030303139303039' TO DFHEIV0(25:11)
 19601     CALL 'kxdfhei1' USING DFHEIV0
 19602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19603
 19604
 19605
 19606* EXEC CICS WRITE
 19607*        DATASET     (CERT-ID)
 19608*        FROM        (CERTIFICATE-MASTER)
 19609*        RIDFLD      (ELCERT-KEY)
 19610*    END-EXEC.
 19611     MOVE LENGTH OF
 19612      CERTIFICATE-MASTER
 19613       TO DFHEIV11
 19614*    MOVE '&$ L                  ''   #00019013' TO DFHEIV0
 19615     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19616     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19617     MOVE X'2020233030303139303133' TO DFHEIV0(25:11)
 19618     CALL 'kxdfhei1' USING DFHEIV0,
 19619           CERT-ID,
 19620           CERTIFICATE-MASTER,
 19621           DFHEIV11,
 19622           ELCERT-KEY,
 19623           DFHEIV99,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628 8000-FREE-MAIN.
 19629
 19630 8000-EXIT.
 19631      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 362
* EL050.cbl
 19633
 19634 8100-READ-ERPNDM.
 19635
 19636* EXEC CICS HANDLE CONDITION
 19637*         NOTFND     (8100-NOTFND)
 19638*         ENDFILE    (8100-NOTFND)
 19639*    END-EXEC.
 19640*    MOVE '"$I''                  ! , #00019026' TO DFHEIV0
 19641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19643     MOVE X'2C20233030303139303236' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0
 19645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19646
 19647
 19648     MOVE SPACES                 TO ERPNDM-FOUND.
 19649     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19650
 19651
 19652* EXEC CICS READ
 19653*         DATASET   (FILE-ERPNDM)
 19654*         RIDFLD    (PM-CONTROL-PRIMARY)
 19655*         INTO      (PENDING-MAILING-DATA)
 19656*    END-EXEC.
 19657     MOVE LENGTH OF
 19658      PENDING-MAILING-DATA
 19659       TO DFHEIV11
 19660*    MOVE '&"IL       E          (   #00019034' TO DFHEIV0
 19661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303139303334' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           FILE-ERPNDM,
 19666           PENDING-MAILING-DATA,
 19667           DFHEIV11,
 19668           PM-CONTROL-PRIMARY,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19673
 19674
 19675     GO TO 8100-EXIT.
 19676
 19677 8100-NOTFND.
 19678
 19679     MOVE 'X'                    TO ERPNDM-FOUND.
 19680     MOVE ER-2694                TO WS-ERROR.
 19681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19682     MOVE ER-2883                TO WS-ERROR
 19683     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19684     .
 19685 8100-EXIT.
 19686     EXIT.
 19687
 19688 8110-READ-ERMAIL.
 19689
 19690* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 363
* EL050.cbl
 19691*         NOTFND     (8110-NOTFND)
 19692*         ENDFILE    (8110-NOTFND)
 19693*    END-EXEC.
 19694*    MOVE '"$I''                  ! - #00019054' TO DFHEIV0
 19695     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19697     MOVE X'2D20233030303139303534' TO DFHEIV0(25:11)
 19698     CALL 'kxdfhei1' USING DFHEIV0
 19699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19700
 19701
 19702     MOVE SPACES                 TO ERMAIL-FOUND.
 19703     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19704     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19705     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19706     MOVE PB-SV-STATE            TO MA-STATE.
 19707
 19708
 19709* EXEC CICS READ
 19710*         UPDATE
 19711*         DATASET   (FILE-ERMAIL)
 19712*         RIDFLD    (MA-CONTROL-PRIMARY)
 19713*         INTO      (MAILING-DATA)
 19714*    END-EXEC.
 19715     MOVE LENGTH OF
 19716      MAILING-DATA
 19717       TO DFHEIV11
 19718*    MOVE '&"IL       EU         (   #00019065' TO DFHEIV0
 19719     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19720     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19721     MOVE X'2020233030303139303635' TO DFHEIV0(25:11)
 19722     CALL 'kxdfhei1' USING DFHEIV0,
 19723           FILE-ERMAIL,
 19724           MAILING-DATA,
 19725           DFHEIV11,
 19726           MA-CONTROL-PRIMARY,
 19727           DFHEIV99,
 19728           DFHEIV99,
 19729           DFHEIV99
 19730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19731
 19732
 19733     GO TO 8110-EXIT.
 19734
 19735 8110-NOTFND.
 19736     MOVE 'X'                    TO ERMAIL-FOUND.
 19737
 19738 8110-EXIT.
 19739     EXIT.
 19740
 19741 8120-REWRITE-ERMAIL.
 19742
 19743* EXEC CICS REWRITE
 19744*         DATASET    (FILE-ERMAIL)
 19745*         FROM       (MAILING-DATA)
 19746*    END-EXEC.
 19747     MOVE LENGTH OF
 19748      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 364
* EL050.cbl
 19749       TO DFHEIV11
 19750*    MOVE '&& L                  %   #00019081' TO DFHEIV0
 19751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19753     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
 19754     CALL 'kxdfhei1' USING DFHEIV0,
 19755           FILE-ERMAIL,
 19756           MAILING-DATA,
 19757           DFHEIV11,
 19758           DFHEIV99
 19759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19760
 19761
 19762 8120-EXIT.
 19763     EXIT.
 19764
 19765 8130-WRITE-ERMAIL.
 19766
 19767* EXEC CICS HANDLE CONDITION
 19768*         DUPKEY   (8130-EXIT)
 19769*    END-EXEC.
 19770*    MOVE '"$$                   ! . #00019090' TO DFHEIV0
 19771     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19773     MOVE X'2E20233030303139303930' TO DFHEIV0(25:11)
 19774     CALL 'kxdfhei1' USING DFHEIV0
 19775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19776
 19777
 19778
 19779* EXEC CICS WRITE
 19780*         DATASET     (FILE-ERMAIL)
 19781*         RIDFLD      (MA-CONTROL-PRIMARY)
 19782*         FROM        (MAILING-DATA)
 19783*    END-EXEC.
 19784     MOVE LENGTH OF
 19785      MAILING-DATA
 19786       TO DFHEIV11
 19787*    MOVE '&$ L                  ''   #00019094' TO DFHEIV0
 19788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           FILE-ERMAIL,
 19793           MAILING-DATA,
 19794           DFHEIV11,
 19795           MA-CONTROL-PRIMARY,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801 8130-EXIT.
 19802     EXIT.
 19803
 19804 8140-UNLOCK-ERMAIL.
 19805
 19806* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 365
* EL050.cbl
 19807*         DATASET   (FILE-ERMAIL)
 19808*    END-EXEC.
 19809*    MOVE '&*                    #   #00019104' TO DFHEIV0
 19810     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19811     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19812     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 19813     CALL 'kxdfhei1' USING DFHEIV0,
 19814           FILE-ERMAIL,
 19815           DFHEIV99
 19816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19817
 19818
 19819 8140-EXIT.
 19820     EXIT.
 19821
 19822 8150-read-elcrtt.
 19823
 19824
 19825* EXEC CICS HANDLE CONDITION
 19826*        NOTFND   (8150-exit)
 19827*    END-EXEC
 19828*    MOVE '"$I                   ! / #00019113' TO DFHEIV0
 19829     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19831     MOVE X'2F20233030303139313133' TO DFHEIV0(25:11)
 19832     CALL 'kxdfhei1' USING DFHEIV0
 19833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19834
 19835     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19836     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19837
 19838
 19839* EXEC CICS READ
 19840*        DATASET  (CRTT-ID)
 19841*        RIDFLD   (WS-ELCRTT-KEY)
 19842*        INTO     (CERTIFICATE-TRAILERS)
 19843*    END-EXEC
 19844     MOVE LENGTH OF
 19845      CERTIFICATE-TRAILERS
 19846       TO DFHEIV11
 19847*    MOVE '&"IL       E          (   #00019120' TO DFHEIV0
 19848     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19850     MOVE X'2020233030303139313230' TO DFHEIV0(25:11)
 19851     CALL 'kxdfhei1' USING DFHEIV0,
 19852           CRTT-ID,
 19853           CERTIFICATE-TRAILERS,
 19854           DFHEIV11,
 19855           WS-ELCRTT-KEY,
 19856           DFHEIV99,
 19857           DFHEIV99,
 19858           DFHEIV99
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19860
 19861     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19862     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19863
 19864     .
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 366
* EL050.cbl
 19865 8150-exit.
 19866     exit.
 19867 8180-UPDATE-VIN-NUMBER.
 19868
 19869* EXEC CICS HANDLE CONDITION
 19870*        NOTFND   (8180-NOTFND)
 19871*    END-EXEC.
 19872*    MOVE '"$I                   ! 0 #00019133' TO DFHEIV0
 19873     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19875     MOVE X'3020233030303139313333' TO DFHEIV0(25:11)
 19876     CALL 'kxdfhei1' USING DFHEIV0
 19877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19878
 19879
 19880     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19881     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19882
 19883
 19884* EXEC CICS READ
 19885*        UPDATE
 19886*        DATASET  (CRTT-ID)
 19887*        RIDFLD   (WS-ELCRTT-KEY)
 19888*        INTO     (CERTIFICATE-TRAILERS)
 19889*    END-EXEC.
 19890     MOVE LENGTH OF
 19891      CERTIFICATE-TRAILERS
 19892       TO DFHEIV11
 19893*    MOVE '&"IL       EU         (   #00019140' TO DFHEIV0
 19894     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303139313430' TO DFHEIV0(25:11)
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           CRTT-ID,
 19899           CERTIFICATE-TRAILERS,
 19900           DFHEIV11,
 19901           WS-ELCRTT-KEY,
 19902           DFHEIV99,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19906
 19907
 19908     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19909         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19910
 19911* EXEC CICS REWRITE
 19912*           DATASET  (CRTT-ID)
 19913*           FROM     (CERTIFICATE-TRAILERS)
 19914*        END-EXEC
 19915     MOVE LENGTH OF
 19916      CERTIFICATE-TRAILERS
 19917       TO DFHEIV11
 19918*    MOVE '&& L                  %   #00019149' TO DFHEIV0
 19919     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19920     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19921     MOVE X'2020233030303139313439' TO DFHEIV0(25:11)
 19922     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 367
* EL050.cbl
 19923           CRTT-ID,
 19924           CERTIFICATE-TRAILERS,
 19925           DFHEIV11,
 19926           DFHEIV99
 19927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19928     ELSE
 19929
 19930* EXEC CICS UNLOCK
 19931*          DATASET  (CRTT-ID)
 19932*       END-EXEC
 19933*    MOVE '&*                    #   #00019154' TO DFHEIV0
 19934     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19935     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19936     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 19937     CALL 'kxdfhei1' USING DFHEIV0,
 19938           CRTT-ID,
 19939           DFHEIV99
 19940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19941     END-IF.
 19942
 19943     GO TO 8180-EXIT.
 19944
 19945 8180-NOTFND.
 19946
 19947     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19948     MOVE 'CS'         TO CS-RECORD-ID.
 19949     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19950     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19951     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19952     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19953
 19954* EXEC CICS WRITE
 19955*       DATASET  (CRTT-ID)
 19956*       RIDFLD   (WS-ELCRTT-KEY)
 19957*       FROM     (CERTIFICATE-TRAILERS)
 19958*    END-EXEC.
 19959     MOVE LENGTH OF
 19960      CERTIFICATE-TRAILERS
 19961       TO DFHEIV11
 19962*    MOVE '&$ L                  ''   #00019169' TO DFHEIV0
 19963     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19965     MOVE X'2020233030303139313639' TO DFHEIV0(25:11)
 19966     CALL 'kxdfhei1' USING DFHEIV0,
 19967           CRTT-ID,
 19968           CERTIFICATE-TRAILERS,
 19969           DFHEIV11,
 19970           WS-ELCRTT-KEY,
 19971           DFHEIV99,
 19972           DFHEIV99
 19973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19974
 19975
 19976 8180-EXIT.
 19977     EXIT.
 19978
 19979 8190-UPDATE-REFUND-CLAIM-FLAG.
 19980
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 368
* EL050.cbl
 19981* EXEC CICS HANDLE CONDITION
 19982*        NOTFND   (8190-NOTFND)
 19983*    END-EXEC.
 19984*    MOVE '"$I                   ! 1 #00019179' TO DFHEIV0
 19985     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19987     MOVE X'3120233030303139313739' TO DFHEIV0(25:11)
 19988     CALL 'kxdfhei1' USING DFHEIV0
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19993     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19994
 19995
 19996* EXEC CICS READ
 19997*        UPDATE
 19998*        DATASET  (CRTT-ID)
 19999*        RIDFLD   (WS-ELCRTT-KEY)
 20000*        INTO     (CERTIFICATE-TRAILERS)
 20001*    END-EXEC.
 20002     MOVE LENGTH OF
 20003      CERTIFICATE-TRAILERS
 20004       TO DFHEIV11
 20005*    MOVE '&"IL       EU         (   #00019186' TO DFHEIV0
 20006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20007     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20008     MOVE X'2020233030303139313836' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0,
 20010           CRTT-ID,
 20011           CERTIFICATE-TRAILERS,
 20012           DFHEIV11,
 20013           WS-ELCRTT-KEY,
 20014           DFHEIV99,
 20015           DFHEIV99,
 20016           DFHEIV99
 20017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20018
 20019
 20020     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20021
 20022* EXEC CICS REWRITE
 20023*       DATASET  (CRTT-ID)
 20024*       FROM     (CERTIFICATE-TRAILERS)
 20025*    END-EXEC.
 20026     MOVE LENGTH OF
 20027      CERTIFICATE-TRAILERS
 20028       TO DFHEIV11
 20029*    MOVE '&& L                  %   #00019194' TO DFHEIV0
 20030     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20032     MOVE X'2020233030303139313934' TO DFHEIV0(25:11)
 20033     CALL 'kxdfhei1' USING DFHEIV0,
 20034           CRTT-ID,
 20035           CERTIFICATE-TRAILERS,
 20036           DFHEIV11,
 20037           DFHEIV99
 20038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 369
* EL050.cbl
 20039
 20040
 20041     GO TO 8190-EXIT.
 20042
 20043 8190-NOTFND.
 20044
 20045     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20046     MOVE 'CS'         TO CS-RECORD-ID.
 20047     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20048     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20049     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20050     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20051
 20052* EXEC CICS WRITE
 20053*       DATASET  (CRTT-ID)
 20054*       RIDFLD   (WS-ELCRTT-KEY)
 20055*       FROM     (CERTIFICATE-TRAILERS)
 20056*    END-EXEC.
 20057     MOVE LENGTH OF
 20058      CERTIFICATE-TRAILERS
 20059       TO DFHEIV11
 20060*    MOVE '&$ L                  ''   #00019209' TO DFHEIV0
 20061     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20062     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20063     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
 20064     CALL 'kxdfhei1' USING DFHEIV0,
 20065           CRTT-ID,
 20066           CERTIFICATE-TRAILERS,
 20067           DFHEIV11,
 20068           WS-ELCRTT-KEY,
 20069           DFHEIV99,
 20070           DFHEIV99
 20071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20072
 20073
 20074 8190-EXIT.
 20075     EXIT.
 20076
 20077 8195-UPDATE-AGE-FLAGS.
 20078
 20079* EXEC CICS HANDLE CONDITION
 20080*        NOTFND   (8195-NOTFND)
 20081*    END-EXEC.
 20082*    MOVE '"$I                   ! 2 #00019219' TO DFHEIV0
 20083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20085     MOVE X'3220233030303139323139' TO DFHEIV0(25:11)
 20086     CALL 'kxdfhei1' USING DFHEIV0
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20091     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20092
 20093
 20094* EXEC CICS READ
 20095*        UPDATE
 20096*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 370
* EL050.cbl
 20097*        RIDFLD   (WS-ELCRTT-KEY)
 20098*        INTO     (CERTIFICATE-TRAILERS)
 20099*    END-EXEC.
 20100     MOVE LENGTH OF
 20101      CERTIFICATE-TRAILERS
 20102       TO DFHEIV11
 20103*    MOVE '&"IL       EU         (   #00019226' TO DFHEIV0
 20104     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20105     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20106     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 20107     CALL 'kxdfhei1' USING DFHEIV0,
 20108           CRTT-ID,
 20109           CERTIFICATE-TRAILERS,
 20110           DFHEIV11,
 20111           WS-ELCRTT-KEY,
 20112           DFHEIV99,
 20113           DFHEIV99,
 20114           DFHEIV99
 20115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20116
 20117
 20118     IF WS-INS-AGE-SET = 'Y'
 20119        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20120     END-IF
 20121     IF WS-JNT-AGE-SET = 'Y'
 20122        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20123     END-IF
 20124
 20125
 20126* EXEC CICS REWRITE
 20127*       DATASET  (CRTT-ID)
 20128*       FROM     (CERTIFICATE-TRAILERS)
 20129*    END-EXEC.
 20130     MOVE LENGTH OF
 20131      CERTIFICATE-TRAILERS
 20132       TO DFHEIV11
 20133*    MOVE '&& L                  %   #00019240' TO DFHEIV0
 20134     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20135     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20136     MOVE X'2020233030303139323430' TO DFHEIV0(25:11)
 20137     CALL 'kxdfhei1' USING DFHEIV0,
 20138           CRTT-ID,
 20139           CERTIFICATE-TRAILERS,
 20140           DFHEIV11,
 20141           DFHEIV99
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20143
 20144
 20145     GO TO 8195-EXIT.
 20146
 20147 8195-NOTFND.
 20148
 20149     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20150     MOVE 'CS'         TO CS-RECORD-ID.
 20151     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20152     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20153     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20154     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 371
* EL050.cbl
 20155     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20156
 20157* EXEC CICS WRITE
 20158*       DATASET  (CRTT-ID)
 20159*       RIDFLD   (WS-ELCRTT-KEY)
 20160*       FROM     (CERTIFICATE-TRAILERS)
 20161*    END-EXEC.
 20162     MOVE LENGTH OF
 20163      CERTIFICATE-TRAILERS
 20164       TO DFHEIV11
 20165*    MOVE '&$ L                  ''   #00019256' TO DFHEIV0
 20166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20168     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 20169     CALL 'kxdfhei1' USING DFHEIV0,
 20170           CRTT-ID,
 20171           CERTIFICATE-TRAILERS,
 20172           DFHEIV11,
 20173           WS-ELCRTT-KEY,
 20174           DFHEIV99,
 20175           DFHEIV99
 20176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20177
 20178
 20179 8195-EXIT.
 20180     EXIT.
 20181
 20182 8200-READ-REIN-TABLE.
 20183
 20184* EXEC CICS HANDLE CONDITION
 20185*         NOTFND   (8200-NOTFND)
 20186*    END-EXEC.
 20187*    MOVE '"$I                   ! 3 #00019266' TO DFHEIV0
 20188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20190     MOVE X'3320233030303139323636' TO DFHEIV0(25:11)
 20191     CALL 'kxdfhei1' USING DFHEIV0
 20192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20193
 20194
 20195
 20196* EXEC CICS READ
 20197*        DATASET     (REIN-ID)
 20198*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20199*        RIDFLD      (ERREIN-KEY)
 20200*    END-EXEC.
 20201*    MOVE '&"S        E          (   #00019270' TO DFHEIV0
 20202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303139323730' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           REIN-ID,
 20207           DFHEIV20,
 20208           DFHEIV99,
 20209           ERREIN-KEY,
 20210           DFHEIV99,
 20211           DFHEIV99,
 20212           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 372
* EL050.cbl
 20213     SET ADDRESS OF REINSURANCE-RECORD TO
 20214         DFHEIV20
 20215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20216
 20217
 20218     GO TO 8200-EXIT.
 20219
 20220 8200-NOTFND.
 20221     MOVE 'N'             TO WS-REIN-READ-SW.
 20222
 20223 8200-EXIT.
 20224      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 373
* EL050.cbl
 20226
 20227 8300-READ-CTBL-TABLE.
 20228
 20229* EXEC CICS HANDLE CONDITION
 20230*        NOTFND    (8300-NOTFND)
 20231*        DISABLED  (8300-ERRESS-PROBLEM)
 20232*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20233*        ENDFILE   (8300-NOTFND)
 20234*    END-EXEC.
 20235*    MOVE '"$IcJ''                ! 4 #00019286' TO DFHEIV0
 20236     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20238     MOVE X'3420233030303139323836' TO DFHEIV0(25:11)
 20239     CALL 'kxdfhei1' USING DFHEIV0
 20240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20241
 20242
 20243
 20244* EXEC CICS READ
 20245*        DATASET     (CTBL-ID)
 20246*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20247*        RIDFLD      (ERCTBL-KEY)
 20248*    END-EXEC.
 20249*    MOVE '&"S        E          (   #00019293' TO DFHEIV0
 20250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20252     MOVE X'2020233030303139323933' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0,
 20254           CTBL-ID,
 20255           DFHEIV20,
 20256           DFHEIV99,
 20257           ERCTBL-KEY,
 20258           DFHEIV99,
 20259           DFHEIV99,
 20260           DFHEIV99
 20261     SET ADDRESS OF COMM-TABLE-RECORD TO
 20262         DFHEIV20
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20267
 20268     GO TO 8300-EXIT.
 20269
 20270 8300-NOTFND.
 20271
 20272     IF CTBL-SW = '0530'
 20273         MOVE 'AA'                     TO WS-AH-COMP-CD
 20274         MOVE '0550'                   TO CTBL-SW
 20275         MOVE '1'                      TO WS-CTBL-READ-SW
 20276         GO TO 8300-EXIT.
 20277
 20278     IF CTBL-SW = '0540'
 20279         MOVE 'AA'                     TO WS-LF-COMP-CD
 20280         MOVE '0550'                   TO CTBL-SW
 20281         MOVE '1'                      TO WS-CTBL-READ-SW
 20282         GO TO 8300-EXIT.
 20283
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 374
* EL050.cbl
 20284     IF CTBL-SW = '0550'
 20285         MOVE '2'                      TO WS-CTBL-READ-SW
 20286         GO TO 8300-EXIT.
 20287
 20288     GO TO 8300-EXIT.
 20289
 20290 8300-ERRESS-PROBLEM.
 20291
 20292      MOVE ER-8050              TO WS-ERROR.
 20293      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20294
 20295     GO TO 8300-EXIT.
 20296
 20297 8300-EXIT.
 20298      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 375
* EL050.cbl
 20300
 20301
 20302 8400-GETMAIN-ERFORM.
 20303
 20304
 20305* EXEC CICS   GETMAIN
 20306*        LENGTH  (500)
 20307*        SET     (ADDRESS OF FORM-MASTER)
 20308*    END-EXEC.
 20309     MOVE 500
 20310       TO DFHEIV11
 20311*    MOVE '," L                  $   #00019337' TO DFHEIV0
 20312     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20314     MOVE X'2020233030303139333337' TO DFHEIV0(25:11)
 20315     CALL 'kxdfhei1' USING DFHEIV0,
 20316           DFHEIV20,
 20317           DFHEIV11,
 20318           DFHEIV99
 20319     SET ADDRESS OF FORM-MASTER TO
 20320         DFHEIV20
 20321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20322
 20323
 20324     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20325
 20326 8400-EXIT.
 20327      EXIT.
 20328
 20329 8450-READ-FORM-MASTER.
 20330
 20331
 20332* EXEC CICS  HANDLE CONDITION
 20333*        NOTFND   (8450-FORM-NOT-FOUND)
 20334*        ENDFILE  (8450-FORM-NOT-FOUND)
 20335*    END-EXEC.
 20336*    MOVE '"$I''                  ! 5 #00019349' TO DFHEIV0
 20337     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20339     MOVE X'3520233030303139333439' TO DFHEIV0(25:11)
 20340     CALL 'kxdfhei1' USING DFHEIV0
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344
 20345* EXEC CICS   READ
 20346*        DATASET   (FORM-ID)
 20347*        RIDFLD    (ERFORM-KEY)
 20348*        INTO      (FORM-MASTER)
 20349*        GTEQ
 20350*    END-EXEC.
 20351     MOVE LENGTH OF
 20352      FORM-MASTER
 20353       TO DFHEIV11
 20354*    MOVE '&"IL       G          (   #00019354' TO DFHEIV0
 20355     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20357     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 376
* EL050.cbl
 20358     CALL 'kxdfhei1' USING DFHEIV0,
 20359           FORM-ID,
 20360           FORM-MASTER,
 20361           DFHEIV11,
 20362           ERFORM-KEY,
 20363           DFHEIV99,
 20364           DFHEIV99,
 20365           DFHEIV99
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369     MOVE  'Y'           TO  FORM-MASTER-SW.
 20370
 20371     GO TO  8450-EXIT.
 20372
 20373 8450-FORM-NOT-FOUND.
 20374
 20375     MOVE  'N'           TO  FORM-MASTER-SW.
 20376
 20377 8450-EXIT.
 20378      EXIT.
 20379
 20380 8500-DATE-CONVERT.
 20381
 20382* EXEC CICS LINK
 20383*        PROGRAM    ('ELDATCV')
 20384*        COMMAREA   (DATE-CONVERSION-DATA)
 20385*        LENGTH     (DC-COMM-LENGTH)
 20386*    END-EXEC.
 20387     MOVE 'ELDATCV' TO DFHEIV1
 20388*    MOVE '."C                   (   #00019373' TO DFHEIV0
 20389     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20391     MOVE X'2020233030303139333733' TO DFHEIV0(25:11)
 20392     CALL 'kxdfhei1' USING DFHEIV0,
 20393           DFHEIV1,
 20394           DATE-CONVERSION-DATA,
 20395           DC-COMM-LENGTH,
 20396           DFHEIV99,
 20397           DFHEIV99,
 20398           DFHEIV99,
 20399           DFHEIV99
 20400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20401
 20402
 20403 8500-EXIT.
 20404     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 377
* EL050.cbl
 20406
 20407 8555-RELOAD-CONTROL-FILE.
 20408     CONTINUE.
 20409
 20410 8555-EXIT.
 20411     EXIT.
 20412
 20413 8557-GETMAIN-ERPLAN.
 20414
 20415
 20416* EXEC CICS GETMAIN
 20417*        LENGTH    (840)
 20418*        SET       (ADDRESS OF PLAN-RECORDS)
 20419*    END-EXEC.
 20420     MOVE 840
 20421       TO DFHEIV11
 20422*    MOVE '," L                  $   #00019391' TO DFHEIV0
 20423     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303139333931' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           DFHEIV20,
 20428           DFHEIV11,
 20429           DFHEIV99
 20430     SET ADDRESS OF PLAN-RECORDS TO
 20431         DFHEIV20
 20432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20433
 20434
 20435     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20436
 20437 8557-EXIT.
 20438     EXIT.
 20439
 20440 8560-GETMAIN.
 20441
 20442* EXEC CICS GETMAIN
 20443*        LENGTH    (2000)
 20444*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20445*    END-EXEC.
 20446     MOVE 2000
 20447       TO DFHEIV11
 20448*    MOVE '," L                  $   #00019402' TO DFHEIV0
 20449     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           DFHEIV20,
 20454           DFHEIV11,
 20455           DFHEIV99
 20456     SET ADDRESS OF ACCOUNT-MASTER TO
 20457         DFHEIV20
 20458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20459
 20460
 20461     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20462
 20463 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 378
* EL050.cbl
 20464     EXIT.
 20465
 20466 8570-START-ACCOUNT-MASTER.
 20467
 20468* EXEC CICS HANDLE CONDITION
 20469*        NOTFND    (0199-ACCT-NOT-FOUND)
 20470*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20471*    END-EXEC.
 20472*    MOVE '"$I''                  ! 6 #00019413' TO DFHEIV0
 20473     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20475     MOVE X'3620233030303139343133' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0
 20477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20478
 20479
 20480
 20481* EXEC CICS STARTBR
 20482*        DATASET    (ACCT-ID)
 20483*        RIDFLD     (ERACCT-KEY)
 20484*        GTEQ
 20485*    END-EXEC.
 20486     MOVE 0
 20487       TO DFHEIV11
 20488*    MOVE '&,         G          &   #00019418' TO DFHEIV0
 20489     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20491     MOVE X'2020233030303139343138' TO DFHEIV0(25:11)
 20492     CALL 'kxdfhei1' USING DFHEIV0,
 20493           ACCT-ID,
 20494           ERACCT-KEY,
 20495           DFHEIV99,
 20496           DFHEIV11,
 20497           DFHEIV99
 20498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20499
 20500
 20501 8570-EXIT.
 20502     EXIT.
 20503
 20504 8580-READ-ACCOUNT-MASTER.
 20505
 20506* EXEC CICS HANDLE CONDITION
 20507*        NOTFND    (0199-ACCT-NOT-FOUND)
 20508*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20509*    END-EXEC.
 20510*    MOVE '"$I''                  ! 7 #00019428' TO DFHEIV0
 20511     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20513     MOVE X'3720233030303139343238' TO DFHEIV0(25:11)
 20514     CALL 'kxdfhei1' USING DFHEIV0
 20515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20516
 20517
 20518
 20519* EXEC CICS READNEXT
 20520*        DATASET     (ACCT-ID)
 20521*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 379
* EL050.cbl
 20522*        RIDFLD      (ERACCT-KEY)
 20523*    END-EXEC.
 20524     MOVE LENGTH OF
 20525      ACCOUNT-MASTER
 20526       TO DFHEIV12
 20527     MOVE 0
 20528       TO DFHEIV11
 20529*    MOVE '&.IL                  )   #00019433' TO DFHEIV0
 20530     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20532     MOVE X'2020233030303139343333' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0,
 20534           ACCT-ID,
 20535           ACCOUNT-MASTER,
 20536           DFHEIV12,
 20537           ERACCT-KEY,
 20538           DFHEIV99,
 20539           DFHEIV11,
 20540           DFHEIV99,
 20541           DFHEIV99
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545 8580-EXIT.
 20546     EXIT.
 20547
 20548 8582-READ-COMPENSATION-MASTER.
 20549
 20550* EXEC CICS HANDLE CONDITION
 20551*        NOTFND    (8582-COMP-NOT-FOUND)
 20552*        ENDFILE   (8582-COMP-NOT-FOUND)
 20553*    END-EXEC.
 20554*    MOVE '"$I''                  ! 8 #00019443' TO DFHEIV0
 20555     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20557     MOVE X'3820233030303139343433' TO DFHEIV0(25:11)
 20558     CALL 'kxdfhei1' USING DFHEIV0
 20559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20560
 20561
 20562
 20563* EXEC CICS READ
 20564*        DATASET     (COMP-ID)
 20565*        INTO        (COMPENSATION-MASTER)
 20566*        RIDFLD      (ERCOMP-KEY)
 20567*    END-EXEC.
 20568     MOVE LENGTH OF
 20569      COMPENSATION-MASTER
 20570       TO DFHEIV11
 20571*    MOVE '&"IL       E          (   #00019448' TO DFHEIV0
 20572     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20574     MOVE X'2020233030303139343438' TO DFHEIV0(25:11)
 20575     CALL 'kxdfhei1' USING DFHEIV0,
 20576           COMP-ID,
 20577           COMPENSATION-MASTER,
 20578           DFHEIV11,
 20579           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 380
* EL050.cbl
 20580           DFHEIV99,
 20581           DFHEIV99,
 20582           DFHEIV99
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20584
 20585
 20586     MOVE 'Y'                    TO COMP-MASTER-SW
 20587
 20588     GO TO 8582-EXIT
 20589     .
 20590 8582-COMP-NOT-FOUND.
 20591
 20592     MOVE 'N'                    TO COMP-MASTER-SW.
 20593
 20594 8582-EXIT.
 20595     EXIT.
 20596
 20597 8583-READ-ERAGTC.
 20598
 20599* EXEC CICS HANDLE CONDITION
 20600*        NOTFND    (8583-AGTC-NOT-FOUND)
 20601*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20602*    END-EXEC.
 20603*    MOVE '"$I''                  ! 9 #00019466' TO DFHEIV0
 20604     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20606     MOVE X'3920233030303139343636' TO DFHEIV0(25:11)
 20607     CALL 'kxdfhei1' USING DFHEIV0
 20608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20609
 20610
 20611
 20612* EXEC CICS STARTBR
 20613*        DATASET    (AGTC-ID)
 20614*        RIDFLD     (ERAGTC-KEY)
 20615*        GTEQ
 20616*    END-EXEC.
 20617     MOVE 0
 20618       TO DFHEIV11
 20619*    MOVE '&,         G          &   #00019471' TO DFHEIV0
 20620     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20622     MOVE X'2020233030303139343731' TO DFHEIV0(25:11)
 20623     CALL 'kxdfhei1' USING DFHEIV0,
 20624           AGTC-ID,
 20625           ERAGTC-KEY,
 20626           DFHEIV99,
 20627           DFHEIV11,
 20628           DFHEIV99
 20629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20630
 20631
 20632 8583-READ-ERAGTC-NEXT.
 20633
 20634* EXEC CICS READNEXT
 20635*        DATASET     (AGTC-ID)
 20636*        INTO        (AGENT-COMMISSIONS)
 20637*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 381
* EL050.cbl
 20638*    END-EXEC.
 20639     MOVE LENGTH OF
 20640      AGENT-COMMISSIONS
 20641       TO DFHEIV12
 20642     MOVE 0
 20643       TO DFHEIV11
 20644*    MOVE '&.IL                  )   #00019478' TO DFHEIV0
 20645     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20647     MOVE X'2020233030303139343738' TO DFHEIV0(25:11)
 20648     CALL 'kxdfhei1' USING DFHEIV0,
 20649           AGTC-ID,
 20650           AGENT-COMMISSIONS,
 20651           DFHEIV12,
 20652           ERAGTC-KEY,
 20653           DFHEIV99,
 20654           DFHEIV11,
 20655           DFHEIV99,
 20656           DFHEIV99
 20657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20658
 20659
 20660*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20661
 20662     GO TO 8583-EXIT
 20663     .
 20664 8583-AGTC-NOT-FOUND.
 20665
 20666     MOVE 'N'                    TO AGTC-MASTER-SW.
 20667
 20668 8583-EXIT.
 20669     EXIT.
 20670
 20671 8584-READ-BANK-CROSS-REF.
 20672
 20673* EXEC CICS HANDLE CONDITION
 20674*        NOTFND    (8584-BXRF-NOT-FOUND)
 20675*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20676*    END-EXEC.
 20677*    MOVE '"$I''                  ! : #00019496' TO DFHEIV0
 20678     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20680     MOVE X'3A20233030303139343936' TO DFHEIV0(25:11)
 20681     CALL 'kxdfhei1' USING DFHEIV0
 20682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20683
 20684
 20685
 20686* EXEC CICS READ
 20687*        DATASET     (BXRF-ID)
 20688*        INTO        (BANK-CROSS-REFERENCE)
 20689*        RIDFLD      (ERBXRF-KEY)
 20690*        LENGTH      (BXRF-REC-LENGTH)
 20691*    END-EXEC.
 20692*    MOVE '&"IL       E          (   #00019501' TO DFHEIV0
 20693     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20695     MOVE X'2020233030303139353031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 382
* EL050.cbl
 20696     CALL 'kxdfhei1' USING DFHEIV0,
 20697           BXRF-ID,
 20698           BANK-CROSS-REFERENCE,
 20699           BXRF-REC-LENGTH,
 20700           ERBXRF-KEY,
 20701           DFHEIV99,
 20702           DFHEIV99,
 20703           DFHEIV99
 20704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20705
 20706
 20707     MOVE 'Y'                    TO BXRF-MASTER-SW
 20708
 20709     GO TO 8584-EXIT
 20710     .
 20711 8584-BXRF-NOT-FOUND.
 20712
 20713     MOVE 'N'                    TO BXRF-MASTER-SW.
 20714
 20715 8584-EXIT.
 20716     EXIT.
 20717
 20718 8585-READ-PLAN-MASTER.
 20719
 20720
 20721* EXEC CICS HANDLE CONDITION
 20722*        NOTFND    (8585-PLAN-NOT-FOUND)
 20723*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20724*    END-EXEC.
 20725*    MOVE '"$I''                  ! ; #00019521' TO DFHEIV0
 20726     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20728     MOVE X'3B20233030303139353231' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0
 20730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20731
 20732
 20733
 20734* EXEC CICS READ
 20735*        DATASET     (PLAN-ID)
 20736*        INTO        (PLAN-MASTER)
 20737*        RIDFLD      (ERPLAN-KEY)
 20738*    END-EXEC.
 20739     MOVE LENGTH OF
 20740      PLAN-MASTER
 20741       TO DFHEIV11
 20742*    MOVE '&"IL       E          (   #00019526' TO DFHEIV0
 20743     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20745     MOVE X'2020233030303139353236' TO DFHEIV0(25:11)
 20746     CALL 'kxdfhei1' USING DFHEIV0,
 20747           PLAN-ID,
 20748           PLAN-MASTER,
 20749           DFHEIV11,
 20750           ERPLAN-KEY,
 20751           DFHEIV99,
 20752           DFHEIV99,
 20753           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 383
* EL050.cbl
 20754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20755
 20756
 20757     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20758
 20759     GO TO 8585-EXIT.
 20760
 20761 8585-PLAN-NOT-FOUND.
 20762
 20763     MOVE 'N'                    TO PLAN-MASTER-SW.
 20764
 20765 8585-EXIT.
 20766     EXIT.
 20767
 20768 8586-READ-LOAN-OFFICER.
 20769
 20770* EXEC CICS READ
 20771*        DATASET     (LOFC-ID)
 20772*        INTO        (LOAN-OFFICER-MASTER)
 20773*        RIDFLD      (ERLOFC-KEY)
 20774*        RESP        (WS-RESPONSE)
 20775*    END-EXEC
 20776     MOVE LENGTH OF
 20777      LOAN-OFFICER-MASTER
 20778       TO DFHEIV11
 20779*    MOVE '&"IL       E          (  N#00019544' TO DFHEIV0
 20780     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20782     MOVE X'204E233030303139353434' TO DFHEIV0(25:11)
 20783     CALL 'kxdfhei1' USING DFHEIV0,
 20784           LOFC-ID,
 20785           LOAN-OFFICER-MASTER,
 20786           DFHEIV11,
 20787           ERLOFC-KEY,
 20788           DFHEIV99,
 20789           DFHEIV99,
 20790           DFHEIV99
 20791     MOVE EIBRESP  TO WS-RESPONSE
 20792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20793
 20794     IF WS-RESP-NORMAL
 20795        MOVE 'Y'                 TO LOFC-MASTER-SW
 20796     ELSE
 20797        MOVE 'N'                 TO LOFC-MASTER-SW
 20798     END-IF
 20799     .
 20800 8586-EXIT.
 20801     EXIT.
 20802 8587-START-ERPDEF.
 20803
 20804* EXEC CICS STARTBR
 20805*       DATASET   (PDEF-ID)
 20806*       RIDFLD    (ERPDEF-KEY)
 20807*       GTEQ
 20808*       RESP      (WS-RESPONSE)
 20809*    END-EXEC
 20810     MOVE 0
 20811       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 384
* EL050.cbl
 20812*    MOVE '&,         G          &  N#00019560' TO DFHEIV0
 20813     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20815     MOVE X'204E233030303139353630' TO DFHEIV0(25:11)
 20816     CALL 'kxdfhei1' USING DFHEIV0,
 20817           PDEF-ID,
 20818           ERPDEF-KEY,
 20819           DFHEIV99,
 20820           DFHEIV11,
 20821           DFHEIV99
 20822     MOVE EIBRESP  TO WS-RESPONSE
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20824     IF WS-RESP-NORMAL
 20825        MOVE 'Y'                 TO PDEF-MASTER-SW
 20826     ELSE
 20827        MOVE 'N'                 TO PDEF-MASTER-SW
 20828     END-IF
 20829     .
 20830 8587-EXIT.
 20831     EXIT.
 20832 8588-READ-ERPDEF.
 20833
 20834* EXEC CICS READNEXT
 20835*       DATASET   (PDEF-ID)
 20836*       RIDFLD    (ERPDEF-KEY)
 20837*       INTO      (PRODUCT-MASTER)
 20838*       RESP      (WS-RESPONSE)
 20839*    END-EXEC
 20840     MOVE LENGTH OF
 20841      PRODUCT-MASTER
 20842       TO DFHEIV12
 20843     MOVE 0
 20844       TO DFHEIV11
 20845*    MOVE '&.IL                  )  N#00019575' TO DFHEIV0
 20846     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20848     MOVE X'204E233030303139353735' TO DFHEIV0(25:11)
 20849     CALL 'kxdfhei1' USING DFHEIV0,
 20850           PDEF-ID,
 20851           PRODUCT-MASTER,
 20852           DFHEIV12,
 20853           ERPDEF-KEY,
 20854           DFHEIV99,
 20855           DFHEIV11,
 20856           DFHEIV99,
 20857           DFHEIV99
 20858     MOVE EIBRESP  TO WS-RESPONSE
 20859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20860     IF WS-RESP-NORMAL
 20861        MOVE 'Y'                 TO PDEF-MASTER-SW
 20862     ELSE
 20863        MOVE 'N'                 TO PDEF-MASTER-SW
 20864     END-IF
 20865     .
 20866 8588-EXIT.
 20867     EXIT.
 20868 8589-ENDBR-ERPDEF.
 20869
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 385
* EL050.cbl
 20870* EXEC CICS ENDBR
 20871*       DATASET   (PDEF-ID)
 20872*    END-EXEC
 20873     MOVE 0
 20874       TO DFHEIV11
 20875*    MOVE '&2                    $   #00019590' TO DFHEIV0
 20876     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20878     MOVE X'2020233030303139353930' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0,
 20880           PDEF-ID,
 20881           DFHEIV11,
 20882           DFHEIV99
 20883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20884     .
 20885 8589-EXIT.
 20886     EXIT.
 20887 8590-READ-CERT-MASTER.
 20888     IF PB-COMPANY-ID = 'UCL'
 20889         GO TO 8690-READ-CERT-MASTER-UCL.
 20890
 20891
 20892* EXEC CICS HANDLE CONDITION
 20893*         NOTFND    (0299-CERT-NOT-FOUND)
 20894*    END-EXEC.
 20895*    MOVE '"$I                   ! < #00019600' TO DFHEIV0
 20896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20898     MOVE X'3C20233030303139363030' TO DFHEIV0(25:11)
 20899     CALL 'kxdfhei1' USING DFHEIV0
 20900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20901
 20902
 20903
 20904* EXEC CICS READ
 20905*        DATASET     (CERT-ID)
 20906*        INTO        (CERTIFICATE-MASTER)
 20907*        RIDFLD      (ELCERT-KEY)
 20908*        UPDATE
 20909*    END-EXEC.
 20910     MOVE LENGTH OF
 20911      CERTIFICATE-MASTER
 20912       TO DFHEIV11
 20913*    MOVE '&"IL       EU         (   #00019604' TO DFHEIV0
 20914     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20915     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20916     MOVE X'2020233030303139363034' TO DFHEIV0(25:11)
 20917     CALL 'kxdfhei1' USING DFHEIV0,
 20918           CERT-ID,
 20919           CERTIFICATE-MASTER,
 20920           DFHEIV11,
 20921           ELCERT-KEY,
 20922           DFHEIV99,
 20923           DFHEIV99,
 20924           DFHEIV99
 20925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20926
 20927
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 386
* EL050.cbl
 20928 8590-EXIT.
 20929     EXIT.
 20930
 20931 8690-READ-CERT-MASTER-UCL.
 20932
 20933* EXEC CICS HANDLE CONDITION
 20934*         NOTFND    (8700-READ-CERT-MASTER)
 20935*    END-EXEC.
 20936*    MOVE '"$I                   ! = #00019615' TO DFHEIV0
 20937     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20939     MOVE X'3D20233030303139363135' TO DFHEIV0(25:11)
 20940     CALL 'kxdfhei1' USING DFHEIV0
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20942
 20943
 20944 8690-READ-CERT-CONT.
 20945
 20946* EXEC CICS READ
 20947*        DATASET     (CERT-ID)
 20948*        INTO        (CERTIFICATE-MASTER)
 20949*        RIDFLD      (ELCERT-KEY)
 20950*        UPDATE
 20951*    END-EXEC.
 20952     MOVE LENGTH OF
 20953      CERTIFICATE-MASTER
 20954       TO DFHEIV11
 20955*    MOVE '&"IL       EU         (   #00019620' TO DFHEIV0
 20956     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20957     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20958     MOVE X'2020233030303139363230' TO DFHEIV0(25:11)
 20959     CALL 'kxdfhei1' USING DFHEIV0,
 20960           CERT-ID,
 20961           CERTIFICATE-MASTER,
 20962           DFHEIV11,
 20963           ELCERT-KEY,
 20964           DFHEIV99,
 20965           DFHEIV99,
 20966           DFHEIV99
 20967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20968
 20969
 20970     GO TO 8590-EXIT.
 20971
 20972 8700-READ-CERT-MASTER.
 20973     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20974     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20975
 20976* EXEC CICS HANDLE CONDITION
 20977*         DUPKEY    (8720-COMP-ACCOUNTS)
 20978*         ENDFILE   (8730-END-BROWSE)
 20979*         NOTFND    (8740-NOT-FOUND)
 20980*    END-EXEC.
 20981*    MOVE '"$$''I                 ! > #00019632' TO DFHEIV0
 20982     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20984     MOVE X'3E20233030303139363332' TO DFHEIV0(25:11)
 20985     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 387
* EL050.cbl
 20986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20987
 20988
 20989
 20990* EXEC CICS STARTBR
 20991*        DATASET     ('ELCERT5')
 20992*        RIDFLD      (ELCERT2-KEY)
 20993*        EQUAL
 20994*    END-EXEC.
 20995     MOVE 'ELCERT5' TO DFHEIV1
 20996     MOVE 0
 20997       TO DFHEIV11
 20998*    MOVE '&,         E          &   #00019638' TO DFHEIV0
 20999     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21000     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21001     MOVE X'2020233030303139363338' TO DFHEIV0(25:11)
 21002     CALL 'kxdfhei1' USING DFHEIV0,
 21003           DFHEIV1,
 21004           ELCERT2-KEY,
 21005           DFHEIV99,
 21006           DFHEIV11,
 21007           DFHEIV99
 21008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21009
 21010
 21011 8710-READ-NEXT.
 21012
 21013* EXEC CICS READNEXT
 21014*        DATASET     ('ELCERT5')
 21015*        INTO        (CERTIFICATE-MASTER)
 21016*        RIDFLD      (ELCERT2-KEY)
 21017*    END-EXEC.
 21018     MOVE LENGTH OF
 21019      CERTIFICATE-MASTER
 21020       TO DFHEIV12
 21021     MOVE 'ELCERT5' TO DFHEIV1
 21022     MOVE 0
 21023       TO DFHEIV11
 21024*    MOVE '&.IL                  )   #00019645' TO DFHEIV0
 21025     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21026     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21027     MOVE X'2020233030303139363435' TO DFHEIV0(25:11)
 21028     CALL 'kxdfhei1' USING DFHEIV0,
 21029           DFHEIV1,
 21030           CERTIFICATE-MASTER,
 21031           DFHEIV12,
 21032           ELCERT2-KEY,
 21033           DFHEIV99,
 21034           DFHEIV11,
 21035           DFHEIV99,
 21036           DFHEIV99
 21037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21038
 21039
 21040 8720-COMP-ACCOUNTS.
 21041
 21042* EXEC CICS ENTER
 21043*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 388
* EL050.cbl
 21044*         FROM (PB-C-LAST-NAME)
 21045*    END-EXEC.
 21046     MOVE 001
 21047       TO DFHEIV11
 21048*    MOVE ':$F                   %   #00019652' TO DFHEIV0
 21049     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21051     MOVE X'2020233030303139363532' TO DFHEIV0(25:11)
 21052     CALL 'kxdfhei1' USING DFHEIV0,
 21053           DFHEIV11,
 21054           PB-C-LAST-NAME,
 21055           DFHEIV99,
 21056           DFHEIV99
 21057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21058
 21059
 21060
 21061* EXEC CICS ENTER
 21062*         TRACEID (002)
 21063*         FROM (CM-INSURED-LAST-NAME)
 21064*    END-EXEC.
 21065     MOVE 002
 21066       TO DFHEIV11
 21067*    MOVE ':$F                   %   #00019657' TO DFHEIV0
 21068     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21069     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21070     MOVE X'2020233030303139363537' TO DFHEIV0(25:11)
 21071     CALL 'kxdfhei1' USING DFHEIV0,
 21072           DFHEIV11,
 21073           CM-INSURED-LAST-NAME,
 21074           DFHEIV99,
 21075           DFHEIV99
 21076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21077
 21078
 21079     IF PB-CERT-NO NOT = CM-CERT-NO
 21080         GO TO 8730-END-BROWSE.
 21081
 21082     IF PB-ACCOUNT = CM-ACCOUNT
 21083         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21084             MOVE ER-2799        TO WS-ERROR
 21085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21086             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21087             GO TO 8730-END-BROWSE.
 21088
 21089     GO TO 8710-READ-NEXT.
 21090
 21091 8730-END-BROWSE.
 21092
 21093* EXEC CICS ENDBR
 21094*         DATASET    ('ELCERT5')
 21095*    END-EXEC.
 21096     MOVE 'ELCERT5' TO DFHEIV1
 21097     MOVE 0
 21098       TO DFHEIV11
 21099*    MOVE '&2                    $   #00019675' TO DFHEIV0
 21100     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21101     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 389
* EL050.cbl
 21102     MOVE X'2020233030303139363735' TO DFHEIV0(25:11)
 21103     CALL 'kxdfhei1' USING DFHEIV0,
 21104           DFHEIV1,
 21105           DFHEIV11,
 21106           DFHEIV99
 21107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21108
 21109
 21110 8740-NOT-FOUND.
 21111     GO TO 0299-CERT-NOT-FOUND.
 21112
 21113 8750-START-ELSTAT.
 21114
 21115* EXEC CICS STARTBR
 21116*       DATASET   (STAT-ID)
 21117*       RIDFLD    (ELSTAT-KEY)
 21118*       GTEQ
 21119*       RESP      (WS-RESPONSE)
 21120*    END-EXEC
 21121     MOVE 0
 21122       TO DFHEIV11
 21123*    MOVE '&,         G          &  N#00019683' TO DFHEIV0
 21124     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21126     MOVE X'204E233030303139363833' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           STAT-ID,
 21129           ELSTAT-KEY,
 21130           DFHEIV99,
 21131           DFHEIV11,
 21132           DFHEIV99
 21133     MOVE EIBRESP  TO WS-RESPONSE
 21134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21135     IF WS-RESP-NORMAL
 21136        MOVE 'Y'                 TO STAT-MASTER-SW
 21137     ELSE
 21138        MOVE 'N'                 TO STAT-MASTER-SW
 21139     END-IF
 21140     .
 21141 8750-EXIT.
 21142     EXIT.
 21143 8752-READ-ELSTAT.
 21144
 21145* EXEC CICS READNEXT
 21146*       DATASET   (STAT-ID)
 21147*       RIDFLD    (ELSTAT-KEY)
 21148*       INTO      (STATE-FILE)
 21149*       RESP      (WS-RESPONSE)
 21150*    END-EXEC
 21151     MOVE LENGTH OF
 21152      STATE-FILE
 21153       TO DFHEIV12
 21154     MOVE 0
 21155       TO DFHEIV11
 21156*    MOVE '&.IL                  )  N#00019698' TO DFHEIV0
 21157     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21158     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21159     MOVE X'204E233030303139363938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 390
* EL050.cbl
 21160     CALL 'kxdfhei1' USING DFHEIV0,
 21161           STAT-ID,
 21162           STATE-FILE,
 21163           DFHEIV12,
 21164           ELSTAT-KEY,
 21165           DFHEIV99,
 21166           DFHEIV11,
 21167           DFHEIV99,
 21168           DFHEIV99
 21169     MOVE EIBRESP  TO WS-RESPONSE
 21170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21171     IF WS-RESP-NORMAL
 21172        MOVE 'Y'                 TO STAT-MASTER-SW
 21173     ELSE
 21174        MOVE 'N'                 TO STAT-MASTER-SW
 21175     END-IF
 21176     .
 21177 8752-EXIT.
 21178     EXIT.
 21179 8800-GET-COMP-RATE.
 21180     MOVE +1 TO IB.
 21181     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21182         ADD +9 TO IB
 21183         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21184             ADD +9 TO IB
 21185             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21186                MOVE ZEROS       TO WS-WK-RATE
 21187                GO TO 8800-EXIT.
 21188
 21189     IF PB-I-AGE GREATER CT-AGE (1)
 21190         ADD +3 TO IB
 21191         IF PB-I-AGE GREATER CT-AGE (2)
 21192             ADD +3 TO IB
 21193             IF PB-I-AGE GREATER CT-AGE (3)
 21194                MOVE ZEROS       TO WS-WK-RATE
 21195                GO TO 8800-EXIT.
 21196
 21197     IF WS-WORK-TERM GREATER CT-TRM (1)
 21198         ADD +1 TO IB
 21199         IF WS-WORK-TERM GREATER CT-TRM (2)
 21200             ADD +1 TO IB
 21201             IF WS-WORK-TERM GREATER CT-TRM (3)
 21202                MOVE ZEROS       TO WS-WK-RATE
 21203                GO TO 8800-EXIT.
 21204
 21205     IF CT-RT (IB) NOT NUMERIC
 21206         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21207         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21208         GO TO 8800-GET-COMP-RATE.
 21209
 21210     MOVE CT-RT (IB) TO WS-WK-RATE.
 21211
 21212 8800-EXIT.
 21213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 391
* EL050.cbl
 21215 8900-ADDRESS-FILE.
 21216     IF ERACCT-FILE-ADDRESSED
 21217         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21218         GO TO 8900-ADDRESS-EXIT.
 21219
 21220     IF ELCNTL-FILE-ADDRESSED
 21221         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21222         GO TO 8900-ADDRESS-EXIT.
 21223
 21224     IF ERPLAN-FILE-ADDRESSED
 21225         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21226         GO TO 8900-ADDRESS-EXIT.
 21227
 21228     IF ERFORM-FILE-ADDRESSED
 21229         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21230         GO TO 8900-ADDRESS-EXIT.
 21231
 21232 8900-ADDRESS-EXIT.
 21233     EXIT.
 21234
 21235 9000-READ-CONTROL.
 21236
 21237* EXEC CICS HANDLE CONDITION
 21238*        NOTFND    (9000-NOTFND)
 21239*    END-EXEC.
 21240*    MOVE '"$I                   ! ? #00019769' TO DFHEIV0
 21241     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21243     MOVE X'3F20233030303139373639' TO DFHEIV0(25:11)
 21244     CALL 'kxdfhei1' USING DFHEIV0
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21246
 21247
 21248
 21249* EXEC CICS READ
 21250*        DATASET     (CNTL-ID)
 21251*        SET         (ADDRESS OF CONTROL-FILE)
 21252*        RIDFLD      (ELCNTL-KEY)
 21253*        GTEQ
 21254*    END-EXEC.
 21255*    MOVE '&"S        G          (   #00019773' TO DFHEIV0
 21256     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21258     MOVE X'2020233030303139373733' TO DFHEIV0(25:11)
 21259     CALL 'kxdfhei1' USING DFHEIV0,
 21260           CNTL-ID,
 21261           DFHEIV20,
 21262           DFHEIV99,
 21263           ELCNTL-KEY,
 21264           DFHEIV99,
 21265           DFHEIV99,
 21266           DFHEIV99
 21267     SET ADDRESS OF CONTROL-FILE TO
 21268         DFHEIV20
 21269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21270
 21271
 21272     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 392
* EL050.cbl
 21273
 21274 9000-NOTFND.
 21275     IF RC-SW-1 = '1'
 21276        MOVE ER-2616              TO WS-ERROR
 21277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21278        GO TO 9000-EXIT.
 21279
 21280     IF RC-SW-1 = '2'
 21281        MOVE ER-2602              TO WS-ERROR
 21282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21283
 21284 9000-EXIT.
 21285      EXIT.
 21286
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 393
* EL050.cbl
 21288 9100-READ-CONTROL.
 21289
 21290* EXEC CICS HANDLE CONDITION
 21291*        NOTFND  (9100-NOTFND)
 21292*        ENDFILE (9100-NOTFND)
 21293*    END-EXEC.
 21294*    MOVE '"$I''                  ! @ #00019797' TO DFHEIV0
 21295     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21297     MOVE X'4020233030303139373937' TO DFHEIV0(25:11)
 21298     CALL 'kxdfhei1' USING DFHEIV0
 21299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21300
 21301
 21302
 21303* EXEC CICS READ
 21304*        DATASET     (CNTL-ID)
 21305*        INTO        (CONTROL-FILE)
 21306*        RIDFLD      (ELCNTL-KEY)
 21307*        GTEQ
 21308*    END-EXEC.
 21309     MOVE LENGTH OF
 21310      CONTROL-FILE
 21311       TO DFHEIV11
 21312*    MOVE '&"IL       G          (   #00019802' TO DFHEIV0
 21313     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21315     MOVE X'2020233030303139383032' TO DFHEIV0(25:11)
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           CNTL-ID,
 21318           CONTROL-FILE,
 21319           DFHEIV11,
 21320           ELCNTL-KEY,
 21321           DFHEIV99,
 21322           DFHEIV99,
 21323           DFHEIV99
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21325
 21326
 21327     GO TO 9100-EXIT.
 21328
 21329 9100-NOTFND.
 21330     IF RC-SW-2 = '0'
 21331        MOVE '1'                  TO STATE-RECORD-ERROR
 21332        GO TO 9100-EXIT
 21333     END-IF
 21334     IF RC-SW-2 = '1'
 21335        MOVE '1'                  TO LF-BENEFIT-ERROR
 21336        MOVE ER-2604              TO WS-ERROR
 21337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21338        GO TO 9100-EXIT.
 21339
 21340     IF RC-SW-2 = '2'
 21341        MOVE '1'                  TO AH-BENEFIT-ERROR
 21342        MOVE ER-2605              TO WS-ERROR
 21343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21344        GO TO 9100-EXIT.
 21345
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 394
* EL050.cbl
 21346     IF RC-SW-2 = '3'
 21347         MOVE ER-2603           TO WS-ERROR
 21348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21349         GO TO 9100-EXIT.
 21350
 21351     IF RC-SW-2 = '4'
 21352         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21353         GO TO 9100-EXIT.
 21354
 21355     IF RC-SW-2 = '5'
 21356         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21357         IF WS-AH-INPUT-CD-1 = SPACE
 21358             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21359         ELSE
 21360             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21361
 21362 9100-EXIT.
 21363      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 395
* EL050.cbl
 21365 9200-CONTROL-GETMAIN.
 21366
 21367* EXEC CICS GETMAIN
 21368*         LENGTH   (750)
 21369*         SET      (ADDRESS OF CONTROL-FILE)
 21370*    END-EXEC.
 21371     MOVE 750
 21372       TO DFHEIV11
 21373*    MOVE '," L                  $   #00019848' TO DFHEIV0
 21374     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21375     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21376     MOVE X'2020233030303139383438' TO DFHEIV0(25:11)
 21377     CALL 'kxdfhei1' USING DFHEIV0,
 21378           DFHEIV20,
 21379           DFHEIV11,
 21380           DFHEIV99
 21381     SET ADDRESS OF CONTROL-FILE TO
 21382         DFHEIV20
 21383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21384
 21385
 21386     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21387
 21388 9200-EXIT.
 21389     EXIT.
 21390
 21391 9250-UNLOCK-RETURN.
 21392
 21393* EXEC CICS UNLOCK
 21394*        DATASET   (CERT-ID)
 21395*    END-EXEC.
 21396*    MOVE '&*                    #   #00019859' TO DFHEIV0
 21397     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21398     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21399     MOVE X'2020233030303139383539' TO DFHEIV0(25:11)
 21400     CALL 'kxdfhei1' USING DFHEIV0,
 21401           CERT-ID,
 21402           DFHEIV99
 21403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21404
 21405
 21406 9300-ABEND.
 21407     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21408
 21409
 21410* EXEC CICS LINK
 21411*        PROGRAM   ('EL004')
 21412*        COMMAREA  (WS-ERROR-LINE)
 21413*        LENGTH    (72)
 21414*    END-EXEC.
 21415     MOVE 'EL004' TO DFHEIV1
 21416     MOVE 72
 21417       TO DFHEIV11
 21418*    MOVE '."C                   (   #00019866' TO DFHEIV0
 21419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21421     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 21422     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 396
* EL050.cbl
 21423           DFHEIV1,
 21424           WS-ERROR-LINE,
 21425           DFHEIV11,
 21426           DFHEIV99,
 21427           DFHEIV99,
 21428           DFHEIV99,
 21429           DFHEIV99
 21430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21431
 21432
 21433     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21434
 21435
 21436* EXEC CICS ABEND
 21437*        ABCODE ('EL50')
 21438*    END-EXEC.
 21439     MOVE 'EL50' TO DFHEIV5
 21440*    MOVE '.,A                   "   #00019874' TO DFHEIV0
 21441     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21442     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21443     MOVE X'2020233030303139383734' TO DFHEIV0(25:11)
 21444     CALL 'kxdfhei1' USING DFHEIV0,
 21445           DFHEIV5
 21446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21447
 21448
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 397
* EL050.cbl
 21450
 21451******************************************************************
 21452*                                                                *
 21453*            E R R O R   F O R M A T   R O U T I N E             *
 21454*                                                                *
 21455******************************************************************
 21456
 21457 9900-ERROR-FORMAT.
 21458
 21459     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21460                    PB-COMMON-ERROR (2) OR
 21461                    PB-COMMON-ERROR (3) OR
 21462                    PB-COMMON-ERROR (4) OR
 21463                    PB-COMMON-ERROR (5) OR
 21464                    PB-COMMON-ERROR (6) OR
 21465                    PB-COMMON-ERROR (7) OR
 21466                    PB-COMMON-ERROR (8) OR
 21467                    PB-COMMON-ERROR (9) OR
 21468                    PB-COMMON-ERROR (10)
 21469        GO TO 9900-EXIT.
 21470
 21471     IF PB-NO-OF-ERRORS = +10
 21472        GO TO 9900-EXIT.
 21473
 21474     ADD +1  TO PB-NO-OF-ERRORS.
 21475     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21476                                       (PB-NO-OF-ERRORS).
 21477 9900-EXIT.
 21478     EXIT.
 21479
 21480 9990-RETURN.
 21481     IF BROWSE-STARTED
 21482
 21483* EXEC CICS ENDBR
 21484*            DATASET  (ACCT-ID)
 21485*       END-EXEC.
 21486     MOVE 0
 21487       TO DFHEIV11
 21488*    MOVE '&2                    $   #00019911' TO DFHEIV0
 21489     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21490     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21491     MOVE X'2020233030303139393131' TO DFHEIV0(25:11)
 21492     CALL 'kxdfhei1' USING DFHEIV0,
 21493           ACCT-ID,
 21494           DFHEIV11,
 21495           DFHEIV99
 21496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21497
 21498
 21499 9990-EXIT.
 21500     EXIT.
 21501
 21502
 21503****Check for CRTO record, add one if not found.
 21504 9991-CHECK-FOR-ELCRTO.
 21505
 21506* EXEC CICS HANDLE CONDITION
 21507*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 398
* EL050.cbl
 21508*         ENDFILE (9991-CRTO-NOT-FOUND)
 21509*     END-EXEC.
 21510*    MOVE '"$I''                  ! A #00019921' TO DFHEIV0
 21511     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21513     MOVE X'4120233030303139393231' TO DFHEIV0(25:11)
 21514     CALL 'kxdfhei1' USING DFHEIV0
 21515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21516
 21517     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21518     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21519     MOVE +0                     TO ELCRTO-SEQ-NO
 21520
 21521
 21522* EXEC CICS READ
 21523*       DATASET   ('ELCRTO')
 21524*       INTO      (ORIGINAL-CERTIFICATE)
 21525*       RIDFLD    (ELCRTO-KEY)
 21526*       GTEQ
 21527*       RESP      (WS-RESPONSE)
 21528*    END-EXEC
 21529     MOVE LENGTH OF
 21530      ORIGINAL-CERTIFICATE
 21531       TO DFHEIV11
 21532     MOVE 'ELCRTO' TO DFHEIV1
 21533*    MOVE '&"IL       G          (  N#00019929' TO DFHEIV0
 21534     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21536     MOVE X'204E233030303139393239' TO DFHEIV0(25:11)
 21537     CALL 'kxdfhei1' USING DFHEIV0,
 21538           DFHEIV1,
 21539           ORIGINAL-CERTIFICATE,
 21540           DFHEIV11,
 21541           ELCRTO-KEY,
 21542           DFHEIV99,
 21543           DFHEIV99,
 21544           DFHEIV99
 21545     MOVE EIBRESP  TO WS-RESPONSE
 21546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21547
 21548     IF WS-RESP-NORMAL
 21549        AND (OC-CONTROL-PRIMARY (1:33) =
 21550                 PB-CONTROL-BY-ACCOUNT (1:33))
 21551        AND (OC-RECORD-TYPE =  'I')
 21552           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21553               GO TO 9991-CHECK-INDICATORS
 21554           ELSE
 21555               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21556               GO TO 9991-CRTO-ADD-REC
 21557           END-IF
 21558     END-IF.
 21559
 21560 9991-CRTO-NOT-FOUND.
 21561
 21562     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21563     MOVE 'OC'                TO OC-RECORD-ID
 21564     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21565                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 399
* EL050.cbl
 21566     MOVE +4096               TO OC-KEY-SEQ-NO.
 21567
 21568 9991-CRTO-ADD-REC.
 21569
 21570     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21571     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21572     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21573     MOVE 'I'                 TO OC-RECORD-TYPE
 21574     IF PB-ISSUE
 21575         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21576         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21577         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21578         MOVE PB-I-AGE               TO OC-INS-AGE
 21579         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21580         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21581         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21582         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21583         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21584         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21585         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21586         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21587         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21588         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21589         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21590         IF PB-I-JOINT-COMMISSION > +0
 21591             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21592         ELSE
 21593             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21594         END-IF
 21595         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21596         MOVE +0                     TO OC-LF-CANCEL-AMT
 21597                                        OC-LF-ITD-CANCEL-AMT
 21598         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21599         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21600         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21601         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21602         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21603         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21604         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21605         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21606         MOVE +0                     TO OC-AH-CANCEL-AMT
 21607                                        OC-AH-ITD-CANCEL-AMT
 21608         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21609         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21610         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21611     ELSE
 21612         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21613         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21614         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21615         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21616         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21617         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21618         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21619         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21620         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21621          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21622             MOVE SPACES             TO OC-LF-BENCD
 21623             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 400
* EL050.cbl
 21624                                        OC-LF-BEN-AMT
 21625                                        OC-LF-PRM-AMT
 21626                                        OC-LF-ALT-BEN-AMT
 21627                                        OC-LF-ALT-PRM-AMT
 21628                                        OC-LF-COMM-PCT
 21629                                        OC-LF-CANCEL-AMT
 21630             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21631             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21632         ELSE
 21633             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21634             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21635             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21636             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21637             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21638             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21639             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21640             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21641             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21642             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21643         END-IF
 21644         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21645         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21646          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21647             MOVE SPACES             TO OC-AH-BENCD
 21648             MOVE ZEROS              TO OC-AH-TERM
 21649                                        OC-AH-BEN-AMT
 21650                                        OC-AH-PRM-AMT
 21651                                        OC-AH-COMM-PCT
 21652                                        OC-AH-CANCEL-AMT
 21653                                        OC-AH-CP
 21654             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21655             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21656         ELSE
 21657             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21658             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21659             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21660             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21661             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21662             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21663             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21664             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21665             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21666         END-IF
 21667         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21668         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21669         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21670         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21671     END-IF
 21672     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21673
 21674     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21675
 21676
 21677* EXEC CICS READ
 21678*         DATASET   (FILE-ERMAIL)
 21679*         RIDFLD    (MA-CONTROL-PRIMARY)
 21680*         INTO      (MAILING-DATA)
 21681*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 401
* EL050.cbl
 21682*    END-EXEC
 21683     MOVE LENGTH OF
 21684      MAILING-DATA
 21685       TO DFHEIV11
 21686*    MOVE '&"IL       E          (  N#00020065' TO DFHEIV0
 21687     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21689     MOVE X'204E233030303230303635' TO DFHEIV0(25:11)
 21690     CALL 'kxdfhei1' USING DFHEIV0,
 21691           FILE-ERMAIL,
 21692           MAILING-DATA,
 21693           DFHEIV11,
 21694           MA-CONTROL-PRIMARY,
 21695           DFHEIV99,
 21696           DFHEIV99,
 21697           DFHEIV99
 21698     MOVE EIBRESP  TO WS-RESPONSE
 21699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21700
 21701     IF WS-RESP-NORMAL
 21702         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21703     END-IF.
 21704
 21705     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21706     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21707
 21708
 21709* EXEC CICS READ
 21710*         DATASET  (CRTT-ID)
 21711*         RIDFLD   (WS-ELCRTT-KEY)
 21712*         INTO     (CERTIFICATE-TRAILERS)
 21713*         RESP     (WS-RESPONSE)
 21714*    END-EXEC
 21715     MOVE LENGTH OF
 21716      CERTIFICATE-TRAILERS
 21717       TO DFHEIV11
 21718*    MOVE '&"IL       E          (  N#00020079' TO DFHEIV0
 21719     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21721     MOVE X'204E233030303230303739' TO DFHEIV0(25:11)
 21722     CALL 'kxdfhei1' USING DFHEIV0,
 21723           CRTT-ID,
 21724           CERTIFICATE-TRAILERS,
 21725           DFHEIV11,
 21726           WS-ELCRTT-KEY,
 21727           DFHEIV99,
 21728           DFHEIV99,
 21729           DFHEIV99
 21730     MOVE EIBRESP  TO WS-RESPONSE
 21731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21732
 21733     IF WS-RESP-NORMAL
 21734         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21735         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21736     END-IF.
 21737
 21738
 21739* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 402
* EL050.cbl
 21740*       DATASET   ('ELCRTO')
 21741*       FROM      (ORIGINAL-CERTIFICATE)
 21742*       RIDFLD    (OC-CONTROL-PRIMARY)
 21743*       RESP      (WS-RESPONSE)
 21744*    END-EXEC.
 21745     MOVE LENGTH OF
 21746      ORIGINAL-CERTIFICATE
 21747       TO DFHEIV11
 21748     MOVE 'ELCRTO' TO DFHEIV1
 21749*    MOVE '&$ L                  ''  N#00020091' TO DFHEIV0
 21750     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21752     MOVE X'204E233030303230303931' TO DFHEIV0(25:11)
 21753     CALL 'kxdfhei1' USING DFHEIV0,
 21754           DFHEIV1,
 21755           ORIGINAL-CERTIFICATE,
 21756           DFHEIV11,
 21757           OC-CONTROL-PRIMARY,
 21758           DFHEIV99,
 21759           DFHEIV99
 21760     MOVE EIBRESP  TO WS-RESPONSE
 21761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21762
 21763
 21764     GO TO 9991-EXIT.
 21765
 21766 9991-CHECK-INDICATORS.
 21767
 21768     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21769         GO TO 9991-EXIT
 21770     END-IF.
 21771
 21772     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21773         GO TO 9991-EXIT
 21774     END-IF.
 21775
 21776
 21777* EXEC CICS READ
 21778*       DATASET   ('ELCRTO')
 21779*       INTO      (ORIGINAL-CERTIFICATE)
 21780*       RIDFLD    (OC-CONTROL-PRIMARY)
 21781*       UPDATE
 21782*       RESP      (WS-RESPONSE)
 21783*    END-EXEC
 21784     MOVE LENGTH OF
 21785      ORIGINAL-CERTIFICATE
 21786       TO DFHEIV11
 21787     MOVE 'ELCRTO' TO DFHEIV1
 21788*    MOVE '&"IL       EU         (  N#00020110' TO DFHEIV0
 21789     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21790     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21791     MOVE X'204E233030303230313130' TO DFHEIV0(25:11)
 21792     CALL 'kxdfhei1' USING DFHEIV0,
 21793           DFHEIV1,
 21794           ORIGINAL-CERTIFICATE,
 21795           DFHEIV11,
 21796           OC-CONTROL-PRIMARY,
 21797           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 403
* EL050.cbl
 21798           DFHEIV99,
 21799           DFHEIV99
 21800     MOVE EIBRESP  TO WS-RESPONSE
 21801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21802     IF WS-RESP-NORMAL
 21803        IF PB-ISSUE
 21804          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21805          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21806          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21807          MOVE PB-I-AGE               TO OC-INS-AGE
 21808          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21809          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21810          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21811          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21812          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21813          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21814          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21815          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21816          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21817          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21818          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21819          IF PB-I-JOINT-COMMISSION > +0
 21820              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21821          ELSE
 21822              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21823          END-IF
 21824          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21825          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21826          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21827          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21828          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21829          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21830          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21831          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21832          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21833
 21834          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21835
 21836* EXEC CICS READ
 21837*             DATASET   (FILE-ERMAIL)
 21838*             RIDFLD    (MA-CONTROL-PRIMARY)
 21839*             INTO      (MAILING-DATA)
 21840*             RESP      (WS-RESPONSE)
 21841*         END-EXEC
 21842     MOVE LENGTH OF
 21843      MAILING-DATA
 21844       TO DFHEIV11
 21845*    MOVE '&"IL       E          (  N#00020150' TO DFHEIV0
 21846     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21848     MOVE X'204E233030303230313530' TO DFHEIV0(25:11)
 21849     CALL 'kxdfhei1' USING DFHEIV0,
 21850           FILE-ERMAIL,
 21851           MAILING-DATA,
 21852           DFHEIV11,
 21853           MA-CONTROL-PRIMARY,
 21854           DFHEIV99,
 21855           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 404
* EL050.cbl
 21856           DFHEIV99
 21857     MOVE EIBRESP  TO WS-RESPONSE
 21858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21859          IF WS-RESP-NORMAL
 21860             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21861          END-IF
 21862
 21863          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21864          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21865
 21866* EXEC CICS READ
 21867*             DATASET  (CRTT-ID)
 21868*             RIDFLD   (WS-ELCRTT-KEY)
 21869*             INTO     (CERTIFICATE-TRAILERS)
 21870*             RESP     (WS-RESPONSE)
 21871*         END-EXEC
 21872     MOVE LENGTH OF
 21873      CERTIFICATE-TRAILERS
 21874       TO DFHEIV11
 21875*    MOVE '&"IL       E          (  N#00020162' TO DFHEIV0
 21876     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21878     MOVE X'204E233030303230313632' TO DFHEIV0(25:11)
 21879     CALL 'kxdfhei1' USING DFHEIV0,
 21880           CRTT-ID,
 21881           CERTIFICATE-TRAILERS,
 21882           DFHEIV11,
 21883           WS-ELCRTT-KEY,
 21884           DFHEIV99,
 21885           DFHEIV99,
 21886           DFHEIV99
 21887     MOVE EIBRESP  TO WS-RESPONSE
 21888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21889          IF WS-RESP-NORMAL
 21890             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21891                               OC-INS-AGE-DEFAULT-FLAG
 21892             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21893                               OC-JNT-AGE-DEFAULT-FLAG
 21894          END-IF
 21895
 21896        ELSE
 21897          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21898             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21899             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21900             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21901          END-IF
 21902          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21903             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21904             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21905             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21906          END-IF
 21907          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21908        END-IF
 21909
 21910* EXEC CICS REWRITE
 21911*          DATASET   ('ELCRTO')
 21912*          FROM      (ORIGINAL-CERTIFICATE)
 21913*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 405
* EL050.cbl
 21914*       END-EXEC
 21915     MOVE LENGTH OF
 21916      ORIGINAL-CERTIFICATE
 21917       TO DFHEIV11
 21918     MOVE 'ELCRTO' TO DFHEIV1
 21919*    MOVE '&& L                  %  N#00020188' TO DFHEIV0
 21920     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21921     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21922     MOVE X'204E233030303230313838' TO DFHEIV0(25:11)
 21923     CALL 'kxdfhei1' USING DFHEIV0,
 21924           DFHEIV1,
 21925           ORIGINAL-CERTIFICATE,
 21926           DFHEIV11,
 21927           DFHEIV99
 21928     MOVE EIBRESP  TO WS-RESPONSE
 21929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21930     END-IF.
 21931
 21932 9991-EXIT.
 21933     EXIT.
 21934
 21935
 21936 9999-RETURN.
 21937     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21938
 21939
 21940* EXEC CICS RETURN
 21941*    END-EXEC.
 21942*    MOVE '.(                    ''   #00020202' TO DFHEIV0
 21943     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21945     MOVE X'2020233030303230323032' TO DFHEIV0(25:11)
 21946     CALL 'kxdfhei1' USING DFHEIV0,
 21947           DFHEIV99,
 21948           DFHEIV99,
 21949           DFHEIV99,
 21950           DFHEIV99,
 21951           DFHEIV99,
 21952           DFHEIV99
 21953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21954
 21955
 21956
 21957* GOBACK.
 21958     MOVE '9%                    "   ' TO DFHEIV0
 21959     MOVE 'EL050' TO DFHEIV1
 21960     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21961     GOBACK.
 21962
 21963 9999-DFHBACK SECTION.
 21964     MOVE '9%                    "   ' TO DFHEIV0
 21965     MOVE 'EL050' TO DFHEIV1
 21966     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21967     GOBACK.
 21968 9999-DFHEXIT.
 21969     IF DFHEIGDJ EQUAL 0001
 21970         NEXT SENTENCE
 21971     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 406
* EL050.cbl
 21972         GO TO 9300-ABEND,
 21973               3990-FILES-NOT-OPEN
 21974         DEPENDING ON DFHEIGDI
 21975     ELSE IF DFHEIGDJ EQUAL 3
 21976         GO TO 6610-START-BROWSE,
 21977               6630-ERRESS-PROBLEM,
 21978               6630-END-OF-FILE
 21979         DEPENDING ON DFHEIGDI
 21980     ELSE IF DFHEIGDJ EQUAL 4
 21981         GO TO 6630-END-OF-FILE,
 21982               6630-ERRESS-PROBLEM,
 21983               6630-ERRESS-PROBLEM,
 21984               6630-END-OF-FILE
 21985         DEPENDING ON DFHEIGDI
 21986     ELSE IF DFHEIGDJ EQUAL 5
 21987         GO TO 6630-END-OF-FILE,
 21988               6630-END-OF-FILE,
 21989               6630-ERRESS-PROBLEM,
 21990               6630-ERRESS-PROBLEM
 21991         DEPENDING ON DFHEIGDI
 21992     ELSE IF DFHEIGDJ EQUAL 6
 21993         GO TO 6660-START-BROWSE,
 21994               6690-ERRESC-PROBLEM,
 21995               6690-ERRESC-PROBLEM,
 21996               6690-END-OF-FILE
 21997         DEPENDING ON DFHEIGDI
 21998     ELSE IF DFHEIGDJ EQUAL 7
 21999         GO TO 6690-END-OF-FILE,
 22000               6690-ERRESC-PROBLEM,
 22001               6690-ERRESC-PROBLEM,
 22002               6690-END-OF-FILE
 22003         DEPENDING ON DFHEIGDI
 22004     ELSE IF DFHEIGDJ EQUAL 8
 22005         GO TO 6690-END-OF-FILE,
 22006               6690-ERRESC-PROBLEM,
 22007               6690-ERRESC-PROBLEM,
 22008               6690-END-OF-FILE
 22009         DEPENDING ON DFHEIGDI
 22010     ELSE IF DFHEIGDJ EQUAL 9
 22011         GO TO 7250-CONTINUE,
 22012               7250-CONTINUE
 22013         DEPENDING ON DFHEIGDI
 22014     ELSE IF DFHEIGDJ EQUAL 10
 22015         GO TO 7300-CONTINUE,
 22016               7300-CONTINUE
 22017         DEPENDING ON DFHEIGDI
 22018     ELSE IF DFHEIGDJ EQUAL 11
 22019         GO TO 8000-FREE-MAIN
 22020         DEPENDING ON DFHEIGDI
 22021     ELSE IF DFHEIGDJ EQUAL 12
 22022         GO TO 8100-NOTFND,
 22023               8100-NOTFND
 22024         DEPENDING ON DFHEIGDI
 22025     ELSE IF DFHEIGDJ EQUAL 13
 22026         GO TO 8110-NOTFND,
 22027               8110-NOTFND
 22028         DEPENDING ON DFHEIGDI
 22029     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 407
* EL050.cbl
 22030         GO TO 8130-EXIT
 22031         DEPENDING ON DFHEIGDI
 22032     ELSE IF DFHEIGDJ EQUAL 15
 22033         GO TO 8150-exit
 22034         DEPENDING ON DFHEIGDI
 22035     ELSE IF DFHEIGDJ EQUAL 16
 22036         GO TO 8180-NOTFND
 22037         DEPENDING ON DFHEIGDI
 22038     ELSE IF DFHEIGDJ EQUAL 17
 22039         GO TO 8190-NOTFND
 22040         DEPENDING ON DFHEIGDI
 22041     ELSE IF DFHEIGDJ EQUAL 18
 22042         GO TO 8195-NOTFND
 22043         DEPENDING ON DFHEIGDI
 22044     ELSE IF DFHEIGDJ EQUAL 19
 22045         GO TO 8200-NOTFND
 22046         DEPENDING ON DFHEIGDI
 22047     ELSE IF DFHEIGDJ EQUAL 20
 22048         GO TO 8300-NOTFND,
 22049               8300-ERRESS-PROBLEM,
 22050               8300-ERRESS-PROBLEM,
 22051               8300-NOTFND
 22052         DEPENDING ON DFHEIGDI
 22053     ELSE IF DFHEIGDJ EQUAL 21
 22054         GO TO 8450-FORM-NOT-FOUND,
 22055               8450-FORM-NOT-FOUND
 22056         DEPENDING ON DFHEIGDI
 22057     ELSE IF DFHEIGDJ EQUAL 22
 22058         GO TO 0199-ACCT-NOT-FOUND,
 22059               0199-ACCT-NOT-FOUND
 22060         DEPENDING ON DFHEIGDI
 22061     ELSE IF DFHEIGDJ EQUAL 23
 22062         GO TO 0199-ACCT-NOT-FOUND,
 22063               0199-ACCT-NOT-FOUND
 22064         DEPENDING ON DFHEIGDI
 22065     ELSE IF DFHEIGDJ EQUAL 24
 22066         GO TO 8582-COMP-NOT-FOUND,
 22067               8582-COMP-NOT-FOUND
 22068         DEPENDING ON DFHEIGDI
 22069     ELSE IF DFHEIGDJ EQUAL 25
 22070         GO TO 8583-AGTC-NOT-FOUND,
 22071               8583-AGTC-NOT-FOUND
 22072         DEPENDING ON DFHEIGDI
 22073     ELSE IF DFHEIGDJ EQUAL 26
 22074         GO TO 8584-BXRF-NOT-FOUND,
 22075               8584-BXRF-NOT-FOUND
 22076         DEPENDING ON DFHEIGDI
 22077     ELSE IF DFHEIGDJ EQUAL 27
 22078         GO TO 8585-PLAN-NOT-FOUND,
 22079               8585-PLAN-NOT-FOUND
 22080         DEPENDING ON DFHEIGDI
 22081     ELSE IF DFHEIGDJ EQUAL 28
 22082         GO TO 0299-CERT-NOT-FOUND
 22083         DEPENDING ON DFHEIGDI
 22084     ELSE IF DFHEIGDJ EQUAL 29
 22085         GO TO 8700-READ-CERT-MASTER
 22086         DEPENDING ON DFHEIGDI
 22087     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 05-Mar-15 13:22 Page 408
* EL050.cbl
 22088         GO TO 8720-COMP-ACCOUNTS,
 22089               8730-END-BROWSE,
 22090               8740-NOT-FOUND
 22091         DEPENDING ON DFHEIGDI
 22092     ELSE IF DFHEIGDJ EQUAL 31
 22093         GO TO 9000-NOTFND
 22094         DEPENDING ON DFHEIGDI
 22095     ELSE IF DFHEIGDJ EQUAL 32
 22096         GO TO 9100-NOTFND,
 22097               9100-NOTFND
 22098         DEPENDING ON DFHEIGDI
 22099     ELSE IF DFHEIGDJ EQUAL 33
 22100         GO TO 9991-CRTO-NOT-FOUND,
 22101               9991-CRTO-NOT-FOUND
 22102         DEPENDING ON DFHEIGDI.
 22103     MOVE '9%                    "   ' TO DFHEIV0
 22104     MOVE 'EL050' TO DFHEIV1
 22105     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22106     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40040     Code:       89162
