* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42******************************************************************
    43
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   3
* EL130.cbl
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    52 77  A1                          PIC S999 COMP-3 VALUE +0.
    53 77  E1                          PIC S999 COMP-3 VALUE +0.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  P1                          PIC S999 COMP-3 VALUE +0.
    57 77  P2                          PIC S999 COMP-3 VALUE +0.
    58 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    59 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    60 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    61 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    62 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    63 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    64 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    65 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    66     88  ERPDEF-FOUND                 VALUE 'Y'.
    67 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    68 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    69 77  ws-dcc-product-code         pic xxx value spaces.
    70 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    71 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    72 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    73 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    74 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    75 77  ws-zero-bens-avail          pic x value ' '.
    76*    COPY ELCSCTM.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCTM                             *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-MESSAGE.
    87     12  FILLER                          PIC X(30)
    88            VALUE '** LOGIC SECURITY VIOLATION -'.
    89     12  SM-READ                         PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' PGM='.
    92     12  SM-PGM                          PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' OPR='.
    95     12  SM-PROCESSOR-ID                 PIC X(4).
    96     12  FILLER                          PIC X(6)
    97            VALUE ' TERM='.
    98     12  SM-TERMID                       PIC X(4).
    99     12  FILLER                          PIC XX   VALUE SPACE.
   100     12  SM-JUL-DATE                     PIC 9(5).
   101     12  FILLER                          PIC X    VALUE SPACE.
   102     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   4
* EL130.cbl
   103
   104
   105*    COPY ELCSCRTY.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCRTY                            *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   113*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   114*        SAVED IN PI-SECURITY-ADDRESS.                           *
   115*                                                                *
   116******************************************************************
   117 01  SECURITY-CONTROL.
   118     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   119     12  FILLER                       PIC XX    VALUE 'SC'.
   120     12  SC-CREDIT-CODES.
   121         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   122             20  SC-CREDIT-DISPLAY    PIC X.
   123             20  SC-CREDIT-UPDATE     PIC X.
   124     12  SC-CLAIMS-CODES.
   125         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   126             20  SC-CLAIMS-DISPLAY    PIC X.
   127             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   5
* EL130.cbl
   129 01  WS-DATE-AREA.
   130     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   131     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   132     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   133
   134 01  ws-dcc-error-line.
   135     05  filler occurs 15.
   136         10  ws-error-no        pic x(4).
   137 01  WS-CRI-SSN-WORK-AREA.
   138     05  WS-CRI-SOC-SEC-NO.
   139         10  WS-SS-REPT-CD       PIC X(5).
   140         10  WS-SS-LAST-NAME     PIC X(5).
   141         10  WS-SS-INITIAL       PIC X.
   142
   143     05  WS-CRI-REPORT-CODE.
   144         10  FILLER              PIC X(5).
   145         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   146
   147     05  WS-CRI-LAST-NAME.
   148         10  WS-CRI-NAME-MOVE    PIC X(5).
   149         10  FILLER              PIC X(10).
   150
   151 01  STANDARD-AREAS.
   152     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   153     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   154     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   155     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   156     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   157     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   158     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   159     12  PGM-NAME            PIC X(8).
   160     12  TIME-IN             PIC S9(7).
   161     12  TIME-OUT-R  REDEFINES TIME-IN.
   162         16  FILLER          PIC X.
   163         16  TIME-OUT        PIC 99V99.
   164         16  FILLER          PIC X(2).
   165     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   166     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   167     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   168     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   169     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   170     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   171     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   172     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   173     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   174     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   175     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   176     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   177     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   178     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   179     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   180     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   181     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   182     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   183     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   184     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   185     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   186     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   6
* EL130.cbl
   187     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   188     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   189     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   190     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   191     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   192     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   193     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   194     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   195     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   196     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   197     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   198     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   199     12  FILE-ID             PIC X(8).
   200     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   201     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   202     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   203     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   204     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   205     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   206     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   207     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   208     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   209
   210 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   211     12  M                   PIC S9(7)V99           VALUE ZEROS.
   212     12  L                   PIC S9(7)V99           VALUE ZEROS.
   213     12  N                   PIC S9(3)              VALUE ZEROS.
   214     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   215     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   216     12  I                   PIC S99V9(5)           VALUE ZEROS.
   217     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   218     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   219     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   220     12  R                   PIC S9(3)              VALUE ZEROS.
   221     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   222     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   223     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   224     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   225     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   226     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   227     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   228     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   229     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   230
   231 01  TERM-CALC-WORK-AREA.
   232     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   233     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   234     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   235     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   236     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   237     12  V-EXPONENTS.
   238        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   239     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   240
   241 01  MISC-WORK-AREAS.
   242     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   243     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   244     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   7
* EL130.cbl
   245     12  QID.
   246         16  QID-TERM        PIC X(4).
   247         16  FILLER          PIC X(4)    VALUE '130A'.
   248     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   249     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   250     12  WS-GROUP-NO.
   251         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   252         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   253
   254     12  WS-RESPONSE         PIC S9(8)   COMP.
   255         88  WS-RESP-NORMAL              VALUE +00.
   256         88  WS-RESP-ERROR               VALUE +01.
   257         88  WS-RESP-NOTFND              VALUE +13.
   258         88  WS-RESP-DUPKEY              VALUE +15.
   259         88  WS-RESP-NOTOPEN             VALUE +19.
   260         88  WS-RESP-ENDFILE             VALUE +20.
   261
   262***************************************************************
   263*                                                             *
   264*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   265*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   266*    CHANGES WITH IN MAP EL130A.                              *
   267*                                                             *
   268***************************************************************
   269
   270     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   271     12  WS-SAVE-CLAIM-MASTER.
   272         16  FILLER                    PIC XX.
   273         16  WS-SAVE-CLAIM-KEY.
   274             20  WS-SAVE-COMPANY-CD    PIC X.
   275             20  WS-SAVE-CARRIER       PIC X.
   276             20  WS-SAVE-CLAIM-NO      PIC X(7).
   277             20  WS-SAVE-CERT-NO       PIC X(11).
   278         16  FILLER                    PIC X(328).
   279     12  SAVE-CURRENT-DATE         PIC XX.
   280     12  SAVE-CONTROL              PIC X(39).
   281     12  SAVE-ERACCT-KEY           PIC X(26).
   282     12  SAVE-COUNTER              PIC S9(8)   COMP.
   283     12  SAVE-METHOD               PIC X.
   284     12  SAVE-COMPANY-ID           PIC XXX.
   285     12  SAVE-COMPANY-CD           PIC X.
   286     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   287     12  SAVE-CREDIT-USER          PIC X.
   288     12  SAVE-CLAIM-USER           PIC X.
   289     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   290     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   291     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   292     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   293     12  SAVE-AH-OVERRIDE-L1       PIC X.
   294     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   295     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   296     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   297     12  FILLER                    PIC X.
   298*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   299     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   300     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   301     12  SAVE-EL127-TO-EL130-CNTRL.
   302         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   8
* EL130.cbl
   303         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   304         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   305             20  SAVE-EL127-CARRIER  PIC X.
   306             20  SAVE-EL127-GROUPING PIC X(6).
   307             20  SAVE-EL127-STATE    PIC X(2).
   308             20  SAVE-EL127-ACCOUNT  PIC X(10).
   309             20  SAVE-EL127-CERT-NO  PIC X(11).
   310             20  SAVE-EL127-EFF-DT   PIC XX.
   311     12  SAVE-EL659-TO-EL130-CNTRL.
   312         16  SAVE-EL659-CARRIER    PIC X.
   313         16  SAVE-EL659-GROUPING   PIC X(6).
   314         16  SAVE-EL659-STATE      PIC XX.
   315         16  SAVE-EL659-ACCOUNT    PIC X(10).
   316     12  DIVIDE-QUOT               PIC 999.
   317     12  DIVIDE-REM                PIC 999.
   318     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   319     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   320     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   321     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   322     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   323     12  WS-RESERVE-CONTROLS       PIC X(9).
   324     12  WS-EXPENSE-CONTROLS       PIC X(7).
   325     12  WS-REIN-TABLE.
   326         16  WS-REIN-1             PIC X            VALUE SPACE.
   327         16  WS-REIN-2             PIC X            VALUE SPACE.
   328         16  WS-REIN-3             PIC X            VALUE SPACE.
   329     12  WS-BENE-CALC-METHOD       PIC X.
   330     12  ws-lf-joint-indicator     pic x.
   331     12  ws-ah-joint-indicator     pic x.
   332     12  WS-EARNINGS-CALC          PIC X.
   333     12  WS-LF-EARNINGS-CALC       PIC X.
   334         88 TEX-REG                VALUE '4'.
   335         88 NET-PAY                VALUE '5'.
   336     12  WS-AH-EARNINGS-CALC       PIC X.
   337     12  WS-SPECIAL-CALC-CD        PIC X(01).
   338     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   339     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   340     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   341     12  WS-ICD-CODE-1             PIC X(8).
   342     12  WS-ICD-CODE-2             PIC X(8).
   343     12  WS-CLAIM-NUMBER.
   344         16  WS-CN-PREFIX.
   345             20  WS-CN-PRF-A PIC X.
   346             20  WS-CN-PRF-B PIC X.
   347         16  WS-CN-NUMBER    PIC 9(5).
   348     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   349     12  WS-CLAIM-SEQU.
   350         16  FILLER          PIC X    VALUE '('.
   351         16  WS-CURRENT-SEQU PIC Z9.
   352         16  FILLER          PIC X(4) VALUE ' OF '.
   353         16  WS-OF-SEQU      PIC Z9.
   354         16  FILLER          PIC X    VALUE ')'.
   355     12  DATE-WORK.
   356       14  FILLER                PIC XX.
   357       14  DATE-MM               PIC XX.
   358       14  DATE-DD               PIC XX.
   359       14  DATE-YY               PIC XX.
   360     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   9
* EL130.cbl
   361         16  CURR-MM.
   362           18  CURR-M1           PIC 9.
   363           18  CURR-M2           PIC 9.
   364         16  FILLER              PIC X(5).
   365         16  CURR-YEAR           PIC 9.
   366     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   367     12  SUB                     PIC 99.
   368     12  MY-DATE.
   369         16  MY-MM               PIC XX.
   370         16  FILLER              PIC X VALUE '/'.
   371         16  MY-YY               PIC XX.
   372
   373     12  WS-EDIT-BEN-CODE        PIC XX.
   374         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   375                                          '90' THRU '99'.
   376
   377     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   378     12  WS-BEN-HOLD             PIC XX.
   379     12  WS-BEN-ALPHA-HOLD.
   380         15  WS-BEN-ALPHA-2      PIC XX.
   381         15  WS-BEN-ALPHA-1      PIC X.
   382     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   383     12  WS-REC-TYPE             PIC X.
   384     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   385     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   386     12  ARCH-NUMBER             PIC S9(8)   COMP.
   387     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   388         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   389         88  REIN-REC-FOUND                  VALUE 'Y'.
   390
   391     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   392     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   393
   394
   395 01  CSO-WORK-FIELDS.
   396     12  WS-BLANK            PIC X       VALUE ' '.
   397
   398     12  WS-MA-CONTROL-PRIMARY.
   399         16  WS-MA-COMPANY-CD        PIC  X.
   400         16  WS-MA-CARRIER           PIC  X.
   401         16  WS-MA-GROUPING          PIC  X(6).
   402         16  WS-MA-STATE             PIC  XX.
   403         16  WS-MA-ACCOUNT           PIC  X(10).
   404         16  WS-MA-CERT-EFF-DT       PIC  XX.
   405         16  WS-MA-CERT-NO.
   406             20  WS-MA-CERT-PRIME    PIC  X(10).
   407             20  WS-MA-CERT-SFX      PIC  X.
   408
   409     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   410     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   411     12  WS-SOC-SEC-NUMBER.
   412         16  WS-SOC-SEC-NO       PIC 9(9).
   413         16  WS-SOC-SEC-BLANK    PIC X(2).
   414     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   415         16  WS-SSN-1-3          PIC 9(3).
   416         16  WS-SSN-DASH1        PIC X(1).
   417         16  WS-SSN-4-5          PIC 9(2).
   418         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  10
* EL130.cbl
   419         16  WS-SSN-6-9          PIC 9(4).
   420
   421     12  WS-DIAG-VIN-MSG.
   422         16  FILLER          PIC X(11)
   423             VALUE 'VIN NUMBER '.
   424         16  WS-DIAG-VIN     PIC X(17).
   425
   426     12  WS-VERIFY-NOTE      PIC X(34)
   427         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   428
   429     12  WS-CAUSAL-NOTE      PIC X(40)
   430         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   431
   432     12  WS-VFY-SSN-NOTE     PIC X(25)
   433         VALUE 'SSN VERIFICATION REQUIRED'.
   434
   435 01  MAP-DATE-AREAS.
   436     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   437     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   438     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   439     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   440     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   441     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   442     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   443     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   444     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   445     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   446     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   447     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   448     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   449     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   450     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   451     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   452     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   453     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   454     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   455         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   456     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   457     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   458     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   459     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   460
   461 01  ACCESS-KEYS.
   462     12  ELACTQ-KEY.
   463         16  ELACTQ-COMPANY-CD       PIC X.
   464         16  ELACTQ-CARRIER          PIC X.
   465         16  ELACTQ-CLAIM-NO         PIC X(7).
   466         16  ELACTQ-CERT-NO          PIC X(11).
   467     12  ELMSTR-KEY.
   468         16  MSTR-COMP-CD            PIC X.
   469         16  MSTR-CARRIER            PIC X.
   470         16  MSTR-CLAIM-NO           PIC X(7).
   471         16  MSTR-CERT-NO.
   472             20  MSTR-CERT-NO-PRIME  PIC X(10).
   473             20  MSTR-CERT-NO-SUFX   PIC X.
   474     12  SAVE-ELMSTR-KEY.
   475         16  SAVE-COMP-CD            PIC X.
   476         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  11
* EL130.cbl
   477         16  SAVE-CLAIM-NO           PIC X(7).
   478         16  SAVE-CERT-NO.
   479             20  SAVE-CERT-NO-PRIME  PIC X(10).
   480             20  SAVE-CERT-NO-SUFX   PIC X.
   481     12  ELMSTR5-KEY.
   482         16  MSTR5-COMP-CD           PIC X.
   483         16  MSTR5-CERT-NO.
   484             20  MSTR5-CERT-NO-PRIME PIC X(10).
   485             20  MSTR5-CERT-NO-SUFX  PIC X.
   486     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   487         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   488         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   489         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   490     12  ELCNTL-KEY.
   491         16  CNTL-COMP-ID    PIC X(3).
   492         16  CNTL-REC-TYPE   PIC X.
   493         16  CNTL-ACCESS.
   494             20  FILLER      PIC XX.
   495             20  CNTL-BENEFIT.
   496                 24  FILLER  PIC X.
   497                 24  CNTL-CARRIER PIC X.
   498         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   499     12  ELCERT-KEY.
   500         16  CERT-COMP-CD    PIC X.
   501         16  CERT-CARRIER    PIC X.
   502         16  CERT-GROUPING   PIC X(6).
   503         16  CERT-STATE      PIC X(2).
   504         16  CERT-ACCOUNT.
   505             20  CERT-ACCOUNT-PREFIX PIC X(4).
   506             20  CERT-ACCOUNT-PRIME  PIC X(6).
   507         16  CERT-EFF-DT     PIC XX.
   508         16  CERT-CERT-NO.
   509             20  CERT-CERT-NO-PRIME  PIC X(10).
   510             20  CERT-CERT-NO-SUFX   PIC X.
   511     12  ELCERT-KEY-5.
   512         16  CERT-COMP-CD-5      PIC X.
   513         16  CERT-CERT-5.
   514             20  CERT-CERT-5-PRIME   PIC X(10).
   515             20  CERT-CERT-5-SUFX    PIC X.
   516     12  ERACCT-KEY.
   517         16  ACCT-COMP-CD    PIC X.
   518         16  ACCT-CARRIER    PIC X.
   519         16  ACCT-GROUPING   PIC X(6).
   520         16  ACCT-STATE      PIC X(2).
   521         16  ACCT-ACCOUNT    PIC X(10).
   522         16  ACCT-EXP-DT     PIC XX.
   523     12  ELTRLR-KEY.
   524         16  TRLR-COMP-CD    PIC X.
   525         16  TRLR-CARRIER    PIC X.
   526         16  TRLR-CLAIM-NO   PIC X(7).
   527         16  TRLR-CERT-NO.
   528             20  TRLR-CERT-NO-PRIME  PIC X(10).
   529             20  TRLR-CERT-NO-SUFX   PIC X.
   530         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   531         16  TRLR-TYPE       PIC X.
   532     12  ELBENE-KEY.
   533         16  BENE-COMP-CD    PIC X.
   534         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  12
* EL130.cbl
   535         16  BENE-CODE       PIC X(10).
   536     12  ERREIN-KEY.
   537         16  REIN-COMP-CD        PIC X(01).
   538         16  REIN-TYPE           PIC X(01).
   539         16  REIN-TABLE-CO.
   540             20  REIN-CODE-1     PIC X(01).
   541             20  REIN-CODE-2     PIC X(01).
   542             20  REIN-CODE-3     PIC X(01).
   543         16  FILLER              PIC X(03).
   544     12  ELCRTT-KEY.
   545         16  CTRLR-COMP-CD       PIC X.
   546         16  CTRLR-CARRIER       PIC X.
   547         16  CTRLR-GROUPING      PIC X(6).
   548         16  CTRLR-STATE         PIC X(2).
   549         16  CTRLR-ACCOUNT       PIC X(10).
   550         16  CTRLR-EFF-DT        PIC XX.
   551         16  CTRLR-CERT-NO       PIC X(11).
   552         16  CTRLR-REC-TYPE      PIC X.
   553 01  ws-acct-found-sw            pic x value ' '.
   554     88  acct-found                value 'Y'.
   555 01  ERPDEF-KEY-SAVE             PIC X(18).
   556 01  ERPDEF-KEY.
   557     12  ERPDEF-COMPANY-CD       PIC X.
   558     12  ERPDEF-STATE            PIC XX.
   559     12  ERPDEF-PROD-CD          PIC XXX.
   560     12  F                       PIC X(7).
   561     12  ERPDEF-BEN-TYPE         PIC X.
   562     12  ERPDEF-BEN-CODE         PIC XX.
   563     12  ERPDEF-EXP-DT           PIC XX.
   564 01  ERROR-MESSAGES.
   565     12  ER-0000                 PIC X(4)  VALUE '0000'.
   566     12  ER-0004                 PIC X(4)  VALUE '0004'.
   567     12  ER-0019                 PIC X(4)  VALUE '0019'.
   568     12  ER-0023                 PIC X(4)  VALUE '0023'.
   569     12  ER-0029                 PIC X(4)  VALUE '0029'.
   570     12  ER-0033                 PIC X(4)  VALUE '0033'.
   571     12  ER-0068                 PIC X(4)  VALUE '0068'.
   572     12  ER-0070                 PIC X(4)  VALUE '0070'.
   573     12  ER-0194                 PIC X(4)  VALUE '0194'.
   574     12  ER-0202                 PIC X(4)  VALUE '0202'.
   575     12  ER-0203                 PIC X(4)  VALUE '0203'.
   576     12  ER-0204                 PIC X(4)  VALUE '0204'.
   577     12  ER-0205                 PIC X(4)  VALUE '0205'.
   578     12  ER-0206                 PIC X(4)  VALUE '0206'.
   579     12  ER-0207                 PIC X(4)  VALUE '0207'.
   580     12  ER-0213                 PIC X(4)  VALUE '0213'.
   581     12  ER-0214                 PIC X(4)  VALUE '0214'.
   582     12  ER-0217                 PIC X(4)  VALUE '0217'.
   583     12  ER-0219                 PIC X(4)  VALUE '0219'.
   584     12  ER-0220                 PIC X(4)  VALUE '0220'.
   585     12  ER-0221                 PIC X(4)  VALUE '0221'.
   586     12  ER-0222                 PIC X(4)  VALUE '0222'.
   587     12  ER-0223                 PIC X(4)  VALUE '0223'.
   588     12  ER-0224                 PIC X(4)  VALUE '0224'.
   589     12  ER-0225                 PIC X(4)  VALUE '0225'.
   590     12  ER-0226                 PIC X(4)  VALUE '0226'.
   591     12  ER-0227                 PIC X(4)  VALUE '0227'.
   592     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  13
* EL130.cbl
   593     12  ER-0230                 PIC X(4)  VALUE '0230'.
   594     12  ER-0231                 PIC X(4)  VALUE '0231'.
   595     12  ER-0232                 PIC X(4)  VALUE '0232'.
   596     12  ER-0233                 PIC X(4)  VALUE '0233'.
   597     12  ER-0234                 PIC X(4)  VALUE '0234'.
   598     12  ER-0235                 PIC X(4)  VALUE '0235'.
   599     12  ER-0236                 PIC X(4)  VALUE '0236'.
   600     12  ER-0237                 PIC X(4)  VALUE '0237'.
   601     12  ER-0238                 PIC X(4)  VALUE '0238'.
   602     12  ER-0239                 PIC X(4)  VALUE '0239'.
   603     12  ER-0240                 PIC X(4)  VALUE '0240'.
   604     12  ER-0241                 PIC X(4)  VALUE '0241'.
   605     12  ER-0243                 PIC X(4)  VALUE '0243'.
   606     12  ER-0244                 PIC X(4)  VALUE '0244'.
   607     12  ER-0245                 PIC X(4)  VALUE '0245'.
   608     12  ER-0246                 PIC X(4)  VALUE '0246'.
   609     12  ER-0247                 PIC X(4)  VALUE '0247'.
   610     12  ER-0248                 PIC X(4)  VALUE '0248'.
   611     12  ER-0250                 PIC X(4)  VALUE '0250'.
   612     12  ER-0251                 PIC X(4)  VALUE '0251'.
   613     12  ER-0252                 PIC X(4)  VALUE '0252'.
   614     12  ER-0253                 PIC X(4)  VALUE '0253'.
   615     12  ER-0254                 PIC X(4)  VALUE '0254'.
   616     12  ER-0257                 PIC X(4)  VALUE '0257'.
   617     12  ER-0258                 PIC X(4)  VALUE '0258'.
   618     12  ER-0260                 PIC X(4)  VALUE '0260'.
   619     12  ER-0261                 PIC X(4)  VALUE '0261'.
   620     12  ER-0263                 PIC X(4)  VALUE '0263'.
   621     12  ER-0264                 PIC X(4)  VALUE '0264'.
   622     12  ER-0265                 PIC X(4)  VALUE '0265'.
   623     12  ER-0266                 PIC X(4)  VALUE '0266'.
   624     12  ER-0267                 PIC X(4)  VALUE '0267'.
   625     12  ER-0334                 PIC X(4)  VALUE '0334'.
   626     12  ER-0337                 PIC X(4)  VALUE '0337'.
   627     12  ER-0412                 PIC X(4)  VALUE '0412'.
   628     12  ER-0413                 PIC X(4)  VALUE '0413'.
   629     12  ER-0428                 PIC X(4)  VALUE '0428'.
   630     12  ER-0429                 PIC X(4)  VALUE '0429'.
   631     12  ER-0430                 PIC X(4)  VALUE '0430'.
   632     12  ER-0433                 PIC X(4)  VALUE '0433'.
   633     12  ER-0434                 PIC X(4)  VALUE '0434'.
   634     12  ER-0458                 PIC X(4)  VALUE '0458'.
   635     12  ER-0489                 PIC X(4)  VALUE '0489'.
   636     12  ER-0509                 PIC X(4)  VALUE '0509'.
   637     12  ER-0510                 PIC X(4)  VALUE '0510'.
   638     12  ER-0511                 PIC X(4)  VALUE '0511'.
   639     12  ER-0512                 PIC X(4)  VALUE '0512'.
   640     12  ER-0516                 PIC X(4)  VALUE '0516'.
   641     12  ER-0517                 PIC X(4)  VALUE '0517'.
   642     12  ER-0518                 PIC X(4)  VALUE '0518'.
   643     12  ER-0519                 PIC X(4)  VALUE '0519'.
   644     12  ER-0520                 PIC X(4)  VALUE '0520'.
   645     12  ER-0521                 PIC X(4)  VALUE '0521'.
   646     12  ER-0522                 PIC X(4)  VALUE '0522'.
   647     12  ER-0523                 PIC X(4)  VALUE '0523'.
   648     12  ER-0544                 PIC X(4)  VALUE '0544'.
   649     12  ER-0546                 PIC X(4)  VALUE '0546'.
   650     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  14
* EL130.cbl
   651     12  ER-0560                 PIC X(4)  VALUE '0560'.
   652     12  ER-0562                 PIC X(4)  VALUE '0562'.
   653     12  ER-0565                 PIC X(4)  VALUE '0565'.
   654     12  ER-0569                 PIC X(4)  VALUE '0569'.
   655     12  ER-0693                 PIC X(4)  VALUE '0693'.
   656     12  ER-0715                 PIC X(4)  VALUE '0715'.
   657     12  ER-0840                 PIC X(4)  VALUE '0840'.
   658     12  ER-0841                 PIC X(4)  VALUE '0841'.
   659     12  ER-0842                 PIC X(4)  VALUE '0842'.
   660     12  ER-0843                 PIC X(4)  VALUE '0843'.
   661     12  ER-0878                 PIC X(4)  VALUE '0878'.
   662     12  ER-0887                 PIC X(4)  VALUE '0887'.
   663     12  ER-0992                 PIC X(4)  VALUE '0992'.
   664     12  ER-1651                 PIC X(4)  VALUE '1651'.
   665     12  ER-1652                 PIC X(4)  VALUE '1652'.
   666     12  ER-1653                 PIC X(4)  VALUE '1653'.
   667     12  ER-1654                 PIC X(4)  VALUE '1654'.
   668     12  ER-1655                 PIC X(4)  VALUE '1655'.
   669     12  er-1659                 pic x(4)  value '1659'.
   670     12  er-1660                 pic x(4)  value '1660'.
   671     12  er-1661                 pic x(4)  value '1661'.
   672     12  er-1671                 pic x(4)  value '1671'.
   673     12  er-1672                 pic x(4)  value '1672'.
   674     12  er-1673                 pic x(4)  value '1673'.
   675     12  er-1675                 pic x(4)  value '1675'.
   676     12  er-1676                 pic x(4)  value '1676'.
   677     12  ER-2280                 PIC X(4)  VALUE '2280'.
   678     12  ER-2370                 PIC X(4)  VALUE '2370'.
   679     12  ER-2371                 PIC X(4)  VALUE '2371'.
   680     12  ER-2378                 PIC X(4)  VALUE '2378'.
   681     12  ER-2380                 PIC X(4)  VALUE '2380'.
   682     12  ER-2566                 PIC X(4)  VALUE '2566'.
   683     12  ER-2848                 PIC X(4)  VALUE '2848'.
   684     12  ER-3548                 PIC X(4)  VALUE '3548'.
   685     12  ER-7008                 PIC X(4)  VALUE '7008'.
   686     12  ER-7319                 PIC X(4)  VALUE '7319'.
   687     12  ER-7321                 PIC X(4)  VALUE '7321'.
   688     12  ER-7352                 PIC X(4)  VALUE '7352'.
   689     12  ER-7353                 PIC X(4)  VALUE '7353'.
   690     12  ER-7575                 PIC X(4)  VALUE '7575'.
   691     12  ER-7577                 PIC X(4)  VALUE '7577'.
   692     12  ER-7582                 PIC X(4)  VALUE '7582'.
   693     12  ER-7634                 PIC X(4)  VALUE '7634'.
   694     12  ER-7635                 PIC X(4)  VALUE '7635'.
   695     12  ER-7636                 PIC X(4)  VALUE '7636'.
   696     12  ER-7637                 PIC X(4)  VALUE '7637'.
   697     12  ER-7638                 PIC X(4)  VALUE '7638'.
   698     12  ER-7639                 PIC X(4)  VALUE '7639'.
   699     12  ER-7640                 PIC X(4)  VALUE '7640'.
   700     12  ER-7641                 PIC X(4)  VALUE '7641'.
   701     12  ER-7642                 PIC X(4)  VALUE '7642'.
   702     12  ER-7643                 PIC X(4)  VALUE '7643'.
   703     12  ER-7646                 PIC X(4)  VALUE '7646'.
   704     12  ER-7647                 PIC X(4)  VALUE '7647'.
   705     12  ER-7648                 PIC X(4)  VALUE '7648'.
   706     12  ER-7649                 PIC X(4)  VALUE '7649'.
   707     12  ER-7651                 PIC X(4)  VALUE '7651'.
   708     12  ER-7670                 PIC X(4)  VALUE '7670'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  15
* EL130.cbl
   709     12  ER-7671                 PIC X(4)  VALUE '7671'.
   710     12  ER-7686                 PIC X(4)  VALUE '7686'.
   711     12  ER-7688                 PIC X(4)  VALUE '7688'.
   712     12  ER-7689                 PIC X(4)  VALUE '7689'.
   713     12  ER-7691                 PIC X(4)  VALUE '7691'.
   714*    COPY ERCPDEF.
   715******************************************************************
   716*                                                                *
   717*                                                                *
   718*                            ERCPDEF.                            *
   719*                                                                *
   720*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   721*                                                                *
   722*    FILE TYPE = VSAM,KSDS                                       *
   723*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   724*                                                                *
   725*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   726*                                                                *
   727*    LOG = YES                                                   *
   728*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   729******************************************************************
   730*                   C H A N G E   L O G
   731*
   732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   733*-----------------------------------------------------------------
   734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   735* EFFECTIVE    NUMBER
   736*-----------------------------------------------------------------
   737* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   738* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   739******************************************************************
   740 01  PRODUCT-MASTER.
   741    12  PD-RECORD-ID                 PIC X(02).
   742        88  VALID-PD-ID                  VALUE 'PD'.
   743    12  PD-CONTROL-PRIMARY.
   744        16  PD-COMPANY-CD            PIC X.
   745        16  PD-STATE                 PIC XX.
   746        16  PD-PRODUCT-CD            PIC XXX.
   747        16  PD-FILLER                PIC X(7).
   748        16  PD-BEN-TYPE              PIC X.
   749        16  PD-BEN-CODE              PIC XX.
   750        16  PD-PROD-EXP-DT           PIC XX.
   751    12  FILLER                       PIC X(50).
   752    12  PD-PRODUCT-DATA OCCURS 8.
   753        16  PD-PROD-CODE             PIC X.
   754            88  PD-PROD-LIFE           VALUE 'L'.
   755            88  PD-PROD-PROP           VALUE 'P'.
   756            88  PD-PROD-AH             VALUE 'A'.
   757            88  PD-PROD-IU             VALUE 'I'.
   758            88  PD-PROD-GAP            VALUE 'G'.
   759            88  PD-PROD-FAML           VALUE 'F'.
   760        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   761        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   762        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   763        16  PD-MAX-TERM              PIC S999        COMP-3.
   764        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   765        16  FILLER                   PIC X.
   766        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  16
* EL130.cbl
   767        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   768        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   769        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   770        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   771        16  PD-REC-CRIT-PERIOD       PIC 99.
   772        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   773            20  PD-RECURRING-YN      PIC X.
   774            20  FILLER               PIC X.
   775        16  PD-RTW-MOS               PIC 99.
   776        16  PD-MAX-EXTENSION         PIC 99.
   777        16  FILLER                   PIC XX.
   778    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   779    12  PD-TERM-LIMITS OCCURS 15.
   780        16  PD-LOW-TERM              PIC S999        COMP-3.
   781        16  PD-HI-TERM               PIC S999        COMP-3.
   782*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   783    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   784        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   785        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   786    12  PD-EARN-FACTORS.
   787        16  FILLER OCCURS 15.
   788            20  FILLER OCCURS 15.
   789                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   790    12  PD-PRODUCT-DESC              PIC X(80).
   791    12  PD-TRUNCATED                 PIC X.
   792    12  FILLER                       PIC X(59).
   793    12  PD-MAINT-INFORMATION.
   794        16  PD-LAST-MAINT-DT         PIC X(02).
   795        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   796        16  PD-LAST-MAINT-BY         PIC X(04).
   797*    COPY ELCLNKLT.
   798******************************************************************
   799*                                                                *
   800*                                                                *
   801*                           ELCLNKLT                             *
   802*                            VMOD=2.003                          *
   803*                                                                *
   804*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   805*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   806*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   807*                                                                *
   808*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   809*   COMPLETING THE REQUIRED FIELDS.                              *
   810*                                                                *
   811*   THE CALLING PROGRAM SHOULD CHECK:                            *
   812*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   813*                              9999 INDICATES AN UNKNOWN ABEND   *
   814*                                   WAS DETECTED.                *
   815*                              ALL OTHER VALUES ARE NORMAL ERROR *
   816*                              CODES FOUND IN THE ERROR FILE.    *
   817******************************************************************
   818 01  W-1523-LINKDATA.
   819     12  W-1523-COMMON-PI-DATA.
   820         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   821         16  FILLER              PIC  X(67).
   822         16  W-1523-COMPANY-CD   PIC  X(01).
   823         16  FILLER              PIC  X(10).
   824         16  W-1523-CONTROL-IN-PROGRESS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  17
* EL130.cbl
   825             20  W-1523-CARRIER  PIC  X(01).
   826             20  W-1523-GROUPING PIC  X(06).
   827             20  W-1523-STATE    PIC  X(02).
   828             20  W-1523-ACCOUNT  PIC  X(10).
   829             20  W-1523-CLAIM-CERT-GRP.
   830                 24  W-1523-CLAIM-NO
   831                                 PIC  X(07).
   832                 24  W-1523-CERT-NO.
   833                     28  W-1523-CERT-PRIME
   834                                 PIC  X(10).
   835                     28  W-1523-CERT-SFX
   836                                 PIC  X(01).
   837                 24  W-1523-CERT-EFF-DT
   838                                 PIC  X(02).
   839         16  FILLER              PIC X(265).
   840
   841     12  W-1523-WORK-AREA.
   842         16  W-1523-FORM-NUMBER  PIC  X(04).
   843         16  W-1523-NUMBER-COPIES
   844                                 PIC  9(01).
   845         16  W-1523-ADDR-TYPE    PIC  X(02).
   846         16  W-1523-FOLLOW-UP-DATE
   847                                 PIC  X(02).
   848         16  W-1523-RESEND-DATE  PIC  X(02).
   849         16  W-1523-ERROR-CODE   PIC  9(04).
   850             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   851             88  W-1523-FATAL-ERROR
   852                                    VALUES  0006 0013 0042
   853                                            0154 0168 0169
   854                                            0176 9999 0172
   855                                            0179 0186 0281
   856                                            0332 2055 3697
   857                                            3698 3699 3770
   858                                            3771 3772 7675
   859                                            9106 9808 9883
   860                                            9887.
   861             88  W-1523-STOP-ERRORS
   862                                    VALUES  0013 0042 0154
   863                                            0168 0169 0172
   864                                            0281 0332 2055
   865                                            3698 3699 7675
   866                                            9106 9808 9883
   867                                            9999.
   868         16  W-1523-REASON       PIC  X(70).
   869         16  W-1523-ARCHIVE-NUMBER
   870                                 PIC  9(08).
   871     12  W-1523-POINTER-AREA.
   872         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   873         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   874         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   875         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   876         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  18
* EL130.cbl
   878*    COPY ELCINTF.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCINTF.                            *
   883*                            VMOD=2.017                          *
   884*                                                                *
   885*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   886*                                                                *
   887*       LENGTH = 1024                                            *
   888*                                                                *
   889******************************************************************
   890*                   C H A N G E   L O G
   891*
   892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   893*-----------------------------------------------------------------
   894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   895* EFFECTIVE    NUMBER
   896*-----------------------------------------------------------------
   897* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   898******************************************************************
   899 01  PROGRAM-INTERFACE-BLOCK.
   900     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   901     12  PI-CALLING-PROGRAM              PIC X(8).
   902     12  PI-SAVED-PROGRAM-1              PIC X(8).
   903     12  PI-SAVED-PROGRAM-2              PIC X(8).
   904     12  PI-SAVED-PROGRAM-3              PIC X(8).
   905     12  PI-SAVED-PROGRAM-4              PIC X(8).
   906     12  PI-SAVED-PROGRAM-5              PIC X(8).
   907     12  PI-SAVED-PROGRAM-6              PIC X(8).
   908     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   909     12  PI-COMPANY-ID                   PIC XXX.
   910     12  PI-COMPANY-CD                   PIC X.
   911
   912     12  PI-COMPANY-PASSWORD             PIC X(8).
   913
   914     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   915
   916     12  PI-CONTROL-IN-PROGRESS.
   917         16  PI-CARRIER                  PIC X.
   918         16  PI-GROUPING                 PIC X(6).
   919         16  PI-STATE                    PIC XX.
   920         16  PI-ACCOUNT                  PIC X(10).
   921         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   922                                         PIC X(10).
   923         16  PI-CLAIM-CERT-GRP.
   924             20  PI-CLAIM-NO             PIC X(7).
   925             20  PI-CERT-NO.
   926                 25  PI-CERT-PRIME       PIC X(10).
   927                 25  PI-CERT-SFX         PIC X.
   928             20  PI-CERT-EFF-DT          PIC XX.
   929         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   930             20  PI-PLAN-CODE            PIC X(2).
   931             20  PI-REVISION-NUMBER      PIC X(3).
   932             20  PI-PLAN-EFF-DT          PIC X(2).
   933             20  PI-PLAN-EXP-DT          PIC X(2).
   934             20  FILLER                  PIC X(11).
   935         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  19
* EL130.cbl
   936             20  PI-OE-REFERENCE-1.
   937                 25  PI-OE-REF-1-PRIME   PIC X(18).
   938                 25  PI-OE-REF-1-SUFF    PIC XX.
   939
   940     12  PI-SESSION-IN-PROGRESS          PIC X.
   941         88  CLAIM-SESSION                   VALUE '1'.
   942         88  CREDIT-SESSION                  VALUE '2'.
   943         88  WARRANTY-SESSION                VALUE '3'.
   944         88  MORTGAGE-SESSION                VALUE '4'.
   945         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   946
   947
   948*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   949
   950     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   951     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   952
   953     12  PI-CREDIT-USER                  PIC X.
   954         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   955         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   956
   957     12  PI-CLAIM-USER                   PIC X.
   958         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   959         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   960
   961     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   962         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   963         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   964         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   965         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   966         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   967
   968     12  PI-PROCESSOR-ID                 PIC X(4).
   969
   970     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   971
   972     12  PI-MEMBER-CAPTION               PIC X(10).
   973
   974     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   975         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   976
   977     12  PI-LIFE-OVERRIDE-L1             PIC X.
   978     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   979     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   980     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   981
   982     12  PI-AH-OVERRIDE-L1               PIC X.
   983     12  PI-AH-OVERRIDE-L2               PIC XX.
   984     12  PI-AH-OVERRIDE-L6               PIC X(6).
   985     12  PI-AH-OVERRIDE-L12              PIC X(12).
   986
   987     12  PI-NEW-SYSTEM                   PIC X(2).
   988
   989     12  PI-PRIMARY-CERT-NO              PIC X(11).
   990     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   991         88  PI-USES-PAID-TO                 VALUE '1'.
   992     12  PI-CRDTCRD-SYSTEM.
   993         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  20
* EL130.cbl
   994             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   995             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   996         16  PI-CC-MONTH-END-DT          PIC XX.
   997     12  PI-PROCESSOR-PRINTER            PIC X(4).
   998
   999     12  PI-OE-REFERENCE-2.
  1000         16  PI-OE-REF-2-PRIME           PIC X(10).
  1001         16  PI-OE-REF-2-SUFF            PIC X.
  1002
  1003     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1004
  1005     12  PI-LANGUAGE-TYPE                PIC X.
  1006             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1007             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1008             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1009
  1010     12  PI-POLICY-LINKAGE-IND           PIC X.
  1011         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1012         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1013                                                   LOW-VALUES.
  1014
  1015     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1016     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1017         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1018         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1019
  1020     12  PI-PROCESSOR-CSR-IND            PIC X.
  1021         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1022         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1023
  1024     12  FILLER                          PIC X(3).
  1025
  1026     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1027
  1028     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1029         PI-SYSTEM-LEVEL.
  1030
  1031         16  PI-ENTRY-CODES.
  1032             20  PI-ENTRY-CD-1           PIC X.
  1033             20  PI-ENTRY-CD-2           PIC X.
  1034
  1035         16  PI-RETURN-CODES.
  1036             20  PI-RETURN-CD-1          PIC X.
  1037             20  PI-RETURN-CD-2          PIC X.
  1038
  1039         16  PI-UPDATE-STATUS-SAVE.
  1040             20  PI-UPDATE-BY            PIC X(4).
  1041             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1042
  1043         16  PI-LOWER-CASE-LETTERS       PIC X.
  1044             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1045
  1046*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1047*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1048*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1049
  1050         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1051             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  21
* EL130.cbl
  1052             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1053             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1054             88  ACCNT-CNTL                  VALUE '3'.
  1055             88  CARR-ACCNT-CNTL             VALUE '4'.
  1056
  1057         16  PI-PROCESSOR-CAP-LIST.
  1058             20  PI-SYSTEM-CONTROLS.
  1059                24 PI-SYSTEM-DISPLAY     PIC X.
  1060                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1061                24 PI-SYSTEM-MODIFY      PIC X.
  1062                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1063             20  FILLER                  PIC XX.
  1064             20  PI-DISPLAY-CAP          PIC X.
  1065                 88  DISPLAY-CAP             VALUE 'Y'.
  1066             20  PI-MODIFY-CAP           PIC X.
  1067                 88  MODIFY-CAP              VALUE 'Y'.
  1068             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1069                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1070             20  PI-FORCE-CAP            PIC X.
  1071                 88  FORCE-CAP               VALUE 'Y'.
  1072
  1073         16  PI-PROGRAM-CONTROLS.
  1074             20  PI-PGM-PRINT-OPT        PIC X.
  1075             20  PI-PGM-FORMAT-OPT       PIC X.
  1076             20  PI-PGM-PROCESS-OPT      PIC X.
  1077             20  PI-PGM-TOTALS-OPT       PIC X.
  1078
  1079         16  PI-HELP-INTERFACE.
  1080             20  PI-LAST-ERROR-NO        PIC X(4).
  1081             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1082
  1083         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1084             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1085
  1086         16  PI-CR-CONTROL-IN-PROGRESS.
  1087             20  PI-CR-CARRIER           PIC X.
  1088             20  PI-CR-GROUPING          PIC X(6).
  1089             20  PI-CR-STATE             PIC XX.
  1090             20  PI-CR-ACCOUNT           PIC X(10).
  1091             20  PI-CR-FIN-RESP          PIC X(10).
  1092             20  PI-CR-TYPE              PIC X.
  1093
  1094         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1095
  1096         16  PI-CR-MONTH-END-DT          PIC XX.
  1097
  1098         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1099             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1100             88  PI-ZERO-CARRIER             VALUE '1'.
  1101             88  PI-ZERO-GROUPING            VALUE '2'.
  1102             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1103
  1104         16  PI-CARRIER-SECURITY         PIC X.
  1105             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1106
  1107         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1108             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1109             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  22
* EL130.cbl
  1110
  1111         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1112             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1113                                         INDEXED BY PI-ACCESS-NDX
  1114                                         PIC X.
  1115
  1116         16  PI-GA-BILLING-CONTROL       PIC X.
  1117             88  PI-GA-BILLING               VALUE '1'.
  1118
  1119         16  PI-MAIL-PROCESSING          PIC X.
  1120             88  PI-MAIL-YES                 VALUE 'Y'.
  1121
  1122         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1123
  1124         16  PI-AR-SYSTEM.
  1125             20  PI-AR-PROCESSING-CNTL   PIC X.
  1126                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1127             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1128             20  PI-AR-MONTH-END-DT      PIC XX.
  1129
  1130         16  PI-MP-SYSTEM.
  1131             20  PI-MORTGAGE-USER            PIC X.
  1132                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1133                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1134             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1135                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1136                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1137                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1138                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1139                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1140             20  PI-MP-MONTH-END-DT          PIC XX.
  1141             20  PI-MP-REFERENCE-NO.
  1142                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1143                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1144
  1145         16  PI-LABEL-CONTROL            PIC X(01).
  1146             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1147             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1148
  1149         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1150             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1151
  1152         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1153             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1154             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1155
  1156         16  FILLER                      PIC X(14).
  1157
  1158     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1159******************************************************************
  1160     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1161         16  PI-MSTR-DT               PIC XX.
  1162         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1163         16  PI-TRLR-DT               PIC XX.
  1164         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1165         16  PI-LAST-CLAIM            PIC X(7).
  1166         16  PI-LAST-CARR             PIC X.
  1167         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  23
* EL130.cbl
  1168             20  PI-LAST-CERT-PRIME   PIC X(10).
  1169             20  PI-LAST-CERT-SUFX    PIC X.
  1170         16  PI-LAST-CLAIM-TYPE       PIC X.
  1171         16  PI-CURSOR                PIC S9(4)   COMP.
  1172         16  PI-SAVE-CERT.
  1173             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1174             20  PI-SAVE-CERT-SUFX    PIC X.
  1175         16  PI-SAVE-EFFDT            PIC X(2).
  1176         16  PI-SAVE-ACCOUNT          PIC X(10).
  1177         16  PI-INCURR-SW             PIC X.
  1178         16  PI-PRT-OPT               PIC X.
  1179         16  PI-ALT-PRT               PIC X(4).
  1180         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1181             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1182         16  FILLER                   PIC X(272).
  1183         16  PI-EL127-TO-EL130-CNTRL.
  1184             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1185             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1186             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1187                 24  PI-EL127-CARRIER        PIC X.
  1188                 24  PI-EL127-GROUPING       PIC X(6).
  1189                 24  PI-EL127-STATE          PIC X(2).
  1190                 24  PI-EL127-ACCOUNT        PIC X(10).
  1191                 24  PI-EL127-CERT-NO.
  1192                     28  PI-EL127-CERT-PRIME PIC X(10).
  1193                     28  PI-EL127-CERT-SUFX  PIC X.
  1194                 24  PI-EL127-EFF-DT         PIC XX.
  1195*        16  FILLER                          PIC X(50).
  1196         16  FILLER                          PIC X(31).
  1197         16  PI-EL659-TO-EL130-CNTRL.
  1198             20  PI-EL659-CARRIER            PIC X.
  1199             20  PI-EL659-GROUPING           PIC X(6).
  1200             20  PI-EL659-STATE              PIC XX.
  1201             20  PI-EL659-ACCOUNT            PIC X(10).
  1202
  1203         16  FILLER                          PIC X(19).
  1204
  1205         16  PI-SAVE-INCUR-DT                PIC X(02).
  1206         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1207*         16  FILLER                          PIC X(65).
  1208         16  PI-ST-VFY-2ND-BENE              PIC X.
  1209         16  PI-ST-CAUSAL-STATE              PIC X.
  1210         16  pi-dcc-max-benefits             pic s999 comp-3.
  1211         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1212         16  pi-emi-sub                      pic 99.
  1213         16  FILLER                          PIC X(53).
  1214
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  24
* EL130.cbl
  1216*    COPY EL130S.
  1217 01  EL130AI.
  1218     05  FILLER            PIC  X(0012).
  1219*    -------------------------------
  1220     05  RUNDTEL PIC S9(0004) COMP.
  1221     05  RUNDTEF PIC  X(0001).
  1222     05  FILLER REDEFINES RUNDTEF.
  1223         10  RUNDTEA PIC  X(0001).
  1224     05  RUNDTEI PIC  X(0008).
  1225*    -------------------------------
  1226     05  RUNTIMEL PIC S9(0004) COMP.
  1227     05  RUNTIMEF PIC  X(0001).
  1228     05  FILLER REDEFINES RUNTIMEF.
  1229         10  RUNTIMEA PIC  X(0001).
  1230     05  RUNTIMEI PIC  X(0005).
  1231*    -------------------------------
  1232     05  COMPL PIC S9(0004) COMP.
  1233     05  COMPF PIC  X(0001).
  1234     05  FILLER REDEFINES COMPF.
  1235         10  COMPA PIC  X(0001).
  1236     05  COMPI PIC  X(0003).
  1237*    -------------------------------
  1238     05  SEQUL PIC S9(0004) COMP.
  1239     05  SEQUF PIC  X(0001).
  1240     05  FILLER REDEFINES SEQUF.
  1241         10  SEQUA PIC  X(0001).
  1242     05  SEQUI PIC  X(0010).
  1243*    -------------------------------
  1244     05  MAINTL PIC S9(0004) COMP.
  1245     05  MAINTF PIC  X(0001).
  1246     05  FILLER REDEFINES MAINTF.
  1247         10  MAINTA PIC  X(0001).
  1248     05  MAINTI PIC  X(0001).
  1249*    -------------------------------
  1250     05  CLMNOL PIC S9(0004) COMP.
  1251     05  CLMNOF PIC  X(0001).
  1252     05  FILLER REDEFINES CLMNOF.
  1253         10  CLMNOA PIC  X(0001).
  1254     05  CLMNOI PIC  X(0007).
  1255*    -------------------------------
  1256     05  CLMCARRL PIC S9(0004) COMP.
  1257     05  CLMCARRF PIC  X(0001).
  1258     05  FILLER REDEFINES CLMCARRF.
  1259         10  CLMCARRA PIC  X(0001).
  1260     05  CLMCARRI PIC  X(0001).
  1261*    -------------------------------
  1262     05  CLMTYPEL PIC S9(0004) COMP.
  1263     05  CLMTYPEF PIC  X(0001).
  1264     05  FILLER REDEFINES CLMTYPEF.
  1265         10  CLMTYPEA PIC  X(0001).
  1266     05  CLMTYPEI PIC  X(0001).
  1267*    -------------------------------
  1268     05  CERTNOL PIC S9(0004) COMP.
  1269     05  CERTNOF PIC  X(0001).
  1270     05  FILLER REDEFINES CERTNOF.
  1271         10  CERTNOA PIC  X(0001).
  1272     05  CERTNOI PIC  X(0010).
  1273*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  25
* EL130.cbl
  1274     05  SUFXL PIC S9(0004) COMP.
  1275     05  SUFXF PIC  X(0001).
  1276     05  FILLER REDEFINES SUFXF.
  1277         10  SUFXA PIC  X(0001).
  1278     05  SUFXI PIC  X(0001).
  1279*    -------------------------------
  1280     05  PCERTNOL PIC S9(0004) COMP.
  1281     05  PCERTNOF PIC  X(0001).
  1282     05  FILLER REDEFINES PCERTNOF.
  1283         10  PCERTNOA PIC  X(0001).
  1284     05  PCERTNOI PIC  X(0010).
  1285*    -------------------------------
  1286     05  PSUFXL PIC S9(0004) COMP.
  1287     05  PSUFXF PIC  X(0001).
  1288     05  FILLER REDEFINES PSUFXF.
  1289         10  PSUFXA PIC  X(0001).
  1290     05  PSUFXI PIC  X(0001).
  1291*    -------------------------------
  1292     05  INCURL PIC S9(0004) COMP.
  1293     05  INCURF PIC  X(0001).
  1294     05  FILLER REDEFINES INCURF.
  1295         10  INCURA PIC  X(0001).
  1296     05  INCURI PIC  X(0008).
  1297*    -------------------------------
  1298     05  REPORTL PIC S9(0004) COMP.
  1299     05  REPORTF PIC  X(0001).
  1300     05  FILLER REDEFINES REPORTF.
  1301         10  REPORTA PIC  X(0001).
  1302     05  REPORTI PIC  X(0008).
  1303*    -------------------------------
  1304     05  ICD1L PIC S9(0004) COMP.
  1305     05  ICD1F PIC  X(0001).
  1306     05  FILLER REDEFINES ICD1F.
  1307         10  ICD1A PIC  X(0001).
  1308     05  ICD1I PIC  X(0008).
  1309*    -------------------------------
  1310     05  ICD2L PIC S9(0004) COMP.
  1311     05  ICD2F PIC  X(0001).
  1312     05  FILLER REDEFINES ICD2F.
  1313         10  ICD2A PIC  X(0001).
  1314     05  ICD2I PIC  X(0008).
  1315*    -------------------------------
  1316     05  DIAGL PIC S9(0004) COMP.
  1317     05  DIAGF PIC  X(0001).
  1318     05  FILLER REDEFINES DIAGF.
  1319         10  DIAGA PIC  X(0001).
  1320     05  DIAGI PIC  X(0060).
  1321*    -------------------------------
  1322     05  BENECDL PIC S9(0004) COMP.
  1323     05  BENECDF PIC  X(0001).
  1324     05  FILLER REDEFINES BENECDF.
  1325         10  BENECDA PIC  X(0001).
  1326     05  BENECDI PIC  X(0010).
  1327*    -------------------------------
  1328     05  BIRTHDTL PIC S9(0004) COMP.
  1329     05  BIRTHDTF PIC  X(0001).
  1330     05  FILLER REDEFINES BIRTHDTF.
  1331         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  26
* EL130.cbl
  1332     05  BIRTHDTI PIC  X(0008).
  1333*    -------------------------------
  1334     05  SSNL PIC S9(0004) COMP.
  1335     05  SSNF PIC  X(0001).
  1336     05  FILLER REDEFINES SSNF.
  1337         10  SSNA PIC  X(0001).
  1338     05  SSNI PIC  X(0011).
  1339*    -------------------------------
  1340     05  SEXL PIC S9(0004) COMP.
  1341     05  SEXF PIC  X(0001).
  1342     05  FILLER REDEFINES SEXF.
  1343         10  SEXA PIC  X(0001).
  1344     05  SEXI PIC  X(0001).
  1345*    -------------------------------
  1346     05  INSTYPEL PIC S9(0004) COMP.
  1347     05  INSTYPEF PIC  X(0001).
  1348     05  FILLER REDEFINES INSTYPEF.
  1349         10  INSTYPEA PIC  X(0001).
  1350     05  INSTYPEI PIC  X(0001).
  1351*    -------------------------------
  1352     05  LSTNMEL PIC S9(0004) COMP.
  1353     05  LSTNMEF PIC  X(0001).
  1354     05  FILLER REDEFINES LSTNMEF.
  1355         10  LSTNMEA PIC  X(0001).
  1356     05  LSTNMEI PIC  X(0015).
  1357*    -------------------------------
  1358     05  FSTNMEL PIC S9(0004) COMP.
  1359     05  FSTNMEF PIC  X(0001).
  1360     05  FILLER REDEFINES FSTNMEF.
  1361         10  FSTNMEA PIC  X(0001).
  1362     05  FSTNMEI PIC  X(0012).
  1363*    -------------------------------
  1364     05  INITL PIC S9(0004) COMP.
  1365     05  INITF PIC  X(0001).
  1366     05  FILLER REDEFINES INITF.
  1367         10  INITA PIC  X(0001).
  1368     05  INITI PIC  X(0001).
  1369*    -------------------------------
  1370     05  LOANNOL PIC S9(0004) COMP.
  1371     05  LOANNOF PIC  X(0001).
  1372     05  FILLER REDEFINES LOANNOF.
  1373         10  LOANNOA PIC  X(0001).
  1374     05  LOANNOI PIC  X(0008).
  1375*    -------------------------------
  1376     05  CRTLNMEL PIC S9(0004) COMP.
  1377     05  CRTLNMEF PIC  X(0001).
  1378     05  FILLER REDEFINES CRTLNMEF.
  1379         10  CRTLNMEA PIC  X(0001).
  1380     05  CRTLNMEI PIC  X(0015).
  1381*    -------------------------------
  1382     05  CRTFNMEL PIC S9(0004) COMP.
  1383     05  CRTFNMEF PIC  X(0001).
  1384     05  FILLER REDEFINES CRTFNMEF.
  1385         10  CRTFNMEA PIC  X(0001).
  1386     05  CRTFNMEI PIC  X(0012).
  1387*    -------------------------------
  1388     05  CRTINITL PIC S9(0004) COMP.
  1389     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  27
* EL130.cbl
  1390     05  FILLER REDEFINES CRTINITF.
  1391         10  CRTINITA PIC  X(0001).
  1392     05  CRTINITI PIC  X(0001).
  1393*    -------------------------------
  1394     05  LOANBALL PIC S9(0004) COMP.
  1395     05  LOANBALF PIC  X(0001).
  1396     05  FILLER REDEFINES LOANBALF.
  1397         10  LOANBALA PIC  X(0001).
  1398     05  LOANBALI PIC  9(7)V99.
  1399*    -------------------------------
  1400     05  MANRSVL PIC S9(0004) COMP.
  1401     05  MANRSVF PIC  X(0001).
  1402     05  FILLER REDEFINES MANRSVF.
  1403         10  MANRSVA PIC  X(0001).
  1404     05  MANRSVI PIC  9(7)V99.
  1405*    -------------------------------
  1406     05  SUPVL PIC S9(0004) COMP.
  1407     05  SUPVF PIC  X(0001).
  1408     05  FILLER REDEFINES SUPVF.
  1409         10  SUPVA PIC  X(0001).
  1410     05  SUPVI PIC  X(0001).
  1411*    -------------------------------
  1412     05  PRICDL PIC S9(0004) COMP.
  1413     05  PRICDF PIC  X(0001).
  1414     05  FILLER REDEFINES PRICDF.
  1415         10  PRICDA PIC  X(0001).
  1416     05  PRICDI PIC  X(0001).
  1417*    -------------------------------
  1418     05  PRODL PIC S9(0004) COMP.
  1419     05  PRODF PIC  X(0001).
  1420     05  FILLER REDEFINES PRODF.
  1421         10  PRODA PIC  X(0001).
  1422     05  PRODI PIC  X(0008).
  1423*    -------------------------------
  1424     05  PRODCDL PIC S9(0004) COMP.
  1425     05  PRODCDF PIC  X(0001).
  1426     05  FILLER REDEFINES PRODCDF.
  1427         10  PRODCDA PIC  X(0001).
  1428     05  PRODCDI PIC  X(0001).
  1429*    -------------------------------
  1430     05  FILETOL PIC S9(0004) COMP.
  1431     05  FILETOF PIC  X(0001).
  1432     05  FILLER REDEFINES FILETOF.
  1433         10  FILETOA PIC  X(0001).
  1434     05  FILETOI PIC  X(0004).
  1435*    -------------------------------
  1436     05  PROCCDL PIC S9(0004) COMP.
  1437     05  PROCCDF PIC  X(0001).
  1438     05  FILLER REDEFINES PROCCDF.
  1439         10  PROCCDA PIC  X(0001).
  1440     05  PROCCDI PIC  X(0004).
  1441*    -------------------------------
  1442     05  RELCLML PIC S9(0004) COMP.
  1443     05  RELCLMF PIC  X(0001).
  1444     05  FILLER REDEFINES RELCLMF.
  1445         10  RELCLMA PIC  X(0001).
  1446     05  RELCLMI PIC  X(0007).
  1447*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  28
* EL130.cbl
  1448     05  PRTOPTL PIC S9(0004) COMP.
  1449     05  PRTOPTF PIC  X(0001).
  1450     05  FILLER REDEFINES PRTOPTF.
  1451         10  PRTOPTA PIC  X(0001).
  1452     05  PRTOPTI PIC  X(0001).
  1453*    -------------------------------
  1454     05  ALTPRTL PIC S9(0004) COMP.
  1455     05  ALTPRTF PIC  X(0001).
  1456     05  FILLER REDEFINES ALTPRTF.
  1457         10  ALTPRTA PIC  X(0001).
  1458     05  ALTPRTI PIC  X(0004).
  1459*    -------------------------------
  1460     05  CERTMTL PIC S9(0004) COMP.
  1461     05  CERTMTF PIC  X(0001).
  1462     05  FILLER REDEFINES CERTMTF.
  1463         10  CERTMTA PIC  X(0001).
  1464     05  CERTMTI PIC  X(0001).
  1465*    -------------------------------
  1466     05  CRTCARRL PIC S9(0004) COMP.
  1467     05  CRTCARRF PIC  X(0001).
  1468     05  FILLER REDEFINES CRTCARRF.
  1469         10  CRTCARRA PIC  X(0001).
  1470     05  CRTCARRI PIC  X(0001).
  1471*    -------------------------------
  1472     05  GROUPL PIC S9(0004) COMP.
  1473     05  GROUPF PIC  X(0001).
  1474     05  FILLER REDEFINES GROUPF.
  1475         10  GROUPA PIC  X(0001).
  1476     05  GROUPI PIC  X(0006).
  1477*    -------------------------------
  1478     05  STATEL PIC S9(0004) COMP.
  1479     05  STATEF PIC  X(0001).
  1480     05  FILLER REDEFINES STATEF.
  1481         10  STATEA PIC  X(0001).
  1482     05  STATEI PIC  X(0002).
  1483*    -------------------------------
  1484     05  ACCOUNTL PIC S9(0004) COMP.
  1485     05  ACCOUNTF PIC  X(0001).
  1486     05  FILLER REDEFINES ACCOUNTF.
  1487         10  ACCOUNTA PIC  X(0001).
  1488     05  ACCOUNTI PIC  X(0010).
  1489*    -------------------------------
  1490     05  EFFDTL PIC S9(0004) COMP.
  1491     05  EFFDTF PIC  X(0001).
  1492     05  FILLER REDEFINES EFFDTF.
  1493         10  EFFDTA PIC  X(0001).
  1494     05  EFFDTI PIC  X(0008).
  1495*    -------------------------------
  1496     05  CRTSSNL PIC S9(0004) COMP.
  1497     05  CRTSSNF PIC  X(0001).
  1498     05  FILLER REDEFINES CRTSSNF.
  1499         10  CRTSSNA PIC  X(0001).
  1500     05  CRTSSNI PIC  X(0011).
  1501*    -------------------------------
  1502     05  MEMCAPL PIC S9(0004) COMP.
  1503     05  MEMCAPF PIC  X(0001).
  1504     05  FILLER REDEFINES MEMCAPF.
  1505         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  29
* EL130.cbl
  1506     05  MEMCAPI PIC  X(0010).
  1507*    -------------------------------
  1508     05  MEMBERL PIC S9(0004) COMP.
  1509     05  MEMBERF PIC  X(0001).
  1510     05  FILLER REDEFINES MEMBERF.
  1511         10  MEMBERA PIC  X(0001).
  1512     05  MEMBERI PIC  X(0012).
  1513*    -------------------------------
  1514     05  REINCDL PIC S9(0004) COMP.
  1515     05  REINCDF PIC  X(0001).
  1516     05  FILLER REDEFINES REINCDF.
  1517         10  REINCDA PIC  X(0001).
  1518     05  REINCDI PIC  X(0001).
  1519*    -------------------------------
  1520     05  ISSAGEL PIC S9(0004) COMP.
  1521     05  ISSAGEF PIC  X(0001).
  1522     05  FILLER REDEFINES ISSAGEF.
  1523         10  ISSAGEA PIC  X(0001).
  1524     05  ISSAGEI PIC  X(0002).
  1525*    -------------------------------
  1526     05  APRL PIC S9(0004) COMP.
  1527     05  APRF PIC  X(0001).
  1528     05  FILLER REDEFINES APRF.
  1529         10  APRA PIC  X(0001).
  1530     05  APRI PIC  9(4)V9(4).
  1531*    -------------------------------
  1532     05  PMTFREQL PIC S9(0004) COMP.
  1533     05  PMTFREQF PIC  X(0001).
  1534     05  FILLER REDEFINES PMTFREQF.
  1535         10  PMTFREQA PIC  X(0001).
  1536     05  PMTFREQI PIC  99.
  1537*    -------------------------------
  1538     05  INDGRPL PIC S9(0004) COMP.
  1539     05  INDGRPF PIC  X(0001).
  1540     05  FILLER REDEFINES INDGRPF.
  1541         10  INDGRPA PIC  X(0001).
  1542     05  INDGRPI PIC  X(0001).
  1543*    -------------------------------
  1544     05  PREMTYPL PIC S9(0004) COMP.
  1545     05  PREMTYPF PIC  X(0001).
  1546     05  FILLER REDEFINES PREMTYPF.
  1547         10  PREMTYPA PIC  X(0001).
  1548     05  PREMTYPI PIC  X(0001).
  1549*    -------------------------------
  1550     05  ADDONDTL PIC S9(0004) COMP.
  1551     05  ADDONDTF PIC  X(0001).
  1552     05  FILLER REDEFINES ADDONDTF.
  1553         10  ADDONDTA PIC  X(0001).
  1554     05  ADDONDTI PIC  X(0008).
  1555*    -------------------------------
  1556     05  JNTLNMEL PIC S9(0004) COMP.
  1557     05  JNTLNMEF PIC  X(0001).
  1558     05  FILLER REDEFINES JNTLNMEF.
  1559         10  JNTLNMEA PIC  X(0001).
  1560     05  JNTLNMEI PIC  X(0015).
  1561*    -------------------------------
  1562     05  JNTFNMEL PIC S9(0004) COMP.
  1563     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  30
* EL130.cbl
  1564     05  FILLER REDEFINES JNTFNMEF.
  1565         10  JNTFNMEA PIC  X(0001).
  1566     05  JNTFNMEI PIC  X(0002).
  1567*    -------------------------------
  1568     05  JNTINITL PIC S9(0004) COMP.
  1569     05  JNTINITF PIC  X(0001).
  1570     05  FILLER REDEFINES JNTINITF.
  1571         10  JNTINITA PIC  X(0001).
  1572     05  JNTINITI PIC  X(0001).
  1573*    -------------------------------
  1574     05  JNTAGEL PIC S9(0004) COMP.
  1575     05  JNTAGEF PIC  X(0001).
  1576     05  FILLER REDEFINES JNTAGEF.
  1577         10  JNTAGEA PIC  X(0001).
  1578     05  JNTAGEI PIC  X(0002).
  1579*    -------------------------------
  1580     05  LCVDSCRL PIC S9(0004) COMP.
  1581     05  LCVDSCRF PIC  X(0001).
  1582     05  FILLER REDEFINES LCVDSCRF.
  1583         10  LCVDSCRA PIC  X(0001).
  1584     05  LCVDSCRI PIC  X(0006).
  1585*    -------------------------------
  1586     05  LCVKINDL PIC S9(0004) COMP.
  1587     05  LCVKINDF PIC  X(0001).
  1588     05  FILLER REDEFINES LCVKINDF.
  1589         10  LCVKINDA PIC  X(0001).
  1590     05  LCVKINDI PIC  X(0003).
  1591*    -------------------------------
  1592     05  LCVCDL PIC S9(0004) COMP.
  1593     05  LCVCDF PIC  X(0001).
  1594     05  FILLER REDEFINES LCVCDF.
  1595         10  LCVCDA PIC  X(0001).
  1596     05  LCVCDI PIC  X(0002).
  1597*    -------------------------------
  1598     05  LCVOTRML PIC S9(0004) COMP.
  1599     05  LCVOTRMF PIC  X(0001).
  1600     05  FILLER REDEFINES LCVOTRMF.
  1601         10  LCVOTRMA PIC  X(0001).
  1602     05  LCVOTRMI PIC  999.
  1603*    -------------------------------
  1604     05  LCVRTRML PIC S9(0004) COMP.
  1605     05  LCVRTRMF PIC  X(0001).
  1606     05  FILLER REDEFINES LCVRTRMF.
  1607         10  LCVRTRMA PIC  X(0001).
  1608     05  LCVRTRMI PIC  X(0003).
  1609*    -------------------------------
  1610     05  LCVRATEL PIC S9(0004) COMP.
  1611     05  LCVRATEF PIC  X(0001).
  1612     05  FILLER REDEFINES LCVRATEF.
  1613         10  LCVRATEA PIC  X(0001).
  1614     05  LCVRATEI PIC  9999V99.
  1615*    -------------------------------
  1616     05  LCVBENEL PIC S9(0004) COMP.
  1617     05  LCVBENEF PIC  X(0001).
  1618     05  FILLER REDEFINES LCVBENEF.
  1619         10  LCVBENEA PIC  X(0001).
  1620     05  LCVBENEI PIC  9(9)V99.
  1621*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  31
* EL130.cbl
  1622     05  LCVFORML PIC S9(0004) COMP.
  1623     05  LCVFORMF PIC  X(0001).
  1624     05  FILLER REDEFINES LCVFORMF.
  1625         10  LCVFORMA PIC  X(0001).
  1626     05  LCVFORMI PIC  X(0012).
  1627*    -------------------------------
  1628     05  LCVCNDTL PIC S9(0004) COMP.
  1629     05  LCVCNDTF PIC  X(0001).
  1630     05  FILLER REDEFINES LCVCNDTF.
  1631         10  LCVCNDTA PIC  X(0001).
  1632     05  LCVCNDTI PIC  X(0008).
  1633*    -------------------------------
  1634     05  LCVEXITL PIC S9(0004) COMP.
  1635     05  LCVEXITF PIC  X(0001).
  1636     05  FILLER REDEFINES LCVEXITF.
  1637         10  LCVEXITA PIC  X(0001).
  1638     05  LCVEXITI PIC  X(0008).
  1639*    -------------------------------
  1640     05  LCVSTATL PIC S9(0004) COMP.
  1641     05  LCVSTATF PIC  X(0001).
  1642     05  FILLER REDEFINES LCVSTATF.
  1643         10  LCVSTATA PIC  X(0001).
  1644     05  LCVSTATI PIC  X(0006).
  1645*    -------------------------------
  1646     05  ACVDSCRL PIC S9(0004) COMP.
  1647     05  ACVDSCRF PIC  X(0001).
  1648     05  FILLER REDEFINES ACVDSCRF.
  1649         10  ACVDSCRA PIC  X(0001).
  1650     05  ACVDSCRI PIC  X(0006).
  1651*    -------------------------------
  1652     05  ACVKINDL PIC S9(0004) COMP.
  1653     05  ACVKINDF PIC  X(0001).
  1654     05  FILLER REDEFINES ACVKINDF.
  1655         10  ACVKINDA PIC  X(0001).
  1656     05  ACVKINDI PIC  X(0003).
  1657*    -------------------------------
  1658     05  ACVCDL PIC S9(0004) COMP.
  1659     05  ACVCDF PIC  X(0001).
  1660     05  FILLER REDEFINES ACVCDF.
  1661         10  ACVCDA PIC  X(0001).
  1662     05  ACVCDI PIC  X(0002).
  1663*    -------------------------------
  1664     05  ACVOTRML PIC S9(0004) COMP.
  1665     05  ACVOTRMF PIC  X(0001).
  1666     05  FILLER REDEFINES ACVOTRMF.
  1667         10  ACVOTRMA PIC  X(0001).
  1668     05  ACVOTRMI PIC  999.
  1669*    -------------------------------
  1670     05  ACVRTRML PIC S9(0004) COMP.
  1671     05  ACVRTRMF PIC  X(0001).
  1672     05  FILLER REDEFINES ACVRTRMF.
  1673         10  ACVRTRMA PIC  X(0001).
  1674     05  ACVRTRMI PIC  X(0003).
  1675*    -------------------------------
  1676     05  ACVRATEL PIC S9(0004) COMP.
  1677     05  ACVRATEF PIC  X(0001).
  1678     05  FILLER REDEFINES ACVRATEF.
  1679         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  32
* EL130.cbl
  1680     05  ACVRATEI PIC  9999V99.
  1681*    -------------------------------
  1682     05  ACVBENEL PIC S9(0004) COMP.
  1683     05  ACVBENEF PIC  X(0001).
  1684     05  FILLER REDEFINES ACVBENEF.
  1685         10  ACVBENEA PIC  X(0001).
  1686     05  ACVBENEI PIC  9(9)V99.
  1687*    -------------------------------
  1688     05  ACVFORML PIC S9(0004) COMP.
  1689     05  ACVFORMF PIC  X(0001).
  1690     05  FILLER REDEFINES ACVFORMF.
  1691         10  ACVFORMA PIC  X(0001).
  1692     05  ACVFORMI PIC  X(0012).
  1693*    -------------------------------
  1694     05  ACVCNDTL PIC S9(0004) COMP.
  1695     05  ACVCNDTF PIC  X(0001).
  1696     05  FILLER REDEFINES ACVCNDTF.
  1697         10  ACVCNDTA PIC  X(0001).
  1698     05  ACVCNDTI PIC  X(0008).
  1699*    -------------------------------
  1700     05  ACVEXITL PIC S9(0004) COMP.
  1701     05  ACVEXITF PIC  X(0001).
  1702     05  FILLER REDEFINES ACVEXITF.
  1703         10  ACVEXITA PIC  X(0001).
  1704     05  ACVEXITI PIC  X(0008).
  1705*    -------------------------------
  1706     05  ACVSTATL PIC S9(0004) COMP.
  1707     05  ACVSTATF PIC  X(0001).
  1708     05  FILLER REDEFINES ACVSTATF.
  1709         10  ACVSTATA PIC  X(0001).
  1710     05  ACVSTATI PIC  X(0006).
  1711*    -------------------------------
  1712     05  ERRMSG1L PIC S9(0004) COMP.
  1713     05  ERRMSG1F PIC  X(0001).
  1714     05  FILLER REDEFINES ERRMSG1F.
  1715         10  ERRMSG1A PIC  X(0001).
  1716     05  ERRMSG1I PIC  X(0072).
  1717*    -------------------------------
  1718     05  ERRMSG2L PIC S9(0004) COMP.
  1719     05  ERRMSG2F PIC  X(0001).
  1720     05  FILLER REDEFINES ERRMSG2F.
  1721         10  ERRMSG2A PIC  X(0001).
  1722     05  ERRMSG2I PIC  X(0072).
  1723*    -------------------------------
  1724     05  BCERT1L PIC S9(0004) COMP.
  1725     05  BCERT1F PIC  X(0001).
  1726     05  FILLER REDEFINES BCERT1F.
  1727         10  BCERT1A PIC  X(0001).
  1728     05  BCERT1I PIC  X(0010).
  1729*    -------------------------------
  1730     05  BSUFX1L PIC S9(0004) COMP.
  1731     05  BSUFX1F PIC  X(0001).
  1732     05  FILLER REDEFINES BSUFX1F.
  1733         10  BSUFX1A PIC  X(0001).
  1734     05  BSUFX1I PIC  X(0001).
  1735*    -------------------------------
  1736     05  BCERT2L PIC S9(0004) COMP.
  1737     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  33
* EL130.cbl
  1738     05  FILLER REDEFINES BCERT2F.
  1739         10  BCERT2A PIC  X(0001).
  1740     05  BCERT2I PIC  X(0010).
  1741*    -------------------------------
  1742     05  BSUFX2L PIC S9(0004) COMP.
  1743     05  BSUFX2F PIC  X(0001).
  1744     05  FILLER REDEFINES BSUFX2F.
  1745         10  BSUFX2A PIC  X(0001).
  1746     05  BSUFX2I PIC  X(0001).
  1747*    -------------------------------
  1748     05  BCERT3L PIC S9(0004) COMP.
  1749     05  BCERT3F PIC  X(0001).
  1750     05  FILLER REDEFINES BCERT3F.
  1751         10  BCERT3A PIC  X(0001).
  1752     05  BCERT3I PIC  X(0010).
  1753*    -------------------------------
  1754     05  BSUFX3L PIC S9(0004) COMP.
  1755     05  BSUFX3F PIC  X(0001).
  1756     05  FILLER REDEFINES BSUFX3F.
  1757         10  BSUFX3A PIC  X(0001).
  1758     05  BSUFX3I PIC  X(0001).
  1759*    -------------------------------
  1760     05  BCERT4L PIC S9(0004) COMP.
  1761     05  BCERT4F PIC  X(0001).
  1762     05  FILLER REDEFINES BCERT4F.
  1763         10  BCERT4A PIC  X(0001).
  1764     05  BCERT4I PIC  X(0010).
  1765*    -------------------------------
  1766     05  BSUFX4L PIC S9(0004) COMP.
  1767     05  BSUFX4F PIC  X(0001).
  1768     05  FILLER REDEFINES BSUFX4F.
  1769         10  BSUFX4A PIC  X(0001).
  1770     05  BSUFX4I PIC  X(0001).
  1771*    -------------------------------
  1772     05  BCERT5L PIC S9(0004) COMP.
  1773     05  BCERT5F PIC  X(0001).
  1774     05  FILLER REDEFINES BCERT5F.
  1775         10  BCERT5A PIC  X(0001).
  1776     05  BCERT5I PIC  X(0010).
  1777*    -------------------------------
  1778     05  BSUFX5L PIC S9(0004) COMP.
  1779     05  BSUFX5F PIC  X(0001).
  1780     05  FILLER REDEFINES BSUFX5F.
  1781         10  BSUFX5A PIC  X(0001).
  1782     05  BSUFX5I PIC  X(0001).
  1783*    -------------------------------
  1784     05  ENTERPFL PIC S9(0004) COMP.
  1785     05  ENTERPFF PIC  X(0001).
  1786     05  FILLER REDEFINES ENTERPFF.
  1787         10  ENTERPFA PIC  X(0001).
  1788     05  ENTERPFI PIC  99.
  1789*    -------------------------------
  1790     05  PF5L PIC S9(0004) COMP.
  1791     05  PF5F PIC  X(0001).
  1792     05  FILLER REDEFINES PF5F.
  1793         10  PF5A PIC  X(0001).
  1794     05  PF5I PIC  X(0013).
  1795 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  34
* EL130.cbl
  1796     05  FILLER            PIC  X(0012).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  RUNDTEO PIC  X(0008).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  RUNTIMEO PIC  99.99.
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  COMPO PIC  X(0003).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  SEQUO PIC  X(0010).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  MAINTO PIC  X(0001).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  CLMNOO PIC  X(0007).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  CLMCARRO PIC  X(0001).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  CLMTYPEO PIC  X(0001).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CERTNOO PIC  X(0010).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  SUFXO PIC  X(0001).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  PCERTNOO PIC  X(0010).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  PSUFXO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  INCURO PIC  X(0008).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  REPORTO PIC  X(0008).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  ICD1O PIC  X(0008).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  ICD2O PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  DIAGO PIC  X(0060).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  BENECDO PIC  X(0010).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  35
* EL130.cbl
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  SSNO PIC  X(0011).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  SEXO PIC  X(0001).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  INSTYPEO PIC  X(0001).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  LSTNMEO PIC  X(0015).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  FSTNMEO PIC  X(0012).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  INITO PIC  X(0001).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  LOANNOO PIC  X(0008).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  CRTLNMEO PIC  X(0015).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  CRTFNMEO PIC  X(0012).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  CRTINITO PIC  X(0001).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  LOANBALO PIC  ZZZZZ9.99.
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  MANRSVO PIC  Z(5)9.99.
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  SUPVO PIC  X(0001).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  PRICDO PIC  X(0001).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  PRODO PIC  X(0008).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PRODCDO PIC  X(0001).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  FILETOO PIC  X(0004).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  PROCCDO PIC  X(0004).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  RELCLMO PIC  X(0007).
  1911*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  36
* EL130.cbl
  1912     05  FILLER            PIC  X(0003).
  1913     05  PRTOPTO PIC  X(0001).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  ALTPRTO PIC  X(0004).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  CERTMTO PIC  X(0001).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  CRTCARRO PIC  X(0001).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  GROUPO PIC  X(0006).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  STATEO PIC  X(0002).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ACCOUNTO PIC  X(0010).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  EFFDTO PIC  X(0008).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  CRTSSNO PIC  X(0011).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  MEMCAPO PIC  X(0010).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  MEMBERO PIC  X(0012).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  REINCDO PIC  X(0001).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  ISSAGEO PIC  X(0002).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  APRO PIC  9(3).9(4).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  PMTFREQO PIC  99.
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  INDGRPO PIC  X(0001).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  PREMTYPO PIC  X(0001).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  ADDONDTO PIC  X(0008).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  JNTLNMEO PIC  X(0015).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  37
* EL130.cbl
  1970     05  JNTFNMEO PIC  X(0002).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  JNTINITO PIC  X(0001).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  JNTAGEO PIC  X(0002).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  LCVDSCRO PIC  X(0006).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  LCVKINDO PIC  X(0003).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  LCVCDO PIC  X(0002).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  LCVOTRMO PIC  999.
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  LCVRTRMO PIC  ZZZ.
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  LCVRATEO PIC  ZZZ.ZZ.
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LCVFORMO PIC  X(0012).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  LCVCNDTO PIC  X(0008).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  LCVEXITO PIC  X(0008).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  LCVSTATO PIC  X(0006).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  ACVDSCRO PIC  X(0006).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  ACVKINDO PIC  X(0003).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  ACVCDO PIC  X(0002).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  ACVOTRMO PIC  999.
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  ACVRTRMO PIC  ZZZ.
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  38
* EL130.cbl
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  ACVFORMO PIC  X(0012).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  ACVCNDTO PIC  X(0008).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ACVEXITO PIC  X(0008).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  ACVSTATO PIC  X(0006).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  ERRMSG1O PIC  X(0072).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  ERRMSG2O PIC  X(0072).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  BCERT1O PIC  X(0010).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  BSUFX1O PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  BCERT2O PIC  X(0010).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  BSUFX2O PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  BCERT3O PIC  X(0010).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BSUFX3O PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  BCERT4O PIC  X(0010).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BSUFX4O PIC  X(0001).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BCERT5O PIC  X(0010).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BSUFX5O PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  ENTERPFO PIC  X(0002).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  PF5O PIC  X(0013).
  2085*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  39
* EL130.cbl
  2087*    COPY ELCDATE.
  2088******************************************************************
  2089*                                                                *
  2090*                                                                *
  2091*                            ELCDATE.                            *
  2092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2093*                            VMOD=2.003
  2094*                                                                *
  2095*                                                                *
  2096*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2097*                 LENGTH = 200                                   *
  2098******************************************************************
  2099
  2100 01  DATE-CONVERSION-DATA.
  2101     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2102     12  DC-OPTION-CODE                PIC X.
  2103         88  BIN-TO-GREG                VALUE ' '.
  2104         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2105         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2106         88  YMD-GREG-TO-BIN            VALUE '3'.
  2107         88  MDY-GREG-TO-BIN            VALUE '4'.
  2108         88  JULIAN-TO-BIN              VALUE '5'.
  2109         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2110         88  FIND-CENTURY               VALUE '7'.
  2111         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2112         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2113         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2114         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2115         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2116         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2117         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2118         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2119         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2120         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2121         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2122         88  BIN-3-TO-GREG              VALUE 'I'.
  2123         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2124         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2125         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2126         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2127         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2128         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2129         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2130         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2131         88  THREE-CHARACTER-BIN
  2132                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2133         88  GREGORIAN-TO-BIN
  2134                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2135         88  BIN-TO-GREGORIAN
  2136                  VALUES ' ' '1' 'I' '8' 'G'.
  2137         88  JULIAN-TO-BINARY
  2138                  VALUES '5' 'C' 'E' 'F'.
  2139     12  DC-ERROR-CODE                 PIC X.
  2140         88  NO-CONVERSION-ERROR        VALUE ' '.
  2141         88  DATE-CONVERSION-ERROR
  2142                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2143         88  DATE-IS-ZERO               VALUE '1'.
  2144         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  40
* EL130.cbl
  2145         88  DATE-IS-INVALID            VALUE '3'.
  2146         88  DATE1-GREATER-DATE2        VALUE '4'.
  2147         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2148         88  DATE-INVALID-OPTION        VALUE '9'.
  2149         88  INVALID-CENTURY            VALUE 'A'.
  2150         88  ONLY-CENTURY               VALUE 'B'.
  2151         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2152         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2153     12  DC-END-OF-MONTH               PIC X.
  2154         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2155     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2156         88  USE-NORMAL-PROCESS         VALUE ' '.
  2157         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2158         88  ADJUST-UP-100-YRS          VALUE '2'.
  2159     12  FILLER                        PIC X.
  2160     12  DC-CONVERSION-DATES.
  2161         16  DC-BIN-DATE-1             PIC XX.
  2162         16  DC-BIN-DATE-2             PIC XX.
  2163         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2164         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2165                       DC-GREG-DATE-1-EDIT.
  2166             20  DC-EDIT1-MONTH        PIC 99.
  2167             20  SLASH1-1              PIC X.
  2168             20  DC-EDIT1-DAY          PIC 99.
  2169             20  SLASH1-2              PIC X.
  2170             20  DC-EDIT1-YEAR         PIC 99.
  2171         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2172         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2173                     DC-GREG-DATE-2-EDIT.
  2174             20  DC-EDIT2-MONTH        PIC 99.
  2175             20  SLASH2-1              PIC X.
  2176             20  DC-EDIT2-DAY          PIC 99.
  2177             20  SLASH2-2              PIC X.
  2178             20  DC-EDIT2-YEAR         PIC 99.
  2179         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2180         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2181                     DC-GREG-DATE-1-YMD.
  2182             20  DC-YMD-YEAR           PIC 99.
  2183             20  DC-YMD-MONTH          PIC 99.
  2184             20  DC-YMD-DAY            PIC 99.
  2185         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2186         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2187                      DC-GREG-DATE-1-MDY.
  2188             20  DC-MDY-MONTH          PIC 99.
  2189             20  DC-MDY-DAY            PIC 99.
  2190             20  DC-MDY-YEAR           PIC 99.
  2191         16  DC-GREG-DATE-1-ALPHA.
  2192             20  DC-ALPHA-MONTH        PIC X(10).
  2193             20  DC-ALPHA-DAY          PIC 99.
  2194             20  FILLER                PIC XX.
  2195             20  DC-ALPHA-CENTURY.
  2196                 24 DC-ALPHA-CEN-N     PIC 99.
  2197             20  DC-ALPHA-YEAR         PIC 99.
  2198         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2199         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2200         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2201         16  DC-JULIAN-DATE            PIC 9(05).
  2202         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  41
* EL130.cbl
  2203                                       PIC 9(05).
  2204         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2205             20  DC-JULIAN-YEAR        PIC 99.
  2206             20  DC-JULIAN-DAYS        PIC 999.
  2207         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2208         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2209         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2210     12  DATE-CONVERSION-VARIBLES.
  2211         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2212         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2213             20  FILLER                PIC 9(3).
  2214             20  HOLD-CEN-1-CCYY.
  2215                 24  HOLD-CEN-1-CC     PIC 99.
  2216                 24  HOLD-CEN-1-YY     PIC 99.
  2217             20  HOLD-CEN-1-MO         PIC 99.
  2218             20  HOLD-CEN-1-DA         PIC 99.
  2219         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2220             20  HOLD-CEN-1-R-MO       PIC 99.
  2221             20  HOLD-CEN-1-R-DA       PIC 99.
  2222             20  HOLD-CEN-1-R-CCYY.
  2223                 24  HOLD-CEN-1-R-CC   PIC 99.
  2224                 24  HOLD-CEN-1-R-YY   PIC 99.
  2225             20  FILLER                PIC 9(3).
  2226         16  HOLD-CENTURY-1-X.
  2227             20  FILLER                PIC X(3)  VALUE SPACES.
  2228             20  HOLD-CEN-1-X-CCYY.
  2229                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2230                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2231             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2232             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2233         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2234             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2235             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2236             20  HOLD-CEN-1-R-X-CCYY.
  2237                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2238                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2239             20  FILLER                PIC XXX.
  2240         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2241         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2242         16  DC-JULIAN-DATE-1          PIC 9(07).
  2243         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2244             20  DC-JULIAN-1-CCYY.
  2245                 24  DC-JULIAN-1-CC    PIC 99.
  2246                 24  DC-JULIAN-1-YR    PIC 99.
  2247             20  DC-JULIAN-DA-1        PIC 999.
  2248         16  DC-JULIAN-DATE-2          PIC 9(07).
  2249         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2250             20  DC-JULIAN-2-CCYY.
  2251                 24  DC-JULIAN-2-CC    PIC 99.
  2252                 24  DC-JULIAN-2-YR    PIC 99.
  2253             20  DC-JULIAN-DA-2        PIC 999.
  2254         16  DC-GREG-DATE-A-EDIT.
  2255             20  DC-EDITA-MONTH        PIC 99.
  2256             20  SLASHA-1              PIC X VALUE '/'.
  2257             20  DC-EDITA-DAY          PIC 99.
  2258             20  SLASHA-2              PIC X VALUE '/'.
  2259             20  DC-EDITA-CCYY.
  2260                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  42
* EL130.cbl
  2261                 24  DC-EDITA-YEAR     PIC 99.
  2262         16  DC-GREG-DATE-B-EDIT.
  2263             20  DC-EDITB-MONTH        PIC 99.
  2264             20  SLASHB-1              PIC X VALUE '/'.
  2265             20  DC-EDITB-DAY          PIC 99.
  2266             20  SLASHB-2              PIC X VALUE '/'.
  2267             20  DC-EDITB-CCYY.
  2268                 24  DC-EDITB-CENT     PIC 99.
  2269                 24  DC-EDITB-YEAR     PIC 99.
  2270         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2271         16  DC-GREG-DATE-CYMD-R REDEFINES
  2272                              DC-GREG-DATE-CYMD.
  2273             20  DC-CYMD-CEN           PIC 99.
  2274             20  DC-CYMD-YEAR          PIC 99.
  2275             20  DC-CYMD-MONTH         PIC 99.
  2276             20  DC-CYMD-DAY           PIC 99.
  2277         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2278         16  DC-GREG-DATE-MDCY-R REDEFINES
  2279                              DC-GREG-DATE-MDCY.
  2280             20  DC-MDCY-MONTH         PIC 99.
  2281             20  DC-MDCY-DAY           PIC 99.
  2282             20  DC-MDCY-CEN           PIC 99.
  2283             20  DC-MDCY-YEAR          PIC 99.
  2284    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2285        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2286    12  DC-EL310-DATE                  PIC X(21).
  2287    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  43
* EL130.cbl
  2289*    COPY ELCCALC.
  2290******************************************************************
  2291*                                                                *
  2292*                           ELCCALC.                            *
  2293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2294*                            VMOD=2.025                          *
  2295*                                                                *
  2296*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2297*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2298*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2299*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2300*                                                                *
  2301*  PASSED TO ELRTRM                                              *
  2302*  -----------------                                             *
  2303*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2304*  ORIGINAL TERM                                                 *
  2305*  BEGINNING DATE                                                *
  2306*  ENDING DATE                                                   *
  2307*  COMPANY I.D.                                                  *
  2308*  ACCOUNT MASTER USER FIELD                                     *
  2309*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2310*  FREE LOOK DAYS                                                *
  2311*                                                                *
  2312*  RETURNED FROM ELRTRM                                          *
  2313*  ---------------------                                         *
  2314*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2315*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2316*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2317*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2318*----------------------------------------------------------------*
  2319*  PASSED TO ELRAMT                                              *
  2320*  ----------------                                              *
  2321*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2322*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2323*  ORIGINAL AMOUNT                                               *
  2324*  ALTERNATE BENEFIT (BALLON)                                    *
  2325*  A.P.R. - NET PAY ONLY                                         *
  2326*  METHOD
  2327*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2328*  COMPANY I.D.                                                  *
  2329*  BENEFIT TYPE                                                  *
  2330*                                                                *
  2331*  RETURNED FROM ELRAMT                                          *
  2332*  --------------------                                          *
  2333*  REMAINING AMOUNT 1 - CURRENT                                  *
  2334*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2335*  REMAINING AMOUNT FACTOR
  2336*----------------------------------------------------------------*
  2337*  PASSED TO ELRESV                                              *
  2338*  -----------------                                             *
  2339*  CERTIFICATE EFFECTIVE DATE                                    *
  2340*  VALUATION DATE                                                *
  2341*  PAID THRU DATE                                                *
  2342*  BENEFIT                                                       *
  2343*  INCURRED DATE                                                 *
  2344*  REPORTED DATE                                                 *
  2345*  ISSUE AGE                                                     *
  2346*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  44
* EL130.cbl
  2347*  CDT PERCENT                                                   *
  2348*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2349* *CLAIM TYPE (LIFE, A/H)                                        *
  2350* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2351* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2352*                                                                *
  2353*  RETURNED FROM ELRESV                                          *
  2354*  --------------------                                          *
  2355*  CDT TABLE USED                                                *
  2356*  CDT FACTOR USED                                               *
  2357*  PAY TO CURRENT RESERVE                                        *
  2358*  I.B.N.R. - A/H ONLY                                           *
  2359*  FUTURE (ACCRUED) AH ONLY                                      *
  2360*----------------------------------------------------------------*
  2361*  PASSED TO ELRATE                                              *
  2362*  ----------------                                              *
  2363*  CERT ISSUE DATE                                               *
  2364*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2365*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2366*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2367*  STATE CODE (CLIENT DEFINED)                                   *
  2368*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2369*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2370*  DEVIATION CODE                                                *
  2371*  ISSUE AGE                                                     *
  2372*  ORIGINAL BENEFIT AMOUNT                                       *
  2373*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2374*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2375*  BENEFIT KIND (LIFE OR A/H)                                    *
  2376*  A.P.R.                                                        *
  2377*  METHOD
  2378*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2379*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2380*  COMPANY I.D. (3 CHARACTER)                                    *
  2381*  BENEFIT CODE                                                  *
  2382*  BENEFIT OVERRIDE CODE                                         *
  2383*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2384*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2385*  JOINT INDICATOR (CSL ONLY)                                    *
  2386*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2387*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2388*                                                                *
  2389*  RETURNED FROM ELRATE                                          *
  2390*  --------------------                                          *
  2391*  CALCULATED PREMIUM                                            *
  2392*  PREMIUM RATE                                                  *
  2393*  MORTALITY CODE                                                *
  2394*  MAX ATTAINED AGE                                              *
  2395*  MAX AGE                                                       *
  2396*  MAX TERM                                                      *
  2397*  MAX MONTHLY BENEFIT                                           *
  2398*  MAX TOTAL BENIFIT                                             *
  2399*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2400*----------------------------------------------------------------*
  2401*  PASSED TO ELRFND                                              *
  2402*  ----------------                                              *
  2403*  CERT ISSUE DATE                                               *
  2404*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  45
* EL130.cbl
  2405*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2406*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2407*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2408*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2409*  STATE CODE (CLIENT DEFINED)                                   *
  2410*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2411*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2412*  DEVIATION CODE                                                *
  2413*  ISSUE AGE                                                     *
  2414*  ORIGINAL BENEFIT AMOUNT                                       *
  2415*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2416*  PROCESS TYPE (CANCEL)                                         *
  2417*  BENEFIT KIND (LIFE OR A/H)                                    *
  2418*  A.P.R.                                                        *
  2419*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2420*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2421*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2422*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2423*  COMPANY I.D. (3 CHARACTER)                                    *
  2424*  BENEFIT CODE                                                  *
  2425*  BENEFIT OVERRIDE CODE                                         *
  2426*                                                                *
  2427*  RETURNED FROM ELRFND                                          *
  2428*  --------------------                                          *
  2429*  CALCULATED REFUND                                             *
  2430*----------------------------------------------------------------*
  2431*  PASSED TO ELEARN                                              *
  2432*  ----------------                                              *
  2433*  CERT ISSUE DATE                                               *
  2434*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2435*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2436*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2437*  STATE CODE (CLIENT DEFINED)                                   *
  2438*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2439*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2440*  DEVIATION CODE                                                *
  2441*  ISSUE AGE                                                     *
  2442*  ORIGINAL BENEFIT AMOUNT                                       *
  2443*  BENEFIT KIND (LIFE OR A/H)                                    *
  2444*  A.P.R.                                                        *
  2445*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2446*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2447*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2448*  COMPANY I.D. (3 CHARACTER)                                    *
  2449*  BENEFIT CODE                                                  *
  2450*  BENEFIT OVERRIDE CODE                                         *
  2451*                                                                *
  2452*  RETURNED FROM ELEARN                                          *
  2453*  --------------------                                          *
  2454*  INDICATED  EARNINGS                                           *
  2455*----------------------------------------------------------------*
  2456*                 LENGTH = 450                                   *
  2457*                                                                *
  2458******************************************************************
  2459******************************************************************
  2460*                   C H A N G E   L O G
  2461*
  2462* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  46
* EL130.cbl
  2463*-----------------------------------------------------------------
  2464*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2465* EFFECTIVE    NUMBER
  2466*-----------------------------------------------------------------
  2467* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2468* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2469* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2470* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2471* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2472* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2473* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2474* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2475* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2476******************************************************************
  2477
  2478 01  CALCULATION-PASS-AREA.
  2479     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2480                                     COMP.
  2481
  2482     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2483       88  NO-CP-ERROR                             VALUE ZERO.
  2484       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2485                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2486       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2487       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2488       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2489       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2490       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2491       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2492       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2493       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2494       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2495       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2496       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2497       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2498       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2499       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2500       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2501       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2502       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2503
  2504     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2505       88  NO-CP-ERROR-2                           VALUE ZERO.
  2506***********************  INPUT AREAS ****************************
  2507
  2508     12  CP-CALCULATION-AREA.
  2509         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2510         16  CP-CERT-EFF-DT        PIC XX.
  2511         16  CP-VALUATION-DT       PIC XX.
  2512         16  CP-PAID-THRU-DT       PIC XX.
  2513         16  CP-BENEFIT-TYPE       PIC X.
  2514           88  CP-AH                               VALUE 'A' 'D'
  2515                                                   'I' 'U'.
  2516           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2517           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2518         16  CP-INCURRED-DT        PIC XX.
  2519         16  CP-REPORTED-DT        PIC XX.
  2520         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  47
* EL130.cbl
  2521         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2522         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2523                                     COMP-3.
  2524         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2525                                     COMP-3.
  2526         16  CP-CDT-METHOD         PIC X.
  2527           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2528           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2529           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2530         16  CP-CLAIM-TYPE         PIC X.
  2531           88  CP-AH-CLAIM                         VALUE 'A'.
  2532           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2533         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2534                                     COMP-3.
  2535         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2536                                     COMP-3.
  2537         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2538                                     COMP-3.
  2539         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2540                                     COMP-3.
  2541         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2542                                     COMP-3.
  2543         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-REM-TERM-METHOD    PIC X.
  2548           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2549           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2550           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2551           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2552           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2553           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2554           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2555         16  CP-EARNING-METHOD     PIC X.
  2556           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2557           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2558           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2559           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2560           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2561           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2562           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2563           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2564           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2565           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2566           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2567           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2568           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2569           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2570         16  CP-PROCESS-TYPE       PIC X.
  2571           88  CP-CLAIM                            VALUE '1'.
  2572           88  CP-CANCEL                           VALUE '2'.
  2573           88  CP-ISSUE                            VALUE '3'.
  2574         16  CP-SPECIAL-CALC-CD    PIC X.
  2575           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2576           88  CP-1-MTH-INTEREST               VALUE ' '.
  2577           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2578           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  48
* EL130.cbl
  2579           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2580           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2581           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2582           88  CP-FARM-PLAN                    VALUE 'F'.
  2583           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2584           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2585           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2586           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2587           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2588           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2589           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2590           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2591           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2592           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2593                                                     'W' 'X'.
  2594           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2595           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2596           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2597           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2598           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2599           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2600           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2601           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2602           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2603           88  CP-CSL-METH-1                   VALUE '5'.
  2604           88  CP-CSL-METH-2                   VALUE '6'.
  2605           88  CP-CSL-METH-3                   VALUE '7'.
  2606           88  CP-CSL-METH-4                   VALUE '8'.
  2607
  2608         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2609                                     COMP-3.
  2610         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2611         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2612         16  CP-STATE              PIC XX          VALUE SPACE.
  2613         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2614         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2615           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2616               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2617         16  CP-R78-OPTION         PIC X.
  2618           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2619           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2620
  2621         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2622         16  CP-IBNR-RESERVE-SW    PIC X.
  2623         16  CP-CLAIM-STATUS       PIC X.
  2624         16  CP-RATE-FILE          PIC X.
  2625         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2626                                     COMP-3.
  2627
  2628         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2629         16  CP-AH-OVERRIDE-CODE   PIC X.
  2630
  2631         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2632                                     COMP-3.
  2633         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2634                                   PIC S9(5)V99 COMP-3.
  2635         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2636                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  49
* EL130.cbl
  2637         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2640                                     COMP-3.
  2641         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2642                                  PIC S9(7)V99 COMP-3.
  2643
  2644         16  CP-PAID-FROM-DATE     PIC X(02).
  2645         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2646         16  CP-EXT-DAYS-CALC      PIC X.
  2647           88  CP-EXT-NO-CHG                   VALUE ' '.
  2648           88  CP-EXT-CHG-LF                   VALUE '1'.
  2649           88  CP-EXT-CHG-AH                   VALUE '2'.
  2650           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2651         16  CP-DOMICILE-STATE     PIC XX.
  2652         16  CP-CARRIER            PIC X.
  2653         16  CP-REIN-FLAG          PIC X.
  2654         16  CP-REM-TRM-CALC-OPTION PIC X.
  2655           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2656                      '2' '3' '4' '5'.
  2657           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2658           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2659           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2660           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2661           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2662           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2663           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2664           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2665         16  CP-SIG-SWITCH         PIC X.
  2666         16  CP-RATING-METHOD      PIC X.
  2667           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2668           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2669           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2670           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2671           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2672           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2673           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2674           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2675           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2676         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2677                                     COMP-3.
  2678         16  CP-BEN-CATEGORY       PIC X.
  2679         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2680         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2681                                   PIC S99V9(5) COMP-3.
  2682         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2683         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2684                                   PIC S99V9(5) COMP-3.
  2685         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2686         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2687         16  CP-EXPIRE-DT          PIC XX.
  2688         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2689         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2690         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2691         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2692         16  CP-DDF-SPEC-CALC      PIC X.
  2693             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2694             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  50
* EL130.cbl
  2695         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2696         16  CP-CANCEL-REASON      PIC X.
  2697         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2698         16  CP-PMT-MODE           PIC X.
  2699         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2700         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2701         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2702         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2703         16  FILLER                PIC X.
  2704
  2705***************    OUTPUT FROM ELRESV   ************************
  2706
  2707         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2708
  2709         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2716                                     COMP-3.
  2717         16  FILLER                PIC X(09).
  2718***************    OUTPUT FROM ELRTRM   *************************
  2719
  2720         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2725                                     COMP-3.
  2726         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2727                                     COMP-3.
  2728         16  FILLER                PIC X(12).
  2729
  2730***************    OUTPUT FROM ELRAMT   *************************
  2731
  2732         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2735                                     COMP-3.
  2736         16  FILLER                PIC X(12).
  2737
  2738***************    OUTPUT FROM ELRATE   *************************
  2739
  2740         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2743                                     COMP-3.
  2744         16  CP-MORTALITY-CODE     PIC X(4).
  2745         16  CP-RATE-EDIT-FLAG     PIC X.
  2746             88  CP-RATES-NEED-APR                  VALUE '1'.
  2747         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2750         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2751         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2752                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  51
* EL130.cbl
  2753         16  FILLER                PIC X(07).
  2754
  2755***************    OUTPUT FROM ELRFND   *************************
  2756
  2757         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2758                                     COMP-3.
  2759         16  CP-REFUND-TYPE-USED   PIC X.
  2760           88  CP-R-AS-R78                         VALUE '1'.
  2761           88  CP-R-AS-PRORATA                     VALUE '2'.
  2762           88  CP-R-AS-CALIF                       VALUE '3'.
  2763           88  CP-R-AS-TEXAS                       VALUE '4'.
  2764           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2765           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2766           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2767           88  CP-R-AS-MEAN                        VALUE '8'.
  2768           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2769           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2770           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2771           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2772           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2773           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2774         16  FILLER                PIC X(12).
  2775
  2776***************    OUTPUT FROM ELEARN   *************************
  2777
  2778         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2781                                     COMP-3.
  2782         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-EARNING-TYPE-USED  PIC X.
  2791           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2792           88  CP-E-AS-R78                         VALUE '1'.
  2793           88  CP-E-AS-PRORATA                     VALUE '2'.
  2794           88  CP-E-AS-TEXAS                       VALUE '4'.
  2795           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2796           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2797           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2798           88  CP-E-AS-MEAN                        VALUE '8'.
  2799           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2800         16  FILLER                PIC X(12).
  2801
  2802***************    OUTPUT FROM ELPMNT   *************************
  2803
  2804         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2805                                     COMP-3.
  2806         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2807                                     COMP-3.
  2808         16  FILLER                PIC X(12).
  2809
  2810***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  52
* EL130.cbl
  2811         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2824             88  OPEN-RATE-FILE                   VALUE 'O'.
  2825             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2826             88  IO-ERROR                         VALUE 'E'.
  2827
  2828         16  CP-FIRST-PAY-DATE     PIC XX.
  2829
  2830         16  CP-JOINT-INDICATOR    PIC X.
  2831
  2832         16  CP-RESERVE-REMAINING-TERM
  2833                                   PIC S9(4)V9    VALUE ZERO
  2834                                     COMP-3.
  2835
  2836         16  CP-INSURED-BIRTH-DT   PIC XX.
  2837
  2838         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2839                                     COMP-3.
  2840
  2841         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2842                                     COMP-3.
  2843
  2844         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2845                                     COMP-3.
  2846
  2847         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2848                                     COMP-3.
  2849
  2850         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2851                                     COMP-3.
  2852
  2853         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2854                                     COMP-3.
  2855
  2856         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2857                                     COMP-3.
  2858
  2859         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2860             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2861
  2862         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2863                                     COMP-3.
  2864         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2865                                     COMP-3.
  2866         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2867         16  FILLER                PIC X(15).
  2868******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  53
* EL130.cbl
  2870*    COPY ELCLOGOF.
  2871******************************************************************
  2872*                                                                *
  2873*                                                                *
  2874*                            ELCLOGOF.                           *
  2875*                            VMOD=2.001                          *
  2876*                                                                *
  2877*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2878*                                                                *
  2879******************************************************************
  2880 01  CLASIC-LOGOFF.
  2881     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2882     12  LOGOFF-TEXT.
  2883         16  FILLER          PIC X(5)    VALUE SPACES.
  2884         16  LOGOFF-MSG.
  2885             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2886             20  FILLER      PIC X       VALUE SPACES.
  2887             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2888         16  FILLER          PIC X(80)
  2889           VALUE '* YOU ARE NOW LOGGED OFF'.
  2890         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2891         16  FILLER          PIC X       VALUE QUOTE.
  2892         16  LOGOFF-SYS-MSG  PIC X(17)
  2893           VALUE 'S CLAS-IC SYSTEM '.
  2894     12  TEXT-MESSAGES.
  2895         16  UNACCESS-MSG    PIC X(29)
  2896             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2897         16  PGMIDERR-MSG    PIC X(17)
  2898             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  54
* EL130.cbl
  2900*    COPY ELCATTR.
  2901******************************************************************
  2902*                                                                *
  2903*                            ELCATTR.                            *
  2904*                            VMOD=2.001                          *
  2905*                                                                *
  2906*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2907*                                                                *
  2908*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2909*                                                                *
  2910*                   POS 1   P=PROTECTED                          *
  2911*                           U=UNPROTECTED                        *
  2912*                           S=ASKIP                              *
  2913*                   POS 2   A=ALPHA/NUMERIC                      *
  2914*                           N=NUMERIC                            *
  2915*                   POS 3   N=NORMAL                             *
  2916*                           B=BRIGHT                             *
  2917*                           D=DARK                               *
  2918*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2919*                           OF=MODIFIED DATA TAG OFF             *
  2920*                                                                *
  2921*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2922******************************************************************
  2923 01  ATTRIBUTE-LIST.
  2924     12  AL-PABOF            PIC X       VALUE 'Y'.
  2925     12  AL-PABON            PIC X       VALUE 'Z'.
  2926     12  AL-PADOF            PIC X       VALUE '%'.
  2927     12  AL-PADON            PIC X       VALUE '_'.
  2928     12  AL-PANOF            PIC X       VALUE '-'.
  2929     12  AL-PANON            PIC X       VALUE '/'.
  2930     12  AL-SABOF            PIC X       VALUE '8'.
  2931     12  AL-SABON            PIC X       VALUE '9'.
  2932     12  AL-SADOF            PIC X       VALUE '@'.
  2933     12  AL-SADON            PIC X       VALUE QUOTE.
  2934     12  AL-SANOF            PIC X       VALUE '0'.
  2935     12  AL-SANON            PIC X       VALUE '1'.
  2936     12  AL-UABOF            PIC X       VALUE 'H'.
  2937     12  AL-UABON            PIC X       VALUE 'I'.
  2938     12  AL-UADOF            PIC X       VALUE '<'.
  2939     12  AL-UADON            PIC X       VALUE '('.
  2940     12  AL-UANOF            PIC X       VALUE ' '.
  2941     12  AL-UANON            PIC X       VALUE 'A'.
  2942     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2943     12  AL-UNBON            PIC X       VALUE 'R'.
  2944     12  AL-UNDOF            PIC X       VALUE '*'.
  2945     12  AL-UNDON            PIC X       VALUE ')'.
  2946     12  AL-UNNOF            PIC X       VALUE '&'.
  2947     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  55
* EL130.cbl
  2949*    COPY ELCEMIB.
  2950******************************************************************
  2951*                                                                *
  2952*                                                                *
  2953*                            ELCEMIB.                            *
  2954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2955*                            VMOD=2.005                          *
  2956*                                                                *
  2957*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2958*                                                                *
  2959******************************************************************
  2960 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2961     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2962     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2963     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2964     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2965     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2966     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2967     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2968     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2969     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2970         88  EMI-NO-ERRORS                    VALUE '1'.
  2971         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2972         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2973     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2974         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2975     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2976         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2977         88  EMI-AREA1-FULL                   VALUE '2'.
  2978     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2979         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2980         88  EMI-AREA2-FULL                   VALUE '2'.
  2981     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2982         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2983         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2984         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2985         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2986         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2987     12  EMI-ERROR-LINES.
  2988         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2989         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2990         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2991         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2992             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2993                 24  EMI-ERR-NUM         PIC X(4).
  2994                 24  EMI-FILLER          PIC X.
  2995                 24  EMI-SEV             PIC X.
  2996                 24  FILLER              PIC X.
  2997             20  FILLER                  PIC X(02).
  2998     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2999         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3000             20  EMI-ERROR-NUMBER    PIC X(4).
  3001             20  EMI-FILL            PIC X.
  3002             20  EMI-SEVERITY        PIC X.
  3003             20  FILLER              PIC X.
  3004             20  EMI-ERROR-TEXT.
  3005                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3006                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  56
* EL130.cbl
  3007     12  EMI-SEVERITY-SAVE           PIC X.
  3008         88  EMI-NOTE                    VALUE 'N'.
  3009         88  EMI-WARNING                 VALUE 'W'.
  3010         88  EMI-FORCABLE                VALUE 'F'.
  3011         88  EMI-FATAL                   VALUE 'X'.
  3012     12  EMI-MESSAGE-FLAG            PIC X.
  3013         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3014         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3015     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3016     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3017         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3018         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3019         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3020     12  emi-claim-no                pic x(7).
  3021     12  emi-claim-type              pic x(6).
  3022     12  FILLER                      PIC X(124)  VALUE SPACES.
  3023     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3024     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3025     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3026     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  57
* EL130.cbl
  3028*    COPY ELCJPFX.
  3029******************************************************************
  3030*                                                                *
  3031*                                                                *
  3032*                            ELCJPFX.                            *
  3033*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3034*                            VMOD=2.002                          *
  3035*                                                                *
  3036*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3037*                                                                *
  3038*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3039*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3040*        ELCNTL - CONTROL FILE                                   *
  3041*        ELMSTR - CLAIM MASTERS                                  *
  3042*        ELTRLR - ACTIVITY TRAILERS                              *
  3043*        ELCHKQ - CHECK QUE                                      *
  3044******************************************************************
  3045 01  JOURNAL-RECORD.
  3046     12  jp-date                     pic s9(5) comp-3.
  3047     12  jp-time                     pic s9(7) comp-3.
  3048     12  JP-USER-ID                  PIC X(4).
  3049     12  JP-FILE-ID                  PIC X(8).
  3050     12  JP-PROGRAM-ID               PIC X(8).
  3051     12  JP-RECORD-TYPE              PIC X.
  3052         88 JP-ADD              VALUE 'A'.
  3053         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3054         88 JP-AFTER-CHANGE     VALUE 'C'.
  3055         88 JP-DELETE           VALUE 'D'.
  3056         88 JP-GENERIC-DELETE   VALUE 'G'.
  3057         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3058         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3059     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3060     12  JP-RECORD-AREA
  3061
  3062
  3063         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  58
* EL130.cbl
  3065*    COPY ELCAID.
  3066******************************************************************
  3067*                                                                *
  3068*                            ELCAID.                             *
  3069*                            VMOD=2.001                          *
  3070*                                                                *
  3071*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3072*                                                                *
  3073*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3074*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3075******************************************************************
  3076
  3077 01  DFHAID.
  3078   02  DFHNULL   PIC  X  VALUE  ' '.
  3079   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3080   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3081   02  DFHPEN    PIC  X  VALUE  '='.
  3082   02  DFHOPID   PIC  X  VALUE  'W'.
  3083   02  DFHPA1    PIC  X  VALUE  '%'.
  3084   02  DFHPA2    PIC  X  VALUE  '>'.
  3085   02  DFHPA3    PIC  X  VALUE  ','.
  3086   02  DFHPF1    PIC  X  VALUE  '1'.
  3087   02  DFHPF2    PIC  X  VALUE  '2'.
  3088   02  DFHPF3    PIC  X  VALUE  '3'.
  3089   02  DFHPF4    PIC  X  VALUE  '4'.
  3090   02  DFHPF5    PIC  X  VALUE  '5'.
  3091   02  DFHPF6    PIC  X  VALUE  '6'.
  3092   02  DFHPF7    PIC  X  VALUE  '7'.
  3093   02  DFHPF8    PIC  X  VALUE  '8'.
  3094   02  DFHPF9    PIC  X  VALUE  '9'.
  3095   02  DFHPF10   PIC  X  VALUE  ':'.
  3096   02  DFHPF11   PIC  X  VALUE  '#'.
  3097   02  DFHPF12   PIC  X  VALUE  '@'.
  3098   02  DFHPF13   PIC  X  VALUE  'A'.
  3099   02  DFHPF14   PIC  X  VALUE  'B'.
  3100   02  DFHPF15   PIC  X  VALUE  'C'.
  3101   02  DFHPF16   PIC  X  VALUE  'D'.
  3102   02  DFHPF17   PIC  X  VALUE  'E'.
  3103   02  DFHPF18   PIC  X  VALUE  'F'.
  3104   02  DFHPF19   PIC  X  VALUE  'G'.
  3105   02  DFHPF20   PIC  X  VALUE  'H'.
  3106   02  DFHPF21   PIC  X  VALUE  'I'.
  3107*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3108   02  DFHPF22   PIC  X  VALUE  '['.
  3109   02  DFHPF23   PIC  X  VALUE  '.'.
  3110   02  DFHPF24   PIC  X  VALUE  '<'.
  3111   02  DFHMSRE   PIC  X  VALUE  'X'.
  3112   02  DFHSTRF   PIC  X  VALUE  'h'.
  3113   02  DFHTRIG   PIC  X  VALUE  '"'.
  3114
  3115 01  FILLER    REDEFINES DFHAID.
  3116     12  FILLER              PIC X(8).
  3117     12  PF-VALUES           PIC X       OCCURS 12.
  3118
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  59
* EL130.cbl
  3120****************************************************************
  3121*
  3122* Copyright (c) 2007 by Clerity Solutions, Inc.
  3123* All rights reserved.
  3124*
  3125****************************************************************
  3126 01  DFHEIV.
  3127   02  DFHEIV0               PIC X(35).
  3128   02  DFHEIV1               PIC X(08).
  3129   02  DFHEIV2               PIC X(08).
  3130   02  DFHEIV3               PIC X(08).
  3131   02  DFHEIV4               PIC X(06).
  3132   02  DFHEIV5               PIC X(04).
  3133   02  DFHEIV6               PIC X(04).
  3134   02  DFHEIV7               PIC X(02).
  3135   02  DFHEIV8               PIC X(02).
  3136   02  DFHEIV9               PIC X(01).
  3137   02  DFHEIV10              PIC S9(7) COMP-3.
  3138   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3139   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3140   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3141   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3142   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3143   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3144   02  DFHEIV17              PIC X(04).
  3145   02  DFHEIV18              PIC X(04).
  3146   02  DFHEIV19              PIC X(04).
  3147   02  DFHEIV20              USAGE IS POINTER.
  3148   02  DFHEIV21              USAGE IS POINTER.
  3149   02  DFHEIV22              USAGE IS POINTER.
  3150   02  DFHEIV23              USAGE IS POINTER.
  3151   02  DFHEIV24              USAGE IS POINTER.
  3152   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3153   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3154   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3155   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3156   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3157   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3158   02  FILLER                PIC X(02).
  3159   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3160   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3161   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3162   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3163   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3164 LINKAGE  SECTION.
  3165*****************************************************************
  3166*                                                               *
  3167* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3168* All rights reserved.                                          *
  3169*                                                               *
  3170*****************************************************************
  3171 01  dfheiblk.
  3172     02  eibtime          pic s9(7) comp-3.
  3173     02  eibdate          pic s9(7) comp-3.
  3174     02  eibtrnid         pic x(4).
  3175     02  eibtaskn         pic s9(7) comp-3.
  3176     02  eibtrmid         pic x(4).
  3177     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  60
* EL130.cbl
  3178     02  eibcposn         pic s9(4) comp.
  3179     02  eibcalen         pic s9(4) comp.
  3180     02  eibaid           pic x(1).
  3181     02  eibfiller1       pic x(1).
  3182     02  eibfn            pic x(2).
  3183     02  eibfiller2       pic x(2).
  3184     02  eibrcode         pic x(6).
  3185     02  eibfiller3       pic x(2).
  3186     02  eibds            pic x(8).
  3187     02  eibreqid         pic x(8).
  3188     02  eibrsrce         pic x(8).
  3189     02  eibsync          pic x(1).
  3190     02  eibfree          pic x(1).
  3191     02  eibrecv          pic x(1).
  3192     02  eibsend          pic x(1).
  3193     02  eibatt           pic x(1).
  3194     02  eibeoc           pic x(1).
  3195     02  eibfmh           pic x(1).
  3196     02  eibcompl         pic x(1).
  3197     02  eibsig           pic x(1).
  3198     02  eibconf          pic x(1).
  3199     02  eiberr           pic x(1).
  3200     02  eibrldbk         pic x(1).
  3201     02  eiberrcd         pic x(4).
  3202     02  eibsynrb         pic x(1).
  3203     02  eibnodat         pic x(1).
  3204     02  eibfiller5       pic x(2).
  3205     02  eibresp          pic 9(09) comp.
  3206     02  eibresp2         pic 9(09) comp.
  3207     02  dfheigdj         pic s9(4) comp.
  3208     02  dfheigdk         pic s9(4) comp.
  3209
  3210 01  DFHCOMMAREA             PIC X(1024).
  3211
  3212*01 PARMLIST .
  3213*    02  FILLER              PIC S9(8)   COMP.
  3214*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3215*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3216*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3217*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3218*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3219*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3220*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3221*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3222*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  61
* EL130.cbl
  3224*    COPY ELCMSTR.
  3225******************************************************************
  3226*                                                                *
  3227*                            ELCMSTR.                            *
  3228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3229*                            VMOD=2.012                          *
  3230*                                                                *
  3231*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3232*                                                                *
  3233*   FILE TYPE = VSAM,KSDS                                        *
  3234*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3235*                                                                *
  3236*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3237*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3238*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3239*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3240*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3241*                                                 RKP=75,LEN=21  *
  3242*                                                                *
  3243*   **** NOTE ****                                               *
  3244*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3245*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3246*                                                                *
  3247*   LOG = YES                                                    *
  3248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3249******************************************************************
  3250*                   C H A N G E   L O G
  3251*
  3252* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3253*-----------------------------------------------------------------
  3254*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3255* EFFECTIVE    NUMBER
  3256*-----------------------------------------------------------------
  3257* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3258* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3259* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3260* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3261* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3262******************************************************************
  3263 01  CLAIM-MASTER.
  3264     12  CL-RECORD-ID                PIC XX.
  3265         88  VALID-CL-ID         VALUE 'CL'.
  3266
  3267     12  CL-CONTROL-PRIMARY.
  3268         16  CL-COMPANY-CD           PIC X.
  3269         16  CL-CARRIER              PIC X.
  3270         16  CL-CLAIM-NO             PIC X(7).
  3271         16  CL-CERT-NO.
  3272             20  CL-CERT-PRIME       PIC X(10).
  3273             20  CL-CERT-SFX         PIC X.
  3274
  3275     12  CL-CONTROL-BY-NAME.
  3276         16  CL-COMPANY-CD-A1        PIC X.
  3277         16  CL-INSURED-LAST-NAME    PIC X(15).
  3278         16  CL-INSURED-NAME.
  3279             20  CL-INSURED-1ST-NAME PIC X(12).
  3280             20  CL-INSURED-MID-INIT PIC X.
  3281
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  62
* EL130.cbl
  3282     12  CL-CONTROL-BY-SSN.
  3283         16  CL-COMPANY-CD-A2        PIC X.
  3284         16  CL-SOC-SEC-NO.
  3285             20  CL-SSN-STATE        PIC XX.
  3286             20  CL-SSN-ACCOUNT      PIC X(6).
  3287             20  CL-SSN-LN3          PIC X(3).
  3288
  3289     12  CL-CONTROL-BY-CERT-NO.
  3290         16  CL-COMPANY-CD-A4        PIC X.
  3291         16  CL-CERT-NO-A4.
  3292             20  CL-CERT-A4-PRIME    PIC X(10).
  3293             20  CL-CERT-A4-SFX      PIC X.
  3294
  3295     12  CL-CONTROL-BY-CCN.
  3296         16  CL-COMPANY-CD-A5        PIC X.
  3297         16  CL-CCN-A5.
  3298             20  CL-CCN.
  3299                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3300                 24  CL-CCN-PRIME-A5 PIC X(12).
  3301             20  CL-CCN-FILLER-A5    PIC X(4).
  3302
  3303     12  CL-INSURED-PROFILE-DATA.
  3304         16  CL-INSURED-BIRTH-DT     PIC XX.
  3305         16  CL-INSURED-SEX-CD       PIC X.
  3306             88  INSURED-IS-MALE        VALUE 'M'.
  3307             88  INSURED-IS-FEMALE      VALUE 'F'.
  3308             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3309         16  CL-INSURED-OCC-CD       PIC X(6).
  3310         16  FILLER                  PIC X(5).
  3311
  3312     12  CL-PROCESSING-INFO.
  3313         16  CL-PROCESSOR-ID         PIC X(4).
  3314         16  CL-CLAIM-STATUS         PIC X.
  3315             88  CLAIM-IS-OPEN          VALUE 'O'.
  3316             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3317         16  CL-CLAIM-TYPE           PIC X.
  3318*            88  AH-CLAIM               VALUE 'A'.
  3319*            88  LIFE-CLAIM             VALUE 'L'.
  3320*            88  PROPERTY-CLAIM         VALUE 'P'.
  3321*            88  IUI-CLAIM              VALUE 'I'.
  3322*            88  GAP-CLAIM              VALUE 'G'.
  3323*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3324         16  CL-CLAIM-PREM-TYPE      PIC X.
  3325             88  SINGLE-PREMIUM         VALUE '1'.
  3326             88  O-B-COVERAGE           VALUE '2'.
  3327             88  OPEN-END-COVERAGE      VALUE '3'.
  3328         16  CL-INCURRED-DT          PIC XX.
  3329         16  CL-REPORTED-DT          PIC XX.
  3330         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3331         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3332         16  CL-LAST-PMT-DT          PIC XX.
  3333         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3334         16  CL-PAID-THRU-DT         PIC XX.
  3335         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3336         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3337         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3338         16  CL-PMT-CALC-METHOD      PIC X.
  3339             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  63
* EL130.cbl
  3340             88  CL-365-DAY-YR          VALUE '2'.
  3341             88  CL-FULL-MONTHS         VALUE '3'.
  3342         16  CL-CAUSE-CD             PIC X(6).
  3343
  3344         16  CL-PRIME-CERT-NO.
  3345             20  CL-PRIME-CERT-PRIME PIC X(10).
  3346             20  CL-PRIME-CERT-SFX   PIC X.
  3347
  3348         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3349             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3350             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3351
  3352         16  CL-MICROFILM-NO         PIC X(10).
  3353         16  FILLER REDEFINES CL-MICROFILM-NO.
  3354             20  CL-BENEFIT-PERIOD   PIC 99.
  3355             20  FILLER              PIC X(8).
  3356         16  CL-PROG-FORM-TYPE       PIC X.
  3357         16  CL-LAST-ADD-ON-DT       PIC XX.
  3358
  3359         16  CL-LAST-REOPEN-DT       PIC XX.
  3360         16  CL-LAST-CLOSE-DT        PIC XX.
  3361         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3362             88  FINAL-PAID             VALUE '1'.
  3363             88  CLAIM-DENIED           VALUE '2'.
  3364             88  AUTO-CLOSE             VALUE '3'.
  3365             88  MANUAL-CLOSE           VALUE '4'.
  3366             88  BENEFITS-CHANGED       VALUE 'C'.
  3367             88  SETUP-ERRORS           VALUE 'E'.
  3368         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3369         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3370         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3371             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3372         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3373         16  FILLER                  PIC X.
  3374
  3375     12  CL-CERTIFICATE-DATA.
  3376         16  CL-CERT-ORIGIN          PIC X.
  3377             88  CERT-WAS-ONLINE        VALUE '1'.
  3378             88  CERT-WAS-CREATED       VALUE '2'.
  3379             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3380         16  CL-CERT-KEY-DATA.
  3381             20  CL-CERT-CARRIER     PIC X.
  3382             20  CL-CERT-GROUPING    PIC X(6).
  3383             20  CL-CERT-STATE       PIC XX.
  3384             20  CL-CERT-ACCOUNT.
  3385                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3386                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3387             20  CL-CERT-EFF-DT      PIC XX.
  3388
  3389     12  CL-STATUS-CONTROLS.
  3390         16  CL-PRIORITY-CD          PIC X.
  3391             88  CONFIDENTIAL-DATA      VALUE '8'.
  3392             88  HIGHEST-PRIORITY       VALUE '9'.
  3393         16  CL-SUPV-ATTN-CD         PIC X.
  3394             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3395             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3396         16  CL-PURGED-DT            PIC XX.
  3397         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  64
* EL130.cbl
  3398         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3399         16  CL-NEXT-RESEND-DT       PIC XX.
  3400         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3401         16  CL-CRITICAL-PERIOD      PIC 99.
  3402*        16  FILLER                  PIC XX.
  3403         16  CL-LAST-MAINT-DT        PIC XX.
  3404         16  CL-LAST-MAINT-USER      PIC X(4).
  3405         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3406         16  CL-LAST-MAINT-TYPE      PIC X.
  3407             88  CLAIM-SET-UP           VALUE ' '.
  3408             88  PAYMENT-MADE           VALUE '1'.
  3409             88  LETTER-SENT            VALUE '2'.
  3410             88  MASTER-WAS-ALTERED     VALUE '3'.
  3411             88  MASTER-WAS-RESTORED    VALUE '4'.
  3412             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3413             88  FILE-CONVERTED         VALUE '6'.
  3414             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3415             88  ERROR-CORRECTION       VALUE 'E'.
  3416         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3417         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3418         16  CL-BENEFICIARY          PIC X(10).
  3419         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3420         16  CL-DENIAL-TYPE          PIC X.
  3421             88  CL-TYPE-DENIAL          VALUE '1'.
  3422             88  CL-TYPE-RESCISSION      VALUE '2'.
  3423             88  CL-TYPE-REFORMATION     VALUE '3'.
  3424             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3425             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3426         16  filler                  pic x(5).
  3427*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3428*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3429*        16  CL-RTW-DT               PIC XX.
  3430
  3431     12  CL-TRAILER-CONTROLS.
  3432         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3433             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3434             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3435             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3436         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3437         16  FILLER                  PIC XX.
  3438         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3439         16  CL-ADDRESS-TRAILER-CNT.
  3440             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3441                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3442             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3443                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3444             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3445                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3446             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3447                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3448             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3449                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3450             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3451                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3452             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3453                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3454
  3455     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  65
* EL130.cbl
  3456         16  CL-CV-REFNO-PRIME       PIC X(18).
  3457         16  CL-CV-REFNO-SFX         PIC XX.
  3458
  3459     12  CL-FILE-LOCATION            PIC X(4).
  3460
  3461     12  CL-PROCESS-ERRORS.
  3462         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3463             88  NO-FATAL-ERRORS        VALUE ZERO.
  3464         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3465             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3466
  3467     12  CL-PRODUCT-CD               PIC X.
  3468
  3469     12  CL-CURRENT-KEY-DATA.
  3470         16  CL-CURRENT-CARRIER      PIC X.
  3471         16  CL-CURRENT-GROUPING     PIC X(6).
  3472         16  CL-CURRENT-STATE        PIC XX.
  3473         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3474
  3475     12  CL-ASSOCIATES               PIC X.
  3476         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3477         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3478         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3479         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3480
  3481     12  CL-ACTIVITY-CODE            PIC 99.
  3482     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3483     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3484
  3485     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3486     12  CL-LAG-REPORT-CODE          PIC 9.
  3487     12  CL-LOAN-TYPE                PIC XX.
  3488     12  CL-LEGAL-STATE              PIC XX.
  3489
  3490     12  CL-YESNOSW                  PIC X.
  3491     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3492         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3493         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3494         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3495     12  cl-insured-type             pic x.
  3496         88  cl-claim-on-primary         value 'P'.
  3497         88  cl-claim-on-co-borrower     value 'C'.
  3498     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  66
* EL130.cbl
  3500*    COPY ELCCNTL.
  3501******************************************************************
  3502*                                                                *
  3503*                                                                *
  3504*                            ELCCNTL.                            *
  3505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3506*                            VMOD=2.059                          *
  3507*                                                                *
  3508*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3509*                                                                *
  3510*   FILE TYPE = VSAM,KSDS                                        *
  3511*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3512*                                                                *
  3513*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3514*       ALTERNATE INDEX = NONE                                   *
  3515*                                                                *
  3516*   LOG = YES                                                    *
  3517*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3518******************************************************************
  3519*                   C H A N G E   L O G
  3520*
  3521* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3522*-----------------------------------------------------------------
  3523*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3524* EFFECTIVE    NUMBER
  3525*-----------------------------------------------------------------
  3526* 082503                   PEMA  ADD BENEFIT GROUP
  3527* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3528* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3529* 092705    2005050300006  PEMA  ADD SPP LEASES
  3530* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3531* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3532* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3533* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3534* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3535* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3536* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3537* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3538* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3539* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3540******************************************************************
  3541*
  3542 01  CONTROL-FILE.
  3543     12  CF-RECORD-ID                       PIC XX.
  3544         88  VALID-CF-ID                        VALUE 'CF'.
  3545
  3546     12  CF-CONTROL-PRIMARY.
  3547         16  CF-COMPANY-ID                  PIC XXX.
  3548         16  CF-RECORD-TYPE                 PIC X.
  3549             88  CF-COMPANY-MASTER              VALUE '1'.
  3550             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3551             88  CF-STATE-MASTER                VALUE '3'.
  3552             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3553             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3554             88  CF-CARRIER-MASTER              VALUE '6'.
  3555             88  CF-MORTALITY-MASTER            VALUE '7'.
  3556             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3557             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  67
* EL130.cbl
  3558             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3559             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3560             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3561             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3562             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3563             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3564             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3565             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3566             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3567         16  CF-ACCESS-CD-GENL              PIC X(4).
  3568         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3569             20  CF-PROCESSOR               PIC X(4).
  3570         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3571             20  CF-STATE-CODE              PIC XX.
  3572             20  FILLER                     PIC XX.
  3573         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3574             20  FILLER                     PIC XX.
  3575             20  CF-HI-BEN-IN-REC           PIC XX.
  3576         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3577             20  FILLER                     PIC XXX.
  3578             20  CF-CARRIER-CNTL            PIC X.
  3579         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3580             20  FILLER                     PIC XX.
  3581             20  CF-HI-TYPE-IN-REC          PIC 99.
  3582         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3583             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3584                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3585             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3586             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3587         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3588             20  FILLER                     PIC X.
  3589             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3590         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3591             20  FILLER                     PIC XX.
  3592             20  CF-MORTGAGE-PLAN           PIC XX.
  3593         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3594
  3595     12  CF-LAST-MAINT-DT                   PIC XX.
  3596     12  CF-LAST-MAINT-BY                   PIC X(4).
  3597     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3598
  3599     12  CF-RECORD-BODY                     PIC X(728).
  3600
  3601
  3602****************************************************************
  3603*             COMPANY MASTER RECORD                            *
  3604****************************************************************
  3605
  3606     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3607         16  CF-COMPANY-ADDRESS.
  3608             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3609             20  CF-CL-IN-CARE-OF           PIC X(30).
  3610             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3611             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3612             20  CF-CL-CITY-STATE           PIC X(30).
  3613             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3614             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3615         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  68
* EL130.cbl
  3616         16  CF-COMPANY-PASSWORD            PIC X(8).
  3617         16  CF-SECURITY-OPTION             PIC X.
  3618             88  ALL-SECURITY                   VALUE '1'.
  3619             88  COMPANY-VERIFY                 VALUE '2'.
  3620             88  PROCESSOR-VERIFY               VALUE '3'.
  3621             88  NO-SECURITY                    VALUE '4'.
  3622             88  ALL-BUT-TERM                   VALUE '5'.
  3623         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3624             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3625         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3626             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3627         16  CF-INFORCE-LOCATION            PIC X.
  3628             88  CERTS-ARE-ONLINE               VALUE '1'.
  3629             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3630             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3631         16  CF-LOWER-CASE-LETTERS          PIC X.
  3632         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3633             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3634             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3635             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3636             88  CF-ACCNT-CNTL                  VALUE '3'.
  3637             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3638
  3639         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3640         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3641
  3642         16  CF-LGX-CREDIT-USER             PIC X.
  3643             88  CO-IS-NOT-USER                 VALUE 'N'.
  3644             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3645
  3646         16 CF-CREDIT-CALC-CODES.
  3647             20  CF-CR-REM-TERM-CALC PIC X.
  3648               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3649               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3650               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3651               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3652               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3653               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3654               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3655             20  CF-CR-R78-METHOD           PIC X.
  3656               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3657               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3658
  3659         16  CF-CLAIM-CONTROL-COUNTS.
  3660             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3661                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3662
  3663             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3664                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3665
  3666             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3667                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3668
  3669             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3670                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3671
  3672         16  CF-CURRENT-MONTH-END           PIC XX.
  3673
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  69
* EL130.cbl
  3674         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3675             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3676             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3677             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3678             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3679                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3680                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3681             20  CF-CO-PREM-REJECT-SW       PIC X.
  3682                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3683                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3684             20  CF-CO-REF-REJECT-SW        PIC X.
  3685                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3686                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3687
  3688         16  CF-CO-REPORTING-DT             PIC XX.
  3689         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3690         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3691           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3692           88  CF-CO-MONTH-END                  VALUE '1'.
  3693
  3694         16  CF-LGX-CLAIM-USER              PIC X.
  3695             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3696             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3697
  3698         16  CF-CREDIT-EDIT-CONTROLS.
  3699             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3700             20  CF-MIN-AGE                 PIC 99.
  3701             20  CF-DEFAULT-AGE             PIC 99.
  3702             20  CF-MIN-TERM                PIC S999      COMP-3.
  3703             20  CF-MAX-TERM                PIC S999      COMP-3.
  3704             20  CF-DEFAULT-SEX             PIC X.
  3705             20  CF-JOINT-AGE-INPUT         PIC X.
  3706                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3707             20  CF-BIRTH-DATE-INPUT        PIC X.
  3708                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3709             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3710                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3711                 88  CF-ZERO-CARRIER            VALUE '1'.
  3712                 88  CF-ZERO-GROUPING           VALUE '2'.
  3713                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3714             20  CF-EDIT-SW                 PIC X.
  3715                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3716             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3717             20  CF-CR-PR-METHOD            PIC X.
  3718               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3719               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3720             20  FILLER                     PIC X.
  3721
  3722         16  CF-CREDIT-MISC-CONTROLS.
  3723             20  CF-REIN-TABLE-SW           PIC X.
  3724                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3725             20  CF-COMP-TABLE-SW           PIC X.
  3726                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3727             20  CF-EXPERIENCE-RETENTION-AGE
  3728                                            PIC S9        COMP-3.
  3729             20  CF-CONVERSION-DT           PIC XX.
  3730             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3731             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  70
* EL130.cbl
  3732                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3733                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3734
  3735             20  CF-CR-CHECK-NO-CONTROL.
  3736                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3737                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3738                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3739                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3740                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3741                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3742
  3743                 24  CF-CR-CHECK-COUNT       REDEFINES
  3744                     CF-CR-CHECK-COUNTER      PIC X(4).
  3745
  3746                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3747                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3748
  3749                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3750                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3751                 24  CF-MAIL-PROCESSING       PIC X.
  3752                     88  MAIL-PROCESSING          VALUE 'Y'.
  3753
  3754         16  CF-MISC-SYSTEM-CONTROL.
  3755             20  CF-SYSTEM-C                 PIC X.
  3756                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3757             20  CF-SYSTEM-D                 PIC X.
  3758                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3759             20  CF-SOC-SEC-NO-SW            PIC X.
  3760                 88  SOC-SEC-NO-USED             VALUE '1'.
  3761             20  CF-MEMBER-NO-SW             PIC X.
  3762                 88  MEMBER-NO-USED              VALUE '1'.
  3763             20  CF-TAX-ID-NUMBER            PIC X(11).
  3764             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3765             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3766                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3767                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3768                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3769                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3770             20  CF-SYSTEM-E                 PIC X.
  3771                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3772
  3773         16  CF-LGX-LIFE-USER               PIC X.
  3774             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3775             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3776
  3777         16  CF-CR-MONTH-END-DT             PIC XX.
  3778
  3779         16  CF-FILE-MAINT-DATES.
  3780             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3781                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3782             20  CF-LAST-BATCH       REDEFINES
  3783                 CF-LAST-BATCH-NO               PIC X(4).
  3784             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3785             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3786             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3787             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3788             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3789             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  71
* EL130.cbl
  3790             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3791             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3792             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3793             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3794
  3795         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3796         16  FILLER                         PIC X.
  3797
  3798         16  CF-ALT-MORT-CODE               PIC X(4).
  3799         16  CF-MEMBER-CAPTION              PIC X(10).
  3800
  3801         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3802             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3803             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3804             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3805             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3806             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3807
  3808         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3809
  3810         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3811         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3812         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3813         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3814
  3815         16  CF-AH-OVERRIDE-L1              PIC X.
  3816         16  CF-AH-OVERRIDE-L2              PIC XX.
  3817         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3818         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3819
  3820         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3821         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3822
  3823         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3824         16  CF-AR-LAST-EL860-DT            PIC XX.
  3825         16  CF-MP-MONTH-END-DT             PIC XX.
  3826
  3827         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3828         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3829             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3830
  3831         16  CF-AR-MONTH-END-DT             PIC XX.
  3832
  3833         16  CF-CRDTCRD-USER                PIC X.
  3834             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3835             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3836
  3837         16  CF-CC-MONTH-END-DT             PIC XX.
  3838
  3839         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3840
  3841         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3842             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3843             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3844             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3845         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3846         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3847         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  72
* EL130.cbl
  3848         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3849             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3850             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3851         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3852         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3853         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3854             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3855         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3856
  3857         16  CF-CL-ZIP-CODE.
  3858             20  CF-CL-ZIP-PRIME.
  3859                 24  CF-CL-ZIP-1ST          PIC X.
  3860                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3861                 24  FILLER                 PIC X(4).
  3862             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3863         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3864             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3865             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3866             20  FILLER                     PIC XXX.
  3867
  3868         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3869         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3870         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3871         16  CF-CO-OPTION-START-DATE        PIC XX.
  3872         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3873           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3874                                                      '3' '4'.
  3875           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3876           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3877           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3878           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3879           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3880           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3881
  3882         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3883
  3884         16  CF-PAYMENT-APPROVAL-LEVELS.
  3885             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3886             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3887             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3888             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3889             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3890             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3891
  3892         16  CF-END-USER-REPORTING-USER     PIC X.
  3893             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3894             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3895
  3896         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3897             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3898             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3899
  3900         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3901
  3902         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3903         16  FILLER                         PIC X.
  3904
  3905         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  73
* EL130.cbl
  3906             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3907             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3908             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3909
  3910         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3911
  3912         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3913             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3914             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3915
  3916         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3917             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3918             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3919
  3920         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3921
  3922         16  CF-CO-ACH-ID-CODE              PIC  X.
  3923             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3924             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3925             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3926         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3927         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3928         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3929         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3930         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3931         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3932         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3933         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3934         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3935                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3936         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3937                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3938
  3939         16  CF-CO-OVER-SHORT.
  3940             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3941             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3942
  3943*         16  FILLER                         PIC X(102).
  3944         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3945             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3946             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3947
  3948         16  CF-AH-APPROVAL-DAYS.
  3949             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3950             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3951             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3952             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3953
  3954         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3955
  3956         16  CF-APPROV-LEV-5.
  3957             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3958             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3959             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3960
  3961         16  FILLER                         PIC X(68).
  3962****************************************************************
  3963*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  74
* EL130.cbl
  3964****************************************************************
  3965
  3966     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3967         16  CF-PROCESSOR-NAME              PIC X(30).
  3968         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3969         16  CF-PROCESSOR-TITLE             PIC X(26).
  3970         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3971                 88  MESSAGE-YES                VALUE 'Y'.
  3972                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3973
  3974*****************************************************
  3975****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3976****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3977****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3978****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3979*****************************************************
  3980
  3981         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3982             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3983             20  CF-APPLICATION-FORCE       PIC X.
  3984             20  CF-INDIVIDUAL-APP.
  3985                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3986                     28  CF-BROWSE-APP      PIC X.
  3987                     28  CF-UPDATE-APP      PIC X.
  3988
  3989         16  CF-CURRENT-TERM-ON             PIC X(4).
  3990         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3991             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3992             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3993             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3994             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3995             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3996             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3997             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3998         16  CF-PROCESSOR-CARRIER           PIC X.
  3999             88  NO-CARRIER-SECURITY            VALUE ' '.
  4000         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4001             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4002         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4003             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4004         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4005             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4006
  4007         16  CF-PROC-SYS-ACCESS-SW.
  4008             20  CF-PROC-CREDIT-CLAIMS-SW.
  4009                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4010                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4011                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4012                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4013             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4014                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4015                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4016             20  CF-PROC-LIFE-GNRLDGR-SW.
  4017                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4018                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4019                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4020                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4021             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  75
* EL130.cbl
  4022                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4023                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4024         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4025             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4026             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4027         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4028
  4029         16  CF-APPROVAL-LEVEL                  PIC X.
  4030             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4031             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4032             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4033             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4034             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4035
  4036         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4037
  4038         16  CF-LANGUAGE-TYPE                   PIC X.
  4039             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4040             88  CF-LANG-IS-FR                      VALUE 'F'.
  4041
  4042         16  CF-CSR-IND                         PIC X.
  4043         16  FILLER                             PIC X(239).
  4044
  4045****************************************************************
  4046*             PROCESSOR/REMINDERS RECORD                       *
  4047****************************************************************
  4048
  4049     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4050         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4051             20  CF-START-REMIND-DT         PIC XX.
  4052             20  CF-END-REMIND-DT           PIC XX.
  4053             20  CF-REMINDER-TEXT           PIC X(50).
  4054         16  FILLER                         PIC X(296).
  4055
  4056
  4057****************************************************************
  4058*             STATE MASTER RECORD                              *
  4059****************************************************************
  4060
  4061     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4062         16  CF-STATE-ABBREVIATION          PIC XX.
  4063         16  CF-STATE-NAME                  PIC X(25).
  4064         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4065         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4066             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4067             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4068             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4069             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4070                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4071                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4072             20  CF-ST-PREM-REJECT-SW       PIC X.
  4073                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4074                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4075             20  CF-ST-REF-REJECT-SW        PIC X.
  4076                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4077                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4078         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4079         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  76
* EL130.cbl
  4080         16  CF-ST-REFUND-RULES.
  4081             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4082             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4083             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4084         16  CF-ST-FST-PMT-EXTENSION.
  4085             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4086             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4087                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4088                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4089                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4090                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4091         16  CF-ST-STATE-CALL.
  4092             20  CF-ST-CALL-UNEARNED        PIC X.
  4093             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4094             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4095         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4096             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4097             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4098         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4099         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4100         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4101         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4102         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4103         16  FILLER                         PIC X.
  4104         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4105             20  CF-ST-BENEFIT-CD           PIC XX.
  4106             20  CF-ST-BENEFIT-KIND         PIC X.
  4107                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4108                 88  CF-ST-AH-KIND              VALUE 'A'.
  4109             20  CF-ST-REM-TERM-CALC        PIC X.
  4110                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4111                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4112                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4113                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4114                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4115                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4116                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4117                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4118
  4119             20  CF-ST-REFUND-CALC          PIC X.
  4120                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4121                 88  ST-REFD-BY-R78             VALUE '1'.
  4122                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4123                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4124                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4125                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4126                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4127                 88  ST-REFD-UTAH               VALUE '7'.
  4128                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4129                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4130                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4131
  4132             20  CF-ST-EARNING-CALC         PIC X.
  4133                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4134                 88  ST-EARN-BY-R78             VALUE '1'.
  4135                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4136                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4137                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  77
* EL130.cbl
  4138                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4139                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4140                 88  ST-EARN-MEAN               VALUE '8'.
  4141                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4142
  4143             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4144                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4145                 88  ST-OVRD-BY-R78             VALUE '1'.
  4146                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4147                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4148                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4149                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4150                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4151                 88  ST-OVRD-MEAN               VALUE '8'.
  4152                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4153             20  FILLER                     PIC X.
  4154
  4155         16  CF-ST-COMMISSION-CAPS.
  4156             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4157             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4158             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4159             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4160         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4161                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4162
  4163         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4164
  4165         16  CF-ST-STATUTORY-INTEREST.
  4166             20  CF-ST-STAT-DATE-FROM       PIC X.
  4167                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4168                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4169             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4170             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4171             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4172             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4173             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4174
  4175         16  CF-ST-OVER-SHORT.
  4176             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4177             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4178
  4179         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4180
  4181         16  CF-ST-RT-CALC                  PIC X.
  4182
  4183         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4184         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4185         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4186         16  CF-ST-RF-LR-CALC               PIC X.
  4187         16  CF-ST-RF-LL-CALC               PIC X.
  4188         16  CF-ST-RF-LN-CALC               PIC X.
  4189         16  CF-ST-RF-AH-CALC               PIC X.
  4190         16  CF-ST-RF-CP-CALC               PIC X.
  4191*        16  FILLER                         PIC X(206).
  4192*CIDMOD         16  FILLER                         PIC X(192).
  4193         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4194             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4195         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  78
* EL130.cbl
  4196         16  CF-ST-VFY-2ND-BENE             PIC X.
  4197         16  CF-ST-CAUSAL-STATE             PIC X.
  4198         16  FILLER                         PIC X(185).
  4199
  4200****************************************************************
  4201*             BENEFIT MASTER RECORD                            *
  4202****************************************************************
  4203
  4204     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4205         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4206             20  CF-BENEFIT-CODE            PIC XX.
  4207             20  CF-BENEFIT-NUMERIC  REDEFINES
  4208                 CF-BENEFIT-CODE            PIC XX.
  4209             20  CF-BENEFIT-ALPHA           PIC XXX.
  4210             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4211             20  CF-BENEFIT-COMMENT         PIC X(10).
  4212
  4213             20  CF-LF-COVERAGE-TYPE        PIC X.
  4214                 88  CF-REDUCING                VALUE 'R'.
  4215                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4216
  4217             20  CF-SPECIAL-CALC-CD         PIC X.
  4218                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4219                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4220                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4221                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4222                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4223                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4224                 88  CF-FARM-PLAN               VALUE 'F'.
  4225                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4226                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4227                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4228                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4229                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4230                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4231                 88  CF-PRUDENTIAL              VALUE 'P'.
  4232                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4233                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4234                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4235                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4236                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4237                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4238
  4239             20  CF-JOINT-INDICATOR         PIC X.
  4240                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4241
  4242*            20  FILLER                     PIC X(12).
  4243             20  cf-maximum-benefits        pic s999 comp-3.
  4244             20  FILLER                     PIC X(09).
  4245             20  CF-BENEFIT-CATEGORY        PIC X.
  4246             20  CF-LOAN-TYPE               PIC X(8).
  4247
  4248             20  CF-CO-REM-TERM-CALC        PIC X.
  4249                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4250                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4251                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4252                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4253                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  79
* EL130.cbl
  4254
  4255             20  CF-CO-EARNINGS-CALC        PIC X.
  4256                 88  CO-EARN-BY-R78             VALUE '1'.
  4257                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4258                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4259                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4260                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4261                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4262                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4263                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4264
  4265             20  CF-CO-REFUND-CALC          PIC X.
  4266                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4267                 88  CO-REFD-BY-R78             VALUE '1'.
  4268                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4269                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4270                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4271                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4272                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4273                 88  CO-REFD-MEAN               VALUE '8'.
  4274                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4275                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4276                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4277
  4278             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4279                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4280                 88  CO-OVRD-BY-R78             VALUE '1'.
  4281                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4282                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4283                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4284                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4285                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4286                 88  CO-OVRD-MEAN               VALUE '8'.
  4287                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4288
  4289             20  CF-CO-BEN-I-G-CD           PIC X.
  4290                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4291                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4292                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4293
  4294         16  FILLER                         PIC X(304).
  4295
  4296
  4297****************************************************************
  4298*             CARRIER MASTER RECORD                            *
  4299****************************************************************
  4300
  4301     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4302         16  CF-ADDRESS-DATA.
  4303             20  CF-MAIL-TO-NAME            PIC X(30).
  4304             20  CF-IN-CARE-OF              PIC X(30).
  4305             20  CF-ADDRESS-LINE-1          PIC X(30).
  4306             20  CF-ADDRESS-LINE-2          PIC X(30).
  4307             20  CF-CITY-STATE              PIC X(30).
  4308             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4309             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4310
  4311         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  80
* EL130.cbl
  4312             20  CF-CLAIM-NO-METHOD         PIC X.
  4313                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4314                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4315                 88  CLAIM-NO-SEQ               VALUE '3'.
  4316                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4317             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4318                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4319                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4320                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4321
  4322         16  CF-CHECK-NO-CONTROL.
  4323             20  CF-CHECK-NO-METHOD         PIC X.
  4324                 88  CHECK-NO-MANUAL            VALUE '1'.
  4325                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4326                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4327                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4328             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4329                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4330
  4331         16  CF-DOMICILE-STATE              PIC XX.
  4332
  4333         16  CF-EXPENSE-CONTROLS.
  4334             20  CF-EXPENSE-METHOD          PIC X.
  4335                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4336                 88  DOLLARS-PER-PMT            VALUE '2'.
  4337                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4338                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4339             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4340             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4341
  4342         16  CF-CORRESPONDENCE-CONTROL.
  4343             20  CF-LETTER-RESEND-OPT       PIC X.
  4344                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4345                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4346             20  FILLER                     PIC X(4).
  4347
  4348         16  CF-RESERVE-CONTROLS.
  4349             20  CF-MANUAL-SW               PIC X.
  4350                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4351             20  CF-FUTURE-SW               PIC X.
  4352                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4353             20  CF-PTC-SW                  PIC X.
  4354                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4355             20  CF-IBNR-SW                 PIC X.
  4356                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4357             20  CF-PTC-LF-SW               PIC X.
  4358                 88  CF-LF-PTC-USED             VALUE '1'.
  4359             20  CF-CDT-ACCESS-METHOD       PIC X.
  4360                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4361                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4362                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4363             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4364
  4365         16  CF-CLAIM-CALC-METHOD           PIC X.
  4366             88  360-PLUS-MONTHS                VALUE '1'.
  4367             88  365-PLUS-MONTHS                VALUE '2'.
  4368             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4369             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  81
* EL130.cbl
  4370             88  365-DAILY                      VALUE '5'.
  4371
  4372         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4373         16  FILLER                         PIC X(11).
  4374
  4375         16  CF-LIMIT-AMOUNTS.
  4376             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4377             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4378             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4379             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4380             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4381             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4382             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4383             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4384             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4385             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4386
  4387         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4388         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4389         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4390
  4391         16  CF-ZIP-CODE.
  4392             20  CF-ZIP-PRIME.
  4393                 24  CF-ZIP-1ST             PIC X.
  4394                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4395                 24  FILLER                 PIC X(4).
  4396             20  CF-ZIP-PLUS4               PIC X(4).
  4397         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4398             20  CF-CAN-POSTAL-1            PIC XXX.
  4399             20  CF-CAN-POSTAL-2            PIC XXX.
  4400             20  FILLER                     PIC XXX.
  4401
  4402         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4403         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4404         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4405
  4406         16  CF-RATING-SWITCH               PIC X.
  4407             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4408             88  CF-NO-RATING                   VALUE 'N'.
  4409
  4410         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4411
  4412         16  CF-CARRIER-OVER-SHORT.
  4413             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4414             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4415
  4416         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4417         16  CF-SECPAY-SWITCH               PIC X.
  4418             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4419             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4420         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4421         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4422         16  FILLER                         PIC X(444).
  4423*        16  FILLER                         PIC X(452).
  4424
  4425
  4426****************************************************************
  4427*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  82
* EL130.cbl
  4428****************************************************************
  4429
  4430     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4431         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4432                                INDEXED BY CF-MORT-NDX.
  4433             20  CF-MORT-TABLE              PIC X(5).
  4434             20  CF-MORT-TABLE-TYPE         PIC X.
  4435                 88  CF-MORT-JOINT              VALUE 'J'.
  4436                 88  CF-MORT-SINGLE             VALUE 'S'.
  4437                 88  CF-MORT-COMBINED           VALUE 'C'.
  4438                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4439                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4440             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4441             20  CF-MORT-AGE-METHOD         PIC XX.
  4442                 88  CF-AGE-LAST                VALUE 'AL'.
  4443                 88  CF-AGE-NEAR                VALUE 'AN'.
  4444             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4445             20  CF-MORT-ADJUSTMENT-DIRECTION
  4446                                            PIC X.
  4447                 88  CF-MINUS                   VALUE '-'.
  4448                 88  CF-PLUS                    VALUE '+'.
  4449             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4450             20  CF-MORT-JOINT-CODE         PIC X.
  4451                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4452             20  CF-MORT-PC-Q               PIC X.
  4453                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4454             20  CF-MORT-TABLE-CODE         PIC X(4).
  4455             20  CF-MORT-COMMENTS           PIC X(15).
  4456             20  FILLER                     PIC X(14).
  4457
  4458         16  FILLER                         PIC X(251).
  4459
  4460
  4461****************************************************************
  4462*             BUSSINESS TYPE MASTER RECORD                     *
  4463****************************************************************
  4464
  4465     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4466* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4467* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4468* AND RECORD 05 IS TYPES 81-99
  4469         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4470             20  CF-BUSINESS-TITLE          PIC  X(19).
  4471             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4472                                            PIC S9V9(4) COMP-3.
  4473             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4474             20  FILLER                     PIC  X.
  4475         16  FILLER                         PIC  X(248).
  4476
  4477
  4478****************************************************************
  4479*             TERMINAL MASTER RECORD                           *
  4480****************************************************************
  4481
  4482     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4483
  4484         16  CF-COMPANY-TERMINALS.
  4485             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  83
* EL130.cbl
  4486                                  PIC X(4).
  4487         16  FILLER               PIC X(248).
  4488
  4489
  4490****************************************************************
  4491*             LIFE EDIT MASTER RECORD                          *
  4492****************************************************************
  4493
  4494     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4495         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4496             20  CF-LIFE-CODE-IN            PIC XX.
  4497             20  CF-LIFE-CODE-OUT           PIC XX.
  4498         16  FILLER                         PIC X(248).
  4499
  4500
  4501****************************************************************
  4502*             AH EDIT MASTER RECORD                            *
  4503****************************************************************
  4504
  4505     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4506         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4507             20  CF-AH-CODE-IN              PIC XXX.
  4508             20  CF-AH-CODE-OUT             PIC XX.
  4509         16  FILLER                         PIC X(248).
  4510
  4511
  4512****************************************************************
  4513*             CREDIBILITY TABLES                               *
  4514****************************************************************
  4515
  4516     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4517         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4518                             INDEXED BY CF-CRDB-NDX.
  4519             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4520             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4521             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4522         16  FILLER                         PIC  X(332).
  4523
  4524
  4525****************************************************************
  4526*             REPORT CUSTOMIZATION RECORD                      *
  4527****************************************************************
  4528
  4529     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4530         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4531             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4532             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4533             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4534**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4535****       A T-TRANSFER.                                   ****
  4536             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4537
  4538         16  FILLER                         PIC XX.
  4539
  4540         16  CF-CARRIER-CNTL-OPT.
  4541             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4542                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4543                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  84
* EL130.cbl
  4544             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4545                                            PIC X.
  4546         16  CF-GROUP-CNTL-OPT.
  4547             20  CF-GROUP-OPT-SEQ           PIC 9.
  4548                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4549                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4550             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4551                                            PIC X(6).
  4552         16  CF-STATE-CNTL-OPT.
  4553             20  CF-STATE-OPT-SEQ           PIC 9.
  4554                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4555                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4556             20  CF-STATE-SELECT OCCURS 3 TIMES
  4557                                            PIC XX.
  4558         16  CF-ACCOUNT-CNTL-OPT.
  4559             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4560                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4561                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4562             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4563                                            PIC X(10).
  4564         16  CF-BUS-TYP-CNTL-OPT.
  4565             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4566                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4567                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4568             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4569                                            PIC XX.
  4570         16  CF-LF-TYP-CNTL-OPT.
  4571             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4572                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4573                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4574             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4575                                            PIC XX.
  4576         16  CF-AH-TYP-CNTL-OPT.
  4577             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4578                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4579                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4580             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4581                                            PIC XX.
  4582         16  CF-REPTCD1-CNTL-OPT.
  4583             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4584                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4585                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4586             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4587                                            PIC X(10).
  4588         16  CF-REPTCD2-CNTL-OPT.
  4589             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4590                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4591                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4592             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4593                                            PIC X(10).
  4594         16  CF-USER1-CNTL-OPT.
  4595             20  CF-USER1-OPT-SEQ           PIC 9.
  4596                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4597                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4598             20  CF-USER1-SELECT OCCURS 3 TIMES
  4599                                            PIC X(10).
  4600         16  CF-USER2-CNTL-OPT.
  4601             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  85
* EL130.cbl
  4602                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4603                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4604             20  CF-USER2-SELECT OCCURS 3 TIMES
  4605                                            PIC X(10).
  4606         16  CF-USER3-CNTL-OPT.
  4607             20  CF-USER3-OPT-SEQ           PIC 9.
  4608                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4609                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4610             20  CF-USER3-SELECT OCCURS 3 TIMES
  4611                                            PIC X(10).
  4612         16  CF-USER4-CNTL-OPT.
  4613             20  CF-USER4-OPT-SEQ           PIC 9.
  4614                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4615                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4616             20  CF-USER4-SELECT OCCURS 3 TIMES
  4617                                            PIC X(10).
  4618         16  CF-USER5-CNTL-OPT.
  4619             20  CF-USER5-OPT-SEQ           PIC 9.
  4620                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4621                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4622             20  CF-USER5-SELECT OCCURS 3 TIMES
  4623                                            PIC X(10).
  4624         16  CF-REINS-CNTL-OPT.
  4625             20  CF-REINS-OPT-SEQ           PIC 9.
  4626                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4627                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4628             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4629                 24  CF-REINS-PRIME         PIC XXX.
  4630                 24  CF-REINS-SUB           PIC XXX.
  4631
  4632         16  CF-AGENT-CNTL-OPT.
  4633             20  CF-AGENT-OPT-SEQ           PIC 9.
  4634                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4635                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4636             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4637                                            PIC X(10).
  4638
  4639         16  FILLER                         PIC X(43).
  4640
  4641         16  CF-LOSS-RATIO-SELECT.
  4642             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4643             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4644         16  CF-ENTRY-DATE-SELECT.
  4645             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4646             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4647         16  CF-EFFECTIVE-DATE-SELECT.
  4648             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4649             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4650
  4651         16  CF-EXCEPTION-LIST-IND          PIC X.
  4652             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4653
  4654         16  FILLER                         PIC X(318).
  4655
  4656****************************************************************
  4657*                  EXCEPTION REPORTING RECORD                  *
  4658****************************************************************
  4659
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  86
* EL130.cbl
  4660     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4661         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4662             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4663
  4664         16  CF-COMBINED-LIFE-AH-OPT.
  4665             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4666             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4667             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4668             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4669
  4670         16  CF-LIFE-OPT.
  4671             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4672             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4673             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4674             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4675             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4676             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4677             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4678             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4679             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4680             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4681
  4682         16  CF-AH-OPT.
  4683             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4684             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4685             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4686             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4687             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4688             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4689             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4690             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4691             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4692             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4693
  4694         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4695             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4696             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4697             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4698
  4699         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4700
  4701         16  FILLER                         PIC X(673).
  4702
  4703
  4704****************************************************************
  4705*             MORTGAGE SYSTEM PLAN RECORD                      *
  4706****************************************************************
  4707
  4708     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4709         16  CF-PLAN-TYPE                   PIC X.
  4710             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4711             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4712             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4713         16  CF-PLAN-ABBREV                 PIC XXX.
  4714         16  CF-PLAN-DESCRIPT               PIC X(10).
  4715         16  CF-PLAN-NOTES                  PIC X(20).
  4716         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4717         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  87
* EL130.cbl
  4718             20  CF-PLAN-TERM-DATA.
  4719                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4720                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4721             20  CF-PLAN-AGE-DATA.
  4722                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4723                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4724                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4725             20  CF-PLAN-BENEFIT-DATA.
  4726                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4727                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4728                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4729                                            PIC S9(7)V99  COMP-3.
  4730         16  CF-PLAN-POLICY-FORMS.
  4731             20  CF-POLICY-FORM             PIC X(12).
  4732             20  CF-MASTER-APPLICATION      PIC X(12).
  4733             20  CF-MASTER-POLICY           PIC X(12).
  4734         16  CF-PLAN-RATING.
  4735             20  CF-RATE-CODE               PIC X(5).
  4736             20  CF-SEX-RATING              PIC X.
  4737                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4738                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4739             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4740             20  CF-SUB-STD-TYPE            PIC X.
  4741                 88  CF-PCT-OF-PREM            VALUE '1'.
  4742                 88  CF-PCT-OF-BENE            VALUE '2'.
  4743         16  CF-PLAN-PREM-TOLERANCES.
  4744             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4745             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4746         16  CF-PLAN-PYMT-TOLERANCES.
  4747             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4748             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4749         16  CF-PLAN-MISC-DATA.
  4750             20  FILLER                     PIC X.
  4751             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4752             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4753         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4754         16  CF-PLAN-IND-GRP                PIC X.
  4755             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4756                                                     '1'.
  4757             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4758                                                     '2'.
  4759         16  CF-MIB-SEARCH-SW               PIC X.
  4760             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4761             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4762             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4763             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4764         16  CF-ALPHA-SEARCH-SW             PIC X.
  4765             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4766             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4767             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4768             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4769             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4770             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4771             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4772             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4773             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4774             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4775                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  88
* EL130.cbl
  4776                                                     'X' 'Y' 'Z'.
  4777         16  CF-EFF-DT-RULE-SW              PIC X.
  4778             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4779             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4780             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4781             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4782             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4783         16  FILLER                         PIC X(4).
  4784         16  CF-HEALTH-QUESTIONS            PIC X.
  4785             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4786         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4787         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4788         16  CF-PLAN-SNGL-JNT               PIC X.
  4789             88  CF-COMBINED-PLAN              VALUE 'C'.
  4790             88  CF-JNT-PLAN                   VALUE 'J'.
  4791             88  CF-SNGL-PLAN                  VALUE 'S'.
  4792         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4793         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4794         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4795         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4796         16  CF-RERATE-CNTL                 PIC  X.
  4797             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4798             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4799             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4800             88  CF-AUTO-RECALC                 VALUE '4'.
  4801         16  CF-BENEFIT-TYPE                PIC  X.
  4802             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4803             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4804         16  CF-POLICY-FEE                  PIC S999V99
  4805                                                    COMP-3.
  4806         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4807         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4808         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4809         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4810         16  FILLER                         PIC  X(32).
  4811         16  CF-TERMINATION-FORM            PIC  X(04).
  4812         16  FILLER                         PIC  X(08).
  4813         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4814                                                       COMP-3.
  4815         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4816         16  CF-ISSUE-LETTER                PIC  X(4).
  4817         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4818         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4819             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4820             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4821         16  CF-MP-REFUND-CALC              PIC X.
  4822             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4823             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4824             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4825             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4826             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4827             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4828             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4829             88  CF-MP-REFD-MEAN                VALUE '8'.
  4830         16  CF-ALT-RATE-CODE               PIC  X(5).
  4831
  4832
  4833         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  89
* EL130.cbl
  4834****************************************************************
  4835*             MORTGAGE COMPANY MASTER RECORD                   *
  4836****************************************************************
  4837
  4838     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4839         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4840         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4841             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4842             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4843             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4844             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4845             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4846
  4847         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4848         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4849         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4850         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4851         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4852
  4853         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4854             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4855         16  CF-MP-RECON-USE-IND            PIC X(1).
  4856             88  CF-MP-USE-RECON             VALUE 'Y'.
  4857         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4858             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4859         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4860             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4861             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4862         16  FILLER                         PIC X(1).
  4863         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4864             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4865         16  CF-MORTG-MIB-VERSION           PIC X.
  4866             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4867             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4868             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4869         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4870             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4871                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4872             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4873                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4874             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4875                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4876             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4877                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4878             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4879                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4880             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4881                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4882         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4883         16  FILLER                         PIC X(7).
  4884         16  CF-MORTG-DESTINATION-SYMBOL.
  4885             20  CF-MORTG-MIB-COMM          PIC X(5).
  4886             20  CF-MORTG-MIB-TERM          PIC X(5).
  4887         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4888             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4889         16  FILLER                         PIC X(03).
  4890         16  CF-MP-CHECK-NO-CONTROL.
  4891             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  90
* EL130.cbl
  4892                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4893                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4894                                                ' ' LOW-VALUES.
  4895                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4896                                               VALUE '3'.
  4897         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4898         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4899         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4900             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4901                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4902             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4903                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4904             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4905                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4906             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4907                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4908             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4909                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4910             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4911                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4912         16  CF-MORTG-BILLING-AREA.
  4913             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4914                                            PIC X.
  4915         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4916         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4917         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4918         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4919             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4920             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4921         16  FILLER                         PIC X.
  4922         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4923             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4924             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4925         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4926         16  FILLER                         PIC X(8).
  4927         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4928         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4929         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4930         16  CF-ACH-COMPANY-ID.
  4931             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4932                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4933                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4934                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4935             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4936         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4937             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4938         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4939             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4940             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4941         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4942         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4943         16  FILLER                         PIC X(536).
  4944
  4945****************************************************************
  4946*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4947****************************************************************
  4948
  4949     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  91
* EL130.cbl
  4950         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4951             20  CF-FEMALE-HEIGHT.
  4952                 24  CF-FEMALE-FT           PIC 99.
  4953                 24  CF-FEMALE-IN           PIC 99.
  4954             20  CF-FEMALE-MIN-WT           PIC 999.
  4955             20  CF-FEMALE-MAX-WT           PIC 999.
  4956         16  FILLER                         PIC X(428).
  4957
  4958     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4959         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4960             20  CF-MALE-HEIGHT.
  4961                 24  CF-MALE-FT             PIC 99.
  4962                 24  CF-MALE-IN             PIC 99.
  4963             20  CF-MALE-MIN-WT             PIC 999.
  4964             20  CF-MALE-MAX-WT             PIC 999.
  4965         16  FILLER                         PIC X(428).
  4966******************************************************************
  4967*             AUTOMATIC ACTIVITY RECORD                          *
  4968******************************************************************
  4969     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4970         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4971             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4972             20  CF-SYS-LETTER-ID           PIC X(04).
  4973             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4974             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4975             20  CF-SYS-RESET-SW            PIC X(01).
  4976             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4977             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4978
  4979         16  FILLER                         PIC X(50).
  4980
  4981         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4982             20  CF-USER-ACTIVE-SW          PIC X(01).
  4983             20  CF-USER-LETTER-ID          PIC X(04).
  4984             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4985             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4986             20  CF-USER-RESET-SW           PIC X(01).
  4987             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4988             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4989             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4990
  4991         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  92
* EL130.cbl
  4993*    COPY ELCCERT.
  4994******************************************************************
  4995*                                                                *
  4996*                            ELCCERT.                            *
  4997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4998*                            VMOD=2.013                          *
  4999*                                                                *
  5000*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5001*                                                                *
  5002*   FILE TYPE = VSAM,KSDS                                        *
  5003*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5004*                                                                *
  5005*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5006*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5007*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5008*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5009*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5010*                                                                *
  5011*   LOG = YES                                                    *
  5012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5013******************************************************************
  5014*                   C H A N G E   L O G
  5015*
  5016* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5017*-----------------------------------------------------------------
  5018*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5019* EFFECTIVE    NUMBER
  5020*-----------------------------------------------------------------
  5021* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5022* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5023* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5024* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5025* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5026* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5027* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5028* 032612  CR2011110200001  PEMA  AHL CHANGES
  5029******************************************************************
  5030
  5031 01  CERTIFICATE-MASTER.
  5032     12  CM-RECORD-ID                      PIC XX.
  5033         88  VALID-CM-ID                      VALUE 'CM'.
  5034
  5035     12  CM-CONTROL-PRIMARY.
  5036         16  CM-COMPANY-CD                 PIC X.
  5037         16  CM-CARRIER                    PIC X.
  5038         16  CM-GROUPING.
  5039             20  CM-GROUPING-PREFIX        PIC X(3).
  5040             20  CM-GROUPING-PRIME         PIC X(3).
  5041         16  CM-STATE                      PIC XX.
  5042         16  CM-ACCOUNT.
  5043             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5044             20  CM-ACCOUNT-PRIME          PIC X(6).
  5045         16  CM-CERT-EFF-DT                PIC XX.
  5046         16  CM-CERT-NO.
  5047             20  CM-CERT-PRIME             PIC X(10).
  5048             20  CM-CERT-SFX               PIC X.
  5049
  5050     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  93
* EL130.cbl
  5051         16  CM-COMPANY-CD-A1              PIC X.
  5052         16  CM-INSURED-LAST-NAME          PIC X(15).
  5053         16  CM-INSURED-INITIALS.
  5054             20  CM-INSURED-INITIAL1       PIC X.
  5055             20  CM-INSURED-INITIAL2       PIC X.
  5056
  5057     12  CM-CONTROL-BY-SSN.
  5058         16  CM-COMPANY-CD-A2              PIC X.
  5059         16  CM-SOC-SEC-NO.
  5060             20  CM-SSN-STATE              PIC XX.
  5061             20  CM-SSN-ACCOUNT            PIC X(6).
  5062             20  CM-SSN-LN3.
  5063                 25  CM-INSURED-INITIALS-A2.
  5064                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5065                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5066                 25 CM-PART-LAST-NAME-A2         PIC X.
  5067
  5068     12  CM-CONTROL-BY-CERT-NO.
  5069         16  CM-COMPANY-CD-A4              PIC X.
  5070         16  CM-CERT-NO-A4                 PIC X(11).
  5071
  5072     12  CM-CONTROL-BY-MEMB.
  5073         16  CM-COMPANY-CD-A5              PIC X.
  5074         16  CM-MEMBER-NO.
  5075             20  CM-MEMB-STATE             PIC XX.
  5076             20  CM-MEMB-ACCOUNT           PIC X(6).
  5077             20  CM-MEMB-LN4.
  5078                 25  CM-INSURED-INITIALS-A5.
  5079                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5080                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5081                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5082
  5083     12  CM-INSURED-PROFILE-DATA.
  5084         16  CM-INSURED-FIRST-NAME.
  5085             20  CM-INSURED-1ST-INIT       PIC X.
  5086             20  FILLER                    PIC X(9).
  5087         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5088         16  CM-INSURED-SEX                PIC X.
  5089             88  CM-SEX-MALE                  VALUE 'M'.
  5090             88  CM-SEX-FEMAL                 VALUE 'F'.
  5091         16  CM-INSURED-JOINT-AGE          PIC 99.
  5092         16  CM-JOINT-INSURED-NAME.
  5093             20  CM-JT-LAST-NAME           PIC X(15).
  5094             20  CM-JT-FIRST-NAME.
  5095                 24  CM-JT-1ST-INIT        PIC X.
  5096                 24  FILLER                PIC X(9).
  5097             20  CM-JT-INITIAL             PIC X.
  5098
  5099     12  CM-LIFE-DATA.
  5100         16  CM-LF-BENEFIT-CD              PIC XX.
  5101         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5102         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5103         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5104         16  CM-LF-DEV-CODE                PIC XXX.
  5105         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5106         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5107         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5108         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  94
* EL130.cbl
  5109         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5110         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5111         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5112         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5113         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5114         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5115         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5116         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5117         16  FILLER                        PIC XX.
  5118
  5119     12  CM-AH-DATA.
  5120         16  CM-AH-BENEFIT-CD              PIC XX.
  5121         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5122         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5123         16  CM-AH-DEV-CODE                PIC XXX.
  5124         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5125         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5126         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5127         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5128         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5129         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5130         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5131         16  CM-AH-PAID-THRU-DT            PIC XX.
  5132             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5133         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5134         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5135         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5136         16  FILLER                        PIC X.
  5137
  5138     12  CM-LOAN-INFORMATION.
  5139         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5140         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5141                                           PIC S9(5)V99  COMP-3.
  5142         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5143         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5144         16  CM-PAY-FREQUENCY              PIC S99.
  5145         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5146         16  CM-RATE-CLASS                 PIC XX.
  5147         16  CM-BENEFICIARY                PIC X(25).
  5148         16  CM-POLICY-FORM-NO             PIC X(12).
  5149         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5150         16  CM-LAST-ADD-ON-DT             PIC XX.
  5151         16  CM-DEDUCTIBLE-AMOUNTS.
  5152             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5153             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5154         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5155             20  CM-RESIDENT-STATE         PIC XX.
  5156             20  CM-RATE-CODE              PIC X(4).
  5157             20  FILLER                    PIC XX.
  5158         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5159             20  CM-LOAN-OFFICER           PIC X(5).
  5160             20  FILLER                    PIC XXX.
  5161         16  CM-CSR-CODE                   PIC XXX.
  5162         16  CM-UNDERWRITING-CODE          PIC X.
  5163             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5164         16  CM-POST-CARD-IND              PIC X.
  5165         16  CM-NH-INTERFACE-SW            PIC X.
  5166         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  95
* EL130.cbl
  5167             88  CM-SING-PRM                  VALUE '1'.
  5168             88  CM-O-B-COVERAGE              VALUE '2'.
  5169             88  CM-OPEN-END                  VALUE '3'.
  5170         16  CM-IND-GRP-TYPE               PIC X.
  5171             88  CM-INDIVIDUAL                VALUE 'I'.
  5172             88  CM-GROUP                     VALUE 'G'.
  5173         16  CM-SKIP-CODE                  PIC X.
  5174             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5175             88  SKIP-JULY                    VALUE '1'.
  5176             88  SKIP-AUGUST                  VALUE '2'.
  5177             88  SKIP-SEPTEMBER               VALUE '3'.
  5178             88  SKIP-JULY-AUG                VALUE '4'.
  5179             88  SKIP-AUG-SEPT                VALUE '5'.
  5180             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5181             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5182             88  SKIP-JUNE                    VALUE '8'.
  5183             88  SKIP-JUNE-JULY               VALUE '9'.
  5184             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5185             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5186         16  CM-PAYMENT-MODE               PIC X.
  5187             88  PAY-MONTHLY                  VALUE SPACE.
  5188             88  PAY-WEEKLY                   VALUE '1'.
  5189             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5190             88  PAY-BI-WEEKLY                VALUE '3'.
  5191             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5192         16  CM-LOAN-NUMBER                PIC X(8).
  5193         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5194         16  CM-OLD-LOF                    PIC XXX.
  5195*        16  CM-LOAN-OFFICER               PIC XXX.
  5196         16  CM-REIN-TABLE                 PIC XXX.
  5197         16  CM-SPECIAL-REIN-CODE          PIC X.
  5198         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5199         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5200         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5201
  5202     12  CM-STATUS-DATA.
  5203         16  CM-ENTRY-STATUS               PIC X.
  5204         16  CM-ENTRY-DT                   PIC XX.
  5205
  5206         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5207         16  CM-LF-CANCEL-DT               PIC XX.
  5208         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5209
  5210         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5211         16  CM-LF-DEATH-DT                PIC XX.
  5212         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5213
  5214         16  CM-LF-CURRENT-STATUS          PIC X.
  5215             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5216                                                'M' '4' '5' '9'.
  5217             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5218             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5219             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5220             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5221             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5222             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5223             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5224             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  96
* EL130.cbl
  5225             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5226             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5227             88  CM-LF-DECLINED               VALUE 'D'.
  5228             88  CM-LF-VOIDED                 VALUE 'V'.
  5229
  5230         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5231         16  CM-AH-CANCEL-DT               PIC XX.
  5232         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5233
  5234         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5235         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5236         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5237
  5238         16  CM-AH-CURRENT-STATUS          PIC X.
  5239             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5240                                                'M' '4' '5' '9'.
  5241             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5242             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5243             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5244             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5245             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5246             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5247             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5248             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5249             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5250             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5251             88  CM-AH-DECLINED               VALUE 'D'.
  5252             88  CM-AH-VOIDED                 VALUE 'V'.
  5253
  5254         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5255             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5256             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5257             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5258         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5259
  5260         16  CM-ENTRY-BATCH                PIC X(6).
  5261         16  CM-LF-EXIT-BATCH              PIC X(6).
  5262         16  CM-AH-EXIT-BATCH              PIC X(6).
  5263         16  CM-LAST-MONTH-END             PIC XX.
  5264
  5265     12  CM-NOTE-SW                        PIC X.
  5266         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5267         88  CERT-NOTES-PRESENT               VALUE '1'.
  5268         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5269         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5270         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5271         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5272         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5273         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5274     12  CM-COMP-EXCP-SW                   PIC X.
  5275         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5276         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5277     12  CM-INSURED-ADDRESS-SW             PIC X.
  5278         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5279         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5280
  5281*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5282     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  97
* EL130.cbl
  5283     12  FILLER                            PIC X.
  5284
  5285*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5286     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5287     12  FILLER                            PIC X.
  5288*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5289     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5290
  5291     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5292         88  CERT-ADDED-BATCH                 VALUE ' '.
  5293         88  CERT-ADDED-ONLINE                VALUE '1'.
  5294         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5295         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5296         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5297     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5298         88  CERT-AS-LOADED                   VALUE ' '.
  5299         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5300         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5301         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5302         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5303         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5304         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5305         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5306
  5307     12  CM-ACCOUNT-COMM-PCTS.
  5308         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5309         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5310
  5311     12  CM-USER-FIELD                     PIC X.
  5312     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5313     12  CM-CLP-STATE                      PIC XX.
  5314     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5315     12  CM-USER-RESERVED                  PIC XXX.
  5316     12  FILLER REDEFINES CM-USER-RESERVED.
  5317         16  CM-AH-CLASS-CD                PIC XX.
  5318         16  F                             PIC X.
  5319******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  98
* EL130.cbl
  5321*    COPY ERCACCT.
  5322******************************************************************
  5323*                                                                *
  5324*                                                                *
  5325*                            ERCACCT                             *
  5326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5327*                            VMOD=2.031                          *
  5328*                                                                *
  5329*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5330*                                                                *
  5331*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5332*   VSAM ACCOUNT MASTER FILES.                                   *
  5333*                                                                *
  5334*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5335*                                                                *
  5336*   FILE TYPE = VSAM,KSDS                                        *
  5337*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5338*                                                                *
  5339*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5340*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5341*                                                                *
  5342*   LOG = NO                                                     *
  5343*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5344*                                                                *
  5345*                                                                *
  5346******************************************************************
  5347*                   C H A N G E   L O G
  5348*
  5349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5350*-----------------------------------------------------------------
  5351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5352* EFFECTIVE    NUMBER
  5353*-----------------------------------------------------------------
  5354* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5355* 092705    2005050300006  PEMA  ADD SPP LEASES
  5356* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5357* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5358* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5359* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5360* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5361******************************************************************
  5362
  5363 01  ACCOUNT-MASTER.
  5364     12  AM-RECORD-ID                      PIC XX.
  5365         88  VALID-AM-ID                      VALUE 'AM'.
  5366
  5367     12  AM-CONTROL-PRIMARY.
  5368         16  AM-COMPANY-CD                 PIC X.
  5369         16  AM-MSTR-CNTRL.
  5370             20  AM-CONTROL-A.
  5371                 24  AM-CARRIER            PIC X.
  5372                 24  AM-GROUPING.
  5373                     28 AM-GROUPING-PREFIX PIC XXX.
  5374                     28 AM-GROUPING-PRIME  PIC XXX.
  5375                 24  AM-STATE              PIC XX.
  5376                 24  AM-ACCOUNT.
  5377                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5378                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  99
* EL130.cbl
  5379             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5380                                           PIC X(19).
  5381             20  AM-CNTRL-B.
  5382                 24  AM-EXPIRATION-DT      PIC XX.
  5383                 24  FILLER                PIC X(4).
  5384             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5385                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5386
  5387     12  AM-CONTROL-BY-VAR-GRP.
  5388         16  AM-COMPANY-CD-A1              PIC X.
  5389         16  AM-VG-CARRIER                 PIC X.
  5390         16  AM-VG-GROUPING                PIC X(6).
  5391         16  AM-VG-STATE                   PIC XX.
  5392         16  AM-VG-ACCOUNT                 PIC X(10).
  5393         16  AM-VG-DATE.
  5394             20  AM-VG-EXPIRATION-DT       PIC XX.
  5395             20  FILLER                    PIC X(4).
  5396         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5397                                           PIC 9(11)      COMP-3.
  5398     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5399         16  FILLER                        PIC X(10).
  5400         16  AM-VG-KEY3.
  5401             20  AM-VG3-ACCOUNT            PIC X(10).
  5402             20  AM-VG3-EXP-DT             PIC XX.
  5403         16  FILLER                        PIC X(4).
  5404     12  AM-MAINT-INFORMATION.
  5405         16  AM-LAST-MAINT-DT              PIC XX.
  5406         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5407         16  AM-LAST-MAINT-USER            PIC X(4).
  5408         16  FILLER                        PIC XX.
  5409
  5410     12  AM-EFFECTIVE-DT                   PIC XX.
  5411     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5412
  5413     12  AM-PREV-DATES  COMP-3.
  5414         16  AM-PREV-EXP-DT                PIC 9(11).
  5415         16  AM-PREV-EFF-DT                PIC 9(11).
  5416
  5417     12  AM-REPORT-CODE-1                  PIC X(10).
  5418     12  AM-REPORT-CODE-2                  PIC X(10).
  5419
  5420     12  AM-CITY-CODE                      PIC X(4).
  5421     12  AM-COUNTY-PARISH                  PIC X(6).
  5422
  5423     12  AM-NAME                           PIC X(30).
  5424     12  AM-PERSON                         PIC X(30).
  5425     12  AM-ADDRS                          PIC X(30).
  5426     12  AM-CITY.
  5427         16  AM-ADDR-CITY                  PIC X(28).
  5428         16  AM-ADDR-STATE                 PIC XX.
  5429     12  AM-ZIP.
  5430         16  AM-ZIP-PRIME.
  5431             20  AM-ZIP-PRI-1ST            PIC X.
  5432                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5433             20  FILLER                    PIC X(4).
  5434         16  AM-ZIP-PLUS4                  PIC X(4).
  5435     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5436         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 100
* EL130.cbl
  5437         16  AM-CAN-POSTAL-2               PIC XXX.
  5438         16  FILLER                        PIC XXX.
  5439     12  AM-TEL-NO.
  5440         16  AM-AREA-CODE                  PIC 999.
  5441         16  AM-TEL-PRE                    PIC 999.
  5442         16  AM-TEL-NBR                    PIC 9(4).
  5443     12  AM-TEL-LOC                        PIC X.
  5444         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5445         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5446
  5447     12  AM-COMM-STRUCTURE.
  5448         16  AM-DEFN-1.
  5449             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5450                 24  AM-AGT.
  5451                     28  AM-AGT-PREFIX     PIC X(4).
  5452                     28  AM-AGT-PRIME      PIC X(6).
  5453                 24  AM-COM-TYP            PIC X.
  5454                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5455                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5456                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5457                 24  AM-RECALC-LV-INDIC    PIC X.
  5458                 24  AM-RETRO-LV-INDIC     PIC X.
  5459                 24  AM-GL-CODES           PIC X.
  5460                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5461                 24  FILLER                PIC X(01).
  5462         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5463             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5464                 24  FILLER                PIC X(11).
  5465                 24  AM-L-COMA             PIC XXX.
  5466                 24  AM-J-COMA             PIC XXX.
  5467                 24  AM-A-COMA             PIC XXX.
  5468                 24  FILLER                PIC X(6).
  5469
  5470     12  AM-COMM-CHANGE-STATUS             PIC X.
  5471         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5472
  5473     12  AM-CSR-CODE                       PIC X(4).
  5474
  5475     12  AM-BILLING-STATUS                 PIC X.
  5476         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5477         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5478     12  AM-AUTO-REFUND-SW                 PIC X.
  5479         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5480         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5481     12  AM-GPCD                           PIC 99.
  5482     12  AM-IG                             PIC X.
  5483         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5484         88  AM-HAS-GROUP                     VALUE '2'.
  5485     12  AM-STATUS                         PIC X.
  5486         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5487         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5488         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5489         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5490         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5491         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5492     12  AM-REMIT-TO                       PIC 99.
  5493     12  AM-ID-NO                          PIC X(11).
  5494
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 101
* EL130.cbl
  5495     12  AM-CAL-TABLE                      PIC XX.
  5496     12  AM-LF-DEVIATION                   PIC XXX.
  5497     12  AM-AH-DEVIATION                   PIC XXX.
  5498     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5499     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5500     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5501     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5502     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5503     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5504
  5505     12  AM-USER-FIELDS.
  5506         16  AM-FLD-1                      PIC XX.
  5507         16  AM-FLD-2                      PIC XX.
  5508         16  AM-FLD-3                      PIC XX.
  5509         16  AM-FLD-4                      PIC XX.
  5510         16  AM-FLD-5                      PIC XX.
  5511
  5512     12  AM-1ST-PROD-DATE.
  5513         16  AM-1ST-PROD-YR                PIC XX.
  5514         16  AM-1ST-PROD-MO                PIC XX.
  5515         16  AM-1ST-PROD-DA                PIC XX.
  5516     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5517     12  AM-CERTS-PURGED-DATE.
  5518         16  AM-PUR-YR                     PIC XX.
  5519         16  AM-PUR-MO                     PIC XX.
  5520         16  AM-PUR-DA                     PIC XX.
  5521     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5522     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5523     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5524     12  AM-INACTIVE-DATE.
  5525         16  AM-INA-MO                     PIC 99.
  5526         16  AM-INA-DA                     PIC 99.
  5527         16  AM-INA-YR                     PIC 99.
  5528     12  AM-AR-HI-CERT-DATE                PIC XX.
  5529
  5530     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5531     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5532
  5533     12  AM-OB-PAYMENT-MODE                PIC X.
  5534         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5535         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5536         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5537         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5538
  5539     12  AM-AH-ONLY-INDICATOR              PIC X.
  5540         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5541         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5542
  5543     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5544
  5545     12  AM-OVER-SHORT.
  5546         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5547         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5548
  5549     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5550     12  AM-DCC-CLP-STATE                  PIC XX.
  5551
  5552     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 102
* EL130.cbl
  5553     12  AM-RECALC-REIN                    PIC X.
  5554
  5555     12  AM-REI-TABLE                      PIC XXX.
  5556     12  AM-REI-ET-LF                      PIC X.
  5557     12  AM-REI-ET-AH                      PIC X.
  5558     12  AM-REI-PE-LF                      PIC X.
  5559     12  AM-REI-PE-AH                      PIC X.
  5560     12  AM-REI-PRT-ST                     PIC X.
  5561     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5562     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5563     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5564     12  AM-REI-GROUP-A                    PIC X(6).
  5565     12  AM-REI-MORT                       PIC X(4).
  5566     12  AM-REI-PRT-OW                     PIC X.
  5567     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5568     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5569     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5570     12  AM-REI-GROUP-B                    PIC X(6).
  5571
  5572     12  AM-TRUST-TYPE                     PIC X(2).
  5573
  5574     12  AM-EMPLOYER-STMT-USED             PIC X.
  5575     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5576
  5577     12  AM-STD-AH-TYPE                    PIC XX.
  5578     12  AM-EARN-METHODS.
  5579         16  AM-EARN-METHOD-R              PIC X.
  5580             88 AM-REF-RL-R78                 VALUE 'R'.
  5581             88 AM-REF-RL-PR                  VALUE 'P'.
  5582             88 AM-REF-RL-MEAN                VALUE 'M'.
  5583             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5584         16  AM-EARN-METHOD-L              PIC X.
  5585             88 AM-REF-LL-R78                 VALUE 'R'.
  5586             88 AM-REF-LL-PR                  VALUE 'P'.
  5587             88 AM-REF-LL-MEAN                VALUE 'M'.
  5588             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5589         16  AM-EARN-METHOD-A              PIC X.
  5590             88 AM-REF-AH-R78                 VALUE 'R'.
  5591             88 AM-REF-AH-PR                  VALUE 'P'.
  5592             88 AM-REF-AH-MEAN                VALUE 'M'.
  5593             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5594             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5595             88 AM-REF-AH-NET                 VALUE 'N'.
  5596
  5597     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5598     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5599     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5600
  5601     12  AM-RET-Y-N                        PIC X.
  5602     12  AM-RET-P-E                        PIC X.
  5603     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5604     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5605     12  AM-RET-GRP                        PIC X(6).
  5606     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5607         16  AM-POOL-PRIME                 PIC XXX.
  5608         16  AM-POOL-SUB                   PIC XXX.
  5609     12  AM-RETRO-EARNINGS.
  5610         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 103
* EL130.cbl
  5611         16  AM-RET-EARN-L                 PIC X.
  5612         16  AM-RET-EARN-A                 PIC X.
  5613     12  AM-RET-ST-TAX-USE                 PIC X.
  5614         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5615         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5616     12  AM-RETRO-BEG-EARNINGS.
  5617         16  AM-RET-BEG-EARN-R             PIC X.
  5618         16  AM-RET-BEG-EARN-L             PIC X.
  5619         16  AM-RET-BEG-EARN-A             PIC X.
  5620     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5621     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5622
  5623     12  AM-USER-SELECT-OPTIONS.
  5624         16  AM-USER-SELECT-1              PIC X(10).
  5625         16  AM-USER-SELECT-2              PIC X(10).
  5626         16  AM-USER-SELECT-3              PIC X(10).
  5627         16  AM-USER-SELECT-4              PIC X(10).
  5628         16  AM-USER-SELECT-5              PIC X(10).
  5629
  5630     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5631
  5632     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5633
  5634     12  AM-RPT045A-SWITCH                 PIC X.
  5635         88  RPT045A-OFF                   VALUE 'N'.
  5636
  5637     12  AM-INSURANCE-LIMITS.
  5638         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5639         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5640
  5641     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5642         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5643
  5644     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5645         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5646         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5647
  5648     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5649
  5650     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5651     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5652     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5653     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5654     12  AM-DCC-UEF-STATE                  PIC XX.
  5655     12  FILLER                            PIC XXX.
  5656     12  AM-REPORT-CODE-3                  PIC X(10).
  5657*    12  FILLER                            PIC X(22).
  5658
  5659     12  AM-RESERVE-DATE.
  5660         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5661         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5662         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5663
  5664     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5665     12  AM-NOTIFICATION-TYPES.
  5666         16  AM-NOTIF-OF-LETTERS           PIC X.
  5667         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5668         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 104
* EL130.cbl
  5669         16  AM-NOTIF-OF-STATUS            PIC X.
  5670
  5671     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5672         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5673         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5674         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5675         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5676
  5677     12  AM-BENEFIT-CONTROLS.
  5678         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5679             20  AM-BENEFIT-CODE           PIC XX.
  5680             20  AM-BENEFIT-TYPE           PIC X.
  5681             20  AM-BENEFIT-REVISION       PIC XXX.
  5682             20  AM-BENEFIT-REM-TERM       PIC X.
  5683             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5684             20  FILLER                    PIC XX.
  5685         16  FILLER                        PIC X(80).
  5686
  5687     12  AM-TRANSFER-DATA.
  5688         16  AM-TRANSFERRED-FROM.
  5689             20  AM-TRNFROM-CARRIER        PIC X.
  5690             20  AM-TRNFROM-GROUPING.
  5691                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5692                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5693             20  AM-TRNFROM-STATE          PIC XX.
  5694             20  AM-TRNFROM-ACCOUNT.
  5695                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5696                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5697             20  AM-TRNFROM-DTE            PIC XX.
  5698         16  AM-TRANSFERRED-TO.
  5699             20  AM-TRNTO-CARRIER          PIC X.
  5700             20  AM-TRNTO-GROUPING.
  5701                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5702                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5703             20  AM-TRNTO-STATE            PIC XX.
  5704             20  AM-TRNTO-ACCOUNT.
  5705                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5706                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5707             20  AM-TRNTO-DTE              PIC XX.
  5708         16  FILLER                        PIC X(10).
  5709
  5710     12  AM-SAVED-REMIT-TO                 PIC 99.
  5711
  5712     12  AM-COMM-STRUCTURE-SAVED.
  5713         16  AM-DEFN-1-SAVED.
  5714             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5715                 24  AM-AGT-SV             PIC X(10).
  5716                 24  AM-COM-TYP-SV         PIC X.
  5717                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5718                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5719                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5720                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5721                 24  FILLER                PIC X.
  5722                 24  AM-GL-CODES-SV        PIC X.
  5723                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5724                 24  FILLER                PIC X.
  5725         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5726             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 105
* EL130.cbl
  5727                 24  FILLER                PIC X(11).
  5728                 24  AM-L-COMA-SV          PIC XXX.
  5729                 24  AM-J-COMA-SV          PIC XXX.
  5730                 24  AM-A-COMA-SV          PIC XXX.
  5731                 24  FILLER                PIC X(6).
  5732
  5733     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5734         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5735            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5736            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5737            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5738
  5739     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5740     12  FILLER                            PIC X(120).
  5741
  5742     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5743         16  AM-CONTROL-NAME               PIC X(30).
  5744         16  AM-EXECUTIVE-ONE.
  5745             20  AM-EXEC1-NAME             PIC X(15).
  5746             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5747                                                          COMP-3.
  5748             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5749                                                          COMP-3.
  5750         16  AM-EXECUTIVE-TWO.
  5751             20  AM-EXEC2-NAME             PIC X(15).
  5752             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5753                                                          COMP-3.
  5754             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5755                                                          COMP-3.
  5756
  5757     12  AM-RETRO-ADDITIONAL-DATA.
  5758         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5759         16  AM-RETRO-PREM-P-E             PIC X.
  5760         16  AM-RETRO-CLMS-P-I             PIC X.
  5761         16  AM-RETRO-RET-BRACKET-LF.
  5762             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5763                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5764                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5765             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5766                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5767                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5768             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5769                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5770                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5771         16  AM-RETRO-RET-BRACKET-AH.
  5772             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5773                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5774                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5775                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5776             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5777                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5778                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5779             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5780                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5781                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5782
  5783     12  AM-COMMENTS.
  5784         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 106
* EL130.cbl
  5785
  5786     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5787         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5788         16  AM-FLI-BILLING-CODE           PIC X.
  5789         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5790         16  AM-FLI-UNITED-IDENT           PIC X.
  5791         16  AM-FLI-INTEREST-LOST-DATA.
  5792             20  AM-FLI-BANK-NO            PIC X(5).
  5793             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5794             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5795             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5796         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5797             20  AM-FLI-AGT                PIC X(9).
  5798             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5799             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5800         16  FILLER                        PIC X(102).
  5801
  5802     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5803         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5804             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5805             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5806             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5807             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5808             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5809         16  FILLER                          PIC X(10).
  5810******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 107
* EL130.cbl
  5812*    COPY ELCTRLR.
  5813******************************************************************
  5814*                                                                *
  5815*                            ELCTRLR.                            *
  5816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5817*                            VMOD=2.014                          *
  5818*                                                                *
  5819*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5820*                                                                *
  5821*   FILE TYPE = VSAM,KSDS                                        *
  5822*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5823*                                                                *
  5824*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5825*       ALTERNATE INDEX = NONE                                   *
  5826*                                                                *
  5827*   LOG = YES                                                    *
  5828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5829******************************************************************
  5830*                   C H A N G E   L O G
  5831*
  5832* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5833*-----------------------------------------------------------------
  5834*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5835* EFFECTIVE    NUMBER
  5836*-----------------------------------------------------------------
  5837* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5838* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5839* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5840* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5841* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5842* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5843* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5844* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5845* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5846* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5847* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5848* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5849* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5850* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5851* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5852* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5853* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5854* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5855* 040814    2014030500002  AJRA  ADD ICD CODES
  5856* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5857******************************************************************
  5858 01  ACTIVITY-TRAILERS.
  5859     12  AT-RECORD-ID                    PIC XX.
  5860         88  VALID-AT-ID                       VALUE 'AT'.
  5861
  5862     12  AT-CONTROL-PRIMARY.
  5863         16  AT-COMPANY-CD               PIC X.
  5864         16  AT-CARRIER                  PIC X.
  5865         16  AT-CLAIM-NO                 PIC X(7).
  5866         16  AT-CERT-NO.
  5867             20  AT-CERT-PRIME           PIC X(10).
  5868             20  AT-CERT-SFX             PIC X.
  5869         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 108
* EL130.cbl
  5870             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5871             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5872             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5873             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5874             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5875             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5876             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5877             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5878             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5879             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5880             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5881             88  AT-BENEFICIARY-TRL           VALUE +91.
  5882             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5883             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5884             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5885             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5886
  5887     12  AT-TRAILER-TYPE                 PIC X.
  5888         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5889         88  PAYMENT-TR                       VALUE '2'.
  5890         88  AUTO-PAY-TR                      VALUE '3'.
  5891         88  CORRESPONDENCE-TR                VALUE '4'.
  5892         88  ADDRESS-TR                       VALUE '5'.
  5893         88  GENERAL-INFO-TR                  VALUE '6'.
  5894         88  AUTO-PROMPT-TR                   VALUE '7'.
  5895         88  DENIAL-TR                        VALUE '8'.
  5896         88  INCURRED-CHG-TR                  VALUE '9'.
  5897         88  FORM-CONTROL-TR                  VALUE 'A'.
  5898
  5899     12  AT-RECORDED-DT                  PIC XX.
  5900     12  AT-RECORDED-BY                  PIC X(4).
  5901     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5902
  5903     12  AT-TRAILER-BODY                 PIC X(165).
  5904
  5905     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5906         16  AT-RESERVE-CONTROLS.
  5907             20  AT-MANUAL-SW            PIC X.
  5908                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5909             20  AT-FUTURE-SW            PIC X.
  5910                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5911             20  AT-PTC-SW               PIC X.
  5912                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5913             20  AT-IBNR-SW              PIC X.
  5914                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5915             20  AT-PTC-LF-SW            PIC X.
  5916                 88  AT-LF-PTC-USED          VALUE '1'.
  5917             20  AT-CDT-ACCESS-METHOD    PIC X.
  5918                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5919                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5920                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5921             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5922         16  AT-LAST-COMPUTED-DT         PIC XX.
  5923         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5924         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5925         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5926         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5927         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 109
* EL130.cbl
  5928         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5929         16  AT-EXPENSE-CONTROLS.
  5930             20  AT-EXPENSE-METHOD       PIC X.
  5931                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5932                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5933                 88  PERCENT-OF-PMT           VALUE '3'.
  5934                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5935             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5936             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5937         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5938         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5939
  5940         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5941         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5942
  5943*        16  FILLER                      PIC X(53).
  5944         16  FILLER                      PIC X(47).
  5945
  5946         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5947         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5948
  5949         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5950             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5951             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5952*                    C = CLOSED
  5953*                    O = OPEN
  5954             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5955*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5956
  5957     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5958         16  AT-PAYMENT-TYPE             PIC X.
  5959             88  PARTIAL-PAYMENT                VALUE '1'.
  5960             88  FINAL-PAYMENT                  VALUE '2'.
  5961             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5962             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5963             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5964             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5965             88  VOIDED-PAYMENT                 VALUE '9'.
  5966             88  TRANSFER                       VALUE 'T'.
  5967             88  LIFE-INTEREST                  VALUE 'I'.
  5968
  5969         16  AT-CLAIM-TYPE               PIC X.
  5970             88  PAID-FOR-AH                    VALUE 'A'.
  5971             88  PAID-FOR-LIFE                  VALUE 'L'.
  5972             88  PAID-FOR-IUI                   VALUE 'I'.
  5973             88  PAID-FOR-GAP                   VALUE 'G'.
  5974             88  PAID-FOR-FAM                   VALUE 'F'.
  5975         16  AT-CLAIM-PREM-TYPE          PIC X.
  5976             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5977             88  AT-O-B-COVERAGE                VALUE '2'.
  5978             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5979         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5980         16  AT-CHECK-NO                 PIC X(7).
  5981         16  AT-PAID-FROM-DT             PIC XX.
  5982         16  AT-PAID-THRU-DT             PIC XX.
  5983         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5984         16  FILLER                      PIC X.
  5985         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 110
* EL130.cbl
  5986         16  AT-PAYMENT-ORIGIN           PIC X.
  5987             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5988             88  ONLINE-AUTO-PMT                VALUE '2'.
  5989             88  OFFLINE-PMT                    VALUE '3'.
  5990         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5991         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5992         16  AT-VOID-DATA.
  5993             20  AT-VOID-DT              PIC XX.
  5994*00144       20  AT-VOID-REASON          PIC X(30).
  5995             20  AT-VOID-REASON          PIC X(26).
  5996         16  AT-PMT-APPROVED-BY          PIC X(04).
  5997         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5998         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5999         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6000                                         PIC S99V9(5)  COMP-3.
  6001         16  AT-CREDIT-INTERFACE.
  6002             20  AT-PMT-SELECT-DT        PIC XX.
  6003                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6004             20  AT-PMT-ACCEPT-DT        PIC XX.
  6005                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6006             20  AT-VOID-SELECT-DT       PIC XX.
  6007                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6008             20  AT-VOID-ACCEPT-DT       PIC XX.
  6009                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6010
  6011         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6012                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6013                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6014         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6015
  6016         16  AT-FORCE-CONTROL            PIC X.
  6017             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6018         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6019         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6020         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6021         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6022         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6023         16  AT-BENEFIT-TYPE             PIC X.
  6024
  6025         16  AT-EXPENSE-TYPE             PIC X.
  6026         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6027
  6028         16  AT-PAYEE-TYPE-CD.
  6029             20  AT-PAYEE-TYPE           PIC X.
  6030                 88  INSURED-PAID           VALUE 'I'.
  6031                 88  BENEFICIARY-PAID       VALUE 'B'.
  6032                 88  ACCOUNT-PAID           VALUE 'A'.
  6033                 88  OTHER-1-PAID           VALUE 'O'.
  6034                 88  OTHER-2-PAID           VALUE 'Q'.
  6035                 88  DOCTOR-PAID            VALUE 'P'.
  6036                 88  EMPLOYER-PAID          VALUE 'E'.
  6037             20  AT-PAYEE-SEQ            PIC X.
  6038
  6039         16  AT-CASH-PAYMENT             PIC X.
  6040         16  AT-GROUPED-PAYMENT          PIC X.
  6041         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6042         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6043         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 111
* EL130.cbl
  6044         16  AT-VOID-TYPE                PIC X.
  6045             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6046             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6047         16  AT-AIG-UNEMP-IND            PIC X.
  6048             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6049         16  AT-ASSOCIATES               PIC X.
  6050             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6051             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6052
  6053         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6054         16  AT-CV-PMT-CODE              PIC X.
  6055             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6056             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6057             88  FULL-ADD-PAYMENT           VALUE '3'.
  6058             88  HALF-ADD-PAYMENT           VALUE '4'.
  6059             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6060             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6061             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6062             88  ADDL-PAYMENT               VALUE '8'.
  6063
  6064         16  AT-EOB-CODE1                PIC XXX.
  6065         16  AT-EOB-CODE2                PIC XXX.
  6066         16  AT-EOB-CODE3                PIC XXX.
  6067         16  FILLER REDEFINES AT-EOB-CODE3.
  6068             20  AT-PRINT-CLM-FORM       PIC X.
  6069             20  AT-PRINT-SURVEY         PIC X.
  6070             20  AT-SPECIAL-RELEASE      PIC X.
  6071         16  AT-EOB-CODE4                PIC XXX.
  6072         16  FILLER REDEFINES AT-EOB-CODE4.
  6073             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6074             20  FILLER                  PIC X.
  6075         16  AT-EOB-CODE5                PIC XXX.
  6076         16  FILLER REDEFINES AT-EOB-CODE5.
  6077             20  AT-PMT-PROOF-DT         PIC XX.
  6078             20  FILLER                  PIC X.
  6079
  6080         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6081             88  AT-PRINT-EOB            VALUE 'Y'.
  6082
  6083         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6084         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6085
  6086     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6087         16  AT-SCHEDULE-START-DT        PIC XX.
  6088         16  AT-SCHEDULE-END-DT          PIC XX.
  6089         16  AT-TERMINATED-DT            PIC XX.
  6090         16  AT-LAST-PMT-TYPE            PIC X.
  6091             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6092             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6093         16  AT-FIRST-PMT-DATA.
  6094             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6095             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6096             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6097         16  AT-REGULAR-PMT-DATA.
  6098             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6099             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6100             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6101         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 112
* EL130.cbl
  6102             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6103                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6104                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6105                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6106                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6107                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6108             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6109         16  AT-AUTO-PAY-DAY             PIC 99.
  6110         16  AT-AUTO-CASH                PIC X.
  6111             88  AT-CASH                      VALUE 'Y'.
  6112             88  AT-NON-CASH                  VALUE 'N'.
  6113*        16  FILLER                      PIC X(129).
  6114         16  AT-AUTO-END-LETTER          PIC X(4).
  6115         16  FILLER                      PIC X(125).
  6116
  6117         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6118         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6119
  6120     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6121         16  AT-LETTER-SENT-DT           PIC XX.
  6122         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6123         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6124         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6125         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6126         16  AT-LETTER-ORIGIN            PIC X.
  6127             88  ONLINE-CREATION              VALUE '1' '3'.
  6128             88  OFFLINE-CREATION             VALUE '2' '4'.
  6129             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6130             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6131         16  AT-STD-LETTER-FORM          PIC X(4).
  6132         16  AT-REASON-TEXT              PIC X(70).
  6133         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6134         16  AT-ADDRESEE-TYPE            PIC X.
  6135              88  INSURED-ADDRESEE            VALUE 'I'.
  6136              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6137              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6138              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6139              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6140              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6141              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6142         16  AT-ADDRESSEE-NAME           PIC X(30).
  6143         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6144         16  AT-RESEND-PRINT-DATE        PIC XX.
  6145         16  AT-CORR-SOL-UNSOL           PIC X.
  6146         16  AT-LETTER-PURGED-DT         PIC XX.
  6147*
  6148*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6149*
  6150         16  AT-CSO-REDEFINITION.
  6151             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6152             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6153             20  AT-LETTER-TO-BENE       PIC X(1).
  6154             20  AT-STOP-LETTER-DT       PIC X(2).
  6155             20  FILLER                  PIC X(19).
  6156*             20  FILLER                  PIC X(27).
  6157             20  AT-CSO-LETTER-STATUS    PIC X.
  6158                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6159                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 113
* EL130.cbl
  6160                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6161             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6162             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6163*
  6164*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6165*
  6166*        16  FILLER                      PIC X(26).
  6167*
  6168*        16  AT-DMD-BSR-CODE             PIC X.
  6169*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6170*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6171*
  6172*        16  AT-DMD-LETTER-STATUS        PIC X.
  6173*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6174*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6175*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6176*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6177*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6178
  6179         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6180         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6181
  6182     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6183         16  AT-ADDRESS-TYPE             PIC X.
  6184             88  INSURED-ADDRESS               VALUE 'I'.
  6185             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6186             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6187             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6188             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6189             88  OTHER-ADDRESS-1               VALUE 'O'.
  6190             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6191         16  AT-MAIL-TO-NAME             PIC X(30).
  6192         16  AT-ADDRESS-LINE-1           PIC X(30).
  6193         16  AT-ADDRESS-LINE-2           PIC X(30).
  6194         16  AT-CITY-STATE.
  6195             20  AT-CITY                 PIC X(28).
  6196             20  AT-STATE                PIC XX.
  6197         16  AT-ZIP.
  6198             20  AT-ZIP-CODE.
  6199                 24  AT-ZIP-1ST          PIC X.
  6200                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6201                 24  FILLER              PIC X(4).
  6202             20  AT-ZIP-PLUS4            PIC X(4).
  6203         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6204             20  AT-CAN-POSTAL-1         PIC XXX.
  6205             20  AT-CAN-POSTAL-2         PIC XXX.
  6206             20  FILLER                  PIC XXX.
  6207         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6208*         16  FILLER                      PIC X(23).
  6209         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6210         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6211         16  FILLER                      PIC X(13).
  6212         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6213         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6214
  6215     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6216         16  AT-INFO-LINE-1              PIC X(60).
  6217         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 114
* EL130.cbl
  6218             20  AT-NOTE-ERROR-NO OCCURS 15
  6219                                         PIC X(4).
  6220         16  AT-INFO-LINE-2              PIC X(60).
  6221         16  FILLER REDEFINES AT-INFO-LINE-2.
  6222             20  AT-ICD-CODE-1           PIC X(8).
  6223             20  AT-ICD-CODE-2           PIC X(8).
  6224             20  FILLER                  PIC X(44).
  6225         16  AT-INFO-TRAILER-TYPE        PIC X.
  6226             88  AT-ERRORS-NOTE          VALUE 'E'.
  6227             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6228             88  AT-CALL-NOTE            VALUE 'C'.
  6229             88  AT-MAINT-NOTE           VALUE 'M'.
  6230             88  AT-CERT-CHANGE          VALUE 'X'.
  6231             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6232             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6233             88  AT-CERT-CANCELLED       VALUE 'T'.
  6234         16  AT-CALL-TYPE                PIC X.
  6235             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6236             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6237         16  AT-NOTE-CONTINUATION        PIC X.
  6238             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6239         16  AT-EOB-CODES-EXIST          PIC X.
  6240             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6241         16  FILLER                      PIC X(35).
  6242         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6243         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6244
  6245     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6246         16  AT-PROMPT-LINE-1            PIC X(60).
  6247         16  AT-PROMPT-LINE-2            PIC X(60).
  6248         16  AT-PROMPT-START-DT          PIC XX.
  6249         16  AT-PROMPT-END-DT            PIC XX.
  6250         16  FILLER                      PIC X(35).
  6251         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6252         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6253
  6254     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6255         16  AT-DENIAL-INFO-1            PIC X(60).
  6256         16  AT-DENIAL-INFO-2            PIC X(60).
  6257         16  AT-DENIAL-DT                PIC XX.
  6258         16  AT-RETRACTION-DT            PIC XX.
  6259         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6260*         16  FILLER                      PIC X(31).
  6261         16  AT-DENIAL-PROOF-DT          PIC XX.
  6262         16  FILLER                      PIC X(29).
  6263         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6264         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6265
  6266     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6267         16  AT-OLD-INCURRED-DT          PIC XX.
  6268         16  AT-OLD-REPORTED-DT          PIC XX.
  6269         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6270         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6271         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6272         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6273         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6274         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6275         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 115
* EL130.cbl
  6276         16  AT-OLD-DIAG-CODE            PIC X(6).
  6277         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6278         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6279         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6280         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6281         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6282         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6283         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6284         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6285         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6286         16  FILLER                      PIC X(9).
  6287         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6288
  6289     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6290         16  AT-FORM-SEND-ON-DT          PIC XX.
  6291         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6292         16  AT-FORM-RE-SEND-DT          PIC XX.
  6293         16  AT-FORM-ANSWERED-DT         PIC XX.
  6294         16  AT-FORM-PRINTED-DT          PIC XX.
  6295         16  AT-FORM-REPRINT-DT          PIC XX.
  6296         16  AT-FORM-TYPE                PIC X.
  6297             88  INITIAL-FORM                  VALUE '1'.
  6298             88  PROGRESS-FORM                 VALUE '2'.
  6299         16  AT-INSTRUCT-LN-1            PIC X(28).
  6300         16  AT-INSTRUCT-LN-2            PIC X(28).
  6301         16  AT-INSTRUCT-LN-3            PIC X(28).
  6302         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6303         16  AT-FORM-ADDRESS             PIC X.
  6304             88  FORM-TO-INSURED              VALUE 'I'.
  6305             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6306             88  FORM-TO-OTHER-1              VALUE 'O'.
  6307             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6308         16  AT-RELATED-1.
  6309             20 AT-REL-CARR-1            PIC X.
  6310             20 AT-REL-CLAIM-1           PIC X(7).
  6311             20 AT-REL-CERT-1            PIC X(11).
  6312         16  AT-RELATED-2.
  6313             20 AT-REL-CARR-2            PIC X.
  6314             20 AT-REL-CLAIM-2           PIC X(7).
  6315             20 AT-REL-CERT-2            PIC X(11).
  6316         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6317         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6318         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6319         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6320         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6321         16  AT-STOP-FORM-DT             PIC X(2).
  6322
  6323         16  FILLER                      PIC X(09).
  6324         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6325         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6326******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 116
* EL130.cbl
  6328*    COPY ELCBENE.
  6329******************************************************************
  6330*                                                                *
  6331*                            ELCBENE.                            *
  6332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6333*                            VMOD=2.006                          *
  6334*                                                                *
  6335*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6336*                                                                *
  6337*   FILE TYPE = VSAM,KSDS                                        *
  6338*   RECORD SIZE = 500   RECFORM = FIX                            *
  6339*                                                                *
  6340*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6341*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6342*                                                                *
  6343*   LOG = YES                                                    *
  6344*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6345*                                                                *
  6346*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6347******************************************************************
  6348
  6349 01  BENEFICIARY-MASTER.
  6350     12  BE-RECORD-ID                PIC XX.
  6351         88  VALID-BE-ID                VALUE 'BE'.
  6352
  6353     12  BE-CONTROL-PRIMARY.
  6354         16  BE-COMPANY-CD           PIC X.
  6355         16  BE-RECORD-TYPE          PIC X.
  6356             88  BENEFICIARY-RECORD  VALUE 'B'.
  6357             88  ADJUSTOR-RECORD     VALUE 'A'.
  6358         16  BE-BENEFICIARY          PIC X(10).
  6359     12  BE-CONTROL-BY-NAME.
  6360         16  BE-COMPANY-CD-A1        PIC X.
  6361         16  BE-RECORD-TYPE-A1       PIC X.
  6362         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6363         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6364
  6365     12  BE-LAST-MAINT-DT            PIC XX.
  6366     12  BE-LAST-MAINT-BY            PIC X(4).
  6367     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6368
  6369     12  BE-ADDRESS-DATA.
  6370         16  BE-MAIL-TO-NAME         PIC X(30).
  6371         16  BE-ADDRESS-LINE-1       PIC X(30).
  6372         16  BE-ADDRESS-LINE-2       PIC X(30).
  6373         16  BE-ADDRESS-LINE-3       PIC X(30).
  6374         16  BE-CITY-STATE.
  6375             20  BE-CITY             PIC X(28).
  6376             20  BE-STATE            PIC XX.
  6377         16  BE-ZIP-CODE.
  6378             20  BE-ZIP-PRIME.
  6379                 24  BE-ZIP-1ST      PIC X.
  6380                     88  BE-CANADIAN-POST-CODE
  6381                                         VALUE 'A' THRU 'Z'.
  6382                 24  FILLER          PIC X(4).
  6383             20  BE-ZIP-PLUS4        PIC X(4).
  6384         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6385             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 117
* EL130.cbl
  6386             20  BE-CAN-POSTAL-2     PIC XXX.
  6387             20  FILLER              PIC XXX.
  6388         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6389         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6390
  6391******************************************************************
  6392*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6393*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6394******************************************************************
  6395     12  BE-CARRIER                  PIC X.
  6396
  6397     12  BE-ADDRESS-DATA2.
  6398         16  BE-MAIL-TO-NAME2        PIC X(30).
  6399         16  BE-ADDRESS-LINE-12      PIC X(30).
  6400         16  BE-ADDRESS-LINE-22      PIC X(30).
  6401         16  BE-ADDRESS-LINE-32      PIC X(30).
  6402         16  BE-CITY-STATE2.
  6403             20  BE-CITY2            PIC X(28).
  6404             20  BE-STATE2           PIC XX.
  6405         16  BE-ZIP-CODE2.
  6406             20  BE-ZIP-PRIME2.
  6407                 24  BE-ZIP-1ST2     PIC X.
  6408                     88  BE-CANADIAN-POST-CODE2
  6409                                         VALUE 'A' THRU 'Z'.
  6410                 24  FILLER          PIC X(4).
  6411             20  BE-ZIP-PLUS42       PIC X(4).
  6412         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6413             20  BE-CAN-POSTAL-12    PIC XXX.
  6414             20  BE-CAN-POSTAL-22    PIC XXX.
  6415             20  FILLER              PIC XXX.
  6416         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6417         16  BE-BILLING-STMT-DATA.
  6418             20  BE-BSR              PIC X.
  6419                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6420                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6421             20  BE-BSR-FROM         PIC X(30).
  6422             20  BE-BSR-DEPT         PIC X(30).
  6423             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6424             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6425             20  BE-OUTPUT-TYPE      PIC X.
  6426                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6427                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6428
  6429     12  FILLER                      PIC X(28).
  6430******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 118
* EL130.cbl
  6432*    COPY ELCDAR.
  6433******************************************************************
  6434*                                                                *
  6435*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6436*   FILE TYPE = VSAM,KSDS                                        *
  6437*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6438*   BASE CLUSTER = DLYACTV                                       *
  6439*   LOG = YES                                                    *
  6440*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6441*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6442*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6443*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6444*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6445*               BY PROGRAM "LGINFCE".                            *
  6446*                                                                *
  6447******************************************************************
  6448 01  DAILY-ACTIVITY-RECORD.
  6449     05  DA-KEY.
  6450         10  DA-COMP-CD          PIC X.
  6451         10  DA-CARRIER          PIC X.
  6452         10  DA-CLAIM-NO         PIC X(7).
  6453         10  DA-CERT-NO.
  6454             15  DA-CERT-PRIME   PIC X(10).
  6455             15  DA-CERT-SFX     PIC X.
  6456     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6457     05  DA-RECORD-TYPE          PIC X.
  6458     05  FILLER                  PIC X(2).
  6459******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 119
* EL130.cbl
  6461*    COPY ELCACTQ.
  6462******************************************************************
  6463*                                                                *
  6464*                            ELCACTQ.                            *
  6465*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6466*                            VMOD=2.004                          *
  6467*                                                                *
  6468*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6469*                                                                *
  6470*   FILE TYPE = VSAM,KSDS                                        *
  6471*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6472*                                                                *
  6473*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6474*       ALTERNATE INDEX = NONE                                   *
  6475*                                                                *
  6476*   LOG = YES                                                    *
  6477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6478*                                                                *
  6479*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6480******************************************************************
  6481
  6482 01  ACTIVITY-QUE.
  6483     12  AQ-RECORD-ID                PIC XX.
  6484         88  VALID-AQ-ID                VALUE 'AQ'.
  6485
  6486     12  AQ-CONTROL-PRIMARY.
  6487         16  AQ-COMPANY-CD           PIC X.
  6488         16  AQ-CARRIER              PIC X.
  6489         16  AQ-CLAIM-NO             PIC X(7).
  6490         16  AQ-CERT-NO.
  6491             20  AQ-CERT-PRIME       PIC X(10).
  6492             20  AQ-CERT-SFX         PIC X.
  6493
  6494     12  AQ-PENDING-ACTIVITY-FLAGS.
  6495         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6496         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6497             88  PENDING-PAYMENTS       VALUE '1'.
  6498         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6499             88  PENDING-FULL-PRINT     VALUE '1'.
  6500             88  PENDING-PART-PRINT     VALUE '2'.
  6501         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6502             88  PENDING-LETTERS        VALUE '1'.
  6503         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6504             88  PENDING-RESTORE        VALUE 'C'.
  6505             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6506
  6507     12  FILLER                      PIC X(20).
  6508
  6509     12  AQ-RESEND-DATE              PIC XX.
  6510     12  AQ-FOLLOWUP-DATE            PIC XX.
  6511     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6512     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6513     12  AQ-AUTO-LETTER              PIC X(4).
  6514     12  FILLER                      PIC XX.
  6515     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6516*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 120
* EL130.cbl
  6518*    COPY ELCARCH.
  6519******************************************************************
  6520*                                                                *
  6521*                            ELCARCH.                            *
  6522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6523*                            VMOD=2.007                          *
  6524*                                                                *
  6525*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6526*                                                                *
  6527*   FILE TYPE = VSAM,KSDS                                        *
  6528*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6529*                                                                *
  6530*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6531*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6532*                                                                *
  6533*   LOG = NO                                                     *
  6534*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6535*                                                                *
  6536*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6537******************************************************************
  6538 01  LETTER-ARCHIVE.
  6539     12  LA-RECORD-ID                PIC XX.
  6540         88  VALID-LA-ID                VALUE 'LA'.
  6541
  6542     12  LA-CONTROL-PRIMARY.
  6543         16  LA-COMPANY-CD           PIC X.
  6544         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6545         16  LA-RECORD-TYPE          PIC X.
  6546             88  LA-HEADER-DATA         VALUE '1'.
  6547             88  LA-ADDRESS-DATA        VALUE '2'.
  6548             88  LA-TEXT-DATA           VALUE '3'.
  6549             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6550         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6551
  6552     12  LA-CONTROL-BY-TYPE.
  6553         16  LA-COMPANY-CD-A1        PIC X.
  6554         16  LA-RECORD-TYPE-A1       PIC X.
  6555         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6556         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6557
  6558     12  LA-TEXT-RECORD.
  6559         16  LA-SKIP-CONTROL         PIC XX.
  6560             88  NO-LINES-SKIPPED       VALUE SPACES.
  6561             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6562         16  LA-TEXT-LINE            PIC X(70).
  6563
  6564     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6565         16  FILLER                  PIC XX.
  6566         16  LA-ADDRESS-LINE         PIC X(30).
  6567         16  FILLER                  PIC X(40).
  6568
  6569     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6570         16  FILLER                  PIC XX.
  6571         16  LA-CARRIER              PIC X.
  6572         16  LA-CLAIM-NO             PIC X(7).
  6573         16  LA-CERT-NO.
  6574             20  LA-CERT-PRIME       PIC X(10).
  6575             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 121
* EL130.cbl
  6576         16  LA-NO-OF-COPIES         PIC S9.
  6577         16  LA-RESEND-DATE          PIC XX.
  6578         16  LA-PROCESSOR-CD         PIC X(4).
  6579         16  LA-CREATION-DT          PIC XX.
  6580         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6581         16  LA-RESEND-PRINT-DATE    PIC XX.
  6582         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6583         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6584*
  6585* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6586*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6587*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6588*   I        20  LA-DMD-RES-ST           PIC XX.
  6589*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6590*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6591*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6592*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6593*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6594*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6595*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6596*   I        20  LA-DMD-UND-CODE         PIC XX.
  6597*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6598*   V    16  FILLER                  PIC X(15).
  6599* -----
  6600*
  6601* REINSERTED  CSO  MODS
  6602*
  6603         16  FILLER.
  6604             20  FILLER                  PIC X(29).
  6605             20  LA-CSO-LETTER-STATUS    PIC X.
  6606                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6607                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6608                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6609             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6610             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6611*
  6612
  6613     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6614         16  FILLER                  PIC XX.
  6615         16  LA4-CARRIER             PIC X.
  6616         16  LA4-CLAIM-NO            PIC X(7).
  6617         16  LA4-CERT-NO.
  6618             20  LA4-CERT-PRIME      PIC X(10).
  6619             20  LA4-CERT-SFX        PIC X.
  6620         16  LA4-NO-OF-COPIES        PIC S9.
  6621         16  LA4-RESEND-DATE         PIC XX.
  6622         16  LA4-PROCESSOR-CD        PIC X(4).
  6623         16  LA4-CREATION-DT         PIC XX.
  6624         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6625         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6626         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6627         16  LA4-FORM-TYPE           PIC X.
  6628             88  LA4-INITIAL-FORM    VALUE '1'.
  6629             88  LA4-PROGRESS-FORM   VALUE '2'.
  6630         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6631         16  LA4-STATE               PIC X(02).
  6632         16  FILLER                  PIC X(31).
  6633******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 122
* EL130.cbl
  6635*    COPY ERCREIN.
  6636******************************************************************
  6637*                                                                *
  6638*                            ERCREIN                             *
  6639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6640*                            VMOD=2.010                          *
  6641*                                                                *
  6642*   ONLINE CREDIT SYSTEM                                         *
  6643*                                                                *
  6644*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6645*                                                                *
  6646*   FILE TYPE = VSAM,KSDS                                        *
  6647*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6648*                                                                *
  6649*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6650*       ALTERNATE PATH = NONE                                    *
  6651*                                                                *
  6652*   LOG = NO                                                     *
  6653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6654*                                                                *
  6655******************************************************************
  6656*                   C H A N G E   L O G
  6657*
  6658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6659*-----------------------------------------------------------------
  6660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6661* EFFECTIVE    NUMBER
  6662*-----------------------------------------------------------------
  6663* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6664* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6665******************************************************************
  6666 01  REINSURANCE-RECORD.
  6667     12  RE-RECORD-ID                      PIC XX.
  6668         88  VALID-RE-ID                      VALUE 'RE'.
  6669
  6670     12  RE-CONTROL-PRIMARY.
  6671         16  RE-COMPANY-CD                 PIC X.
  6672         16  RE-KEY.
  6673             20  RE-CODE                   PIC X.
  6674                 88  RE-TABLE-RECORD          VALUE 'A'.
  6675                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6676             20  RE-TABLE                  PIC XXX.
  6677             20  FILLER                    PIC XXX.
  6678         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6679             20  FILLER                    PIC X.
  6680             20  RE-COMPANY.
  6681                 24  RE-COMP-PRIME         PIC XXX.
  6682                 24  RE-COMP-SUB           PIC XXX.
  6683
  6684     12  RE-MAINT-INFORMATION.
  6685         16  RE-LAST-MAINT-DT              PIC XX.
  6686         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6687         16  RE-LAST-MAINT-USER            PIC X(4).
  6688         16  FILLER                        PIC X(10).
  6689
  6690     12  RE-TABLE-DATA.
  6691         16  RE-100-COMP                   PIC 99.
  6692
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 123
* EL130.cbl
  6693         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6694             20  RE-REI-COMP-NO.
  6695                 24  RE-REI-COMP           PIC XXX.
  6696                 24  RE-REI-COMP-SUB       PIC XXX.
  6697             20  RE-LF-QC                  PIC X.
  6698             20  RE-AH-QC                  PIC X.
  6699             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6700             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6701             20  RE-LFAGE-LO               PIC 99.
  6702             20  RE-LFAGE-HI               PIC 99.
  6703             20  RE-AHAGE-LO               PIC 99.
  6704             20  RE-AHAGE-HI               PIC 99.
  6705             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6706             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6707             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6708             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6709             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6710             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6711             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6712             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6713             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6714             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6715             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6716             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6717             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6718             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6719             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6720             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6721             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6722             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6723             20  RE-LF-BEN-CODE            PIC X.
  6724             20  RE-AH-BEN-CODE            PIC X.
  6725             20  RE-INTERACTIVE            PIC X.
  6726             20  RE-REMAINING              PIC X.
  6727             20  RE-LF-RUNOFF-SW           PIC X.
  6728             20  RE-AH-RUNOFF-SW           PIC X.
  6729             20  FILLER                    PIC X(19).
  6730
  6731         16  RE-COMP-INFO-END              PIC X(6).
  6732         16  RE-NSP-ST-CD-LF               PIC XX.
  6733         16  RE-NSP-ST-CD-AH               PIC XX.
  6734         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6735             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6736
  6737         16  FILLER                        PIC X(27).
  6738
  6739     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6740         16  RE-NAME                       PIC X(30).
  6741         16  RE-LF-PE                      PIC X.
  6742         16  RE-AH-PE                      PIC X.
  6743         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6744         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6745         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6746         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6747         16  RE-PRT-ST                     PIC X.
  6748         16  RE-PRT-OW                     PIC X.
  6749         16  RE-MORT-CODE                  PIC X(4).
  6750         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 124
* EL130.cbl
  6751         16  RE-ZERO-LF-FEE                PIC X.
  6752         16  RE-ZERO-AH-FEE                PIC X.
  6753         16  RE-CEDE-NAME                  PIC X(30).
  6754         16  RE-LF-COMM                    PIC X.
  6755         16  RE-AH-COMM                    PIC X.
  6756         16  RE-LF-TAX                     PIC X.
  6757         16  RE-AH-TAX                     PIC X.
  6758         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6759         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6760         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6761
  6762         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6763             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6764
  6765         16  RE-LF-CEDING-FEE-BRACKETS.
  6766             20  RE-LF-FEE-METHOD          PIC X.
  6767                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6768                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6769                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6770                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6771             20  RE-LF-FEE-BASIS           PIC X.
  6772                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6773                 88  RE-LF-NET-CEDED               VALUE '2'.
  6774                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6775                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6776                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6777                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6778                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6779                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6780             20  FILLER                    PIC XXX.
  6781             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6782                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6783                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6784
  6785         16  RE-AH-CEDING-FEE-BRACKETS.
  6786             20  RE-AH-FEE-METHOD          PIC X.
  6787                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6788                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6789                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6790                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6791             20  RE-AH-FEE-BASIS           PIC X.
  6792                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6793                 88  RE-AH-NET-CEDED               VALUE '2'.
  6794                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6795                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6796                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6797                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6798                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6799                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6800             20  FILLER                    PIC XXX.
  6801             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6802                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6803                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6804
  6805         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6806
  6807         16  RE-OLD-CEDING-STMT            PIC X.
  6808
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 125
* EL130.cbl
  6809         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6810         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6811         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6812         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6813         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6814         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6815         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6816         16  RE-MORT-SW                    PIC X.
  6817         16  RE-CEDING-TYPE-FLAG           PIC X.
  6818             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6819             88  RE-CEDED                          VALUE 'C'.
  6820             88  RE-ASSUMED                        VALUE 'A'.
  6821             88  RE-PHANTOM                        VALUE 'P'.
  6822
  6823         16  RE-CEDING-STMT-OPT-A          PIC X.
  6824             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6825         16  RE-CEDING-STMT-OPT-B          PIC X.
  6826             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6827         16  RE-CEDING-STMT-OPT-C          PIC X.
  6828             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6829         16  RE-CEDING-STMT-OPT-D          PIC X.
  6830             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6831         16  RE-CEDING-STMT-OPT-E          PIC X.
  6832             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6833
  6834         16  RE-PRT-CRSV                   PIC X.
  6835
  6836         16  RE-GL-CENTER                  PIC X(4).
  6837
  6838         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6839
  6840         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6841
  6842         16  RE-EARN-STOP-CODE             PIC X.
  6843             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6844             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6845
  6846         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6847             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6848
  6849         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6850         16  FILLER                        PIC X(2281).
  6851
  6852         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6853
  6854******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 126
* EL130.cbl
  6856*    COPY ERCMAIL.
  6857******************************************************************
  6858*                                                                *
  6859*                                                                *
  6860*                            ERCMAIL                             *
  6861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6862*                            VMOD=2.003                          *
  6863*                                                                *
  6864*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6865*                                                                *
  6866*   FILE TYPE = VSAM,KSDS                                        *
  6867*   RECORD SIZE = 374   RECFORM = FIX                            *
  6868*                                                                *
  6869*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6870*   ALTERNATE PATH    = NOT USED                                 *
  6871*                                                                *
  6872*   LOG = YES                                                    *
  6873*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6874******************************************************************
  6875*                   C H A N G E   L O G
  6876*
  6877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6878*-----------------------------------------------------------------
  6879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6880* EFFECTIVE    NUMBER
  6881*-----------------------------------------------------------------
  6882* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6883* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6884* 111108                   PEMA  ADD CRED BENE ADDR2
  6885******************************************************************
  6886
  6887 01  MAILING-DATA.
  6888     12  MA-RECORD-ID                      PIC XX.
  6889         88  VALID-MA-ID                       VALUE 'MA'.
  6890
  6891     12  MA-CONTROL-PRIMARY.
  6892         16  MA-COMPANY-CD                 PIC X.
  6893         16  MA-CARRIER                    PIC X.
  6894         16  MA-GROUPING.
  6895             20  MA-GROUPING-PREFIX        PIC XXX.
  6896             20  MA-GROUPING-PRIME         PIC XXX.
  6897         16  MA-STATE                      PIC XX.
  6898         16  MA-ACCOUNT.
  6899             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6900             20  MA-ACCOUNT-PRIME          PIC X(6).
  6901         16  MA-CERT-EFF-DT                PIC XX.
  6902         16  MA-CERT-NO.
  6903             20  MA-CERT-PRIME             PIC X(10).
  6904             20  MA-CERT-SFX               PIC X.
  6905
  6906     12  FILLER                            PIC XX.
  6907
  6908     12  MA-ACCESS-CONTROL.
  6909         16  MA-SOURCE-SYSTEM              PIC XX.
  6910             88  MA-FROM-CREDIT                VALUE 'CR'.
  6911             88  MA-FROM-VSI                   VALUE 'VS'.
  6912             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6913             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 127
* EL130.cbl
  6914         16  MA-RECORD-ADD-DT              PIC XX.
  6915         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6916         16  MA-LAST-MAINT-DT              PIC XX.
  6917         16  MA-LAST-MAINT-BY              PIC XXXX.
  6918         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6919
  6920     12  MA-PROFILE-INFO.
  6921         16  MA-QUALIFY-CODE-1             PIC XX.
  6922         16  MA-QUALIFY-CODE-2             PIC XX.
  6923         16  MA-QUALIFY-CODE-3             PIC XX.
  6924         16  MA-QUALIFY-CODE-4             PIC XX.
  6925         16  MA-QUALIFY-CODE-5             PIC XX.
  6926
  6927         16  MA-INSURED-LAST-NAME          PIC X(15).
  6928         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6929         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6930         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6931         16  MA-INSURED-BIRTH-DT           PIC XX.
  6932         16  MA-INSURED-SEX                PIC X.
  6933             88  MA-SEX-MALE                   VALUE 'M'.
  6934             88  MA-SEX-FEMALE                 VALUE 'F'.
  6935         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6936
  6937         16  MA-ADDRESS-CORRECTED          PIC X.
  6938         16  MA-JOINT-BIRTH-DT             PIC XX.
  6939*        16  FILLER                        PIC X(12).
  6940
  6941         16  MA-ADDRESS-LINE-1             PIC X(30).
  6942         16  MA-ADDRESS-LINE-2             PIC X(30).
  6943         16  MA-CITY-STATE.
  6944             20  MA-CITY                   PIC X(28).
  6945             20  MA-ADDR-STATE             PIC XX.
  6946         16  MA-ZIP.
  6947             20  MA-ZIP-CODE.
  6948                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6949                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6950                 24  FILLER                PIC X(4).
  6951             20  MA-ZIP-PLUS4              PIC X(4).
  6952         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6953             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6954             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6955             20  FILLER                    PIC X(3).
  6956
  6957         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6958
  6959         16  FILLER                        PIC XXX.
  6960*        16  FILLER                        PIC X(10).
  6961
  6962     12  MA-CRED-BENE-INFO.
  6963         16  MA-CRED-BENE-NAME                 PIC X(25).
  6964         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6965         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6966         16  MA-CRED-BENE-CTYST.
  6967             20  MA-CRED-BENE-CITY             PIC X(28).
  6968             20  MA-CRED-BENE-STATE            PIC XX.
  6969         16  MA-CRED-BENE-ZIP.
  6970             20  MA-CB-ZIP-CODE.
  6971                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 128
* EL130.cbl
  6972                     88  MA-CB-CANADIAN-POST-CODE
  6973                                           VALUE 'A' THRU 'Z'.
  6974                 24  FILLER                    PIC X(4).
  6975             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6976         16  MA-CB-CANADIAN-POSTAL-CODE
  6977                            REDEFINES MA-CRED-BENE-ZIP.
  6978             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6979             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6980             20  FILLER                        PIC X(3).
  6981     12  MA-POST-CARD-MAIL-DATA.
  6982         16  MA-MAIL-DATA OCCURS 7.
  6983             20  MA-MAIL-TYPE              PIC X.
  6984                 88  MA-12MO-MAILING           VALUE '1'.
  6985                 88  MA-EXP-MAILING            VALUE '2'.
  6986             20  MA-MAIL-STATUS            PIC X.
  6987                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6988                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6989                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6990             20  MA-MAIL-DATE              PIC XX.
  6991     12  FILLER                            PIC XX.
  6992     12  FILLER                            PIC XX.
  6993*    12  FILLER                            PIC X(30).
  6994******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 129
* EL130.cbl
  6996*    COPY ELCCRTT.
  6997******************************************************************
  6998*                                                                *
  6999*                            ELCCRTT.                            *
  7000*                                                                *
  7001*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7002*                                                                *
  7003*   FILE TYPE = VSAM,KSDS                                        *
  7004*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7005*                                                                *
  7006*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7007*                                                                *
  7008*   LOG = YES                                                    *
  7009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7010******************************************************************
  7011*                   C H A N G E   L O G
  7012*
  7013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7014*-----------------------------------------------------------------
  7015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7016* EFFECTIVE    NUMBER
  7017*-----------------------------------------------------------------
  7018* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7019* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7020* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7021* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7022* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7023* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7024* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7025******************************************************************
  7026
  7027 01  CERTIFICATE-TRAILERS.
  7028     12  CS-RECORD-ID                      PIC XX.
  7029         88  VALID-CS-ID                      VALUE 'CS'.
  7030
  7031     12  CS-CONTROL-PRIMARY.
  7032         16  CS-COMPANY-CD                 PIC X.
  7033         16  CS-CARRIER                    PIC X.
  7034         16  CS-GROUPING                   PIC X(6).
  7035         16  CS-STATE                      PIC XX.
  7036         16  CS-ACCOUNT                    PIC X(10).
  7037         16  CS-CERT-EFF-DT                PIC XX.
  7038         16  CS-CERT-NO.
  7039             20  CS-CERT-PRIME             PIC X(10).
  7040             20  CS-CERT-SFX               PIC X.
  7041         16  CS-TRAILER-TYPE               PIC X.
  7042             88  COMM-TRLR           VALUE 'A'.
  7043             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7044             88  CERT-DATA-TRLR      VALUE 'C'.
  7045
  7046     12  CS-DATA-AREA                      PIC X(516).
  7047
  7048     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7049         16  CS-BANK-COMMISSION-AREA.
  7050             20  CS-BANK-COMMS       OCCURS 10.
  7051                 24  CS-AGT                PIC X(10).
  7052                 24  CS-COM-TYP            PIC X.
  7053                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 130
* EL130.cbl
  7054                 24  CS-RECALC-LV-INDIC    PIC X.
  7055                 24  FILLER                PIC X(10).
  7056         16  FILLER                        PIC X(256).
  7057
  7058     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7059****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7060         16  CS-MB-CLAIM-DATA OCCURS 24.
  7061             20  CS-CLAIM-NO               PIC X(7).
  7062             20  CS-CLAIM-TYPE             PIC X.
  7063                 88  CS-AH-CLM               VALUE 'A'.
  7064                 88  CS-IU-CLM               VALUE 'I'.
  7065                 88  CS-GP-CLM               VALUE 'G'.
  7066                 88  CS-LF-CLM               VALUE 'L'.
  7067                 88  CS-PR-CLM               VALUE 'P'.
  7068                 88  CS-FL-CLM               VALUE 'F'.
  7069             20  CS-INSURED-TYPE           PIC X.
  7070                 88  CS-PRIM-INSURED          VALUE 'P'.
  7071                 88  CS-CO-BORROWER           VALUE 'C'.
  7072             20  CS-BENEFIT-PERIOD         PIC 99.
  7073             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7074             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7075             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7076         16  FILLER                        PIC X(12).
  7077     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7078         16  CS-VIN-NUMBER                 PIC X(17).
  7079         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7080         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7081         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7082         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 131
* EL130.cbl
  7084
  7085 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7086                          CONTROL-FILE CERTIFICATE-MASTER
  7087                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7088                          BENEFICIARY-MASTER
  7089                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7090                          LETTER-ARCHIVE REINSURANCE-RECORD
  7091                          MAILING-DATA CERTIFICATE-TRAILERS.
  7092 0000-DFHEXIT SECTION.
  7093     MOVE '9#                    $   ' TO DFHEIV0.
  7094     MOVE 'EL130' TO DFHEIV1.
  7095     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7096     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7097     MOVE '5'                    TO DC-OPTION-CODE.
  7098     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7099     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7100     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7101
  7102     IF EIBCALEN = ZERO
  7103         GO TO 8800-UNAUTHORIZED-ACCESS
  7104     END-IF.
  7105
  7106     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7107     MOVE EIBTRMID               TO QID-TERM.
  7108     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7109     move spaces                 to emi-error-lines
  7110     MOVE '2'                    TO EMI-SWITCH2.
  7111     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7112     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7113
  7114
  7115* EXEC CICS HANDLE CONDITION
  7116*        QIDERR     (0100-TEST-ENTRY)
  7117*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7118*        PGMIDERR   (9600-PGMID-ERROR)
  7119*        TERMIDERR  (8820-TERM-ERROR)
  7120*        TRANSIDERR (8830-TRAN-ERROR)
  7121*        ERROR      (9990-ABEND)
  7122*    END-EXEC.
  7123*    MOVE '"$N?L[\.              ! " #00007110' TO DFHEIV0
  7124     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7126     MOVE X'2220233030303037313130' TO DFHEIV0(25:11)
  7127     CALL 'kxdfhei1' USING DFHEIV0
  7128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7129
  7130
  7131     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7132        PI-CALLING-PROGRAM   = XCTL-6592
  7133         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7134     ELSE
  7135         MOVE SPACES             TO RETURNED-FROM
  7136     END-IF.
  7137
  7138     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7139         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7140             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7141             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 132
* EL130.cbl
  7142             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7143             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7144             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7145             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7146             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7147             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7148         ELSE
  7149             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7150             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7151             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7152             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7153             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7154             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7155             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7156             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7157         END-IF
  7158     END-IF.
  7159
  7160     IF EIBTRNID = TRANS-ID
  7161         IF EIBAID = DFHCLEAR
  7162             GO TO 9400-CLEAR
  7163         ELSE
  7164             GO TO 0200-RECEIVE
  7165         END-IF
  7166     END-IF.
  7167
  7168     IF RETURNED-FROM NOT = SPACES
  7169         GO TO 0600-RECOVER-TEMP-STORAGE
  7170     END-IF.
  7171
  7172     MOVE LOW-VALUES TO EL130AO.
  7173     move zeros to pi-dcc-max-amt
  7174                   pi-dcc-max-benefits
  7175
  7176
  7177
  7178* EXEC CICS DELETEQ TS
  7179*         QUEUE   (QID)
  7180*    END-EXEC.
  7181*    MOVE '*&                    #   #00007165' TO DFHEIV0
  7182     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7184     MOVE X'2020233030303037313635' TO DFHEIV0(25:11)
  7185     CALL 'kxdfhei1' USING DFHEIV0,
  7186           QID,
  7187           DFHEIV99
  7188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7189
  7190
  7191 0100-TEST-ENTRY.
  7192     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7193         GO TO 0650-FROM-EL127
  7194     ELSE
  7195         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7196                                    PI-CERT-PROCESSED
  7197                                    PI-LETTER-ERROR-CODE
  7198     END-IF.
  7199
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 133
* EL130.cbl
  7200     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7201         GO TO 0640-FROM-EL132
  7202     END-IF.
  7203
  7204     GO TO 8100-SEND-INITIAL-MAP.
  7205
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 134
* EL130.cbl
  7207 0200-RECEIVE.
  7208     MOVE LOW-VALUES             TO EL130AI.
  7209
  7210     IF PI-PROCESSOR-ID = 'LGXX'
  7211*        NEXT SENTENCE
  7212         CONTINUE
  7213     ELSE
  7214
  7215* EXEC CICS READQ TS
  7216*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7217*            INTO    (SECURITY-CONTROL)
  7218*            LENGTH  (SC-COMM-LENGTH)
  7219*            ITEM    (SC-ITEM)
  7220*        END-EXEC
  7221*    MOVE '*$II   L              ''   #00007192' TO DFHEIV0
  7222     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7224     MOVE X'2020233030303037313932' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           PI-SECURITY-TEMP-STORE-ID,
  7227           SECURITY-CONTROL,
  7228           SC-COMM-LENGTH,
  7229           SC-ITEM,
  7230           DFHEIV99,
  7231           DFHEIV99
  7232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7233         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7234         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7235         IF NOT DISPLAY-CAP
  7236             MOVE 'READ'              TO  SM-READ
  7237             PERFORM 9995-SECURITY-VIOLATION
  7238             MOVE ER-0070             TO  EMI-ERROR
  7239             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7240             GO TO 8100-SEND-INITIAL-MAP
  7241         END-IF
  7242     END-IF.
  7243
  7244     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7245         MOVE ER-7008 TO EMI-ERROR
  7246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7247         MOVE -1 TO MAINTL
  7248         GO TO 8200-SEND-DATAONLY
  7249     END-IF.
  7250
  7251
  7252
  7253* EXEC CICS RECEIVE
  7254*         MAP     (MAP-NAME)
  7255*         MAPSET  (MAPSET-NAME)
  7256*         INTO    (EL130AI)
  7257*    END-EXEC.
  7258     MOVE LENGTH OF
  7259      EL130AI
  7260       TO DFHEIV11
  7261*    MOVE '8"T I  L              ''   #00007217' TO DFHEIV0
  7262     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7263     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7264     MOVE X'2020233030303037323137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 135
* EL130.cbl
  7265     CALL 'kxdfhei1' USING DFHEIV0,
  7266           MAP-NAME,
  7267           EL130AI,
  7268           DFHEIV11,
  7269           MAPSET-NAME,
  7270           DFHEIV99,
  7271           DFHEIV99
  7272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7273
  7274
  7275     IF NOT PI-NO-CARRIER-SECURITY
  7276        MOVE +1                  TO CLMCARRL
  7277        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7278     END-IF.
  7279
  7280     IF ENTERPFL = ZERO
  7281         GO TO 0300-CHECK-PFKEYS
  7282     END-IF.
  7283
  7284     IF EIBAID NOT = DFHENTER
  7285         MOVE ER-0004            TO EMI-ERROR
  7286         GO TO 0320-INPUT-ERROR
  7287     END-IF.
  7288
  7289     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7290         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7291     ELSE
  7292         MOVE ER-0029            TO EMI-ERROR
  7293         GO TO 0320-INPUT-ERROR
  7294     END-IF.
  7295
  7296 0300-CHECK-PFKEYS.
  7297     IF EIBAID = DFHPF23
  7298         GO TO 8810-PF23
  7299     END-IF.
  7300
  7301     IF EIBAID = DFHPF24
  7302         GO TO 9200-RETURN-MAIN-MENU
  7303     END-IF.
  7304
  7305     IF EIBAID = DFHPF12
  7306         GO TO 9500-PF12
  7307     END-IF.
  7308
  7309     IF EIBAID = DFHPF3
  7310         MOVE SPACES              TO MAINTI
  7311         MOVE ZEROS               TO MAINTL
  7312         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7313         MOVE XCTL-127            TO PGM-NAME
  7314         GO TO 9300-XCTL
  7315     END-IF.
  7316
  7317     IF EIBAID = DFHPF4
  7318         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7319         MOVE XCTL-132            TO PGM-NAME
  7320         GO TO 9300-XCTL
  7321     END-IF.
  7322
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 136
* EL130.cbl
  7323     IF EIBAID = DFHPF13
  7324         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7325             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7326             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7327             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7328             MOVE PI-STATE            TO  PI-CR-STATE
  7329             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7330             MOVE XCTL-650            TO  PGM-NAME
  7331             GO TO 9300-XCTL
  7332         ELSE
  7333             MOVE -1                  TO  ENTERPFL
  7334             MOVE ER-2566             TO  EMI-ERROR
  7335             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7336             GO TO 8100-SEND-INITIAL-MAP
  7337         END-IF
  7338     END-IF.
  7339
  7340     IF EIBAID = DFHPF5
  7341         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7342             ADD +1 TO PI-CERT-PROCESSED
  7343             GO TO 0650-FROM-EL127
  7344         ELSE
  7345             MOVE ER-7686         TO EMI-ERROR
  7346             GO TO 0320-INPUT-ERROR
  7347         END-IF
  7348     END-IF.
  7349
  7350     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7351         GO TO 0800-TEST-PREVIOUS-CONTROL
  7352     END-IF.
  7353
  7354     IF PI-HAS-CLAS-IC-CRDTCRD
  7355         IF EIBAID = DFHPF10
  7356             MOVE XCTL-725          TO PGM-NAME
  7357             GO TO 9300-XCTL
  7358         END-IF
  7359     END-IF.
  7360
  7361     IF EIBAID = DFHPF14
  7362         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7363         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7364         MOVE XCTL-659            TO PGM-NAME
  7365         GO TO 9300-XCTL
  7366     END-IF.
  7367
  7368     IF EIBAID = DFHPF15
  7369         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7370         MOVE XCTL-114            TO PGM-NAME
  7371         GO TO 9300-XCTL
  7372     END-IF.
  7373
  7374*    IF EIBAID = DFHPF11
  7375*       GO TO 0600-RECOVER-TEMP-STORAGE
  7376*    END-IF
  7377     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7378         GO TO 0330-EDIT-DATA
  7379     END-IF.
  7380
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 137
* EL130.cbl
  7381     MOVE ER-0029                TO EMI-ERROR.
  7382
  7383 0320-INPUT-ERROR.
  7384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7385
  7386     MOVE AL-UNBON               TO ENTERPFA.
  7387
  7388     IF ENTERPFL = ZERO
  7389         MOVE -1                 TO MAINTL
  7390     ELSE
  7391         MOVE -1                 TO ENTERPFL
  7392     END-IF.
  7393
  7394     GO TO 8200-SEND-DATAONLY.
  7395
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 138
* EL130.cbl
  7397 0330-EDIT-DATA.
  7398
  7399     IF MAINTI = 'S'
  7400         IF PRTOPTL GREATER THAN 0
  7401             IF PRTOPTI NOT = 'N' AND 'L'
  7402                 MOVE AL-UABON   TO  PRTOPTA
  7403                 MOVE -1         TO  PRTOPTL
  7404                 MOVE ER-0334    TO  EMI-ERROR
  7405                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7406                 GO TO 8200-SEND-DATAONLY
  7407             ELSE
  7408                 IF PRTOPTI = 'L'
  7409                     GO TO 0400-CREATE-ELACTQ
  7410                 ELSE
  7411                     GO TO 0480-PRINT-NOW
  7412                 END-IF
  7413             END-IF
  7414         ELSE
  7415             GO TO 1000-SHOW-CLAIM
  7416         END-IF
  7417     END-IF.
  7418
  7419     IF NOT MODIFY-CAP
  7420         MOVE 'UPDATE'       TO  SM-READ
  7421         PERFORM 9995-SECURITY-VIOLATION
  7422         MOVE ER-0070        TO  EMI-ERROR
  7423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7424         GO TO 8100-SEND-INITIAL-MAP
  7425     END-IF.
  7426
  7427     IF MAINTI = 'D'
  7428         GO TO 2000-DELETE-CLAIM
  7429     END-IF.
  7430
  7431     IF MAINTI = 'A'
  7432         GO TO 3000-ADD-CLAIM
  7433     END-IF.
  7434
  7435     IF MAINTI = 'I'
  7436         GO TO 5000-INCURRED-CHANGE
  7437     END-IF.
  7438
  7439     MOVE ER-0023                TO EMI-ERROR.
  7440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7441     MOVE -1                     TO MAINTL.
  7442     MOVE AL-UABON               TO MAINTA.
  7443
  7444     GO TO 8200-SEND-DATAONLY.
  7445
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 139
* EL130.cbl
  7447 0400-CREATE-ELACTQ.
  7448     IF CLMNOI   = PI-LAST-CLAIM      AND
  7449        CLMCARRI = PI-LAST-CARR       AND
  7450        CERTNOI  = PI-LAST-CERT-PRIME AND
  7451        SUFXI    = PI-LAST-CERT-SUFX
  7452         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7453         MOVE PI-LAST-CARR       TO PI-CARRIER
  7454         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7455     ELSE
  7456         MOVE ER-0207            TO EMI-ERROR
  7457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7458         MOVE -1                 TO MAINTL
  7459         GO TO 8200-SEND-DATAONLY
  7460     END-IF.
  7461
  7462     IF (NOT PI-NO-CARRIER-SECURITY OR
  7463         NOT PI-NO-ACCOUNT-SECURITY)
  7464         MOVE AL-UABON      TO  PRTOPTA
  7465         MOVE -1            TO  PRTOPTL
  7466         MOVE ER-2378       TO  EMI-ERROR
  7467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7468         GO TO 8200-SEND-DATAONLY
  7469     END-IF.
  7470
  7471     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7472     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7473     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7474     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7475
  7476
  7477
  7478* EXEC CICS HANDLE CONDITION
  7479*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7480*    END-EXEC.
  7481*    MOVE '"$I                   ! # #00007425' TO DFHEIV0
  7482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7484     MOVE X'2320233030303037343235' TO DFHEIV0(25:11)
  7485     CALL 'kxdfhei1' USING DFHEIV0
  7486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7487
  7488
  7489
  7490
  7491* EXEC CICS READ
  7492*         UPDATE
  7493*         DATASET    (ELACTQ-DSID)
  7494*         SET        (ADDRESS OF ACTIVITY-QUE)
  7495*         RIDFLD     (ELACTQ-KEY)
  7496*    END-EXEC.
  7497*    MOVE '&"S        EU         (   #00007430' TO DFHEIV0
  7498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7500     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           ELACTQ-DSID,
  7503           DFHEIV20,
  7504           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 140
* EL130.cbl
  7505           ELACTQ-KEY,
  7506           DFHEIV99,
  7507           DFHEIV99,
  7508           DFHEIV99
  7509     SET ADDRESS OF ACTIVITY-QUE TO
  7510         DFHEIV20
  7511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7512
  7513
  7514     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7515     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7516
  7517
  7518
  7519* EXEC CICS REWRITE
  7520*         DATASET     (ELACTQ-DSID)
  7521*         FROM        (ACTIVITY-QUE)
  7522*    END-EXEC.
  7523     MOVE LENGTH OF
  7524      ACTIVITY-QUE
  7525       TO DFHEIV11
  7526*    MOVE '&& L                  %   #00007441' TO DFHEIV0
  7527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7529     MOVE X'2020233030303037343431' TO DFHEIV0(25:11)
  7530     CALL 'kxdfhei1' USING DFHEIV0,
  7531           ELACTQ-DSID,
  7532           ACTIVITY-QUE,
  7533           DFHEIV11,
  7534           DFHEIV99
  7535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7536
  7537
  7538     GO TO 0470-STATUS-FINISH.
  7539
  7540 0450-ADD-ELACTQ-RECORD.
  7541
  7542
  7543* EXEC CICS GETMAIN
  7544*        SET     (ADDRESS OF ACTIVITY-QUE)
  7545*        LENGTH  (ELACTQ-LENGTH)
  7546*        INITIMG (GETMAIN-SPACE)
  7547*    END-EXEC.
  7548*    MOVE ',"IL                  $   #00007450' TO DFHEIV0
  7549     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7551     MOVE X'2020233030303037343530' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0,
  7553           DFHEIV20,
  7554           ELACTQ-LENGTH,
  7555           GETMAIN-SPACE
  7556     SET ADDRESS OF ACTIVITY-QUE TO
  7557         DFHEIV20
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7559
  7560
  7561     MOVE 'AQ'              TO AQ-RECORD-ID.
  7562     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 141
* EL130.cbl
  7563     MOVE +0                TO AQ-PAYMENT-COUNTER
  7564                               AQ-PMT-UNAPPROVED-COUNT.
  7565     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7566                               AQ-FOLLOWUP-DATE.
  7567     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7568     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7569
  7570
  7571
  7572* EXEC CICS WRITE
  7573*         DATASET     (ELACTQ-DSID)
  7574*         FROM        (ACTIVITY-QUE)
  7575*         RIDFLD      (ELACTQ-KEY)
  7576*    END-EXEC.
  7577     MOVE LENGTH OF
  7578      ACTIVITY-QUE
  7579       TO DFHEIV11
  7580*    MOVE '&$ L                  ''   #00007466' TO DFHEIV0
  7581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7583     MOVE X'2020233030303037343636' TO DFHEIV0(25:11)
  7584     CALL 'kxdfhei1' USING DFHEIV0,
  7585           ELACTQ-DSID,
  7586           ACTIVITY-QUE,
  7587           DFHEIV11,
  7588           ELACTQ-KEY,
  7589           DFHEIV99,
  7590           DFHEIV99
  7591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7592
  7593
  7594 0470-STATUS-FINISH.
  7595     MOVE AL-UANOF               TO  PRTOPTA
  7596                                     ALTPRTA.
  7597
  7598     MOVE SPACES                 TO  PRTOPTO
  7599                                     ALTPRTO.
  7600
  7601     MOVE ER-0000                TO EMI-ERROR.
  7602     MOVE -1                     TO MAINTL.
  7603     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7604     GO TO 8100-SEND-INITIAL-MAP.
  7605
  7606 0480-PRINT-NOW.
  7607
  7608
  7609* EXEC CICS HANDLE CONDITION
  7610*        TERMIDERR   (8820-TERM-ERROR)
  7611*        TRANSIDERR  (8830-TRAN-ERROR)
  7612*    END-EXEC.
  7613*    MOVE '"$[\                  ! $ #00007486' TO DFHEIV0
  7614     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7616     MOVE X'2420233030303037343836' TO DFHEIV0(25:11)
  7617     CALL 'kxdfhei1' USING DFHEIV0
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7619
  7620
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 142
* EL130.cbl
  7621     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7622     MOVE '1'                    TO  CNTL-REC-TYPE.
  7623     MOVE SPACES                 TO  CNTL-ACCESS.
  7624     MOVE +0                     TO  CNTL-SEQ-NO.
  7625     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7626
  7627     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7628
  7629     IF CF-FORMS-PRINTER-ID = SPACES
  7630         IF ALTPRTL NOT GREATER THAN 0
  7631             MOVE ER-0337        TO  EMI-ERROR
  7632             MOVE -1             TO  ALTPRTL
  7633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7634             GO TO 8200-SEND-DATAONLY
  7635         END-IF
  7636     END-IF.
  7637
  7638     IF ALTPRTL GREATER THAN 0
  7639         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7640     END-IF.
  7641
  7642     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7643     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7644     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7645
  7646
  7647
  7648* EXEC CICS START
  7649*        TRANSID   (START-TRANS-ID)
  7650*        TERMID    (CF-FORMS-PRINTER-ID)
  7651*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7652*        LENGTH    (PI-COMM-LENGTH)
  7653*    END-EXEC.
  7654*    MOVE '0( LFT                1   #00007517' TO DFHEIV0
  7655     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7656     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7657     MOVE X'2020233030303037353137' TO DFHEIV0(25:11)
  7658     CALL 'kxdfhei1' USING DFHEIV0,
  7659           DFHEIV99,
  7660           START-TRANS-ID,
  7661           DFHEIV99,
  7662           PROGRAM-INTERFACE-BLOCK,
  7663           PI-COMM-LENGTH,
  7664           CF-FORMS-PRINTER-ID,
  7665           DFHEIV99,
  7666           DFHEIV99,
  7667           DFHEIV99,
  7668           DFHEIV99,
  7669           DFHEIV99,
  7670           DFHEIV99,
  7671           DFHEIV99,
  7672           DFHEIV99,
  7673           DFHEIV99,
  7674           DFHEIV99
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 143
* EL130.cbl
  7679                                     ALTPRTA.
  7680
  7681     MOVE SPACES                 TO  PRTOPTO
  7682                                     ALTPRTO.
  7683
  7684     MOVE ER-0000                TO  EMI-ERROR.
  7685     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7686     MOVE -1                     TO  MAINTL.
  7687     GO TO 8100-SEND-INITIAL-MAP.
  7688
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 144
* EL130.cbl
  7690 0500-CREATE-TEMP-STORAGE.
  7691     MOVE EIBCPOSN               TO PI-CURSOR.
  7692
  7693    move emi-line1               to errmsg1o
  7694    move emi-line2               to errmsg2o
  7695    move emi-sub                 to pi-emi-sub
  7696
  7697
  7698* EXEC CICS WRITEQ TS
  7699*        QUEUE   (QID)
  7700*        FROM    (EL130AI)
  7701*        LENGTH  (QID-MAP-LENGTH)
  7702*    END-EXEC.
  7703*    MOVE '*"                    ''   #00007543' TO DFHEIV0
  7704     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7706     MOVE X'2020233030303037353433' TO DFHEIV0(25:11)
  7707     CALL 'kxdfhei1' USING DFHEIV0,
  7708           QID,
  7709           EL130AI,
  7710           QID-MAP-LENGTH,
  7711           DFHEIV99,
  7712           DFHEIV99,
  7713           DFHEIV99
  7714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7715
  7716
  7717
  7718
  7719* EXEC CICS WRITEQ TS
  7720*        QUEUE    (QID)
  7721*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7722*        LENGTH   (PI-COMM-LENGTH)
  7723*    END-EXEC.
  7724*    MOVE '*"                    ''   #00007550' TO DFHEIV0
  7725     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7726     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7727     MOVE X'2020233030303037353530' TO DFHEIV0(25:11)
  7728     CALL 'kxdfhei1' USING DFHEIV0,
  7729           QID,
  7730           PROGRAM-INTERFACE-BLOCK,
  7731           PI-COMM-LENGTH,
  7732           DFHEIV99,
  7733           DFHEIV99,
  7734           DFHEIV99
  7735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7736
  7737
  7738 0599-EXIT.
  7739      EXIT.
  7740
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 145
* EL130.cbl
  7742 0600-RECOVER-TEMP-STORAGE.
  7743     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7744     MOVE PI-EL127-TO-EL130-CNTRL
  7745                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7746     MOVE PI-EL659-TO-EL130-CNTRL
  7747                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7748     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7749     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7750     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7751     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7752     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7753     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7754     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7755     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7756     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7757     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7758     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7759     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7760     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7761     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7762     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7763     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7764                                 TO SAVE-BENEFICIARY
  7765
  7766
  7767
  7768* EXEC CICS HANDLE CONDITION
  7769*        NOTFND  (0660-NOT-FOUND)
  7770*        QIDERR  (0670-QIDERR)
  7771*    END-EXEC.
  7772*    MOVE '"$IN                  ! % #00007585' TO DFHEIV0
  7773     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7775     MOVE X'2520233030303037353835' TO DFHEIV0(25:11)
  7776     CALL 'kxdfhei1' USING DFHEIV0
  7777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7778
  7779
  7780
  7781
  7782* EXEC CICS READQ TS
  7783*        QUEUE    (QID)
  7784*        INTO     (EL130AI)
  7785*        LENGTH   (QID-MAP-LENGTH)
  7786*    END-EXEC.
  7787*    MOVE '*$I    L              ''   #00007591' TO DFHEIV0
  7788     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7790     MOVE X'2020233030303037353931' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0,
  7792           QID,
  7793           EL130AI,
  7794           QID-MAP-LENGTH,
  7795           DFHEIV99,
  7796           DFHEIV99,
  7797           DFHEIV99
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7799
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 146
* EL130.cbl
  7800
  7801     IF RETURNED-FROM = XCTL-131
  7802        IF CLAIM-DELETED-BY-EL131
  7803            MOVE LOW-VALUES      TO CERTNOI
  7804                                    SUFXI
  7805            MOVE ZEROS           TO CERTNOL
  7806                                    SUFXL
  7807         END-IF
  7808     END-IF.
  7809
  7810     IF RETURNED-FROM = XCTL-131
  7811         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7812         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7813                                    PI-CERT-PROCESSED
  7814     ELSE
  7815
  7816
  7817* EXEC CICS READQ TS
  7818*             QUEUE   (QID)
  7819*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7820*             LENGTH  (PI-COMM-LENGTH)
  7821*        END-EXEC
  7822*    MOVE '*$I    L              ''   #00007612' TO DFHEIV0
  7823     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7824     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7825     MOVE X'2020233030303037363132' TO DFHEIV0(25:11)
  7826     CALL 'kxdfhei1' USING DFHEIV0,
  7827           QID,
  7828           PROGRAM-INTERFACE-BLOCK,
  7829           PI-COMM-LENGTH,
  7830           DFHEIV99,
  7831           DFHEIV99,
  7832           DFHEIV99
  7833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7834     END-IF.
  7835
  7836
  7837* EXEC CICS DELETEQ TS
  7838*        QUEUE   (QID)
  7839*    END-EXEC.
  7840*    MOVE '*&                    #   #00007619' TO DFHEIV0
  7841     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037363139' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           QID,
  7846           DFHEIV99
  7847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7848
  7849
  7850     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7851
  7852     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7853         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7854         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7855         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7856         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7857         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 147
* EL130.cbl
  7858         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7859         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7860         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7861         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7862         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7863         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7864         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7865         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7866         MOVE SAVE-CERT-ACCESS-CONTROL
  7867                                    TO PI-CERT-ACCESS-CONTROL
  7868         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7869                                    TO PI-CARRIER-CONTROL-LEVEL
  7870     END-IF.
  7871
  7872*    IF EIBAID = DFHPF11
  7873*       move errmsg1i            to emi-line1
  7874*       move errmsg2i            to emi-line2
  7875*       move pi-emi-sub          to emi-sub
  7876*       go to 8200-SEND-DATAONLY
  7877*    end-if
  7878     IF RETURNED-FROM = XCTL-127
  7879         MOVE SAVE-EL127-TO-EL130-CNTRL
  7880                                 TO PI-EL127-TO-EL130-CNTRL
  7881     END-IF.
  7882
  7883     IF RETURNED-FROM = XCTL-6592
  7884        MOVE SAVE-EL659-TO-EL130-CNTRL
  7885                                 TO PI-EL659-TO-EL130-CNTRL
  7886     END-IF.
  7887
  7888     IF RETURNED-FROM = XCTL-114
  7889        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7890           MOVE SAVE-BENEFICIARY TO BENECDI
  7891           MOVE +10              TO BENECDL
  7892           MOVE -1               TO BIRTHDTL
  7893        END-IF
  7894     END-IF.
  7895     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7896
  7897     IF MAINTL NOT = ZERO
  7898         MOVE AL-UANON           TO MAINTA
  7899     END-IF.
  7900
  7901     IF ENTERPFL NOT = ZERO
  7902         MOVE AL-UNNON           TO ENTERPFA
  7903     END-IF.
  7904
  7905     IF RETURNED-FROM = XCTL-127
  7906         GO TO 0650-FROM-EL127
  7907     END-IF.
  7908
  7909     IF RETURNED-FROM = XCTL-132
  7910         GO TO 0640-FROM-EL132
  7911     END-IF.
  7912
  7913     IF RETURNED-FROM = XCTL-650
  7914         MOVE AL-SABON           TO PF5A
  7915         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 148
* EL130.cbl
  7916     END-IF.
  7917
  7918     IF RETURNED-FROM = XCTL-6592
  7919         GO TO 0630-FROM-EL6592
  7920     END-IF.
  7921
  7922     IF MAINTI = 'S' OR 'I'
  7923        GO TO 1000-SHOW-CLAIM
  7924     END-IF.
  7925
  7926     GO TO 8100-SEND-INITIAL-MAP.
  7927
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 149
* EL130.cbl
  7929 0630-FROM-EL6592.
  7930     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7931     MOVE PI-EL659-GROUPING      TO GROUPO.
  7932     MOVE PI-EL659-STATE         TO STATEO.
  7933     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7934
  7935     MOVE AL-UANON               TO CRTCARRA
  7936                                    GROUPA
  7937                                    STATEA
  7938                                    ACCOUNTA.
  7939     GO TO 8100-SEND-INITIAL-MAP.
  7940
  7941 0640-FROM-EL132.
  7942     IF PI-CLAIM-NO = SPACES
  7943         GO TO 0645-NO-CLAIM-SELECTED
  7944     END-IF.
  7945
  7946     MOVE LOW-VALUES             TO EL130AI.
  7947     MOVE 'MSTR'                 TO FILE-SWITCH.
  7948     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7949     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7950     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7951                                    CLMNOO.
  7952     MOVE AL-UANON               TO CLMNOA.
  7953     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7954
  7955
  7956
  7957* EXEC CICS HANDLE CONDITION
  7958*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7959*    END-EXEC.
  7960*    MOVE '"$I                   ! & #00007729' TO DFHEIV0
  7961     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7963     MOVE X'2620233030303037373239' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0
  7965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7966
  7967
  7968     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7969     MOVE 'X'                    TO CLAIM-SWITCH.
  7970     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7971     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7972     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  7973     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  7974     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7975     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7976
  7977     MOVE ER-0213                TO EMI-ERROR.
  7978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7979     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7980     GO TO 8100-SEND-INITIAL-MAP.
  7981
  7982 0645-NO-CLAIM-SELECTED.
  7983
  7984     IF MAINTI = 'S' OR 'I'
  7985        GO TO 1000-SHOW-CLAIM
  7986     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 150
* EL130.cbl
  7987
  7988     GO TO 8100-SEND-INITIAL-MAP.
  7989
  7990 0650-FROM-EL127.
  7991
  7992     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7993         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7994                                    PI-CERT-PROCESSED
  7995     END-IF.
  7996
  7997     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7998         MOVE +1                 TO PI-CERT-SELECT-CNT
  7999                                    PI-CERT-PROCESSED
  8000         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8001         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8002         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8003         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8004         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8005         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8006     END-IF.
  8007
  8008     IF PI-CERT-SELECT-CNT = ZERO
  8009         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8010             MOVE CERTNOI        TO PI-CERT-NO
  8011             MOVE SUFXI          TO PI-CERT-SFX
  8012             GO TO 3000-READ-CERT
  8013         ELSE
  8014             GO TO 8100-SEND-INITIAL-MAP
  8015         END-IF
  8016     END-IF.
  8017
  8018     MOVE AL-SABON               TO PF5A.
  8019
  8020     IF PI-CERT-PROCESSED = 1
  8021         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8022     END-IF.
  8023
  8024     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8025     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8026
  8027     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8028     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8029                                 TO CERT-CARRIER
  8030                                    PI-CARRIER.
  8031     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8032                                 TO CERT-GROUPING
  8033                                    PI-GROUPING.
  8034     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8035                                 TO CERT-STATE
  8036                                    PI-STATE.
  8037     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8038                                 TO CERT-ACCOUNT
  8039                                    PI-ACCOUNT.
  8040     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8041                                 TO CERT-EFF-DT
  8042                                    PI-CERT-EFF-DT.
  8043     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8044                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 151
* EL130.cbl
  8045                                    PI-CERT-NO.
  8046
  8047     MOVE 'CERT'                 TO FILE-SWITCH.
  8048     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8049
  8050     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8051     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8052     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8053
  8054     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8055         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8056         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8057         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8058         IF INCURRED-DATE-MATCH
  8059             MOVE ER-7352        TO EMI-ERROR
  8060             MOVE -1             TO CERTNOL
  8061             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8062         ELSE
  8063             IF NO-CLAIMS-FOR-CERT
  8064                 MOVE ER-7353    TO EMI-ERROR
  8065                 MOVE -1         TO CERTNOL
  8066                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067             ELSE
  8068                 MOVE ER-0558    TO EMI-ERROR
  8069                 MOVE -1         TO CERTNOL
  8070                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8071             END-IF
  8072         END-IF
  8073     END-IF.
  8074
  8075     MOVE SPACES                 TO PI-PRT-OPT
  8076                                    PI-ALT-PRT.
  8077
  8078     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8079
  8080     if (ws-lf-joint-indicator not = 'J')
  8081        and (ws-ah-joint-indicator not = 'J')
  8082        move 'P'                 to INSTYPEO
  8083        MOVE AL-UANON            TO INSTYPEA
  8084     end-if
  8085     IF LSTNMEL NOT GREATER ZERO
  8086        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8087         MOVE CRTLNMEI           TO  LSTNMEO
  8088         MOVE CRTFNMEI           TO  FSTNMEO
  8089         MOVE CRTINITI           TO  INITO
  8090         MOVE AL-UANON           TO  LSTNMEA
  8091                                     FSTNMEA
  8092                                     INITA
  8093     END-IF.
  8094
  8095     IF SSNL GREATER ZERO
  8096         GO TO 0655-SKIP-SOCIAL-SECURITY
  8097     END-IF.
  8098
  8099     IF CRTSSNI = SPACES OR LOW-VALUES
  8100         GO TO 0655-SKIP-SOCIAL-SECURITY
  8101     END-IF.
  8102
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 152
* EL130.cbl
  8103     IF CM-SSN-STATE   = CM-STATE AND
  8104        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8105            GO TO 0655-SKIP-SOCIAL-SECURITY
  8106     END-IF.
  8107
  8108     MOVE CRTSSNI                TO SSNO
  8109     MOVE AL-UANON               TO SSNA.
  8110
  8111 0655-SKIP-SOCIAL-SECURITY.
  8112
  8113     IF CLMCARRL NOT = ZERO  AND
  8114        CLMCARRI NOT = CRTCARRI
  8115        MOVE ER-0562             TO EMI-ERROR
  8116        MOVE AL-UABON            TO CLMCARRA
  8117        MOVE -1                  TO CLMCARRL
  8118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8119     END-IF.
  8120
  8121     IF CLMCARRL = ZERO
  8122        MOVE AL-UANON            TO CLMCARRA
  8123        MOVE CRTCARRI            TO CLMCARRI
  8124     END-IF.
  8125
  8126     MOVE 'A'                    TO MAINTO.
  8127     MOVE AL-UANON               TO MAINTA.
  8128
  8129     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8130        GO TO 8100-SEND-INITIAL-MAP
  8131     ELSE
  8132        GO TO 8150-SEND-MAP-CURSOR
  8133     END-IF.
  8134
  8135 0660-NOT-FOUND.
  8136     MOVE ER-0214                TO EMI-ERROR.
  8137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8138     GO TO 8100-SEND-INITIAL-MAP.
  8139
  8140 0670-QIDERR.
  8141     MOVE ER-0033                TO EMI-ERROR.
  8142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8143     GO TO 8100-SEND-INITIAL-MAP.
  8144
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 153
* EL130.cbl
  8146 0680-PLUG-SELECTED-CERTS.
  8147
  8148     MOVE AL-SANON               TO BCERT1A
  8149                                    BSUFX1A
  8150                                    BCERT2A
  8151                                    BSUFX2A
  8152                                    BCERT3A
  8153                                    BSUFX3A
  8154                                    BCERT4A
  8155                                    BSUFX4A
  8156                                    BCERT5A
  8157                                    BSUFX5A.
  8158
  8159     IF PCERTNOO = SPACES OR LOW-VALUES
  8160         MOVE PI-EL127-CERT-PRIME (1)
  8161                                 TO PCERTNOO
  8162         MOVE PI-EL127-CERT-SUFX  (1)
  8163                                 TO PSUFXO
  8164     END-IF.
  8165
  8166     MOVE PI-EL127-CERT-PRIME (1)
  8167                                 TO BCERT1O.
  8168     MOVE PI-EL127-CERT-SUFX  (1)
  8169                                 TO BSUFX1O.
  8170
  8171     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8172         MOVE PI-EL127-CERT-PRIME (2)
  8173                                 TO BCERT2O
  8174         MOVE PI-EL127-CERT-SUFX  (2)
  8175                                 TO BSUFX2O
  8176     ELSE
  8177         MOVE LOW-VALUES         TO BCERT2O
  8178                                    BSUFX2O
  8179     END-IF.
  8180
  8181     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8182         MOVE PI-EL127-CERT-PRIME (3)
  8183                                 TO BCERT3O
  8184         MOVE PI-EL127-CERT-SUFX  (3)
  8185                                 TO BSUFX3O
  8186     ELSE
  8187         MOVE LOW-VALUES         TO BCERT3O
  8188                                    BSUFX3O
  8189     END-IF.
  8190
  8191     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8192         MOVE PI-EL127-CERT-PRIME (4)
  8193                                 TO BCERT4O
  8194         MOVE PI-EL127-CERT-SUFX  (4)
  8195                                 TO BSUFX4O
  8196     ELSE
  8197         MOVE LOW-VALUES         TO BCERT4O
  8198                                    BSUFX4O
  8199     END-IF.
  8200
  8201     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8202         MOVE PI-EL127-CERT-PRIME (5)
  8203                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 154
* EL130.cbl
  8204         MOVE PI-EL127-CERT-SUFX  (5)
  8205                                 TO BSUFX5O
  8206     ELSE
  8207         MOVE LOW-VALUES         TO BCERT5O
  8208                                    BSUFX5O
  8209     END-IF.
  8210
  8211 0680-EXIT.
  8212     EXIT.
  8213
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 155
* EL130.cbl
  8215 0690-HIGHLIGHT-CERTS.
  8216
  8217     MOVE AL-UANON               TO PCERTNOA
  8218                                    PSUFXA.
  8219
  8220     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8221        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8222            MOVE AL-SABON        TO BCERT1A
  8223                                    BSUFX1A
  8224     ELSE
  8225         MOVE AL-SANON           TO BCERT1A
  8226                                    BSUFX1A
  8227     END-IF.
  8228
  8229     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8230        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8231            MOVE AL-SABON        TO BCERT2A
  8232                                    BSUFX2A
  8233     ELSE
  8234         MOVE AL-SANON           TO BCERT2A
  8235                                    BSUFX2A
  8236     END-IF.
  8237
  8238     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8239        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8240            MOVE AL-SABON        TO BCERT3A
  8241                                    BSUFX3A
  8242     ELSE
  8243         MOVE AL-SANON           TO BCERT3A
  8244                                    BSUFX3A
  8245     END-IF.
  8246
  8247     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8248        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8249            MOVE AL-SABON        TO BCERT4A
  8250                                    BSUFX4A
  8251     ELSE
  8252         MOVE AL-SANON           TO BCERT4A
  8253                                    BSUFX4A
  8254     END-IF.
  8255
  8256     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8257        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8258            MOVE AL-SABON        TO BCERT5A
  8259                                    BSUFX5A
  8260     ELSE
  8261         MOVE AL-SANON           TO BCERT5A
  8262                                    BSUFX5A
  8263     END-IF.
  8264
  8265 0690-EXIT.
  8266     EXIT.
  8267
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 156
* EL130.cbl
  8269 0800-TEST-PREVIOUS-CONTROL.
  8270     IF CLMNOI   = PI-LAST-CLAIM       AND
  8271        CLMCARRI = PI-LAST-CARR        AND
  8272        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8273        SUFXI    = PI-LAST-CERT-SUFX
  8274*        NEXT SENTENCE
  8275         CONTINUE
  8276     ELSE
  8277         MOVE ER-0207            TO EMI-ERROR
  8278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8279         MOVE -1                 TO MAINTL
  8280         GO TO 8200-SEND-DATAONLY
  8281     END-IF.
  8282
  8283     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8284
  8285     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8286     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8287     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8288
  8289     IF EIBAID = DFHPF7
  8290         MOVE XCTL-157           TO PGM-NAME
  8291     END-IF.
  8292
  8293     IF EIBAID = DFHPF8
  8294         MOVE XCTL-141           TO PGM-NAME
  8295     END-IF.
  8296
  8297     IF EIBAID = DFHPF9
  8298        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8299                                    PI-SAVED-PROGRAM-2
  8300                                    PI-SAVED-PROGRAM-3
  8301                                    PI-SAVED-PROGRAM-4
  8302                                    PI-SAVED-PROGRAM-5
  8303                                    PI-SAVED-PROGRAM-6
  8304        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8305        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8306        MOVE XCTL-150            TO PGM-NAME
  8307     END-IF.
  8308
  8309     GO TO 9300-XCTL.
  8310
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 157
* EL130.cbl
  8312 1000-SHOW-CLAIM.
  8313
  8314     IF CLMNOL = ZERO
  8315         MOVE -1                 TO CLMNOL
  8316         MOVE AL-UABON           TO CLMNOA
  8317         MOVE ER-0202            TO EMI-ERROR
  8318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8319     ELSE
  8320         MOVE AL-UANON           TO CLMNOA
  8321     END-IF.
  8322
  8323     IF PI-NO-CARRIER-SECURITY
  8324        IF CLMCARRL = ZERO
  8325             MOVE -1             TO CLMCARRL
  8326             MOVE AL-UABON       TO CLMCARRA
  8327             MOVE ER-0194        TO EMI-ERROR
  8328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8329         ELSE
  8330             MOVE AL-UANON       TO CLMCARRA
  8331         END-IF
  8332     END-IF.
  8333
  8334     IF SUFXL = ZERO
  8335         MOVE SPACES             TO SUFXI
  8336         MOVE AL-UANON           TO SUFXA
  8337     ELSE
  8338         MOVE AL-UANON           TO SUFXA
  8339     END-IF.
  8340
  8341     IF NOT EMI-NO-ERRORS
  8342         GO TO 1050-SEND-CHECK
  8343     END-IF.
  8344
  8345
  8346
  8347* EXEC CICS HANDLE CONDITION
  8348*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8349*    END-EXEC.
  8350*    MOVE '"$I                   ! '' #00008111' TO DFHEIV0
  8351     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8353     MOVE X'2720233030303038313131' TO DFHEIV0(25:11)
  8354     CALL 'kxdfhei1' USING DFHEIV0
  8355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8356
  8357
  8358     MOVE 'MSTR'                 TO FILE-SWITCH
  8359     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8360
  8361     MOVE CLMCARRI               TO MSTR-CARRIER.
  8362     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8363
  8364     IF CERTNOL = ZERO     OR
  8365        CERTNOI = SPACES   OR
  8366        CERTNOI = LOW-VALUES
  8367         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8368         MOVE AL-SANON        TO CERTNOA
  8369                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 158
* EL130.cbl
  8370     ELSE
  8371         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8372     END-IF.
  8373
  8374     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8375     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8376
  8377
  8378
  8379* EXEC CICS HANDLE CONDITION
  8380*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8381*    END-EXEC.
  8382*    MOVE '"$I                   ! ( #00008135' TO DFHEIV0
  8383     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8385     MOVE X'2820233030303038313335' TO DFHEIV0(25:11)
  8386     CALL 'kxdfhei1' USING DFHEIV0
  8387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8388
  8389
  8390     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8391
  8392     IF NOT PI-NO-ACCOUNT-SECURITY
  8393         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8394           MOVE ER-2371          TO EMI-ERROR
  8395           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8396           MOVE -1               TO MAINTL
  8397           GO TO 8200-SEND-DATAONLY
  8398         END-IF
  8399     END-IF.
  8400
  8401
  8402
  8403* EXEC CICS HANDLE CONDITION
  8404*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8405*    END-EXEC.
  8406*    MOVE '"$I                   ! ) #00008151' TO DFHEIV0
  8407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8409     MOVE X'2920233030303038313531' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0
  8411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8412
  8413
  8414     MOVE 'Y'                    TO CLAIM-SWITCH.
  8415     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8416     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8417     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8418     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8419     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8420
  8421 1000-SHOW-END-OF-PERFORM.
  8422
  8423     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8424     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8425     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8426     MOVE CL-CERT-STATE          TO CERT-STATE.
  8427     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 159
* EL130.cbl
  8428     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8429     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8430
  8431     MOVE 'CERT'                 TO FILE-SWITCH.
  8432
  8433     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8434
  8435     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8436     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8437     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8438     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8439     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8440     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8441     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8442     MOVE CLMCARRI               TO PI-LAST-CARR.
  8443
  8444     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8445
  8446     IF MAINTI = 'I'
  8447         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8448                 BIRTHDTA  LSTNMEA   RELCLMA
  8449                 LOANNOA   LOANBALA  BENECDA
  8450         MOVE AL-SANON TO  SSNA
  8451         MOVE SPACES   TO  INCURI    REPORTI
  8452         MOVE 'Y'      TO PI-INCURR-SW
  8453         MOVE ER-0522  TO EMI-ERROR
  8454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8455     ELSE
  8456         MOVE ' '      TO PI-INCURR-SW
  8457     END-IF.
  8458
  8459     MOVE -1                     TO MAINTL.
  8460     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8461     MOVE CERT-GROUPING          TO PI-GROUPING.
  8462     MOVE CERT-STATE             TO PI-STATE.
  8463     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8464     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8465     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8466     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8467
  8468     IF RETURNED-FROM NOT = SPACES
  8469         GO TO 8100-SEND-INITIAL-MAP
  8470     ELSE
  8471         GO TO 8200-SEND-DATAONLY
  8472     END-IF.
  8473
  8474 1025-SHOW-RECORD-NOT-FOUND.
  8475
  8476     IF FILE-SWITCH = 'MSTR'
  8477         MOVE ER-0204            TO EMI-ERROR
  8478     ELSE
  8479         IF FILE-SWITCH = 'TRLR'
  8480             MOVE ER-0205        TO EMI-ERROR
  8481         ELSE
  8482             MOVE ER-0206        TO EMI-ERROR
  8483         END-IF
  8484     END-IF.
  8485
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 160
* EL130.cbl
  8486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8487
  8488 1050-SEND-CHECK.
  8489
  8490     IF RETURNED-FROM NOT = SPACES
  8491         GO TO 8100-SEND-INITIAL-MAP
  8492     ELSE
  8493         MOVE -1                 TO MAINTL
  8494         GO TO 8200-SEND-DATAONLY
  8495     END-IF.
  8496
  8497 2000-DELETE-CLAIM.
  8498     IF NOT MODIFY-CAP
  8499         MOVE ER-0070            TO EMI-ERROR
  8500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8501         MOVE -1                 TO MAINTL
  8502         GO TO 8200-SEND-DATAONLY
  8503     END-IF.
  8504
  8505     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8506        CLMCARRI NOT = PI-LAST-CARR        OR
  8507        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8508        SUFXI    NOT = PI-LAST-CERT-SUFX
  8509         MOVE ER-0207            TO EMI-ERROR
  8510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8511         MOVE -1                 TO MAINTL
  8512         GO TO 8200-SEND-DATAONLY
  8513     END-IF.
  8514
  8515
  8516
  8517* EXEC CICS HANDLE CONDITION
  8518*        NOTFND   (2050-DELETE-NOT-FOUND)
  8519*    END-EXEC.
  8520*    MOVE '"$I                   ! * #00008257' TO DFHEIV0
  8521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8523     MOVE X'2A20233030303038323537' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8526
  8527
  8528     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8529
  8530     MOVE CLMCARRI               TO MSTR-CARRIER.
  8531     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8532     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8533     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8534
  8535     MOVE 'MSTR'                 TO FILE-SWITCH.
  8536     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8537
  8538     MOVE 'Y'                    TO CLAIM-SWITCH.
  8539
  8540     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8541        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8542         MOVE ER-0068        TO EMI-ERROR
  8543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 161
* EL130.cbl
  8544         MOVE -1             TO MAINTL
  8545         GO TO 8200-SEND-DATAONLY
  8546     END-IF.
  8547
  8548     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8549         MOVE ER-0569            TO EMI-ERROR
  8550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8551         MOVE -1                 TO MAINTL
  8552         GO TO 8200-SEND-DATAONLY
  8553     END-IF.
  8554
  8555     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8556         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8557     END-IF.
  8558
  8559     IF CL-PURGED-DT NOT = LOW-VALUES
  8560         MOVE ER-7691            TO EMI-ERROR
  8561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8562         MOVE -1                 TO MAINTL
  8563         GO TO 8200-SEND-DATAONLY
  8564     END-IF.
  8565
  8566     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8567     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8568     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8569     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8570     MOVE +0                     TO TRLR-SEQ-NO.
  8571     MOVE '1'                    TO TRLR-TYPE.
  8572
  8573     MOVE 'TRLR'                 TO FILE-SWITCH.
  8574
  8575
  8576
  8577* EXEC CICS READ
  8578*        UPDATE
  8579*        DATASET  (ELTRLR-DSID)
  8580*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8581*        RIDFLD   (ELTRLR-KEY)
  8582*    END-EXEC.
  8583*    MOVE '&"S        EU         (   #00008309' TO DFHEIV0
  8584     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8586     MOVE X'2020233030303038333039' TO DFHEIV0(25:11)
  8587     CALL 'kxdfhei1' USING DFHEIV0,
  8588           ELTRLR-DSID,
  8589           DFHEIV20,
  8590           DFHEIV99,
  8591           ELTRLR-KEY,
  8592           DFHEIV99,
  8593           DFHEIV99,
  8594           DFHEIV99
  8595     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8596         DFHEIV20
  8597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8598
  8599
  8600     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8601        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 162
* EL130.cbl
  8602         MOVE ER-0068        TO EMI-ERROR
  8603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604         MOVE -1             TO MAINTL
  8605         GO TO 8200-SEND-DATAONLY
  8606     END-IF.
  8607
  8608
  8609
  8610* EXEC CICS DELETE
  8611*        DATASET   (ELTRLR-DSID)
  8612*    END-EXEC.
  8613*    MOVE '&(                    &   #00008325' TO DFHEIV0
  8614     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8616     MOVE X'2020233030303038333235' TO DFHEIV0(25:11)
  8617     CALL 'kxdfhei1' USING DFHEIV0,
  8618           ELTRLR-DSID,
  8619           DFHEIV99,
  8620           DFHEIV99,
  8621           DFHEIV99,
  8622           DFHEIV99
  8623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8624
  8625
  8626     MOVE +90                    TO TRLR-SEQ-NO.
  8627     MOVE '6'                    TO TRLR-TYPE.
  8628
  8629
  8630
  8631* EXEC CICS READ
  8632*        UPDATE
  8633*        DATASET  (ELTRLR-DSID)
  8634*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8635*        RIDFLD   (ELTRLR-KEY)
  8636*    END-EXEC.
  8637*    MOVE '&"S        EU         (   #00008333' TO DFHEIV0
  8638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8639     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8640     MOVE X'2020233030303038333333' TO DFHEIV0(25:11)
  8641     CALL 'kxdfhei1' USING DFHEIV0,
  8642           ELTRLR-DSID,
  8643           DFHEIV20,
  8644           DFHEIV99,
  8645           ELTRLR-KEY,
  8646           DFHEIV99,
  8647           DFHEIV99,
  8648           DFHEIV99
  8649     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8650         DFHEIV20
  8651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8652
  8653
  8654
  8655
  8656* EXEC CICS DELETE
  8657*        DATASET   (ELTRLR-DSID)
  8658*    END-EXEC.
  8659*    MOVE '&(                    &   #00008341' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 163
* EL130.cbl
  8660     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8661     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8662     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  8663     CALL 'kxdfhei1' USING DFHEIV0,
  8664           ELTRLR-DSID,
  8665           DFHEIV99,
  8666           DFHEIV99,
  8667           DFHEIV99,
  8668           DFHEIV99
  8669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8670
  8671
  8672     MOVE +91                    TO TRLR-SEQ-NO.
  8673     MOVE '6'                    TO TRLR-TYPE.
  8674
  8675
  8676
  8677* EXEC CICS READ
  8678*        UPDATE
  8679*        DATASET  (ELTRLR-DSID)
  8680*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8681*        RIDFLD   (ELTRLR-KEY)
  8682*        RESP     (WS-RESPONSE)
  8683*    END-EXEC
  8684*    MOVE '&"S        EU         (  N#00008349' TO DFHEIV0
  8685     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8686     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8687     MOVE X'204E233030303038333439' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           ELTRLR-DSID,
  8690           DFHEIV20,
  8691           DFHEIV99,
  8692           ELTRLR-KEY,
  8693           DFHEIV99,
  8694           DFHEIV99,
  8695           DFHEIV99
  8696     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8697         DFHEIV20
  8698     MOVE EIBRESP  TO WS-RESPONSE
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8700
  8701     IF WS-RESP-NORMAL
  8702
  8703* EXEC CICS DELETE
  8704*          DATASET   (ELTRLR-DSID)
  8705*       END-EXEC
  8706*    MOVE '&(                    &   #00008358' TO DFHEIV0
  8707     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8709     MOVE X'2020233030303038333538' TO DFHEIV0(25:11)
  8710     CALL 'kxdfhei1' USING DFHEIV0,
  8711           ELTRLR-DSID,
  8712           DFHEIV99,
  8713           DFHEIV99,
  8714           DFHEIV99,
  8715           DFHEIV99
  8716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8717     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 164
* EL130.cbl
  8718
  8719     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8720     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8721     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8722     MOVE CL-CERT-STATE          TO CERT-STATE.
  8723     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8724     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8725     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8726
  8727     MOVE 'CERT'                 TO FILE-SWITCH.
  8728
  8729     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8730
  8731     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8732
  8733     IF WS-NUM-HOLD NOT = +0
  8734         GO TO 2005-REWRITE-CERT
  8735     END-IF.
  8736
  8737     IF NOT CERT-WAS-CREATED
  8738         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8739         GO TO 2005-REWRITE-CERT
  8740     END-IF.
  8741
  8742
  8743
  8744* EXEC CICS DELETE
  8745*        DATASET   (ELCERT-DSID)
  8746*    END-EXEC.
  8747*    MOVE '&(                    &   #00008387' TO DFHEIV0
  8748     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8750     MOVE X'2020233030303038333837' TO DFHEIV0(25:11)
  8751     CALL 'kxdfhei1' USING DFHEIV0,
  8752           ELCERT-DSID,
  8753           DFHEIV99,
  8754           DFHEIV99,
  8755           DFHEIV99,
  8756           DFHEIV99
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760     GO TO 2010-DELETE-CL.
  8761
  8762 2005-REWRITE-CERT.
  8763
  8764     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8765
  8766
  8767
  8768* EXEC CICS HANDLE CONDITION
  8769*         DUPKEY   (2010-DELETE-CL)
  8770*    END-EXEC.
  8771*    MOVE '"$$                   ! + #00008398' TO DFHEIV0
  8772     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8774     MOVE X'2B20233030303038333938' TO DFHEIV0(25:11)
  8775     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 165
* EL130.cbl
  8776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8777
  8778
  8779
  8780
  8781* EXEC CICS REWRITE
  8782*        DATASET  (ELCERT-DSID)
  8783*        FROM     (CERTIFICATE-MASTER)
  8784*    END-EXEC.
  8785     MOVE LENGTH OF
  8786      CERTIFICATE-MASTER
  8787       TO DFHEIV11
  8788*    MOVE '&& L                  %   #00008403' TO DFHEIV0
  8789     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8791     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  8792     CALL 'kxdfhei1' USING DFHEIV0,
  8793           ELCERT-DSID,
  8794           CERTIFICATE-MASTER,
  8795           DFHEIV11,
  8796           DFHEIV99
  8797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8798
  8799
  8800 2010-DELETE-CL.
  8801
  8802
  8803
  8804* EXEC CICS DELETE
  8805*        DATASET  (ELMSTR-DSID)
  8806*    END-EXEC.
  8807*    MOVE '&(                    &   #00008411' TO DFHEIV0
  8808     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8810     MOVE X'2020233030303038343131' TO DFHEIV0(25:11)
  8811     CALL 'kxdfhei1' USING DFHEIV0,
  8812           ELMSTR-DSID,
  8813           DFHEIV99,
  8814           DFHEIV99,
  8815           DFHEIV99,
  8816           DFHEIV99
  8817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8818
  8819
  8820     MOVE -1                     TO ONE-OR-MIN1.
  8821     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8822
  8823     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8824         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8825                                    WS-SAVE-CLAIM-KEY
  8826         MOVE +1                 TO ONE-OR-MIN1
  8827         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8828     END-IF.
  8829
  8830     MOVE ER-0000                TO EMI-ERROR.
  8831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8832     MOVE LOW-VALUES             TO EL130AO.
  8833     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 166
* EL130.cbl
  8834     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8835     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8836                                    PI-CERT-PROCESSED
  8837                                    PI-LETTER-ERROR-CODE.
  8838     GO TO 8100-SEND-INITIAL-MAP.
  8839
  8840 2050-DELETE-NOT-FOUND.
  8841     IF FILE-SWITCH = 'MSTR'
  8842         MOVE -1                 TO CLMNOL
  8843         MOVE ER-0204            TO EMI-ERROR
  8844     ELSE
  8845         IF FILE-SWITCH = 'TRLR'
  8846             MOVE -1             TO MAINTL
  8847             MOVE ER-0205        TO EMI-ERROR
  8848         ELSE
  8849             MOVE -1             TO CERTNOL
  8850             MOVE ER-0206        TO EMI-ERROR
  8851         END-IF
  8852     END-IF.
  8853
  8854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8855     GO TO 8200-SEND-DATAONLY.
  8856
  8857 3000-ADD-CLAIM.
  8858     IF NOT MODIFY-CAP
  8859         MOVE ER-0070            TO EMI-ERROR
  8860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8861         MOVE -1                 TO MAINTL
  8862         GO TO 8200-SEND-DATAONLY
  8863     END-IF.
  8864
  8865     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8866
  8867     IF CERTMTI = 'S'
  8868         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8869            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8870            WS-EFFDT = PI-SAVE-EFFDT       AND
  8871            ACCOUNTI = PI-SAVE-ACCOUNT
  8872             IF EMI-ERROR = 0
  8873                 GO TO 3010-TEST-FOR-ERRORS
  8874             ELSE
  8875                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8876                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8877                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8878                 MOVE PI-STATE         TO  CERT-STATE
  8879                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8880                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8881                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8882
  8883
  8884* EXEC CICS HANDLE CONDITION
  8885*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8886*                END-EXEC
  8887*    MOVE '"$I                   ! , #00008478' TO DFHEIV0
  8888     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8890     MOVE X'2C20233030303038343738' TO DFHEIV0(25:11)
  8891     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 167
* EL130.cbl
  8892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8893                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8894                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8895                 GO TO 3010-TEST-FOR-ERRORS
  8896             END-IF
  8897         END-IF
  8898     END-IF.
  8899
  8900     IF CERTMTI = 'A'
  8901         IF NOT PI-NO-CARRIER-SECURITY OR
  8902             NOT PI-NO-ACCOUNT-SECURITY
  8903             MOVE ER-2370          TO EMI-ERROR
  8904             MOVE -1               TO MAINTL
  8905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8906             GO TO 8200-SEND-DATAONLY
  8907         ELSE
  8908             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8909             GO TO 3010-TEST-FOR-ERRORS
  8910         END-IF
  8911     END-IF.
  8912
  8913     IF CERTNOL = ZEROS
  8914        GO TO 3010-TEST-FOR-ERRORS
  8915     END-IF.
  8916
  8917 3000-READ-CERT.
  8918
  8919     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8920                                    MSTR5-COMP-CD.
  8921     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8922                                    MSTR5-CERT-NO-PRIME.
  8923     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8924                                    MSTR5-CERT-NO-SUFX.
  8925
  8926
  8927
  8928* EXEC CICS HANDLE CONDITION
  8929*         DUPKEY   (3008-DUP-ERROR)
  8930*         NOTFND   (3009-NOT-FOUND)
  8931*    END-EXEC
  8932*    MOVE '"$$I                  ! - #00008515' TO DFHEIV0
  8933     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8935     MOVE X'2D20233030303038353135' TO DFHEIV0(25:11)
  8936     CALL 'kxdfhei1' USING DFHEIV0
  8937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8938
  8939     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8940
  8941     IF NOT PI-NO-ACCOUNT-SECURITY
  8942         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8943             MOVE ER-2371          TO EMI-ERROR
  8944             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8945             MOVE -1               TO MAINTL
  8946             GO TO 8200-SEND-DATAONLY
  8947         END-IF
  8948     END-IF.
  8949
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 168
* EL130.cbl
  8950     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8951     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  8952     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8953     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8954     MOVE CM-CARRIER             TO PI-CARRIER.
  8955     MOVE CM-GROUPING            TO PI-GROUPING.
  8956     MOVE CM-STATE               TO PI-STATE.
  8957     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8958     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8959     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8960     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8961
  8962     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8963         IF LSTNMEO = SPACES OR LOW-VALUES
  8964             MOVE CRTLNMEI       TO  LSTNMEO
  8965             MOVE AL-UANON       TO  LSTNMEA
  8966         END-IF
  8967     END-IF.
  8968
  8969     MOVE 'S'                    TO CERTMTO.
  8970*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8971     MOVE AL-SANON               TO CERTNOA.
  8972     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8973                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8974     IF EMI-NO-ERRORS
  8975         MOVE -1                  TO MAINTL
  8976     END-IF.
  8977
  8978     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8979         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8980         IF INCURRED-DATE-MATCH
  8981             MOVE ER-7352         TO EMI-ERROR
  8982             MOVE -1              TO CERTNOL
  8983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984         ELSE
  8985             IF NO-CLAIMS-FOR-CERT
  8986                 MOVE ER-7353     TO EMI-ERROR
  8987                 MOVE -1          TO CERTNOL
  8988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989             ELSE
  8990                 MOVE ER-0558     TO EMI-ERROR
  8991                 MOVE -1          TO CERTNOL
  8992                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993                 GO TO 3010-TEST-FOR-ERRORS
  8994             END-IF
  8995         END-IF
  8996     END-IF.
  8997
  8998 3007-SEND-SCREEN.
  8999     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9000         GO TO 8150-SEND-MAP-CURSOR
  9001     ELSE
  9002         GO TO 8200-SEND-DATAONLY
  9003     END-IF.
  9004
  9005 3008-DUP-ERROR.
  9006     MOVE ER-0560                TO EMI-ERROR.
  9007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 169
* EL130.cbl
  9008     MOVE -1                     TO CERTNOL.
  9009     GO TO 3007-SEND-SCREEN.
  9010
  9011 3009-NOT-FOUND.
  9012     MOVE ER-0214                TO EMI-ERROR.
  9013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9014     MOVE -1                     TO CERTNOL.
  9015     GO TO 3007-SEND-SCREEN.
  9016
  9017 3010-TEST-FOR-ERRORS.
  9018
  9019     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9020     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9021     perform 6500-get-acct    thru 6500-exit
  9022
  9023     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9024     move +0                     to e1
  9025     move spaces                 to ws-dcc-error-line
  9026     move ' '                    to ws-zero-bens-avail
  9027
  9028     if ws-dcc-product-code not = spaces
  9029        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9030        IF ERPDEF-FOUND
  9031           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9032           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9033           MOVE '1'              TO DC-OPTION-CODE
  9034           MOVE +0               TO DC-ELAPSED-MONTHS
  9035                                    DC-ELAPSED-DAYS
  9036           PERFORM 9700-LINK-DATE-CONVERT
  9037                                 THRU 9700-EXIT
  9038           IF NO-CONVERSION-ERROR
  9039              MOVE DC-ELAPSED-MONTHS
  9040                                 TO WS-MONTHS-BETWEEN
  9041              IF DC-ELAPSED-DAYS > 1
  9042                 ADD 1 TO WS-MONTHS-BETWEEN
  9043              END-IF
  9044           ELSE
  9045              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9046           END-IF
  9047
  9048           evaluate true
  9049              when (ws-excl-period not = zeros)
  9050                 and (ws-months-between <= ws-excl-period)
  9051                 MOVE -1         TO MAINTL
  9052                 add +1          to e1
  9053                 move 'Y'        to ws-zero-bens-avail
  9054                 MOVE ER-1651    TO EMI-ERROR
  9055                                    ws-error-no (e1)
  9056                 PERFORM 9900-ERROR-FORMAT
  9057                                 THRU 9900-EXIT
  9058              when (ws-cov-ends not = zeros)
  9059                 and (ws-months-between > ws-cov-ends)
  9060                 MOVE -1         TO MAINTL
  9061                 add +1          to e1
  9062                 move 'Y'        to ws-zero-bens-avail
  9063                 MOVE ER-1653    TO EMI-ERROR
  9064                                    ws-error-no (e1)
  9065                 evaluate true
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 170
* EL130.cbl
  9066                    when clmtypei = 'L'
  9067                       move '  LF  ' to emi-claim-type
  9068                    when clmtypei = 'I'
  9069                       move '  IU  ' to emi-claim-type
  9070                    WHEN CLMTYPEI = 'F'
  9071                       MOVE '  FL  ' TO EMI-CLAIM-TYPE
  9072                    when other
  9073                       move '  AH  ' to emi-claim-type
  9074                 end-evaluate
  9075                 PERFORM 9900-ERROR-FORMAT
  9076                                 THRU 9900-EXIT
  9077              when (ws-acc-period not = zeros)
  9078                 and (ws-months-between <= ws-acc-period)
  9079                 MOVE -1         TO MAINTL
  9080                 add +1          to e1
  9081                 MOVE ER-1652    TO EMI-ERROR
  9082                                    ws-error-no (e1)
  9083                 PERFORM 9900-ERROR-FORMAT
  9084                                 THRU 9900-EXIT
  9085                 add +1          to e1
  9086                 move er-1655    to emi-error
  9087                                    ws-error-no (e1)
  9088                 PERFORM 9900-ERROR-FORMAT
  9089                                 THRU 9900-EXIT
  9090              when clmtypei = 'I'
  9091                 add +1          to e1
  9092                 move er-1661    to emi-error
  9093                                    ws-error-no (e1)
  9094                 PERFORM 9900-ERROR-FORMAT
  9095                                 THRU 9900-EXIT
  9096           end-evaluate
  9097        END-IF
  9098*       perform 3996-read-cert-claim-trailer
  9099*                                thru 3996-exit
  9100     END-IF
  9101     perform 3996-read-cert-claim-trailer
  9102                                 thru 3996-exit
  9103     IF CERTMTI NOT = 'A'
  9104         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9105             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9106             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9107             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9108             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9109             IF INCURRED-DATE-MATCH
  9110                 MOVE ER-7352         TO EMI-ERROR
  9111                 MOVE -1              TO CERTNOL
  9112                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113             ELSE
  9114                 IF NO-CLAIMS-FOR-CERT
  9115                     MOVE ER-7353     TO EMI-ERROR
  9116                     MOVE -1          TO CERTNOL
  9117                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9118                 ELSE
  9119                     MOVE ER-0558     TO EMI-ERROR
  9120                     MOVE -1          TO CERTNOL
  9121                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9122                 END-IF
  9123             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 171
* EL130.cbl
  9124         END-IF
  9125     END-IF.
  9126
  9127     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9128         MOVE ER-0433             TO EMI-ERROR
  9129         MOVE -1                  TO MAINTL
  9130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131         GO TO 8200-SEND-DATAONLY
  9132     END-IF.
  9133
  9134     IF (EMI-NO-ERRORS)
  9135        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9136         GO TO 3015-TRY-TO-BUILD
  9137     END-IF.
  9138
  9139     IF EIBAID = DFHPF6
  9140         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9141             MOVE ER-0434         TO EMI-ERROR
  9142             MOVE -1              TO MAINTL
  9143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9144             GO TO 8200-SEND-DATAONLY
  9145         ELSE
  9146             MOVE +1              TO INCURL
  9147             GO TO 3015-TRY-TO-BUILD
  9148         END-IF
  9149     END-IF.
  9150
  9151     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9152         GO TO 8150-SEND-MAP-CURSOR
  9153     ELSE
  9154         GO TO 8200-SEND-DATAONLY
  9155     END-IF.
  9156
  9157 3015-TRY-TO-BUILD.
  9158     IF CLMNOL EQUAL ZERO
  9159         GO TO 3030-BUILD-CONT
  9160     END-IF.
  9161
  9162
  9163
  9164* EXEC CICS HANDLE CONDITION
  9165*        NOTFND   (3030-BUILD-CONT)
  9166*    END-EXEC.
  9167*    MOVE '"$I                   ! . #00008744' TO DFHEIV0
  9168     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9170     MOVE X'2E20233030303038373434' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0
  9172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9173
  9174
  9175     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9176
  9177     MOVE CLMCARRI               TO MSTR-CARRIER.
  9178     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9179     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9180     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9181
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 172
* EL130.cbl
  9182     MOVE 'MSTR'                 TO FILE-SWITCH.
  9183
  9184     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9185
  9186     MOVE ER-0221                TO EMI-ERROR.
  9187
  9188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9189     MOVE -1                     TO MAINTL.
  9190     GO TO 8200-SEND-DATAONLY.
  9191
  9192 3030-BUILD-CONT.
  9193     IF (CERTMTI NOT = 'A')
  9194        and (pi-company-id not = 'DCC')
  9195         GO TO 3060-BUILD-CONT
  9196     END-IF.
  9197
  9198
  9199
  9200* EXEC CICS HANDLE CONDITION
  9201*        NOTFND   (3033-ACCT-NOT-FOUND)
  9202*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9203*    END-EXEC.
  9204*    MOVE '"$I''                  ! / #00008772' TO DFHEIV0
  9205     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9207     MOVE X'2F20233030303038373732' TO DFHEIV0(25:11)
  9208     CALL 'kxdfhei1' USING DFHEIV0
  9209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9210
  9211
  9212     MOVE SPACES                 TO ERACCT-KEY.
  9213
  9214     IF CARR-GROUP-ST-ACCNT-CNTL
  9215         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9216         MOVE CRTCARRI           TO ACCT-CARRIER
  9217         MOVE GROUPI             TO ACCT-GROUPING
  9218         MOVE STATEI             TO ACCT-STATE
  9219         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9220         GO TO 3031-MOVE-ACCT-KEY
  9221     END-IF.
  9222
  9223     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9224     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9225
  9226     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9227         MOVE STATEI             TO ACCT-STATE
  9228     END-IF.
  9229
  9230     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9231         MOVE CRTCARRI           TO ACCT-CARRIER
  9232     END-IF.
  9233
  9234 3031-MOVE-ACCT-KEY.
  9235     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9236
  9237
  9238
  9239* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 173
* EL130.cbl
  9240*        DATASET     (ERACCT2-DSID)
  9241*        RIDFLD      (SAVE-ERACCT-KEY)
  9242*        GENERIC
  9243*        KEYLENGTH   (20)
  9244*    END-EXEC.
  9245     MOVE 20
  9246       TO DFHEIV11
  9247     MOVE 0
  9248       TO DFHEIV12
  9249*    MOVE '&,   KG    G          &   #00008803' TO DFHEIV0
  9250     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9252     MOVE X'2020233030303038383033' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           ERACCT2-DSID,
  9255           SAVE-ERACCT-KEY,
  9256           DFHEIV11,
  9257           DFHEIV12,
  9258           DFHEIV99
  9259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9260
  9261
  9262
  9263
  9264* EXEC CICS HANDLE CONDITION
  9265*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9266*    END-EXEC.
  9267*    MOVE '"$''                   ! 0 #00008811' TO DFHEIV0
  9268     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9270     MOVE X'3020233030303038383131' TO DFHEIV0(25:11)
  9271     CALL 'kxdfhei1' USING DFHEIV0
  9272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9273
  9274
  9275 3031-READ-ACCT-LOOP.
  9276
  9277
  9278* EXEC CICS READNEXT
  9279*        DATASET   (ERACCT2-DSID)
  9280*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9281*        RIDFLD    (SAVE-ERACCT-KEY)
  9282*    END-EXEC.
  9283     MOVE 0
  9284       TO DFHEIV11
  9285*    MOVE '&.S                   )   #00008817' TO DFHEIV0
  9286     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9287     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9288     MOVE X'2020233030303038383137' TO DFHEIV0(25:11)
  9289     CALL 'kxdfhei1' USING DFHEIV0,
  9290           ERACCT2-DSID,
  9291           DFHEIV20,
  9292           DFHEIV99,
  9293           SAVE-ERACCT-KEY,
  9294           DFHEIV99,
  9295           DFHEIV11,
  9296           DFHEIV99,
  9297           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 174
* EL130.cbl
  9298     SET ADDRESS OF ACCOUNT-MASTER TO
  9299         DFHEIV20
  9300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9301
  9302
  9303     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9304        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9305        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9306        ACCT-STATE    NOT = AM-VG-STATE       OR
  9307        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9308         GO TO 3033-ACCT-NOT-FOUND
  9309     END-IF.
  9310
  9311     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9312        WS-EFFDT LESS AM-EXPIRATION-DT
  9313         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9314         MOVE AM-CARRIER       TO CERT-CARRIER
  9315         MOVE AM-GROUPING      TO CERT-GROUPING
  9316         MOVE AM-STATE         TO CERT-STATE
  9317         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9318         MOVE WS-EFFDT         TO CERT-EFF-DT
  9319         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9320         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9321         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9322         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9323     END-IF.
  9324
  9325     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9326         GO TO 3031-READ-ACCT-LOOP
  9327     END-IF.
  9328
  9329 3032-NOT-IN-DT-RANGE.
  9330     MOVE ER-0226                TO EMI-ERROR.
  9331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9332     MOVE -1                     TO EFFDTL.
  9333     GO TO 8200-SEND-DATAONLY.
  9334
  9335 3033-ACCT-NOT-FOUND.
  9336     MOVE ER-0226 TO EMI-ERROR.
  9337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338     MOVE -1                     TO ACCOUNTL.
  9339     GO TO 8200-SEND-DATAONLY.
  9340
  9341 3034-CHECK-EMPLOYER-STATEMENT.
  9342
  9343     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9344*        NEXT SENTENCE
  9345         CONTINUE
  9346     ELSE
  9347         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9348     END-IF.
  9349
  9350     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9351     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9352     MOVE '1'                    TO  DC-OPTION-CODE.
  9353     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9354                                     DC-ELAPSED-DAYS.
  9355     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 175
* EL130.cbl
  9356
  9357     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9358         DC-ELAPSED-DAYS LESS THAN +31)
  9359                      OR
  9360        (AM-EMPLOYER-STMT-USED = '2' AND
  9361         DC-ELAPSED-DAYS LESS THAN +61)
  9362                      OR
  9363        (AM-EMPLOYER-STMT-USED = '3' AND
  9364         DC-ELAPSED-DAYS LESS THAN +91)
  9365            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9366     END-IF.
  9367
  9368 3034-CHECK-ACCOUNT-LIMITS.
  9369
  9370     IF CERTMTI NOT = 'A'
  9371         GO TO 3060-BUILD-CONT
  9372     END-IF.
  9373
  9374     IF AM-STATUS NOT = '0'
  9375         MOVE ER-0225                TO EMI-ERROR
  9376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9377         MOVE -1                     TO ACCOUNTL
  9378     END-IF.
  9379
  9380     IF EIBAID = DFHPF6
  9381         IF EMI-FATAL-CTR NOT = ZERO
  9382             MOVE ER-0434         TO EMI-ERROR
  9383             MOVE -1              TO MAINTL
  9384             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385             GO TO 8200-SEND-DATAONLY
  9386         END-IF
  9387     END-IF.
  9388
  9389*    IF PI-COMPANY-ID NOT = 'CRI'
  9390*        GO TO 3035-END-BROWSE
  9391*    END-IF.
  9392
  9393 3035-END-BROWSE.
  9394
  9395
  9396* EXEC CICS ENDBR
  9397*        DATASET    (ERACCT2-DSID)
  9398*    END-EXEC.
  9399     MOVE 0
  9400       TO DFHEIV11
  9401*    MOVE '&2                    $   #00008915' TO DFHEIV0
  9402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9404     MOVE X'2020233030303038393135' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0,
  9406           ERACCT2-DSID,
  9407           DFHEIV11,
  9408           DFHEIV99
  9409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9410
  9411
  9412 3040-CHECK-CERT-ALREADY-ON.
  9413
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 176
* EL130.cbl
  9414
  9415* EXEC CICS HANDLE CONDITION
  9416*        NOTFND   (3070-BUILD-CONT)
  9417*    END-EXEC.
  9418*    MOVE '"$I                   ! 1 #00008921' TO DFHEIV0
  9419     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9421     MOVE X'3120233030303038393231' TO DFHEIV0(25:11)
  9422     CALL 'kxdfhei1' USING DFHEIV0
  9423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9424
  9425
  9426     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9427
  9428     MOVE ER-0229                TO EMI-ERROR.
  9429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9430     MOVE -1                     TO MAINTL.
  9431     GO TO 8200-SEND-DATAONLY.
  9432
  9433 3060-BUILD-CONT.
  9434     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9435     MOVE CRTCARRI               TO CERT-CARRIER.
  9436     MOVE GROUPI                 TO CERT-GROUPING.
  9437     MOVE STATEI                 TO CERT-STATE.
  9438     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9439     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9440     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9441     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9442
  9443
  9444
  9445* EXEC CICS HANDLE CONDITION
  9446*        NOTFND  (3065-CERT-NOT-FOUND)
  9447*    END-EXEC.
  9448*    MOVE '"$I                   ! 2 #00008943' TO DFHEIV0
  9449     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9451     MOVE X'3220233030303038393433' TO DFHEIV0(25:11)
  9452     CALL 'kxdfhei1' USING DFHEIV0
  9453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9454
  9455
  9456     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9457
  9458     GO TO 3070-BUILD-CONT.
  9459
  9460 3065-CERT-NOT-FOUND.
  9461     MOVE ER-0244                TO EMI-ERROR.
  9462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9463     MOVE -1                     TO CERTNOL.
  9464     GO TO 8200-SEND-DATAONLY.
  9465
  9466 3070-BUILD-CONT.
  9467     IF CLMNOL NOT = ZERO
  9468         GO TO 3200-BUILD-ZERO-TRAILER
  9469     END-IF.
  9470
  9471     MOVE SPACES                 TO ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 177
* EL130.cbl
  9472
  9473     IF CONTROL-IS-ACTUAL-CARRIER
  9474         MOVE PI-CARRIER         TO CNTL-CARRIER
  9475     ELSE
  9476         MOVE PI-CARRIER-CONTROL-LEVEL
  9477                                 TO CNTL-CARRIER
  9478     END-IF.
  9479
  9480     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9481     MOVE '6'                    TO CNTL-REC-TYPE.
  9482     MOVE +0                     TO CNTL-SEQ-NO.
  9483
  9484
  9485
  9486* EXEC CICS HANDLE CONDITION
  9487*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9488*    END-EXEC.
  9489*    MOVE '"$I                   ! 3 #00008976' TO DFHEIV0
  9490     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9492     MOVE X'3320233030303038393736' TO DFHEIV0(25:11)
  9493     CALL 'kxdfhei1' USING DFHEIV0
  9494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9495
  9496
  9497
  9498
  9499* EXEC CICS READ
  9500*        UPDATE
  9501*        DATASET   (ELCNTL-DSID)
  9502*        SET       (ADDRESS OF CONTROL-FILE)
  9503*        RIDFLD    (ELCNTL-KEY)
  9504*    END-EXEC.
  9505*    MOVE '&"S        EU         (   #00008981' TO DFHEIV0
  9506     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9507     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9508     MOVE X'2020233030303038393831' TO DFHEIV0(25:11)
  9509     CALL 'kxdfhei1' USING DFHEIV0,
  9510           ELCNTL-DSID,
  9511           DFHEIV20,
  9512           DFHEIV99,
  9513           ELCNTL-KEY,
  9514           DFHEIV99,
  9515           DFHEIV99,
  9516           DFHEIV99
  9517     SET ADDRESS OF CONTROL-FILE TO
  9518         DFHEIV20
  9519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9520
  9521
  9522     IF CLAIM-NO-MANUAL
  9523         GO TO 3120-CLAIM-MUST-BE-INPUT
  9524     END-IF.
  9525
  9526     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9527     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9528
  9529     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 178
* EL130.cbl
  9530         CONTINUE
  9531     ELSE
  9532         GO TO 3080-ASSIGN-LOOP
  9533     END-IF.
  9534
  9535
  9536
  9537* EXEC CICS UNLOCK
  9538*        DATASET   (ELCNTL-DSID)
  9539*    END-EXEC.
  9540*    MOVE '&*                    #   #00009002' TO DFHEIV0
  9541     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9543     MOVE X'2020233030303039303032' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0,
  9545           ELCNTL-DSID,
  9546           DFHEIV99
  9547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9548
  9549
  9550     MOVE '1'                    TO CNTL-REC-TYPE.
  9551     MOVE SPACES                 TO CNTL-ACCESS.
  9552
  9553     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9554
  9555
  9556
  9557* EXEC CICS HANDLE CONDITION
  9558*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9559*    END-EXEC.
  9560*    MOVE '"$I                   ! 4 #00009012' TO DFHEIV0
  9561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9563     MOVE X'3420233030303039303132' TO DFHEIV0(25:11)
  9564     CALL 'kxdfhei1' USING DFHEIV0
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9566
  9567
  9568     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9569
  9570     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9571
  9572 3080-ASSIGN-LOOP.
  9573     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9574        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9575         MOVE +0                 TO SAVE-COUNTER
  9576     END-IF.
  9577
  9578     ADD +1 TO SAVE-COUNTER.
  9579
  9580     IF SAVE-METHOD  = '3'
  9581         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9582         GO TO 3090-SET-COMP
  9583     END-IF.
  9584
  9585     IF SAVE-METHOD  = '4'
  9586         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9587         MOVE CLMCARRI           TO WS-CN-PRF-A
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 179
* EL130.cbl
  9588         GO TO 3090-SET-COMP
  9589     END-IF.
  9590
  9591     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9592     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9593     MOVE SAVE-DATE              TO CURR-DATE.
  9594
  9595     IF CURR-MM LESS '10'
  9596         MOVE CURR-M2             TO WS-CN-PRF-B
  9597     END-IF.
  9598
  9599     IF CURR-MM = '10'
  9600        MOVE 'A'                 TO WS-CN-PRF-B
  9601     END-IF.
  9602     IF CURR-MM = '11'
  9603        MOVE 'B'                 TO WS-CN-PRF-B
  9604     END-IF.
  9605     IF CURR-MM = '12'
  9606        MOVE 'C'                 TO WS-CN-PRF-B
  9607     END-IF.
  9608
  9609     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9610
  9611 3090-SET-COMP.
  9612
  9613     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9614     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9615                                    CLMNOO.
  9616     MOVE AL-UANON               TO CLMNOA.
  9617     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9618     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9619     MOVE CLMCARRI               TO MSTR-CARRIER.
  9620
  9621
  9622
  9623* EXEC CICS HANDLE CONDITION
  9624*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9625*    END-EXEC.
  9626*    MOVE '"$I                   ! 5 #00009070' TO DFHEIV0
  9627     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9629     MOVE X'3520233030303039303730' TO DFHEIV0(25:11)
  9630     CALL 'kxdfhei1' USING DFHEIV0
  9631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9632
  9633
  9634     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9635
  9636     GO TO 3080-ASSIGN-LOOP.
  9637
  9638 3100-CARRIER-NOT-FOUND.
  9639     MOVE ER-0252                TO EMI-ERROR.
  9640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9641     MOVE -1                     TO CLMCARRL.
  9642     GO TO 8200-SEND-DATAONLY.
  9643
  9644 3110-COMPANY-NOT-FOUND.
  9645     MOVE ER-0254                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 180
* EL130.cbl
  9646     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647     MOVE -1                     TO MAINTL.
  9648     GO TO 8200-SEND-DATAONLY.
  9649
  9650 3120-CLAIM-MUST-BE-INPUT.
  9651     MOVE ER-0264                TO EMI-ERROR.
  9652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653     MOVE -1                     TO CLMNOL.
  9654     GO TO 8200-SEND-DATAONLY.
  9655
  9656 3200-BUILD-ZERO-TRAILER.
  9657
  9658
  9659* EXEC CICS HANDLE CONDITION
  9660*        NOTFND
  9661*    END-EXEC.
  9662*    MOVE '"$                   ! 6 #00009098' TO DFHEIV0
  9663     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9665     MOVE X'3620233030303039303938' TO DFHEIV0(25:11)
  9666     CALL 'kxdfhei1' USING DFHEIV0
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670
  9671
  9672* EXEC CICS GETMAIN
  9673*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9674*        LENGTH  (ELTRLR-LENGTH)
  9675*    END-EXEC.
  9676*    MOVE '," L                  $   #00009103' TO DFHEIV0
  9677     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9679     MOVE X'2020233030303039313033' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0,
  9681           DFHEIV20,
  9682           ELTRLR-LENGTH,
  9683           DFHEIV99
  9684     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9685         DFHEIV20
  9686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9687
  9688
  9689     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9690     MOVE 'AT'                   TO AT-RECORD-ID.
  9691
  9692     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9693     MOVE CLMCARRI               TO AT-CARRIER.
  9694     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9695     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9696     MOVE +0                     TO AT-SEQUENCE-NO.
  9697     MOVE '1'                    TO AT-TRAILER-TYPE.
  9698
  9699     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9700     MOVE '5'                    TO DC-OPTION-CODE.
  9701     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9702     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9703                                    AT-RESERVES-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 181
* EL130.cbl
  9704
  9705     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9706                                    AT-RESERVES-LAST-UPDATED-BY.
  9707
  9708     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9709
  9710     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9711
  9712     MOVE +0                     TO AT-FUTURE-RESERVE
  9713                                    AT-IBNR-RESERVE
  9714                                    AT-PAY-CURRENT-RESERVE
  9715                                    AT-INITIAL-MANUAL-RESERVE
  9716                                    AT-CURRENT-MANUAL-RESERVE
  9717                                    AT-ITD-LIFE-REFUNDS
  9718                                    AT-ITD-AH-REFUNDS
  9719                                    AT-ITD-ADDITIONAL-RESERVE.
  9720
  9721     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9722
  9723     IF MANRSVL NOT = ZERO
  9724         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9725                                    AT-CURRENT-MANUAL-RESERVE
  9726     END-IF.
  9727
  9728     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9729
  9730     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9731                                    AT-ITD-CHARGEABLE-EXPENSE.
  9732
  9733     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9734     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9735     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9736
  9737
  9738
  9739* EXEC CICS WRITE
  9740*        DATASET   (ELTRLR-DSID)
  9741*        FROM      (ACTIVITY-TRAILERS)
  9742*        RIDFLD    (AT-CONTROL-PRIMARY)
  9743*    END-EXEC.
  9744     MOVE LENGTH OF
  9745      ACTIVITY-TRAILERS
  9746       TO DFHEIV11
  9747*    MOVE '&$ L                  ''   #00009157' TO DFHEIV0
  9748     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9749     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9750     MOVE X'2020233030303039313537' TO DFHEIV0(25:11)
  9751     CALL 'kxdfhei1' USING DFHEIV0,
  9752           ELTRLR-DSID,
  9753           ACTIVITY-TRAILERS,
  9754           DFHEIV11,
  9755           AT-CONTROL-PRIMARY,
  9756           DFHEIV99,
  9757           DFHEIV99
  9758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9759
  9760
  9761     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 182
* EL130.cbl
  9762
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 183
* EL130.cbl
  9764
  9765 3250-BUILD-I1-ADDRESS-TRAILER.
  9766
  9767     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9768     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9769     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9770     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9771     MOVE GROUPI                 TO WS-MA-GROUPING.
  9772     MOVE STATEI                 TO WS-MA-STATE.
  9773     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9774     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9775     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9776     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9777
  9778
  9779* EXEC CICS HANDLE CONDITION
  9780*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9781*    END-EXEC.
  9782*    MOVE '"$I                   ! 7 #00009180' TO DFHEIV0
  9783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9785     MOVE X'3720233030303039313830' TO DFHEIV0(25:11)
  9786     CALL 'kxdfhei1' USING DFHEIV0
  9787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9788
  9789
  9790
  9791* EXEC CICS READ
  9792*        EQUAL
  9793*        DATASET   (ERMAIL-DSID)
  9794*        SET       (ADDRESS OF MAILING-DATA)
  9795*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9796*    END-EXEC.
  9797*    MOVE '&"S        E          (   #00009184' TO DFHEIV0
  9798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9800     MOVE X'2020233030303039313834' TO DFHEIV0(25:11)
  9801     CALL 'kxdfhei1' USING DFHEIV0,
  9802           ERMAIL-DSID,
  9803           DFHEIV20,
  9804           DFHEIV99,
  9805           WS-MA-CONTROL-PRIMARY,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV99
  9809     SET ADDRESS OF MAILING-DATA TO
  9810         DFHEIV20
  9811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9812
  9813
  9814     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9815         GO TO 3290-NO-INSURED-ADDRESS
  9816     END-IF.
  9817
  9818     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9819     MOVE 'AT'                   TO AT-RECORD-ID.
  9820
  9821     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 184
* EL130.cbl
  9822     MOVE CLMCARRI               TO AT-CARRIER.
  9823     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9824     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9825     MOVE +1                     TO AT-SEQUENCE-NO.
  9826     MOVE '5'                    TO AT-TRAILER-TYPE.
  9827
  9828     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9829     IF MA-INSURED-MIDDLE-INIT > SPACES
  9830        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9831               ' ' DELIMITED BY SIZE
  9832               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9833               ' ' DELIMITED BY SIZE
  9834               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9835        INTO AT-MAIL-TO-NAME
  9836     ELSE
  9837        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9838               ' ' DELIMITED BY SIZE
  9839               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9840        INTO AT-MAIL-TO-NAME
  9841     END-IF.
  9842     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9843     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9844*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9845     MOVE MA-CITY                TO AT-CITY
  9846     MOVE MA-ADDR-STATE          TO AT-STATE
  9847     MOVE MA-ZIP                 TO AT-ZIP
  9848     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9849
  9850     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9851                                    AT-ADDRESS-LAST-MAINT-DT.
  9852
  9853     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9854                                    AT-ADDRESS-LAST-UPDATED-BY.
  9855
  9856     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9857
  9858
  9859* EXEC CICS WRITE
  9860*        DATASET   (ELTRLR-DSID)
  9861*        FROM      (ACTIVITY-TRAILERS)
  9862*        RIDFLD    (AT-CONTROL-PRIMARY)
  9863*    END-EXEC.
  9864     MOVE LENGTH OF
  9865      ACTIVITY-TRAILERS
  9866       TO DFHEIV11
  9867*    MOVE '&$ L                  ''   #00009235' TO DFHEIV0
  9868     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9870     MOVE X'2020233030303039323335' TO DFHEIV0(25:11)
  9871     CALL 'kxdfhei1' USING DFHEIV0,
  9872           ELTRLR-DSID,
  9873           ACTIVITY-TRAILERS,
  9874           DFHEIV11,
  9875           AT-CONTROL-PRIMARY,
  9876           DFHEIV99,
  9877           DFHEIV99
  9878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9879
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 185
* EL130.cbl
  9880
  9881     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9882     GO TO 3300-BUILD-NINETY-TRAILER.
  9883
  9884 3290-NO-INSURED-ADDRESS.
  9885      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9886
  9887 3300-BUILD-NINETY-TRAILER.
  9888
  9889     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9890     MOVE 'AT'                   TO AT-RECORD-ID.
  9891
  9892     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9893     MOVE CLMCARRI               TO AT-CARRIER.
  9894
  9895     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9896     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9897     MOVE +90                    TO AT-SEQUENCE-NO.
  9898     MOVE '6'                    TO AT-TRAILER-TYPE.
  9899
  9900     IF DIAGL NOT = ZERO
  9901         MOVE DIAGI              TO AT-INFO-LINE-1
  9902     END-IF.
  9903
  9904     IF ICD1L NOT = ZERO
  9905         MOVE ICD1I              TO AT-ICD-CODE-1
  9906     END-IF.
  9907
  9908     IF ICD2L NOT = ZERO
  9909         MOVE ICD2I              TO AT-ICD-CODE-2
  9910     END-IF.
  9911
  9912     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9913                                    AT-GEN-INFO-LAST-MAINT-DT.
  9914
  9915     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9916                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9917     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9918
  9919
  9920
  9921* EXEC CICS WRITE
  9922*        DATASET   (ELTRLR-DSID)
  9923*        FROM      (ACTIVITY-TRAILERS)
  9924*        RIDFLD    (AT-CONTROL-PRIMARY)
  9925*    END-EXEC.
  9926     MOVE LENGTH OF
  9927      ACTIVITY-TRAILERS
  9928       TO DFHEIV11
  9929*    MOVE '&$ L                  ''   #00009280' TO DFHEIV0
  9930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9932     MOVE X'2020233030303039323830' TO DFHEIV0(25:11)
  9933     CALL 'kxdfhei1' USING DFHEIV0,
  9934           ELTRLR-DSID,
  9935           ACTIVITY-TRAILERS,
  9936           DFHEIV11,
  9937           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 186
* EL130.cbl
  9938           DFHEIV99,
  9939           DFHEIV99
  9940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9941
  9942
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 187
* EL130.cbl
  9944 3400-CHECK-CERT-MAINT.
  9945
  9946     IF CERTMTI = 'A'
  9947         GO TO 3600-BUILD-NEW-CERT
  9948     END-IF.
  9949
  9950     IF NO-CLAIM-ATTACHED
  9951         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9952     END-IF.
  9953
  9954     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9955
  9956     IF CM-LF-CURRENT-STATUS = '2' OR
  9957        CM-AH-CURRENT-STATUS = '2'
  9958         GO TO 3400-REWRITE-CERT
  9959     END-IF.
  9960
  9961     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9962
  9963 3400-REWRITE-CERT.
  9964
  9965
  9966
  9967* EXEC CICS HANDLE CONDITION
  9968*        DUPKEY (3410-DUP-KEY)
  9969*    END-EXEC.
  9970*    MOVE '"$$                   ! 8 #00009309' TO DFHEIV0
  9971     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9973     MOVE X'3820233030303039333039' TO DFHEIV0(25:11)
  9974     CALL 'kxdfhei1' USING DFHEIV0
  9975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9976
  9977
  9978
  9979
  9980* EXEC CICS REWRITE
  9981*        DATASET   (ELCERT-DSID)
  9982*        FROM      (CERTIFICATE-MASTER)
  9983*    END-EXEC.
  9984     MOVE LENGTH OF
  9985      CERTIFICATE-MASTER
  9986       TO DFHEIV11
  9987*    MOVE '&& L                  %   #00009314' TO DFHEIV0
  9988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303039333134' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           ELCERT-DSID,
  9993           CERTIFICATE-MASTER,
  9994           DFHEIV11,
  9995           DFHEIV99
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999 3410-DUP-KEY.
 10000     GO TO 3800-BUILD-NEW-CLAIM.
 10001
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 188
* EL130.cbl
 10002 3600-BUILD-NEW-CERT.
 10003
 10004
 10005* EXEC CICS GETMAIN
 10006*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10007*        LENGTH   (ELCERT-LENGTH)
 10008*    END-EXEC.
 10009*    MOVE '," L                  $   #00009324' TO DFHEIV0
 10010     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10012     MOVE X'2020233030303039333234' TO DFHEIV0(25:11)
 10013     CALL 'kxdfhei1' USING DFHEIV0,
 10014           DFHEIV20,
 10015           ELCERT-LENGTH,
 10016           DFHEIV99
 10017     SET ADDRESS OF CERTIFICATE-MASTER TO
 10018         DFHEIV20
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10023
 10024     MOVE 'CM'                   TO CM-RECORD-ID.
 10025
 10026     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10027                                    CM-COMPANY-CD-A1
 10028                                    CM-COMPANY-CD-A2
 10029                                    CM-COMPANY-CD-A4
 10030                                    CM-COMPANY-CD-A5.
 10031
 10032     MOVE CERT-CARRIER           TO CM-CARRIER.
 10033     MOVE CERT-GROUPING          TO CM-GROUPING.
 10034     MOVE CERT-STATE             TO CM-STATE.
 10035     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10036     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10037     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10038
 10039     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10040                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10041                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10042                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10043                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10044                       CM-LIVES              CM-LOAN-TERM
 10045                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10046                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10047                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10048                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10049                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10050                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10051                       CM-LF-ALT-PREMIUM-RATE
 10052                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10053                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10054                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10055                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10056                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10057
 10058     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10059                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 189
* EL130.cbl
 10060                                    CM-AH-SETTLEMENT-DT
 10061                                    CM-AH-CANCEL-EXIT-DT
 10062                                    CM-AH-SETTLEMENT-EXIT-DT
 10063                                    CM-LF-LOAN-EXPIRE-DT
 10064                                    CM-LF-CANCEL-DT
 10065                                    CM-LF-DEATH-DT
 10066                                    CM-LF-CANCEL-EXIT-DT
 10067                                    CM-LF-DEATH-EXIT-DT
 10068                                    CM-LAST-ADD-ON-DT
 10069                                    CM-ENTRY-DT.
 10070
 10071     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10072     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10073     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10074
 10075     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10076                                    CM-PART-LAST-NAME-A2
 10077                                    CM-PART-LAST-NAME-A5.
 10078
 10079     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10080                                    CM-INSURED-INITIAL1-A2
 10081                                    CM-INSURED-INITIAL1-A5
 10082                                    CM-INSURED-FIRST-NAME.
 10083
 10084     IF CRTINITL GREATER ZERO
 10085         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10086                                    CM-INSURED-INITIAL2-A2
 10087                                    CM-INSURED-INITIAL2-A5
 10088     ELSE
 10089         MOVE SPACES             TO CM-INSURED-INITIAL2
 10090                                    CM-INSURED-INITIAL2-A2
 10091                                    CM-INSURED-INITIAL2-A5
 10092     END-IF.
 10093
 10094     IF CM-INSURED-INITIALS = SPACES
 10095         MOVE '**'               TO CM-INSURED-INITIALS
 10096     END-IF.
 10097
 10098     IF MEMBERL GREATER ZERO
 10099         MOVE MEMBERI              TO CM-MEMBER-NO
 10100     ELSE
 10101         MOVE CERT-STATE           TO CM-MEMB-STATE
 10102         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10103         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10104         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10105     END-IF.
 10106
 10107     IF JNTLNMEL GREATER ZERO
 10108         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10109     END-IF.
 10110
 10111     IF JNTFNMEL GREATER ZERO
 10112         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10113     END-IF.
 10114
 10115     IF JNTINITL GREATER ZERO
 10116         MOVE JNTINITI           TO CM-JT-INITIAL
 10117     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 190
* EL130.cbl
 10118
 10119     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10120
 10121
 10122
 10123* EXEC CICS HANDLE CONDITION
 10124*        DUPKEY   (3690-CERT-WRITTEN)
 10125*    END-EXEC.
 10126*    MOVE '"$$                   ! 9 #00009429' TO DFHEIV0
 10127     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10129     MOVE X'3920233030303039343239' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0
 10131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10132
 10133
 10134
 10135
 10136* EXEC CICS WRITE
 10137*        DATASET   (ELCERT-DSID)
 10138*        FROM      (CERTIFICATE-MASTER)
 10139*        RIDFLD    (CM-CONTROL-PRIMARY)
 10140*    END-EXEC.
 10141     MOVE LENGTH OF
 10142      CERTIFICATE-MASTER
 10143       TO DFHEIV11
 10144*    MOVE '&$ L                  ''   #00009434' TO DFHEIV0
 10145     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039343334' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           ELCERT-DSID,
 10150           CERTIFICATE-MASTER,
 10151           DFHEIV11,
 10152           CM-CONTROL-PRIMARY,
 10153           DFHEIV99,
 10154           DFHEIV99
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158 3690-CERT-WRITTEN.
 10159
 10160     GO TO 3800-BUILD-NEW-CLAIM.
 10161
 10162 3690-EXIT.
 10163      EXIT.
 10164
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 191
* EL130.cbl
 10166 3700-BUILD-CERT.
 10167
 10168     IF CERTMTI NOT = 'A'
 10169         GO TO 3700-FINISH-CERT-BUILD
 10170     END-IF.
 10171
 10172     IF CERTMTI = 'A'
 10173         IF LCVCDL = ZEROS
 10174             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10175                                    CM-LF-ORIG-TERM
 10176                                    CM-LF-BENEFIT-AMT
 10177                                    CM-LF-PREMIUM-RATE
 10178             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10179         END-IF
 10180     END-IF.
 10181
 10182     IF LCVCDL GREATER ZERO
 10183         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10184     END-IF.
 10185
 10186     IF LCVOTRML GREATER ZERO
 10187         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10188     END-IF.
 10189
 10190     IF LCVBENEL GREATER ZERO
 10191         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10192     END-IF.
 10193
 10194     IF LCVRATEL GREATER ZERO
 10195         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10196     END-IF.
 10197
 10198     IF WS-EXPIRE NOT = LOW-VALUES
 10199         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10200     END-IF.
 10201
 10202     IF LCVFORML GREATER ZERO
 10203         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10204     END-IF.
 10205
 10206     IF LCVCNDTL = ZERO
 10207        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10208     END-IF.
 10209
 10210     IF WS-LCVCNDT NOT = LOW-VALUES
 10211        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10212        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10213        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10214     END-IF.
 10215
 10216     IF CM-LF-CURRENT-STATUS = '7'
 10217        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10218        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10219        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10220                                    CM-LF-DEATH-DT
 10221        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10222     END-IF.
 10223
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 192
* EL130.cbl
 10224     IF CM-LF-CURRENT-STATUS = '8'
 10225        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10226        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10227     END-IF.
 10228
 10229 3700-BUILD-AH-COVERAGE-SIDE.
 10230
 10231     IF CERTMTI = 'A'
 10232         IF ACVCDL = ZEROS
 10233             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10234                                    CM-AH-ORIG-TERM
 10235                                    CM-AH-BENEFIT-AMT
 10236                                    CM-AH-PREMIUM-RATE
 10237             GO TO 3700-COVERAGE-BUILT
 10238         END-IF
 10239     END-IF.
 10240
 10241     IF ACVCDL GREATER ZERO
 10242         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10243     END-IF.
 10244
 10245     IF ACVOTRML GREATER ZERO
 10246         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10247     END-IF.
 10248
 10249     IF ACVBENEL GREATER ZERO
 10250         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10251     END-IF.
 10252
 10253     IF ACVRATEL GREATER ZERO
 10254         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10255     END-IF.
 10256
 10257     IF WS-EXPIRE NOT = LOW-VALUES
 10258         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10259     END-IF.
 10260
 10261     IF ACVFORML GREATER ZERO
 10262         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10263     END-IF.
 10264
 10265     IF ACVCNDTL = ZERO
 10266        GO TO 3700-COVERAGE-BUILT
 10267     END-IF.
 10268
 10269     IF WS-ACVCNDT NOT = LOW-VALUES
 10270        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10271        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10272        GO TO 3700-COVERAGE-BUILT
 10273     END-IF.
 10274
 10275     IF CM-AH-CURRENT-STATUS = '6'
 10276        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10277        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10278        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10279        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10280        GO TO 3700-COVERAGE-BUILT
 10281     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 193
* EL130.cbl
 10282
 10283     IF CM-AH-CURRENT-STATUS = '8'
 10284        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10285        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10286     END-IF.
 10287
 10288 3700-COVERAGE-BUILT.
 10289     IF ISSAGEL GREATER ZERO
 10290         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10291     END-IF.
 10292
 10293     IF JNTAGEL GREATER ZERO
 10294         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10295     END-IF.
 10296
 10297     IF SEXL GREATER ZERO
 10298         MOVE SEXI               TO CM-INSURED-SEX
 10299     END-IF.
 10300
 10301     IF APRL GREATER ZERO
 10302         MOVE WS-APR             TO CM-LOAN-APR
 10303     END-IF.
 10304
 10305     IF PMTFREQL GREATER ZERO
 10306         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10307     END-IF.
 10308
 10309     IF INDGRPL GREATER ZERO
 10310         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10311     END-IF.
 10312
 10313     IF CERTMTI = 'A'
 10314         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10315     END-IF.
 10316
 10317     IF REINCDL GREATER ZERO
 10318         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10319                                    WS-REIN-1
 10320                                    WS-REIN-2
 10321                                    WS-REIN-3
 10322         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10323     END-IF.
 10324
 10325     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10326         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10327     END-IF.
 10328
 10329     IF CRTSSNL GREATER ZERO
 10330         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10331     ELSE
 10332         IF SSNL GREATER ZERO
 10333             MOVE SSNI           TO CM-SOC-SEC-NO
 10334         END-IF
 10335     END-IF.
 10336
 10337     IF CRTSSNL = ZERO AND
 10338        SSNL    = ZERO
 10339         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 194
* EL130.cbl
 10340         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10341         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10342         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10343     END-IF.
 10344
 10345     IF CM-LF-CURRENT-STATUS = SPACES
 10346         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10347     END-IF.
 10348
 10349     IF CM-AH-CURRENT-STATUS = SPACES
 10350         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10351     END-IF.
 10352
 10353     IF CERTMTI = 'A'
 10354         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10355     END-IF.
 10356
 10357 3700-FINISH-CERT-BUILD.
 10358
 10359     IF LOANNOL GREATER ZERO
 10360         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10361     END-IF.
 10362
 10363     IF LOANBALL GREATER ZERO
 10364         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10365     END-IF.
 10366
 10367     IF PREMTYPL GREATER ZERO
 10368         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10369     END-IF.
 10370
 10371 3700-EXIT.
 10372      EXIT.
 10373
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 195
* EL130.cbl
 10375 3800-BUILD-NEW-CLAIM.
 10376
 10377*************************************************************
 10378*****           START OF ACTIVITY FILE PROCESSING          **
 10379*************************************************************
 10380     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10381         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10382                 6700-EXIT
 10383     END-IF.
 10384*************************************************************
 10385*****            END OF ACTIVITY FILE PROCESSING           **
 10386*************************************************************
 10387
 10388
 10389
 10390
 10391* EXEC CICS GETMAIN
 10392*        SET     (ADDRESS OF CLAIM-MASTER)
 10393*        LENGTH  (ELMSTR-LENGTH)
 10394*    END-EXEC.
 10395*    MOVE '," L                  $   #00009672' TO DFHEIV0
 10396     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10397     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10398     MOVE X'2020233030303039363732' TO DFHEIV0(25:11)
 10399     CALL 'kxdfhei1' USING DFHEIV0,
 10400           DFHEIV20,
 10401           ELMSTR-LENGTH,
 10402           DFHEIV99
 10403     SET ADDRESS OF CLAIM-MASTER TO
 10404         DFHEIV20
 10405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10406
 10407
 10408     MOVE SPACES TO CLAIM-MASTER.
 10409
 10410     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10411         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10412         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10413         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10414         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10415         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10416         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10417         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10418
 10419     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10420             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10421             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10422             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10423             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10424             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10425             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10426             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10427             CL-FORCEABLE-ERROR-CNT.
 10428
 10429     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10430
 10431     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10432                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 196
* EL130.cbl
 10433                                    CL-LAG-REPORT-CODE
 10434                                    CL-CRITICAL-PERIOD
 10435*                                   CL-CRIT-PER-RTW-MOS
 10436     move 01                     to cl-benefit-period
 10437
 10438     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10439     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10440
 10441     IF BENECDL NOT = ZEROS
 10442        MOVE BENECDI             TO CL-BENEFICIARY
 10443     END-IF.
 10444
 10445     MOVE 'CL'                   TO CL-RECORD-ID.
 10446     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10447
 10448     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10449                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10450                             CL-COMPANY-CD-A5.
 10451
 10452     MOVE CLMCARRI               TO CL-CARRIER.
 10453
 10454     IF CLMNOL = ZERO
 10455         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10456     ELSE
 10457         MOVE CLMNOI             TO CL-CLAIM-NO
 10458     END-IF.
 10459
 10460     MOVE CERTNOI                TO CL-CERT-PRIME
 10461                                    CL-CERT-A4-PRIME.
 10462
 10463     MOVE SUFXI                  TO CL-CERT-SFX
 10464                                    CL-CERT-A4-SFX.
 10465
 10466     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10467
 10468     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10469
 10470     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10471
 10472     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10473
 10474     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10475     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10476
 10477     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10478
 10479     IF CERTMTI = 'A'
 10480         MOVE '2'                TO CL-CERT-ORIGIN
 10481     ELSE
 10482         MOVE '1'                TO CL-CERT-ORIGIN
 10483     END-IF.
 10484
 10485     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10486     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10487     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10488     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10489     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10490
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 197
* EL130.cbl
 10491 3820-REWRITE-CONTROL-FILE.
 10492
 10493     IF CLMNOL GREATER ZERO
 10494         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10495     END-IF.
 10496
 10497     IF CF-RECORD-TYPE = '6'
 10498         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10499     ELSE
 10500         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10501     END-IF.
 10502
 10503
 10504
 10505* EXEC CICS REWRITE
 10506*        DATASET   (ELCNTL-DSID)
 10507*        FROM      (CONTROL-FILE)
 10508*    END-EXEC.
 10509     MOVE LENGTH OF
 10510      CONTROL-FILE
 10511       TO DFHEIV11
 10512*    MOVE '&& L                  %   #00009773' TO DFHEIV0
 10513     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10514     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10515     MOVE X'2020233030303039373733' TO DFHEIV0(25:11)
 10516     CALL 'kxdfhei1' USING DFHEIV0,
 10517           ELCNTL-DSID,
 10518           CONTROL-FILE,
 10519           DFHEIV11,
 10520           DFHEIV99
 10521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10522
 10523
 10524 3830-SEQUENCE-CLAIM-RECORDS.
 10525
 10526     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10527     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10528     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10529
 10530     IF WS-ASSOC-CERT-TOTAL = ZERO
 10531         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10532                                    CL-ASSOC-CERT-TOTAL
 10533         GO TO 3840-WRITE-CLAIM-MASTER
 10534     END-IF.
 10535
 10536     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10537         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10538     ELSE
 10539         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10540     END-IF.
 10541
 10542     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10543     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10544     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10545
 10546 3840-WRITE-CLAIM-MASTER.
 10547
 10548     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 198
* EL130.cbl
 10549     IF WS-REC-FOUND-SW = 'Y'
 10550         MOVE 01                 TO  CL-ACTIVITY-CODE
 10551         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10552         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10553     END-IF.
 10554
 10555
 10556
 10557* EXEC CICS HANDLE CONDITION
 10558*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10559*    END-EXEC.
 10560*    MOVE '"$$                   ! : #00009810' TO DFHEIV0
 10561     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10563     MOVE X'3A20233030303039383130' TO DFHEIV0(25:11)
 10564     CALL 'kxdfhei1' USING DFHEIV0
 10565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10566
 10567
 10568** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10569     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10570
 10571
 10572*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10573*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10574*       CL-CERT-NO
 10575*    IF CL-COMPANY-CD = X'04'
 10576*       DISPLAY ' CID COMP CD '
 10577*    ELSE
 10578*       IF CL-COMPANY-CD = X'05'
 10579*          DISPLAY ' DCC COMP CD '
 10580*       ELSE
 10581*          DISPLAY ' UNKNOWN COMP CD '
 10582*       END-IF
 10583*    END-IF
 10584
 10585* EXEC CICS WRITE
 10586*        DATASET   (ELMSTR-DSID)
 10587*        FROM      (CLAIM-MASTER)
 10588*        RIDFLD    (CL-CONTROL-PRIMARY)
 10589*    END-EXEC.
 10590     MOVE LENGTH OF
 10591      CLAIM-MASTER
 10592       TO DFHEIV11
 10593*    MOVE '&$ L                  ''   #00009830' TO DFHEIV0
 10594     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10595     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10596     MOVE X'2020233030303039383330' TO DFHEIV0(25:11)
 10597     CALL 'kxdfhei1' USING DFHEIV0,
 10598           ELMSTR-DSID,
 10599           CLAIM-MASTER,
 10600           DFHEIV11,
 10601           CL-CONTROL-PRIMARY,
 10602           DFHEIV99,
 10603           DFHEIV99
 10604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10605
 10606
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 199
* EL130.cbl
 10607 3850-CLAIM-MSTR-WRITTEN.
 10608
 10609     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10610         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10611     END-IF.
 10612
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 200
* EL130.cbl
 10614 3990-ADD-DONE.
 10615*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10616*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10617*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10618*                                  EMI-ERROR-LINES.
 10619
 10620     IF CLMNOL = ZERO
 10621         move spaces             to emi-claim-no
 10622         MOVE ER-0265            TO EMI-ERROR
 10623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10624         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10625                                    PI-LAST-CLAIM
 10626     ELSE
 10627         MOVE CLMNOI             TO PI-LAST-CLAIM
 10628                                    MSTR-CLAIM-NO
 10629         MOVE ER-0000            TO EMI-ERROR
 10630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10631     END-IF.
 10632
 10633     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10634       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10635         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10636         MOVE ER-7575            TO EMI-ERROR
 10637         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10638     END-IF.
 10639
 10640     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10641       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10642         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10643         MOVE ER-7582            TO EMI-ERROR
 10644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10645     END-IF.
 10646
 10647     IF WS-NO-INSURED-ADDRESS = 'Y'
 10648         MOVE ER-3548            TO EMI-ERROR
 10649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10650     END-IF.
 10651
 10652     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10653       (PI-ST-CAUSAL-STATE = 'L' AND
 10654              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10655       (PI-ST-CAUSAL-STATE = 'A' AND
 10656              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10657         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10658         MOVE ER-7577            TO EMI-ERROR
 10659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10660     END-IF.
 10661     if pi-company-id = 'DCC'
 10662        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10663                                 THRU 3994C-EXIT
 10664     end-if
 10665     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10666     MOVE CLMCARRI                   TO  PI-CARRIER.
 10667     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10668     MOVE SUFXI                      TO  PI-CERT-SFX.
 10669
 10670     IF WS-LETTER-SW = 'Y'
 10671         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 201
* EL130.cbl
 10672         IF W-1523-ERROR-CODE NOT = ZEROS
 10673             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10675         END-IF
 10676     END-IF.
 10677
 10678     perform 3998-update-cert-claim-trailer
 10679                                 thru 3998-exit
 10680     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10681     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10682     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10683     MOVE CLMCARRI               TO PI-LAST-CARR.
 10684
 10685     IF PRTOPTL GREATER THAN 0
 10686         MOVE PRTOPTI            TO PI-PRT-OPT
 10687     END-IF.
 10688     IF ALTPRTL GREATER THAN 0
 10689         MOVE ALTPRTI            TO PI-ALT-PRT
 10690     END-IF.
 10691
 10692     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10693         MOVE LOW-VALUES         TO EL130AI
 10694         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10695         MOVE AL-SANON           TO CERTNOA
 10696         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10697         MOVE AL-SANON           TO SUFXA
 10698         MOVE PI-LAST-CARR       TO CLMCARRO
 10699         MOVE AL-UANON           TO CLMCARRA
 10700         MOVE PI-LAST-CLAIM      TO CLMNOO
 10701         MOVE AL-UANON           TO CLMNOA
 10702         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10703         MOVE AL-UANON           TO CLMTYPEA
 10704     ELSE
 10705         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10706         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10707     END-IF.
 10708
 10709     IF PI-PRT-OPT = 'N' OR 'L'
 10710         MOVE PI-PRT-OPT         TO PRTOPTO
 10711         MOVE 1                  TO PRTOPTL
 10712     END-IF.
 10713
 10714     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10715         MOVE PI-ALT-PRT         TO ALTPRTO
 10716         MOVE 4                  TO ALTPRTL
 10717     END-IF.
 10718
 10719     IF PRTOPTL GREATER THAN 0
 10720         IF PRTOPTI = 'L'
 10721             GO TO 0400-CREATE-ELACTQ
 10722         ELSE
 10723             GO TO 0480-PRINT-NOW
 10724         END-IF
 10725     END-IF.
 10726     move 'S'                    to mainti
 10727     PERFORM 0500-CREATE-TEMP-STORAGE
 10728                                 THRU 0599-EXIT
 10729     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 202
* EL130.cbl
 10730         GO TO 8100-SEND-INITIAL-MAP
 10731     ELSE
 10732         MOVE LOW-VALUES         TO MAINTO
 10733         MOVE -1                 TO MAINTL
 10734         GO TO 8200-SEND-DATAONLY
 10735     END-IF.
 10736
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 203
* EL130.cbl
 10738 3993-MODIFY-SCREEN-ATTRB.
 10739
 10740     IF CERTMTL GREATER ZERO
 10741         MOVE AL-UANON           TO CERTMTA
 10742     END-IF.
 10743
 10744     IF EFFDTL GREATER ZERO
 10745         MOVE AL-UANON           TO EFFDTA
 10746     END-IF.
 10747
 10748     IF ACCOUNTL GREATER ZERO
 10749         MOVE AL-UANON           TO ACCOUNTA
 10750     END-IF.
 10751
 10752     IF STATEL GREATER ZERO
 10753         MOVE AL-UANON           TO STATEA
 10754     END-IF.
 10755
 10756     IF CRTCARRL GREATER ZERO
 10757         MOVE AL-UANON           TO CRTCARRA
 10758     END-IF.
 10759
 10760     IF GROUPL GREATER ZERO
 10761         MOVE AL-UANON           TO GROUPA
 10762     END-IF.
 10763
 10764     IF CRTLNMEL GREATER ZERO
 10765         MOVE AL-UANON           TO CRTLNMEA
 10766     END-IF.
 10767
 10768     IF CRTFNMEL GREATER ZERO
 10769         MOVE AL-UANON           TO CRTFNMEA
 10770     END-IF.
 10771
 10772     IF CRTINITL GREATER ZERO
 10773         MOVE AL-UANON           TO CRTINITA
 10774     END-IF.
 10775
 10776     IF ISSAGEL GREATER ZERO
 10777         MOVE AL-UNNON           TO ISSAGEA
 10778     END-IF.
 10779
 10780     IF JNTLNMEL GREATER ZERO
 10781         MOVE AL-UANON           TO JNTLNMEA
 10782     END-IF.
 10783
 10784     IF JNTFNMEL GREATER ZERO
 10785         MOVE AL-UANON           TO JNTFNMEA
 10786     END-IF.
 10787
 10788     IF JNTINITL GREATER ZERO
 10789         MOVE AL-UANON           TO JNTINITA
 10790     END-IF.
 10791
 10792     IF JNTAGEL GREATER ZERO
 10793         MOVE AL-UNNON           TO JNTAGEA
 10794     END-IF.
 10795
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 204
* EL130.cbl
 10796     IF CRTSSNL GREATER ZERO
 10797         MOVE AL-UANON           TO CRTSSNA
 10798     END-IF.
 10799
 10800     IF ACVDSCRL GREATER ZERO
 10801         MOVE AL-SANON           TO ACVDSCRA
 10802     END-IF.
 10803
 10804     IF ACVKINDL GREATER ZERO
 10805         MOVE AL-SANON           TO ACVKINDA
 10806     END-IF.
 10807
 10808     IF ACVCDL GREATER ZERO
 10809         MOVE AL-UANON           TO ACVCDA
 10810     END-IF.
 10811
 10812     IF ACVOTRML GREATER ZERO
 10813         MOVE AL-UNNON           TO ACVOTRMA
 10814     END-IF.
 10815
 10816     IF ACVRTRML GREATER ZERO
 10817         MOVE AL-UNNON           TO ACVRTRMA
 10818     END-IF.
 10819
 10820     IF ACVRATEL GREATER ZERO
 10821         MOVE AL-UNNON           TO ACVRATEA
 10822     END-IF.
 10823
 10824     IF ACVBENEL GREATER ZERO
 10825         MOVE AL-UNNON           TO ACVBENEA
 10826     END-IF.
 10827
 10828     IF ACVFORML GREATER ZERO
 10829         MOVE AL-UANON           TO ACVFORMA
 10830     END-IF.
 10831
 10832     IF ACVCNDTL GREATER ZERO
 10833         MOVE AL-UANON           TO ACVCNDTA
 10834     END-IF.
 10835
 10836     IF ACVEXITL GREATER ZERO
 10837         MOVE AL-UANON           TO ACVEXITA
 10838     END-IF.
 10839
 10840     IF ACVSTATL GREATER ZERO
 10841         MOVE AL-UANON           TO ACVSTATA
 10842     END-IF.
 10843
 10844     IF LCVDSCRL GREATER ZERO
 10845         MOVE AL-SANON           TO LCVDSCRA
 10846     END-IF.
 10847
 10848     IF LCVKINDL GREATER ZERO
 10849         MOVE AL-SANON           TO LCVKINDA
 10850     END-IF.
 10851
 10852     IF LCVCDL GREATER ZERO
 10853         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 205
* EL130.cbl
 10854     END-IF.
 10855
 10856     IF LCVOTRML GREATER ZERO
 10857         MOVE AL-UNNON           TO LCVOTRMA
 10858     END-IF.
 10859
 10860     IF LCVRTRML GREATER ZERO
 10861         MOVE AL-UNNON           TO LCVRTRMA
 10862     END-IF.
 10863
 10864     IF LCVRATEL GREATER ZERO
 10865         MOVE AL-UNNON           TO LCVRATEA
 10866     END-IF.
 10867
 10868     IF LCVBENEL GREATER ZERO
 10869         MOVE AL-UNNON           TO LCVBENEA
 10870     END-IF.
 10871
 10872     IF LCVFORML GREATER ZERO
 10873         MOVE AL-UANON           TO LCVFORMA
 10874     END-IF.
 10875
 10876     IF LCVCNDTL GREATER ZERO
 10877         MOVE AL-UANON           TO LCVCNDTA
 10878     END-IF.
 10879
 10880     IF LCVEXITL GREATER ZERO
 10881         MOVE AL-UANON           TO LCVEXITA
 10882     END-IF.
 10883
 10884     IF LCVSTATL GREATER ZERO
 10885         MOVE AL-UANON           TO LCVSTATA
 10886     END-IF.
 10887
 10888     IF MEMCAPL GREATER ZERO
 10889         MOVE AL-UANON           TO MEMCAPA
 10890     END-IF.
 10891
 10892     IF APRL GREATER ZERO
 10893         MOVE AL-UNNON           TO APRA
 10894     END-IF.
 10895
 10896     IF PMTFREQL GREATER ZERO
 10897         MOVE AL-UNNON           TO PMTFREQA
 10898     END-IF.
 10899
 10900     IF INDGRPL GREATER ZERO
 10901         MOVE AL-UANON           TO INDGRPA
 10902     END-IF.
 10903
 10904     IF PREMTYPL GREATER ZERO
 10905         MOVE AL-UANON           TO PREMTYPA
 10906     END-IF.
 10907
 10908     IF REINCDL GREATER ZERO
 10909         MOVE AL-UANON           TO REINCDA
 10910     END-IF.
 10911
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 206
* EL130.cbl
 10912     IF ADDONDTL GREATER ZERO
 10913         MOVE AL-UANON           TO ADDONDTA
 10914     END-IF.
 10915
 10916     IF MEMBERL GREATER ZERO
 10917         MOVE AL-UANON           TO MEMBERA
 10918     END-IF.
 10919
 10920     IF BCERT1L GREATER ZERO
 10921         MOVE AL-SANON           TO BCERT1A
 10922                                    BSUFX1A
 10923     END-IF.
 10924
 10925     IF BCERT2L GREATER ZERO
 10926         MOVE AL-SANON           TO BCERT2A
 10927                                    BSUFX2A
 10928     END-IF.
 10929
 10930     IF BCERT3L GREATER ZERO
 10931         MOVE AL-SANON           TO BCERT3A
 10932                                    BSUFX3A
 10933     END-IF.
 10934
 10935     IF BCERT4L GREATER ZERO
 10936         MOVE AL-SANON           TO BCERT4A
 10937                                    BSUFX4A
 10938     END-IF.
 10939
 10940     IF BCERT5L GREATER ZERO
 10941         MOVE AL-SANON           TO BCERT5A
 10942                                    BSUFX5A
 10943     END-IF.
 10944
 10945 3993-MODIFY-CLAIM-ATTRB.
 10946
 10947     IF PCERTNOL GREATER ZERO
 10948         MOVE AL-UANON           TO PCERTNOA
 10949     END-IF.
 10950
 10951     IF PSUFXL GREATER ZERO
 10952         MOVE AL-UANON           TO PSUFXA
 10953     END-IF.
 10954
 10955     IF LSTNMEL GREATER ZERO
 10956         MOVE AL-UANON           TO LSTNMEA
 10957     END-IF.
 10958
 10959     IF FSTNMEL GREATER ZERO
 10960         MOVE AL-UANON           TO FSTNMEA
 10961     END-IF.
 10962
 10963     IF INITL GREATER ZERO
 10964         MOVE AL-UANON           TO INITA
 10965     END-IF.
 10966
 10967     IF SEXL GREATER ZERO
 10968         MOVE AL-UANON           TO SEXA
 10969     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 207
* EL130.cbl
 10970
 10971     IF BIRTHDTL GREATER ZERO
 10972         MOVE AL-UANON           TO BIRTHDTA
 10973     END-IF.
 10974
 10975     IF SSNL GREATER ZERO
 10976         MOVE AL-UANON           TO SSNA
 10977     END-IF.
 10978
 10979     IF INCURL GREATER ZERO
 10980         MOVE AL-UANON           TO INCURA
 10981     END-IF.
 10982
 10983     IF REPORTL GREATER ZERO
 10984         MOVE AL-UANON           TO REPORTA
 10985     END-IF.
 10986
 10987*    IF ESTENDL GREATER ZERO
 10988*        MOVE AL-UANON           TO ESTENDA
 10989*    END-IF.
 10990
 10991     IF DIAGL GREATER ZERO
 10992         MOVE AL-UANON           TO DIAGA
 10993     END-IF.
 10994*
 10995     IF ICD1L GREATER ZERO
 10996         MOVE AL-UANON           TO ICD1A
 10997     END-IF.
 10998
 10999     IF ICD2L GREATER ZERO
 11000         MOVE AL-UANON           TO ICD2A
 11001     END-IF.
 11002
 11003*    IF CAUSEL GREATER ZERO
 11004*        MOVE AL-UANON           TO CAUSEA
 11005*    END-IF.
 11006
 11007     IF MANRSVL GREATER ZERO
 11008         MOVE AL-UNNON           TO MANRSVA
 11009     END-IF.
 11010
 11011     IF RELCLML GREATER ZERO
 11012         MOVE AL-UANON           TO RELCLMA
 11013     END-IF.
 11014
 11015     IF LOANNOL GREATER ZERO
 11016         MOVE AL-UANON           TO LOANNOA
 11017     END-IF.
 11018
 11019     IF LOANBALL GREATER ZERO
 11020         MOVE AL-UNNON           TO LOANBALA
 11021     END-IF.
 11022
 11023     IF PROCCDL GREATER ZERO
 11024         MOVE AL-UANON           TO PROCCDA
 11025     END-IF.
 11026
 11027     IF BENECDL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 208
* EL130.cbl
 11028         MOVE AL-UANON           TO  BENECDA
 11029     END-IF.
 11030
 11031     IF PRICDL GREATER ZERO
 11032         MOVE AL-UANON           TO PRICDA
 11033     END-IF.
 11034
 11035     IF SUPVL GREATER ZERO
 11036         MOVE AL-UANON           TO SUPVA
 11037     END-IF.
 11038
 11039     IF FILETOL GREATER ZERO
 11040         MOVE AL-UANON           TO FILETOA
 11041     END-IF.
 11042
 11043
 11044 3993-MODIFY-CLAIM-KEY-ATTRB.
 11045
 11046     IF CLMNOL GREATER ZERO
 11047         MOVE AL-UANON           TO CLMNOA
 11048     END-IF.
 11049
 11050     IF CLMCARRL GREATER ZERO
 11051         MOVE AL-UANON           TO CLMCARRA
 11052     END-IF.
 11053
 11054     IF CLMTYPEL GREATER ZERO
 11055         MOVE AL-UANON           TO CLMTYPEA
 11056     END-IF.
 11057
 11058     IF CERTNOL GREATER ZERO
 11059         MOVE AL-SANON           TO CERTNOA
 11060     END-IF.
 11061
 11062     IF SUFXL GREATER ZERO
 11063         MOVE AL-SANON           TO SUFXA
 11064     END-IF.
 11065
 11066 3993-EXIT.
 11067     EXIT.
 11068
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 209
* EL130.cbl
 11070 3994-BUILD-NINETY-THREE-TRAILER.
 11071
 11072     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11073     MOVE 'AT'                   TO AT-RECORD-ID.
 11074
 11075     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11076     MOVE CLMCARRI               TO AT-CARRIER.
 11077
 11078     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11079     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11080     MOVE +93                    TO AT-SEQUENCE-NO.
 11081     MOVE '6'                    TO AT-TRAILER-TYPE.
 11082     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11083
 11084     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11085         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11086     ELSE
 11087         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11088     END-IF
 11089
 11090     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11091                                    AT-GEN-INFO-LAST-MAINT-DT.
 11092
 11093     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11094                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11095     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11096
 11097
 11098
 11099* EXEC CICS WRITE
 11100*        DATASET   (ELTRLR-DSID)
 11101*        FROM      (ACTIVITY-TRAILERS)
 11102*        RIDFLD    (AT-CONTROL-PRIMARY)
 11103*    END-EXEC.
 11104     MOVE LENGTH OF
 11105      ACTIVITY-TRAILERS
 11106       TO DFHEIV11
 11107*    MOVE '&$ L                  ''   #00010327' TO DFHEIV0
 11108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11110     MOVE X'2020233030303130333237' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0,
 11112           ELTRLR-DSID,
 11113           ACTIVITY-TRAILERS,
 11114           DFHEIV11,
 11115           AT-CONTROL-PRIMARY,
 11116           DFHEIV99,
 11117           DFHEIV99
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11119
 11120
 11121 3994-EXIT.
 11122     EXIT.
 11123
 11124 3994B-BUILD-NINETY-FOUR-TRAILER.
 11125
 11126     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11127     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 210
* EL130.cbl
 11128
 11129     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11130     MOVE CLMCARRI               TO AT-CARRIER.
 11131
 11132     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11133     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11134     MOVE +94                    TO AT-SEQUENCE-NO.
 11135     MOVE '6'                    TO AT-TRAILER-TYPE.
 11136     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11137
 11138     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11139
 11140     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11141                                    AT-GEN-INFO-LAST-MAINT-DT.
 11142
 11143     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11144                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11145     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11146
 11147
 11148
 11149* EXEC CICS WRITE
 11150*        DATASET   (ELTRLR-DSID)
 11151*        FROM      (ACTIVITY-TRAILERS)
 11152*        RIDFLD    (AT-CONTROL-PRIMARY)
 11153*    END-EXEC.
 11154     MOVE LENGTH OF
 11155      ACTIVITY-TRAILERS
 11156       TO DFHEIV11
 11157*    MOVE '&$ L                  ''   #00010360' TO DFHEIV0
 11158     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11159     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11160     MOVE X'2020233030303130333630' TO DFHEIV0(25:11)
 11161     CALL 'kxdfhei1' USING DFHEIV0,
 11162           ELTRLR-DSID,
 11163           ACTIVITY-TRAILERS,
 11164           DFHEIV11,
 11165           AT-CONTROL-PRIMARY,
 11166           DFHEIV99,
 11167           DFHEIV99
 11168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11169
 11170
 11171 3994B-EXIT.
 11172     EXIT.
 11173 3994C-BUILD-NINETY-FIVE-TRAILER.
 11174
 11175     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11176     MOVE 'AT'                   TO AT-RECORD-ID
 11177
 11178     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11179     MOVE CLMCARRI               TO AT-CARRIER
 11180
 11181     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11182     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11183     MOVE +95                    TO AT-SEQUENCE-NO
 11184     MOVE '6'                    TO AT-TRAILER-TYPE
 11185     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 211
* EL130.cbl
 11186
 11187     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11188                                    AT-GEN-INFO-LAST-MAINT-DT
 11189
 11190     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11191                                    AT-GEN-INFO-LAST-UPDATED-BY
 11192     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11193
 11194     perform varying e1 from +1 by +1 until
 11195        ws-error-no (e1) = spaces
 11196        move ws-error-no (e1)    to at-note-error-no (e1)
 11197     end-perform
 11198
 11199     if at-info-line-1 not = spaces
 11200
 11201* EXEC CICS WRITE
 11202*          DATASET  (ELTRLR-DSID)
 11203*          FROM     (ACTIVITY-TRAILERS)
 11204*          RIDFLD   (AT-CONTROL-PRIMARY)
 11205*       END-EXEC
 11206     MOVE LENGTH OF
 11207      ACTIVITY-TRAILERS
 11208       TO DFHEIV11
 11209*    MOVE '&$ L                  ''   #00010395' TO DFHEIV0
 11210     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11212     MOVE X'2020233030303130333935' TO DFHEIV0(25:11)
 11213     CALL 'kxdfhei1' USING DFHEIV0,
 11214           ELTRLR-DSID,
 11215           ACTIVITY-TRAILERS,
 11216           DFHEIV11,
 11217           AT-CONTROL-PRIMARY,
 11218           DFHEIV99,
 11219           DFHEIV99
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11221     end-if
 11222
 11223     .
 11224 3994C-EXIT.
 11225     EXIT.
 11226 3995-BUILD-CLAIM-RECORD.
 11227     IF PROCCDL GREATER ZERO
 11228         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11229     ELSE
 11230         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11231     END-IF.
 11232
 11233     IF FSTNMEL GREATER ZERO
 11234         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11235     END-IF.
 11236
 11237     IF INITL GREATER ZERO
 11238         MOVE INITI              TO CL-INSURED-MID-INIT
 11239     END-IF.
 11240
 11241     IF BIRTHDTL GREATER ZERO
 11242         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11243     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 212
* EL130.cbl
 11244
 11245     IF SEXL GREATER ZERO
 11246         MOVE SEXI               TO CL-INSURED-SEX-CD
 11247     END-IF.
 11248
 11249     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11250
 11251*    IF CLMTYPEL GREATER ZERO
 11252     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11253*    END-IF.
 11254
 11255     IF PREMTYPL GREATER ZERO
 11256         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11257     END-IF.
 11258
 11259     IF INCURL GREATER ZERO
 11260         MOVE WS-INCUR           TO CL-INCURRED-DT
 11261     END-IF.
 11262
 11263     IF (PI-COMPANY-ID = 'DCC')
 11264        AND (ERPDEF-FOUND)
 11265        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11266*       MOVE WS-CRIT-PER-RECURRENT
 11267*                                TO CL-CRIT-PER-RECURRENT
 11268*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11269        if ws-crit-per-recurrent > 01
 11270           move zeros            to cl-benefit-period
 11271        end-if
 11272     ELSE
 11273        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11274           MOVE CM-LF-CRITICAL-PERIOD
 11275                                 TO CL-CRITICAL-PERIOD
 11276        ELSE
 11277           MOVE CM-AH-CRITICAL-PERIOD
 11278                                 TO CL-CRITICAL-PERIOD
 11279        END-IF
 11280     END-IF
 11281
 11282     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11283        COMPUTE DC-ELAPSED-MONTHS =
 11284           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11285        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11286        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11287        MOVE '6'                 TO DC-OPTION-CODE
 11288        PERFORM 9700-LINK-DATE-CONVERT
 11289                                 THRU 9700-EXIT
 11290        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11291     END-IF
 11292
 11293     if instypel > zero
 11294        move instypei            to cl-insured-type
 11295     end-if
 11296     IF REPORTL GREATER ZERO
 11297         MOVE WS-REPORT          TO CL-REPORTED-DT
 11298     END-IF.
 11299
 11300     IF EIBAID = DFHPF6
 11301         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 213
* EL130.cbl
 11302             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11303                 IF EMI-FORCABLE-CTR = +1
 11304                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11305                 END-IF
 11306         END-IF
 11307     END-IF.
 11308
 11309*    IF ESTENDL GREATER ZERO
 11310*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11311*    END-IF.
 11312
 11313     IF ADDONDTL GREATER ZERO
 11314         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11315     END-IF.
 11316
 11317*    IF CAUSEL GREATER ZERO
 11318*        MOVE CAUSEI             TO CL-CAUSE-CD
 11319*    END-IF.
 11320
 11321     IF SSNL GREATER ZERO
 11322         MOVE SSNI               TO CL-SOC-SEC-NO
 11323     ELSE
 11324         MOVE CERT-STATE         TO CL-SSN-STATE
 11325         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11326         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11327     END-IF.
 11328
 11329     IF PRICDL GREATER ZERO
 11330         MOVE PRICDI             TO CL-PRIORITY-CD
 11331     END-IF.
 11332
 11333     IF SUPVL GREATER ZERO
 11334         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11335     END-IF.
 11336
 11337     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11338     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11339     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11340
 11341     IF RELCLML GREATER ZERO
 11342         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11343     END-IF.
 11344
 11345     IF FILETOL GREATER ZERO
 11346         MOVE FILETOI            TO CL-FILE-LOCATION
 11347     END-IF.
 11348
 11349 3995-EXIT.
 11350      EXIT.
 11351 3996-read-cert-claim-trailer.
 11352
 11353     move cm-ah-benefit-amt      to ws-monthly-benefit
 11354     if (pi-dcc-max-amt < ws-monthly-benefit)
 11355        and (pi-dcc-max-amt not = zeros)
 11356        move pi-dcc-max-amt      to ws-monthly-benefit
 11357     end-if
 11358
 11359     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 214
* EL130.cbl
 11360     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11361     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11362     MOVE CM-STATE               TO CTRLR-STATE
 11363     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11364     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11365     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11366     MOVE 'B'                    TO CTRLR-REC-TYPE
 11367
 11368* EXEC CICS READ
 11369*       DATASET  (ELCRTT-DSID)
 11370*       set     (address of CERTIFICATE-TRAILERS)
 11371*       RIDFLD   (ELCRTT-KEY)
 11372*       RESP     (WS-RESPONSE)
 11373*    END-EXEC
 11374*    MOVE '&"S        E          (  N#00010546' TO DFHEIV0
 11375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11377     MOVE X'204E233030303130353436' TO DFHEIV0(25:11)
 11378     CALL 'kxdfhei1' USING DFHEIV0,
 11379           ELCRTT-DSID,
 11380           DFHEIV20,
 11381           DFHEIV99,
 11382           ELCRTT-KEY,
 11383           DFHEIV99,
 11384           DFHEIV99,
 11385           DFHEIV99
 11386     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11387         DFHEIV20
 11388     MOVE EIBRESP  TO WS-RESPONSE
 11389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11390***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11391***                                                            ***
 11392***  This may need some work here. I think I should accumulate ***
 11393***  all the claims with the same claim type?????????          ***
 11394***                                                            ***
 11395***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11396     IF WS-RESP-NORMAL
 11397        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11398        perform varying s1 from +1 by +1 until
 11399           (s1 > +24)
 11400           or (cs-claim-no (s1) = spaces)
 11401           if cs-claim-type (s1) = clmtypei
 11402              move er-1659       to ws-error-no (e1)
 11403              compute ws-tot-days-paid =
 11404                 ws-tot-days-paid + cs-days-paid (s1)
 11405              compute ws-tot-amt-paid =
 11406                 ws-tot-amt-paid + cs-total-paid (s1)
 11407           end-if
 11408        end-perform
 11409*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11410*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11411*           and (pi-dcc-max-benefits not = zeros)
 11412*           add +1                to e1
 11413*           MOVE ER-1660          TO EMI-ERROR
 11414*                                    ws-error-no (e1)
 11415*           PERFORM 9900-ERROR-FORMAT
 11416*                                 THRU 9900-EXIT
 11417*        end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 215
* EL130.cbl
 11418     end-if
 11419**       if instypei = 'P'
 11420**          move +1 to s1
 11421**       else
 11422**          MOVE +2 to s1
 11423**       end-if
 11424*
 11425*        move +1 to s1
 11426*        evaluate clmtypei
 11427*           when 'A'
 11428*              move +1 to s2
 11429*           when 'I'
 11430*              move +2 to s2
 11431*           when 'G'
 11432*              move +3 to s2
 11433*           when 'L'
 11434*              move +4 to s2
 11435*           when 'P'
 11436*              move +5 to s2
 11437*        end-evaluate
 11438*        if cs-claim-type (s1 s2) = clmtypei
 11439*           if cs-no-of-claims (s1 s2) > zeros
 11440*              move er-1659       to ws-error-no (e1)
 11441*           end-if
 11442*           compute WS-BENEFITS-PREV-PAID =
 11443*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11444*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11445*              and (pi-dcc-max-benefits not = zeros)
 11446*              add +1             to e1
 11447*              MOVE ER-1660       TO EMI-ERROR
 11448*                                    ws-error-no (e1)
 11449*              PERFORM 9900-ERROR-FORMAT
 11450*                                 THRU 9900-EXIT
 11451*           end-if
 11452*        end-if
 11453*     end-if
 11454
 11455     .
 11456 3996-exit.
 11457     exit.
 11458
 11459 3997-GET-ERPDEF.
 11460
 11461     if cm-clp-state = spaces or low-values or zeros
 11462        move cm-state            to cm-clp-state
 11463     end-if
 11464     MOVE SPACES                 TO WS-ERPDEF-SW
 11465     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11466                                    WS-CRIT-PER-RTW-MOS
 11467                                    WS-CRIT-PER-RECURRENT
 11468
 11469     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11470     MOVE CM-clp-state        TO ERPDEF-STATE
 11471     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11472     if (clmtypei = 'L' or 'P')
 11473        and (cm-lf-benefit-cd not = '00' and '  ' and 'DD')
 11474        move 'L'              to erpdef-ben-type
 11475        move cm-lf-benefit-cd to erpdef-ben-code
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 216
* EL130.cbl
 11476     ELSE
 11477        MOVE 'A'              to erpdef-ben-type
 11478        move cm-ah-benefit-cd to erpdef-ben-code
 11479     end-if
 11480*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11481*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11482     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11483     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11484
 11485
 11486* EXEC CICS STARTBR
 11487*        DATASET  ('ERPDEF')
 11488*        RIDFLD   (ERPDEF-KEY)
 11489*        GTEQ
 11490*        RESP     (WS-RESPONSE)
 11491*    END-EXEC
 11492     MOVE 'ERPDEF' TO DFHEIV1
 11493     MOVE 0
 11494       TO DFHEIV11
 11495*    MOVE '&,         G          &  N#00010647' TO DFHEIV0
 11496     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11498     MOVE X'204E233030303130363437' TO DFHEIV0(25:11)
 11499     CALL 'kxdfhei1' USING DFHEIV0,
 11500           DFHEIV1,
 11501           ERPDEF-KEY,
 11502           DFHEIV99,
 11503           DFHEIV11,
 11504           DFHEIV99
 11505     MOVE EIBRESP  TO WS-RESPONSE
 11506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11507
 11508     IF WS-RESP-NORMAL
 11509
 11510* EXEC CICS READNEXT
 11511*          DATASET  ('ERPDEF')
 11512*          INTO     (PRODUCT-MASTER)
 11513*          RIDFLD   (ERPDEF-KEY)
 11514*          RESP     (WS-RESPONSE)
 11515*       END-EXEC
 11516     MOVE LENGTH OF
 11517      PRODUCT-MASTER
 11518       TO DFHEIV12
 11519     MOVE 'ERPDEF' TO DFHEIV1
 11520     MOVE 0
 11521       TO DFHEIV11
 11522*    MOVE '&.IL                  )  N#00010655' TO DFHEIV0
 11523     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11524     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11525     MOVE X'204E233030303130363535' TO DFHEIV0(25:11)
 11526     CALL 'kxdfhei1' USING DFHEIV0,
 11527           DFHEIV1,
 11528           PRODUCT-MASTER,
 11529           DFHEIV12,
 11530           ERPDEF-KEY,
 11531           DFHEIV99,
 11532           DFHEIV11,
 11533           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 217
* EL130.cbl
 11534           DFHEIV99
 11535     MOVE EIBRESP  TO WS-RESPONSE
 11536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11537
 11538        IF WS-RESP-NORMAL
 11539           IF (ERPDEF-KEY-SAVE (1:16) =
 11540              PD-CONTROL-PRIMARY (1:16))
 11541              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11542
 11543              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11544                 (A1 > +8)
 11545                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11546              END-PERFORM
 11547              IF A1 < +9
 11548                 SET ERPDEF-FOUND TO TRUE
 11549                 move pd-max-amt (a1)
 11550                              to pi-dcc-max-amt
 11551                 MOVE PD-CRIT-PERIOD (A1)
 11552                              TO WS-MAX-BENEFITS
 11553                                 pi-dcc-max-benefits
 11554                 if pd-rec-crit-period (a1) not numeric
 11555                    move 01      to pd-rec-crit-period (a1)
 11556                 end-if
 11557                 MOVE PD-REC-CRIT-PERIOD (A1)
 11558                              TO WS-CRIT-PER-RECURRENT
 11559                 IF PD-RTW-MOS (A1) NUMERIC
 11560                    MOVE PD-RTW-MOS (A1)
 11561                              TO WS-CRIT-PER-RTW-MOS
 11562                 ELSE
 11563                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11564                 END-IF
 11565                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11566                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11567                                 TO WS-EXCL-PERIOD
 11568                 END-IF
 11569                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 11570                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11571                                 TO WS-COV-ENDS
 11572                 END-IF
 11573                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11574                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11575                                 TO WS-ACC-PERIOD
 11576                 END-IF
 11577              else
 11578                 move er-1673    to emi-error
 11579                 PERFORM 9900-ERROR-FORMAT
 11580                                 THRU 9900-EXIT
 11581              END-IF
 11582           else
 11583              MOVE -1            TO MAINTL
 11584              move er-1671       to emi-error
 11585              PERFORM 9900-ERROR-FORMAT
 11586                                 THRU 9900-EXIT
 11587           END-IF
 11588        END-IF
 11589     END-IF
 11590
 11591     .
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 218
* EL130.cbl
 11592 3997-EXIT.
 11593     EXIT.
 11594
 11595 3998-update-cert-claim-trailer.
 11596
 11597
 11598* EXEC CICS GETMAIN
 11599*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11600*       LENGTH   (ELCRTT-LENGTH)
 11601*       INITIMG  (GETMAIN-SPACE)
 11602*    END-EXEC
 11603*    MOVE ',"IL                  $   #00010721' TO DFHEIV0
 11604     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11605     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11606     MOVE X'2020233030303130373231' TO DFHEIV0(25:11)
 11607     CALL 'kxdfhei1' USING DFHEIV0,
 11608           DFHEIV20,
 11609           ELCRTT-LENGTH,
 11610           GETMAIN-SPACE
 11611     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11612         DFHEIV20
 11613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11614
 11615     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11616     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11617     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11618     MOVE CM-STATE         TO CTRLR-STATE
 11619     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11620     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11621     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11622     MOVE 'B'              TO CTRLR-REC-TYPE
 11623
 11624* EXEC CICS READ
 11625*       UPDATE
 11626*       DATASET  (ELCRTT-DSID)
 11627*       into     (CERTIFICATE-TRAILERS)
 11628*       RIDFLD   (ELCRTT-KEY)
 11629*       RESP     (WS-RESPONSE)
 11630*    END-EXEC
 11631     MOVE LENGTH OF
 11632      CERTIFICATE-TRAILERS
 11633       TO DFHEIV11
 11634*    MOVE '&"IL       EU         (  N#00010735' TO DFHEIV0
 11635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11637     MOVE X'204E233030303130373335' TO DFHEIV0(25:11)
 11638     CALL 'kxdfhei1' USING DFHEIV0,
 11639           ELCRTT-DSID,
 11640           CERTIFICATE-TRAILERS,
 11641           DFHEIV11,
 11642           ELCRTT-KEY,
 11643           DFHEIV99,
 11644           DFHEIV99,
 11645           DFHEIV99
 11646     MOVE EIBRESP  TO WS-RESPONSE
 11647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11648     IF WS-RESP-NORMAL
 11649        perform varying s1 from +1 by +1 until
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 219
* EL130.cbl
 11650           (s1 > +24)
 11651           or (cs-claim-no (s1) = spaces)
 11652        end-perform
 11653        if s1 < +25
 11654           perform 3999-upd-crt-trlr thru 3999-exit
 11655
 11656* EXEC CICS REWRITE
 11657*             DATASET  (ELCRTT-DSID)
 11658*             from     (CERTIFICATE-TRAILERS)
 11659*             RESP     (WS-RESPONSE)
 11660*          END-EXEC
 11661     MOVE LENGTH OF
 11662      CERTIFICATE-TRAILERS
 11663       TO DFHEIV11
 11664*    MOVE '&& L                  %  N#00010749' TO DFHEIV0
 11665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11667     MOVE X'204E233030303130373439' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           ELCRTT-DSID,
 11670           CERTIFICATE-TRAILERS,
 11671           DFHEIV11,
 11672           DFHEIV99
 11673     MOVE EIBRESP  TO WS-RESPONSE
 11674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11675        end-if
 11676     else
 11677        if ws-resp-notfnd
 11678           move 'CS'             to certificate-trailers
 11679           move cm-control-primary to cs-control-primary
 11680           move 'B'              to cs-trailer-type
 11681           perform varying s1 from +1 by +1 until s1 > +24
 11682              move zeros         to cs-days-paid (s1)
 11683                                    cs-total-paid (s1)
 11684                                    cs-benefit-period (s1)
 11685                                    cs-remaining-bens (s1)
 11686           end-perform
 11687           move +1               to s1
 11688           perform 3999-upd-crt-trlr
 11689                                 thru 3999-exit
 11690
 11691* EXEC CICS WRITE
 11692*             DATASET  (ELCRTT-DSID)
 11693*             from     (CERTIFICATE-TRAILERS)
 11694*             RIDFLD   (cs-control-primary)
 11695*             RESP     (WS-RESPONSE)
 11696*          END-EXEC
 11697     MOVE LENGTH OF
 11698      CERTIFICATE-TRAILERS
 11699       TO DFHEIV11
 11700*    MOVE '&$ L                  ''  N#00010769' TO DFHEIV0
 11701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11703     MOVE X'204E233030303130373639' TO DFHEIV0(25:11)
 11704     CALL 'kxdfhei1' USING DFHEIV0,
 11705           ELCRTT-DSID,
 11706           CERTIFICATE-TRAILERS,
 11707           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 220
* EL130.cbl
 11708           cs-control-primary,
 11709           DFHEIV99,
 11710           DFHEIV99
 11711     MOVE EIBRESP  TO WS-RESPONSE
 11712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11713        end-if
 11714     END-IF
 11715
 11716     .
 11717 3998-exit.
 11718     exit.
 11719
 11720 3999-upd-crt-trlr.
 11721     move clmnoi                 to cs-claim-no       (s1)
 11722     move clmtypei               to cs-claim-type     (s1)
 11723     move instypei               to cs-insured-type   (s1)
 11724     move cl-benefit-period      to cs-benefit-period (s1)
 11725*    move cl-critical-period     to cs-remaining-bens (s1)
 11726     move zeros                  to cs-remaining-bens (s1)
 11727     .
 11728 3999-exit.
 11729     exit.
 11730 4000-CALCULATE-CERT-TERM.
 11731
 11732     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11733
 11734     MOVE N                      TO WS-TERM.
 11735
 11736     IF WS-TERM GREATER 120
 11737         MOVE 120                TO WS-TERM
 11738     END-IF.
 11739
 11740 4000-CALC-TERM-EXIT.
 11741      EXIT.
 11742
 11743 4100-CALC-GROSS-TERM.
 11744     MOVE HOLD-LOAN-BAL           TO L.
 11745     MOVE WS-ACVBENE              TO M.
 11746     COMPUTE N = L / M.
 11747     IF N LESS 1
 11748         MOVE 1  TO N
 11749     END-IF.
 11750
 11751     IF LCVCDL GREATER ZERO
 11752         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11753     ELSE
 11754         MOVE ZEROS               TO WS-LF-RATE
 11755     END-IF.
 11756
 11757     IF ACVCDL GREATER ZERO
 11758         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11759     ELSE
 11760         MOVE ZEROS               TO WS-AH-RATE
 11761     END-IF.
 11762
 11763     COMPUTE I = WS-APR / +1200.
 11764
 11765 4105-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 221
* EL130.cbl
 11766     IF N GREATER 240
 11767         GO TO 4200-EXIT
 11768     END-IF.
 11769
 11770     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11771
 11772     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11773         ADD 1 TO N
 11774         GO TO 4105-LOOP
 11775     END-IF.
 11776
 11777 4200-EXIT.
 11778      EXIT.
 11779
 11780 4210-CALC-LEFT-RIGHTONE.
 11781      MOVE L         TO LEFT-TOT-1.
 11782      SUBTRACT 1 FROM N.
 11783      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11784      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11785      ADD 1 TO N.
 11786
 11787 4211-CALC-TERM1.
 11788      MOVE N         TO TERM1.
 11789      MULTIPLY M BY TERM1.
 11790
 11791 4212-LOOP.
 11792      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11793      ADD 1 TO A-N.
 11794      MULTIPLY A-N BY TERM1.
 11795      SUBTRACT 1 FROM A-N.
 11796      ADD TERM1 TO LEFT-TOT-1.
 11797
 11798 4213-CALC-TERM2.
 11799      MOVE M         TO TERM2.
 11800      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 11801      MULTIPLY IA-N BY TERM2.
 11802      SUBTRACT TERM2 FROM LEFT-TOT-1.
 11803
 11804 4215-CALC-RIGHTONE.
 11805      MOVE M         TO RIGHT-TOT-1.
 11806      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11807      MULTIPLY A-N BY RIGHT-TOT-1.
 11808
 11809 4220-EXIT.
 11810      EXIT.
 11811
 11812 4300-CALC-A-N.
 11813     IF N LESS 1
 11814         MOVE 0     TO A-N
 11815         GO TO 4300-EXIT
 11816     END-IF.
 11817
 11818     IF I = 0
 11819         MOVE .00001 TO I
 11820     END-IF.
 11821
 11822     ADD 1 TO I.
 11823     DIVIDE I INTO 1 GIVING V.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 222
* EL130.cbl
 11824     SUBTRACT 1 FROM I.
 11825     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11826     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11827     DIVIDE I INTO TERM3 GIVING A-N.
 11828
 11829 4300-EXIT.
 11830      EXIT.
 11831
 11832 4350-CALC-IA-N.
 11833     IF N LESS 1
 11834         MOVE 0      TO IA-N
 11835         GO TO 4400-EXIT
 11836     END-IF.
 11837
 11838     ADD 1 TO N.
 11839     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11840     SUBTRACT 1 FROM N.
 11841     MULTIPLY N BY V-EX-N GIVING TERM3.
 11842     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11843     SUBTRACT V FROM 1 GIVING TERM4.
 11844     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11845
 11846 4400-EXIT.
 11847      EXIT.
 11848
 11849 4450-CALC-V-EX-N.
 11850     IF N LESS 1
 11851         MOVE 1    TO V-EX-N
 11852         GO TO 4490-EXIT
 11853     END-IF.
 11854
 11855     MOVE N        TO NV-STORE.
 11856
 11857     IF V-EX-ONETIME = 1  OR
 11858        V NOT = V-EXPONENT (1)
 11859          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11860     END-IF.
 11861
 11862 4460-LOOP.
 11863     IF N GREATER 248
 11864         MOVE 248 TO N
 11865     END-IF.
 11866
 11867     IF N = 1
 11868         MOVE V               TO V-EX-N
 11869     ELSE
 11870         MOVE V-EXPONENT (N)  TO V-EX-N
 11871     END-IF.
 11872
 11873     GO TO 4490-EXIT.
 11874
 11875 4470-BUILD-V-EX-TABLE.
 11876     MOVE 2      TO N.
 11877     MOVE V      TO V-EXPONENT (1)
 11878                    V-EX-N.
 11879
 11880 4471-LOOP.
 11881     MULTIPLY V BY V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 223
* EL130.cbl
 11882     MOVE V-EX-N   TO V-EXPONENT (N).
 11883
 11884     ADD 1 TO N.
 11885     IF N LESS 248
 11886         GO TO 4471-LOOP
 11887     END-IF.
 11888
 11889     MOVE NV-STORE     TO N.
 11890     MOVE ZERO         TO V-EX-ONETIME.
 11891
 11892 4480-EXIT.
 11893      EXIT.
 11894
 11895 4490-EXIT.
 11896      EXIT.
 11897
 11898 4500-CALC-NET-TERM.
 11899     MOVE HOLD-LOAN-BAL           TO L.
 11900     MOVE WS-ACVBENE              TO M.
 11901     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11902
 11903     IF WS-REMAIN GREATER ZERO
 11904         ADD 1 TO N
 11905     END-IF.
 11906
 11907     IF N = 0
 11908         MOVE 1 TO N
 11909     END-IF.
 11910
 11911 4700-EXIT.
 11912      EXIT.
 11913
 11914 4999-CALC-TERM-EXIT.
 11915     EXIT.
 11916
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 224
* EL130.cbl
 11918 5000-INCURRED-CHANGE.
 11919     IF NOT MODIFY-CAP
 11920         MOVE ER-0070            TO EMI-ERROR
 11921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11922         MOVE -1                 TO MAINTL
 11923         GO TO 8200-SEND-DATAONLY
 11924     END-IF.
 11925
 11926     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11927        CLMCARRI     NOT = PI-LAST-CARR        OR
 11928        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11929        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11930        PI-INCURR-SW NOT = 'Y'
 11931          GO TO 1000-SHOW-CLAIM
 11932     END-IF.
 11933
 11934     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11935     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11936     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11937
 11938     IF EMI-NO-ERRORS
 11939         GO TO 5000-TRY-TO-BUILD
 11940     END-IF.
 11941
 11942     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11943        MOVE ER-0433             TO EMI-ERROR
 11944        MOVE -1                  TO MAINTL
 11945        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11946        GO TO 8200-SEND-DATAONLY
 11947     END-IF.
 11948
 11949     IF EIBAID = DFHPF6
 11950         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11951            MOVE ER-0434         TO EMI-ERROR
 11952            MOVE -1              TO MAINTL
 11953            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11954            GO TO 8200-SEND-DATAONLY
 11955         ELSE
 11956            MOVE +1              TO INCURL
 11957            GO TO 5000-TRY-TO-BUILD
 11958         END-IF
 11959     END-IF.
 11960
 11961     GO TO 8200-SEND-DATAONLY.
 11962
 11963 5000-TRY-TO-BUILD.
 11964
 11965     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11966
 11967     MOVE CLMCARRI               TO MSTR-CARRIER.
 11968
 11969     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11970     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11971     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11972
 11973     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11974
 11975     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 225
* EL130.cbl
 11976         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11977     END-IF.
 11978
 11979     IF CL-PURGED-DT NOT = LOW-VALUES
 11980
 11981
 11982* EXEC CICS UNLOCK
 11983*            DATASET   (ELMSTR-DSID)
 11984*        END-EXEC
 11985*    MOVE '&*                    #   #00011043' TO DFHEIV0
 11986     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11987     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11988     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 11989     CALL 'kxdfhei1' USING DFHEIV0,
 11990           ELMSTR-DSID,
 11991           DFHEIV99
 11992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11993         MOVE ER-7691            TO EMI-ERROR
 11994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11995         MOVE -1                 TO MAINTL
 11996         GO TO 8200-SEND-DATAONLY
 11997     END-IF.
 11998
 11999     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12000
 12001
 12002* EXEC CICS UNLOCK
 12003*            DATASET   (ELMSTR-DSID)
 12004*       END-EXEC
 12005*    MOVE '&*                    #   #00011054' TO DFHEIV0
 12006     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12007     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12008     MOVE X'2020233030303131303534' TO DFHEIV0(25:11)
 12009     CALL 'kxdfhei1' USING DFHEIV0,
 12010           ELMSTR-DSID,
 12011           DFHEIV99
 12012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12013         MOVE ER-0523             TO EMI-ERROR
 12014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12015         MOVE -1                  TO MAINTL
 12016         GO TO 8200-SEND-DATAONLY
 12017     END-IF.
 12018
 12019     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12020
 12021     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12022     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12023     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12024     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12025     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12026
 12027     IF MANRSVL GREATER ZERO
 12028        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12029                                    AT-CURRENT-MANUAL-RESERVE
 12030     END-IF.
 12031     MOVE 1                      TO SUB.
 12032
 12033 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 226
* EL130.cbl
 12034     IF SUB = 1
 12035        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12036        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12037        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12038     ELSE
 12039        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12040        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12041                                    AT-OPEN-CLOSE-REASON (SUB)
 12042     END-IF.
 12043
 12044     IF SUB NOT = 6
 12045        ADD 1                    TO SUB
 12046        GO TO 5010-LOOP
 12047     END-IF.
 12048
 12049 5020-UPDATE.
 12050
 12051     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12052
 12053     IF DIAGL = ZERO
 12054       AND ICD1L = ZERO
 12055       AND ICD2L = ZERO
 12056         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12057         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12058         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12059         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12060         GO TO 5025-BYPASS-UPDATE
 12061     END-IF.
 12062
 12063     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12064
 12065     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12066     IF DIAGL NOT = ZERO
 12067         MOVE DIAGI              TO AT-INFO-LINE-1
 12068     END-IF.
 12069
 12070     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12071     IF ICD1L NOT = ZERO
 12072         MOVE ICD1I              TO AT-ICD-CODE-1
 12073     END-IF.
 12074
 12075     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12076     IF ICD2L NOT = ZERO
 12077         MOVE ICD2I              TO AT-ICD-CODE-2
 12078     END-IF.
 12079
 12080     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12081
 12082 5025-BYPASS-UPDATE.
 12083
 12084
 12085
 12086* EXEC CICS GETMAIN
 12087*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12088*        LENGTH   (ELTRLR-LENGTH)
 12089*    END-EXEC.
 12090*    MOVE '," L                  $   #00011129' TO DFHEIV0
 12091     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 227
* EL130.cbl
 12092     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12093     MOVE X'2020233030303131313239' TO DFHEIV0(25:11)
 12094     CALL 'kxdfhei1' USING DFHEIV0,
 12095           DFHEIV20,
 12096           ELTRLR-LENGTH,
 12097           DFHEIV99
 12098     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12099         DFHEIV20
 12100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12101
 12102
 12103     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12104     MOVE 'AT'                   TO AT-RECORD-ID.
 12105
 12106     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12107     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12108     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12109     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12110     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12111     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12112     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12113     MOVE '9'                    TO AT-TRAILER-TYPE.
 12114     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12115     MOVE '5'                    TO DC-OPTION-CODE.
 12116     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12117     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12118
 12119     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12120     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12121
 12122     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12123     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12124     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12125     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12126     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12127     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12128     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12129     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12130     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12131     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12132     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12133     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12134
 12135     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12136     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12137     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12138     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12139     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12140
 12141
 12142
 12143* EXEC CICS WRITE
 12144*        DATASET   (ELTRLR-DSID)
 12145*        FROM      (ACTIVITY-TRAILERS)
 12146*        RIDFLD    (AT-CONTROL-PRIMARY)
 12147*    END-EXEC.
 12148     MOVE LENGTH OF
 12149      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 228
* EL130.cbl
 12150       TO DFHEIV11
 12151*    MOVE '&$ L                  ''   #00011173' TO DFHEIV0
 12152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12154     MOVE X'2020233030303131313733' TO DFHEIV0(25:11)
 12155     CALL 'kxdfhei1' USING DFHEIV0,
 12156           ELTRLR-DSID,
 12157           ACTIVITY-TRAILERS,
 12158           DFHEIV11,
 12159           AT-CONTROL-PRIMARY,
 12160           DFHEIV99,
 12161           DFHEIV99
 12162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12163
 12164
 12165     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12166     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12167     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12168     MOVE CL-CERT-STATE          TO CERT-STATE.
 12169     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12170     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12171     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12172
 12173
 12174
 12175* EXEC CICS HANDLE CONDITION
 12176*        NOTFND   (5050-CERT-NOT-FOUND)
 12177*    END-EXEC.
 12178*    MOVE '"$I                   ! ; #00011188' TO DFHEIV0
 12179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12181     MOVE X'3B20233030303131313838' TO DFHEIV0(25:11)
 12182     CALL 'kxdfhei1' USING DFHEIV0
 12183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12184
 12185
 12186     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12187
 12188     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12189
 12190
 12191
 12192* EXEC CICS HANDLE CONDITION
 12193*         DUPKEY   (5030-CERT-WRITTEN)
 12194*    END-EXEC.
 12195*    MOVE '"$$                   ! < #00011197' TO DFHEIV0
 12196     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12198     MOVE X'3C20233030303131313937' TO DFHEIV0(25:11)
 12199     CALL 'kxdfhei1' USING DFHEIV0
 12200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12201
 12202
 12203
 12204
 12205* EXEC CICS REWRITE
 12206*        DATASET  (ELCERT-DSID)
 12207*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 229
* EL130.cbl
 12208*    END-EXEC.
 12209     MOVE LENGTH OF
 12210      CERTIFICATE-MASTER
 12211       TO DFHEIV11
 12212*    MOVE '&& L                  %   #00011202' TO DFHEIV0
 12213     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12214     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12215     MOVE X'2020233030303131323032' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0,
 12217           ELCERT-DSID,
 12218           CERTIFICATE-MASTER,
 12219           DFHEIV11,
 12220           DFHEIV99
 12221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12222
 12223
 12224 5030-CERT-WRITTEN.
 12225
 12226     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12227                                    CL-INCURRED-DT
 12228                                    CL-REPORTED-DT
 12229                                    CL-EST-END-OF-DISAB-DT
 12230                                    CL-PAID-THRU-DT.
 12231
 12232     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12233                                    CL-NO-OF-PMTS-MADE
 12234                                    CL-NO-OF-DAYS-PAID.
 12235
 12236     IF CLAIM-IS-CLOSED
 12237        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12238        MOVE 'O'                 TO CL-CLAIM-STATUS
 12239     END-IF.
 12240
 12241     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12242     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12243     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12244
 12245
 12246
 12247* EXEC CICS HANDLE CONDITION
 12248*         DUPKEY   (5035-CLAIM-WRITTEN)
 12249*    END-EXEC.
 12250*    MOVE '"$$                   ! = #00011229' TO DFHEIV0
 12251     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12253     MOVE X'3D20233030303131323239' TO DFHEIV0(25:11)
 12254     CALL 'kxdfhei1' USING DFHEIV0
 12255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12256
 12257
 12258
 12259
 12260* EXEC CICS REWRITE
 12261*        DATASET   (ELMSTR-DSID)
 12262*        FROM      (CLAIM-MASTER)
 12263*    END-EXEC.
 12264     MOVE LENGTH OF
 12265      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 230
* EL130.cbl
 12266       TO DFHEIV11
 12267*    MOVE '&& L                  %   #00011234' TO DFHEIV0
 12268     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12269     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12270     MOVE X'2020233030303131323334' TO DFHEIV0(25:11)
 12271     CALL 'kxdfhei1' USING DFHEIV0,
 12272           ELMSTR-DSID,
 12273           CLAIM-MASTER,
 12274           DFHEIV11,
 12275           DFHEIV99
 12276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12277
 12278
 12279 5035-CLAIM-WRITTEN.
 12280
 12281     MOVE ER-0000                TO EMI-ERROR.
 12282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12283
 12284     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12285     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12286     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12287     MOVE CLMCARRI               TO PI-LAST-CARR.
 12288
 12289     IF PRTOPTL GREATER ZERO
 12290         MOVE PRTOPTI            TO PI-PRT-OPT
 12291     END-IF.
 12292
 12293     IF ALTPRTL GREATER ZERO
 12294         MOVE ALTPRTI            TO PI-ALT-PRT
 12295     END-IF.
 12296
 12297     MOVE LOW-VALUES             TO EL130AI.
 12298
 12299     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12300     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12301     MOVE PI-LAST-CARR           TO CLMCARRO.
 12302     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12303
 12304     IF PI-PRT-OPT = 'N' OR 'L'
 12305         MOVE PI-PRT-OPT         TO PRTOPTO
 12306         MOVE 1                  TO PRTOPTL
 12307     END-IF.
 12308
 12309     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12310         MOVE PI-ALT-PRT         TO ALTPRTO
 12311         MOVE 4                  TO ALTPRTL
 12312     END-IF.
 12313
 12314     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12315     MOVE AL-SANON               TO CERTNOA SUFXA.
 12316
 12317     MOVE SPACES                 TO PI-INCURR-SW.
 12318
 12319     IF PRTOPTL GREATER ZERO
 12320         IF PRTOPTI = 'L'
 12321             GO TO 0400-CREATE-ELACTQ
 12322         ELSE
 12323             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 231
* EL130.cbl
 12324         END-IF
 12325     END-IF.
 12326
 12327     GO TO 8100-SEND-INITIAL-MAP.
 12328
 12329 5050-CERT-NOT-FOUND.
 12330
 12331     MOVE ER-0244                TO EMI-ERROR.
 12332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12333     MOVE -1                     TO CERTNOL.
 12334     GO TO 8200-SEND-DATAONLY.
 12335
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 232
* EL130.cbl
 12337 5500-BUILD-FORM-TRAILER.
 12338*************************************************************
 12339*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12340*************************************************************
 12341
 12342     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12343
 12344     IF  WS-BEN-ALPHA-2 = '30'
 12345         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12346         MOVE '6'                TO DC-OPTION-CODE
 12347         IF CL-CARRIER = 'C'
 12348             MOVE +14            TO DC-ELAPSED-DAYS
 12349             MOVE +0             TO DC-ELAPSED-MONTHS
 12350             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12351             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12352         ELSE
 12353             MOVE +21            TO DC-ELAPSED-DAYS
 12354             MOVE +0             TO DC-ELAPSED-MONTHS
 12355             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12356             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12357         END-IF
 12358     END-IF.
 12359
 12360
 12361
 12362* EXEC CICS GETMAIN
 12363*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12364*         LENGTH   (ELTRLR-LENGTH)
 12365*         INITIMG  (GETMAIN-SPACE)
 12366*    END-EXEC.
 12367*    MOVE ',"IL                  $   #00011321' TO DFHEIV0
 12368     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12369     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12370     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 12371     CALL 'kxdfhei1' USING DFHEIV0,
 12372           DFHEIV20,
 12373           ELTRLR-LENGTH,
 12374           GETMAIN-SPACE
 12375     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12376         DFHEIV20
 12377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12378
 12379
 12380     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12381     MOVE 'AT'                   TO AT-RECORD-ID.
 12382
 12383     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12384     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12385     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12386     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12387                                    AT-FORM-LAST-MAINT-DT.
 12388     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12389                                    AT-FORM-LAST-UPDATED-BY.
 12390     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12391     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12392     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12393                                    AT-FORM-RE-SEND-DT
 12394                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 233
* EL130.cbl
 12395                                    AT-EMP-FORM-ANSWERED-DT
 12396                                    AT-PHY-FORM-ANSWERED-DT
 12397                                    AT-EMP-FORM-SEND-ON-DT
 12398                                    AT-FORM-PRINTED-DT
 12399                                    AT-FORM-REPRINT-DT.
 12400     MOVE '1'                    TO AT-FORM-TYPE.
 12401
 12402     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12403                                    AT-INSTRUCT-LN-2
 12404                                    AT-INSTRUCT-LN-3.
 12405
 12406     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12407     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12408
 12409     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12410
 12411     IF AM-EMPLOYER-STMT-USED = 'Y'
 12412        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12413     END-IF.
 12414
 12415
 12416
 12417* EXEC CICS WRITE
 12418*         DATASET  (ELTRLR-DSID)
 12419*         FROM     (ACTIVITY-TRAILERS)
 12420*         RIDFLD   (AT-CONTROL-PRIMARY)
 12421*    END-EXEC.
 12422     MOVE LENGTH OF
 12423      ACTIVITY-TRAILERS
 12424       TO DFHEIV11
 12425*    MOVE '&$ L                  ''   #00011363' TO DFHEIV0
 12426     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12428     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 12429     CALL 'kxdfhei1' USING DFHEIV0,
 12430           ELTRLR-DSID,
 12431           ACTIVITY-TRAILERS,
 12432           DFHEIV11,
 12433           AT-CONTROL-PRIMARY,
 12434           DFHEIV99,
 12435           DFHEIV99
 12436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12437
 12438
 12439 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 234
* EL130.cbl
 12441*************************************************************
 12442*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12443*************************************************************
 12444
 12445 5700-BUILD-ARCHIVE-HEADER.
 12446
 12447     MOVE '1'                    TO CNTL-REC-TYPE.
 12448     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12449     MOVE SPACES                 TO CNTL-ACCESS.
 12450
 12451
 12452
 12453* EXEC CICS READ
 12454*         DATASET  (ELCNTL-DSID)
 12455*         SET      (ADDRESS OF CONTROL-FILE)
 12456*         RIDFLD   (ELCNTL-KEY)
 12457*         UPDATE
 12458*    END-EXEC.
 12459*    MOVE '&"S        EU         (   #00011382' TO DFHEIV0
 12460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12461     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12462     MOVE X'2020233030303131333832' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           ELCNTL-DSID,
 12465           DFHEIV20,
 12466           DFHEIV99,
 12467           ELCNTL-KEY,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99
 12471     SET ADDRESS OF CONTROL-FILE TO
 12472         DFHEIV20
 12473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12474
 12475
 12476     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12477
 12478     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12479
 12480
 12481
 12482* EXEC CICS REWRITE
 12483*         FROM     (CONTROL-FILE)
 12484*         DATASET  (ELCNTL-DSID)
 12485*    END-EXEC.
 12486     MOVE LENGTH OF
 12487      CONTROL-FILE
 12488       TO DFHEIV11
 12489*    MOVE '&& L                  %   #00011394' TO DFHEIV0
 12490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303131333934' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           ELCNTL-DSID,
 12495           CONTROL-FILE,
 12496           DFHEIV11,
 12497           DFHEIV99
 12498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 235
* EL130.cbl
 12499
 12500
 12501
 12502
 12503* EXEC CICS HANDLE CONDITION
 12504*         NOTOPEN  (9990-ABEND)
 12505*         DUPKEY   (5799-EXIT)
 12506*    END-EXEC.
 12507*    MOVE '"$J$                  ! > #00011400' TO DFHEIV0
 12508     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12510     MOVE X'3E20233030303131343030' TO DFHEIV0(25:11)
 12511     CALL 'kxdfhei1' USING DFHEIV0
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12513
 12514
 12515
 12516
 12517* EXEC CICS GETMAIN
 12518*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12519*         LENGTH  (ELARCH-LENGTH)
 12520*    END-EXEC.
 12521*    MOVE '," L                  $   #00011406' TO DFHEIV0
 12522     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12524     MOVE X'2020233030303131343036' TO DFHEIV0(25:11)
 12525     CALL 'kxdfhei1' USING DFHEIV0,
 12526           DFHEIV20,
 12527           ELARCH-LENGTH,
 12528           DFHEIV99
 12529     SET ADDRESS OF LETTER-ARCHIVE TO
 12530         DFHEIV20
 12531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12532
 12533
 12534     MOVE SPACES                 TO LETTER-ARCHIVE.
 12535     MOVE 'LA'                   TO LA-RECORD-ID.
 12536     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12537                                    LA-ARCHIVE-NO-A1.
 12538     MOVE '4'                    TO LA-RECORD-TYPE
 12539                                    LA-RECORD-TYPE-A1.
 12540     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12541                                    LA-LINE-SEQ-NO-A1.
 12542     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12543                                    LA-COMPANY-CD-A1.
 12544     MOVE CL-CARRIER             TO LA4-CARRIER.
 12545     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12546     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12547     MOVE CL-CERT-STATE          TO LA4-STATE.
 12548     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12549     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12550     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12551     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12552                                    LA4-RESEND-PRINT-DATE
 12553                                    LA4-FORM-REM-PRINT-DT
 12554                                    LA4-RESEND-DATE.
 12555     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12556     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 236
* EL130.cbl
 12557
 12558
 12559
 12560* EXEC CICS WRITE
 12561*         DATASET  (ELARCH-DSID)
 12562*         FROM     (LETTER-ARCHIVE)
 12563*         RIDFLD   (LA-CONTROL-PRIMARY)
 12564*    END-EXEC.
 12565     MOVE LENGTH OF
 12566      LETTER-ARCHIVE
 12567       TO DFHEIV11
 12568*    MOVE '&$ L                  ''   #00011436' TO DFHEIV0
 12569     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12571     MOVE X'2020233030303131343336' TO DFHEIV0(25:11)
 12572     CALL 'kxdfhei1' USING DFHEIV0,
 12573           ELARCH-DSID,
 12574           LETTER-ARCHIVE,
 12575           DFHEIV11,
 12576           LA-CONTROL-PRIMARY,
 12577           DFHEIV99,
 12578           DFHEIV99
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 237
* EL130.cbl
 12584 6000-EDIT-CLAIM-DATA.
 12585
 12586     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12587     MOVE '2'                    TO DC-OPTION-CODE.
 12588     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12589     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12590
 12591     IF MAINTL NOT = ZERO
 12592         MOVE AL-UANON           TO MAINTA
 12593     END-IF
 12594
 12595     IF CLMNOL GREATER ZERO
 12596         IF CLMNOI = SPACES OR LOW-VALUES
 12597             MOVE -1             TO CLMNOL
 12598             MOVE AL-UABON       TO CLMNOA
 12599             MOVE ER-7688        TO EMI-ERROR
 12600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12601         ELSE
 12602             MOVE AL-UANON       TO CLMNOA
 12603         END-IF
 12604     END-IF.
 12605
 12606     IF CERTNOL = ZERO
 12607         MOVE -1                 TO CERTNOL
 12608         MOVE AL-SABON           TO CERTNOA
 12609         MOVE ER-0203            TO EMI-ERROR
 12610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12611     ELSE
 12612         MOVE AL-SANON           TO CERTNOA
 12613     END-IF.
 12614
 12615     IF SUFXL = ZERO
 12616         MOVE SPACES             TO SUFXI
 12617         MOVE AL-SANON           TO SUFXA
 12618     ELSE
 12619         MOVE AL-SANON           TO SUFXA
 12620     END-IF.
 12621
 12622     IF CLMCARRL = ZERO
 12623         MOVE -1                 TO CLMCARRL
 12624         MOVE ER-0194            TO EMI-ERROR
 12625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12626     ELSE
 12627         MOVE CLMCARRI           TO PI-CARRIER
 12628         IF PI-NO-CARRIER-SECURITY
 12629             MOVE AL-UANON       TO CLMCARRA
 12630         END-IF
 12631     END-IF.
 12632
 12633     IF CLMTYPEL > ZERO
 12634        IF ((PI-COMPANY-ID = 'DCC')
 12635           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12636              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12637                        OR
 12638           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12639           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12640              AND PI-AH-OVERRIDE-L1))
 12641              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 238
* EL130.cbl
 12642              MOVE AL-UABON       TO CLMTYPEA
 12643              MOVE ER-7634        TO EMI-ERROR
 12644              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12645        ELSE
 12646           MOVE AL-UANON       TO CLMTYPEA
 12647        END-IF
 12648     ELSE
 12649        IF MAINTI = 'A'
 12650           MOVE -1             TO CLMTYPEL
 12651           MOVE AL-UABON       TO CLMTYPEA
 12652           MOVE ER-0546        TO EMI-ERROR
 12653           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12654        END-IF
 12655     END-IF
 12656     if instypel > ZERO
 12657        if instypei = 'P' OR 'C'
 12658           move al-uanon         to instypea
 12659        else
 12660           MOVE -1               TO INSTYPEL
 12661           MOVE AL-UABON         TO INSTYPEA
 12662           MOVE ER-1654          TO EMI-ERROR
 12663           PERFORM 9900-ERROR-FORMAT
 12664                                 THRU 9900-EXIT
 12665        END-IF
 12666     ELSE
 12667        IF MAINTI = 'A'
 12668           MOVE -1               TO INSTYPEL
 12669           MOVE AL-UABON         TO INSTYPEA
 12670           MOVE ER-1654          TO EMI-ERROR
 12671           PERFORM 9900-ERROR-FORMAT
 12672                                 THRU 9900-EXIT
 12673        END-IF
 12674     END-IF
 12675     if (instypel <> zeros)
 12676        and (emi-error not = er-1654)
 12677        and (instypei = 'C')
 12678        and (crtfnmei = fstnmei)
 12679        move er-1675             to emi-error
 12680        MOVE -1                  TO INSTYPEL
 12681        MOVE AL-UABON            TO INSTYPEA
 12682        PERFORM 9900-ERROR-FORMAT
 12683                                 THRU 9900-EXIT
 12684    end-if
 12685     if (instypel <> zeros)
 12686        and (emi-error not = er-1654)
 12687        and (instypei = 'P')
 12688        and (crtfnmei <> fstnmei)
 12689        move er-1676             to emi-error
 12690        MOVE -1                  TO INSTYPEL
 12691        MOVE AL-UABON            TO INSTYPEA
 12692        PERFORM 9900-ERROR-FORMAT
 12693                                 THRU 9900-EXIT
 12694    end-if
 12695     IF PCERTNOL = ZERO
 12696        MOVE CERTNOI             TO PCERTNOI
 12697        MOVE CERTNOL             TO PCERTNOL
 12698        MOVE AL-UANON            TO PCERTNOA
 12699     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 239
* EL130.cbl
 12700        MOVE AL-UANON            TO PCERTNOA
 12701     END-IF.
 12702
 12703     IF PSUFXL = ZERO
 12704        MOVE SUFXI               TO PSUFXI
 12705        MOVE SUFXL               TO PSUFXL
 12706        MOVE AL-UANON            TO PSUFXA
 12707     ELSE
 12708        MOVE AL-UANON            TO PSUFXA
 12709     END-IF.
 12710
 12711     IF MAINTI = 'I'
 12712         GO TO 6020-EDIT
 12713     END-IF.
 12714
 12715     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12716         MOVE -1                 TO LSTNMEL
 12717         MOVE ER-0236            TO EMI-ERROR
 12718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12719     ELSE
 12720         MOVE AL-UANON           TO LSTNMEA
 12721     END-IF.
 12722     if fstnmel not = zeros
 12723        move al-uanon            to fstnmea
 12724     end-if
 12725     IF SEXL > ZEROS
 12726        IF SEXI = 'M' OR 'F'
 12727           move al-uanon         to sexa
 12728           CONTINUE
 12729        ELSE
 12730           MOVE -1               TO SEXL
 12731           MOVE AL-UABON         TO SEXA
 12732           MOVE ER-0219          TO EMI-ERROR
 12733           PERFORM 9900-ERROR-FORMAT
 12734                                 THRU 9900-EXIT
 12735        END-IF
 12736     ELSE
 12737        IF MAINTI = 'A'
 12738           MOVE -1               TO SEXL
 12739           MOVE AL-UABON         TO SEXA
 12740           MOVE ER-0219          TO EMI-ERROR
 12741           PERFORM 9900-ERROR-FORMAT
 12742                                 THRU 9900-EXIT
 12743        END-IF
 12744     END-IF
 12745     IF SSNL GREATER THAN ZERO
 12746         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12747         IF WS-SOC-SEC-NO NUMERIC AND
 12748           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12749             NEXT SENTENCE
 12750         ELSE
 12751            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12752               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12753               WS-SSN-DASH2 = '-'
 12754                 NEXT SENTENCE
 12755            ELSE
 12756                 MOVE ER-0887        TO  EMI-ERROR
 12757                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 240
* EL130.cbl
 12758                 MOVE AL-UABON       TO  SSNA
 12759                 MOVE -1             TO  SSNL
 12760            END-IF
 12761        END-IF
 12762     END-IF.
 12763
 12764     IF BIRTHDTL = ZERO
 12765         GO TO 6020-EDIT
 12766     END-IF.
 12767
 12768     IF BIRTHDTL GREATER ZERO
 12769         MOVE BIRTHDTI           TO DATE-WORK
 12770         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12771         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12772         MOVE '4'                TO DC-OPTION-CODE
 12773         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12774         IF DATE-CONVERSION-ERROR
 12775             MOVE AL-UABON       TO BIRTHDTA
 12776             MOVE -1             TO BIRTHDTL
 12777             MOVE ER-0220        TO EMI-ERROR
 12778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12779             GO TO 6020-EDIT
 12780         END-IF
 12781     END-IF.
 12782
 12783******************************************************************
 12784**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12785**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12786**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 12787******************************************************************
 12788
 12789     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12790         MOVE BIRTHDTI           TO  DATE-WORK
 12791         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12792         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12793         MOVE '4'                TO  DC-OPTION-CODE
 12794         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12795         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12796                                     DC-ELAPSED-DAYS
 12797         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12798         IF DATE-CONVERSION-ERROR
 12799             MOVE AL-UABON       TO  BIRTHDTA
 12800             MOVE -1             TO  BIRTHDTL
 12801             MOVE ER-0220        TO  EMI-ERROR
 12802             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803             GO TO 6020-EDIT
 12804         END-IF
 12805     END-IF.
 12806
 12807     MOVE AL-UANON               TO  BIRTHDTA.
 12808     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12809     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12810     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12811
 12812 6020-EDIT.
 12813     IF INCURL GREATER ZERO
 12814         MOVE INCURI             TO DATE-WORK
 12815         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 241
* EL130.cbl
 12816         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12817         MOVE '4'                TO DC-OPTION-CODE
 12818         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12819         IF DATE-CONVERSION-ERROR
 12820             MOVE AL-UABON       TO INCURA
 12821             MOVE -1             TO INCURL
 12822             MOVE ER-0222        TO EMI-ERROR
 12823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12824         ELSE
 12825             MOVE AL-UANON       TO INCURA
 12826             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12827             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12828                                    PI-SAVE-INCUR-DT
 12829             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12830                 MOVE ER-0511     TO EMI-ERROR
 12831                 MOVE -1          TO INCURL
 12832                 MOVE AL-UABON    TO INCURA
 12833                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12834             ELSE
 12835*                NEXT SENTENCE
 12836                 CONTINUE
 12837             END-IF
 12838         END-IF
 12839     ELSE
 12840         MOVE ER-0516         TO EMI-ERROR
 12841         MOVE AL-UABON        TO INCURA
 12842         MOVE -1              TO INCURL
 12843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12844     END-IF.
 12845
 12846     IF REPORTL GREATER ZERO
 12847         MOVE REPORTI            TO DATE-WORK
 12848         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12849         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12850         MOVE '4'                TO DC-OPTION-CODE
 12851         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12852         IF DATE-CONVERSION-ERROR
 12853             MOVE AL-UABON       TO REPORTA
 12854             MOVE -1             TO REPORTL
 12855             MOVE ER-0223        TO EMI-ERROR
 12856             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12857         ELSE
 12858             MOVE AL-UANON       TO REPORTA
 12859             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12860             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12861             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12862                 MOVE ER-0512     TO EMI-ERROR
 12863                 MOVE -1          TO REPORTL
 12864                 MOVE AL-UABON    TO REPORTA
 12865                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12866             ELSE
 12867*                NEXT SENTENCE
 12868                 CONTINUE
 12869             END-IF
 12870         END-IF
 12871     ELSE
 12872         MOVE ER-0517         TO EMI-ERROR
 12873         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 242
* EL130.cbl
 12874         MOVE AL-UABON        TO REPORTA
 12875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12876     END-IF.
 12877
 12878     IF WS-REPORT NOT = LOW-VALUES
 12879         IF WS-INCUR GREATER THAN WS-REPORT
 12880             MOVE AL-UABON       TO REPORTA
 12881             MOVE -1             TO REPORTL
 12882             MOVE ER-0509        TO EMI-ERROR
 12883             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12884         END-IF
 12885     END-IF.
 12886
 12887     IF ICD1L GREATER THAN ZERO
 12888         IF (ICD1I GREATER THAN SPACES) AND
 12889            (ICD1I(4:1) NOT = '.')
 12890             IF ICD1I(4:1) = ' '
 12891                 MOVE '.' TO ICD1I(4:1)
 12892             ELSE
 12893                 IF ICD1I(8:1) = ' '
 12894                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 12895                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 12896                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 12897                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 12898                     MOVE '.'        TO ICD1I(4:1)
 12899                 END-IF
 12900             END-IF
 12901         END-IF
 12902         IF (ICD1I GREATER THAN SPACES) AND
 12903            (ICD1I(1:1) NOT > ' ' OR
 12904             ICD1I(2:1) NOT > ' ' OR
 12905             ICD1I(3:1) NOT > ' ' OR
 12906             ICD1I(4:1) NOT = '.')
 12907              MOVE ER-0992        TO  EMI-ERROR
 12908              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12909              MOVE AL-UABON       TO ICD1A
 12910              MOVE -1             TO ICD1L
 12911         END-IF
 12912     END-IF.
 12913
 12914     IF ICD2L GREATER THAN ZERO
 12915         IF (ICD2I GREATER THAN SPACES) AND
 12916            (ICD2I(4:1) NOT = '.')
 12917             IF ICD2I(4:1) = ' '
 12918                 MOVE '.' TO ICD2I(4:1)
 12919             ELSE
 12920                 IF ICD2I(8:1) = ' '
 12921                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 12922                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 12923                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 12924                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 12925                     MOVE '.'        TO ICD2I(4:1)
 12926                 END-IF
 12927             END-IF
 12928         END-IF
 12929         IF (ICD2I GREATER THAN SPACES) AND
 12930            (ICD2I(1:1) NOT > ' ' OR
 12931             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 243
* EL130.cbl
 12932             ICD2I(3:1) NOT > ' ' OR
 12933             ICD2I(4:1) NOT = '.')
 12934              MOVE ER-0992        TO  EMI-ERROR
 12935              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12936              MOVE AL-UABON       TO ICD2A
 12937              MOVE -1             TO ICD2L
 12938         END-IF
 12939     END-IF
 12940
 12941*    IF ESTENDL GREATER ZERO
 12942*        MOVE ESTENDI            TO DATE-WORK
 12943*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12944*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12945*        MOVE '4'                TO DC-OPTION-CODE
 12946*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12947*        IF DATE-CONVERSION-ERROR
 12948*            MOVE AL-UABON       TO ESTENDA
 12949*            MOVE -1             TO ESTENDL
 12950*            MOVE ER-0224        TO EMI-ERROR
 12951*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12952*        ELSE
 12953*            MOVE AL-UANON       TO ESTENDA
 12954*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12955*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12956*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12957*               MOVE AL-UABON    TO ESTENDA
 12958*               MOVE -1          TO ESTENDL
 12959*               MOVE ER-0544     TO EMI-ERROR
 12960*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12961*            END-IF
 12962*        END-IF
 12963*    END-IF.
 12964*
 12965*    IF WS-ESTEND NOT = LOW-VALUES
 12966*        IF WS-INCUR GREATER THAN WS-ESTEND
 12967*            MOVE AL-UABON       TO ESTENDA
 12968*            MOVE -1             TO ESTENDL
 12969*            MOVE ER-0510        TO EMI-ERROR
 12970*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12971*        END-IF
 12972*    END-IF.
 12973
 12974     IF PRTOPTL GREATER ZERO
 12975         IF PRTOPTI NOT = 'N' AND 'L'
 12976             MOVE AL-UABON       TO PRTOPTA
 12977             MOVE -1             TO PRTOPTL
 12978             MOVE ER-0334        TO EMI-ERROR
 12979             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12980         END-IF
 12981     END-IF.
 12982
 12983     IF MANRSVL GREATER ZERO
 12984
 12985* EXEC CICS BIF DEEDIT
 12986*            FIELD   (MANRSVI)
 12987*            LENGTH  (9)
 12988*        END-EXEC
 12989     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 244
* EL130.cbl
 12990       TO DFHEIV11
 12991*    MOVE '@"L                   #   #00011844' TO DFHEIV0
 12992     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12993     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12994     MOVE X'2020233030303131383434' TO DFHEIV0(25:11)
 12995     CALL 'kxdfhei1' USING DFHEIV0,
 12996           MANRSVI,
 12997           DFHEIV11
 12998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12999         IF MANRSVI NOT NUMERIC
 13000             MOVE AL-UNBON       TO MANRSVA
 13001             MOVE -1             TO MANRSVL
 13002             MOVE ER-0489        TO EMI-ERROR
 13003             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13004         ELSE
 13005             MOVE AL-UNNON       TO MANRSVA
 13006             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13007         END-IF
 13008     END-IF.
 13009
 13010     MOVE SPACES                 TO ELCNTL-KEY.
 13011
 13012     IF CONTROL-IS-ACTUAL-CARRIER
 13013         MOVE PI-CARRIER         TO CNTL-CARRIER
 13014     ELSE
 13015         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13016     END-IF.
 13017
 13018     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13019     MOVE '6'                    TO CNTL-REC-TYPE.
 13020     MOVE +0                     TO CNTL-SEQ-NO.
 13021
 13022
 13023
 13024* EXEC CICS HANDLE CONDITION
 13025*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13026*    END-EXEC.
 13027*    MOVE '"$I                   ! ? #00011872' TO DFHEIV0
 13028     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13030     MOVE X'3F20233030303131383732' TO DFHEIV0(25:11)
 13031     CALL 'kxdfhei1' USING DFHEIV0
 13032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13033
 13034
 13035     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13036
 13037     IF NOT CF-MANUAL-RESERVES-USED AND
 13038           WS-MANRSV GREATER ZERO
 13039         MOVE ER-0518             TO EMI-ERROR
 13040         MOVE -1                  TO MANRSVL
 13041         MOVE AL-UNBON            TO MANRSVA
 13042         MOVE ZEROS               TO WS-MANRSV
 13043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13044     END-IF.
 13045
 13046     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13047     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 245
* EL130.cbl
 13048
 13049     IF SUPVL GREATER ZERO
 13050         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13051             MOVE -1             TO SUPVL
 13052             MOVE AL-UABON       TO SUPVA
 13053             MOVE ER-0230        TO EMI-ERROR
 13054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13055         ELSE
 13056             MOVE AL-UANON       TO SUPVA
 13057         END-IF
 13058     END-IF.
 13059
 13060     IF PROCCDL = ZERO
 13061        GO TO 6050-CONTINUE-EDITS
 13062     END-IF.
 13063
 13064     MOVE SPACES                 TO ELCNTL-KEY.
 13065     MOVE PROCCDI                TO CNTL-ACCESS.
 13066
 13067     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13068     MOVE '2'                    TO CNTL-REC-TYPE.
 13069     MOVE +0                     TO CNTL-SEQ-NO.
 13070
 13071
 13072
 13073* EXEC CICS HANDLE CONDITION
 13074*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13075*    END-EXEC.
 13076*    MOVE '"$I                   ! @ #00011913' TO DFHEIV0
 13077     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13078     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13079     MOVE X'4020233030303131393133' TO DFHEIV0(25:11)
 13080     CALL 'kxdfhei1' USING DFHEIV0
 13081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13082
 13083
 13084     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13085
 13086     GO TO 6050-CONTINUE-EDITS.
 13087
 13088 6040-NO-PROCESSOR-RECORD.
 13089     MOVE ER-0019                TO EMI-ERROR.
 13090     MOVE -1                     TO PROCCDL.
 13091     MOVE AL-UABON               TO PROCCDA.
 13092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13093
 13094 6050-CONTINUE-EDITS.
 13095     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13096           GO TO 6070-CONTINUE-EDITS
 13097     END-IF.
 13098
 13099     MOVE BENECDI                TO BENE-CODE.
 13100     MOVE 'B'                    TO BENE-RCD-TYPE.
 13101     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13102
 13103
 13104
 13105* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 246
* EL130.cbl
 13106*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13107*    END-EXEC.
 13108*    MOVE '"$I                   ! A #00011937' TO DFHEIV0
 13109     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13111     MOVE X'4120233030303131393337' TO DFHEIV0(25:11)
 13112     CALL 'kxdfhei1' USING DFHEIV0
 13113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13114
 13115
 13116
 13117* EXEC CICS READ
 13118*         DATASET   (ELBENE-DSID)
 13119*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13120*         RIDFLD    (ELBENE-KEY)
 13121*    END-EXEC.
 13122*    MOVE '&"S        E          (   #00011941' TO DFHEIV0
 13123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           ELBENE-DSID,
 13128           DFHEIV20,
 13129           DFHEIV99,
 13130           ELBENE-KEY,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99
 13134     SET ADDRESS OF BENEFICIARY-MASTER TO
 13135         DFHEIV20
 13136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13137
 13138
 13139     GO TO 6070-CONTINUE-EDITS.
 13140
 13141 6060-NO-BENEFICIARY-RECORD.
 13142     MOVE ER-0565                TO EMI-ERROR.
 13143     MOVE -1                     TO BENECDL.
 13144     MOVE AL-UABON               TO BENECDA.
 13145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13146
 13147
 13148 6070-CONTINUE-EDITS.
 13149     IF CERTMTL GREATER ZERO
 13150         IF CERTMTI NOT = 'A' AND 'S'
 13151             MOVE -1             TO CERTMTL
 13152             MOVE AL-UABON       TO CERTMTA
 13153             MOVE ER-0267        TO EMI-ERROR
 13154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13155         ELSE
 13156             MOVE AL-UANON       TO CERTMTA
 13157         END-IF
 13158     ELSE
 13159         GO TO 6000-EXIT
 13160     END-IF.
 13161
 13162     IF EFFDTL GREATER ZERO
 13163         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 247
* EL130.cbl
 13164         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13165         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13166         MOVE '4'                TO DC-OPTION-CODE
 13167         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13168         IF DATE-CONVERSION-ERROR
 13169             MOVE AL-UABON       TO EFFDTA
 13170             MOVE -1             TO EFFDTL
 13171             MOVE ER-0231        TO EMI-ERROR
 13172             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13173         ELSE
 13174             MOVE AL-UANON       TO EFFDTA
 13175             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13176             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13177         END-IF
 13178     ELSE
 13179         MOVE ER-0231            TO EMI-ERROR
 13180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13181         MOVE -1                 TO EFFDTL
 13182         MOVE AL-UABON           TO EFFDTA
 13183     END-IF.
 13184
 13185     IF ACCOUNTL = ZERO
 13186         MOVE ER-0232            TO EMI-ERROR
 13187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13188         MOVE AL-UABON           TO ACCOUNTA
 13189         MOVE -1                 TO ACCOUNTL
 13190     ELSE
 13191         MOVE AL-UANON           TO ACCOUNTA
 13192     END-IF.
 13193
 13194     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13195        (STATEL = ZERO)
 13196         MOVE ER-0233        TO EMI-ERROR
 13197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13198         MOVE AL-UABON       TO STATEA
 13199         MOVE -1             TO STATEL
 13200     ELSE
 13201         MOVE AL-UANON       TO STATEA
 13202     END-IF.
 13203
 13204     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13205        (CRTCARRL = ZERO)
 13206         MOVE ER-0234        TO EMI-ERROR
 13207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13208         MOVE AL-UABON       TO CRTCARRA
 13209         MOVE -1             TO CRTCARRL
 13210     ELSE
 13211         MOVE AL-UANON       TO CRTCARRA
 13212     END-IF.
 13213
 13214     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13215        GROUPL = ZERO
 13216         MOVE ER-0235            TO EMI-ERROR
 13217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13218         MOVE AL-UABON           TO GROUPA
 13219         MOVE -1                 TO GROUPL
 13220     ELSE
 13221         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 248
* EL130.cbl
 13222     END-IF.
 13223
 13224     IF CRTLNMEL = ZERO
 13225         IF LSTNMEI = SPACES OR LOW-VALUES
 13226             MOVE ER-0236            TO  EMI-ERROR
 13227             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13228             MOVE AL-UABON           TO  CRTLNMEA
 13229             MOVE -1                 TO  CRTLNMEL
 13230         ELSE
 13231             MOVE LSTNMEI            TO  CRTLNMEI
 13232             MOVE AL-UANON           TO  CRTLNMEA
 13233         END-IF
 13234     ELSE
 13235         MOVE AL-UANON               TO  CRTLNMEA
 13236     END-IF.
 13237
 13238     IF CRTFNMEL = ZERO
 13239         IF FSTNMEI = SPACES OR LOW-VALUES
 13240*            NEXT SENTENCE
 13241             CONTINUE
 13242         ELSE
 13243             MOVE FSTNMEI            TO  CRTFNMEI
 13244             MOVE AL-UANON           TO  CRTFNMEA
 13245         END-IF
 13246     END-IF.
 13247
 13248     IF CRTINITL = ZERO
 13249         IF INITI = SPACES OR LOW-VALUES
 13250*            NEXT SENTENCE
 13251             CONTINUE
 13252         ELSE
 13253             MOVE INITI              TO  CRTINITI
 13254             MOVE AL-UANON           TO  CRTINITA
 13255         END-IF
 13256     END-IF.
 13257
 13258 6000-EXIT.
 13259     EXIT.
 13260
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 249
* EL130.cbl
 13262 6200-EDIT-CERT-DATA.
 13263     IF ISSAGEL GREATER ZERO
 13264         IF ISSAGEI NOT NUMERIC
 13265             MOVE ER-0237        TO EMI-ERROR
 13266             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13267             MOVE -1             TO ISSAGEL
 13268             MOVE AL-UNBON       TO ISSAGEA
 13269         ELSE
 13270             MOVE AL-UNNON       TO ISSAGEA
 13271         END-IF
 13272     END-IF.
 13273
 13274     IF JNTAGEL GREATER ZERO
 13275         IF JNTAGEI NOT NUMERIC
 13276             MOVE ER-0238        TO EMI-ERROR
 13277             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13278             MOVE -1             TO JNTAGEL
 13279             MOVE AL-UNBON       TO JNTAGEA
 13280         ELSE
 13281             MOVE AL-UNNON       TO JNTAGEA
 13282         END-IF
 13283     END-IF.
 13284
 13285     IF LCVCDL GREATER ZERO
 13286         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13287         IF INVALID-BENEFIT-CODE
 13288             MOVE ER-7635        TO EMI-ERROR
 13289             MOVE -1             TO LCVCDL
 13290             MOVE AL-UABON       TO LCVCDA
 13291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13292         ELSE
 13293             MOVE LCVCDI         TO WS-BEN-HOLD
 13294             MOVE '4'            TO WS-REC-TYPE
 13295             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13296             IF WS-BEN-ALPHA-HOLD = SPACES
 13297                MOVE ER-7635     TO EMI-ERROR
 13298                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13299                MOVE -1          TO LCVCDL
 13300                MOVE AL-UABON    TO LCVCDA
 13301             ELSE
 13302                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13303                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13304                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13305                MOVE AL-UANON           TO LCVCDA
 13306             END-IF
 13307         END-IF
 13308     END-IF.
 13309
 13310     IF ACVCDL GREATER ZERO
 13311         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13312         IF INVALID-BENEFIT-CODE
 13313             MOVE ER-7635        TO EMI-ERROR
 13314             MOVE -1             TO ACVCDL
 13315             MOVE AL-UABON       TO ACVCDA
 13316             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13317         ELSE
 13318             MOVE ACVCDI         TO WS-BEN-HOLD
 13319             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 250
* EL130.cbl
 13320             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13321             IF WS-BEN-ALPHA-HOLD = SPACES
 13322                MOVE ER-7635     TO EMI-ERROR
 13323                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13324                MOVE -1          TO ACVCDL
 13325                MOVE AL-UABON    TO ACVCDA
 13326             ELSE
 13327                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13328                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13329                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13330                MOVE AL-UANON           TO ACVCDA
 13331             END-IF
 13332         END-IF
 13333     END-IF.
 13334
 13335     IF LCVOTRML GREATER ZERO
 13336         IF LCVOTRMI NOT NUMERIC
 13337             MOVE ER-7636        TO EMI-ERROR
 13338             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13339             MOVE -1             TO LCVOTRML
 13340             MOVE AL-UNBON       TO LCVOTRMA
 13341         ELSE
 13342             MOVE AL-UNNON       TO LCVOTRMA
 13343         END-IF
 13344     END-IF.
 13345
 13346     IF ACVOTRML GREATER ZERO
 13347         IF ACVOTRMI NOT NUMERIC
 13348             MOVE ER-7636        TO EMI-ERROR
 13349             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13350             MOVE -1             TO ACVOTRML
 13351             MOVE AL-UNBON       TO ACVOTRMA
 13352         ELSE
 13353             MOVE AL-UNNON       TO ACVOTRMA
 13354         END-IF
 13355     END-IF.
 13356
 13357     IF LCVRATEL GREATER ZERO
 13358
 13359* EXEC CICS BIF DEEDIT
 13360*            FIELD    (LCVRATEI)
 13361*            LENGTH   (06)
 13362*        END-EXEC
 13363     MOVE 06
 13364       TO DFHEIV11
 13365*    MOVE '@"L                   #   #00012166' TO DFHEIV0
 13366     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13367     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13368     MOVE X'2020233030303132313636' TO DFHEIV0(25:11)
 13369     CALL 'kxdfhei1' USING DFHEIV0,
 13370           LCVRATEI,
 13371           DFHEIV11
 13372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13373         IF LCVRATEI NOT NUMERIC
 13374             MOVE AL-UNBON       TO LCVRATEA
 13375             MOVE -1             TO LCVRATEL
 13376             MOVE ER-2280        TO EMI-ERROR
 13377             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 251
* EL130.cbl
 13378         ELSE
 13379             MOVE AL-UNNON       TO LCVRATEA
 13380             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13381         END-IF
 13382     END-IF.
 13383
 13384     IF ACVRATEL GREATER ZERO
 13385
 13386* EXEC CICS BIF DEEDIT
 13387*            FIELD    (ACVRATEI)
 13388*            LENGTH   (06)
 13389*        END-EXEC
 13390     MOVE 06
 13391       TO DFHEIV11
 13392*    MOVE '@"L                   #   #00012182' TO DFHEIV0
 13393     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13395     MOVE X'2020233030303132313832' TO DFHEIV0(25:11)
 13396     CALL 'kxdfhei1' USING DFHEIV0,
 13397           ACVRATEI,
 13398           DFHEIV11
 13399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13400         IF ACVRATEI NOT NUMERIC
 13401             MOVE AL-UNBON       TO ACVRATEA
 13402             MOVE -1             TO ACVRATEL
 13403             MOVE ER-2280        TO EMI-ERROR
 13404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13405         ELSE
 13406             MOVE AL-UNNON       TO ACVRATEA
 13407             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13408         END-IF
 13409     END-IF.
 13410
 13411     IF LCVBENEL GREATER ZERO
 13412
 13413* EXEC CICS BIF DEEDIT
 13414*            FIELD    (LCVBENEI)
 13415*            LENGTH   (11)
 13416*        END-EXEC
 13417     MOVE 11
 13418       TO DFHEIV11
 13419*    MOVE '@"L                   #   #00012198' TO DFHEIV0
 13420     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13421     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13422     MOVE X'2020233030303132313938' TO DFHEIV0(25:11)
 13423     CALL 'kxdfhei1' USING DFHEIV0,
 13424           LCVBENEI,
 13425           DFHEIV11
 13426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13427         IF LCVBENEI NOT NUMERIC
 13428             MOVE AL-UNBON       TO LCVBENEA
 13429             MOVE -1             TO LCVBENEL
 13430             MOVE ER-7637        TO EMI-ERROR
 13431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13432         ELSE
 13433             MOVE AL-UNNON       TO LCVBENEA
 13434             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13435         END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 252
* EL130.cbl
 13436     END-IF.
 13437
 13438     IF ACVBENEL GREATER ZERO
 13439
 13440* EXEC CICS BIF DEEDIT
 13441*            FIELD    (ACVBENEI)
 13442*            LENGTH   (11)
 13443*        END-EXEC
 13444     MOVE 11
 13445       TO DFHEIV11
 13446*    MOVE '@"L                   #   #00012214' TO DFHEIV0
 13447     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13448     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13449     MOVE X'2020233030303132323134' TO DFHEIV0(25:11)
 13450     CALL 'kxdfhei1' USING DFHEIV0,
 13451           ACVBENEI,
 13452           DFHEIV11
 13453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13454         IF ACVBENEI NOT NUMERIC
 13455             MOVE AL-UNBON       TO ACVBENEA
 13456             MOVE -1             TO ACVBENEL
 13457             MOVE ER-7637        TO EMI-ERROR
 13458             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13459         ELSE
 13460             MOVE AL-UNNON       TO ACVBENEA
 13461             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13462         END-IF
 13463     END-IF.
 13464
 13465     IF LCVCNDTL GREATER ZERO
 13466         IF LCVCNDTI NOT = SPACES
 13467             MOVE LCVCNDTI        TO DATE-WORK
 13468             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13469             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13470             MOVE '4'             TO DC-OPTION-CODE
 13471             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13472             IF DATE-CONVERSION-ERROR
 13473                 MOVE AL-UABON    TO LCVCNDTA
 13474                 MOVE -1          TO LCVCNDTL
 13475                 MOVE ER-7638     TO EMI-ERROR
 13476                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13477             ELSE
 13478                 MOVE AL-UANON    TO LCVCNDTA
 13479                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13480                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13481             END-IF
 13482         END-IF
 13483     END-IF.
 13484
 13485     IF ACVCNDTL GREATER ZERO
 13486         IF ACVCNDTI NOT = SPACES
 13487             MOVE ACVCNDTI        TO DATE-WORK
 13488             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13489             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13490             MOVE '4'             TO DC-OPTION-CODE
 13491             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13492             IF DATE-CONVERSION-ERROR
 13493                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 253
* EL130.cbl
 13494                 MOVE -1          TO ACVCNDTL
 13495                 MOVE ER-7638     TO EMI-ERROR
 13496                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13497             ELSE
 13498                 MOVE AL-UANON    TO ACVCNDTA
 13499                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13500                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13501             END-IF
 13502         END-IF
 13503     END-IF.
 13504
 13505     IF ADDONDTL GREATER ZERO
 13506         MOVE ADDONDTI        TO DATE-WORK
 13507         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13508         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13509         MOVE '4'             TO DC-OPTION-CODE
 13510         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13511         IF DATE-CONVERSION-ERROR
 13512             MOVE AL-UABON    TO ADDONDTA
 13513             MOVE -1          TO ADDONDTL
 13514             MOVE ER-7651     TO EMI-ERROR
 13515             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516         ELSE
 13517             MOVE AL-UANON    TO ADDONDTA
 13518             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13519             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13520         END-IF
 13521     END-IF.
 13522
 13523     IF APRL GREATER ZERO
 13524
 13525* EXEC CICS BIF DEEDIT
 13526*            FIELD    (APRI)
 13527*            LENGTH   (8)
 13528*        END-EXEC
 13529     MOVE 8
 13530       TO DFHEIV11
 13531*    MOVE '@"L                   #   #00012288' TO DFHEIV0
 13532     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13533     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13534     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 13535     CALL 'kxdfhei1' USING DFHEIV0,
 13536           APRI,
 13537           DFHEIV11
 13538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13539         IF APRI NOT NUMERIC
 13540             MOVE AL-UNBON       TO APRA
 13541             MOVE -1             TO APRL
 13542             MOVE ER-0248        TO EMI-ERROR
 13543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13544         ELSE
 13545             MOVE AL-UNNON       TO APRA
 13546             MOVE APRI           TO WS-APR APRO
 13547         END-IF
 13548     END-IF.
 13549
 13550     IF PMTFREQL GREATER ZERO
 13551
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 254
* EL130.cbl
 13552* EXEC CICS BIF DEEDIT
 13553*            FIELD   (PMTFREQI)
 13554*            LENGTH  (2)
 13555*        END-EXEC
 13556     MOVE 2
 13557       TO DFHEIV11
 13558*    MOVE '@"L                   #   #00012304' TO DFHEIV0
 13559     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13560     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13561     MOVE X'2020233030303132333034' TO DFHEIV0(25:11)
 13562     CALL 'kxdfhei1' USING DFHEIV0,
 13563           PMTFREQI,
 13564           DFHEIV11
 13565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13566         IF PMTFREQI NOT NUMERIC
 13567             MOVE -1             TO PMTFREQL
 13568             MOVE AL-UNBON       TO PMTFREQA
 13569             MOVE ER-0258        TO EMI-ERROR
 13570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13571         ELSE
 13572             MOVE AL-UNNON       TO PMTFREQA
 13573             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13574         END-IF
 13575     END-IF.
 13576
 13577     IF INDGRPL GREATER ZERO
 13578         IF INDGRPI = 'I' OR 'G'
 13579             MOVE AL-UANON       TO INDGRPA
 13580         ELSE
 13581             MOVE -1 TO INDGRPL
 13582             MOVE AL-UABON       TO INDGRPA
 13583             MOVE ER-0260        TO EMI-ERROR
 13584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13585         END-IF
 13586     END-IF.
 13587
 13588     IF LOANBALL GREATER ZERO
 13589         MOVE LOANBALI           TO DEEDIT-FIELD
 13590
 13591* EXEC CICS BIF DEEDIT
 13592*            FIELD   (DEEDIT-FIELD)
 13593*            LENGTH  (12)
 13594*        END-EXEC
 13595     MOVE 12
 13596       TO DFHEIV11
 13597*    MOVE '@"L                   #   #00012332' TO DFHEIV0
 13598     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303132333332' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
 13602           DEEDIT-FIELD,
 13603           DFHEIV11
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13605         IF DEEDIT-FIELD NOT NUMERIC
 13606             MOVE AL-UNBON       TO LOANBALA
 13607             MOVE -1             TO LOANBALL
 13608             MOVE ER-0247        TO EMI-ERROR
 13609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 255
* EL130.cbl
 13610         ELSE
 13611             MOVE AL-UNNON       TO LOANBALA
 13612             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13613         END-IF
 13614     END-IF.
 13615
 13616     IF PREMTYPL GREATER ZERO
 13617         IF (PREMTYPI = '1' OR '2' OR '3')
 13618             MOVE AL-UANON       TO PREMTYPA
 13619         ELSE
 13620             MOVE -1             TO PREMTYPL
 13621             MOVE AL-UABON       TO PREMTYPA
 13622             MOVE ER-0227        TO EMI-ERROR
 13623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13624         END-IF
 13625     END-IF.
 13626
 13627     IF REINCDL GREATER ZERO
 13628         MOVE LOW-VALUES         TO  ERREIN-KEY
 13629         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13630         MOVE REINCDI            TO  REIN-CODE-1
 13631                                     REIN-CODE-2
 13632                                     REIN-CODE-3
 13633         MOVE 'A'                TO  REIN-TYPE
 13634         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13635         IF REIN-REC-NOT-FOUND
 13636             MOVE ER-0266        TO  EMI-ERROR
 13637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13638             MOVE -1             TO  REINCDL
 13639             MOVE AL-UABON       TO  REINCDA
 13640         ELSE
 13641             MOVE AL-UANON       TO  REINCDA
 13642         END-IF
 13643     END-IF.
 13644
 13645     IF CERTMTI NOT = 'A'
 13646        GO TO 6200-EXIT
 13647     END-IF.
 13648
 13649     IF PREMTYPI = '1'
 13650         IF LCVCDL GREATER ZERO
 13651             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13652                 MOVE ER-0841        TO  EMI-ERROR
 13653                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13654                 MOVE -1             TO  PREMTYPL
 13655                 MOVE AL-UABON       TO  PREMTYPA
 13656             END-IF
 13657         END-IF
 13658     END-IF.
 13659
 13660     IF PREMTYPI = '1'
 13661         IF ACVCDL GREATER ZERO
 13662             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13663                 MOVE ER-0841        TO  EMI-ERROR
 13664                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13665                 MOVE -1             TO  PREMTYPL
 13666                 MOVE AL-UABON       TO  PREMTYPA
 13667             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 256
* EL130.cbl
 13668         END-IF
 13669     END-IF.
 13670
 13671     IF PREMTYPI = '2'
 13672         IF LCVCDL GREATER ZERO
 13673             IF (PI-COMPANY-ID = 'HAN') AND
 13674                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13675                        OR
 13676                 WS-LF-SPECIAL-CALC-CD = 'O'
 13677*                NEXT SENTENCE
 13678                 CONTINUE
 13679             ELSE
 13680                 MOVE ER-0840        TO  EMI-ERROR
 13681                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13682                 MOVE -1             TO  PREMTYPL
 13683                 MOVE AL-UABON       TO  PREMTYPA
 13684             END-IF
 13685         END-IF
 13686     END-IF.
 13687
 13688     IF PREMTYPI = '2'
 13689         IF ACVCDL GREATER ZERO
 13690             IF (PI-COMPANY-ID = 'HAN')  AND
 13691                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13692                        OR
 13693                 WS-AH-SPECIAL-CALC-CD = 'O'
 13694*                NEXT SENTENCE
 13695                 CONTINUE
 13696             ELSE
 13697                 MOVE ER-0840        TO  EMI-ERROR
 13698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13699                 MOVE -1             TO  PREMTYPL
 13700                 MOVE AL-UABON       TO  PREMTYPA
 13701             END-IF
 13702         END-IF
 13703     END-IF.
 13704
 13705     IF LCVCDL = ZEROS
 13706        GO TO 6200-EXIT
 13707     END-IF.
 13708
 13709     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13710         IF PMTFREQI NOT = ZEROS
 13711             MOVE ER-0428        TO EMI-ERROR
 13712             MOVE -1             TO PMTFREQL
 13713             MOVE AL-UNBON       TO PMTFREQA
 13714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13715             GO TO 6200-CHECK-APR
 13716         END-IF
 13717     END-IF.
 13718
 13719     IF PMTFREQL = ZEROS AND TEX-REG
 13720         MOVE ER-0429            TO EMI-ERROR
 13721         MOVE -1                 TO PMTFREQL
 13722         MOVE AL-UNBON           TO PMTFREQA
 13723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13724         GO TO 6200-CHECK-APR
 13725     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 257
* EL130.cbl
 13726
 13727     IF LCVOTRMI NOT NUMERIC
 13728         GO TO 6200-CHECK-APR
 13729     END-IF.
 13730
 13731     IF WS-PMTFREQ NOT = ZERO
 13732         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13733         GIVING DIVIDE-QUOT
 13734         REMAINDER DIVIDE-REM
 13735         IF DIVIDE-REM GREATER ZERO
 13736             MOVE ER-0430            TO EMI-ERROR
 13737             MOVE -1                 TO PMTFREQL
 13738             MOVE AL-UNBON           TO PMTFREQA
 13739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13740         END-IF
 13741     END-IF.
 13742
 13743 6200-CHECK-APR.
 13744     IF NET-PAY AND APRL = ZEROS
 13745        MOVE ER-0257             TO EMI-ERROR
 13746        MOVE -1                  TO APRL
 13747        MOVE AL-UABON            TO APRA
 13748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13749     END-IF.
 13750
 13751 6200-EXIT.
 13752     EXIT.
 13753
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 258
* EL130.cbl
 13755 6300-REQUIRED-CERT-EDIT.
 13756
 13757     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13758        GO TO 6300-REQUIRED-AH-EDIT
 13759     END-IF
 13760
 13761     IF LCVCDL = ZERO
 13762        MOVE ER-7639             TO EMI-ERROR
 13763        MOVE -1                  TO LCVCDL
 13764        MOVE AL-UABON            TO LCVCDA
 13765        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13766     END-IF.
 13767
 13768     IF LCVOTRML = ZERO
 13769        MOVE ER-7670             TO EMI-ERROR
 13770        MOVE -1                  TO LCVOTRML
 13771        MOVE AL-UNBON            TO LCVOTRMA
 13772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13773     END-IF.
 13774
 13775     IF LCVBENEL = ZERO
 13776        MOVE ER-7671             TO EMI-ERROR
 13777        MOVE -1                  TO LCVBENEL
 13778        MOVE AL-UNBON            TO LCVBENEA
 13779        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13780     END-IF.
 13781
 13782     GO TO 6399-EXIT.
 13783
 13784 6300-REQUIRED-AH-EDIT.
 13785
 13786     IF ACVCDL = ZERO
 13787        MOVE ER-7639             TO EMI-ERROR
 13788        MOVE -1                  TO ACVCDL
 13789        MOVE AL-UABON            TO ACVCDA
 13790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13791     END-IF.
 13792
 13793     IF ACVOTRML = ZERO
 13794         MOVE ER-7670             TO EMI-ERROR
 13795         MOVE -1                  TO ACVOTRML
 13796         MOVE AL-UNBON            TO ACVOTRMA
 13797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13798     END-IF.
 13799
 13800     IF ACVBENEL = ZERO
 13801        MOVE ER-7671             TO EMI-ERROR
 13802        MOVE -1                  TO ACVBENEL
 13803        MOVE AL-UNBON            TO ACVBENEA
 13804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805     END-IF.
 13806
 13807 6399-EXIT.
 13808      EXIT.
 13809
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 259
* EL130.cbl
 13811 6400-TEST-CLAIM-REASONABILITY.
 13812
 13813     IF WS-INCUR = LOW-VALUES
 13814        GO TO 6499-EXIT
 13815     END-IF.
 13816
 13817     IF WS-EFFDT NOT = LOW-VALUES
 13818         IF WS-INCUR LESS WS-EFFDT
 13819             MOVE ER-0458          TO EMI-ERROR
 13820             MOVE -1               TO INCURL
 13821             MOVE AL-UABON         TO INCURA
 13822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13823         END-IF
 13824     END-IF.
 13825
 13826     IF CERTMTI = 'A'
 13827        GO TO 6460-TEST-NEW-CERT
 13828     END-IF.
 13829
 13830     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13831     MOVE CRTCARRI               TO CERT-CARRIER.
 13832     MOVE GROUPI                 TO CERT-GROUPING.
 13833     MOVE STATEI                 TO CERT-STATE.
 13834     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13835     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13836     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13837
 13838
 13839
 13840* EXEC CICS HANDLE CONDITION
 13841*         DUPKEY   (6499-EXIT)
 13842*         NOTFND   (6499-EXIT)
 13843*    END-EXEC.
 13844*    MOVE '"$$I                  ! B #00012570' TO DFHEIV0
 13845     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13847     MOVE X'4220233030303132353730' TO DFHEIV0(25:11)
 13848     CALL 'kxdfhei1' USING DFHEIV0
 13849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13850
 13851
 13852     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13853
 13854     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13855        'I' OR 'G' OR 'F')
 13856        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13857     ELSE
 13858        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13859     END-IF.
 13860
 13861     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13862     MOVE '6'                    TO DC-OPTION-CODE.
 13863     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13864
 13865     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 13866        MOVE ER-0519             TO EMI-ERROR
 13867        MOVE -1                  TO INCURL
 13868        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 260
* EL130.cbl
 13869        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13870     END-IF.
 13871
 13872     IF CLMCARRI NOT = CRTCARRI
 13873        MOVE ER-0562             TO EMI-ERROR
 13874        MOVE AL-UABON            TO CLMCARRA
 13875        MOVE -1                  TO CLMCARRL
 13876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13877     END-IF.
 13878
 13879     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13880         OR 'F') AND
 13881        CM-AH-BENEFIT-CD = '00')
 13882                  OR
 13883        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13884        CM-LF-BENEFIT-CD = '00')
 13885         MOVE ER-0521         TO EMI-ERROR
 13886         MOVE AL-UABON        TO CLMTYPEA
 13887         MOVE -1              TO CLMTYPEL
 13888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889     END-IF.
 13890*    IF CLMTYPEI = 'I' AND
 13891*       CM-AH-CRITICAL-PERIOD = +0
 13892*        MOVE ER-0521         TO EMI-ERROR
 13893*        MOVE AL-UABON        TO CLMTYPEA
 13894*        MOVE -1              TO CLMTYPEL
 13895*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13896*    END-IF
 13897
 13898*    IF PI-COMPANY-ID = 'CRI'
 13899*        IF MAINTI = 'A'
 13900*            IF CERT-PEND-ISSUE-ERROR  OR
 13901*               CERT-PEND-ISSUE-RETURNED
 13902*                MOVE -1                 TO CERTNOL
 13903*                MOVE AL-UABON           TO CERTNOA
 13904*                MOVE ER-7640            TO EMI-ERROR
 13905*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13906*            END-IF
 13907*        END-IF
 13908*    END-IF.
 13909
 13910     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13911         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 13912         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13913             GO TO 6450-DATE-ERROR
 13914         END-IF
 13915     END-IF.
 13916
 13917     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13918         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13919         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13920             GO TO 6450-DATE-ERROR
 13921         END-IF
 13922     END-IF.
 13923
 13924     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13925         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13926             GO TO 6450-DATE-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 261
* EL130.cbl
 13927         END-IF
 13928     END-IF.
 13929
 13930     GO TO 6499-EXIT.
 13931
 13932 6450-DATE-ERROR.
 13933     MOVE ER-0520                TO EMI-ERROR.
 13934     MOVE -1                     TO INCURL.
 13935     MOVE AL-UABON               TO INCURA.
 13936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13937
 13938*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13939*       (EMI-SEVERITY-SAVE = 'X')
 13940*        ADD 1                TO EMI-FORCABLE-CTR
 13941*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13942*    END-IF.
 13943
 13944     GO TO 6499-EXIT.
 13945
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 262
* EL130.cbl
 13947 6460-TEST-NEW-CERT.
 13948
 13949     IF NOT EMI-NO-ERRORS
 13950        GO TO 6499-EXIT
 13951     END-IF.
 13952
 13953     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13954
 13955     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13956          OR 'F') AND
 13957         ACVOTRML GREATER ZERO)
 13958        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13959     END-IF.
 13960
 13961     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13962         LCVOTRML GREATER ZERO
 13963        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13964     END-IF.
 13965
 13966     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13967
 13968*    IF PI-COMPANY-ID = 'HAN'
 13969*        IF ADDONDTL GREATER ZERO
 13970*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13971*            IF CLMTYPEI = 'A'
 13972*                IF ACVOTRMI NOT = ZEROS
 13973*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13974*                ELSE
 13975*                    NEXT SENTENCE
 13976*                    CONTINUE
 13977*                END-IF
 13978*            ELSE
 13979*                IF LCVOTRMI NOT = ZEROS
 13980*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13981*                END-IF
 13982*            END-IF
 13983*        END-IF
 13984*    END-IF.
 13985
 13986     MOVE '6'                    TO DC-OPTION-CODE.
 13987     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13988
 13989     IF NO-CONVERSION-ERROR
 13990         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13991     END-IF.
 13992
 13993     IF WS-INCUR GREATER THAN WS-EXPIRE
 13994        MOVE ER-0519             TO EMI-ERROR
 13995        MOVE -1                  TO INCURL
 13996        MOVE AL-UABON            TO INCURA
 13997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998     END-IF.
 13999
 14000     IF CLMCARRI NOT = CRTCARRI
 14001        MOVE ER-0562             TO EMI-ERROR
 14002        MOVE AL-UABON            TO CLMCARRA
 14003        MOVE -1                  TO CLMCARRL
 14004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 263
* EL130.cbl
 14005     END-IF.
 14006
 14007     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14008          OR 'F') AND
 14009         ACVCDL = ZEROS)
 14010             MOVE ER-0521        TO EMI-ERROR
 14011             MOVE AL-UABON       TO CLMTYPEA
 14012             MOVE -1             TO CLMTYPEL
 14013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14014     END-IF.
 14015
 14016     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14017         LCVCDL = ZEROS
 14018             MOVE ER-0521        TO EMI-ERROR
 14019             MOVE AL-UABON       TO CLMTYPEA
 14020             MOVE -1             TO CLMTYPEL
 14021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14022     END-IF.
 14023
 14024     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14025         IF LCVCNDTL GREATER ZERO
 14026             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14027                 GO TO 6450-DATE-ERROR
 14028             END-IF
 14029         END-IF
 14030     END-IF.
 14031
 14032     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14033         IF ACVCNDTL GREATER ZERO
 14034             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14035                 GO TO 6450-DATE-ERROR
 14036             END-IF
 14037         END-IF
 14038     END-IF.
 14039
 14040 6499-EXIT.
 14041     EXIT.
 14042 6500-get-acct.
 14043
 14044     MOVE SPACES                 TO ERACCT-KEY
 14045                                    ws-dcc-product-code
 14046                                    ws-acct-found-sw
 14047
 14048     IF CARR-GROUP-ST-ACCNT-CNTL
 14049        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14050        MOVE CRTCARRI            TO ACCT-CARRIER
 14051        MOVE GROUPI              TO ACCT-GROUPING
 14052        MOVE STATEI              TO ACCT-STATE
 14053        MOVE ACCOUNTI            TO ACCT-ACCOUNT
 14054        GO TO 6500-startbr
 14055     END-IF
 14056
 14057     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14058     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14059
 14060     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14061        MOVE STATEI             TO ACCT-STATE
 14062     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 264
* EL130.cbl
 14063
 14064     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14065        MOVE CRTCARRI           TO ACCT-CARRIER
 14066     END-IF
 14067
 14068     .
 14069 6500-startbr.
 14070
 14071     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14072
 14073
 14074* EXEC CICS STARTBR
 14075*       DATASET     (ERACCT2-DSID)
 14076*       RIDFLD      (SAVE-ERACCT-KEY)
 14077*       GENERIC
 14078*       KEYLENGTH   (20)
 14079*       resp        (ws-response)
 14080*    END-EXEC
 14081     MOVE 20
 14082       TO DFHEIV11
 14083     MOVE 0
 14084       TO DFHEIV12
 14085*    MOVE '&,   KG    G          &  N#00012796' TO DFHEIV0
 14086     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14088     MOVE X'204E233030303132373936' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
 14090           ERACCT2-DSID,
 14091           SAVE-ERACCT-KEY,
 14092           DFHEIV11,
 14093           DFHEIV12,
 14094           DFHEIV99
 14095     MOVE EIBRESP  TO ws-response
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14097
 14098     if not ws-resp-normal
 14099        go to 6500-exit
 14100     end-if
 14101
 14102     .
 14103 6500-readnext.
 14104
 14105
 14106* EXEC CICS READNEXT
 14107*       DATASET   (ERACCT2-DSID)
 14108*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14109*       RIDFLD    (SAVE-ERACCT-KEY)
 14110*    END-EXEC
 14111     MOVE 0
 14112       TO DFHEIV11
 14113*    MOVE '&.S                   )   #00012811' TO DFHEIV0
 14114     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14115     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14116     MOVE X'2020233030303132383131' TO DFHEIV0(25:11)
 14117     CALL 'kxdfhei1' USING DFHEIV0,
 14118           ERACCT2-DSID,
 14119           DFHEIV20,
 14120           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 265
* EL130.cbl
 14121           SAVE-ERACCT-KEY,
 14122           DFHEIV99,
 14123           DFHEIV11,
 14124           DFHEIV99,
 14125           DFHEIV99
 14126     SET ADDRESS OF ACCOUNT-MASTER TO
 14127         DFHEIV20
 14128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14129
 14130     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14131        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14132        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14133        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14134        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14135        go to 6500-endbr
 14136     END-IF
 14137
 14138     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14139        and (WS-EFFDT < AM-EXPIRATION-DT)
 14140        set acct-found to true
 14141        MOVE AM-dcc-product-code to ws-dcc-product-code
 14142        GO TO 6500-endbr
 14143     END-IF
 14144
 14145     IF WS-EFFDT >= AM-EXPIRATION-DT
 14146         GO TO 6500-readnext
 14147     END-IF
 14148
 14149     .
 14150 6500-endbr.
 14151
 14152
 14153* EXEC CICS ENDBR
 14154*        DATASET    (ERACCT2-DSID)
 14155*    END-EXEC
 14156     MOVE 0
 14157       TO DFHEIV11
 14158*    MOVE '&2                    $   #00012839' TO DFHEIV0
 14159     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14160     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14161     MOVE X'2020233030303132383339' TO DFHEIV0(25:11)
 14162     CALL 'kxdfhei1' USING DFHEIV0,
 14163           ERACCT2-DSID,
 14164           DFHEIV11,
 14165           DFHEIV99
 14166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14167
 14168     .
 14169 6500-exit.
 14170     exit.
 14171 6600-CHECK-AUTO-ACTIVITY.
 14172
 14173
 14174* EXEC CICS HANDLE CONDITION
 14175*        NOTFND   (6600-NOT-FOUND)
 14176*    END-EXEC.
 14177*    MOVE '"$I                   ! C #00012848' TO DFHEIV0
 14178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 266
* EL130.cbl
 14179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14180     MOVE X'4320233030303132383438' TO DFHEIV0(25:11)
 14181     CALL 'kxdfhei1' USING DFHEIV0
 14182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14183
 14184
 14185     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14186     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14187     MOVE SPACES                     TO  CNTL-ACCESS.
 14188     MOVE +0                         TO  CNTL-SEQ-NO.
 14189
 14190     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14191
 14192     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14193         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14194                                         WS-LETTER-SW
 14195         GO TO 6600-EXIT
 14196     END-IF.
 14197
 14198     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14199         MOVE 'N'                     TO  WS-LETTER-SW
 14200     ELSE
 14201         MOVE 'Y'                     TO  WS-LETTER-SW
 14202     END-IF.
 14203
 14204     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14205     GO TO 6600-EXIT.
 14206
 14207 6600-START-AUTO-LETTER-WRITER.
 14208
 14209     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14210     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14211
 14212     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14213
 14214     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14215         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14216         MOVE '6'                     TO  DC-OPTION-CODE
 14217         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14218         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14219         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14220         IF NO-CONVERSION-ERROR
 14221             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14222         ELSE
 14223             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14224         END-IF
 14225     END-IF.
 14226
 14227     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 14228         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14229         MOVE '6'                     TO  DC-OPTION-CODE
 14230         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14231         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14232         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14233         IF NO-CONVERSION-ERROR
 14234             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14235         ELSE
 14236             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 267
* EL130.cbl
 14237         END-IF
 14238     END-IF.
 14239
 14240
 14241
 14242* EXEC CICS LINK
 14243*        PROGRAM    (LINK-1523)
 14244*        COMMAREA   (W-1523-LINKDATA)
 14245*        LENGTH     (W-1523-COMM-LENGTH)
 14246*    END-EXEC.
 14247*    MOVE '."C                   (   #00012908' TO DFHEIV0
 14248     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14250     MOVE X'2020233030303132393038' TO DFHEIV0(25:11)
 14251     CALL 'kxdfhei1' USING DFHEIV0,
 14252           LINK-1523,
 14253           W-1523-LINKDATA,
 14254           W-1523-COMM-LENGTH,
 14255           DFHEIV99,
 14256           DFHEIV99,
 14257           DFHEIV99,
 14258           DFHEIV99
 14259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14260
 14261
 14262     GO TO 6600-EXIT.
 14263
 14264 6600-NOT-FOUND.
 14265     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14266
 14267 6600-EXIT.
 14268     EXIT.
 14269
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 268
* EL130.cbl
 14270/
 14271*************************************************************
 14272*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14273*************************************************************
 14274
 14275 6700-OUTPUT-ACTIVITY-RECORD.
 14276
 14277
 14278
 14279* EXEC CICS GETMAIN
 14280*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14281*        LENGTH (DLYACTV-LENGTH)
 14282*        INITIMG (WS-BLANK)
 14283*    END-EXEC.
 14284*    MOVE ',"IL                  $   #00012930' TO DFHEIV0
 14285     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14287     MOVE X'2020233030303132393330' TO DFHEIV0(25:11)
 14288     CALL 'kxdfhei1' USING DFHEIV0,
 14289           DFHEIV20,
 14290           DLYACTV-LENGTH,
 14291           WS-BLANK
 14292     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14293         DFHEIV20
 14294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14295
 14296
 14297     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14298     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14299     MOVE CLMCARRI               TO DA-CARRIER.
 14300     IF CLMNOL EQUAL ZERO
 14301         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14302     ELSE
 14303         MOVE CLMNOI             TO DA-CLAIM-NO
 14304     END-IF.
 14305     MOVE CERTNOI                TO DA-CERT-PRIME.
 14306     MOVE SUFXI                  TO DA-CERT-SFX.
 14307     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14308     MOVE 'A'                    TO DA-RECORD-TYPE.
 14309
 14310
 14311* EXEC CICS HANDLE CONDITION
 14312*        NOTOPEN (6700-NOTOPEN-ERROR)
 14313*        DUPREC (6700-EXIT)
 14314*    END-EXEC.
 14315*    MOVE '"$J%                  ! D #00012949' TO DFHEIV0
 14316     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14318     MOVE X'4420233030303132393439' TO DFHEIV0(25:11)
 14319     CALL 'kxdfhei1' USING DFHEIV0
 14320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14321
 14322
 14323
 14324* EXEC CICS WRITE
 14325*        DATASET (DLYACTV-DSID)
 14326*        RIDFLD (DA-KEY)
 14327*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 269
* EL130.cbl
 14328*        LENGTH (DLYACTV-LENGTH)
 14329*    END-EXEC.
 14330*    MOVE '&$ L                  ''   #00012954' TO DFHEIV0
 14331     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14332     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14333     MOVE X'2020233030303132393534' TO DFHEIV0(25:11)
 14334     CALL 'kxdfhei1' USING DFHEIV0,
 14335           DLYACTV-DSID,
 14336           DAILY-ACTIVITY-RECORD,
 14337           DLYACTV-LENGTH,
 14338           DA-KEY,
 14339           DFHEIV99,
 14340           DFHEIV99
 14341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14342
 14343     GO TO 6700-EXIT.
 14344
 14345 6700-NOTOPEN-ERROR.
 14346     MOVE '2955'                 TO EMI-ERROR.
 14347     MOVE -1                     TO MAINTL.
 14348     MOVE AL-UANON               TO MAINTA.
 14349     PERFORM 9900-ERROR-FORMAT THRU
 14350             9900-EXIT.
 14351     GO TO 8200-SEND-DATAONLY.
 14352
 14353 6700-EXIT.
 14354     EXIT.
 14355
 14356*************************************************************
 14357*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14358*************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 270
* EL130.cbl
 14359/
 14360 6990-DEEDIT-DATE.
 14361
 14362
 14363* EXEC CICS BIF DEEDIT
 14364*        FIELD   (DATE-WORK)
 14365*        LENGTH  (8)
 14366*    END-EXEC.
 14367     MOVE 8
 14368       TO DFHEIV11
 14369*    MOVE '@"L                   #   #00012979' TO DFHEIV0
 14370     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14371     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14372     MOVE X'2020233030303132393739' TO DFHEIV0(25:11)
 14373     CALL 'kxdfhei1' USING DFHEIV0,
 14374           DATE-WORK,
 14375           DFHEIV11
 14376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14377
 14378 6990-EXIT.
 14379     EXIT.
 14380
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 271
* EL130.cbl
 14382 7000-BUILD-OUTPUT-MAP.
 14383
 14384     IF CLAIM-SWITCH = 'N'
 14385         GO TO 7050-BUILD-MAP-CERT-DATA
 14386     END-IF.
 14387
 14388     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14389         MOVE SPACES                 TO SEQUO
 14390         MOVE AL-SABOF               TO SEQUA
 14391     ELSE
 14392         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14393         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14394         MOVE WS-CLAIM-SEQU          TO SEQUO
 14395         MOVE AL-SABON               TO SEQUA
 14396     END-IF.
 14397
 14398     MOVE CL-CARRIER             TO CLMCARRO.
 14399     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14400     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14401     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14402     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14403     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14404     MOVE CL-INSURED-MID-INIT    TO INITO.
 14405     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14406     move cl-insured-type        to instypeo
 14407*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14408
 14409     MOVE AL-UANON               TO CLMCARRA
 14410                                    CLMTYPEA
 14411                                    PCERTNOA
 14412                                    PSUFXA
 14413                                    LSTNMEA
 14414                                    FSTNMEA
 14415                                    INITA
 14416                                    SEXA
 14417
 14418     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14419
 14420     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14421         MOVE ' '                 TO DC-OPTION-CODE
 14422         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14423         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14424         IF NOT DATE-CONVERSION-ERROR
 14425             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14426             MOVE AL-UANON            TO BIRTHDTA
 14427         END-IF
 14428     END-IF.
 14429
 14430     MOVE CL-SOC-SEC-NO          TO SSNO.
 14431     MOVE AL-UANON               TO SSNA.
 14432
 14433     IF CL-INCURRED-DT NOT = LOW-VALUES
 14434         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14435         MOVE ' '                TO DC-OPTION-CODE
 14436         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14437         IF NOT DATE-CONVERSION-ERROR
 14438             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14439             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 272
* EL130.cbl
 14440         END-IF
 14441     END-IF.
 14442
 14443     IF CL-REPORTED-DT NOT = LOW-VALUES
 14444         MOVE ' '                TO DC-OPTION-CODE
 14445         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14446         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14447         IF NOT DATE-CONVERSION-ERROR
 14448             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14449             MOVE AL-UANON            TO REPORTA
 14450         END-IF
 14451     END-IF.
 14452
 14453*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14454*        MOVE ' '                 TO DC-OPTION-CODE
 14455*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14456*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14457*        IF NOT DATE-CONVERSION-ERROR
 14458*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14459*            MOVE AL-UANON            TO ESTENDA
 14460*        END-IF
 14461*    END-IF.
 14462
 14463     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14464     MOVE WS-ICD-CODE-1          TO ICD1O.
 14465     MOVE WS-ICD-CODE-2          TO ICD2O.
 14466*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14467     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14468     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14469     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14470     MOVE CL-PRIORITY-CD         TO PRICDO.
 14471     MOVE AL-UANON               TO DIAGA
 14472                                    ICD1A
 14473                                    ICD2A
 14474*                                   CAUSEA
 14475                                    RELCLMA
 14476                                    PROCCDA
 14477                                    PRICDA.
 14478     MOVE AL-UNNON               TO MANRSVA.
 14479
 14480*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14481*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14482*        MOVE AL-UANON               TO PRODCDA
 14483*    END-IF.
 14484
 14485     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14486     MOVE CL-FILE-LOCATION       TO FILETOO.
 14487     MOVE CL-BENEFICIARY         TO BENECDO.
 14488     MOVE AL-UANON               TO SUPVA
 14489                                    FILETOA
 14490                                    BENECDA.
 14491
 14492     IF CLAIM-SWITCH = 'X'
 14493         GO TO 7099-EXIT
 14494     END-IF.
 14495
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 273
* EL130.cbl
 14497 7050-BUILD-MAP-CERT-DATA.
 14498     MOVE CM-CERT-PRIME          TO CERTNOO.
 14499     MOVE CM-CERT-SFX            TO SUFXO.
 14500     MOVE AL-SANON               TO CERTNOA
 14501                                    SUFXA.
 14502
 14503     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14504         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14505         MOVE ' '                TO DC-OPTION-CODE
 14506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14507         IF NOT DATE-CONVERSION-ERROR
 14508             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14509         END-IF
 14510     END-IF.
 14511
 14512     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14513     MOVE CM-STATE               TO STATEO.
 14514     MOVE CM-CARRIER             TO CRTCARRO.
 14515     MOVE CM-GROUPING            TO GROUPO.
 14516     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14517     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14518     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14519     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14520     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14521     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14522     MOVE CM-JT-INITIAL          TO JNTINITO.
 14523     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14524     MOVE AL-UANON               TO ACCOUNTA
 14525                                    STATEA
 14526                                    CRTCARRA
 14527                                    GROUPA
 14528                                    CRTLNMEA
 14529                                    CRTFNMEA
 14530                                    CRTINITA
 14531                                    JNTLNMEA
 14532                                    JNTFNMEA
 14533                                    JNTINITA.
 14534     MOVE AL-UNNON               TO ISSAGEA
 14535                                    JNTAGEA.
 14536
 14537     IF CM-SSN-STATE   = CM-STATE AND
 14538        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14539*        NEXT SENTENCE
 14540         CONTINUE
 14541     ELSE
 14542         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14543     END-IF.
 14544
 14545     MOVE AL-UANON               TO CRTSSNA.
 14546
 14547     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14548     MOVE '2'                    TO DC-OPTION-CODE.
 14549     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14550     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14551
 14552*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14553     MOVE SPACES                 TO ELCNTL-KEY.
 14554     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 274
* EL130.cbl
 14555     MOVE '3'                    TO CNTL-REC-TYPE.
 14556     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14557     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14558
 14559
 14560
 14561* EXEC CICS READ
 14562*        DATASET  (ELCNTL-DSID)
 14563*        SET      (ADDRESS OF CONTROL-FILE)
 14564*        RIDFLD   (ELCNTL-KEY)
 14565*        RESP     (WS-RESPONSE)
 14566*    END-EXEC.
 14567*    MOVE '&"S        E          (  N#00013165' TO DFHEIV0
 14568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14570     MOVE X'204E233030303133313635' TO DFHEIV0(25:11)
 14571     CALL 'kxdfhei1' USING DFHEIV0,
 14572           ELCNTL-DSID,
 14573           DFHEIV20,
 14574           DFHEIV99,
 14575           ELCNTL-KEY,
 14576           DFHEIV99,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     SET ADDRESS OF CONTROL-FILE TO
 14580         DFHEIV20
 14581     MOVE EIBRESP  TO WS-RESPONSE
 14582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14583
 14584
 14585     IF WS-RESP-NOTFND
 14586          MOVE ER-2848           TO EMI-ERROR
 14587          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14588          GO TO 8100-SEND-INITIAL-MAP
 14589     END-IF.
 14590
 14591     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14592     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14593     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 275
* EL130.cbl
 14595     IF CM-LF-BENEFIT-CD = '00'
 14596         MOVE ZEROS              TO LCVOTRMO
 14597                                    LCVRTRMO
 14598                                    LCVRATEO
 14599                                    LCVBENEO
 14600         MOVE SPACES             TO LCVDSCRO
 14601                                    LCVCDO
 14602                                    LCVKINDO
 14603                                    LCVFORMO
 14604                                    LCVCNDTO
 14605                                    LCVEXITO
 14606                                    LCVSTATO
 14607         IF CLMTYPEL GREATER THAN ZERO AND
 14608            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14609                MOVE ER-0521     TO EMI-ERROR
 14610                MOVE AL-UABON    TO CLMTYPEA
 14611                MOVE -1          TO CLMTYPEL
 14612                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14613                GO TO 7060-FILL-AH-COVERAGE
 14614         ELSE
 14615             GO TO 7060-FILL-AH-COVERAGE
 14616         END-IF
 14617     END-IF.
 14618
 14619     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14620     MOVE AL-UANON               TO LCVDSCRA.
 14621     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14622     MOVE '4'                    TO WS-REC-TYPE.
 14623     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14624     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14625     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14626     MOVE AL-UANON               TO LCVCDA.
 14627     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14628                                    CP-ORIGINAL-TERM.
 14629     MOVE AL-UNNON               TO LCVOTRMA.
 14630     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14631     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14632     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14633     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14634     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14635     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14636
 14637     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14638     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14639
 14640     IF CM-LF-PREMIUM-RATE NUMERIC
 14641         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14642     ELSE
 14643         MOVE ZEROS              TO LCVRATEO
 14644     END-IF.
 14645
 14646     MOVE AL-UNNON               TO LCVRATEA.
 14647
 14648     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14649         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14650     END-IF.
 14651
 14652     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 276
* EL130.cbl
 14653
 14654     MOVE AL-UNNON               TO LCVBENEA.
 14655
 14656     IF CM-POLICY-FORM-NO NOT = SPACES
 14657         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14658     ELSE
 14659         MOVE WS-FORM-HOLD       TO LCVFORMO
 14660     END-IF.
 14661
 14662     MOVE SPACES                 TO WS-FORM-HOLD.
 14663     MOVE 'L'                    TO WS-REC-TYPE.
 14664     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14665
 14666     IF WS-FORM-HOLD NOT = SPACES
 14667         MOVE WS-FORM-HOLD       TO LCVFORMO
 14668         MOVE AL-UANON           TO LCVFORMA
 14669     END-IF.
 14670
 14671     IF CM-LF-CURRENT-STATUS = '8'
 14672         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14673             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14674             MOVE ' '             TO DC-OPTION-CODE
 14675             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14676             IF NOT DATE-CONVERSION-ERROR
 14677                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14678                 MOVE AL-UANON            TO LCVCNDTA
 14679             END-IF
 14680         END-IF
 14681     END-IF.
 14682
 14683     IF CM-LF-CURRENT-STATUS = '7'
 14684         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14685             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14686             MOVE ' '            TO DC-OPTION-CODE
 14687             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14688             IF NOT DATE-CONVERSION-ERROR
 14689                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14690                 MOVE AL-UANON   TO LCVCNDTA
 14691             END-IF
 14692         END-IF
 14693     END-IF.
 14694
 14695     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14696         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14697             MOVE ' '            TO DC-OPTION-CODE
 14698             MOVE CM-LF-DEATH-EXIT-DT
 14699                                 TO DC-BIN-DATE-1
 14700             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14701             IF NOT DATE-CONVERSION-ERROR
 14702                 MOVE DC-GREG-DATE-1-EDIT
 14703                                 TO LCVEXITO
 14704             END-IF
 14705         END-IF
 14706     END-IF.
 14707
 14708     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14709         IF CP-REMAINING-TERM-3 = ZEROS
 14710             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 277
* EL130.cbl
 14711         ELSE
 14712             MOVE 'ACTIVE'       TO LCVSTATO
 14713         END-IF
 14714     END-IF.
 14715
 14716     IF CM-LF-CURRENT-STATUS = '2'
 14717        MOVE 'PEND  '            TO LCVSTATO
 14718     END-IF.
 14719     IF CM-LF-CURRENT-STATUS = '3'
 14720        MOVE 'RESTORE'           TO LCVSTATO
 14721     END-IF.
 14722     IF CM-LF-CURRENT-STATUS = '5'
 14723        MOVE 'REISSUE'           TO LCVSTATO
 14724     END-IF.
 14725     IF CM-LF-CURRENT-STATUS = '6'
 14726        MOVE 'LMP DIS'           TO LCVSTATO
 14727     END-IF.
 14728     IF CM-LF-CURRENT-STATUS = '7'
 14729        MOVE 'DEATH  '           TO LCVSTATO
 14730     END-IF.
 14731     IF CM-LF-CURRENT-STATUS = '8'
 14732        MOVE 'CANCEL '           TO LCVSTATO
 14733     END-IF.
 14734     IF CM-LF-CURRENT-STATUS = '9'
 14735        MOVE 'RE-ONLY'           TO LCVSTATO
 14736     END-IF.
 14737     IF CM-LF-CURRENT-STATUS = 'V'
 14738        MOVE 'VOID   '           TO LCVSTATO
 14739     END-IF.
 14740     IF CM-LF-CURRENT-STATUS = 'D'
 14741        MOVE 'DECLINE'           TO LCVSTATO
 14742     END-IF.
 14743
 14744     IF PI-COMPANY-ID = 'CID'
 14745         IF CM-LF-BENEFIT-CD >= '2O' AND
 14746            CM-LF-BENEFIT-CD <= '2V'
 14747             MOVE ER-0878       TO EMI-ERROR
 14748             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14749         END-IF
 14750     END-IF.
 14751
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 278
* EL130.cbl
 14753 7060-FILL-AH-COVERAGE.
 14754
 14755     IF CM-AH-BENEFIT-CD = '00'
 14756         MOVE ZEROS              TO ACVOTRMO
 14757                                    ACVRTRMO
 14758                                    ACVRATEO
 14759                                    ACVBENEO
 14760         MOVE SPACES             TO ACVDSCRO
 14761                                    ACVCDO
 14762                                    ACVKINDO
 14763                                    ACVFORMO
 14764                                    ACVCNDTO
 14765                                    ACVEXITO
 14766                                    ACVSTATO
 14767         IF (CLMTYPEL GREATER THAN ZERO AND
 14768          (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14769             MOVE ER-0521     TO EMI-ERROR
 14770             MOVE AL-UABON    TO CLMTYPEA
 14771             MOVE -1          TO CLMTYPEL
 14772             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14773             GO TO 7070-BUILD-MAP-FINISH
 14774         ELSE
 14775             GO TO 7070-BUILD-MAP-FINISH
 14776         END-IF
 14777     END-IF.
 14778
 14779     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14780     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14781     MOVE AL-UANON               TO ACVDSCRA
 14782                                    ACVCDA.
 14783     MOVE '5'                    TO WS-REC-TYPE.
 14784     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14785     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14786
 14787     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14788                                    CP-ORIGINAL-TERM.
 14789     MOVE AL-UNNON               TO ACVOTRMA.
 14790
 14791     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14792     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14793     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14794     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14795     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14796     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14797
 14798     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14799     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14800
 14801     IF CM-AH-PREMIUM-RATE NUMERIC
 14802         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14803     ELSE
 14804         MOVE ZEROS              TO ACVRATEO
 14805     END-IF.
 14806
 14807     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14808     MOVE AL-UNNON               TO ACVRATEA
 14809                                    ACVBENEA.
 14810
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 279
* EL130.cbl
 14811     IF CM-POLICY-FORM-NO NOT = SPACES
 14812         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14813     ELSE
 14814         MOVE WS-FORM-HOLD       TO ACVFORMO
 14815         MOVE SPACES TO WS-FORM-HOLD
 14816         MOVE 'A'                TO WS-REC-TYPE
 14817         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14818         IF WS-FORM-HOLD NOT = SPACES
 14819             MOVE WS-FORM-HOLD   TO ACVFORMO
 14820         END-IF
 14821     END-IF.
 14822
 14823     MOVE AL-UANON               TO ACVFORMA.
 14824
 14825     IF CM-AH-CURRENT-STATUS = '8'
 14826         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14827             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14828             MOVE ' '             TO DC-OPTION-CODE
 14829             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14830             IF NOT DATE-CONVERSION-ERROR
 14831                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14832                MOVE AL-UANON    TO ACVCNDTA
 14833             END-IF
 14834         END-IF
 14835     END-IF.
 14836
 14837     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14838         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14839             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14840             MOVE ' '             TO DC-OPTION-CODE
 14841             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14842             IF NOT DATE-CONVERSION-ERROR
 14843                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14844                MOVE AL-UANON            TO ACVCNDTA
 14845             END-IF
 14846         END-IF
 14847     END-IF.
 14848
 14849     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14850         MOVE ' '                TO DC-OPTION-CODE
 14851         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14852         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14853         IF NOT DATE-CONVERSION-ERROR
 14854             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14855         END-IF
 14856     END-IF.
 14857
 14858     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14859         IF CP-REMAINING-TERM-3 = ZEROS
 14860             MOVE 'EXPIRED'      TO ACVSTATO
 14861         ELSE
 14862             MOVE 'ACTIVE'       TO ACVSTATO
 14863         END-IF
 14864     END-IF.
 14865
 14866     IF CM-AH-CURRENT-STATUS = '2'
 14867         MOVE 'PEND  '           TO ACVSTATO
 14868     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 280
* EL130.cbl
 14869     IF CM-AH-CURRENT-STATUS = '3'
 14870         MOVE 'RESTORE'          TO ACVSTATO
 14871     END-IF.
 14872     IF CM-AH-CURRENT-STATUS = '5'
 14873         MOVE 'REISSUE'          TO ACVSTATO
 14874     END-IF.
 14875     IF CM-AH-CURRENT-STATUS = '6'
 14876         MOVE 'LMP DIS'          TO ACVSTATO
 14877     END-IF.
 14878     IF CM-AH-CURRENT-STATUS = '7'
 14879         MOVE 'DEATH  '          TO ACVSTATO
 14880     END-IF.
 14881     IF CM-AH-CURRENT-STATUS = '8'
 14882         MOVE 'CANCEL '          TO ACVSTATO
 14883     END-IF.
 14884     IF CM-AH-CURRENT-STATUS = '9'
 14885         MOVE 'RE-ONLY'          TO ACVSTATO
 14886     END-IF.
 14887     IF CM-AH-CURRENT-STATUS = 'V'
 14888         MOVE 'VOID   '          TO ACVSTATO
 14889     END-IF.
 14890     IF CM-AH-CURRENT-STATUS = 'D'
 14891         MOVE 'DECLINE'          TO ACVSTATO
 14892     END-IF.
 14893
 14894     IF PI-COMPANY-ID = 'DCC'
 14895        IF CM-ACCOUNT (9:2) = 'BI'
 14896           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14897           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14898           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14899           MOVE CM-STATE         TO CTRLR-STATE
 14900           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14901           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14902           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14903           MOVE 'C'              TO CTRLR-REC-TYPE
 14904
 14905* EXEC CICS READ
 14906*            DATASET  (ELCRTT-DSID)
 14907*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14908*            RIDFLD   (ELCRTT-KEY)
 14909*            RESP     (WS-RESPONSE)
 14910*          END-EXEC
 14911*    MOVE '&"S        E          (  N#00013491' TO DFHEIV0
 14912     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14914     MOVE X'204E233030303133343931' TO DFHEIV0(25:11)
 14915     CALL 'kxdfhei1' USING DFHEIV0,
 14916           ELCRTT-DSID,
 14917           DFHEIV20,
 14918           DFHEIV99,
 14919           ELCRTT-KEY,
 14920           DFHEIV99,
 14921           DFHEIV99,
 14922           DFHEIV99
 14923     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14924         DFHEIV20
 14925     MOVE EIBRESP  TO WS-RESPONSE
 14926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 281
* EL130.cbl
 14927           IF WS-RESP-NORMAL
 14928               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14929               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14930               MOVE AL-UANON        TO DIAGA
 14931           END-IF
 14932        END-IF
 14933     END-IF.
 14934
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 282
* EL130.cbl
 14936 7070-BUILD-MAP-FINISH.
 14937     MOVE CM-LOAN-APR            TO APRO.
 14938     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14939     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14940     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14941     MOVE AL-UNNON               TO APRA
 14942                                    PMTFREQA.
 14943     MOVE AL-UANON               TO INDGRPA
 14944                                    PREMTYPA.
 14945
 14946     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14947         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14948         MOVE AL-UANON               TO REINCDA
 14949     END-IF.
 14950
 14951     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14952*        NEXT SENTENCE
 14953         CONTINUE
 14954     ELSE
 14955         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14956         MOVE ' '                TO DC-OPTION-CODE
 14957         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14958         IF NOT DATE-CONVERSION-ERROR
 14959             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 14960             MOVE AL-UANON            TO ADDONDTA
 14961         END-IF
 14962     END-IF.
 14963
 14964     IF CLAIM-SWITCH = 'N'
 14965         IF SEXL = ZEROS
 14966             MOVE CM-INSURED-SEX TO SEXO
 14967*            MOVE AL-UANON       TO SEXA
 14968         END-IF
 14969     END-IF.
 14970
 14971     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 14972         MOVE CM-MEMBER-NO       TO MEMBERO
 14973         MOVE AL-UANON           TO MEMBERA
 14974     END-IF.
 14975
 14976     IF MAINTI = 'A'
 14977         IF (LOANNOL = ZEROS OR
 14978             EIBAID = DFHPF5)
 14979             MOVE CM-LOAN-NUMBER TO LOANNOO
 14980             MOVE AL-UANON       TO LOANNOA
 14981         ELSE
 14982*            NEXT SENTENCE
 14983             CONTINUE
 14984         END-IF
 14985     ELSE
 14986         MOVE CM-LOAN-NUMBER     TO LOANNOO
 14987         MOVE AL-UANON           TO LOANNOA
 14988     END-IF.
 14989
 14990     IF MAINTI = 'A'
 14991         IF (LOANBALL = ZEROS OR
 14992             EIBAID = DFHPF5)
 14993             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 283
* EL130.cbl
 14994             MOVE AL-UNNON       TO LOANBALA
 14995         ELSE
 14996*            NEXT SENTENCE
 14997             CONTINUE
 14998         END-IF
 14999     ELSE
 15000         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15001         MOVE AL-UNNON           TO LOANBALA
 15002     END-IF.
 15003
 15004     IF CM-PREMIUM-TYPE NOT = '3'
 15005         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15006             PERFORM 7200-PROTECT-CERT-FIELDS
 15007         ELSE
 15008             PERFORM 7300-RESET-KEY-ATTRBS
 15009         END-IF
 15010     ELSE
 15011         PERFORM 7300-RESET-KEY-ATTRBS
 15012     END-IF.
 15013
 15014*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15015*        NEXT SENTENCE
 15016*        CONTINUE
 15017*    ELSE
 15018         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15019*    END-IF.
 15020
 15021 7099-EXIT.
 15022     EXIT.
 15023
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 284
* EL130.cbl
 15025 7100-READ-BENEFIT.
 15026
 15027
 15028* EXEC CICS HANDLE CONDITION
 15029*         NOTFND   (7120-NOT-FOUND)
 15030*    END-EXEC.
 15031*    MOVE '"$I                   ! E #00013597' TO DFHEIV0
 15032     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15034     MOVE X'4520233030303133353937' TO DFHEIV0(25:11)
 15035     CALL 'kxdfhei1' USING DFHEIV0
 15036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15037
 15038
 15039     MOVE SPACES                 TO ELCNTL-KEY.
 15040     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15041     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15042     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15043     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15044
 15045 7105-READ-FILE.
 15046     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15047
 15048     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15049        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15050          GO TO 7120-NOT-FOUND
 15051     END-IF.
 15052
 15053     MOVE 1                      TO SUB.
 15054 7110-LOOP.
 15055     IF SUB = 9
 15056         GO TO 7120-NOT-FOUND
 15057     END-IF.
 15058
 15059     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15060         ADD 1                   TO SUB
 15061         GO TO 7110-LOOP
 15062     END-IF.
 15063
 15064     if ws-rec-type = '4'
 15065        move cf-joint-indicator (sub)
 15066                                 to ws-lf-joint-indicator
 15067     else
 15068        move cf-joint-indicator (sub)
 15069                                 to ws-ah-joint-indicator
 15070     end-if
 15071     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15072     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15073     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15074
 15075     GO TO 7199-EXIT.
 15076
 15077 7120-NOT-FOUND.
 15078     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15079                                    WS-FORM-HOLD.
 15080
 15081 7199-EXIT.
 15082      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 285
* EL130.cbl
 15083
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 286
* EL130.cbl
 15085 7200-PROTECT-CERT-FIELDS.
 15086     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15087                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15088                                LCVFORMA ACVFORMA JNTLNMEA
 15089                                JNTFNMEA JNTINITA.
 15090
 15091     IF CM-LF-CURRENT-STATUS = '2' OR
 15092        CM-AH-CURRENT-STATUS = '2'
 15093         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15094     END-IF.
 15095
 15096     MOVE AL-SANOF TO
 15097            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15098            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15099            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15100            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15101            LCVRATEA   ACVRATEA.
 15102
 15103     MOVE 'S'                    TO CERTMTI.
 15104
 15105 7300-RESET-KEY-ATTRBS.
 15106     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15107                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15108                                LCVFORMA ACVFORMA JNTLNMEA
 15109                                JNTFNMEA JNTINITA.
 15110
 15111     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15112         MOVE AL-SANOF           TO REINCDA
 15113     END-IF.
 15114
 15115     MOVE 'S'                    TO CERTMTI.
 15116
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 287
* EL130.cbl
 15118 7400-READ-STATE.
 15119
 15120
 15121* EXEC CICS HANDLE CONDITION
 15122*         NOTFND   (7499-EXIT)
 15123*    END-EXEC.
 15124*    MOVE '"$I                   ! F #00013682' TO DFHEIV0
 15125     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15127     MOVE X'4620233030303133363832' TO DFHEIV0(25:11)
 15128     CALL 'kxdfhei1' USING DFHEIV0
 15129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15130
 15131
 15132     MOVE SPACES                 TO ELCNTL-KEY.
 15133     MOVE CM-STATE               TO CNTL-ACCESS.
 15134     MOVE '3'                    TO CNTL-REC-TYPE.
 15135     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15136     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15137
 15138     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15139
 15140     MOVE 1                      TO SUB.
 15141
 15142 7410-LOOP.
 15143     IF SUB = 21
 15144        GO TO 7499-EXIT
 15145     END-IF.
 15146
 15147*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15148*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15149*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15150*        GO TO 7499-EXIT.
 15151
 15152     ADD 1                       TO SUB.
 15153     GO TO 7410-LOOP.
 15154
 15155 7499-EXIT.
 15156      EXIT.
 15157
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 288
* EL130.cbl
 15159 7500-BROWSE-FOR-DUPLICATE.
 15160
 15161     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15162
 15163
 15164
 15165* EXEC CICS HANDLE CONDITION
 15166*        NOTFND   (7500-EXIT)
 15167*        DUPKEY   (7500-DUPLICATE-KEY)
 15168*        ENDFILE  (7500-EXIT)
 15169*    END-EXEC.
 15170*    MOVE '"$I$''                 ! G #00013718' TO DFHEIV0
 15171     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15173     MOVE X'4720233030303133373138' TO DFHEIV0(25:11)
 15174     CALL 'kxdfhei1' USING DFHEIV0
 15175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15176
 15177
 15178
 15179
 15180* EXEC CICS STARTBR
 15181*        DATASET    (ELMSTR5-DSID)
 15182*        RIDFLD     (ELMSTR5-KEY)
 15183*    END-EXEC.
 15184     MOVE 0
 15185       TO DFHEIV11
 15186*    MOVE '&,         G          &   #00013725' TO DFHEIV0
 15187     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15189     MOVE X'2020233030303133373235' TO DFHEIV0(25:11)
 15190     CALL 'kxdfhei1' USING DFHEIV0,
 15191           ELMSTR5-DSID,
 15192           ELMSTR5-KEY,
 15193           DFHEIV99,
 15194           DFHEIV11,
 15195           DFHEIV99
 15196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15197
 15198
 15199
 15200
 15201* EXEC CICS HANDLE CONDITION
 15202*        ENDFILE  (7500-END-BROWSE)
 15203*    END-EXEC.
 15204*    MOVE '"$''                   ! H #00013731' TO DFHEIV0
 15205     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15207     MOVE X'4820233030303133373331' TO DFHEIV0(25:11)
 15208     CALL 'kxdfhei1' USING DFHEIV0
 15209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15210
 15211
 15212 7500-READ-CLAIM-LOOP.
 15213
 15214
 15215
 15216* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 289
* EL130.cbl
 15217*        DATASET   (ELMSTR5-DSID)
 15218*        SET       (ADDRESS OF CLAIM-MASTER)
 15219*        RIDFLD    (ELMSTR5-KEY)
 15220*    END-EXEC.
 15221     MOVE 0
 15222       TO DFHEIV11
 15223*    MOVE '&.S                   )   #00013738' TO DFHEIV0
 15224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15226     MOVE X'2020233030303133373338' TO DFHEIV0(25:11)
 15227     CALL 'kxdfhei1' USING DFHEIV0,
 15228           ELMSTR5-DSID,
 15229           DFHEIV20,
 15230           DFHEIV99,
 15231           ELMSTR5-KEY,
 15232           DFHEIV99,
 15233           DFHEIV11,
 15234           DFHEIV99,
 15235           DFHEIV99
 15236     SET ADDRESS OF CLAIM-MASTER TO
 15237         DFHEIV20
 15238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15239
 15240
 15241 7500-DUPLICATE-KEY.
 15242
 15243     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15244        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15245        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15246        CL-CERT-STATE     NOT = CM-STATE       OR
 15247        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15248        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15249        CL-CERT-NO        NOT = CM-CERT-NO
 15250           GO TO 7500-CHECK-MATCH-COUNT
 15251     END-IF.
 15252
 15253     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15254
 15255     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15256        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15257        GO TO 7500-END-BROWSE
 15258     ELSE
 15259        GO TO 7500-READ-CLAIM-LOOP
 15260     END-IF.
 15261
 15262 7500-CHECK-MATCH-COUNT.
 15263
 15264     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15265        CL-CERT-NO    = CM-CERT-NO
 15266          GO TO 7500-READ-CLAIM-LOOP
 15267     END-IF.
 15268
 15269 7500-END-BROWSE.
 15270
 15271
 15272
 15273* EXEC CICS ENDBR
 15274*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 290
* EL130.cbl
 15275*    END-EXEC.
 15276     MOVE 0
 15277       TO DFHEIV11
 15278*    MOVE '&2                    $   #00013775' TO DFHEIV0
 15279     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15281     MOVE X'2020233030303133373735' TO DFHEIV0(25:11)
 15282     CALL 'kxdfhei1' USING DFHEIV0,
 15283           ELMSTR5-DSID,
 15284           DFHEIV11,
 15285           DFHEIV99
 15286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15287
 15288
 15289 7500-EXIT.
 15290     EXIT.
 15291
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 291
* EL130.cbl
 15293 7550-FALL-THRU-PARA.
 15294
 15295
 15296
 15297* EXEC CICS DUMP
 15298*         DUMPCODE ('E130')
 15299*         TASK
 15300*    END-EXEC.
 15301     MOVE 'E130' TO DFHEIV5
 15302*    MOVE '<"   T                $   #00013786' TO DFHEIV0
 15303     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15305     MOVE X'2020233030303133373836' TO DFHEIV0(25:11)
 15306     CALL 'kxdfhei1' USING DFHEIV0,
 15307           DFHEIV5,
 15308           DFHEIV99,
 15309           DFHEIV99
 15310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15311
 15312
 15313
 15314
 15315* EXEC CICS RETURN
 15316*    END-EXEC.
 15317*    MOVE '.(                    ''   #00013792' TO DFHEIV0
 15318     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15319     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15320     MOVE X'2020233030303133373932' TO DFHEIV0(25:11)
 15321     CALL 'kxdfhei1' USING DFHEIV0,
 15322           DFHEIV99,
 15323           DFHEIV99,
 15324           DFHEIV99,
 15325           DFHEIV99,
 15326           DFHEIV99,
 15327           DFHEIV99
 15328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15329
 15330
 15331 7600-BROWSE-CLAIM.
 15332
 15333
 15334
 15335* EXEC CICS READ
 15336*        DATASET(ELMSTR-DSID)
 15337*        SET    (ADDRESS OF CLAIM-MASTER)
 15338*        RIDFLD (ELMSTR-KEY)
 15339*        GENERIC
 15340*        EQUAL
 15341*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15342*    END-EXEC.
 15343*    MOVE '&"S  KG    E          (   #00013798' TO DFHEIV0
 15344     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15346     MOVE X'2020233030303133373938' TO DFHEIV0(25:11)
 15347     CALL 'kxdfhei1' USING DFHEIV0,
 15348           ELMSTR-DSID,
 15349           DFHEIV20,
 15350           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 292
* EL130.cbl
 15351           ELMSTR-KEY,
 15352           ELMSTR-GENERIC-LENGTH,
 15353           DFHEIV99,
 15354           DFHEIV99
 15355     SET ADDRESS OF CLAIM-MASTER TO
 15356         DFHEIV20
 15357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15358
 15359
 15360     MOVE CL-CERT-PRIME          TO CERTNOI.
 15361     MOVE CL-CERT-SFX            TO SUFXI.
 15362
 15363 7610-BROWSE-CLAIM-LOOP.
 15364
 15365     MOVE LOW-VALUES             TO BCERT1O
 15366                                    BSUFX1O
 15367                                    BCERT2O
 15368                                    BSUFX2O
 15369                                    BCERT3O
 15370                                    BSUFX3O
 15371                                    BCERT4O
 15372                                    BSUFX4O
 15373                                    BCERT5O
 15374                                    BSUFX5O.
 15375
 15376     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15377
 15378
 15379
 15380* EXEC CICS HANDLE CONDITION
 15381*        ENDFILE  (7630-END-BROWSE)
 15382*    END-EXEC.
 15383*    MOVE '"$''                   ! I #00013826' TO DFHEIV0
 15384     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15386     MOVE X'4920233030303133383236' TO DFHEIV0(25:11)
 15387     CALL 'kxdfhei1' USING DFHEIV0
 15388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15389
 15390
 15391
 15392
 15393* EXEC CICS STARTBR
 15394*        DATASET    (ELMSTR-DSID)
 15395*        RIDFLD     (ELMSTR-KEY)
 15396*    END-EXEC.
 15397     MOVE 0
 15398       TO DFHEIV11
 15399*    MOVE '&,         G          &   #00013831' TO DFHEIV0
 15400     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15401     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15402     MOVE X'2020233030303133383331' TO DFHEIV0(25:11)
 15403     CALL 'kxdfhei1' USING DFHEIV0,
 15404           ELMSTR-DSID,
 15405           ELMSTR-KEY,
 15406           DFHEIV99,
 15407           DFHEIV11,
 15408           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 293
* EL130.cbl
 15409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15410
 15411
 15412     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15413
 15414 7620-READ-CLAIM-LOOP.
 15415
 15416
 15417
 15418* EXEC CICS READNEXT
 15419*        DATASET   (ELMSTR-DSID)
 15420*        SET       (ADDRESS OF CLAIM-MASTER)
 15421*        RIDFLD    (ELMSTR-KEY)
 15422*    END-EXEC.
 15423     MOVE 0
 15424       TO DFHEIV11
 15425*    MOVE '&.S                   )   #00013841' TO DFHEIV0
 15426     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15427     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15428     MOVE X'2020233030303133383431' TO DFHEIV0(25:11)
 15429     CALL 'kxdfhei1' USING DFHEIV0,
 15430           ELMSTR-DSID,
 15431           DFHEIV20,
 15432           DFHEIV99,
 15433           ELMSTR-KEY,
 15434           DFHEIV99,
 15435           DFHEIV11,
 15436           DFHEIV99,
 15437           DFHEIV99
 15438     SET ADDRESS OF CLAIM-MASTER TO
 15439         DFHEIV20
 15440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15441
 15442
 15443     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15444        CL-CARRIER     NOT = CLMCARRI       OR
 15445        CL-CLAIM-NO    NOT = CLMNOI
 15446          GO TO 7630-END-BROWSE
 15447     END-IF.
 15448
 15449     IF WS-ASSOCIATED-CERTS = 1
 15450         MOVE CL-CERT-PRIME      TO BCERT1O
 15451         MOVE CL-CERT-SFX        TO BSUFX1O
 15452     END-IF.
 15453
 15454     IF WS-ASSOCIATED-CERTS = 2
 15455         MOVE CL-CERT-PRIME      TO BCERT2O
 15456         MOVE CL-CERT-SFX        TO BSUFX2O
 15457     END-IF.
 15458
 15459     IF WS-ASSOCIATED-CERTS = 3
 15460         MOVE CL-CERT-PRIME      TO BCERT3O
 15461         MOVE CL-CERT-SFX        TO BSUFX3O
 15462     END-IF.
 15463
 15464     IF WS-ASSOCIATED-CERTS = 4
 15465         MOVE CL-CERT-PRIME      TO BCERT4O
 15466         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 294
* EL130.cbl
 15467     END-IF.
 15468
 15469     IF WS-ASSOCIATED-CERTS = 5
 15470         MOVE CL-CERT-PRIME      TO BCERT5O
 15471         MOVE CL-CERT-SFX        TO BSUFX5O
 15472     ELSE
 15473         ADD +1                  TO WS-ASSOCIATED-CERTS
 15474         GO TO 7620-READ-CLAIM-LOOP
 15475     END-IF.
 15476
 15477 7630-END-BROWSE.
 15478
 15479
 15480
 15481* EXEC CICS ENDBR
 15482*        DATASET   (ELMSTR-DSID)
 15483*    END-EXEC.
 15484     MOVE 0
 15485       TO DFHEIV11
 15486*    MOVE '&2                    $   #00013884' TO DFHEIV0
 15487     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15488     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15489     MOVE X'2020233030303133383834' TO DFHEIV0(25:11)
 15490     CALL 'kxdfhei1' USING DFHEIV0,
 15491           ELMSTR-DSID,
 15492           DFHEIV11,
 15493           DFHEIV99
 15494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15495
 15496
 15497 7640-HIGHLIGHT-CERT-DISPLAYED.
 15498
 15499     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15500     MOVE AL-SANON               TO BCERT1A
 15501                                    BSUFX1A
 15502                                    BCERT2A
 15503                                    BSUFX2A
 15504                                    BCERT3A
 15505                                    BSUFX3A
 15506                                    BCERT4A
 15507                                    BSUFX4A
 15508                                    BCERT5A
 15509                                    BSUFX5A.
 15510
 15511     IF BCERT1O = CERTNOI AND
 15512        BSUFX1O = SUFXI
 15513            MOVE AL-SABON        TO BCERT1A
 15514                                    BSUFX1A
 15515     END-IF.
 15516
 15517     IF BCERT2O = CERTNOI AND
 15518        BSUFX2O = SUFXI
 15519            MOVE AL-SABON        TO BCERT2A
 15520                                    BSUFX2A
 15521     END-IF.
 15522
 15523     IF BCERT3O = CERTNOI AND
 15524        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 295
* EL130.cbl
 15525            MOVE AL-SABON        TO BCERT3A
 15526                                    BSUFX3A
 15527     END-IF.
 15528
 15529     IF BCERT4O = CERTNOI AND
 15530        BSUFX4O = SUFXI
 15531            MOVE AL-SABON        TO BCERT4A
 15532                                    BSUFX4A
 15533     END-IF.
 15534
 15535     IF BCERT5O = CERTNOI AND
 15536        BSUFX5O = SUFXI
 15537            MOVE AL-SABON        TO BCERT5A
 15538                                    BSUFX5A
 15539     END-IF.
 15540
 15541 7699-EXIT.
 15542     EXIT.
 15543
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 296
* EL130.cbl
 15545 7700-CHECK-SEQUENCE.
 15546
 15547
 15548
 15549* EXEC CICS HANDLE CONDITION
 15550*        ENDFILE  (7799-EXIT)
 15551*        NOTFND   (7799-EXIT)
 15552*    END-EXEC.
 15553*    MOVE '"$''I                  ! J #00013939' TO DFHEIV0
 15554     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15556     MOVE X'4A20233030303133393339' TO DFHEIV0(25:11)
 15557     CALL 'kxdfhei1' USING DFHEIV0
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561
 15562
 15563* EXEC CICS READ
 15564*        DATASET(ELMSTR-DSID)
 15565*        SET    (ADDRESS OF CLAIM-MASTER)
 15566*        RIDFLD (ELMSTR-KEY)
 15567*        GENERIC
 15568*        EQUAL
 15569*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15570*    END-EXEC.
 15571*    MOVE '&"S  KG    E          (   #00013945' TO DFHEIV0
 15572     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15574     MOVE X'2020233030303133393435' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           ELMSTR-DSID,
 15577           DFHEIV20,
 15578           DFHEIV99,
 15579           ELMSTR-KEY,
 15580           ELMSTR-GENERIC-LENGTH,
 15581           DFHEIV99,
 15582           DFHEIV99
 15583     SET ADDRESS OF CLAIM-MASTER TO
 15584         DFHEIV20
 15585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15586
 15587
 15588     COMPUTE WS-ASSOC-CERT-TOTAL =
 15589             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15590
 15591     GO TO 7799-EXIT.
 15592
 15593 7710-RESEQUENCE-CLAIMS.
 15594
 15595
 15596
 15597* EXEC CICS HANDLE CONDITION
 15598*        ENDFILE  (7790-END-BROWSE)
 15599*    END-EXEC.
 15600*    MOVE '"$''                   ! K #00013962' TO DFHEIV0
 15601     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 297
* EL130.cbl
 15603     MOVE X'4B20233030303133393632' TO DFHEIV0(25:11)
 15604     CALL 'kxdfhei1' USING DFHEIV0
 15605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15606
 15607
 15608
 15609
 15610* EXEC CICS STARTBR
 15611*        DATASET    (ELMSTR-DSID)
 15612*        RIDFLD     (ELMSTR-KEY)
 15613*    END-EXEC.
 15614     MOVE 0
 15615       TO DFHEIV11
 15616*    MOVE '&,         G          &   #00013967' TO DFHEIV0
 15617     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15619     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0,
 15621           ELMSTR-DSID,
 15622           ELMSTR-KEY,
 15623           DFHEIV99,
 15624           DFHEIV11,
 15625           DFHEIV99
 15626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15627
 15628
 15629     ADD +1 TO WS-ASSOC-CERT-SEQU
 15630               WS-READNEXT-SWITCH.
 15631
 15632 7720-READ-CLAIM-LOOP.
 15633
 15634
 15635
 15636* EXEC CICS READNEXT
 15637*        DATASET   (ELMSTR-DSID)
 15638*        SET       (ADDRESS OF CLAIM-MASTER)
 15639*        RIDFLD    (ELMSTR-KEY)
 15640*    END-EXEC.
 15641     MOVE 0
 15642       TO DFHEIV11
 15643*    MOVE '&.S                   )   #00013978' TO DFHEIV0
 15644     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15645     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15646     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 15647     CALL 'kxdfhei1' USING DFHEIV0,
 15648           ELMSTR-DSID,
 15649           DFHEIV20,
 15650           DFHEIV99,
 15651           ELMSTR-KEY,
 15652           DFHEIV99,
 15653           DFHEIV11,
 15654           DFHEIV99,
 15655           DFHEIV99
 15656     SET ADDRESS OF CLAIM-MASTER TO
 15657         DFHEIV20
 15658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15659
 15660
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 298
* EL130.cbl
 15661     IF WS-READNEXT-SWITCH = 1
 15662         ADD 1 TO WS-READNEXT-SWITCH
 15663         GO TO 7720-READ-CLAIM-LOOP
 15664     END-IF.
 15665
 15666 7730-END-BROWSE.
 15667
 15668
 15669
 15670* EXEC CICS ENDBR
 15671*        DATASET   (ELMSTR-DSID)
 15672*    END-EXEC.
 15673     MOVE 0
 15674       TO DFHEIV11
 15675*    MOVE '&2                    $   #00013992' TO DFHEIV0
 15676     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15678     MOVE X'2020233030303133393932' TO DFHEIV0(25:11)
 15679     CALL 'kxdfhei1' USING DFHEIV0,
 15680           ELMSTR-DSID,
 15681           DFHEIV11,
 15682           DFHEIV99
 15683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15684
 15685
 15686 7740-READ-CLAIM-UPDATE.
 15687
 15688     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15689        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15690        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15691          GO TO 7799-EXIT
 15692     ELSE
 15693          MOVE ZERO              TO WS-READNEXT-SWITCH
 15694     END-IF.
 15695
 15696
 15697
 15698* EXEC CICS READ
 15699*        DATASET(ELMSTR-DSID)
 15700*        SET    (ADDRESS OF CLAIM-MASTER)
 15701*        RIDFLD (ELMSTR-KEY)
 15702*        UPDATE
 15703*    END-EXEC.
 15704*    MOVE '&"S        EU         (   #00014007' TO DFHEIV0
 15705     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15706     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15707     MOVE X'2020233030303134303037' TO DFHEIV0(25:11)
 15708     CALL 'kxdfhei1' USING DFHEIV0,
 15709           ELMSTR-DSID,
 15710           DFHEIV20,
 15711           DFHEIV99,
 15712           ELMSTR-KEY,
 15713           DFHEIV99,
 15714           DFHEIV99,
 15715           DFHEIV99
 15716     SET ADDRESS OF CLAIM-MASTER TO
 15717         DFHEIV20
 15718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 299
* EL130.cbl
 15719
 15720
 15721     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15722     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15723
 15724
 15725
 15726* EXEC CICS REWRITE
 15727*         DATASET     (ELMSTR-DSID)
 15728*         FROM        (CLAIM-MASTER)
 15729*    END-EXEC.
 15730     MOVE LENGTH OF
 15731      CLAIM-MASTER
 15732       TO DFHEIV11
 15733*    MOVE '&& L                  %   #00014018' TO DFHEIV0
 15734     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15735     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15736     MOVE X'2020233030303134303138' TO DFHEIV0(25:11)
 15737     CALL 'kxdfhei1' USING DFHEIV0,
 15738           ELMSTR-DSID,
 15739           CLAIM-MASTER,
 15740           DFHEIV11,
 15741           DFHEIV99
 15742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15743
 15744
 15745     GO TO 7710-RESEQUENCE-CLAIMS.
 15746
 15747 7790-END-BROWSE.
 15748
 15749
 15750
 15751* EXEC CICS ENDBR
 15752*        DATASET   (ELMSTR-DSID)
 15753*    END-EXEC.
 15754     MOVE 0
 15755       TO DFHEIV11
 15756*    MOVE '&2                    $   #00014028' TO DFHEIV0
 15757     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15759     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 15760     CALL 'kxdfhei1' USING DFHEIV0,
 15761           ELMSTR-DSID,
 15762           DFHEIV11,
 15763           DFHEIV99
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
 15766
 15767 7799-EXIT.
 15768     EXIT.
 15769
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 300
* EL130.cbl
 15771************************************************
 15772*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15773************************************************
 15774
 15775 7900-READ-ACTV-UPDATE.
 15776     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15777     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15778     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15779     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15780     MOVE +0                     TO TRLR-SEQ-NO.
 15781     MOVE '1'                    TO TRLR-TYPE.
 15782     GO TO 7900-READ-TRAILER-UPDATE.
 15783
 15784 7900-READ-NINETY-UPDATE.
 15785     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15786     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15787     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15788     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15789     MOVE +90                    TO TRLR-SEQ-NO.
 15790     MOVE '6'                    TO TRLR-TYPE.
 15791
 15792 7900-READ-TRAILER-UPDATE.
 15793
 15794
 15795* EXEC CICS READ  UPDATE
 15796*        DATASET    (ELTRLR-DSID)
 15797*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15798*        RIDFLD     (ELTRLR-KEY)
 15799*    END-EXEC.
 15800*    MOVE '&"S        EU         (   #00014059' TO DFHEIV0
 15801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15802     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15803     MOVE X'2020233030303134303539' TO DFHEIV0(25:11)
 15804     CALL 'kxdfhei1' USING DFHEIV0,
 15805           ELTRLR-DSID,
 15806           DFHEIV20,
 15807           DFHEIV99,
 15808           ELTRLR-KEY,
 15809           DFHEIV99,
 15810           DFHEIV99,
 15811           DFHEIV99
 15812     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15813         DFHEIV20
 15814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15815
 15816
 15817 7900-EXIT.
 15818      EXIT.
 15819
 15820 7910-READ-ACTV.
 15821     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15822     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15823     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15824     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15825     MOVE +0                     TO TRLR-SEQ-NO.
 15826     MOVE '1'                    TO TRLR-TYPE.
 15827     GO TO 7910-READ-TRAILER.
 15828
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 301
* EL130.cbl
 15829 7910-READ-NINETY.
 15830     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15831     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15832     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15833     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15834     MOVE +90                    TO TRLR-SEQ-NO.
 15835     MOVE '6'                    TO TRLR-TYPE.
 15836
 15837 7910-READ-TRAILER.
 15838     MOVE 'TRLR'                 TO FILE-SWITCH.
 15839
 15840
 15841
 15842* EXEC CICS READ
 15843*        DATASET   (ELTRLR-DSID)
 15844*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15845*        RIDFLD    (ELTRLR-KEY)
 15846*    END-EXEC.
 15847*    MOVE '&"S        E          (   #00014089' TO DFHEIV0
 15848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15850     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 15851     CALL 'kxdfhei1' USING DFHEIV0,
 15852           ELTRLR-DSID,
 15853           DFHEIV20,
 15854           DFHEIV99,
 15855           ELTRLR-KEY,
 15856           DFHEIV99,
 15857           DFHEIV99,
 15858           DFHEIV99
 15859     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15860         DFHEIV20
 15861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15862
 15863
 15864 7910-EXIT.
 15865      EXIT.
 15866
 15867 7915-REWRITE-TRAILER.
 15868
 15869
 15870* EXEC CICS REWRITE
 15871*        DATASET   (ELTRLR-DSID)
 15872*        FROM      (ACTIVITY-TRAILERS)
 15873*    END-EXEC.
 15874     MOVE LENGTH OF
 15875      ACTIVITY-TRAILERS
 15876       TO DFHEIV11
 15877*    MOVE '&& L                  %   #00014100' TO DFHEIV0
 15878     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15879     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15880     MOVE X'2020233030303134313030' TO DFHEIV0(25:11)
 15881     CALL 'kxdfhei1' USING DFHEIV0,
 15882           ELTRLR-DSID,
 15883           ACTIVITY-TRAILERS,
 15884           DFHEIV11,
 15885           DFHEIV99
 15886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 302
* EL130.cbl
 15887
 15888
 15889 7915-EXIT.
 15890      EXIT.
 15891
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 303
* EL130.cbl
 15893********************************************
 15894*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15895********************************************
 15896
 15897 7920-READ-CLAIM-UPDATE.
 15898
 15899
 15900
 15901* EXEC CICS READ
 15902*        UPDATE
 15903*        DATASET   (ELMSTR-DSID)
 15904*        SET       (ADDRESS OF CLAIM-MASTER)
 15905*        RIDFLD    (ELMSTR-KEY)
 15906*    END-EXEC.
 15907*    MOVE '&"S        EU         (   #00014116' TO DFHEIV0
 15908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15909     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15910     MOVE X'2020233030303134313136' TO DFHEIV0(25:11)
 15911     CALL 'kxdfhei1' USING DFHEIV0,
 15912           ELMSTR-DSID,
 15913           DFHEIV20,
 15914           DFHEIV99,
 15915           ELMSTR-KEY,
 15916           DFHEIV99,
 15917           DFHEIV99,
 15918           DFHEIV99
 15919     SET ADDRESS OF CLAIM-MASTER TO
 15920         DFHEIV20
 15921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15922
 15923
 15924 7920-EXIT.
 15925      EXIT.
 15926
 15927 7950-READ-CLAIM.
 15928
 15929
 15930* EXEC CICS READ
 15931*        DATASET   (ELMSTR-DSID)
 15932*        SET       (ADDRESS OF CLAIM-MASTER)
 15933*        RIDFLD    (ELMSTR-KEY)
 15934*    END-EXEC.
 15935*    MOVE '&"S        E          (   #00014128' TO DFHEIV0
 15936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15938     MOVE X'2020233030303134313238' TO DFHEIV0(25:11)
 15939     CALL 'kxdfhei1' USING DFHEIV0,
 15940           ELMSTR-DSID,
 15941           DFHEIV20,
 15942           DFHEIV99,
 15943           ELMSTR-KEY,
 15944           DFHEIV99,
 15945           DFHEIV99,
 15946           DFHEIV99
 15947     SET ADDRESS OF CLAIM-MASTER TO
 15948         DFHEIV20
 15949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15950
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 304
* EL130.cbl
 15951
 15952 7950-EXIT.
 15953      EXIT.
 15954
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 305
* EL130.cbl
 15956***************************************
 15957*  I/O REQUESTS AGAINST CONTROL FILE  *
 15958***************************************
 15959
 15960 7960-READ-CNTL-UPDATE.
 15961
 15962
 15963* EXEC CICS READ
 15964*        UPDATE
 15965*        DATASET  (ELCNTL-DSID)
 15966*        SET      (ADDRESS OF CONTROL-FILE)
 15967*        RIDFLD   (ELCNTL-KEY)
 15968*    END-EXEC.
 15969*    MOVE '&"S        EU         (   #00014144' TO DFHEIV0
 15970     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15971     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15972     MOVE X'2020233030303134313434' TO DFHEIV0(25:11)
 15973     CALL 'kxdfhei1' USING DFHEIV0,
 15974           ELCNTL-DSID,
 15975           DFHEIV20,
 15976           DFHEIV99,
 15977           ELCNTL-KEY,
 15978           DFHEIV99,
 15979           DFHEIV99,
 15980           DFHEIV99
 15981     SET ADDRESS OF CONTROL-FILE TO
 15982         DFHEIV20
 15983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15984
 15985
 15986 7960-EXIT.
 15987      EXIT.
 15988
 15989 7970-READ-CNTL.
 15990
 15991
 15992* EXEC CICS READ
 15993*        DATASET  (ELCNTL-DSID)
 15994*        SET      (ADDRESS OF CONTROL-FILE)
 15995*        RIDFLD   (ELCNTL-KEY)
 15996*    END-EXEC.
 15997*    MOVE '&"S        E          (   #00014156' TO DFHEIV0
 15998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16000     MOVE X'2020233030303134313536' TO DFHEIV0(25:11)
 16001     CALL 'kxdfhei1' USING DFHEIV0,
 16002           ELCNTL-DSID,
 16003           DFHEIV20,
 16004           DFHEIV99,
 16005           ELCNTL-KEY,
 16006           DFHEIV99,
 16007           DFHEIV99,
 16008           DFHEIV99
 16009     SET ADDRESS OF CONTROL-FILE TO
 16010         DFHEIV20
 16011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16012
 16013
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 306
* EL130.cbl
 16014 7970-EXIT.
 16015      EXIT.
 16016
 16017 7975-READ-CNTL-GTEQ.
 16018
 16019
 16020* EXEC CICS READ
 16021*         DATASET   (ELCNTL-DSID)
 16022*         SET       (ADDRESS OF CONTROL-FILE)
 16023*         RIDFLD    (ELCNTL-KEY)
 16024*         GTEQ
 16025*     END-EXEC.
 16026*    MOVE '&"S        G          (   #00014167' TO DFHEIV0
 16027     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16029     MOVE X'2020233030303134313637' TO DFHEIV0(25:11)
 16030     CALL 'kxdfhei1' USING DFHEIV0,
 16031           ELCNTL-DSID,
 16032           DFHEIV20,
 16033           DFHEIV99,
 16034           ELCNTL-KEY,
 16035           DFHEIV99,
 16036           DFHEIV99,
 16037           DFHEIV99
 16038     SET ADDRESS OF CONTROL-FILE TO
 16039         DFHEIV20
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043 7975-EXIT.
 16044      EXIT.
 16045
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 307
* EL130.cbl
 16047**************************************************
 16048*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16049**************************************************
 16050
 16051 7980-READ-CERT5.
 16052
 16053
 16054* EXEC CICS READ
 16055*         DATASET  (ELCERT5-DSID)
 16056*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16057*         RIDFLD   (ELCERT-KEY-5)
 16058*     END-EXEC.
 16059*    MOVE '&"S        E          (   #00014184' TO DFHEIV0
 16060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16062     MOVE X'2020233030303134313834' TO DFHEIV0(25:11)
 16063     CALL 'kxdfhei1' USING DFHEIV0,
 16064           ELCERT5-DSID,
 16065           DFHEIV20,
 16066           DFHEIV99,
 16067           ELCERT-KEY-5,
 16068           DFHEIV99,
 16069           DFHEIV99,
 16070           DFHEIV99
 16071     SET ADDRESS OF CERTIFICATE-MASTER TO
 16072         DFHEIV20
 16073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16074
 16075
 16076 7980-EXIT.
 16077      EXIT.
 16078
 16079 7930-READ-CERT-UPDATE.
 16080
 16081
 16082* EXEC CICS READ
 16083*        DATASET  (ELCERT-DSID)
 16084*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16085*        RIDFLD   (ELCERT-KEY)
 16086*        UPDATE
 16087*    END-EXEC.
 16088*    MOVE '&"S        EU         (   #00014195' TO DFHEIV0
 16089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16090     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16091     MOVE X'2020233030303134313935' TO DFHEIV0(25:11)
 16092     CALL 'kxdfhei1' USING DFHEIV0,
 16093           ELCERT-DSID,
 16094           DFHEIV20,
 16095           DFHEIV99,
 16096           ELCERT-KEY,
 16097           DFHEIV99,
 16098           DFHEIV99,
 16099           DFHEIV99
 16100     SET ADDRESS OF CERTIFICATE-MASTER TO
 16101         DFHEIV20
 16102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16103
 16104
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 308
* EL130.cbl
 16105 7930-EXIT.
 16106      EXIT.
 16107
 16108 7940-READ-CERT.
 16109
 16110
 16111* EXEC CICS READ
 16112*        DATASET  (ELCERT-DSID)
 16113*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16114*        RIDFLD   (ELCERT-KEY)
 16115*    END-EXEC.
 16116*    MOVE '&"S        E          (   #00014207' TO DFHEIV0
 16117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16119     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 16120     CALL 'kxdfhei1' USING DFHEIV0,
 16121           ELCERT-DSID,
 16122           DFHEIV20,
 16123           DFHEIV99,
 16124           ELCERT-KEY,
 16125           DFHEIV99,
 16126           DFHEIV99,
 16127           DFHEIV99
 16128     SET ADDRESS OF CERTIFICATE-MASTER TO
 16129         DFHEIV20
 16130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16131
 16132
 16133 7940-EXIT.
 16134      EXIT.
 16135
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 309
* EL130.cbl
 16137**************************************************
 16138*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16139**************************************************
 16140
 16141 7991-READ-BENE.
 16142
 16143
 16144* EXEC CICS READ
 16145*         DATASET   (ELBENE-DSID)
 16146*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16147*         RIDFLD    (ELBENE-KEY)
 16148*     END-EXEC.
 16149*    MOVE '&"S        E          (   #00014223' TO DFHEIV0
 16150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16152     MOVE X'2020233030303134323233' TO DFHEIV0(25:11)
 16153     CALL 'kxdfhei1' USING DFHEIV0,
 16154           ELBENE-DSID,
 16155           DFHEIV20,
 16156           DFHEIV99,
 16157           ELBENE-KEY,
 16158           DFHEIV99,
 16159           DFHEIV99,
 16160           DFHEIV99
 16161     SET ADDRESS OF BENEFICIARY-MASTER TO
 16162         DFHEIV20
 16163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16164
 16165
 16166 7991-EXIT.
 16167      EXIT.
 16168
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 310
* EL130.cbl
 16170**************************************************
 16171*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16172**************************************************
 16173
 16174 7992-READ-REIN.
 16175
 16176
 16177
 16178* EXEC CICS HANDLE CONDITION
 16179*        NOTFND   (7992-NOT-FOUND)
 16180*    END-EXEC.
 16181*    MOVE '"$I                   ! L #00014240' TO DFHEIV0
 16182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16184     MOVE X'4C20233030303134323430' TO DFHEIV0(25:11)
 16185     CALL 'kxdfhei1' USING DFHEIV0
 16186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16187
 16188
 16189
 16190
 16191* EXEC CICS READ
 16192*        DATASET   (ERREIN-DSID)
 16193*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16194*        RIDFLD    (ERREIN-KEY)
 16195*    END-EXEC.
 16196*    MOVE '&"S        E          (   #00014245' TO DFHEIV0
 16197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16199     MOVE X'2020233030303134323435' TO DFHEIV0(25:11)
 16200     CALL 'kxdfhei1' USING DFHEIV0,
 16201           ERREIN-DSID,
 16202           DFHEIV20,
 16203           DFHEIV99,
 16204           ERREIN-KEY,
 16205           DFHEIV99,
 16206           DFHEIV99,
 16207           DFHEIV99
 16208     SET ADDRESS OF REINSURANCE-RECORD TO
 16209         DFHEIV20
 16210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16211
 16212
 16213     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16214
 16215     GO TO 7992-EXIT.
 16216
 16217 7992-NOT-FOUND.
 16218     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16219
 16220 7992-EXIT.
 16221     EXIT.
 16222
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 311
* EL130.cbl
 16224 8000-LOAD-ERROR-MESSAGES.
 16225     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16226
 16227     IF EMI-NO-ERRORS
 16228         GO TO 8000-EXIT
 16229     END-IF.
 16230
 16231     perform varying e1 from +1 by +1 until e1 > +3
 16232        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16233                                or '1655' or '1660'
 16234           move 'W'              to emi-severity (e1)
 16235        end-if
 16236     end-perform
 16237     IF EMI-NUMBER-OF-LINES = 1
 16238         MOVE EMI-LINE1          TO ERRMSG1O
 16239         GO TO 8000-EXIT
 16240     END-IF.
 16241
 16242     IF EMI-NUMBER-OF-LINES = 2
 16243          MOVE EMI-LINE1         TO ERRMSG1O
 16244          MOVE EMI-LINE2         TO ERRMSG2O
 16245          GO TO 8000-EXIT
 16246     END-IF.
 16247
 16248     MOVE EMI-LINE1              TO ERRMSG1O.
 16249
 16250 8000-EXIT.
 16251     EXIT.
 16252
 16253 8100-SEND-INITIAL-MAP.
 16254     MOVE SAVE-DATE              TO RUNDTEO.
 16255     MOVE EIBTIME                TO TIME-IN.
 16256     MOVE TIME-OUT               TO RUNTIMEO.
 16257     IF EIBAID = DFHPF11
 16258        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16260     end-if
 16261     IF RETURNED-FROM = XCTL-114
 16262        CONTINUE
 16263     ELSE
 16264        MOVE -1                  TO MAINTL
 16265     END-IF.
 16266
 16267*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16268         MOVE SPACES             TO PRODO.
 16269         MOVE AL-SANOF           TO PRODCDA.
 16270*    END-IF.
 16271
 16272     MOVE PI-COMPANY-ID          TO COMPO.
 16273     MOVE AL-PABOF               TO COMPA.
 16274     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16275     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16276     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16277
 16278     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16279
 16280     IF NOT PI-NO-CARRIER-SECURITY
 16281        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 312
* EL130.cbl
 16282        MOVE AL-SABOF            TO CLMCARRA
 16283     END-IF.
 16284
 16285     IF PI-PROCESSOR-ID = 'PEMA'
 16286        MOVE AL-UANON            TO CERTNOA
 16287                                    SUFXA
 16288     END-IF.
 16289*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16290*        NEXT SENTENCE
 16291*        CONTINUE
 16292*    ELSE
 16293         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16294*    END-IF.
 16295
 16296
 16297
 16298* EXEC CICS SEND
 16299*        MAP     (MAP-NAME)
 16300*        MAPSET  (MAPSET-NAME)
 16301*        FROM    (EL130AO)
 16302*        ERASE
 16303*        CURSOR
 16304*    END-EXEC.
 16305     MOVE LENGTH OF
 16306      EL130AO
 16307       TO DFHEIV12
 16308     MOVE -1
 16309       TO DFHEIV11
 16310*    MOVE '8$     CT  E    H L F ,   #00014335' TO DFHEIV0
 16311     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16312     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16313     MOVE X'2020233030303134333335' TO DFHEIV0(25:11)
 16314     CALL 'kxdfhei1' USING DFHEIV0,
 16315           MAP-NAME,
 16316           EL130AO,
 16317           DFHEIV12,
 16318           MAPSET-NAME,
 16319           DFHEIV99,
 16320           DFHEIV99,
 16321           DFHEIV99,
 16322           DFHEIV11,
 16323           DFHEIV99,
 16324           DFHEIV99,
 16325           DFHEIV99
 16326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16327
 16328
 16329     GO TO 9100-RETURN-TRAN.
 16330
 16331 8150-SEND-MAP-CURSOR.
 16332     MOVE SAVE-DATE              TO RUNDTEO.
 16333     MOVE EIBTIME                TO TIME-IN.
 16334     MOVE TIME-OUT               TO RUNTIMEO.
 16335     IF EIBAID = DFHPF11
 16336        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16338     end-if
 16339     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 313
* EL130.cbl
 16340     MOVE AL-PABOF               TO COMPA
 16341     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16342     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16343     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16344
 16345*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16346         MOVE SPACES             TO PRODO.
 16347         MOVE AL-SANOF           TO PRODCDA.
 16348*    END-IF.
 16349
 16350     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16351
 16352     IF NOT PI-NO-CARRIER-SECURITY
 16353         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16354         MOVE AL-SABOF            TO CLMCARRA
 16355     END-IF.
 16356
 16357     IF PI-PROCESSOR-ID = 'PEMA'
 16358        MOVE AL-UANON            TO CERTNOA
 16359                                    SUFXA
 16360     END-IF.
 16361*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16362*        NEXT SENTENCE
 16363*        CONTINUE
 16364*    ELSE
 16365         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16366*    END-IF.
 16367
 16368
 16369
 16370* EXEC CICS SEND
 16371*        MAP      (MAP-NAME)
 16372*        MAPSET   (MAPSET-NAME)
 16373*        FROM     (EL130AO)
 16374*        CURSOR   (PI-CURSOR)
 16375*        ERASE
 16376*    END-EXEC.
 16377     MOVE LENGTH OF
 16378      EL130AO
 16379       TO DFHEIV11
 16380*    MOVE '8$     CT  E    H L F ,   #00014383' TO DFHEIV0
 16381     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16382     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16383     MOVE X'2020233030303134333833' TO DFHEIV0(25:11)
 16384     CALL 'kxdfhei1' USING DFHEIV0,
 16385           MAP-NAME,
 16386           EL130AO,
 16387           DFHEIV11,
 16388           MAPSET-NAME,
 16389           DFHEIV99,
 16390           DFHEIV99,
 16391           DFHEIV99,
 16392           PI-CURSOR,
 16393           DFHEIV99,
 16394           DFHEIV99,
 16395           DFHEIV99
 16396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16397
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 314
* EL130.cbl
 16398
 16399     GO TO 9100-RETURN-TRAN.
 16400
 16401 8200-SEND-DATAONLY.
 16402     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16403
 16404     IF EIBAID = DFHPF11
 16405        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16407        go to 8100-send-initial-map
 16408     end-if
 16409*    IF EIBAID = DFHPF11
 16410*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16411*       move pi-last-claim       to emi-claim-no
 16412*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16413*       go to 8100-send-initial-map
 16414*    END-IF.
 16415     .
 16416 8200-BYPASS-ERROR.
 16417     MOVE SAVE-DATE              TO RUNDTEO.
 16418     MOVE EIBTIME                TO TIME-IN.
 16419     MOVE TIME-OUT               TO RUNTIMEO.
 16420     MOVE PI-COMPANY-ID          TO COMPO.
 16421     MOVE AL-PABOF               TO COMPA
 16422     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16423
 16424*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16425         MOVE SPACES             TO PRODO.
 16426         MOVE AL-SANOF           TO PRODCDA.
 16427*    END-IF.
 16428
 16429     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16430     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16431
 16432     IF PI-PROCESSOR-ID = 'PEMA'
 16433        MOVE AL-UANON            TO CERTNOA
 16434                                    SUFXA
 16435     END-IF.
 16436     IF NOT PI-NO-CARRIER-SECURITY
 16437        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16438        MOVE AL-SABOF            TO CLMCARRA
 16439     END-IF.
 16440
 16441*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16442*        NEXT SENTENCE
 16443*        CONTINUE
 16444*    ELSE
 16445         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16446*    END-IF.
 16447
 16448*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16449         MOVE AL-SANOF           TO PRODCDA.
 16450*    END-IF.
 16451
 16452
 16453
 16454* EXEC CICS SEND
 16455*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 315
* EL130.cbl
 16456*        MAPSET   (MAPSET-NAME)
 16457*        FROM     (EL130AO)
 16458*        DATAONLY
 16459*        CURSOR
 16460*    END-EXEC.
 16461     MOVE LENGTH OF
 16462      EL130AO
 16463       TO DFHEIV12
 16464     MOVE -1
 16465       TO DFHEIV11
 16466*    MOVE '8$D    CT       H L F ,   #00014445' TO DFHEIV0
 16467     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16468     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16469     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 16470     CALL 'kxdfhei1' USING DFHEIV0,
 16471           MAP-NAME,
 16472           EL130AO,
 16473           DFHEIV12,
 16474           MAPSET-NAME,
 16475           DFHEIV99,
 16476           DFHEIV99,
 16477           DFHEIV99,
 16478           DFHEIV11,
 16479           DFHEIV99,
 16480           DFHEIV99,
 16481           DFHEIV99
 16482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16483
 16484
 16485     GO TO 9100-RETURN-TRAN.
 16486
 16487 8300-SEND-TEXT.
 16488
 16489
 16490* EXEC CICS SEND TEXT
 16491*        FROM     (LOGOFF-TEXT)
 16492*        LENGTH   (LOGOFF-LENGTH)
 16493*        ERASE
 16494*        FREEKB
 16495*    END-EXEC.
 16496*    MOVE '8&      T  E F  H   F -   #00014457' TO DFHEIV0
 16497     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16498     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16499     MOVE X'2020233030303134343537' TO DFHEIV0(25:11)
 16500     CALL 'kxdfhei1' USING DFHEIV0,
 16501           LOGOFF-TEXT,
 16502           LOGOFF-LENGTH,
 16503           DFHEIV99,
 16504           DFHEIV99,
 16505           DFHEIV99,
 16506           DFHEIV99,
 16507           DFHEIV99,
 16508           DFHEIV99,
 16509           DFHEIV99,
 16510           DFHEIV99,
 16511           DFHEIV99,
 16512           DFHEIV99
 16513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 316
* EL130.cbl
 16514
 16515
 16516
 16517
 16518* EXEC CICS RETURN
 16519*    END-EXEC.
 16520*    MOVE '.(                    ''   #00014465' TO DFHEIV0
 16521     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16523     MOVE X'2020233030303134343635' TO DFHEIV0(25:11)
 16524     CALL 'kxdfhei1' USING DFHEIV0,
 16525           DFHEIV99,
 16526           DFHEIV99,
 16527           DFHEIV99,
 16528           DFHEIV99,
 16529           DFHEIV99,
 16530           DFHEIV99
 16531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16532
 16533
 16534 8800-UNAUTHORIZED-ACCESS.
 16535     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16536     GO TO 8300-SEND-TEXT.
 16537
 16538 8810-PF23.
 16539     MOVE EIBAID TO PI-ENTRY-CD-1.
 16540     MOVE XCTL-005               TO PGM-NAME.
 16541     GO TO 9300-XCTL.
 16542
 16543 8820-TERM-ERROR.
 16544     MOVE ER-0412                TO EMI-ERROR.
 16545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16546     MOVE -1                     TO MAINTL.
 16547     GO TO 8200-SEND-DATAONLY.
 16548
 16549 8830-TRAN-ERROR.
 16550     MOVE ER-0413                TO EMI-ERROR.
 16551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16552     MOVE -1                     TO MAINTL.
 16553     GO TO 8200-SEND-DATAONLY.
 16554
 16555 9000-RETURN-CICS.
 16556
 16557
 16558* EXEC CICS RETURN
 16559*    END-EXEC.
 16560*    MOVE '.(                    ''   #00014491' TO DFHEIV0
 16561     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16563     MOVE X'2020233030303134343931' TO DFHEIV0(25:11)
 16564     CALL 'kxdfhei1' USING DFHEIV0,
 16565           DFHEIV99,
 16566           DFHEIV99,
 16567           DFHEIV99,
 16568           DFHEIV99,
 16569           DFHEIV99,
 16570           DFHEIV99
 16571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 317
* EL130.cbl
 16572
 16573
 16574 9100-RETURN-TRAN.
 16575     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16576     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16577
 16578
 16579
 16580* EXEC CICS RETURN
 16581*        TRANSID   (TRANS-ID)
 16582*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16583*        LENGTH    (PI-COMM-LENGTH)
 16584*    END-EXEC.
 16585*    MOVE '.(CT                  ''   #00014499' TO DFHEIV0
 16586     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16588     MOVE X'2020233030303134343939' TO DFHEIV0(25:11)
 16589     CALL 'kxdfhei1' USING DFHEIV0,
 16590           TRANS-ID,
 16591           PROGRAM-INTERFACE-BLOCK,
 16592           PI-COMM-LENGTH,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16597
 16598
 16599 9200-RETURN-MAIN-MENU.
 16600     MOVE XCTL-126               TO PGM-NAME.
 16601     GO TO 9300-XCTL.
 16602
 16603 9300-XCTL.
 16604
 16605
 16606* EXEC CICS XCTL
 16607*        PROGRAM   (PGM-NAME)
 16608*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16609*        LENGTH    (PI-COMM-LENGTH)
 16610*    END-EXEC.
 16611*    MOVE '.$C                   %   #00014511' TO DFHEIV0
 16612     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16614     MOVE X'2020233030303134353131' TO DFHEIV0(25:11)
 16615     CALL 'kxdfhei1' USING DFHEIV0,
 16616           PGM-NAME,
 16617           PROGRAM-INTERFACE-BLOCK,
 16618           PI-COMM-LENGTH,
 16619           DFHEIV99
 16620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16621
 16622
 16623 9400-CLEAR.
 16624     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16625     GO TO 9300-XCTL.
 16626
 16627 9500-PF12.
 16628     MOVE XCTL-010               TO PGM-NAME.
 16629     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 318
* EL130.cbl
 16630
 16631 9600-PGMID-ERROR.
 16632
 16633
 16634* EXEC CICS HANDLE CONDITION
 16635*        PGMIDERR  (8300-SEND-TEXT)
 16636*    END-EXEC.
 16637*    MOVE '"$L                   ! M #00014527' TO DFHEIV0
 16638     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16640     MOVE X'4D20233030303134353237' TO DFHEIV0(25:11)
 16641     CALL 'kxdfhei1' USING DFHEIV0
 16642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16643
 16644
 16645     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16646     MOVE ' '                    TO PI-ENTRY-CD-1.
 16647     MOVE XCTL-005               TO PGM-NAME.
 16648     MOVE PGM-NAME               TO LOGOFF-PGM.
 16649     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16650     GO TO 9300-XCTL.
 16651
 16652 9700-LINK-DATE-CONVERT.
 16653     MOVE LINK-ELDATCV           TO PGM-NAME.
 16654
 16655
 16656* EXEC CICS LINK
 16657*        PROGRAM    (PGM-NAME)
 16658*        COMMAREA   (DATE-CONVERSION-DATA)
 16659*        LENGTH     (DC-COMM-LENGTH)
 16660*    END-EXEC.
 16661*    MOVE '."C                   (   #00014541' TO DFHEIV0
 16662     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16664     MOVE X'2020233030303134353431' TO DFHEIV0(25:11)
 16665     CALL 'kxdfhei1' USING DFHEIV0,
 16666           PGM-NAME,
 16667           DATE-CONVERSION-DATA,
 16668           DC-COMM-LENGTH,
 16669           DFHEIV99,
 16670           DFHEIV99,
 16671           DFHEIV99,
 16672           DFHEIV99
 16673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16674
 16675
 16676 9700-EXIT.
 16677     EXIT.
 16678
 16679 9800-LINK-REM-TERM.
 16680     MOVE LINK-ELRTRM            TO PGM-NAME.
 16681
 16682
 16683* EXEC CICS LINK
 16684*        PROGRAM    (PGM-NAME)
 16685*        COMMAREA   (CALCULATION-PASS-AREA)
 16686*        LENGTH     (CP-COMM-LENGTH)
 16687*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 319
* EL130.cbl
 16688*    MOVE '."C                   (   #00014553' TO DFHEIV0
 16689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16691     MOVE X'2020233030303134353533' TO DFHEIV0(25:11)
 16692     CALL 'kxdfhei1' USING DFHEIV0,
 16693           PGM-NAME,
 16694           CALCULATION-PASS-AREA,
 16695           CP-COMM-LENGTH,
 16696           DFHEIV99,
 16697           DFHEIV99,
 16698           DFHEIV99,
 16699           DFHEIV99
 16700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16701
 16702
 16703 9800-EXIT.
 16704     EXIT.
 16705
 16706 9900-ERROR-FORMAT.
 16707*    if emi-error = 1651 or 1652 or 1653 or 1655
 16708*       display ' 9900 error ' emi-error
 16709*       display emi-message-area (1)
 16710*       display emi-message-area (2)
 16711*       display emi-message-area (3)
 16712*    end-if
 16713     IF NOT EMI-ERRORS-COMPLETE
 16714         MOVE LINK-001           TO PGM-NAME
 16715
 16716* EXEC CICS LINK
 16717*            PROGRAM   (PGM-NAME)
 16718*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16719*            LENGTH    (EMI-COMM-LENGTH)
 16720*        END-EXEC
 16721*    MOVE '."C                   (   #00014571' TO DFHEIV0
 16722     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16724     MOVE X'2020233030303134353731' TO DFHEIV0(25:11)
 16725     CALL 'kxdfhei1' USING DFHEIV0,
 16726           PGM-NAME,
 16727           ERROR-MESSAGE-INTERFACE-BLOCK,
 16728           EMI-COMM-LENGTH,
 16729           DFHEIV99,
 16730           DFHEIV99,
 16731           DFHEIV99,
 16732           DFHEIV99
 16733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16734         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16735            subtract 1 from emi-fatal-ctr
 16736         end-if
 16737     END-IF.
 16738
 16739     .
 16740 9900-EXIT.
 16741     EXIT.
 16742
 16743 9990-ABEND.
 16744     MOVE -1                     TO MAINTL.
 16745     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 320
* EL130.cbl
 16746     MOVE DFHEIBLK               TO EMI-LINE1.
 16747
 16748
 16749* EXEC CICS LINK
 16750*        PROGRAM   (PGM-NAME)
 16751*        COMMAREA  (EMI-LINE1)
 16752*        LENGTH    (72)
 16753*    END-EXEC.
 16754     MOVE 72
 16755       TO DFHEIV11
 16756*    MOVE '."C                   (   #00014590' TO DFHEIV0
 16757     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16758     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16759     MOVE X'2020233030303134353930' TO DFHEIV0(25:11)
 16760     CALL 'kxdfhei1' USING DFHEIV0,
 16761           PGM-NAME,
 16762           EMI-LINE1,
 16763           DFHEIV11,
 16764           DFHEIV99,
 16765           DFHEIV99,
 16766           DFHEIV99,
 16767           DFHEIV99
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771     MOVE EMI-LINE1              TO ERRMSG2O.
 16772
 16773     GO TO 8200-BYPASS-ERROR.
 16774
 16775
 16776
 16777* GOBACK.
 16778     MOVE '9%                    "   ' TO DFHEIV0
 16779     MOVE 'EL130' TO DFHEIV1
 16780     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16781     GOBACK.
 16782
 16783 9995-SECURITY-VIOLATION.
 16784*             COPY ELCSCTP.
 16785******************************************************************
 16786*                                                                *
 16787*                            ELCSCTP                             *
 16788*                            VMOD=2.001                          *
 16789*                                                                *
 16790*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16791******************************************************************
 16792
 16793
 16794     MOVE EIBDATE          TO SM-JUL-DATE.
 16795     MOVE EIBTRMID         TO SM-TERMID.
 16796     MOVE THIS-PGM         TO SM-PGM.
 16797     MOVE EIBTIME          TO TIME-IN.
 16798     MOVE TIME-OUT         TO SM-TIME.
 16799     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16800
 16801
 16802* EXEC CICS LINK
 16803*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 321
* EL130.cbl
 16804*         COMMAREA (SECURITY-MESSAGE)
 16805*         LENGTH   (80)
 16806*    END-EXEC.
 16807     MOVE 'EL003' TO DFHEIV1
 16808     MOVE 80
 16809       TO DFHEIV11
 16810*    MOVE '."C                   (   #00014621' TO DFHEIV0
 16811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16813     MOVE X'2020233030303134363231' TO DFHEIV0(25:11)
 16814     CALL 'kxdfhei1' USING DFHEIV0,
 16815           DFHEIV1,
 16816           SECURITY-MESSAGE,
 16817           DFHEIV11,
 16818           DFHEIV99,
 16819           DFHEIV99,
 16820           DFHEIV99,
 16821           DFHEIV99
 16822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16823
 16824
 16825******************************************************************
 16826
 16827
 16828 9995-EXIT.
 16829     EXIT.
 16830
 16831
 16832 9999-DFHBACK SECTION.
 16833     MOVE '9%                    "   ' TO DFHEIV0
 16834     MOVE 'EL130' TO DFHEIV1
 16835     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16836     GOBACK.
 16837 9999-DFHEXIT.
 16838     IF DFHEIGDJ EQUAL 0001
 16839         NEXT SENTENCE
 16840     ELSE IF DFHEIGDJ EQUAL 2
 16841         GO TO 0100-TEST-ENTRY,
 16842               8100-SEND-INITIAL-MAP,
 16843               9600-PGMID-ERROR,
 16844               8820-TERM-ERROR,
 16845               8830-TRAN-ERROR,
 16846               9990-ABEND
 16847         DEPENDING ON DFHEIGDI
 16848     ELSE IF DFHEIGDJ EQUAL 3
 16849         GO TO 0450-ADD-ELACTQ-RECORD
 16850         DEPENDING ON DFHEIGDI
 16851     ELSE IF DFHEIGDJ EQUAL 4
 16852         GO TO 8820-TERM-ERROR,
 16853               8830-TRAN-ERROR
 16854         DEPENDING ON DFHEIGDI
 16855     ELSE IF DFHEIGDJ EQUAL 5
 16856         GO TO 0660-NOT-FOUND,
 16857               0670-QIDERR
 16858         DEPENDING ON DFHEIGDI
 16859     ELSE IF DFHEIGDJ EQUAL 6
 16860         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16861         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 322
* EL130.cbl
 16862     ELSE IF DFHEIGDJ EQUAL 7
 16863         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16864         DEPENDING ON DFHEIGDI
 16865     ELSE IF DFHEIGDJ EQUAL 8
 16866         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16867         DEPENDING ON DFHEIGDI
 16868     ELSE IF DFHEIGDJ EQUAL 9
 16869         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16870         DEPENDING ON DFHEIGDI
 16871     ELSE IF DFHEIGDJ EQUAL 10
 16872         GO TO 2050-DELETE-NOT-FOUND
 16873         DEPENDING ON DFHEIGDI
 16874     ELSE IF DFHEIGDJ EQUAL 11
 16875         GO TO 2010-DELETE-CL
 16876         DEPENDING ON DFHEIGDI
 16877     ELSE IF DFHEIGDJ EQUAL 12
 16878         GO TO 3010-TEST-FOR-ERRORS
 16879         DEPENDING ON DFHEIGDI
 16880     ELSE IF DFHEIGDJ EQUAL 13
 16881         GO TO 3008-DUP-ERROR,
 16882               3009-NOT-FOUND
 16883         DEPENDING ON DFHEIGDI
 16884     ELSE IF DFHEIGDJ EQUAL 14
 16885         GO TO 3030-BUILD-CONT
 16886         DEPENDING ON DFHEIGDI
 16887     ELSE IF DFHEIGDJ EQUAL 15
 16888         GO TO 3033-ACCT-NOT-FOUND,
 16889               3033-ACCT-NOT-FOUND
 16890         DEPENDING ON DFHEIGDI
 16891     ELSE IF DFHEIGDJ EQUAL 16
 16892         GO TO 3032-NOT-IN-DT-RANGE
 16893         DEPENDING ON DFHEIGDI
 16894     ELSE IF DFHEIGDJ EQUAL 17
 16895         GO TO 3070-BUILD-CONT
 16896         DEPENDING ON DFHEIGDI
 16897     ELSE IF DFHEIGDJ EQUAL 18
 16898         GO TO 3065-CERT-NOT-FOUND
 16899         DEPENDING ON DFHEIGDI
 16900     ELSE IF DFHEIGDJ EQUAL 19
 16901         GO TO 3100-CARRIER-NOT-FOUND
 16902         DEPENDING ON DFHEIGDI
 16903     ELSE IF DFHEIGDJ EQUAL 20
 16904         GO TO 3110-COMPANY-NOT-FOUND
 16905         DEPENDING ON DFHEIGDI
 16906     ELSE IF DFHEIGDJ EQUAL 21
 16907         GO TO 3200-BUILD-ZERO-TRAILER
 16908         DEPENDING ON DFHEIGDI
 16909     ELSE IF DFHEIGDJ EQUAL 22
 16910         GO TO 9999-DFHBACK
 16911         DEPENDING ON DFHEIGDI
 16912     ELSE IF DFHEIGDJ EQUAL 23
 16913         GO TO 3290-NO-INSURED-ADDRESS
 16914         DEPENDING ON DFHEIGDI
 16915     ELSE IF DFHEIGDJ EQUAL 24
 16916         GO TO 3410-DUP-KEY
 16917         DEPENDING ON DFHEIGDI
 16918     ELSE IF DFHEIGDJ EQUAL 25
 16919         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 323
* EL130.cbl
 16920         DEPENDING ON DFHEIGDI
 16921     ELSE IF DFHEIGDJ EQUAL 26
 16922         GO TO 3850-CLAIM-MSTR-WRITTEN
 16923         DEPENDING ON DFHEIGDI
 16924     ELSE IF DFHEIGDJ EQUAL 27
 16925         GO TO 5050-CERT-NOT-FOUND
 16926         DEPENDING ON DFHEIGDI
 16927     ELSE IF DFHEIGDJ EQUAL 28
 16928         GO TO 5030-CERT-WRITTEN
 16929         DEPENDING ON DFHEIGDI
 16930     ELSE IF DFHEIGDJ EQUAL 29
 16931         GO TO 5035-CLAIM-WRITTEN
 16932         DEPENDING ON DFHEIGDI
 16933     ELSE IF DFHEIGDJ EQUAL 30
 16934         GO TO 9990-ABEND,
 16935               5799-EXIT
 16936         DEPENDING ON DFHEIGDI
 16937     ELSE IF DFHEIGDJ EQUAL 31
 16938         GO TO 3100-CARRIER-NOT-FOUND
 16939         DEPENDING ON DFHEIGDI
 16940     ELSE IF DFHEIGDJ EQUAL 32
 16941         GO TO 6040-NO-PROCESSOR-RECORD
 16942         DEPENDING ON DFHEIGDI
 16943     ELSE IF DFHEIGDJ EQUAL 33
 16944         GO TO 6060-NO-BENEFICIARY-RECORD
 16945         DEPENDING ON DFHEIGDI
 16946     ELSE IF DFHEIGDJ EQUAL 34
 16947         GO TO 6499-EXIT,
 16948               6499-EXIT
 16949         DEPENDING ON DFHEIGDI
 16950     ELSE IF DFHEIGDJ EQUAL 35
 16951         GO TO 6600-NOT-FOUND
 16952         DEPENDING ON DFHEIGDI
 16953     ELSE IF DFHEIGDJ EQUAL 36
 16954         GO TO 6700-NOTOPEN-ERROR,
 16955               6700-EXIT
 16956         DEPENDING ON DFHEIGDI
 16957     ELSE IF DFHEIGDJ EQUAL 37
 16958         GO TO 7120-NOT-FOUND
 16959         DEPENDING ON DFHEIGDI
 16960     ELSE IF DFHEIGDJ EQUAL 38
 16961         GO TO 7499-EXIT
 16962         DEPENDING ON DFHEIGDI
 16963     ELSE IF DFHEIGDJ EQUAL 39
 16964         GO TO 7500-EXIT,
 16965               7500-DUPLICATE-KEY,
 16966               7500-EXIT
 16967         DEPENDING ON DFHEIGDI
 16968     ELSE IF DFHEIGDJ EQUAL 40
 16969         GO TO 7500-END-BROWSE
 16970         DEPENDING ON DFHEIGDI
 16971     ELSE IF DFHEIGDJ EQUAL 41
 16972         GO TO 7630-END-BROWSE
 16973         DEPENDING ON DFHEIGDI
 16974     ELSE IF DFHEIGDJ EQUAL 42
 16975         GO TO 7799-EXIT,
 16976               7799-EXIT
 16977         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 324
* EL130.cbl
 16978     ELSE IF DFHEIGDJ EQUAL 43
 16979         GO TO 7790-END-BROWSE
 16980         DEPENDING ON DFHEIGDI
 16981     ELSE IF DFHEIGDJ EQUAL 44
 16982         GO TO 7992-NOT-FOUND
 16983         DEPENDING ON DFHEIGDI
 16984     ELSE IF DFHEIGDJ EQUAL 45
 16985         GO TO 8300-SEND-TEXT
 16986         DEPENDING ON DFHEIGDI.
 16987     MOVE '9%                    "   ' TO DFHEIV0
 16988     MOVE 'EL130' TO DFHEIV1
 16989     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16990     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12280     Code:       53727
