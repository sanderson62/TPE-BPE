* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53******************************************************************
    54
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   3
* EL156.cbl
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
    59
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER  PIC X(32)  VALUE '********************************'.
    64 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    65 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    66 77  WS-SSN  PIC X(9) VALUE ZEROS.
    67 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    68 77  C0                          PIC S999 COMP-3 VALUE +0.
    69 77  C1                          PIC S999 COMP-3 VALUE +0.
    70 77  C2                          PIC S999 COMP-3 VALUE +0.
    71 77  C3                          PIC S999 COMP-3 VALUE +0.
    72 77  s1                          PIC S999 COMP-3 VALUE +0.
    73 77  s2                          pic s999 comp-3 value +0.
    74 77  P1                          PIC S999 COMP-3 VALUE +0.
    75 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    76 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    77 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    78 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    80 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    81 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    82 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    83 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    84 77  ws-max-bens                 pic s999 comp-3 value +0.
    85 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    86 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    87 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    88 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    89 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    90
    91*    COPY ELCSCTM.
    92******************************************************************
    93*                                                                *
    94*                                                                *
    95*                            ELCSCTM                             *
    96*                            VMOD=2.001                          *
    97*                                                                *
    98*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    99*                                                                *
   100******************************************************************
   101 01  SECURITY-MESSAGE.
   102     12  FILLER                          PIC X(30)
   103            VALUE '** LOGIC SECURITY VIOLATION -'.
   104     12  SM-READ                         PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' PGM='.
   107     12  SM-PGM                          PIC X(6).
   108     12  FILLER                          PIC X(5)
   109            VALUE ' OPR='.
   110     12  SM-PROCESSOR-ID                 PIC X(4).
   111     12  FILLER                          PIC X(6)
   112            VALUE ' TERM='.
   113     12  SM-TERMID                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   4
* EL156.cbl
   114     12  FILLER                          PIC XX   VALUE SPACE.
   115     12  SM-JUL-DATE                     PIC 9(5).
   116     12  FILLER                          PIC X    VALUE SPACE.
   117     12  SM-TIME                         PIC 99.99.
   118
   119
   120*    COPY ELCSCRTY.
   121******************************************************************
   122*                                                                *
   123*                                                                *
   124*                            ELCSCRTY                            *
   125*                            VMOD=2.001                          *
   126*                                                                *
   127*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   128*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   129*        SAVED IN PI-SECURITY-ADDRESS.                           *
   130*                                                                *
   131******************************************************************
   132 01  SECURITY-CONTROL.
   133     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   134     12  FILLER                       PIC XX    VALUE 'SC'.
   135     12  SC-CREDIT-CODES.
   136         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   137             20  SC-CREDIT-DISPLAY    PIC X.
   138             20  SC-CREDIT-UPDATE     PIC X.
   139     12  SC-CLAIMS-CODES.
   140         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   141             20  SC-CLAIMS-DISPLAY    PIC X.
   142             20  SC-CLAIMS-UPDATE     PIC X.
   143
   144 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   145 01  WS-DATE-AREA.
   146     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   147     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   148     12  SAVE-DATE-CCYYMMDD.
   149         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   150         16  SAVE-DATE-YMD.
   151             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   152             20  FILLER              PIC X(04)   VALUE SPACES.
   153
   154 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   155 01  STANDARD-AREAS.
   156     12  WS-RESPONSE         PIC S9(8)   COMP.
   157         88  WS-RESP-NORMAL              VALUE +00.
   158         88  WS-RESP-ERROR               VALUE +01.
   159         88  WS-RESP-NOTFND              VALUE +13.
   160         88  WS-RESP-DUPREC              VALUE +14.
   161         88  WS-RESP-ENDFILE             VALUE +20.
   162     12  PMT-HEAD-A.
   163         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   164         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   165         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   166-        '     RESERVES  TYPE    AMOUNT'.
   167     12  PMT-HEAD-B.
   168         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   169         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   170         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   171     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   5
* EL156.cbl
   172     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   173     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   174     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   175     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   176     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   177     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   178     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   179     12  PGM-NAME            PIC X(8).
   180     12  TIME-IN             PIC S9(7).
   181     12  TIME-OUT-R  REDEFINES TIME-IN.
   182         16  FILLER          PIC X.
   183         16  TIME-OUT        PIC 99V99.
   184         16  FILLER          PIC XX.
   185     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   186     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   187     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   188     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   189     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   190     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   191     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   192     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   193     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   194     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   195     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   196     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   197     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   198     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   199     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   200     12  WS-BLANK            PIC X       VALUE ' '.
   201
   202 01  MISC-WORK-AREAS.
   203     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   204     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   205     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   206     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   207     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   208     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   209     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   210     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   211     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   212     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   213     12  W-CALLED-NAME           PIC X(08).
   214     12  W-EOB-CODES.
   215         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   216             20  W-EOB-CODE      PIC XXX.
   217             20  W-EOB-FILLER    PIC X.
   218     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   219     12  W-NAME-LAST             PIC X(15).
   220     12  W-NAME-FIRST            PIC X(15).
   221     12  W-NAME-MIDDLE.
   222         16  FILLER              PIC X.
   223         16  W-NAME-MIDDLE-2     PIC X.
   224         16  FILLER              PIC X(13).
   225     12  W-DMD-CHECK-NO.
   226         16  W-DMD-CHECK-NO-1    PIC X(4).
   227         16  W-DMD-CHECK-NO-2    PIC X.
   228         16  W-DMD-CHECK-NO-3    PIC XX.
   229
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   6
* EL156.cbl
   230     12  WS-COMPUTE-FROM-DT  PIC XX.
   231     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   232     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   233     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   234     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   235     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   236     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   237         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   238         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   239     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   240         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   241     12  WS-UPDATE-SW        PIC X VALUE ' '.
   242     12  WS-GROUPING.
   243         16  WS-GROUP-1      PIC X VALUE SPACES.
   244         16  FILLER          PIC X(05) VALUE SPACES.
   245     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   246     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   247     12  WS-WORK-STATE-ACCT.
   248         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   249         16  FILLER          PIC X       VALUE '/'.
   250         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   251     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   252     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   253     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   254     12  QID.
   255         16  QID-TERM        PIC X(4)    VALUE SPACES.
   256         16  FILLER          PIC X(4)    VALUE '156A'.
   257     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   258     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   259     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   260     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   261     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   262     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   263     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   264     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   265     12  WS-STATUS           PIC X       VALUE SPACES.
   266     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   267     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   268     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   269     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   270     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   271     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   272     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   273     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   274     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   275     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   276     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   277     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   278     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   279     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   280     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   281     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   282     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   283     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   284     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   285     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   286     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   287     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   7
* EL156.cbl
   288     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   289     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   290     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   291     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   292     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   293     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   294     12  WORK-DATE-FROM.
   295         16  WDF-MONTH       PIC 99        VALUE ZERO.
   296         16  WDF-DAY         PIC 99        VALUE ZERO.
   297         16  WDF-YEAR        PIC 99        VALUE ZERO.
   298     12  WORK-DATE-THRU.
   299         16  WDT-MONTH       PIC 99        VALUE ZERO.
   300         16  WDT-DAY         PIC 99        VALUE ZERO.
   301         16  WDT-YEAR        PIC 99        VALUE ZERO.
   302     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   303     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   304     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   305     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   306     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   307     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   308     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   309     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   310     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   311     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   312     12  WS-PY-WK REDEFINES WS-PY-WORK.
   313         16  WS-PY-NUM       PIC S9(7)V99.
   314         16  WS-PY-SIGN      PIC X.
   315     12  WS-DY-WORK          PIC S9(5).
   316     12  WS-DY-WK REDEFINES WS-DY-WORK.
   317         16  WS-DY-NUM       PIC S9(4).
   318         16  WS-DY-SIGN      PIC X.
   319     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   320         88  COMP-REC-FOUND              VALUE 'Y'.
   321     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   322         88  BENEFIT-FOUND       VALUE 'Y'.
   323         88  NO-BENEFIT-FOUND    VALUE 'N'.
   324     12  WS-TERMS.
   325         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   326         16  FILLER          PIC X       VALUE '/'.
   327         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   328         16  WST-REM-DAYS-GRP.
   329             20  WST-SLASH   PIC X       VALUE '/'.
   330             20  WST-REM-DAYS
   331                             PIC --9.
   332     12  WS-ACCESS.
   333         16  FILLER          PIC XX      VALUE SPACES.
   334         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   335     12  WS-STATE-ACCESS.
   336         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   337         16  FILLER          PIC XX      VALUE SPACES.
   338     12  WS-CARR-ACCESS.
   339         16  FILLER          PIC X(3)    VALUE SPACES.
   340         16  WS-CARR         PIC X       VALUE SPACES.
   341     12  DATE-WORK.
   342         16  FILLER          PIC XX      VALUE SPACES.
   343         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   344     12  WS-SAVE-INPUT.
   345         16  WS-PMTTYPE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   8
* EL156.cbl
   346         16  WS-PAYEE        PIC XX      VALUE SPACE.
   347         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   348         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   349         16  WS-OFFLINE      PIC X       VALUE SPACE.
   350         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   351         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   352         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   353         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   354         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   355         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   356         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   357         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   358         16  WS-ETYPE        PIC X       VALUE SPACE.
   359         16  WS-CASH         PIC X       VALUE SPACE.
   360         16  WS-GROUPED      PIC X       VALUE SPACE.
   361         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   362         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   363         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   364         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   365         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   366         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   367         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   368         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   369     12  LAST-ERROR-LINE.
   370         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   371         16  FILLER              PIC X(30)
   372             VALUE ' FATAL ERRORS ENCOUNTERED'.
   373         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   374         16  FILLER              PIC X(28)
   375             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   376     12  WS-CHECK-AREA.
   377         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   378         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   379     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   380     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   381         16  FILLER              PIC XX.
   382         16  WS-A-CHECK-NUM-5    PIC 9(5).
   383     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   384         16  FILLER              PIC X.
   385         16  WS-A-CHECK-NUM-6    PIC 9(6).
   386     12  OPTION-1-SAVE-AREA.
   387         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   388         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   389     12  WS-WORK-ZIP.
   390         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   391         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   392     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   393                                 PIC 9(9).
   394     12  WS-FLI-PMTNOTE.
   395         16  WS-PMTOPTION        PIC XX.
   396         16  WS-DOCNAME          PIC X(28).
   397         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   398             20  WS-AMOUNT       PIC X(8).
   399             20  FILLER          PIC X(20).
   400         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   401             20  WS-NUM-AMT      PIC 9(6)V99.
   402             20  FILLER          PIC X(20).
   403
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   9
* EL156.cbl
   404     12  WS-HAN-PMTNOTE.
   405         16  WS-HAN-PMT-CODE     PIC X.
   406         16  WS-HAN-PMT-NOTE     PIC X(39).
   407
   408     12  WS-NCL-PMT-OPTION       PIC XX.
   409         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   410
   411     12  WS-CLAIM-SEQUENCE.
   412         16  FILLER              PIC X VALUE '('.
   413         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   414         16  FILLER              PIC X(04) VALUE ' OF '.
   415         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   416         16  FILLER              PIC X VALUE ')'.
   417
   418     12  WS-REFUND-AMT           PIC Z(7).99.
   419     12  WS-CALC-INT             PIC S9(7)V99.
   420     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   421
   422     12  SUB                     PIC 99 VALUE ZEROS.
   423
   424     12  WS-BOANOTE1.
   425         16  WS-BOANOTE1-DESC    PIC X(11).
   426         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   427         16  FILLER              PIC X(17).
   428     12  WS-BOANOTE2.
   429         16  WS-BOANOTE2-DESC    PIC X(11).
   430         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   431         16  FILLER              PIC X(17).
   432
   433     12  WS-NCLNOTE1.
   434         16  WS-NCLNOTE1-DESC    PIC X(11).
   435         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   436         16  FILLER              PIC X(17).
   437     12  WS-NCLNOTE2.
   438         16  WS-NCLNOTE2-DESC    PIC X(11).
   439         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   440         16  FILLER              PIC X(17).
   441
   442     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   443     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   444     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   445     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   446     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   447     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   448     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   449     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   450     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   451     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   452
   453     12  WS-AIG-WORK-AREAS.
   454         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   455             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   456         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   457             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   458         16  WS-FROM-DATE-MDY.
   459             20  WS-FROM-MO      PIC 99.
   460             20  WS-FROM-DA      PIC 99.
   461             20  WS-FROM-YR      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  10
* EL156.cbl
   462         16  WS-TEMP-DATE-MDY.
   463             20  WS-TEMP-MO      PIC 99.
   464             20  WS-TEMP-DA      PIC 99.
   465             20  WS-TEMP-YR      PIC 99.
   466         16  WS-BIN-FROM-DT      PIC XX.
   467         16  WS-TEMP-INC-MDY.
   468             20  WS-TEMP-INC-MO  PIC 99.
   469             20  WS-TEMP-INC-DA  PIC 99.
   470             20  WS-TEMP-INC-YR  PIC 99.
   471         16  WS-PMT-DUE-MDY.
   472             20  WS-PMT-DUE-MO   PIC 99.
   473             20  WS-PMT-DUE-DA   PIC 99.
   474             20  WS-PMT-DUE-YR   PIC 99.
   475         16  WS-PMT-DUE-DT       PIC XX.
   476         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   477         16  WS-RETRO-ELIM-DT    PIC XX.
   478         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   479             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   480         16  WS-SAVE-DUE-DA      PIC 99.
   481         16  WS-CDAYS            PIC S9(05).
   482         16  WS-DAYS-OFF         PIC S9(05).
   483         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   484             88  ELIM-SATISFIED            VALUE 'Y'.
   485         16  WS-AIG-CHECKNO.
   486             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   487             20  WS-A-CHECKNO-3-7.
   488                 24  FILLER              PIC X(3)    VALUE SPACES.
   489                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   490                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   491         16  WS-AIG-GROUPING.
   492             20  WS-A-BENE               PIC XXX.
   493             20  FILLER                  PIC XXX.
   494         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   495             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   496             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   497         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   498                 VALUE 'UNEMPLOYMENT PAYMENT'.
   499         16  WS-CHK-THRU-DT              PIC XX.
   500         16  WS-HOLD-BIN-DATE-1          PIC XX.
   501
   502 01  MISC-CSO-AREA.
   503     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   504     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   505     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   506         88  APPROVAL-NEEDED                        VALUE 'Y'.
   507     12  WS-APPROV-NOTE                  PIC X(43)
   508         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   509     12  WS-REAUDIT-NOTE                 PIC X(43)
   510         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   511     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   512     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   513     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   514     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   515     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   516     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   517     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   518         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   519     12  WS-PAYEE-CITY-STATE     PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  11
* EL156.cbl
   520     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   521         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   522     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   523     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   524     12  WS-WORK-NAME            PIC X(30).
   525     12  FILLER  REDEFINES WS-WORK-NAME.
   526         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   527     12  WS-INSURED-NAME         PIC X(30).
   528     12  FILLER  REDEFINES WS-INSURED-NAME.
   529         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   530     12  WS-PAYEE-NAME           PIC X(30).
   531     12  FILLER  REDEFINES WS-PAYEE-NAME.
   532         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   533
   534 01  ERROR-MESSAGES.
   535     12  ER-0000                 PIC X(4)  VALUE '0000'.
   536     12  ER-0004                 PIC X(4)  VALUE '0004'.
   537     12  ER-0008                 PIC X(4)  VALUE '0008'.
   538     12  ER-0019                 PIC X(4)  VALUE '0019'.
   539     12  ER-0029                 PIC X(4)  VALUE '0029'.
   540     12  ER-0042                 PIC X(4)  VALUE '0042'.
   541     12  ER-0070                 PIC X(4)  VALUE '0070'.
   542     12  ER-0130                 PIC X(4)  VALUE '0130'.
   543     12  ER-0149                 PIC X(4)  VALUE '0149'.
   544     12  ER-0154                 PIC X(4)  VALUE '0154'.
   545     12  ER-0168                 PIC X(4)  VALUE '0168'.
   546     12  ER-0169                 PIC X(4)  VALUE '0169'.
   547     12  ER-0172                 PIC X(4)  VALUE '0174'.
   548     12  ER-0198                 PIC X(4)  VALUE '0198'.
   549     12  ER-0204                 PIC X(4)  VALUE '0204'.
   550     12  ER-0206                 PIC X(4)  VALUE '0206'.
   551     12  ER-0252                 PIC X(4)  VALUE '0252'.
   552     12  ER-0254                 PIC X(4)  VALUE '0254'.
   553     12  ER-0282                 PIC X(4)  VALUE '0282'.
   554     12  ER-0283                 PIC X(4)  VALUE '0283'.
   555     12  ER-0294                 PIC X(4)  VALUE '0294'.
   556     12  ER-0338                 PIC X(4)  VALUE '0338'.
   557     12  ER-0419                 PIC X(4)  VALUE '0419'.
   558     12  ER-0420                 PIC X(4)  VALUE '0420'.
   559     12  ER-0421                 PIC X(4)  VALUE '0421'.
   560     12  ER-0422                 PIC X(4)  VALUE '0422'.
   561     12  ER-0433                 PIC X(4)  VALUE '0433'.
   562     12  ER-0436                 PIC X(4)  VALUE '0436'.
   563     12  ER-0437                 PIC X(4)  VALUE '0437'.
   564     12  ER-0438                 PIC X(4)  VALUE '0438'.
   565     12  ER-0439                 PIC X(4)  VALUE '0439'.
   566     12  ER-0440                 PIC X(4)  VALUE '0440'.
   567     12  ER-0441                 PIC X(4)  VALUE '0441'.
   568     12  ER-0442                 PIC X(4)  VALUE '0442'.
   569     12  ER-0443                 PIC X(4)  VALUE '0443'.
   570     12  ER-0444                 PIC X(4)  VALUE '0444'.
   571     12  ER-0445                 PIC X(4)  VALUE '0445'.
   572     12  ER-0446                 PIC X(4)  VALUE '0446'.
   573     12  ER-0447                 PIC X(4)  VALUE '0447'.
   574     12  ER-0448                 PIC X(4)  VALUE '0448'.
   575     12  ER-0449                 PIC X(4)  VALUE '0449'.
   576     12  ER-0452                 PIC X(4)  VALUE '0452'.
   577     12  ER-0458                 PIC X(4)  VALUE '0458'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  12
* EL156.cbl
   578     12  ER-0459                 PIC X(4)  VALUE '0459'.
   579     12  ER-0460                 PIC X(4)  VALUE '0460'.
   580     12  ER-0461                 PIC X(4)  VALUE '0461'.
   581     12  ER-0462                 PIC X(4)  VALUE '0462'.
   582     12  ER-0463                 PIC X(4)  VALUE '0463'.
   583     12  ER-0464                 PIC X(4)  VALUE '0464'.
   584     12  ER-0465                 PIC X(4)  VALUE '0465'.
   585     12  ER-0466                 PIC X(4)  VALUE '0466'.
   586     12  ER-0467                 PIC X(4)  VALUE '0467'.
   587     12  ER-0468                 PIC X(4)  VALUE '0468'.
   588     12  ER-0469                 PIC X(4)  VALUE '0469'.
   589     12  ER-0473                 PIC X(4)  VALUE '0473'.
   590     12  ER-0474                 PIC X(4)  VALUE '0474'.
   591     12  ER-0475                 PIC X(4)  VALUE '0475'.
   592     12  ER-0476                 PIC X(4)  VALUE '0476'.
   593     12  ER-0477                 PIC X(4)  VALUE '0477'.
   594     12  ER-0478                 PIC X(4)  VALUE '0478'.
   595     12  ER-0479                 PIC X(4)  VALUE '0479'.
   596     12  ER-0481                 PIC X(4)  VALUE '0481'.
   597     12  ER-0491                 PIC X(4)  VALUE '0491'.
   598     12  ER-0492                 PIC X(4)  VALUE '0492'.
   599     12  ER-0493                 PIC X(4)  VALUE '0493'.
   600     12  ER-0494                 PIC X(4)  VALUE '0494'.
   601     12  ER-0495                 PIC X(4)  VALUE '0495'.
   602     12  ER-0499                 PIC X(4)  VALUE '0499'.
   603     12  ER-0500                 PIC X(4)  VALUE '0500'.
   604     12  ER-0501                 PIC X(4)  VALUE '0501'.
   605     12  ER-0502                 PIC X(4)  VALUE '0502'.
   606     12  ER-0508                 PIC X(4)  VALUE '0508'.
   607     12  ER-0513                 PIC X(4)  VALUE '0513'.
   608     12  ER-0518                 PIC X(4)  VALUE '0518'.
   609     12  ER-0524                 PIC X(4)  VALUE '0524'.
   610     12  ER-0525                 PIC X(4)  VALUE '0525'.
   611     12  ER-0526                 PIC X(4)  VALUE '0526'.
   612     12  ER-0530                 PIC X(4)  VALUE '0530'.
   613     12  ER-0540                 PIC X(4)  VALUE '0540'.
   614     12  ER-0541                 PIC X(4)  VALUE '0541'.
   615     12  ER-0542                 PIC X(4)  VALUE '0542'.
   616     12  ER-0543                 PIC X(4)  VALUE '0543'.
   617     12  ER-0545                 PIC X(4)  VALUE '0545'.
   618     12  ER-0552                 PIC X(4)  VALUE '0552'.
   619     12  ER-0555                 PIC X(4)  VALUE '0555'.
   620     12  ER-0556                 PIC X(4)  VALUE '0556'.
   621     12  ER-0557                 PIC X(4)  VALUE '0557'.
   622     12  ER-0572                 PIC X(4)  VALUE '0572'.
   623     12  ER-0573                 PIC X(4)  VALUE '0573'.
   624     12  ER-0594                 PIC X(4)  VALUE '0594'.
   625     12  ER-0616                 PIC X(4)  VALUE '0616'.
   626     12  ER-0617                 PIC X(4)  VALUE '0617'.
   627     12  ER-0618                 PIC X(4)  VALUE '0618'.
   628     12  ER-0657                 PIC X(4)  VALUE '0657'.
   629     12  ER-0658                 PIC X(4)  VALUE '0658'.
   630     12  ER-0699                 PIC X(4)  VALUE '0699'.
   631     12  ER-0730                 PIC X(4)  VALUE '0730'.
   632     12  ER-0737                 PIC X(4)  VALUE '0737'.
   633     12  ER-0760                 PIC X(4)  VALUE '0760'.
   634     12  ER-0768                 PIC X(4)  VALUE '0768'.
   635     12  ER-0769                 PIC X(4)  VALUE '0769'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  13
* EL156.cbl
   636     12  ER-0770                 PIC X(4)  VALUE '0770'.
   637     12  ER-0802                 PIC X(4)  VALUE '0802'.
   638     12  ER-0803                 PIC X(4)  VALUE '0803'.
   639     12  ER-0819                 PIC X(4)  VALUE '0819'.
   640     12  ER-0834                 PIC X(4)  VALUE '0834'.
   641     12  ER-0836                 PIC X(4)  VALUE '0836'.
   642     12  ER-0844                 PIC X(4)  VALUE '0844'.
   643     12  ER-0845                 PIC X(4)  VALUE '0845'.
   644     12  ER-0846                 PIC X(4)  VALUE '0846'.
   645     12  ER-0849                 PIC X(4)  VALUE '0849'.
   646     12  ER-0851                 PIC X(4)  VALUE '0851'.
   647     12  ER-0872                 PIC X(4)  VALUE '0872'.
   648     12  ER-0873                 PIC X(4)  VALUE '0873'.
   649     12  ER-0874                 PIC X(4)  VALUE '0874'.
   650     12  ER-0879                 PIC X(4)  VALUE '0879'.
   651     12  ER-0919                 PIC X(4)  VALUE '0919'.
   652     12  ER-0921                 PIC X(4)  VALUE '0921'.
   653     12  ER-0923                 PIC X(4)  VALUE '0923'.
   654     12  ER-0925                 PIC X(4)  VALUE '0925'.
   655     12  ER-0944                 PIC X(4)  VALUE '0944'.
   656     12  ER-0945                 PIC X(4)  VALUE '0945'.
   657     12  ER-0946                 PIC X(4)  VALUE '0946'.
   658     12  ER-0947                 PIC X(4)  VALUE '0947'.
   659     12  ER-0948                 PIC X(4)  VALUE '0948'.
   660     12  ER-0949                 PIC X(4)  VALUE '0949'.
   661     12  ER-0950                 PIC X(4)  VALUE '0950'.
   662     12  ER-0951                 PIC X(4)  VALUE '0951'.
   663     12  ER-0954                 PIC X(4)  VALUE '0954'.
   664     12  ER-0956                 PIC X(4)  VALUE '0956'.
   665     12  ER-0967                 PIC X(4)  VALUE '0967'.
   666     12  ER-0968                 PIC X(4)  VALUE '0968'.
   667     12  ER-0974                 PIC X(4)  VALUE '0974'.
   668     12  ER-0975                 PIC X(4)  VALUE '0975'.
   669     12  ER-1561                 PIC X(4)  VALUE '1561'.
   670     12  ER-1566                 PIC X(4)  VALUE '1566'.
   671     12  ER-1567                 PIC X(4)  VALUE '1567'.
   672     12  ER-1569                 PIC X(4)  VALUE '1569'.
   673     12  er-1657                 pic x(4)  value '1657'.
   674     12  er-1658                 pic x(4)  value '1658'.
   675     12  er-1667                 pic x(4)  value '1667'.
   676     12  er-1670                 pic x(4)  value '1670'.
   677     12  er-1671                 pic x(4)  value '1671'.
   678     12  er-1672                 pic x(4)  value '1672'.
   679     12  er-1673                 pic x(4)  value '1673'.
   680     12  er-1674                 pic x(4)  value '1674'.
   681     12  ER-1775                 PIC X(4)  VALUE '1775'.
   682     12  ER-1880                 PIC X(4)  VALUE '1880'.
   683     12  ER-2044                 PIC X(4)  VALUE '2044'.
   684     12  ER-3140                 PIC X(4)  VALUE '3140'.
   685     12  ER-3141                 PIC X(4)  VALUE '3141'.
   686     12  ER-3255                 PIC X(4)  VALUE '3255'.
   687     12  ER-3516                 PIC X(4)  VALUE '3516'.
   688     12  ER-3527                 PIC X(4)  VALUE '3527'.
   689     12  ER-3528                 PIC X(4)  VALUE '3528'.
   690     12  ER-3529                 PIC X(4)  VALUE '3529'.
   691     12  ER-3530                 PIC X(4)  VALUE '3530'.
   692     12  ER-3531                 PIC X(4)  VALUE '3531'.
   693     12  ER-3532                 PIC X(4)  VALUE '3532'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  14
* EL156.cbl
   694     12  ER-3533                 PIC X(4)  VALUE '3533'.
   695     12  ER-3534                 PIC X(4)  VALUE '3534'.
   696     12  ER-3535                 PIC X(4)  VALUE '3535'.
   697     12  ER-3536                 PIC X(4)  VALUE '3536'.
   698     12  ER-3537                 PIC X(4)  VALUE '3537'.
   699     12  ER-3538                 PIC X(4)  VALUE '3538'.
   700     12  ER-3539                 PIC X(4)  VALUE '3539'.
   701     12  ER-3540                 PIC X(4)  VALUE '3540'.
   702     12  ER-3541                 PIC X(4)  VALUE '3541'.
   703     12  ER-3542                 PIC X(4)  VALUE '3542'.
   704     12  ER-3543                 PIC X(4)  VALUE '3543'.
   705     12  ER-3546                 PIC X(4)  VALUE '3546'.
   706     12  ER-3549                 PIC X(4)  VALUE '3549'.
   707     12  ER-3818                 PIC X(4)  VALUE '3818'.
   708     12  ER-7540                 PIC X(4)  VALUE '7540'.
   709     12  ER-7576                 PIC X(4)  VALUE '7576'.
   710     12  ER-7579                 PIC X(4)  VALUE '7579'.
   711     12  ER-7580                 PIC X(4)  VALUE '7580'.
   712     12  ER-7583                 PIC X(4)  VALUE '7583'.
   713     12  ER-7830                 PIC X(4)  VALUE '7830'.
   714     12  ER-7831                 PIC X(4)  VALUE '7831'.
   715     12  ER-7832                 PIC X(4)  VALUE '7832'.
   716     12  ER-7833                 PIC X(4)  VALUE '7833'.
   717     12  ER-7834                 PIC X(4)  VALUE '7834'.
   718     12  ER-7835                 PIC X(4)  VALUE '7835'.
   719     12  ER-7836                 PIC X(4)  VALUE '7836'.
   720     12  ER-7837                 PIC X(4)  VALUE '7837'.
   721     12  ER-7838                 PIC X(4)  VALUE '7838'.
   722     12  ER-7841                 PIC X(4)  VALUE '7841'.
   723     12  ER-7844                 PIC X(4)  VALUE '7844'.
   724     12  ER-7845                 PIC X(4)  VALUE '7845'.
   725     12  ER-8000                 PIC X(4)  VALUE '8000'.
   726     12  ER-8051                 PIC X(4)  VALUE '8051'.
   727     12  ER-8052                 PIC X(4)  VALUE '8052'.
   728     12  ER-8053                 PIC X(4)  VALUE '8053'.
   729     12  ER-8054                 PIC X(4)  VALUE '8054'.
   730     12  ER-8055                 PIC X(4)  VALUE '8055'.
   731     12  ER-8056                 PIC X(4)  VALUE '8056'.
   732     12  ER-8057                 PIC X(4)  VALUE '8057'.
   733     12  ER-8058                 PIC X(4)  VALUE '8058'.
   734     12  ER-8059                 PIC X(4)  VALUE '8059'.
   735     12  ER-8060                 PIC X(4)  VALUE '8060'.
   736     12  ER-8061                 PIC X(4)  VALUE '8061'.
   737     12  ER-8062                 PIC X(4)  VALUE '8062'.
   738     12  ER-8063                 PIC X(4)  VALUE '8063'.
   739     12  ER-8064                 PIC X(4)  VALUE '8064'.
   740     12  ER-8065                 PIC X(4)  VALUE '8065'.
   741     12  ER-8066                 PIC X(4)  VALUE '8066'.
   742     12  ER-8146                 PIC X(4)  VALUE '8146'.
   743     12  ER-8147                 PIC X(4)  VALUE '8147'.
   744     12  ER-8152                 PIC X(4)  VALUE '8152'.
   745     12  ER-8153                 PIC X(4)  VALUE '8153'.
   746     12  ER-8154                 PIC X(4)  VALUE '8154'.
   747     12  ER-8155                 PIC X(4)  VALUE '8155'.
   748     12  ER-8310                 PIC X(4)  VALUE '8310'.
   749     12  ER-8311                 PIC X(4)  VALUE '8311'.
   750     12  ER-8312                 PIC X(4)  VALUE '8312'.
   751     12  ER-8313                 PIC X(4)  VALUE '8313'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  15
* EL156.cbl
   752     12  ER-8314                 PIC X(4)  VALUE '8314'.
   753     12  ER-8315                 PIC X(4)  VALUE '8315'.
   754     12  ER-8316                 PIC X(4)  VALUE '8316'.
   755     12  ER-8317                 PIC X(4)  VALUE '8317'.
   756
   757 01  CSO-WORK-FIELDS.
   758     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   759       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   760
   761     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   762     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   763         88  CERT-NOTE-ADDED           VALUE 'Y'.
   764     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   765         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   766     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   767
   768     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   769
   770 01  SC-NP6-CERT-NOTE.
   771     12  FILLER                  PIC X(12)
   772               VALUE 'REM BENEFIT '.
   773     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   774     12  SC-NP6-COMM             PIC X(8)
   775               VALUE ' + 6 MO '.
   776     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   777     12  FILLER                  PIC X(12)
   778               VALUE ' = AMT PAID '.
   779     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   780
   781 01  SC-NP6-ORIG-NOTE.
   782     12  FILLER                  PIC X(63)  VALUE
   783         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   784 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   785     88  PDEF-FOUND                   VALUE 'Y'.
   786 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   787     88  ACCT-FOUND                   VALUE 'Y'.
   788 01  CTBL-KEY-SAVE               PIC X(5).
   789 01  CTBL-KEY.
   790     05  CTBL-COMPANY-CD         PIC X.
   791     05  CTBL-TABLE              PIC XXX.
   792     05  CTBL-BEN-TYPE           PIC X.
   793     05  CTBL-BEN-CODE           PIC XX.
   794 01  ERPDEF-KEY-SAVE             PIC X(18).
   795 01  ERPDEF-KEY.
   796     12  ERPDEF-COMPANY-CD       PIC X.
   797     12  ERPDEF-STATE            PIC XX.
   798     12  ERPDEF-PROD-CD          PIC XXX.
   799     12  F                       PIC X(7).
   800     12  ERPDEF-BEN-TYPE         PIC X.
   801     12  ERPDEF-BEN-CODE         PIC XX.
   802     12  ERPDEF-EXP-DT           PIC XX.
   803 01  ELCRTT-KEY.
   804     05  CTRLR-COMP-CD       PIC X.
   805     05  CTRLR-CARRIER       PIC X.
   806     05  CTRLR-GROUPING      PIC X(6).
   807     05  CTRLR-STATE         PIC X(2).
   808     05  CTRLR-ACCOUNT       PIC X(10).
   809     05  CTRLR-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  16
* EL156.cbl
   810     05  CTRLR-CERT-NO       PIC X(11).
   811     05  CTRLR-REC-TYPE      PIC X.
   812 01  ACCESS-KEYS.
   813     12  ELARCH-KEY.
   814         16  ARCH-CO             PIC X.
   815         16  ARCH-NUMBER         PIC S9(08) COMP.
   816         16  ARCH-REC-TYPE       PIC X.
   817         16  ARCH-SEQ            PIC S9(04) COMP.
   818     12  ELMSTR-KEY.
   819         16  MSTR-COMP-CD        PIC X.
   820         16  MSTR-CARRIER        PIC X.
   821         16  MSTR-CLAIM-NO       PIC X(7).
   822         16  MSTR-CERT-NO        PIC X(11).
   823     12  ELCNTL-KEY.
   824         16  CNTL-COMP-ID        PIC X(3).
   825         16  CNTL-REC-TYPE       PIC X.
   826         16  CNTL-ACCESS         PIC X(4).
   827         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   828     12  ELCERT-KEY.
   829         16  CERT-COMP-CD        PIC X.
   830         16  CERT-CARRIER        PIC X.
   831         16  CERT-GROUPING       PIC X(6).
   832         16  CERT-STATE          PIC XX.
   833         16  CERT-ACCOUNT        PIC X(10).
   834         16  CERT-EFF-DT         PIC XX.
   835         16  CERT-CERT-NO        PIC X(11).
   836     12  ELTRLR-KEY.
   837         16  TRLR-COMP-CD        PIC X.
   838         16  TRLR-CARRIER        PIC X.
   839         16  TRLR-CLAIM-NO       PIC X(7).
   840         16  TRLR-CERT-NO        PIC X(11).
   841         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   842     12  ELACTQ-KEY.
   843         16  ACTQ-COMP-CD        PIC X.
   844         16  ACTQ-CARRIER        PIC X.
   845         16  ACTQ-CLAIM-NO       PIC X(7).
   846         16  ACTQ-CERT-NO        PIC X(11).
   847     12  W-NOTE-KEY.
   848         16  W-NOTE-COMP-CD      PIC X.
   849         16  W-NOTE-CERT-KEY.
   850             20  W-NOTE-CARRIER  PIC X.
   851             20  W-NOTE-GROUPING PIC X(6).
   852             20  W-NOTE-STATE    PIC XX.
   853             20  W-NOTE-ACCOUNT  PIC X(10).
   854             20  W-NOTE-EFF-DT   PIC XX.
   855             20  W-NOTE-CERT-NO  PIC X(11).
   856     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   857     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   858     12  ERACCT-KEY.
   859         16  ERACCT-PARTIAL-KEY.
   860             20  ACCT-COMP-CD    PIC X.
   861             20  ACCT-CARRIER    PIC X.
   862             20  ACCT-GROUPING   PIC X(6).
   863             20  ACCT-STATE      PIC XX.
   864             20  ACCT-ACCOUNT    PIC X(10).
   865         16  ACCT-EXP-DT         PIC XX.
   866         16  FILLER              PIC X(4) VALUE SPACES.
   867     12  ELCHKQ-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  17
* EL156.cbl
   868         16  CHKQ-COMP-CD        PIC X.
   869         16  CHKQ-CONTROL        PIC S9(8) COMP.
   870         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   871     12  ELBENE-KEY.
   872         16  BENE-COMP-CD         PIC X.
   873         16  BENE-RECORD-TYPE     PIC X.
   874         16  BENE-NUMBER          PIC X(10).
   875     12  ERCOMP-KEY.
   876         16  COMP-COMP-CD        PIC X.
   877         16  COMP-CARRIER        PIC X.
   878         16  COMP-GROUP          PIC X(06).
   879         16  COMP-FIN-RESP       PIC X(10).
   880         16  COMP-ACCOUNT        PIC X(10).
   881         16  COMP-TYPE           PIC X.
   882
   883     12  DLO035-KEY.
   884         16  DL35-PROCESS-TYPE   PIC X.
   885         16  DL35-CREDIT-CARD    PIC X(20).
   886         16  DL35-BEN-TYPE       PIC XX.
   887         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   888         16  DL35-RETURN-CODE    PIC XX.
   889
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  18
* EL156.cbl
   891*    COPY ELCDATE.
   892******************************************************************
   893*                                                                *
   894*                                                                *
   895*                            ELCDATE.                            *
   896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   897*                            VMOD=2.003
   898*                                                                *
   899*                                                                *
   900*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   901*                 LENGTH = 200                                   *
   902******************************************************************
   903
   904 01  DATE-CONVERSION-DATA.
   905     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   906     12  DC-OPTION-CODE                PIC X.
   907         88  BIN-TO-GREG                VALUE ' '.
   908         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   909         88  EDIT-GREG-TO-BIN           VALUE '2'.
   910         88  YMD-GREG-TO-BIN            VALUE '3'.
   911         88  MDY-GREG-TO-BIN            VALUE '4'.
   912         88  JULIAN-TO-BIN              VALUE '5'.
   913         88  BIN-PLUS-ELAPSED           VALUE '6'.
   914         88  FIND-CENTURY               VALUE '7'.
   915         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   916         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   917         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   918         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   919         88  JULIAN-TO-BIN-3            VALUE 'C'.
   920         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   921         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   922         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   923         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   924         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   925         88  CHECK-LEAP-YEAR            VALUE 'H'.
   926         88  BIN-3-TO-GREG              VALUE 'I'.
   927         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   928         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   929         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   930         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   931         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   932         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   933         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   934         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   935         88  THREE-CHARACTER-BIN
   936                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   937         88  GREGORIAN-TO-BIN
   938                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   939         88  BIN-TO-GREGORIAN
   940                  VALUES ' ' '1' 'I' '8' 'G'.
   941         88  JULIAN-TO-BINARY
   942                  VALUES '5' 'C' 'E' 'F'.
   943     12  DC-ERROR-CODE                 PIC X.
   944         88  NO-CONVERSION-ERROR        VALUE ' '.
   945         88  DATE-CONVERSION-ERROR
   946                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   947         88  DATE-IS-ZERO               VALUE '1'.
   948         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  19
* EL156.cbl
   949         88  DATE-IS-INVALID            VALUE '3'.
   950         88  DATE1-GREATER-DATE2        VALUE '4'.
   951         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   952         88  DATE-INVALID-OPTION        VALUE '9'.
   953         88  INVALID-CENTURY            VALUE 'A'.
   954         88  ONLY-CENTURY               VALUE 'B'.
   955         88  ONLY-LEAP-YEAR             VALUE 'C'.
   956         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   957     12  DC-END-OF-MONTH               PIC X.
   958         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   959     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   960         88  USE-NORMAL-PROCESS         VALUE ' '.
   961         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   962         88  ADJUST-UP-100-YRS          VALUE '2'.
   963     12  FILLER                        PIC X.
   964     12  DC-CONVERSION-DATES.
   965         16  DC-BIN-DATE-1             PIC XX.
   966         16  DC-BIN-DATE-2             PIC XX.
   967         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   968         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   969                       DC-GREG-DATE-1-EDIT.
   970             20  DC-EDIT1-MONTH        PIC 99.
   971             20  SLASH1-1              PIC X.
   972             20  DC-EDIT1-DAY          PIC 99.
   973             20  SLASH1-2              PIC X.
   974             20  DC-EDIT1-YEAR         PIC 99.
   975         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   976         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   977                     DC-GREG-DATE-2-EDIT.
   978             20  DC-EDIT2-MONTH        PIC 99.
   979             20  SLASH2-1              PIC X.
   980             20  DC-EDIT2-DAY          PIC 99.
   981             20  SLASH2-2              PIC X.
   982             20  DC-EDIT2-YEAR         PIC 99.
   983         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   984         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   985                     DC-GREG-DATE-1-YMD.
   986             20  DC-YMD-YEAR           PIC 99.
   987             20  DC-YMD-MONTH          PIC 99.
   988             20  DC-YMD-DAY            PIC 99.
   989         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   990         16  DC-GREG-DATE-1-MDY-R REDEFINES
   991                      DC-GREG-DATE-1-MDY.
   992             20  DC-MDY-MONTH          PIC 99.
   993             20  DC-MDY-DAY            PIC 99.
   994             20  DC-MDY-YEAR           PIC 99.
   995         16  DC-GREG-DATE-1-ALPHA.
   996             20  DC-ALPHA-MONTH        PIC X(10).
   997             20  DC-ALPHA-DAY          PIC 99.
   998             20  FILLER                PIC XX.
   999             20  DC-ALPHA-CENTURY.
  1000                 24 DC-ALPHA-CEN-N     PIC 99.
  1001             20  DC-ALPHA-YEAR         PIC 99.
  1002         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1003         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1004         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1005         16  DC-JULIAN-DATE            PIC 9(05).
  1006         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  20
* EL156.cbl
  1007                                       PIC 9(05).
  1008         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1009             20  DC-JULIAN-YEAR        PIC 99.
  1010             20  DC-JULIAN-DAYS        PIC 999.
  1011         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1012         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1013         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1014     12  DATE-CONVERSION-VARIBLES.
  1015         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1016         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1017             20  FILLER                PIC 9(3).
  1018             20  HOLD-CEN-1-CCYY.
  1019                 24  HOLD-CEN-1-CC     PIC 99.
  1020                 24  HOLD-CEN-1-YY     PIC 99.
  1021             20  HOLD-CEN-1-MO         PIC 99.
  1022             20  HOLD-CEN-1-DA         PIC 99.
  1023         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1024             20  HOLD-CEN-1-R-MO       PIC 99.
  1025             20  HOLD-CEN-1-R-DA       PIC 99.
  1026             20  HOLD-CEN-1-R-CCYY.
  1027                 24  HOLD-CEN-1-R-CC   PIC 99.
  1028                 24  HOLD-CEN-1-R-YY   PIC 99.
  1029             20  FILLER                PIC 9(3).
  1030         16  HOLD-CENTURY-1-X.
  1031             20  FILLER                PIC X(3)  VALUE SPACES.
  1032             20  HOLD-CEN-1-X-CCYY.
  1033                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1034                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1035             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1036             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1037         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1038             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1039             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1040             20  HOLD-CEN-1-R-X-CCYY.
  1041                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1042                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1043             20  FILLER                PIC XXX.
  1044         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1045         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1046         16  DC-JULIAN-DATE-1          PIC 9(07).
  1047         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1048             20  DC-JULIAN-1-CCYY.
  1049                 24  DC-JULIAN-1-CC    PIC 99.
  1050                 24  DC-JULIAN-1-YR    PIC 99.
  1051             20  DC-JULIAN-DA-1        PIC 999.
  1052         16  DC-JULIAN-DATE-2          PIC 9(07).
  1053         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1054             20  DC-JULIAN-2-CCYY.
  1055                 24  DC-JULIAN-2-CC    PIC 99.
  1056                 24  DC-JULIAN-2-YR    PIC 99.
  1057             20  DC-JULIAN-DA-2        PIC 999.
  1058         16  DC-GREG-DATE-A-EDIT.
  1059             20  DC-EDITA-MONTH        PIC 99.
  1060             20  SLASHA-1              PIC X VALUE '/'.
  1061             20  DC-EDITA-DAY          PIC 99.
  1062             20  SLASHA-2              PIC X VALUE '/'.
  1063             20  DC-EDITA-CCYY.
  1064                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  21
* EL156.cbl
  1065                 24  DC-EDITA-YEAR     PIC 99.
  1066         16  DC-GREG-DATE-B-EDIT.
  1067             20  DC-EDITB-MONTH        PIC 99.
  1068             20  SLASHB-1              PIC X VALUE '/'.
  1069             20  DC-EDITB-DAY          PIC 99.
  1070             20  SLASHB-2              PIC X VALUE '/'.
  1071             20  DC-EDITB-CCYY.
  1072                 24  DC-EDITB-CENT     PIC 99.
  1073                 24  DC-EDITB-YEAR     PIC 99.
  1074         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1075         16  DC-GREG-DATE-CYMD-R REDEFINES
  1076                              DC-GREG-DATE-CYMD.
  1077             20  DC-CYMD-CEN           PIC 99.
  1078             20  DC-CYMD-YEAR          PIC 99.
  1079             20  DC-CYMD-MONTH         PIC 99.
  1080             20  DC-CYMD-DAY           PIC 99.
  1081         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1082         16  DC-GREG-DATE-MDCY-R REDEFINES
  1083                              DC-GREG-DATE-MDCY.
  1084             20  DC-MDCY-MONTH         PIC 99.
  1085             20  DC-MDCY-DAY           PIC 99.
  1086             20  DC-MDCY-CEN           PIC 99.
  1087             20  DC-MDCY-YEAR          PIC 99.
  1088    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1089        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1090    12  DC-EL310-DATE                  PIC X(21).
  1091    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  22
* EL156.cbl
  1093*    COPY ELCLOGOF.
  1094******************************************************************
  1095*                                                                *
  1096*                                                                *
  1097*                            ELCLOGOF.                           *
  1098*                            VMOD=2.001                          *
  1099*                                                                *
  1100*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1101*                                                                *
  1102******************************************************************
  1103 01  CLASIC-LOGOFF.
  1104     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1105     12  LOGOFF-TEXT.
  1106         16  FILLER          PIC X(5)    VALUE SPACES.
  1107         16  LOGOFF-MSG.
  1108             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1109             20  FILLER      PIC X       VALUE SPACES.
  1110             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1111         16  FILLER          PIC X(80)
  1112           VALUE '* YOU ARE NOW LOGGED OFF'.
  1113         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1114         16  FILLER          PIC X       VALUE QUOTE.
  1115         16  LOGOFF-SYS-MSG  PIC X(17)
  1116           VALUE 'S CLAS-IC SYSTEM '.
  1117     12  TEXT-MESSAGES.
  1118         16  UNACCESS-MSG    PIC X(29)
  1119             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1120         16  PGMIDERR-MSG    PIC X(17)
  1121             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  23
* EL156.cbl
  1123*    COPY ELCCALC.
  1124******************************************************************
  1125*                                                                *
  1126*                           ELCCALC.                            *
  1127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1128*                            VMOD=2.025                          *
  1129*                                                                *
  1130*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1131*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1132*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1133*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1134*                                                                *
  1135*  PASSED TO ELRTRM                                              *
  1136*  -----------------                                             *
  1137*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1138*  ORIGINAL TERM                                                 *
  1139*  BEGINNING DATE                                                *
  1140*  ENDING DATE                                                   *
  1141*  COMPANY I.D.                                                  *
  1142*  ACCOUNT MASTER USER FIELD                                     *
  1143*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1144*  FREE LOOK DAYS                                                *
  1145*                                                                *
  1146*  RETURNED FROM ELRTRM                                          *
  1147*  ---------------------                                         *
  1148*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1149*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1150*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1151*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1152*----------------------------------------------------------------*
  1153*  PASSED TO ELRAMT                                              *
  1154*  ----------------                                              *
  1155*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1156*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1157*  ORIGINAL AMOUNT                                               *
  1158*  ALTERNATE BENEFIT (BALLON)                                    *
  1159*  A.P.R. - NET PAY ONLY                                         *
  1160*  METHOD
  1161*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1162*  COMPANY I.D.                                                  *
  1163*  BENEFIT TYPE                                                  *
  1164*                                                                *
  1165*  RETURNED FROM ELRAMT                                          *
  1166*  --------------------                                          *
  1167*  REMAINING AMOUNT 1 - CURRENT                                  *
  1168*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1169*  REMAINING AMOUNT FACTOR
  1170*----------------------------------------------------------------*
  1171*  PASSED TO ELRESV                                              *
  1172*  -----------------                                             *
  1173*  CERTIFICATE EFFECTIVE DATE                                    *
  1174*  VALUATION DATE                                                *
  1175*  PAID THRU DATE                                                *
  1176*  BENEFIT                                                       *
  1177*  INCURRED DATE                                                 *
  1178*  REPORTED DATE                                                 *
  1179*  ISSUE AGE                                                     *
  1180*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  24
* EL156.cbl
  1181*  CDT PERCENT                                                   *
  1182*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1183* *CLAIM TYPE (LIFE, A/H)                                        *
  1184* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1185* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1186*                                                                *
  1187*  RETURNED FROM ELRESV                                          *
  1188*  --------------------                                          *
  1189*  CDT TABLE USED                                                *
  1190*  CDT FACTOR USED                                               *
  1191*  PAY TO CURRENT RESERVE                                        *
  1192*  I.B.N.R. - A/H ONLY                                           *
  1193*  FUTURE (ACCRUED) AH ONLY                                      *
  1194*----------------------------------------------------------------*
  1195*  PASSED TO ELRATE                                              *
  1196*  ----------------                                              *
  1197*  CERT ISSUE DATE                                               *
  1198*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1199*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1200*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1201*  STATE CODE (CLIENT DEFINED)                                   *
  1202*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1203*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1204*  DEVIATION CODE                                                *
  1205*  ISSUE AGE                                                     *
  1206*  ORIGINAL BENEFIT AMOUNT                                       *
  1207*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1208*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1209*  BENEFIT KIND (LIFE OR A/H)                                    *
  1210*  A.P.R.                                                        *
  1211*  METHOD
  1212*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1213*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1214*  COMPANY I.D. (3 CHARACTER)                                    *
  1215*  BENEFIT CODE                                                  *
  1216*  BENEFIT OVERRIDE CODE                                         *
  1217*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1218*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1219*  JOINT INDICATOR (CSL ONLY)                                    *
  1220*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1221*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1222*                                                                *
  1223*  RETURNED FROM ELRATE                                          *
  1224*  --------------------                                          *
  1225*  CALCULATED PREMIUM                                            *
  1226*  PREMIUM RATE                                                  *
  1227*  MORTALITY CODE                                                *
  1228*  MAX ATTAINED AGE                                              *
  1229*  MAX AGE                                                       *
  1230*  MAX TERM                                                      *
  1231*  MAX MONTHLY BENEFIT                                           *
  1232*  MAX TOTAL BENIFIT                                             *
  1233*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1234*----------------------------------------------------------------*
  1235*  PASSED TO ELRFND                                              *
  1236*  ----------------                                              *
  1237*  CERT ISSUE DATE                                               *
  1238*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  25
* EL156.cbl
  1239*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1240*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1241*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1242*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1243*  STATE CODE (CLIENT DEFINED)                                   *
  1244*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1245*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1246*  DEVIATION CODE                                                *
  1247*  ISSUE AGE                                                     *
  1248*  ORIGINAL BENEFIT AMOUNT                                       *
  1249*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1250*  PROCESS TYPE (CANCEL)                                         *
  1251*  BENEFIT KIND (LIFE OR A/H)                                    *
  1252*  A.P.R.                                                        *
  1253*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1254*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1255*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1256*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1257*  COMPANY I.D. (3 CHARACTER)                                    *
  1258*  BENEFIT CODE                                                  *
  1259*  BENEFIT OVERRIDE CODE                                         *
  1260*                                                                *
  1261*  RETURNED FROM ELRFND                                          *
  1262*  --------------------                                          *
  1263*  CALCULATED REFUND                                             *
  1264*----------------------------------------------------------------*
  1265*  PASSED TO ELEARN                                              *
  1266*  ----------------                                              *
  1267*  CERT ISSUE DATE                                               *
  1268*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1269*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1270*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1271*  STATE CODE (CLIENT DEFINED)                                   *
  1272*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1273*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1274*  DEVIATION CODE                                                *
  1275*  ISSUE AGE                                                     *
  1276*  ORIGINAL BENEFIT AMOUNT                                       *
  1277*  BENEFIT KIND (LIFE OR A/H)                                    *
  1278*  A.P.R.                                                        *
  1279*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1280*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1281*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1282*  COMPANY I.D. (3 CHARACTER)                                    *
  1283*  BENEFIT CODE                                                  *
  1284*  BENEFIT OVERRIDE CODE                                         *
  1285*                                                                *
  1286*  RETURNED FROM ELEARN                                          *
  1287*  --------------------                                          *
  1288*  INDICATED  EARNINGS                                           *
  1289*----------------------------------------------------------------*
  1290*                 LENGTH = 450                                   *
  1291*                                                                *
  1292******************************************************************
  1293******************************************************************
  1294*                   C H A N G E   L O G
  1295*
  1296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  26
* EL156.cbl
  1297*-----------------------------------------------------------------
  1298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1299* EFFECTIVE    NUMBER
  1300*-----------------------------------------------------------------
  1301* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1302* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1303* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1304* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1305* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1306* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1307* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1308* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1309* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1310******************************************************************
  1311
  1312 01  CALCULATION-PASS-AREA.
  1313     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1314                                     COMP.
  1315
  1316     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1317       88  NO-CP-ERROR                             VALUE ZERO.
  1318       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1319                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1320       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1321       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1322       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1323       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1324       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1325       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1326       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1327       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1328       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1329       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1330       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1331       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1332       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1333       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1334       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1335       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1336       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1337
  1338     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1339       88  NO-CP-ERROR-2                           VALUE ZERO.
  1340***********************  INPUT AREAS ****************************
  1341
  1342     12  CP-CALCULATION-AREA.
  1343         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1344         16  CP-CERT-EFF-DT        PIC XX.
  1345         16  CP-VALUATION-DT       PIC XX.
  1346         16  CP-PAID-THRU-DT       PIC XX.
  1347         16  CP-BENEFIT-TYPE       PIC X.
  1348           88  CP-AH                               VALUE 'A' 'D'
  1349                                                   'I' 'U'.
  1350           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1351           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1352         16  CP-INCURRED-DT        PIC XX.
  1353         16  CP-REPORTED-DT        PIC XX.
  1354         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  27
* EL156.cbl
  1355         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1356         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1357                                     COMP-3.
  1358         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1359                                     COMP-3.
  1360         16  CP-CDT-METHOD         PIC X.
  1361           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1362           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1363           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1364         16  CP-CLAIM-TYPE         PIC X.
  1365           88  CP-AH-CLAIM                         VALUE 'A'.
  1366           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1367         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1368                                     COMP-3.
  1369         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1372                                     COMP-3.
  1373         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1374                                     COMP-3.
  1375         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1376                                     COMP-3.
  1377         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1380                                     COMP-3.
  1381         16  CP-REM-TERM-METHOD    PIC X.
  1382           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1383           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1384           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1385           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1386           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1387           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1388           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1389         16  CP-EARNING-METHOD     PIC X.
  1390           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1391           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1392           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1393           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1394           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1395           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1396           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1397           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1398           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1399           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1400           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1401           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1402           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1403           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1404         16  CP-PROCESS-TYPE       PIC X.
  1405           88  CP-CLAIM                            VALUE '1'.
  1406           88  CP-CANCEL                           VALUE '2'.
  1407           88  CP-ISSUE                            VALUE '3'.
  1408         16  CP-SPECIAL-CALC-CD    PIC X.
  1409           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1410           88  CP-1-MTH-INTEREST               VALUE ' '.
  1411           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1412           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  28
* EL156.cbl
  1413           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1414           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1415           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1416           88  CP-FARM-PLAN                    VALUE 'F'.
  1417           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1418           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1419           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1420           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1421           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1422           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1423           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1424           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1425           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1426           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1427                                                     'W' 'X'.
  1428           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1429           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1430           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1431           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1432           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1433           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1434           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1435           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1436           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1437           88  CP-CSL-METH-1                   VALUE '5'.
  1438           88  CP-CSL-METH-2                   VALUE '6'.
  1439           88  CP-CSL-METH-3                   VALUE '7'.
  1440           88  CP-CSL-METH-4                   VALUE '8'.
  1441
  1442         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1443                                     COMP-3.
  1444         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1445         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1446         16  CP-STATE              PIC XX          VALUE SPACE.
  1447         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1448         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1449           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1450               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1451         16  CP-R78-OPTION         PIC X.
  1452           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1453           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1454
  1455         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1456         16  CP-IBNR-RESERVE-SW    PIC X.
  1457         16  CP-CLAIM-STATUS       PIC X.
  1458         16  CP-RATE-FILE          PIC X.
  1459         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1460                                     COMP-3.
  1461
  1462         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1463         16  CP-AH-OVERRIDE-CODE   PIC X.
  1464
  1465         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1466                                     COMP-3.
  1467         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1468                                   PIC S9(5)V99 COMP-3.
  1469         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1470                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  29
* EL156.cbl
  1471         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1472                                     COMP-3.
  1473         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1474                                     COMP-3.
  1475         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1476                                  PIC S9(7)V99 COMP-3.
  1477
  1478         16  CP-PAID-FROM-DATE     PIC X(02).
  1479         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1480         16  CP-EXT-DAYS-CALC      PIC X.
  1481           88  CP-EXT-NO-CHG                   VALUE ' '.
  1482           88  CP-EXT-CHG-LF                   VALUE '1'.
  1483           88  CP-EXT-CHG-AH                   VALUE '2'.
  1484           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1485         16  CP-DOMICILE-STATE     PIC XX.
  1486         16  CP-CARRIER            PIC X.
  1487         16  CP-REIN-FLAG          PIC X.
  1488         16  CP-REM-TRM-CALC-OPTION PIC X.
  1489           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1490                      '2' '3' '4' '5'.
  1491           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1492           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1493           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1494           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1495           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1496           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1497           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1498           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1499         16  CP-SIG-SWITCH         PIC X.
  1500         16  CP-RATING-METHOD      PIC X.
  1501           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1502           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1503           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1504           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1505           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1506           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1507           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1508           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1509           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1510         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1511                                     COMP-3.
  1512         16  CP-BEN-CATEGORY       PIC X.
  1513         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1514         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1515                                   PIC S99V9(5) COMP-3.
  1516         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1517         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1518                                   PIC S99V9(5) COMP-3.
  1519         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1520         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1521         16  CP-EXPIRE-DT          PIC XX.
  1522         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1523         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1524         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1525         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1526         16  CP-DDF-SPEC-CALC      PIC X.
  1527             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1528             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  30
* EL156.cbl
  1529         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1530         16  CP-CANCEL-REASON      PIC X.
  1531         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1532         16  CP-PMT-MODE           PIC X.
  1533         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1534         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1535         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1536         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1537         16  FILLER                PIC X.
  1538
  1539***************    OUTPUT FROM ELRESV   ************************
  1540
  1541         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1542
  1543         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1546                                     COMP-3.
  1547         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1548                                     COMP-3.
  1549         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  FILLER                PIC X(09).
  1552***************    OUTPUT FROM ELRTRM   *************************
  1553
  1554         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1561                                     COMP-3.
  1562         16  FILLER                PIC X(12).
  1563
  1564***************    OUTPUT FROM ELRAMT   *************************
  1565
  1566         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1567                                     COMP-3.
  1568         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1569                                     COMP-3.
  1570         16  FILLER                PIC X(12).
  1571
  1572***************    OUTPUT FROM ELRATE   *************************
  1573
  1574         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1575                                     COMP-3.
  1576         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-MORTALITY-CODE     PIC X(4).
  1579         16  CP-RATE-EDIT-FLAG     PIC X.
  1580             88  CP-RATES-NEED-APR                  VALUE '1'.
  1581         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1582                                     COMP-3.
  1583         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1584         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1585         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1586                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  31
* EL156.cbl
  1587         16  FILLER                PIC X(07).
  1588
  1589***************    OUTPUT FROM ELRFND   *************************
  1590
  1591         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-REFUND-TYPE-USED   PIC X.
  1594           88  CP-R-AS-R78                         VALUE '1'.
  1595           88  CP-R-AS-PRORATA                     VALUE '2'.
  1596           88  CP-R-AS-CALIF                       VALUE '3'.
  1597           88  CP-R-AS-TEXAS                       VALUE '4'.
  1598           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1599           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1600           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1601           88  CP-R-AS-MEAN                        VALUE '8'.
  1602           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1603           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1604           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1605           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1606           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1607           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1608         16  FILLER                PIC X(12).
  1609
  1610***************    OUTPUT FROM ELEARN   *************************
  1611
  1612         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1613                                     COMP-3.
  1614         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1615                                     COMP-3.
  1616         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1617                                     COMP-3.
  1618         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1621                                     COMP-3.
  1622         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  CP-EARNING-TYPE-USED  PIC X.
  1625           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1626           88  CP-E-AS-R78                         VALUE '1'.
  1627           88  CP-E-AS-PRORATA                     VALUE '2'.
  1628           88  CP-E-AS-TEXAS                       VALUE '4'.
  1629           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1630           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1631           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1632           88  CP-E-AS-MEAN                        VALUE '8'.
  1633           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1634         16  FILLER                PIC X(12).
  1635
  1636***************    OUTPUT FROM ELPMNT   *************************
  1637
  1638         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  FILLER                PIC X(12).
  1643
  1644***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  32
* EL156.cbl
  1645         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1646                                     COMP-3.
  1647         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1648                                     COMP-3.
  1649         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1650                                     COMP-3.
  1651         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1652                                     COMP-3.
  1653         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1654                                     COMP-3.
  1655         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1658             88  OPEN-RATE-FILE                   VALUE 'O'.
  1659             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1660             88  IO-ERROR                         VALUE 'E'.
  1661
  1662         16  CP-FIRST-PAY-DATE     PIC XX.
  1663
  1664         16  CP-JOINT-INDICATOR    PIC X.
  1665
  1666         16  CP-RESERVE-REMAINING-TERM
  1667                                   PIC S9(4)V9    VALUE ZERO
  1668                                     COMP-3.
  1669
  1670         16  CP-INSURED-BIRTH-DT   PIC XX.
  1671
  1672         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1673                                     COMP-3.
  1674
  1675         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1676                                     COMP-3.
  1677
  1678         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1679                                     COMP-3.
  1680
  1681         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1682                                     COMP-3.
  1683
  1684         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1685                                     COMP-3.
  1686
  1687         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1688                                     COMP-3.
  1689
  1690         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1691                                     COMP-3.
  1692
  1693         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1694             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1695
  1696         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1697                                     COMP-3.
  1698         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1699                                     COMP-3.
  1700         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1701         16  FILLER                PIC X(15).
  1702******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  33
* EL156.cbl
  1703*    COPY ELCICALC.
  1704******************************************************************
  1705*                                                                *
  1706*                           ELCCICALC.                           *
  1707*                            VMOD=2.001                          *
  1708*                                                                *
  1709*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1710*                 CALCULATION MODULE                             *
  1711*                                                                *
  1712*  PASSED TO ELCLMI                                              *
  1713*  -----------------                                             *
  1714*  STATE                                                         *
  1715*  PRODUCT                                                       *
  1716*  COVERAGE                                                      *
  1717*  EFFECTIVE DATE                                                *
  1718*  INCURRED DATE                                                 *
  1719*  ESTABLISHED DATE                                              *
  1720*  LAST PAID DATE                                                *
  1721*  REPORTED DATE                                                 *
  1722*  CLAIM PAYMENT AMOUNT                                          *
  1723*                                                                *
  1724*  RETURNED FROM ELRTRM                                          *
  1725*  ---------------------                                         *
  1726*  RETURN CODE                                                   *
  1727*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1728*  CLAIM INTEREST AMOUNT                                         *
  1729*----------------------------------------------------------------*
  1730*----------------------------------------------------------------*
  1731*                 LENGTH = 100                                   *
  1732*                                                                *
  1733******************************************************************
  1734******************************************************************
  1735*                   C H A N G E   L O G
  1736*
  1737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1738*-----------------------------------------------------------------
  1739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1740* EFFECTIVE    NUMBER
  1741*-----------------------------------------------------------------
  1742* 120905    2004040700004  PEMA  NEW COPYBOOK
  1743* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1744******************************************************************
  1745
  1746 01  CLAIM-INT-PASS-AREA.
  1747     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1748                                     COMP.
  1749
  1750     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1751       88  NO-CI-ERROR                             VALUE ZERO.
  1752       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1753       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1754       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1755       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1756       88  CP-AMT-LT-5000                          VALUE '4'.
  1757       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1758       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1759       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1760       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  34
* EL156.cbl
  1761***********************  INPUT AREAS ****************************
  1762
  1763     12  CP-CALCULATION-AREA.
  1764         16  CP-COMPANY-CD         PIC X.
  1765         16  CP-STATE              PIC XX.
  1766         16  CP-PRODUCT            PIC XX.
  1767         16  CP-COVERAGE           PIC XX.
  1768         16  CP-INC-DT             PIC XX.
  1769         16  CP-EST-DT             PIC XX.
  1770         16  CP-LSTPD-DT           PIC XX.
  1771         16  CP-RPT-DT             PIC XX.
  1772         16  CP-PRF-DT             PIC XX.
  1773         16  CP-EFF-DT             PIC XX.
  1774         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1775         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1776         16  FILLER                PIC X(37).
  1777
  1778***************    OUTPUT FROM ELCLMI   ************************
  1779
  1780         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1781
  1782         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1783         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1784         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1785         16  FILLER                PIC X(19).
  1786******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  35
* EL156.cbl
  1788*    COPY ELCATTR.
  1789******************************************************************
  1790*                                                                *
  1791*                            ELCATTR.                            *
  1792*                            VMOD=2.001                          *
  1793*                                                                *
  1794*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1795*                                                                *
  1796*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1797*                                                                *
  1798*                   POS 1   P=PROTECTED                          *
  1799*                           U=UNPROTECTED                        *
  1800*                           S=ASKIP                              *
  1801*                   POS 2   A=ALPHA/NUMERIC                      *
  1802*                           N=NUMERIC                            *
  1803*                   POS 3   N=NORMAL                             *
  1804*                           B=BRIGHT                             *
  1805*                           D=DARK                               *
  1806*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1807*                           OF=MODIFIED DATA TAG OFF             *
  1808*                                                                *
  1809*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1810******************************************************************
  1811 01  ATTRIBUTE-LIST.
  1812     12  AL-PABOF            PIC X       VALUE 'Y'.
  1813     12  AL-PABON            PIC X       VALUE 'Z'.
  1814     12  AL-PADOF            PIC X       VALUE '%'.
  1815     12  AL-PADON            PIC X       VALUE '_'.
  1816     12  AL-PANOF            PIC X       VALUE '-'.
  1817     12  AL-PANON            PIC X       VALUE '/'.
  1818     12  AL-SABOF            PIC X       VALUE '8'.
  1819     12  AL-SABON            PIC X       VALUE '9'.
  1820     12  AL-SADOF            PIC X       VALUE '@'.
  1821     12  AL-SADON            PIC X       VALUE QUOTE.
  1822     12  AL-SANOF            PIC X       VALUE '0'.
  1823     12  AL-SANON            PIC X       VALUE '1'.
  1824     12  AL-UABOF            PIC X       VALUE 'H'.
  1825     12  AL-UABON            PIC X       VALUE 'I'.
  1826     12  AL-UADOF            PIC X       VALUE '<'.
  1827     12  AL-UADON            PIC X       VALUE '('.
  1828     12  AL-UANOF            PIC X       VALUE ' '.
  1829     12  AL-UANON            PIC X       VALUE 'A'.
  1830     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1831     12  AL-UNBON            PIC X       VALUE 'R'.
  1832     12  AL-UNDOF            PIC X       VALUE '*'.
  1833     12  AL-UNDON            PIC X       VALUE ')'.
  1834     12  AL-UNNOF            PIC X       VALUE '&'.
  1835     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  36
* EL156.cbl
  1837*    COPY ELCEMIB.
  1838******************************************************************
  1839*                                                                *
  1840*                                                                *
  1841*                            ELCEMIB.                            *
  1842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1843*                            VMOD=2.005                          *
  1844*                                                                *
  1845*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1846*                                                                *
  1847******************************************************************
  1848 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1849     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1850     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1851     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1852     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1853     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1854     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1855     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1856     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1857     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1858         88  EMI-NO-ERRORS                    VALUE '1'.
  1859         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1860         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1861     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1862         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1863     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1864         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1865         88  EMI-AREA1-FULL                   VALUE '2'.
  1866     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1867         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1868         88  EMI-AREA2-FULL                   VALUE '2'.
  1869     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1870         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1871         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1872         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1873         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1874         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1875     12  EMI-ERROR-LINES.
  1876         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1877         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1878         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1879         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1880             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1881                 24  EMI-ERR-NUM         PIC X(4).
  1882                 24  EMI-FILLER          PIC X.
  1883                 24  EMI-SEV             PIC X.
  1884                 24  FILLER              PIC X.
  1885             20  FILLER                  PIC X(02).
  1886     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1887         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1888             20  EMI-ERROR-NUMBER    PIC X(4).
  1889             20  EMI-FILL            PIC X.
  1890             20  EMI-SEVERITY        PIC X.
  1891             20  FILLER              PIC X.
  1892             20  EMI-ERROR-TEXT.
  1893                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1894                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  37
* EL156.cbl
  1895     12  EMI-SEVERITY-SAVE           PIC X.
  1896         88  EMI-NOTE                    VALUE 'N'.
  1897         88  EMI-WARNING                 VALUE 'W'.
  1898         88  EMI-FORCABLE                VALUE 'F'.
  1899         88  EMI-FATAL                   VALUE 'X'.
  1900     12  EMI-MESSAGE-FLAG            PIC X.
  1901         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1902         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1903     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1904     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1905         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1906         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1907         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1908     12  emi-claim-no                pic x(7).
  1909     12  emi-claim-type              pic x(6).
  1910     12  FILLER                      PIC X(124)  VALUE SPACES.
  1911     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1912     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1913     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1914     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  38
* EL156.cbl
  1916*    COPY ELCLNKLT.
  1917******************************************************************
  1918*                                                                *
  1919*                                                                *
  1920*                           ELCLNKLT                             *
  1921*                            VMOD=2.003                          *
  1922*                                                                *
  1923*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1924*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1925*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1926*                                                                *
  1927*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1928*   COMPLETING THE REQUIRED FIELDS.                              *
  1929*                                                                *
  1930*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1931*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1932*                              9999 INDICATES AN UNKNOWN ABEND   *
  1933*                                   WAS DETECTED.                *
  1934*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1935*                              CODES FOUND IN THE ERROR FILE.    *
  1936******************************************************************
  1937 01  W-1523-LINKDATA.
  1938     12  W-1523-COMMON-PI-DATA.
  1939         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1940         16  FILLER              PIC  X(67).
  1941         16  W-1523-COMPANY-CD   PIC  X(01).
  1942         16  FILLER              PIC  X(10).
  1943         16  W-1523-CONTROL-IN-PROGRESS.
  1944             20  W-1523-CARRIER  PIC  X(01).
  1945             20  W-1523-GROUPING PIC  X(06).
  1946             20  W-1523-STATE    PIC  X(02).
  1947             20  W-1523-ACCOUNT  PIC  X(10).
  1948             20  W-1523-CLAIM-CERT-GRP.
  1949                 24  W-1523-CLAIM-NO
  1950                                 PIC  X(07).
  1951                 24  W-1523-CERT-NO.
  1952                     28  W-1523-CERT-PRIME
  1953                                 PIC  X(10).
  1954                     28  W-1523-CERT-SFX
  1955                                 PIC  X(01).
  1956                 24  W-1523-CERT-EFF-DT
  1957                                 PIC  X(02).
  1958         16  FILLER              PIC X(265).
  1959
  1960     12  W-1523-WORK-AREA.
  1961         16  W-1523-FORM-NUMBER  PIC  X(04).
  1962         16  W-1523-NUMBER-COPIES
  1963                                 PIC  9(01).
  1964         16  W-1523-ADDR-TYPE    PIC  X(02).
  1965         16  W-1523-FOLLOW-UP-DATE
  1966                                 PIC  X(02).
  1967         16  W-1523-RESEND-DATE  PIC  X(02).
  1968         16  W-1523-ERROR-CODE   PIC  9(04).
  1969             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1970             88  W-1523-FATAL-ERROR
  1971                                    VALUES  0006 0013 0042
  1972                                            0154 0168 0169
  1973                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  39
* EL156.cbl
  1974                                            0179 0186 0281
  1975                                            0332 2055 3697
  1976                                            3698 3699 3770
  1977                                            3771 3772 7675
  1978                                            9106 9808 9883
  1979                                            9887.
  1980             88  W-1523-STOP-ERRORS
  1981                                    VALUES  0013 0042 0154
  1982                                            0168 0169 0172
  1983                                            0281 0332 2055
  1984                                            3698 3699 7675
  1985                                            9106 9808 9883
  1986                                            9999.
  1987         16  W-1523-REASON       PIC  X(70).
  1988         16  W-1523-ARCHIVE-NUMBER
  1989                                 PIC  9(08).
  1990     12  W-1523-POINTER-AREA.
  1991         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1992         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1993         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1994         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1995         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  40
* EL156.cbl
  1997*    COPY ELCNWA.
  1998*****************************************************************
  1999*                                                               *
  2000*                                                               *
  2001*                            ELCNWA.                            *
  2002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2003*                            VMOD=2.003                         *
  2004*                                                               *
  2005*            M O V E   N A M E   W O R K   A R E A.             *
  2006*                                                               *
  2007*****************************************************************.
  2008
  2009 01  WS-NAME-WORK-AREA.
  2010     05  WS-INSURED-LAST-NAME        PIC X(15).
  2011     05  WS-INSURED-1ST-NAME         PIC X(12).
  2012     05  WS-INSURED-MID-INIT         PIC X.
  2013
  2014     05  WS-NAME-WORK.
  2015         10  WS-NW                   PIC X
  2016             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2017
  2018     05  WS-NAME-WORK2.
  2019         10  WS-NW2                  PIC X
  2020             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2021                                        NWA-INDEX0.
  2022
  2023     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2024                                     COMP-3.
  2025
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  41
* EL156.cbl
  2027*    COPY ELCDMO.
  2028******************************************************************
  2029*                                                                *
  2030*                                                                *
  2031*                            ELCDMO.                             *
  2032*                            VMOD=2.004                          *
  2033*                                                                *
  2034*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2035*        COMMUNICATION AREA                                      *
  2036*   FILE TYPE = NA                                               *
  2037*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2038*                                                                *
  2039******************************************************************
  2040 01  DMO-COMMUNICATION-AREA.
  2041     12  DM-RECORD-TYPE                  PIC  X(02).
  2042             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2043             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2044             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2045     12  DM-DIST-CODE                    PIC  X(04).
  2046     12  DM-MAIL-CODE                    PIC  X(05).
  2047     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2048     12  DM-INSURED-NAME                 PIC  X(30).
  2049     12  DM-CLAIM-NO                     PIC  X(07).
  2050     12  DM-CLAIM-TYPE                   PIC  X.
  2051
  2052     12  DM-STATUS-DATA-AREA.
  2053         16  DM-CLAIM-STATUS             PIC  X.
  2054             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2055             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2056             88  DM-CLOSED                        VALUE '3'.
  2057             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2058             88  DM-DEFAULT                       VALUE '9'.
  2059         16  DM-STATUS-DATE              PIC  X(08).
  2060******YYYYMMDD
  2061         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2062             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2063             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2064             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2065             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2066             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2067             88  DM-RE-OPENED                     VALUE 'R'.
  2068             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2069             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2070             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2071         16  DM-STAT-CARRIER             PIC X.
  2072
  2073     12  DM-DRAFT-DATA-AREA.
  2074         16  DM-PAYMENT-TYPE             PIC  X.
  2075             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2076         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2077         16  DM-PAYMENT-DATE             PIC  X(08).
  2078******YYYYMMDD
  2079         16  DM-CERT-NO                  PIC  X(11).
  2080         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2081         16  DM-CARRIER                  PIC  X.
  2082
  2083     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  42
* EL156.cbl
  2085*    COPY ELCDMDCD.
  2086******************************************************************
  2087*                                                                *
  2088*                                                                *
  2089*                            ELCDMDCD.                           *
  2090*                            VMOD=2.001                          *
  2091*                                                                *
  2092*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2093*       COMMUNICATIONS AREA                                      *
  2094*                                                                *
  2095******************************************************************
  2096 01  CD-COMMUNICATION-AREA.
  2097     12  CD-SYSTEM-ID            PIC  X(02).
  2098         88 CD-CLAIMS                      VALUE 'CL'.
  2099         88 CD-CREDIT                      VALUE 'CR'.
  2100     12  CD-RECORD-TYPE          PIC  X(02).
  2101         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2102         88 CD-EOB-CODE                    VALUE 'EO'.
  2103         88 CD-ICD9-CODE                   VALUE 'I9'.
  2104         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2105         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2106         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2107         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2108         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2109     12  CD-RECORD-KEY           PIC  X(06).
  2110         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2111     12  CD-RETURN-CODE          PIC  X(02).
  2112     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2113     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2114     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2115     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  43
* EL156.cbl
  2117*    COPY ELCDCTB.
  2118******************************************************************
  2119*                                                                *
  2120*                                                                *
  2121*                            ELCDCTB.                            *
  2122*                            VMOD=2.002                          *
  2123*                                                                *
  2124*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2125*       COMMUNICATIONS AREA                                      *
  2126*                                                                *
  2127******************************************************************
  2128 01  DCT-COMMUNICATION-AREA.
  2129     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2130     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2131     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2132     12  DCT-PRODUCT-CODE         PIC  X(02).
  2133     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2134     12  DCT-RETURN-CODE          PIC  X(02).
  2135     12  DCT-MAIL-CODE            PIC  X(05).
  2136     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2137     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  44
* EL156.cbl
  2139 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2140 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2141 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2142 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  45
* EL156.cbl
  2144*    COPY ELCINTF.
  2145******************************************************************
  2146*                                                                *
  2147*                                                                *
  2148*                            ELCINTF.                            *
  2149*                            VMOD=2.017                          *
  2150*                                                                *
  2151*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2152*                                                                *
  2153*       LENGTH = 1024                                            *
  2154*                                                                *
  2155******************************************************************
  2156*                   C H A N G E   L O G
  2157*
  2158* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2159*-----------------------------------------------------------------
  2160*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2161* EFFECTIVE    NUMBER
  2162*-----------------------------------------------------------------
  2163* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2164******************************************************************
  2165 01  PROGRAM-INTERFACE-BLOCK.
  2166     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2167     12  PI-CALLING-PROGRAM              PIC X(8).
  2168     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2169     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2170     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2171     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2172     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2173     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2174     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2175     12  PI-COMPANY-ID                   PIC XXX.
  2176     12  PI-COMPANY-CD                   PIC X.
  2177
  2178     12  PI-COMPANY-PASSWORD             PIC X(8).
  2179
  2180     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2181
  2182     12  PI-CONTROL-IN-PROGRESS.
  2183         16  PI-CARRIER                  PIC X.
  2184         16  PI-GROUPING                 PIC X(6).
  2185         16  PI-STATE                    PIC XX.
  2186         16  PI-ACCOUNT                  PIC X(10).
  2187         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2188                                         PIC X(10).
  2189         16  PI-CLAIM-CERT-GRP.
  2190             20  PI-CLAIM-NO             PIC X(7).
  2191             20  PI-CERT-NO.
  2192                 25  PI-CERT-PRIME       PIC X(10).
  2193                 25  PI-CERT-SFX         PIC X.
  2194             20  PI-CERT-EFF-DT          PIC XX.
  2195         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2196             20  PI-PLAN-CODE            PIC X(2).
  2197             20  PI-REVISION-NUMBER      PIC X(3).
  2198             20  PI-PLAN-EFF-DT          PIC X(2).
  2199             20  PI-PLAN-EXP-DT          PIC X(2).
  2200             20  FILLER                  PIC X(11).
  2201         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  46
* EL156.cbl
  2202             20  PI-OE-REFERENCE-1.
  2203                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2204                 25  PI-OE-REF-1-SUFF    PIC XX.
  2205
  2206     12  PI-SESSION-IN-PROGRESS          PIC X.
  2207         88  CLAIM-SESSION                   VALUE '1'.
  2208         88  CREDIT-SESSION                  VALUE '2'.
  2209         88  WARRANTY-SESSION                VALUE '3'.
  2210         88  MORTGAGE-SESSION                VALUE '4'.
  2211         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2212
  2213
  2214*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2215
  2216     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2217     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2218
  2219     12  PI-CREDIT-USER                  PIC X.
  2220         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2221         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2222
  2223     12  PI-CLAIM-USER                   PIC X.
  2224         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2225         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2226
  2227     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2228         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2229         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2230         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2231         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2232         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2233
  2234     12  PI-PROCESSOR-ID                 PIC X(4).
  2235
  2236     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2237
  2238     12  PI-MEMBER-CAPTION               PIC X(10).
  2239
  2240     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2241         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2242
  2243     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2244     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2245     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2246     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2247
  2248     12  PI-AH-OVERRIDE-L1               PIC X.
  2249     12  PI-AH-OVERRIDE-L2               PIC XX.
  2250     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2251     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2252
  2253     12  PI-NEW-SYSTEM                   PIC X(2).
  2254
  2255     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2256     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2257         88  PI-USES-PAID-TO                 VALUE '1'.
  2258     12  PI-CRDTCRD-SYSTEM.
  2259         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  47
* EL156.cbl
  2260             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2261             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2262         16  PI-CC-MONTH-END-DT          PIC XX.
  2263     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2264
  2265     12  PI-OE-REFERENCE-2.
  2266         16  PI-OE-REF-2-PRIME           PIC X(10).
  2267         16  PI-OE-REF-2-SUFF            PIC X.
  2268
  2269     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2270
  2271     12  PI-LANGUAGE-TYPE                PIC X.
  2272             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2273             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2274             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2275
  2276     12  PI-POLICY-LINKAGE-IND           PIC X.
  2277         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2278         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2279                                                   LOW-VALUES.
  2280
  2281     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2282     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2283         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2284         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2285
  2286     12  PI-PROCESSOR-CSR-IND            PIC X.
  2287         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2288         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2289
  2290     12  FILLER                          PIC X(3).
  2291
  2292     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2293
  2294     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2295         PI-SYSTEM-LEVEL.
  2296
  2297         16  PI-ENTRY-CODES.
  2298             20  PI-ENTRY-CD-1           PIC X.
  2299             20  PI-ENTRY-CD-2           PIC X.
  2300
  2301         16  PI-RETURN-CODES.
  2302             20  PI-RETURN-CD-1          PIC X.
  2303             20  PI-RETURN-CD-2          PIC X.
  2304
  2305         16  PI-UPDATE-STATUS-SAVE.
  2306             20  PI-UPDATE-BY            PIC X(4).
  2307             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2308
  2309         16  PI-LOWER-CASE-LETTERS       PIC X.
  2310             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2311
  2312*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2313*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2314*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2315
  2316         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2317             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  48
* EL156.cbl
  2318             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2319             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2320             88  ACCNT-CNTL                  VALUE '3'.
  2321             88  CARR-ACCNT-CNTL             VALUE '4'.
  2322
  2323         16  PI-PROCESSOR-CAP-LIST.
  2324             20  PI-SYSTEM-CONTROLS.
  2325                24 PI-SYSTEM-DISPLAY     PIC X.
  2326                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2327                24 PI-SYSTEM-MODIFY      PIC X.
  2328                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2329             20  FILLER                  PIC XX.
  2330             20  PI-DISPLAY-CAP          PIC X.
  2331                 88  DISPLAY-CAP             VALUE 'Y'.
  2332             20  PI-MODIFY-CAP           PIC X.
  2333                 88  MODIFY-CAP              VALUE 'Y'.
  2334             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2335                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2336             20  PI-FORCE-CAP            PIC X.
  2337                 88  FORCE-CAP               VALUE 'Y'.
  2338
  2339         16  PI-PROGRAM-CONTROLS.
  2340             20  PI-PGM-PRINT-OPT        PIC X.
  2341             20  PI-PGM-FORMAT-OPT       PIC X.
  2342             20  PI-PGM-PROCESS-OPT      PIC X.
  2343             20  PI-PGM-TOTALS-OPT       PIC X.
  2344
  2345         16  PI-HELP-INTERFACE.
  2346             20  PI-LAST-ERROR-NO        PIC X(4).
  2347             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2348
  2349         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2350             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2351
  2352         16  PI-CR-CONTROL-IN-PROGRESS.
  2353             20  PI-CR-CARRIER           PIC X.
  2354             20  PI-CR-GROUPING          PIC X(6).
  2355             20  PI-CR-STATE             PIC XX.
  2356             20  PI-CR-ACCOUNT           PIC X(10).
  2357             20  PI-CR-FIN-RESP          PIC X(10).
  2358             20  PI-CR-TYPE              PIC X.
  2359
  2360         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2361
  2362         16  PI-CR-MONTH-END-DT          PIC XX.
  2363
  2364         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2365             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2366             88  PI-ZERO-CARRIER             VALUE '1'.
  2367             88  PI-ZERO-GROUPING            VALUE '2'.
  2368             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2369
  2370         16  PI-CARRIER-SECURITY         PIC X.
  2371             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2372
  2373         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2374             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2375             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  49
* EL156.cbl
  2376
  2377         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2378             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2379                                         INDEXED BY PI-ACCESS-NDX
  2380                                         PIC X.
  2381
  2382         16  PI-GA-BILLING-CONTROL       PIC X.
  2383             88  PI-GA-BILLING               VALUE '1'.
  2384
  2385         16  PI-MAIL-PROCESSING          PIC X.
  2386             88  PI-MAIL-YES                 VALUE 'Y'.
  2387
  2388         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2389
  2390         16  PI-AR-SYSTEM.
  2391             20  PI-AR-PROCESSING-CNTL   PIC X.
  2392                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2393             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2394             20  PI-AR-MONTH-END-DT      PIC XX.
  2395
  2396         16  PI-MP-SYSTEM.
  2397             20  PI-MORTGAGE-USER            PIC X.
  2398                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2399                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2400             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2401                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2402                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2403                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2404                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2405                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2406             20  PI-MP-MONTH-END-DT          PIC XX.
  2407             20  PI-MP-REFERENCE-NO.
  2408                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2409                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2410
  2411         16  PI-LABEL-CONTROL            PIC X(01).
  2412             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2413             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2414
  2415         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2416             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2417
  2418         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2419             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2420             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2421
  2422         16  FILLER                      PIC X(14).
  2423
  2424     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2425******************************************************************
  2426     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2427         16  PI-SAVE-FORM        PIC X(12).
  2428         16  PI-ACCT-KEY         PIC X(26).
  2429         16  PI-PAYEE-NAME       PIC X(30).
  2430         16  PI-DAILY-RATE       PIC S9(3)V99.
  2431         16  PI-MONTH-END-SAVE   PIC XX.
  2432         16  PI-BENEFIT-SAVE.
  2433             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  50
* EL156.cbl
  2434             20  PI-BEN-TYPE     PIC X.
  2435         16  PI-MANUAL-SW        PIC 9.
  2436         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2437         16  PI-PASS-SW          PIC X.
  2438         16  PI-PFKEY-USED       PIC X.
  2439         16  PI-CK-ASSIGN        PIC X.
  2440         16  PI-FATAL-COUNT      PIC 99.
  2441         16  PI-FORCE-COUNT      PIC 99.
  2442         16  PI-SAVE-INPUT.
  2443             20  PI-PMTTYPE      PIC X.
  2444             20  PI-PAYEE.
  2445                 24  PI-PAYEE-TYPE PIC X.
  2446                 24  PI-PAYEE-SEQ  PIC X.
  2447                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2448                   PI-PAYEE-SEQ    PIC S9.
  2449             20  PI-PMTNOTE1     PIC X(60).
  2450             20  PI-PMTNOTE2     PIC X(60).
  2451             20  PI-OFFLINE      PIC X.
  2452             20  PI-ECHECKNO     PIC X(7).
  2453             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2454                 28  PI-ECHECKNO-N     PIC X.
  2455                 28  PI-ECHECKNO-6     PIC X(6).
  2456             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2457                 24  PI-ECHECKNO-CR    PIC XX.
  2458                 24  PI-ECHECKNO-5     PIC X(5).
  2459             20  PI-HOLDTIL      PIC 9(6).
  2460             20  PI-EPYFROM      PIC 9(6).
  2461             20  PI-EPYTHRU      PIC 9(6).
  2462             20  PI-EDAYS        PIC S9(5).
  2463             20  PI-EPYAMT       PIC S9(7)V99.
  2464             20  PI-ERESV        PIC S9(7)V99.
  2465             20  PI-EEXPENS      PIC 9(6)V99.
  2466             20  PI-ETYPE        PIC X.
  2467             20  PI-CASH         PIC X.
  2468             20  PI-GROUPED      PIC X.
  2469             20  PI-INT-RATE     PIC S99V9(5).
  2470             20  PI-AIGFROM      PIC 9(6).
  2471             20  PI-LOAN-NO      PIC X(20).
  2472             20  PI-PROOF-DATE   PIC 9(6).
  2473             20  PI-PRINT-EOB-YN PIC X.
  2474             20  PI-PRINT-CLM-FRM-YN PIC X.
  2475             20  PI-PRINT-SURVEY-YN PIC X.
  2476             20  PI-SPECIAL-RELEASE-YN PIC X.
  2477         16  PI-SAVE-COMPUTED.
  2478             20  PI-CCHECKNO     PIC X(7).
  2479             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2480                 28  PI-CCHECKNO-N     PIC X.
  2481                 28  PI-CCHECKNO-6     PIC X(6).
  2482             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2483                 24  PI-CCHECKNO-CR    PIC XX.
  2484                 24  PI-CCHECKNO-5     PIC X(5).
  2485             20  PI-CPYFROM      PIC XX.
  2486             20  PI-CPYTHRU      PIC XX.
  2487             20  PI-CDAYS        PIC S9(5).
  2488             20  PI-CPYAMT       PIC S9(7)V99.
  2489             20  PI-CRESV        PIC 9(6)V99.
  2490             20  PI-CEXPENS      PIC 9(6)V99.
  2491             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  51
* EL156.cbl
  2492                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2493                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2494                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2495         16  PI-PREV-CLMNO       PIC X(7).
  2496         16  PI-LF-COVERAGE-TYPE PIC X.
  2497         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2498         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2499         16  PI-PROVISIONAL-IND  PIC X.
  2500             88 PI-PROV-PMT      VALUE 'P'.
  2501         16  PI-PREV-TRLR-KEY    PIC X(22).
  2502         16  PI-SPLIT-PMT-SW     PIC X.
  2503         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2504         16  PI-ACTIVITY-CODE    PIC 99.
  2505         16  PI-RESET-SW         PIC X.
  2506         16  PI-SPECIAL-BEN-SW   PIC X.
  2507             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2508         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2509         16  PI-EXP-DT           PIC XX.
  2510         16  PI-LOAN-DUE-DAY     PIC 99.
  2511         16  PI-3RD-PARTY-SW     PIC X.
  2512         16  PI-LOAN-UPDATE-SW   PIC X.
  2513
  2514         16  PI-DMD-DATA.
  2515             20  PI-SV-CERT-KEY       PIC X(21).
  2516             20  PI-SV-CERT-NO        PIC X(11).
  2517             20  PI-SV-BEN            PIC X(10).
  2518             20  PI-SV-CCN            PIC X(16).
  2519             20  PI-INTEREST-PAID-IND PIC X.
  2520                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2521             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2522             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2523             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2524             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2525         16  PI-AT-EOB-CODES.
  2526             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2527         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2528         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2529         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2530         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2531         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2532         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2533         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2534         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2535         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2536         16  PI-LF-BENEFIT-CD         PIC X(2).
  2537         16  PI-EOB-CODES-EXIST PIC X.
  2538         16  PI-SET-NOTE2-MDT   PIC X.
  2539         16  PI-VFY-2ND-BENE          PIC X.
  2540         16  PI-CLM-TYPE              PIC X.
  2541         16  PI-APPROVAL-LEVEL        PIC X.
  2542         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2543         16  PI-REAUDIT-NEEDED        PIC X.
  2544         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2545         16  PI-AH-BENEFIT-CD         PIC XX.
  2546         16  pi-ah-term               pic s999 comp-3.
  2547         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2548         16  pi-max-ext               pic 999.
  2549         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  52
* EL156.cbl
  2550*00781          16  FILLER                   PIC X(176).
  2551*052506         16  FILLER                   PIC X(161).
  2552*031808         16  FILLER                   PIC X(154).
  2553*091808         16  FILLER                   PIC X(152).
  2554*041710         16  FILLER                   PIC X(94).
  2555         16  FILLER                   PIC X(70).
  2556
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  53
* EL156.cbl
  2558*    COPY ELCJPFX.
  2559******************************************************************
  2560*                                                                *
  2561*                                                                *
  2562*                            ELCJPFX.                            *
  2563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2564*                            VMOD=2.002                          *
  2565*                                                                *
  2566*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2567*                                                                *
  2568*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2569*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2570*        ELCNTL - CONTROL FILE                                   *
  2571*        ELMSTR - CLAIM MASTERS                                  *
  2572*        ELTRLR - ACTIVITY TRAILERS                              *
  2573*        ELCHKQ - CHECK QUE                                      *
  2574******************************************************************
  2575 01  JOURNAL-RECORD.
  2576     12  jp-date                     pic s9(5) comp-3.
  2577     12  jp-time                     pic s9(7) comp-3.
  2578     12  JP-USER-ID                  PIC X(4).
  2579     12  JP-FILE-ID                  PIC X(8).
  2580     12  JP-PROGRAM-ID               PIC X(8).
  2581     12  JP-RECORD-TYPE              PIC X.
  2582         88 JP-ADD              VALUE 'A'.
  2583         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2584         88 JP-AFTER-CHANGE     VALUE 'C'.
  2585         88 JP-DELETE           VALUE 'D'.
  2586         88 JP-GENERIC-DELETE   VALUE 'G'.
  2587         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2588         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2589     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2590     12  JP-RECORD-AREA
  2591
  2592
  2593                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  54
* EL156.cbl
  2595*    COPY ELCAID.
  2596******************************************************************
  2597*                                                                *
  2598*                            ELCAID.                             *
  2599*                            VMOD=2.001                          *
  2600*                                                                *
  2601*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2602*                                                                *
  2603*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2604*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2605******************************************************************
  2606
  2607 01  DFHAID.
  2608   02  DFHNULL   PIC  X  VALUE  ' '.
  2609   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2610   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2611   02  DFHPEN    PIC  X  VALUE  '='.
  2612   02  DFHOPID   PIC  X  VALUE  'W'.
  2613   02  DFHPA1    PIC  X  VALUE  '%'.
  2614   02  DFHPA2    PIC  X  VALUE  '>'.
  2615   02  DFHPA3    PIC  X  VALUE  ','.
  2616   02  DFHPF1    PIC  X  VALUE  '1'.
  2617   02  DFHPF2    PIC  X  VALUE  '2'.
  2618   02  DFHPF3    PIC  X  VALUE  '3'.
  2619   02  DFHPF4    PIC  X  VALUE  '4'.
  2620   02  DFHPF5    PIC  X  VALUE  '5'.
  2621   02  DFHPF6    PIC  X  VALUE  '6'.
  2622   02  DFHPF7    PIC  X  VALUE  '7'.
  2623   02  DFHPF8    PIC  X  VALUE  '8'.
  2624   02  DFHPF9    PIC  X  VALUE  '9'.
  2625   02  DFHPF10   PIC  X  VALUE  ':'.
  2626   02  DFHPF11   PIC  X  VALUE  '#'.
  2627   02  DFHPF12   PIC  X  VALUE  '@'.
  2628   02  DFHPF13   PIC  X  VALUE  'A'.
  2629   02  DFHPF14   PIC  X  VALUE  'B'.
  2630   02  DFHPF15   PIC  X  VALUE  'C'.
  2631   02  DFHPF16   PIC  X  VALUE  'D'.
  2632   02  DFHPF17   PIC  X  VALUE  'E'.
  2633   02  DFHPF18   PIC  X  VALUE  'F'.
  2634   02  DFHPF19   PIC  X  VALUE  'G'.
  2635   02  DFHPF20   PIC  X  VALUE  'H'.
  2636   02  DFHPF21   PIC  X  VALUE  'I'.
  2637*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2638   02  DFHPF22   PIC  X  VALUE  '['.
  2639   02  DFHPF23   PIC  X  VALUE  '.'.
  2640   02  DFHPF24   PIC  X  VALUE  '<'.
  2641   02  DFHMSRE   PIC  X  VALUE  'X'.
  2642   02  DFHSTRF   PIC  X  VALUE  'h'.
  2643   02  DFHTRIG   PIC  X  VALUE  '"'.
  2644 01  FILLER    REDEFINES DFHAID.
  2645     12  FILLER              PIC X(8).
  2646     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  55
* EL156.cbl
  2648*    COPY EL156S.
  2649 01  EL156AI.
  2650     05  FILLER            PIC  X(0012).
  2651*    -------------------------------
  2652     05  RUNDTEAL PIC S9(0004) COMP.
  2653     05  RUNDTEAF PIC  X(0001).
  2654     05  FILLER REDEFINES RUNDTEAF.
  2655         10  RUNDTEAA PIC  X(0001).
  2656     05  RUNDTEAI PIC  X(0008).
  2657*    -------------------------------
  2658     05  RUNTIMAL PIC S9(0004) COMP.
  2659     05  RUNTIMAF PIC  X(0001).
  2660     05  FILLER REDEFINES RUNTIMAF.
  2661         10  RUNTIMAA PIC  X(0001).
  2662     05  RUNTIMAI PIC  X(0005).
  2663*    -------------------------------
  2664     05  SEQUL PIC S9(0004) COMP.
  2665     05  SEQUF PIC  X(0001).
  2666     05  FILLER REDEFINES SEQUF.
  2667         10  SEQUA PIC  X(0001).
  2668     05  SEQUI PIC  X(0010).
  2669*    -------------------------------
  2670     05  CLMNOL PIC S9(0004) COMP.
  2671     05  CLMNOF PIC  X(0001).
  2672     05  FILLER REDEFINES CLMNOF.
  2673         10  CLMNOA PIC  X(0001).
  2674     05  CLMNOI PIC  X(0007).
  2675*    -------------------------------
  2676     05  CARRL PIC S9(0004) COMP.
  2677     05  CARRF PIC  X(0001).
  2678     05  FILLER REDEFINES CARRF.
  2679         10  CARRA PIC  X(0001).
  2680     05  CARRI PIC  X(0001).
  2681*    -------------------------------
  2682     05  CERTNOL PIC S9(0004) COMP.
  2683     05  CERTNOF PIC  X(0001).
  2684     05  FILLER REDEFINES CERTNOF.
  2685         10  CERTNOA PIC  X(0001).
  2686     05  CERTNOI PIC  X(0010).
  2687*    -------------------------------
  2688     05  SUFXL PIC S9(0004) COMP.
  2689     05  SUFXF PIC  X(0001).
  2690     05  FILLER REDEFINES SUFXF.
  2691         10  SUFXA PIC  X(0001).
  2692     05  SUFXI PIC  X(0001).
  2693*    -------------------------------
  2694     05  CLMTYPL PIC S9(0004) COMP.
  2695     05  CLMTYPF PIC  X(0001).
  2696     05  FILLER REDEFINES CLMTYPF.
  2697         10  CLMTYPA PIC  X(0001).
  2698     05  CLMTYPI PIC  X(0006).
  2699*    -------------------------------
  2700     05  CLMSTATL PIC S9(0004) COMP.
  2701     05  CLMSTATF PIC  X(0001).
  2702     05  FILLER REDEFINES CLMSTATF.
  2703         10  CLMSTATA PIC  X(0001).
  2704     05  CLMSTATI PIC  X(0006).
  2705*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  56
* EL156.cbl
  2706     05  LSTNMEL PIC S9(0004) COMP.
  2707     05  LSTNMEF PIC  X(0001).
  2708     05  FILLER REDEFINES LSTNMEF.
  2709         10  LSTNMEA PIC  X(0001).
  2710     05  LSTNMEI PIC  X(0015).
  2711*    -------------------------------
  2712     05  FSTNMEL PIC S9(0004) COMP.
  2713     05  FSTNMEF PIC  X(0001).
  2714     05  FILLER REDEFINES FSTNMEF.
  2715         10  FSTNMEA PIC  X(0001).
  2716     05  FSTNMEI PIC  X(0012).
  2717*    -------------------------------
  2718     05  MINITL PIC S9(0004) COMP.
  2719     05  MINITF PIC  X(0001).
  2720     05  FILLER REDEFINES MINITF.
  2721         10  MINITA PIC  X(0001).
  2722     05  MINITI PIC  X(0001).
  2723*    -------------------------------
  2724     05  PRIMHDGL PIC S9(0004) COMP.
  2725     05  PRIMHDGF PIC  X(0001).
  2726     05  FILLER REDEFINES PRIMHDGF.
  2727         10  PRIMHDGA PIC  X(0001).
  2728     05  PRIMHDGI PIC  X(0012).
  2729*    -------------------------------
  2730     05  PCERTNOL PIC S9(0004) COMP.
  2731     05  PCERTNOF PIC  X(0001).
  2732     05  FILLER REDEFINES PCERTNOF.
  2733         10  PCERTNOA PIC  X(0001).
  2734     05  PCERTNOI PIC  X(0010).
  2735*    -------------------------------
  2736     05  PSUFXL PIC S9(0004) COMP.
  2737     05  PSUFXF PIC  X(0001).
  2738     05  FILLER REDEFINES PSUFXF.
  2739         10  PSUFXA PIC  X(0001).
  2740     05  PSUFXI PIC  X(0001).
  2741*    -------------------------------
  2742     05  STATUSL PIC S9(0004) COMP.
  2743     05  STATUSF PIC  X(0001).
  2744     05  FILLER REDEFINES STATUSF.
  2745         10  STATUSA PIC  X(0001).
  2746     05  STATUSI PIC  X(0010).
  2747*    -------------------------------
  2748     05  LOANHL PIC S9(0004) COMP.
  2749     05  LOANHF PIC  X(0001).
  2750     05  FILLER REDEFINES LOANHF.
  2751         10  LOANHA PIC  X(0001).
  2752     05  LOANHI PIC  X(0014).
  2753*    -------------------------------
  2754     05  LOANNOL PIC S9(0004) COMP.
  2755     05  LOANNOF PIC  X(0001).
  2756     05  FILLER REDEFINES LOANNOF.
  2757         10  LOANNOA PIC  X(0001).
  2758     05  LOANNOI PIC  X(0025).
  2759*    -------------------------------
  2760     05  DUEDAYHL PIC S9(0004) COMP.
  2761     05  DUEDAYHF PIC  X(0001).
  2762     05  FILLER REDEFINES DUEDAYHF.
  2763         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  57
* EL156.cbl
  2764     05  DUEDAYHI PIC  X(0008).
  2765*    -------------------------------
  2766     05  DUEDAYL PIC S9(0004) COMP.
  2767     05  DUEDAYF PIC  X(0001).
  2768     05  FILLER REDEFINES DUEDAYF.
  2769         10  DUEDAYA PIC  X(0001).
  2770     05  DUEDAYI PIC  X(0002).
  2771*    -------------------------------
  2772     05  ZINTHL PIC S9(0004) COMP.
  2773     05  ZINTHF PIC  X(0001).
  2774     05  FILLER REDEFINES ZINTHF.
  2775         10  ZINTHA PIC  X(0001).
  2776     05  ZINTHI PIC  X(0009).
  2777*    -------------------------------
  2778     05  ZINTL PIC S9(0004) COMP.
  2779     05  ZINTF PIC  X(0001).
  2780     05  FILLER REDEFINES ZINTF.
  2781         10  ZINTA PIC  X(0001).
  2782     05  ZINTI PIC  99V99999.
  2783*    -------------------------------
  2784     05  PTHRHDGL PIC S9(0004) COMP.
  2785     05  PTHRHDGF PIC  X(0001).
  2786     05  FILLER REDEFINES PTHRHDGF.
  2787         10  PTHRHDGA PIC  X(0001).
  2788     05  PTHRHDGI PIC  X(0014).
  2789*    -------------------------------
  2790     05  PDTHRUL PIC S9(0004) COMP.
  2791     05  PDTHRUF PIC  X(0001).
  2792     05  FILLER REDEFINES PDTHRUF.
  2793         10  PDTHRUA PIC  X(0001).
  2794     05  PDTHRUI PIC  X(0008).
  2795*    -------------------------------
  2796     05  TOTPAIDL PIC S9(0004) COMP.
  2797     05  TOTPAIDF PIC  X(0001).
  2798     05  FILLER REDEFINES TOTPAIDF.
  2799         10  TOTPAIDA PIC  X(0001).
  2800     05  TOTPAIDI PIC  X(0010).
  2801*    -------------------------------
  2802     05  COVERL PIC S9(0004) COMP.
  2803     05  COVERF PIC  X(0001).
  2804     05  FILLER REDEFINES COVERF.
  2805         10  COVERA PIC  X(0001).
  2806     05  COVERI PIC  X(0010).
  2807*    -------------------------------
  2808     05  INCURL PIC S9(0004) COMP.
  2809     05  INCURF PIC  X(0001).
  2810     05  FILLER REDEFINES INCURF.
  2811         10  INCURA PIC  X(0001).
  2812     05  INCURI PIC  X(0008).
  2813*    -------------------------------
  2814     05  LSTDTEL PIC S9(0004) COMP.
  2815     05  LSTDTEF PIC  X(0001).
  2816     05  FILLER REDEFINES LSTDTEF.
  2817         10  LSTDTEA PIC  X(0001).
  2818     05  LSTDTEI PIC  X(0008).
  2819*    -------------------------------
  2820     05  CRTSTATL PIC S9(0004) COMP.
  2821     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  58
* EL156.cbl
  2822     05  FILLER REDEFINES CRTSTATF.
  2823         10  CRTSTATA PIC  X(0001).
  2824     05  CRTSTATI PIC  X(0010).
  2825*    -------------------------------
  2826     05  EFFECTL PIC S9(0004) COMP.
  2827     05  EFFECTF PIC  X(0001).
  2828     05  FILLER REDEFINES EFFECTF.
  2829         10  EFFECTA PIC  X(0001).
  2830     05  EFFECTI PIC  X(0008).
  2831*    -------------------------------
  2832     05  TERMSL PIC S9(0004) COMP.
  2833     05  TERMSF PIC  X(0001).
  2834     05  FILLER REDEFINES TERMSF.
  2835         10  TERMSA PIC  X(0001).
  2836     05  TERMSI PIC  X(0011).
  2837*    -------------------------------
  2838     05  STACCTL PIC S9(0004) COMP.
  2839     05  STACCTF PIC  X(0001).
  2840     05  FILLER REDEFINES STACCTF.
  2841         10  STACCTA PIC  X(0001).
  2842     05  STACCTI PIC  X(0013).
  2843*    -------------------------------
  2844     05  EXPDTEHL PIC S9(0004) COMP.
  2845     05  EXPDTEHF PIC  X(0001).
  2846     05  FILLER REDEFINES EXPDTEHF.
  2847         10  EXPDTEHA PIC  X(0001).
  2848     05  EXPDTEHI PIC  X(0014).
  2849*    -------------------------------
  2850     05  EXPDTEL PIC S9(0004) COMP.
  2851     05  EXPDTEF PIC  X(0001).
  2852     05  FILLER REDEFINES EXPDTEF.
  2853         10  EXPDTEA PIC  X(0001).
  2854     05  EXPDTEI PIC  X(0008).
  2855*    -------------------------------
  2856     05  BENECAPL PIC S9(0004) COMP.
  2857     05  BENECAPF PIC  X(0001).
  2858     05  FILLER REDEFINES BENECAPF.
  2859         10  BENECAPA PIC  X(0001).
  2860     05  BENECAPI PIC  X(0013).
  2861*    -------------------------------
  2862     05  BENEL PIC S9(0004) COMP.
  2863     05  BENEF PIC  X(0001).
  2864     05  FILLER REDEFINES BENEF.
  2865         10  BENEA PIC  X(0001).
  2866     05  BENEI PIC  X(0009).
  2867*    -------------------------------
  2868     05  FORMTYPL PIC S9(0004) COMP.
  2869     05  FORMTYPF PIC  X(0001).
  2870     05  FILLER REDEFINES FORMTYPF.
  2871         10  FORMTYPA PIC  X(0001).
  2872     05  FORMTYPI PIC  X(0001).
  2873*    -------------------------------
  2874     05  PMTTYPEL PIC S9(0004) COMP.
  2875     05  PMTTYPEF PIC  X(0001).
  2876     05  FILLER REDEFINES PMTTYPEF.
  2877         10  PMTTYPEA PIC  X(0001).
  2878     05  PMTTYPEI PIC  X(0001).
  2879*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  59
* EL156.cbl
  2880     05  PAYEEL PIC S9(0004) COMP.
  2881     05  PAYEEF PIC  X(0001).
  2882     05  FILLER REDEFINES PAYEEF.
  2883         10  PAYEEA PIC  X(0001).
  2884     05  PAYEEI PIC  X(0002).
  2885*    -------------------------------
  2886     05  CHECKNOL PIC S9(0004) COMP.
  2887     05  CHECKNOF PIC  X(0001).
  2888     05  FILLER REDEFINES CHECKNOF.
  2889         10  CHECKNOA PIC  X(0001).
  2890     05  CHECKNOI PIC  X(0007).
  2891*    -------------------------------
  2892     05  OFFLINEL PIC S9(0004) COMP.
  2893     05  OFFLINEF PIC  X(0001).
  2894     05  FILLER REDEFINES OFFLINEF.
  2895         10  OFFLINEA PIC  X(0001).
  2896     05  OFFLINEI PIC  X(0001).
  2897*    -------------------------------
  2898     05  HOLDTILL PIC S9(0004) COMP.
  2899     05  HOLDTILF PIC  X(0001).
  2900     05  FILLER REDEFINES HOLDTILF.
  2901         10  HOLDTILA PIC  X(0001).
  2902     05  HOLDTILI PIC  X(0008).
  2903*    -------------------------------
  2904     05  NOTE1L PIC S9(0004) COMP.
  2905     05  NOTE1F PIC  X(0001).
  2906     05  FILLER REDEFINES NOTE1F.
  2907         10  NOTE1A PIC  X(0001).
  2908     05  NOTE1I PIC  X(0060).
  2909*    -------------------------------
  2910     05  NOTE2L PIC S9(0004) COMP.
  2911     05  NOTE2F PIC  X(0001).
  2912     05  FILLER REDEFINES NOTE2F.
  2913         10  NOTE2A PIC  X(0001).
  2914     05  NOTE2I PIC  X(0060).
  2915*    -------------------------------
  2916     05  EOBYNL PIC S9(0004) COMP.
  2917     05  EOBYNF PIC  X(0001).
  2918     05  FILLER REDEFINES EOBYNF.
  2919         10  EOBYNA PIC  X(0001).
  2920     05  EOBYNI PIC  X(0001).
  2921*    -------------------------------
  2922     05  CLMFMYNL PIC S9(0004) COMP.
  2923     05  CLMFMYNF PIC  X(0001).
  2924     05  FILLER REDEFINES CLMFMYNF.
  2925         10  CLMFMYNA PIC  X(0001).
  2926     05  CLMFMYNI PIC  X(0001).
  2927*    -------------------------------
  2928     05  SURVYYNL PIC S9(0004) COMP.
  2929     05  SURVYYNF PIC  X(0001).
  2930     05  FILLER REDEFINES SURVYYNF.
  2931         10  SURVYYNA PIC  X(0001).
  2932     05  SURVYYNI PIC  X(0001).
  2933*    -------------------------------
  2934     05  SPRELYNL PIC S9(0004) COMP.
  2935     05  SPRELYNF PIC  X(0001).
  2936     05  FILLER REDEFINES SPRELYNF.
  2937         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  60
* EL156.cbl
  2938     05  SPRELYNI PIC  X(0001).
  2939*    -------------------------------
  2940     05  PINTHL PIC S9(0004) COMP.
  2941     05  PINTHF PIC  X(0001).
  2942     05  FILLER REDEFINES PINTHF.
  2943         10  PINTHA PIC  X(0001).
  2944     05  PINTHI PIC  X(0004).
  2945*    -------------------------------
  2946     05  PINTL PIC S9(0004) COMP.
  2947     05  PINTF PIC  X(0001).
  2948     05  FILLER REDEFINES PINTF.
  2949         10  PINTA PIC  X(0001).
  2950     05  PINTI PIC  X(0008).
  2951*    -------------------------------
  2952     05  PROOFDTL PIC S9(0004) COMP.
  2953     05  PROOFDTF PIC  X(0001).
  2954     05  FILLER REDEFINES PROOFDTF.
  2955         10  PROOFDTA PIC  X(0001).
  2956     05  PROOFDTI PIC  X(0008).
  2957*    -------------------------------
  2958     05  AIGFRMHL PIC S9(0004) COMP.
  2959     05  AIGFRMHF PIC  X(0001).
  2960     05  FILLER REDEFINES AIGFRMHF.
  2961         10  AIGFRMHA PIC  X(0001).
  2962     05  AIGFRMHI PIC  X(0012).
  2963*    -------------------------------
  2964     05  AIGFROML PIC S9(0004) COMP.
  2965     05  AIGFROMF PIC  X(0001).
  2966     05  FILLER REDEFINES AIGFROMF.
  2967         10  AIGFROMA PIC  X(0001).
  2968     05  AIGFROMI PIC  X(0008).
  2969*    -------------------------------
  2970     05  PMTHDGAL PIC S9(0004) COMP.
  2971     05  PMTHDGAF PIC  X(0001).
  2972     05  FILLER REDEFINES PMTHDGAF.
  2973         10  PMTHDGAA PIC  X(0001).
  2974     05  PMTHDGAI PIC  X(0066).
  2975*    -------------------------------
  2976     05  EPYFROML PIC S9(0004) COMP.
  2977     05  EPYFROMF PIC  X(0001).
  2978     05  FILLER REDEFINES EPYFROMF.
  2979         10  EPYFROMA PIC  X(0001).
  2980     05  EPYFROMI PIC  X(0008).
  2981*    -------------------------------
  2982     05  EPYTHRUL PIC S9(0004) COMP.
  2983     05  EPYTHRUF PIC  X(0001).
  2984     05  FILLER REDEFINES EPYTHRUF.
  2985         10  EPYTHRUA PIC  X(0001).
  2986     05  EPYTHRUI PIC  X(0008).
  2987*    -------------------------------
  2988     05  EDAYSL PIC S9(0004) COMP.
  2989     05  EDAYSF PIC  X(0001).
  2990     05  FILLER REDEFINES EDAYSF.
  2991         10  EDAYSA PIC  X(0001).
  2992     05  EDAYSI PIC  S9(6).
  2993*    -------------------------------
  2994     05  EPYAMTL PIC S9(0004) COMP.
  2995     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  61
* EL156.cbl
  2996     05  FILLER REDEFINES EPYAMTF.
  2997         10  EPYAMTA PIC  X(0001).
  2998     05  EPYAMTI PIC  S9(8)V99.
  2999*    -------------------------------
  3000     05  ERESVL PIC S9(0004) COMP.
  3001     05  ERESVF PIC  X(0001).
  3002     05  FILLER REDEFINES ERESVF.
  3003         10  ERESVA PIC  X(0001).
  3004     05  ERESVI PIC  S9(7)V99.
  3005*    -------------------------------
  3006     05  ETYPEL PIC S9(0004) COMP.
  3007     05  ETYPEF PIC  X(0001).
  3008     05  FILLER REDEFINES ETYPEF.
  3009         10  ETYPEA PIC  X(0001).
  3010     05  ETYPEI PIC  X(0001).
  3011*    -------------------------------
  3012     05  EEXPENSL PIC S9(0004) COMP.
  3013     05  EEXPENSF PIC  X(0001).
  3014     05  FILLER REDEFINES EEXPENSF.
  3015         10  EEXPENSA PIC  X(0001).
  3016     05  EEXPENSI PIC  9(6)V99.
  3017*    -------------------------------
  3018     05  CPYFROML PIC S9(0004) COMP.
  3019     05  CPYFROMF PIC  X(0001).
  3020     05  FILLER REDEFINES CPYFROMF.
  3021         10  CPYFROMA PIC  X(0001).
  3022     05  CPYFROMI PIC  X(0008).
  3023*    -------------------------------
  3024     05  CPYTHRUL PIC S9(0004) COMP.
  3025     05  CPYTHRUF PIC  X(0001).
  3026     05  FILLER REDEFINES CPYTHRUF.
  3027         10  CPYTHRUA PIC  X(0001).
  3028     05  CPYTHRUI PIC  X(0008).
  3029*    -------------------------------
  3030     05  CDAYSL PIC S9(0004) COMP.
  3031     05  CDAYSF PIC  X(0001).
  3032     05  FILLER REDEFINES CDAYSF.
  3033         10  CDAYSA PIC  X(0001).
  3034     05  CDAYSI PIC  9(6).
  3035*    -------------------------------
  3036     05  CPYAMTL PIC S9(0004) COMP.
  3037     05  CPYAMTF PIC  X(0001).
  3038     05  FILLER REDEFINES CPYAMTF.
  3039         10  CPYAMTA PIC  X(0001).
  3040     05  CPYAMTI PIC  S9(8)V99.
  3041*    -------------------------------
  3042     05  CRESVL PIC S9(0004) COMP.
  3043     05  CRESVF PIC  X(0001).
  3044     05  FILLER REDEFINES CRESVF.
  3045         10  CRESVA PIC  X(0001).
  3046     05  CRESVI PIC  9(6)V99.
  3047*    -------------------------------
  3048     05  CEXPENSL PIC S9(0004) COMP.
  3049     05  CEXPENSF PIC  X(0001).
  3050     05  FILLER REDEFINES CEXPENSF.
  3051         10  CEXPENSA PIC  X(0001).
  3052     05  CEXPENSI PIC  9(6)V99.
  3053*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  62
* EL156.cbl
  3054     05  ERRMSG0L PIC S9(0004) COMP.
  3055     05  ERRMSG0F PIC  X(0001).
  3056     05  FILLER REDEFINES ERRMSG0F.
  3057         10  ERRMSG0A PIC  X(0001).
  3058     05  ERRMSG0I PIC  X(0072).
  3059*    -------------------------------
  3060     05  ERRMSG1L PIC S9(0004) COMP.
  3061     05  ERRMSG1F PIC  X(0001).
  3062     05  FILLER REDEFINES ERRMSG1F.
  3063         10  ERRMSG1A PIC  X(0001).
  3064     05  ERRMSG1I PIC  X(0072).
  3065*    -------------------------------
  3066     05  ERRMSG2L PIC S9(0004) COMP.
  3067     05  ERRMSG2F PIC  X(0001).
  3068     05  FILLER REDEFINES ERRMSG2F.
  3069         10  ERRMSG2A PIC  X(0001).
  3070     05  ERRMSG2I PIC  X(0072).
  3071*    -------------------------------
  3072     05  ENTERPFL PIC S9(0004) COMP.
  3073     05  ENTERPFF PIC  X(0001).
  3074     05  FILLER REDEFINES ENTERPFF.
  3075         10  ENTERPFA PIC  X(0001).
  3076     05  ENTERPFI PIC  99.
  3077*    -------------------------------
  3078     05  PF6TITL PIC S9(0004) COMP.
  3079     05  PF6TITF PIC  X(0001).
  3080     05  FILLER REDEFINES PF6TITF.
  3081         10  PF6TITA PIC  X(0001).
  3082     05  PF6TITI PIC  X(0016).
  3083 01  EL156AO REDEFINES EL156AI.
  3084     05  FILLER            PIC  X(0012).
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  RUNDTEAO PIC  X(0008).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  RUNTIMAO PIC  99.99.
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  SEQUO PIC  X(0010).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  CLMNOO PIC  X(0007).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  CARRO PIC  X(0001).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  CERTNOO PIC  X(0010).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  SUFXO PIC  X(0001).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  CLMTYPO PIC  X(0006).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  63
* EL156.cbl
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  LSTNMEO PIC  X(0015).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  FSTNMEO PIC  X(0012).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  MINITO PIC  X(0001).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  PRIMHDGO PIC  X(0012).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  PCERTNOO PIC  X(0010).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  PSUFXO PIC  X(0001).
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  STATUSO PIC  X(0010).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  LOANHO PIC  X(0014).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  LOANNOO PIC  X(0025).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  DUEDAYHO PIC  X(0008).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  DUEDAYO PIC  X(0002).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  ZINTHO PIC  X(0009).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  ZINTO PIC  9.99999.
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  PTHRHDGO PIC  X(0014).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  PDTHRUO PIC  X(0008).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  TOTPAIDO PIC  Z(6).99-.
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  COVERO PIC  X(0010).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  INCURO PIC  X(0008).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  LSTDTEO PIC  X(0008).
  3169*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  64
* EL156.cbl
  3170     05  FILLER            PIC  X(0003).
  3171     05  CRTSTATO PIC  X(0010).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  EFFECTO PIC  X(0008).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  TERMSO PIC  X(0011).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  STACCTO PIC  X(0013).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  EXPDTEHO PIC  X(0014).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  EXPDTEO PIC  X(0008).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  BENECAPO PIC  X(0013).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  BENEO PIC  Z(6).99.
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  FORMTYPO PIC  X(0001).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  PMTTYPEO PIC  X(0001).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  PAYEEO PIC  X(0002).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  CHECKNOO PIC  X(0007).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  OFFLINEO PIC  X(0001).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  HOLDTILO PIC  99B99B99.
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  NOTE1O PIC  X(0060).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  NOTE2O PIC  X(0060).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  EOBYNO PIC  X(0001).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  CLMFMYNO PIC  X(0001).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  SURVYYNO PIC  X(0001).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  65
* EL156.cbl
  3228     05  SPRELYNO PIC  X(0001).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  PINTHO PIC  X(0004).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  PINTO PIC  Z,ZZ9.99.
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  PROOFDTO PIC  99B99B99.
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  AIGFRMHO PIC  X(0012).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  AIGFROMO PIC  99B99B99.
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  PMTHDGAO PIC  X(0066).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  EPYFROMO PIC  99B99B99.
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  EPYTHRUO PIC  99B99B99.
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  EDAYSO PIC  Z(4)9-.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  EPYAMTO PIC  Z(6).99-.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  ERESVO PIC  Z(5).99-.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  ETYPEO PIC  X(0001).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  EEXPENSO PIC  Z(5).99.
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  CPYFROMO PIC  99B99B99.
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  CPYTHRUO PIC  99B99B99.
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  CDAYSO PIC  Z(4)9-.
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  CPYAMTO PIC  Z(6).99-.
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  CRESVO PIC  Z(5).99.
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  66
* EL156.cbl
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  ERRMSG0O PIC  X(0072).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  ERRMSG1O PIC  X(0072).
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  ERRMSG2O PIC  X(0072).
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  ENTERPFO PIC  X(0002).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  PF6TITO PIC  X(0016).
  3301*    -------------------------------
  3302 01  EL156BI REDEFINES EL156AI.
  3303     05  FILLER            PIC  X(0012).
  3304*    -------------------------------
  3305     05  RUNDTEBL PIC S9(0004) COMP.
  3306     05  RUNDTEBF PIC  X(0001).
  3307     05  FILLER REDEFINES RUNDTEBF.
  3308         10  RUNDTEBA PIC  X(0001).
  3309     05  RUNDTEBI PIC  X(0008).
  3310*    -------------------------------
  3311     05  RUNTIMBL PIC S9(0004) COMP.
  3312     05  RUNTIMBF PIC  X(0001).
  3313     05  FILLER REDEFINES RUNTIMBF.
  3314         10  RUNTIMBA PIC  X(0001).
  3315     05  RUNTIMBI PIC  X(0005).
  3316*    -------------------------------
  3317     05  PAYDTBL PIC S9(0004) COMP.
  3318     05  PAYDTBF PIC  X(0001).
  3319     05  FILLER REDEFINES PAYDTBF.
  3320         10  PAYDTBA PIC  X(0001).
  3321     05  PAYDTBI PIC  X(0008).
  3322*    -------------------------------
  3323     05  PAYTYPBL PIC S9(0004) COMP.
  3324     05  PAYTYPBF PIC  X(0001).
  3325     05  FILLER REDEFINES PAYTYPBF.
  3326         10  PAYTYPBA PIC  X(0001).
  3327     05  PAYTYPBI PIC  X(0015).
  3328*    -------------------------------
  3329     05  PAYAMTBL PIC S9(0004) COMP.
  3330     05  PAYAMTBF PIC  X(0001).
  3331     05  FILLER REDEFINES PAYAMTBF.
  3332         10  PAYAMTBA PIC  X(0001).
  3333     05  PAYAMTBI PIC  X(0011).
  3334*    -------------------------------
  3335     05  LOANHBL PIC S9(0004) COMP.
  3336     05  LOANHBF PIC  X(0001).
  3337     05  FILLER REDEFINES LOANHBF.
  3338         10  LOANHBA PIC  X(0001).
  3339     05  LOANHBI PIC  X(0012).
  3340*    -------------------------------
  3341     05  LOANNBL PIC S9(0004) COMP.
  3342     05  LOANNBF PIC  X(0001).
  3343     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  67
* EL156.cbl
  3344         10  LOANNBA PIC  X(0001).
  3345     05  LOANNBI PIC  X(0025).
  3346*    -------------------------------
  3347     05  CKNUMHDL PIC S9(0004) COMP.
  3348     05  CKNUMHDF PIC  X(0001).
  3349     05  FILLER REDEFINES CKNUMHDF.
  3350         10  CKNUMHDA PIC  X(0001).
  3351     05  CKNUMHDI PIC  X(0012).
  3352*    -------------------------------
  3353     05  CKNUMBL PIC S9(0004) COMP.
  3354     05  CKNUMBF PIC  X(0001).
  3355     05  FILLER REDEFINES CKNUMBF.
  3356         10  CKNUMBA PIC  X(0001).
  3357     05  CKNUMBI PIC  X(0007).
  3358*    -------------------------------
  3359     05  AGTHDGL PIC S9(0004) COMP.
  3360     05  AGTHDGF PIC  X(0001).
  3361     05  FILLER REDEFINES AGTHDGF.
  3362         10  AGTHDGA PIC  X(0001).
  3363     05  AGTHDGI PIC  X(0016).
  3364*    -------------------------------
  3365     05  NAMEBL PIC S9(0004) COMP.
  3366     05  NAMEBF PIC  X(0001).
  3367     05  FILLER REDEFINES NAMEBF.
  3368         10  NAMEBA PIC  X(0001).
  3369     05  NAMEBI PIC  X(0030).
  3370*    -------------------------------
  3371     05  NAMEB2L PIC S9(0004) COMP.
  3372     05  NAMEB2F PIC  X(0001).
  3373     05  FILLER REDEFINES NAMEB2F.
  3374         10  NAMEB2A PIC  X(0001).
  3375     05  NAMEB2I PIC  X(0030).
  3376*    -------------------------------
  3377     05  ADDR1BL PIC S9(0004) COMP.
  3378     05  ADDR1BF PIC  X(0001).
  3379     05  FILLER REDEFINES ADDR1BF.
  3380         10  ADDR1BA PIC  X(0001).
  3381     05  ADDR1BI PIC  X(0030).
  3382*    -------------------------------
  3383     05  ADDR1B2L PIC S9(0004) COMP.
  3384     05  ADDR1B2F PIC  X(0001).
  3385     05  FILLER REDEFINES ADDR1B2F.
  3386         10  ADDR1B2A PIC  X(0001).
  3387     05  ADDR1B2I PIC  X(0030).
  3388*    -------------------------------
  3389     05  ADDR2BL PIC S9(0004) COMP.
  3390     05  ADDR2BF PIC  X(0001).
  3391     05  FILLER REDEFINES ADDR2BF.
  3392         10  ADDR2BA PIC  X(0001).
  3393     05  ADDR2BI PIC  X(0030).
  3394*    -------------------------------
  3395     05  ADDR2B2L PIC S9(0004) COMP.
  3396     05  ADDR2B2F PIC  X(0001).
  3397     05  FILLER REDEFINES ADDR2B2F.
  3398         10  ADDR2B2A PIC  X(0001).
  3399     05  ADDR2B2I PIC  X(0030).
  3400*    -------------------------------
  3401     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  68
* EL156.cbl
  3402     05  CITYSTBF PIC  X(0001).
  3403     05  FILLER REDEFINES CITYSTBF.
  3404         10  CITYSTBA PIC  X(0001).
  3405     05  CITYSTBI PIC  X(0030).
  3406*    -------------------------------
  3407     05  CITYST2L PIC S9(0004) COMP.
  3408     05  CITYST2F PIC  X(0001).
  3409     05  FILLER REDEFINES CITYST2F.
  3410         10  CITYST2A PIC  X(0001).
  3411     05  CITYST2I PIC  X(0030).
  3412*    -------------------------------
  3413     05  ZIPBL PIC S9(0004) COMP.
  3414     05  ZIPBF PIC  X(0001).
  3415     05  FILLER REDEFINES ZIPBF.
  3416         10  ZIPBA PIC  X(0001).
  3417     05  ZIPBI PIC  X(0009).
  3418*    -------------------------------
  3419     05  ZIPB2L PIC S9(0004) COMP.
  3420     05  ZIPB2F PIC  X(0001).
  3421     05  FILLER REDEFINES ZIPB2F.
  3422         10  ZIPB2A PIC  X(0001).
  3423     05  ZIPB2I PIC  X(0009).
  3424*    -------------------------------
  3425     05  INTHDBL PIC S9(0004) COMP.
  3426     05  INTHDBF PIC  X(0001).
  3427     05  FILLER REDEFINES INTHDBF.
  3428         10  INTHDBA PIC  X(0001).
  3429     05  INTHDBI PIC  X(0012).
  3430*    -------------------------------
  3431     05  INTAMTBL PIC S9(0004) COMP.
  3432     05  INTAMTBF PIC  X(0001).
  3433     05  FILLER REDEFINES INTAMTBF.
  3434         10  INTAMTBA PIC  X(0001).
  3435     05  INTAMTBI PIC  X(0011).
  3436*    -------------------------------
  3437     05  PMTHDGBL PIC S9(0004) COMP.
  3438     05  PMTHDGBF PIC  X(0001).
  3439     05  FILLER REDEFINES PMTHDGBF.
  3440         10  PMTHDGBA PIC  X(0001).
  3441     05  PMTHDGBI PIC  X(0034).
  3442*    -------------------------------
  3443     05  CLMNOBL PIC S9(0004) COMP.
  3444     05  CLMNOBF PIC  X(0001).
  3445     05  FILLER REDEFINES CLMNOBF.
  3446         10  CLMNOBA PIC  X(0001).
  3447     05  CLMNOBI PIC  X(0007).
  3448*    -------------------------------
  3449     05  CARRBL PIC S9(0004) COMP.
  3450     05  CARRBF PIC  X(0001).
  3451     05  FILLER REDEFINES CARRBF.
  3452         10  CARRBA PIC  X(0001).
  3453     05  CARRBI PIC  X(0001).
  3454*    -------------------------------
  3455     05  CERTNOBL PIC S9(0004) COMP.
  3456     05  CERTNOBF PIC  X(0001).
  3457     05  FILLER REDEFINES CERTNOBF.
  3458         10  CERTNOBA PIC  X(0001).
  3459     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  69
* EL156.cbl
  3460*    -------------------------------
  3461     05  SUFXBL PIC S9(0004) COMP.
  3462     05  SUFXBF PIC  X(0001).
  3463     05  FILLER REDEFINES SUFXBF.
  3464         10  SUFXBA PIC  X(0001).
  3465     05  SUFXBI PIC  X(0001).
  3466*    -------------------------------
  3467     05  CLMTYPBL PIC S9(0004) COMP.
  3468     05  CLMTYPBF PIC  X(0001).
  3469     05  FILLER REDEFINES CLMTYPBF.
  3470         10  CLMTYPBA PIC  X(0001).
  3471     05  CLMTYPBI PIC  X(0006).
  3472*    -------------------------------
  3473     05  INCURBL PIC S9(0004) COMP.
  3474     05  INCURBF PIC  X(0001).
  3475     05  FILLER REDEFINES INCURBF.
  3476         10  INCURBA PIC  X(0001).
  3477     05  INCURBI PIC  X(0008).
  3478*    -------------------------------
  3479     05  PYFROMBL PIC S9(0004) COMP.
  3480     05  PYFROMBF PIC  X(0001).
  3481     05  FILLER REDEFINES PYFROMBF.
  3482         10  PYFROMBA PIC  X(0001).
  3483     05  PYFROMBI PIC  X(0008).
  3484*    -------------------------------
  3485     05  PYTHRUBL PIC S9(0004) COMP.
  3486     05  PYTHRUBF PIC  X(0001).
  3487     05  FILLER REDEFINES PYTHRUBF.
  3488         10  PYTHRUBA PIC  X(0001).
  3489     05  PYTHRUBI PIC  X(0008).
  3490*    -------------------------------
  3491     05  DAYSBL PIC S9(0004) COMP.
  3492     05  DAYSBF PIC  X(0001).
  3493     05  FILLER REDEFINES DAYSBF.
  3494         10  DAYSBA PIC  X(0001).
  3495     05  DAYSBI PIC  X(0005).
  3496*    -------------------------------
  3497     05  BYBL PIC S9(0004) COMP.
  3498     05  BYBF PIC  X(0001).
  3499     05  FILLER REDEFINES BYBF.
  3500         10  BYBA PIC  X(0001).
  3501     05  BYBI PIC  X(0004).
  3502*    -------------------------------
  3503     05  PROOFDBL PIC S9(0004) COMP.
  3504     05  PROOFDBF PIC  X(0001).
  3505     05  FILLER REDEFINES PROOFDBF.
  3506         10  PROOFDBA PIC  X(0001).
  3507     05  PROOFDBI PIC  X(0008).
  3508*    -------------------------------
  3509     05  ACCTBL PIC S9(0004) COMP.
  3510     05  ACCTBF PIC  X(0001).
  3511     05  FILLER REDEFINES ACCTBF.
  3512         10  ACCTBA PIC  X(0001).
  3513     05  ACCTBI PIC  X(0010).
  3514*    -------------------------------
  3515     05  STATEBL PIC S9(0004) COMP.
  3516     05  STATEBF PIC  X(0001).
  3517     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  70
* EL156.cbl
  3518         10  STATEBA PIC  X(0001).
  3519     05  STATEBI PIC  X(0002).
  3520*    -------------------------------
  3521     05  GROUPBL PIC S9(0004) COMP.
  3522     05  GROUPBF PIC  X(0001).
  3523     05  FILLER REDEFINES GROUPBF.
  3524         10  GROUPBA PIC  X(0001).
  3525     05  GROUPBI PIC  X(0006).
  3526*    -------------------------------
  3527     05  ACARRBL PIC S9(0004) COMP.
  3528     05  ACARRBF PIC  X(0001).
  3529     05  FILLER REDEFINES ACARRBF.
  3530         10  ACARRBA PIC  X(0001).
  3531     05  ACARRBI PIC  X(0001).
  3532*    -------------------------------
  3533     05  ACCTNMBL PIC S9(0004) COMP.
  3534     05  ACCTNMBF PIC  X(0001).
  3535     05  FILLER REDEFINES ACCTNMBF.
  3536         10  ACCTNMBA PIC  X(0001).
  3537     05  ACCTNMBI PIC  X(0030).
  3538*    -------------------------------
  3539     05  UNDISBL PIC S9(0004) COMP.
  3540     05  UNDISBF PIC  X(0001).
  3541     05  FILLER REDEFINES UNDISBF.
  3542         10  UNDISBA PIC  X(0001).
  3543     05  UNDISBI PIC  X(0010).
  3544*    -------------------------------
  3545     05  RATEBL PIC S9(0004) COMP.
  3546     05  RATEBF PIC  X(0001).
  3547     05  FILLER REDEFINES RATEBF.
  3548         10  RATEBA PIC  X(0001).
  3549     05  RATEBI PIC  X(0006).
  3550*    -------------------------------
  3551     05  ERMSG1BL PIC S9(0004) COMP.
  3552     05  ERMSG1BF PIC  X(0001).
  3553     05  FILLER REDEFINES ERMSG1BF.
  3554         10  ERMSG1BA PIC  X(0001).
  3555     05  ERMSG1BI PIC  X(0072).
  3556*    -------------------------------
  3557     05  ENTPFBL PIC S9(0004) COMP.
  3558     05  ENTPFBF PIC  X(0001).
  3559     05  FILLER REDEFINES ENTPFBF.
  3560         10  ENTPFBA PIC  X(0001).
  3561     05  ENTPFBI PIC  99.
  3562 01  EL156BO REDEFINES EL156AI.
  3563     05  FILLER            PIC  X(0012).
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  RUNDTEBO PIC  X(0008).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  RUNTIMBO PIC  99.99.
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  PAYDTBO PIC  99B99B99.
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  71
* EL156.cbl
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  LOANHBO PIC  X(0012).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  LOANNBO PIC  X(0025).
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  CKNUMHDO PIC  X(0012).
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  CKNUMBO PIC  X(0007).
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  AGTHDGO PIC  X(0016).
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  NAMEBO PIC  X(0030).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  NAMEB2O PIC  X(0030).
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  ADDR1BO PIC  X(0030).
  3603*    -------------------------------
  3604     05  FILLER            PIC  X(0003).
  3605     05  ADDR1B2O PIC  X(0030).
  3606*    -------------------------------
  3607     05  FILLER            PIC  X(0003).
  3608     05  ADDR2BO PIC  X(0030).
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  ADDR2B2O PIC  X(0030).
  3612*    -------------------------------
  3613     05  FILLER            PIC  X(0003).
  3614     05  CITYSTBO PIC  X(0030).
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  CITYST2O PIC  X(0030).
  3618*    -------------------------------
  3619     05  FILLER            PIC  X(0003).
  3620     05  ZIPBO PIC  ZZZZ99999.
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  ZIPB2O PIC  ZZZZZZZZZ.
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  INTHDBO PIC  X(0012).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  PMTHDGBO PIC  X(0034).
  3633*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  72
* EL156.cbl
  3634     05  FILLER            PIC  X(0003).
  3635     05  CLMNOBO PIC  X(0007).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  CARRBO PIC  X(0001).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  CERTNOBO PIC  X(0010).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  SUFXBO PIC  X(0001).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  CLMTYPBO PIC  X(0006).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  INCURBO PIC  X(0008).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  PYFROMBO PIC  99B99B99.
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  PYTHRUBO PIC  99B99B99.
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  DAYSBO PIC  X(0005).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  BYBO PIC  X(0004).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  PROOFDBO PIC  99B99B99.
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  ACCTBO PIC  X(0010).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  STATEBO PIC  X(0002).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  GROUPBO PIC  X(0006).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  ACARRBO PIC  X(0001).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  ACCTNMBO PIC  X(0030).
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  UNDISBO PIC  ZZZ,Z99.99.
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  RATEBO PIC  ZZZ.99.
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  ERMSG1BO PIC  X(0072).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  73
* EL156.cbl
  3692     05  ENTPFBO PIC  X(0002).
  3693*    -------------------------------
  3694****************************************************************
  3695*
  3696* Copyright (c) 2007 by Clerity Solutions, Inc.
  3697* All rights reserved.
  3698*
  3699****************************************************************
  3700 01  DFHEIV.
  3701   02  DFHEIV0               PIC X(35).
  3702   02  DFHEIV1               PIC X(08).
  3703   02  DFHEIV2               PIC X(08).
  3704   02  DFHEIV3               PIC X(08).
  3705   02  DFHEIV4               PIC X(06).
  3706   02  DFHEIV5               PIC X(04).
  3707   02  DFHEIV6               PIC X(04).
  3708   02  DFHEIV7               PIC X(02).
  3709   02  DFHEIV8               PIC X(02).
  3710   02  DFHEIV9               PIC X(01).
  3711   02  DFHEIV10              PIC S9(7) COMP-3.
  3712   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3713   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3714   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3715   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3716   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3717   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3718   02  DFHEIV17              PIC X(04).
  3719   02  DFHEIV18              PIC X(04).
  3720   02  DFHEIV19              PIC X(04).
  3721   02  DFHEIV20              USAGE IS POINTER.
  3722   02  DFHEIV21              USAGE IS POINTER.
  3723   02  DFHEIV22              USAGE IS POINTER.
  3724   02  DFHEIV23              USAGE IS POINTER.
  3725   02  DFHEIV24              USAGE IS POINTER.
  3726   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3727   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3728   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3729   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3730   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3731   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3732   02  FILLER                PIC X(02).
  3733   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3734   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3735   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3736   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3737   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3738 LINKAGE  SECTION.
  3739*****************************************************************
  3740*                                                               *
  3741* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3742* All rights reserved.                                          *
  3743*                                                               *
  3744*****************************************************************
  3745 01  dfheiblk.
  3746     02  eibtime          pic s9(7) comp-3.
  3747     02  eibdate          pic s9(7) comp-3.
  3748     02  eibtrnid         pic x(4).
  3749     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  74
* EL156.cbl
  3750     02  eibtrmid         pic x(4).
  3751     02  dfheigdi         pic s9(4) comp.
  3752     02  eibcposn         pic s9(4) comp.
  3753     02  eibcalen         pic s9(4) comp.
  3754     02  eibaid           pic x(1).
  3755     02  eibfiller1       pic x(1).
  3756     02  eibfn            pic x(2).
  3757     02  eibfiller2       pic x(2).
  3758     02  eibrcode         pic x(6).
  3759     02  eibfiller3       pic x(2).
  3760     02  eibds            pic x(8).
  3761     02  eibreqid         pic x(8).
  3762     02  eibrsrce         pic x(8).
  3763     02  eibsync          pic x(1).
  3764     02  eibfree          pic x(1).
  3765     02  eibrecv          pic x(1).
  3766     02  eibsend          pic x(1).
  3767     02  eibatt           pic x(1).
  3768     02  eibeoc           pic x(1).
  3769     02  eibfmh           pic x(1).
  3770     02  eibcompl         pic x(1).
  3771     02  eibsig           pic x(1).
  3772     02  eibconf          pic x(1).
  3773     02  eiberr           pic x(1).
  3774     02  eibrldbk         pic x(1).
  3775     02  eiberrcd         pic x(4).
  3776     02  eibsynrb         pic x(1).
  3777     02  eibnodat         pic x(1).
  3778     02  eibfiller5       pic x(2).
  3779     02  eibresp          pic 9(09) comp.
  3780     02  eibresp2         pic 9(09) comp.
  3781     02  dfheigdj         pic s9(4) comp.
  3782     02  dfheigdk         pic s9(4) comp.
  3783 01  DFHCOMMAREA             PIC X(1024).
  3784
  3785*    COPY ELCMSTR.
  3786******************************************************************
  3787*                                                                *
  3788*                            ELCMSTR.                            *
  3789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3790*                            VMOD=2.012                          *
  3791*                                                                *
  3792*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3793*                                                                *
  3794*   FILE TYPE = VSAM,KSDS                                        *
  3795*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3796*                                                                *
  3797*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3798*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3799*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3800*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3801*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3802*                                                 RKP=75,LEN=21  *
  3803*                                                                *
  3804*   **** NOTE ****                                               *
  3805*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3806*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3807*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  75
* EL156.cbl
  3808*   LOG = YES                                                    *
  3809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3810******************************************************************
  3811*                   C H A N G E   L O G
  3812*
  3813* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3814*-----------------------------------------------------------------
  3815*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3816* EFFECTIVE    NUMBER
  3817*-----------------------------------------------------------------
  3818* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3819* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3820* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3821* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3822******************************************************************
  3823 01  CLAIM-MASTER.
  3824     12  CL-RECORD-ID                PIC XX.
  3825         88  VALID-CL-ID         VALUE 'CL'.
  3826
  3827     12  CL-CONTROL-PRIMARY.
  3828         16  CL-COMPANY-CD           PIC X.
  3829         16  CL-CARRIER              PIC X.
  3830         16  CL-CLAIM-NO             PIC X(7).
  3831         16  CL-CERT-NO.
  3832             20  CL-CERT-PRIME       PIC X(10).
  3833             20  CL-CERT-SFX         PIC X.
  3834
  3835     12  CL-CONTROL-BY-NAME.
  3836         16  CL-COMPANY-CD-A1        PIC X.
  3837         16  CL-INSURED-LAST-NAME    PIC X(15).
  3838         16  CL-INSURED-NAME.
  3839             20  CL-INSURED-1ST-NAME PIC X(12).
  3840             20  CL-INSURED-MID-INIT PIC X.
  3841
  3842     12  CL-CONTROL-BY-SSN.
  3843         16  CL-COMPANY-CD-A2        PIC X.
  3844         16  CL-SOC-SEC-NO.
  3845             20  CL-SSN-STATE        PIC XX.
  3846             20  CL-SSN-ACCOUNT      PIC X(6).
  3847             20  CL-SSN-LN3          PIC X(3).
  3848
  3849     12  CL-CONTROL-BY-CERT-NO.
  3850         16  CL-COMPANY-CD-A4        PIC X.
  3851         16  CL-CERT-NO-A4.
  3852             20  CL-CERT-A4-PRIME    PIC X(10).
  3853             20  CL-CERT-A4-SFX      PIC X.
  3854
  3855     12  CL-CONTROL-BY-CCN.
  3856         16  CL-COMPANY-CD-A5        PIC X.
  3857         16  CL-CCN-A5.
  3858             20  CL-CCN.
  3859                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3860                 24  CL-CCN-PRIME-A5 PIC X(12).
  3861             20  CL-CCN-FILLER-A5    PIC X(4).
  3862
  3863     12  CL-INSURED-PROFILE-DATA.
  3864         16  CL-INSURED-BIRTH-DT     PIC XX.
  3865         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  76
* EL156.cbl
  3866             88  INSURED-IS-MALE        VALUE 'M'.
  3867             88  INSURED-IS-FEMALE      VALUE 'F'.
  3868             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3869         16  CL-INSURED-OCC-CD       PIC X(6).
  3870         16  FILLER                  PIC X(5).
  3871
  3872     12  CL-PROCESSING-INFO.
  3873         16  CL-PROCESSOR-ID         PIC X(4).
  3874         16  CL-CLAIM-STATUS         PIC X.
  3875             88  CLAIM-IS-OPEN          VALUE 'O'.
  3876             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3877         16  CL-CLAIM-TYPE           PIC X.
  3878*            88  AH-CLAIM               VALUE 'A'.
  3879*            88  LIFE-CLAIM             VALUE 'L'.
  3880*            88  PROPERTY-CLAIM         VALUE 'P'.
  3881*            88  IUI-CLAIM              VALUE 'I'.
  3882*            88  GAP-CLAIM              VALUE 'G'.
  3883         16  CL-CLAIM-PREM-TYPE      PIC X.
  3884             88  SINGLE-PREMIUM         VALUE '1'.
  3885             88  O-B-COVERAGE           VALUE '2'.
  3886             88  OPEN-END-COVERAGE      VALUE '3'.
  3887         16  CL-INCURRED-DT          PIC XX.
  3888         16  CL-REPORTED-DT          PIC XX.
  3889         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3890         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3891         16  CL-LAST-PMT-DT          PIC XX.
  3892         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3893         16  CL-PAID-THRU-DT         PIC XX.
  3894         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3895         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3896         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3897         16  CL-PMT-CALC-METHOD      PIC X.
  3898             88  CL-360-DAY-YR          VALUE '1'.
  3899             88  CL-365-DAY-YR          VALUE '2'.
  3900             88  CL-FULL-MONTHS         VALUE '3'.
  3901         16  CL-CAUSE-CD             PIC X(6).
  3902
  3903         16  CL-PRIME-CERT-NO.
  3904             20  CL-PRIME-CERT-PRIME PIC X(10).
  3905             20  CL-PRIME-CERT-SFX   PIC X.
  3906
  3907         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3908             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3909             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3910
  3911         16  CL-MICROFILM-NO         PIC X(10).
  3912         16  FILLER REDEFINES CL-MICROFILM-NO.
  3913             20  CL-BENEFIT-PERIOD   PIC 99.
  3914             20  FILLER              PIC X(8).
  3915         16  CL-PROG-FORM-TYPE       PIC X.
  3916         16  CL-LAST-ADD-ON-DT       PIC XX.
  3917
  3918         16  CL-LAST-REOPEN-DT       PIC XX.
  3919         16  CL-LAST-CLOSE-DT        PIC XX.
  3920         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3921             88  FINAL-PAID             VALUE '1'.
  3922             88  CLAIM-DENIED           VALUE '2'.
  3923             88  AUTO-CLOSE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  77
* EL156.cbl
  3924             88  MANUAL-CLOSE           VALUE '4'.
  3925             88  BENEFITS-CHANGED       VALUE 'C'.
  3926             88  SETUP-ERRORS           VALUE 'E'.
  3927         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3928         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3929         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3930             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3931         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3932         16  FILLER                  PIC X.
  3933
  3934     12  CL-CERTIFICATE-DATA.
  3935         16  CL-CERT-ORIGIN          PIC X.
  3936             88  CERT-WAS-ONLINE        VALUE '1'.
  3937             88  CERT-WAS-CREATED       VALUE '2'.
  3938             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3939         16  CL-CERT-KEY-DATA.
  3940             20  CL-CERT-CARRIER     PIC X.
  3941             20  CL-CERT-GROUPING    PIC X(6).
  3942             20  CL-CERT-STATE       PIC XX.
  3943             20  CL-CERT-ACCOUNT.
  3944                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3945                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3946             20  CL-CERT-EFF-DT      PIC XX.
  3947
  3948     12  CL-STATUS-CONTROLS.
  3949         16  CL-PRIORITY-CD          PIC X.
  3950             88  CONFIDENTIAL-DATA      VALUE '8'.
  3951             88  HIGHEST-PRIORITY       VALUE '9'.
  3952         16  CL-SUPV-ATTN-CD         PIC X.
  3953             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3954             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3955         16  CL-PURGED-DT            PIC XX.
  3956         16  CL-RESTORED-DT          PIC XX.
  3957         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3958         16  CL-NEXT-RESEND-DT       PIC XX.
  3959         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3960         16  CL-CRITICAL-PERIOD      PIC 99.
  3961*        16  FILLER                  PIC XX.
  3962         16  CL-LAST-MAINT-DT        PIC XX.
  3963         16  CL-LAST-MAINT-USER      PIC X(4).
  3964         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3965         16  CL-LAST-MAINT-TYPE      PIC X.
  3966             88  CLAIM-SET-UP           VALUE ' '.
  3967             88  PAYMENT-MADE           VALUE '1'.
  3968             88  LETTER-SENT            VALUE '2'.
  3969             88  MASTER-WAS-ALTERED     VALUE '3'.
  3970             88  MASTER-WAS-RESTORED    VALUE '4'.
  3971             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3972             88  FILE-CONVERTED         VALUE '6'.
  3973             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3974             88  ERROR-CORRECTION       VALUE 'E'.
  3975         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3976         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3977         16  CL-BENEFICIARY          PIC X(10).
  3978         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3979         16  CL-DENIAL-TYPE          PIC X.
  3980             88  CL-TYPE-DENIAL          VALUE '1'.
  3981             88  CL-TYPE-RESCISSION      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  78
* EL156.cbl
  3982             88  CL-TYPE-REFORMATION     VALUE '3'.
  3983             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3984             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3985         16  filler                  pic x(5).
  3986*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3987*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3988*        16  CL-RTW-DT               PIC XX.
  3989
  3990     12  CL-TRAILER-CONTROLS.
  3991         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3992             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3993             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3994             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3995         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3996         16  FILLER                  PIC XX.
  3997         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3998         16  CL-ADDRESS-TRAILER-CNT.
  3999             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4000                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4001             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4002                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4003             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4004                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4005             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4006                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4007             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4008                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4009             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4010                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4011             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4012                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4013
  4014     12  CL-CV-REFERENCE-NO.
  4015         16  CL-CV-REFNO-PRIME       PIC X(18).
  4016         16  CL-CV-REFNO-SFX         PIC XX.
  4017
  4018     12  CL-FILE-LOCATION            PIC X(4).
  4019
  4020     12  CL-PROCESS-ERRORS.
  4021         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4022             88  NO-FATAL-ERRORS        VALUE ZERO.
  4023         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4024             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4025
  4026     12  CL-PRODUCT-CD               PIC X.
  4027
  4028     12  CL-CURRENT-KEY-DATA.
  4029         16  CL-CURRENT-CARRIER      PIC X.
  4030         16  CL-CURRENT-GROUPING     PIC X(6).
  4031         16  CL-CURRENT-STATE        PIC XX.
  4032         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4033
  4034     12  CL-ASSOCIATES               PIC X.
  4035         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4036         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4037         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4038         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4039
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  79
* EL156.cbl
  4040     12  CL-ACTIVITY-CODE            PIC 99.
  4041     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4042     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4043
  4044     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4045     12  CL-LAG-REPORT-CODE          PIC 9.
  4046     12  CL-LOAN-TYPE                PIC XX.
  4047     12  CL-LEGAL-STATE              PIC XX.
  4048
  4049     12  CL-YESNOSW                  PIC X.
  4050     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4051         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4052         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4053         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4054     12  cl-insured-type             pic x.
  4055         88  cl-claim-on-primary         value 'P'.
  4056         88  cl-claim-on-co-borrower     value 'C'.
  4057     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  80
* EL156.cbl
  4059*    COPY ELCCNTL.
  4060******************************************************************
  4061*                                                                *
  4062*                                                                *
  4063*                            ELCCNTL.                            *
  4064*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4065*                            VMOD=2.059                          *
  4066*                                                                *
  4067*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4068*                                                                *
  4069*   FILE TYPE = VSAM,KSDS                                        *
  4070*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4071*                                                                *
  4072*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4073*       ALTERNATE INDEX = NONE                                   *
  4074*                                                                *
  4075*   LOG = YES                                                    *
  4076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4077******************************************************************
  4078*                   C H A N G E   L O G
  4079*
  4080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4081*-----------------------------------------------------------------
  4082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4083* EFFECTIVE    NUMBER
  4084*-----------------------------------------------------------------
  4085* 082503                   PEMA  ADD BENEFIT GROUP
  4086* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4087* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4088* 092705    2005050300006  PEMA  ADD SPP LEASES
  4089* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4090* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4091* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4092* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4093* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4094* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4095* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4096* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4097* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4098* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4099******************************************************************
  4100*
  4101 01  CONTROL-FILE.
  4102     12  CF-RECORD-ID                       PIC XX.
  4103         88  VALID-CF-ID                        VALUE 'CF'.
  4104
  4105     12  CF-CONTROL-PRIMARY.
  4106         16  CF-COMPANY-ID                  PIC XXX.
  4107         16  CF-RECORD-TYPE                 PIC X.
  4108             88  CF-COMPANY-MASTER              VALUE '1'.
  4109             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4110             88  CF-STATE-MASTER                VALUE '3'.
  4111             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4112             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4113             88  CF-CARRIER-MASTER              VALUE '6'.
  4114             88  CF-MORTALITY-MASTER            VALUE '7'.
  4115             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4116             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  81
* EL156.cbl
  4117             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4118             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4119             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4120             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4121             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4122             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4123             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4124             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4125             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4126         16  CF-ACCESS-CD-GENL              PIC X(4).
  4127         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4128             20  CF-PROCESSOR               PIC X(4).
  4129         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4130             20  CF-STATE-CODE              PIC XX.
  4131             20  FILLER                     PIC XX.
  4132         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4133             20  FILLER                     PIC XX.
  4134             20  CF-HI-BEN-IN-REC           PIC XX.
  4135         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4136             20  FILLER                     PIC XXX.
  4137             20  CF-CARRIER-CNTL            PIC X.
  4138         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4139             20  FILLER                     PIC XX.
  4140             20  CF-HI-TYPE-IN-REC          PIC 99.
  4141         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4142             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4143                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4144             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4145             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4146         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4147             20  FILLER                     PIC X.
  4148             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4149         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4150             20  FILLER                     PIC XX.
  4151             20  CF-MORTGAGE-PLAN           PIC XX.
  4152         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4153
  4154     12  CF-LAST-MAINT-DT                   PIC XX.
  4155     12  CF-LAST-MAINT-BY                   PIC X(4).
  4156     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4157
  4158     12  CF-RECORD-BODY                     PIC X(728).
  4159
  4160
  4161****************************************************************
  4162*             COMPANY MASTER RECORD                            *
  4163****************************************************************
  4164
  4165     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4166         16  CF-COMPANY-ADDRESS.
  4167             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4168             20  CF-CL-IN-CARE-OF           PIC X(30).
  4169             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4170             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4171             20  CF-CL-CITY-STATE           PIC X(30).
  4172             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4173             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4174         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  82
* EL156.cbl
  4175         16  CF-COMPANY-PASSWORD            PIC X(8).
  4176         16  CF-SECURITY-OPTION             PIC X.
  4177             88  ALL-SECURITY                   VALUE '1'.
  4178             88  COMPANY-VERIFY                 VALUE '2'.
  4179             88  PROCESSOR-VERIFY               VALUE '3'.
  4180             88  NO-SECURITY                    VALUE '4'.
  4181             88  ALL-BUT-TERM                   VALUE '5'.
  4182         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4183             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4184         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4185             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4186         16  CF-INFORCE-LOCATION            PIC X.
  4187             88  CERTS-ARE-ONLINE               VALUE '1'.
  4188             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4189             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4190         16  CF-LOWER-CASE-LETTERS          PIC X.
  4191         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4192             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4193             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4194             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4195             88  CF-ACCNT-CNTL                  VALUE '3'.
  4196             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4197
  4198         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4199         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4200
  4201         16  CF-LGX-CREDIT-USER             PIC X.
  4202             88  CO-IS-NOT-USER                 VALUE 'N'.
  4203             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4204
  4205         16 CF-CREDIT-CALC-CODES.
  4206             20  CF-CR-REM-TERM-CALC PIC X.
  4207               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4208               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4209               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4210               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4211               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4212               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4213               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4214             20  CF-CR-R78-METHOD           PIC X.
  4215               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4216               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4217
  4218         16  CF-CLAIM-CONTROL-COUNTS.
  4219             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4220                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4221
  4222             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4223                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4224
  4225             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4226                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4227
  4228             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4229                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4230
  4231         16  CF-CURRENT-MONTH-END           PIC XX.
  4232
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  83
* EL156.cbl
  4233         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4234             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4235             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4236             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4237             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4238                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4239                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4240             20  CF-CO-PREM-REJECT-SW       PIC X.
  4241                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4242                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4243             20  CF-CO-REF-REJECT-SW        PIC X.
  4244                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4245                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4246
  4247         16  CF-CO-REPORTING-DT             PIC XX.
  4248         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4249         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4250           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4251           88  CF-CO-MONTH-END                  VALUE '1'.
  4252
  4253         16  CF-LGX-CLAIM-USER              PIC X.
  4254             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4255             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4256
  4257         16  CF-CREDIT-EDIT-CONTROLS.
  4258             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4259             20  CF-MIN-AGE                 PIC 99.
  4260             20  CF-DEFAULT-AGE             PIC 99.
  4261             20  CF-MIN-TERM                PIC S999      COMP-3.
  4262             20  CF-MAX-TERM                PIC S999      COMP-3.
  4263             20  CF-DEFAULT-SEX             PIC X.
  4264             20  CF-JOINT-AGE-INPUT         PIC X.
  4265                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4266             20  CF-BIRTH-DATE-INPUT        PIC X.
  4267                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4268             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4269                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4270                 88  CF-ZERO-CARRIER            VALUE '1'.
  4271                 88  CF-ZERO-GROUPING           VALUE '2'.
  4272                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4273             20  CF-EDIT-SW                 PIC X.
  4274                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4275             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4276             20  CF-CR-PR-METHOD            PIC X.
  4277               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4278               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4279             20  FILLER                     PIC X.
  4280
  4281         16  CF-CREDIT-MISC-CONTROLS.
  4282             20  CF-REIN-TABLE-SW           PIC X.
  4283                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4284             20  CF-COMP-TABLE-SW           PIC X.
  4285                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4286             20  CF-EXPERIENCE-RETENTION-AGE
  4287                                            PIC S9        COMP-3.
  4288             20  CF-CONVERSION-DT           PIC XX.
  4289             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4290             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  84
* EL156.cbl
  4291                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4292                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4293
  4294             20  CF-CR-CHECK-NO-CONTROL.
  4295                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4296                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4297                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4298                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4299                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4300                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4301
  4302                 24  CF-CR-CHECK-COUNT       REDEFINES
  4303                     CF-CR-CHECK-COUNTER      PIC X(4).
  4304
  4305                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4306                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4307
  4308                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4309                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4310                 24  CF-MAIL-PROCESSING       PIC X.
  4311                     88  MAIL-PROCESSING          VALUE 'Y'.
  4312
  4313         16  CF-MISC-SYSTEM-CONTROL.
  4314             20  CF-SYSTEM-C                 PIC X.
  4315                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4316             20  CF-SYSTEM-D                 PIC X.
  4317                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4318             20  CF-SOC-SEC-NO-SW            PIC X.
  4319                 88  SOC-SEC-NO-USED             VALUE '1'.
  4320             20  CF-MEMBER-NO-SW             PIC X.
  4321                 88  MEMBER-NO-USED              VALUE '1'.
  4322             20  CF-TAX-ID-NUMBER            PIC X(11).
  4323             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4324             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4325                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4326                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4327                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4328                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4329             20  CF-SYSTEM-E                 PIC X.
  4330                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4331
  4332         16  CF-LGX-LIFE-USER               PIC X.
  4333             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4334             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4335
  4336         16  CF-CR-MONTH-END-DT             PIC XX.
  4337
  4338         16  CF-FILE-MAINT-DATES.
  4339             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4340                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4341             20  CF-LAST-BATCH       REDEFINES
  4342                 CF-LAST-BATCH-NO               PIC X(4).
  4343             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4344             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4345             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4346             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4347             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4348             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  85
* EL156.cbl
  4349             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4350             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4351             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4352             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4353
  4354         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4355         16  FILLER                         PIC X.
  4356
  4357         16  CF-ALT-MORT-CODE               PIC X(4).
  4358         16  CF-MEMBER-CAPTION              PIC X(10).
  4359
  4360         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4361             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4362             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4363             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4364             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4365             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4366
  4367         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4368
  4369         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4370         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4371         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4372         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4373
  4374         16  CF-AH-OVERRIDE-L1              PIC X.
  4375         16  CF-AH-OVERRIDE-L2              PIC XX.
  4376         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4377         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4378
  4379         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4380         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4381
  4382         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4383         16  CF-AR-LAST-EL860-DT            PIC XX.
  4384         16  CF-MP-MONTH-END-DT             PIC XX.
  4385
  4386         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4387         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4388             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4389
  4390         16  CF-AR-MONTH-END-DT             PIC XX.
  4391
  4392         16  CF-CRDTCRD-USER                PIC X.
  4393             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4394             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4395
  4396         16  CF-CC-MONTH-END-DT             PIC XX.
  4397
  4398         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4399
  4400         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4401             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4402             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4403             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4404         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4405         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4406         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  86
* EL156.cbl
  4407         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4408             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4409             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4410         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4411         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4412         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4413             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4414         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4415
  4416         16  CF-CL-ZIP-CODE.
  4417             20  CF-CL-ZIP-PRIME.
  4418                 24  CF-CL-ZIP-1ST          PIC X.
  4419                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4420                 24  FILLER                 PIC X(4).
  4421             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4422         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4423             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4424             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4425             20  FILLER                     PIC XXX.
  4426
  4427         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4428         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4429         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4430         16  CF-CO-OPTION-START-DATE        PIC XX.
  4431         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4432           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4433                                                      '3' '4'.
  4434           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4435           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4436           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4437           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4438           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4439           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4440
  4441         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4442
  4443         16  CF-PAYMENT-APPROVAL-LEVELS.
  4444             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4445             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4446             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4447             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4448             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4449             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4450
  4451         16  CF-END-USER-REPORTING-USER     PIC X.
  4452             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4453             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4454
  4455         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4456             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4457             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4458
  4459         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4460
  4461         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4462         16  FILLER                         PIC X.
  4463
  4464         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  87
* EL156.cbl
  4465             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4466             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4467             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4468
  4469         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4470
  4471         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4472             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4473             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4474
  4475         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4476             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4477             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4478
  4479         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4480
  4481         16  CF-CO-ACH-ID-CODE              PIC  X.
  4482             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4483             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4484             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4485         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4486         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4487         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4488         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4489         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4490         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4491         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4492         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4493         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4494                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4495         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4496                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4497
  4498         16  CF-CO-OVER-SHORT.
  4499             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4500             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4501
  4502*         16  FILLER                         PIC X(102).
  4503         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4504             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4505             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4506
  4507         16  CF-AH-APPROVAL-DAYS.
  4508             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4509             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4510             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4511             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4512
  4513         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4514
  4515         16  CF-APPROV-LEV-5.
  4516             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4517             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4518             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4519
  4520         16  FILLER                         PIC X(68).
  4521****************************************************************
  4522*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  88
* EL156.cbl
  4523****************************************************************
  4524
  4525     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4526         16  CF-PROCESSOR-NAME              PIC X(30).
  4527         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4528         16  CF-PROCESSOR-TITLE             PIC X(26).
  4529         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4530                 88  MESSAGE-YES                VALUE 'Y'.
  4531                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4532
  4533*****************************************************
  4534****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4535****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4536****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4537****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4538*****************************************************
  4539
  4540         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4541             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4542             20  CF-APPLICATION-FORCE       PIC X.
  4543             20  CF-INDIVIDUAL-APP.
  4544                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4545                     28  CF-BROWSE-APP      PIC X.
  4546                     28  CF-UPDATE-APP      PIC X.
  4547
  4548         16  CF-CURRENT-TERM-ON             PIC X(4).
  4549         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4550             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4551             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4552             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4553             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4554             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4555             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4556             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4557         16  CF-PROCESSOR-CARRIER           PIC X.
  4558             88  NO-CARRIER-SECURITY            VALUE ' '.
  4559         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4560             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4561         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4562             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4563         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4564             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4565
  4566         16  CF-PROC-SYS-ACCESS-SW.
  4567             20  CF-PROC-CREDIT-CLAIMS-SW.
  4568                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4569                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4570                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4571                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4572             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4573                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4574                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4575             20  CF-PROC-LIFE-GNRLDGR-SW.
  4576                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4577                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4578                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4579                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4580             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  89
* EL156.cbl
  4581                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4582                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4583         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4584             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4585             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4586         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4587
  4588         16  CF-APPROVAL-LEVEL                  PIC X.
  4589             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4590             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4591             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4592             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4593             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4594
  4595         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4596
  4597         16  CF-LANGUAGE-TYPE                   PIC X.
  4598             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4599             88  CF-LANG-IS-FR                      VALUE 'F'.
  4600
  4601         16  CF-CSR-IND                         PIC X.
  4602         16  FILLER                             PIC X(239).
  4603
  4604****************************************************************
  4605*             PROCESSOR/REMINDERS RECORD                       *
  4606****************************************************************
  4607
  4608     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4609         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4610             20  CF-START-REMIND-DT         PIC XX.
  4611             20  CF-END-REMIND-DT           PIC XX.
  4612             20  CF-REMINDER-TEXT           PIC X(50).
  4613         16  FILLER                         PIC X(296).
  4614
  4615
  4616****************************************************************
  4617*             STATE MASTER RECORD                              *
  4618****************************************************************
  4619
  4620     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4621         16  CF-STATE-ABBREVIATION          PIC XX.
  4622         16  CF-STATE-NAME                  PIC X(25).
  4623         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4624         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4625             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4626             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4627             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4628             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4629                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4630                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4631             20  CF-ST-PREM-REJECT-SW       PIC X.
  4632                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4633                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4634             20  CF-ST-REF-REJECT-SW        PIC X.
  4635                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4636                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4637         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4638         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  90
* EL156.cbl
  4639         16  CF-ST-REFUND-RULES.
  4640             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4641             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4642             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4643         16  CF-ST-FST-PMT-EXTENSION.
  4644             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4645             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4646                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4647                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4648                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4649                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4650         16  CF-ST-STATE-CALL.
  4651             20  CF-ST-CALL-UNEARNED        PIC X.
  4652             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4653             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4654         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4655             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4656             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4657         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4658         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4659         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4660         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4661         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4662         16  FILLER                         PIC X.
  4663         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4664             20  CF-ST-BENEFIT-CD           PIC XX.
  4665             20  CF-ST-BENEFIT-KIND         PIC X.
  4666                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4667                 88  CF-ST-AH-KIND              VALUE 'A'.
  4668             20  CF-ST-REM-TERM-CALC        PIC X.
  4669                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4670                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4671                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4672                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4673                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4674                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4675                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4676                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4677
  4678             20  CF-ST-REFUND-CALC          PIC X.
  4679                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4680                 88  ST-REFD-BY-R78             VALUE '1'.
  4681                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4682                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4683                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4684                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4685                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4686                 88  ST-REFD-UTAH               VALUE '7'.
  4687                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4688                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4689                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4690
  4691             20  CF-ST-EARNING-CALC         PIC X.
  4692                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4693                 88  ST-EARN-BY-R78             VALUE '1'.
  4694                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4695                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4696                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  91
* EL156.cbl
  4697                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4698                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4699                 88  ST-EARN-MEAN               VALUE '8'.
  4700                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4701
  4702             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4703                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4704                 88  ST-OVRD-BY-R78             VALUE '1'.
  4705                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4706                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4707                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4708                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4709                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4710                 88  ST-OVRD-MEAN               VALUE '8'.
  4711                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4712             20  FILLER                     PIC X.
  4713
  4714         16  CF-ST-COMMISSION-CAPS.
  4715             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4716             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4717             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4718             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4719         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4720                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4721
  4722         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4723
  4724         16  CF-ST-STATUTORY-INTEREST.
  4725             20  CF-ST-STAT-DATE-FROM       PIC X.
  4726                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4727                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4728             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4729             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4730             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4731             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4732             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4733
  4734         16  CF-ST-OVER-SHORT.
  4735             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4736             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4737
  4738         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4739
  4740         16  CF-ST-RT-CALC                  PIC X.
  4741
  4742         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4743         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4744         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4745         16  CF-ST-RF-LR-CALC               PIC X.
  4746         16  CF-ST-RF-LL-CALC               PIC X.
  4747         16  CF-ST-RF-LN-CALC               PIC X.
  4748         16  CF-ST-RF-AH-CALC               PIC X.
  4749         16  CF-ST-RF-CP-CALC               PIC X.
  4750*        16  FILLER                         PIC X(206).
  4751*CIDMOD         16  FILLER                         PIC X(192).
  4752         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4753             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4754         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  92
* EL156.cbl
  4755         16  CF-ST-VFY-2ND-BENE             PIC X.
  4756         16  CF-ST-CAUSAL-STATE             PIC X.
  4757         16  FILLER                         PIC X(185).
  4758
  4759****************************************************************
  4760*             BENEFIT MASTER RECORD                            *
  4761****************************************************************
  4762
  4763     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4764         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4765             20  CF-BENEFIT-CODE            PIC XX.
  4766             20  CF-BENEFIT-NUMERIC  REDEFINES
  4767                 CF-BENEFIT-CODE            PIC XX.
  4768             20  CF-BENEFIT-ALPHA           PIC XXX.
  4769             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4770             20  CF-BENEFIT-COMMENT         PIC X(10).
  4771
  4772             20  CF-LF-COVERAGE-TYPE        PIC X.
  4773                 88  CF-REDUCING                VALUE 'R'.
  4774                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4775
  4776             20  CF-SPECIAL-CALC-CD         PIC X.
  4777                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4778                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4779                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4780                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4781                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4782                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4783                 88  CF-FARM-PLAN               VALUE 'F'.
  4784                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4785                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4786                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4787                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4788                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4789                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4790                 88  CF-PRUDENTIAL              VALUE 'P'.
  4791                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4792                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4793                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4794                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4795                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4796                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4797
  4798             20  CF-JOINT-INDICATOR         PIC X.
  4799                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4800
  4801*            20  FILLER                     PIC X(12).
  4802             20  cf-maximum-benefits        pic s999 comp-3.
  4803             20  FILLER                     PIC X(09).
  4804             20  CF-BENEFIT-CATEGORY        PIC X.
  4805             20  CF-LOAN-TYPE               PIC X(8).
  4806
  4807             20  CF-CO-REM-TERM-CALC        PIC X.
  4808                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4809                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4810                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4811                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4812                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  93
* EL156.cbl
  4813
  4814             20  CF-CO-EARNINGS-CALC        PIC X.
  4815                 88  CO-EARN-BY-R78             VALUE '1'.
  4816                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4817                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4818                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4819                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4820                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4821                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4822                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4823
  4824             20  CF-CO-REFUND-CALC          PIC X.
  4825                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4826                 88  CO-REFD-BY-R78             VALUE '1'.
  4827                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4828                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4829                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4830                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4831                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4832                 88  CO-REFD-MEAN               VALUE '8'.
  4833                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4834                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4835                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4836
  4837             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4838                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4839                 88  CO-OVRD-BY-R78             VALUE '1'.
  4840                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4841                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4842                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4843                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4844                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4845                 88  CO-OVRD-MEAN               VALUE '8'.
  4846                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4847
  4848             20  CF-CO-BEN-I-G-CD           PIC X.
  4849                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4850                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4851                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4852
  4853         16  FILLER                         PIC X(304).
  4854
  4855
  4856****************************************************************
  4857*             CARRIER MASTER RECORD                            *
  4858****************************************************************
  4859
  4860     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4861         16  CF-ADDRESS-DATA.
  4862             20  CF-MAIL-TO-NAME            PIC X(30).
  4863             20  CF-IN-CARE-OF              PIC X(30).
  4864             20  CF-ADDRESS-LINE-1          PIC X(30).
  4865             20  CF-ADDRESS-LINE-2          PIC X(30).
  4866             20  CF-CITY-STATE              PIC X(30).
  4867             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4868             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4869
  4870         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  94
* EL156.cbl
  4871             20  CF-CLAIM-NO-METHOD         PIC X.
  4872                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4873                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4874                 88  CLAIM-NO-SEQ               VALUE '3'.
  4875                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4876             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4877                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4878                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4879                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4880
  4881         16  CF-CHECK-NO-CONTROL.
  4882             20  CF-CHECK-NO-METHOD         PIC X.
  4883                 88  CHECK-NO-MANUAL            VALUE '1'.
  4884                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4885                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4886                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4887             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4888                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4889
  4890         16  CF-DOMICILE-STATE              PIC XX.
  4891
  4892         16  CF-EXPENSE-CONTROLS.
  4893             20  CF-EXPENSE-METHOD          PIC X.
  4894                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4895                 88  DOLLARS-PER-PMT            VALUE '2'.
  4896                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4897                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4898             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4899             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4900
  4901         16  CF-CORRESPONDENCE-CONTROL.
  4902             20  CF-LETTER-RESEND-OPT       PIC X.
  4903                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4904                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4905             20  FILLER                     PIC X(4).
  4906
  4907         16  CF-RESERVE-CONTROLS.
  4908             20  CF-MANUAL-SW               PIC X.
  4909                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4910             20  CF-FUTURE-SW               PIC X.
  4911                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4912             20  CF-PTC-SW                  PIC X.
  4913                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4914             20  CF-IBNR-SW                 PIC X.
  4915                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4916             20  CF-PTC-LF-SW               PIC X.
  4917                 88  CF-LF-PTC-USED             VALUE '1'.
  4918             20  CF-CDT-ACCESS-METHOD       PIC X.
  4919                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4920                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4921                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4922             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4923
  4924         16  CF-CLAIM-CALC-METHOD           PIC X.
  4925             88  360-PLUS-MONTHS                VALUE '1'.
  4926             88  365-PLUS-MONTHS                VALUE '2'.
  4927             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4928             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  95
* EL156.cbl
  4929             88  365-DAILY                      VALUE '5'.
  4930
  4931         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4932         16  FILLER                         PIC X(11).
  4933
  4934         16  CF-LIMIT-AMOUNTS.
  4935             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4936             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4937             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4938             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4939             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4940             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4941             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4942             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4943             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4944             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4945
  4946         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4947         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4948         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4949
  4950         16  CF-ZIP-CODE.
  4951             20  CF-ZIP-PRIME.
  4952                 24  CF-ZIP-1ST             PIC X.
  4953                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4954                 24  FILLER                 PIC X(4).
  4955             20  CF-ZIP-PLUS4               PIC X(4).
  4956         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4957             20  CF-CAN-POSTAL-1            PIC XXX.
  4958             20  CF-CAN-POSTAL-2            PIC XXX.
  4959             20  FILLER                     PIC XXX.
  4960
  4961         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4962         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4963         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4964
  4965         16  CF-RATING-SWITCH               PIC X.
  4966             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4967             88  CF-NO-RATING                   VALUE 'N'.
  4968
  4969         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4970
  4971         16  CF-CARRIER-OVER-SHORT.
  4972             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4973             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4974
  4975         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4976         16  CF-SECPAY-SWITCH               PIC X.
  4977             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4978             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4979         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4980         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4981         16  FILLER                         PIC X(444).
  4982*        16  FILLER                         PIC X(452).
  4983
  4984
  4985****************************************************************
  4986*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  96
* EL156.cbl
  4987****************************************************************
  4988
  4989     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4990         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4991                                INDEXED BY CF-MORT-NDX.
  4992             20  CF-MORT-TABLE              PIC X(5).
  4993             20  CF-MORT-TABLE-TYPE         PIC X.
  4994                 88  CF-MORT-JOINT              VALUE 'J'.
  4995                 88  CF-MORT-SINGLE             VALUE 'S'.
  4996                 88  CF-MORT-COMBINED           VALUE 'C'.
  4997                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4998                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4999             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5000             20  CF-MORT-AGE-METHOD         PIC XX.
  5001                 88  CF-AGE-LAST                VALUE 'AL'.
  5002                 88  CF-AGE-NEAR                VALUE 'AN'.
  5003             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5004             20  CF-MORT-ADJUSTMENT-DIRECTION
  5005                                            PIC X.
  5006                 88  CF-MINUS                   VALUE '-'.
  5007                 88  CF-PLUS                    VALUE '+'.
  5008             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5009             20  CF-MORT-JOINT-CODE         PIC X.
  5010                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5011             20  CF-MORT-PC-Q               PIC X.
  5012                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5013             20  CF-MORT-TABLE-CODE         PIC X(4).
  5014             20  CF-MORT-COMMENTS           PIC X(15).
  5015             20  FILLER                     PIC X(14).
  5016
  5017         16  FILLER                         PIC X(251).
  5018
  5019
  5020****************************************************************
  5021*             BUSSINESS TYPE MASTER RECORD                     *
  5022****************************************************************
  5023
  5024     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5025* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5026* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5027* AND RECORD 05 IS TYPES 81-99
  5028         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5029             20  CF-BUSINESS-TITLE          PIC  X(19).
  5030             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5031                                            PIC S9V9(4) COMP-3.
  5032             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5033             20  FILLER                     PIC  X.
  5034         16  FILLER                         PIC  X(248).
  5035
  5036
  5037****************************************************************
  5038*             TERMINAL MASTER RECORD                           *
  5039****************************************************************
  5040
  5041     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5042
  5043         16  CF-COMPANY-TERMINALS.
  5044             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  97
* EL156.cbl
  5045                                  PIC X(4).
  5046         16  FILLER               PIC X(248).
  5047
  5048
  5049****************************************************************
  5050*             LIFE EDIT MASTER RECORD                          *
  5051****************************************************************
  5052
  5053     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5054         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5055             20  CF-LIFE-CODE-IN            PIC XX.
  5056             20  CF-LIFE-CODE-OUT           PIC XX.
  5057         16  FILLER                         PIC X(248).
  5058
  5059
  5060****************************************************************
  5061*             AH EDIT MASTER RECORD                            *
  5062****************************************************************
  5063
  5064     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5065         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5066             20  CF-AH-CODE-IN              PIC XXX.
  5067             20  CF-AH-CODE-OUT             PIC XX.
  5068         16  FILLER                         PIC X(248).
  5069
  5070
  5071****************************************************************
  5072*             CREDIBILITY TABLES                               *
  5073****************************************************************
  5074
  5075     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5076         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5077                             INDEXED BY CF-CRDB-NDX.
  5078             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5079             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5080             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5081         16  FILLER                         PIC  X(332).
  5082
  5083
  5084****************************************************************
  5085*             REPORT CUSTOMIZATION RECORD                      *
  5086****************************************************************
  5087
  5088     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5089         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5090             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5091             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5092             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5093**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5094****       A T-TRANSFER.                                   ****
  5095             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5096
  5097         16  FILLER                         PIC XX.
  5098
  5099         16  CF-CARRIER-CNTL-OPT.
  5100             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5101                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5102                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  98
* EL156.cbl
  5103             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5104                                            PIC X.
  5105         16  CF-GROUP-CNTL-OPT.
  5106             20  CF-GROUP-OPT-SEQ           PIC 9.
  5107                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5108                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5109             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5110                                            PIC X(6).
  5111         16  CF-STATE-CNTL-OPT.
  5112             20  CF-STATE-OPT-SEQ           PIC 9.
  5113                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5114                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5115             20  CF-STATE-SELECT OCCURS 3 TIMES
  5116                                            PIC XX.
  5117         16  CF-ACCOUNT-CNTL-OPT.
  5118             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5119                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5120                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5121             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5122                                            PIC X(10).
  5123         16  CF-BUS-TYP-CNTL-OPT.
  5124             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5125                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5126                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5127             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5128                                            PIC XX.
  5129         16  CF-LF-TYP-CNTL-OPT.
  5130             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5131                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5132                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5133             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5134                                            PIC XX.
  5135         16  CF-AH-TYP-CNTL-OPT.
  5136             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5137                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5138                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5139             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5140                                            PIC XX.
  5141         16  CF-REPTCD1-CNTL-OPT.
  5142             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5143                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5144                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5145             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5146                                            PIC X(10).
  5147         16  CF-REPTCD2-CNTL-OPT.
  5148             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5149                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5150                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5151             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5152                                            PIC X(10).
  5153         16  CF-USER1-CNTL-OPT.
  5154             20  CF-USER1-OPT-SEQ           PIC 9.
  5155                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5156                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5157             20  CF-USER1-SELECT OCCURS 3 TIMES
  5158                                            PIC X(10).
  5159         16  CF-USER2-CNTL-OPT.
  5160             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  99
* EL156.cbl
  5161                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5162                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5163             20  CF-USER2-SELECT OCCURS 3 TIMES
  5164                                            PIC X(10).
  5165         16  CF-USER3-CNTL-OPT.
  5166             20  CF-USER3-OPT-SEQ           PIC 9.
  5167                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5168                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5169             20  CF-USER3-SELECT OCCURS 3 TIMES
  5170                                            PIC X(10).
  5171         16  CF-USER4-CNTL-OPT.
  5172             20  CF-USER4-OPT-SEQ           PIC 9.
  5173                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5174                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5175             20  CF-USER4-SELECT OCCURS 3 TIMES
  5176                                            PIC X(10).
  5177         16  CF-USER5-CNTL-OPT.
  5178             20  CF-USER5-OPT-SEQ           PIC 9.
  5179                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5180                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5181             20  CF-USER5-SELECT OCCURS 3 TIMES
  5182                                            PIC X(10).
  5183         16  CF-REINS-CNTL-OPT.
  5184             20  CF-REINS-OPT-SEQ           PIC 9.
  5185                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5186                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5187             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5188                 24  CF-REINS-PRIME         PIC XXX.
  5189                 24  CF-REINS-SUB           PIC XXX.
  5190
  5191         16  CF-AGENT-CNTL-OPT.
  5192             20  CF-AGENT-OPT-SEQ           PIC 9.
  5193                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5194                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5195             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5196                                            PIC X(10).
  5197
  5198         16  FILLER                         PIC X(43).
  5199
  5200         16  CF-LOSS-RATIO-SELECT.
  5201             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5202             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5203         16  CF-ENTRY-DATE-SELECT.
  5204             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5205             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5206         16  CF-EFFECTIVE-DATE-SELECT.
  5207             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5208             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5209
  5210         16  CF-EXCEPTION-LIST-IND          PIC X.
  5211             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5212
  5213         16  FILLER                         PIC X(318).
  5214
  5215****************************************************************
  5216*                  EXCEPTION REPORTING RECORD                  *
  5217****************************************************************
  5218
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 100
* EL156.cbl
  5219     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5220         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5221             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5222
  5223         16  CF-COMBINED-LIFE-AH-OPT.
  5224             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5225             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5226             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5227             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5228
  5229         16  CF-LIFE-OPT.
  5230             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5231             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5232             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5233             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5234             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5235             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5236             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5237             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5238             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5239             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5240
  5241         16  CF-AH-OPT.
  5242             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5243             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5244             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5245             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5246             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5247             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5248             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5249             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5250             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5251             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5252
  5253         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5254             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5255             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5256             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5257
  5258         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5259
  5260         16  FILLER                         PIC X(673).
  5261
  5262
  5263****************************************************************
  5264*             MORTGAGE SYSTEM PLAN RECORD                      *
  5265****************************************************************
  5266
  5267     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5268         16  CF-PLAN-TYPE                   PIC X.
  5269             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5270             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5271             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5272         16  CF-PLAN-ABBREV                 PIC XXX.
  5273         16  CF-PLAN-DESCRIPT               PIC X(10).
  5274         16  CF-PLAN-NOTES                  PIC X(20).
  5275         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5276         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 101
* EL156.cbl
  5277             20  CF-PLAN-TERM-DATA.
  5278                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5279                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5280             20  CF-PLAN-AGE-DATA.
  5281                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5282                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5283                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5284             20  CF-PLAN-BENEFIT-DATA.
  5285                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5286                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5287                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5288                                            PIC S9(7)V99  COMP-3.
  5289         16  CF-PLAN-POLICY-FORMS.
  5290             20  CF-POLICY-FORM             PIC X(12).
  5291             20  CF-MASTER-APPLICATION      PIC X(12).
  5292             20  CF-MASTER-POLICY           PIC X(12).
  5293         16  CF-PLAN-RATING.
  5294             20  CF-RATE-CODE               PIC X(5).
  5295             20  CF-SEX-RATING              PIC X.
  5296                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5297                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5298             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5299             20  CF-SUB-STD-TYPE            PIC X.
  5300                 88  CF-PCT-OF-PREM            VALUE '1'.
  5301                 88  CF-PCT-OF-BENE            VALUE '2'.
  5302         16  CF-PLAN-PREM-TOLERANCES.
  5303             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5304             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5305         16  CF-PLAN-PYMT-TOLERANCES.
  5306             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5307             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5308         16  CF-PLAN-MISC-DATA.
  5309             20  FILLER                     PIC X.
  5310             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5311             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5312         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5313         16  CF-PLAN-IND-GRP                PIC X.
  5314             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5315                                                     '1'.
  5316             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5317                                                     '2'.
  5318         16  CF-MIB-SEARCH-SW               PIC X.
  5319             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5320             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5321             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5322             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5323         16  CF-ALPHA-SEARCH-SW             PIC X.
  5324             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5325             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5326             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5327             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5328             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5329             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5330             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5331             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5332             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5333             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5334                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 102
* EL156.cbl
  5335                                                     'X' 'Y' 'Z'.
  5336         16  CF-EFF-DT-RULE-SW              PIC X.
  5337             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5338             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5339             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5340             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5341             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5342         16  FILLER                         PIC X(4).
  5343         16  CF-HEALTH-QUESTIONS            PIC X.
  5344             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5345         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5346         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5347         16  CF-PLAN-SNGL-JNT               PIC X.
  5348             88  CF-COMBINED-PLAN              VALUE 'C'.
  5349             88  CF-JNT-PLAN                   VALUE 'J'.
  5350             88  CF-SNGL-PLAN                  VALUE 'S'.
  5351         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5352         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5353         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5354         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5355         16  CF-RERATE-CNTL                 PIC  X.
  5356             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5357             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5358             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5359             88  CF-AUTO-RECALC                 VALUE '4'.
  5360         16  CF-BENEFIT-TYPE                PIC  X.
  5361             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5362             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5363         16  CF-POLICY-FEE                  PIC S999V99
  5364                                                    COMP-3.
  5365         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5366         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5367         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5368         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5369         16  FILLER                         PIC  X(32).
  5370         16  CF-TERMINATION-FORM            PIC  X(04).
  5371         16  FILLER                         PIC  X(08).
  5372         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5373                                                       COMP-3.
  5374         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5375         16  CF-ISSUE-LETTER                PIC  X(4).
  5376         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5377         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5378             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5379             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5380         16  CF-MP-REFUND-CALC              PIC X.
  5381             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5382             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5383             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5384             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5385             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5386             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5387             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5388             88  CF-MP-REFD-MEAN                VALUE '8'.
  5389         16  CF-ALT-RATE-CODE               PIC  X(5).
  5390
  5391
  5392         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 103
* EL156.cbl
  5393****************************************************************
  5394*             MORTGAGE COMPANY MASTER RECORD                   *
  5395****************************************************************
  5396
  5397     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5398         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5399         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5400             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5401             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5402             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5403             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5404             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5405
  5406         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5407         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5408         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5409         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5410         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5411
  5412         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5413             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5414         16  CF-MP-RECON-USE-IND            PIC X(1).
  5415             88  CF-MP-USE-RECON             VALUE 'Y'.
  5416         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5417             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5418         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5419             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5420             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5421         16  FILLER                         PIC X(1).
  5422         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5423             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5424         16  CF-MORTG-MIB-VERSION           PIC X.
  5425             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5426             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5427             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5428         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5429             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5430                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5431             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5432                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5433             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5434                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5435             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5436                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5437             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5438                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5439             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5440                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5441         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5442         16  FILLER                         PIC X(7).
  5443         16  CF-MORTG-DESTINATION-SYMBOL.
  5444             20  CF-MORTG-MIB-COMM          PIC X(5).
  5445             20  CF-MORTG-MIB-TERM          PIC X(5).
  5446         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5447             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5448         16  FILLER                         PIC X(03).
  5449         16  CF-MP-CHECK-NO-CONTROL.
  5450             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 104
* EL156.cbl
  5451                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5452                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5453                                                ' ' LOW-VALUES.
  5454                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5455                                               VALUE '3'.
  5456         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5457         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5458         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5459             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5460                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5461             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5462                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5463             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5464                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5465             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5466                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5467             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5468                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5469             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5470                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5471         16  CF-MORTG-BILLING-AREA.
  5472             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5473                                            PIC X.
  5474         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5475         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5476         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5477         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5478             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5479             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5480         16  FILLER                         PIC X.
  5481         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5482             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5483             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5484         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5485         16  FILLER                         PIC X(8).
  5486         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5487         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5488         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5489         16  CF-ACH-COMPANY-ID.
  5490             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5491                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5492                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5493                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5494             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5495         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5496             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5497         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5498             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5499             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5500         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5501         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5502         16  FILLER                         PIC X(536).
  5503
  5504****************************************************************
  5505*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5506****************************************************************
  5507
  5508     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 105
* EL156.cbl
  5509         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5510             20  CF-FEMALE-HEIGHT.
  5511                 24  CF-FEMALE-FT           PIC 99.
  5512                 24  CF-FEMALE-IN           PIC 99.
  5513             20  CF-FEMALE-MIN-WT           PIC 999.
  5514             20  CF-FEMALE-MAX-WT           PIC 999.
  5515         16  FILLER                         PIC X(428).
  5516
  5517     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5518         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5519             20  CF-MALE-HEIGHT.
  5520                 24  CF-MALE-FT             PIC 99.
  5521                 24  CF-MALE-IN             PIC 99.
  5522             20  CF-MALE-MIN-WT             PIC 999.
  5523             20  CF-MALE-MAX-WT             PIC 999.
  5524         16  FILLER                         PIC X(428).
  5525******************************************************************
  5526*             AUTOMATIC ACTIVITY RECORD                          *
  5527******************************************************************
  5528     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5529         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5530             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5531             20  CF-SYS-LETTER-ID           PIC X(04).
  5532             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5533             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5534             20  CF-SYS-RESET-SW            PIC X(01).
  5535             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5536             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5537
  5538         16  FILLER                         PIC X(50).
  5539
  5540         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5541             20  CF-USER-ACTIVE-SW          PIC X(01).
  5542             20  CF-USER-LETTER-ID          PIC X(04).
  5543             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5544             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5545             20  CF-USER-RESET-SW           PIC X(01).
  5546             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5547             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5548             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5549
  5550         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 106
* EL156.cbl
  5552*    COPY ELCCERT.
  5553******************************************************************
  5554*                                                                *
  5555*                            ELCCERT.                            *
  5556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5557*                            VMOD=2.013                          *
  5558*                                                                *
  5559*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5560*                                                                *
  5561*   FILE TYPE = VSAM,KSDS                                        *
  5562*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5563*                                                                *
  5564*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5565*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5566*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5567*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5568*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5569*                                                                *
  5570*   LOG = YES                                                    *
  5571*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5572******************************************************************
  5573*                   C H A N G E   L O G
  5574*
  5575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5576*-----------------------------------------------------------------
  5577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5578* EFFECTIVE    NUMBER
  5579*-----------------------------------------------------------------
  5580* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5581* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5582* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5583* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5584* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5585* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5586* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5587* 032612  CR2011110200001  PEMA  AHL CHANGES
  5588******************************************************************
  5589
  5590 01  CERTIFICATE-MASTER.
  5591     12  CM-RECORD-ID                      PIC XX.
  5592         88  VALID-CM-ID                      VALUE 'CM'.
  5593
  5594     12  CM-CONTROL-PRIMARY.
  5595         16  CM-COMPANY-CD                 PIC X.
  5596         16  CM-CARRIER                    PIC X.
  5597         16  CM-GROUPING.
  5598             20  CM-GROUPING-PREFIX        PIC X(3).
  5599             20  CM-GROUPING-PRIME         PIC X(3).
  5600         16  CM-STATE                      PIC XX.
  5601         16  CM-ACCOUNT.
  5602             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5603             20  CM-ACCOUNT-PRIME          PIC X(6).
  5604         16  CM-CERT-EFF-DT                PIC XX.
  5605         16  CM-CERT-NO.
  5606             20  CM-CERT-PRIME             PIC X(10).
  5607             20  CM-CERT-SFX               PIC X.
  5608
  5609     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 107
* EL156.cbl
  5610         16  CM-COMPANY-CD-A1              PIC X.
  5611         16  CM-INSURED-LAST-NAME          PIC X(15).
  5612         16  CM-INSURED-INITIALS.
  5613             20  CM-INSURED-INITIAL1       PIC X.
  5614             20  CM-INSURED-INITIAL2       PIC X.
  5615
  5616     12  CM-CONTROL-BY-SSN.
  5617         16  CM-COMPANY-CD-A2              PIC X.
  5618         16  CM-SOC-SEC-NO.
  5619             20  CM-SSN-STATE              PIC XX.
  5620             20  CM-SSN-ACCOUNT            PIC X(6).
  5621             20  CM-SSN-LN3.
  5622                 25  CM-INSURED-INITIALS-A2.
  5623                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5624                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5625                 25 CM-PART-LAST-NAME-A2         PIC X.
  5626
  5627     12  CM-CONTROL-BY-CERT-NO.
  5628         16  CM-COMPANY-CD-A4              PIC X.
  5629         16  CM-CERT-NO-A4                 PIC X(11).
  5630
  5631     12  CM-CONTROL-BY-MEMB.
  5632         16  CM-COMPANY-CD-A5              PIC X.
  5633         16  CM-MEMBER-NO.
  5634             20  CM-MEMB-STATE             PIC XX.
  5635             20  CM-MEMB-ACCOUNT           PIC X(6).
  5636             20  CM-MEMB-LN4.
  5637                 25  CM-INSURED-INITIALS-A5.
  5638                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5639                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5640                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5641
  5642     12  CM-INSURED-PROFILE-DATA.
  5643         16  CM-INSURED-FIRST-NAME.
  5644             20  CM-INSURED-1ST-INIT       PIC X.
  5645             20  FILLER                    PIC X(9).
  5646         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5647         16  CM-INSURED-SEX                PIC X.
  5648             88  CM-SEX-MALE                  VALUE 'M'.
  5649             88  CM-SEX-FEMAL                 VALUE 'F'.
  5650         16  CM-INSURED-JOINT-AGE          PIC 99.
  5651         16  CM-JOINT-INSURED-NAME.
  5652             20  CM-JT-LAST-NAME           PIC X(15).
  5653             20  CM-JT-FIRST-NAME.
  5654                 24  CM-JT-1ST-INIT        PIC X.
  5655                 24  FILLER                PIC X(9).
  5656             20  CM-JT-INITIAL             PIC X.
  5657
  5658     12  CM-LIFE-DATA.
  5659         16  CM-LF-BENEFIT-CD              PIC XX.
  5660         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5661         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5662         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5663         16  CM-LF-DEV-CODE                PIC XXX.
  5664         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5665         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5666         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5667         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 108
* EL156.cbl
  5668         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5669         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5670         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5671         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5672         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5673         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5674         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5675         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5676         16  FILLER                        PIC XX.
  5677
  5678     12  CM-AH-DATA.
  5679         16  CM-AH-BENEFIT-CD              PIC XX.
  5680         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5681         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5682         16  CM-AH-DEV-CODE                PIC XXX.
  5683         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5684         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5685         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5686         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5687         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5688         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5689         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5690         16  CM-AH-PAID-THRU-DT            PIC XX.
  5691             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5692         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5693         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5694         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5695         16  FILLER                        PIC X.
  5696
  5697     12  CM-LOAN-INFORMATION.
  5698         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5699         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5700                                           PIC S9(5)V99  COMP-3.
  5701         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5702         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5703         16  CM-PAY-FREQUENCY              PIC S99.
  5704         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5705         16  CM-RATE-CLASS                 PIC XX.
  5706         16  CM-BENEFICIARY                PIC X(25).
  5707         16  CM-POLICY-FORM-NO             PIC X(12).
  5708         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5709         16  CM-LAST-ADD-ON-DT             PIC XX.
  5710         16  CM-DEDUCTIBLE-AMOUNTS.
  5711             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5712             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5713         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5714             20  CM-RESIDENT-STATE         PIC XX.
  5715             20  CM-RATE-CODE              PIC X(4).
  5716             20  FILLER                    PIC XX.
  5717         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5718             20  CM-LOAN-OFFICER           PIC X(5).
  5719             20  FILLER                    PIC XXX.
  5720         16  CM-CSR-CODE                   PIC XXX.
  5721         16  CM-UNDERWRITING-CODE          PIC X.
  5722             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5723         16  CM-POST-CARD-IND              PIC X.
  5724         16  CM-NH-INTERFACE-SW            PIC X.
  5725         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 109
* EL156.cbl
  5726             88  CM-SING-PRM                  VALUE '1'.
  5727             88  CM-O-B-COVERAGE              VALUE '2'.
  5728             88  CM-OPEN-END                  VALUE '3'.
  5729         16  CM-IND-GRP-TYPE               PIC X.
  5730             88  CM-INDIVIDUAL                VALUE 'I'.
  5731             88  CM-GROUP                     VALUE 'G'.
  5732         16  CM-SKIP-CODE                  PIC X.
  5733             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5734             88  SKIP-JULY                    VALUE '1'.
  5735             88  SKIP-AUGUST                  VALUE '2'.
  5736             88  SKIP-SEPTEMBER               VALUE '3'.
  5737             88  SKIP-JULY-AUG                VALUE '4'.
  5738             88  SKIP-AUG-SEPT                VALUE '5'.
  5739             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5740             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5741             88  SKIP-JUNE                    VALUE '8'.
  5742             88  SKIP-JUNE-JULY               VALUE '9'.
  5743             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5744             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5745         16  CM-PAYMENT-MODE               PIC X.
  5746             88  PAY-MONTHLY                  VALUE SPACE.
  5747             88  PAY-WEEKLY                   VALUE '1'.
  5748             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5749             88  PAY-BI-WEEKLY                VALUE '3'.
  5750             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5751         16  CM-LOAN-NUMBER                PIC X(8).
  5752         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5753         16  CM-OLD-LOF                    PIC XXX.
  5754*        16  CM-LOAN-OFFICER               PIC XXX.
  5755         16  CM-REIN-TABLE                 PIC XXX.
  5756         16  CM-SPECIAL-REIN-CODE          PIC X.
  5757         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5758         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5759         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5760
  5761     12  CM-STATUS-DATA.
  5762         16  CM-ENTRY-STATUS               PIC X.
  5763         16  CM-ENTRY-DT                   PIC XX.
  5764
  5765         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5766         16  CM-LF-CANCEL-DT               PIC XX.
  5767         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5768
  5769         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5770         16  CM-LF-DEATH-DT                PIC XX.
  5771         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5772
  5773         16  CM-LF-CURRENT-STATUS          PIC X.
  5774             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5775                                                'M' '4' '5' '9'.
  5776             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5777             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5778             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5779             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5780             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5781             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5782             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5783             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 110
* EL156.cbl
  5784             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5785             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5786             88  CM-LF-DECLINED               VALUE 'D'.
  5787             88  CM-LF-VOIDED                 VALUE 'V'.
  5788
  5789         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5790         16  CM-AH-CANCEL-DT               PIC XX.
  5791         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5792
  5793         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5794         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5795         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5796
  5797         16  CM-AH-CURRENT-STATUS          PIC X.
  5798             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5799                                                'M' '4' '5' '9'.
  5800             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5801             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5802             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5803             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5804             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5805             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5806             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5807             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5808             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5809             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5810             88  CM-AH-DECLINED               VALUE 'D'.
  5811             88  CM-AH-VOIDED                 VALUE 'V'.
  5812
  5813         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5814             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5815             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5816             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5817         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5818
  5819         16  CM-ENTRY-BATCH                PIC X(6).
  5820         16  CM-LF-EXIT-BATCH              PIC X(6).
  5821         16  CM-AH-EXIT-BATCH              PIC X(6).
  5822         16  CM-LAST-MONTH-END             PIC XX.
  5823
  5824     12  CM-NOTE-SW                        PIC X.
  5825         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5826         88  CERT-NOTES-PRESENT               VALUE '1'.
  5827         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5828         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5829         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5830         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5831         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5832         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5833     12  CM-COMP-EXCP-SW                   PIC X.
  5834         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5835         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5836     12  CM-INSURED-ADDRESS-SW             PIC X.
  5837         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5838         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5839
  5840*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5841     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 111
* EL156.cbl
  5842     12  FILLER                            PIC X.
  5843
  5844*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5845     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5846     12  FILLER                            PIC X.
  5847*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5848     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5849
  5850     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5851         88  CERT-ADDED-BATCH                 VALUE ' '.
  5852         88  CERT-ADDED-ONLINE                VALUE '1'.
  5853         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5854         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5855         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5856     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5857         88  CERT-AS-LOADED                   VALUE ' '.
  5858         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5859         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5860         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5861         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5862         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5863         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5864         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5865
  5866     12  CM-ACCOUNT-COMM-PCTS.
  5867         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5868         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5869
  5870     12  CM-USER-FIELD                     PIC X.
  5871     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5872     12  CM-CLP-STATE                      PIC XX.
  5873     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5874     12  CM-USER-RESERVED                  PIC XXX.
  5875     12  FILLER REDEFINES CM-USER-RESERVED.
  5876         16  CM-AH-CLASS-CD                PIC XX.
  5877         16  F                             PIC X.
  5878******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 112
* EL156.cbl
  5880*    COPY ELCTRLR.
  5881******************************************************************
  5882*                                                                *
  5883*                            ELCTRLR.                            *
  5884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5885*                            VMOD=2.014                          *
  5886*                                                                *
  5887*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5888*                                                                *
  5889*   FILE TYPE = VSAM,KSDS                                        *
  5890*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5891*                                                                *
  5892*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5893*       ALTERNATE INDEX = NONE                                   *
  5894*                                                                *
  5895*   LOG = YES                                                    *
  5896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5897******************************************************************
  5898*                   C H A N G E   L O G
  5899*
  5900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5901*-----------------------------------------------------------------
  5902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5903* EFFECTIVE    NUMBER
  5904*-----------------------------------------------------------------
  5905* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5906* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5907* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5908* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5909* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5910* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5911* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5912* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5913* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5914* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5915* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5916* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5917* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5918* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5919* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5920* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5921* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5922* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5923* 040814    2014030500002  AJRA  ADD ICD CODES
  5924******************************************************************
  5925 01  ACTIVITY-TRAILERS.
  5926     12  AT-RECORD-ID                    PIC XX.
  5927         88  VALID-AT-ID                       VALUE 'AT'.
  5928
  5929     12  AT-CONTROL-PRIMARY.
  5930         16  AT-COMPANY-CD               PIC X.
  5931         16  AT-CARRIER                  PIC X.
  5932         16  AT-CLAIM-NO                 PIC X(7).
  5933         16  AT-CERT-NO.
  5934             20  AT-CERT-PRIME           PIC X(10).
  5935             20  AT-CERT-SFX             PIC X.
  5936         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5937             88  AT-1ST-TRL-AVAIL             VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 113
* EL156.cbl
  5938             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5939             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5940             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5941             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5942             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5943             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5944             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5945             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5946             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5947             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5948             88  AT-BENEFICIARY-TRL           VALUE +91.
  5949             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5950             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5951             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5952             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5953
  5954     12  AT-TRAILER-TYPE                 PIC X.
  5955         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5956         88  PAYMENT-TR                       VALUE '2'.
  5957         88  AUTO-PAY-TR                      VALUE '3'.
  5958         88  CORRESPONDENCE-TR                VALUE '4'.
  5959         88  ADDRESS-TR                       VALUE '5'.
  5960         88  GENERAL-INFO-TR                  VALUE '6'.
  5961         88  AUTO-PROMPT-TR                   VALUE '7'.
  5962         88  DENIAL-TR                        VALUE '8'.
  5963         88  INCURRED-CHG-TR                  VALUE '9'.
  5964         88  FORM-CONTROL-TR                  VALUE 'A'.
  5965
  5966     12  AT-RECORDED-DT                  PIC XX.
  5967     12  AT-RECORDED-BY                  PIC X(4).
  5968     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5969
  5970     12  AT-TRAILER-BODY                 PIC X(165).
  5971
  5972     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5973         16  AT-RESERVE-CONTROLS.
  5974             20  AT-MANUAL-SW            PIC X.
  5975                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5976             20  AT-FUTURE-SW            PIC X.
  5977                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5978             20  AT-PTC-SW               PIC X.
  5979                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5980             20  AT-IBNR-SW              PIC X.
  5981                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5982             20  AT-PTC-LF-SW            PIC X.
  5983                 88  AT-LF-PTC-USED          VALUE '1'.
  5984             20  AT-CDT-ACCESS-METHOD    PIC X.
  5985                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5986                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5987                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5988             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5989         16  AT-LAST-COMPUTED-DT         PIC XX.
  5990         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5991         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5992         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5993         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5994         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5995         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 114
* EL156.cbl
  5996         16  AT-EXPENSE-CONTROLS.
  5997             20  AT-EXPENSE-METHOD       PIC X.
  5998                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5999                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6000                 88  PERCENT-OF-PMT           VALUE '3'.
  6001                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6002             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6003             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6004         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6005         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6006
  6007         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6008         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6009
  6010*        16  FILLER                      PIC X(53).
  6011         16  FILLER                      PIC X(47).
  6012
  6013         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6014         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6015
  6016         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6017             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6018             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6019*                    C = CLOSED
  6020*                    O = OPEN
  6021             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6022*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6023
  6024     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6025         16  AT-PAYMENT-TYPE             PIC X.
  6026             88  PARTIAL-PAYMENT                VALUE '1'.
  6027             88  FINAL-PAYMENT                  VALUE '2'.
  6028             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6029             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6030             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6031             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6032             88  VOIDED-PAYMENT                 VALUE '9'.
  6033             88  TRANSFER                       VALUE 'T'.
  6034             88  LIFE-INTEREST                  VALUE 'I'.
  6035
  6036         16  AT-CLAIM-TYPE               PIC X.
  6037             88  PAID-FOR-AH                    VALUE 'A'.
  6038             88  PAID-FOR-LIFE                  VALUE 'L'.
  6039             88  PAID-FOR-IUI                   VALUE 'I'.
  6040             88  PAID-FOR-GAP                   VALUE 'G'.
  6041         16  AT-CLAIM-PREM-TYPE          PIC X.
  6042             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6043             88  AT-O-B-COVERAGE                VALUE '2'.
  6044             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6045         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6046         16  AT-CHECK-NO                 PIC X(7).
  6047         16  AT-PAID-FROM-DT             PIC XX.
  6048         16  AT-PAID-THRU-DT             PIC XX.
  6049         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6050         16  FILLER                      PIC X.
  6051         16  AT-PAYEES-NAME              PIC X(30).
  6052         16  AT-PAYMENT-ORIGIN           PIC X.
  6053             88  ONLINE-MANUAL-PMT              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 115
* EL156.cbl
  6054             88  ONLINE-AUTO-PMT                VALUE '2'.
  6055             88  OFFLINE-PMT                    VALUE '3'.
  6056         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6057         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6058         16  AT-VOID-DATA.
  6059             20  AT-VOID-DT              PIC XX.
  6060*00144       20  AT-VOID-REASON          PIC X(30).
  6061             20  AT-VOID-REASON          PIC X(26).
  6062         16  AT-PMT-APPROVED-BY          PIC X(04).
  6063         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6064         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6065         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6066                                         PIC S99V9(5)  COMP-3.
  6067         16  AT-CREDIT-INTERFACE.
  6068             20  AT-PMT-SELECT-DT        PIC XX.
  6069                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6070             20  AT-PMT-ACCEPT-DT        PIC XX.
  6071                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6072             20  AT-VOID-SELECT-DT       PIC XX.
  6073                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6074             20  AT-VOID-ACCEPT-DT       PIC XX.
  6075                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6076
  6077         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6078                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6079                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6080         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6081
  6082         16  AT-FORCE-CONTROL            PIC X.
  6083             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6084         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6085         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6086         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6087         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6088         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6089         16  AT-BENEFIT-TYPE             PIC X.
  6090
  6091         16  AT-EXPENSE-TYPE             PIC X.
  6092         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6093
  6094         16  AT-PAYEE-TYPE-CD.
  6095             20  AT-PAYEE-TYPE           PIC X.
  6096                 88  INSURED-PAID           VALUE 'I'.
  6097                 88  BENEFICIARY-PAID       VALUE 'B'.
  6098                 88  ACCOUNT-PAID           VALUE 'A'.
  6099                 88  OTHER-1-PAID           VALUE 'O'.
  6100                 88  OTHER-2-PAID           VALUE 'Q'.
  6101                 88  DOCTOR-PAID            VALUE 'P'.
  6102                 88  EMPLOYER-PAID          VALUE 'E'.
  6103             20  AT-PAYEE-SEQ            PIC X.
  6104
  6105         16  AT-CASH-PAYMENT             PIC X.
  6106         16  AT-GROUPED-PAYMENT          PIC X.
  6107         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6108         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6109         16  AT-APPROVED-LEVEL           PIC X.
  6110         16  AT-VOID-TYPE                PIC X.
  6111             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 116
* EL156.cbl
  6112             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6113         16  AT-AIG-UNEMP-IND            PIC X.
  6114             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6115         16  AT-ASSOCIATES               PIC X.
  6116             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6117             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6118
  6119         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6120         16  AT-CV-PMT-CODE              PIC X.
  6121             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6122             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6123             88  FULL-ADD-PAYMENT           VALUE '3'.
  6124             88  HALF-ADD-PAYMENT           VALUE '4'.
  6125             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6126             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6127             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6128             88  ADDL-PAYMENT               VALUE '8'.
  6129
  6130         16  AT-EOB-CODE1                PIC XXX.
  6131         16  AT-EOB-CODE2                PIC XXX.
  6132         16  AT-EOB-CODE3                PIC XXX.
  6133         16  FILLER REDEFINES AT-EOB-CODE3.
  6134             20  AT-PRINT-CLM-FORM       PIC X.
  6135             20  AT-PRINT-SURVEY         PIC X.
  6136             20  AT-SPECIAL-RELEASE      PIC X.
  6137         16  AT-EOB-CODE4                PIC XXX.
  6138         16  FILLER REDEFINES AT-EOB-CODE4.
  6139             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6140             20  FILLER                  PIC X.
  6141         16  AT-EOB-CODE5                PIC XXX.
  6142         16  FILLER REDEFINES AT-EOB-CODE5.
  6143             20  AT-PMT-PROOF-DT         PIC XX.
  6144             20  FILLER                  PIC X.
  6145
  6146         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6147             88  AT-PRINT-EOB            VALUE 'Y'.
  6148
  6149         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6150         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6151
  6152     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6153         16  AT-SCHEDULE-START-DT        PIC XX.
  6154         16  AT-SCHEDULE-END-DT          PIC XX.
  6155         16  AT-TERMINATED-DT            PIC XX.
  6156         16  AT-LAST-PMT-TYPE            PIC X.
  6157             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6158             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6159         16  AT-FIRST-PMT-DATA.
  6160             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6161             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6162             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6163         16  AT-REGULAR-PMT-DATA.
  6164             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6165             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6166             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6167         16  AT-AUTO-PAYEE-CD.
  6168             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6169                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 117
* EL156.cbl
  6170                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6171                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6172                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6173                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6174             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6175         16  AT-AUTO-PAY-DAY             PIC 99.
  6176         16  AT-AUTO-CASH                PIC X.
  6177             88  AT-CASH                      VALUE 'Y'.
  6178             88  AT-NON-CASH                  VALUE 'N'.
  6179*        16  FILLER                      PIC X(129).
  6180         16  AT-AUTO-END-LETTER          PIC X(4).
  6181         16  FILLER                      PIC X(125).
  6182
  6183         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6184         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6185
  6186     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6187         16  AT-LETTER-SENT-DT           PIC XX.
  6188         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6189         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6190         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6191         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6192         16  AT-LETTER-ORIGIN            PIC X.
  6193             88  ONLINE-CREATION              VALUE '1' '3'.
  6194             88  OFFLINE-CREATION             VALUE '2' '4'.
  6195             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6196             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6197         16  AT-STD-LETTER-FORM          PIC X(4).
  6198         16  AT-REASON-TEXT              PIC X(70).
  6199         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6200         16  AT-ADDRESEE-TYPE            PIC X.
  6201              88  INSURED-ADDRESEE            VALUE 'I'.
  6202              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6203              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6204              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6205              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6206              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6207              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6208         16  AT-ADDRESSEE-NAME           PIC X(30).
  6209         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6210         16  AT-RESEND-PRINT-DATE        PIC XX.
  6211         16  AT-CORR-SOL-UNSOL           PIC X.
  6212         16  AT-LETTER-PURGED-DT         PIC XX.
  6213*
  6214*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6215*
  6216         16  AT-CSO-REDEFINITION.
  6217             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6218             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6219             20  AT-LETTER-TO-BENE       PIC X(1).
  6220             20  AT-STOP-LETTER-DT       PIC X(2).
  6221             20  FILLER                  PIC X(19).
  6222*             20  FILLER                  PIC X(27).
  6223             20  AT-CSO-LETTER-STATUS    PIC X.
  6224                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6225                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6226                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6227             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 118
* EL156.cbl
  6228             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6229*
  6230*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6231*
  6232*        16  FILLER                      PIC X(26).
  6233*
  6234*        16  AT-DMD-BSR-CODE             PIC X.
  6235*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6236*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6237*
  6238*        16  AT-DMD-LETTER-STATUS        PIC X.
  6239*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6240*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6241*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6242*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6243*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6244
  6245         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6246         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6247
  6248     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6249         16  AT-ADDRESS-TYPE             PIC X.
  6250             88  INSURED-ADDRESS               VALUE 'I'.
  6251             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6252             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6253             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6254             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6255             88  OTHER-ADDRESS-1               VALUE 'O'.
  6256             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6257         16  AT-MAIL-TO-NAME             PIC X(30).
  6258         16  AT-ADDRESS-LINE-1           PIC X(30).
  6259         16  AT-ADDRESS-LINE-2           PIC X(30).
  6260         16  AT-CITY-STATE.
  6261             20  AT-CITY                 PIC X(28).
  6262             20  AT-STATE                PIC XX.
  6263         16  AT-ZIP.
  6264             20  AT-ZIP-CODE.
  6265                 24  AT-ZIP-1ST          PIC X.
  6266                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6267                 24  FILLER              PIC X(4).
  6268             20  AT-ZIP-PLUS4            PIC X(4).
  6269         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6270             20  AT-CAN-POSTAL-1         PIC XXX.
  6271             20  AT-CAN-POSTAL-2         PIC XXX.
  6272             20  FILLER                  PIC XXX.
  6273         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6274*         16  FILLER                      PIC X(23).
  6275         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6276         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6277         16  FILLER                      PIC X(13).
  6278         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6279         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6280
  6281     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6282         16  AT-INFO-LINE-1              PIC X(60).
  6283         16  FILLER REDEFINES AT-INFO-LINE-1.
  6284             20  AT-NOTE-ERROR-NO OCCURS 15
  6285                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 119
* EL156.cbl
  6286         16  AT-INFO-LINE-2              PIC X(60).
  6287         16  FILLER REDEFINES AT-INFO-LINE-2.
  6288             20  AT-ICD-CODE-1           PIC X(8).
  6289             20  AT-ICD-CODE-2           PIC X(8).
  6290             20  FILLER                  PIC X(44).
  6291         16  AT-INFO-TRAILER-TYPE        PIC X.
  6292             88  AT-ERRORS-NOTE          VALUE 'E'.
  6293             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6294             88  AT-CALL-NOTE            VALUE 'C'.
  6295             88  AT-MAINT-NOTE           VALUE 'M'.
  6296             88  AT-CERT-CHANGE          VALUE 'X'.
  6297             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6298             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6299             88  AT-CERT-CANCELLED       VALUE 'T'.
  6300         16  AT-CALL-TYPE                PIC X.
  6301             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6302             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6303         16  AT-NOTE-CONTINUATION        PIC X.
  6304             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6305         16  AT-EOB-CODES-EXIST          PIC X.
  6306             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6307         16  FILLER                      PIC X(35).
  6308         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6309         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6310
  6311     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6312         16  AT-PROMPT-LINE-1            PIC X(60).
  6313         16  AT-PROMPT-LINE-2            PIC X(60).
  6314         16  AT-PROMPT-START-DT          PIC XX.
  6315         16  AT-PROMPT-END-DT            PIC XX.
  6316         16  FILLER                      PIC X(35).
  6317         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6318         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6319
  6320     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6321         16  AT-DENIAL-INFO-1            PIC X(60).
  6322         16  AT-DENIAL-INFO-2            PIC X(60).
  6323         16  AT-DENIAL-DT                PIC XX.
  6324         16  AT-RETRACTION-DT            PIC XX.
  6325         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6326*         16  FILLER                      PIC X(31).
  6327         16  AT-DENIAL-PROOF-DT          PIC XX.
  6328         16  FILLER                      PIC X(29).
  6329         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6330         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6331
  6332     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6333         16  AT-OLD-INCURRED-DT          PIC XX.
  6334         16  AT-OLD-REPORTED-DT          PIC XX.
  6335         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6336         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6337         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6338         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6339         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6340         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6341         16  FILLER                      PIC X(26).
  6342         16  AT-OLD-DIAG-CODE            PIC X(6).
  6343         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 120
* EL156.cbl
  6344         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6345         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6346         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6347         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6348         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6349         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6350         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6351         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6352         16  FILLER                      PIC X(9).
  6353         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6354
  6355     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6356         16  AT-FORM-SEND-ON-DT          PIC XX.
  6357         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6358         16  AT-FORM-RE-SEND-DT          PIC XX.
  6359         16  AT-FORM-ANSWERED-DT         PIC XX.
  6360         16  AT-FORM-PRINTED-DT          PIC XX.
  6361         16  AT-FORM-REPRINT-DT          PIC XX.
  6362         16  AT-FORM-TYPE                PIC X.
  6363             88  INITIAL-FORM                  VALUE '1'.
  6364             88  PROGRESS-FORM                 VALUE '2'.
  6365         16  AT-INSTRUCT-LN-1            PIC X(28).
  6366         16  AT-INSTRUCT-LN-2            PIC X(28).
  6367         16  AT-INSTRUCT-LN-3            PIC X(28).
  6368         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6369         16  AT-FORM-ADDRESS             PIC X.
  6370             88  FORM-TO-INSURED              VALUE 'I'.
  6371             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6372             88  FORM-TO-OTHER-1              VALUE 'O'.
  6373             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6374         16  AT-RELATED-1.
  6375             20 AT-REL-CARR-1            PIC X.
  6376             20 AT-REL-CLAIM-1           PIC X(7).
  6377             20 AT-REL-CERT-1            PIC X(11).
  6378         16  AT-RELATED-2.
  6379             20 AT-REL-CARR-2            PIC X.
  6380             20 AT-REL-CLAIM-2           PIC X(7).
  6381             20 AT-REL-CERT-2            PIC X(11).
  6382         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6383         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6384         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6385         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6386         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6387         16  AT-STOP-FORM-DT             PIC X(2).
  6388
  6389         16  FILLER                      PIC X(09).
  6390         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6391         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6392******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 121
* EL156.cbl
  6394*    COPY ELCACTQ.
  6395******************************************************************
  6396*                                                                *
  6397*                            ELCACTQ.                            *
  6398*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6399*                            VMOD=2.004                          *
  6400*                                                                *
  6401*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6402*                                                                *
  6403*   FILE TYPE = VSAM,KSDS                                        *
  6404*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6405*                                                                *
  6406*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6407*       ALTERNATE INDEX = NONE                                   *
  6408*                                                                *
  6409*   LOG = YES                                                    *
  6410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6411*                                                                *
  6412*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6413******************************************************************
  6414
  6415 01  ACTIVITY-QUE.
  6416     12  AQ-RECORD-ID                PIC XX.
  6417         88  VALID-AQ-ID                VALUE 'AQ'.
  6418
  6419     12  AQ-CONTROL-PRIMARY.
  6420         16  AQ-COMPANY-CD           PIC X.
  6421         16  AQ-CARRIER              PIC X.
  6422         16  AQ-CLAIM-NO             PIC X(7).
  6423         16  AQ-CERT-NO.
  6424             20  AQ-CERT-PRIME       PIC X(10).
  6425             20  AQ-CERT-SFX         PIC X.
  6426
  6427     12  AQ-PENDING-ACTIVITY-FLAGS.
  6428         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6429         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6430             88  PENDING-PAYMENTS       VALUE '1'.
  6431         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6432             88  PENDING-FULL-PRINT     VALUE '1'.
  6433             88  PENDING-PART-PRINT     VALUE '2'.
  6434         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6435             88  PENDING-LETTERS        VALUE '1'.
  6436         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6437             88  PENDING-RESTORE        VALUE 'C'.
  6438             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6439
  6440     12  FILLER                      PIC X(20).
  6441
  6442     12  AQ-RESEND-DATE              PIC XX.
  6443     12  AQ-FOLLOWUP-DATE            PIC XX.
  6444     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6445     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6446     12  AQ-AUTO-LETTER              PIC X(4).
  6447     12  FILLER                      PIC XX.
  6448     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6449*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 122
* EL156.cbl
  6451*    COPY ERCACCT.
  6452******************************************************************
  6453*                                                                *
  6454*                                                                *
  6455*                            ERCACCT                             *
  6456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6457*                            VMOD=2.031                          *
  6458*                                                                *
  6459*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6460*                                                                *
  6461*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6462*   VSAM ACCOUNT MASTER FILES.                                   *
  6463*                                                                *
  6464*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6465*                                                                *
  6466*   FILE TYPE = VSAM,KSDS                                        *
  6467*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6468*                                                                *
  6469*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6470*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6471*                                                                *
  6472*   LOG = NO                                                     *
  6473*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6474*                                                                *
  6475*                                                                *
  6476******************************************************************
  6477*                   C H A N G E   L O G
  6478*
  6479* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6480*-----------------------------------------------------------------
  6481*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6482* EFFECTIVE    NUMBER
  6483*-----------------------------------------------------------------
  6484* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6485* 092705    2005050300006  PEMA  ADD SPP LEASES
  6486* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6487* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6488* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6489* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6490* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6491******************************************************************
  6492
  6493 01  ACCOUNT-MASTER.
  6494     12  AM-RECORD-ID                      PIC XX.
  6495         88  VALID-AM-ID                      VALUE 'AM'.
  6496
  6497     12  AM-CONTROL-PRIMARY.
  6498         16  AM-COMPANY-CD                 PIC X.
  6499         16  AM-MSTR-CNTRL.
  6500             20  AM-CONTROL-A.
  6501                 24  AM-CARRIER            PIC X.
  6502                 24  AM-GROUPING.
  6503                     28 AM-GROUPING-PREFIX PIC XXX.
  6504                     28 AM-GROUPING-PRIME  PIC XXX.
  6505                 24  AM-STATE              PIC XX.
  6506                 24  AM-ACCOUNT.
  6507                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6508                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 123
* EL156.cbl
  6509             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6510                                           PIC X(19).
  6511             20  AM-CNTRL-B.
  6512                 24  AM-EXPIRATION-DT      PIC XX.
  6513                 24  FILLER                PIC X(4).
  6514             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6515                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6516
  6517     12  AM-CONTROL-BY-VAR-GRP.
  6518         16  AM-COMPANY-CD-A1              PIC X.
  6519         16  AM-VG-CARRIER                 PIC X.
  6520         16  AM-VG-GROUPING                PIC X(6).
  6521         16  AM-VG-STATE                   PIC XX.
  6522         16  AM-VG-ACCOUNT                 PIC X(10).
  6523         16  AM-VG-DATE.
  6524             20  AM-VG-EXPIRATION-DT       PIC XX.
  6525             20  FILLER                    PIC X(4).
  6526         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6527                                           PIC 9(11)      COMP-3.
  6528     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6529         16  FILLER                        PIC X(10).
  6530         16  AM-VG-KEY3.
  6531             20  AM-VG3-ACCOUNT            PIC X(10).
  6532             20  AM-VG3-EXP-DT             PIC XX.
  6533         16  FILLER                        PIC X(4).
  6534     12  AM-MAINT-INFORMATION.
  6535         16  AM-LAST-MAINT-DT              PIC XX.
  6536         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6537         16  AM-LAST-MAINT-USER            PIC X(4).
  6538         16  FILLER                        PIC XX.
  6539
  6540     12  AM-EFFECTIVE-DT                   PIC XX.
  6541     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6542
  6543     12  AM-PREV-DATES  COMP-3.
  6544         16  AM-PREV-EXP-DT                PIC 9(11).
  6545         16  AM-PREV-EFF-DT                PIC 9(11).
  6546
  6547     12  AM-REPORT-CODE-1                  PIC X(10).
  6548     12  AM-REPORT-CODE-2                  PIC X(10).
  6549
  6550     12  AM-CITY-CODE                      PIC X(4).
  6551     12  AM-COUNTY-PARISH                  PIC X(6).
  6552
  6553     12  AM-NAME                           PIC X(30).
  6554     12  AM-PERSON                         PIC X(30).
  6555     12  AM-ADDRS                          PIC X(30).
  6556     12  AM-CITY.
  6557         16  AM-ADDR-CITY                  PIC X(28).
  6558         16  AM-ADDR-STATE                 PIC XX.
  6559     12  AM-ZIP.
  6560         16  AM-ZIP-PRIME.
  6561             20  AM-ZIP-PRI-1ST            PIC X.
  6562                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6563             20  FILLER                    PIC X(4).
  6564         16  AM-ZIP-PLUS4                  PIC X(4).
  6565     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6566         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 124
* EL156.cbl
  6567         16  AM-CAN-POSTAL-2               PIC XXX.
  6568         16  FILLER                        PIC XXX.
  6569     12  AM-TEL-NO.
  6570         16  AM-AREA-CODE                  PIC 999.
  6571         16  AM-TEL-PRE                    PIC 999.
  6572         16  AM-TEL-NBR                    PIC 9(4).
  6573     12  AM-TEL-LOC                        PIC X.
  6574         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6575         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6576
  6577     12  AM-COMM-STRUCTURE.
  6578         16  AM-DEFN-1.
  6579             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6580                 24  AM-AGT.
  6581                     28  AM-AGT-PREFIX     PIC X(4).
  6582                     28  AM-AGT-PRIME      PIC X(6).
  6583                 24  AM-COM-TYP            PIC X.
  6584                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6585                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6586                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6587                 24  AM-RECALC-LV-INDIC    PIC X.
  6588                 24  AM-RETRO-LV-INDIC     PIC X.
  6589                 24  AM-GL-CODES           PIC X.
  6590                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6591                 24  FILLER                PIC X(01).
  6592         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6593             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6594                 24  FILLER                PIC X(11).
  6595                 24  AM-L-COMA             PIC XXX.
  6596                 24  AM-J-COMA             PIC XXX.
  6597                 24  AM-A-COMA             PIC XXX.
  6598                 24  FILLER                PIC X(6).
  6599
  6600     12  AM-COMM-CHANGE-STATUS             PIC X.
  6601         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6602
  6603     12  AM-CSR-CODE                       PIC X(4).
  6604
  6605     12  AM-BILLING-STATUS                 PIC X.
  6606         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6607         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6608     12  AM-AUTO-REFUND-SW                 PIC X.
  6609         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6610         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6611     12  AM-GPCD                           PIC 99.
  6612     12  AM-IG                             PIC X.
  6613         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6614         88  AM-HAS-GROUP                     VALUE '2'.
  6615     12  AM-STATUS                         PIC X.
  6616         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6617         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6618         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6619         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6620         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6621         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6622     12  AM-REMIT-TO                       PIC 99.
  6623     12  AM-ID-NO                          PIC X(11).
  6624
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 125
* EL156.cbl
  6625     12  AM-CAL-TABLE                      PIC XX.
  6626     12  AM-LF-DEVIATION                   PIC XXX.
  6627     12  AM-AH-DEVIATION                   PIC XXX.
  6628     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6629     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6630     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6631     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6632     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6633     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6634
  6635     12  AM-USER-FIELDS.
  6636         16  AM-FLD-1                      PIC XX.
  6637         16  AM-FLD-2                      PIC XX.
  6638         16  AM-FLD-3                      PIC XX.
  6639         16  AM-FLD-4                      PIC XX.
  6640         16  AM-FLD-5                      PIC XX.
  6641
  6642     12  AM-1ST-PROD-DATE.
  6643         16  AM-1ST-PROD-YR                PIC XX.
  6644         16  AM-1ST-PROD-MO                PIC XX.
  6645         16  AM-1ST-PROD-DA                PIC XX.
  6646     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6647     12  AM-CERTS-PURGED-DATE.
  6648         16  AM-PUR-YR                     PIC XX.
  6649         16  AM-PUR-MO                     PIC XX.
  6650         16  AM-PUR-DA                     PIC XX.
  6651     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6652     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6653     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6654     12  AM-INACTIVE-DATE.
  6655         16  AM-INA-MO                     PIC 99.
  6656         16  AM-INA-DA                     PIC 99.
  6657         16  AM-INA-YR                     PIC 99.
  6658     12  AM-AR-HI-CERT-DATE                PIC XX.
  6659
  6660     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6661     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6662
  6663     12  AM-OB-PAYMENT-MODE                PIC X.
  6664         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6665         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6666         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6667         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6668
  6669     12  AM-AH-ONLY-INDICATOR              PIC X.
  6670         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6671         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6672
  6673     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6674
  6675     12  AM-OVER-SHORT.
  6676         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6677         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6678
  6679     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6680     12  AM-DCC-CLP-STATE                  PIC XX.
  6681
  6682     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 126
* EL156.cbl
  6683     12  AM-RECALC-REIN                    PIC X.
  6684
  6685     12  AM-REI-TABLE                      PIC XXX.
  6686     12  AM-REI-ET-LF                      PIC X.
  6687     12  AM-REI-ET-AH                      PIC X.
  6688     12  AM-REI-PE-LF                      PIC X.
  6689     12  AM-REI-PE-AH                      PIC X.
  6690     12  AM-REI-PRT-ST                     PIC X.
  6691     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6692     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6693     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6694     12  AM-REI-GROUP-A                    PIC X(6).
  6695     12  AM-REI-MORT                       PIC X(4).
  6696     12  AM-REI-PRT-OW                     PIC X.
  6697     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6698     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6699     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6700     12  AM-REI-GROUP-B                    PIC X(6).
  6701
  6702     12  AM-TRUST-TYPE                     PIC X(2).
  6703
  6704     12  AM-EMPLOYER-STMT-USED             PIC X.
  6705     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6706
  6707     12  AM-STD-AH-TYPE                    PIC XX.
  6708     12  AM-EARN-METHODS.
  6709         16  AM-EARN-METHOD-R              PIC X.
  6710             88 AM-REF-RL-R78                 VALUE 'R'.
  6711             88 AM-REF-RL-PR                  VALUE 'P'.
  6712             88 AM-REF-RL-MEAN                VALUE 'M'.
  6713             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6714         16  AM-EARN-METHOD-L              PIC X.
  6715             88 AM-REF-LL-R78                 VALUE 'R'.
  6716             88 AM-REF-LL-PR                  VALUE 'P'.
  6717             88 AM-REF-LL-MEAN                VALUE 'M'.
  6718             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6719         16  AM-EARN-METHOD-A              PIC X.
  6720             88 AM-REF-AH-R78                 VALUE 'R'.
  6721             88 AM-REF-AH-PR                  VALUE 'P'.
  6722             88 AM-REF-AH-MEAN                VALUE 'M'.
  6723             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6724             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6725             88 AM-REF-AH-NET                 VALUE 'N'.
  6726
  6727     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6728     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6729     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6730
  6731     12  AM-RET-Y-N                        PIC X.
  6732     12  AM-RET-P-E                        PIC X.
  6733     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6734     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6735     12  AM-RET-GRP                        PIC X(6).
  6736     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6737         16  AM-POOL-PRIME                 PIC XXX.
  6738         16  AM-POOL-SUB                   PIC XXX.
  6739     12  AM-RETRO-EARNINGS.
  6740         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 127
* EL156.cbl
  6741         16  AM-RET-EARN-L                 PIC X.
  6742         16  AM-RET-EARN-A                 PIC X.
  6743     12  AM-RET-ST-TAX-USE                 PIC X.
  6744         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6745         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6746     12  AM-RETRO-BEG-EARNINGS.
  6747         16  AM-RET-BEG-EARN-R             PIC X.
  6748         16  AM-RET-BEG-EARN-L             PIC X.
  6749         16  AM-RET-BEG-EARN-A             PIC X.
  6750     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6751     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6752
  6753     12  AM-USER-SELECT-OPTIONS.
  6754         16  AM-USER-SELECT-1              PIC X(10).
  6755         16  AM-USER-SELECT-2              PIC X(10).
  6756         16  AM-USER-SELECT-3              PIC X(10).
  6757         16  AM-USER-SELECT-4              PIC X(10).
  6758         16  AM-USER-SELECT-5              PIC X(10).
  6759
  6760     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6761
  6762     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6763
  6764     12  AM-RPT045A-SWITCH                 PIC X.
  6765         88  RPT045A-OFF                   VALUE 'N'.
  6766
  6767     12  AM-INSURANCE-LIMITS.
  6768         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6769         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6770
  6771     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6772         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6773
  6774     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6775         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6776         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6777
  6778     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6779
  6780     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6781     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6782     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6783     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6784     12  AM-DCC-UEF-STATE                  PIC XX.
  6785     12  FILLER                            PIC XXX.
  6786     12  AM-REPORT-CODE-3                  PIC X(10).
  6787*    12  FILLER                            PIC X(22).
  6788
  6789     12  AM-RESERVE-DATE.
  6790         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6791         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6792         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6793
  6794     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6795     12  AM-NOTIFICATION-TYPES.
  6796         16  AM-NOTIF-OF-LETTERS           PIC X.
  6797         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6798         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 128
* EL156.cbl
  6799         16  AM-NOTIF-OF-STATUS            PIC X.
  6800
  6801     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6802         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6803         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6804         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6805         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6806
  6807     12  AM-BENEFIT-CONTROLS.
  6808         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6809             20  AM-BENEFIT-CODE           PIC XX.
  6810             20  AM-BENEFIT-TYPE           PIC X.
  6811             20  AM-BENEFIT-REVISION       PIC XXX.
  6812             20  AM-BENEFIT-REM-TERM       PIC X.
  6813             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6814             20  FILLER                    PIC XX.
  6815         16  FILLER                        PIC X(80).
  6816
  6817     12  AM-TRANSFER-DATA.
  6818         16  AM-TRANSFERRED-FROM.
  6819             20  AM-TRNFROM-CARRIER        PIC X.
  6820             20  AM-TRNFROM-GROUPING.
  6821                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6822                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6823             20  AM-TRNFROM-STATE          PIC XX.
  6824             20  AM-TRNFROM-ACCOUNT.
  6825                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6826                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6827             20  AM-TRNFROM-DTE            PIC XX.
  6828         16  AM-TRANSFERRED-TO.
  6829             20  AM-TRNTO-CARRIER          PIC X.
  6830             20  AM-TRNTO-GROUPING.
  6831                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6832                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6833             20  AM-TRNTO-STATE            PIC XX.
  6834             20  AM-TRNTO-ACCOUNT.
  6835                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6836                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6837             20  AM-TRNTO-DTE              PIC XX.
  6838         16  FILLER                        PIC X(10).
  6839
  6840     12  AM-SAVED-REMIT-TO                 PIC 99.
  6841
  6842     12  AM-COMM-STRUCTURE-SAVED.
  6843         16  AM-DEFN-1-SAVED.
  6844             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6845                 24  AM-AGT-SV             PIC X(10).
  6846                 24  AM-COM-TYP-SV         PIC X.
  6847                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6848                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6849                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6850                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6851                 24  FILLER                PIC X.
  6852                 24  AM-GL-CODES-SV        PIC X.
  6853                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6854                 24  FILLER                PIC X.
  6855         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6856             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 129
* EL156.cbl
  6857                 24  FILLER                PIC X(11).
  6858                 24  AM-L-COMA-SV          PIC XXX.
  6859                 24  AM-J-COMA-SV          PIC XXX.
  6860                 24  AM-A-COMA-SV          PIC XXX.
  6861                 24  FILLER                PIC X(6).
  6862
  6863     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6864         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6865            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6866            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6867            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6868
  6869     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6870     12  FILLER                            PIC X(120).
  6871
  6872     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6873         16  AM-CONTROL-NAME               PIC X(30).
  6874         16  AM-EXECUTIVE-ONE.
  6875             20  AM-EXEC1-NAME             PIC X(15).
  6876             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6877                                                          COMP-3.
  6878             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6879                                                          COMP-3.
  6880         16  AM-EXECUTIVE-TWO.
  6881             20  AM-EXEC2-NAME             PIC X(15).
  6882             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6883                                                          COMP-3.
  6884             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6885                                                          COMP-3.
  6886
  6887     12  AM-RETRO-ADDITIONAL-DATA.
  6888         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6889         16  AM-RETRO-PREM-P-E             PIC X.
  6890         16  AM-RETRO-CLMS-P-I             PIC X.
  6891         16  AM-RETRO-RET-BRACKET-LF.
  6892             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6893                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6894                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6895             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6896                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6897                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6898             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6899                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6900                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6901         16  AM-RETRO-RET-BRACKET-AH.
  6902             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6903                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6904                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6905                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6906             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6907                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6908                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6909             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6910                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6911                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6912
  6913     12  AM-COMMENTS.
  6914         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 130
* EL156.cbl
  6915
  6916     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6917         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6918         16  AM-FLI-BILLING-CODE           PIC X.
  6919         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6920         16  AM-FLI-UNITED-IDENT           PIC X.
  6921         16  AM-FLI-INTEREST-LOST-DATA.
  6922             20  AM-FLI-BANK-NO            PIC X(5).
  6923             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6924             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6925             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6926         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6927             20  AM-FLI-AGT                PIC X(9).
  6928             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6929             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6930         16  FILLER                        PIC X(102).
  6931
  6932     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6933         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6934             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6935             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6936             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6937             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6938             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6939         16  FILLER                          PIC X(10).
  6940******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 131
* EL156.cbl
  6942*    COPY ELCCHKQ.
  6943******************************************************************
  6944*                                                                *
  6945*                                                                *
  6946*                            ELCCHKQ.                            *
  6947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6948*                            VMOD=2.007                          *
  6949*                                                                *
  6950*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6951*                                                                *
  6952*   FILE TYPE = VSAM,KSDS                                        *
  6953*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6954*                                                                *
  6955*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6956*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6957*                                                                *
  6958*   LOG = YES                                                    *
  6959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6960******************************************************************
  6961 01  CHECK-QUE.
  6962     12  CQ-RECORD-ID                PIC XX.
  6963         88  VALID-CQ-ID         VALUE 'CQ'.
  6964
  6965     12  CQ-CONTROL-PRIMARY.
  6966         16  CQ-COMPANY-CD           PIC X.
  6967         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6968         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6969
  6970     12  CQ-CONTROL-BY-PAYEE.
  6971         16  CQ-CONTROL-BY-NUMBER.
  6972             20  CQ-COMPANY-CD-A1     PIC X.
  6973             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6974         16  CQ-PAYEE-CARRIER        PIC X.
  6975         16  CQ-PAYEE-GROUPING       PIC X(6).
  6976         16  CQ-PAYEE-STATE          PIC XX.
  6977         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6978         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6979
  6980     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6981         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6982         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6983         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6984         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6985         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6986         16  FILLER                  PIC X(3).
  6987
  6988     12  CQ-ENTRY-TYPE               PIC X.
  6989             88  CHECK-ON-QUE           VALUE 'Q'.
  6990             88  ALIGNMENT-CHECK        VALUE 'A'.
  6991             88  SPOILED-CHECK          VALUE 'S'.
  6992             88  PAYMENT-ABORTED        VALUE 'X'.
  6993
  6994     12  CQ-CLAIM-MAST-CNTL.
  6995         16  CQ-CARRIER              PIC X.
  6996         16  CQ-CLAIM-NO             PIC X(7).
  6997         16  CQ-CERT-NO.
  6998             20  CQ-CERT-PRIME       PIC X(10).
  6999             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 132
* EL156.cbl
  7000         16  CQ-CLAIM-TYPE           PIC X.
  7001             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7002             88  CQ-AH-CLAIM            VALUE 'A'.
  7003         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7004             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7005             88  CQ-O-B-COVERAGE        VALUE '2'.
  7006             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7007
  7008     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7009     12  CQ-CHECK-NUMBER             PIC X(7).
  7010     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7011     12  CQ-PAYMENT-TYPE             PIC X.
  7012             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7013             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7014             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7015             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7016             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7017             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7018             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7019             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7020     12  CQ-VOID-INDICATOR           PIC X.
  7021             88  CHECK-IS-STOPPED          VALUE 'S'.
  7022             88  CHECK-IS-VOID             VALUE 'V'.
  7023     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7024     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7025     12  CQ-CHECK-BY-USER            PIC X(4).
  7026     12  CQ-PRE-NUMBERING-SW         PIC X.
  7027       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7028       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7029
  7030     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7031     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7032     12  CQ-LEDGER-FLAG              PIC X(01).
  7033     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7034     12  CQ-LAST-UPDATED-DT          PIC XX.
  7035     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7036     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7037
  7038     12  FILLER                      PIC X(04).
  7039
  7040******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 133
* EL156.cbl
  7042*    COPY ELCBENE.
  7043******************************************************************
  7044*                                                                *
  7045*                            ELCBENE.                            *
  7046*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7047*                            VMOD=2.006                          *
  7048*                                                                *
  7049*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7050*                                                                *
  7051*   FILE TYPE = VSAM,KSDS                                        *
  7052*   RECORD SIZE = 500   RECFORM = FIX                            *
  7053*                                                                *
  7054*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7055*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7056*                                                                *
  7057*   LOG = YES                                                    *
  7058*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7059*                                                                *
  7060*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7061******************************************************************
  7062
  7063 01  BENEFICIARY-MASTER.
  7064     12  BE-RECORD-ID                PIC XX.
  7065         88  VALID-BE-ID                VALUE 'BE'.
  7066
  7067     12  BE-CONTROL-PRIMARY.
  7068         16  BE-COMPANY-CD           PIC X.
  7069         16  BE-RECORD-TYPE          PIC X.
  7070             88  BENEFICIARY-RECORD  VALUE 'B'.
  7071             88  ADJUSTOR-RECORD     VALUE 'A'.
  7072         16  BE-BENEFICIARY          PIC X(10).
  7073     12  BE-CONTROL-BY-NAME.
  7074         16  BE-COMPANY-CD-A1        PIC X.
  7075         16  BE-RECORD-TYPE-A1       PIC X.
  7076         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7077         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7078
  7079     12  BE-LAST-MAINT-DT            PIC XX.
  7080     12  BE-LAST-MAINT-BY            PIC X(4).
  7081     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7082
  7083     12  BE-ADDRESS-DATA.
  7084         16  BE-MAIL-TO-NAME         PIC X(30).
  7085         16  BE-ADDRESS-LINE-1       PIC X(30).
  7086         16  BE-ADDRESS-LINE-2       PIC X(30).
  7087         16  BE-ADDRESS-LINE-3       PIC X(30).
  7088         16  BE-CITY-STATE.
  7089             20  BE-CITY             PIC X(28).
  7090             20  BE-STATE            PIC XX.
  7091         16  BE-ZIP-CODE.
  7092             20  BE-ZIP-PRIME.
  7093                 24  BE-ZIP-1ST      PIC X.
  7094                     88  BE-CANADIAN-POST-CODE
  7095                                         VALUE 'A' THRU 'Z'.
  7096                 24  FILLER          PIC X(4).
  7097             20  BE-ZIP-PLUS4        PIC X(4).
  7098         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7099             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 134
* EL156.cbl
  7100             20  BE-CAN-POSTAL-2     PIC XXX.
  7101             20  FILLER              PIC XXX.
  7102         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7103         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7104
  7105******************************************************************
  7106*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7107*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7108******************************************************************
  7109     12  BE-CARRIER                  PIC X.
  7110
  7111     12  BE-ADDRESS-DATA2.
  7112         16  BE-MAIL-TO-NAME2        PIC X(30).
  7113         16  BE-ADDRESS-LINE-12      PIC X(30).
  7114         16  BE-ADDRESS-LINE-22      PIC X(30).
  7115         16  BE-ADDRESS-LINE-32      PIC X(30).
  7116         16  BE-CITY-STATE2.
  7117             20  BE-CITY2            PIC X(28).
  7118             20  BE-STATE2           PIC XX.
  7119         16  BE-ZIP-CODE2.
  7120             20  BE-ZIP-PRIME2.
  7121                 24  BE-ZIP-1ST2     PIC X.
  7122                     88  BE-CANADIAN-POST-CODE2
  7123                                         VALUE 'A' THRU 'Z'.
  7124                 24  FILLER          PIC X(4).
  7125             20  BE-ZIP-PLUS42       PIC X(4).
  7126         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7127             20  BE-CAN-POSTAL-12    PIC XXX.
  7128             20  BE-CAN-POSTAL-22    PIC XXX.
  7129             20  FILLER              PIC XXX.
  7130         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7131         16  BE-BILLING-STMT-DATA.
  7132             20  BE-BSR              PIC X.
  7133                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7134                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7135             20  BE-BSR-FROM         PIC X(30).
  7136             20  BE-BSR-DEPT         PIC X(30).
  7137             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7138             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7139             20  BE-OUTPUT-TYPE      PIC X.
  7140                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7141                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7142
  7143     12  FILLER                      PIC X(28).
  7144******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 135
* EL156.cbl
  7146*    COPY ELCARCH.
  7147******************************************************************
  7148*                                                                *
  7149*                            ELCARCH.                            *
  7150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7151*                            VMOD=2.007                          *
  7152*                                                                *
  7153*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7154*                                                                *
  7155*   FILE TYPE = VSAM,KSDS                                        *
  7156*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7157*                                                                *
  7158*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7159*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7160*                                                                *
  7161*   LOG = NO                                                     *
  7162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7163*                                                                *
  7164*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7165******************************************************************
  7166 01  LETTER-ARCHIVE.
  7167     12  LA-RECORD-ID                PIC XX.
  7168         88  VALID-LA-ID                VALUE 'LA'.
  7169
  7170     12  LA-CONTROL-PRIMARY.
  7171         16  LA-COMPANY-CD           PIC X.
  7172         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7173         16  LA-RECORD-TYPE          PIC X.
  7174             88  LA-HEADER-DATA         VALUE '1'.
  7175             88  LA-ADDRESS-DATA        VALUE '2'.
  7176             88  LA-TEXT-DATA           VALUE '3'.
  7177             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7178         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7179
  7180     12  LA-CONTROL-BY-TYPE.
  7181         16  LA-COMPANY-CD-A1        PIC X.
  7182         16  LA-RECORD-TYPE-A1       PIC X.
  7183         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7184         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7185
  7186     12  LA-TEXT-RECORD.
  7187         16  LA-SKIP-CONTROL         PIC XX.
  7188             88  NO-LINES-SKIPPED       VALUE SPACES.
  7189             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7190         16  LA-TEXT-LINE            PIC X(70).
  7191
  7192     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7193         16  FILLER                  PIC XX.
  7194         16  LA-ADDRESS-LINE         PIC X(30).
  7195         16  FILLER                  PIC X(40).
  7196
  7197     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7198         16  FILLER                  PIC XX.
  7199         16  LA-CARRIER              PIC X.
  7200         16  LA-CLAIM-NO             PIC X(7).
  7201         16  LA-CERT-NO.
  7202             20  LA-CERT-PRIME       PIC X(10).
  7203             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 136
* EL156.cbl
  7204         16  LA-NO-OF-COPIES         PIC S9.
  7205         16  LA-RESEND-DATE          PIC XX.
  7206         16  LA-PROCESSOR-CD         PIC X(4).
  7207         16  LA-CREATION-DT          PIC XX.
  7208         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7209         16  LA-RESEND-PRINT-DATE    PIC XX.
  7210         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7211         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7212*
  7213* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7214*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7215*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7216*   I        20  LA-DMD-RES-ST           PIC XX.
  7217*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7218*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7219*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7220*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7221*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7222*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7223*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7224*   I        20  LA-DMD-UND-CODE         PIC XX.
  7225*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7226*   V    16  FILLER                  PIC X(15).
  7227* -----
  7228*
  7229* REINSERTED  CSO  MODS
  7230*
  7231         16  FILLER.
  7232             20  FILLER                  PIC X(29).
  7233             20  LA-CSO-LETTER-STATUS    PIC X.
  7234                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7235                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7236                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7237             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7238             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7239*
  7240
  7241     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7242         16  FILLER                  PIC XX.
  7243         16  LA4-CARRIER             PIC X.
  7244         16  LA4-CLAIM-NO            PIC X(7).
  7245         16  LA4-CERT-NO.
  7246             20  LA4-CERT-PRIME      PIC X(10).
  7247             20  LA4-CERT-SFX        PIC X.
  7248         16  LA4-NO-OF-COPIES        PIC S9.
  7249         16  LA4-RESEND-DATE         PIC XX.
  7250         16  LA4-PROCESSOR-CD        PIC X(4).
  7251         16  LA4-CREATION-DT         PIC XX.
  7252         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7253         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7254         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7255         16  LA4-FORM-TYPE           PIC X.
  7256             88  LA4-INITIAL-FORM    VALUE '1'.
  7257             88  LA4-PROGRESS-FORM   VALUE '2'.
  7258         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7259         16  LA4-STATE               PIC X(02).
  7260         16  FILLER                  PIC X(31).
  7261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 137
* EL156.cbl
  7263*    COPY ELCDAR.
  7264******************************************************************
  7265*                                                                *
  7266*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7267*   FILE TYPE = VSAM,KSDS                                        *
  7268*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7269*   BASE CLUSTER = DLYACTV                                       *
  7270*   LOG = YES                                                    *
  7271*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7272*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7273*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7274*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7275*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7276*               BY PROGRAM "LGINFCE".                            *
  7277*                                                                *
  7278******************************************************************
  7279 01  DAILY-ACTIVITY-RECORD.
  7280     05  DA-KEY.
  7281         10  DA-COMP-CD          PIC X.
  7282         10  DA-CARRIER          PIC X.
  7283         10  DA-CLAIM-NO         PIC X(7).
  7284         10  DA-CERT-NO.
  7285             15  DA-CERT-PRIME   PIC X(10).
  7286             15  DA-CERT-SFX     PIC X.
  7287     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7288     05  DA-RECORD-TYPE          PIC X.
  7289     05  FILLER                  PIC X(2).
  7290******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 138
* EL156.cbl
  7292*    COPY ERCCOMP.
  7293******************************************************************
  7294*                                                                *
  7295*                                                                *
  7296*                            ERCCOMP                             *
  7297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7298*                            VMOD=2.019                          *
  7299*                                                                *
  7300*   ONLINE CREDIT SYSTEM                                         *
  7301*                                                                *
  7302*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7303*                                                                *
  7304*   FILE TYPE = VSAM,KSDS                                        *
  7305*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7306*                                                                *
  7307*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7308*       ALTERNATE PATH = NONE                                    *
  7309*                                                                *
  7310*   LOG = NO                                                     *
  7311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7312*                                                                *
  7313******************************************************************
  7314*                   C H A N G E   L O G
  7315*
  7316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7317*-----------------------------------------------------------------
  7318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7319* EFFECTIVE    NUMBER
  7320*-----------------------------------------------------------------
  7321* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7322* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7323* 092205    2005050300006  PEMA  ADD LEASE FEE
  7324* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7325* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7326* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7327* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7328* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7329* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7330******************************************************************
  7331
  7332 01  COMPENSATION-MASTER.
  7333     12  CO-RECORD-ID                          PIC XX.
  7334         88  VALID-CO-ID                          VALUE 'CO'.
  7335
  7336     12  CO-CONTROL-PRIMARY.
  7337         16  CO-COMPANY-CD                     PIC X.
  7338         16  CO-CONTROL.
  7339             20  CO-CTL-1.
  7340                 24  CO-CARR-GROUP.
  7341                     28  CO-CARRIER            PIC X.
  7342                     28  CO-GROUPING.
  7343                         32  CO-GROUP-PREFIX   PIC XXX.
  7344                         32  CO-GROUP-PRIME    PIC XXX.
  7345                 24  CO-RESP-NO.
  7346                     28  CO-RESP-PREFIX        PIC X(4).
  7347                     28  CO-RESP-PRIME         PIC X(6).
  7348             20  CO-CTL-2.
  7349                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 139
* EL156.cbl
  7350                     28  CO-ACCT-PREFIX        PIC X(4).
  7351                     28  CO-ACCT-PRIME         PIC X(6).
  7352         16  CO-TYPE                           PIC X.
  7353             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7354             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7355             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7356
  7357     12  CO-MAINT-INFORMATION.
  7358         16  CO-LAST-MAINT-DT                  PIC XX.
  7359         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7360         16  CO-LAST-MAINT-USER                PIC X(4).
  7361     12  FILLER                                PIC XX.
  7362     12  CO-STMT-TYPE                          PIC XXX.
  7363     12  CO-COMP-TYPE                          PIC X.
  7364         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7365     12  CO-STMT-OWNER                         PIC X(4).
  7366     12  CO-BALANCE-CONTROL                    PIC X.
  7367         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7368         88  CO-NO-BALANCE                        VALUE 'N'.
  7369
  7370     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7371         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7372         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7373         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7374
  7375     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7376         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7377         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7378
  7379     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7380     12  CO-GA-DIRECT-DEP                      PIC X.
  7381     12  CO-FUTURE-SPACE                       PIC X.
  7382         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7383
  7384     12  CO-ACCT-NAME                          PIC X(30).
  7385     12  CO-MAIL-NAME                          PIC X(30).
  7386     12  CO-ADDR-1                             PIC X(30).
  7387     12  CO-ADDR-2                             PIC X(30).
  7388     12  CO-ADDR-3.
  7389         16  CO-ADDR-CITY                      PIC X(27).
  7390         16  CO-ADDR-STATE                     PIC XX.
  7391     12  CO-CSO-1099                           PIC X.
  7392     12  CO-ZIP.
  7393         16  CO-ZIP-PRIME.
  7394             20  CO-ZIP-PRI-1ST                PIC X.
  7395                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7396             20  FILLER                        PIC X(4).
  7397         16  CO-ZIP-PLUS4                      PIC X(4).
  7398     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7399         16  CO-CAN-POSTAL-1                   PIC XXX.
  7400         16  CO-CAN-POSTAL-2                   PIC XXX.
  7401         16  FILLER                            PIC XXX.
  7402     12  CO-SOC-SEC                            PIC X(13).
  7403     12  CO-TELEPHONE.
  7404         16  CO-AREA-CODE                      PIC XXX.
  7405         16  CO-PREFIX                         PIC XXX.
  7406         16  CO-PHONE                          PIC X(4).
  7407
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 140
* EL156.cbl
  7408     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7409
  7410     12  CO-AR-BAL-LEVEL                       PIC X.
  7411         88  CO-AR-REF-LVL                        VALUE '1'.
  7412         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7413         88  CO-AR-BILL-LVL                       VALUE '2'.
  7414         88  CO-AR-AGT-LVL                        VALUE '3'.
  7415         88  CO-AR-FR-LVL                         VALUE '4'.
  7416
  7417     12  CO-AR-NORMAL-PRINT                    PIC X.
  7418         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7419         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7420
  7421     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7422
  7423     12  CO-AR-REPORTING                       PIC X.
  7424         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7425         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7426
  7427     12  CO-AR-PULL-CHECK                      PIC X.
  7428         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7429         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7430
  7431     12  CO-AR-BALANCE-PRINT                   PIC X.
  7432         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7433
  7434     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7435         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7436         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7437         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7438
  7439     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7440
  7441     12  CO-USER-CODE                          PIC X.
  7442     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7443
  7444******************************************************************
  7445*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7446*    THE LAST MONTH END RUN.
  7447******************************************************************
  7448
  7449     12  CO-LAST-ACTIVITY-DATE.
  7450         16  CO-ACT-YEAR                       PIC 99.
  7451         16  CO-ACT-MONTH                      PIC 99.
  7452         16  CO-ACT-DAY                        PIC 99.
  7453
  7454     12  CO-LAST-STMT-DT.
  7455         16  CO-LAST-STMT-YEAR                 PIC 99.
  7456         16  CO-LAST-STMT-MONTH                PIC 99.
  7457         16  CO-LAST-STMT-DAY                  PIC 99.
  7458
  7459     12  CO-MO-END-TOTALS.
  7460         16  CO-MONTHLY-TOTALS.
  7461             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7462             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7463             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7464             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7465             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 141
* EL156.cbl
  7466
  7467         16  CO-AGING-TOTALS.
  7468             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7469             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7470             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7471             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7472
  7473         16  CO-YTD-TOTALS.
  7474             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7475             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7476
  7477         16  CO-OVER-UNDER-TOTALS.
  7478             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7479             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7480
  7481     12  CO-MISCELLANEOUS-TOTALS.
  7482         16  CO-FICA-TOTALS.
  7483             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7484             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7485
  7486         16  CO-CLAIM-TOTALS.
  7487             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7488             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7489
  7490******************************************************************
  7491*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7492*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7493******************************************************************
  7494
  7495     12  CO-CURRENT-TOTALS.
  7496         16  CO-CURRENT-LAST-STMT-DT.
  7497             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7498             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7499             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7500
  7501         16  CO-CURRENT-MONTHLY-TOTALS.
  7502             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7503             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7504             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7505             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7506             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7507
  7508         16  CO-CURRENT-AGING-TOTALS.
  7509             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7510             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7511             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7512             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7513
  7514         16  CO-CURRENT-YTD-TOTALS.
  7515             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7516             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7517
  7518     12  CO-PAID-COMM-TOTALS.
  7519         16  CO-YTD-PAID-COMMS.
  7520             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7521             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7522
  7523     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 142
* EL156.cbl
  7524         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7525         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7526
  7527     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7528         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7529         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7530         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7531         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7532         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7533         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7534         88  CO-FINAL-LETTER                  VALUE 'F'.
  7535         88  CO-RECONCILING                   VALUE 'R'.
  7536         88  CO-PHONE-CALL                    VALUE 'P'.
  7537         88  CO-LEGAL                         VALUE 'L'.
  7538         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7539         88  CO-WRITE-OFF                     VALUE 'W'.
  7540         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7541
  7542     12  CO-CSR-CODE                       PIC X(4).
  7543
  7544     12  CO-GA-STATUS-INFO.
  7545         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7546         16  CO-GA-TERMINATION-DT          PIC XX.
  7547         16  CO-GA-STATUS-CODE             PIC X.
  7548             88  CO-GA-ACTIVE                 VALUE 'A'.
  7549             88  CO-GA-INACTIVE               VALUE 'I'.
  7550             88  CO-GA-PENDING                VALUE 'P'.
  7551         16  CO-GA-COMMENTS.
  7552             20  CO-GA-COMMENT-1           PIC X(40).
  7553             20  CO-GA-COMMENT-2           PIC X(40).
  7554             20  CO-GA-COMMENT-3           PIC X(40).
  7555             20  CO-GA-COMMENT-4           PIC X(40).
  7556
  7557     12  CO-RPTCD2                         PIC X(10).
  7558     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7559         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7560         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7561
  7562     12  CO-TYPE-AGENT                     PIC X(01).
  7563         88  CO-CORPORATION                   VALUE 'C'.
  7564         88  CO-PARTNERSHIP                   VALUE 'P'.
  7565         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7566         88  CO-TRUST                         VALUE 'T'.
  7567         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7568
  7569     12  CO-FAXNO.
  7570         16  CO-FAX-AREA-CODE                  PIC XXX.
  7571         16  CO-FAX-PREFIX                     PIC XXX.
  7572         16  CO-FAX-PHONE                      PIC X(4).
  7573
  7574     12  CO-BANK-INFORMATION.
  7575         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7576         16  CO-BANK-TRANSIT-NON REDEFINES
  7577             CO-BANK-TRANSIT-NO                PIC 9(8).
  7578
  7579         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7580     12  CO-MISC-DEDUCT-INFO REDEFINES
  7581                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 143
* EL156.cbl
  7582         16  CO-MD-GL-ACCT                     PIC X(10).
  7583         16  CO-MD-DIV                         PIC XX.
  7584         16  CO-MD-CENTER                      PIC X(4).
  7585         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7586         16  CO-CREATE-AP-CHECK                PIC X.
  7587         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7588         16  FILLER                            PIC XXX.
  7589     12  CO-ACH-STATUS                         PIC X.
  7590         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7591         88  CO-ACH-PENDING                        VALUE 'P'.
  7592
  7593     12  CO-BILL-SW                            PIC X.
  7594     12  CO-CONTROL-NAME                       PIC X(30).
  7595     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7596     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7597     12  CO-CLP-STATE                          PIC XX.
  7598     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7599     12  CO-SPP-REFUND-EDIT                    PIC X.
  7600
  7601******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 144
* EL156.cbl
  7603*    COPY ERCDMDNT.
  7604******************************************************************
  7605*                                                                *
  7606*                            ERCDMDNT                            *
  7607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7608*                            VMOD=2.005                          *
  7609*                                                                *
  7610*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7611*                                                                *
  7612*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7613*                                                                *
  7614*        FILE TYPE= VSAM,KSDS                                    *
  7615*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7616*                                                                *
  7617*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7618*                                                                *
  7619*        LOG = YES                                               *
  7620*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7621*                                                                *
  7622******************************************************************
  7623
  7624 01  CERTIFICATE-NOTE.
  7625     12  CN-RECORD-ID                     PIC  XX.
  7626         88  VALID-CN-ID                      VALUE 'CN'.
  7627
  7628     12  CN-CONTROL-PRIMARY.
  7629         16  CN-COMPANY-CD                PIC X.
  7630         16  CN-CERT-KEY.
  7631             20  CN-CARRIER               PIC X.
  7632             20  CN-GROUPING.
  7633                 24  CN-GROUPING-PREFIX   PIC XXX.
  7634                 24  CN-GROUPING-PRIME    PIC XXX.
  7635             20  CN-STATE                 PIC XX.
  7636             20  CN-ACCOUNT.
  7637                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7638                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7639             20  CN-CERT-EFF-DT           PIC XX.
  7640             20  CN-CERT-NO.
  7641                 24  CN-CERT-PRIME        PIC X(10).
  7642                 24  CN-CERT-SFX          PIC X.
  7643
  7644     12  CN-BILLING-START-LINE-NO         PIC 99.
  7645     12  CN-BILLING-END-LINE-NO           PIC 99.
  7646
  7647     12  CN-LINES.
  7648         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7649
  7650     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7651         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7652         16  CN-CSI-GENERAL-DATA-AREA.
  7653             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7654
  7655         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7656             CN-CSI-GENERAL-DATA-AREA.
  7657             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7658             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7659             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7660             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 145
* EL156.cbl
  7661             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7662             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7663             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7664             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7665             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7666             20  FILLER                       PIC XX.
  7667             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7668             20  FILLER                       PIC X(38).
  7669
  7670         16  CN-CSI-PRODUCT-DATA-AREA.
  7671             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7672
  7673         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7674             CN-CSI-PRODUCT-DATA-AREA.
  7675             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7676             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7677             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7678             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7679             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7680             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7681             20  FILLER                   PIC XX.
  7682             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7683             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7684             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7685             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7686             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7687             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7688             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7689             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7690             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7691             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7692             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7693             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7694             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7695             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7696             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7697             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7698             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7699             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7700             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7701             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7702             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7703             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7704             20  FILLER                   PIC X(25).
  7705
  7706         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7707             CN-CSI-CREDIT-CARD-DATA.
  7708             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7709             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7710             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7711             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7712             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7713             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7714             20  FILLER                   PIC XX.
  7715             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7716             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7717             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7718             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 146
* EL156.cbl
  7719             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7720             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7721             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7722             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7723             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7724             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7725             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7726             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7727             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7728             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7729             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7730             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7731             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7732             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7733             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7734             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7735             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7736             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7737             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7738             20  FILLER                   PIC X(17).
  7739
  7740         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7741             CN-CSI-FAMILY-LEAVE-DATA.
  7742             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7743             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7744             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7745             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7746             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7747             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7748             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7749             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7750             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7751             20  CN-CSI-SL-INT-ON-PROCEEDS
  7752                                          PIC S9(5)V99  COMP-3.
  7753             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7754             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7755             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7756             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7757             20  CN-CSI-SL-POLICY-BENEFITS
  7758                                          PIC S9(5)V99  COMP-3.
  7759             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7760             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7761             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7762             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7763             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7764             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7765             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7766             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7767             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7768             20  CN-CSI-SL-STATE-NOT      PIC X.
  7769             20  FILLER                   PIC XX.
  7770
  7771         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7772             CN-CSI-SENIOR-LIFE-DATA.
  7773             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7774             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7775             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7776                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 147
* EL156.cbl
  7777             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7778             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7779             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7780             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7781             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7782             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7783             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7784             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7785             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7786             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7787             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7788             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7789             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7790             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7791             20  CN-CSI-PP-REPAIR         PIC X.
  7792             20  CN-CSI-PP-REPLACE        PIC X.
  7793             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7794             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7795             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7796             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7797             20  FILLER                   PIC X(5).
  7798
  7799         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7800             CN-CSI-PURCH-PROP-DATA.
  7801             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7802             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7803             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7804             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7805             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7806             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7807             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7808             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7809             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7810             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7811             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7812             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7813             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7814             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7815             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7816             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7817             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7818             20  CN-CSI-EW-REPLACE        PIC X.
  7819             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7820             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7821             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7822             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7823             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7824             20  FILLER                   PIC X(4).
  7825
  7826     12  CN-LAST-MAINT-DT                 PIC XX.
  7827     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7828     12  CN-LAST-MAINT-USER               PIC X(4).
  7829     12  FILLER                           PIC X(6).
  7830
  7831******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 148
* EL156.cbl
  7833*    COPY ERCCNOT.
  7834******************************************************************
  7835*                                                                *
  7836*                            ERCCNOT                             *
  7837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7838*                            VMOD=2.003                          *
  7839*                                                                *
  7840*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7841*                                                                *
  7842*        FILE TYPE= VSAM,KSDS                                    *
  7843*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7844*                                                                *
  7845*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7846*                                                                *
  7847*        LOG = YES                                               *
  7848*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7849*                                                                *
  7850******************************************************************
  7851*                   C H A N G E   L O G
  7852*
  7853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7854*-----------------------------------------------------------------
  7855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7856* EFFECTIVE    NUMBER
  7857*-----------------------------------------------------------------
  7858* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7859******************************************************************
  7860
  7861 01  CERT-NOTE-FILE.
  7862     12  CZ-RECORD-ID                PIC  XX.
  7863         88  VALID-CZ-ID                  VALUE 'CZ'.
  7864
  7865     12  CZ-CONTROL-PRIMARY.
  7866         16  CZ-COMPANY-CD           PIC X.
  7867         16  CZ-CARRIER              PIC X.
  7868         16  CZ-GROUPING.
  7869             20 CZ-GROUPING-PREFIX   PIC XXX.
  7870             20 CZ-GROUPING-PRIME    PIC XXX.
  7871         16  CZ-STATE                PIC XX.
  7872         16  CZ-ACCOUNT.
  7873             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7874             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7875         16  CZ-CERT-EFF-DT          PIC XX.
  7876         16  CZ-CERT-NO.
  7877             20  CZ-CERT-PRIME       PIC X(10).
  7878             20  CZ-CERT-SFX         PIC X.
  7879         16  CZ-RECORD-TYPE          PIC X.
  7880             88  CERT-NOTE           VALUE '1'.
  7881             88  CLAIM-CERT-NOTE     VALUE '2'.
  7882         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7883
  7884     12  CZ-LAST-MAINT-DT            PIC XX.
  7885     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7886     12  CZ-LAST-MAINT-USER          PIC X(4).
  7887
  7888     12  CZ-NOTE-INFORMATION.
  7889         16  CZ-NOTE                 PIC X(63).
  7890         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 149
* EL156.cbl
  7891******************************************************************
  7892*                            COPY ERCPDEF.
  7893******************************************************************
  7894*                                                                *
  7895*                                                                *
  7896*                            ERCPDEF.                            *
  7897*                                                                *
  7898*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7899*                                                                *
  7900*    FILE TYPE = VSAM,KSDS                                       *
  7901*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7902*                                                                *
  7903*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7904*                                                                *
  7905*    LOG = YES                                                   *
  7906*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7907******************************************************************
  7908*                   C H A N G E   L O G
  7909*
  7910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7911*-----------------------------------------------------------------
  7912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7913* EFFECTIVE    NUMBER
  7914*-----------------------------------------------------------------
  7915* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7916******************************************************************
  7917 01  PRODUCT-MASTER.
  7918    12  PD-RECORD-ID                 PIC X(02).
  7919        88  VALID-PD-ID                  VALUE 'PD'.
  7920    12  PD-CONTROL-PRIMARY.
  7921        16  PD-COMPANY-CD            PIC X.
  7922        16  PD-STATE                 PIC XX.
  7923        16  PD-PRODUCT-CD            PIC XXX.
  7924        16  PD-FILLER                PIC X(7).
  7925        16  PD-BEN-TYPE              PIC X.
  7926        16  PD-BEN-CODE              PIC XX.
  7927        16  PD-PROD-EXP-DT           PIC XX.
  7928    12  FILLER                       PIC X(50).
  7929    12  PD-PRODUCT-DATA OCCURS 8.
  7930        16  PD-PROD-CODE             PIC X.
  7931            88  PD-PROD-LIFE           VALUE 'L'.
  7932            88  PD-PROD-PROP           VALUE 'P'.
  7933            88  PD-PROD-AH             VALUE 'A'.
  7934            88  PD-PROD-IU             VALUE 'I'.
  7935            88  PD-PROD-GAP            VALUE 'G'.
  7936            88  PD-PROD-FMLA           VALUE 'F'.
  7937        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7938        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7939        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7940        16  PD-MAX-TERM              PIC S999        COMP-3.
  7941        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7942        16  FILLER                   PIC X.
  7943        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7944        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7945        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7946        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7947        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7948        16  PD-REC-CRIT-PERIOD       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 150
* EL156.cbl
  7949        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7950            20  PD-RECURRING-YN      PIC X.
  7951            20  FILLER               PIC X.
  7952        16  PD-RTW-MOS               PIC 99.
  7953        16  PD-MAX-EXTENSION         PIC 99.
  7954        16  FILLER                   PIC XX.
  7955    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7956    12  PD-TERM-LIMITS OCCURS 15.
  7957        16  PD-LOW-TERM              PIC S999        COMP-3.
  7958        16  PD-HI-TERM               PIC S999        COMP-3.
  7959*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7960    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7961        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7962        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7963    12  PD-EARN-FACTORS.
  7964        16  FILLER OCCURS 15.
  7965            20  FILLER OCCURS 15.
  7966                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7967    12  PD-PRODUCT-DESC              PIC X(80).
  7968    12  PD-TRUNCATED                 PIC X.
  7969    12  FILLER                       PIC X(59).
  7970    12  PD-MAINT-INFORMATION.
  7971        16  PD-LAST-MAINT-DT         PIC X(02).
  7972        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7973        16  PD-LAST-MAINT-BY         PIC X(04).
  7974*                            COPY ELCCRTT.
  7975******************************************************************
  7976*                                                                *
  7977*                            ELCCRTT.                            *
  7978*                                                                *
  7979*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7980*                                                                *
  7981*   FILE TYPE = VSAM,KSDS                                        *
  7982*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7983*                                                                *
  7984*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7985*                                                                *
  7986*   LOG = YES                                                    *
  7987*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7988******************************************************************
  7989*                   C H A N G E   L O G
  7990*
  7991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7992*-----------------------------------------------------------------
  7993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7994* EFFECTIVE    NUMBER
  7995*-----------------------------------------------------------------
  7996* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7997* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7998* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7999* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8000* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8001* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8002******************************************************************
  8003
  8004 01  CERTIFICATE-TRAILERS.
  8005     12  CS-RECORD-ID                      PIC XX.
  8006         88  VALID-CS-ID                      VALUE 'CS'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 151
* EL156.cbl
  8007
  8008     12  CS-CONTROL-PRIMARY.
  8009         16  CS-COMPANY-CD                 PIC X.
  8010         16  CS-CARRIER                    PIC X.
  8011         16  CS-GROUPING                   PIC X(6).
  8012         16  CS-STATE                      PIC XX.
  8013         16  CS-ACCOUNT                    PIC X(10).
  8014         16  CS-CERT-EFF-DT                PIC XX.
  8015         16  CS-CERT-NO.
  8016             20  CS-CERT-PRIME             PIC X(10).
  8017             20  CS-CERT-SFX               PIC X.
  8018         16  CS-TRAILER-TYPE               PIC X.
  8019             88  COMM-TRLR           VALUE 'A'.
  8020             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8021             88  CERT-DATA-TRLR      VALUE 'C'.
  8022
  8023     12  CS-DATA-AREA                      PIC X(516).
  8024
  8025     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8026         16  CS-BANK-COMMISSION-AREA.
  8027             20  CS-BANK-COMMS       OCCURS 10.
  8028                 24  CS-AGT                PIC X(10).
  8029                 24  CS-COM-TYP            PIC X.
  8030                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8031                 24  CS-RECALC-LV-INDIC    PIC X.
  8032                 24  FILLER                PIC X(10).
  8033         16  FILLER                        PIC X(256).
  8034
  8035     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8036****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8037         16  CS-MB-CLAIM-DATA OCCURS 24.
  8038             20  CS-CLAIM-NO               PIC X(7).
  8039             20  CS-CLAIM-TYPE             PIC X.
  8040                 88  CS-AH-CLM               VALUE 'A'.
  8041                 88  CS-IU-CLM               VALUE 'I'.
  8042                 88  CS-GP-CLM               VALUE 'G'.
  8043                 88  CS-LF-CLM               VALUE 'L'.
  8044                 88  CS-PR-CLM               VALUE 'P'.
  8045             20  CS-INSURED-TYPE           PIC X.
  8046                 88  CS-PRIM-INSURED          VALUE 'P'.
  8047                 88  CS-CO-BORROWER           VALUE 'C'.
  8048             20  CS-BENEFIT-PERIOD         PIC 99.
  8049             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8050             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8051             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8052         16  FILLER                        PIC X(12).
  8053     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8054         16  CS-VIN-NUMBER                 PIC X(17).
  8055         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8056         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8057         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8058         16  FILLER                        PIC X(496).
  8059 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8060                          CONTROL-FILE CERTIFICATE-MASTER
  8061                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8062                          ACCOUNT-MASTER CHECK-QUE
  8063                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8064                          DAILY-ACTIVITY-RECORD
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 152
* EL156.cbl
  8065                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8066                          CERT-NOTE-FILE PRODUCT-MASTER
  8067                          CERTIFICATE-TRAILERS.
  8068 0000-DFHEXIT SECTION.
  8069     MOVE '9#                    $   ' TO DFHEIV0.
  8070     MOVE 'EL156' TO DFHEIV1.
  8071     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8072
  8073     IF EIBCALEN = 0
  8074         GO TO 8800-UNAUTHORIZED-ACCESS.
  8075
  8076     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8077     MOVE EIBTRMID               TO QID-TERM.
  8078     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8079     MOVE '2'                    TO EMI-SWITCH2.
  8080     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8081     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8082
  8083     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8084     MOVE '5'                    TO DC-OPTION-CODE.
  8085     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8086     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8087                                    SAVE-BIN-DATE.
  8088     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8089     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8090
  8091     IF SAVE-DATE-YY > 70
  8092         MOVE 19                 TO SAVE-DATE-CC
  8093     ELSE
  8094         MOVE 20                 TO SAVE-DATE-CC.
  8095
  8096     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8097         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8098     END-IF.
  8099
  8100     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8101        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8102     ELSE
  8103        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8104     END-IF
  8105
  8106     IF PI-PRINT-CLM-FRM-YN = 'N'
  8107         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8108     ELSE
  8109         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8110     END-IF
  8111
  8112     IF PI-PRINT-SURVEY-YN = 'N'
  8113         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8114     ELSE
  8115         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8116     END-IF
  8117
  8118     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8119         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8120     ELSE
  8121         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8122     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 153
* EL156.cbl
  8123
  8124* EXEC CICS HANDLE CONDITION
  8125*        NOTOPEN   (9990-ABEND)
  8126*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8127*        MAPFAIL   (0400-FIRST-TIME)
  8128*        DUPREC    (6180-DUPREC)
  8129*        ERROR     (9990-ABEND)
  8130*    END-EXEC.
  8131*    MOVE '"$JL?%.               ! " #00008119' TO DFHEIV0
  8132     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8134     MOVE X'2220233030303038313139' TO DFHEIV0(25:11)
  8135     CALL 'kxdfhei1' USING DFHEIV0
  8136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8137
  8138
  8139     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8140         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8141
  8142     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8143         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8144             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8145             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8146             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8147             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8148             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8149             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8150             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8151             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8152             MOVE LOW-VALUES           TO EL156AI
  8153             MOVE 'Y'                  TO FIRST-ENTRY
  8154         ELSE
  8155             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8156             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8157             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8158             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8159             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8160             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8161             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8162             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8163
  8164     IF RETURNED-FROM NOT = SPACES
  8165        IF (RETURNED-FROM = 'EL614')
  8166           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8167           IF WS-SAVED-EOB-CODES NOT = SPACES
  8168              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8169           ELSE
  8170              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8171           END-IF
  8172        END-IF
  8173         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8174            MOVE 'Y'             TO FIRST-ENTRY
  8175            IF RETURNED-FROM = 'EL614'
  8176               AND (PI-PASS-SW NOT = 'C')
  8177               IF WS-SAVED-EOB-CODES NOT = SPACES
  8178                  MOVE WS-SAVED-EOB-CODES
  8179                                 TO PI-PMTNOTE2
  8180                                    WS-PMTNOTE2
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 154
* EL156.cbl
  8181                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8182               ELSE
  8183                  MOVE SPACES    TO PI-PMTNOTE2
  8184                                    WS-PMTNOTE2
  8185                                    PI-EOB-CODES-EXIST
  8186               END-IF
  8187            END-IF
  8188            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8189            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8190            IF RETURNED-FROM = 'EL614'
  8191               GO TO 1000-EDIT-DATA
  8192            END-IF
  8193            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8194               (PAYEEI   = LOW-VALUES OR SPACES)
  8195               GO TO 8100-SEND-INITIAL-MAP
  8196            ELSE
  8197               GO TO 1000-EDIT-DATA.
  8198
  8199     IF EIBTRNID NOT = TRANS-ID
  8200         GO TO 0400-FIRST-TIME.
  8201
  8202     IF EIBAID = DFHCLEAR
  8203        IF PI-PASS-SW = 'C'
  8204           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8205           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8206           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8207           MOVE 'Y'            TO RETURNED-FROM-B
  8208           GO TO 1000-EDIT-DATA
  8209        ELSE
  8210           GO TO 9400-CLEAR.
  8211
  8212     IF PI-PASS-SW = 'C'
  8213         MOVE MAP-NAMEB          TO MAP-NAME
  8214         IF EIBAID = DFHPF1 OR DFHPF13
  8215             GO TO 5000-UPDATE
  8216           ELSE
  8217             IF EIBAID NOT = DFHENTER
  8218                 MOVE LOW-VALUES TO EL156BI
  8219                 MOVE MAP-NAMEB  TO MAP-NAME
  8220                 MOVE ER-0029    TO EMI-ERROR
  8221                 MOVE -1         TO  ENTPFBL
  8222                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8223                 GO TO 8200-SEND-DATAONLY.
  8224
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 155
* EL156.cbl
  8226 0200-RECEIVE.
  8227     MOVE LOW-VALUES             TO EL156AI.
  8228     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8229         MOVE ER-0008            TO EMI-ERROR
  8230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231         IF PI-PASS-SW = 'C'
  8232             MOVE -1             TO ENTPFBL
  8233             GO TO 8200-SEND-DATAONLY
  8234         ELSE
  8235             MOVE -1             TO PMTTYPEL
  8236             GO TO 8200-SEND-DATAONLY.
  8237
  8238     IF PI-COMPANY-ID = 'DMD'
  8239         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8240
  8241     IF PI-PASS-SW = 'C'
  8242         MOVE MAP-NAMEB          TO MAP-NAME.
  8243
  8244
  8245* EXEC CICS RECEIVE
  8246*        MAP   (MAP-NAME)
  8247*        MAPSET(MAPSET-NAME)
  8248*        ASIS
  8249*        INTO  (EL156AI)
  8250*    END-EXEC.
  8251     MOVE LENGTH OF
  8252      EL156AI
  8253       TO DFHEIV11
  8254*    MOVE '8"TAI  L              ''   #00008232' TO DFHEIV0
  8255     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8257     MOVE X'2020233030303038323332' TO DFHEIV0(25:11)
  8258     CALL 'kxdfhei1' USING DFHEIV0,
  8259           MAP-NAME,
  8260           EL156AI,
  8261           DFHEIV11,
  8262           MAPSET-NAME,
  8263           DFHEIV99,
  8264           DFHEIV99
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267
  8268     IF PI-PASS-SW NOT = 'C'
  8269         GO TO 0250-MAPA.
  8270
  8271     IF ENTPFBL NOT > ZERO
  8272         MOVE MAP-NAMEB          TO MAP-NAME
  8273         MOVE ER-0029            TO EMI-ERROR
  8274         MOVE -1                 TO  ENTPFBL
  8275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8276         GO TO 8200-SEND-DATAONLY.
  8277
  8278     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8279         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8280       ELSE
  8281         MOVE MAP-NAMEB           TO MAP-NAME
  8282         MOVE ER-0029             TO EMI-ERROR
  8283         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 156
* EL156.cbl
  8284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8285         GO TO 8200-SEND-DATAONLY.
  8286
  8287     IF EIBAID = DFHPF1 OR DFHPF13
  8288         IF MODIFY-CAP
  8289            GO TO 5000-UPDATE
  8290          ELSE
  8291            MOVE 'UPDATE'           TO SM-READ
  8292            PERFORM 9995-SECURITY-VIOLATION
  8293            MOVE MAP-NAMEB          TO MAP-NAME
  8294            MOVE ER-0070            TO EMI-ERROR
  8295            MOVE -1                 TO  ENTPFBL
  8296            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8297            GO TO 8200-SEND-DATAONLY.
  8298
  8299 0250-MAPA.
  8300     IF ENTERPFL = 0
  8301         GO TO 0300-CHECK-PFKEYS.
  8302
  8303     IF EIBAID NOT = DFHENTER
  8304         MOVE ER-0004            TO EMI-ERROR
  8305         GO TO 0320-INPUT-ERROR.
  8306
  8307     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8308         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8309     ELSE
  8310         MOVE ER-0029            TO EMI-ERROR
  8311         GO TO 0320-INPUT-ERROR.
  8312
  8313 0300-CHECK-PFKEYS.
  8314     IF EIBAID = DFHPF7 OR DFHPF8
  8315         GO TO 8820-PF7-8.
  8316
  8317     IF EIBAID = DFHPF23
  8318         GO TO 8810-PF23.
  8319
  8320     IF EIBAID = DFHPF24
  8321         GO TO 9200-RETURN-MAIN-MENU.
  8322
  8323     IF EIBAID = DFHPF12
  8324         GO TO 9500-PF12.
  8325
  8326     IF EIBAID = DFHPF1
  8327        IF PI-PASS-SW = 'A' OR 'B'
  8328          GO TO 0330-BROWSE-FORWARD.
  8329
  8330     IF EIBAID = DFHPF2
  8331        IF PI-PASS-SW = 'A' OR 'B'
  8332          GO TO 0350-BROWSE-BACKWARD.
  8333
  8334     IF EIBAID = DFHPF6
  8335        IF PI-EOB-CODES-EXIST = 'Y'
  8336           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8337        ELSE
  8338           MOVE SPACES              TO WS-PMTNOTE2
  8339        END-IF
  8340         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8341         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 157
* EL156.cbl
  8342            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8343         END-IF
  8344         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8345         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8346             MOVE 'EL614'        TO PGM-NAME
  8347             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8348             GO TO 9300-XCTL
  8349         ELSE
  8350             MOVE XCTL-157       TO PGM-NAME
  8351             GO TO 9300-XCTL.
  8352
  8353     IF EIBAID = DFHPF9
  8354        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8355        MOVE XCTL-141            TO PGM-NAME
  8356        GO TO 9300-XCTL.
  8357
  8358     IF EIBAID = DFHPF10
  8359        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8360        MOVE XCTL-155            TO PGM-NAME
  8361        GO TO 9300-XCTL.
  8362
  8363     MOVE SPACES                 TO ERRMSG0O
  8364                                    ERRMSG1O
  8365                                    ERRMSG2O.
  8366
  8367     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8368         IF PI-PASS-SW NOT = 'B'
  8369             MOVE ER-0422        TO EMI-ERROR
  8370             GO TO 0320-INPUT-ERROR
  8371           ELSE
  8372             GO TO 0700-TEST-FOR-CHANGES.
  8373
  8374     IF EIBAID = DFHPF11
  8375        IF PI-PASS-SW = 'C'
  8376           MOVE ER-0029          TO EMI-ERROR
  8377           GO TO 0320-INPUT-ERROR.
  8378
  8379     IF EIBAID = DFHENTER OR DFHPF11
  8380        NEXT SENTENCE
  8381     ELSE
  8382        MOVE ER-0029             TO EMI-ERROR
  8383        GO TO 0320-INPUT-ERROR.
  8384
  8385     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8386
  8387     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8388         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8389         GO TO 1000-EDIT-DATA
  8390     ELSE
  8391         IF PI-FATAL-COUNT NOT = 0 OR
  8392            PI-FORCE-COUNT NOT = 0
  8393             GO TO 1000-EDIT-DATA
  8394         ELSE
  8395             GO TO 2000-EDIT-DONE.
  8396
  8397 0320-INPUT-ERROR.
  8398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8399
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 158
* EL156.cbl
  8400     IF ENTERPFL = 0
  8401         MOVE -1                 TO PMTTYPEL
  8402     ELSE
  8403         MOVE AL-UNBON           TO ENTERPFA
  8404         MOVE -1                 TO ENTERPFL.
  8405
  8406     GO TO 8200-SEND-DATAONLY.
  8407
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 159
* EL156.cbl
  8409 0330-BROWSE-FORWARD.
  8410
  8411     MOVE CLMNOI            TO PI-CLAIM-NO.
  8412     MOVE CARRI             TO PI-CARRIER.
  8413     MOVE CERTNOI           TO PI-CERT-PRIME.
  8414     MOVE SUFXI             TO PI-CERT-SFX.
  8415
  8416     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8417     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8418     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8419     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8420
  8421     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8422
  8423
  8424* EXEC CICS HANDLE CONDITION
  8425*         NOTFND   (0380-CLAIM-END-FILE)
  8426*         ENDFILE  (0380-CLAIM-END-FILE)
  8427*    END-EXEC.
  8428*    MOVE '"$I''                  ! # #00008394' TO DFHEIV0
  8429     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8431     MOVE X'2320233030303038333934' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0
  8433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8434
  8435
  8436
  8437* EXEC CICS STARTBR
  8438*         DATASET    ('ELMSTR')
  8439*         RIDFLD     (ELMSTR-KEY)
  8440*         GTEQ
  8441*    END-EXEC.
  8442     MOVE 'ELMSTR' TO DFHEIV1
  8443     MOVE 0
  8444       TO DFHEIV11
  8445*    MOVE '&,         G          &   #00008399' TO DFHEIV0
  8446     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8448     MOVE X'2020233030303038333939' TO DFHEIV0(25:11)
  8449     CALL 'kxdfhei1' USING DFHEIV0,
  8450           DFHEIV1,
  8451           ELMSTR-KEY,
  8452           DFHEIV99,
  8453           DFHEIV11,
  8454           DFHEIV99
  8455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8456
  8457
  8458     MOVE 'Y' TO WS-BROWSE-START-SW.
  8459
  8460 0335-READNEXT.
  8461
  8462
  8463* EXEC CICS READNEXT
  8464*         DATASET    ('ELMSTR')
  8465*         RIDFLD     (ELMSTR-KEY)
  8466*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 160
* EL156.cbl
  8467*    END-EXEC.
  8468     MOVE 'ELMSTR' TO DFHEIV1
  8469     MOVE 0
  8470       TO DFHEIV11
  8471*    MOVE '&.S                   )   #00008409' TO DFHEIV0
  8472     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8474     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0,
  8476           DFHEIV1,
  8477           DFHEIV20,
  8478           DFHEIV99,
  8479           ELMSTR-KEY,
  8480           DFHEIV99,
  8481           DFHEIV11,
  8482           DFHEIV99,
  8483           DFHEIV99
  8484     SET ADDRESS OF CLAIM-MASTER TO
  8485         DFHEIV20
  8486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8487
  8488
  8489     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8490        GO TO 0380-CLAIM-END-FILE.
  8491
  8492     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8493        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8494        GO TO 0335-READNEXT.
  8495
  8496     IF PI-COMPANY-ID = 'CRI'
  8497         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8498            GO TO 0380-CLAIM-END-FILE.
  8499
  8500     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8501         GO TO 0335-READNEXT.
  8502
  8503     IF PI-CARRIER-SECURITY > SPACES
  8504         IF CL-CARRIER = PI-CARRIER-SECURITY
  8505             NEXT SENTENCE
  8506         ELSE
  8507             GO TO 0335-READNEXT.
  8508
  8509     IF PI-ACCOUNT-SECURITY > SPACES
  8510         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8511             NEXT SENTENCE
  8512         ELSE
  8513             GO TO 0335-READNEXT.
  8514
  8515     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8516     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8517     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8518
  8519     GO TO 0400-FIRST-TIME.
  8520
  8521 0350-BROWSE-BACKWARD.
  8522
  8523     MOVE CLMNOI            TO PI-CLAIM-NO
  8524                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 161
* EL156.cbl
  8525     MOVE CARRI             TO PI-CARRIER.
  8526     MOVE CERTNOI           TO PI-CERT-PRIME.
  8527     MOVE SUFXI             TO PI-CERT-SFX.
  8528
  8529     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8530
  8531     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8532     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8533     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8534
  8535
  8536* EXEC CICS HANDLE CONDITION
  8537*         NOTFND   (0380-CLAIM-END-FILE)
  8538*         ENDFILE  (0380-CLAIM-END-FILE)
  8539*    END-EXEC.
  8540*    MOVE '"$I''                  ! $ #00008461' TO DFHEIV0
  8541     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8543     MOVE X'2420233030303038343631' TO DFHEIV0(25:11)
  8544     CALL 'kxdfhei1' USING DFHEIV0
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548
  8549* EXEC CICS STARTBR
  8550*         DATASET    ('ELMSTR')
  8551*         RIDFLD     (ELMSTR-KEY)
  8552*         GTEQ
  8553*    END-EXEC.
  8554     MOVE 'ELMSTR' TO DFHEIV1
  8555     MOVE 0
  8556       TO DFHEIV11
  8557*    MOVE '&,         G          &   #00008466' TO DFHEIV0
  8558     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8560     MOVE X'2020233030303038343636' TO DFHEIV0(25:11)
  8561     CALL 'kxdfhei1' USING DFHEIV0,
  8562           DFHEIV1,
  8563           ELMSTR-KEY,
  8564           DFHEIV99,
  8565           DFHEIV11,
  8566           DFHEIV99
  8567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8568
  8569
  8570     MOVE 'Y' TO WS-BROWSE-START-SW.
  8571
  8572
  8573* EXEC CICS READNEXT
  8574*         DATASET    ('ELMSTR')
  8575*         RIDFLD     (ELMSTR-KEY)
  8576*         SET        (ADDRESS OF CLAIM-MASTER)
  8577*    END-EXEC.
  8578     MOVE 'ELMSTR' TO DFHEIV1
  8579     MOVE 0
  8580       TO DFHEIV11
  8581*    MOVE '&.S                   )   #00008474' TO DFHEIV0
  8582     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 162
* EL156.cbl
  8583     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8584     MOVE X'2020233030303038343734' TO DFHEIV0(25:11)
  8585     CALL 'kxdfhei1' USING DFHEIV0,
  8586           DFHEIV1,
  8587           DFHEIV20,
  8588           DFHEIV99,
  8589           ELMSTR-KEY,
  8590           DFHEIV99,
  8591           DFHEIV11,
  8592           DFHEIV99,
  8593           DFHEIV99
  8594     SET ADDRESS OF CLAIM-MASTER TO
  8595         DFHEIV20
  8596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8597
  8598
  8599
  8600* EXEC CICS READPREV
  8601*         DATASET    ('ELMSTR')
  8602*         RIDFLD     (ELMSTR-KEY)
  8603*         SET        (ADDRESS OF CLAIM-MASTER)
  8604*    END-EXEC.
  8605     MOVE 'ELMSTR' TO DFHEIV1
  8606     MOVE 0
  8607       TO DFHEIV11
  8608*    MOVE '&0S                   )   #00008480' TO DFHEIV0
  8609     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8610     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8611     MOVE X'2020233030303038343830' TO DFHEIV0(25:11)
  8612     CALL 'kxdfhei1' USING DFHEIV0,
  8613           DFHEIV1,
  8614           DFHEIV20,
  8615           DFHEIV99,
  8616           ELMSTR-KEY,
  8617           DFHEIV99,
  8618           DFHEIV11,
  8619           DFHEIV99,
  8620           DFHEIV99
  8621     SET ADDRESS OF CLAIM-MASTER TO
  8622         DFHEIV20
  8623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8624
  8625
  8626 0360-BROWSE-BACKWARD.
  8627
  8628
  8629* EXEC CICS READPREV
  8630*         DATASET    ('ELMSTR')
  8631*         RIDFLD     (ELMSTR-KEY)
  8632*         SET        (ADDRESS OF CLAIM-MASTER)
  8633*    END-EXEC.
  8634     MOVE 'ELMSTR' TO DFHEIV1
  8635     MOVE 0
  8636       TO DFHEIV11
  8637*    MOVE '&0S                   )   #00008488' TO DFHEIV0
  8638     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8639     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8640     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 163
* EL156.cbl
  8641     CALL 'kxdfhei1' USING DFHEIV0,
  8642           DFHEIV1,
  8643           DFHEIV20,
  8644           DFHEIV99,
  8645           ELMSTR-KEY,
  8646           DFHEIV99,
  8647           DFHEIV11,
  8648           DFHEIV99,
  8649           DFHEIV99
  8650     SET ADDRESS OF CLAIM-MASTER TO
  8651         DFHEIV20
  8652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8653
  8654
  8655     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8656        GO TO 0380-CLAIM-END-FILE.
  8657
  8658     IF PI-COMPANY-ID = 'CRI'
  8659         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8660            GO TO 0380-CLAIM-END-FILE.
  8661
  8662     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8663         GO TO 0360-BROWSE-BACKWARD.
  8664
  8665     IF PI-CARRIER-SECURITY > SPACES
  8666         IF CL-CARRIER = PI-CARRIER-SECURITY
  8667             NEXT SENTENCE
  8668         ELSE
  8669             GO TO 0360-BROWSE-BACKWARD.
  8670
  8671     IF PI-ACCOUNT-SECURITY > SPACES
  8672         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8673             NEXT SENTENCE
  8674         ELSE
  8675             GO TO 0360-BROWSE-BACKWARD.
  8676
  8677     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8678     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8679     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8680
  8681     GO TO 0400-FIRST-TIME.
  8682
  8683 0380-CLAIM-END-FILE.
  8684
  8685     MOVE ER-0130     TO EMI-ERROR.
  8686     MOVE -1          TO CLMNOL.
  8687     MOVE AL-UABON    TO CARRA
  8688                         CLMNOA
  8689                         CERTNOA
  8690                         SUFXA.
  8691
  8692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8693
  8694     GO TO 8200-SEND-DATAONLY.
  8695
  8696 0400-FIRST-TIME.
  8697
  8698     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 164
* EL156.cbl
  8699        MOVE 'N'         TO WS-BROWSE-START-SW
  8700
  8701* EXEC CICS ENDBR
  8702*            DATASET    ('ELMSTR')
  8703*       END-EXEC.
  8704     MOVE 'ELMSTR' TO DFHEIV1
  8705     MOVE 0
  8706       TO DFHEIV11
  8707*    MOVE '&2                    $   #00008539' TO DFHEIV0
  8708     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8709     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8710     MOVE X'2020233030303038353339' TO DFHEIV0(25:11)
  8711     CALL 'kxdfhei1' USING DFHEIV0,
  8712           DFHEIV1,
  8713           DFHEIV11,
  8714           DFHEIV99
  8715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8716
  8717
  8718     IF PI-PROCESSOR-ID = 'LGXX'
  8719         NEXT SENTENCE
  8720     ELSE
  8721
  8722* EXEC CICS READQ TS
  8723*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8724*            INTO    (SECURITY-CONTROL)
  8725*            LENGTH  (SC-COMM-LENGTH)
  8726*            ITEM    (SC-ITEM)
  8727*        END-EXEC
  8728*    MOVE '*$II   L              ''   #00008546' TO DFHEIV0
  8729     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8731     MOVE X'2020233030303038353436' TO DFHEIV0(25:11)
  8732     CALL 'kxdfhei1' USING DFHEIV0,
  8733           PI-SECURITY-TEMP-STORE-ID,
  8734           SECURITY-CONTROL,
  8735           SC-COMM-LENGTH,
  8736           SC-ITEM,
  8737           DFHEIV99,
  8738           DFHEIV99
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8740         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8741         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8742
  8743     MOVE LOW-VALUES             TO EL156AI.
  8744     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8745     MOVE 'Y'                    TO FIRST-ENTRY.
  8746     GO TO 7000-SHOW-CLAIM.
  8747
  8748 0500-CREATE-TEMP-STORAGE.
  8749     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8750
  8751
  8752* EXEC CICS WRITEQ TS
  8753*        QUEUE (QID)
  8754*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8755*        LENGTH(PI-COMM-LENGTH)
  8756*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 165
* EL156.cbl
  8757*    MOVE '*"                    ''   #00008563' TO DFHEIV0
  8758     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303038353633' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           QID,
  8763           PROGRAM-INTERFACE-BLOCK,
  8764           PI-COMM-LENGTH,
  8765           DFHEIV99,
  8766           DFHEIV99,
  8767           DFHEIV99
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771
  8772* EXEC CICS WRITEQ TS
  8773*        QUEUE (QID)
  8774*        FROM  (EL156AI)
  8775*        LENGTH(MAP-LENGTH)
  8776*    END-EXEC.
  8777*    MOVE '*"                    ''   #00008569' TO DFHEIV0
  8778     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8780     MOVE X'2020233030303038353639' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0,
  8782           QID,
  8783           EL156AI,
  8784           MAP-LENGTH,
  8785           DFHEIV99,
  8786           DFHEIV99,
  8787           DFHEIV99
  8788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8789
  8790
  8791 0599-EXIT.
  8792      EXIT.
  8793
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 166
* EL156.cbl
  8795 0600-RECOVER-TEMP-STORAGE.
  8796
  8797* EXEC CICS READQ TS
  8798*        QUEUE (QID)
  8799*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8800*        LENGTH(PI-COMM-LENGTH)
  8801*    END-EXEC.
  8802*    MOVE '*$I    L              ''   #00008580' TO DFHEIV0
  8803     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8805     MOVE X'2020233030303038353830' TO DFHEIV0(25:11)
  8806     CALL 'kxdfhei1' USING DFHEIV0,
  8807           QID,
  8808           PROGRAM-INTERFACE-BLOCK,
  8809           PI-COMM-LENGTH,
  8810           DFHEIV99,
  8811           DFHEIV99,
  8812           DFHEIV99
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816
  8817* EXEC CICS READQ TS
  8818*        QUEUE (QID)
  8819*        INTO  (EL156AI)
  8820*        LENGTH(MAP-LENGTH)
  8821*    END-EXEC.
  8822*    MOVE '*$I    L              ''   #00008586' TO DFHEIV0
  8823     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8824     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8825     MOVE X'2020233030303038353836' TO DFHEIV0(25:11)
  8826     CALL 'kxdfhei1' USING DFHEIV0,
  8827           QID,
  8828           EL156AI,
  8829           MAP-LENGTH,
  8830           DFHEIV99,
  8831           DFHEIV99,
  8832           DFHEIV99
  8833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8834
  8835
  8836     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8837
  8838     IF PMTTYPEI NOT = LOW-VALUES
  8839         MOVE AL-UANON           TO PMTTYPEA.
  8840
  8841     IF PAYEEI NOT = LOW-VALUES
  8842         MOVE AL-UANON           TO PAYEEA.
  8843
  8844     IF NOTE1I NOT = LOW-VALUES
  8845         MOVE AL-UANON           TO NOTE1A.
  8846
  8847     IF (RETURNED-FROM = 'EL614')
  8848        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8849     END-IF
  8850*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8851*       AND (PI-EOB-CODES-EXIST = 'Y')
  8852*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 167
* EL156.cbl
  8853*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8854     IF PI-SET-NOTE2-MDT = 'Y'
  8855         MOVE AL-SANON           TO NOTE2A
  8856     END-IF
  8857
  8858     IF OFFLINEI NOT = LOW-VALUES
  8859         MOVE AL-UANON           TO OFFLINEA.
  8860
  8861*    IF GROUPEDI NOT = LOW-VALUES
  8862*        MOVE AL-UANON           TO GROUPEDA.
  8863
  8864*    IF CASHI NOT = LOW-VALUES
  8865*        MOVE AL-UANON           TO CASHA.
  8866
  8867     IF CHECKNOI NOT = LOW-VALUES
  8868         MOVE AL-UANON           TO CHECKNOA.
  8869
  8870     IF HOLDTILI NOT = LOW-VALUES
  8871         MOVE AL-UANON           TO HOLDTILA.
  8872
  8873     IF EPYFROMI NOT = LOW-VALUES
  8874         MOVE AL-UANON           TO EPYFROMA.
  8875
  8876     IF AIGFROMI NOT = LOW-VALUES
  8877         MOVE AL-UANON           TO AIGFROMA.
  8878
  8879     IF EPYTHRUI NOT = LOW-VALUES
  8880         MOVE AL-UANON           TO EPYTHRUA.
  8881
  8882     IF EDAYSI NOT = LOW-VALUES
  8883         MOVE AL-UNNON           TO EDAYSA.
  8884
  8885     IF EPYAMTL NOT = +0
  8886         MOVE AL-UNNON           TO EPYAMTA.
  8887
  8888     IF ERESVL NOT = +0
  8889         MOVE AL-UNNON           TO ERESVA.
  8890
  8891     IF EEXPENSL NOT = +0
  8892         MOVE AL-UNNON           TO EEXPENSA.
  8893
  8894     IF ETYPEI NOT = LOW-VALUES
  8895         MOVE AL-UNNON           TO ETYPEA.
  8896
  8897     IF PROOFDTI NOT = 0
  8898         MOVE AL-UNNON           TO PROOFDTA.
  8899
  8900     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8901        MOVE AL-UANON            TO EOBYNA
  8902     END-IF
  8903     IF CLMFMYNI = 'Y' OR 'N'
  8904        MOVE AL-UANON            TO CLMFMYNA
  8905     END-IF
  8906
  8907     IF SURVYYNI = 'Y' OR 'N'
  8908        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8909           MOVE AL-UANON         TO SURVYYNA
  8910        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 168
* EL156.cbl
  8911     END-IF
  8912
  8913     IF SPRELYNI = 'Y' OR 'N'
  8914        MOVE AL-UANON            TO SPRELYNA
  8915     END-IF
  8916
  8917     .
  8918 0699-EXIT.
  8919      EXIT.
  8920
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 169
* EL156.cbl
  8922 0700-TEST-FOR-CHANGES.
  8923     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8924         MOVE ER-0433            TO EMI-ERROR
  8925         GO TO 0750-FUNCTION-ERROR.
  8926
  8927     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8928
  8929     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8930         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8931         MOVE 'A'                TO PI-PASS-SW
  8932         GO TO 1000-EDIT-DATA.
  8933
  8934     IF PI-FATAL-COUNT NOT = 0
  8935         MOVE ER-0499            TO EMI-ERROR
  8936         GO TO 0750-FUNCTION-ERROR.
  8937
  8938     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8939         MOVE ER-0500            TO EMI-ERROR
  8940         GO TO 0750-FUNCTION-ERROR.
  8941
  8942     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8943        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8944           MOVE ER-0542          TO EMI-ERROR
  8945           MOVE -1               TO EPYAMTL
  8946           GO TO 0750-FUNCTION-ERROR.
  8947
  8948     IF PI-OFFLINE = 'Y'  OR
  8949        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8950        MOVE EIBAID              TO PI-PFKEY-USED
  8951        GO TO 5000-UPDATE.
  8952
  8953     GO TO 6000-BUILD-SCREEN-B.
  8954
  8955 0750-FUNCTION-ERROR.
  8956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8957
  8958     IF ENTERPFL > 0
  8959         MOVE -1                 TO ENTERPFL
  8960         MOVE AL-UNBON           TO ENTERPFA
  8961         GO TO 8200-SEND-DATAONLY
  8962     ELSE
  8963         MOVE -1                 TO ENTERPFL
  8964         MOVE AL-UNNOF           TO ENTERPFA
  8965         GO TO 8200-SEND-DATAONLY.
  8966
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 170
* EL156.cbl
  8968 0800-DELETE-TS.
  8969
  8970* EXEC CICS HANDLE CONDITION
  8971*        QIDERR(0800-EXIT)
  8972*    END-EXEC.
  8973*    MOVE '"$N                   ! % #00008725' TO DFHEIV0
  8974     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8975     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8976     MOVE X'2520233030303038373235' TO DFHEIV0(25:11)
  8977     CALL 'kxdfhei1' USING DFHEIV0
  8978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8979
  8980
  8981
  8982* EXEC CICS DELETEQ TS
  8983*        QUEUE(QID)
  8984*    END-EXEC.
  8985*    MOVE '*&                    #   #00008729' TO DFHEIV0
  8986     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8987     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8988     MOVE X'2020233030303038373239' TO DFHEIV0(25:11)
  8989     CALL 'kxdfhei1' USING DFHEIV0,
  8990           QID,
  8991           DFHEIV99
  8992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8993
  8994
  8995 0800-EXIT.
  8996      EXIT.
  8997 0900-GET-DDF-LIMITS.
  8998
  8999     if cm-clp-state = zeros or spaces or low-values
  9000        move cm-state            to cm-clp-state
  9001     end-if
  9002     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9003     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9004     MOVE cm-clp-state           TO ERPDEF-STATE
  9005     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9006     if (cl-claim-type = 'L' or 'P')
  9007        and (pi-lf-benefit-cd not = '00' and '  ' and 'DD')
  9008        move 'L'                 to erpdef-ben-type
  9009        move pi-lf-benefit-cd    to erpdef-ben-code
  9010     else
  9011        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9012        MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9013     end-if
  9014     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9015
  9016     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9017
  9018
  9019* EXEC CICS STARTBR
  9020*        DATASET  ('ERPDEF')
  9021*        RIDFLD   (ERPDEF-KEY)
  9022*        GTEQ
  9023*        RESP     (WS-RESPONSE)
  9024*    END-EXEC
  9025     MOVE 'ERPDEF' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 171
* EL156.cbl
  9026     MOVE 0
  9027       TO DFHEIV11
  9028*    MOVE '&,         G          &  N#00008756' TO DFHEIV0
  9029     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9031     MOVE X'204E233030303038373536' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           DFHEIV1,
  9034           ERPDEF-KEY,
  9035           DFHEIV99,
  9036           DFHEIV11,
  9037           DFHEIV99
  9038     MOVE EIBRESP  TO WS-RESPONSE
  9039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9040
  9041     IF NOT WS-RESP-NORMAL
  9042        GO TO 0900-EXIT
  9043     END-IF
  9044
  9045     .
  9046 0900-READNEXT.
  9047
  9048
  9049* EXEC CICS READNEXT
  9050*       DATASET  ('ERPDEF')
  9051*       SET      (ADDRESS OF PRODUCT-MASTER)
  9052*       RIDFLD   (ERPDEF-KEY)
  9053*       RESP     (WS-RESPONSE)
  9054*    END-EXEC
  9055     MOVE 'ERPDEF' TO DFHEIV1
  9056     MOVE 0
  9057       TO DFHEIV11
  9058*    MOVE '&.S                   )  N#00008770' TO DFHEIV0
  9059     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9060     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9061     MOVE X'204E233030303038373730' TO DFHEIV0(25:11)
  9062     CALL 'kxdfhei1' USING DFHEIV0,
  9063           DFHEIV1,
  9064           DFHEIV20,
  9065           DFHEIV99,
  9066           ERPDEF-KEY,
  9067           DFHEIV99,
  9068           DFHEIV11,
  9069           DFHEIV99,
  9070           DFHEIV99
  9071     SET ADDRESS OF PRODUCT-MASTER TO
  9072         DFHEIV20
  9073     MOVE EIBRESP  TO WS-RESPONSE
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9075
  9076     IF NOT WS-RESP-NORMAL
  9077        GO TO 0900-ENDBR
  9078     END-IF
  9079
  9080     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9081        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9082           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9083        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 172
* EL156.cbl
  9084           GO TO 0900-READNEXT
  9085        END-IF
  9086     ELSE
  9087        GO TO 0900-ENDBR
  9088     END-IF
  9089
  9090     IF CM-LOAN-TERM = ZEROS
  9091        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9092     END-IF
  9093
  9094     .
  9095 0900-ENDBR.
  9096
  9097
  9098* EXEC CICS ENDBR
  9099*       DATASET  ('ERPDEF')
  9100*    END-EXEC
  9101     MOVE 'ERPDEF' TO DFHEIV1
  9102     MOVE 0
  9103       TO DFHEIV11
  9104*    MOVE '&2                    $   #00008798' TO DFHEIV0
  9105     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9106     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9107     MOVE X'2020233030303038373938' TO DFHEIV0(25:11)
  9108     CALL 'kxdfhei1' USING DFHEIV0,
  9109           DFHEIV1,
  9110           DFHEIV11,
  9111           DFHEIV99
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9113
  9114     .
  9115 0900-EXIT.
  9116     EXIT.
  9117 1000-EDIT-DATA.
  9118
  9119     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9120         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9121         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9122
  9123     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9124
  9125     IF NOT MODIFY-CAP
  9126         MOVE ER-0070            TO EMI-ERROR
  9127         MOVE -1                 TO PMTTYPEL
  9128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9129         GO TO 2000-EDIT-DONE.
  9130
  9131     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9132                         '5' AND '6'
  9133         MOVE ER-0420            TO EMI-ERROR
  9134         MOVE -1                 TO PMTTYPEL
  9135         MOVE AL-UABON           TO PMTTYPEA
  9136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9137     ELSE
  9138         MOVE AL-UANON           TO PMTTYPEA.
  9139
  9140*    IF PI-OFFLINE = 'Y'
  9141*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 173
* EL156.cbl
  9142*          MOVE ER-1880         TO EMI-ERROR
  9143*          MOVE -1              TO GROUPEDL
  9144*          MOVE AL-UABON        TO GROUPEDA
  9145*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9146*
  9147*    IF GROUPEDL > +0
  9148*       IF PI-GROUPED = 'Y' OR 'N'
  9149*          MOVE AL-UANON TO GROUPEDA
  9150*       ELSE
  9151*          MOVE ER-3140            TO EMI-ERROR
  9152*          MOVE -1                 TO GROUPEDL
  9153*          MOVE AL-UABON           TO GROUPEDA
  9154*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155*
  9156*    IF CASHL > +0
  9157*       IF PI-CASH = 'Y' OR 'N'
  9158*          MOVE AL-UANON           TO CASHA
  9159*       ELSE
  9160*          MOVE ER-3141            TO EMI-ERROR
  9161*          MOVE -1                 TO CASHL
  9162*          MOVE AL-UABON           TO CASHA
  9163*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164
  9165     IF LOANNOL > +0
  9166         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9167
  9168 1000-EDIT-PAYEE.
  9169
  9170     IF PI-PAYEE-SEQ NOT NUMERIC
  9171         MOVE ER-0294            TO  EMI-ERROR
  9172         MOVE -1                 TO  PAYEEL
  9173         MOVE AL-UABON           TO  PAYEEA
  9174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9175         GO TO 1000-CONT-EDIT.
  9176
  9177     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9178                         'E' OR 'O' OR 'Q'
  9179         NEXT SENTENCE
  9180     ELSE
  9181         MOVE ER-0294            TO  EMI-ERROR
  9182         MOVE -1                 TO  PAYEEL
  9183         MOVE AL-UABON           TO  PAYEEA
  9184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9185         GO TO 1000-CONT-EDIT.
  9186
  9187     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9188        (PI-PAYEE-SEQ NOT < '1' AND
  9189         PI-PAYEE-SEQ NOT > '9'))
  9190      OR
  9191        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9192         (PI-PAYEE-SEQ NOT > '9'))
  9193         MOVE AL-UANON            TO PAYEEA
  9194     ELSE
  9195         MOVE ER-0294            TO EMI-ERROR
  9196         MOVE -1                 TO PAYEEL
  9197         MOVE AL-UABON           TO PAYEEA
  9198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9199
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 174
* EL156.cbl
  9200     IF PI-COMPANY-ID = 'DMD'
  9201         IF PI-PAYEE-TYPE = 'B' AND
  9202            PI-PAYEE-SEQ NOT = '0'
  9203               MOVE ER-7841            TO EMI-ERROR
  9204               MOVE -1                 TO PAYEEL
  9205               MOVE AL-UABON           TO PAYEEA
  9206               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9207
  9208     IF PI-COMPANY-ID = 'JHL'
  9209         IF PI-PAYEE = 'B0'
  9210             NEXT SENTENCE
  9211           ELSE
  9212
  9213* EXEC CICS HANDLE CONDITION
  9214*            ENDFILE(1950-NOT-FOUND)
  9215*            NOTFND (1950-NOT-FOUND)
  9216*        END-EXEC
  9217*    MOVE '"$''I                  ! & #00008900' TO DFHEIV0
  9218     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9220     MOVE X'2620233030303038393030' TO DFHEIV0(25:11)
  9221     CALL 'kxdfhei1' USING DFHEIV0
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9223         MOVE 'N'                    TO FOUND-TOL-SW
  9224         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9225         MOVE '2'                    TO CNTL-REC-TYPE
  9226         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9227         MOVE +0                     TO CNTL-SEQ-NO
  9228         MOVE 'PROC'                 TO FILE-SWITCH
  9229         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9230         IF PI-PAYEE = 'I1' AND
  9231            APPROVAL-LEVEL-2
  9232             NEXT SENTENCE
  9233           ELSE
  9234         IF NOT PI-USER-ALMIGHTY-YES
  9235             MOVE ER-3546        TO EMI-ERROR
  9236             MOVE -1             TO PAYEEL
  9237             MOVE AL-UABON       TO PAYEEA
  9238             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9239
  9240     IF PI-PAYEE-TYPE = 'E'
  9241        IF PI-PMTTYPE = '5' OR '6'
  9242            NEXT SENTENCE
  9243        ELSE
  9244            MOVE ER-3539            TO EMI-ERROR
  9245            MOVE -1                 TO PAYEEL
  9246            MOVE AL-UABON           TO PAYEEA
  9247            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9248
  9249 1000-CONT-EDIT.
  9250
  9251     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9252        IF PI-EPYAMT NOT NEGATIVE
  9253            MOVE ER-0421         TO EMI-ERROR
  9254            MOVE -1              TO OFFLINEL
  9255            MOVE AL-UABON        TO OFFLINEA
  9256            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9257        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 175
* EL156.cbl
  9258            MOVE AL-UANON        TO OFFLINEA.
  9259
  9260     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9261        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9262           CONTINUE
  9263        ELSE
  9264           IF PI-PRINT-EOB-YN = 'S' AND
  9265              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9266                CONTINUE
  9267           ELSE
  9268              MOVE ER-1561       TO EMI-ERROR
  9269              MOVE -1            TO EOBYNL
  9270              MOVE AL-UABON      TO EOBYNA
  9271              PERFORM 9900-ERROR-FORMAT
  9272                                 THRU 9900-EXIT
  9273           END-IF
  9274        END-IF
  9275
  9276        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9277            MOVE ER-1566        TO EMI-ERROR
  9278            MOVE -1             TO CLMFMYNL
  9279            MOVE AL-UABON       TO CLMFMYNA
  9280            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281        END-IF
  9282
  9283        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9284            MOVE ER-1567        TO EMI-ERROR
  9285            MOVE -1             TO SURVYYNL
  9286            MOVE AL-UABON       TO SURVYYNA
  9287            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9288        END-IF
  9289
  9290        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9291            MOVE ER-1569        TO EMI-ERROR
  9292            MOVE -1             TO SPRELYNL
  9293            MOVE AL-UABON       TO SPRELYNA
  9294            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9295        END-IF
  9296
  9297     END-IF
  9298     IF PI-EPYAMT IS NEGATIVE
  9299         IF PI-OFFLINE NOT = 'Y'
  9300             MOVE ER-0836        TO  EMI-ERROR
  9301             MOVE -1             TO  OFFLINEL
  9302             MOVE AL-UABON       TO  OFFLINEA
  9303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9304
  9305     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9306        MOVE ER-0872             TO EMI-ERROR
  9307        MOVE -1                  TO PROOFDTL
  9308        MOVE AL-UABON            TO PROOFDTA
  9309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9310     ELSE
  9311        MOVE '4'                TO DC-OPTION-CODE
  9312        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9313        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9314        IF DATE-CONVERSION-ERROR
  9315            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 176
* EL156.cbl
  9316            MOVE -1                  TO PROOFDTL
  9317            MOVE AL-UABON            TO PROOFDTA
  9318            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9319        ELSE
  9320            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9321            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9322                MOVE ER-0873    TO EMI-ERROR
  9323                MOVE -1                  TO PROOFDTL
  9324                MOVE AL-UABON            TO PROOFDTA
  9325                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9326            END-IF
  9327        END-IF
  9328     END-IF.
  9329
  9330     IF PI-COMPANY-ID = 'DMD'
  9331        IF NOTE1L NOT = ZEROS
  9332            MOVE ER-7844        TO  EMI-ERROR
  9333            MOVE -1             TO  NOTE1L
  9334            MOVE AL-UABON       TO  NOTE1A
  9335            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9336
  9337     IF PI-COMPANY-ID = 'DMD'
  9338        IF NOTE2L NOT = ZEROS
  9339          GO TO 1004-DMD-EOB-CHECKS.
  9340
  9341     IF NOTE1L NOT > +0
  9342         GO TO 1005-CHECK-ERRORS.
  9343
  9344     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9345         GO TO 1005-CHECK-ERRORS.
  9346
  9347     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9348         GO TO 1003-HAN-PMT-NOTES.
  9349
  9350     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9351
  9352     IF WS-PMTOPTION NUMERIC
  9353        IF WS-PMTOPTION > '00' AND < '17'
  9354           NEXT SENTENCE
  9355        ELSE
  9356           MOVE ER-0618          TO EMI-ERROR
  9357           MOVE -1               TO NOTE1L
  9358           MOVE AL-UABON         TO NOTE1A
  9359           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360     ELSE
  9361        GO TO 1005-CHECK-ERRORS.
  9362
  9363     IF WS-PMTOPTION = '05' AND
  9364        WS-DOCNAME = SPACES
  9365          MOVE ER-0616             TO EMI-ERROR
  9366          MOVE -1                  TO NOTE1L
  9367          MOVE AL-UABON            TO NOTE1A
  9368          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9369
  9370     IF WS-PMTOPTION = '15' OR '16'
  9371
  9372* EXEC CICS BIF DEEDIT
  9373*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 177
* EL156.cbl
  9374*            LENGTH(08)
  9375*        END-EXEC
  9376     MOVE 08
  9377       TO DFHEIV11
  9378*    MOVE '@"L                   #   #00009052' TO DFHEIV0
  9379     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9380     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9381     MOVE X'2020233030303039303532' TO DFHEIV0(25:11)
  9382     CALL 'kxdfhei1' USING DFHEIV0,
  9383           WS-AMOUNT,
  9384           DFHEIV11
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9386        IF (WS-NUM-AMT = ZEROS) OR
  9387           (WS-AMOUNT NOT NUMERIC)
  9388           MOVE ER-0617          TO EMI-ERROR
  9389           MOVE -1               TO NOTE1L
  9390           MOVE AL-UABON         TO NOTE1A
  9391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9392
  9393     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9394
  9395     GO TO 1005-CHECK-ERRORS.
  9396
  9397 1003-HAN-PMT-NOTES.
  9398
  9399     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9400
  9401     IF WS-HAN-PMT-CODE = SPACE
  9402         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9403     ELSE
  9404     IF WS-HAN-PMT-CODE = 'A'
  9405         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9406                                 TO WS-HAN-PMT-NOTE
  9407     ELSE
  9408     IF WS-HAN-PMT-CODE = 'B'
  9409         MOVE ':FINAL PAYMENT / DECEASED'
  9410                                 TO WS-HAN-PMT-NOTE
  9411     ELSE
  9412     IF WS-HAN-PMT-CODE = 'C'
  9413         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9414                                 TO WS-HAN-PMT-NOTE
  9415     ELSE
  9416     IF WS-HAN-PMT-CODE = 'D'
  9417         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9418                                 TO WS-HAN-PMT-NOTE
  9419     ELSE
  9420     IF WS-HAN-PMT-CODE = 'E'
  9421         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9422                                 TO WS-HAN-PMT-NOTE
  9423     ELSE
  9424     IF WS-HAN-PMT-CODE = 'F'
  9425         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9426                                 TO WS-HAN-PMT-NOTE
  9427     ELSE
  9428     IF WS-HAN-PMT-CODE = 'P'
  9429         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9430
  9431     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 178
* EL156.cbl
  9432     GO TO 1005-CHECK-ERRORS.
  9433
  9434 1004-DMD-EOB-CHECKS.
  9435
  9436     INITIALIZE PI-AT-EOB-CODES.
  9437
  9438     IF NOTE2I (20:21) > SPACES
  9439         MOVE ER-7845          TO EMI-ERROR
  9440         MOVE -1               TO NOTE2L
  9441         MOVE AL-UABON         TO NOTE2A
  9442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9443         GO TO 1005-CHECK-ERRORS
  9444      ELSE
  9445         MOVE NOTE2I             TO W-EOB-CODES.
  9446
  9447     MOVE +1                     TO W-EOB-NDX.
  9448
  9449 1004-CHECK-EACH-EOB.
  9450
  9451     IF W-EOB-NDX > +5
  9452             OR
  9453        W-EOB-CODE (W-EOB-NDX) = SPACES
  9454         GO TO 1004-CHECK-DUP-EOB.
  9455
  9456     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9457         MOVE ER-0956            TO EMI-ERROR
  9458         MOVE -1                 TO NOTE2L
  9459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9460         GO TO 1005-CHECK-ERRORS.
  9461
  9462     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9463     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9464     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9465     MOVE 'DLO023'               TO PGM-NAME.
  9466
  9467
  9468* EXEC CICS LINK
  9469*        PROGRAM    (PGM-NAME)
  9470*        COMMAREA   (CD-COMMUNICATION-AREA)
  9471*        LENGTH     (CD-RCRD-LENGTH)
  9472*    END-EXEC.
  9473*    MOVE '."C                   (   #00009137' TO DFHEIV0
  9474     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9476     MOVE X'2020233030303039313337' TO DFHEIV0(25:11)
  9477     CALL 'kxdfhei1' USING DFHEIV0,
  9478           PGM-NAME,
  9479           CD-COMMUNICATION-AREA,
  9480           CD-RCRD-LENGTH,
  9481           DFHEIV99,
  9482           DFHEIV99,
  9483           DFHEIV99,
  9484           DFHEIV99
  9485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9486
  9487
  9488     IF CD-RETURN-CODE = 'OK'
  9489         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 179
* EL156.cbl
  9490
  9491     MOVE -1                     TO NOTE2L.
  9492
  9493     IF CD-RETURN-CODE = '01'
  9494         MOVE ER-8310            TO EMI-ERROR
  9495         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9496         GO TO 1005-CHECK-ERRORS.
  9497
  9498     IF CD-RETURN-CODE = '02'
  9499         MOVE ER-8311            TO EMI-ERROR
  9500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9501         GO TO 1005-CHECK-ERRORS.
  9502
  9503     IF CD-RETURN-CODE = '03'
  9504         MOVE ER-8312            TO EMI-ERROR
  9505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9506         GO TO 1005-CHECK-ERRORS.
  9507
  9508     IF CD-RETURN-CODE = '04'
  9509         MOVE ER-8313            TO EMI-ERROR
  9510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9511         GO TO 1005-CHECK-ERRORS.
  9512
  9513     IF CD-RETURN-CODE = '05'
  9514         MOVE ER-8314            TO EMI-ERROR
  9515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9516         GO TO 1005-CHECK-ERRORS.
  9517
  9518     IF CD-RETURN-CODE = '06'
  9519         MOVE ER-8315            TO EMI-ERROR
  9520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9521         GO TO 1005-CHECK-ERRORS.
  9522
  9523     IF CD-RETURN-CODE = 'E1'
  9524         MOVE ER-8316            TO EMI-ERROR
  9525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9526         GO TO 1005-CHECK-ERRORS.
  9527
  9528     IF CD-RETURN-CODE = 'N1'
  9529         MOVE ER-8317            TO EMI-ERROR
  9530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9531         GO TO 1005-CHECK-ERRORS.
  9532
  9533 1004-CONT.
  9534     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9535
  9536     ADD +1 TO W-EOB-NDX.
  9537     GO TO 1004-CHECK-EACH-EOB.
  9538
  9539 1004-CHECK-DUP-EOB.
  9540     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9541         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9542                               PI-AT-EOB-CODE (3) OR
  9543                               PI-AT-EOB-CODE (4) OR
  9544                               PI-AT-EOB-CODE (5)))
  9545                  OR
  9546        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9547         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 180
* EL156.cbl
  9548                               PI-AT-EOB-CODE (4) OR
  9549                               PI-AT-EOB-CODE (5)))
  9550                  OR
  9551        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9552         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9553                               PI-AT-EOB-CODE (5)))
  9554                  OR
  9555        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9556         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9557            MOVE ER-8000            TO EMI-ERROR
  9558            MOVE AL-UABON           TO NOTE2A
  9559            MOVE -1                 TO NOTE2L
  9560            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9561            GO TO 1005-CHECK-ERRORS.
  9562
  9563 1005-CHECK-ERRORS.
  9564*    IF PI-COMPANY-ID NOT = 'DMD'
  9565        GO TO 1006-CHECK-ERRORS.
  9566
  9567*********  DMD CODE START ******************
  9568*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9569*       GO TO 1006-CHECK-ERRORS.
  9570*
  9571*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9572*
  9573*    COMPUTE W-PAYMENT-TOTAL
  9574*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9575*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9576*               AND
  9577*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9578*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9579*          MOVE ER-0967    TO EMI-ERROR
  9580*          MOVE -1         TO PMTTYPEL
  9581*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9582*
  9583*    GO TO 1006-CHECK-ERRORS.
  9584*********  DMD CODE END ******************
  9585
  9586 1006-CHECK-ERRORS.
  9587     IF NOT EMI-NO-ERRORS
  9588        GO TO 2000-EDIT-DONE.
  9589
  9590
  9591* EXEC CICS HANDLE CONDITION
  9592*        NOTFND(1950-NOT-FOUND)
  9593*    END-EXEC.
  9594*    MOVE '"$I                   ! '' #00009245' TO DFHEIV0
  9595     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9597     MOVE X'2720233030303039323435' TO DFHEIV0(25:11)
  9598     CALL 'kxdfhei1' USING DFHEIV0
  9599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9600
  9601
  9602     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9603     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9604     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9605     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 181
* EL156.cbl
  9606     MOVE 'MSTR'                 TO FILE-SWITCH.
  9607
  9608     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9609
  9610     IF PI-COMPANY-ID = 'DMD'
  9611         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9612
  9613     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9614        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9615           MOVE ER-0873    TO EMI-ERROR
  9616           MOVE -1                  TO PROOFDTL
  9617           MOVE AL-UABON            TO PROOFDTA
  9618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9619        END-IF
  9620     END-IF
  9621     if cl-benefit-period = zeros
  9622        move er-1667             to emi-error
  9623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9624     end-if
  9625     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9626     MOVE +95                    TO TRLR-SEQ-NO
  9627
  9628* EXEC CICS READ
  9629*       DATASET  ('ELTRLR')
  9630*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9631*       RIDFLD   (ELTRLR-KEY)
  9632*       RESP     (WS-RESPONSE)
  9633*    END-EXEC
  9634     MOVE 'ELTRLR' TO DFHEIV1
  9635*    MOVE '&"S        E          (  N#00009274' TO DFHEIV0
  9636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9638     MOVE X'204E233030303039323734' TO DFHEIV0(25:11)
  9639     CALL 'kxdfhei1' USING DFHEIV0,
  9640           DFHEIV1,
  9641           DFHEIV20,
  9642           DFHEIV99,
  9643           ELTRLR-KEY,
  9644           DFHEIV99,
  9645           DFHEIV99,
  9646           DFHEIV99
  9647     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9648         DFHEIV20
  9649     MOVE EIBRESP  TO WS-RESPONSE
  9650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9651
  9652     if ws-resp-normal
  9653        perform varying s1 from +1 by +1 until
  9654           at-note-error-no (s1) = spaces
  9655           if at-note-error-no (s1) = '1662'
  9656              continue
  9657           else
  9658              move at-note-error-no (s1)
  9659                                 to emi-error
  9660              if at-note-error-no (s1) = '1653'
  9661                 evaluate true
  9662                    when cl-claim-type = 'L'
  9663                       move '  LF  '
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 182
* EL156.cbl
  9664                                 to emi-claim-type
  9665                    when cl-claim-type = 'I'
  9666                       move '  IU  '
  9667                                 to emi-claim-type
  9668                    when cl-claim-type = 'A'
  9669                       move '  AH  '
  9670                                 to emi-claim-type
  9671                    when other
  9672                       move ' FMLA '
  9673                                 to emi-claim-type
  9674                 end-evaluate
  9675              end-if
  9676              PERFORM 9900-ERROR-FORMAT
  9677                                 THRU 9900-EXIT
  9678           end-if
  9679        end-perform
  9680     end-if
  9681     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9682         IF PI-PMTTYPE = '5' OR '6'
  9683             NEXT SENTENCE
  9684         ELSE
  9685             MOVE ER-0555             TO EMI-ERROR
  9686             MOVE -1                  TO PMTTYPEL
  9687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9688
  9689     IF CL-LAST-CLOSE-REASON = '2'
  9690         IF CL-CLAIM-STATUS = 'C'
  9691             MOVE ER-0760        TO  EMI-ERROR
  9692             MOVE -1             TO  PMTTYPEL
  9693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9694
  9695     IF PI-ACTIVITY-CODE = 9
  9696         MOVE ER-3538            TO  EMI-ERROR
  9697         MOVE -1                 TO  PMTTYPEL
  9698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9699
  9700     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9701         GO TO 1008-READ-CERT.
  9702**********************AIG LOGIC STARTS *********************
  9703     IF CL-CERT-PRIME = 'INCOMPLETE'
  9704         MOVE ER-3540            TO  EMI-ERROR
  9705         MOVE -1                 TO  PMTTYPEL
  9706         MOVE AL-UABON           TO  PMTTYPEA
  9707         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9708         GO TO 2000-EDIT-DONE.
  9709
  9710     IF PI-PMTTYPE = '4'
  9711         IF PI-EPYAMT IS NEGATIVE
  9712             IF PI-ECHECKNO-CR = 'CR'
  9713                 NEXT SENTENCE
  9714             ELSE
  9715                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9716
  9717     IF PI-PMTTYPE = '4'
  9718         IF PI-ECHECKNO-CR = 'CR'
  9719             IF PI-EPYAMT IS NEGATIVE
  9720                 NEXT SENTENCE
  9721             ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 183
* EL156.cbl
  9722                 MOVE ER-0834    TO  EMI-ERROR
  9723                 MOVE -1         TO  EPYAMTL
  9724                 MOVE AL-UNBON   TO  EPYAMTA
  9725                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9726
  9727     IF PI-PMTTYPE = '4'
  9728         IF PI-EPYAMT IS NEGATIVE
  9729             IF PI-OFFLINE = 'Y'
  9730                 NEXT SENTENCE
  9731             ELSE
  9732                 MOVE 'Y'        TO  PI-OFFLINE
  9733                                     WS-OFFLINE
  9734                                     OFFLINEO
  9735                 MOVE AL-UANON   TO  OFFLINEA.
  9736
  9737*    IF PI-PMTTYPE = '4'
  9738*        IF PI-EPYAMT IS NEGATIVE
  9739*            IF PI-CASH = 'Y'
  9740*                NEXT SENTENCE
  9741*            ELSE
  9742*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9743*                MOVE AL-UANON   TO  CASHA
  9744*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9745*
  9746*    IF PI-CASH NOT = 'Y' AND 'N'
  9747*         IF PI-OFFLINE = 'Y'  AND
  9748*            PI-ECHECKNO-CR = 'CR'
  9749*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9750*              MOVE AL-UANON     TO  CASHA
  9751*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9752*
  9753*    IF PI-CASH NOT = 'Y' AND 'N'
  9754*        IF PI-PMTTYPE = '5' OR '6'
  9755*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9756*            MOVE AL-UANON       TO  CASHA
  9757*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9758*
  9759*    IF PI-CASH NOT = 'Y' AND 'N'
  9760*       IF CL-ASSOCIATES = 'N' OR 'A'
  9761*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9762*           MOVE AL-UANON        TO  CASHA
  9763*       ELSE
  9764*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9765*           MOVE AL-UANON        TO  CASHA.
  9766*
  9767*    IF PI-PMTTYPE = '5' OR '6'
  9768*        IF PI-CASH = 'N'
  9769*            MOVE ER-0819        TO  EMI-ERROR
  9770*            MOVE AL-UANON       TO  CASHA
  9771*            MOVE -1             TO  CASHL
  9772*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9773*
  9774*    IF CL-ASSOCIATES = 'N' OR 'A'
  9775*       IF CASHI = 'N'
  9776*        MOVE ER-3537            TO  EMI-ERROR
  9777*        MOVE AL-UANON           TO  CASHA
  9778*        MOVE -1                 TO  CASHL
  9779*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 184
* EL156.cbl
  9780
  9781 1007-DEFAULT-AIG-CHECKNO.
  9782
  9783     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9784         MOVE ER-3532            TO  EMI-ERROR
  9785         MOVE -1                 TO  PMTTYPEL
  9786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9787**********************AIG LOGIC ENDS ***********************
  9788
  9789 1008-READ-CERT.
  9790
  9791     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9792     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9793     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9794     MOVE CL-CERT-STATE          TO CERT-STATE.
  9795     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9796     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9797     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9798     MOVE 'CERT'                 TO FILE-SWITCH.
  9799
  9800     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9801
  9802     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9803         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9804     ELSE
  9805         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9806
  9807*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9808*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9809
  9810     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9811         MOVE ER-0458            TO EMI-ERROR
  9812         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9813
  9814     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9815         MOVE ER-0459            TO EMI-ERROR
  9816         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9817
  9818     IF CL-REPORTED-DT = LOW-VALUES
  9819        MOVE ER-0530             TO EMI-ERROR
  9820        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9821
  9822     IF PI-COMPANY-ID = 'NCL'
  9823        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9824            MOVE ER-0770            TO EMI-ERROR
  9825            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9826
  9827     IF PI-COMPANY-ID = 'NCL'
  9828        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9829            MOVE ER-0737            TO EMI-ERROR
  9830            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9831
  9832     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9833         MOVE ER-0768            TO  EMI-ERROR
  9834         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9835
  9836     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9837         MOVE ER-0769            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 185
* EL156.cbl
  9838         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9839
  9840     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9841         GO TO 1020-DO-LIFE-EDITS
  9842     ELSE
  9843         GO TO 1030-DO-AH-EDITS.
  9844
  9845 1010-GENERAL-ERROR.
  9846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9847
  9848     IF EMI-MESSAGE-FORMATTED
  9849         MOVE -1                 TO PMTTYPEL.
  9850
  9851 1010-EXIT.
  9852     EXIT.
  9853
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 186
* EL156.cbl
  9855 1020-DO-LIFE-EDITS.
  9856     IF CM-LF-BENEFIT-CD = '00'
  9857         IF PI-PMTTYPE = '5' OR '6'
  9858             MOVE ER-0658        TO EMI-ERROR
  9859             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9860         ELSE
  9861             MOVE ER-1775        TO EMI-ERROR
  9862             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9863
  9864     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9865     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9866         MOVE ER-0460            TO EMI-ERROR
  9867         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9868
  9869     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9870     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9871     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9872     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9873     MOVE '4'                    TO  CNTL-REC-TYPE.
  9874     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9875     MOVE 'BENE'                 TO  FILE-SWITCH.
  9876     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9877     IF NO-BENEFIT-FOUND
  9878         GO TO 1950-NOT-FOUND.
  9879
  9880     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9881
  9882     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9883         IF PI-PMTTYPE = '4'
  9884             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9885                PI-LF-COVERAGE-TYPE = 'P'
  9886                 NEXT SENTENCE
  9887             ELSE
  9888                 MOVE ER-0461        TO EMI-ERROR
  9889                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9890         ELSE
  9891            NEXT SENTENCE
  9892     ELSE
  9893         IF PI-PMTTYPE = '2'
  9894            IF NOT CM-O-B-COVERAGE
  9895              AND CM-LF-CURRENT-STATUS = '7'
  9896                MOVE ER-0462     TO EMI-ERROR
  9897                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9898
  9899     IF PI-PMTTYPE = '2'
  9900         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9901            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9902             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9903             MOVE ER-0730            TO  EMI-ERROR
  9904             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9905             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9906
  9907     IF PI-PMTTYPE = '2'
  9908         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9909            PI-LF-COVERAGE-TYPE = 'P'
  9910             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9911                 MOVE ER-0462    TO  EMI-ERROR
  9912                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 187
* EL156.cbl
  9913
  9914     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9915       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9916         MOVE ER-0466            TO EMI-ERROR
  9917         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9918
  9919     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9920         IF PI-PMTTYPE = '3'
  9921             MOVE 0436           TO EMI-ERROR
  9922             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9923             GO TO 1045-EDIT-PAYEE-ADDR
  9924         ELSE
  9925             GO TO 1045-EDIT-PAYEE-ADDR.
  9926
  9927     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9928        PI-LF-COVERAGE-TYPE = 'P'
  9929         IF PI-PMTTYPE = '3'
  9930             MOVE ER-0436          TO  EMI-ERROR
  9931             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9932         ELSE
  9933             NEXT SENTENCE
  9934     ELSE
  9935         IF PI-PMTTYPE = '1' OR '3'
  9936             MOVE ER-0436            TO EMI-ERROR
  9937             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9938*
  9939     IF PI-COMPANY-ID = 'CID' AND
  9940        CL-CERT-STATE = 'SC'  AND
  9941        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9942           MOVE ER-0879    TO  EMI-ERROR
  9943           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9944           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9945     END-IF.
  9946     IF PI-COMPANY-ID = 'AHL'
  9947        evaluate true
  9948           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9949              MOVE ER-0879       TO  EMI-ERROR
  9950              PERFORM 1040-PMTTYPE-ERROR
  9951                                 THRU 1040-EXIT
  9952              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9953           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9954                 '6D' OR '6H' OR '6R'
  9955              MOVE ER-0879       TO  EMI-ERROR
  9956              PERFORM 1040-PMTTYPE-ERROR
  9957                                 THRU 1040-EXIT
  9958              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9959           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9960              MOVE ER-0879       TO  EMI-ERROR
  9961              PERFORM 1040-PMTTYPE-ERROR
  9962                                 THRU 1040-EXIT
  9963              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9964        end-evaluate
  9965     END-IF
  9966     GO TO 1045-EDIT-PAYEE-ADDR.
  9967
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 188
* EL156.cbl
  9969 1030-DO-AH-EDITS.
  9970     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9971     IF CM-AH-BENEFIT-CD = '00'
  9972         IF PI-PMTTYPE = '5' OR '6'
  9973             MOVE ER-0658        TO EMI-ERROR
  9974             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9975         ELSE
  9976             MOVE ER-1775        TO EMI-ERROR
  9977             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9978
  9979     IF CL-TOTAL-PAID-AMT = ZEROS
  9980         IF PI-PMTTYPE = '4'
  9981             MOVE ER-0438        TO EMI-ERROR
  9982             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9983
  9984     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9985         IF PI-PMTTYPE = '3'
  9986             MOVE ER-0463        TO EMI-ERROR
  9987             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9988         ELSE
  9989             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9990              AND CM-LF-CURRENT-STATUS = '7'
  9991                 MOVE ER-0465    TO EMI-ERROR
  9992                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9993
  9994     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9995         IF PI-PMTTYPE = '3'
  9996             MOVE ER-0464        TO EMI-ERROR
  9997             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9998         ELSE
  9999             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10000                 MOVE ER-0469    TO EMI-ERROR
 10001                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10002
 10003     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10004         IF PI-PMTTYPE = '3'
 10005             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10006                 MOVE ER-0467    TO EMI-ERROR
 10007                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10008             ELSE
 10009                 NEXT SENTENCE
 10010         ELSE
 10011             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10012                 MOVE ER-0468    TO EMI-ERROR
 10013                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10014
 10015     GO TO 1045-EDIT-PAYEE-ADDR.
 10016
 10017 1040-PMTTYPE-ERROR.
 10018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
 10020     IF EMI-MESSAGE-FORMATTED
 10021         MOVE -1                 TO PMTTYPEL
 10022         MOVE AL-UABON           TO PMTTYPEA.
 10023
 10024 1040-EXIT.
 10025     EXIT.
 10026
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 189
* EL156.cbl
 10028 1045-EDIT-PAYEE-ADDR.
 10029
 10030     IF PI-OFFLINE = 'N' AND
 10031        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10032           < PI-PAYEE-SEQ-NUM)
 10033        OR
 10034         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10035         (PI-PAYEE-TYPE = 'B')                 AND
 10036         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10037        OR
 10038         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10039           < PI-PAYEE-SEQ-NUM)
 10040        OR
 10041         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10042           < PI-PAYEE-SEQ-NUM)
 10043        OR
 10044         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10045           < PI-PAYEE-SEQ-NUM)
 10046        OR
 10047         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10048           < PI-PAYEE-SEQ-NUM)
 10049        OR
 10050         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10051           < PI-PAYEE-SEQ-NUM))
 10052             MOVE ER-0437        TO EMI-ERROR
 10053             MOVE -1             TO PAYEEL
 10054             MOVE AL-UABON       TO PAYEEA
 10055             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10056
 10057     IF PI-OFFLINE    = 'N' AND
 10058        PI-PAYEE-TYPE = 'B' AND
 10059        PI-PAYEE-SEQ  = '0'
 10060         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10061         IF BENE-FOUND-SW = 'N'
 10062             MOVE ER-0437        TO EMI-ERROR
 10063             MOVE -1             TO PAYEEL
 10064             MOVE AL-UABON       TO PAYEEA
 10065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10066
 10067     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10068        IF PI-OFFLINE    = 'N'  AND
 10069           PI-PAYEE-TYPE = 'B'  AND
 10070           PI-PAYEE-SEQ  = '9'
 10071             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10072             IF BENE-FOUND-SW = 'N'
 10073                MOVE ER-0437        TO EMI-ERROR
 10074                MOVE -1             TO PAYEEL
 10075                MOVE AL-UABON       TO PAYEEA
 10076                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10077
 10078*    IF PI-COMPANY-ID = 'CRI'
 10079*        IF CL-CLAIM-TYPE = 'L'
 10080*            MOVE 'N'                TO  WS-GROUPED
 10081*                                        PI-GROUPED
 10082*                                        GROUPEDI
 10083*            MOVE AL-UANON           TO  GROUPEDA
 10084*            GO TO 1050-EDIT-CHECK-NO
 10085*        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 190
* EL156.cbl
 10086*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10087*            IF WS-GROUP-1 = 'C'
 10088*                NEXT SENTENCE
 10089*            ELSE
 10090*                MOVE 'N'            TO  WS-GROUPED
 10091*                                        PI-GROUPED
 10092*                                        GROUPEDI
 10093*                MOVE AL-UANON       TO  GROUPEDA
 10094*                GO TO 1050-EDIT-CHECK-NO.
 10095
 10096*     IF PI-GROUPED = 'Y'
 10097*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10098*           NEXT SENTENCE
 10099*        ELSE
 10100*           MOVE ER-0437        TO EMI-ERROR
 10101*           MOVE -1             TO PAYEEL
 10102**02180            MOVE AL-UABON       TO PAYEEA
 10103*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10104*
 10105*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10106*        (PI-GROUPED    = ' ')
 10107*        NEXT SENTENCE
 10108*     ELSE
 10109*
 10110     GO TO 1050-EDIT-CHECK-NO.
 10111*     IF PI-COMPANY-ID = 'CRI'
 10112*        MOVE 'N'           TO GROUPEDI
 10113*                              PI-GROUPED
 10114*                              WS-GROUPED
 10115*        MOVE AL-UANON      TO GROUPEDA.
 10116*
 10117*     IF PI-COMPANY-ID = 'CRI'
 10118*        IF PI-PAYEE-TYPE = 'B'
 10119*           IF BENE-FOUND-SW = 'Y'
 10120*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10121*                 MOVE 'Y'           TO GROUPEDI
 10122*                                       PI-GROUPED
 10123*                                       WS-GROUPED
 10124*                 MOVE AL-UANON      TO GROUPEDA
 10125*              ELSE
 10126*                 NEXT SENTENCE
 10127*           ELSE
 10128*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10129*              IF BENE-FOUND-SW = 'Y'
 10130*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10131*                    MOVE 'Y'      TO GROUPEDI
 10132*                                     PI-GROUPED
 10133*                                     WS-GROUPED
 10134*                    MOVE AL-UANON TO GROUPEDA.
 10135*
 10136
 10137     IF PI-COMPANY-ID NOT = 'CRI'
 10138        GO TO 1050-EDIT-CHECK-NO.
 10139
 10140*************** CRI CODE START ******************
 10141     IF PI-PAYEE-TYPE NOT = 'A'
 10142        GO TO 1050-EDIT-CHECK-NO.
 10143
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 191
* EL156.cbl
 10144     MOVE LOW-VALUES             TO ERACCT-KEY.
 10145     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10146     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10147     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10148     MOVE PI-STATE               TO ACCT-STATE.
 10149     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10150     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10151     MOVE 'ACCT'                 TO FILE-SWITCH.
 10152
 10153     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10154     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10155
 10156
 10157* EXEC CICS HANDLE CONDITION
 10158*         NOTFND   (1950-NOT-FOUND)
 10159*         ENDFILE  (1950-NOT-FOUND)
 10160*    END-EXEC.
 10161*    MOVE '"$I''                  ! ( #00009785' TO DFHEIV0
 10162     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10164     MOVE X'2820233030303039373835' TO DFHEIV0(25:11)
 10165     CALL 'kxdfhei1' USING DFHEIV0
 10166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10167
 10168
 10169
 10170* EXEC CICS STARTBR
 10171*         DATASET   ('ERACCT')
 10172*         RIDFLD    (ERACCT-KEY)
 10173*         GTEQ
 10174*    END-EXEC.
 10175     MOVE 'ERACCT' TO DFHEIV1
 10176     MOVE 0
 10177       TO DFHEIV11
 10178*    MOVE '&,         G          &   #00009790' TO DFHEIV0
 10179     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10181     MOVE X'2020233030303039373930' TO DFHEIV0(25:11)
 10182     CALL 'kxdfhei1' USING DFHEIV0,
 10183           DFHEIV1,
 10184           ERACCT-KEY,
 10185           DFHEIV99,
 10186           DFHEIV11,
 10187           DFHEIV99
 10188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10189
 10190
 10191 1046-READNEXT-ERACCT.
 10192
 10193
 10194* EXEC CICS READNEXT
 10195*         DATASET   ('ERACCT')
 10196*         RIDFLD    (ERACCT-KEY)
 10197*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10198*    END-EXEC.
 10199     MOVE 'ERACCT' TO DFHEIV1
 10200     MOVE 0
 10201       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 192
* EL156.cbl
 10202*    MOVE '&.S                   )   #00009798' TO DFHEIV0
 10203     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10204     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10205     MOVE X'2020233030303039373938' TO DFHEIV0(25:11)
 10206     CALL 'kxdfhei1' USING DFHEIV0,
 10207           DFHEIV1,
 10208           DFHEIV20,
 10209           DFHEIV99,
 10210           ERACCT-KEY,
 10211           DFHEIV99,
 10212           DFHEIV11,
 10213           DFHEIV99,
 10214           DFHEIV99
 10215     SET ADDRESS OF ACCOUNT-MASTER TO
 10216         DFHEIV20
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10221        IF WS-ERACCT-HOLD-RECORD = SPACES
 10222           GO TO 1950-NOT-FOUND
 10223        ELSE
 10224           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10225           GO TO 1048-CONTINUE.
 10226
 10227     IF ACCT-EXP-DT = HIGH-VALUES
 10228        NEXT SENTENCE
 10229     ELSE
 10230        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10231        GO TO 1046-READNEXT-ERACCT.
 10232
 10233 1048-CONTINUE.
 10234
 10235*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10236*       MOVE 'Y'                 TO GROUPEDI
 10237*                                   PI-GROUPED
 10238*                                   WS-GROUPED
 10239*       MOVE AL-UANON            TO GROUPEDA.
 10240*************** CRI CODE END ******************
 10241
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 193
* EL156.cbl
 10243 1050-EDIT-CHECK-NO.
 10244
 10245     IF PI-OFFLINE = 'Y'
 10246         IF PI-ECHECKNO = SPACES
 10247              MOVE ER-0439        TO EMI-ERROR
 10248              GO TO 1090-CHECK-NO-ERROR
 10249           ELSE
 10250*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10251*           IF PI-ECHECKNO-N = 'N' AND
 10252*              PI-CASH       = 'Y'
 10253*                MOVE ER-3535        TO EMI-ERROR
 10254*                GO TO 1090-CHECK-NO-ERROR
 10255*             ELSE
 10256*                MOVE AL-UANON    TO CHECKNOA
 10257*                GO TO 1100-EDIT-HOLDTIL
 10258*         ELSE
 10259            MOVE AL-UANON    TO CHECKNOA
 10260            GO TO 1100-EDIT-HOLDTIL.
 10261
 10262     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10263     MOVE '6'                    TO CNTL-REC-TYPE.
 10264
 10265     IF CONTROL-IS-ACTUAL-CARRIER
 10266         MOVE PI-CARRIER         TO WS-CARR
 10267     ELSE
 10268         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10269
 10270     IF PI-COMPANY-ID = 'FIA'
 10271         MOVE PI-CARRIER         TO WS-CARR.
 10272
 10273     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10274     MOVE 0                      TO CNTL-SEQ-NO.
 10275     MOVE 'CARR'                 TO FILE-SWITCH.
 10276
 10277     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10278
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 194
* EL156.cbl
 10280     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10281         GO TO 1051-EDIT-CHECKNO-CONT.
 10282
 10283**********************AIG LOGIC STARTS**********************
 10284     IF PI-ECHECKNO = SPACES
 10285         IF CHECK-NO-MANUAL
 10286             MOVE ER-0441        TO EMI-ERROR
 10287             GO TO 1090-CHECK-NO-ERROR
 10288         ELSE
 10289             MOVE AL-UANOF       TO CHECKNOA
 10290             GO TO 1100-EDIT-HOLDTIL.
 10291
 10292     IF PI-ECHECKNO NOT = SPACES
 10293         IF CHECK-NO-MANUAL
 10294             MOVE AL-UANON       TO CHECKNOA
 10295             GO TO 1100-EDIT-HOLDTIL.
 10296
 10297     IF PI-ECHECKNO-CR = 'CR'
 10298        IF PI-OFFLINE = 'Y'
 10299            MOVE AL-UANON       TO CHECKNOA
 10300            GO TO 1100-EDIT-HOLDTIL
 10301        ELSE
 10302            MOVE ER-3534        TO EMI-ERROR
 10303            GO TO 1090-CHECK-NO-ERROR.
 10304
 10305     IF PI-ECHECKNO-N = 'N'
 10306        IF PI-CASH = 'N'
 10307            MOVE AL-UANON       TO CHECKNOA
 10308            GO TO 1100-EDIT-HOLDTIL
 10309        ELSE
 10310            MOVE ER-3535          TO EMI-ERROR
 10311            GO TO 1090-CHECK-NO-ERROR.
 10312
 10313     MOVE ER-0442        TO EMI-ERROR
 10314     GO TO 1090-CHECK-NO-ERROR.
 10315**********************AIG LOGIC ENDS************************
 10316
 10317 1051-EDIT-CHECKNO-CONT.
 10318
 10319     IF PI-COMPANY-ID = 'DMD'
 10320        IF PI-ECHECKNO NOT = SPACES
 10321           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10322              MOVE ER-0442        TO EMI-ERROR
 10323              GO TO 1090-CHECK-NO-ERROR
 10324            ELSE
 10325              GO TO 1100-EDIT-HOLDTIL
 10326          ELSE
 10327           GO TO 1100-EDIT-HOLDTIL.
 10328
 10329     IF PI-ECHECKNO = SPACES
 10330         IF CHECK-NO-MANUAL
 10331             MOVE ER-0441        TO EMI-ERROR
 10332             GO TO 1090-CHECK-NO-ERROR
 10333         ELSE
 10334             MOVE AL-UANOF       TO CHECKNOA
 10335             GO TO 1100-EDIT-HOLDTIL
 10336     ELSE
 10337         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 195
* EL156.cbl
 10338             MOVE AL-UANON       TO CHECKNOA
 10339             GO TO 1100-EDIT-HOLDTIL
 10340         ELSE
 10341             MOVE ER-0442        TO EMI-ERROR
 10342             GO TO 1090-CHECK-NO-ERROR.
 10343
 10344 1090-CHECK-NO-ERROR.
 10345     MOVE -1                     TO CHECKNOL.
 10346     MOVE AL-UABON               TO CHECKNOA.
 10347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10348
 10349     GO TO 2000-EDIT-DONE.
 10350
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 196
* EL156.cbl
 10352 1100-EDIT-HOLDTIL.
 10353     MOVE AL-UANON               TO HOLDTILA.
 10354
 10355     IF PI-HOLDTIL = ZEROS
 10356        IF PI-OFFLINE = 'Y'
 10357           MOVE ER-0572          TO EMI-ERROR
 10358           GO TO 1105-HOLDTIL-ERROR
 10359        ELSE
 10360           GO TO 1110-EDIT-PAID-FROM.
 10361
 10362     MOVE '4'                    TO DC-OPTION-CODE.
 10363     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10364     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10365
 10366     IF DATE-CONVERSION-ERROR
 10367         MOVE ER-0446            TO EMI-ERROR
 10368         GO TO 1105-HOLDTIL-ERROR
 10369     END-IF
 10370     IF PI-OFFLINE = 'Y'
 10371        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10372           MOVE ER-0446            TO EMI-ERROR
 10373           GO TO 1105-HOLDTIL-ERROR
 10374        END-IF
 10375     END-IF
 10376
 10377     IF PI-OFFLINE = 'Y'
 10378        GO TO 1110-EDIT-PAID-FROM.
 10379
 10380     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10381     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10382     MOVE '1'                    TO DC-OPTION-CODE.
 10383     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10384
 10385     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10386         MOVE ER-0447            TO EMI-ERROR
 10387         GO TO 1105-HOLDTIL-ERROR.
 10388
 10389     GO TO 1110-EDIT-PAID-FROM.
 10390
 10391 1105-HOLDTIL-ERROR.
 10392     MOVE -1                     TO HOLDTILL.
 10393     MOVE AL-UNBON               TO HOLDTILA.
 10394     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10395
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 197
* EL156.cbl
 10397 1110-EDIT-PAID-FROM.
 10398     MOVE AL-UANON               TO EPYFROMA.
 10399
 10400     IF PI-EPYFROM = ZEROS
 10401         GO TO 1120-CALCULATE-PAID-FROM.
 10402
 10403     IF PI-PMTTYPE = '5' OR '6'
 10404         MOVE ER-0448            TO EMI-ERROR
 10405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10406         MOVE AL-UNBON           TO EPYFROMA
 10407         MOVE -1                 TO EPYFROML
 10408         GO TO 1150-EDIT-PAID-THRU.
 10409
 10410     MOVE '4'                    TO DC-OPTION-CODE.
 10411     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10412     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10413
 10414     IF DATE-CONVERSION-ERROR
 10415         MOVE ER-0449            TO EMI-ERROR
 10416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10417         MOVE AL-UNBON           TO EPYFROMA
 10418         MOVE -1                 TO EPYFROML
 10419     ELSE
 10420         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10421
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 198
* EL156.cbl
 10423 1120-CALCULATE-PAID-FROM.
 10424     IF PI-PMTTYPE = '5' OR '6'
 10425         GO TO 1150-EDIT-PAID-THRU.
 10426
 10427*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10428*       IF PI-PMTTYPE = '4'
 10429*         GO TO 1150-EDIT-PAID-THRU.
 10430
 10431     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10432         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10433         MOVE ' '                TO DC-OPTION-CODE
 10434         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10435         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10436         GO TO 1145-TEST-PAID-FROM.
 10437
 10438     IF PI-PMTTYPE = '4'
 10439        GO TO 1150-EDIT-PAID-THRU.
 10440
 10441     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10442     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10443     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10444     MOVE '5'                    TO CNTL-REC-TYPE.
 10445     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10446     MOVE 'BENE'                 TO FILE-SWITCH.
 10447
 10448     IF WS-BEN-CD = ZEROS
 10449         GO TO 1950-NOT-FOUND.
 10450
 10451     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10452
 10453     IF NO-BENEFIT-FOUND
 10454         GO TO 1950-NOT-FOUND.
 10455
 10456     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10457     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10458
 10459     IF PI-BEN-DAYS NOT NUMERIC
 10460        MOVE ZEROS               TO PI-BEN-DAYS.
 10461
 10462     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10463
 10464     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10465        (CL-TOTAL-PAID-AMT > ZEROS)
 10466         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10467         MOVE '6'                 TO DC-OPTION-CODE
 10468         MOVE +0                  TO DC-ELAPSED-MONTHS
 10469         MOVE +1                  TO DC-ELAPSED-DAYS
 10470         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10471         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10472         GO TO 1145-TEST-PAID-FROM.
 10473
 10474******************************************************************
 10475****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10476****** SPECIAL ENTERED DATE.
 10477******************************************************************
 10478
 10479     IF PI-AIGFROM = ZEROS
 10480         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 199
* EL156.cbl
 10481
 10482     MOVE AL-UANON TO AIGFROMA.
 10483
 10484     MOVE '4'                    TO DC-OPTION-CODE.
 10485     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10486     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10487
 10488     IF DATE-CONVERSION-ERROR
 10489         MOVE ER-0449            TO EMI-ERROR
 10490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10491         MOVE AL-UNBON           TO AIGFROMA
 10492         MOVE -1                 TO AIGFROML
 10493         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10494     ELSE
 10495         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10496         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10497
 10498     GO TO 1140-CONTINUE-PAID-FROM.
 10499
 10500 1130-CONTINUE-PAID-FROM.
 10501
 10502     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10503        (CL-TOTAL-PAID-AMT = ZEROS)
 10504           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10505
 10506 1140-CONTINUE-PAID-FROM.
 10507
 10508     IF PI-BEN-TYPE = 'R'
 10509         IF PI-BEN-DAYS = ZEROS
 10510             NEXT SENTENCE
 10511         ELSE
 10512         IF PI-COMPANY-ID NOT = 'DMD'
 10513             SUBTRACT 1 FROM PI-BEN-DAYS.
 10514
 10515     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10516
 10517     IF PI-COMPANY-ID = 'DMD'
 10518         MOVE -1                 TO DC-ELAPSED-DAYS
 10519         MOVE +0                 TO DC-ELAPSED-MONTHS
 10520         MOVE '6'                TO DC-OPTION-CODE
 10521         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10522         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10523         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10524                               REMAINDER DC-ELAPSED-DAYS
 10525      ELSE
 10526         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10527         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10528
 10529     MOVE '6'                    TO DC-OPTION-CODE.
 10530     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10531     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10532
 10533     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10534
 10535     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10536         MOVE ER-0541            TO EMI-ERROR
 10537         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10538         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 200
* EL156.cbl
 10539         MOVE AL-UNBON           TO EPYFROMA.
 10540
 10541     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10542        (PI-BENEFIT-SAVE = '60E')
 10543        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10544           (CL-TOTAL-PAID-AMT = ZEROS)
 10545             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10546             MOVE 30                  TO DC-ELAPSED-DAYS
 10547             MOVE +0                  TO DC-ELAPSED-MONTHS
 10548             MOVE '6'                 TO DC-OPTION-CODE
 10549             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10550
 10551     IF PI-BEN-TYPE = 'R'
 10552         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10553     ELSE
 10554         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10555         IF WS-SV-EPYFROM = LOW-VALUES
 10556            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10557
 10558     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10559         IF WS-USE-AIG-PAYFROM   OR
 10560            WS-AIG-RECALC-PAYFROM
 10561              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10562                                      DC-BIN-DATE-1
 10563              MOVE ' '            TO  DC-OPTION-CODE
 10564              MOVE +0             TO  DC-ELAPSED-MONTHS
 10565                                      DC-ELAPSED-DAYS
 10566              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10567              IF NO-CONVERSION-ERROR
 10568                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10569
 10570     IF PI-CPYFROM < CL-INCURRED-DT
 10571        MOVE -1                  TO EPYFROML
 10572        MOVE ER-3542             TO EMI-ERROR
 10573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10574
 10575     IF CM-ENTRY-DT < CL-INCURRED-DT
 10576        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10577        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10578        MOVE +0                     TO DC-ELAPSED-DAYS
 10579        MOVE +0                     TO DC-ELAPSED-MONTHS
 10580        MOVE '1'                    TO DC-OPTION-CODE
 10581        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10582        ELSE
 10583        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10584
 10585     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10586         NEXT SENTENCE
 10587     ELSE
 10588         IF DC-ELAPSED-MONTHS < 2
 10589             MOVE ER-3255        TO EMI-ERROR
 10590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10591
 10592 1145-TEST-PAID-FROM.
 10593     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10594         GO TO 1150-EDIT-PAID-THRU.
 10595
 10596     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 201
* EL156.cbl
 10597         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10598         MOVE ' '                TO DC-OPTION-CODE
 10599         MOVE +0                 TO DC-ELAPSED-MONTHS
 10600                                    DC-ELAPSED-DAYS
 10601         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10602         IF NO-CONVERSION-ERROR
 10603             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10604         ELSE
 10605             MOVE SPACES             TO EMI-DATE-FIELD.
 10606
 10607     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10608         IF CL-TOTAL-PAID-AMT = ZEROS
 10609             MOVE ER-3543            TO EMI-ERROR
 10610             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10611             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10612             IF EMI-MESSAGE-FORMATTED
 10613                MOVE -1             TO EPYFROML
 10614                MOVE AL-UNBON       TO EPYFROMA
 10615             ELSE
 10616                NEXT SENTENCE
 10617         ELSE
 10618             MOVE ER-0452            TO EMI-ERROR
 10619             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10621             IF EMI-MESSAGE-FORMATTED
 10622                MOVE -1             TO EPYFROML
 10623                MOVE AL-UNBON       TO EPYFROMA.
 10624
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 202
* EL156.cbl
 10626 1150-EDIT-PAID-THRU.
 10627
 10628     MOVE AL-UANON               TO EPYTHRUA.
 10629
 10630     IF PI-EPYTHRU = ZEROS
 10631         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10632             GO TO 1200-EDIT-FIND-TOLERANCES
 10633         ELSE
 10634            IF (PI-PMTTYPE = '3') OR
 10635               (PI-PMTTYPE = '2' AND
 10636                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10637               GO TO 1152-CHECK-TYPE
 10638            ELSE
 10639               MOVE ER-0473      TO EMI-ERROR
 10640               GO TO 1170-PAID-THRU-FATAL-ERROR
 10641     ELSE
 10642         IF PI-PMTTYPE = '5' OR '6'
 10643             MOVE ER-0474        TO EMI-ERROR
 10644             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10645
 10646     MOVE '4'                    TO DC-OPTION-CODE.
 10647     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10648     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10649
 10650     IF DATE-CONVERSION-ERROR
 10651         MOVE ER-0475            TO EMI-ERROR
 10652         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10653
 10654     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10655
 10656     IF PI-COMPANY-ID = 'DMD'
 10657         IF PI-PMTTYPE NOT = '2'
 10658                 AND
 10659            WS-EXP-DT > WS-SV-EPYTHRU
 10660             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10661             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10662             MOVE '1'              TO DC-OPTION-CODE
 10663             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10664             IF DATE-CONVERSION-ERROR
 10665                 MOVE ER-0944      TO EMI-ERROR
 10666                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10667             ELSE
 10668                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10669                    DC-ELAPSED-DAYS   = 1
 10670                     MOVE ER-0945  TO EMI-ERROR
 10671                     MOVE -1       TO EPYTHRUL
 10672                     MOVE AL-UABON TO EPYTHRUA
 10673                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10674
 10675     IF PI-PMTTYPE = '4'
 10676         NEXT SENTENCE
 10677     ELSE
 10678         IF WS-SV-EPYTHRU = WS-EXP-DT
 10679             IF PI-PMTTYPE NOT = '2' AND '3'
 10680                 MOVE ER-3541    TO EMI-ERROR
 10681                 MOVE -1         TO PMTTYPEL
 10682                 MOVE AL-UABON   TO PMTTYPEA
 10683                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 203
* EL156.cbl
 10684
 10685     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10686         MOVE ER-0501            TO EMI-ERROR
 10687         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10688
 10689     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10690        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10691*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10692*              MOVE ER-0540         TO EMI-ERROR
 10693*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10694*              MOVE -1              TO EPYTHRUL
 10695*              MOVE AL-UNBON        TO EPYTHRUA
 10696*          ELSE
 10697*          IF PI-COMPANY-ID = 'DMD'
 10698*              MOVE ER-7540         TO EMI-ERROR
 10699*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10700*              MOVE -1              TO EPYTHRUL
 10701*              MOVE AL-UNBON        TO EPYTHRUA
 10702*          ELSE
 10703               IF PI-PMTTYPE NOT = '2' AND '3'
 10704                  IF PI-COMPANY-ID = '???'
 10705                      MOVE ER-7540  TO EMI-ERROR
 10706                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10707                      MOVE -1       TO EPYTHRUL
 10708                      MOVE AL-UNBON TO EPYTHRUA
 10709                  ELSE
 10710                      MOVE ER-0540  TO EMI-ERROR
 10711                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10712                      MOVE -1       TO EPYTHRUL
 10713                      MOVE AL-UNBON TO EPYTHRUA.
 10714
 10715     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10716            OR
 10717        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10718         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10719            OR
 10720        (PI-CPYFROM NOT = LOW-VALUES AND
 10721         PI-CPYFROM < CL-PAID-THRU-DT)
 10722        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10723
 10724 1152-CHECK-TYPE.
 10725     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10726        OR (PI-PMTTYPE = '5' OR '6')
 10727         GO TO 1160-EDIT-PAID-THRU-AH.
 10728
 10729 1155-EDIT-PAID-THRU-LIFE.
 10730     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10731     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10732     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10733     MOVE '4'                    TO CNTL-REC-TYPE.
 10734     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10735     MOVE 'BENE'                 TO FILE-SWITCH.
 10736
 10737     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10738
 10739     IF NO-BENEFIT-FOUND
 10740         GO TO 1950-NOT-FOUND.
 10741
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 204
* EL156.cbl
 10742     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10743
 10744     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10745
 10746     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10747        PI-LF-COVERAGE-TYPE = 'P'
 10748         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10749         GO TO 1200-EDIT-FIND-TOLERANCES.
 10750
 10751     IF PI-EPYTHRU = ZEROS
 10752        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10753
 10754     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10755         MOVE ER-0476            TO EMI-ERROR
 10756         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10757
 10758     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10759*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10760     move cl-critical-period    to dc-elapsed-months
 10761     MOVE +0                    TO DC-ELAPSED-DAYS.
 10762     MOVE '6'                   TO DC-OPTION-CODE.
 10763     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10764
 10765     IF (NO-CONVERSION-ERROR AND
 10766         WS-SPECIAL-CALC-CD = 'C')
 10767        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10768            MOVE ER-0657 TO EMI-ERROR
 10769            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10770
 10771     IF PI-COMPANY-ID = 'NCL'
 10772         IF WS-SPECIAL-CALC-CD = 'C' AND
 10773            cl-critical-period = zeros
 10774*           CM-LF-CRITICAL-PERIOD = +0
 10775             MOVE ER-0844       TO EMI-ERROR
 10776             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10777
 10778     GO TO 1200-EDIT-FIND-TOLERANCES.
 10779
 10780 1160-EDIT-PAID-THRU-AH.
 10781     IF PI-EPYTHRU = ZEROS
 10782        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10783                                    WS-SV-EPYTHRU
 10784     ELSE
 10785        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10786
 10787     IF WS-SV-EPYTHRU < PI-CPYFROM
 10788         MOVE ER-0508            TO EMI-ERROR
 10789         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10790
 10791     perform 7975-read-acct      thru 7975-exit
 10792     move zeros                  to pi-max-ext
 10793     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10794        PERFORM 0900-GET-DDF-LIMITS
 10795                                 THRU 0900-EXIT
 10796        IF PDEF-FOUND
 10797           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10798              (P1 > +8)
 10799              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 205
* EL156.cbl
 10800           END-PERFORM
 10801           IF P1 < +9
 10802              MOVE PD-MAX-extension (P1)
 10803                                 TO pi-max-ext
 10804           else
 10805              move er-1674       to emi-error
 10806              PERFORM 9900-ERROR-FORMAT
 10807                                 THRU 9900-EXIT
 10808           END-IF
 10809        else
 10810           move er-1672          to emi-error
 10811           PERFORM 9900-ERROR-FORMAT
 10812                                 THRU 9900-EXIT
 10813        END-IF
 10814     end-if
 10815     move spaces                 to pi-max-ext-used
 10816     IF PI-PMTTYPE = '3'
 10817        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10818        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10819           MOVE ER-0477          TO EMI-ERROR
 10820           PERFORM 1165-PAID-THRU-ERROR
 10821                                 THRU 1165-EXIT
 10822        ELSE
 10823           continue
 10824        end-if
 10825     ELSE
 10826        IF WS-SV-EPYTHRU > WS-EXP-DT
 10827           move ws-exp-dt        to dc-bin-date-1
 10828           move ws-sv-epythru    to dc-bin-date-2
 10829           MOVE '1'              TO DC-OPTION-CODE
 10830           MOVE +0               TO DC-ELAPSED-DAYS
 10831                                    DC-ELAPSED-MONTHS
 10832           PERFORM 9700-LINK-DATE-CONVERT
 10833                                 THRU 9700-EXIT
 10834           if no-conversion-error
 10835              if dc-elapsed-days > zeros
 10836                 add +1 to dc-elapsed-months
 10837              end-if
 10838              if dc-elapsed-months > pi-max-ext
 10839                 MOVE ER-0557    TO EMI-ERROR
 10840                 PERFORM 1165-PAID-THRU-ERROR
 10841                                 THRU 1165-EXIT
 10842              else
 10843                 move 'Y'        to pi-max-ext-used
 10844                 move er-1670    to emi-error
 10845                 perform 9900-error-format
 10846                                 thru 9900-exit
 10847              end-if
 10848           end-if
 10849        end-if
 10850     end-if
 10851
 10852     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10853         PI-PMTTYPE NOT = '3'
 10854         MOVE ER-0541        TO EMI-ERROR
 10855         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10856
 10857     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 206
* EL156.cbl
 10858        (PI-PMTTYPE NOT = '3')
 10859         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10860             MOVE ER-0478        TO EMI-ERROR
 10861             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10862
 10863     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10864        (PI-PMTTYPE NOT = '4')
 10865         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10866             MOVE ER-0479        TO EMI-ERROR
 10867             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10868
 10869     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10870         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10871             MOVE ER-0545        TO EMI-ERROR
 10872             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10873
 10874     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10875         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10876             MOVE ER-0481        TO EMI-ERROR
 10877             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10878
 10879*    IF PI-COMPANY-ID = 'NCL'
 10880*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10881*           CM-AH-CRITICAL-PERIOD = +0
 10882*            MOVE ER-0844        TO  EMI-ERROR
 10883*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10884
 10885*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10886     if (cl-critical-period = zeros)
 10887        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10888          GO TO 1200-EDIT-FIND-TOLERANCES.
 10889
 10890     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10891     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10892     MOVE '1'        TO DC-OPTION-CODE.
 10893     MOVE +0         TO DC-ELAPSED-DAYS
 10894                        DC-ELAPSED-MONTHS.
 10895     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10896
 10897*    IF NO-CONVERSION-ERROR
 10898*       COMPUTE ws-benefits-paid =
 10899*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10900*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 10901*           MOVE ER-0657 TO EMI-ERROR
 10902*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10903
 10904     GO TO 1200-EDIT-FIND-TOLERANCES.
 10905
 10906 1165-PAID-THRU-ERROR.
 10907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10908
 10909     IF EMI-MESSAGE-FORMATTED
 10910         MOVE -1                 TO EPYTHRUL
 10911         MOVE AL-UNBON           TO EPYTHRUA.
 10912
 10913 1165-EXIT.
 10914     EXIT.
 10915
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 207
* EL156.cbl
 10916 1166-CHECK-ALL-TRLRS.
 10917
 10918     IF PI-PMTTYPE = '4'
 10919        GO TO 1166-TRLR-EXIT.
 10920
 10921     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10922
 10923     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10924        WS-SV-EPYFROM = LOW-VALUES
 10925          GO TO 1166-END-CHECK.
 10926
 10927
 10928* EXEC CICS HANDLE CONDITION
 10929*        ENDFILE   (1166-END-CHECK)
 10930*        NOTFND    (1166-END-CHECK)
 10931*    END-EXEC.
 10932*    MOVE '"$''I                  ! ) #00010511' TO DFHEIV0
 10933     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10935     MOVE X'2920233030303130353131' TO DFHEIV0(25:11)
 10936     CALL 'kxdfhei1' USING DFHEIV0
 10937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10938
 10939
 10940     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10941     MOVE +100                   TO TRLR-SEQ-NO.
 10942
 10943
 10944* EXEC CICS STARTBR
 10945*         DATASET    ('ELTRLR')
 10946*         RIDFLD     (ELTRLR-KEY)
 10947*         GTEQ
 10948*    END-EXEC.
 10949     MOVE 'ELTRLR' TO DFHEIV1
 10950     MOVE 0
 10951       TO DFHEIV11
 10952*    MOVE '&,         G          &   #00010519' TO DFHEIV0
 10953     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10955     MOVE X'2020233030303130353139' TO DFHEIV0(25:11)
 10956     CALL 'kxdfhei1' USING DFHEIV0,
 10957           DFHEIV1,
 10958           ELTRLR-KEY,
 10959           DFHEIV99,
 10960           DFHEIV11,
 10961           DFHEIV99
 10962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10963
 10964
 10965     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10966
 10967 1166-READ-TRLR-NEXT.
 10968
 10969
 10970* EXEC CICS READNEXT
 10971*         DATASET    ('ELTRLR')
 10972*         RIDFLD     (ELTRLR-KEY)
 10973*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 208
* EL156.cbl
 10974*    END-EXEC.
 10975     MOVE 'ELTRLR' TO DFHEIV1
 10976     MOVE 0
 10977       TO DFHEIV11
 10978*    MOVE '&.S                   )   #00010529' TO DFHEIV0
 10979     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10980     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10981     MOVE X'2020233030303130353239' TO DFHEIV0(25:11)
 10982     CALL 'kxdfhei1' USING DFHEIV0,
 10983           DFHEIV1,
 10984           DFHEIV20,
 10985           DFHEIV99,
 10986           ELTRLR-KEY,
 10987           DFHEIV99,
 10988           DFHEIV11,
 10989           DFHEIV99,
 10990           DFHEIV99
 10991     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10992         DFHEIV20
 10993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10994
 10995
 10996     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10997        TRLR-CARRIER  = MSTR-CARRIER  AND
 10998        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10999        TRLR-CERT-NO  = MSTR-CERT-NO
 11000          NEXT SENTENCE
 11001      ELSE
 11002          GO TO 1166-END-CHECK.
 11003
 11004* **  BYPASS ALL NON-PAYMENT TRAILERS
 11005
 11006     IF AT-TRAILER-TYPE = '2'
 11007        NEXT SENTENCE
 11008     ELSE
 11009        GO TO 1166-READ-TRLR-NEXT.
 11010
 11011* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11012
 11013     IF AT-PAYMENT-TYPE = '1' OR '2'
 11014        NEXT SENTENCE
 11015     ELSE
 11016        GO TO 1166-READ-TRLR-NEXT.
 11017
 11018* **  BYPASS ALL VOID PAYMENTS
 11019
 11020     IF AT-VOID-DT NOT = LOW-VALUES
 11021        GO TO 1166-READ-TRLR-NEXT.
 11022
 11023     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11024        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11025          GO TO 1166-READ-TRLR-NEXT.
 11026
 11027     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11028         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11029            OR
 11030        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11031         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 209
* EL156.cbl
 11032        NEXT SENTENCE
 11033     ELSE
 11034         IF CL-TOTAL-PAID-AMT > ZEROS
 11035             MOVE ER-0502            TO EMI-ERROR
 11036             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11037             MOVE -1                 TO EPYTHRUL
 11038             MOVE AL-UNBON           TO EPYTHRUA.
 11039
 11040     GO TO 1166-READ-TRLR-NEXT.
 11041
 11042 1166-END-CHECK.
 11043
 11044     IF WS-BROWSE-TRLR-SW = 'Y'
 11045
 11046* EXEC CICS ENDBR
 11047*            DATASET   ('ELTRLR')
 11048*       END-EXEC.
 11049     MOVE 'ELTRLR' TO DFHEIV1
 11050     MOVE 0
 11051       TO DFHEIV11
 11052*    MOVE '&2                    $   #00010584' TO DFHEIV0
 11053     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11054     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11055     MOVE X'2020233030303130353834' TO DFHEIV0(25:11)
 11056     CALL 'kxdfhei1' USING DFHEIV0,
 11057           DFHEIV1,
 11058           DFHEIV11,
 11059           DFHEIV99
 11060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11061
 11062
 11063     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11064
 11065 1166-TRLR-EXIT.
 11066     EXIT.
 11067
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 210
* EL156.cbl
 11069 1170-PAID-THRU-FATAL-ERROR.
 11070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11071
 11072     MOVE -1                     TO EPYTHRUL.
 11073     MOVE AL-UNBON               TO EPYTHRUA.
 11074
 11075 1200-EDIT-FIND-TOLERANCES.
 11076
 11077* EXEC CICS HANDLE CONDITION
 11078*        ENDFILE(1950-NOT-FOUND)
 11079*        NOTFND (1950-NOT-FOUND)
 11080*    END-EXEC.
 11081*    MOVE '"$''I                  ! * #00010601' TO DFHEIV0
 11082     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11084     MOVE X'2A20233030303130363031' TO DFHEIV0(25:11)
 11085     CALL 'kxdfhei1' USING DFHEIV0
 11086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11087
 11088
 11089     IF PI-PROCESSOR-ID = 'LGXX'
 11090        GO TO 1240-FIND-ACCT-TOLERANCES.
 11091
 11092     MOVE 'N'                    TO FOUND-TOL-SW.
 11093     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11094     MOVE '2'                    TO CNTL-REC-TYPE.
 11095     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11096     MOVE +0                     TO CNTL-SEQ-NO.
 11097     MOVE 'PROC'                 TO FILE-SWITCH.
 11098
 11099     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11100
 11101     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11102     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11103                                    PI-MAX-PMT-TOL.
 11104     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11105
 11106     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11107         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11108
 11109     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11110     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11111                                    PI-MAX-LF-PMT-TOL.
 11112
 11113     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11114         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11115
 11116     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11117                                    PI-MAX-EXP-PMT.
 11118
 11119 1240-FIND-ACCT-TOLERANCES.
 11120
 11121     IF WS-PMT-TOL NOT = +0
 11122         MOVE 'Y'                TO FOUND-TOL-SW.
 11123
 11124     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11125         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11126         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 211
* EL156.cbl
 11127         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11128         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11129         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11130         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11131     ELSE
 11132         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11133         MOVE PI-CARRIER             TO ACCT-CARRIER
 11134         MOVE PI-GROUPING            TO ACCT-GROUPING
 11135         MOVE PI-STATE               TO ACCT-STATE
 11136         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11137         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11138
 11139     MOVE 'ACCT'                 TO FILE-SWITCH.
 11140
 11141     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11142     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11143
 11144
 11145* EXEC CICS HANDLE CONDITION
 11146*         NOTFND   (1950-NOT-FOUND)
 11147*         ENDFILE  (1950-NOT-FOUND)
 11148*    END-EXEC.
 11149*    MOVE '"$I''                  ! + #00010661' TO DFHEIV0
 11150     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11152     MOVE X'2B20233030303130363631' TO DFHEIV0(25:11)
 11153     CALL 'kxdfhei1' USING DFHEIV0
 11154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11155
 11156
 11157
 11158* EXEC CICS STARTBR
 11159*        DATASET('ERACCT')
 11160*        RIDFLD (ERACCT-KEY)
 11161*        GTEQ
 11162*    END-EXEC.
 11163     MOVE 'ERACCT' TO DFHEIV1
 11164     MOVE 0
 11165       TO DFHEIV11
 11166*    MOVE '&,         G          &   #00010666' TO DFHEIV0
 11167     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11169     MOVE X'2020233030303130363636' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0,
 11171           DFHEIV1,
 11172           ERACCT-KEY,
 11173           DFHEIV99,
 11174           DFHEIV11,
 11175           DFHEIV99
 11176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11177
 11178
 11179 1245-FIND-ACCT-TOLERANCES-LOOP.
 11180
 11181
 11182* EXEC CICS READNEXT
 11183*        DATASET('ERACCT')
 11184*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 212
* EL156.cbl
 11185*        RIDFLD (ERACCT-KEY)
 11186*    END-EXEC.
 11187     MOVE 'ERACCT' TO DFHEIV1
 11188     MOVE 0
 11189       TO DFHEIV11
 11190*    MOVE '&.S                   )   #00010674' TO DFHEIV0
 11191     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11192     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11193     MOVE X'2020233030303130363734' TO DFHEIV0(25:11)
 11194     CALL 'kxdfhei1' USING DFHEIV0,
 11195           DFHEIV1,
 11196           DFHEIV20,
 11197           DFHEIV99,
 11198           ERACCT-KEY,
 11199           DFHEIV99,
 11200           DFHEIV11,
 11201           DFHEIV99,
 11202           DFHEIV99
 11203     SET ADDRESS OF ACCOUNT-MASTER TO
 11204         DFHEIV20
 11205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11206
 11207
 11208     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11209        IF WS-ERACCT-HOLD-RECORD = SPACES
 11210           GO TO 1950-NOT-FOUND
 11211        ELSE
 11212           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11213           GO TO 1250-CONTINUE.
 11214
 11215     IF ACCT-EXP-DT = HIGH-VALUES
 11216        NEXT SENTENCE
 11217     ELSE
 11218        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11219        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11220
 11221 1250-CONTINUE.
 11222
 11223     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11224
 11225     IF FOUND-TOL-SW = 'N'
 11226         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11227
 11228********* 1260-FIND-STATE-TOLERANCES.
 11229
 11230     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11231     MOVE PI-STATE               TO WS-ST-ACCESS.
 11232     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11233     MOVE '3'                    TO CNTL-REC-TYPE.
 11234     MOVE +0                     TO CNTL-SEQ-NO.
 11235     MOVE 'STAT'                 TO FILE-SWITCH.
 11236
 11237     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11238
 11239     IF WS-PMT-TOL = +0
 11240         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11241
 11242     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 213
* EL156.cbl
 11243     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11244     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11245     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11246     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11247
 11248****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11249****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11250     IF PI-PAYEE-TYPE <> 'B'
 11251           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11252     END-IF.
 11253
 11254     IF PI-PMTTYPE      = '2'  AND
 11255        PI-SPLIT-PMT-SW = 'Y'  AND
 11256        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11257          MOVE ER-3530                TO EMI-ERROR
 11258          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11259
 11260********* 1280-FIND-BENEFIT-TOLERANCES.
 11261
 11262     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11263        OR (PI-PMTTYPE = '5' OR '6')
 11264         GO TO 1300-FIND-CARR-TOLERANCES.
 11265
 11266     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11267     MOVE '4'                    TO CNTL-REC-TYPE.
 11268     MOVE +0                     TO CNTL-SEQ-NO.
 11269     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11270     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11271     MOVE 'BENE'                 TO FILE-SWITCH.
 11272
 11273     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11274
 11275     IF NO-BENEFIT-FOUND
 11276         GO TO 1950-NOT-FOUND.
 11277
 11278     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11279     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11280     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11281
 11282
 11283* EXEC CICS HANDLE CONDITION
 11284*        NOTFND(1950-NOT-FOUND)
 11285*    END-EXEC.
 11286*    MOVE '"$I                   ! , #00010754' TO DFHEIV0
 11287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11289     MOVE X'2C20233030303130373534' TO DFHEIV0(25:11)
 11290     CALL 'kxdfhei1' USING DFHEIV0
 11291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11292
 11293
 11294 1300-FIND-CARR-TOLERANCES.
 11295     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11296     MOVE '6'                    TO CNTL-REC-TYPE.
 11297
 11298     IF CONTROL-IS-ACTUAL-CARRIER
 11299         MOVE PI-CARRIER               TO WS-CARR
 11300     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 214
* EL156.cbl
 11301         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11302
 11303     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11304     MOVE +0                     TO CNTL-SEQ-NO.
 11305     MOVE 'CARR'                 TO FILE-SWITCH.
 11306
 11307     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11308
 11309     IF WS-DAYS-TOL = +0
 11310         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11311
 11312     IF WS-PMT-TOL = +0
 11313         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11314
 11315     IF WS-MAX-DAYS-TOL = +0
 11316         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11317
 11318     IF WS-MAX-PMT-TOL = +0
 11319         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11320                                    PI-MAX-PMT-TOL.
 11321
 11322     IF WS-MAX-LF-PMT-TOL = +0
 11323        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11324                                    PI-MAX-LF-PMT-TOL.
 11325
 11326     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11327
 11328********* 1320-FIND-COMP-TOLERANCES.
 11329
 11330     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11331     MOVE '1'                    TO CNTL-REC-TYPE.
 11332     MOVE SPACES                 TO CNTL-ACCESS.
 11333     MOVE +0                     TO CNTL-SEQ-NO.
 11334     MOVE 'COMP'                 TO FILE-SWITCH.
 11335
 11336     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11337
 11338     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11339     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11340
 11341     IF WS-PMT-TOL NOT = +0
 11342        IF WS-TOL-SEVERITY NOT = ' '
 11343         GO TO 1360-EDIT-DAYS.
 11344
 11345     IF WS-PMT-TOL = +0
 11346         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11347
 11348     IF WS-TOL-SEVERITY = ' '
 11349         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11350
 11351 1360-EDIT-DAYS.
 11352     IF PI-PMTTYPE NOT = '4'
 11353        IF PI-EDAYS NEGATIVE OR
 11354           PI-EPYAMT NEGATIVE
 11355          MOVE ER-0513             TO EMI-ERROR
 11356          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357          MOVE -1                  TO PMTTYPEL.
 11358
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 215
* EL156.cbl
 11359     IF PI-PMTTYPE = '5' OR '6'
 11360        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11361
 11362     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11363        IF PI-PMTTYPE = '4'
 11364          MOVE PI-EDAYS          TO PI-CDAYS.
 11365
 11366     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11367         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11368
 11369     IF PI-PMTTYPE = '4'
 11370        MOVE PI-EDAYS            TO PI-CDAYS
 11371        GO TO 1400-EDIT-PAYMENT.
 11372
 11373     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11374        GO TO 1500-EDIT-EXPENSES.
 11375
 11376*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11377*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11378*          CM-AH-BENEFIT-CD = '23'              AND
 11379*          CL-CERT-STATE    = '04'              AND
 11380*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11381*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11382*            GO TO 1362-CHECK-MAX-DAYS.
 11383
 11384     IF PI-EDAYS = ZEROS
 11385*        IF PI-COMPANY-ID = 'DMD'
 11386*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11387*            MOVE -1             TO DC-ELAPSED-DAYS
 11388*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11389*            MOVE '6'            TO DC-OPTION-CODE
 11390*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11391*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11392*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11393*            MOVE '1'            TO DC-OPTION-CODE
 11394*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11395*            IF NO-CONVERSION-ERROR
 11396*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11397*                                 + DC-ODD-DAYS-OVER
 11398*               MOVE 6           TO EDAYSL
 11399*               MOVE AL-UNNON    TO EDAYSA
 11400*            ELSE
 11401*                NEXT SENTENCE
 11402*       ELSE
 11403            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11404            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11405            MOVE '1'             TO DC-OPTION-CODE
 11406            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11407            IF NO-CONVERSION-ERROR
 11408                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11409                ADD 1                 TO PI-EDAYS
 11410                MOVE AL-UNNON         TO EDAYSA.
 11411
 11412*    IF PI-COMPANY-ID = 'DMD'
 11413*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11414*        MOVE -1                 TO DC-ELAPSED-DAYS
 11415*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11416*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 216
* EL156.cbl
 11417*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11418*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11419*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11420*        MOVE '1'                TO DC-OPTION-CODE
 11421*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11422*    ELSE
 11423         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11424         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11425         MOVE '1'                TO DC-OPTION-CODE.
 11426         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11427
 11428     IF NO-CONVERSION-ERROR
 11429        IF PI-COMPANY-ID = 'DMD'
 11430            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11431                             + DC-ODD-DAYS-OVER
 11432        ELSE
 11433            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11434            ADD 1                TO PI-CDAYS.
 11435
 11436     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11437        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11438        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11439
 11440     IF PI-EDAYS NOT NUMERIC
 11441         MOVE ER-0491            TO EMI-ERROR
 11442         GO TO 1370-DAYS-ERROR.
 11443
 11444     IF CL-NO-OF-PMTS-MADE = 0
 11445        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11446        AND CL-CERT-STATE = 'MI'
 11447        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11448            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11449     END-IF.
 11450
 11451 1362-CHECK-MAX-DAYS.
 11452
 11453     IF WS-MAX-DAYS-TOL = +999
 11454         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11455
 11456     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11457         IF PI-EDAYS = ZEROS
 11458             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11459         ELSE
 11460             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11461
 11462     IF WS-MAX-DAYS-TOL NOT = ZERO
 11463        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11464           PI-CDAYS > WS-MAX-DAYS-TOL
 11465             MOVE ER-0492          TO EMI-ERROR
 11466             GO TO 1370-DAYS-ERROR.
 11467
 11468 1365-SKIP-MAX-DAYS-EDIT.
 11469     IF PI-EDAYS = ZEROS
 11470        GO TO 1400-EDIT-PAYMENT.
 11471
 11472     IF WS-DAYS-TOL NOT = ZERO
 11473        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11474           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 217
* EL156.cbl
 11475                MOVE ER-0493     TO EMI-ERROR
 11476                GO TO 1370-DAYS-ERROR.
 11477
 11478     GO TO 1400-EDIT-PAYMENT.
 11479
 11480 1370-DAYS-ERROR.
 11481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11482
 11483     IF EMI-MESSAGE-FORMATTED
 11484         MOVE -1                 TO EDAYSL
 11485         MOVE AL-UABON           TO EDAYSA.
 11486
 11487     GO TO 1400-EDIT-PAYMENT.
 11488
 11489 1380-EDIT-EXPENSE-PMT-AMT.
 11490     IF PI-PMTTYPE = '5' OR '6'
 11491         NEXT SENTENCE
 11492     ELSE
 11493         GO TO 1400-EDIT-PAYMENT.
 11494
 11495     IF WS-MAX-EXP-PMT NOT = ZEROS
 11496        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11497            MOVE ER-3529            TO EMI-ERROR
 11498            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11499
 11500     GO TO 1500-EDIT-EXPENSES.
 11501
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 218
* EL156.cbl
 11503
 11504 1390-CHECK-PAYMENT-DAYS.
 11505
 11506     IF PI-EDAYS = 0
 11507         MOVE PI-CDAYS TO WS-PD-DAYS
 11508     ELSE
 11509         MOVE PI-EDAYS TO WS-PD-DAYS
 11510     END-IF.
 11511
 11512     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11513         IF WS-PD-DAYS = 14
 11514            GO TO 1390-EXIT
 11515         END-IF
 11516     END-IF.
 11517
 11518     IF PI-COMPANY-ID = 'AHL'  AND
 11519        CM-AH-BENEFIT-CD = '1K'
 11520         IF WS-PD-DAYS = 14
 11521            GO TO 1390-EXIT
 11522         END-IF
 11523     END-IF.
 11524
 11525     IF WS-PD-DAYS < 30
 11526         MOVE ER-3549              TO EMI-ERROR
 11527         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11528     END-IF.
 11529
 11530 1390-EXIT.
 11531      EXIT.
 11532
 11533 1400-EDIT-PAYMENT.
 11534*    IF PI-COMPANY-ID = 'DMD'
 11535*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11536*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11537
 11538     IF PI-COMPANY-ID = 'DCC'
 11539        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11540        MOVE PI-CARRIER          TO ACCT-CARRIER
 11541        MOVE PI-GROUPING         TO ACCT-GROUPING
 11542        MOVE PI-STATE            TO ACCT-STATE
 11543        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11544        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11545        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11546        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11547
 11548
 11549* EXEC CICS READ
 11550*          DATASET ('ERACCT')
 11551*          RIDFLD  (ERACCT-KEY)
 11552*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11553*          GTEQ
 11554*          resp    (WS-RESPONSE)
 11555*       END-EXEC
 11556     MOVE 'ERACCT' TO DFHEIV1
 11557*    MOVE '&"S        G          (  N#00011012' TO DFHEIV0
 11558     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11560     MOVE X'204E233030303131303132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 219
* EL156.cbl
 11561     CALL 'kxdfhei1' USING DFHEIV0,
 11562           DFHEIV1,
 11563           DFHEIV20,
 11564           DFHEIV99,
 11565           ERACCT-KEY,
 11566           DFHEIV99,
 11567           DFHEIV99,
 11568           DFHEIV99
 11569     SET ADDRESS OF ACCOUNT-MASTER TO
 11570         DFHEIV20
 11571     MOVE EIBRESP  TO WS-RESPONSE
 11572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11573        IF WS-RESP-NORMAL
 11574           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11575           and pi-cert-eff-dt < am-expiration-dt
 11576           and pi-cert-eff-dt >= am-effective-dt
 11577           move am-dcc-product-code to pi-dcc-product-code
 11578        else
 11579           move spaces           to pi-dcc-product-code
 11580        end-if
 11581        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11582           PERFORM 0900-GET-DDF-LIMITS
 11583                                 THRU 0900-EXIT
 11584           IF PDEF-FOUND
 11585              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11586                 (P1 > +8)
 11587                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11588              END-PERFORM
 11589              IF P1 < +9
 11590                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11591                    MOVE PD-MAX-AMT (P1)
 11592                                 TO CM-AH-BENEFIT-AMT
 11593                 end-if
 11594              else
 11595                 move er-1674    to emi-error
 11596                 PERFORM 9900-ERROR-FORMAT
 11597                                 THRU 9900-EXIT
 11598              END-IF
 11599           else
 11600              move er-1672       to emi-error
 11601              PERFORM 9900-ERROR-FORMAT
 11602                                 THRU 9900-EXIT
 11603           END-IF
 11604        end-if
 11605     END-IF
 11606     IF PI-PMTTYPE NOT = '4'
 11607        GO TO 1405-CALC-PAYMENT.
 11608
 11609     IF PI-EDAYS NOT NUMERIC
 11610         MOVE PI-EPYAMT           TO PI-CPYAMT
 11611         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11612         GO TO 1430-CHECK-AH-TOLERANCE.
 11613
 11614*    IF PI-COMPANY-ID = 'FIA'
 11615*       IF CERT-ACCOUNT = '0000011043'
 11616*        COMPUTE PI-DAILY-RATE ROUNDED =
 11617*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11618*        COMPUTE PI-CPYAMT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 220
* EL156.cbl
 11619*                          PI-DAILY-RATE * PI-EDAYS
 11620*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11621*        GO TO 1430-CHECK-AH-TOLERANCE.
 11622
 11623     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11624         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11625         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11626         GO TO 1420-CHECK-AIG-BENEFIT.
 11627
 11628     IF WS-CALC-METHOD = '2' OR  '5'
 11629         COMPUTE PI-DAILY-RATE ROUNDED =
 11630                        (CM-AH-BENEFIT-AMT * 12) / 365
 11631         COMPUTE PI-CPYAMT ROUNDED =
 11632                           PI-DAILY-RATE * PI-EDAYS
 11633        GO TO 1420-CHECK-AIG-BENEFIT.
 11634
 11635     IF WS-CALC-METHOD = '3'
 11636         COMPUTE PI-DAILY-RATE =
 11637                         (CM-AH-BENEFIT-AMT * 12) / 365
 11638         COMPUTE PI-CPYAMT ROUNDED =
 11639                           PI-DAILY-RATE * PI-EDAYS
 11640        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 221
* EL156.cbl
 11642*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11643
 11644****************************************************************
 11645****************************************************************
 11646*                  CALCULATED FROM      PAYMENT      PAYMENT
 11647*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11648* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11649*1-01-83  1-15-83    0    15     15        15           15
 11650*1-01-83  1-30-83    0    30     30        30           30
 11651*1-01-83  1-31-83    1     0     31        30           30
 11652*1-01-83  2-01-83    1     1     32        31           31
 11653*1-01-83  2-15-83    1    15     46        45           45
 11654*1-01-83  2-28-83    2     0     59        60           60
 11655*1-01-83  3-01-83    2     1     60        61           61
 11656*1-01-83  3-31-83    3     0     90        90           90
 11657*1-15-83  1-31-83    0    17     17        17           16
 11658*1-15-83  2-01-83    0    18     18        18           17
 11659*1-15-83  2-28-83    1    14     45        44           46
 11660*1-21-83  3-09-83    1    20     48        50           49
 11661*2-05-83  3-06-83    1     2     30        32           32
 11662*2-05-83  3-23-83    1    19     47        49           49
 11663*2-15-83  2-28-83    0    14     14        14           16
 11664*2-15-83  3-01-83    0    15     15        15           17
 11665*2-21-83  3-19-83    0    27     27        27           29
 11666*2-21-83  3-20-83    1     0     28        30           30
 11667*2-21-83  4-10-83    1    18     49        30           50
 11668*2-21-83  5-19-83    2    27     88        87           89
 11669*2-21-83  5-22-83    3     2     91        92           92
 11670*3-21-83  5-19-83    1    30     60        60           59
 11671****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 222
* EL156.cbl
 11673 1405-CALC-PAYMENT.
 11674     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11675     MOVE ' '                    TO DC-OPTION-CODE.
 11676     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11677     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11678     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11679
 11680     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11681     MOVE ' '                    TO DC-OPTION-CODE.
 11682     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11683     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11684     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11685
 11686     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11687     MOVE -1                     TO DC-ELAPSED-DAYS.
 11688     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11689     MOVE '6'                    TO DC-OPTION-CODE.
 11690     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11691     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11692
 11693     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11694     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11695     MOVE '1'                    TO DC-OPTION-CODE.
 11696     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11697
 11698     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11699     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11700     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11701
 11702******************************************************************
 11703*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11704*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11705*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11706******************************************************************
 11707
 11708     IF WS-CALC-METHOD = '1'           AND
 11709        DC-ELAPSED-MONTHS > ZERO AND
 11710        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11711        WDF-DAY > WDT-DAY
 11712          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11713          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11714          MOVE -1                  TO DC-ELAPSED-MONTHS
 11715          MOVE '6'                 TO DC-OPTION-CODE
 11716          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11717          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11718          COMPUTE WS-SAVE-ODD-DAYS =
 11719          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11720          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11721
 11722     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11723     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11724     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11725
 11726     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11727     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11728
 11729*    IF PI-COMPANY-ID = 'FIA'
 11730*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 223
* EL156.cbl
 11731*        COMPUTE PI-DAILY-RATE ROUNDED =
 11732*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11733*        COMPUTE PI-CPYAMT ROUNDED =
 11734*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11735*        GO TO 1420-CHECK-AIG-BENEFIT.
 11736
 11737*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11738*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11739*          CM-AH-BENEFIT-CD = '23'               AND
 11740*          CL-CERT-STATE    = '04'               AND
 11741*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11742*            COMPUTE WS-DAILY-RATE ROUNDED =
 11743*                               CM-AH-BENEFIT-AMT / 30
 11744*            COMPUTE PI-CPYAMT ROUNDED =
 11745*                               (WS-DAILY-RATE * PI-CDAYS)
 11746*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11747*            GO TO 1420-CHECK-AIG-BENEFIT.
 11748
 11749     IF WS-CALC-METHOD = '1'
 11750         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11751         COMPUTE PI-CPYAMT ROUNDED =
 11752             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11753             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11754         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11755         GO TO 1420-CHECK-AIG-BENEFIT.
 11756
 11757     IF WS-CALC-METHOD = '2'
 11758         COMPUTE PI-DAILY-RATE ROUNDED =
 11759                          (CM-AH-BENEFIT-AMT * 12) / 365
 11760         COMPUTE PI-CPYAMT ROUNDED =
 11761             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11762             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11763         GO TO 1420-CHECK-AIG-BENEFIT.
 11764
 11765     IF WS-CALC-METHOD = '4'
 11766         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11767         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11768         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11769         COMPUTE PI-CPYAMT ROUNDED =
 11770                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11771         GO TO 1420-CHECK-AIG-BENEFIT.
 11772
 11773     IF WS-CALC-METHOD = '5'
 11774         COMPUTE PI-DAILY-RATE ROUNDED =
 11775                            (CM-AH-BENEFIT-AMT * 12) / 365
 11776         COMPUTE PI-CPYAMT ROUNDED =
 11777                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11778         GO TO 1420-CHECK-AIG-BENEFIT.
 11779
 11780     IF WS-CALC-METHOD NOT = '3'
 11781        GO TO 1410-CHECK-PAYMENT.
 11782
 11783******   CALCULATION METHOD  3  ROUTINE
 11784     COMPUTE PI-DAILY-RATE =
 11785                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11786
 11787******CHECK TO SEE IF WITHIN SAME MONTH
 11788     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 224
* EL156.cbl
 11789        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11790                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11791         GO TO 1420-CHECK-AIG-BENEFIT.
 11792
 11793******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11794     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11795             SAVE-ODD-DAYS-OVER = ZEROS
 11796      COMPUTE PI-CPYAMT  ROUNDED =
 11797                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11798      GO TO 1420-CHECK-AIG-BENEFIT.
 11799
 11800******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11801******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11802     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11803        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11804        IF WDF-MONTH > 12
 11805           ADD 1                 TO WDF-YEAR
 11806           SUBTRACT 12         FROM WDF-MONTH.
 11807
 11808******CONVERT THE NEW FROM MONTH TO BINARY
 11809     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11810        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11811        MOVE '4'              TO DC-OPTION-CODE
 11812        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11813        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11814
 11815     IF WDF-MONTH = WDT-MONTH AND
 11816        WDF-YEAR  = WDT-YEAR
 11817          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11818                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11819                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11820        ELSE
 11821          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11822          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11823          COMPUTE PI-CPYAMT ROUNDED =
 11824       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11825       +
 11826       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11827       +
 11828       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11829
 11830     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 225
* EL156.cbl
 11832 1410-CHECK-PAYMENT.
 11833******PAYMENT OPTION 6
 11834******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11835     IF SAVE-ELAPSED-MONTHS > ZERO
 11836        IF SAVE-ODD-DAYS-OVER = ZEROS
 11837           GO TO 1412-CHECK-TO-DAY
 11838        ELSE
 11839           IF WDF-DAY > WDT-DAY
 11840              IF WDF-MONTH = 02
 11841                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11842                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11843                  GO TO 1412-CHECK-TO-DAY
 11844              ELSE
 11845                  IF FROM-DAYS-IN-MONTH = 31
 11846                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11847                     GO TO 1412-CHECK-TO-DAY
 11848                  ELSE
 11849                     GO TO 1412-CHECK-TO-DAY
 11850           ELSE
 11851               GO TO 1412-CHECK-TO-DAY.
 11852
 11853     IF WDF-MONTH NOT = WDT-MONTH
 11854        IF WDF-MONTH = 02
 11855           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11856           IF WDF-DAY = 29
 11857              ADD 1              TO SAVE-ODD-DAYS-OVER
 11858           ELSE
 11859              ADD 2              TO SAVE-ODD-DAYS-OVER
 11860        ELSE
 11861           IF FROM-DAYS-IN-MONTH = 31
 11862              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11863
 11864 1412-CHECK-TO-DAY.
 11865        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11866           IF WDT-DAY = 28
 11867              ADD 2              TO SAVE-ODD-DAYS-OVER
 11868           ELSE
 11869              IF WDT-DAY = 29
 11870                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11871              ELSE
 11872                 NEXT SENTENCE
 11873        ELSE
 11874           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11875              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11876
 11877     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11878     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11879     COMPUTE PI-CPYAMT ROUNDED =
 11880         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11881         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11882
 11883     GO TO 1420-CHECK-AIG-BENEFIT.
 11884
 11885 1415-CHECK-LEAP-YEAR.
 11886     IF FROM-DAYS-IN-MONTH = 29
 11887        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11888
 11889 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 226
* EL156.cbl
 11890     EXIT.
 11891
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 227
* EL156.cbl
 11893 1420-CHECK-AIG-BENEFIT.
 11894
 11895     IF WS-SPECIAL-CALC-CD = 'Q'
 11896         GO TO 1425-CHECK-WHOLE-MONTH.
 11897
 11898*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11899*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11900*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11901*       (PI-PMTTYPE = '1' OR '2')
 11902*        NEXT SENTENCE
 11903*    ELSE
 11904         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11905         GO TO 1430-CHECK-AH-TOLERANCE.
 11906
 11907******************AIG LOGIC STARTS**********************
 11908*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11909*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11910*    MOVE ER-3533      TO EMI-ERROR.
 11911*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11912*    GO TO 1430-CHECK-AH-TOLERANCE.
 11913******************AIG LOGIC ENDS************************
 11914
 11915 1425-CHECK-WHOLE-MONTH.
 11916******************************************************************
 11917****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11918****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11919****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11920****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11921****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11922****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11923****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11924****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11925****          PAID * MONTHLY BENEFIT.                         ****
 11926******************************************************************
 11927
 11928     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11929
 11930     IF CL-NO-OF-PMTS-MADE > +0
 11931         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11932
 11933     IF PI-CDAYS < WS-BEN-DAYS
 11934         GO TO 1430-CHECK-AH-TOLERANCE.
 11935
 11936     IF PI-CDAYS = WS-BEN-DAYS
 11937         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11938         GO TO 1430-CHECK-AH-TOLERANCE.
 11939
 11940*    IF PI-COMPANY-ID = 'ACM'
 11941*       NEXT SENTENCE
 11942*    ELSE
 11943        GO TO 1425-NOT-ACM-W15C.
 11944
 11945*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11946*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11947*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11948*    MOVE '6'                    TO  DC-OPTION-CODE.
 11949*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11950*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 228
* EL156.cbl
 11951*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11952*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11953*       MOVE '1'                 TO  DC-OPTION-CODE
 11954*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11955*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11956*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11957*       IF NO-CONVERSION-ERROR
 11958*          IF (DC-ELAPSED-MONTHS > +0) OR
 11959*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11960*             NEXT SENTENCE
 11961*          ELSE
 11962*             MOVE +0            TO  PI-CPYAMT
 11963*             MOVE ER-0846       TO  EMI-ERROR
 11964*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11965*             GO TO 1430-CHECK-AH-TOLERANCE
 11966*       ELSE
 11967*           MOVE ER-0846         TO  EMI-ERROR
 11968*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11969*           GO TO 1430-CHECK-AH-TOLERANCE.
 11970*
 11971*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11972*       ADD +1 TO DC-ELAPSED-MONTHS.
 11973*
 11974*    COMPUTE PI-CPYAMT ROUNDED =
 11975*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11976*
 11977*    GO TO 1430-CHECK-AH-TOLERANCE.
 11978
 11979 1425-NOT-ACM-W15C.
 11980
 11981     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11982     MOVE '6'                        TO  DC-OPTION-CODE.
 11983     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11984     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11985
 11986     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11987     IF NO-CONVERSION-ERROR
 11988         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11989     ELSE
 11990         MOVE ER-0846                TO  EMI-ERROR
 11991         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11992         GO TO 1430-CHECK-AH-TOLERANCE.
 11993
 11994     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11995     MOVE '1'                        TO  DC-OPTION-CODE.
 11996     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11997     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11998     IF NO-CONVERSION-ERROR
 11999         IF DC-ODD-DAYS-OVER = +0
 12000             NEXT SENTENCE
 12001         ELSE
 12002             MOVE ER-0846            TO  EMI-ERROR
 12003             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12004             GO TO 1430-CHECK-AH-TOLERANCE
 12005     ELSE
 12006         MOVE ER-0846                TO  EMI-ERROR
 12007         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12008         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 229
* EL156.cbl
 12009
 12010     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12011         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12012
 12013     GO TO 1430-CHECK-AH-TOLERANCE.
 12014
 12015 1425-CONT-WHOLE-MONTH-PMTS.
 12016******************************************************************
 12017****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12018****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12019****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12020******************************************************************
 12021
 12022     IF PI-COMPANY-ID = 'ACM'
 12023        NEXT SENTENCE
 12024     ELSE
 12025        IF DC-ODD-DAYS-OVER = +0
 12026            NEXT SENTENCE
 12027        ELSE
 12028            MOVE ER-0845            TO  EMI-ERROR
 12029            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12030            GO TO 1430-CHECK-AH-TOLERANCE.
 12031
 12032     COMPUTE PI-CPYAMT ROUNDED =
 12033                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12034
 12035 1430-CHECK-AH-TOLERANCE.
 12036     IF PI-PMT-APPR-SW = 'G'
 12037         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12038
 12039*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12040*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12041*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12042*
 12043*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12044*      IF WDF-MONTH = 02
 12045*        IF SAVE-ELAPSED-MONTHS = 0
 12046*          NEXT SENTENCE
 12047*        ELSE
 12048*          IF SAVE-ODD-DAYS-OVER > 0
 12049*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12050*            COMPUTE WS-PMT-MOS ROUNDED =
 12051*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12052*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12053*                                     WS-PMT-MOS
 12054*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12055*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12056*          ELSE
 12057*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12058*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12059*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12060*                                     WS-PMT-MOS.
 12061
 12062     IF WS-MAX-PMT-TOL NOT = ZERO
 12063        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12064           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12065            MOVE ER-0494         TO  EMI-ERROR
 12066            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 230
* EL156.cbl
 12067            GO TO 1500-EDIT-EXPENSES.
 12068
 12069 1430-CONT-CHECK-AH-TOLERANCE.
 12070
 12071     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12072        GO TO 1500-EDIT-EXPENSES.
 12073
 12074     IF CM-O-B-COVERAGE
 12075        GO TO 1500-EDIT-EXPENSES.
 12076
 12077     IF PI-COMPANY-ID = 'NCL'
 12078       IF FOUND-TOL-SW = 'Y'
 12079         IF WS-PMT-TOL NOT = ZERO
 12080           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12081              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12082                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12083                  IF WS-NCL-PMT-OPTION = SPACES
 12084                      MOVE ER-0699 TO EMI-ERROR
 12085                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12086                  ELSE
 12087                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12088                      NEXT SENTENCE
 12089                  ELSE
 12090                  IF NOT WS-VALID-NCL-OPTION
 12091                      MOVE ER-0699 TO EMI-ERROR
 12092                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12093
 12094     IF WS-PMT-TOL NOT = ZERO
 12095        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12096           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12097           MOVE ER-0495          TO EMI-ERROR
 12098           PERFORM 1490-PAYMENT-ERROR
 12099                                 THRU 1490-EXIT
 12100        end-if
 12101     end-if
 12102
 12103     GO TO 1500-EDIT-EXPENSES.
 12104
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 231
* EL156.cbl
 12106 1440-COMPUTE-LIFE-REMAINING.
 12107
 12108     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12109        IF PI-PMTTYPE = '4'
 12110          MOVE PI-EPYAMT TO PI-CPYAMT
 12111          GO TO 1460-TEST-TYPE.
 12112
 12113     IF WS-LF-COVERAGE-TYPE = 'L'
 12114        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12115                          - CL-TOTAL-PAID-AMT
 12116        GO TO 1450-CHECK-MAX.
 12117
 12118     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12119        PI-LF-COVERAGE-TYPE = 'P'
 12120          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12121                              CM-LF-ITD-DEATH-AMT
 12122          GO TO 1450-CHECK-MAX.
 12123
 12124     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12125     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12126     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12127     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12128     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12129     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12130     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12131     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12132     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12133
 12134     PERFORM 9800-LINK-REM-TERM.
 12135
 12136     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12137     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12138     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12139     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12140     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12141     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12142     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12143     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12144     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12145     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12146     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12147     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12148     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12149     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12150     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12151     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12152     IF PI-COMPANY-ID = 'DCC'
 12153        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12154        MOVE PI-CARRIER          TO ACCT-CARRIER
 12155        MOVE PI-GROUPING         TO ACCT-GROUPING
 12156        MOVE PI-STATE            TO ACCT-STATE
 12157        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12158        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12159        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12160        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12161
 12162
 12163* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 232
* EL156.cbl
 12164*          DATASET ('ERACCT')
 12165*          RIDFLD  (ERACCT-KEY)
 12166*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12167*          GTEQ
 12168*          resp    (WS-RESPONSE)
 12169*       END-EXEC
 12170     MOVE 'ERACCT' TO DFHEIV1
 12171*    MOVE '&"S        G          (  N#00011608' TO DFHEIV0
 12172     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12174     MOVE X'204E233030303131363038' TO DFHEIV0(25:11)
 12175     CALL 'kxdfhei1' USING DFHEIV0,
 12176           DFHEIV1,
 12177           DFHEIV20,
 12178           DFHEIV99,
 12179           ERACCT-KEY,
 12180           DFHEIV99,
 12181           DFHEIV99,
 12182           DFHEIV99
 12183     SET ADDRESS OF ACCOUNT-MASTER TO
 12184         DFHEIV20
 12185     MOVE EIBRESP  TO WS-RESPONSE
 12186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12187        IF WS-RESP-NORMAL
 12188           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12189           and (pi-cert-eff-dt < am-expiration-dt)
 12190           and (pi-cert-eff-dt >= am-effective-dt)
 12191           move am-dcc-product-code to pi-dcc-product-code
 12192        else
 12193           move spaces           to pi-dcc-product-code
 12194        end-if
 12195        if pi-dcc-product-code not = spaces
 12196           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12197           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12198           PERFORM 0900-GET-DDF-limits
 12199                                 THRU 0900-EXIT
 12200           IF PDEF-FOUND
 12201              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12202                 (P1 > +8)
 12203                 OR (PD-PROD-CODE (P1) = 'L')
 12204              END-PERFORM
 12205              IF P1 < +9
 12206                 MOVE PD-MAX-AMT (P1)
 12207                                 TO CP-R-MAX-TOT-BEN
 12208              else
 12209                 move er-1674    to emi-error
 12210                 PERFORM 9900-ERROR-FORMAT
 12211                                 THRU 9900-EXIT
 12212              END-IF
 12213           else
 12214              move er-1672       to emi-error
 12215              PERFORM 9900-ERROR-FORMAT
 12216                                 THRU 9900-EXIT
 12217           END-IF
 12218        end-if
 12219     END-IF
 12220
 12221* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 233
* EL156.cbl
 12222*       PROGRAM  (LINK-REMAMT)
 12223*       COMMAREA (CALCULATION-PASS-AREA)
 12224*       LENGTH   (CP-COMM-LENGTH)
 12225*    END-EXEC.
 12226*    MOVE '."C                   (   #00011648' TO DFHEIV0
 12227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12229     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12230     CALL 'kxdfhei1' USING DFHEIV0,
 12231           LINK-REMAMT,
 12232           CALCULATION-PASS-AREA,
 12233           CP-COMM-LENGTH,
 12234           DFHEIV99,
 12235           DFHEIV99,
 12236           DFHEIV99,
 12237           DFHEIV99
 12238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12239
 12240
 12241     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12242
 12243     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12244     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12245
 12246     IF PI-COMPANY-ID = 'BOA' AND
 12247        PI-PMTTYPE    = '2'   AND
 12248        PI-OFFLINE    = 'N'
 12249           GO TO 1441-COMPUTE-BOA-INTEREST.
 12250
 12251     IF PI-COMPANY-ID = 'NCL' AND
 12252        PI-PMTTYPE    = '2'   AND
 12253        PI-OFFLINE    = 'N'
 12254          GO TO 1442-COMPUTE-NCL-INTEREST
 12255       ELSE
 12256          GO TO 1445-CONTINUE.
 12257
 12258 1441-COMPUTE-BOA-INTEREST.
 12259     MOVE +0             TO WS-CALC-INT.
 12260
 12261     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12262     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12263     MOVE +0             TO DC-ELAPSED-MONTHS
 12264                            DC-ELAPSED-DAYS.
 12265     MOVE '1'            TO DC-OPTION-CODE.
 12266     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12267     IF NO-CONVERSION-ERROR
 12268         NEXT SENTENCE
 12269     ELSE
 12270         GO TO 1445-CONTINUE.
 12271
 12272     IF (PI-INT-RATE NOT > ZEROS)  AND
 12273        (DC-ELAPSED-DAYS > +30)
 12274         MOVE ER-3531            TO EMI-ERROR
 12275         MOVE -1                 TO PINTL
 12276         MOVE AL-UNBON           TO PINTA
 12277         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12278
 12279     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 234
* EL156.cbl
 12280         GO TO 1445-CONTINUE.
 12281
 12282     IF (PI-INT-RATE NOT > ZEROS)  OR
 12283        (DC-ELAPSED-DAYS NOT > +30)
 12284         MOVE PI-EPYAMT TO PI-CPYAMT
 12285         GO TO 1441-FORMAT-NOTE.
 12286
 12287     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12288                                 *  PI-INT-RATE
 12289                                 *  DC-ELAPSED-DAYS
 12290                                 /  365
 12291                                 /  100.
 12292
 12293     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12294
 12295 1441-FORMAT-NOTE.
 12296
 12297     MOVE SPACES        TO WS-BOANOTE1.
 12298     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12299     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12300     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12301     MOVE AL-UANON      TO NOTE1A.
 12302
 12303     IF WS-CALC-INT > ZEROS
 12304         MOVE SPACES        TO WS-BOANOTE2
 12305         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12306         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12307         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12308         MOVE AL-UANON      TO NOTE2A.
 12309
 12310     GO TO 1445-CONTINUE.
 12311
 12312 1442-COMPUTE-NCL-INTEREST.
 12313     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12314     MOVE PI-STATE               TO WS-ST-ACCESS.
 12315     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12316     MOVE '3'                    TO CNTL-REC-TYPE.
 12317     MOVE +0                     TO CNTL-SEQ-NO.
 12318     MOVE 'STAT'                 TO FILE-SWITCH.
 12319
 12320     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12321
 12322     MOVE +0                 TO WS-CALC-INT.
 12323
 12324     IF ST-STAT-FROM-INCURRED
 12325         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12326       ELSE
 12327     IF ST-STAT-FROM-REPORTED
 12328         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12329       ELSE
 12330         GO TO 1445-CONTINUE.
 12331
 12332     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12333     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12334     MOVE +0                 TO DC-ELAPSED-MONTHS
 12335                                DC-ELAPSED-DAYS.
 12336     MOVE '1'                TO DC-OPTION-CODE.
 12337     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 235
* EL156.cbl
 12338     IF NO-CONVERSION-ERROR
 12339         NEXT SENTENCE
 12340     ELSE
 12341         GO TO 1445-CONTINUE.
 12342
 12343     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12344        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12345         GO TO 1445-CONTINUE.
 12346
 12347     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12348                                 *  CF-ST-STAT-INTEREST.
 12349
 12350     MOVE SPACES              TO WS-NCLNOTE1.
 12351     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12352     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12353     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12354                                 PI-PMTNOTE1
 12355                                 NOTE1I.
 12356     MOVE AL-UANON            TO NOTE1A.
 12357
 12358     IF WS-CALC-INT > ZEROS
 12359         MOVE SPACES          TO WS-NCLNOTE2
 12360         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12361         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12362         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12363                                 PI-PMTNOTE2
 12364                                 NOTE2I
 12365         MOVE AL-UANON        TO NOTE2A.
 12366
 12367     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12368
 12369 1445-CONTINUE.
 12370
 12371     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12372        GO TO 1460-TEST-TYPE.
 12373
 12374     IF CM-O-B-COVERAGE
 12375        GO TO 1460-TEST-TYPE.
 12376
 12377     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12378         GO TO 1450-CHECK-MAX.
 12379
 12380     if (pi-company-id = 'DCC')
 12381        and (pdef-found)
 12382        and (pi-epyamt > pd-max-amt (p1))
 12383        move er-1657             to emi-error
 12384        perform 1490-payment-error
 12385                                 thru 1490-exit
 12386        go to 1460-test-type
 12387     else
 12388        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12389           > PI-EPYAMT)
 12390                         OR
 12391           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12392           < PI-EPYAMT)
 12393           MOVE ER-0594          TO EMI-ERROR
 12394           PERFORM 1490-PAYMENT-ERROR
 12395                                 THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 236
* EL156.cbl
 12396           GO TO 1460-TEST-TYPE
 12397        end-if
 12398     end-if
 12399     .
 12400 1450-CHECK-MAX.
 12401
 12402     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12403        PI-LF-COVERAGE-TYPE = 'P'
 12404         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12405                                   CM-LF-ITD-DEATH-AMT
 12406     ELSE
 12407         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12408                                   CL-TOTAL-PAID-AMT.
 12409
 12410     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12411          MOVE ER-0543           TO EMI-ERROR
 12412          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12413
 12414 1460-TEST-TYPE.
 12415
 12416     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12417        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12418           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12419                                   CM-LF-ALT-BENEFIT-AMT -
 12420                                   CL-TOTAL-PAID-AMT
 12421           IF PI-EPYAMT > WS-LF-BEN-AMT
 12422               MOVE ER-0543      TO EMI-ERROR
 12423               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12424           END-IF
 12425        END-IF
 12426     END-IF
 12427
 12428     IF PI-PMT-APPR-SW = 'G'
 12429       NEXT SENTENCE
 12430     ELSE
 12431       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12432         IF PI-EPYAMT = ZERO
 12433             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12434                 MOVE ER-0494    TO  EMI-ERROR
 12435                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12436                 GO TO 1500-EDIT-EXPENSES
 12437             ELSE
 12438                 NEXT SENTENCE
 12439         ELSE
 12440             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12441                 MOVE ER-0494    TO  EMI-ERROR
 12442                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12443                 GO TO 1500-EDIT-EXPENSES.
 12444
 12445     IF PI-PMTTYPE NOT = '2' OR
 12446        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12447         GO TO 1500-EDIT-EXPENSES.
 12448
 12449     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12450     MOVE ER-0526                TO EMI-ERROR.
 12451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12452
 12453     IF EMI-ERROR-NUMBER (1) = '0526'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 237
* EL156.cbl
 12454        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12455
 12456     IF EMI-ERROR-NUMBER (2) = '0526'
 12457        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12458
 12459     GO TO 1500-EDIT-EXPENSES.
 12460
 12461 1490-PAYMENT-ERROR.
 12462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12463
 12464     IF EMI-MESSAGE-FORMATTED
 12465         MOVE -1                 TO EPYAMTL
 12466         MOVE AL-UNBON           TO EPYAMTA.
 12467
 12468 1490-EXIT.
 12469      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 238
* EL156.cbl
 12471 1500-EDIT-EXPENSES.
 12472     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12473         GO TO 1500-SKIP-ERROR-0556.
 12474
 12475 1500-CONTINUE-ON.
 12476
 12477     IF CM-O-B-COVERAGE
 12478        MOVE ER-0556             TO EMI-ERROR
 12479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12480
 12481 1500-SKIP-ERROR-0556.
 12482     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12483        IF PI-EEXPENS NOT = ZEROS
 12484           MOVE ER-0524          TO EMI-ERROR
 12485           GO TO 1590-EXPENSE-ERROR
 12486        ELSE
 12487           GO TO 1600-EDIT-RESERVES.
 12488
 12489     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12490     MOVE '6'                    TO CNTL-REC-TYPE.
 12491
 12492     IF CONTROL-IS-ACTUAL-CARRIER
 12493         MOVE PI-CARRIER         TO WS-CARR
 12494     ELSE
 12495         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12496
 12497     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12498     MOVE +0                     TO CNTL-SEQ-NO.
 12499     MOVE 'CARR'                 TO FILE-SWITCH.
 12500
 12501     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12502
 12503     IF EXPENSE-CALC-MANUAL
 12504        GO TO 1600-EDIT-RESERVES.
 12505
 12506     IF DOLLARS-PER-PMT
 12507        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12508        GO TO 1600-EDIT-RESERVES.
 12509
 12510     IF DOLLARS-PER-MONTH AND
 12511        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12512       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12513       GO TO 1600-EDIT-RESERVES.
 12514
 12515     IF PERCENT-OF-PAYMENT
 12516        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12517
 12518     GO TO 1600-EDIT-RESERVES.
 12519
 12520 1590-EXPENSE-ERROR.
 12521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12522
 12523     IF EMI-MESSAGE-FORMATTED
 12524        MOVE -1                  TO EEXPENSL
 12525        MOVE AL-UNBON            TO EEXPENSA.
 12526
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 239
* EL156.cbl
 12528 1600-EDIT-RESERVES.
 12529     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12530        IF PI-ERESV = ZEROS
 12531           GO TO 1700-EDIT-EXPENSE-TYPE
 12532        ELSE
 12533           MOVE ER-0525          TO EMI-ERROR
 12534           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12535           GO TO 1700-EDIT-EXPENSE-TYPE.
 12536
 12537     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12538     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12539     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12540
 12541     IF NOT AT-MANUAL-RESERVES-USED
 12542        IF PI-ERESV NOT = ZEROS
 12543           MOVE ER-0518          TO EMI-ERROR
 12544           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12545
 12546     IF AT-MANUAL-RESERVES-USED
 12547        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12548        GO TO 1700-EDIT-EXPENSE-TYPE.
 12549
 12550     IF AT-FUTURE-RESERVES-USED
 12551        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12552
 12553     IF AT-FUTURE-RESERVES-USED
 12554        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12555
 12556     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12557        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12558
 12559     IF AT-IBNR-RESERVES-USED
 12560        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12561
 12562     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12563     GO TO 1700-EDIT-EXPENSE-TYPE.
 12564
 12565 1690-RESERVE-ERROR.
 12566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12567
 12568     IF EMI-MESSAGE-FORMATTED
 12569        MOVE AL-UNBON            TO ERESVA
 12570        MOVE -1                  TO ERESVL.
 12571
 12572 1690-EXIT.
 12573      EXIT.
 12574
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 240
* EL156.cbl
 12576 1700-EDIT-EXPENSE-TYPE.
 12577     IF PI-PMTTYPE NOT = '5' AND '6'
 12578        GO TO 2000-EDIT-DONE.
 12579
 12580     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12581                   '6' OR '7' OR '8' OR '9'
 12582        GO TO 2000-EDIT-DONE.
 12583
 12584 1705-EXPENSE-ERROR.
 12585     MOVE ER-0573                TO EMI-ERROR.
 12586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12587
 12588     IF EMI-MESSAGE-FORMATTED
 12589        MOVE AL-UABON            TO ETYPEA
 12590        MOVE -1                  TO ETYPEL.
 12591
 12592     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 241
* EL156.cbl
 12594 1950-NOT-FOUND.
 12595     IF FILE-SWITCH = 'MSTR'
 12596        MOVE ER-0204             TO EMI-ERROR.
 12597
 12598     IF FILE-SWITCH = 'CARR'
 12599        MOVE ER-0252             TO EMI-ERROR.
 12600
 12601     IF FILE-SWITCH = 'COMP'
 12602        MOVE ER-0254             TO EMI-ERROR.
 12603
 12604     IF FILE-SWITCH = 'STAT'
 12605        MOVE ER-0149             TO EMI-ERROR.
 12606
 12607     IF FILE-SWITCH = 'PROC'
 12608        MOVE ER-0019             TO EMI-ERROR.
 12609
 12610     IF FILE-SWITCH = 'ACCT'
 12611        MOVE ER-0198             TO EMI-ERROR.
 12612
 12613     IF FILE-SWITCH = 'BENE'
 12614        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12615           MOVE ER-0282          TO EMI-ERROR
 12616        ELSE
 12617           MOVE ER-0283          TO EMI-ERROR.
 12618
 12619     MOVE -1                     TO PMTTYPEL.
 12620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12621
 12622     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12623                                     WS-FORCE-CTR.
 12624
 12625     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12626                                     WS-FATAL-CTR.
 12627
 12628     GO TO 8200-SEND-DATAONLY.
 12629
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 242
* EL156.cbl
 12631 2000-EDIT-DONE.
 12632*********************
 12633     perform 2210-dcc-max-benes thru 2210-exit
 12634     if pi-company-id not = 'DCC'
 12635        IF (WS-SPECIAL-CALC-CD = 'C')
 12636           and (cl-critical-period > 0)
 12637           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12638              IF PI-EPYAMT > ZEROS
 12639                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12640                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12641              ELSE
 12642                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12643                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12644              END-IF
 12645              if ws-benefits-paid > cl-critical-period
 12646                 MOVE ER-0657          TO EMI-ERROR
 12647                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12648              END-IF
 12649           END-IF
 12650        END-IF
 12651     end-if
 12652     IF PI-HOLDTIL NOT = ZEROS
 12653        MOVE PI-HOLDTIL          TO HOLDTILO
 12654        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12655
 12656     IF PI-EPYFROM NOT = ZEROS
 12657        MOVE PI-EPYFROM          TO EPYFROMO
 12658        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12659
 12660     IF PI-EPYTHRU NOT = ZEROS
 12661        MOVE PI-EPYTHRU            TO EPYTHRUO
 12662        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12663        IF PI-USES-PAID-TO
 12664           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12665           MOVE '4'                TO DC-OPTION-CODE
 12666           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12667           IF NO-CONVERSION-ERROR
 12668              MOVE +1              TO DC-ELAPSED-DAYS
 12669              MOVE +0              TO DC-ELAPSED-MONTHS
 12670              MOVE '6'             TO DC-OPTION-CODE
 12671              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12672              IF NO-CONVERSION-ERROR
 12673                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12674
 12675     MOVE PI-EDAYS               TO EDAYSO.
 12676
 12677     IF PI-AIGFROM NOT = ZEROS
 12678        MOVE PI-AIGFROM          TO AIGFROMO
 12679        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12680
 12681     MOVE PI-EPYAMT              TO EPYAMTO.
 12682     MOVE PI-ERESV               TO ERESVO.
 12683     MOVE PI-EEXPENS             TO EEXPENSO.
 12684
 12685     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12686     MOVE SPACES                 TO DC-OPTION-CODE.
 12687     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12688
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 243
* EL156.cbl
 12689     IF DATE-CONVERSION-ERROR
 12690        MOVE SPACES              TO CPYFROMI
 12691     ELSE
 12692        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12693        IF PI-EPYFROM = ZEROS
 12694           MOVE AL-UANON             TO EPYFROMA
 12695           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12696           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12697
 12698     IF PI-USES-PAID-TO
 12699        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12700        MOVE +1                            TO DC-ELAPSED-DAYS
 12701        MOVE +0                            TO DC-ELAPSED-MONTHS
 12702        MOVE '6'                           TO DC-OPTION-CODE
 12703        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12704        IF NO-CONVERSION-ERROR
 12705           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12706           IF PI-EPYTHRU = ZEROS
 12707              MOVE AL-UANON                TO EPYTHRUA
 12708              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12709              MOVE ' '                     TO DC-OPTION-CODE
 12710              MOVE +0                      TO DC-ELAPSED-DAYS
 12711                                              DC-ELAPSED-MONTHS
 12712              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12713              IF NO-CONVERSION-ERROR
 12714                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12715                  GO TO 2001-CONTINUE
 12716              ELSE
 12717                  GO TO 2001-CONTINUE
 12718           ELSE
 12719              GO TO 2001-CONTINUE.
 12720
 12721     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12722     MOVE SPACES                 TO DC-OPTION-CODE.
 12723     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12724
 12725     IF DATE-CONVERSION-ERROR
 12726        MOVE SPACES              TO CPYTHRUI
 12727     ELSE
 12728        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12729        IF PI-EPYTHRU = ZEROS
 12730           MOVE AL-UANON TO EPYTHRUA
 12731           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12732           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12733
 12734 2001-CONTINUE.
 12735
 12736     MOVE PI-CDAYS               TO CDAYSO.
 12737
 12738     IF PI-EDAYS = ZEROS
 12739        MOVE AL-UNNON TO EDAYSA
 12740        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12741
 12742     MOVE PI-CPYAMT              TO CPYAMTO.
 12743
 12744     IF PI-EPYAMT = ZEROS
 12745        MOVE AL-UNNON            TO EPYAMTA
 12746        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 244
* EL156.cbl
 12747
 12748     MOVE PI-CRESV               TO CRESVO.
 12749     MOVE PI-CEXPENS             TO CEXPENSO.
 12750
 12751     IF PI-EEXPENS = ZEROS
 12752        MOVE AL-UNNON TO EEXPENSA
 12753        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12754
 12755     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12756        AND (CL-CLAIM-TYPE = 'L')
 12757        AND (PI-OFFLINE NOT EQUAL 'Y')
 12758        IF PI-PMTTYPE = '2' OR '4'
 12759           PERFORM 2200-CALC-INTEREST
 12760                                 THRU 2200-EXIT
 12761        END-IF
 12762     END-IF
 12763     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12764     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12765     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12766
 12767     IF EMI-FATAL-CTR = ZEROS
 12768        MOVE 'B'                 TO PI-PASS-SW.
 12769
 12770     IF NOT EMI-MESSAGE-FORMATTED
 12771         MOVE -1                 TO EPYFROML
 12772     ELSE
 12773         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12774            EMI-ERROR-NUMBER (2) = SPACES
 12775             MOVE -1             TO EPYFROML.
 12776
 12777     GO TO 8200-SEND-DATAONLY.
 12778
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 245
* EL156.cbl
 12780 2200-CALC-INTEREST.
 12781     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12782        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12783        MOVE '4'                 TO DC-OPTION-CODE
 12784        PERFORM 9700-LINK-DATE-CONVERT
 12785        IF DATE-CONVERSION-ERROR
 12786            MOVE LOW-VALUES      TO CP-PRF-DT
 12787        ELSE
 12788           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12789        END-IF
 12790     END-IF
 12791     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12792        IN CLAIM-INT-PASS-AREA
 12793     MOVE CL-CERT-STATE          TO CP-STATE
 12794        IN CLAIM-INT-PASS-AREA
 12795     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12796     MOVE 'LF'                   TO CP-COVERAGE
 12797     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12798     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12799     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12800     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12801     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12802     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12803
 12804* EXEC CICS LINK
 12805*       PROGRAM   ('ELCLMI')
 12806*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12807*       LENGTH    (CP-CLAIM-LENGTH)
 12808*    END-EXEC
 12809     MOVE 'ELCLMI' TO DFHEIV1
 12810*    MOVE '."C                   (   #00012216' TO DFHEIV0
 12811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12813     MOVE X'2020233030303132323136' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0,
 12815           DFHEIV1,
 12816           CLAIM-INT-PASS-AREA,
 12817           CP-CLAIM-LENGTH,
 12818           DFHEIV99,
 12819           DFHEIV99,
 12820           DFHEIV99,
 12821           DFHEIV99
 12822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12823     MOVE AL-PANOF               TO PINTHA
 12824                                    PINTA
 12825     IF NO-CI-ERROR
 12826        MOVE CP-CLM-INT-AMT      TO PINTO
 12827                                    PI-INT-AMT
 12828        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12829        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12830        MOVE AL-PANOF            TO PINTHA
 12831                                    PINTA
 12832     ELSE
 12833        IF CI-RETURN-CODE = '8'
 12834           MOVE ER-3818          TO EMI-ERROR
 12835           MOVE -1               TO ZINTL
 12836           PERFORM 9900-ERROR-FORMAT
 12837                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 246
* EL156.cbl
 12838           GO TO 2200-EXIT
 12839        ELSE
 12840           MOVE ZEROS            TO PINTO
 12841                                    PI-INT-AMT
 12842                                    PI-INT-DAYS
 12843                                    PI-INT-RATE-USED
 12844        END-IF
 12845     END-IF
 12846     IF PI-INT-AMT NOT = ZEROS
 12847        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12848           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12849           CONTINUE
 12850        ELSE
 12851           MOVE CL-SOC-SEC-NO (1:3)
 12852                                 TO WS-SSN (1:3)
 12853           MOVE CL-SOC-SEC-NO (5:2)
 12854                                 TO WS-SSN (4:2)
 12855           MOVE CL-SOC-SEC-NO (8:4)
 12856                                 TO WS-SSN (6:4)
 12857           IF (WS-SSN NUMERIC)
 12858              AND (WS-SSN NOT = ZEROS)
 12859              CONTINUE
 12860           ELSE
 12861              MOVE ER-2044       TO EMI-ERROR
 12862              PERFORM 9900-ERROR-FORMAT
 12863                                 THRU 9900-EXIT
 12864           END-IF
 12865        END-IF
 12866        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12867        MOVE +51                 TO TRLR-SEQ-NO
 12868
 12869* EXEC CICS READ
 12870*          DATASET  ('ELTRLR')
 12871*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12872*          RIDFLD   (ELTRLR-KEY)
 12873*          RESP     (WS-RESPONSE)
 12874*       END-EXEC
 12875     MOVE 'ELTRLR' TO DFHEIV1
 12876*    MOVE '&"S        E          (  N#00012266' TO DFHEIV0
 12877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12879     MOVE X'204E233030303132323636' TO DFHEIV0(25:11)
 12880     CALL 'kxdfhei1' USING DFHEIV0,
 12881           DFHEIV1,
 12882           DFHEIV20,
 12883           DFHEIV99,
 12884           ELTRLR-KEY,
 12885           DFHEIV99,
 12886           DFHEIV99,
 12887           DFHEIV99
 12888     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12889         DFHEIV20
 12890     MOVE EIBRESP  TO WS-RESPONSE
 12891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12892        IF (NOT WS-RESP-NORMAL)
 12893                    OR
 12894           ((WS-RESP-NORMAL)
 12895           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 247
* EL156.cbl
 12896           OR (AT-CITY-STATE = SPACES)))
 12897           MOVE ER-0874          TO EMI-ERROR
 12898           PERFORM 9900-ERROR-FORMAT
 12899                                 THRU 9900-EXIT
 12900        END-IF
 12901     END-IF
 12902     .
 12903 2200-EXIT.
 12904     EXIT.
 12905 2210-dcc-max-benes.
 12906
 12907     move pi-ah-term             to ws-max-bens
 12908     if cl-critical-period not = zeros and spaces
 12909        move cl-critical-period  to ws-max-bens
 12910     end-if
 12911     move cm-ah-benefit-amt      to ws-monthly-benefit
 12912     if pdef-found
 12913        and (pd-max-amt (p1) not = zeros)
 12914        and (pd-max-amt (p1) < ws-monthly-benefit)
 12915        move pd-max-amt (p1)     to ws-monthly-benefit
 12916     end-if
 12917
 12918     move cl-cert-key-data       to elcrtt-key (2:21)
 12919     move cl-company-cd          to ctrlr-comp-cd
 12920     move cl-cert-no             to ctrlr-cert-no
 12921     move 'B'                    to ctrlr-rec-type
 12922
 12923
 12924* EXEC CICS READ
 12925*       DATASET  ('ELCRTT')
 12926*       set      (address of CERTIFICATE-TRAILERS)
 12927*       RIDFLD   (ELCRTT-KEY)
 12928*       RESP     (WS-RESPONSE)
 12929*    END-EXEC
 12930     MOVE 'ELCRTT' TO DFHEIV1
 12931*    MOVE '&"S        E          (  N#00012303' TO DFHEIV0
 12932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12934     MOVE X'204E233030303132333033' TO DFHEIV0(25:11)
 12935     CALL 'kxdfhei1' USING DFHEIV0,
 12936           DFHEIV1,
 12937           DFHEIV20,
 12938           DFHEIV99,
 12939           ELCRTT-KEY,
 12940           DFHEIV99,
 12941           DFHEIV99,
 12942           DFHEIV99
 12943     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12944         DFHEIV20
 12945     MOVE EIBRESP  TO WS-RESPONSE
 12946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12947     IF not WS-RESP-NORMAL
 12948        go to 2210-exit
 12949     end-if
 12950
 12951*    if instypei = 'P'
 12952*       move +1 to s1
 12953*    else
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 248
* EL156.cbl
 12954*       MOVE +2 to s1
 12955*    end-if
 12956
 12957*    move +1 to s1
 12958*    evaluate cl-claim-type
 12959*       when 'A'
 12960*          move +1 to s2
 12961*       when 'I'
 12962*          move +2 to s2
 12963*       when 'G'
 12964*          move +3 to s2
 12965*       when 'L'
 12966*          move +4 to s2
 12967*       when 'P'
 12968*          move +5 to s2
 12969*    end-evaluate
 12970
 12971     move zeros                  to ws-prev-days-paid
 12972                                    ws-benefits-paid
 12973                                    ws-prev-amt-paid
 12974     perform varying s1 from +1 by +1 until
 12975        (s1 > +24)
 12976        or (cs-claim-type (s1) = spaces)
 12977        if pi-company-id not = 'DCC'
 12978           if cs-claim-type (s1) = cl-claim-type
 12979              compute ws-prev-days-paid =
 12980                 ws-prev-days-paid + cs-days-paid (s1)
 12981              compute ws-prev-amt-paid =
 12982                 ws-prev-amt-paid + cs-total-paid (s1)
 12983           end-if
 12984        else
 12985           if (cs-claim-type (s1) = cl-claim-type)
 12986              and (cs-benefit-period (s1) = cl-benefit-period)
 12987              and (cs-insured-type (s1) = cl-insured-type)
 12988              compute ws-prev-days-paid =
 12989                 ws-prev-days-paid + cs-days-paid (s1)
 12990              compute ws-prev-amt-paid =
 12991                 ws-prev-amt-paid + cs-total-paid (s1)
 12992           end-if
 12993        end-if
 12994     end-perform
 12995     if pi-epyamt > zeros
 12996        compute ws-benefits-paid =
 12997           (ws-prev-amt-paid + pi-epyamt)
 12998           / ws-monthly-benefit
 12999     else
 13000        compute ws-benefits-paid =
 13001           (ws-prev-amt-paid + pi-cpyamt)
 13002           / ws-monthly-benefit
 13003     end-if
 13004     if pi-company-id = 'DCC'
 13005     if cl-claim-type not = 'L' and 'P'
 13006        if ws-benefits-paid > ws-max-bens
 13007           move er-1658          to emi-error
 13008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13009        end-if
 13010     end-if
 13011     end-if
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 249
* EL156.cbl
 13012*     if s1 < +25
 13013*        if pi-epyamt > zeros
 13014*           compute ws-benefits-paid =
 13015*              (cs-total-paid (s1) + PI-EPYAMT)
 13016*              / ws-monthly-benefit
 13017*        else
 13018*           compute ws-benefits-paid =
 13019*              (cs-total-paid (s1) + PI-CPYAMT)
 13020*              / ws-monthly-benefit
 13021*        end-if
 13022
 13023*       if ws-benefits-paid > pd-crit-period (p1)
 13024*        if ws-benefits-paid > ws-max-bens
 13025*           move er-1658          to emi-error
 13026*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027*        end-if
 13028*     end-if
 13029     .
 13030 2210-exit.
 13031     exit.
 13032
 13033 2220-update-elcrtt.
 13034
 13035
 13036* EXEC CICS GETMAIN
 13037*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13038*       LENGTH   (ELCRTT-LENGTH)
 13039*       INITIMG  (GETMAIN-SPACE)
 13040*    END-EXEC
 13041*    MOVE ',"IL                  $   #00012397' TO DFHEIV0
 13042     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13043     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13044     MOVE X'2020233030303132333937' TO DFHEIV0(25:11)
 13045     CALL 'kxdfhei1' USING DFHEIV0,
 13046           DFHEIV20,
 13047           ELCRTT-LENGTH,
 13048           GETMAIN-SPACE
 13049     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13050         DFHEIV20
 13051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13052
 13053     move cl-cert-key-data       to elcrtt-key (2:21)
 13054     move cl-company-cd          to ctrlr-comp-cd
 13055     move cl-cert-no             to ctrlr-cert-no
 13056     move 'B'                    to ctrlr-rec-type
 13057
 13058
 13059* EXEC CICS READ
 13060*       UPDATE
 13061*       DATASET  (ELCRTT-DSID)
 13062*       into     (CERTIFICATE-TRAILERS)
 13063*       RIDFLD   (ELCRTT-KEY)
 13064*       RESP     (WS-RESPONSE)
 13065*    END-EXEC
 13066     MOVE LENGTH OF
 13067      CERTIFICATE-TRAILERS
 13068       TO DFHEIV11
 13069*    MOVE '&"IL       EU         (  N#00012408' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 250
* EL156.cbl
 13070     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13071     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13072     MOVE X'204E233030303132343038' TO DFHEIV0(25:11)
 13073     CALL 'kxdfhei1' USING DFHEIV0,
 13074           ELCRTT-DSID,
 13075           CERTIFICATE-TRAILERS,
 13076           DFHEIV11,
 13077           ELCRTT-KEY,
 13078           DFHEIV99,
 13079           DFHEIV99,
 13080           DFHEIV99
 13081     MOVE EIBRESP  TO WS-RESPONSE
 13082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13083
 13084     IF WS-RESP-NORMAL
 13085        perform 2225-upd-crt-trlr thru 2225-exit
 13086
 13087* EXEC CICS REWRITE
 13088*          DATASET  (ELCRTT-DSID)
 13089*          from     (CERTIFICATE-TRAILERS)
 13090*          RESP     (WS-RESPONSE)
 13091*       END-EXEC
 13092     MOVE LENGTH OF
 13093      CERTIFICATE-TRAILERS
 13094       TO DFHEIV11
 13095*    MOVE '&& L                  %  N#00012418' TO DFHEIV0
 13096     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13098     MOVE X'204E233030303132343138' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0,
 13100           ELCRTT-DSID,
 13101           CERTIFICATE-TRAILERS,
 13102           DFHEIV11,
 13103           DFHEIV99
 13104     MOVE EIBRESP  TO WS-RESPONSE
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13106     else
 13107        if ws-resp-notfnd
 13108           move 'CS'             to certificate-trailers
 13109           move cl-company-cd    to cs-company-cd
 13110           move cl-cert-key-data to cs-control-primary (2:21)
 13111           move cl-cert-no       to cs-cert-no
 13112           move 'B'              to cs-trailer-type
 13113           perform varying s1 from +1 by +1 until s1 > +24
 13114              move zeros         to cs-benefit-period (s1)
 13115                                    cs-days-paid (s1)
 13116                                    cs-total-paid (s1)
 13117                                    cs-remaining-bens (s1)
 13118           end-perform
 13119           perform 2225-upd-crt-trlr
 13120                                 thru 2225-exit
 13121
 13122* EXEC CICS WRITE
 13123*             DATASET  (ELCRTT-DSID)
 13124*             from     (CERTIFICATE-TRAILERS)
 13125*             RIDFLD   (cs-control-primary)
 13126*             RESP     (WS-RESPONSE)
 13127*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 251
* EL156.cbl
 13128     MOVE LENGTH OF
 13129      CERTIFICATE-TRAILERS
 13130       TO DFHEIV11
 13131*    MOVE '&$ L                  ''  N#00012438' TO DFHEIV0
 13132     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13134     MOVE X'204E233030303132343338' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0,
 13136           ELCRTT-DSID,
 13137           CERTIFICATE-TRAILERS,
 13138           DFHEIV11,
 13139           cs-control-primary,
 13140           DFHEIV99,
 13141           DFHEIV99
 13142     MOVE EIBRESP  TO WS-RESPONSE
 13143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13144        end-if
 13145     END-IF
 13146
 13147     .
 13148 2220-exit.
 13149     exit.
 13150
 13151 2225-upd-crt-trlr.
 13152
 13153*    if instypei = 'P'
 13154*       move +1 to s1
 13155*    else
 13156*       MOVE +2 to s1
 13157*    end-if
 13158
 13159*    move +1 to s1
 13160*    evaluate cl-claim-type
 13161*       when 'A'
 13162*          move +1 to s2
 13163*       when 'I'
 13164*          move +2 to s2
 13165*       when 'G'
 13166*          move +3 to s2
 13167*       when 'L'
 13168*          move +4 to s2
 13169*       when 'P'
 13170*          move +5 to s2
 13171*    end-evaluate
 13172     perform varying s1 from +1 by +1 until
 13173        (s1 > +24)
 13174        or (cl-claim-no = cs-claim-no (s1))
 13175     end-perform
 13176     if s1 < +25
 13177        compute cs-total-paid (s1) =
 13178           cs-total-paid (s1) + at-amount-paid
 13179        compute cs-days-paid (s1) =
 13180           cs-days-paid (s1) +  at-days-in-period
 13181*       compute cs-remaining-bens (s1) =
 13182*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13183        perform 2230-accum-bens-paid thru 2230-exit
 13184     end-if
 13185
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 252
* EL156.cbl
 13186     .
 13187 2225-exit.
 13188     exit.
 13189 2230-accum-bens-paid.
 13190     if cl-claim-type not = 'L' and 'P'
 13191        move pi-ah-term          to ws-max-bens
 13192        if cl-critical-period not = zeros and spaces
 13193           move cl-critical-period
 13194                                 to ws-max-bens
 13195        end-if
 13196     else
 13197        move 01                  to ws-max-bens
 13198     end-if
 13199     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13200     perform varying s2 from +1 by +1 until
 13201        (s2 > +24)
 13202        or (cs-claim-no (s2) = spaces)
 13203        if pi-company-id not = 'DCC'
 13204           if cs-claim-type (s2) = cl-claim-type
 13205              compute ws-tot-days-paid =
 13206                 ws-tot-days-paid + cs-days-paid (s2)
 13207              compute ws-tot-amt-paid =
 13208                 ws-tot-amt-paid + cs-total-paid (s2)
 13209           end-if
 13210        else
 13211           if (cs-benefit-period (s2) = cl-benefit-period)
 13212              and (cs-claim-type (s2) = cl-claim-type)
 13213              and (cs-insured-type (s2) = cl-insured-type)
 13214              compute ws-tot-days-paid =
 13215                 ws-tot-days-paid + cs-days-paid (s2)
 13216              compute ws-tot-amt-paid =
 13217                 ws-tot-amt-paid + cs-total-paid (s2)
 13218           end-if
 13219        end-if
 13220     end-perform
 13221     if cl-claim-type = 'L' and 'P'
 13222        if ws-tot-amt-paid > zeros
 13223           move zeros            to cs-remaining-bens (s1)
 13224        else
 13225           move 01               to cs-remaining-bens (s1)
 13226        end-if
 13227     else
 13228        compute ws-pd-bens rounded =
 13229           ws-tot-amt-paid / pi-ah-benefit-amt
 13230        compute cs-remaining-bens (s1) =
 13231           ws-max-bens - ws-pd-bens
 13232        if cs-remaining-bens (s1) < zeros
 13233           move zeros            to cs-remaining-bens (s1)
 13234        end-if
 13235     end-if
 13236     .
 13237 2230-exit.
 13238     exit.
 13239 3000-MOVE-INPUT-TO-SAVE-AREA.
 13240     IF PMTTYPEL > 0
 13241         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13242
 13243     MOVE SPACES                 TO PI-PROVISIONAL-IND.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 253
* EL156.cbl
 13244
 13245     IF WS-PMTTYPE = '9'
 13246         MOVE 'P'                TO PI-PROVISIONAL-IND
 13247         MOVE '1'                TO WS-PMTTYPE.
 13248
 13249     IF PAYEEL > 0
 13250         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13251         MOVE PAYEEI             TO WS-PAYEE.
 13252
 13253     IF NOTE1L > +0
 13254         MOVE NOTE1I             TO WS-PMTNOTE1
 13255                                    WS-FLI-PMTNOTE
 13256                                    WS-HAN-PMTNOTE.
 13257
 13258     IF NOTE2L > +0
 13259         MOVE NOTE2I             TO WS-PMTNOTE2.
 13260
 13261     IF OFFLINEL > 0
 13262         MOVE OFFLINEI           TO WS-OFFLINE.
 13263
 13264     IF PROOFDTL > 0
 13265         MOVE PROOFDTI            TO DATE-WORK
 13266         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13267         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13268         MOVE '4'                 TO DC-OPTION-CODE
 13269         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13270         IF NO-CONVERSION-ERROR
 13271            MOVE NUM-WORK         TO PROOFDTO
 13272            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13273            MOVE NUM-WORK         TO WS-PROOF-DATE
 13274         ELSE
 13275            MOVE ZEROS            TO WS-PROOF-DATE
 13276         END-IF
 13277     END-IF.
 13278
 13279     IF EOBYNL > +0
 13280         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13281         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13282     END-IF
 13283
 13284     IF CLMFMYNL > +0
 13285         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13286         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13287     END-IF
 13288
 13289     IF SURVYYNL > +0
 13290         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13291         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13292     END-IF
 13293
 13294     IF SPRELYNL > +0
 13295         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13296         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13297     END-IF
 13298*    IF GROUPEDL > +0
 13299*        MOVE GROUPEDI           TO WS-GROUPED.
 13300*
 13301*    IF CASHL > +0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 254
* EL156.cbl
 13302*       MOVE CASHI               TO WS-CASH.
 13303     IF LOANNOL > +0
 13304         MOVE LOANNOI            TO WS-LOAN-NO.
 13305
 13306     IF CHECKNOL > 0
 13307         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13308
 13309     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13310         IF WS-AIG-CREDIT-ENTERED
 13311             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13312             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13313             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13314             MOVE AL-UANON         TO CHECKNOA.
 13315
 13316     IF HOLDTILL > 0
 13317         MOVE HOLDTILI           TO DATE-WORK
 13318         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13319         MOVE NUM-WORK           TO WS-HOLDTIL.
 13320
 13321     IF ZINTL > +0
 13322
 13323* EXEC CICS BIF DEEDIT
 13324*           FIELD   (ZINTI)
 13325*           LENGTH  (07)
 13326*       END-EXEC
 13327     MOVE 07
 13328       TO DFHEIV11
 13329*    MOVE '@"L                   #   #00012622' TO DFHEIV0
 13330     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13331     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13332     MOVE X'2020233030303132363232' TO DFHEIV0(25:11)
 13333     CALL 'kxdfhei1' USING DFHEIV0,
 13334           ZINTI,
 13335           DFHEIV11
 13336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13337        IF ZINTI NOT NUMERIC
 13338           MOVE ER-0419          TO EMI-ERROR
 13339           PERFORM 9900-ERROR-FORMAT
 13340           MOVE AL-UABON         TO ZINTA
 13341           MOVE -1               TO ZINTL
 13342        ELSE
 13343           MOVE ZINTI            TO CP-INT-RATE
 13344                                    WS-INT-RATE
 13345           MOVE CP-INT-RATE      TO ZINTO
 13346           MOVE AL-UNNON         TO ZINTA
 13347        END-IF
 13348     ELSE
 13349        MOVE ZEROS               TO CP-INT-RATE
 13350     END-IF
 13351     IF EPYFROML > 0
 13352         MOVE EPYFROMI           TO DATE-WORK
 13353         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13354         MOVE NUM-WORK           TO WS-EPYFROM.
 13355
 13356     IF AIGFROML > 0
 13357         MOVE AIGFROMI           TO DATE-WORK
 13358         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13359         MOVE NUM-WORK           TO WS-AIGFROM
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 255
* EL156.cbl
 13360     ELSE
 13361         IF (AIGFROMI = LOW-VALUES) AND
 13362            (PI-AIGFROM NOT = ZEROS)
 13363              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13364
 13365     IF EPYTHRUL > +0
 13366        MOVE EPYTHRUI           TO DATE-WORK
 13367        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13368        MOVE NUM-WORK           TO WS-EPYTHRU
 13369        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13370        MOVE '4'                TO DC-OPTION-CODE
 13371        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13372        IF NO-CONVERSION-ERROR
 13373           IF PI-USES-PAID-TO
 13374              MOVE '6'                TO DC-OPTION-CODE
 13375              MOVE -1                 TO DC-ELAPSED-DAYS
 13376              MOVE +0                 TO DC-ELAPSED-MONTHS
 13377              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13378              IF NO-CONVERSION-ERROR
 13379                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13380                 MOVE ' '             TO DC-OPTION-CODE
 13381                 MOVE +0              TO DC-ELAPSED-DAYS
 13382                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13383              IF NO-CONVERSION-ERROR
 13384                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13385
 13386*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13387*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13388     IF EDAYSL > 0
 13389
 13390* EXEC CICS BIF DEEDIT
 13391*            FIELD(EDAYSI)
 13392*            LENGTH(6)
 13393*        END-EXEC
 13394     MOVE 6
 13395       TO DFHEIV11
 13396*    MOVE '@"L                   #   #00012678' TO DFHEIV0
 13397     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13398     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13399     MOVE X'2020233030303132363738' TO DFHEIV0(25:11)
 13400     CALL 'kxdfhei1' USING DFHEIV0,
 13401           EDAYSI,
 13402           DFHEIV11
 13403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13404         MOVE EDAYSI             TO WS-DY-WORK
 13405         IF WS-DY-SIGN = SPACES
 13406            MOVE WS-DY-NUM       TO WS-EDAYS
 13407            ADD 0                TO WS-EDAYS
 13408         ELSE
 13409            MOVE EDAYSI          TO WS-EDAYS
 13410            ADD 0                TO WS-EDAYS.
 13411
 13412*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13413*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13414     IF EPYAMTL > 0
 13415
 13416* EXEC CICS BIF DEEDIT
 13417*            FIELD(EPYAMTI)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 256
* EL156.cbl
 13418*            LENGTH(10)
 13419*        END-EXEC
 13420     MOVE 10
 13421       TO DFHEIV11
 13422*    MOVE '@"L                   #   #00012693' TO DFHEIV0
 13423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13425     MOVE X'2020233030303132363933' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           EPYAMTI,
 13428           DFHEIV11
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13430         MOVE EPYAMTI            TO WS-PY-WORK
 13431         IF WS-PY-SIGN = SPACES
 13432            MOVE WS-PY-NUM       TO WS-EPYAMT
 13433            ADD 0                TO WS-EPYAMT
 13434         ELSE
 13435            MOVE EPYAMTI         TO WS-EPYAMT
 13436            ADD 0                TO WS-EPYAMT.
 13437
 13438     IF ERESVL > 0
 13439
 13440* EXEC CICS BIF DEEDIT
 13441*            FIELD(ERESVI)
 13442*            LENGTH(9)
 13443*        END-EXEC
 13444     MOVE 9
 13445       TO DFHEIV11
 13446*    MOVE '@"L                   #   #00012706' TO DFHEIV0
 13447     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13448     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13449     MOVE X'2020233030303132373036' TO DFHEIV0(25:11)
 13450     CALL 'kxdfhei1' USING DFHEIV0,
 13451           ERESVI,
 13452           DFHEIV11
 13453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13454         MOVE ERESVI TO WS-ERESV.
 13455
 13456     IF EEXPENSL > 0
 13457
 13458* EXEC CICS BIF DEEDIT
 13459*            FIELD(EEXPENSI)
 13460*            LENGTH(8)
 13461*        END-EXEC
 13462     MOVE 8
 13463       TO DFHEIV11
 13464*    MOVE '@"L                   #   #00012713' TO DFHEIV0
 13465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13467     MOVE X'2020233030303132373133' TO DFHEIV0(25:11)
 13468     CALL 'kxdfhei1' USING DFHEIV0,
 13469           EEXPENSI,
 13470           DFHEIV11
 13471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13472         MOVE EEXPENSI           TO WS-EEXPENS.
 13473
 13474     IF ETYPEL > ZEROS
 13475         MOVE ETYPEI             TO WS-ETYPE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 257
* EL156.cbl
 13476
 13477     IF PI-COMPANY-ID = 'BOA'
 13478        IF PINTL > ZEROS
 13479
 13480* EXEC CICS BIF DEEDIT
 13481*            FIELD (PINTI)
 13482*            LENGTH(05)
 13483*          END-EXEC
 13484     MOVE 05
 13485       TO DFHEIV11
 13486*    MOVE '@"L                   #   #00012724' TO DFHEIV0
 13487     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13488     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13489     MOVE X'2020233030303132373234' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           PINTI,
 13492           DFHEIV11
 13493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13494           IF PINTI NUMERIC
 13495               MOVE AL-UNNON     TO PINTA
 13496               MOVE PINTI        TO WS-INT-RATE
 13497               MOVE WS-INT-RATE  TO PINTO.
 13498
 13499 3000-EXIT.
 13500     EXIT.
 13501
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 258
* EL156.cbl
 13503 3050-REBUILD-ENTERED.
 13504
 13505     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13506
 13507     IF PI-PROV-PMT
 13508         MOVE '9'           TO PMTTYPEO
 13509     ELSE
 13510         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13511
 13512     MOVE PI-PAYEE          TO PAYEEO.
 13513     MOVE PI-PMTNOTE1       TO NOTE1O.
 13514     MOVE PI-PMTNOTE2       TO NOTE2O.
 13515     MOVE PI-OFFLINE        TO OFFLINEO.
 13516     IF PI-PROOF-DATE NOT = ZEROS
 13517         MOVE PI-PROOF-DATE TO PROOFDTO
 13518         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13519     END-IF.
 13520*    MOVE PI-GROUPED        TO GROUPEDO.
 13521
 13522*    MOVE PI-CASH           TO CASHO.
 13523
 13524     IF PI-INT-RATE > ZEROS
 13525         MOVE PI-INT-RATE   TO PINTO.
 13526
 13527     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13528        IF PI-INT-AMT > ZEROS
 13529           MOVE PI-INT-AMT       TO PINTO
 13530           MOVE AL-PANOF         TO PINTA
 13531                                    PINTHA
 13532        END-IF
 13533     END-IF
 13534     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13535     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13536     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13537     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13538     IF PI-HOLDTIL NOT = ZEROS
 13539        MOVE PI-HOLDTIL          TO HOLDTILO
 13540        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13541
 13542     IF PI-EPYFROM NOT = ZEROS
 13543        MOVE PI-EPYFROM          TO EPYFROMO
 13544        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13545
 13546     IF PI-AIGFROM NOT = ZEROS
 13547        MOVE PI-AIGFROM          TO AIGFROMO
 13548        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13549
 13550     IF PI-EPYTHRU NOT = ZEROS
 13551        MOVE PI-EPYTHRU          TO EPYTHRUO
 13552        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13553        IF PI-USES-PAID-TO
 13554           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13555           MOVE '4'                TO DC-OPTION-CODE
 13556           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13557           IF NO-CONVERSION-ERROR
 13558              MOVE +1 TO DC-ELAPSED-DAYS
 13559              MOVE +0 TO DC-ELAPSED-MONTHS
 13560              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 259
* EL156.cbl
 13561              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13562              IF NO-CONVERSION-ERROR
 13563                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13564
 13565     IF PI-EDAYS NOT = ZEROS
 13566        MOVE PI-EDAYS TO EDAYSO.
 13567
 13568     IF PI-EPYAMT NOT = ZEROS
 13569        MOVE PI-EPYAMT TO EPYAMTO.
 13570
 13571     IF PI-ERESV NOT = ZEROS
 13572        MOVE PI-ERESV TO ERESVO.
 13573
 13574     IF PI-EEXPENS NOT = ZEROS
 13575        MOVE PI-EEXPENS TO EEXPENSO.
 13576
 13577     MOVE PI-ETYPE TO ETYPEO.
 13578
 13579     IF PI-ECHECKNO NOT = SPACES
 13580        MOVE PI-ECHECKNO         TO CHECKNOO
 13581     ELSE
 13582        MOVE PI-CCHECKNO         TO CHECKNOO.
 13583
 13584     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13585     MOVE SPACES                 TO DC-OPTION-CODE.
 13586     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13587
 13588     IF DATE-CONVERSION-ERROR
 13589        MOVE SPACES              TO CPYFROMI
 13590     ELSE
 13591        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13592
 13593     IF PI-USES-PAID-TO
 13594        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13595        MOVE +1                  TO DC-ELAPSED-DAYS
 13596        MOVE +0                  TO DC-ELAPSED-MONTHS
 13597        MOVE '6'                 TO DC-OPTION-CODE
 13598        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13599        IF NO-CONVERSION-ERROR
 13600           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13601           GO TO 3051-CONTINUE.
 13602
 13603     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13604     MOVE SPACES                 TO DC-OPTION-CODE.
 13605     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13606
 13607     IF DATE-CONVERSION-ERROR
 13608        MOVE SPACES              TO CPYTHRUI
 13609     ELSE
 13610        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13611
 13612 3051-CONTINUE.
 13613
 13614     IF PI-CDAYS NOT = ZEROS
 13615        MOVE PI-CDAYS TO CDAYSO.
 13616
 13617     IF PI-CPYAMT NOT = ZEROS
 13618        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 260
* EL156.cbl
 13619
 13620     IF PI-CRESV NOT = ZEROS
 13621        MOVE PI-CRESV TO CRESVO.
 13622
 13623     IF PI-CEXPENS NOT = ZEROS
 13624        MOVE PI-CEXPENS TO CEXPENSO.
 13625
 13626 3059-EXIT.
 13627     EXIT.
 13628
 13629 3100-DEEDIT-DATE.
 13630
 13631* EXEC CICS BIF DEEDIT
 13632*        FIELD(DATE-WORK)
 13633*        LENGTH(8)
 13634*    END-EXEC.
 13635     MOVE 8
 13636       TO DFHEIV11
 13637*    MOVE '@"L                   #   #00012864' TO DFHEIV0
 13638     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13639     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13640     MOVE X'2020233030303132383634' TO DFHEIV0(25:11)
 13641     CALL 'kxdfhei1' USING DFHEIV0,
 13642           DATE-WORK,
 13643           DFHEIV11
 13644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13645
 13646
 13647 3100-EXIT.
 13648     EXIT.
 13649
 13650 3200-CALC-AIG-DAYS.
 13651
 13652     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13653
 13654     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13655     MOVE ' '                    TO DC-OPTION-CODE.
 13656     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13657     IF NO-CONVERSION-ERROR
 13658         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13659     ELSE
 13660         GO TO 3290-ERROR.
 13661
 13662     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13663         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13664                                WS-BIN-FROM-DT
 13665     ELSE
 13666         IF CL-TOTAL-PAID-AMT > ZEROS
 13667             IF WS-SV-EPYFROM = LOW-VALUES
 13668                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13669                                        WS-BIN-FROM-DT
 13670             ELSE
 13671                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13672                                        WS-BIN-FROM-DT
 13673         ELSE
 13674             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13675                                        WS-BIN-FROM-DT.
 13676
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 261
* EL156.cbl
 13677 3210-CONTINUE.
 13678
 13679     MOVE ' '                    TO DC-OPTION-CODE.
 13680     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13681     IF DATE-CONVERSION-ERROR
 13682         GO TO 3290-ERROR.
 13683
 13684     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13685
 13686     IF PI-LOAN-DUE-DAY = 31
 13687         MOVE 30              TO WS-PMT-DUE-DA
 13688                                 WS-SAVE-DUE-DA
 13689     ELSE
 13690         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13691                                 WS-SAVE-DUE-DA.
 13692
 13693     IF (PI-LOAN-DUE-DAY > 28) AND
 13694        (WS-PMT-DUE-MO = 2)
 13695         MOVE 'Y'                TO WS-DUE-DAY-SW
 13696         MOVE 28                 TO WS-PMT-DUE-DA.
 13697
 13698     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13699     MOVE '4'                    TO DC-OPTION-CODE.
 13700     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13701     IF NO-CONVERSION-ERROR
 13702         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13703     ELSE
 13704         GO TO 3290-ERROR.
 13705
 13706*--------------------------------------------------------------*
 13707*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13708*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13709*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13710*                                                              *
 13711*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13712*             INCURRED DATE      - 04/15/91                    *
 13713*             PMT DUE DATE       - 04/03/91                    *
 13714*             PMT DUE DATE       - 05/03/91                    *
 13715*--------------------------------------------------------------*
 13716
 13717     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13718        (WS-SV-AIGFROM = LOW-VALUES)
 13719         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13720            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13721             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13722             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13723             IF NO-CONVERSION-ERROR
 13724                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13725                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13726             ELSE
 13727                 GO TO 3290-ERROR.
 13728
 13729     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13730        (WS-SV-AIGFROM = LOW-VALUES)
 13731         GO TO 3205-CONT-CALC-PMT.
 13732
 13733     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13734     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 262
* EL156.cbl
 13735     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13736     IF NO-CONVERSION-ERROR
 13737         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13738     ELSE
 13739         GO TO 3290-ERROR.
 13740
 13741     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13742        (WS-PMT-DUE-DA < WS-FROM-DA)
 13743          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13744          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13745          IF NO-CONVERSION-ERROR
 13746              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13747              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13748          ELSE
 13749              GO TO 3290-ERROR.
 13750
 13751 3205-CONT-CALC-PMT.
 13752
 13753*--------------------------------------------------------------*
 13754*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13755*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13756*--------------------------------------------------------------*
 13757
 13758     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13759        PI-PMTTYPE = '2'
 13760          NEXT SENTENCE
 13761     ELSE
 13762        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13763           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13764             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13765             MOVE ER-3527            TO EMI-ERROR
 13766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13767             MOVE -1                 TO EPYTHRUL
 13768             MOVE AL-UNBON           TO EPYTHRUA
 13769                                        EPYFROMA
 13770             GO TO 3299-EXIT.
 13771
 13772*--------------------------------------------------------------*
 13773*    CALCULATE RETRO ELIMINATION DATE                          *
 13774*--------------------------------------------------------------*
 13775
 13776     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13777         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13778     ELSE
 13779         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13780
 13781     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13782     MOVE +0             TO DC-ELAPSED-MONTHS.
 13783     MOVE '6'            TO DC-OPTION-CODE.
 13784     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13785     IF NO-CONVERSION-ERROR
 13786         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13787     ELSE
 13788         GO TO 3290-ERROR.
 13789
 13790 3210-CHECK-PMT-DATE.
 13791
 13792*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 263
* EL156.cbl
 13793*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13794*    THE ENTERED PAY FROM DATE                                 *
 13795*--------------------------------------------------------------*
 13796
 13797     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13798         NEXT SENTENCE
 13799     ELSE
 13800         GO TO 3220-COMPUTE-DAYS.
 13801
 13802     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13803     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13804     IF NO-CONVERSION-ERROR
 13805         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13806         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13807         GO TO 3210-CHECK-PMT-DATE
 13808     ELSE
 13809         GO TO 3290-ERROR.
 13810
 13811 3220-COMPUTE-DAYS.
 13812
 13813     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13814     MOVE ZEROS         TO WS-CDAYS.
 13815     MOVE 'N'           TO WS-ELIMINATION-SW.
 13816
 13817*--------------------------------------------------------------*
 13818*    COMPUTE CALIFORNIA DUE DAYS                               *
 13819*--------------------------------------------------------------*
 13820
 13821     IF CL-TOTAL-PAID-AMT > ZEROS
 13822         MOVE 'Y' TO WS-ELIMINATION-SW
 13823         GO TO 3240-FIRST-PMT-DUE
 13824     ELSE
 13825        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13826            NEXT SENTENCE
 13827        ELSE
 13828            GO TO 3240-FIRST-PMT-DUE.
 13829
 13830 3230-NEXT-PMT-DUE.
 13831
 13832     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13833     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13834     IF NO-CONVERSION-ERROR
 13835         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13836         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13837     ELSE
 13838         GO TO 3290-ERROR.
 13839
 13840 3240-FIRST-PMT-DUE.
 13841
 13842     IF CL-TOTAL-PAID-AMT > ZEROS
 13843         NEXT SENTENCE
 13844     ELSE
 13845        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13846            GO TO 3230-NEXT-PMT-DUE.
 13847
 13848     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13849         GO TO 3250-VERIFY-ELIMINATION.
 13850
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 264
* EL156.cbl
 13851     ADD +30 TO WS-CDAYS.
 13852     MOVE 'Y' TO WS-ELIMINATION-SW.
 13853     GO TO 3230-NEXT-PMT-DUE.
 13854
 13855 3250-VERIFY-ELIMINATION.
 13856
 13857     IF ELIM-SATISFIED
 13858         GO TO 3260-END-CALC.
 13859
 13860     IF PI-PMTTYPE = '1'
 13861         MOVE ZEROS TO WS-CDAYS
 13862         GO TO 3260-END-CALC.
 13863
 13864     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13865         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13866     ELSE
 13867         IF CL-TOTAL-PAID-AMT > ZEROS
 13868             IF WS-SV-EPYFROM = LOW-VALUES
 13869                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13870             ELSE
 13871                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13872         ELSE
 13873             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13874
 13875     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13876     MOVE '1'                    TO DC-OPTION-CODE.
 13877     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13878     IF NO-CONVERSION-ERROR
 13879         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13880     ELSE
 13881         GO TO 3290-ERROR.
 13882
 13883     IF CL-TOTAL-PAID-AMT > ZEROS
 13884         MOVE WS-DAYS-OFF TO WS-CDAYS
 13885     ELSE
 13886         IF PI-BEN-DAYS > WS-DAYS-OFF
 13887             MOVE ZEROS TO WS-CDAYS
 13888         ELSE
 13889             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13890
 13891 3260-END-CALC.
 13892
 13893     MOVE WS-CDAYS TO PI-CDAYS.
 13894
 13895     IF PI-EDAYS = ZEROS
 13896         MOVE PI-CDAYS TO PI-EDAYS
 13897         MOVE AL-UNNON TO EDAYSA.
 13898
 13899     GO TO 3299-EXIT.
 13900
 13901 3290-ERROR.
 13902
 13903     MOVE ER-3528            TO EMI-ERROR.
 13904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13905     MOVE -1                 TO CDAYSL.
 13906     MOVE AL-UNBON           TO CDAYSA.
 13907
 13908 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 265
* EL156.cbl
 13909     EXIT.
 13910
 13911 3300-BUMP-DATE.
 13912
 13913     IF WS-RESTORE-DUE-DAY
 13914         MOVE 'N'              TO WS-DUE-DAY-SW
 13915         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13916         ADD 1                 TO WS-PMT-DUE-MO
 13917         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13918         MOVE '4'              TO DC-OPTION-CODE
 13919         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13920         IF NO-CONVERSION-ERROR
 13921             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13922             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13923             GO TO 3399-EXIT
 13924         ELSE
 13925             MOVE '9'          TO DC-ERROR-CODE
 13926             GO TO 3399-EXIT.
 13927
 13928     IF (WS-PMT-DUE-MO = 1) AND
 13929        (WS-SAVE-DUE-DA > 28)
 13930           MOVE 'Y' TO WS-DUE-DAY-SW.
 13931
 13932     MOVE +0                 TO DC-ELAPSED-DAYS.
 13933     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13934     MOVE '6'                TO DC-OPTION-CODE.
 13935     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13936
 13937 3399-EXIT.
 13938     EXIT.
 13939
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 266
* EL156.cbl
 13941 3400-COMPUTE-EXPIRY.
 13942
 13943     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13944     MOVE +0                    TO DC-ELAPSED-DAYS
 13945                                   DC-ODD-DAYS-OVER.
 13946     MOVE '1'                   TO DC-END-OF-MONTH.
 13947     MOVE '6'                   TO DC-OPTION-CODE.
 13948
 13949     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13950         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13951     ELSE
 13952         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13953
 13954     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13955     IF NO-CONVERSION-ERROR
 13956         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13957     ELSE
 13958         GO TO 3390-CONTINUE.
 13959
 13960     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13961         GO TO 3390-CONTINUE.
 13962
 13963     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13964     MOVE '4'                    TO CNTL-REC-TYPE.
 13965     MOVE +0                     TO CNTL-SEQ-NO.
 13966     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13967     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13968     MOVE 'BENE'                 TO FILE-SWITCH.
 13969
 13970     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13971
 13972     IF NO-BENEFIT-FOUND
 13973         GO TO 3390-CONTINUE.
 13974
 13975     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13976        IF (PI-OFFLINE = 'Y') OR
 13977           (PI-PMTTYPE = '7')
 13978           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13979                                     THRU 9870-EXIT
 13980           IF ERROR-ON-OUTPUT
 13981             MOVE -1                 TO ENTERPFL
 13982             MOVE AL-UANON           TO ENTERPFA
 13983             MOVE MAP-NAMEA          TO MAP-NAME
 13984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985             GO TO 8200-SEND-DATAONLY.
 13986
 13987     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13988        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13989        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13990          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13991          MOVE +0        TO DC-ELAPSED-DAYS
 13992          MOVE +1        TO DC-ELAPSED-MONTHS
 13993          MOVE 6         TO DC-OPTION-CODE
 13994          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13995          IF NO-CONVERSION-ERROR
 13996              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13997
 13998 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 267
* EL156.cbl
 13999
 14000      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14001         MOVE CM-AH-LOAN-EXPIRE-DT
 14002                                 TO DC-BIN-DATE-1
 14003      ELSE
 14004         MOVE CM-LF-LOAN-EXPIRE-DT
 14005                                 TO DC-BIN-DATE-1
 14006      END-IF
 14007
 14008      MOVE ' '                    TO DC-OPTION-CODE.
 14009      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14010      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14011      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14012
 14013 3499-EXIT.
 14014     EXIT.
 14015
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 268
* EL156.cbl
 14017
 14018 3600-CHECK-VERIFICATION.
 14019
 14020     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14021
 14022     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14023
 14024     IF PI-PAYEE-TYPE = 'I'
 14025        GO TO 3600-READ-TRAILER.
 14026
 14027     IF PI-PAYEE-TYPE = 'B'
 14028        ADD +10                  TO TRLR-SEQ-NO
 14029        GO TO 3600-READ-TRAILER.
 14030
 14031     IF PI-PAYEE-TYPE = 'A'
 14032        ADD +20                  TO TRLR-SEQ-NO
 14033        GO TO 3600-READ-TRAILER.
 14034
 14035     IF PI-PAYEE-TYPE = 'O'
 14036        ADD +50                  TO TRLR-SEQ-NO
 14037        GO TO 3600-READ-TRAILER.
 14038
 14039     IF PI-PAYEE-TYPE = 'Q'
 14040        ADD +60                  TO TRLR-SEQ-NO
 14041        GO TO 3600-READ-TRAILER.
 14042
 14043     IF PI-PAYEE-TYPE = 'P'
 14044        ADD +30                  TO TRLR-SEQ-NO
 14045        GO TO 3600-READ-TRAILER.
 14046
 14047     IF PI-PAYEE-TYPE = 'E'
 14048        ADD +40                  TO TRLR-SEQ-NO.
 14049
 14050 3600-READ-TRAILER.
 14051
 14052
 14053* EXEC CICS HANDLE CONDITION
 14054*         NOTFND(3600-CONTINUE)
 14055*    END-EXEC.
 14056*    MOVE '"$I                   ! - #00013274' TO DFHEIV0
 14057     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14059     MOVE X'2D20233030303133323734' TO DFHEIV0(25:11)
 14060     CALL 'kxdfhei1' USING DFHEIV0
 14061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14062
 14063
 14064     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14065
 14066 3600-CONTINUE.
 14067
 14068     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14069         GO TO 3600-AH-VERIFY
 14070     END-IF.
 14071
 14072     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14073       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14074         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 269
* EL156.cbl
 14075           MOVE ER-7576            TO EMI-ERROR
 14076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077           MOVE -1                 TO PAYEEL
 14078           MOVE AL-UABON           TO PAYEEA
 14079           GO TO 3600-EXIT
 14080         END-IF
 14081       END-IF
 14082     END-IF.
 14083
 14084     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14085     MOVE 1 TO WS-SUB2
 14086     MOVE SPACES TO WS-PAYEE-NAME
 14087     PERFORM VARYING WS-SUB FROM 1 BY 1
 14088             UNTIL WS-SUB > 30
 14089         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14090            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14091                 WS-PAYEE-NAME-X (WS-SUB2)
 14092            ADD +1 TO WS-SUB2
 14093         END-IF
 14094     END-PERFORM.
 14095
 14096     STRING CL-INSURED-1ST-NAME
 14097            CL-INSURED-MID-INIT
 14098            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14099     MOVE 1 TO WS-SUB2
 14100     MOVE SPACES TO WS-INSURED-NAME
 14101     PERFORM VARYING WS-SUB FROM 1 BY 1
 14102             UNTIL WS-SUB > 30
 14103         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14104            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14105                 WS-INSURED-NAME-X (WS-SUB2)
 14106            ADD +1 TO WS-SUB2
 14107         END-IF
 14108     END-PERFORM.
 14109
 14110     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14111        MOVE ER-7579            TO EMI-ERROR
 14112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113        MOVE -1                 TO PAYEEL
 14114        MOVE AL-UABON           TO PAYEEA
 14115     END-IF.
 14116
 14117     IF PI-PMTTYPE = '4'  AND
 14118        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14119        PI-PAYEE-TYPE <> 'I'
 14120          MOVE ER-7580          TO EMI-ERROR
 14121          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14122          MOVE -1               TO PAYEEL
 14123          MOVE AL-UABON         TO PAYEEA
 14124     END-IF.
 14125
 14126     GO TO 3600-EXIT.
 14127
 14128 3600-AH-VERIFY.
 14129
 14130     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14131        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14132           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 270
* EL156.cbl
 14133           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14134           MOVE -1                 TO PAYEEL
 14135           MOVE AL-UABON           TO PAYEEA
 14136        END-IF
 14137     END-IF.
 14138
 14139
 14140 3600-EXIT.
 14141     EXIT.
 14142
 14143 5000-UPDATE.
 14144
 14145     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14146
 14147     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14148
 14149     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14150        PI-OFFLINE = 'Y'
 14151        NEXT SENTENCE
 14152     ELSE
 14153        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14154
 14155*    IF PI-COMPANY-ID = 'CRI'
 14156*       IF PI-PMTTYPE = '1' OR  '2'
 14157*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14158*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14159*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14160
 14161*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14162*       IF PI-PMTTYPE = '1'
 14163*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14164*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14165
 14166     IF PI-PMTTYPE      = '2' AND
 14167        PI-SPLIT-PMT-SW = 'Y' AND
 14168        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14169          MOVE ER-3530                TO EMI-ERROR
 14170          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14171
 14172     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14173        AND (CL-CLAIM-TYPE = 'L')
 14174        IF PI-PMTTYPE = '2' OR '4'
 14175           IF PI-INT-AMT NOT = ZEROS
 14176              PERFORM 7110-BUILD-PMT-TRLR
 14177                                 THRU 7130-EXIT
 14178           ELSE
 14179              IF PI-PMTTYPE = '2'
 14180                 PERFORM 7140-BUILD-NOTE-TRLR
 14181                                 THRU 7170-EXIT
 14182              END-IF
 14183           END-IF
 14184        END-IF
 14185     END-IF
 14186*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14187*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14188*            MOVE 'N'                 TO  WS-LETTER-SW.
 14189
 14190*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 271
* EL156.cbl
 14191*        IF CL-NO-OF-PMTS-MADE = +1
 14192*                OR
 14193*           PI-PMTTYPE = '2'
 14194*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14195
 14196     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14197
 14198*    IF PI-COMPANY-ID = 'DMD'
 14199*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14200*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14201
 14202
 14203* EXEC CICS REWRITE
 14204*         DATASET('ELMSTR')
 14205*         FROM(CLAIM-MASTER)
 14206*     END-EXEC.
 14207     MOVE LENGTH OF
 14208      CLAIM-MASTER
 14209       TO DFHEIV11
 14210     MOVE 'ELMSTR' TO DFHEIV1
 14211*    MOVE '&& L                  %   #00013416' TO DFHEIV0
 14212     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14213     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14214     MOVE X'2020233030303133343136' TO DFHEIV0(25:11)
 14215     CALL 'kxdfhei1' USING DFHEIV0,
 14216           DFHEIV1,
 14217           CLAIM-MASTER,
 14218           DFHEIV11,
 14219           DFHEIV99
 14220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14221
 14222
 14223     IF WS-LETTER-SW = 'N'
 14224         GO TO 5000-END-UPDATE.
 14225
 14226 5000-GENERATE-AUTO-LETTER.
 14227
 14228
 14229* EXEC CICS LINK
 14230*        PROGRAM    (LINK-1523)
 14231*        COMMAREA   (W-1523-LINKDATA)
 14232*        LENGTH     (W-1523-COMM-LENGTH)
 14233*    END-EXEC.
 14234*    MOVE '."C                   (   #00013426' TO DFHEIV0
 14235     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14237     MOVE X'2020233030303133343236' TO DFHEIV0(25:11)
 14238     CALL 'kxdfhei1' USING DFHEIV0,
 14239           LINK-1523,
 14240           W-1523-LINKDATA,
 14241           W-1523-COMM-LENGTH,
 14242           DFHEIV99,
 14243           DFHEIV99,
 14244           DFHEIV99,
 14245           DFHEIV99
 14246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14247
 14248
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 272
* EL156.cbl
 14249     IF W-1523-FATAL-ERROR
 14250         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14252         MOVE ER-0802                TO  EMI-ERROR
 14253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14254
 14255     IF W-1523-ERROR-CODE = 0191
 14256         MOVE ER-0803                TO  EMI-ERROR
 14257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     IF PI-COMPANY-ID      = 'HAN' AND
 14260        PI-PMTTYPE         = '1'   AND
 14261        PI-3RD-PARTY-SW    = 'Y'   AND
 14262        W-1523-FORM-NUMBER = 'EOB1'
 14263           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14264           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14265           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14266           GO TO 5000-GENERATE-AUTO-LETTER.
 14267
 14268 5000-END-UPDATE.
 14269
 14270     MOVE ER-0000                TO EMI-ERROR.
 14271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14272     GO TO 7000-SHOW-CLAIM.
 14273
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 273
* EL156.cbl
 14275 5000-MOVE-NAME.
 14276     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14277     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14278     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14279
 14280 5000-EXIT.
 14281     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 274
* EL156.cbl
 14283 5300-CREATE-DMO.
 14284
 14285     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14286     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14287     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14288
 14289
 14290* EXEC CICS HANDLE CONDITION
 14291*         NOTFND   (5300-NOTE-NOT-FOUND)
 14292*    END-EXEC.
 14293*    MOVE '"$I                   ! . #00013472' TO DFHEIV0
 14294     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14296     MOVE X'2E20233030303133343732' TO DFHEIV0(25:11)
 14297     CALL 'kxdfhei1' USING DFHEIV0
 14298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14299
 14300
 14301
 14302* EXEC CICS READ
 14303*         DATASET('ERNOTE')
 14304*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14305*         RIDFLD (W-NOTE-KEY)
 14306*    END-EXEC.
 14307     MOVE 'ERNOTE' TO DFHEIV1
 14308*    MOVE '&"S        E          (   #00013476' TO DFHEIV0
 14309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14311     MOVE X'2020233030303133343736' TO DFHEIV0(25:11)
 14312     CALL 'kxdfhei1' USING DFHEIV0,
 14313           DFHEIV1,
 14314           DFHEIV20,
 14315           DFHEIV99,
 14316           W-NOTE-KEY,
 14317           DFHEIV99,
 14318           DFHEIV99,
 14319           DFHEIV99
 14320     SET ADDRESS OF CERTIFICATE-NOTE TO
 14321         DFHEIV20
 14322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14323
 14324
 14325     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14326     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14327     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14328
 14329     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14330         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14331     ELSE
 14332         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14333
 14334     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14335     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14336     MOVE 'DLO006'               TO PGM-NAME.
 14337
 14338
 14339* EXEC CICS LINK
 14340*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 275
* EL156.cbl
 14341*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14342*        LENGTH     (DCT-RCRD-LENGTH)
 14343*    END-EXEC.
 14344*    MOVE '."C                   (   #00013495' TO DFHEIV0
 14345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14347     MOVE X'2020233030303133343935' TO DFHEIV0(25:11)
 14348     CALL 'kxdfhei1' USING DFHEIV0,
 14349           PGM-NAME,
 14350           DCT-COMMUNICATION-AREA,
 14351           DCT-RCRD-LENGTH,
 14352           DFHEIV99,
 14353           DFHEIV99,
 14354           DFHEIV99,
 14355           DFHEIV99
 14356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14357
 14358
 14359     IF DCT-RETURN-CODE = 'OK'
 14360         GO TO 5300-CONT.
 14361
 14362     IF DCT-RETURN-CODE = '01' OR '02'
 14363         GO TO 5300-EXIT.
 14364
 14365     IF DCT-RETURN-CODE = '03'
 14366         MOVE ER-0951            TO EMI-ERROR
 14367         GO TO 5300-BAD-EXIT.
 14368
 14369     IF DCT-RETURN-CODE = '04'
 14370         MOVE ER-0946            TO EMI-ERROR
 14371         GO TO 5300-BAD-EXIT.
 14372
 14373     IF DCT-RETURN-CODE = '05'
 14374         MOVE ER-0947            TO EMI-ERROR
 14375         GO TO 5300-BAD-EXIT.
 14376
 14377     IF DCT-RETURN-CODE = '06'
 14378         MOVE ER-0921            TO EMI-ERROR
 14379         GO TO 5300-BAD-EXIT.
 14380
 14381     IF DCT-RETURN-CODE = '07'
 14382         MOVE ER-0849            TO EMI-ERROR
 14383         GO TO 5300-BAD-EXIT.
 14384
 14385     IF DCT-RETURN-CODE = '08'
 14386         MOVE ER-0948            TO EMI-ERROR
 14387         GO TO 5300-BAD-EXIT.
 14388
 14389     IF DCT-RETURN-CODE = 'N1'
 14390         MOVE ER-0950            TO EMI-ERROR
 14391         GO TO 5300-BAD-EXIT.
 14392
 14393     IF DCT-RETURN-CODE = 'E1'
 14394         MOVE ER-0974            TO EMI-ERROR
 14395         GO TO 5300-BAD-EXIT.
 14396
 14397     IF DCT-RETURN-CODE = 'E2'
 14398         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 276
* EL156.cbl
 14399         GO TO 5300-BAD-EXIT.
 14400
 14401     IF DCT-RETURN-CODE NOT = 'OK'
 14402         MOVE ER-0949            TO EMI-ERROR
 14403         GO TO 5300-BAD-EXIT.
 14404
 14405 5300-CONT.
 14406
 14407     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14408     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14409     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14410     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14411     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14412     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14413     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14414     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14415
 14416     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14417     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14418     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14419     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14420     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14421
 14422     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14423
 14424     IF PI-PMTTYPE = '2'
 14425         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14426         MOVE '4'                TO DM-CLAIM-STATUS
 14427     ELSE
 14428         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14429         MOVE '2'                TO DM-CLAIM-STATUS.
 14430
 14431     MOVE 'DLO025'               TO PGM-NAME.
 14432
 14433
 14434* EXEC CICS LINK
 14435*        PROGRAM    (PGM-NAME)
 14436*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14437*        LENGTH     (DM-DMO-LENGTH)
 14438*    END-EXEC.
 14439*    MOVE '."C                   (   #00013575' TO DFHEIV0
 14440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14442     MOVE X'2020233030303133353735' TO DFHEIV0(25:11)
 14443     CALL 'kxdfhei1' USING DFHEIV0,
 14444           PGM-NAME,
 14445           DMO-COMMUNICATION-AREA,
 14446           DM-DMO-LENGTH,
 14447           DFHEIV99,
 14448           DFHEIV99,
 14449           DFHEIV99,
 14450           DFHEIV99
 14451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14452
 14453
 14454     IF DM-RETURN-CODE = 'OK'
 14455         GO TO 5300-EXIT.
 14456
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 277
* EL156.cbl
 14457     IF DM-RETURN-CODE = '01'
 14458         MOVE ER-8051            TO EMI-ERROR
 14459         GO TO 5300-BAD-EXIT.
 14460
 14461     IF DM-RETURN-CODE = '02'
 14462         MOVE ER-8052            TO EMI-ERROR
 14463         GO TO 5300-BAD-EXIT.
 14464
 14465     IF DM-RETURN-CODE = '03'
 14466         MOVE ER-8053            TO EMI-ERROR
 14467         GO TO 5300-BAD-EXIT.
 14468
 14469     IF DM-RETURN-CODE = '04'
 14470         MOVE ER-8054            TO EMI-ERROR
 14471         GO TO 5300-BAD-EXIT.
 14472
 14473     IF DM-RETURN-CODE = '05'
 14474         MOVE ER-8055            TO EMI-ERROR
 14475         GO TO 5300-BAD-EXIT.
 14476
 14477     IF DM-RETURN-CODE = '06'
 14478         MOVE ER-8056            TO EMI-ERROR
 14479         GO TO 5300-BAD-EXIT.
 14480
 14481     IF DM-RETURN-CODE = '07'
 14482         MOVE ER-8057            TO EMI-ERROR
 14483         GO TO 5300-BAD-EXIT.
 14484
 14485     IF DM-RETURN-CODE = '08'
 14486         MOVE ER-8058            TO EMI-ERROR
 14487         GO TO 5300-BAD-EXIT.
 14488
 14489     IF DM-RETURN-CODE = '09'
 14490         MOVE ER-8059            TO EMI-ERROR
 14491         GO TO 5300-BAD-EXIT.
 14492
 14493     IF DM-RETURN-CODE = '10'
 14494         MOVE ER-8060            TO EMI-ERROR
 14495         GO TO 5300-BAD-EXIT.
 14496
 14497     IF DM-RETURN-CODE = '11'
 14498         MOVE ER-8061            TO EMI-ERROR
 14499         GO TO 5300-BAD-EXIT.
 14500
 14501     IF DM-RETURN-CODE = '12'
 14502         MOVE ER-8062            TO EMI-ERROR
 14503         GO TO 5300-BAD-EXIT.
 14504
 14505     IF DM-RETURN-CODE = '13'
 14506         MOVE ER-8063            TO EMI-ERROR
 14507         GO TO 5300-BAD-EXIT.
 14508
 14509     IF DM-RETURN-CODE = '14'
 14510         MOVE ER-8064            TO EMI-ERROR
 14511         GO TO 5300-BAD-EXIT.
 14512
 14513     IF DM-RETURN-CODE = '15'
 14514         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 278
* EL156.cbl
 14515         GO TO 5300-BAD-EXIT.
 14516
 14517     IF DM-RETURN-CODE = '16'
 14518         MOVE ER-8154            TO EMI-ERROR
 14519         GO TO 5300-BAD-EXIT.
 14520
 14521     IF DM-RETURN-CODE = '17'
 14522         MOVE ER-8155            TO EMI-ERROR
 14523         GO TO 5300-BAD-EXIT.
 14524
 14525     IF DM-RETURN-CODE = 'N1'
 14526         MOVE ER-8152            TO EMI-ERROR
 14527         GO TO 5300-BAD-EXIT.
 14528
 14529     IF DM-RETURN-CODE = 'E1'
 14530         MOVE ER-8153            TO EMI-ERROR
 14531         GO TO 5300-BAD-EXIT.
 14532
 14533     MOVE ER-8066            TO EMI-ERROR.
 14534     GO TO 5300-BAD-EXIT.
 14535
 14536 5300-NOTE-NOT-FOUND.
 14537
 14538     MOVE ER-0954                TO EMI-ERROR.
 14539     GO TO 5300-BAD-EXIT.
 14540
 14541 5300-BAD-EXIT.
 14542
 14543* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14544*    MOVE '6"R                   !   #00013669' TO DFHEIV0
 14545     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14547     MOVE X'2020233030303133363639' TO DFHEIV0(25:11)
 14548     CALL 'kxdfhei1' USING DFHEIV0
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14550
 14551     IF MAP-NAME = 'EL156A'
 14552         MOVE -1             TO ENTERPFL
 14553       ELSE
 14554         MOVE LOW-VALUES     TO EL156BI
 14555         MOVE -1             TO ENTPFBL.
 14556
 14557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14558     GO TO 8200-SEND-DATAONLY.
 14559
 14560 5300-EXIT.
 14561     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 279
* EL156.cbl
 14563 5350-FORMAT-LAST-NAME-1ST.
 14564*****************************************************************
 14565*             M O V E   N A M E   R O U T I N E                 *
 14566*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14567*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14568*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14569*                  FIELD                   VALUE                *
 14570*           W-NAME-LAST    (CL15)      SMITH                    *
 14571*           W-NAME-FIRST   (CL15)      JOHN                     *
 14572*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14573*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14574*     CONTAIN                                                   *
 14575*                SMITH, JOHN ALLEN                              *
 14576*     OR                                                        *
 14577*                SMITH, JOHN A.                                 *
 14578*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14579*     COPYBOOK, ELCNWA.                                         *
 14580*****************************************************************.
 14581
 14582     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14583     MOVE ZERO                   TO  WS-NAME-SW.
 14584     SET NWA-INDEX               TO +1.
 14585
 14586     IF W-NAME-LAST   = SPACES AND
 14587        W-NAME-MIDDLE = SPACES
 14588         MOVE +1                 TO WS-NAME-SW.
 14589
 14590     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14591     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14592
 14593     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14594     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14595
 14596     SET NWA-INDEX UP BY +1.
 14597
 14598     IF W-NAME-MIDDLE NOT = SPACES
 14599         IF W-NAME-MIDDLE-2 = SPACES
 14600             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14601             SET NWA-INDEX UP BY +1
 14602             MOVE '.'            TO WS-NW (NWA-INDEX)
 14603             SET NWA-INDEX UP BY +2
 14604         ELSE
 14605             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14606             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14607
 14608 5350-EXIT.
 14609     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 280
* EL156.cbl
 14611 5360-MOVE-NAME.
 14612
 14613     IF WS-NAME-SW > +1
 14614         GO TO 5360-EXIT.
 14615
 14616     IF WS-NAME-WORK2 = SPACES
 14617         GO TO 5360-EXIT.
 14618
 14619     SET NWA-INDEX2            TO +1.
 14620     SET NWA-INDEX3            TO +2.
 14621
 14622 5360-MOVE-NAME-CYCLE.
 14623
 14624     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14625
 14626     IF NWA-INDEX < +30
 14627         SET NWA-INDEX UP BY +1
 14628     ELSE
 14629         ADD +2                TO  WS-NAME-SW
 14630         GO TO 5360-EXIT.
 14631
 14632     IF NWA-INDEX2 < +20
 14633         SET NWA-INDEX3 UP BY +1
 14634         SET NWA-INDEX2 UP BY +1.
 14635
 14636     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14637        WS-NW2 (NWA-INDEX3) = SPACES
 14638         IF WS-NAME-SW = ZERO
 14639             MOVE ','            TO  WS-NW (NWA-INDEX)
 14640             SET NWA-INDEX UP BY +2
 14641             MOVE +1             TO  WS-NAME-SW
 14642             GO TO 5360-EXIT
 14643         ELSE
 14644             GO TO 5360-EXIT.
 14645
 14646     GO TO 5360-MOVE-NAME-CYCLE.
 14647
 14648 5360-EXIT.
 14649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 281
* EL156.cbl
 14651 6000-BUILD-SCREEN-B.
 14652     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14653     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14654     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14655     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14656
 14657     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14658
 14659 6050-BUILD-SCREEN.
 14660     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14661     MOVE LOW-VALUES             TO EL156BI.
 14662     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14663
 14664     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14665
 14666     IF PI-PAYEE-TYPE = 'I'
 14667        GO TO 6060-READ-TRAILER.
 14668
 14669     IF PI-PAYEE-TYPE = 'B'
 14670        ADD +10                  TO TRLR-SEQ-NO
 14671        GO TO 6060-READ-TRAILER.
 14672
 14673     IF PI-PAYEE-TYPE = 'A'
 14674        ADD +20                  TO TRLR-SEQ-NO
 14675        GO TO 6060-READ-TRAILER.
 14676
 14677     IF PI-PAYEE-TYPE = 'O'
 14678        ADD +50                  TO TRLR-SEQ-NO
 14679        GO TO 6060-READ-TRAILER.
 14680
 14681     IF PI-PAYEE-TYPE = 'Q'
 14682        ADD +60                  TO TRLR-SEQ-NO
 14683        GO TO 6060-READ-TRAILER.
 14684
 14685     IF PI-PAYEE-TYPE = 'P'
 14686        ADD +30                  TO TRLR-SEQ-NO
 14687        GO TO 6060-READ-TRAILER.
 14688
 14689     IF PI-PAYEE-TYPE = 'E'
 14690        ADD +40                  TO TRLR-SEQ-NO.
 14691
 14692 6060-READ-TRAILER.
 14693
 14694     IF PI-PAYEE-TYPE    = 'A' AND
 14695        PI-PAYEE-SEQ-NUM = 0
 14696          GO TO 6061-READ-ACCOUNT.
 14697
 14698     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14699        (PI-PAYEE-TYPE    = 'B')             AND
 14700        (PI-PAYEE-SEQ-NUM = 9)
 14701          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14702          IF BENE-FOUND-SW = 'N'
 14703            GO TO 6065-NOT-FOUND
 14704          ELSE
 14705            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14706            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14707            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14708*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 282
* EL156.cbl
 14709            STRING BE-CITY ' ' BE-STATE
 14710               DELIMITED BY '  ' INTO CITYSTBO
 14711            END-STRING
 14712            MOVE BE-ZIP-CODE       TO ZIPBO
 14713            GO TO 6061-READ-ACCOUNT.
 14714
 14715     IF PI-PAYEE-TYPE    = 'B' AND
 14716        PI-PAYEE-SEQ-NUM = 0
 14717          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14718          IF BENE-FOUND-SW = 'N'
 14719            GO TO 6065-NOT-FOUND
 14720          ELSE
 14721            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14722            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14723            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14724*           MOVE BE-CITY-STATE     TO CITYSTBO
 14725            STRING BE-CITY ' ' BE-STATE
 14726               DELIMITED BY '  ' INTO CITYSTBO
 14727            END-STRING
 14728            MOVE BE-ZIP-CODE       TO ZIPBO
 14729            GO TO 6061-READ-ACCOUNT.
 14730
 14731
 14732* EXEC CICS HANDLE CONDITION
 14733*         NOTFND(6065-NOT-FOUND)
 14734*     END-EXEC.
 14735*    MOVE '"$I                   ! / #00013850' TO DFHEIV0
 14736     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14738     MOVE X'2F20233030303133383530' TO DFHEIV0(25:11)
 14739     CALL 'kxdfhei1' USING DFHEIV0
 14740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14741
 14742
 14743     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14744
 14745     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14746     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14747     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14748     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14749*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14750     STRING AT-CITY ' ' AT-STATE
 14751        DELIMITED BY '  ' INTO CITYSTBO
 14752     END-STRING
 14753     MOVE AT-ZIP-CODE            TO ZIPBO.
 14754
 14755 6061-READ-ACCOUNT.
 14756
 14757* EXEC CICS HANDLE CONDITION
 14758*         NOTFND(6068-ACCT-NOT-FND)
 14759*     END-EXEC.
 14760*    MOVE '"$I                   ! 0 #00013867' TO DFHEIV0
 14761     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14763     MOVE X'3020233030303133383637' TO DFHEIV0(25:11)
 14764     CALL 'kxdfhei1' USING DFHEIV0
 14765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14766
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 283
* EL156.cbl
 14767
 14768
 14769* EXEC CICS READ
 14770*         DATASET('ERACCT')
 14771*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14772*         RIDFLD (PI-ACCT-KEY)
 14773*     END-EXEC.
 14774     MOVE 'ERACCT' TO DFHEIV1
 14775*    MOVE '&"S        E          (   #00013871' TO DFHEIV0
 14776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14778     MOVE X'2020233030303133383731' TO DFHEIV0(25:11)
 14779     CALL 'kxdfhei1' USING DFHEIV0,
 14780           DFHEIV1,
 14781           DFHEIV20,
 14782           DFHEIV99,
 14783           PI-ACCT-KEY,
 14784           DFHEIV99,
 14785           DFHEIV99,
 14786           DFHEIV99
 14787     SET ADDRESS OF ACCOUNT-MASTER TO
 14788         DFHEIV20
 14789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14790
 14791
 14792     MOVE AM-CARRIER             TO ACARRBO.
 14793     MOVE AM-GROUPING            TO GROUPBO.
 14794     MOVE AM-STATE               TO STATEBO.
 14795     MOVE AM-ACCOUNT             TO ACCTBO.
 14796     MOVE AM-NAME                TO ACCTNMBO.
 14797
 14798     IF PI-PAYEE-TYPE = 'A' AND
 14799        PI-PAYEE-SEQ-NUM = 0
 14800          MOVE AM-NAME             TO NAMEBO
 14801                                      PI-PAYEE-NAME
 14802          MOVE AM-ADDRS            TO ADDR1BO
 14803          MOVE SPACES              TO ADDR2BO
 14804*         MOVE AM-CITY             TO CITYSTBO
 14805          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14806             DELIMITED BY '  ' INTO CITYSTBO
 14807          END-STRING
 14808          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14809          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14810          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14811          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14812
 14813     IF CITYSTBO EQUAL SPACES
 14814         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14815         GO TO 6070-FORMAT-DATA
 14816     END-IF.
 14817
 14818     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14819     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14820     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14821     PERFORM VARYING WS-SUB FROM 30 BY -1
 14822          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14823        IF WS-END-SUB = 0  AND
 14824           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 284
* EL156.cbl
 14825              OR LOW-VALUES  OR '.')
 14826            CONTINUE
 14827        ELSE
 14828            IF WS-END-SUB = 0
 14829                MOVE WS-SUB TO WS-END-SUB
 14830            ELSE
 14831                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14832                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14833                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14834                END-IF
 14835            END-IF
 14836        END-IF
 14837        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14838            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14839            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14840        END-IF
 14841     END-PERFORM.
 14842
 14843     IF WS-BEG-SUB > 0
 14844         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14845         IF WS-STATE-LENGTH = 2
 14846             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14847                  TO PI-CHECK-STATE-FOR-AK
 14848         ELSE
 14849             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14850                'ALASKA'
 14851                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14852             ELSE
 14853                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14854             END-IF
 14855         END-IF
 14856     ELSE
 14857         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14858     END-IF.
 14859
 14860     GO TO 6070-FORMAT-DATA.
 14861
 14862 6065-NOT-FOUND.
 14863     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14864     GO TO 6061-READ-ACCOUNT.
 14865
 14866 6068-ACCT-NOT-FND.
 14867     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14868
 14869 6070-FORMAT-DATA.
 14870     IF PI-HOLDTIL = ZEROS
 14871        MOVE SAVE-DATE           TO PAYDTBI
 14872       ELSE
 14873        MOVE PI-HOLDTIL          TO PAYDTBO
 14874        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14875
 14876     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14877     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14878
 14879     IF EIBAID = DFHPF3 OR DFHPF4
 14880        NEXT SENTENCE
 14881     ELSE
 14882       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 285
* EL156.cbl
 14883
 14884     MOVE PI-EPYFROM          TO PYFROMBO.
 14885     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14886
 14887     IF NOT PI-USES-PAID-TO
 14888        MOVE PI-EPYTHRU          TO PYTHRUBO
 14889        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14890     ELSE
 14891        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14892        MOVE '4'              TO DC-OPTION-CODE
 14893        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14894        IF NO-CONVERSION-ERROR
 14895           MOVE +1            TO DC-ELAPSED-DAYS
 14896           MOVE +0            TO DC-ELAPSED-MONTHS
 14897           MOVE '6'           TO DC-OPTION-CODE
 14898           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14899           IF NO-CONVERSION-ERROR
 14900              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14901
 14902     MOVE PI-EDAYS            TO DAYSBO.
 14903     MOVE PI-EPYAMT           TO PAYAMTBO.
 14904     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14905        IF PI-INT-AMT > ZEROS
 14906           MOVE PI-INT-AMT       TO INTAMTBO
 14907        END-IF
 14908     END-IF
 14909     GO TO 6072-SET-TYPE.
 14910
 14911 6071-CONTINUE.
 14912
 14913     IF PI-CPYFROM NOT = LOW-VALUES
 14914        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14915        MOVE SPACES              TO DC-OPTION-CODE
 14916        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14917        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14918
 14919     IF PI-CPYTHRU NOT = LOW-VALUES
 14920        IF NOT PI-USES-PAID-TO
 14921           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14922           MOVE SPACES             TO DC-OPTION-CODE
 14923           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14924           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14925        ELSE
 14926           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14927           MOVE '6'                TO DC-OPTION-CODE
 14928           MOVE +1                 TO DC-ELAPSED-DAYS
 14929           MOVE +0                 TO DC-ELAPSED-MONTHS
 14930           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14931           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14932
 14933     MOVE PI-CDAYS               TO DAYSBO.
 14934     MOVE PI-CPYAMT              TO PAYAMTBO.
 14935     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14936        IF PI-INT-AMT > ZEROS
 14937           MOVE PI-INT-AMT       TO INTAMTBO
 14938        END-IF
 14939     END-IF
 14940     .
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 286
* EL156.cbl
 14941 6072-SET-TYPE.
 14942     IF PI-PMTTYPE = '1'
 14943        MOVE 'PARTIAL'           TO PAYTYPBO.
 14944
 14945     IF PI-PMTTYPE = '2'
 14946        MOVE 'FINAL'             TO PAYTYPBO.
 14947
 14948     IF PI-PMTTYPE = '3'
 14949        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14950
 14951     IF PI-PMTTYPE = '4'
 14952        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14953
 14954     IF PI-PMTTYPE = '5'
 14955        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14956
 14957     IF PI-PMTTYPE = '6'
 14958        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14959
 14960     IF PI-PROV-PMT
 14961        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14962
 14963     IF PI-ECHECKNO NOT = SPACES
 14964        MOVE PI-ECHECKNO         TO CKNUMBO
 14965     ELSE
 14966        MOVE PI-CCHECKNO         TO CKNUMBO.
 14967
 14968     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14969        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14970        MOVE +91                 TO  TRLR-SEQ-NO
 14971
 14972* EXEC CICS READ
 14973*           DATASET  ('ELTRLR')
 14974*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14975*           RIDFLD   (ELTRLR-KEY)
 14976*           RESP     (WS-RESPONSE)
 14977*       END-EXEC
 14978     MOVE 'ELTRLR' TO DFHEIV1
 14979*    MOVE '&"S        E          (  N#00014056' TO DFHEIV0
 14980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14982     MOVE X'204E233030303134303536' TO DFHEIV0(25:11)
 14983     CALL 'kxdfhei1' USING DFHEIV0,
 14984           DFHEIV1,
 14985           DFHEIV20,
 14986           DFHEIV99,
 14987           ELTRLR-KEY,
 14988           DFHEIV99,
 14989           DFHEIV99,
 14990           DFHEIV99
 14991     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14992         DFHEIV20
 14993     MOVE EIBRESP  TO WS-RESPONSE
 14994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14995
 14996        IF WS-RESP-NORMAL
 14997           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14998        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 287
* EL156.cbl
 14999           MOVE SPACES           TO  LOANNBO
 15000        END-IF
 15001     END-IF
 15002
 15003*       MOVE PI-LOAN-NO          TO LOANNBO
 15004
 15005     IF CKNUMBO = SPACES
 15006         MOVE SPACES             TO CKNUMHDO.
 15007
 15008     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15009     MOVE CL-CARRIER             TO CARRBO.
 15010     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15011     MOVE CL-CERT-SFX            TO SUFXBO.
 15012
 15013     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15014        EVALUATE CL-CLAIM-TYPE
 15015           WHEN 'I'
 15016              MOVE '  IU  '      TO CLMTYPBO
 15017           WHEN 'G'
 15018              MOVE ' GAP  '      TO CLMTYPBO
 15019           WHEN OTHER
 15020              MOVE PI-AH-OVERRIDE-L6
 15021                                 TO CLMTYPBO
 15022        END-EVALUATE
 15023        MOVE ZEROS               TO UNDISBO
 15024*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15025        IF PI-PMTTYPE = '5' OR '6'
 15026           GO TO 6073-GET-NOTIFY-DATA
 15027        ELSE
 15028           MOVE PI-DAILY-RATE    TO RATEBO
 15029           GO TO 6073-GET-NOTIFY-DATA.
 15030
 15031     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15032
 15033     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15034        MOVE ZEROS               TO UNDISBO
 15035     ELSE
 15036        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15037
 15038 6073-GET-NOTIFY-DATA.
 15039
 15040     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15041
 15042     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15043         MOVE SPACES             TO  NAMEB2O
 15044                                     ADDR1B2O
 15045                                     ADDR2B2O
 15046                                     CITYST2O
 15047                                     AGTHDGO
 15048         MOVE ZEROS              TO  ZIPB2O
 15049         GO TO 6080-SET-INCURRED.
 15050
 15051     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15052     MOVE +29                    TO  TRLR-SEQ-NO.
 15053
 15054
 15055* EXEC CICS HANDLE CONDITION
 15056*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 288
* EL156.cbl
 15057*    END-EXEC.
 15058*    MOVE '"$I                   ! 1 #00014121' TO DFHEIV0
 15059     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15061     MOVE X'3120233030303134313231' TO DFHEIV0(25:11)
 15062     CALL 'kxdfhei1' USING DFHEIV0
 15063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15064
 15065
 15066     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15067
 15068     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15069     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15070     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15071*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15072     STRING AT-CITY ' ' AT-STATE
 15073        DELIMITED BY '  ' INTO CITYST2O
 15074     END-STRING
 15075     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15076     GO TO 6080-SET-INCURRED.
 15077
 15078 6074-GET-COMP-DATA.
 15079
 15080     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15081         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15082
 15083     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15084         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15085                                         ADDR1B2O
 15086                                         ADDR2B2O
 15087                                         CITYST2O
 15088         MOVE ZEROS                  TO  ZIPB2O
 15089         GO TO 6080-SET-INCURRED.
 15090
 15091     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15092     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15093     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15094     MOVE AM-GROUPING            TO  COMP-GROUP.
 15095     MOVE 'A'                    TO  COMP-TYPE.
 15096     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15097                                 TO  COMP-FIN-RESP.
 15098
 15099     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15100         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15101                                       'G' OR 'B'
 15102             MOVE 'G'            TO  COMP-TYPE
 15103             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15104         ELSE
 15105             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15106                                 TO  COMP-ACCOUNT
 15107     ELSE
 15108         MOVE 'G'                TO  COMP-TYPE
 15109         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15110
 15111     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15112
 15113     IF COMP-REC-FOUND
 15114         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 289
* EL156.cbl
 15115         MOVE CO-ADDR-1          TO  ADDR1B2O
 15116         MOVE CO-ADDR-2          TO  ADDR2B2O
 15117*        MOVE CO-ADDR-3          TO  CITYST2O
 15118         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15119            DELIMITED BY '  ' INTO CITYST2O
 15120         END-STRING
 15121         MOVE CO-ZIP             TO  ZIPB2O
 15122     ELSE
 15123         MOVE 'NO COMP ADDRESS AVAILABLE'
 15124                                 TO  NAMEB2O
 15125                                     ADDR1B2O
 15126                                     ADDR2B2O
 15127                                     CITYST2O
 15128         MOVE ZEROS               TO ZIPB2O.
 15129
 15130 6080-SET-INCURRED.
 15131     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15132     MOVE SPACES                 TO DC-OPTION-CODE.
 15133     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15134     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15135     MOVE PI-PROCESSOR-ID        TO BYBO.
 15136     MOVE MAP-NAMEB              TO MAP-NAME.
 15137     MOVE 'C'                    TO PI-PASS-SW.
 15138     MOVE EIBAID                 TO PI-PFKEY-USED.
 15139     MOVE -1                     TO ENTPFBL.
 15140     GO TO 8100-SEND-INITIAL-MAP.
 15141
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 290
* EL156.cbl
 15143 6100-BUILD-PAYMENT-TRAILER.
 15144
 15145     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15146       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15147         GO TO 6105-STATE-CHECK-NUMBER
 15148     END-IF.
 15149
 15150     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15151     MOVE '6'                    TO CNTL-REC-TYPE.
 15152
 15153     IF CONTROL-IS-ACTUAL-CARRIER
 15154         MOVE PI-CARRIER         TO WS-CARR
 15155     ELSE
 15156         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15157
 15158     IF PI-COMPANY-ID = 'FIA'
 15159         MOVE PI-CARRIER         TO  WS-CARR.
 15160
 15161     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15162     MOVE 0                      TO CNTL-SEQ-NO.
 15163     MOVE 'CARR'                 TO FILE-SWITCH.
 15164
 15165     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15166
 15167     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15168         IF PI-OFFLINE     = 'Y' AND
 15169            PI-ECHECKNO-CR = 'CR'
 15170              GO TO 6110-READ-CONTROL
 15171         ELSE
 15172            IF PI-CASH = 'N'
 15173                GO TO 6110-READ-CONTROL.
 15174
 15175     IF CHECK-NO-MANUAL    OR
 15176        CHECK-NO-AT-PRINT  OR
 15177        PI-OFFLINE = 'Y'
 15178          GO TO 6130-BUILD-TRAILER.
 15179
 15180     IF PI-COMPANY-ID = 'FIA'
 15181         NEXT SENTENCE
 15182     ELSE
 15183         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15184             GO TO 6110-READ-CONTROL.
 15185
 15186     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15187
 15188     IF CHECK-CNT-RESET-VALUE
 15189        MOVE +1                  TO CF-CHECK-COUNTER
 15190     ELSE
 15191        ADD +1                   TO CF-CHECK-COUNTER.
 15192
 15193     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15194
 15195     IF CHECK-NO-CARR-SEQ
 15196        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15197
 15198     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15199
 15200     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 291
* EL156.cbl
 15201     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15202        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15203         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15204         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15205            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15206         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15207                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15208     END-IF.
 15209
 15210     GO TO 6120-REWRITE.
 15211
 15212 6105-STATE-CHECK-NUMBER.
 15213     IF CHECK-NO-MANUAL    OR
 15214        CHECK-NO-AT-PRINT  OR
 15215        PI-OFFLINE = 'Y'
 15216           GO TO 6130-BUILD-TRAILER
 15217     END-IF.
 15218
 15219     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15220     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15221     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15222     MOVE '3'                TO CNTL-REC-TYPE.
 15223     MOVE +0                 TO CNTL-SEQ-NO.
 15224     MOVE 'STAT'             TO FILE-SWITCH.
 15225     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15226
 15227     IF CF-ST-CHECK-CNT-RESET
 15228         MOVE +1             TO CF-ST-CHECK-COUNTER
 15229     ELSE
 15230         ADD +1              TO CF-ST-CHECK-COUNTER
 15231     END-IF.
 15232
 15233     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15234     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15235     GO TO 6120-REWRITE.
 15236
 15237 6110-READ-CONTROL.
 15238     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15239     MOVE '1'                    TO CNTL-REC-TYPE.
 15240     MOVE SPACES                 TO CNTL-ACCESS.
 15241     MOVE 0                      TO CNTL-SEQ-NO.
 15242
 15243     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15244
 15245     IF CO-CHECK-COUNT-RESET
 15246        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15247     ELSE
 15248        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15249
 15250     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15251
 15252     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15253         IF PI-OFFLINE     = 'Y'  AND
 15254            PI-ECHECKNO-CR = 'CR'
 15255              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15256              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15257              MOVE AL-UANON           TO CHECKNOA
 15258              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 292
* EL156.cbl
 15259         ELSE
 15260         IF PI-CASH = 'N'
 15261             MOVE 'N'                TO PI-ECHECKNO-N
 15262             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15263             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15264             MOVE AL-UANON           TO CHECKNOA
 15265             GO TO 6120-REWRITE.
 15266
 15267     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15268
 15269 6120-REWRITE.
 15270
 15271* EXEC CICS REWRITE
 15272*         DATASET('ELCNTL')
 15273*         FROM(CONTROL-FILE)
 15274*     END-EXEC.
 15275     MOVE LENGTH OF
 15276      CONTROL-FILE
 15277       TO DFHEIV11
 15278     MOVE 'ELCNTL' TO DFHEIV1
 15279*    MOVE '&& L                  %   #00014329' TO DFHEIV0
 15280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15282     MOVE X'2020233030303134333239' TO DFHEIV0(25:11)
 15283     CALL 'kxdfhei1' USING DFHEIV0,
 15284           DFHEIV1,
 15285           CONTROL-FILE,
 15286           DFHEIV11,
 15287           DFHEIV99
 15288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15289
 15290
 15291     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15292
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 293
* EL156.cbl
 15294 6130-BUILD-TRAILER.
 15295
 15296
 15297* EXEC CICS GETMAIN
 15298*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15299*         LENGTH    (200)
 15300*         INITIMG   (GETMAIN-SPACE)
 15301*     END-EXEC.
 15302     MOVE 200
 15303       TO DFHEIV11
 15304*    MOVE ',"IL                  $   #00014339' TO DFHEIV0
 15305     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15306     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15307     MOVE X'2020233030303134333339' TO DFHEIV0(25:11)
 15308     CALL 'kxdfhei1' USING DFHEIV0,
 15309           DFHEIV20,
 15310           DFHEIV11,
 15311           GETMAIN-SPACE
 15312     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15313         DFHEIV20
 15314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15315
 15316
 15317     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15318                                    AT-PREV-PAID-THRU-DT.
 15319     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15320     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15321     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15322     MOVE 'AT'                   TO AT-RECORD-ID.
 15323     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15324
 15325     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15326        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15327           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15328     ELSE
 15329           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15330           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15331
 15332     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15333         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15334             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15335             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15336           ELSE
 15337             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15338             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15339
 15340     MOVE '2'                    TO AT-TRAILER-TYPE.
 15341     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15342                                    AT-PAYMENT-LAST-MAINT-DT.
 15343     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15344                                    AT-PAYMENT-LAST-UPDATED-BY.
 15345     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15346     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15347     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15348     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15349
 15350     IF PI-PMT-APPROVED
 15351        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 294
* EL156.cbl
 15352           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15353
 15354     IF PI-PFKEY-USED = DFHPF5
 15355        GO TO 6140-PF5-ENTERED.
 15356
 15357     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15358     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15359
 15360     IF PI-AIG-SPECIAL-BENEFIT
 15361         IF WS-1ST-SPECIAL-PMT
 15362             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15363             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15364                                        AT-AMOUNT-PAID
 15365         ELSE
 15366             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15367
 15368     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15369
 15370     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15371     MOVE '4'                    TO DC-OPTION-CODE.
 15372     PERFORM 9700-LINK-DATE-CONVERT.
 15373
 15374     IF DATE-CONVERSION-ERROR
 15375        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15376     ELSE
 15377        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15378
 15379     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15380     MOVE '4'                    TO DC-OPTION-CODE.
 15381     PERFORM 9700-LINK-DATE-CONVERT.
 15382
 15383     IF DATE-CONVERSION-ERROR
 15384        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15385     ELSE
 15386        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15387
 15388     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15389     GO TO 6150-FINISH-MOVE.
 15390
 15391 6140-PF5-ENTERED.
 15392     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15393     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15394
 15395     IF PI-AIG-SPECIAL-BENEFIT
 15396         IF WS-1ST-SPECIAL-PMT
 15397             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15398             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15399                                        AT-AMOUNT-PAID
 15400         ELSE
 15401             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15402
 15403     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15404     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15405     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15406
 15407 6150-FINISH-MOVE.
 15408
 15409     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 295
* EL156.cbl
 15410         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15411     ELSE
 15412         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15413
 15414     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15415     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15416
 15417*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15418*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15419
 15420     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15421         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15422
 15423     IF PI-OFFLINE = 'N'
 15424        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15425        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15426     ELSE
 15427        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15428        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15429
 15430     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15431
 15432     IF WS-2ND-SPECIAL-PMT
 15433         MOVE 'Y'                TO AT-CASH-PAYMENT
 15434         MOVE SPACES             TO AT-CHECK-NO
 15435         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15436         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15437         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15438         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15439
 15440     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15441                                    AT-TO-BE-WRITTEN-DT.
 15442
 15443     IF PI-HOLDTIL NOT = ZEROS
 15444        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15445        MOVE '4'                 TO DC-OPTION-CODE
 15446        PERFORM 9700-LINK-DATE-CONVERT
 15447        IF PI-OFFLINE = 'N'
 15448           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15449        ELSE
 15450           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15451
 15452     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15453     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15454                                    AT-CHECK-QUE-SEQUENCE.
 15455
 15456     IF PI-PFKEY-USED = DFHPF4
 15457        MOVE '1'                 TO AT-FORCE-CONTROL.
 15458
 15459     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15460        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15461        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15462        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15463
 15464     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15465                                    AT-VOID-SELECT-DT
 15466                                    AT-VOID-ACCEPT-DT
 15467                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 296
* EL156.cbl
 15468     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15469        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15470        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15471        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15472        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15473     ELSE
 15474        MOVE ZEROS               TO AT-DAILY-RATE
 15475                                    AT-ELIMINATION-DAYS
 15476        MOVE SPACES              TO AT-BENEFIT-TYPE
 15477     END-IF
 15478     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15479     MOVE '4'                    TO DC-OPTION-CODE.
 15480     PERFORM 9700-LINK-DATE-CONVERT.
 15481     IF DATE-CONVERSION-ERROR
 15482         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15483     ELSE
 15484         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15485     END-IF.
 15486     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15487     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15488     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15489     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15490     IF (PI-REAUDIT-NEEDED = 'Y')
 15491        or (pi-max-ext-used = 'Y')
 15492         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15493         MOVE 'Y' TO WS-NEED-APPROVAL
 15494         GO TO 6170-WRITE
 15495     END-IF.
 15496*******************************************************
 15497     IF NOT PI-PMT-GRADUATED
 15498         GO TO 6170-WRITE.
 15499
 15500     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15501     MOVE '1'                    TO CNTL-REC-TYPE.
 15502     MOVE SPACES                 TO CNTL-ACCESS.
 15503     MOVE +0                     TO CNTL-SEQ-NO.
 15504     MOVE 'COMP'                 TO FILE-SWITCH.
 15505
 15506     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15507
 15508     IF PAID-FOR-LIFE
 15509         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15510             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15511                                     WS-PMT-APPROVAL-SW
 15512             GO TO 6170-WRITE.
 15513
 15514*05999      IF PAID-FOR-AH
 15515     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15516         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15517             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15518                                     WS-PMT-APPROVAL-SW
 15519             GO TO 6170-WRITE.
 15520
 15521     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15522
 15523******A&H Limits are set as a monthly payment.  Calculate the mont
 15524******equivalent of the amount paid today
 15525     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 297
* EL156.cbl
 15526        PI-SAVE-ODD-DAYS-OVER > 0
 15527           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15528                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15529           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15530                                  WS-CALC-PMT-MONTHS
 15531     ELSE
 15532           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15533     END-IF.
 15534*06007      IF ((PAID-FOR-AH) AND
 15535     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15536*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15537        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15538              OR
 15539        ((PAID-FOR-LIFE) AND
 15540        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15541            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15542       ELSE
 15543*06014      IF ((PAID-FOR-AH)  AND
 15544         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15545*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15546           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15547              OR
 15548        ((PAID-FOR-LIFE) AND
 15549        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15550            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15551         ELSE
 15552*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15553           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15554               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15555              OR
 15556          ((PAID-FOR-LIFE) AND
 15557          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15558            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15559       ELSE
 15560           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15561               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15562              OR
 15563          ((PAID-FOR-LIFE) AND
 15564          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15565            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15566       ELSE
 15567            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15568
 15569     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15570        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15571        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15572            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15573        END-IF
 15574     ELSE
 15575     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15576        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15577        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15578            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15579        END-IF
 15580     ELSE
 15581     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15582        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15583        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 298
* EL156.cbl
 15584            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15585        END-IF
 15586     ELSE
 15587     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15588        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15589        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15590            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15591        END-IF
 15592     ELSE
 15593     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15594            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15595
 15596     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15597
 15598     IF NOT PI-PMT-GRADUATED
 15599         GO TO 6170-WRITE.
 15600
 15601
 15602* EXEC CICS HANDLE CONDITION
 15603*        NOTFND   (6170-WRITE)
 15604*    END-EXEC.
 15605*    MOVE '"$I                   ! 2 #00014629' TO DFHEIV0
 15606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15608     MOVE X'3220233030303134363239' TO DFHEIV0(25:11)
 15609     CALL 'kxdfhei1' USING DFHEIV0
 15610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15611
 15612
 15613     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15614     MOVE '2'                    TO CNTL-REC-TYPE.
 15615     MOVE +0                     TO CNTL-SEQ-NO.
 15616     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15617
 15618
 15619* EXEC CICS READ
 15620*         DATASET  ('ELCNTL')
 15621*         SET      (ADDRESS OF CONTROL-FILE)
 15622*         RIDFLD   (ELCNTL-KEY)
 15623*    END-EXEC.
 15624     MOVE 'ELCNTL' TO DFHEIV1
 15625*    MOVE '&"S        E          (   #00014638' TO DFHEIV0
 15626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15628     MOVE X'2020233030303134363338' TO DFHEIV0(25:11)
 15629     CALL 'kxdfhei1' USING DFHEIV0,
 15630           DFHEIV1,
 15631           DFHEIV20,
 15632           DFHEIV99,
 15633           ELCNTL-KEY,
 15634           DFHEIV99,
 15635           DFHEIV99,
 15636           DFHEIV99
 15637     SET ADDRESS OF CONTROL-FILE TO
 15638         DFHEIV20
 15639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15640
 15641
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 299
* EL156.cbl
 15642     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15643
 15644     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15645                         OR '4' OR '5'
 15646         NEXT SENTENCE
 15647     ELSE
 15648         MOVE 'Y' TO WS-NEED-APPROVAL
 15649         GO TO 6170-WRITE.
 15650
 15651     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15652         MOVE 'Y' TO WS-NEED-APPROVAL
 15653         IF WS-APPROVAL-LEVEL = '1'
 15654             MOVE '2'        TO  AT-APPROVED-LEVEL
 15655                            WS-SAVE-APPROVED-LEVEL
 15656             GO TO 6170-WRITE
 15657         ELSE
 15658             IF WS-APPROVAL-LEVEL = '2'
 15659                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15660                                WS-SAVE-APPROVED-LEVEL
 15661                 GO TO 6170-WRITE
 15662             ELSE IF WS-APPROVAL-LEVEL = '3'
 15663                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15664                                WS-SAVE-APPROVED-LEVEL
 15665                 GO TO 6170-WRITE
 15666             ELSE IF WS-APPROVAL-LEVEL = '4'
 15667                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15668                                WS-SAVE-APPROVED-LEVEL
 15669                 GO TO 6170-WRITE.
 15670
 15671     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15672                             WS-PMT-APPROVAL-SW.
 15673     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15674                             AT-APPROVAL-LEVEL-REQD.
 15675
 15676*******************************************************
 15677
 15678 6170-WRITE.
 15679
 15680     if pi-company-id = 'DCC'
 15681        PERFORM 0900-GET-DDF-limits
 15682                                 THRU 0900-EXIT
 15683     end-if
 15684     perform 2220-update-elcrtt  thru 2220-exit
 15685     IF PI-COMPANY-ID = 'DMD'
 15686        IF PI-AT-EOB-CODES NOT = SPACES
 15687           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15688           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15689           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15690           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15691           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15692
 15693
 15694* EXEC CICS HANDLE CONDITION
 15695*        DUPREC    (6180-DUPREC)
 15696*    END-EXEC.
 15697*    MOVE '"$%                   ! 3 #00014695' TO DFHEIV0
 15698     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 300
* EL156.cbl
 15700     MOVE X'3320233030303134363935' TO DFHEIV0(25:11)
 15701     CALL 'kxdfhei1' USING DFHEIV0
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15703
 15704
 15705
 15706* EXEC CICS WRITE
 15707*         DATASET       ('ELTRLR')
 15708*         FROM          (ACTIVITY-TRAILERS)
 15709*         RIDFLD        (AT-CONTROL-PRIMARY)
 15710*     END-EXEC.
 15711     MOVE LENGTH OF
 15712      ACTIVITY-TRAILERS
 15713       TO DFHEIV11
 15714     MOVE 'ELTRLR' TO DFHEIV1
 15715*    MOVE '&$ L                  ''   #00014699' TO DFHEIV0
 15716     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15718     MOVE X'2020233030303134363939' TO DFHEIV0(25:11)
 15719     CALL 'kxdfhei1' USING DFHEIV0,
 15720           DFHEIV1,
 15721           ACTIVITY-TRAILERS,
 15722           DFHEIV11,
 15723           AT-CONTROL-PRIMARY,
 15724           DFHEIV99,
 15725           DFHEIV99
 15726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15727
 15728
 15729     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15730        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15731*06088           GO TO 6199-EXIT.
 15732           GO TO 6176-APPROVAL-NOTE.
 15733
 15734
 15735* EXEC CICS GETMAIN
 15736*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15737*         LENGTH    (200)
 15738*         INITIMG   (GETMAIN-SPACE)
 15739*     END-EXEC.
 15740     MOVE 200
 15741       TO DFHEIV11
 15742*    MOVE ',"IL                  $   #00014710' TO DFHEIV0
 15743     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15744     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15745     MOVE X'2020233030303134373130' TO DFHEIV0(25:11)
 15746     CALL 'kxdfhei1' USING DFHEIV0,
 15747           DFHEIV20,
 15748           DFHEIV11,
 15749           GETMAIN-SPACE
 15750     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15751         DFHEIV20
 15752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15753
 15754
 15755     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15756
 15757     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 301
* EL156.cbl
 15758     MOVE 'AT'                   TO AT-RECORD-ID.
 15759     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15760     MOVE '6'                    TO AT-TRAILER-TYPE.
 15761     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15762                                    AT-GEN-INFO-LAST-MAINT-DT
 15763     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15764                                    AT-GEN-INFO-LAST-UPDATED-BY
 15765     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15766
 15767     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15768     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15769     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15770
 15771     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15772
 15773 6175-WRITE.
 15774
 15775
 15776* EXEC CICS HANDLE CONDITION
 15777*        DUPREC    (6190-DUPREC)
 15778*    END-EXEC.
 15779*    MOVE '"$%                   ! 4 #00014736' TO DFHEIV0
 15780     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15782     MOVE X'3420233030303134373336' TO DFHEIV0(25:11)
 15783     CALL 'kxdfhei1' USING DFHEIV0
 15784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15785
 15786
 15787
 15788* EXEC CICS WRITE
 15789*         DATASET     ('ELTRLR')
 15790*         FROM        (ACTIVITY-TRAILERS)
 15791*         RIDFLD      (AT-CONTROL-PRIMARY)
 15792*     END-EXEC.
 15793     MOVE LENGTH OF
 15794      ACTIVITY-TRAILERS
 15795       TO DFHEIV11
 15796     MOVE 'ELTRLR' TO DFHEIV1
 15797*    MOVE '&$ L                  ''   #00014740' TO DFHEIV0
 15798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15800     MOVE X'2020233030303134373430' TO DFHEIV0(25:11)
 15801     CALL 'kxdfhei1' USING DFHEIV0,
 15802           DFHEIV1,
 15803           ACTIVITY-TRAILERS,
 15804           DFHEIV11,
 15805           AT-CONTROL-PRIMARY,
 15806           DFHEIV99,
 15807           DFHEIV99
 15808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15809
 15810
 15811 6176-APPROVAL-NOTE.
 15812
 15813     IF NOT APPROVAL-NEEDED
 15814         GO TO 6199-EXIT.
 15815
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 302
* EL156.cbl
 15816
 15817* EXEC CICS GETMAIN
 15818*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15819*        LENGTH    (200)
 15820*        INITIMG   (GETMAIN-SPACE)
 15821*    END-EXEC.
 15822     MOVE 200
 15823       TO DFHEIV11
 15824*    MOVE ',"IL                  $   #00014751' TO DFHEIV0
 15825     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15827     MOVE X'2020233030303134373531' TO DFHEIV0(25:11)
 15828     CALL 'kxdfhei1' USING DFHEIV0,
 15829           DFHEIV20,
 15830           DFHEIV11,
 15831           GETMAIN-SPACE
 15832     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15833         DFHEIV20
 15834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15835
 15836
 15837     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15838
 15839     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15840     MOVE 'AT'               TO AT-RECORD-ID
 15841     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15842     MOVE '6'                TO AT-TRAILER-TYPE
 15843     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15844                                AT-GEN-INFO-LAST-MAINT-DT
 15845     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15846                                AT-GEN-INFO-LAST-UPDATED-BY
 15847     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15848
 15849     IF PI-REAUDIT-NEEDED = 'Y'
 15850         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15851     ELSE
 15852         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15853     END-IF
 15854     MOVE SPACES             TO AT-INFO-LINE-2
 15855
 15856     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15857 6177-WRITE.
 15858
 15859
 15860* EXEC CICS HANDLE CONDITION
 15861*        DUPREC    (6185-DUPREC)
 15862*    END-EXEC.
 15863*    MOVE '"$%                   ! 5 #00014779' TO DFHEIV0
 15864     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15866     MOVE X'3520233030303134373739' TO DFHEIV0(25:11)
 15867     CALL 'kxdfhei1' USING DFHEIV0
 15868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15869
 15870
 15871
 15872* EXEC CICS WRITE
 15873*         DATASET     ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 303
* EL156.cbl
 15874*         FROM        (ACTIVITY-TRAILERS)
 15875*         RIDFLD      (AT-CONTROL-PRIMARY)
 15876*     END-EXEC.
 15877     MOVE LENGTH OF
 15878      ACTIVITY-TRAILERS
 15879       TO DFHEIV11
 15880     MOVE 'ELTRLR' TO DFHEIV1
 15881*    MOVE '&$ L                  ''   #00014783' TO DFHEIV0
 15882     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15883     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15884     MOVE X'2020233030303134373833' TO DFHEIV0(25:11)
 15885     CALL 'kxdfhei1' USING DFHEIV0,
 15886           DFHEIV1,
 15887           ACTIVITY-TRAILERS,
 15888           DFHEIV11,
 15889           AT-CONTROL-PRIMARY,
 15890           DFHEIV99,
 15891           DFHEIV99
 15892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15893
 15894
 15895
 15896     GO TO 6199-EXIT.
 15897
 15898 6180-DUPREC.
 15899
 15900     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15901     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15902     GO TO 6170-WRITE.
 15903
 15904 6185-DUPREC.
 15905     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15906     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15907     GO TO 6177-WRITE.
 15908
 15909 6190-DUPREC.
 15910     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15911     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15912     GO TO 6175-WRITE.
 15913
 15914 6199-EXIT.
 15915      EXIT.
 15916
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 304
* EL156.cbl
 15918 6200-UPDATE-CLAIM-MSTR.
 15919     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15920     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15921     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15922     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15923
 15924     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15925
 15926     MOVE ZEROS                  TO W-INTEREST.
 15927
 15928     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15929        IF (PI-OFFLINE = 'Y') OR
 15930           (PI-PMTTYPE = '7')
 15931           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15932                                 THRU 9870-EXIT
 15933        END-IF
 15934     END-IF
 15935     IF NOT ERROR-ON-OUTPUT
 15936        CONTINUE
 15937     ELSE
 15938
 15939* EXEC CICS REWRITE
 15940*          DATASET('ELMSTR')
 15941*          FROM(CLAIM-MASTER)
 15942*       END-EXEC
 15943     MOVE LENGTH OF
 15944      CLAIM-MASTER
 15945       TO DFHEIV11
 15946     MOVE 'ELMSTR' TO DFHEIV1
 15947*    MOVE '&& L                  %   #00014832' TO DFHEIV0
 15948     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15950     MOVE X'2020233030303134383332' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0,
 15952           DFHEIV1,
 15953           CLAIM-MASTER,
 15954           DFHEIV11,
 15955           DFHEIV99
 15956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15957
 15958        MOVE -1                  TO ENTPFBL
 15959        MOVE AL-UANON            TO ENTPFBA
 15960        MOVE MAP-NAMEB           TO MAP-NAME
 15961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15962        GO TO 8200-SEND-DATAONLY
 15963     END-IF
 15964
 15965     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15966
 15967     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15968
 15969     IF PI-AIG-SPECIAL-BENEFIT
 15970         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15971
 15972     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15973
 15974     IF PI-SPECIAL-BEN-SW = 'Y'
 15975         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 305
* EL156.cbl
 15976         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15977
 15978     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15979         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15980     ELSE
 15981         IF PI-PMTTYPE NOT = '4'
 15982            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15983
 15984     IF PI-PMTTYPE = '5' OR '6'
 15985        GO TO  6250-SET-MAINT.
 15986
 15987     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15988                                         CL-LAG-REPORT-CODE.
 15989
 15990     IF CL-ACTIVITY-CODE = 09
 15991         GO TO 6200-CONT-UPDATE.
 15992
 15993     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15994         IF CL-ACTIVITY-CODE = 11
 15995             GO TO 6200-CONT-UPDATE.
 15996
 15997     IF WS-ACT-REC-FOUND-SW = 'N'
 15998         GO TO 6200-CONT-UPDATE.
 15999
 16000     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16001         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16002         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16003         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16004
 16005     IF WS-UPDATE-SW = 'Y'
 16006         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16007                                         CL-NEXT-FOLLOWUP-DT.
 16008
 16009 6200-CONT-UPDATE.
 16010
 16011     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16012       IF CLAIM-IS-CLOSED
 16013         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16014           IF WS-OPEN-CLOSE-SW = '2'
 16015             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16016                                        CL-LAST-CLOSE-DT.
 16017
 16018     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16019        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16020        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16021
 16022     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16023        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16024        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16025        MOVE 'C'                 TO CL-CLAIM-STATUS
 16026        IF PI-PMTTYPE = '2'
 16027           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16028           CONTINUE
 16029        ELSE
 16030           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16031        END-IF
 16032     ELSE
 16033        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 306
* EL156.cbl
 16034           IF PI-PMTTYPE = '2' AND
 16035              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16036              CONTINUE
 16037           ELSE
 16038              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16039           END-IF
 16040        END-IF
 16041     END-IF
 16042
 16043     IF PI-PMTTYPE = '4'
 16044        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16045
 16046     IF PI-COMPANY-ID = 'CVL'
 16047         IF PI-LOAN-UPDATE-SW = 'Y'
 16048             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16049             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16050             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16051             MOVE CL-CERT-STATE      TO  CERT-STATE
 16052             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16053             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16054             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16055             MOVE 'CERT'             TO  FILE-SWITCH
 16056             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16057             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16058             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16059
 16060     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16061        GO TO 6220-USE-COMPUTED.
 16062
 16063     IF (PI-PMTTYPE = '4')  AND
 16064        (PI-EPYAMT < ZEROS)
 16065          COMPUTE CL-NO-OF-DAYS-PAID =
 16066                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16067          IF CL-NO-OF-DAYS-PAID < +0
 16068              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16069          ELSE
 16070              NEXT SENTENCE
 16071     ELSE
 16072          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16073
 16074     IF PI-PROCESSOR-ID = 'FIX '
 16075        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16076           NEXT SENTENCE
 16077        ELSE
 16078           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16079     ELSE
 16080        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16081
 16082     IF PI-PMTTYPE = '4'
 16083        GO TO 6250-SET-MAINT.
 16084
 16085     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16086
 16087     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16088     MOVE '4'                    TO DC-OPTION-CODE.
 16089     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16090     IF DATE-CONVERSION-ERROR
 16091        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 307
* EL156.cbl
 16092     ELSE
 16093        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16094           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16095           IF PI-AIG-SPECIAL-BENEFIT
 16096               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16097           ELSE
 16098               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16099
 16100     GO TO 6250-SET-MAINT.
 16101
 16102 6220-USE-COMPUTED.
 16103
 16104     IF (PI-PMTTYPE = '4')  AND
 16105        (PI-CPYAMT < ZEROS)
 16106          COMPUTE CL-NO-OF-DAYS-PAID =
 16107                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16108          IF CL-NO-OF-DAYS-PAID < +0
 16109              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16110          ELSE
 16111              NEXT SENTENCE
 16112     ELSE
 16113          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16114
 16115     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16116
 16117     IF PI-PMTTYPE = '4'
 16118        GO TO 6250-SET-MAINT.
 16119
 16120     IF PI-AIG-SPECIAL-BENEFIT
 16121         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16122     ELSE
 16123         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16124
 16125     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16126
 16127     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16128        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16129
 16130 6250-SET-MAINT.
 16131     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16132
 16133     IF PI-PROCESSOR-ID = 'FIX '
 16134        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16135           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16136        ELSE
 16137           NEXT SENTENCE
 16138     ELSE
 16139        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16140
 16141     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16142     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16143     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16144
 16145 6299-EXIT.
 16146      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 308
* EL156.cbl
 16148 6300-UPDATE-CERT.
 16149
 16150*  ADD CERTNOTE FOR SC NP+6
 16151     IF PI-COMPANY-ID = 'CID' AND
 16152       (PI-PMTTYPE = '2' OR '3') AND
 16153        CL-CERT-STATE = 'SC'  AND
 16154        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16155           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16156     END-IF.
 16157
 16158     IF PI-COMPANY-ID = 'AHL' AND
 16159       (PI-PMTTYPE = '2' OR '3') AND
 16160        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16161           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16162           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16163     END-IF.
 16164
 16165     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16166     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16167     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16168     MOVE CL-CERT-STATE    TO CERT-STATE.
 16169     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16170     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16171     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16172     MOVE 'CERT'           TO FILE-SWITCH.
 16173
 16174     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16175
 16176     IF CERT-NOTE-ADDED
 16177        IF CM-NOTE-SW = ' '
 16178           MOVE '4'             TO CM-NOTE-SW
 16179        ELSE
 16180           IF CM-NOTE-SW = '1'
 16181               MOVE '5'           TO CM-NOTE-SW
 16182           ELSE
 16183              IF CM-NOTE-SW = '2'
 16184                 MOVE '6'         TO CM-NOTE-SW
 16185              ELSE
 16186                 IF CM-NOTE-SW = '3'
 16187                    MOVE '7'      TO CM-NOTE-SW
 16188                 END-IF
 16189              END-IF
 16190           END-IF
 16191        END-IF
 16192     END-IF.
 16193
 16194     IF PI-COMPANY-ID = 'CVL'
 16195         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16196         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16197
 16198     IF PI-PMTTYPE NOT = '4'
 16199        GO TO 6340-UPDATE-CERT.
 16200
 16201     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16202        IF PI-PFKEY-USED = DFHPF5
 16203           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16204        ELSE
 16205           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 309
* EL156.cbl
 16206
 16207*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16208*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16209*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16210*               PI-LF-COVERAGE-TYPE = 'P'
 16211*                GO TO 6350-REWRITE-CERT.
 16212
 16213     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16214       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16215          PI-LF-COVERAGE-TYPE = 'P'
 16216           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16217                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16218                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16219                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16220                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16221                GO TO 6350-REWRITE-CERT
 16222            ELSE
 16223                GO TO 6350-REWRITE-CERT.
 16224
 16225     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16226         GO TO 6350-REWRITE-CERT.
 16227
 16228     IF NOT CM-AH-LUMP-SUM-DISAB
 16229        GO TO 6380-UNLOCK-CERT.
 16230
 16231     IF PI-PFKEY-USED = DFHPF5
 16232        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16233                                    CM-AH-ITD-AH-PMT
 16234        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16235        GO TO 6350-REWRITE-CERT
 16236     ELSE
 16237        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16238                                    CM-AH-ITD-AH-PMT
 16239        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16240        GO TO 6350-REWRITE-CERT.
 16241
 16242 6340-UPDATE-CERT.
 16243
 16244     IF CL-CLAIM-TYPE = 'L'
 16245         IF PI-PFKEY-USED = DFHPF5
 16246             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16247         ELSE
 16248             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16249
 16250     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16251         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16252             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16253                PI-LF-COVERAGE-TYPE = 'P'
 16254                 GO TO 6350-REWRITE-CERT.
 16255
 16256     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16257       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16258          PI-LF-COVERAGE-TYPE = 'P'
 16259           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16260                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16261                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16262                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16263                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 310
* EL156.cbl
 16264                GO TO 6350-REWRITE-CERT.
 16265
 16266     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16267         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16268            PI-LF-COVERAGE-TYPE NOT = 'P'
 16269             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16270             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16271             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16272             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16273             GO TO 6350-REWRITE-CERT.
 16274
 16275     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16276         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16277         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16278         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16279         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16280         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16281         IF PI-PFKEY-USED = DFHPF5
 16282             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16283                                        CM-AH-ITD-AH-PMT
 16284             GO TO 6350-REWRITE-CERT
 16285         ELSE
 16286             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16287                                        CM-AH-ITD-AH-PMT
 16288             GO TO 6350-REWRITE-CERT.
 16289
 16290 6350-REWRITE-CERT.
 16291
 16292
 16293* EXEC CICS REWRITE
 16294*         DATASET  ('ELCERT')
 16295*         FROM(CERTIFICATE-MASTER)
 16296*     END-EXEC.
 16297     MOVE LENGTH OF
 16298      CERTIFICATE-MASTER
 16299       TO DFHEIV11
 16300     MOVE 'ELCERT' TO DFHEIV1
 16301*    MOVE '&& L                  %   #00015171' TO DFHEIV0
 16302     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16303     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16304     MOVE X'2020233030303135313731' TO DFHEIV0(25:11)
 16305     CALL 'kxdfhei1' USING DFHEIV0,
 16306           DFHEIV1,
 16307           CERTIFICATE-MASTER,
 16308           DFHEIV11,
 16309           DFHEIV99
 16310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16311
 16312
 16313     GO TO 6399-EXIT.
 16314
 16315 6380-UNLOCK-CERT.
 16316
 16317* EXEC CICS UNLOCK
 16318*         DATASET  ('ELCERT')
 16319*     END-EXEC.
 16320     MOVE 'ELCERT' TO DFHEIV1
 16321*    MOVE '&*                    #   #00015179' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 311
* EL156.cbl
 16322     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16324     MOVE X'2020233030303135313739' TO DFHEIV0(25:11)
 16325     CALL 'kxdfhei1' USING DFHEIV0,
 16326           DFHEIV1,
 16327           DFHEIV99
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
 16331 6399-EXIT.
 16332      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 312
* EL156.cbl
 16334 6400-UPDATE-ZERO-TRAILER.
 16335     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16336     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16337
 16338     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16339
 16340     IF PI-EPYAMT NOT = ZEROS
 16341         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16342     ELSE
 16343         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16344
 16345     IF PI-ERESV NOT = ZEROS
 16346        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16347
 16348     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16349        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16350
 16351     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16352        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16353     ELSE
 16354        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16355
 16356     IF PI-PMTTYPE = '5'
 16357        IF PI-EPYAMT = ZEROS
 16358           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16359        ELSE
 16360           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16361
 16362     IF PI-PMTTYPE = '6'
 16363        IF PI-EPYAMT = ZEROS
 16364           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16365        ELSE
 16366           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16367
 16368 6420-CHECK-OPEN-CLOSE.
 16369     IF PI-PMTTYPE = '5' OR '6'
 16370        GO TO 6450-REWRITE.
 16371
 16372     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16373         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16374             IF CLAIM-IS-CLOSED
 16375                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16376                 MOVE 1          TO  SUB-1
 16377                 GO TO 6440-AIG-LOOP.
 16378
 16379     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16380        GO TO 6450-REWRITE.
 16381
 16382     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16383        GO TO 6450-REWRITE.
 16384
 16385     MOVE 1                      TO SUB-1.
 16386
 16387 6430-LOOP.
 16388     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16389        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16390        IF PI-PMTTYPE = '1' OR '4'
 16391           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 313
* EL156.cbl
 16392           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16393           GO TO 6450-REWRITE
 16394        ELSE
 16395           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16396           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16397           GO TO 6450-REWRITE.
 16398
 16399     IF SUB-1 = 6
 16400      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16401      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16402      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16403      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16404      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16405      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16406      GO TO 6430-LOOP.
 16407
 16408     ADD 1                       TO SUB-1.
 16409     GO TO 6430-LOOP.
 16410
 16411
 16412 6440-AIG-LOOP.
 16413
 16414     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16415       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16416       IF WS-OPEN-CLOSE-SW = '1'
 16417         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16418         IF PI-PMTTYPE = '2'
 16419           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16420           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16421         ELSE
 16422           IF PI-PMTTYPE = '3'
 16423             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16424             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16425           ELSE
 16426             IF PI-PMTTYPE = '4'
 16427               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16428               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16429             ELSE
 16430               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16431               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16432       ELSE
 16433         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16434         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16435         GO TO 6450-REWRITE.
 16436
 16437     IF SUB-1 = 6
 16438      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16439      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16440      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16441      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16442      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16443      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16444      GO TO 6440-AIG-LOOP.
 16445
 16446     ADD 1                       TO SUB-1.
 16447     GO TO 6440-AIG-LOOP.
 16448
 16449 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 314
* EL156.cbl
 16450     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16451     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16452     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16453
 16454     IF PI-COMPANY-ID = 'DMD'
 16455         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16456         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16457         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16458         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16459         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16460
 16461
 16462* EXEC CICS REWRITE
 16463*         DATASET  ('ELTRLR')
 16464*         FROM     (ACTIVITY-TRAILERS)
 16465*     END-EXEC.
 16466     MOVE LENGTH OF
 16467      ACTIVITY-TRAILERS
 16468       TO DFHEIV11
 16469     MOVE 'ELTRLR' TO DFHEIV1
 16470*    MOVE '&& L                  %   #00015313' TO DFHEIV0
 16471     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16472     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16473     MOVE X'2020233030303135333133' TO DFHEIV0(25:11)
 16474     CALL 'kxdfhei1' USING DFHEIV0,
 16475           DFHEIV1,
 16476           ACTIVITY-TRAILERS,
 16477           DFHEIV11,
 16478           DFHEIV99
 16479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16480
 16481
 16482 6499-EXIT.
 16483      EXIT.
 16484
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 315
* EL156.cbl
 16486 6500-READ-DLO035.
 16487     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16488     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16489     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16490     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16491
 16492
 16493* EXEC CICS LINK
 16494*        PROGRAM    ('DLO035')
 16495*        COMMAREA   (DLO035-KEY)
 16496*        LENGTH     (DL35-LENGTH)
 16497*    END-EXEC.
 16498     MOVE 'DLO035' TO DFHEIV1
 16499*    MOVE '."C                   (   #00015328' TO DFHEIV0
 16500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16502     MOVE X'2020233030303135333238' TO DFHEIV0(25:11)
 16503     CALL 'kxdfhei1' USING DFHEIV0,
 16504           DFHEIV1,
 16505           DLO035-KEY,
 16506           DL35-LENGTH,
 16507           DFHEIV99,
 16508           DFHEIV99,
 16509           DFHEIV99,
 16510           DFHEIV99
 16511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16512
 16513
 16514     IF DL35-RETURN-CODE = 'OK'
 16515         GO TO 6500-EXIT.
 16516
 16517     IF DL35-RETURN-CODE = '01'
 16518         MOVE ER-7830            TO EMI-ERROR
 16519         GO TO 6500-BAD-EXIT.
 16520
 16521     IF DL35-RETURN-CODE = '02'
 16522         MOVE ER-7831            TO EMI-ERROR
 16523         GO TO 6500-BAD-EXIT.
 16524
 16525     IF DL35-RETURN-CODE = '03'
 16526         MOVE ER-7832            TO EMI-ERROR
 16527         GO TO 6500-BAD-EXIT.
 16528
 16529     IF DL35-RETURN-CODE = '04'
 16530         MOVE ER-7833            TO EMI-ERROR
 16531         GO TO 6500-BAD-EXIT.
 16532
 16533     IF DL35-RETURN-CODE = '05'
 16534         MOVE ER-7834            TO EMI-ERROR
 16535         GO TO 6500-BAD-EXIT.
 16536
 16537     IF DL35-RETURN-CODE = '06'
 16538         MOVE ER-7835            TO EMI-ERROR
 16539         GO TO 6500-BAD-EXIT.
 16540
 16541     IF DL35-RETURN-CODE = '07'
 16542         MOVE ER-7836            TO EMI-ERROR
 16543         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 316
* EL156.cbl
 16544
 16545     IF DL35-RETURN-CODE = 'E1'
 16546         MOVE ER-7837            TO EMI-ERROR
 16547         GO TO 6500-BAD-EXIT.
 16548
 16549     IF DL35-RETURN-CODE NOT = 'OK'
 16550         MOVE ER-7838            TO EMI-ERROR
 16551         GO TO 6500-BAD-EXIT.
 16552
 16553 6500-EXIT.
 16554      EXIT.
 16555
 16556 6500-BAD-EXIT.
 16557
 16558* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16559*    MOVE '6"R                   !   #00015377' TO DFHEIV0
 16560     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16562     MOVE X'2020233030303135333737' TO DFHEIV0(25:11)
 16563     CALL 'kxdfhei1' USING DFHEIV0
 16564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16565
 16566     MOVE -1                 TO PMTTYPEL.
 16567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16568     GO TO 8200-SEND-DATAONLY.
 16569
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 317
* EL156.cbl
 16571 6600-UPDATE-DLO035.
 16572     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16573     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16574     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16575     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16576
 16577
 16578* EXEC CICS LINK
 16579*        PROGRAM    ('DLO035')
 16580*        COMMAREA   (DLO035-KEY)
 16581*        LENGTH     (DL35-LENGTH)
 16582*    END-EXEC.
 16583     MOVE 'DLO035' TO DFHEIV1
 16584*    MOVE '."C                   (   #00015389' TO DFHEIV0
 16585     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16587     MOVE X'2020233030303135333839' TO DFHEIV0(25:11)
 16588     CALL 'kxdfhei1' USING DFHEIV0,
 16589           DFHEIV1,
 16590           DLO035-KEY,
 16591           DL35-LENGTH,
 16592           DFHEIV99,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16597
 16598
 16599     IF DL35-RETURN-CODE = 'OK'
 16600         GO TO 6600-EXIT.
 16601
 16602     IF DL35-RETURN-CODE = '01'
 16603         MOVE ER-7830            TO EMI-ERROR
 16604         GO TO 6500-BAD-EXIT.
 16605
 16606     IF DL35-RETURN-CODE = '02'
 16607         MOVE ER-7831            TO EMI-ERROR
 16608         GO TO 6500-BAD-EXIT.
 16609
 16610     IF DL35-RETURN-CODE = '03'
 16611         MOVE ER-7832            TO EMI-ERROR
 16612         GO TO 6500-BAD-EXIT.
 16613
 16614     IF DL35-RETURN-CODE = '04'
 16615         MOVE ER-7833            TO EMI-ERROR
 16616         GO TO 6500-BAD-EXIT.
 16617
 16618     IF DL35-RETURN-CODE = '05'
 16619         MOVE ER-7834            TO EMI-ERROR
 16620         GO TO 6500-BAD-EXIT.
 16621
 16622     IF DL35-RETURN-CODE = '06'
 16623         MOVE ER-7835            TO EMI-ERROR
 16624         GO TO 6500-BAD-EXIT.
 16625
 16626     IF DL35-RETURN-CODE = '07'
 16627         MOVE ER-7836            TO EMI-ERROR
 16628         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 318
* EL156.cbl
 16629
 16630     IF DL35-RETURN-CODE = 'E1'
 16631         MOVE ER-7837            TO EMI-ERROR
 16632         GO TO 6500-BAD-EXIT.
 16633
 16634     IF DL35-RETURN-CODE NOT = 'OK'
 16635         MOVE ER-7838            TO EMI-ERROR
 16636         GO TO 6500-BAD-EXIT.
 16637
 16638 6600-EXIT.
 16639      EXIT.
 16640
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 319
* EL156.cbl
 16642 6700-UPDATE-ACTQ.
 16643***************************************************************
 16644*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16645*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16646*    ONE ALREADY THERE.                                       *
 16647***************************************************************
 16648
 16649
 16650* EXEC CICS HANDLE CONDITION
 16651*         NOTFND(6720-BUILD-NEW-RECORD)
 16652*     END-EXEC.
 16653*    MOVE '"$I                   ! 6 #00015445' TO DFHEIV0
 16654     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16656     MOVE X'3620233030303135343435' TO DFHEIV0(25:11)
 16657     CALL 'kxdfhei1' USING DFHEIV0
 16658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16659
 16660
 16661
 16662* EXEC CICS READ
 16663*         DATASET('ELACTQ')
 16664*         RIDFLD (ELMSTR-KEY)
 16665*         SET    (ADDRESS OF ACTIVITY-QUE)
 16666*         UPDATE
 16667*     END-EXEC.
 16668     MOVE 'ELACTQ' TO DFHEIV1
 16669*    MOVE '&"S        EU         (   #00015449' TO DFHEIV0
 16670     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16672     MOVE X'2020233030303135343439' TO DFHEIV0(25:11)
 16673     CALL 'kxdfhei1' USING DFHEIV0,
 16674           DFHEIV1,
 16675           DFHEIV20,
 16676           DFHEIV99,
 16677           ELMSTR-KEY,
 16678           DFHEIV99,
 16679           DFHEIV99,
 16680           DFHEIV99
 16681     SET ADDRESS OF ACTIVITY-QUE TO
 16682         DFHEIV20
 16683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16684
 16685
 16686     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16687
 16688     IF PI-AIG-SPECIAL-BENEFIT AND
 16689        PI-CASH = 'Y'
 16690         ADD 2                   TO AQ-PAYMENT-COUNTER
 16691     ELSE
 16692         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16693
 16694     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16695         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16696
 16697     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16698
 16699     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 320
* EL156.cbl
 16700         IF WS-PMT-APPROVAL-SW = 'A'
 16701             NEXT SENTENCE
 16702         ELSE
 16703            IF PI-AIG-SPECIAL-BENEFIT AND
 16704               PI-CASH = 'Y'
 16705                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16706                                     WS-PMT-UNAPPROVED-CNT
 16707            ELSE
 16708                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16709                                     WS-PMT-UNAPPROVED-CNT
 16710     ELSE
 16711         IF PI-PMT-APPR-SW = 'Y'
 16712            IF PI-AIG-SPECIAL-BENEFIT AND
 16713               PI-CASH = 'Y'
 16714                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16715                                     WS-PMT-UNAPPROVED-CNT
 16716            ELSE
 16717                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16718                                     WS-PMT-UNAPPROVED-CNT.
 16719
 16720     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16721         MOVE ER-3536 TO EMI-ERROR
 16722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723
 16724     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16725
 16726
 16727* EXEC CICS REWRITE
 16728*         DATASET('ELACTQ')
 16729*         FROM   (ACTIVITY-QUE)
 16730*     END-EXEC.
 16731     MOVE LENGTH OF
 16732      ACTIVITY-QUE
 16733       TO DFHEIV11
 16734     MOVE 'ELACTQ' TO DFHEIV1
 16735*    MOVE '&& L                  %   #00015496' TO DFHEIV0
 16736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16738     MOVE X'2020233030303135343936' TO DFHEIV0(25:11)
 16739     CALL 'kxdfhei1' USING DFHEIV0,
 16740           DFHEIV1,
 16741           ACTIVITY-QUE,
 16742           DFHEIV11,
 16743           DFHEIV99
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16745
 16746
 16747     GO TO 6799-EXIT.
 16748
 16749 6720-BUILD-NEW-RECORD.
 16750
 16751* EXEC CICS GETMAIN
 16752*         SET    (ADDRESS OF ACTIVITY-QUE)
 16753*         LENGTH (60)
 16754*         INITIMG(GETMAIN-SPACE)
 16755*     END-EXEC.
 16756     MOVE 60
 16757       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 321
* EL156.cbl
 16758*    MOVE ',"IL                  $   #00015504' TO DFHEIV0
 16759     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16761     MOVE X'2020233030303135353034' TO DFHEIV0(25:11)
 16762     CALL 'kxdfhei1' USING DFHEIV0,
 16763           DFHEIV20,
 16764           DFHEIV11,
 16765           GETMAIN-SPACE
 16766     SET ADDRESS OF ACTIVITY-QUE TO
 16767         DFHEIV20
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16772
 16773     IF PI-AIG-SPECIAL-BENEFIT AND
 16774        PI-CASH = 'Y'
 16775         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16776     ELSE
 16777         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16778
 16779     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16780     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16781     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16782     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16783                                    AQ-FOLLOWUP-DATE.
 16784     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16785     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16786
 16787     IF PI-PMT-GRADUATED
 16788         IF WS-PMT-APPROVAL-SW = 'A'
 16789             NEXT SENTENCE
 16790         ELSE
 16791            IF PI-AIG-SPECIAL-BENEFIT AND
 16792               PI-CASH = 'Y'
 16793                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16794            ELSE
 16795                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16796     ELSE
 16797         IF PI-PMT-APPR-SW = 'Y'
 16798            IF PI-AIG-SPECIAL-BENEFIT AND
 16799               PI-CASH = 'Y'
 16800                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16801            ELSE
 16802                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16803
 16804     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16805         MOVE ER-3536 TO EMI-ERROR
 16806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16807
 16808
 16809* EXEC CICS WRITE
 16810*         DATASET('ELACTQ')
 16811*         RIDFLD (ELMSTR-KEY)
 16812*         FROM   (ACTIVITY-QUE)
 16813*     END-EXEC.
 16814     MOVE LENGTH OF
 16815      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 322
* EL156.cbl
 16816       TO DFHEIV11
 16817     MOVE 'ELACTQ' TO DFHEIV1
 16818*    MOVE '&$ L                  ''   #00015547' TO DFHEIV0
 16819     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303135353437' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0,
 16823           DFHEIV1,
 16824           ACTIVITY-QUE,
 16825           DFHEIV11,
 16826           ELMSTR-KEY,
 16827           DFHEIV99,
 16828           DFHEIV99
 16829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16830
 16831
 16832 6799-EXIT.
 16833      EXIT.
 16834
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 323
* EL156.cbl
 16836 6800-BUILD-FORM-TRAILER.
 16837
 16838
 16839* EXEC CICS GETMAIN
 16840*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16841*         LENGTH   (200)
 16842*         INITIMG  (GETMAIN-SPACE)
 16843*    END-EXEC.
 16844     MOVE 200
 16845       TO DFHEIV11
 16846*    MOVE ',"IL                  $   #00015559' TO DFHEIV0
 16847     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16848     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16849     MOVE X'2020233030303135353539' TO DFHEIV0(25:11)
 16850     CALL 'kxdfhei1' USING DFHEIV0,
 16851           DFHEIV20,
 16852           DFHEIV11,
 16853           GETMAIN-SPACE
 16854     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16855         DFHEIV20
 16856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16857
 16858
 16859     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16860
 16861     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16862     MOVE 'AT'                   TO AT-RECORD-ID.
 16863     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16864
 16865     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16866     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16867                                    AT-FORM-LAST-MAINT-DT
 16868                                    AT-FORM-SEND-ON-DT.
 16869     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16870                                    AT-FORM-LAST-UPDATED-BY.
 16871     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16872     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16873     MOVE '6'                    TO DC-OPTION-CODE.
 16874     MOVE +29                    TO DC-ELAPSED-DAYS.
 16875     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16876     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16877     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16878
 16879     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16880         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16881
 16882     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16883                                    AT-FORM-RE-SEND-DT
 16884                                    AT-EMP-FORM-ANSWERED-DT
 16885                                    AT-PHY-FORM-ANSWERED-DT
 16886                                    AT-EMP-FORM-SEND-ON-DT
 16887                                    AT-PHY-FORM-SEND-ON-DT
 16888                                    AT-FORM-PRINTED-DT
 16889                                    AT-FORM-REPRINT-DT.
 16890     MOVE '2'                    TO AT-FORM-TYPE.
 16891
 16892     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16893     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 324
* EL156.cbl
 16894
 16895     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16896         NEXT SENTENCE
 16897     ELSE
 16898         IF CL-PROG-FORM-TYPE NOT = 'S'
 16899            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16900
 16901
 16902* EXEC CICS WRITE
 16903*         DATASET  ('ELTRLR')
 16904*         FROM     (ACTIVITY-TRAILERS)
 16905*         RIDFLD   (AT-CONTROL-PRIMARY)
 16906*     END-EXEC.
 16907     MOVE LENGTH OF
 16908      ACTIVITY-TRAILERS
 16909       TO DFHEIV11
 16910     MOVE 'ELTRLR' TO DFHEIV1
 16911*    MOVE '&$ L                  ''   #00015607' TO DFHEIV0
 16912     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16914     MOVE X'2020233030303135363037' TO DFHEIV0(25:11)
 16915     CALL 'kxdfhei1' USING DFHEIV0,
 16916           DFHEIV1,
 16917           ACTIVITY-TRAILERS,
 16918           DFHEIV11,
 16919           AT-CONTROL-PRIMARY,
 16920           DFHEIV99,
 16921           DFHEIV99
 16922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16923
 16924
 16925 6899-EXIT.
 16926      EXIT.
 16927
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 325
* EL156.cbl
 16929 6900-BUILD-ARCHIVE-HEADER.
 16930
 16931     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16932     MOVE '1'                    TO CNTL-REC-TYPE.
 16933     MOVE +0                     TO CNTL-SEQ-NO.
 16934     MOVE SPACES                 TO CNTL-ACCESS.
 16935
 16936
 16937* EXEC CICS READ
 16938*         DATASET  ('ELCNTL')
 16939*         SET      (ADDRESS OF CONTROL-FILE)
 16940*         RIDFLD   (ELCNTL-KEY)
 16941*         UPDATE
 16942*    END-EXEC.
 16943     MOVE 'ELCNTL' TO DFHEIV1
 16944*    MOVE '&"S        EU         (   #00015624' TO DFHEIV0
 16945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16946     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16947     MOVE X'2020233030303135363234' TO DFHEIV0(25:11)
 16948     CALL 'kxdfhei1' USING DFHEIV0,
 16949           DFHEIV1,
 16950           DFHEIV20,
 16951           DFHEIV99,
 16952           ELCNTL-KEY,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99
 16956     SET ADDRESS OF CONTROL-FILE TO
 16957         DFHEIV20
 16958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16959
 16960
 16961     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16962     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16963
 16964
 16965* EXEC CICS REWRITE
 16966*         FROM     (CONTROL-FILE)
 16967*         DATASET  ('ELCNTL')
 16968*    END-EXEC.
 16969     MOVE LENGTH OF
 16970      CONTROL-FILE
 16971       TO DFHEIV11
 16972     MOVE 'ELCNTL' TO DFHEIV1
 16973*    MOVE '&& L                  %   #00015634' TO DFHEIV0
 16974     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16975     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16976     MOVE X'2020233030303135363334' TO DFHEIV0(25:11)
 16977     CALL 'kxdfhei1' USING DFHEIV0,
 16978           DFHEIV1,
 16979           CONTROL-FILE,
 16980           DFHEIV11,
 16981           DFHEIV99
 16982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16983
 16984
 16985
 16986* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 326
* EL156.cbl
 16987*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16988*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16989*    END-EXEC.
 16990*    MOVE '"$$%                  ! 7 #00015639' TO DFHEIV0
 16991     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16993     MOVE X'3720233030303135363339' TO DFHEIV0(25:11)
 16994     CALL 'kxdfhei1' USING DFHEIV0
 16995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16996
 16997
 16998
 16999* EXEC CICS GETMAIN
 17000*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17001*         LENGTH  (ELARCH-LENGTH)
 17002*         INITIMG (GETMAIN-SPACE)
 17003*    END-EXEC.
 17004*    MOVE ',"IL                  $   #00015644' TO DFHEIV0
 17005     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17007     MOVE X'2020233030303135363434' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0,
 17009           DFHEIV20,
 17010           ELARCH-LENGTH,
 17011           GETMAIN-SPACE
 17012     SET ADDRESS OF LETTER-ARCHIVE TO
 17013         DFHEIV20
 17014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17015
 17016
 17017     MOVE 'LA'                   TO LA-RECORD-ID.
 17018     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17019                                    LA-ARCHIVE-NO-A1.
 17020     MOVE '4'                    TO LA-RECORD-TYPE
 17021                                    LA-RECORD-TYPE-A1.
 17022     MOVE +0                     TO LA-LINE-SEQ-NO
 17023                                    LA-LINE-SEQ-NO-A1.
 17024     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17025                                    LA-COMPANY-CD-A1.
 17026     MOVE CL-CARRIER             TO LA4-CARRIER.
 17027     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17028     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17029     MOVE CL-CERT-STATE          TO LA4-STATE.
 17030     MOVE +0                     TO LA4-NO-OF-COPIES.
 17031     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17032     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17033     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17034                                    LA4-INITIAL-PRINT-DATE
 17035                                    LA4-RESEND-PRINT-DATE
 17036                                    LA4-FORM-REM-PRINT-DT.
 17037     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17038     MOVE '2'                    TO LA4-FORM-TYPE.
 17039
 17040
 17041* EXEC CICS WRITE
 17042*         DATASET  ('ELARCH')
 17043*         FROM     (LETTER-ARCHIVE)
 17044*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 327
* EL156.cbl
 17045*    END-EXEC.
 17046     MOVE LENGTH OF
 17047      LETTER-ARCHIVE
 17048       TO DFHEIV11
 17049     MOVE 'ELARCH' TO DFHEIV1
 17050*    MOVE '&$ L                  ''   #00015673' TO DFHEIV0
 17051     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17053     MOVE X'2020233030303135363733' TO DFHEIV0(25:11)
 17054     CALL 'kxdfhei1' USING DFHEIV0,
 17055           DFHEIV1,
 17056           LETTER-ARCHIVE,
 17057           DFHEIV11,
 17058           LA-CONTROL-PRIMARY,
 17059           DFHEIV99,
 17060           DFHEIV99
 17061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17062
 17063
 17064 6999-EXIT.
 17065      EXIT.
 17066
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 328
* EL156.cbl
 17068 7000-SHOW-CLAIM.
 17069     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17070     MOVE 'A'                    TO PI-PASS-SW.
 17071     MOVE LOW-VALUES             TO PI-CPYFROM
 17072                                    PI-MONTH-END-SAVE
 17073                                    PI-CPYTHRU.
 17074
 17075     MOVE ZEROS                  TO PI-FATAL-COUNT
 17076                                    PI-DAILY-RATE
 17077                                    PI-BEN-DAYS
 17078                                    PI-MANUAL-SW
 17079                                    PI-SAVE-CURSOR
 17080                                    PI-FORCE-COUNT
 17081                                    PI-HOLDTIL
 17082                                    PI-EPYFROM
 17083                                    PI-EPYTHRU
 17084                                    PI-EDAYS
 17085                                    PI-EPYAMT
 17086                                    PI-ERESV
 17087                                    PI-EEXPENS
 17088                                    PI-CDAYS
 17089                                    PI-CPYAMT
 17090                                    PI-CRESV
 17091                                    PI-CEXPENS
 17092                                    PI-INT-RATE
 17093                                    PI-AIGFROM.
 17094     MOVE ZEROS                  TO PI-PROOF-DATE.
 17095     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17096                                    PI-REM-BEN-AMT
 17097                                    PI-MO-BEN-AMT
 17098                                    pi-ah-term.
 17099
 17100     MOVE LOW-VALUES             TO EL156AI.
 17101     MOVE MAP-NAMEA              TO MAP-NAME.
 17102
 17103* EXEC CICS HANDLE CONDITION
 17104*        NOTFND   (7010-BUILD-MAP)
 17105*    END-EXEC.
 17106*    MOVE '"$I                   ! 8 #00015717' TO DFHEIV0
 17107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17109     MOVE X'3820233030303135373137' TO DFHEIV0(25:11)
 17110     CALL 'kxdfhei1' USING DFHEIV0
 17111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17112
 17113
 17114     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17115     MOVE '2'                    TO CNTL-REC-TYPE.
 17116     MOVE +0                     TO CNTL-SEQ-NO.
 17117     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17118
 17119
 17120* EXEC CICS READ
 17121*         DATASET  ('ELCNTL')
 17122*         SET      (ADDRESS OF CONTROL-FILE)
 17123*         RIDFLD   (ELCNTL-KEY)
 17124*    END-EXEC.
 17125     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 329
* EL156.cbl
 17126*    MOVE '&"S        E          (   #00015726' TO DFHEIV0
 17127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17129     MOVE X'2020233030303135373236' TO DFHEIV0(25:11)
 17130     CALL 'kxdfhei1' USING DFHEIV0,
 17131           DFHEIV1,
 17132           DFHEIV20,
 17133           DFHEIV99,
 17134           ELCNTL-KEY,
 17135           DFHEIV99,
 17136           DFHEIV99,
 17137           DFHEIV99
 17138     SET ADDRESS OF CONTROL-FILE TO
 17139         DFHEIV20
 17140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17141
 17142
 17143     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17144
 17145     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17146         MOVE AL-UANON      TO SURVYYNA
 17147     END-IF.
 17148
 17149
 17150     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17151     MOVE '1'                    TO CNTL-REC-TYPE.
 17152     MOVE SPACES                 TO CNTL-ACCESS.
 17153     MOVE +0                     TO CNTL-SEQ-NO.
 17154
 17155
 17156* EXEC CICS READ
 17157*         DATASET  ('ELCNTL')
 17158*         SET      (ADDRESS OF CONTROL-FILE)
 17159*         RIDFLD   (ELCNTL-KEY)
 17160*    END-EXEC.
 17161     MOVE 'ELCNTL' TO DFHEIV1
 17162*    MOVE '&"S        E          (   #00015744' TO DFHEIV0
 17163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17165     MOVE X'2020233030303135373434' TO DFHEIV0(25:11)
 17166     CALL 'kxdfhei1' USING DFHEIV0,
 17167           DFHEIV1,
 17168           DFHEIV20,
 17169           DFHEIV99,
 17170           ELCNTL-KEY,
 17171           DFHEIV99,
 17172           DFHEIV99,
 17173           DFHEIV99
 17174     SET ADDRESS OF CONTROL-FILE TO
 17175         DFHEIV20
 17176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17177
 17178
 17179     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17180
 17181 7010-BUILD-MAP.
 17182
 17183
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 330
* EL156.cbl
 17184* EXEC CICS HANDLE CONDITION
 17185*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17186*    END-EXEC.
 17187*    MOVE '"$I                   ! 9 #00015754' TO DFHEIV0
 17188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17190     MOVE X'3920233030303135373534' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0
 17192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17193
 17194
 17195     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17196     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17197     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17198     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17199     MOVE 'MSTR'                 TO FILE-SWITCH.
 17200
 17201     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17202
 17203     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17204     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17205     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17206     MOVE CL-CCN                 TO PI-SV-CCN.
 17207
 17208     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17209     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17210     MOVE CL-CLAIM-NO            TO CLMNOO.
 17211     MOVE CL-CARRIER             TO CARRO.
 17212     MOVE CL-CERT-PRIME          TO CERTNOO.
 17213     MOVE CL-CERT-SFX            TO SUFXO.
 17214
 17215     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17216        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17217        CONTINUE
 17218     ELSE
 17219        MOVE AL-SADOF            TO ZINTHA
 17220                                    ZINTA
 17221                                    PINTHA
 17222                                    PINTA
 17223     END-IF
 17224     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17225     EVALUATE TRUE
 17226     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17227         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17228     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17229         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17230
 17231     WHEN CL-CLAIM-TYPE = 'I'
 17232         MOVE '  IU  '           TO CLMTYPO
 17233     WHEN CL-CLAIM-TYPE = 'G'
 17234         MOVE ' GAP  '           TO CLMTYPO
 17235     END-EVALUATE.
 17236     IF CLAIM-IS-OPEN
 17237         MOVE ' OPEN'            TO CLMSTATO
 17238     ELSE
 17239         MOVE 'CLOSED'           TO CLMSTATO.
 17240
 17241     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 331
* EL156.cbl
 17242
 17243     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17244         MOVE SPACES             TO  PCERTNOO
 17245                                     PSUFXO
 17246                                     PRIMHDGO
 17247                                     SEQUO
 17248         MOVE AL-SADOF           TO  PCERTNOA
 17249                                     PSUFXA
 17250                                     PRIMHDGA
 17251                                     SEQUA
 17252     ELSE
 17253         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17254         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17255         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17256         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17257         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17258         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17259         MOVE AL-SANON               TO  PCERTNOA
 17260                                         PSUFXA
 17261                                         PRIMHDGA
 17262         MOVE AL-SABON               TO  SEQUA.
 17263
 17264     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17265
 17266     IF CL-NO-OF-PMTS-MADE = 0 AND
 17267        CL-TOTAL-PAID-AMT = 0
 17268         NEXT SENTENCE
 17269     ELSE
 17270         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17271             IF NOT PI-USES-PAID-TO
 17272                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17273                 MOVE ' '                 TO DC-OPTION-CODE
 17274                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17275                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17276             ELSE
 17277                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17278                 MOVE '6'                 TO DC-OPTION-CODE
 17279                 MOVE +1                  TO DC-ELAPSED-DAYS
 17280                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17281                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17282                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17283
 17284     IF MAP-NAME = 'EL156A'
 17285        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17286           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17287             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17288           end-if
 17289        end-if
 17290     end-if
 17291     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17292         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17293         MOVE ' '                TO DC-OPTION-CODE
 17294         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17295         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17296
 17297     IF CL-INCURRED-DT NOT = LOW-VALUES
 17298         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17299         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 332
* EL156.cbl
 17300         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17301         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17302
 17303     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17304
 17305     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17306         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17307         MOVE ' '                TO DC-OPTION-CODE
 17308         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17309         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17310
 17311     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17312         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17313         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17314     ELSE
 17315         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17316         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17317
 17318     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17319     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17320     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17321     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17322                                    PI-GROUPING.
 17323     MOVE CL-CERT-STATE          TO CERT-STATE
 17324                                    PI-STATE.
 17325     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17326                                    PI-ACCOUNT.
 17327     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17328     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17329     MOVE 'CERT'                 TO FILE-SWITCH.
 17330
 17331     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17332     perform 7975-read-acct      thru 7975-exit
 17333     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17334     MOVE PI-STATE               TO WS-ST-ACCESS.
 17335     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17336     MOVE '3'                    TO CNTL-REC-TYPE.
 17337     MOVE +0                     TO CNTL-SEQ-NO.
 17338     MOVE 'STAT'                 TO FILE-SWITCH.
 17339
 17340     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17341
 17342     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17343     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17344
 17345     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17346        GO TO 7020-BYPASS-BENEFIT.
 17347
 17348     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17349     MOVE '4'                    TO CNTL-REC-TYPE.
 17350     MOVE +0                     TO CNTL-SEQ-NO.
 17351     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17352     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17353     MOVE 'BENE'                 TO FILE-SWITCH.
 17354
 17355     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17356
 17357     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 333
* EL156.cbl
 17358        GO TO 7020-BYPASS-BENEFIT.
 17359
 17360     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17361     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17362     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17363
 17364 7020-BYPASS-BENEFIT.
 17365
 17366*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17367*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17368*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17369
 17370     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17371         GO TO 7021-GO-TO-LIFE.
 17372     move zeros                  to PI-MAX-BENEFIT-AMT
 17373     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17374     move cm-ah-orig-term        to pi-ah-term
 17375     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17376
 17377     IF (PI-COMPANY-ID = 'DCC')
 17378        and (acct-found)
 17379        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17380        PERFORM 0900-GET-DDF-limits
 17381                                 THRU 0900-EXIT
 17382        IF PDEF-FOUND
 17383           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17384              (P1 > +8)
 17385              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17386           END-PERFORM
 17387           IF P1 < +9
 17388              MOVE PD-MAX-AMT (P1)
 17389                                 TO PI-MAX-BENEFIT-AMT
 17390           END-IF
 17391        END-IF
 17392     end-if
 17393     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17394     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17395     if (pi-max-benefit-amt not = zeros)
 17396        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17397        move pi-max-benefit-amt  to beneo
 17398     else
 17399        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17400     end-if
 17401     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17402     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17403                                    CP-ORIGINAL-TERM.
 17404     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17405
 17406*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17407*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17408*    ELSE
 17409         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17410
 17411     MOVE ' '                    TO DC-OPTION-CODE.
 17412     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17413     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17414
 17415     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 334
* EL156.cbl
 17416         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17417         GO TO 7023-BYPASS-REMAINING-TERM.
 17418
 17419     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17420     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17421     GO TO 7022-AROUND-LIFE.
 17422
 17423 7021-GO-TO-LIFE.
 17424
 17425     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17426     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17427     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17428                                    CP-ORIGINAL-TERM.
 17429     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17430     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17431     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17432     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17433
 17434     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17435         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17436     ELSE
 17437         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17438
 17439     MOVE ' '                    TO DC-OPTION-CODE.
 17440     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17441     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17442
 17443 7022-AROUND-LIFE.
 17444
 17445     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17446     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17447     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17448     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17449     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17450     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17451     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17452
 17453     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17454
 17455     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17456        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17457           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17458
 17459     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17460        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17461           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17462
 17463 7023-BYPASS-REMAINING-TERM.
 17464     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17465       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17466          MOVE ZEROS                  TO BENEO
 17467       ELSE
 17468          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17469          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17470          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17471          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17472          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17473          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 335
* EL156.cbl
 17474          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17475          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17476          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17477          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17478          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17479          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17480          IF (PI-COMPANY-ID = 'DCC')
 17481             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17482             PERFORM 0900-GET-DDF-limits
 17483                                 THRU 0900-EXIT
 17484             IF PDEF-FOUND
 17485                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17486                   (P1 > +8)
 17487                   OR (PD-PROD-CODE (P1) = 'L')
 17488                END-PERFORM
 17489                IF P1 < +9
 17490                   MOVE PD-MAX-AMT (P1)
 17491                                 TO CP-R-MAX-TOT-BEN
 17492                END-IF
 17493             END-IF
 17494          END-IF
 17495
 17496* EXEC CICS LINK
 17497*            PROGRAM  (LINK-REMAMT)
 17498*            COMMAREA (CALCULATION-PASS-AREA)
 17499*            LENGTH   (CP-COMM-LENGTH)
 17500*         END-EXEC
 17501*    MOVE '."C                   (   #00016058' TO DFHEIV0
 17502     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17504     MOVE X'2020233030303136303538' TO DFHEIV0(25:11)
 17505     CALL 'kxdfhei1' USING DFHEIV0,
 17506           LINK-REMAMT,
 17507           CALCULATION-PASS-AREA,
 17508           CP-COMM-LENGTH,
 17509           DFHEIV99,
 17510           DFHEIV99,
 17511           DFHEIV99,
 17512           DFHEIV99
 17513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17514          MOVE CP-REMAINING-AMT       TO BENEO
 17515       end-if
 17516     end-if
 17517     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17518     MOVE +95                    TO TRLR-SEQ-NO
 17519
 17520* EXEC CICS READ
 17521*       DATASET  ('ELTRLR')
 17522*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17523*       RIDFLD   (ELTRLR-KEY)
 17524*       RESP     (WS-RESPONSE)
 17525*    END-EXEC
 17526     MOVE 'ELTRLR' TO DFHEIV1
 17527*    MOVE '&"S        E          (  N#00016068' TO DFHEIV0
 17528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17530     MOVE X'204E233030303136303638' TO DFHEIV0(25:11)
 17531     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 336
* EL156.cbl
 17532           DFHEIV1,
 17533           DFHEIV20,
 17534           DFHEIV99,
 17535           ELTRLR-KEY,
 17536           DFHEIV99,
 17537           DFHEIV99,
 17538           DFHEIV99
 17539     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17540         DFHEIV20
 17541     MOVE EIBRESP  TO WS-RESPONSE
 17542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17543
 17544     if ws-resp-normal
 17545        perform varying s1 from +1 by +1 until
 17546           at-note-error-no (s1) = spaces
 17547           move at-note-error-no (s1)
 17548                                 to emi-error
 17549           if at-note-error-no (s1) = '1653'
 17550              evaluate true
 17551                 when cl-claim-type = 'L'
 17552                    move '  LF  '
 17553                                 to emi-claim-type
 17554                 when cl-claim-type = 'I'
 17555                    move '  IU  '
 17556                                 to emi-claim-type
 17557                 when other
 17558                    move '  AH  '
 17559                                 to emi-claim-type
 17560              end-evaluate
 17561           end-if
 17562           PERFORM 9900-ERROR-FORMAT
 17563                                 THRU 9900-EXIT
 17564        end-perform
 17565     end-if
 17566     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17567         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17568            WS-LF-COVERAGE-TYPE = 'P'
 17569             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17570                                        CM-LF-ITD-DEATH-AMT
 17571             MOVE WS-REMAINING-AMT  TO  BENEO.
 17572
 17573     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17574     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17575     MOVE WS-TERMS               TO TERMSO.
 17576
 17577     IF WS-STATUS = '6' OR '7' OR '8'
 17578         MOVE AL-SABOF           TO CRTSTATA.
 17579
 17580     IF WS-STATUS = '1' OR '4'
 17581        IF CP-REMAINING-TERM-3 = ZEROS
 17582           MOVE 'EXPIRED'        TO CRTSTATO
 17583        ELSE
 17584           MOVE 'ACTIVE  '       TO CRTSTATO.
 17585
 17586     IF WS-STATUS = '2'
 17587         MOVE 'PEND    '         TO CRTSTATO.
 17588
 17589     IF WS-STATUS = '3'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 337
* EL156.cbl
 17590         MOVE 'RESTORE '         TO CRTSTATO.
 17591
 17592     IF WS-STATUS = '5'
 17593         MOVE 'REISSUE '         TO CRTSTATO.
 17594
 17595     IF WS-STATUS = '6'
 17596         MOVE 'LMP DIS'          TO CRTSTATO.
 17597
 17598     IF WS-STATUS = '7'
 17599         MOVE 'DEATH'            TO CRTSTATO.
 17600
 17601     IF WS-STATUS = '8'
 17602         MOVE 'CANCEL'           TO CRTSTATO.
 17603
 17604     IF WS-STATUS = '9'
 17605         MOVE 'RE-ONLY '         TO CRTSTATO.
 17606
 17607     IF WS-STATUS = 'V'
 17608         MOVE 'VOID  '           TO CRTSTATO.
 17609
 17610     IF WS-STATUS = 'D'
 17611         MOVE 'DECLINE '         TO CRTSTATO.
 17612
 17613     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17614         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17615         MOVE '5'                TO CNTL-REC-TYPE
 17616     ELSE
 17617         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17618         MOVE '4'                TO CNTL-REC-TYPE.
 17619
 17620     MOVE '** NONE **'           TO COVERO.
 17621     MOVE AL-SABON               TO COVERA.
 17622
 17623     IF PI-COMPANY-ID = 'CVL'
 17624         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17625             MOVE CM-BENEFICIARY TO LOANNOO
 17626             MOVE AL-UANON       TO LOANNOA.
 17627
 17628     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17629        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17630        MOVE +91                 TO  TRLR-SEQ-NO
 17631
 17632* EXEC CICS READ
 17633*           DATASET  ('ELTRLR')
 17634*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17635*           RIDFLD   (ELTRLR-KEY)
 17636*           RESP     (WS-RESPONSE)
 17637*       END-EXEC
 17638     MOVE 'ELTRLR' TO DFHEIV1
 17639*    MOVE '&"S        E          (  N#00016162' TO DFHEIV0
 17640     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17642     MOVE X'204E233030303136313632' TO DFHEIV0(25:11)
 17643     CALL 'kxdfhei1' USING DFHEIV0,
 17644           DFHEIV1,
 17645           DFHEIV20,
 17646           DFHEIV99,
 17647           ELTRLR-KEY,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 338
* EL156.cbl
 17648           DFHEIV99,
 17649           DFHEIV99,
 17650           DFHEIV99
 17651     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17652         DFHEIV20
 17653     MOVE EIBRESP  TO WS-RESPONSE
 17654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17655
 17656        IF WS-RESP-NORMAL
 17657           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17658        ELSE
 17659           MOVE SPACES           TO  LOANNOO
 17660        END-IF
 17661*052506
 17662*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17663*052506
 17664     END-IF
 17665
 17666     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17667        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17668
 17669     IF WS-BEN-CD = ZEROS
 17670         GO TO 7050-SHOW-CONTINUE.
 17671
 17672     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17673     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17674     MOVE +0                     TO CNTL-SEQ-NO.
 17675     MOVE 'BENE'                 TO FILE-SWITCH.
 17676
 17677     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17678
 17679     IF BENEFIT-FOUND
 17680         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17681         MOVE AL-SANON                    TO COVERA.
 17682
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 339
* EL156.cbl
 17684 7050-SHOW-CONTINUE.
 17685
 17686     IF PI-COMPANY-ID = 'DMD'
 17687         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17688
 17689     MOVE -1                     TO PMTTYPEL.
 17690     GO TO 8100-SEND-INITIAL-MAP.
 17691
 17692 7100-SHOW-RECORD-NOT-FOUND.
 17693     IF FILE-SWITCH = 'MSTR'
 17694         MOVE ER-0204            TO EMI-ERROR.
 17695
 17696     IF FILE-SWITCH = 'CERT'
 17697         MOVE ER-0206            TO EMI-ERROR.
 17698
 17699     IF FILE-SWITCH = 'STAT'
 17700         MOVE ER-0149            TO EMI-ERROR.
 17701
 17702     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17703
 17704     MOVE -1                     TO PMTTYPEL.
 17705     GO TO 8100-SEND-INITIAL-MAP
 17706
 17707     .
 17708 7110-BUILD-PMT-TRLR.
 17709     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17710     MOVE +51                    TO TRLR-SEQ-NO
 17711
 17712* EXEC CICS READ
 17713*        DATASET  ('ELTRLR')
 17714*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17715*        RIDFLD   (ELTRLR-KEY)
 17716*        RESP     (WS-RESPONSE)
 17717*    END-EXEC
 17718     MOVE 'ELTRLR' TO DFHEIV1
 17719*    MOVE '&"S        E          (  N#00016224' TO DFHEIV0
 17720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17722     MOVE X'204E233030303136323234' TO DFHEIV0(25:11)
 17723     CALL 'kxdfhei1' USING DFHEIV0,
 17724           DFHEIV1,
 17725           DFHEIV20,
 17726           DFHEIV99,
 17727           ELTRLR-KEY,
 17728           DFHEIV99,
 17729           DFHEIV99,
 17730           DFHEIV99
 17731     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17732         DFHEIV20
 17733     MOVE EIBRESP  TO WS-RESPONSE
 17734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17735     IF WS-RESP-NORMAL
 17736        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17737     END-IF
 17738     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17739
 17740* EXEC CICS GETMAIN
 17741*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 340
* EL156.cbl
 17742*         LENGTH    (200)
 17743*         INITIMG   (GETMAIN-SPACE)
 17744*     END-EXEC
 17745     MOVE 200
 17746       TO DFHEIV11
 17747*    MOVE ',"IL                  $   #00016234' TO DFHEIV0
 17748     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17749     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17750     MOVE X'2020233030303136323334' TO DFHEIV0(25:11)
 17751     CALL 'kxdfhei1' USING DFHEIV0,
 17752           DFHEIV20,
 17753           DFHEIV11,
 17754           GETMAIN-SPACE
 17755     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17756         DFHEIV20
 17757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17758     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17759                                    AT-PREV-PAID-THRU-DT
 17760     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17761     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17762     MOVE 'AT'                   TO AT-RECORD-ID
 17763     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17764     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17765     MOVE '2'                    TO AT-TRAILER-TYPE
 17766     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17767                                    AT-PAYMENT-LAST-MAINT-DT
 17768     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17769                                    AT-PAYMENT-LAST-UPDATED-BY
 17770     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17771     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17772     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17773     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17774     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17775     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17776     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17777     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17778     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17779     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17780     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17781     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17782     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17783     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17784     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17785     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17786                                    AT-TO-BE-WRITTEN-DT
 17787     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17788                                    AT-CHECK-QUE-SEQUENCE
 17789                                    AT-ADDL-RESERVE
 17790     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17791                                    AT-VOID-SELECT-DT
 17792                                    AT-VOID-ACCEPT-DT
 17793                                    AT-VOID-DT
 17794                                    AT-PMT-PROOF-DT
 17795                                    AT-INT-PMT-SELECT-DT
 17796     MOVE ZEROS                  TO AT-DAILY-RATE
 17797                                    AT-ELIMINATION-DAYS
 17798     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17799*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 341
* EL156.cbl
 17800*        DUPREC    (7120-DUPREC)
 17801*    END-EXEC
 17802     .
 17803 7115-WRITE-INT-TRLR.
 17804
 17805* EXEC CICS WRITE
 17806*         DATASET       ('ELTRLR')
 17807*         FROM          (ACTIVITY-TRAILERS)
 17808*         RIDFLD        (AT-CONTROL-PRIMARY)
 17809*         RESP          (WS-RESPONSE)
 17810*     END-EXEC
 17811     MOVE LENGTH OF
 17812      ACTIVITY-TRAILERS
 17813       TO DFHEIV11
 17814     MOVE 'ELTRLR' TO DFHEIV1
 17815*    MOVE '&$ L                  ''  N#00016285' TO DFHEIV0
 17816     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17818     MOVE X'204E233030303136323835' TO DFHEIV0(25:11)
 17819     CALL 'kxdfhei1' USING DFHEIV0,
 17820           DFHEIV1,
 17821           ACTIVITY-TRAILERS,
 17822           DFHEIV11,
 17823           AT-CONTROL-PRIMARY,
 17824           DFHEIV99,
 17825           DFHEIV99
 17826     MOVE EIBRESP  TO WS-RESPONSE
 17827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17828      IF WS-RESP-DUPREC
 17829         GO TO 7120-DUPREC
 17830      END-IF
 17831     GO TO 7130-EXIT
 17832     .
 17833 7120-DUPREC.
 17834     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17835     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17836     GO TO 7115-WRITE-INT-TRLR
 17837     .
 17838 7130-EXIT.
 17839      EXIT.
 17840 7140-BUILD-NOTE-TRLR.
 17841
 17842
 17843* EXEC CICS GETMAIN
 17844*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17845*         LENGTH    (200)
 17846*         INITIMG   (GETMAIN-SPACE)
 17847*     END-EXEC
 17848     MOVE 200
 17849       TO DFHEIV11
 17850*    MOVE ',"IL                  $   #00016305' TO DFHEIV0
 17851     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17853     MOVE X'2020233030303136333035' TO DFHEIV0(25:11)
 17854     CALL 'kxdfhei1' USING DFHEIV0,
 17855           DFHEIV20,
 17856           DFHEIV11,
 17857           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 342
* EL156.cbl
 17858     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17859         DFHEIV20
 17860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17861     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17862     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17863     MOVE 'AT'                   TO AT-RECORD-ID
 17864     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17865     MOVE '6'                    TO AT-TRAILER-TYPE
 17866     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17867                                    AT-GEN-INFO-LAST-MAINT-DT
 17868     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17869                                    AT-GEN-INFO-LAST-UPDATED-BY
 17870     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17871     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17872     .
 17873 7150-WRITE.
 17874
 17875* EXEC CICS HANDLE CONDITION
 17876*        DUPREC    (7160-DUPREC)
 17877*    END-EXEC
 17878*    MOVE '"$%                   ! : #00016323' TO DFHEIV0
 17879     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17881     MOVE X'3A20233030303136333233' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0
 17883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17884
 17885* EXEC CICS WRITE
 17886*         DATASET     ('ELTRLR')
 17887*         FROM        (ACTIVITY-TRAILERS)
 17888*         RIDFLD      (AT-CONTROL-PRIMARY)
 17889*         RESP        (WS-RESPONSE)
 17890*     END-EXEC
 17891     MOVE LENGTH OF
 17892      ACTIVITY-TRAILERS
 17893       TO DFHEIV11
 17894     MOVE 'ELTRLR' TO DFHEIV1
 17895*    MOVE '&$ L                  ''  N#00016326' TO DFHEIV0
 17896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17898     MOVE X'204E233030303136333236' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0,
 17900           DFHEIV1,
 17901           ACTIVITY-TRAILERS,
 17902           DFHEIV11,
 17903           AT-CONTROL-PRIMARY,
 17904           DFHEIV99,
 17905           DFHEIV99
 17906     MOVE EIBRESP  TO WS-RESPONSE
 17907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17908      IF WS-RESP-DUPREC
 17909         GO TO 7160-DUPREC
 17910      END-IF
 17911     GO TO 7170-EXIT
 17912     .
 17913 7160-DUPREC.
 17914     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17915     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 343
* EL156.cbl
 17916     GO TO 7150-WRITE
 17917     .
 17918 7170-EXIT.
 17919      EXIT.
 17920
 17921 7180-ADD-CERT-NOTE.
 17922*ADD CERT NOTE FOR SC NP+6
 17923
 17924
 17925* EXEC CICS GETMAIN
 17926*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17927*         LENGTH    (150)
 17928*         INITIMG   (GETMAIN-SPACE)
 17929*     END-EXEC.
 17930     MOVE 150
 17931       TO DFHEIV11
 17932*    MOVE ',"IL                  $   #00016348' TO DFHEIV0
 17933     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17935     MOVE X'2020233030303136333438' TO DFHEIV0(25:11)
 17936     CALL 'kxdfhei1' USING DFHEIV0,
 17937           DFHEIV20,
 17938           DFHEIV11,
 17939           GETMAIN-SPACE
 17940     SET ADDRESS OF CERT-NOTE-FILE TO
 17941         DFHEIV20
 17942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17943
 17944
 17945     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17946     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17947     MOVE +1                     TO WRK-NOTE-SEQ.
 17948     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17949     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17950     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17951     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17952     MOVE CL-CERT-STATE          TO CZ-STATE.
 17953     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17954     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17955     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17956     MOVE '2'                    TO CZ-RECORD-TYPE.
 17957     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17958     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17959     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17960     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17961     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17962     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17963     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17964     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17965     IF PI-COMPANY-ID = 'AHL'
 17966        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17967           CONTINUE
 17968        ELSE
 17969           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17970              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17971           ELSE
 17972              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17973           END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 344
* EL156.cbl
 17974        END-IF
 17975     END-IF
 17976     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17977     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17978
 17979 7181-WRITE.
 17980
 17981
 17982* EXEC CICS WRITE
 17983*         DATASET     ('ERCNOT')
 17984*         FROM        (CERT-NOTE-FILE)
 17985*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17986*         RESP        (WS-RESPONSE)
 17987*    END-EXEC.
 17988     MOVE LENGTH OF
 17989      CERT-NOTE-FILE
 17990       TO DFHEIV11
 17991     MOVE 'ERCNOT' TO DFHEIV1
 17992*    MOVE '&$ L                  ''  N#00016390' TO DFHEIV0
 17993     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17995     MOVE X'204E233030303136333930' TO DFHEIV0(25:11)
 17996     CALL 'kxdfhei1' USING DFHEIV0,
 17997           DFHEIV1,
 17998           CERT-NOTE-FILE,
 17999           DFHEIV11,
 18000           CZ-CONTROL-PRIMARY,
 18001           DFHEIV99,
 18002           DFHEIV99
 18003     MOVE EIBRESP  TO WS-RESPONSE
 18004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18005
 18006
 18007     IF WS-RESP-DUPREC
 18008         GO TO 7182-DUPREC
 18009     END-IF.
 18010
 18011     SET CERT-NOTE-ADDED TO TRUE.
 18012
 18013     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18014         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18015     END-IF.
 18016
 18017     GO TO 7189-EXIT.
 18018
 18019 7182-DUPREC.
 18020
 18021     ADD +1                      TO  WRK-NOTE-SEQ.
 18022     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18023     GO TO 7181-WRITE.
 18024
 18025 7189-EXIT.
 18026      EXIT.
 18027
 18028 7190-ADD-ORIG-NOTE.
 18029
 18030
 18031* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 345
* EL156.cbl
 18032*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18033*         LENGTH    (150)
 18034*         INITIMG   (GETMAIN-SPACE)
 18035*     END-EXEC.
 18036     MOVE 150
 18037       TO DFHEIV11
 18038*    MOVE ',"IL                  $   #00016420' TO DFHEIV0
 18039     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18041     MOVE X'2020233030303136343230' TO DFHEIV0(25:11)
 18042     CALL 'kxdfhei1' USING DFHEIV0,
 18043           DFHEIV20,
 18044           DFHEIV11,
 18045           GETMAIN-SPACE
 18046     SET ADDRESS OF CERT-NOTE-FILE TO
 18047         DFHEIV20
 18048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18049
 18050
 18051     ADD +1                      TO WRK-NOTE-SEQ.
 18052     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18053     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18054     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18055     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18056     MOVE CL-CERT-STATE          TO CZ-STATE.
 18057     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18058     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18059     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18060     MOVE '2'                    TO CZ-RECORD-TYPE.
 18061     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18062     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18063     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18064     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18065     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18066     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18067
 18068 7191-WRITE.
 18069
 18070
 18071* EXEC CICS WRITE
 18072*         DATASET     ('ERCNOT')
 18073*         FROM        (CERT-NOTE-FILE)
 18074*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18075*         RESP        (WS-RESPONSE)
 18076*    END-EXEC.
 18077     MOVE LENGTH OF
 18078      CERT-NOTE-FILE
 18079       TO DFHEIV11
 18080     MOVE 'ERCNOT' TO DFHEIV1
 18081*    MOVE '&$ L                  ''  N#00016445' TO DFHEIV0
 18082     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18083     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18084     MOVE X'204E233030303136343435' TO DFHEIV0(25:11)
 18085     CALL 'kxdfhei1' USING DFHEIV0,
 18086           DFHEIV1,
 18087           CERT-NOTE-FILE,
 18088           DFHEIV11,
 18089           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 346
* EL156.cbl
 18090           DFHEIV99,
 18091           DFHEIV99
 18092     MOVE EIBRESP  TO WS-RESPONSE
 18093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18094
 18095
 18096     IF WS-RESP-DUPREC
 18097         GO TO 7192-DUPREC
 18098     END-IF.
 18099
 18100     GO TO 7199-EXIT.
 18101
 18102 7192-DUPREC.
 18103
 18104     ADD +1                      TO  WRK-NOTE-SEQ.
 18105     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18106     GO TO 7191-WRITE.
 18107
 18108 7199-EXIT.
 18109      EXIT.
 18110 7200-FIND-BENEFIT.
 18111     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18112
 18113
 18114* EXEC CICS HANDLE CONDITION
 18115*        ENDFILE(7200-EXIT)
 18116*        NOTFND(7200-EXIT)
 18117*    END-EXEC.
 18118*    MOVE '"$''I                  ! ; #00016469' TO DFHEIV0
 18119     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18121     MOVE X'3B20233030303136343639' TO DFHEIV0(25:11)
 18122     CALL 'kxdfhei1' USING DFHEIV0
 18123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18124
 18125
 18126
 18127* EXEC CICS READ
 18128*        DATASET('ELCNTL')
 18129*        SET(ADDRESS OF CONTROL-FILE)
 18130*        RIDFLD(ELCNTL-KEY)
 18131*        GTEQ
 18132*    END-EXEC.
 18133     MOVE 'ELCNTL' TO DFHEIV1
 18134*    MOVE '&"S        G          (   #00016474' TO DFHEIV0
 18135     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18137     MOVE X'2020233030303136343734' TO DFHEIV0(25:11)
 18138     CALL 'kxdfhei1' USING DFHEIV0,
 18139           DFHEIV1,
 18140           DFHEIV20,
 18141           DFHEIV99,
 18142           ELCNTL-KEY,
 18143           DFHEIV99,
 18144           DFHEIV99,
 18145           DFHEIV99
 18146     SET ADDRESS OF CONTROL-FILE TO
 18147         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 347
* EL156.cbl
 18148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18149
 18150
 18151     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18152        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18153           GO TO 7200-EXIT.
 18154
 18155     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18156         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18157            ((SUB-1 > 8) OR
 18158            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18159
 18160     IF SUB-1 NOT = 9
 18161         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18162
 18163     GO TO 7200-EXIT.
 18164
 18165 7200-BENEFIT-DUMMY.
 18166
 18167 7200-DUMMY-EXIT.
 18168     EXIT.
 18169
 18170 7200-EXIT.
 18171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 348
* EL156.cbl
 18173*052506
 18174*052506 7250-FIND-LETTER-TRLR.
 18175*052506     EXEC CICS HANDLE CONDITION
 18176*052506         ENDFILE  (7250-END)
 18177*052506         NOTFND   (7250-END)
 18178*052506     END-EXEC.
 18179*052506
 18180*052506     EXEC CICS STARTBR
 18181*052506         DATASET   ('ELTRLR')
 18182*052506         RIDFLD    (ELTRLR-KEY)
 18183*052506         GTEQ
 18184*052506     END-EXEC.
 18185*052506
 18186*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18187*052506
 18188*052506 7250-FIND-LOOP.
 18189*052506     EXEC CICS READNEXT
 18190*052506         DATASET   ('ELTRLR')
 18191*052506         RIDFLD    (ELTRLR-KEY)
 18192*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18193*052506     END-EXEC.
 18194*052506
 18195*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18196*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18197*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18198*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18199*052506        GO TO 7250-END
 18200*052506     END-IF.
 18201*052506
 18202*052506     IF AT-TRAILER-TYPE NOT = '4'
 18203*052506         GO TO 7250-FIND-LOOP
 18204*052506     END-IF.
 18205*052506
 18206*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18207*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18208*052506     END-IF.
 18209*052506
 18210*052506     GO TO 7250-FIND-LOOP.
 18211*052506
 18212*052506 7250-END.
 18213*052506
 18214*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18215*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18216*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18217*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18218*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18219*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18220*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18221*052506     END-IF.
 18222*052506
 18223*052506     EXEC CICS ENDBR
 18224*052506          DATASET    ('ELTRLR')
 18225*052506     END-EXEC.
 18226*052506
 18227*052506 7250-EXIT.
 18228*052506     EXIT.
 18229*052506     EJECT
 18230*052506
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 349
* EL156.cbl
 18231 7300-CHECK-AUTO-ACTIVITY.
 18232
 18233     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18234         NEXT SENTENCE
 18235     ELSE
 18236         GO TO 7399-EXIT.
 18237
 18238     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18239
 18240     IF WS-ACT-REC-FOUND-SW = 'N'
 18241         GO TO 7399-EXIT.
 18242
 18243     IF PI-ACTIVITY-CODE = 09
 18244         GO TO 7300-CONT-AUTO-ACTIVITY.
 18245
 18246     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18247        (PI-ACTIVITY-CODE = 11)
 18248         GO TO 7300-CONT-AUTO-ACTIVITY.
 18249
 18250     IF PI-PROVISIONAL-IND = 'P'
 18251         IF PI-PMTTYPE = '1'
 18252             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18253                 MOVE 'N'    TO  PI-RESET-SW
 18254                 GO TO 7399-EXIT.
 18255
 18256     IF PI-PMTTYPE = '1'
 18257         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18258             MOVE 'N'        TO  PI-RESET-SW
 18259             GO TO 7399-EXIT.
 18260
 18261     IF PI-PMTTYPE = '2' OR '3'
 18262         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18263             MOVE 'N'        TO  PI-RESET-SW
 18264             GO TO 7399-EXIT.
 18265
 18266     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18267         IF PI-PROVISIONAL-IND = 'P'
 18268             NEXT SENTENCE
 18269         ELSE
 18270             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18271
 18272 7300-CONT-AUTO-ACTIVITY.
 18273
 18274     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18275         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18276         MOVE '4'            TO DC-OPTION-CODE
 18277         MOVE +0             TO DC-ELAPSED-DAYS
 18278                                DC-ELAPSED-MONTHS
 18279         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18280         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18281         IF PI-USES-PAID-TO
 18282             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18283             IF NO-CONVERSION-ERROR
 18284                 MOVE +1     TO DC-ELAPSED-DAYS
 18285                 MOVE +0     TO DC-ELAPSED-MONTHS
 18286                 MOVE '6'    TO DC-OPTION-CODE
 18287                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18288                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 350
* EL156.cbl
 18289                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18290
 18291     IF PI-PFKEY-USED = DFHPF5
 18292         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18293         IF PI-USES-PAID-TO
 18294             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18295             MOVE +1                  TO DC-ELAPSED-DAYS
 18296             MOVE +0                  TO DC-ELAPSED-MONTHS
 18297             MOVE '6'                 TO DC-OPTION-CODE
 18298             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18299             IF NO-CONVERSION-ERROR
 18300                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18301
 18302     IF WS-CHK-THRU-DT < PI-EXP-DT
 18303         NEXT SENTENCE
 18304     ELSE
 18305         MOVE 03                     TO  WS-ACTIVITY-CODE
 18306         GO TO 7390-PROCESS-ACTIVITY.
 18307
 18308     IF PI-PROV-PMT
 18309         MOVE 09                     TO  WS-ACTIVITY-CODE
 18310     ELSE
 18311        IF PI-PMTTYPE = '1'
 18312            MOVE 02                  TO  WS-ACTIVITY-CODE
 18313        ELSE
 18314        IF PI-PMTTYPE = '2' OR '3'
 18315            MOVE 07                  TO  WS-ACTIVITY-CODE
 18316        ELSE
 18317        IF PI-PMTTYPE = '4'
 18318            MOVE 00                  TO  WS-ACTIVITY-CODE
 18319        ELSE
 18320            MOVE 'N'                 TO  PI-RESET-SW
 18321            GO TO 7399-EXIT.
 18322
 18323 7390-PROCESS-ACTIVITY.
 18324
 18325     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18326
 18327 7399-EXIT.
 18328     EXIT.
 18329
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 351
* EL156.cbl
 18331 7400-CHECK-AUTO-ACTIVITY.
 18332
 18333
 18334* EXEC CICS HANDLE CONDITION
 18335*        NOTFND   (7400-NOT-FOUND)
 18336*    END-EXEC.
 18337*    MOVE '"$I                   ! < #00016663' TO DFHEIV0
 18338     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18340     MOVE X'3C20233030303136363633' TO DFHEIV0(25:11)
 18341     CALL 'kxdfhei1' USING DFHEIV0
 18342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18343
 18344
 18345     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18346     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18347     MOVE SPACES                 TO  CNTL-ACCESS.
 18348     MOVE +0                     TO  CNTL-SEQ-NO.
 18349
 18350
 18351* EXEC CICS READ
 18352*        DATASET   ('ELCNTL')
 18353*        RIDFLD    (ELCNTL-KEY)
 18354*        SET       (ADDRESS OF CONTROL-FILE)
 18355*    END-EXEC.
 18356     MOVE 'ELCNTL' TO DFHEIV1
 18357*    MOVE '&"S        E          (   #00016672' TO DFHEIV0
 18358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18360     MOVE X'2020233030303136363732' TO DFHEIV0(25:11)
 18361     CALL 'kxdfhei1' USING DFHEIV0,
 18362           DFHEIV1,
 18363           DFHEIV20,
 18364           DFHEIV99,
 18365           ELCNTL-KEY,
 18366           DFHEIV99,
 18367           DFHEIV99,
 18368           DFHEIV99
 18369     SET ADDRESS OF CONTROL-FILE TO
 18370         DFHEIV20
 18371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18372
 18373
 18374     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18375     GO TO 7400-EXIT.
 18376
 18377 7400-NOT-FOUND.
 18378     MOVE 'N'                        TO  PI-RESET-SW
 18379                                         WS-LETTER-SW
 18380                                         WS-ACT-REC-FOUND-SW.
 18381
 18382     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18383
 18384 7400-EXIT.
 18385     EXIT.
 18386
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 352
* EL156.cbl
 18388 7450-FORMAT-AUTO-LETTER.
 18389
 18390     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18391         MOVE 'Y'                    TO PI-RESET-SW
 18392         GO TO 7450-CONTINUE-PROCESS.
 18393
 18394     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18395
 18396     IF SUB > 9
 18397         SUBTRACT 9 FROM SUB
 18398         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18399     ELSE
 18400         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18401
 18402 7450-CONTINUE-PROCESS.
 18403
 18404     IF WS-ACTIVITY-CODE = ZEROS
 18405         MOVE 'N'                    TO  WS-LETTER-SW
 18406         GO TO 7450-EXIT.
 18407
 18408     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18409
 18410     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18411         MOVE 'N'                    TO  PI-RESET-SW
 18412                                         WS-LETTER-SW
 18413         GO TO 7450-EXIT.
 18414
 18415     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18416         MOVE 'N'                    TO  WS-LETTER-SW
 18417         GO TO 7450-EXIT.
 18418
 18419     MOVE 'Y'                        TO  WS-LETTER-SW.
 18420     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18421     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18422
 18423     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18424
 18425     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18426         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18427         MOVE '6'                    TO  DC-OPTION-CODE
 18428         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18429         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18430         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18431         IF NO-CONVERSION-ERROR
 18432             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18433         ELSE
 18434              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18435
 18436     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18437         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18438         MOVE '6'                    TO  DC-OPTION-CODE
 18439         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18440         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18441         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18442         IF NO-CONVERSION-ERROR
 18443             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18444         ELSE
 18445             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 353
* EL156.cbl
 18446
 18447 7450-EXIT.
 18448     EXIT.
 18449
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 354
* EL156.cbl
 18451 7500-RESET-AUTO-ACTIVITY.
 18452
 18453     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18454     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18455     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18456     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18457     MOVE +100                   TO  TRLR-SEQ-NO.
 18458
 18459 7500-STARTBR-TRLR.
 18460
 18461
 18462* EXEC CICS HANDLE CONDITION
 18463*        ENDFILE  (7590-END)
 18464*        NOTFND   (7590-END)
 18465*    END-EXEC.
 18466*    MOVE '"$''I                  ! = #00016765' TO DFHEIV0
 18467     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18469     MOVE X'3D20233030303136373635' TO DFHEIV0(25:11)
 18470     CALL 'kxdfhei1' USING DFHEIV0
 18471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18472
 18473
 18474
 18475* EXEC CICS STARTBR
 18476*        DATASET   ('ELTRLR')
 18477*        RIDFLD    (ELTRLR-KEY)
 18478*        GTEQ
 18479*    END-EXEC.
 18480     MOVE 'ELTRLR' TO DFHEIV1
 18481     MOVE 0
 18482       TO DFHEIV11
 18483*    MOVE '&,         G          &   #00016770' TO DFHEIV0
 18484     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18486     MOVE X'2020233030303136373730' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
 18488           DFHEIV1,
 18489           ELTRLR-KEY,
 18490           DFHEIV99,
 18491           DFHEIV11,
 18492           DFHEIV99
 18493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18494
 18495
 18496     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18497
 18498 7500-READ-NEXT.
 18499
 18500
 18501* EXEC CICS READNEXT
 18502*        DATASET   ('ELTRLR')
 18503*        RIDFLD    (ELTRLR-KEY)
 18504*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18505*    END-EXEC.
 18506     MOVE 'ELTRLR' TO DFHEIV1
 18507     MOVE 0
 18508       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 355
* EL156.cbl
 18509*    MOVE '&.S                   )   #00016780' TO DFHEIV0
 18510     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18511     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18512     MOVE X'2020233030303136373830' TO DFHEIV0(25:11)
 18513     CALL 'kxdfhei1' USING DFHEIV0,
 18514           DFHEIV1,
 18515           DFHEIV20,
 18516           DFHEIV99,
 18517           ELTRLR-KEY,
 18518           DFHEIV99,
 18519           DFHEIV11,
 18520           DFHEIV99,
 18521           DFHEIV99
 18522     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18523         DFHEIV20
 18524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18525
 18526
 18527     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18528        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18529        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18530        PI-CERT-NO    NOT = TRLR-CERT-NO
 18531         GO TO 7590-END.
 18532
 18533     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18534         GO TO 7500-READ-NEXT.
 18535
 18536     IF AT-TRAILER-TYPE NOT = '4'
 18537         GO TO 7500-READ-NEXT.
 18538
 18539     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18540         GO TO 7500-READ-NEXT.
 18541
 18542     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18543        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18544         GO TO 7500-READ-NEXT.
 18545
 18546     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18547        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18548        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18549         GO TO 7500-READ-NEXT.
 18550
 18551     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18552                         AND
 18553        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18554                         AND
 18555        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18556            GO TO 7500-READ-NEXT.
 18557
 18558     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18559
 18560
 18561* EXEC CICS ENDBR
 18562*        DATASET   ('ELTRLR')
 18563*    END-EXEC.
 18564     MOVE 'ELTRLR' TO DFHEIV1
 18565     MOVE 0
 18566       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 356
* EL156.cbl
 18567*    MOVE '&2                    $   #00016819' TO DFHEIV0
 18568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18570     MOVE X'2020233030303136383139' TO DFHEIV0(25:11)
 18571     CALL 'kxdfhei1' USING DFHEIV0,
 18572           DFHEIV1,
 18573           DFHEIV11,
 18574           DFHEIV99
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578     MOVE 'N'                        TO  WS-BROWSE-SW.
 18579
 18580
 18581* EXEC CICS READ
 18582*        DATASET   ('ELTRLR')
 18583*        RIDFLD    (ELTRLR-KEY)
 18584*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18585*        UPDATE
 18586*    END-EXEC.
 18587     MOVE 'ELTRLR' TO DFHEIV1
 18588*    MOVE '&"S        EU         (   #00016825' TO DFHEIV0
 18589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18591     MOVE X'2020233030303136383235' TO DFHEIV0(25:11)
 18592     CALL 'kxdfhei1' USING DFHEIV0,
 18593           DFHEIV1,
 18594           DFHEIV20,
 18595           DFHEIV99,
 18596           ELTRLR-KEY,
 18597           DFHEIV99,
 18598           DFHEIV99,
 18599           DFHEIV99
 18600     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18601         DFHEIV20
 18602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18603
 18604
 18605     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18606
 18607     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18608         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18609     ELSE
 18610         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18611             NEXT SENTENCE
 18612         ELSE
 18613             GO TO 7500-REWRITE-TRLR.
 18614
 18615     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18616
 18617     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18618     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18619     MOVE '1'                        TO  ARCH-REC-TYPE.
 18620     MOVE +0                         TO  ARCH-SEQ.
 18621
 18622     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18623
 18624 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 357
* EL156.cbl
 18625
 18626
 18627* EXEC CICS REWRITE
 18628*        DATASET   ('ELTRLR')
 18629*        FROM      (ACTIVITY-TRAILERS)
 18630*    END-EXEC.
 18631     MOVE LENGTH OF
 18632      ACTIVITY-TRAILERS
 18633       TO DFHEIV11
 18634     MOVE 'ELTRLR' TO DFHEIV1
 18635*    MOVE '&& L                  %   #00016853' TO DFHEIV0
 18636     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18637     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18638     MOVE X'2020233030303136383533' TO DFHEIV0(25:11)
 18639     CALL 'kxdfhei1' USING DFHEIV0,
 18640           DFHEIV1,
 18641           ACTIVITY-TRAILERS,
 18642           DFHEIV11,
 18643           DFHEIV99
 18644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18645
 18646
 18647     GO TO 7500-STARTBR-TRLR.
 18648
 18649 7590-END.
 18650
 18651     IF WS-BROWSE-SW = 'Y'
 18652         MOVE 'N'                    TO  WS-BROWSE-SW
 18653
 18654* EXEC CICS ENDBR
 18655*            DATASET   ('ELTRLR')
 18656*        END-EXEC.
 18657     MOVE 'ELTRLR' TO DFHEIV1
 18658     MOVE 0
 18659       TO DFHEIV11
 18660*    MOVE '&2                    $   #00016864' TO DFHEIV0
 18661     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18662     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18663     MOVE X'2020233030303136383634' TO DFHEIV0(25:11)
 18664     CALL 'kxdfhei1' USING DFHEIV0,
 18665           DFHEIV1,
 18666           DFHEIV11,
 18667           DFHEIV99
 18668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18669
 18670
 18671 7599-EXIT.
 18672     EXIT.
 18673
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 358
* EL156.cbl
 18675 7600-READ-ARCH-UPDATE.
 18676
 18677
 18678* EXEC CICS HANDLE CONDITION
 18679*        NOTFND   (7699-EXIT)
 18680*    END-EXEC.
 18681*    MOVE '"$I                   ! > #00016874' TO DFHEIV0
 18682     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18684     MOVE X'3E20233030303136383734' TO DFHEIV0(25:11)
 18685     CALL 'kxdfhei1' USING DFHEIV0
 18686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18687
 18688
 18689
 18690* EXEC CICS READ
 18691*        DATASET   ('ELARCH')
 18692*        RIDFLD    (ELARCH-KEY)
 18693*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18694*        UPDATE
 18695*    END-EXEC.
 18696     MOVE 'ELARCH' TO DFHEIV1
 18697*    MOVE '&"S        EU         (   #00016878' TO DFHEIV0
 18698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18700     MOVE X'2020233030303136383738' TO DFHEIV0(25:11)
 18701     CALL 'kxdfhei1' USING DFHEIV0,
 18702           DFHEIV1,
 18703           DFHEIV20,
 18704           DFHEIV99,
 18705           ELARCH-KEY,
 18706           DFHEIV99,
 18707           DFHEIV99,
 18708           DFHEIV99
 18709     SET ADDRESS OF LETTER-ARCHIVE TO
 18710         DFHEIV20
 18711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18712
 18713
 18714     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18715
 18716
 18717* EXEC CICS REWRITE
 18718*        DATASET   ('ELARCH')
 18719*        FROM      (LETTER-ARCHIVE)
 18720*    END-EXEC.
 18721     MOVE LENGTH OF
 18722      LETTER-ARCHIVE
 18723       TO DFHEIV11
 18724     MOVE 'ELARCH' TO DFHEIV1
 18725*    MOVE '&& L                  %   #00016887' TO DFHEIV0
 18726     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18727     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18728     MOVE X'2020233030303136383837' TO DFHEIV0(25:11)
 18729     CALL 'kxdfhei1' USING DFHEIV0,
 18730           DFHEIV1,
 18731           LETTER-ARCHIVE,
 18732           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 359
* EL156.cbl
 18733           DFHEIV99
 18734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18735
 18736
 18737 7699-EXIT.
 18738     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 360
* EL156.cbl
 18740 7700-GET-DCT.
 18741
 18742     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18743     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18744     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18745     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18746                                    PI-MAX-BENEFIT-AMT
 18747                                    PI-MAX-BENEFIT-PYMT
 18748                                    PI-MIN-PAYMENT-AMT
 18749                                    PI-TIME-OF-LOSS-BAL.
 18750
 18751
 18752* EXEC CICS HANDLE CONDITION
 18753*         NOTFND (5300-NOTE-NOT-FOUND)
 18754*     END-EXEC.
 18755*    MOVE '"$I                   ! ? #00016906' TO DFHEIV0
 18756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18758     MOVE X'3F20233030303136393036' TO DFHEIV0(25:11)
 18759     CALL 'kxdfhei1' USING DFHEIV0
 18760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18761
 18762
 18763
 18764* EXEC CICS READ
 18765*         DATASET('ERNOTE')
 18766*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18767*         RIDFLD (W-NOTE-KEY)
 18768*     END-EXEC.
 18769     MOVE 'ERNOTE' TO DFHEIV1
 18770*    MOVE '&"S        E          (   #00016910' TO DFHEIV0
 18771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18773     MOVE X'2020233030303136393130' TO DFHEIV0(25:11)
 18774     CALL 'kxdfhei1' USING DFHEIV0,
 18775           DFHEIV1,
 18776           DFHEIV20,
 18777           DFHEIV99,
 18778           W-NOTE-KEY,
 18779           DFHEIV99,
 18780           DFHEIV99,
 18781           DFHEIV99
 18782     SET ADDRESS OF CERTIFICATE-NOTE TO
 18783         DFHEIV20
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18788     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18789     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18790     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18791     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18792
 18793     IF PI-PAYEE-TYPE NOT = 'B'
 18794         GO TO 7700-EXIT.
 18795
 18796     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18797     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 361
* EL156.cbl
 18798     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18799
 18800     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18801         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18802     ELSE
 18803         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18804
 18805     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18806     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18807     MOVE 'DLO006'               TO PGM-NAME.
 18808
 18809
 18810* EXEC CICS LINK
 18811*        PROGRAM    (PGM-NAME)
 18812*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18813*        LENGTH     (DCT-RCRD-LENGTH)
 18814*    END-EXEC.
 18815*    MOVE '."C                   (   #00016938' TO DFHEIV0
 18816     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18818     MOVE X'2020233030303136393338' TO DFHEIV0(25:11)
 18819     CALL 'kxdfhei1' USING DFHEIV0,
 18820           PGM-NAME,
 18821           DCT-COMMUNICATION-AREA,
 18822           DCT-RCRD-LENGTH,
 18823           DFHEIV99,
 18824           DFHEIV99,
 18825           DFHEIV99,
 18826           DFHEIV99
 18827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18828
 18829
 18830     IF DCT-RETURN-CODE = 'OK'
 18831         GO TO 7700-CONT.
 18832
 18833     IF DCT-RETURN-CODE = '01' OR '02'
 18834         GO TO 7700-SET-TO-YES.
 18835
 18836     IF DCT-RETURN-CODE = '03'
 18837
 18838* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18839*    MOVE '6"R                   !   #00016951' TO DFHEIV0
 18840     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18842     MOVE X'2020233030303136393531' TO DFHEIV0(25:11)
 18843     CALL 'kxdfhei1' USING DFHEIV0
 18844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18845         MOVE ER-0951            TO EMI-ERROR
 18846         MOVE -1                 TO PMTTYPEL
 18847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18848         GO TO 8200-SEND-DATAONLY.
 18849
 18850     IF DCT-RETURN-CODE = '04'
 18851
 18852* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18853*    MOVE '6"R                   !   #00016958' TO DFHEIV0
 18854     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 362
* EL156.cbl
 18856     MOVE X'2020233030303136393538' TO DFHEIV0(25:11)
 18857     CALL 'kxdfhei1' USING DFHEIV0
 18858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18859         MOVE ER-0946            TO EMI-ERROR
 18860         MOVE -1                 TO PMTTYPEL
 18861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18862         GO TO 8200-SEND-DATAONLY.
 18863
 18864     IF DCT-RETURN-CODE = '05'
 18865
 18866* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18867*    MOVE '6"R                   !   #00016965' TO DFHEIV0
 18868     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18870     MOVE X'2020233030303136393635' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0
 18872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18873         MOVE ER-0947            TO EMI-ERROR
 18874         MOVE -1                 TO PMTTYPEL
 18875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18876         GO TO 8200-SEND-DATAONLY.
 18877
 18878     IF DCT-RETURN-CODE = '06'
 18879
 18880* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18881*    MOVE '6"R                   !   #00016972' TO DFHEIV0
 18882     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18884     MOVE X'2020233030303136393732' TO DFHEIV0(25:11)
 18885     CALL 'kxdfhei1' USING DFHEIV0
 18886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18887         MOVE ER-0921            TO EMI-ERROR
 18888         MOVE -1                 TO PMTTYPEL
 18889         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18890         GO TO 8200-SEND-DATAONLY.
 18891
 18892     IF DCT-RETURN-CODE = '07'
 18893
 18894* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18895*    MOVE '6"R                   !   #00016979' TO DFHEIV0
 18896     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303136393739' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18901         MOVE ER-0919            TO EMI-ERROR
 18902         MOVE -1                 TO PMTTYPEL
 18903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18904         GO TO 8200-SEND-DATAONLY.
 18905
 18906     IF DCT-RETURN-CODE = '08'
 18907
 18908* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18909*    MOVE '6"R                   !   #00016986' TO DFHEIV0
 18910     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18912     MOVE X'2020233030303136393836' TO DFHEIV0(25:11)
 18913     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 363
* EL156.cbl
 18914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18915         MOVE ER-0948            TO EMI-ERROR
 18916         MOVE -1                 TO PMTTYPEL
 18917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18918         GO TO 8200-SEND-DATAONLY.
 18919
 18920     IF DCT-RETURN-CODE = 'N1'
 18921
 18922* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18923*    MOVE '6"R                   !   #00016993' TO DFHEIV0
 18924     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18926     MOVE X'2020233030303136393933' TO DFHEIV0(25:11)
 18927     CALL 'kxdfhei1' USING DFHEIV0
 18928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18929         MOVE ER-0950            TO EMI-ERROR
 18930         MOVE -1                 TO PMTTYPEL
 18931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18932         GO TO 8200-SEND-DATAONLY.
 18933
 18934     IF DCT-RETURN-CODE = 'E1'
 18935
 18936* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18937*    MOVE '6"R                   !   #00017000' TO DFHEIV0
 18938     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18940     MOVE X'2020233030303137303030' TO DFHEIV0(25:11)
 18941     CALL 'kxdfhei1' USING DFHEIV0
 18942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18943         MOVE ER-0974            TO EMI-ERROR
 18944         MOVE -1                 TO PMTTYPEL
 18945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18946         GO TO 8200-SEND-DATAONLY.
 18947
 18948     IF DCT-RETURN-CODE = 'E2'
 18949
 18950* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18951*    MOVE '6"R                   !   #00017007' TO DFHEIV0
 18952     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18954     MOVE X'2020233030303137303037' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18957         MOVE ER-0975            TO EMI-ERROR
 18958         MOVE -1                 TO PMTTYPEL
 18959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18960         GO TO 8200-SEND-DATAONLY.
 18961
 18962     IF DCT-RETURN-CODE NOT = 'OK'
 18963
 18964* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18965*    MOVE '6"R                   !   #00017014' TO DFHEIV0
 18966     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303137303134' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0
 18970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18971         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 364
* EL156.cbl
 18972         MOVE -1                 TO PMTTYPEL
 18973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18974         GO TO 8200-SEND-DATAONLY.
 18975
 18976 7700-CONT.
 18977
 18978*    MOVE 'N'                    TO CASHO.
 18979*    MOVE +1                     TO CASHL.
 18980*    MOVE AL-UANON               TO CASHA.
 18981
 18982     IF PI-OFFLINE = 'Y'
 18983         GO TO 7700-EXIT.
 18984
 18985     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18986     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18987     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18988     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18989     MOVE +7                     TO CHECKNOL.
 18990     MOVE AL-UANON               TO CHECKNOA.
 18991     GO TO 7700-EXIT.
 18992
 18993 7700-SET-TO-YES.
 18994
 18995*    MOVE 'Y'                    TO CASHO.
 18996*    MOVE +1                     TO CASHL.
 18997*    MOVE AL-UANON               TO CASHA.
 18998
 18999 7700-EXIT.
 19000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 365
* EL156.cbl
 19002 7800-READ-COMP-MSTR.
 19003
 19004
 19005* EXEC CICS HANDLE CONDITION
 19006*        NOTFND   (7800-COMP-NOTFND)
 19007*    END-EXEC.
 19008*    MOVE '"$I                   ! @ #00017048' TO DFHEIV0
 19009     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19011     MOVE X'4020233030303137303438' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016
 19017* EXEC CICS READ
 19018*        DATASET   ('ERCOMP')
 19019*        RIDFLD    (ERCOMP-KEY)
 19020*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19021*    END-EXEC.
 19022     MOVE 'ERCOMP' TO DFHEIV1
 19023*    MOVE '&"S        E          (   #00017052' TO DFHEIV0
 19024     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19026     MOVE X'2020233030303137303532' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0,
 19028           DFHEIV1,
 19029           DFHEIV20,
 19030           DFHEIV99,
 19031           ERCOMP-KEY,
 19032           DFHEIV99,
 19033           DFHEIV99,
 19034           DFHEIV99
 19035     SET ADDRESS OF COMPENSATION-MASTER TO
 19036         DFHEIV20
 19037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19038
 19039
 19040     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19041     GO TO 7800-COMP-EXIT.
 19042
 19043 7800-COMP-NOTFND.
 19044     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19045
 19046 7800-COMP-EXIT.
 19047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 366
* EL156.cbl
 19049 7900-READ-CLAIM.
 19050
 19051* EXEC CICS READ
 19052*        DATASET  ('ELMSTR')
 19053*        SET      (ADDRESS OF CLAIM-MASTER)
 19054*        RIDFLD   (ELMSTR-KEY)
 19055*    END-EXEC.
 19056     MOVE 'ELMSTR' TO DFHEIV1
 19057*    MOVE '&"S        E          (   #00017068' TO DFHEIV0
 19058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19060     MOVE X'2020233030303137303638' TO DFHEIV0(25:11)
 19061     CALL 'kxdfhei1' USING DFHEIV0,
 19062           DFHEIV1,
 19063           DFHEIV20,
 19064           DFHEIV99,
 19065           ELMSTR-KEY,
 19066           DFHEIV99,
 19067           DFHEIV99,
 19068           DFHEIV99
 19069     SET ADDRESS OF CLAIM-MASTER TO
 19070         DFHEIV20
 19071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19072
 19073
 19074 7900-EXIT.
 19075      EXIT.
 19076
 19077 7910-READ-CLAIM-UPDATE.
 19078
 19079* EXEC CICS READ
 19080*        DATASET  ('ELMSTR')
 19081*        SET      (ADDRESS OF CLAIM-MASTER)
 19082*        RIDFLD   (ELMSTR-KEY)
 19083*        UPDATE
 19084*    END-EXEC.
 19085     MOVE 'ELMSTR' TO DFHEIV1
 19086*    MOVE '&"S        EU         (   #00017078' TO DFHEIV0
 19087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19089     MOVE X'2020233030303137303738' TO DFHEIV0(25:11)
 19090     CALL 'kxdfhei1' USING DFHEIV0,
 19091           DFHEIV1,
 19092           DFHEIV20,
 19093           DFHEIV99,
 19094           ELMSTR-KEY,
 19095           DFHEIV99,
 19096           DFHEIV99,
 19097           DFHEIV99
 19098     SET ADDRESS OF CLAIM-MASTER TO
 19099         DFHEIV20
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19101
 19102
 19103 7910-EXIT.
 19104      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 367
* EL156.cbl
 19106 7920-READ-BENE.
 19107     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19108     MOVE 'B'                TO BENE-RECORD-TYPE.
 19109     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19110
 19111     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19112        IF PI-PAYEE-TYPE    = 'B' AND
 19113           PI-PAYEE-SEQ-NUM = 9
 19114             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19115             MOVE WS-A-BENE           TO BENE-NUMBER.
 19116
 19117
 19118* EXEC CICS HANDLE CONDITION
 19119*        NOTFND   (7920-NOT-FOUND)
 19120*    END-EXEC.
 19121*    MOVE '"$I                   ! A #00017099' TO DFHEIV0
 19122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19124     MOVE X'4120233030303137303939' TO DFHEIV0(25:11)
 19125     CALL 'kxdfhei1' USING DFHEIV0
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19127
 19128
 19129
 19130* EXEC CICS READ
 19131*        DATASET  ('ELBENE')
 19132*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19133*        RIDFLD   (ELBENE-KEY)
 19134*    END-EXEC.
 19135     MOVE 'ELBENE' TO DFHEIV1
 19136*    MOVE '&"S        E          (   #00017103' TO DFHEIV0
 19137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19139     MOVE X'2020233030303137313033' TO DFHEIV0(25:11)
 19140     CALL 'kxdfhei1' USING DFHEIV0,
 19141           DFHEIV1,
 19142           DFHEIV20,
 19143           DFHEIV99,
 19144           ELBENE-KEY,
 19145           DFHEIV99,
 19146           DFHEIV99,
 19147           DFHEIV99
 19148     SET ADDRESS OF BENEFICIARY-MASTER TO
 19149         DFHEIV20
 19150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19151
 19152
 19153     MOVE 'Y' TO BENE-FOUND-SW.
 19154     GO TO 7920-EXIT.
 19155
 19156 7920-NOT-FOUND.
 19157     MOVE 'N'                    TO BENE-FOUND-SW.
 19158
 19159 7920-EXIT.
 19160      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 368
* EL156.cbl
 19162 7930-READ-CONTROL.
 19163
 19164* EXEC CICS READ
 19165*        DATASET  ('ELCNTL')
 19166*        SET      (ADDRESS OF CONTROL-FILE)
 19167*        RIDFLD   (ELCNTL-KEY)
 19168*    END-EXEC.
 19169     MOVE 'ELCNTL' TO DFHEIV1
 19170*    MOVE '&"S        E          (   #00017119' TO DFHEIV0
 19171     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19173     MOVE X'2020233030303137313139' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0,
 19175           DFHEIV1,
 19176           DFHEIV20,
 19177           DFHEIV99,
 19178           ELCNTL-KEY,
 19179           DFHEIV99,
 19180           DFHEIV99,
 19181           DFHEIV99
 19182     SET ADDRESS OF CONTROL-FILE TO
 19183         DFHEIV20
 19184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19185
 19186
 19187 7930-EXIT.
 19188      EXIT.
 19189
 19190 7940-READ-CONTROL-UPDATE.
 19191
 19192* EXEC CICS READ
 19193*        DATASET  ('ELCNTL')
 19194*        SET      (ADDRESS OF CONTROL-FILE)
 19195*        RIDFLD   (ELCNTL-KEY)
 19196*        UPDATE
 19197*    END-EXEC.
 19198     MOVE 'ELCNTL' TO DFHEIV1
 19199*    MOVE '&"S        EU         (   #00017129' TO DFHEIV0
 19200     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19201     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19202     MOVE X'2020233030303137313239' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0,
 19204           DFHEIV1,
 19205           DFHEIV20,
 19206           DFHEIV99,
 19207           ELCNTL-KEY,
 19208           DFHEIV99,
 19209           DFHEIV99,
 19210           DFHEIV99
 19211     SET ADDRESS OF CONTROL-FILE TO
 19212         DFHEIV20
 19213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19214
 19215
 19216 7940-EXIT.
 19217      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 369
* EL156.cbl
 19219 7950-READ-TRAILER.
 19220
 19221* EXEC CICS READ
 19222*        DATASET  ('ELTRLR')
 19223*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19224*        RIDFLD   (ELTRLR-KEY)
 19225*    END-EXEC.
 19226     MOVE 'ELTRLR' TO DFHEIV1
 19227*    MOVE '&"S        E          (   #00017140' TO DFHEIV0
 19228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137313430' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           DFHEIV20,
 19234           DFHEIV99,
 19235           ELTRLR-KEY,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19240         DFHEIV20
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244 7950-EXIT.
 19245      EXIT.
 19246
 19247 7960-READ-TRAILER-UPDATE.
 19248
 19249* EXEC CICS READ
 19250*        DATASET  ('ELTRLR')
 19251*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19252*        RIDFLD   (ELTRLR-KEY)
 19253*        UPDATE
 19254*    END-EXEC.
 19255     MOVE 'ELTRLR' TO DFHEIV1
 19256*    MOVE '&"S        EU         (   #00017150' TO DFHEIV0
 19257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           DFHEIV1,
 19262           DFHEIV20,
 19263           DFHEIV99,
 19264           ELTRLR-KEY,
 19265           DFHEIV99,
 19266           DFHEIV99,
 19267           DFHEIV99
 19268     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19269         DFHEIV20
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273 7960-EXIT.
 19274      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 370
* EL156.cbl
 19276 7970-READ-CERT.
 19277
 19278* EXEC CICS READ
 19279*        DATASET  ('ELCERT')
 19280*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19281*        RIDFLD   (ELCERT-KEY)
 19282*    END-EXEC.
 19283     MOVE 'ELCERT' TO DFHEIV1
 19284*    MOVE '&"S        E          (   #00017161' TO DFHEIV0
 19285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19287     MOVE X'2020233030303137313631' TO DFHEIV0(25:11)
 19288     CALL 'kxdfhei1' USING DFHEIV0,
 19289           DFHEIV1,
 19290           DFHEIV20,
 19291           DFHEIV99,
 19292           ELCERT-KEY,
 19293           DFHEIV99,
 19294           DFHEIV99,
 19295           DFHEIV99
 19296     SET ADDRESS OF CERTIFICATE-MASTER TO
 19297         DFHEIV20
 19298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19299
 19300
 19301 7970-EXIT.
 19302      EXIT.
 19303 7975-read-acct.
 19304
 19305     move spaces              to WS-ACCT-RECORD-SW
 19306                                 pi-dcc-product-code
 19307
 19308     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19309     MOVE PI-CARRIER          TO ACCT-CARRIER
 19310     MOVE PI-GROUPING         TO ACCT-GROUPING
 19311     MOVE PI-STATE            TO ACCT-STATE
 19312     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19313     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19314     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19315     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19316
 19317
 19318* EXEC CICS READ
 19319*       DATASET ('ERACCT')
 19320*       RIDFLD  (ERACCT-KEY)
 19321*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19322*       GTEQ
 19323*       resp    (WS-RESPONSE)
 19324*    END-EXEC
 19325     MOVE 'ERACCT' TO DFHEIV1
 19326*    MOVE '&"S        G          (  N#00017183' TO DFHEIV0
 19327     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19329     MOVE X'204E233030303137313833' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0,
 19331           DFHEIV1,
 19332           DFHEIV20,
 19333           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 371
* EL156.cbl
 19334           ERACCT-KEY,
 19335           DFHEIV99,
 19336           DFHEIV99,
 19337           DFHEIV99
 19338     SET ADDRESS OF ACCOUNT-MASTER TO
 19339         DFHEIV20
 19340     MOVE EIBRESP  TO WS-RESPONSE
 19341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19342     IF WS-RESP-NORMAL
 19343        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19344        and pi-cert-eff-dt < am-expiration-dt
 19345        and pi-cert-eff-dt >= am-effective-dt
 19346        move am-dcc-product-code to pi-dcc-product-code
 19347        set acct-found to true
 19348     end-if
 19349
 19350     .
 19351 7975-exit.
 19352     exit.
 19353 7980-READ-CERT-UPDATE.
 19354
 19355* EXEC CICS READ
 19356*        DATASET  ('ELCERT')
 19357*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19358*        RIDFLD   (ELCERT-KEY)
 19359*        UPDATE
 19360*    END-EXEC.
 19361     MOVE 'ELCERT' TO DFHEIV1
 19362*    MOVE '&"S        EU         (   #00017202' TO DFHEIV0
 19363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19364     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303137323032' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           DFHEIV1,
 19368           DFHEIV20,
 19369           DFHEIV99,
 19370           ELCERT-KEY,
 19371           DFHEIV99,
 19372           DFHEIV99,
 19373           DFHEIV99
 19374     SET ADDRESS OF CERTIFICATE-MASTER TO
 19375         DFHEIV20
 19376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19377
 19378
 19379 7980-EXIT.
 19380      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 372
* EL156.cbl
 19382 8000-LOAD-ERROR-MESSAGES.
 19383     IF PI-PASS-SW = 'C'
 19384        MOVE EMI-LINE1           TO ERMSG1BO
 19385     ELSE
 19386        MOVE EMI-LINE1           TO ERRMSG1O
 19387        MOVE EMI-LINE2           TO ERRMSG2O.
 19388
 19389 8000-EXIT.
 19390     EXIT.
 19391
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 373
* EL156.cbl
 19393
 19394 8010-DMD-ERROR-CHECKS.
 19395     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19396
 19397     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19398         GO TO 8051-ISSUE-ERROR.
 19399
 19400     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19401     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19402     MOVE '3'                    TO DC-OPTION-CODE.
 19403     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19404     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19405         GO TO 8051-ISSUE-ERROR.
 19406
 19407     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19408       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19409                           OR
 19410          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19411           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19412             MOVE ER-0851         TO EMI-ERROR
 19413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19414       END-IF
 19415       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19416             MOVE ER-8147         TO EMI-ERROR
 19417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19418
 19419     GO TO 8090-EXIT.
 19420
 19421 8051-ISSUE-ERROR.
 19422     MOVE ER-8146            TO EMI-ERROR.
 19423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19424     GO TO 8090-EXIT.
 19425
 19426 8090-EXIT.
 19427      EXIT.
 19428
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 374
* EL156.cbl
 19430 8100-SEND-INITIAL-MAP.
 19431
 19432     MOVE SAVE-DATE              TO RUNDTEAO.
 19433     MOVE EIBTIME                TO TIME-IN.
 19434     MOVE TIME-OUT               TO RUNTIMAO.
 19435     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19436
 19437     IF MAP-NAME = 'EL156A'
 19438        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19439           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19440        END-IF
 19441     END-IF
 19442*    IF MAP-NAME = 'EL156A'
 19443*       IF PI-COMPANY-ID = 'CRI'
 19444*          NEXT SENTENCE
 19445*       ELSE
 19446*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19447
 19448     IF MAP-NAME = 'EL156A'
 19449        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19450           NEXT SENTENCE
 19451        ELSE
 19452           MOVE AL-SADOF TO  PINTA    PINTHA.
 19453
 19454     IF MAP-NAME = 'EL156A'
 19455        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19456            NEXT SENTENCE
 19457        ELSE
 19458           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19459
 19460*    IF MAP-NAME = 'EL156A'
 19461*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19462*          NEXT SENTENCE
 19463*       ELSE
 19464*          MOVE AL-SADOF TO CASHHA CASHA.
 19465
 19466     IF MAP-NAME = 'EL156A'
 19467        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19468           NEXT SENTENCE
 19469        ELSE
 19470           MOVE AL-SADOF        TO  LOANHA
 19471                                    LOANNOA.
 19472
 19473     IF MAP-NAME = 'EL156A'
 19474        MOVE -1                 TO  ENTERPFL
 19475        IF PI-USES-PAID-TO
 19476           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19477           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19478           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19479        ELSE
 19480           NEXT SENTENCE
 19481     ELSE
 19482        IF MAP-NAME = 'EL156B'
 19483           IF PI-USES-PAID-TO
 19484              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19485              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19486
 19487
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 375
* EL156.cbl
 19488* EXEC CICS SEND
 19489*        MAP   (MAP-NAME)
 19490*        MAPSET(MAPSET-NAME)
 19491*        FROM  (EL156AI)
 19492*        ERASE
 19493*        CURSOR
 19494*    END-EXEC.
 19495     MOVE LENGTH OF
 19496      EL156AI
 19497       TO DFHEIV12
 19498     MOVE -1
 19499       TO DFHEIV11
 19500*    MOVE '8$     CT  E    H L F ,   #00017317' TO DFHEIV0
 19501     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19502     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19503     MOVE X'2020233030303137333137' TO DFHEIV0(25:11)
 19504     CALL 'kxdfhei1' USING DFHEIV0,
 19505           MAP-NAME,
 19506           EL156AI,
 19507           DFHEIV12,
 19508           MAPSET-NAME,
 19509           DFHEIV99,
 19510           DFHEIV99,
 19511           DFHEIV99,
 19512           DFHEIV11,
 19513           DFHEIV99,
 19514           DFHEIV99,
 19515           DFHEIV99
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19517
 19518
 19519     GO TO 9100-RETURN-TRAN.
 19520
 19521 8200-SEND-DATAONLY.
 19522
 19523     IF FIRST-ENTRY = 'Y'
 19524         GO TO 8100-SEND-INITIAL-MAP.
 19525
 19526     IF RETURNED-FROM-B = 'Y'
 19527         GO TO 8100-SEND-INITIAL-MAP.
 19528
 19529     MOVE SAVE-DATE              TO RUNDTEAO.
 19530     MOVE EIBTIME                TO TIME-IN.
 19531     MOVE TIME-OUT               TO RUNTIMAO.
 19532
 19533     IF EIBAID = DFHPF11
 19534        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19536        MOVE 'EL001   '          TO RETURNED-FROM
 19537        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19538        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19539        GO TO 8100-SEND-INITIAL-MAP.
 19540
 19541     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19542
 19543     IF MAP-NAME =  'EL156A'
 19544        MOVE -1                 TO  ENTERPFL
 19545        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 376
* EL156.cbl
 19546           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19547           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19548           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19549        ELSE
 19550           NEXT SENTENCE
 19551     ELSE
 19552        IF MAP-NAME = 'EL156B'
 19553           IF PI-USES-PAID-TO
 19554              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19555              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19556
 19557     IF MAP-NAME =  'EL156A'
 19558        IF PI-COMPANY-ID = 'BOA'
 19559            IF PI-INT-RATE NUMERIC
 19560                MOVE PI-INT-RATE TO PINTO.
 19561     IF MAP-NAME = 'EL156A'
 19562        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19563           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19564*          MOVE 'Y'              TO EOBYNO
 19565        END-IF
 19566     END-IF
 19567
 19568
 19569* EXEC CICS SEND
 19570*        MAP   (MAP-NAME)
 19571*        MAPSET(MAPSET-NAME)
 19572*        FROM  (EL156AI)
 19573*        DATAONLY
 19574*        CURSOR
 19575*    END-EXEC.
 19576     MOVE LENGTH OF
 19577      EL156AI
 19578       TO DFHEIV12
 19579     MOVE -1
 19580       TO DFHEIV11
 19581*    MOVE '8$D    CT       H L F ,   #00017374' TO DFHEIV0
 19582     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19583     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19584     MOVE X'2020233030303137333734' TO DFHEIV0(25:11)
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           MAP-NAME,
 19587           EL156AI,
 19588           DFHEIV12,
 19589           MAPSET-NAME,
 19590           DFHEIV99,
 19591           DFHEIV99,
 19592           DFHEIV99,
 19593           DFHEIV11,
 19594           DFHEIV99,
 19595           DFHEIV99,
 19596           DFHEIV99
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19598
 19599
 19600     GO TO 9100-RETURN-TRAN.
 19601
 19602 8300-SEND-TEXT.
 19603
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 377
* EL156.cbl
 19604* EXEC CICS SEND TEXT
 19605*        FROM(LOGOFF-TEXT)
 19606*        LENGTH(LOGOFF-LENGTH)
 19607*        ERASE
 19608*        FREEKB
 19609*    END-EXEC.
 19610*    MOVE '8&      T  E F  H   F -   #00017385' TO DFHEIV0
 19611     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19612     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19613     MOVE X'2020233030303137333835' TO DFHEIV0(25:11)
 19614     CALL 'kxdfhei1' USING DFHEIV0,
 19615           LOGOFF-TEXT,
 19616           LOGOFF-LENGTH,
 19617           DFHEIV99,
 19618           DFHEIV99,
 19619           DFHEIV99,
 19620           DFHEIV99,
 19621           DFHEIV99,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV99,
 19625           DFHEIV99,
 19626           DFHEIV99
 19627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19628
 19629
 19630
 19631* EXEC CICS RETURN
 19632*    END-EXEC.
 19633*    MOVE '.(                    ''   #00017392' TO DFHEIV0
 19634     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19635     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19636     MOVE X'2020233030303137333932' TO DFHEIV0(25:11)
 19637     CALL 'kxdfhei1' USING DFHEIV0,
 19638           DFHEIV99,
 19639           DFHEIV99,
 19640           DFHEIV99,
 19641           DFHEIV99,
 19642           DFHEIV99,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647 8500-FILE-NOTOPEN.
 19648     IF FILE-SWITCH = 'MSTR'
 19649         MOVE ER-0154            TO EMI-ERROR.
 19650     IF FILE-SWITCH = 'TRLR'
 19651         MOVE ER-0172            TO EMI-ERROR.
 19652     IF FILE-SWITCH = 'CERT'
 19653         MOVE ER-0169            TO EMI-ERROR.
 19654     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19655                      'PROC' OR 'STAT'
 19656         MOVE ER-0042            TO EMI-ERROR.
 19657     IF FILE-SWITCH = 'ACTQ'
 19658         MOVE ER-0338            TO EMI-ERROR.
 19659     IF FILE-SWITCH = 'ACCT'
 19660         MOVE ER-0168            TO EMI-ERROR.
 19661
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 378
* EL156.cbl
 19662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19663     MOVE -1                     TO PMTTYPEL.
 19664
 19665     IF FIRST-ENTRY = 'Y'
 19666         GO TO 8100-SEND-INITIAL-MAP.
 19667
 19668     GO TO 8200-SEND-DATAONLY.
 19669
 19670 8600-PGRM-NOT-FOUND.
 19671
 19672     MOVE ER-0923                TO EMI-ERROR.
 19673     MOVE -1                     TO ENTPFBL.
 19674     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19675
 19676     IF FIRST-ENTRY = 'Y'
 19677         GO TO 8100-SEND-INITIAL-MAP
 19678     ELSE
 19679         GO TO 8200-SEND-DATAONLY.
 19680
 19681 8800-UNAUTHORIZED-ACCESS.
 19682     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19683     GO TO 8300-SEND-TEXT.
 19684
 19685 8810-PF23.
 19686     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19687     MOVE XCTL-005               TO PGM-NAME.
 19688     GO TO 9300-XCTL.
 19689
 19690 8820-PF7-8.
 19691     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19692     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19693                                    PI-SAVED-PROGRAM-2
 19694                                    PI-SAVED-PROGRAM-3
 19695                                    PI-SAVED-PROGRAM-4
 19696                                    PI-SAVED-PROGRAM-5
 19697                                    PI-SAVED-PROGRAM-6
 19698                                    PI-RETURN-TO-PROGRAM.
 19699     IF EIBAID = DFHPF8
 19700        MOVE XCTL-132            TO PGM-NAME
 19701     ELSE
 19702        MOVE XCTL-130            TO PGM-NAME.
 19703
 19704     GO TO 9300-XCTL.
 19705
 19706 9100-RETURN-TRAN.
 19707     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19708     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19709
 19710
 19711* EXEC CICS RETURN
 19712*        TRANSID(TRANS-ID)
 19713*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19714*        LENGTH(PI-COMM-LENGTH)
 19715*    END-EXEC.
 19716*    MOVE '.(CT                  ''   #00017458' TO DFHEIV0
 19717     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19719     MOVE X'2020233030303137343538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 379
* EL156.cbl
 19720     CALL 'kxdfhei1' USING DFHEIV0,
 19721           TRANS-ID,
 19722           PROGRAM-INTERFACE-BLOCK,
 19723           PI-COMM-LENGTH,
 19724           DFHEIV99,
 19725           DFHEIV99,
 19726           DFHEIV99
 19727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19728
 19729
 19730 9200-RETURN-MAIN-MENU.
 19731     MOVE XCTL-126               TO PGM-NAME.
 19732     GO TO 9300-XCTL.
 19733
 19734 9300-XCTL.
 19735
 19736* EXEC CICS XCTL
 19737*        PROGRAM(PGM-NAME)
 19738*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19739*        LENGTH(PI-COMM-LENGTH)
 19740*    END-EXEC.
 19741*    MOVE '.$C                   %   #00017469' TO DFHEIV0
 19742     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19744     MOVE X'2020233030303137343639' TO DFHEIV0(25:11)
 19745     CALL 'kxdfhei1' USING DFHEIV0,
 19746           PGM-NAME,
 19747           PROGRAM-INTERFACE-BLOCK,
 19748           PI-COMM-LENGTH,
 19749           DFHEIV99
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753 9400-CLEAR.
 19754     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19755     GO TO 9300-XCTL.
 19756
 19757 9500-PF12.
 19758     MOVE XCTL-010               TO PGM-NAME.
 19759     GO TO 9300-XCTL.
 19760
 19761 9700-LINK-DATE-CONVERT.
 19762     MOVE LINK-ELDATCV           TO PGM-NAME.
 19763
 19764* EXEC CICS LINK
 19765*        PROGRAM   (PGM-NAME)
 19766*        COMMAREA  (DATE-CONVERSION-DATA)
 19767*        LENGTH    (DC-COMM-LENGTH)
 19768*    END-EXEC.
 19769*    MOVE '."C                   (   #00017485' TO DFHEIV0
 19770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19772     MOVE X'2020233030303137343835' TO DFHEIV0(25:11)
 19773     CALL 'kxdfhei1' USING DFHEIV0,
 19774           PGM-NAME,
 19775           DATE-CONVERSION-DATA,
 19776           DC-COMM-LENGTH,
 19777           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 380
* EL156.cbl
 19778           DFHEIV99,
 19779           DFHEIV99,
 19780           DFHEIV99
 19781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19782
 19783
 19784 9700-EXIT.
 19785     EXIT.
 19786
 19787 9800-LINK-REM-TERM.
 19788     MOVE LINK-REMTERM TO PGM-NAME.
 19789
 19790
 19791* EXEC CICS LINK
 19792*        PROGRAM   (PGM-NAME)
 19793*        COMMAREA  (CALCULATION-PASS-AREA)
 19794*        LENGTH    (CP-COMM-LENGTH)
 19795*    END-EXEC.
 19796*    MOVE '."C                   (   #00017497' TO DFHEIV0
 19797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303137343937' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
 19801           PGM-NAME,
 19802           CALCULATION-PASS-AREA,
 19803           CP-COMM-LENGTH,
 19804           DFHEIV99,
 19805           DFHEIV99,
 19806           DFHEIV99,
 19807           DFHEIV99
 19808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19809
 19810
 19811 9800-EXIT.
 19812     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 381
* EL156.cbl
 19814 9830-DMD-REMAINING-TERM.
 19815
 19816     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19817         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19818
 19819     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19820                              CM-PMT-EXTENSION-DAYS.
 19821
 19822     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19823                                  CL-NO-OF-DAYS-PAID.
 19824
 19825     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19826         GIVING W-REM REMAINDER W-REM-DAYS.
 19827
 19828     MOVE W-REM                  TO WST-REM.
 19829
 19830     IF W-REM-DAYS > ZEROS
 19831         MOVE '/'                TO WST-SLASH
 19832         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19833     ELSE
 19834         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19835
 19836 9830-EXIT.
 19837     EXIT.
 19838
 19839 9870-OUTPUT-ACTIVITY-RECORD.
 19840
 19841
 19842* EXEC CICS GETMAIN
 19843*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19844*         LENGTH(25)
 19845*         INITIMG(WS-BLANK)
 19846*    END-EXEC.
 19847     MOVE 25
 19848       TO DFHEIV11
 19849*    MOVE ',"IL                  $   #00017533' TO DFHEIV0
 19850     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19851     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19852     MOVE X'2020233030303137353333' TO DFHEIV0(25:11)
 19853     CALL 'kxdfhei1' USING DFHEIV0,
 19854           DFHEIV20,
 19855           DFHEIV11,
 19856           WS-BLANK
 19857     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19858         DFHEIV20
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19860
 19861
 19862     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19863     MOVE ELMSTR-KEY             TO DA-KEY.
 19864     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19865
 19866     IF PI-PMTTYPE EQUAL '7'
 19867         MOVE 'V'                TO DA-RECORD-TYPE
 19868     ELSE
 19869         MOVE 'P'                TO DA-RECORD-TYPE.
 19870
 19871
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 382
* EL156.cbl
 19872* EXEC CICS HANDLE CONDITION
 19873*         NOTOPEN(9870-NOTOPEN)
 19874*         DUPREC(9870-EXIT)
 19875*    END-EXEC.
 19876*    MOVE '"$J%                  ! B #00017548' TO DFHEIV0
 19877     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19879     MOVE X'4220233030303137353438' TO DFHEIV0(25:11)
 19880     CALL 'kxdfhei1' USING DFHEIV0
 19881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19882
 19883
 19884
 19885* EXEC CICS WRITE
 19886*         DATASET('DLYACTV')
 19887*         RIDFLD(DA-KEY)
 19888*         FROM(DAILY-ACTIVITY-RECORD)
 19889*         LENGTH(25)
 19890*    END-EXEC.
 19891     MOVE 'DLYACTV' TO DFHEIV1
 19892     MOVE 25
 19893       TO DFHEIV11
 19894*    MOVE '&$ L                  ''   #00017553' TO DFHEIV0
 19895     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19896     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19897     MOVE X'2020233030303137353533' TO DFHEIV0(25:11)
 19898     CALL 'kxdfhei1' USING DFHEIV0,
 19899           DFHEIV1,
 19900           DAILY-ACTIVITY-RECORD,
 19901           DFHEIV11,
 19902           DA-KEY,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19906
 19907     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19908     GO TO 9870-EXIT.
 19909
 19910 9870-NOTOPEN.
 19911
 19912     MOVE '2955'                 TO EMI-ERROR.
 19913     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19914
 19915 9870-EXIT.
 19916     EXIT.
 19917
 19918 9900-ERROR-FORMAT.
 19919
 19920     IF EMI-ERROR = ER-0923
 19921         MOVE PGM-NAME           TO W-CALLED-NAME.
 19922
 19923     MOVE LINK-001      TO PGM-NAME.
 19924     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19925
 19926
 19927* EXEC CICS LINK
 19928*        PROGRAM (PGM-NAME)
 19929*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 383
* EL156.cbl
 19930*        LENGTH  (EMI-COMM-LENGTH)
 19931*    END-EXEC.
 19932*    MOVE '."C                   (   #00017578' TO DFHEIV0
 19933     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19935     MOVE X'2020233030303137353738' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0,
 19937           PGM-NAME,
 19938           ERROR-MESSAGE-INTERFACE-BLOCK,
 19939           EMI-COMM-LENGTH,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99,
 19943           DFHEIV99
 19944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19945
 19946
 19947     IF EMI-ERROR = ER-0923
 19948         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19949
 19950 9900-EXIT.
 19951     EXIT.
 19952
 19953 9990-ABEND.
 19954     MOVE LINK-004               TO PGM-NAME.
 19955     MOVE DFHEIBLK               TO EMI-LINE1.
 19956
 19957* EXEC CICS LINK
 19958*        PROGRAM   (PGM-NAME)
 19959*        COMMAREA  (EMI-LINE1)
 19960*        LENGTH    (64)
 19961*    END-EXEC.
 19962     MOVE 64
 19963       TO DFHEIV11
 19964*    MOVE '."C                   (   #00017593' TO DFHEIV0
 19965     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19967     MOVE X'2020233030303137353933' TO DFHEIV0(25:11)
 19968     CALL 'kxdfhei1' USING DFHEIV0,
 19969           PGM-NAME,
 19970           EMI-LINE1,
 19971           DFHEIV11,
 19972           DFHEIV99,
 19973           DFHEIV99,
 19974           DFHEIV99,
 19975           DFHEIV99
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979     MOVE 'EL156A'               TO  MAP-NAME.
 19980     MOVE LOW-VALUES             TO  EL156AO.
 19981     GO TO 8100-SEND-INITIAL-MAP.
 19982
 19983 9995-SECURITY-VIOLATION.
 19984*    COPY ELCSCTP.
 19985******************************************************************
 19986*                                                                *
 19987*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 384
* EL156.cbl
 19988*                            VMOD=2.001                          *
 19989*                                                                *
 19990*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19991******************************************************************
 19992
 19993
 19994     MOVE EIBDATE          TO SM-JUL-DATE.
 19995     MOVE EIBTRMID         TO SM-TERMID.
 19996     MOVE THIS-PGM         TO SM-PGM.
 19997     MOVE EIBTIME          TO TIME-IN.
 19998     MOVE TIME-OUT         TO SM-TIME.
 19999     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20000
 20001
 20002* EXEC CICS LINK
 20003*         PROGRAM  ('EL003')
 20004*         COMMAREA (SECURITY-MESSAGE)
 20005*         LENGTH   (80)
 20006*    END-EXEC.
 20007     MOVE 'EL003' TO DFHEIV1
 20008     MOVE 80
 20009       TO DFHEIV11
 20010*    MOVE '."C                   (   #00017621' TO DFHEIV0
 20011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20013     MOVE X'2020233030303137363231' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           DFHEIV1,
 20016           SECURITY-MESSAGE,
 20017           DFHEIV11,
 20018           DFHEIV99,
 20019           DFHEIV99,
 20020           DFHEIV99,
 20021           DFHEIV99
 20022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20023
 20024
 20025******************************************************************
 20026
 20027
 20028
 20029 9999-DFHBACK SECTION.
 20030     MOVE '9%                    "   ' TO DFHEIV0
 20031     MOVE 'EL156' TO DFHEIV1
 20032     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20033     GOBACK.
 20034 9999-DFHEXIT.
 20035     IF DFHEIGDJ EQUAL 0001
 20036         NEXT SENTENCE
 20037     ELSE IF DFHEIGDJ EQUAL 2
 20038         GO TO 9990-ABEND,
 20039               8600-PGRM-NOT-FOUND,
 20040               0400-FIRST-TIME,
 20041               6180-DUPREC,
 20042               9990-ABEND
 20043         DEPENDING ON DFHEIGDI
 20044     ELSE IF DFHEIGDJ EQUAL 3
 20045         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 385
* EL156.cbl
 20046               0380-CLAIM-END-FILE
 20047         DEPENDING ON DFHEIGDI
 20048     ELSE IF DFHEIGDJ EQUAL 4
 20049         GO TO 0380-CLAIM-END-FILE,
 20050               0380-CLAIM-END-FILE
 20051         DEPENDING ON DFHEIGDI
 20052     ELSE IF DFHEIGDJ EQUAL 5
 20053         GO TO 0800-EXIT
 20054         DEPENDING ON DFHEIGDI
 20055     ELSE IF DFHEIGDJ EQUAL 6
 20056         GO TO 1950-NOT-FOUND,
 20057               1950-NOT-FOUND
 20058         DEPENDING ON DFHEIGDI
 20059     ELSE IF DFHEIGDJ EQUAL 7
 20060         GO TO 1950-NOT-FOUND
 20061         DEPENDING ON DFHEIGDI
 20062     ELSE IF DFHEIGDJ EQUAL 8
 20063         GO TO 1950-NOT-FOUND,
 20064               1950-NOT-FOUND
 20065         DEPENDING ON DFHEIGDI
 20066     ELSE IF DFHEIGDJ EQUAL 9
 20067         GO TO 1166-END-CHECK,
 20068               1166-END-CHECK
 20069         DEPENDING ON DFHEIGDI
 20070     ELSE IF DFHEIGDJ EQUAL 10
 20071         GO TO 1950-NOT-FOUND,
 20072               1950-NOT-FOUND
 20073         DEPENDING ON DFHEIGDI
 20074     ELSE IF DFHEIGDJ EQUAL 11
 20075         GO TO 1950-NOT-FOUND,
 20076               1950-NOT-FOUND
 20077         DEPENDING ON DFHEIGDI
 20078     ELSE IF DFHEIGDJ EQUAL 12
 20079         GO TO 1950-NOT-FOUND
 20080         DEPENDING ON DFHEIGDI
 20081     ELSE IF DFHEIGDJ EQUAL 13
 20082         GO TO 3600-CONTINUE
 20083         DEPENDING ON DFHEIGDI
 20084     ELSE IF DFHEIGDJ EQUAL 14
 20085         GO TO 5300-NOTE-NOT-FOUND
 20086         DEPENDING ON DFHEIGDI
 20087     ELSE IF DFHEIGDJ EQUAL 15
 20088         GO TO 6065-NOT-FOUND
 20089         DEPENDING ON DFHEIGDI
 20090     ELSE IF DFHEIGDJ EQUAL 16
 20091         GO TO 6068-ACCT-NOT-FND
 20092         DEPENDING ON DFHEIGDI
 20093     ELSE IF DFHEIGDJ EQUAL 17
 20094         GO TO 6074-GET-COMP-DATA
 20095         DEPENDING ON DFHEIGDI
 20096     ELSE IF DFHEIGDJ EQUAL 18
 20097         GO TO 6170-WRITE
 20098         DEPENDING ON DFHEIGDI
 20099     ELSE IF DFHEIGDJ EQUAL 19
 20100         GO TO 6180-DUPREC
 20101         DEPENDING ON DFHEIGDI
 20102     ELSE IF DFHEIGDJ EQUAL 20
 20103         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 386
* EL156.cbl
 20104         DEPENDING ON DFHEIGDI
 20105     ELSE IF DFHEIGDJ EQUAL 21
 20106         GO TO 6185-DUPREC
 20107         DEPENDING ON DFHEIGDI
 20108     ELSE IF DFHEIGDJ EQUAL 22
 20109         GO TO 6720-BUILD-NEW-RECORD
 20110         DEPENDING ON DFHEIGDI
 20111     ELSE IF DFHEIGDJ EQUAL 23
 20112         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20113               6900-BUILD-ARCHIVE-HEADER
 20114         DEPENDING ON DFHEIGDI
 20115     ELSE IF DFHEIGDJ EQUAL 24
 20116         GO TO 7010-BUILD-MAP
 20117         DEPENDING ON DFHEIGDI
 20118     ELSE IF DFHEIGDJ EQUAL 25
 20119         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20120         DEPENDING ON DFHEIGDI
 20121     ELSE IF DFHEIGDJ EQUAL 26
 20122         GO TO 7160-DUPREC
 20123         DEPENDING ON DFHEIGDI
 20124     ELSE IF DFHEIGDJ EQUAL 27
 20125         GO TO 7200-EXIT,
 20126               7200-EXIT
 20127         DEPENDING ON DFHEIGDI
 20128     ELSE IF DFHEIGDJ EQUAL 28
 20129         GO TO 7400-NOT-FOUND
 20130         DEPENDING ON DFHEIGDI
 20131     ELSE IF DFHEIGDJ EQUAL 29
 20132         GO TO 7590-END,
 20133               7590-END
 20134         DEPENDING ON DFHEIGDI
 20135     ELSE IF DFHEIGDJ EQUAL 30
 20136         GO TO 7699-EXIT
 20137         DEPENDING ON DFHEIGDI
 20138     ELSE IF DFHEIGDJ EQUAL 31
 20139         GO TO 5300-NOTE-NOT-FOUND
 20140         DEPENDING ON DFHEIGDI
 20141     ELSE IF DFHEIGDJ EQUAL 32
 20142         GO TO 7800-COMP-NOTFND
 20143         DEPENDING ON DFHEIGDI
 20144     ELSE IF DFHEIGDJ EQUAL 33
 20145         GO TO 7920-NOT-FOUND
 20146         DEPENDING ON DFHEIGDI
 20147     ELSE IF DFHEIGDJ EQUAL 34
 20148         GO TO 9870-NOTOPEN,
 20149               9870-EXIT
 20150         DEPENDING ON DFHEIGDI.
 20151     MOVE '9%                    "   ' TO DFHEIV0
 20152     MOVE 'EL156' TO DFHEIV1
 20153     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20154     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12132     Code:       74446
