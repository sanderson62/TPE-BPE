* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL65091.cbl
* Options: int("EL65091.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL65091.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL65091.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL65091.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL65091.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 08:35:33.
     7*                            VMOD=2.003.
     8*
     9*
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL65091.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXDB - ACCOUNT NOTEPAD PRINT ROUTINE.
    25
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    35*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    36******************************************************************
    37 ENVIRONMENT DIVISION.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL65091.cbl
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32) VALUE '********************************'.
    44 77  FILLER  PIC X(32) VALUE '*   EL65091  WORKING-STORAGE   *'.
    45 77  FILLER  PIC X(32) VALUE '*********** V/M 2.003 **********'.
    46
    47 77  WS-LEN  PIC S9(4)  COMP    VALUE +326.
    48
    49 77  WS-SAVED-PI-COMPANY-ID     PIC XXX.
    50
    51 01  STANDARD-AREAS.
    52     12  W-DELAY-CNT             PIC S9(3)  COMP-3 VALUE ZERO.
    53     12  W-DELAY-INTERVAL        PIC S9(7)  COMP-3 VALUE +2.
    54     12  PGM-NAME                PIC X(8).
    55     12  LINK-001                PIC X(8)    VALUE  'EL001'.
    56     12  LINK-004                PIC X(8)    VALUE  'EL004'.
    57     12  LINK-ELDATCV            PIC X(8)    VALUE  'ELDATCV'.
    58     12  ERROR-LINE              PIC X(70).
    59
    60     12  W-DATE-AREA.
    61         16  W-CURRENT-DATE      PIC X(8)    VALUE SPACES.
    62         16  W-CURRENT-BIN-DATE  PIC X(2)    VALUE SPACES.
    63
    64     12  LINE-CNT                PIC S9(3)  COMP-3 VALUE ZERO.
    65     12  WS-TERMINAL-ID.
    66         16  WS-TERM-PREFIX      PIC XX.
    67         16  FILLER              PIC XX.
    68     12  ERACNT-FILE-ID          PIC X(8) VALUE 'ERACNT'.
    69     12  ERACCT-FILE-ID          PIC X(8) VALUE 'ERACCT'.
    70     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
    71         88 FIRST-ONE            VALUE 'Y'.
    72     12  ERACNT-KEY-LENGTH       PIC S9(4)   COMP  VALUE +23.
    73     12  ERACNT-START-LENGTH     PIC S9(4)   COMP  VALUE +21.
    74
    75     12  ERACNT-KEY.
    76         16  ERACNT-PARTIAL-KEY.
    77             20  ERACNT-COMPANY-CD    PIC X.
    78             20  ERACNT-CARRIER       PIC X.
    79             20  ERACNT-GROUPING      PIC X(06).
    80             20  ERACNT-STATE         PIC X(02).
    81             20  ERACNT-ACCOUNT       PIC X(10).
    82             20  ERACNT-REC-TYP       PIC X.
    83         16  ERACNT-SEQ          PIC S9(4) COMP.
    84
    85     12  ERACCT-KEY.
    86         16  ERACCT-PARTIAL-KEY.
    87             20  ERACCT-COMPANY-CD    PIC X.
    88             20  ERACCT-CARRIER       PIC X.
    89             20  ERACCT-GROUPING      PIC X(06).
    90             20  ERACCT-STATE         PIC X(02).
    91             20  ERACCT-ACCOUNT       PIC X(10).
    92         16  ERACCT-EXP-DT       PIC XX.
    93
    94     12  W-PRIOR-KEY.
    95         16  W-PRIOR-PARTIAL-KEY.
    96             20  W-PRIOR-COMPANY-CD   PIC X.
    97             20  W-PRIOR-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL65091.cbl
    98             20  W-PRIOR-GROUPING     PIC X(06).
    99             20  W-PRIOR-STATE        PIC X(02).
   100             20  W-PRIOR-ACCOUNT      PIC X(10).
   101             20  W-PRIOR-REC-TYP      PIC X.
   102         16  W-PRIOR-SEQ         PIC S9(4) COMP.
   103
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL65091.cbl
   105 01  PRT-LINES.
   106     05  HEAD-LINE-1.
   107         10  FILLER              PIC X(01)    VALUE SPACES.
   108         10  H1-DATE             PIC X(08)    VALUE SPACES.
   109         10  FILLER              PIC X(22)    VALUE SPACES.
   110         10  FILLER              PIC X(18)    VALUE
   111             ' ACCOUNT NOTEPAD  '.
   112         10  FILLER              PIC X(23)    VALUE SPACES.
   113         10  THIS-PGM            PIC X(7)     VALUE 'EL65091'.
   114         10  FILLER              PIC X(01)    VALUE SPACES.
   115
   116     05  HEAD-LINE-ACCOUNT.
   117         10  FILLER              PIC X(01)    VALUE SPACES.
   118         10  FILLER              PIC X(07)    VALUE
   119            'CARRIER'.
   120         10  FILLER              PIC X(01)    VALUE SPACES.
   121         10  FILLER              PIC X(08)    VALUE
   122            'GROUPING'.
   123         10  FILLER              PIC X(02)    VALUE SPACES.
   124         10  FILLER              PIC X(05)    VALUE
   125            'STATE'.
   126         10  FILLER              PIC X(04)    VALUE SPACES.
   127         10  FILLER              PIC X(07)    VALUE
   128            'ACCOUNT'.
   129         10  FILLER              PIC X(07)    VALUE SPACES.
   130         10  FILLER              PIC X(04)    VALUE
   131            'NAME'.
   132         10  FILLER              PIC X(34)    VALUE SPACES.
   133
   134     05  DETAIL-LINE-ACCOUNT.
   135         10  FILLER              PIC X(01)    VALUE SPACES.
   136         10  FILLER              PIC X(03)    VALUE SPACES.
   137         10  DA-CARRIER          PIC X(01)    VALUE SPACES.
   138         10  FILLER              PIC X(05)    VALUE SPACES.
   139         10  DA-GROUPING         PIC X(06)    VALUE SPACES.
   140         10  FILLER              PIC X(05)    VALUE SPACES.
   141         10  DA-STATE            PIC X(02)    VALUE SPACES.
   142         10  FILLER              PIC X(04)    VALUE SPACES.
   143         10  DA-ACCOUNT          PIC X(10)    VALUE SPACES.
   144         10  FILLER              PIC X(05)    VALUE SPACES.
   145         10  DA-ACCT-NAME        PIC X(30)    VALUE SPACES.
   146         10  FILLER              PIC X(08)    VALUE SPACES.
   147
   148     05  HEAD-LINE-2.
   149         10  FILLER             PIC X(69)    VALUE SPACES.
   150         10  FILLER             PIC X(10)    VALUE
   151            'CHG       '.
   152         10  FILLER             PIC X(01)    VALUE SPACES.
   153
   154     05  HEAD-LINE-3.
   155         10  FILLER             PIC X(01)    VALUE SPACES.
   156         10  FILLER             PIC X(12)    VALUE
   157             'LINE    TEXT'.
   158         10  FILLER             PIC X(57)    VALUE SPACES.
   159         10  FILLER             PIC X(09)    VALUE
   160            'BY  DATE '.
   161         10  FILLER             PIC X(01)    VALUE SPACES.
   162
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL65091.cbl
   163     05  DETAIL-LINE-1.
   164         10  FILLER             PIC X        VALUE SPACES.
   165         10  D1-LINE-NO         PIC Z99      VALUE ZEROS.
   166         10  FILLER             PIC X(01)    VALUE ' '.
   167         10  D1-TEXT            PIC X(60)    VALUE '*'.
   168         10  FILLER             PIC X(01)    VALUE SPACES.
   169         10  FILLER             PIC X(01)    VALUE SPACES.
   170         10  FILLER             PIC X(01)    VALUE SPACES.
   171         10  D1-MAINT-BY        PIC X(04)    VALUE SPACES.
   172         10  FILLER             PIC X        VALUE SPACES.
   173         10  D1-MAINT-DT        PIC X(6)     VALUE SPACES.
   174         10  FILLER             PIC X        VALUE SPACES.
   175*                                COPY ELCDMD34.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ELCDMD34.                           *
   180*                            VMOD=2.001                          *
   181*                                                                *
   182*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   183*                                                                *
   184*    LENGTH = 272    RECFRM = FIXED                              *
   185*                                                                *
   186******************************************************************
   187 01  DLO034-COMMUNICATION-AREA.
   188     12  DL34-PROCESS-TYPE             PIC X.
   189     12  DL34-COMPANY-ID               PIC XXX.
   190     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
   191     12  DL34-USERID                   PIC X(4).
   192     12  DL34-PRINT-LINE               PIC X(250).
   193     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   194     12  DL34-RETURN-CODE              PIC XX.
   195 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL65091.cbl
   197*                                COPY ELCAID.
   198******************************************************************
   199*                                                                *
   200*                            ELCAID.                             *
   201*                            VMOD=2.001                          *
   202*                                                                *
   203*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   204*                                                                *
   205*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   206*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   207******************************************************************
   208
   209 01  DFHAID.
   210   02  DFHNULL   PIC  X  VALUE  ' '.
   211   02  DFHENTER  PIC  X  VALUE  QUOTE.
   212   02  DFHCLEAR  PIC  X  VALUE  '_'.
   213   02  DFHPEN    PIC  X  VALUE  '='.
   214   02  DFHOPID   PIC  X  VALUE  'W'.
   215   02  DFHPA1    PIC  X  VALUE  '%'.
   216   02  DFHPA2    PIC  X  VALUE  '>'.
   217   02  DFHPA3    PIC  X  VALUE  ','.
   218   02  DFHPF1    PIC  X  VALUE  '1'.
   219   02  DFHPF2    PIC  X  VALUE  '2'.
   220   02  DFHPF3    PIC  X  VALUE  '3'.
   221   02  DFHPF4    PIC  X  VALUE  '4'.
   222   02  DFHPF5    PIC  X  VALUE  '5'.
   223   02  DFHPF6    PIC  X  VALUE  '6'.
   224   02  DFHPF7    PIC  X  VALUE  '7'.
   225   02  DFHPF8    PIC  X  VALUE  '8'.
   226   02  DFHPF9    PIC  X  VALUE  '9'.
   227   02  DFHPF10   PIC  X  VALUE  ':'.
   228   02  DFHPF11   PIC  X  VALUE  '#'.
   229   02  DFHPF12   PIC  X  VALUE  '@'.
   230   02  DFHPF13   PIC  X  VALUE  'A'.
   231   02  DFHPF14   PIC  X  VALUE  'B'.
   232   02  DFHPF15   PIC  X  VALUE  'C'.
   233   02  DFHPF16   PIC  X  VALUE  'D'.
   234   02  DFHPF17   PIC  X  VALUE  'E'.
   235   02  DFHPF18   PIC  X  VALUE  'F'.
   236   02  DFHPF19   PIC  X  VALUE  'G'.
   237   02  DFHPF20   PIC  X  VALUE  'H'.
   238   02  DFHPF21   PIC  X  VALUE  'I'.
   239*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   240   02  DFHPF22   PIC  X  VALUE  '['.
   241   02  DFHPF23   PIC  X  VALUE  '.'.
   242   02  DFHPF24   PIC  X  VALUE  '<'.
   243   02  DFHMSRE   PIC  X  VALUE  'X'.
   244   02  DFHSTRF   PIC  X  VALUE  'h'.
   245   02  DFHTRIG   PIC  X  VALUE  '"'.
   246 01  PF-AID REDEFINES DFHAID.
   247     05  FILLER                  PIC X(8).
   248     05  PF-VALUES  OCCURS 24    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL65091.cbl
   250*                                COPY ELPRTCVD.
   251*****************************************************************
   252*                                                               *
   253*                            ELPRTCVD.                          *
   254*                            VMOD=2.001                         *
   255*****************************************************************.
   256
   257******************************************************************
   258***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   259***                 -ELPRTCVD-
   260***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   261******************************************************************
   262
   263 01  S-WORK-AREA                     SYNC.
   264     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   265                                     COMP.
   266
   267     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   268                                     COMP.
   269
   270     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   271                                     COMP.
   272
   273     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   274                                     COMP.
   275
   276     12  WS-PROG-END                 PIC X           VALUE SPACES.
   277
   278     12  WS-PRINT-AREA.
   279         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   280           88  SINGLE-SPACE                          VALUE ' '.
   281           88  DOUBLE-SPACE                          VALUE '0'.
   282           88  TRIPLE-SPACE                          VALUE '-'.
   283           88  TOP-PAGE                              VALUE '1'.
   284
   285         16  WS-PASSED-DATA.
   286             20  WS-PRINT-BYTE       PIC X
   287                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   288
   289     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   290                                     COMP-3.
   291     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   292
   293     12  WS-EM                       PIC S9(4)        VALUE +25
   294                                     COMP.
   295     12  FILLER   REDEFINES WS-EM.
   296         16  FILLER                  PIC X.
   297         16  T-EM                    PIC X.
   298
   299*    12  WS-SS                       PIC S9(4)        VALUE +21
   300     12  WS-SS                       PIC S9(4)        VALUE +10
   301                                     COMP.
   302     12  FILLER   REDEFINES WS-SS.
   303         16  FILLER                  PIC X.
   304         16  T-SS                    PIC X.
   305
   306     12  WS-TP                       PIC S9(4)      VALUE +12
   307                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL65091.cbl
   308     12  FILLER   REDEFINES WS-TP.
   309         16  FILLER                  PIC X.
   310         16  T-TP                    PIC X.
   311
   312     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   313         88  FIRST-TIME                              VALUE '1'.
   314         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   315
   316     12  WS-BUFFER-AREA.
   317         16  WS-BUFFER-BYTE          PIC X
   318             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   319                                                BUFFER-INDEX2.
   320
   321******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL65091.cbl
   323*                                COPY ELCINTF.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCINTF.                            *
   328*                            VMOD=2.017                          *
   329*                                                                *
   330*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   331*                                                                *
   332*       LENGTH = 1024                                            *
   333*                                                                *
   334******************************************************************
   335 01  PROGRAM-INTERFACE-BLOCK.
   336     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   337     12  PI-CALLING-PROGRAM              PIC X(8).
   338     12  PI-SAVED-PROGRAM-1              PIC X(8).
   339     12  PI-SAVED-PROGRAM-2              PIC X(8).
   340     12  PI-SAVED-PROGRAM-3              PIC X(8).
   341     12  PI-SAVED-PROGRAM-4              PIC X(8).
   342     12  PI-SAVED-PROGRAM-5              PIC X(8).
   343     12  PI-SAVED-PROGRAM-6              PIC X(8).
   344     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   345     12  PI-COMPANY-ID                   PIC XXX.
   346     12  PI-COMPANY-CD                   PIC X.
   347
   348     12  PI-COMPANY-PASSWORD             PIC X(8).
   349
   350     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   351
   352     12  PI-CONTROL-IN-PROGRESS.
   353         16  PI-CARRIER                  PIC X.
   354         16  PI-GROUPING                 PIC X(6).
   355         16  PI-STATE                    PIC XX.
   356         16  PI-ACCOUNT                  PIC X(10).
   357         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   358                                         PIC X(10).
   359         16  PI-CLAIM-CERT-GRP.
   360             20  PI-CLAIM-NO             PIC X(7).
   361             20  PI-CERT-NO.
   362                 25  PI-CERT-PRIME       PIC X(10).
   363                 25  PI-CERT-SFX         PIC X.
   364             20  PI-CERT-EFF-DT          PIC XX.
   365         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   366             20  PI-PLAN-CODE            PIC X(2).
   367             20  PI-REVISION-NUMBER      PIC X(3).
   368             20  PI-PLAN-EFF-DT          PIC X(2).
   369             20  PI-PLAN-EXP-DT          PIC X(2).
   370             20  FILLER                  PIC X(11).
   371         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   372             20  PI-OE-REFERENCE-1.
   373                 25  PI-OE-REF-1-PRIME   PIC X(18).
   374                 25  PI-OE-REF-1-SUFF    PIC XX.
   375
   376     12  PI-SESSION-IN-PROGRESS          PIC X.
   377         88  CLAIM-SESSION                   VALUE '1'.
   378         88  CREDIT-SESSION                  VALUE '2'.
   379         88  WARRANTY-SESSION                VALUE '3'.
   380         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL65091.cbl
   381         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   382
   383
   384*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   385
   386     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   387     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   388
   389     12  PI-CREDIT-USER                  PIC X.
   390         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   391         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   392
   393     12  PI-CLAIM-USER                   PIC X.
   394         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   395         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   396
   397     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   398         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   399         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   400         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   401         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   402         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   403
   404     12  PI-PROCESSOR-ID                 PIC X(4).
   405
   406     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   407
   408     12  PI-MEMBER-CAPTION               PIC X(10).
   409
   410     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   411         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   412
   413     12  PI-LIFE-OVERRIDE-L1             PIC X.
   414     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   415     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   416     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   417
   418     12  PI-AH-OVERRIDE-L1               PIC X.
   419     12  PI-AH-OVERRIDE-L2               PIC XX.
   420     12  PI-AH-OVERRIDE-L6               PIC X(6).
   421     12  PI-AH-OVERRIDE-L12              PIC X(12).
   422
   423     12  PI-NEW-SYSTEM                   PIC X(2).
   424
   425     12  PI-PRIMARY-CERT-NO              PIC X(11).
   426     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   427         88  PI-USES-PAID-TO                 VALUE '1'.
   428     12  PI-CRDTCRD-SYSTEM.
   429         16  PI-CRDTCRD-USER             PIC X.
   430             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   431             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   432         16  PI-CC-MONTH-END-DT          PIC XX.
   433     12  PI-PROCESSOR-PRINTER            PIC X(4).
   434
   435     12  PI-OE-REFERENCE-2.
   436         16  PI-OE-REF-2-PRIME           PIC X(10).
   437         16  PI-OE-REF-2-SUFF            PIC X.
   438
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL65091.cbl
   439     12  PI-REM-TRM-CALC-OPTION          PIC X.
   440
   441     12  PI-LANGUAGE-TYPE                PIC X.
   442             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   443             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   444             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   445
   446     12  PI-POLICY-LINKAGE-IND           PIC X.
   447         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   448         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   449                                                   LOW-VALUES.
   450
   451     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   452     12  PI-CLAIM-PW-SESSION             PIC X(1).
   453         88  PI-CLAIM-CREDIT                 VALUE '1'.
   454         88  PI-CLAIM-CONVEN                 VALUE '2'.
   455     12  FILLER                          PIC X(4).
   456
   457     12  PI-SYSTEM-LEVEL                 PIC X(145).
   458
   459     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   460         PI-SYSTEM-LEVEL.
   461
   462         16  PI-ENTRY-CODES.
   463             20  PI-ENTRY-CD-1           PIC X.
   464             20  PI-ENTRY-CD-2           PIC X.
   465
   466         16  PI-RETURN-CODES.
   467             20  PI-RETURN-CD-1          PIC X.
   468             20  PI-RETURN-CD-2          PIC X.
   469
   470         16  PI-UPDATE-STATUS-SAVE.
   471             20  PI-UPDATE-BY            PIC X(4).
   472             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   473
   474         16  PI-LOWER-CASE-LETTERS       PIC X.
   475             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   476
   477*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   478*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   479*            88  CARRIER-CLM-CNTL            VALUE '2'.
   480
   481         16  PI-CERT-ACCESS-CONTROL      PIC X.
   482             88  ST-ACCNT-CNTL               VALUE ' '.
   483             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   484             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   485             88  ACCNT-CNTL                  VALUE '3'.
   486             88  CARR-ACCNT-CNTL             VALUE '4'.
   487
   488         16  PI-PROCESSOR-CAP-LIST.
   489             20  PI-SYSTEM-CONTROLS.
   490                24 PI-SYSTEM-DISPLAY     PIC X.
   491                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   492                24 PI-SYSTEM-MODIFY      PIC X.
   493                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   494             20  FILLER                  PIC XX.
   495             20  PI-DISPLAY-CAP          PIC X.
   496                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL65091.cbl
   497             20  PI-MODIFY-CAP           PIC X.
   498                 88  MODIFY-CAP              VALUE 'Y'.
   499             20  PI-MSG-AT-LOGON-CAP     PIC X.
   500                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   501             20  PI-FORCE-CAP            PIC X.
   502                 88  FORCE-CAP               VALUE 'Y'.
   503
   504         16  PI-PROGRAM-CONTROLS.
   505             20  PI-PGM-PRINT-OPT        PIC X.
   506             20  PI-PGM-FORMAT-OPT       PIC X.
   507             20  PI-PGM-PROCESS-OPT      PIC X.
   508             20  PI-PGM-TOTALS-OPT       PIC X.
   509
   510         16  PI-HELP-INTERFACE.
   511             20  PI-LAST-ERROR-NO        PIC X(4).
   512             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   513
   514         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   515             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   516
   517         16  PI-CR-CONTROL-IN-PROGRESS.
   518             20  PI-CR-CARRIER           PIC X.
   519             20  PI-CR-GROUPING          PIC X(6).
   520             20  PI-CR-STATE             PIC XX.
   521             20  PI-CR-ACCOUNT           PIC X(10).
   522             20  PI-CR-FIN-RESP          PIC X(10).
   523             20  PI-CR-TYPE              PIC X.
   524
   525         16  PI-CR-BATCH-NUMBER          PIC X(6).
   526
   527         16  PI-CR-MONTH-END-DT          PIC XX.
   528
   529         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   530             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   531             88  PI-ZERO-CARRIER             VALUE '1'.
   532             88  PI-ZERO-GROUPING            VALUE '2'.
   533             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   534
   535         16  PI-CARRIER-SECURITY         PIC X.
   536             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   537
   538         16  PI-ACCOUNT-SECURITY         PIC X(10).
   539             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   540             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   541
   542         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   543             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   544                                         INDEXED BY PI-ACCESS-NDX
   545                                         PIC X.
   546
   547         16  PI-GA-BILLING-CONTROL       PIC X.
   548             88  PI-GA-BILLING               VALUE '1'.
   549
   550         16  PI-MAIL-PROCESSING          PIC X.
   551             88  PI-MAIL-YES                 VALUE 'Y'.
   552
   553         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   554
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL65091.cbl
   555         16  PI-AR-SYSTEM.
   556             20  PI-AR-PROCESSING-CNTL   PIC X.
   557                 88  PI-AR-PROCESSING        VALUE 'Y'.
   558             20  PI-AR-SUMMARY-CODE      PIC X(6).
   559             20  PI-AR-MONTH-END-DT      PIC XX.
   560
   561         16  PI-MP-SYSTEM.
   562             20  PI-MORTGAGE-USER            PIC X.
   563                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   564                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   565             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   566                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   567                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   568                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   569                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   570                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   571             20  PI-MP-MONTH-END-DT          PIC XX.
   572             20  PI-MP-REFERENCE-NO.
   573                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   574                 24  PI-MP-REFERENCE-SFX     PIC XX.
   575
   576         16  PI-LABEL-CONTROL            PIC X(01).
   577             88  PI-CREATE-LABELS                    VALUE 'Y'.
   578             88  PI-BYPASS-LABELS                    VALUE 'N'.
   579
   580         16  PI-BILL-GROUPING-CODE       PIC X(01).
   581             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   582
   583         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   584             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   585             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   586
   587         16  FILLER                      PIC X(14).
   588
   589     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   590******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL65091.cbl
   592*                                COPY ELC650PI.
   593******************************************************************
   594*
   595*                            ELC650PI.
   596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   597*                            VMOD=2.007
   598*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   599*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   600* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   601*
   602******************************************************************
   603
   604     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   605         16  PI-MAINT                   PIC X.
   606         16  PI-PREV-ACCOUNT            PIC X(20).
   607         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   608         16  PI-ACCT-KEY.
   609             20  PI-ACCT-CCGSA-KEY.
   610                 24  PI-ACCT-CO             PIC X.
   611                 24  PI-ACCT-CARRIER        PIC X.
   612                 24  PI-ACCT-GROUPING       PIC X(6).
   613                 24  PI-ACCT-STATE          PIC XX.
   614                 24  PI-ACCT-ACCOUNT        PIC X(10).
   615             20  PI-ACCT-EXP-DT           PIC XX.
   616             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   617         16  PI-ACCT-ID                 PIC X(8).
   618         16  PI-PLAN-KEY.
   619             20  PI-PLAN-ACCT-KEY.
   620                 24  PI-PLAN-COMPANY-CD PIC X.
   621                 24  PI-PLAN-CARRIER    PIC X.
   622                 24  PI-PLAN-GROUP      PIC X(6).
   623                 24  PI-PLAN-STATE      PIC X(2).
   624                 24  PI-PLAN-ACCOUNT    PIC X(10).
   625             20  PI-PLAN-BEN-TYPE       PIC X.
   626             20  PI-PLAN-BEN            PIC XX.
   627             20  PI-PLAN-REVISION       PIC X(3).
   628         16  PI-WS-STATE                PIC XX.
   629         16  PI-WS-CLASS                PIC XX.
   630         16  PI-WS-DEV                  PIC X(3).
   631         16  PI-WS-TYPE                 PIC X.
   632         16  PI-WS-PLAN                 PIC XX.
   633
   634         16  PI-ERPNDB-ALT-KEY.
   635             20  PI-PB-COMPANY-CD-A1    PIC X.
   636             20  PI-PB-CARRIER          PIC X.
   637             20  PI-PB-GROUPING         PIC X(6).
   638             20  PI-PB-STATE            PIC XX.
   639             20  PI-PB-ACCOUNT          PIC X(10).
   640             20  PI-PB-CERT-EFF-DT      PIC XX.
   641             20  PI-PB-CERT-NO          PIC X(10).
   642             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   643             20  PI-PB-RECORD-TYPE      PIC X.
   644
   645         16  PI-DATE-RANGE-TABLE.
   646             20  PI-TABLE-ENT OCCURS 32 TIMES
   647                            INDEXED BY T-INDEX.
   648                 24  PI-BIN-EFF-DT          PIC XX.
   649                 24  PI-BIN-EXP-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL65091.cbl
   650                 24  PI-BIN-MAINT-DT        PIC XX.
   651                 24  PI-BIN-LO-CERT         PIC XX.
   652                 24  PI-BIN-AR-HI-CERT      PIC XX.
   653                 24  PI-BIN-HI-CERT         PIC XX.
   654         16  PI-PAGE-NUMBER             PIC S9.
   655             88  PI-FST-PAGE               VALUE +1.
   656             88  PI-2ND-PAGE               VALUE +2.
   657             88  PI-3RD-PAGE               VALUE +3.
   658             88  PI-LST-PAGE               VALUE +4.
   659         16  PI-TOTAL-LINES             PIC S99.
   660         16  PI-LINE-SELECTED    PIC S9.
   661***  Y2K PROJ 7744
   662         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   663         16  BIN-EFFCHG-SAVE     PIC XX.
   664         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   665***  Y2K PROJ 7744
   666         16  BIN-EXPCHG-SAVE     PIC XX.
   667         16  PI-RECORD-ADDED-SW  PIC X.
   668             88  PI-RECORD-ADDED            VALUE '1'.
   669             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   670         16  PI-ACCNAME          PIC X(30).
   671         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   672         16  PI-SV-MAINT         PIC X.
   673         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   674         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   675         16  PI-UPDATE-SW        PIC X.
   676             88  PI-CHANGES-MADE             VALUE '1'.
   677         16  PI-NOTE-TYPE        PIC X.
   678             88  PI-ACCT-NOTE                VALUE '1'.
   679         16  PI-DMD-FILE-SW      PIC X.
   680             88  END-OF-FILE                 VALUE 'E'.
   681             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   682             88  FIRST-OCCURS                VALUE 'F'.
   683         16  PI-DMD-OCCURS       PIC S999.
   684         16  PI-DMD-SCREEN       PIC X.
   685             88  SCREEN-1-DISPLAYED  VALUE '1'.
   686             88  SCREEN-2-DISPLAYED  VALUE '2'.
   687             88  SCREEN-3-DISPLAYED  VALUE '3'.
   688         16  PI-NAMEFLG          PIC X.
   689         16  PI-EL650-DEL-SW     PIC X.
   690         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL65091.cbl
   693*                                COPY ELCDATE.
   694******************************************************************
   695*                                                                *
   696*                                                                *
   697*                            ELCDATE.                            *
   698*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   699*                            VMOD=2.003
   700*                                                                *
   701*                                                                *
   702*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   703*                 LENGTH = 200                                   *
   704******************************************************************
   705
   706 01  DATE-CONVERSION-DATA.
   707     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   708     12  DC-OPTION-CODE                PIC X.
   709         88  BIN-TO-GREG                VALUE ' '.
   710         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   711         88  EDIT-GREG-TO-BIN           VALUE '2'.
   712         88  YMD-GREG-TO-BIN            VALUE '3'.
   713         88  MDY-GREG-TO-BIN            VALUE '4'.
   714         88  JULIAN-TO-BIN              VALUE '5'.
   715         88  BIN-PLUS-ELAPSED           VALUE '6'.
   716         88  FIND-CENTURY               VALUE '7'.
   717         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   718         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   719         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   720         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   721         88  JULIAN-TO-BIN-3            VALUE 'C'.
   722         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   723         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   724         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   725         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   726         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   727         88  CHECK-LEAP-YEAR            VALUE 'H'.
   728         88  BIN-3-TO-GREG              VALUE 'I'.
   729         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   730         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   731         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   732         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   733         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   734         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   735         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   736         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   737         88  THREE-CHARACTER-BIN
   738                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   739         88  GREGORIAN-TO-BIN
   740                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   741         88  BIN-TO-GREGORIAN
   742                  VALUES ' ' '1' 'I' '8' 'G'.
   743         88  JULIAN-TO-BINARY
   744                  VALUES '5' 'C' 'E' 'F'.
   745     12  DC-ERROR-CODE                 PIC X.
   746         88  NO-CONVERSION-ERROR        VALUE ' '.
   747         88  DATE-CONVERSION-ERROR
   748                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   749         88  DATE-IS-ZERO               VALUE '1'.
   750         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL65091.cbl
   751         88  DATE-IS-INVALID            VALUE '3'.
   752         88  DATE1-GREATER-DATE2        VALUE '4'.
   753         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   754         88  DATE-INVALID-OPTION        VALUE '9'.
   755         88  INVALID-CENTURY            VALUE 'A'.
   756         88  ONLY-CENTURY               VALUE 'B'.
   757         88  ONLY-LEAP-YEAR             VALUE 'C'.
   758         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   759     12  DC-END-OF-MONTH               PIC X.
   760         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   761     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   762         88  USE-NORMAL-PROCESS         VALUE ' '.
   763         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   764         88  ADJUST-UP-100-YRS          VALUE '2'.
   765     12  FILLER                        PIC X.
   766     12  DC-CONVERSION-DATES.
   767         16  DC-BIN-DATE-1             PIC XX.
   768         16  DC-BIN-DATE-2             PIC XX.
   769         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   770         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   771                       DC-GREG-DATE-1-EDIT.
   772             20  DC-EDIT1-MONTH        PIC 99.
   773             20  SLASH1-1              PIC X.
   774             20  DC-EDIT1-DAY          PIC 99.
   775             20  SLASH1-2              PIC X.
   776             20  DC-EDIT1-YEAR         PIC 99.
   777         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   778         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   779                     DC-GREG-DATE-2-EDIT.
   780             20  DC-EDIT2-MONTH        PIC 99.
   781             20  SLASH2-1              PIC X.
   782             20  DC-EDIT2-DAY          PIC 99.
   783             20  SLASH2-2              PIC X.
   784             20  DC-EDIT2-YEAR         PIC 99.
   785         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   786         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   787                     DC-GREG-DATE-1-YMD.
   788             20  DC-YMD-YEAR           PIC 99.
   789             20  DC-YMD-MONTH          PIC 99.
   790             20  DC-YMD-DAY            PIC 99.
   791         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   792         16  DC-GREG-DATE-1-MDY-R REDEFINES
   793                      DC-GREG-DATE-1-MDY.
   794             20  DC-MDY-MONTH          PIC 99.
   795             20  DC-MDY-DAY            PIC 99.
   796             20  DC-MDY-YEAR           PIC 99.
   797         16  DC-GREG-DATE-1-ALPHA.
   798             20  DC-ALPHA-MONTH        PIC X(10).
   799             20  DC-ALPHA-DAY          PIC 99.
   800             20  FILLER                PIC XX.
   801             20  DC-ALPHA-CENTURY.
   802                 24 DC-ALPHA-CEN-N     PIC 99.
   803             20  DC-ALPHA-YEAR         PIC 99.
   804         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   805         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   806         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   807         16  DC-JULIAN-DATE            PIC 9(05).
   808         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL65091.cbl
   809                                       PIC 9(05).
   810         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   811             20  DC-JULIAN-YEAR        PIC 99.
   812             20  DC-JULIAN-DAYS        PIC 999.
   813         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   814         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   815         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   816     12  DATE-CONVERSION-VARIBLES.
   817         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   818         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   819             20  FILLER                PIC 9(3).
   820             20  HOLD-CEN-1-CCYY.
   821                 24  HOLD-CEN-1-CC     PIC 99.
   822                 24  HOLD-CEN-1-YY     PIC 99.
   823             20  HOLD-CEN-1-MO         PIC 99.
   824             20  HOLD-CEN-1-DA         PIC 99.
   825         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   826             20  HOLD-CEN-1-R-MO       PIC 99.
   827             20  HOLD-CEN-1-R-DA       PIC 99.
   828             20  HOLD-CEN-1-R-CCYY.
   829                 24  HOLD-CEN-1-R-CC   PIC 99.
   830                 24  HOLD-CEN-1-R-YY   PIC 99.
   831             20  FILLER                PIC 9(3).
   832         16  HOLD-CENTURY-1-X.
   833             20  FILLER                PIC X(3)  VALUE SPACES.
   834             20  HOLD-CEN-1-X-CCYY.
   835                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   836                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   837             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   838             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   839         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   840             20  HOLD-CEN-1-R-X-MO     PIC XX.
   841             20  HOLD-CEN-1-R-X-DA     PIC XX.
   842             20  HOLD-CEN-1-R-X-CCYY.
   843                 24  HOLD-CEN-1-R-X-CC PIC XX.
   844                 24  HOLD-CEN-1-R-X-YY PIC XX.
   845             20  FILLER                PIC XXX.
   846         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   847         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   848         16  DC-JULIAN-DATE-1          PIC 9(07).
   849         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   850             20  DC-JULIAN-1-CCYY.
   851                 24  DC-JULIAN-1-CC    PIC 99.
   852                 24  DC-JULIAN-1-YR    PIC 99.
   853             20  DC-JULIAN-DA-1        PIC 999.
   854         16  DC-JULIAN-DATE-2          PIC 9(07).
   855         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   856             20  DC-JULIAN-2-CCYY.
   857                 24  DC-JULIAN-2-CC    PIC 99.
   858                 24  DC-JULIAN-2-YR    PIC 99.
   859             20  DC-JULIAN-DA-2        PIC 999.
   860         16  DC-GREG-DATE-A-EDIT.
   861             20  DC-EDITA-MONTH        PIC 99.
   862             20  SLASHA-1              PIC X VALUE '/'.
   863             20  DC-EDITA-DAY          PIC 99.
   864             20  SLASHA-2              PIC X VALUE '/'.
   865             20  DC-EDITA-CCYY.
   866                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL65091.cbl
   867                 24  DC-EDITA-YEAR     PIC 99.
   868         16  DC-GREG-DATE-B-EDIT.
   869             20  DC-EDITB-MONTH        PIC 99.
   870             20  SLASHB-1              PIC X VALUE '/'.
   871             20  DC-EDITB-DAY          PIC 99.
   872             20  SLASHB-2              PIC X VALUE '/'.
   873             20  DC-EDITB-CCYY.
   874                 24  DC-EDITB-CENT     PIC 99.
   875                 24  DC-EDITB-YEAR     PIC 99.
   876         16  DC-GREG-DATE-CYMD         PIC 9(08).
   877         16  DC-GREG-DATE-CYMD-R REDEFINES
   878                              DC-GREG-DATE-CYMD.
   879             20  DC-CYMD-CEN           PIC 99.
   880             20  DC-CYMD-YEAR          PIC 99.
   881             20  DC-CYMD-MONTH         PIC 99.
   882             20  DC-CYMD-DAY           PIC 99.
   883         16  DC-GREG-DATE-MDCY         PIC 9(08).
   884         16  DC-GREG-DATE-MDCY-R REDEFINES
   885                              DC-GREG-DATE-MDCY.
   886             20  DC-MDCY-MONTH         PIC 99.
   887             20  DC-MDCY-DAY           PIC 99.
   888             20  DC-MDCY-CEN           PIC 99.
   889             20  DC-MDCY-YEAR          PIC 99.
   890    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   891        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   892    12  DC-EL310-DATE                  PIC X(21).
   893    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL65091.cbl
   895
   896****************************************************************
   897*
   898* Copyright (c) 2007 by Clerity Solutions, Inc.
   899* All rights reserved.
   900*
   901****************************************************************
   902 01  DFHEIV.
   903   02  DFHEIV0               PIC X(35).
   904   02  DFHEIV1               PIC X(08).
   905   02  DFHEIV2               PIC X(08).
   906   02  DFHEIV3               PIC X(08).
   907   02  DFHEIV4               PIC X(06).
   908   02  DFHEIV5               PIC X(04).
   909   02  DFHEIV6               PIC X(04).
   910   02  DFHEIV7               PIC X(02).
   911   02  DFHEIV8               PIC X(02).
   912   02  DFHEIV9               PIC X(01).
   913   02  DFHEIV10              PIC S9(7) COMP-3.
   914   02  DFHEIV11              PIC S9(4) COMP SYNC.
   915   02  DFHEIV12              PIC S9(4) COMP SYNC.
   916   02  DFHEIV13              PIC S9(4) COMP SYNC.
   917   02  DFHEIV14              PIC S9(4) COMP SYNC.
   918   02  DFHEIV15              PIC S9(4) COMP SYNC.
   919   02  DFHEIV16              PIC S9(9) COMP SYNC.
   920   02  DFHEIV17              PIC X(04).
   921   02  DFHEIV18              PIC X(04).
   922   02  DFHEIV19              PIC X(04).
   923   02  DFHEIV20              USAGE IS POINTER.
   924   02  DFHEIV21              USAGE IS POINTER.
   925   02  DFHEIV22              USAGE IS POINTER.
   926   02  DFHEIV23              USAGE IS POINTER.
   927   02  DFHEIV24              USAGE IS POINTER.
   928   02  DFHEIV25              PIC S9(9) COMP SYNC.
   929   02  DFHEIV26              PIC S9(9) COMP SYNC.
   930   02  DFHEIV27              PIC S9(9) COMP SYNC.
   931   02  DFHEIV28              PIC S9(9) COMP SYNC.
   932   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   933   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   934   02  FILLER                PIC X(02).
   935   02  DFHEIV99              PIC X(08) VALUE SPACE.
   936   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   937   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   938   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   939   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   940 LINKAGE  SECTION.
   941*****************************************************************
   942*                                                               *
   943* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   944* All rights reserved.                                          *
   945*                                                               *
   946*****************************************************************
   947 01  dfheiblk.
   948     02  eibtime          pic s9(7) comp-3.
   949     02  eibdate          pic s9(7) comp-3.
   950     02  eibtrnid         pic x(4).
   951     02  eibtaskn         pic s9(7) comp-3.
   952     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL65091.cbl
   953     02  dfheigdi         pic s9(4) comp.
   954     02  eibcposn         pic s9(4) comp.
   955     02  eibcalen         pic s9(4) comp.
   956     02  eibaid           pic x(1).
   957     02  eibfiller1       pic x(1).
   958     02  eibfn            pic x(2).
   959     02  eibfiller2       pic x(2).
   960     02  eibrcode         pic x(6).
   961     02  eibfiller3       pic x(2).
   962     02  eibds            pic x(8).
   963     02  eibreqid         pic x(8).
   964     02  eibrsrce         pic x(8).
   965     02  eibsync          pic x(1).
   966     02  eibfree          pic x(1).
   967     02  eibrecv          pic x(1).
   968     02  eibsend          pic x(1).
   969     02  eibatt           pic x(1).
   970     02  eibeoc           pic x(1).
   971     02  eibfmh           pic x(1).
   972     02  eibcompl         pic x(1).
   973     02  eibsig           pic x(1).
   974     02  eibconf          pic x(1).
   975     02  eiberr           pic x(1).
   976     02  eibrldbk         pic x(1).
   977     02  eiberrcd         pic x(4).
   978     02  eibsynrb         pic x(1).
   979     02  eibnodat         pic x(1).
   980     02  eibfiller5       pic x(2).
   981     02  eibresp          pic 9(09) comp.
   982     02  eibresp2         pic 9(09) comp.
   983     02  dfheigdj         pic s9(4) comp.
   984     02  dfheigdk         pic s9(4) comp.
   985 01  DFHCOMMAREA                 PIC X(1500).
   986
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL65091.cbl
   988*01  PARMLIST.
   989*    05  FILLER                  PIC S9(8)   COMP.
   990*    05  ERACNT-POINTER          PIC S9(8)   COMP.
   991*    05  ERACCT-POINTER          PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL65091.cbl
   993*                                COPY ERCACNT.
   994******************************************************************
   995*                                                                *
   996*                                                                *
   997*                            ERCACNT.                            *
   998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   999*                            VMOD=2.002                          *
  1000*                                                                *
  1001*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1002*                                                                *
  1003*   FILE TYPE = VSAM,KSDS                                        *
  1004*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1005*                                                                *
  1006*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1007*       ALTERNATE INDEX = NONE                                   *
  1008*                                                                *
  1009*                                                                *
  1010*   LOG = YES                                                    *
  1011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1012******************************************************************
  1013*                   C H A N G E   L O G
  1014*
  1015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1016*-----------------------------------------------------------------
  1017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1018* EFFECTIVE    NUMBER
  1019*-----------------------------------------------------------------
  1020* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1021*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1022******************************************************************
  1023 01  NOTE-FILE.
  1024     12  NT-FILE-ID                  PIC XX.
  1025         88  VALID-NOTE-ID              VALUE 'NT'.
  1026
  1027     12  NT-CONTROL-PRIMARY.
  1028         16  NT-COMPANY-CD           PIC X.
  1029         16  NT-ACCT-NOTE-KEY.
  1030             18  NT-CARRIER              PIC X.
  1031             18  NT-GROUPING             PIC X(06).
  1032             18  NT-STATE                PIC XX.
  1033             18  NT-ACCOUNT              PIC X(10).
  1034         16  NT-RECORD-TYPE          PIC X.
  1035              88  ACCT-NOTE          VALUE '1'.
  1036              88  ACCT-BRANCH-LOC    VALUE '2'.
  1037              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1038         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1039
  1040     12  NT-LAST-MAINT-DT            PIC XX.
  1041     12  NT-LAST-MAINT-BY            PIC X(4).
  1042     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1043
  1044*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1045*     SEQUENCE NUMBERS
  1046     12  NT-NOTE-INFORMATION.
  1047         16  NT-NOTE-LINE            PIC X(60).
  1048         16  FILLER                  PIC X(25).
  1049*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1050     12  NT-LOCATION-INFORMATION REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL65091.cbl
  1051                         NT-NOTE-INFORMATION.
  1052         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1053         16  FILLER                  PIC X(25).
  1054*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1055*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1056*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1057*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1058*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1059*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1060*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1061     12  NT-SHIPPING-INFORMATION REDEFINES
  1062                         NT-NOTE-INFORMATION.
  1063         16  NT-SHIPPING-LINE        PIC X(60).
  1064         16  NT-SHIP-STATE           PIC XX.
  1065         16  NT-SHIP-ZIP             PIC X(10).
  1066         16  FILLER                  PIC X(13).
  1067*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL65091.cbl
  1069*                                COPY ERCACCT.
  1070******************************************************************
  1071*                                                                *
  1072*                                                                *
  1073*                            ERCACCT                             *
  1074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1075*                            VMOD=2.031                          *
  1076*                                                                *
  1077*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1078*                                                                *
  1079*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1080*   VSAM ACCOUNT MASTER FILES.                                   *
  1081*                                                                *
  1082*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1083*                                                                *
  1084*   FILE TYPE = VSAM,KSDS                                        *
  1085*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1086*                                                                *
  1087*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1088*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1089*                                                                *
  1090*   LOG = NO                                                     *
  1091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1092*                                                                *
  1093*                                                                *
  1094******************************************************************
  1095*                   C H A N G E   L O G
  1096*
  1097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1098*-----------------------------------------------------------------
  1099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1100* EFFECTIVE    NUMBER
  1101*-----------------------------------------------------------------
  1102* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1103* 092705    2005050300006  PEMA  ADD SPP LEASES
  1104* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1105* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1106******************************************************************
  1107
  1108 01  ACCOUNT-MASTER.
  1109     12  AM-RECORD-ID                      PIC XX.
  1110         88  VALID-AM-ID                      VALUE 'AM'.
  1111
  1112     12  AM-CONTROL-PRIMARY.
  1113         16  AM-COMPANY-CD                 PIC X.
  1114         16  AM-MSTR-CNTRL.
  1115             20  AM-CONTROL-A.
  1116                 24  AM-CARRIER            PIC X.
  1117                 24  AM-GROUPING.
  1118                     28 AM-GROUPING-PREFIX PIC XXX.
  1119                     28 AM-GROUPING-PRIME  PIC XXX.
  1120                 24  AM-STATE              PIC XX.
  1121                 24  AM-ACCOUNT.
  1122                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1123                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1124             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1125                                           PIC X(19).
  1126             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL65091.cbl
  1127                 24  AM-EXPIRATION-DT      PIC XX.
  1128                 24  FILLER                PIC X(4).
  1129             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1130                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1131
  1132     12  AM-CONTROL-BY-VAR-GRP.
  1133         16  AM-COMPANY-CD-A1              PIC X.
  1134         16  AM-VG-CARRIER                 PIC X.
  1135         16  AM-VG-GROUPING                PIC X(6).
  1136         16  AM-VG-STATE                   PIC XX.
  1137         16  AM-VG-ACCOUNT                 PIC X(10).
  1138         16  AM-VG-DATE.
  1139             20  AM-VG-EXPIRATION-DT       PIC XX.
  1140             20  FILLER                    PIC X(4).
  1141         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1142                                           PIC 9(11)      COMP-3.
  1143     12  AM-MAINT-INFORMATION.
  1144         16  AM-LAST-MAINT-DT              PIC XX.
  1145         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1146         16  AM-LAST-MAINT-USER            PIC X(4).
  1147         16  FILLER                        PIC XX.
  1148
  1149     12  AM-EFFECTIVE-DT                   PIC XX.
  1150     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1151
  1152     12  AM-PREV-DATES  COMP-3.
  1153         16  AM-PREV-EXP-DT                PIC 9(11).
  1154         16  AM-PREV-EFF-DT                PIC 9(11).
  1155
  1156     12  AM-REPORT-CODE-1                  PIC X(10).
  1157     12  AM-REPORT-CODE-2                  PIC X(10).
  1158
  1159     12  AM-CITY-CODE                      PIC X(4).
  1160     12  AM-COUNTY-PARISH                  PIC X(6).
  1161
  1162     12  AM-NAME                           PIC X(30).
  1163     12  AM-PERSON                         PIC X(30).
  1164     12  AM-ADDRS                          PIC X(30).
  1165     12  AM-CITY.
  1166         16  AM-ADDR-CITY                  PIC X(28).
  1167         16  AM-ADDR-STATE                 PIC XX.
  1168     12  AM-ZIP.
  1169         16  AM-ZIP-PRIME.
  1170             20  AM-ZIP-PRI-1ST            PIC X.
  1171                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1172             20  FILLER                    PIC X(4).
  1173         16  AM-ZIP-PLUS4                  PIC X(4).
  1174     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1175         16  AM-CAN-POSTAL-1               PIC XXX.
  1176         16  AM-CAN-POSTAL-2               PIC XXX.
  1177         16  FILLER                        PIC XXX.
  1178     12  AM-TEL-NO.
  1179         16  AM-AREA-CODE                  PIC 999.
  1180         16  AM-TEL-PRE                    PIC 999.
  1181         16  AM-TEL-NBR                    PIC 9(4).
  1182     12  AM-TEL-LOC                        PIC X.
  1183         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1184         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL65091.cbl
  1185
  1186     12  AM-COMM-STRUCTURE.
  1187         16  AM-DEFN-1.
  1188             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1189                 24  AM-AGT.
  1190                     28  AM-AGT-PREFIX     PIC X(4).
  1191                     28  AM-AGT-PRIME      PIC X(6).
  1192                 24  AM-COM-TYP            PIC X.
  1193                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1194                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1195                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1196                 24  AM-RECALC-LV-INDIC    PIC X.
  1197                 24  AM-RETRO-LV-INDIC     PIC X.
  1198                 24  AM-GL-CODES           PIC X.
  1199                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1200                 24  FILLER                PIC X(01).
  1201         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1202             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1203                 24  FILLER                PIC X(11).
  1204                 24  AM-L-COMA             PIC XXX.
  1205                 24  AM-J-COMA             PIC XXX.
  1206                 24  AM-A-COMA             PIC XXX.
  1207                 24  FILLER                PIC X(6).
  1208
  1209     12  AM-COMM-CHANGE-STATUS             PIC X.
  1210         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1211
  1212     12  AM-CSR-CODE                       PIC X(4).
  1213
  1214     12  AM-BILLING-STATUS                 PIC X.
  1215         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1216         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1217     12  AM-AUTO-REFUND-SW                 PIC X.
  1218         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1219         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1220     12  AM-GPCD                           PIC 99.
  1221     12  AM-IG                             PIC X.
  1222         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1223         88  AM-HAS-GROUP                     VALUE '2'.
  1224     12  AM-STATUS                         PIC X.
  1225         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1226         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1227         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1228         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1229         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1230     12  AM-REMIT-TO                       PIC 99.
  1231     12  AM-ID-NO                          PIC X(11).
  1232
  1233     12  AM-CAL-TABLE                      PIC XX.
  1234     12  AM-LF-DEVIATION                   PIC XXX.
  1235     12  AM-AH-DEVIATION                   PIC XXX.
  1236     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1237     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1238     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1239     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1240     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1241     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1242
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL65091.cbl
  1243     12  AM-USER-FIELDS.
  1244         16  AM-FLD-1                      PIC XX.
  1245         16  AM-FLD-2                      PIC XX.
  1246         16  AM-FLD-3                      PIC XX.
  1247         16  AM-FLD-4                      PIC XX.
  1248         16  AM-FLD-5                      PIC XX.
  1249
  1250     12  AM-1ST-PROD-DATE.
  1251         16  AM-1ST-PROD-YR                PIC XX.
  1252         16  AM-1ST-PROD-MO                PIC XX.
  1253         16  AM-1ST-PROD-DA                PIC XX.
  1254     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1255     12  AM-CERTS-PURGED-DATE.
  1256         16  AM-PUR-YR                     PIC XX.
  1257         16  AM-PUR-MO                     PIC XX.
  1258         16  AM-PUR-DA                     PIC XX.
  1259     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1260     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1261     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1262     12  AM-INACTIVE-DATE.
  1263         16  AM-INA-MO                     PIC 99.
  1264         16  AM-INA-DA                     PIC 99.
  1265         16  AM-INA-YR                     PIC 99.
  1266     12  AM-AR-HI-CERT-DATE                PIC XX.
  1267
  1268     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1269     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1270
  1271     12  AM-OB-PAYMENT-MODE                PIC X.
  1272         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1273         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1274         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1275         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1276
  1277     12  AM-AH-ONLY-INDICATOR              PIC X.
  1278         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1279         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1280
  1281     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1282
  1283     12  AM-OVER-SHORT.
  1284         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1285         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1286
  1287     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1288     12  AM-DCC-CLP-STATE                  PIC XX.
  1289
  1290     12  AM-RECALC-COMM                    PIC X.
  1291     12  AM-RECALC-REIN                    PIC X.
  1292
  1293     12  AM-REI-TABLE                      PIC XXX.
  1294     12  AM-REI-ET-LF                      PIC X.
  1295     12  AM-REI-ET-AH                      PIC X.
  1296     12  AM-REI-PE-LF                      PIC X.
  1297     12  AM-REI-PE-AH                      PIC X.
  1298     12  AM-REI-PRT-ST                     PIC X.
  1299     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1300     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL65091.cbl
  1301     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1302     12  AM-REI-GROUP-A                    PIC X(6).
  1303     12  AM-REI-MORT                       PIC X(4).
  1304     12  AM-REI-PRT-OW                     PIC X.
  1305     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1306     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1307     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1308     12  AM-REI-GROUP-B                    PIC X(6).
  1309
  1310     12  AM-TRUST-TYPE                     PIC X(2).
  1311
  1312     12  AM-EMPLOYER-STMT-USED             PIC X.
  1313     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1314
  1315     12  AM-STD-AH-TYPE                    PIC XX.
  1316     12  AM-EARN-METHODS.
  1317         16  AM-EARN-METHOD-R              PIC X.
  1318             88 AM-REF-RL-R78                 VALUE 'R'.
  1319             88 AM-REF-RL-PR                  VALUE 'P'.
  1320             88 AM-REF-RL-MEAN                VALUE 'M'.
  1321             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1322         16  AM-EARN-METHOD-L              PIC X.
  1323             88 AM-REF-LL-R78                 VALUE 'R'.
  1324             88 AM-REF-LL-PR                  VALUE 'P'.
  1325             88 AM-REF-LL-MEAN                VALUE 'M'.
  1326             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1327         16  AM-EARN-METHOD-A              PIC X.
  1328             88 AM-REF-AH-R78                 VALUE 'R'.
  1329             88 AM-REF-AH-PR                  VALUE 'P'.
  1330             88 AM-REF-AH-MEAN                VALUE 'M'.
  1331             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1332             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1333             88 AM-REF-AH-NET                 VALUE 'N'.
  1334
  1335     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1336     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1337     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1338
  1339     12  AM-RET-Y-N                        PIC X.
  1340     12  AM-RET-P-E                        PIC X.
  1341     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1342     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1343     12  AM-RET-GRP                        PIC X(6).
  1344     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1345         16  AM-POOL-PRIME                 PIC XXX.
  1346         16  AM-POOL-SUB                   PIC XXX.
  1347     12  AM-RETRO-EARNINGS.
  1348         16  AM-RET-EARN-R                 PIC X.
  1349         16  AM-RET-EARN-L                 PIC X.
  1350         16  AM-RET-EARN-A                 PIC X.
  1351     12  AM-RET-ST-TAX-USE                 PIC X.
  1352         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1353         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1354     12  AM-RETRO-BEG-EARNINGS.
  1355         16  AM-RET-BEG-EARN-R             PIC X.
  1356         16  AM-RET-BEG-EARN-L             PIC X.
  1357         16  AM-RET-BEG-EARN-A             PIC X.
  1358     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL65091.cbl
  1359     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1360
  1361     12  AM-USER-SELECT-OPTIONS.
  1362         16  AM-USER-SELECT-1              PIC X(10).
  1363         16  AM-USER-SELECT-2              PIC X(10).
  1364         16  AM-USER-SELECT-3              PIC X(10).
  1365         16  AM-USER-SELECT-4              PIC X(10).
  1366         16  AM-USER-SELECT-5              PIC X(10).
  1367
  1368     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1369
  1370     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1371
  1372     12  AM-RPT045A-SWITCH                 PIC X.
  1373         88  RPT045A-OFF                   VALUE 'N'.
  1374
  1375     12  AM-INSURANCE-LIMITS.
  1376         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1377         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1378
  1379     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1380         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1381
  1382     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1383         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1384         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1385
  1386     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1387
  1388     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1389     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1390     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1391     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1392     12  FILLER                            PIC X(5).
  1393     12  AM-REPORT-CODE-3                  PIC X(10).
  1394*    12  FILLER                            PIC X(22).
  1395
  1396     12  AM-RESERVE-DATE.
  1397         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1398         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1399         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1400
  1401     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1402     12  AM-NOTIFICATION-TYPES.
  1403         16  AM-NOTIF-OF-LETTERS           PIC X.
  1404         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1405         16  AM-NOTIF-OF-REPORTS           PIC X.
  1406         16  AM-NOTIF-OF-STATUS            PIC X.
  1407
  1408     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1409         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1410         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1411         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1412         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1413
  1414     12  AM-BENEFIT-CONTROLS.
  1415         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1416             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL65091.cbl
  1417             20  AM-BENEFIT-TYPE           PIC X.
  1418             20  AM-BENEFIT-REVISION       PIC XXX.
  1419             20  AM-BENEFIT-REM-TERM       PIC X.
  1420             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1421             20  FILLER                    PIC XX.
  1422         16  FILLER                        PIC X(80).
  1423
  1424     12  AM-TRANSFER-DATA.
  1425         16  AM-TRANSFERRED-FROM.
  1426             20  AM-TRNFROM-CARRIER        PIC X.
  1427             20  AM-TRNFROM-GROUPING.
  1428                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1429                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1430             20  AM-TRNFROM-STATE          PIC XX.
  1431             20  AM-TRNFROM-ACCOUNT.
  1432                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1433                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1434             20  AM-TRNFROM-DTE            PIC XX.
  1435         16  AM-TRANSFERRED-TO.
  1436             20  AM-TRNTO-CARRIER          PIC X.
  1437             20  AM-TRNTO-GROUPING.
  1438                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1439                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1440             20  AM-TRNTO-STATE            PIC XX.
  1441             20  AM-TRNTO-ACCOUNT.
  1442                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1443                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1444             20  AM-TRNTO-DTE              PIC XX.
  1445         16  FILLER                        PIC X(10).
  1446
  1447     12  AM-SAVED-REMIT-TO                 PIC 99.
  1448
  1449     12  AM-COMM-STRUCTURE-SAVED.
  1450         16  AM-DEFN-1-SAVED.
  1451             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1452                 24  AM-AGT-SV             PIC X(10).
  1453                 24  AM-COM-TYP-SV         PIC X.
  1454                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1455                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1456                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1457                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1458                 24  FILLER                PIC X.
  1459                 24  AM-GL-CODES-SV        PIC X.
  1460                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1461                 24  FILLER                PIC X.
  1462         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1463             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1464                 24  FILLER                PIC X(11).
  1465                 24  AM-L-COMA-SV          PIC XXX.
  1466                 24  AM-J-COMA-SV          PIC XXX.
  1467                 24  AM-A-COMA-SV          PIC XXX.
  1468                 24  FILLER                PIC X(6).
  1469
  1470     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1471         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1472            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1473            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1474            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL65091.cbl
  1475
  1476     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1477     12  FILLER                            PIC X(120).
  1478
  1479     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1480         16  AM-CONTROL-NAME               PIC X(30).
  1481         16  AM-EXECUTIVE-ONE.
  1482             20  AM-EXEC1-NAME             PIC X(15).
  1483             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1484                                                          COMP-3.
  1485             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1486                                                          COMP-3.
  1487         16  AM-EXECUTIVE-TWO.
  1488             20  AM-EXEC2-NAME             PIC X(15).
  1489             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1490                                                          COMP-3.
  1491             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1492                                                          COMP-3.
  1493
  1494     12  AM-RETRO-ADDITIONAL-DATA.
  1495         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1496         16  AM-RETRO-PREM-P-E             PIC X.
  1497         16  AM-RETRO-CLMS-P-I             PIC X.
  1498         16  AM-RETRO-RET-BRACKET-LF.
  1499             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1500                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1501                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1502             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1503                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1504                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1505             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1506                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1507                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1508         16  AM-RETRO-RET-BRACKET-AH.
  1509             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1510                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1511                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1512                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1513             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1514                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1515                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1516             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1517                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1518                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1519
  1520     12  AM-COMMENTS.
  1521         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1522
  1523     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1524         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1525         16  AM-FLI-BILLING-CODE           PIC X.
  1526         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1527         16  AM-FLI-UNITED-IDENT           PIC X.
  1528         16  AM-FLI-INTEREST-LOST-DATA.
  1529             20  AM-FLI-BANK-NO            PIC X(5).
  1530             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1531             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1532             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL65091.cbl
  1533         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1534             20  AM-FLI-AGT                PIC X(9).
  1535             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1536             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1537         16  FILLER                        PIC X(102).
  1538
  1539     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1540         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1541             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1542             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1543             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1544             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1545             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1546         16  FILLER                          PIC X(10).
  1547******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL65091.cbl
  1549 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA NOTE-FILE
  1550                          ACCOUNT-MASTER.
  1551 0000-DFHEXIT SECTION.
  1552     MOVE '9#                    $   ' TO DFHEIV0.
  1553     MOVE 'EL65091' TO DFHEIV1.
  1554     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1555
  1556     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1557     MOVE '5'                    TO DC-OPTION-CODE.
  1558     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1559     MOVE DC-GREG-DATE-1-EDIT    TO  W-CURRENT-DATE.
  1560     MOVE DC-BIN-DATE-1          TO  W-CURRENT-BIN-DATE.
  1561     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  1562
  1563 0100-RETRIEVE.
  1564
  1565* EXEC CICS  HANDLE CONDITION
  1566*        ERROR    (8300-ABEND)
  1567*        PGMIDERR (8900-PGMIDERR)
  1568*        ENDDATA  (9999-FINALIZE)
  1569*        NOTFND   (8500-NOTFND)
  1570*    END-EXEC.
  1571*    MOVE '"$.L&I                ! " #00001560' TO DFHEIV0
  1572     MOVE X'22242E4C2649202020202020' TO DFHEIV0(1:12)
  1573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1574     MOVE X'2220233030303031353630' TO DFHEIV0(25:11)
  1575     CALL 'kxdfhei1' USING DFHEIV0
  1576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1577
  1578
  1579
  1580* EXEC CICS  RETRIEVE
  1581*        INTO    (PROGRAM-INTERFACE-BLOCK)
  1582*        LENGTH  (PI-COMM-LENGTH)
  1583*    END-EXEC.
  1584*    MOVE '0*I L                 &   #00001567' TO DFHEIV0
  1585     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1586     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1587     MOVE X'2020233030303031353637' TO DFHEIV0(25:11)
  1588     CALL 'kxdfhei1' USING DFHEIV0,
  1589           PROGRAM-INTERFACE-BLOCK,
  1590           PI-COMM-LENGTH,
  1591           DFHEIV99,
  1592           DFHEIV99,
  1593           DFHEIV99
  1594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1595
  1596
  1597* DLO034 OPEN WHEN DMD OR CID
  1598     MOVE PI-COMPANY-ID             TO WS-SAVED-PI-COMPANY-ID.
  1599     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1600         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  1601             MOVE 'O'                TO DL34-PROCESS-TYPE
  1602             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1603             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1604             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1605             MOVE SPACES             TO DL34-PRINT-LINE
  1606             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL65091.cbl
  1607
  1608* EXEC CICS LINK
  1609*                PROGRAM    ('DLO034')
  1610*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1611*                LENGTH     (DLO034-REC-LENGTH)
  1612*            END-EXEC
  1613     MOVE 'DLO034' TO DFHEIV1
  1614*    MOVE '."C                   ''   #00001582' TO DFHEIV0
  1615     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1616     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1617     MOVE X'2020233030303031353832' TO DFHEIV0(25:11)
  1618     CALL 'kxdfhei1' USING DFHEIV0,
  1619           DFHEIV1,
  1620           DLO034-COMMUNICATION-AREA,
  1621           DLO034-REC-LENGTH,
  1622           DFHEIV99,
  1623           DFHEIV99,
  1624           DFHEIV99
  1625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1626             IF DL34-RETURN-CODE NOT = 'OK'
  1627                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1628                                     TO   ERROR-LINE
  1629                 PERFORM 8400-SEND-TEXT
  1630
  1631* EXEC CICS RETURN
  1632*                END-EXEC.
  1633*    MOVE '.(                    &   #00001591' TO DFHEIV0
  1634     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1635     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1636     MOVE X'2020233030303031353931' TO DFHEIV0(25:11)
  1637     CALL 'kxdfhei1' USING DFHEIV0,
  1638           DFHEIV99,
  1639           DFHEIV99,
  1640           DFHEIV99,
  1641           DFHEIV99,
  1642           DFHEIV99
  1643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1644
  1645
  1646 1000-PRINT-RESULTS.
  1647     MOVE SPACES                 TO  ERACNT-KEY.
  1648     MOVE PI-COMPANY-CD          TO  ERACNT-COMPANY-CD.
  1649     MOVE '1'                    TO  ERACNT-REC-TYP.
  1650     MOVE PI-ACCT-CARRIER        TO  ERACNT-CARRIER.
  1651     MOVE PI-ACCT-GROUPING       TO  ERACNT-GROUPING.
  1652     MOVE PI-ACCT-STATE          TO  ERACNT-STATE.
  1653     MOVE PI-ACCT-ACCOUNT        TO  ERACNT-ACCOUNT.
  1654
  1655     PERFORM 2000-PRINT-HEADINGS  THRU 2000-EXIT.
  1656
  1657     MOVE ERACNT-KEY             TO  W-PRIOR-KEY.
  1658
  1659
  1660* EXEC CICS HANDLE CONDITION
  1661*         NOTFND(1400-NOTFND)
  1662*         NOTOPEN(1600-NOT-OPEN)
  1663*         ENDFILE(1500-ENDBR)
  1664*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL65091.cbl
  1665*    MOVE '"$IJ''                 ! # #00001607' TO DFHEIV0
  1666     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1668     MOVE X'2320233030303031363037' TO DFHEIV0(25:11)
  1669     CALL 'kxdfhei1' USING DFHEIV0
  1670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1671
  1672
  1673
  1674* EXEC CICS STARTBR
  1675*         DATASET(ERACNT-FILE-ID)
  1676*         RIDFLD(ERACNT-KEY)
  1677*         KEYLENGTH(ERACNT-START-LENGTH)
  1678*         GENERIC
  1679*         GTEQ
  1680*    END-EXEC.
  1681     MOVE 0
  1682       TO DFHEIV11
  1683*    MOVE '&,   KG    G          &   #00001613' TO DFHEIV0
  1684     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  1685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1686     MOVE X'2020233030303031363133' TO DFHEIV0(25:11)
  1687     CALL 'kxdfhei1' USING DFHEIV0,
  1688           ERACNT-FILE-ID,
  1689           ERACNT-KEY,
  1690           ERACNT-START-LENGTH,
  1691           DFHEIV11,
  1692           DFHEIV99
  1693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1694
  1695
  1696 1001-LOOP.
  1697
  1698* EXEC CICS READNEXT
  1699*         SET(ADDRESS OF NOTE-FILE)
  1700*         DATASET(ERACNT-FILE-ID)
  1701*         RIDFLD(ERACNT-KEY)
  1702*    END-EXEC.
  1703     MOVE 0
  1704       TO DFHEIV11
  1705*    MOVE '&.S                   )   #00001622' TO DFHEIV0
  1706     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1707     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1708     MOVE X'2020233030303031363232' TO DFHEIV0(25:11)
  1709     CALL 'kxdfhei1' USING DFHEIV0,
  1710           ERACNT-FILE-ID,
  1711           DFHEIV20,
  1712           DFHEIV99,
  1713           ERACNT-KEY,
  1714           DFHEIV99,
  1715           DFHEIV11,
  1716           DFHEIV99,
  1717           DFHEIV99
  1718     SET ADDRESS OF NOTE-FILE TO
  1719         DFHEIV20
  1720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1721
  1722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL65091.cbl
  1723     ADD 1                       TO  W-DELAY-CNT.
  1724     IF W-DELAY-CNT GREATER THAN +50
  1725         MOVE +0 TO  W-DELAY-CNT
  1726
  1727* EXEC CICS DELAY
  1728*             INTERVAL (W-DELAY-INTERVAL)
  1729*             END-EXEC.
  1730*    MOVE '0$I                   &   #00001631' TO DFHEIV0
  1731     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  1732     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1733     MOVE X'2020233030303031363331' TO DFHEIV0(25:11)
  1734     CALL 'kxdfhei1' USING DFHEIV0,
  1735           W-DELAY-INTERVAL,
  1736           DFHEIV99,
  1737           DFHEIV99,
  1738           DFHEIV99,
  1739           DFHEIV99
  1740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1741
  1742
  1743     IF FIRST-ONE
  1744         IF ERACNT-PARTIAL-KEY NOT = W-PRIOR-PARTIAL-KEY
  1745             GO TO 1400-NOTFND
  1746         ELSE
  1747             MOVE SPACE TO FIRST-TIME-SW
  1748             MOVE NT-CONTROL-PRIMARY TO W-PRIOR-KEY.
  1749
  1750     MOVE NT-CONTROL-PRIMARY        TO ERACNT-KEY.
  1751
  1752     IF W-PRIOR-PARTIAL-KEY = ERACNT-PARTIAL-KEY
  1753         NEXT SENTENCE
  1754     ELSE
  1755         GO TO 1500-ENDBR.
  1756
  1757     IF WS-LINE-CNT GREATER 55
  1758         PERFORM 2000-PRINT-HEADINGS  THRU 2000-EXIT.
  1759
  1760     ADD 1 TO LINE-CNT.
  1761     MOVE LINE-CNT      TO D1-LINE-NO.
  1762     MOVE NT-NOTE-LINE   TO D1-TEXT.
  1763     MOVE NT-LAST-MAINT-BY  TO D1-MAINT-BY.
  1764
  1765     IF NT-LAST-MAINT-DT = LOW-VALUES OR SPACES
  1766          MOVE SPACES   TO D1-MAINT-DT
  1767      ELSE
  1768        MOVE NT-LAST-MAINT-DT    TO DC-BIN-DATE-1
  1769        MOVE SPACE               TO DC-OPTION-CODE
  1770        PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  1771        MOVE DC-GREG-DATE-1-MDY   TO D1-MAINT-DT.
  1772
  1773     MOVE DETAIL-LINE-1        TO WS-PASSED-DATA.
  1774     MOVE SPACE                TO WS-PASSED-CNTL-CHAR.
  1775     PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1776
  1777     MOVE NT-CONTROL-PRIMARY    TO W-PRIOR-KEY.
  1778
  1779     GO TO 1001-LOOP.
  1780
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL65091.cbl
  1781 1400-NOTFND.
  1782     MOVE 'NOTES NOT FOUND ON FILE' TO WS-PASSED-DATA.
  1783     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1784     GO TO 9999-FINALIZE.
  1785 1500-ENDBR.
  1786     MOVE SPACES TO WS-PASSED-DATA.
  1787     MOVE 'X'  TO WS-PROG-END.
  1788     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1789*    GO TO 9999-FINALIZE.
  1790     GO TO 8999-RETURN-CICS.
  1791 1600-NOT-OPEN.
  1792     MOVE 'NOTE FILE NOT OPEN' TO WS-PASSED-DATA.
  1793     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1794     GO TO 9999-FINALIZE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL65091.cbl
  1796 2000-PRINT-HEADINGS.
  1797     MOVE W-CURRENT-DATE TO H1-DATE.
  1798     MOVE '1'            TO WS-PASSED-CNTL-CHAR.
  1799     MOVE HEAD-LINE-1    TO WS-PASSED-DATA.
  1800     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1801
  1802     PERFORM 5000-GET-ACCOUNT THRU 5999-EXIT.
  1803
  1804     MOVE HEAD-LINE-2       TO WS-PASSED-DATA.
  1805     MOVE '0'               TO WS-PASSED-CNTL-CHAR.
  1806     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1807
  1808     MOVE HEAD-LINE-3       TO WS-PASSED-DATA.
  1809     MOVE SPACE             TO WS-PASSED-CNTL-CHAR.
  1810     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1811
  1812 2000-EXIT.
  1813     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL65091.cbl
  1815
  1816 5000-GET-ACCOUNT.
  1817     IF FIRST-ONE
  1818         NEXT SENTENCE
  1819     ELSE
  1820         GO TO 5500-PUT-LINES.
  1821
  1822
  1823* EXEC CICS HANDLE CONDITION
  1824*        NOTFND (5400-NOTFND)
  1825*    END-EXEC.
  1826*    MOVE '"$I                   ! $ #00001714' TO DFHEIV0
  1827     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1829     MOVE X'2420233030303031373134' TO DFHEIV0(25:11)
  1830     CALL 'kxdfhei1' USING DFHEIV0
  1831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1832
  1833
  1834     MOVE PI-COMPANY-CD          TO  ERACCT-COMPANY-CD.
  1835     MOVE PI-ACCT-CARRIER        TO  ERACCT-CARRIER.
  1836     MOVE PI-ACCT-GROUPING       TO  ERACCT-GROUPING.
  1837     MOVE PI-ACCT-STATE          TO  ERACCT-STATE.
  1838     MOVE PI-ACCT-ACCOUNT        TO  ERACCT-ACCOUNT.
  1839     MOVE PI-ACCT-EXP-DT         TO  ERACCT-EXP-DT.
  1840
  1841
  1842* EXEC CICS READ
  1843*        DATASET (ERACCT-FILE-ID)
  1844*        RIDFLD  (ERACCT-KEY)
  1845*        SET     (ADDRESS OF ACCOUNT-MASTER)
  1846*        EQUAL
  1847*        END-EXEC.
  1848*    MOVE '&"S        E          (   #00001725' TO DFHEIV0
  1849     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1851     MOVE X'2020233030303031373235' TO DFHEIV0(25:11)
  1852     CALL 'kxdfhei1' USING DFHEIV0,
  1853           ERACCT-FILE-ID,
  1854           DFHEIV20,
  1855           DFHEIV99,
  1856           ERACCT-KEY,
  1857           DFHEIV99,
  1858           DFHEIV99,
  1859           DFHEIV99
  1860     SET ADDRESS OF ACCOUNT-MASTER TO
  1861         DFHEIV20
  1862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1863
  1864
  1865     MOVE AM-CARRIER             TO  DA-CARRIER.
  1866     MOVE AM-GROUPING            TO  DA-GROUPING.
  1867     MOVE AM-STATE               TO  DA-STATE.
  1868     MOVE AM-ACCOUNT             TO  DA-ACCOUNT.
  1869
  1870     MOVE AM-NAME                TO  DA-ACCT-NAME.
  1871
  1872     GO TO 5500-PUT-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL65091.cbl
  1873
  1874 5400-NOTFND.
  1875      MOVE 'ACCOUNT MASTER NOT ON FILE '  TO WS-PASSED-DATA.
  1876      MOVE '0'                   TO WS-PASSED-CNTL-CHAR.
  1877      PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1878      GO TO 5999-EXIT.
  1879
  1880 5500-PUT-LINES.
  1881      MOVE HEAD-LINE-ACCOUNT     TO WS-PASSED-DATA.
  1882      MOVE '0'                   TO WS-PASSED-CNTL-CHAR.
  1883      PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1884      MOVE DETAIL-LINE-ACCOUNT   TO WS-PASSED-DATA.
  1885      MOVE ' '                   TO WS-PASSED-CNTL-CHAR.
  1886      PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1887
  1888 5999-EXIT.  EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL65091.cbl
  1890*****************************************************************
  1891*PRINT-RTN.  COPY ELPRTCVP.
  1892 PRINT-RTN.
  1893*    COPY ELPRTCVP.
  1894******************************************************************
  1895***                                                              *
  1896***                          ELPRTCVP.                           *
  1897***                          VMOD=2.003                          *
  1898***                                                              *
  1899***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1900***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1901***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1902***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1903***                                                              *
  1904***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1905***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1906***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1907***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1908***      SUCCESSFUL.                                             *
  1909***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1910***                         LENGTH OF THE LINE TO BE PRINTED     *
  1911***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1912***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1913***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1914***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1915***                         PROGRAM END SWITCH. INITIALIZED      *
  1916***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1917***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1918***      05  WS-PRINT-AREA.                                      *
  1919***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1920***          10  WS-PASSED-DATA          PIC X(132).             *
  1921***                         USE THE DATA TO BE PRINTED IN THE    *
  1922***                         WS-PASSED-DATA.                      *
  1923***                         USE THE STANDARD CARRIAGE CONTROL    *
  1924***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1925***                           SINGLE-SPACE            VALUE ' '  *
  1926***                           DOUBLE-SPACE            VALUE '0'  *
  1927***                           TRIPLE-SPACE            VALUE '-'  *
  1928***                           TOP-PAGE                VALUE '1'  *
  1929***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1930***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1931***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1932***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1933***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1934***            CONDITION.                                        *
  1935***                                                              *
  1936******************************************************************
  1937
  1938 ELPRTCVP.
  1939
  1940*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1941     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1942         MOVE 'P'                TO DL34-PROCESS-TYPE
  1943         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1944         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1945         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1946         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1947         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL65091.cbl
  1948
  1949
  1950* EXEC CICS LINK
  1951*            PROGRAM    ('DLO034')
  1952*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1953*            LENGTH     (DLO034-REC-LENGTH)
  1954*        END-EXEC
  1955     MOVE 'DLO034' TO DFHEIV1
  1956*    MOVE '."C                   ''   #00001816' TO DFHEIV0
  1957     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1958     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1959     MOVE X'2020233030303031383136' TO DFHEIV0(25:11)
  1960     CALL 'kxdfhei1' USING DFHEIV0,
  1961           DFHEIV1,
  1962           DLO034-COMMUNICATION-AREA,
  1963           DLO034-REC-LENGTH,
  1964           DFHEIV99,
  1965           DFHEIV99,
  1966           DFHEIV99
  1967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1968
  1969            IF DL34-RETURN-CODE = 'OK'
  1970                GO TO ELPRTCVP-EXIT
  1971            ELSE
  1972*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1973                GO TO ELPRTCVP-EXIT.
  1974
  1975     IF NOT FIRST-TIME
  1976         GO TO ELPRTCVP-020.
  1977
  1978     IF WS-LINE-LEN NOT GREATER ZERO
  1979         GO TO ELPRTCVP-EXIT.
  1980
  1981     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1982     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1983
  1984     SET BUFFER-INDEX TO +1
  1985
  1986     IF EIBTRMID IS EQUAL TO 'AFLP'
  1987         NEXT SENTENCE
  1988     ELSE
  1989         IF NOT TOP-PAGE
  1990             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1991             SET BUFFER-INDEX UP BY +1.
  1992
  1993 ELPRTCVP-020.
  1994     IF WS-PROG-END = SPACES
  1995         GO TO ELPRTCVP-030.
  1996
  1997     MOVE SPACES                 TO WS-PROG-END.
  1998
  1999     IF BUFFER-INDEX GREATER +1
  2000         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2001
  2002     MOVE '1'                    TO WS-FIRST-TIME-SW.
  2003
  2004     GO TO ELPRTCVP-EXIT.
  2005
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL65091.cbl
  2006 ELPRTCVP-030.
  2007     IF WS-PASSED-DATA = SPACES
  2008         SET PRT-INDEX TO +1
  2009         GO TO ELPRTCVP-050.
  2010
  2011     SET PRT-INDEX TO WS-LINE-LEN.
  2012
  2013 ELPRTCVP-040.
  2014     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  2015         GO TO ELPRTCVP-050.
  2016
  2017     IF PRT-INDEX GREATER +1
  2018         SET PRT-INDEX DOWN BY +1
  2019         GO TO ELPRTCVP-040.
  2020
  2021 ELPRTCVP-050.
  2022     SET WS-LINE-LENGTH TO PRT-INDEX.
  2023     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2024     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2025
  2026     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  2027         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2028
  2029     IF TRIPLE-SPACE
  2030          ADD +2  TO  WS-LINE-CNT
  2031          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2032                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2033          SET BUFFER-INDEX UP BY +2.
  2034
  2035     IF DOUBLE-SPACE
  2036          ADD +1  TO  WS-LINE-CNT
  2037          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2038          SET BUFFER-INDEX UP BY +1.
  2039
  2040     ADD +1 TO WS-LINE-CNT
  2041************************************************************
  2042*     BYPASS NEW LINE SYMBOL                               *
  2043*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2044*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2045************************************************************
  2046
  2047     IF (BUFFER-INDEX GREATER +1 AND
  2048         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2049         FIRST-LINE-NEXT-BUFFER
  2050         MOVE ZERO               TO WS-FIRST-TIME-SW
  2051     ELSE
  2052         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2053         SET BUFFER-INDEX UP BY +1.
  2054
  2055**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2056
  2057     IF TOP-PAGE
  2058         MOVE +1                TO WS-LINE-CNT
  2059         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2060         SET BUFFER-INDEX UP BY +1.
  2061
  2062     SET PRT-INDEX TO +1.
  2063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL65091.cbl
  2064 ELPRTCVP-060.
  2065     MOVE WS-PRINT-BYTE (PRT-INDEX)
  2066                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2067     SET BUFFER-INDEX UP BY +1.
  2068
  2069     IF PRT-INDEX LESS WS-LINE-LENGTH
  2070         SET PRT-INDEX UP BY +1
  2071         GO TO ELPRTCVP-060.
  2072
  2073 ELPRTCVP-EXIT.
  2074     EXIT.
  2075
  2076 ELPRTCVP-PRINT-BUFFER.
  2077     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2078        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2079        SET BUFFER-INDEX UP BY 1.
  2080
  2081     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2082     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2083
  2084
  2085* EXEC CICS SEND
  2086*        FROM    (WS-BUFFER-AREA)
  2087*        LENGTH  (WS-BUFFER-LENGTH)
  2088*        CTLCHAR (WS-WCC-CNTL)
  2089*        ERASE
  2090*    END-EXEC.
  2091*    MOVE '$$    C E         L F ,   #00001937' TO DFHEIV0
  2092     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2093     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2094     MOVE X'2020233030303031393337' TO DFHEIV0(25:11)
  2095     CALL 'kxdfhei1' USING DFHEIV0,
  2096           WS-BUFFER-AREA,
  2097           WS-BUFFER-LENGTH,
  2098           DFHEIV99,
  2099           DFHEIV99,
  2100           WS-WCC-CNTL,
  2101           DFHEIV99,
  2102           DFHEIV99,
  2103           DFHEIV99,
  2104           DFHEIV99,
  2105           DFHEIV99,
  2106           DFHEIV99
  2107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2108
  2109
  2110     SET BUFFER-INDEX TO +1.
  2111     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2112
  2113 ELPRTCVP-PRINT-EXIT.
  2114     EXIT.
  2115
  2116
  2117
  2118*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL65091.cbl
  2120 8300-ABEND.
  2121
  2122     MOVE SPACES                 TO WS-PASSED-DATA.
  2123     MOVE DFHEIBLK               TO WS-PASSED-DATA.
  2124     MOVE LINK-004               TO PGM-NAME.
  2125
  2126
  2127* EXEC CICS LINK
  2128*        PROGRAM   (PGM-NAME)
  2129*        COMMAREA  (WS-PASSED-DATA)
  2130*        LENGTH    (72)
  2131*    END-EXEC.
  2132     MOVE 72
  2133       TO DFHEIV11
  2134*    MOVE '."C                   ''   #00001960' TO DFHEIV0
  2135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2136     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2137     MOVE X'2020233030303031393630' TO DFHEIV0(25:11)
  2138     CALL 'kxdfhei1' USING DFHEIV0,
  2139           PGM-NAME,
  2140           WS-PASSED-DATA,
  2141           DFHEIV11,
  2142           DFHEIV99,
  2143           DFHEIV99,
  2144           DFHEIV99
  2145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2146
  2147
  2148     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2149
  2150     GO TO 9999-FINALIZE.
  2151
  2152 8400-SEND-TEXT.
  2153
  2154* EXEC CICS SEND TEXT
  2155*         FROM    (ERROR-LINE)
  2156*         LENGTH  (70)
  2157*         END-EXEC.
  2158     MOVE 70
  2159       TO DFHEIV11
  2160*    MOVE '8&      T       H   F -   #00001971' TO DFHEIV0
  2161     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  2162     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  2163     MOVE X'2020233030303031393731' TO DFHEIV0(25:11)
  2164     CALL 'kxdfhei1' USING DFHEIV0,
  2165           ERROR-LINE,
  2166           DFHEIV11,
  2167           DFHEIV99,
  2168           DFHEIV99,
  2169           DFHEIV99,
  2170           DFHEIV99,
  2171           DFHEIV99,
  2172           DFHEIV99,
  2173           DFHEIV99,
  2174           DFHEIV99,
  2175           DFHEIV99,
  2176           DFHEIV99
  2177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL65091.cbl
  2178
  2179
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL65091.cbl
  2181
  2182 8500-DATE-CONVERT.
  2183     MOVE LINK-ELDATCV           TO PGM-NAME.
  2184
  2185
  2186* EXEC CICS LINK
  2187*        PROGRAM    (PGM-NAME)
  2188*        COMMAREA   (DATE-CONVERSION-DATA)
  2189*        LENGTH     (DC-COMM-LENGTH)
  2190*        END-EXEC.
  2191*    MOVE '."C                   ''   #00001981' TO DFHEIV0
  2192     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2194     MOVE X'2020233030303031393831' TO DFHEIV0(25:11)
  2195     CALL 'kxdfhei1' USING DFHEIV0,
  2196           PGM-NAME,
  2197           DATE-CONVERSION-DATA,
  2198           DC-COMM-LENGTH,
  2199           DFHEIV99,
  2200           DFHEIV99,
  2201           DFHEIV99
  2202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2203
  2204 8500-EXIT.
  2205     EXIT.
  2206



  2208 8500-NOTFND.
  2209     MOVE 'NO COMMUNICATION AREA FOUND' TO WS-PASSED-DATA.
  2210     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2211     GO TO 9999-FINALIZE.



  2213 8900-PGMIDERR.
  2214     MOVE '* PROG NOT FOUND, NOTIFY DATA PROCESSING *'
  2215                          TO WS-PASSED-DATA.
  2216     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2217     GO TO 9999-FINALIZE.
  2218
  2219* GOBACK.
  2220     MOVE '9%                    "   ' TO DFHEIV0
  2221     MOVE 'EL65091' TO DFHEIV1
  2222     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2223     GOBACK.
  2224 8900-EXIT.
  2225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL65091.cbl
  2227
  2228 8999-RETURN-CICS.
  2229
  2230     MOVE WS-SAVED-PI-COMPANY-ID    TO PI-COMPANY-ID.
  2231
  2232
  2233* EXEC CICS RETURN
  2234*    END-EXEC.
  2235*    MOVE '.(                    &   #00002009' TO DFHEIV0
  2236     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2237     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2238     MOVE X'2020233030303032303039' TO DFHEIV0(25:11)
  2239     CALL 'kxdfhei1' USING DFHEIV0,
  2240           DFHEIV99,
  2241           DFHEIV99,
  2242           DFHEIV99,
  2243           DFHEIV99,
  2244           DFHEIV99
  2245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2246
  2247
  2248 8999-EXIT. EXIT.
  2249
  2250 9999-FINALIZE.
  2251* DLO034 CLOSE
  2252     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2253         IF DL34-PROCESS-TYPE IS NOT EQUAL TO SPACES
  2254             MOVE 'C'                TO DL34-PROCESS-TYPE
  2255             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2256             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2257             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2258             MOVE SPACES             TO DL34-PRINT-LINE
  2259                                        DL34-OVERRIDE-PRINTER-ID
  2260
  2261* EXEC CICS LINK
  2262*                PROGRAM    ('DLO034')
  2263*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  2264*                LENGTH     (DLO034-REC-LENGTH)
  2265*            END-EXEC
  2266     MOVE 'DLO034' TO DFHEIV1
  2267*    MOVE '."C                   ''   #00002024' TO DFHEIV0
  2268     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2270     MOVE X'2020233030303032303234' TO DFHEIV0(25:11)
  2271     CALL 'kxdfhei1' USING DFHEIV0,
  2272           DFHEIV1,
  2273           DLO034-COMMUNICATION-AREA,
  2274           DLO034-REC-LENGTH,
  2275           DFHEIV99,
  2276           DFHEIV99,
  2277           DFHEIV99
  2278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2279             IF DL34-RETURN-CODE NOT = 'OK'
  2280                 MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  2281                                     TO ERROR-LINE
  2282                 PERFORM 8400-SEND-TEXT
  2283
  2284* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL65091.cbl
  2285*                END-EXEC.
  2286*    MOVE '.(                    &   #00002033' TO DFHEIV0
  2287     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2288     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2289     MOVE X'2020233030303032303333' TO DFHEIV0(25:11)
  2290     CALL 'kxdfhei1' USING DFHEIV0,
  2291           DFHEIV99,
  2292           DFHEIV99,
  2293           DFHEIV99,
  2294           DFHEIV99,
  2295           DFHEIV99
  2296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2297
  2298
  2299     MOVE SPACES TO WS-PASSED-DATA.
  2300     MOVE 'X'  TO WS-PROG-END.
  2301     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2302     GO TO 8999-RETURN-CICS.
  2303 9999-EXIT.
  2304
  2305 9999-DFHBACK SECTION.
  2306     MOVE '9%                    "   ' TO DFHEIV0
  2307     MOVE 'EL65091' TO DFHEIV1
  2308     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2309     GOBACK.
  2310 9999-DFHEXIT.
  2311     IF DFHEIGDJ EQUAL 0001
  2312         NEXT SENTENCE
  2313     ELSE IF DFHEIGDJ EQUAL 2
  2314         GO TO 8300-ABEND,
  2315               8900-PGMIDERR,
  2316               9999-FINALIZE,
  2317               8500-NOTFND
  2318         DEPENDING ON DFHEIGDI
  2319     ELSE IF DFHEIGDJ EQUAL 3
  2320         GO TO 1400-NOTFND,
  2321               1600-NOT-OPEN,
  2322               1500-ENDBR
  2323         DEPENDING ON DFHEIGDI
  2324     ELSE IF DFHEIGDJ EQUAL 4
  2325         GO TO 5400-NOTFND
  2326         DEPENDING ON DFHEIGDI.
  2327     MOVE '9%                    "   ' TO DFHEIV0
  2328     MOVE 'EL65091' TO DFHEIV1
  2329     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2330     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5428     Code:        4514
