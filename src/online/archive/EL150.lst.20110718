* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL150.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL150.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL150.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL150 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/09/95 16:19:31.
     7*                            VMOD=2.053
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*REMARKS.    TRANSACTION - EX23 - STATUS DISPLAY AND DISPOSITION
    12*
    13******************************************************************
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL150.cbl
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    22*                              ADJUST REDEFINES EL150AI FILLER
    23* 062602    2002030700006  PEMA  Add note type of 'S'
    24*                                  (special review)
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    26* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    27* 050107    2007041300002  AJRA  PREVENT CHECK FOR NON COVERED CLA
    28* 080106    2006052500001  AJRA  ADD NOTE TYPE N
    29* 041807    2006032200004  AJRA  ADD NOTE TYPE R
    30* 082707    2007032100001  PEMA  ADDITIONAL INTEREST CHANGES
    31* 102809    2008100900003  AJRA  PF19 TO NEW CERT NOTES SCREEN
    32* 042110  CR2008100900001  PEMA  ADD DENIAL TYPE
    33* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    34******************************************************************
    35
    36 ENVIRONMENT DIVISION.
    37
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL150.cbl
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL150 WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.053 *********'.
    46
    47*                            COPY ELCSCTM.
    48******************************************************************
    49*                                                                *
    50*                                                                *
    51*                            ELCSCTM                             *
    52*                            VMOD=2.001                          *
    53*                                                                *
    54*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    55*                                                                *
    56******************************************************************
    57 01  SECURITY-MESSAGE.
    58     12  FILLER                          PIC X(30)
    59            VALUE '** LOGIC SECURITY VIOLATION -'.
    60     12  SM-READ                         PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' PGM='.
    63     12  SM-PGM                          PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' OPR='.
    66     12  SM-PROCESSOR-ID                 PIC X(4).
    67     12  FILLER                          PIC X(6)
    68            VALUE ' TERM='.
    69     12  SM-TERMID                       PIC X(4).
    70     12  FILLER                          PIC XX   VALUE SPACE.
    71     12  SM-JUL-DATE                     PIC 9(5).
    72     12  FILLER                          PIC X    VALUE SPACE.
    73     12  SM-TIME                         PIC 99.99.
    74
    75
    76*                            COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL150.cbl
    97             20  SC-CLAIMS-DISPLAY    PIC X.
    98             20  SC-CLAIMS-UPDATE     PIC X.
    99
   100 01  TS-AREA.
   101     05  TS-PI-AREA          PIC X(1024) VALUE LOW-VALUES.
   102     05  TS-PI-SAVE-CLOAN    PIC X(25)   VALUE LOW-VALUES.
   103 01  WS-DATE-AREA.
   104     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   105     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   106
   107 01  STANDARD-AREAS.
   108     12  TS-LENGTH           PIC S9(4)  COMP VALUE +1049.
   109     12  WS-EARNING-METHOD   PIC X      VALUE SPACES.
   110     12  WS-INDEX            PIC S9(04) COMP VALUE +0.
   111     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   112     12  MAP-NAME            PIC X(8)    VALUE 'EL150A'.
   113     12  MAPSET-NAME         PIC X(8)    VALUE 'EL150S'.
   114     12  TRANS-ID            PIC X(4)    VALUE 'EX23'.
   115     12  THIS-PGM            PIC X(8)    VALUE 'EL150'.
   116     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   117     12  PGM-NAME            PIC X(8).
   118     12  TIME-IN             PIC S9(7).
   119     12  TIME-OUT-R  REDEFINES TIME-IN.
   120         16  FILLER          PIC X.
   121         16  TIME-OUT        PIC 99V99.
   122         16  FILLER          PIC XX.
   123     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   124     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   125     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   126     12  XCTL-1273           PIC X(8)    VALUE 'EL1273'.
   127     12  XCTL-EM1273         PIC X(8)    VALUE 'EM1273'.
   128     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   129     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   130     12  XCTL-EM131          PIC X(8)    VALUE 'EM131'.
   131     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   132     12  XCTL-142            PIC X(8)    VALUE 'EL142'.
   133     12  XCTL-1501           PIC X(8)    VALUE 'EL1501'.
   134     12  XCTL-1502           PIC X(8)    VALUE 'EL1502'.
   135     12  XCTL-151            PIC X(8)    VALUE 'EL151'.
   136     12  XCTL-152            PIC X(8)    VALUE 'EL152'.
   137     12  XCTL-153            PIC X(8)    VALUE 'EL153'.
   138     12  XCTL-154            PIC X(8)    VALUE 'EL154'.
   139     12  XCTL-156            PIC X(8)    VALUE 'EL156'.
   140     12  XCTL-EM156          PIC X(8)    VALUE 'EM156'.
   141     12  XCTL-EM1561         PIC X(8)    VALUE 'EM1561'.
   142     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   143     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   144     12  XCTL-158            PIC X(8)    VALUE 'EL158'.
   145     12  XCTL-162            PIC X(8)    VALUE 'EL162'.
   146     12  XCTL-1276           PIC X(8)    VALUE 'EL1276'.
   147     12  XCTL-EM1276         PIC X(8)    VALUE 'EM1276'.
   148     12  XCTL-1279           PIC X(8)    VALUE 'EL1279'.
   149     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   150     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   151     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   152     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   153     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   154     12  FILE-ID             PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL150.cbl
   155     12  EMPHST-FILE-ID      PIC X(8)    VALUE 'MPPHST'.
   156     12  SC-ITEM             PIC S9(4)   VALUE +0001   COMP.
   157
   158 01  WS-HISTORY-AREA                 PIC X(50).
   159 01  WS-FLD1            REDEFINES WS-HISTORY-AREA.
   160     12  FILLER                 PIC X(38).
   161     12  WS-NUMERIC-FLD1        PIC S9(10)V99.
   162 01  WS-FLD2            REDEFINES WS-HISTORY-AREA.
   163     12  FILLER                 PIC X(45).
   164     12  WS-NUMERIC-FLD2        PIC S99V999.
   165 01  WS-FLD3            REDEFINES WS-HISTORY-AREA.
   166     12  FILLER                 PIC X(35).
   167     12  WS-NUMERIC-FLD3        PIC S9(15).
   168 01  WS-FLD4            REDEFINES WS-HISTORY-AREA.
   169     12  FILLER                 PIC X(36).
   170     12  WS-NUMERIC-FLD4        PIC S9(10)V9999.
   171
   172 01  MISC-WORK-AREAS.
   173     12  QID.
   174         16  QID-TERM        PIC X(4).
   175         16  FILLER          PIC X(4)    VALUE '150A'.
   176     12  MAP-LENGTH          PIC S9(4)   VALUE +1920   COMP.
   177     12  PASS-SWITCH         PIC X       VALUE 'A'.
   178     12  SV-LAST-BY          PIC X(4)    VALUE SPACES.
   179     12  SV-LAST-HHMMSS      PIC S9(6)   VALUE +0      COMP-3.
   180     12  SUB-1               PIC S9(4)   VALUE +0    COMP.
   181     12  DISPLAY-CNT         PIC S9(4)   VALUE +1    COMP.
   182     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   183     12  WS-SUB              PIC 9       VALUE 0.
   184     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   185     12  DIRECTION-SWITCH    PIC X       VALUE 'N'.
   186     12  WS-STATUS           PIC X.
   187     12  WS-LF-COVERAGE-TYPE PIC X       VALUE SPACE.
   188     12  WS-REMAINING-AMT    PIC S9(9)V99 VALUE +0.
   189     12  W-REMAINDER         PIC S9(3)    VALUE +0.
   190     12  WS-TERMS.
   191         16  WST-ORIG        PIC ZZ9.
   192         16  WST-ORIG-DAYS-GRP.
   193             20  WST-SLASH1  PIC X       VALUE '/'.
   194             20  WST-EXT-DAYS
   195                             PIC Z9.
   196         16  FILLER          PIC X       VALUE '/'.
   197         16  WST-REM         PIC ZZ9.
   198         16  WST-REM-DAYS-GRP.
   199             20  WST-SLASH2  PIC X       VALUE '/'.
   200             20  WST-REM-DAYS
   201                             PIC Z9.
   202     12  W-DAYS-PAID-X       PIC ZZZZ9.
   203     12  W-TOTAL-PAID-AMT-X  PIC ZZZZ,ZZZ.99.
   204     12  W-PAID-MONTHS       PIC S9(03)  COMP-3.
   205     12  W-PAID-DAYS         PIC S9(03)  COMP-3.
   206
   207     12  W-REM               PIC S999    COMP-3.
   208     12  W-REM-DAYS          PIC S999    COMP-3.
   209     12  W-TERM-IN-DAYS      PIC S9(4)   COMP-3.
   210     12  W-REM-TERM-IN-DAYS  PIC S9(4)   COMP-3.
   211
   212     12  W-PAYMENTS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL150.cbl
   213         16  W-PYMTS         PIC ZZ9.
   214         16  FILLER          PIC X       VALUE '/'.
   215         16  W-ADD-DAYS      PIC ZZ9.
   216     12  WS-ACCESS.
   217         16  FILLER          PIC XX      VALUE SPACES.
   218         16  WS-BEN-CD       PIC XX.
   219     12  WS-STATE-ACCESS.
   220         16  WS-ST-ACCESS    PIC XX.
   221         16  FILLER          PIC XX      VALUE SPACES.
   222     12  WS-CLAIM-SEQUENCE.
   223         16  FILLER          PIC X       VALUE '('.
   224         16  WS-CUR-SEQU     PIC Z9      VALUE ZEROS.
   225         16  FILLER          PIC X(04)   VALUE ' OF '.
   226         16  WS-OF-SEQU      PIC Z9      VALUE ZEROS.
   227         16  FILLER          PIC X       VALUE ')'.
   228
   229     12  WS-PURGED-MESSAGE.
   230         16  WS-PURGED-MSG       PIC X(18)    VALUE SPACES.
   231         16  WS-PURGED-DATE      PIC X(08)    VALUE SPACES.
   232
   233     12  SAVE-CONTROL        PIC X(39).
   234     12  WS-ERACCT-SAVE-KEY      PIC X(20) VALUE SPACES.
   235     12  WS-ERACCT-HOLD-RECORD   PIC X(2000) VALUE SPACES.
   236
   237     12  SUB                 PIC 99      VALUE ZEROS.
   238
   239     12  WS-ACTIVITY-CODE    PIC 99      VALUE ZEROS.
   240         88  VALID-ACTIVITY-CODE         VALUE 00, 10 THRU 17.
   241
   242     12  WS-ACT-REC-FOUND-SW PIC X       VALUE 'N'.
   243     12  WS-LETTER-SW        PIC X       VALUE 'N'.
   244     12  WS-BROWSE-SW        PIC X       VALUE 'N'.
   245     12  WS-BROWSE-START-SW  PIC X       VALUE ' '.
   246     12  WS-UPDATE-SW        PIC X       VALUE 'N'.
   247
   248     12  WS-ACT-USER-DESC.
   249         16  WS-DESC-1-3     PIC X(03)   VALUE SPACES.
   250         16  FILLER          PIC X(17)   VALUE SPACES.
   251
   252     12  WS-CERT-READ-SW     PIC X       VALUE 'N'.
   253     12  WS-LOAN-EXPIRE-DT   PIC X(08)   VALUE SPACES.
   254     12  W-CLAIM-MASTER-SAVE PIC X(350)  VALUE SPACES.
   255
   256     12  WS-PMT-AMTD.
   257         16  WS-PMT-AMT      PIC Z(4).99-.
   258
   259     12  WS-RESPONSE         PIC S9(8)   COMP.
   260         88  WS-RESP-NORMAL              VALUE +00.
   261         88  WS-RESP-NOTFND              VALUE +13.
   262
   263 01  ACCESS-KEYS.
   264     12  ERACCT-KEY.
   265         16  ERACCT-PARTIAL-KEY.
   266             20  ACCT-COMP-CD    PIC X.
   267             20  ACCT-CARRIER    PIC X.
   268             20  ACCT-GROUPING   PIC X(6).
   269             20  ACCT-STATE      PIC XX.
   270             20  ACCT-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL150.cbl
   271         16  ACCT-EXP-DT         PIC XX.
   272         16  FILLER              PIC X(04).
   273     12  ELMSTR-KEY.
   274         16  MSTR-COMP-CD    PIC X.
   275         16  MSTR-CARRIER    PIC X.
   276         16  MSTR-CLAIM-NO   PIC X(7).
   277         16  MSTR-CERT-NO.
   278             20  MSTR-CERT-NO-PRIME  PIC X(10).
   279             20  MSTR-CERT-NO-SUFX   PIC X.
   280     12  W-ELRETR-KEY.
   281         16  W-RET-COMP-CD       PIC  X.
   282         16  W-RET-CARRIER       PIC  X.
   283         16  W-RET-CLAIM-NO      PIC  X(07).
   284         16  W-RET-CERT-NO.
   285             20  W-RET-CERT-PRIME
   286                                 PIC  X(10).
   287             20  W-RET-CERT-SUFX PIC  X.
   288     12  ELCNTL-KEY.
   289         16  CNTL-COMP-ID    PIC X(3).
   290         16  CNTL-REC-TYPE   PIC X.
   291         16  CNTL-ACCESS.
   292             20  FILLER      PIC XX.
   293             20  CNTL-BEN-NO PIC XX.
   294         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   295     12  ELCERT-KEY.
   296         16  CERT-COMP-CD    PIC X.
   297         16  CERT-CARRIER    PIC X.
   298         16  CERT-GROUPING   PIC X(6).
   299         16  CERT-STATE      PIC XX.
   300         16  CERT-ACCOUNT    PIC X(10).
   301         16  CERT-EFF-DT     PIC XX.
   302         16  CERT-CERT-NO.
   303             20  CERT-CERT-NO-PRIME PIC X(10).
   304             20  CERT-CERT-NO-SUFX  PIC X.
   305     12  ELTRLR-KEY.
   306         16  TRLR-COMP-CD    PIC X.
   307         16  TRLR-CARRIER    PIC X.
   308         16  TRLR-CLAIM-NO   PIC X(7).
   309         16  TRLR-CERT-NO.
   310             20  TRLR-CERT-NO-PRIME PIC X(10).
   311             20  TRLR-CERT-NO-SUFX  PIC X.
   312         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   313     12  ws-ELTRLR-KEY.
   314         16  ws-TRLR-COMP-CD    PIC X.
   315         16  ws-TRLR-CARRIER    PIC X.
   316         16  ws-TRLR-CLAIM-NO   PIC X(7).
   317         16  ws-TRLR-CERT-NO.
   318             20  ws-TRLR-CERT-NO-PRIME PIC X(10).
   319             20  ws-TRLR-CERT-NO-SUFX  PIC X.
   320         16  ws-TRLR-SEQ-NO     PIC S9(4)   COMP.
   321     12  ELACTQ-KEY.
   322         16  ACTQ-COMP-CD    PIC X.
   323         16  ACTQ-CARRIER    PIC X.
   324         16  ACTQ-CLAIM-NO   PIC X(7).
   325         16  ACTQ-CERT-NO.
   326             20  ACTQ-CERT-NO-PRIME PIC X(10).
   327             20  ACTQ-CERT-NO-SUFX  PIC X.
   328     12  ELARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL150.cbl
   329         16  ARCH-COMP-CD        PIC X.
   330         16  ARCH-ARCHIVE-NO     PIC S9(08)  COMP.
   331         16  ARCH-RECORD-TYPE    PIC X.
   332         16  ARCH-SEQ-NO         PIC S9(04)  COMP.
   333
   334     12  EMPLCY-KEY.
   335         16  PLCY-COMP-CD            PIC X.
   336         16  PLCY-CARRIER            PIC X.
   337         16  PLCY-GROUPING           PIC X(06).
   338         16  PLCY-STATE              PIC XX.
   339         16  PLCY-PRODUCER           PIC X(10).
   340         16  PLCY-EFF-DT             PIC XX.
   341         16  PLCY-REFERENCE-NO.
   342             20  PLCY-REFNO-PRIME    PIC X(18).
   343             20  PLCY-REFNO-SFX      PIC XX.
   344
   345     12  EMPHST-KEY.
   346         16  EMPHST-COMPANY-CD       PIC X.
   347         16  EMPHST-CARRIER          PIC X.
   348         16  EMPHST-GROUPING         PIC X(06).
   349         16  EMPHST-STATE            PIC XX.
   350         16  EMPHST-PRODUCER         PIC X(10).
   351         16  EMPHST-POLICY-EFF-DT    PIC XX.
   352         16  EMPHST-REFERENCE-NUMBER.
   353             20  EMPHST-REFNO-PRIME  PIC X(18).
   354             20  EMPHST-REFNO-SFX    PIC XX.
   355         16  EMPHST-RECORD-TYPE      PIC XX.
   356         16  EMPHST-FIELD-TYPE       PIC XX.
   357         16  EMPHST-SEQUENCE-NO      PIC S9(04) COMP.
   358
   359     12  EMPLAN-KEY.
   360         16  PLAN-COMP-CD            PIC X.
   361         16  PLAN-CARRIER            PIC X.
   362         16  PLAN-GROUPING           PIC X(06).
   363         16  PLAN-STATE              PIC XX.
   364         16  PLAN-PRODUCER           PIC X(10).
   365         16  PLAN-PLAN-CODE          PIC XX.
   366         16  PLAN-REV-NO             PIC 9(03).
   367
   368     12  EMPROD-KEY.
   369         16  EMPROD-PARTIAL-KEY.
   370             20  PROD-COMP-CD        PIC X.
   371             20  PROD-CARRIER        PIC X.
   372             20  PROD-GROUPING       PIC X(06).
   373             20  PROD-STATE          PIC XX.
   374             20  PROD-PRODUCER       PIC X(10).
   375         16  PROD-EXP-DT             PIC XX.
   376
   377 01  TRAILER-DISPLAY-WORK-AREA.
   378     12  DISPLAY-ACTION.
   379         16  DISP-ACT-A      PIC X(10).
   380         16  DISP-ACT-B      PIC X(4).
   381     12  FILLER              PIC X.
   382     12  DISPLAY-BY          PIC X(4).
   383     12  FILLER              PIC X.
   384     12  DISPLAY-DATE        PIC X(8).
   385     12  FILLER              PIC X.
   386     12  DISPLAY-SEQ         PIC Z(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL150.cbl
   387     12  FILLER              PIC X.
   388     12  DISPLAY-TEXT        PIC X(45).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL150.cbl
   390 01  ERROR-MESSAGES.
   391     05  ER-0000                 PIC X(4) VALUE '0000'.
   392     05  ER-0004                 PIC X(4) VALUE '0004'.
   393     05  ER-0008                 PIC X(4) VALUE '0008'.
   394     05  ER-0029                 PIC X(4) VALUE '0029'.
   395     05  ER-0033                 PIC X(4) VALUE '0033'.
   396     05  ER-0042                 PIC X(4) VALUE '0042'.
   397     05  ER-0068                 PIC X(4) VALUE '0068'.
   398     05  ER-0070                 PIC X(4) VALUE '0070'.
   399     05  ER-0130                 PIC X(4) VALUE '0130'.
   400     05  ER-0154                 PIC X(4) VALUE '0154'.
   401     05  ER-0168                 PIC X(4) VALUE '0168'.
   402     05  ER-0169                 PIC X(4) VALUE '0169'.
   403     05  ER-0172                 PIC X(4) VALUE '0172'.
   404     05  ER-0190                 PIC X(4) VALUE '0190'.
   405     05  ER-0204                 PIC X(4) VALUE '0204'.
   406     05  ER-0206                 PIC X(4) VALUE '0206'.
   407     05  ER-0303                 PIC X(4) VALUE '0303'.
   408     05  ER-0334                 PIC X(4) VALUE '0334'.
   409     05  ER-0335                 PIC X(4) VALUE '0335'.
   410     05  ER-0336                 PIC X(4) VALUE '0336'.
   411     05  ER-0337                 PIC X(4) VALUE '0337'.
   412     05  ER-0338                 PIC X(4) VALUE '0338'.
   413     05  ER-0376                 PIC X(4) VALUE '0376'.
   414     05  ER-0412                 PIC X(4) VALUE '0412'.
   415     05  ER-0413                 PIC X(4) VALUE '0413'.
   416     05  ER-0433                 PIC X(4) VALUE '0433'.
   417     05  ER-0500                 PIC X(4) VALUE '0500'.
   418     05  ER-0802                 PIC X(4) VALUE '0802'.
   419     05  ER-0803                 PIC X(4) VALUE '0803'.
   420     05  ER-0804                 PIC X(4) VALUE '0804'.
   421     05  ER-0926                 PIC X(4) VALUE '0926'.
   422     05  ER-0927                 PIC X(4) VALUE '0927'.
   423     05  ER-0928                 PIC X(4) VALUE '0928'.
   424     05  ER-0929                 PIC X(4) VALUE '0929'.
   425     05  ER-0931                 PIC X(4) VALUE '0931'.
   426     05  ER-0932                 PIC X(4) VALUE '0932'.
   427     05  ER-0933                 PIC X(4) VALUE '0933'.
   428     05  ER-0934                 PIC X(4) VALUE '0934'.
   429     05  ER-0935                 PIC X(4) VALUE '0935'.
   430     05  ER-0936                 PIC X(4) VALUE '0936'.
   431     05  ER-0937                 PIC X(4) VALUE '0937'.
   432     05  ER-2378                 PIC X(4) VALUE '2378'.
   433     05  ER-2379                 PIC X(4) VALUE '2379'.
   434     05  ER-2848                 PIC X(4) VALUE '2848'.
   435     05  ER-3516                 PIC X(4) VALUE '3516'.
   436     05  ER-3526                 PIC X(4) VALUE '3526'.
   437     05  ER-3545                 PIC X(4) VALUE '3545'.
   438     05  ER-3550                 PIC X(4) VALUE '3550'.
   439     05  ER-9483                 PIC X(4) VALUE '9483'.
   440     05  ER-9808                 PIC X(4) VALUE '9808'.
   441     05  ER-9883                 PIC X(4) VALUE '9883'.
   442     05  ER-9886                 PIC X(4) VALUE '9886'.
   443
   444 01  TEXT-WORK-AREAS.
   445     12  PAYMENT-TEXT.
   446         16  PMT-VAR         PIC X(8).
   447         16  PMT-PD-THRU     PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL150.cbl
   448         16  FILLER          PIC X(7)    VALUE ' CHECK='.
   449         16  PMT-CHECK-NO    PIC X(7).
   450         16  FILLER          PIC X(5)    VALUE ' AMT='.
   451         16  PMT-AMOUNT      PIC Z(6).99-.
   452
   453     12  AUTO-PMT-TEXT.
   454         16  FILLER          PIC X(6)    VALUE 'START='.
   455         16  AUTO-START      PIC X(8).
   456         16  FILLER          PIC X(5)    VALUE ' END='.
   457         16  AUTO-END        PIC X(8).
   458         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   459         16  AUTO-AMOUNT     PIC Z(6).99-.
   460
   461     12  AUTO-TERM-TEXT.
   462         16  FILLER          PIC X(11)   VALUE 'TERMINATED='.
   463         16  AUTO-TERMINATED PIC X(8).
   464         16  FILLER          PIC X(8)    VALUE SPACES.
   465         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   466         16  AUTO-TERM-AMT   PIC Z(6).99-.
   467
   468     12  CORRESPONDENCE-TEXT.
   469         16  FILLER          PIC X(3)    VALUE 'TO='.
   470         16  CORR-TO         PIC X(8).
   471         16  CORR-RECVD-LIT  PIC X(8)    VALUE '  RECVD='.
   472         16  CORR-RECVD      PIC X(8).
   473         16  CORR-VAR        PIC X(9).
   474         16  CORR-RESENT     PIC X(8).
   475         16  CORR-ARCH-NO REDEFINES CORR-RESENT PIC 9(8).
   476
   477     12  PROMPT-TEXT.
   478         16  FILLER          PIC X(4)    VALUE 'END='.
   479         16  PROMPT-END      PIC X(8).
   480         16  FILLER          PIC XX      VALUE SPACES.
   481         16  PROMPT-MSG      PIC X(31).
   482
   483     12  DENIAL-TEXT.
   484         16  FILLER          PIC X(5)    VALUE 'DATE='.
   485         16  DENIAL-DATE     PIC X(8).
   486         16  FILLER          PIC X(6)    VALUE ' CODE='.
   487         16  DENIAL-CODE     PIC X(4).
   488         16  FILLER          PIC XX      VALUE SPACES.
   489         16  DENIAL-MSG      PIC X(20).
   490
   491     12  RECONSIDERED-TEXT.
   492         16  FILLER          PIC X(7)    VALUE 'DENIED '.
   493         16  DENIED-DATE     PIC X(8).
   494         16  FILLER          PIC X(15)   VALUE '  RECONSIDERED '.
   495         16  RECONSIDERED-DATE  PIC X(8).
   496
   497     12  INCUR-TEXT.
   498         16  FILLER          PIC X(6)    VALUE 'INCUR='.
   499         16  INCUR-DT        PIC X(8).
   500         16  PDTHRU-HEAD     PIC X(9)    VALUE ' PD THRU='.
   501         16  INCUR-PDTHRU    PIC X(8).
   502         16  FILLER          PIC X(4)    VALUE ' PD='.
   503         16  INCUR-PAID      PIC Z(6).99-.
   504
   505     12  LOAN-TEXT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL150.cbl
   506         16  FILLER          PIC X(5)    VALUE 'LOAN='.
   507         16  LOAN-NUMBER     PIC X(8).
   508         16  FILLER          PIC X(5)    VALUE ' BAL='.
   509         16  LOAN-BALANCE    PIC Z(7).99-.
   510         16  FILLER          PIC X(4)    VALUE ' ME='.
   511         16  LOAN-MEMBER     PIC X(12).
   512
   513     12  ASSOC-LOAN-TEXT.
   514         16  FILLER          PIC X(11)   VALUE
   515                 'ORIG/CUR : '.
   516         16  ASSOC-ORIG-LOAN PIC X(08)   VALUE SPACES.
   517         16  FILLER          PIC X       VALUE SPACES.
   518         16  ASSOC-CUR-LOAN  PIC X(12)   VALUE SPACES.
   519         16  FILLER          PIC XX      VALUE SPACES.
   520         16  ASSOC-LOAN-TYPE PIC XX      VALUE SPACES.
   521         16  FILLER          PIC X(09)   VALUE SPACES.
   522
   523     12  ASSOC-CV-LOAN-TEXT.
   524         16  FILLER          PIC X(11)   VALUE
   525                 'LOAN NO. : '.
   526         16  ASSOC-CV-LOAN   PIC X(20)   VALUE SPACES.
   527         16  FILLER          PIC X(14)   VALUE SPACES.
   528
   529 01  PAYMENT-DESCRIPTION-TABLE.
   530     12  FILLER              PIC X(14)   VALUE 'PARTIAL PMT   '.
   531     12  FILLER              PIC X(14)   VALUE 'FINAL PMT     '.
   532     12  FILLER              PIC X(14)   VALUE 'LUMP SUM PMT  '.
   533     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL PMT'.
   534     12  FILLER              PIC X(14)   VALUE 'CHARGEABLE EXP'.
   535     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   536     12  FILLER              PIC X(14)   VALUE 'LIFE PRM RFND '.
   537     12  FILLER              PIC X(14)   VALUE 'A/H PRM RFND  '.
   538     12  FILLER              PIC X(14)   VALUE 'ENTRY CORRECT '.
   539 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   540     12  PAY-DESC            PIC X(14)   OCCURS 9.
   541
   542 01  CV-PAYMENT-DESCRIPTION-TABLE.
   543     12  FILLER              PIC X(14)   VALUE 'FULL DEATH    '.
   544     12  FILLER              PIC X(14)   VALUE 'HALF DEATH    '.
   545     12  FILLER              PIC X(14)   VALUE 'FULL AD&D     '.
   546     12  FILLER              PIC X(14)   VALUE 'HALF AD&D     '.
   547     12  FILLER              PIC X(14)   VALUE 'FULL RIDER    '.
   548     12  FILLER              PIC X(14)   VALUE 'HALF RIDER    '.
   549     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   550     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL    '.
   551 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   552     12  CV-PAY-DESC         PIC X(14)   OCCURS 2.
   553
   554 01  CORRESPONDENCE-TO-DESCRIPTIONS.
   555     12  FILLER              PIC X(8)    VALUE 'INSURED '.
   556     12  FILLER              PIC X(8)    VALUE 'BENEF   '.
   557     12  FILLER              PIC X(8)    VALUE 'ACCOUNT '.
   558     12  FILLER              PIC X(8)    VALUE 'DOCTOR  '.
   559     12  FILLER              PIC X(8)    VALUE 'EMPLOYER'.
   560     12  FILLER              PIC X(8)    VALUE 'OTHER1  '.
   561     12  FILLER              PIC X(8)    VALUE 'OTHER2  '.
   562 01  CORR-TO-DESC   REDEFINES CORRESPONDENCE-TO-DESCRIPTIONS.
   563     12  CORR-DESC           PIC X(8)    OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL150.cbl
   564
   565 01  W-CONFIDENTIAL-TEXT.
   566     12  W-CONF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   567     12  W-CONF-TEXT.
   568         16  FILLER.
   569             20  W-CONF-PGM  PIC X(8)    VALUE 'EL150'.
   570             20  FILLER      PIC X       VALUE SPACES.
   571             20  FILLER      PIC X(71)   VALUE
   572     '******THIS IS A CONFIDENTIAL CLAIM!!!!!*****'.
   573         16  FILLER          PIC X(8)    VALUE SPACES.
   574         16  FILLER          PIC X(71)   VALUE
   575      '******PRESS ENTER TO RETURN TO SCREEN.******'.
   576         16  FILLER          PIC X(26)   VALUE SPACES.
   577*        16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   578*        16  FILLER          PIC X       VALUE QUOTE.
   579*        16  W-CONF-SYS-MSG  PIC X(17)
   580*          VALUE 'S CLAS-IC SYSTEM '.
   581
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL150.cbl
   583*                            COPY ELCNWA.
   584*****************************************************************
   585*                                                               *
   586*                                                               *
   587*                            ELCNWA.                            *
   588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   589*                            VMOD=2.003                         *
   590*                                                               *
   591*            M O V E   N A M E   W O R K   A R E A.             *
   592*                                                               *
   593*****************************************************************.
   594
   595 01  WS-NAME-WORK-AREA.
   596     05  WS-INSURED-LAST-NAME        PIC X(15).
   597     05  WS-INSURED-1ST-NAME         PIC X(12).
   598     05  WS-INSURED-MID-INIT         PIC X.
   599
   600     05  WS-NAME-WORK.
   601         10  WS-NW                   PIC X
   602             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   603
   604     05  WS-NAME-WORK2.
   605         10  WS-NW2                  PIC X
   606             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   607                                        NWA-INDEX0.
   608
   609     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   610                                     COMP-3.
   611
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL150.cbl
   613*                            COPY ELCDATE.
   614******************************************************************
   615*                                                                *
   616*                                                                *
   617*                            ELCDATE.                            *
   618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   619*                            VMOD=2.003
   620*                                                                *
   621*                                                                *
   622*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   623*                 LENGTH = 200                                   *
   624******************************************************************
   625
   626 01  DATE-CONVERSION-DATA.
   627     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   628     12  DC-OPTION-CODE                PIC X.
   629         88  BIN-TO-GREG                VALUE ' '.
   630         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   631         88  EDIT-GREG-TO-BIN           VALUE '2'.
   632         88  YMD-GREG-TO-BIN            VALUE '3'.
   633         88  MDY-GREG-TO-BIN            VALUE '4'.
   634         88  JULIAN-TO-BIN              VALUE '5'.
   635         88  BIN-PLUS-ELAPSED           VALUE '6'.
   636         88  FIND-CENTURY               VALUE '7'.
   637         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   638         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   639         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   640         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   641         88  JULIAN-TO-BIN-3            VALUE 'C'.
   642         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   643         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   644         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   645         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   646         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   647         88  CHECK-LEAP-YEAR            VALUE 'H'.
   648         88  BIN-3-TO-GREG              VALUE 'I'.
   649         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   650         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   651         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   652         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   653         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   654         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   655         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   656         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   657         88  THREE-CHARACTER-BIN
   658                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   659         88  GREGORIAN-TO-BIN
   660                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   661         88  BIN-TO-GREGORIAN
   662                  VALUES ' ' '1' 'I' '8' 'G'.
   663         88  JULIAN-TO-BINARY
   664                  VALUES '5' 'C' 'E' 'F'.
   665     12  DC-ERROR-CODE                 PIC X.
   666         88  NO-CONVERSION-ERROR        VALUE ' '.
   667         88  DATE-CONVERSION-ERROR
   668                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   669         88  DATE-IS-ZERO               VALUE '1'.
   670         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL150.cbl
   671         88  DATE-IS-INVALID            VALUE '3'.
   672         88  DATE1-GREATER-DATE2        VALUE '4'.
   673         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   674         88  DATE-INVALID-OPTION        VALUE '9'.
   675         88  INVALID-CENTURY            VALUE 'A'.
   676         88  ONLY-CENTURY               VALUE 'B'.
   677         88  ONLY-LEAP-YEAR             VALUE 'C'.
   678         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   679     12  DC-END-OF-MONTH               PIC X.
   680         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   681     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   682         88  USE-NORMAL-PROCESS         VALUE ' '.
   683         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   684         88  ADJUST-UP-100-YRS          VALUE '2'.
   685     12  FILLER                        PIC X.
   686     12  DC-CONVERSION-DATES.
   687         16  DC-BIN-DATE-1             PIC XX.
   688         16  DC-BIN-DATE-2             PIC XX.
   689         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   690         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   691                       DC-GREG-DATE-1-EDIT.
   692             20  DC-EDIT1-MONTH        PIC 99.
   693             20  SLASH1-1              PIC X.
   694             20  DC-EDIT1-DAY          PIC 99.
   695             20  SLASH1-2              PIC X.
   696             20  DC-EDIT1-YEAR         PIC 99.
   697         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   698         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   699                     DC-GREG-DATE-2-EDIT.
   700             20  DC-EDIT2-MONTH        PIC 99.
   701             20  SLASH2-1              PIC X.
   702             20  DC-EDIT2-DAY          PIC 99.
   703             20  SLASH2-2              PIC X.
   704             20  DC-EDIT2-YEAR         PIC 99.
   705         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   706         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   707                     DC-GREG-DATE-1-YMD.
   708             20  DC-YMD-YEAR           PIC 99.
   709             20  DC-YMD-MONTH          PIC 99.
   710             20  DC-YMD-DAY            PIC 99.
   711         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   712         16  DC-GREG-DATE-1-MDY-R REDEFINES
   713                      DC-GREG-DATE-1-MDY.
   714             20  DC-MDY-MONTH          PIC 99.
   715             20  DC-MDY-DAY            PIC 99.
   716             20  DC-MDY-YEAR           PIC 99.
   717         16  DC-GREG-DATE-1-ALPHA.
   718             20  DC-ALPHA-MONTH        PIC X(10).
   719             20  DC-ALPHA-DAY          PIC 99.
   720             20  FILLER                PIC XX.
   721             20  DC-ALPHA-CENTURY.
   722                 24 DC-ALPHA-CEN-N     PIC 99.
   723             20  DC-ALPHA-YEAR         PIC 99.
   724         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   725         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   726         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   727         16  DC-JULIAN-DATE            PIC 9(05).
   728         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL150.cbl
   729                                       PIC 9(05).
   730         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   731             20  DC-JULIAN-YEAR        PIC 99.
   732             20  DC-JULIAN-DAYS        PIC 999.
   733         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   734         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   735         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   736     12  DATE-CONVERSION-VARIBLES.
   737         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   738         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   739             20  FILLER                PIC 9(3).
   740             20  HOLD-CEN-1-CCYY.
   741                 24  HOLD-CEN-1-CC     PIC 99.
   742                 24  HOLD-CEN-1-YY     PIC 99.
   743             20  HOLD-CEN-1-MO         PIC 99.
   744             20  HOLD-CEN-1-DA         PIC 99.
   745         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   746             20  HOLD-CEN-1-R-MO       PIC 99.
   747             20  HOLD-CEN-1-R-DA       PIC 99.
   748             20  HOLD-CEN-1-R-CCYY.
   749                 24  HOLD-CEN-1-R-CC   PIC 99.
   750                 24  HOLD-CEN-1-R-YY   PIC 99.
   751             20  FILLER                PIC 9(3).
   752         16  HOLD-CENTURY-1-X.
   753             20  FILLER                PIC X(3)  VALUE SPACES.
   754             20  HOLD-CEN-1-X-CCYY.
   755                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   756                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   757             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   759         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   760             20  HOLD-CEN-1-R-X-MO     PIC XX.
   761             20  HOLD-CEN-1-R-X-DA     PIC XX.
   762             20  HOLD-CEN-1-R-X-CCYY.
   763                 24  HOLD-CEN-1-R-X-CC PIC XX.
   764                 24  HOLD-CEN-1-R-X-YY PIC XX.
   765             20  FILLER                PIC XXX.
   766         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   768         16  DC-JULIAN-DATE-1          PIC 9(07).
   769         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   770             20  DC-JULIAN-1-CCYY.
   771                 24  DC-JULIAN-1-CC    PIC 99.
   772                 24  DC-JULIAN-1-YR    PIC 99.
   773             20  DC-JULIAN-DA-1        PIC 999.
   774         16  DC-JULIAN-DATE-2          PIC 9(07).
   775         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   776             20  DC-JULIAN-2-CCYY.
   777                 24  DC-JULIAN-2-CC    PIC 99.
   778                 24  DC-JULIAN-2-YR    PIC 99.
   779             20  DC-JULIAN-DA-2        PIC 999.
   780         16  DC-GREG-DATE-A-EDIT.
   781             20  DC-EDITA-MONTH        PIC 99.
   782             20  SLASHA-1              PIC X VALUE '/'.
   783             20  DC-EDITA-DAY          PIC 99.
   784             20  SLASHA-2              PIC X VALUE '/'.
   785             20  DC-EDITA-CCYY.
   786                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL150.cbl
   787                 24  DC-EDITA-YEAR     PIC 99.
   788         16  DC-GREG-DATE-B-EDIT.
   789             20  DC-EDITB-MONTH        PIC 99.
   790             20  SLASHB-1              PIC X VALUE '/'.
   791             20  DC-EDITB-DAY          PIC 99.
   792             20  SLASHB-2              PIC X VALUE '/'.
   793             20  DC-EDITB-CCYY.
   794                 24  DC-EDITB-CENT     PIC 99.
   795                 24  DC-EDITB-YEAR     PIC 99.
   796         16  DC-GREG-DATE-CYMD         PIC 9(08).
   797         16  DC-GREG-DATE-CYMD-R REDEFINES
   798                              DC-GREG-DATE-CYMD.
   799             20  DC-CYMD-CEN           PIC 99.
   800             20  DC-CYMD-YEAR          PIC 99.
   801             20  DC-CYMD-MONTH         PIC 99.
   802             20  DC-CYMD-DAY           PIC 99.
   803         16  DC-GREG-DATE-MDCY         PIC 9(08).
   804         16  DC-GREG-DATE-MDCY-R REDEFINES
   805                              DC-GREG-DATE-MDCY.
   806             20  DC-MDCY-MONTH         PIC 99.
   807             20  DC-MDCY-DAY           PIC 99.
   808             20  DC-MDCY-CEN           PIC 99.
   809             20  DC-MDCY-YEAR          PIC 99.
   810    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   811        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   812    12  DC-EL310-DATE                  PIC X(21).
   813    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL150.cbl
   815*                            COPY ELCCALC.
   816******************************************************************
   817*                                                                *
   818*                           ELCCALC.                            *
   819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   820*                            VMOD=2.025                          *
   821*                                                                *
   822*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   823*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   824*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   825*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   826*                                                                *
   827*  PASSED TO ELRTRM                                              *
   828*  -----------------                                             *
   829*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   830*  ORIGINAL TERM                                                 *
   831*  BEGINNING DATE                                                *
   832*  ENDING DATE                                                   *
   833*  COMPANY I.D.                                                  *
   834*  ACCOUNT MASTER USER FIELD                                     *
   835*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   836*  FREE LOOK DAYS                                                *
   837*                                                                *
   838*  RETURNED FROM ELRTRM                                          *
   839*  ---------------------                                         *
   840*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   841*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   842*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   843*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   844*----------------------------------------------------------------*
   845*  PASSED TO ELRAMT                                              *
   846*  ----------------                                              *
   847*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   848*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   849*  ORIGINAL AMOUNT                                               *
   850*  ALTERNATE BENEFIT (BALLON)                                    *
   851*  A.P.R. - NET PAY ONLY                                         *
   852*  METHOD
   853*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   854*  COMPANY I.D.                                                  *
   855*  BENEFIT TYPE                                                  *
   856*                                                                *
   857*  RETURNED FROM ELRAMT                                          *
   858*  --------------------                                          *
   859*  REMAINING AMOUNT 1 - CURRENT                                  *
   860*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   861*  REMAINING AMOUNT FACTOR
   862*----------------------------------------------------------------*
   863*  PASSED TO ELRESV                                              *
   864*  -----------------                                             *
   865*  CERTIFICATE EFFECTIVE DATE                                    *
   866*  VALUATION DATE                                                *
   867*  PAID THRU DATE                                                *
   868*  BENEFIT                                                       *
   869*  INCURRED DATE                                                 *
   870*  REPORTED DATE                                                 *
   871*  ISSUE AGE                                                     *
   872*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL150.cbl
   873*  CDT PERCENT                                                   *
   874*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   875* *CLAIM TYPE (LIFE, A/H)                                        *
   876* *REMAINING BENEFIT (FROM ELRAMT)                               *
   877* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   878*                                                                *
   879*  RETURNED FROM ELRESV                                          *
   880*  --------------------                                          *
   881*  CDT TABLE USED                                                *
   882*  CDT FACTOR USED                                               *
   883*  PAY TO CURRENT RESERVE                                        *
   884*  I.B.N.R. - A/H ONLY                                           *
   885*  FUTURE (ACCRUED) AH ONLY                                      *
   886*----------------------------------------------------------------*
   887*  PASSED TO ELRATE                                              *
   888*  ----------------                                              *
   889*  CERT ISSUE DATE                                               *
   890*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   891*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   892*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   893*  STATE CODE (CLIENT DEFINED)                                   *
   894*  STATE CODE (STANDARD P.O. ABBRV)                              *
   895*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   896*  DEVIATION CODE                                                *
   897*  ISSUE AGE                                                     *
   898*  ORIGINAL BENEFIT AMOUNT                                       *
   899*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   900*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   901*  BENEFIT KIND (LIFE OR A/H)                                    *
   902*  A.P.R.                                                        *
   903*  METHOD
   904*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   905*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   906*  COMPANY I.D. (3 CHARACTER)                                    *
   907*  BENEFIT CODE                                                  *
   908*  BENEFIT OVERRIDE CODE                                         *
   909*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   910*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   911*  JOINT INDICATOR (CSL ONLY)                                    *
   912*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   913*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   914*                                                                *
   915*  RETURNED FROM ELRATE                                          *
   916*  --------------------                                          *
   917*  CALCULATED PREMIUM                                            *
   918*  PREMIUM RATE                                                  *
   919*  MORTALITY CODE                                                *
   920*  MAX ATTAINED AGE                                              *
   921*  MAX AGE                                                       *
   922*  MAX TERM                                                      *
   923*  MAX MONTHLY BENEFIT                                           *
   924*  MAX TOTAL BENIFIT                                             *
   925*  COMPOSITE RATE (OPEN-END ONLY)                                *
   926*----------------------------------------------------------------*
   927*  PASSED TO ELRFND                                              *
   928*  ----------------                                              *
   929*  CERT ISSUE DATE                                               *
   930*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL150.cbl
   931*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   932*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   933*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   934*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   935*  STATE CODE (CLIENT DEFINED)                                   *
   936*  STATE CODE (STANDARD P.O. ABBRV)                              *
   937*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   938*  DEVIATION CODE                                                *
   939*  ISSUE AGE                                                     *
   940*  ORIGINAL BENEFIT AMOUNT                                       *
   941*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   942*  PROCESS TYPE (CANCEL)                                         *
   943*  BENEFIT KIND (LIFE OR A/H)                                    *
   944*  A.P.R.                                                        *
   945*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   946*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   947*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   948*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   949*  COMPANY I.D. (3 CHARACTER)                                    *
   950*  BENEFIT CODE                                                  *
   951*  BENEFIT OVERRIDE CODE                                         *
   952*                                                                *
   953*  RETURNED FROM ELRFND                                          *
   954*  --------------------                                          *
   955*  CALCULATED REFUND                                             *
   956*----------------------------------------------------------------*
   957*  PASSED TO ELEARN                                              *
   958*  ----------------                                              *
   959*  CERT ISSUE DATE                                               *
   960*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   961*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   962*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   963*  STATE CODE (CLIENT DEFINED)                                   *
   964*  STATE CODE (STANDARD P.O. ABBRV)                              *
   965*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   966*  DEVIATION CODE                                                *
   967*  ISSUE AGE                                                     *
   968*  ORIGINAL BENEFIT AMOUNT                                       *
   969*  BENEFIT KIND (LIFE OR A/H)                                    *
   970*  A.P.R.                                                        *
   971*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   972*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   973*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   974*  COMPANY I.D. (3 CHARACTER)                                    *
   975*  BENEFIT CODE                                                  *
   976*  BENEFIT OVERRIDE CODE                                         *
   977*                                                                *
   978*  RETURNED FROM ELEARN                                          *
   979*  --------------------                                          *
   980*  INDICATED  EARNINGS                                           *
   981*----------------------------------------------------------------*
   982*                 LENGTH = 450                                   *
   983*                                                                *
   984******************************************************************
   985******************************************************************
   986*                   C H A N G E   L O G
   987*
   988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL150.cbl
   989*-----------------------------------------------------------------
   990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   991* EFFECTIVE    NUMBER
   992*-----------------------------------------------------------------
   993* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   994* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   995* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   996* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   997* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   998* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   999* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1000******************************************************************
  1001
  1002 01  CALCULATION-PASS-AREA.
  1003     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1004                                     COMP.
  1005
  1006     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1007       88  NO-CP-ERROR                             VALUE ZERO.
  1008       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1009                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1010       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1011       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1012       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1013       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1014       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1015       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1016       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1017       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1018       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1019       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1020       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1021       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1022       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1023       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1024       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1025       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1026       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1027
  1028     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1029       88  NO-CP-ERROR-2                           VALUE ZERO.
  1030***********************  INPUT AREAS ****************************
  1031
  1032     12  CP-CALCULATION-AREA.
  1033         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1034         16  CP-CERT-EFF-DT        PIC XX.
  1035         16  CP-VALUATION-DT       PIC XX.
  1036         16  CP-PAID-THRU-DT       PIC XX.
  1037         16  CP-BENEFIT-TYPE       PIC X.
  1038           88  CP-AH                               VALUE 'A' 'D'
  1039                                                   'I' 'U'.
  1040           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1041           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1042         16  CP-INCURRED-DT        PIC XX.
  1043         16  CP-REPORTED-DT        PIC XX.
  1044         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1045         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1046         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL150.cbl
  1047                                     COMP-3.
  1048         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1049                                     COMP-3.
  1050         16  CP-CDT-METHOD         PIC X.
  1051           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1052           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1053           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1054         16  CP-CLAIM-TYPE         PIC X.
  1055           88  CP-AH-CLAIM                         VALUE 'A'.
  1056           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1057         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1058                                     COMP-3.
  1059         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1060                                     COMP-3.
  1061         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1062                                     COMP-3.
  1063         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1064                                     COMP-3.
  1065         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1066                                     COMP-3.
  1067         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-REM-TERM-METHOD    PIC X.
  1072           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1073           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1074           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1075           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1076           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1077           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1078           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1079         16  CP-EARNING-METHOD     PIC X.
  1080           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1081           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1082           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1083           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1084           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1085           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1086           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1087           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1088           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1089           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1090           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1091           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1092         16  CP-PROCESS-TYPE       PIC X.
  1093           88  CP-CLAIM                            VALUE '1'.
  1094           88  CP-CANCEL                           VALUE '2'.
  1095           88  CP-ISSUE                            VALUE '3'.
  1096         16  CP-SPECIAL-CALC-CD    PIC X.
  1097           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1098           88  CP-1-MTH-INTEREST               VALUE ' '.
  1099           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1100           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1101           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1102           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1103           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1104           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL150.cbl
  1105           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1106           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1107           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1108           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1109           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1110           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1111           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1112           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1113           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1114           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1115                                                     'W' 'X'.
  1116           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1117           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1118           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1119           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1120           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1121           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1122           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1123           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1124           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1125           88  CP-CSL-METH-1                   VALUE '5'.
  1126           88  CP-CSL-METH-2                   VALUE '6'.
  1127           88  CP-CSL-METH-3                   VALUE '7'.
  1128           88  CP-CSL-METH-4                   VALUE '8'.
  1129
  1130         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1131                                     COMP-3.
  1132         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1133         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1134         16  CP-STATE              PIC XX          VALUE SPACE.
  1135         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1136         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1137           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1138               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1139         16  CP-R78-OPTION         PIC X.
  1140           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1141           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1142
  1143         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1144         16  CP-IBNR-RESERVE-SW    PIC X.
  1145         16  CP-CLAIM-STATUS       PIC X.
  1146         16  CP-RATE-FILE          PIC X.
  1147         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1148                                     COMP-3.
  1149
  1150         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1151         16  CP-AH-OVERRIDE-CODE   PIC X.
  1152
  1153         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1154                                     COMP-3.
  1155         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1156                                     COMP-3.
  1157         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1158                                     COMP-3.
  1159         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1160                                     COMP-3.
  1161
  1162         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL150.cbl
  1163         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1164         16  CP-EXT-DAYS-CALC      PIC X.
  1165           88  CP-EXT-NO-CHG                   VALUE ' '.
  1166           88  CP-EXT-CHG-LF                   VALUE '1'.
  1167           88  CP-EXT-CHG-AH                   VALUE '2'.
  1168           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1169         16  CP-DOMICILE-STATE     PIC XX.
  1170         16  CP-CARRIER            PIC X.
  1171         16  CP-REIN-FLAG          PIC X.
  1172         16  CP-REM-TRM-CALC-OPTION PIC X.
  1173           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1174                      '2' '3' '4' '5'.
  1175           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1176           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1177           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1178           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1179           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1180           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1181           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1182           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1183         16  CP-SIG-SWITCH         PIC X.
  1184         16  CP-RATING-METHOD      PIC X.
  1185           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1186           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1187           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1188           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1189           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1190           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1191           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1192           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1193           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1194         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1195                                     COMP-3.
  1196         16  CP-BEN-CATEGORY       PIC X.
  1197         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1198         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1199                                   PIC S99V9(5) COMP-3.
  1200         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1201         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1202                                   PIC S99V9(5) COMP-3.
  1203         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1204         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1205         16  CP-EXPIRE-DT          PIC XX.
  1206         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1207         16  FILLER                PIC X(35).
  1208*        16  FILLER                PIC X(50).
  1209
  1210***************    OUTPUT FROM ELRESV   ************************
  1211
  1212         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1213
  1214         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1215                                     COMP-3.
  1216         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1217                                     COMP-3.
  1218         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1219                                     COMP-3.
  1220         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL150.cbl
  1221                                     COMP-3.
  1222         16  FILLER                PIC X(09).
  1223***************    OUTPUT FROM ELRTRM   *************************
  1224
  1225         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1226                                     COMP-3.
  1227         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1228                                     COMP-3.
  1229         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1230                                     COMP-3.
  1231         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1232                                     COMP-3.
  1233         16  FILLER                PIC X(12).
  1234
  1235***************    OUTPUT FROM ELRAMT   *************************
  1236
  1237         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1238                                     COMP-3.
  1239         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1240                                     COMP-3.
  1241         16  FILLER                PIC X(12).
  1242
  1243***************    OUTPUT FROM ELRATE   *************************
  1244
  1245         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1246                                     COMP-3.
  1247         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1248                                     COMP-3.
  1249         16  CP-MORTALITY-CODE     PIC X(4).
  1250         16  CP-RATE-EDIT-FLAG     PIC X.
  1251             88  CP-RATES-NEED-APR                  VALUE '1'.
  1252         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1253                                     COMP-3.
  1254         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1255         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1256         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1257                                   PIC S9(7)V99 COMP-3.
  1258         16  FILLER                PIC X(07).
  1259
  1260***************    OUTPUT FROM ELRFND   *************************
  1261
  1262         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1263                                     COMP-3.
  1264         16  CP-REFUND-TYPE-USED   PIC X.
  1265           88  CP-R-AS-R78                         VALUE '1'.
  1266           88  CP-R-AS-PRORATA                     VALUE '2'.
  1267           88  CP-R-AS-CALIF                       VALUE '3'.
  1268           88  CP-R-AS-TEXAS                       VALUE '4'.
  1269           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1270           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1271           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1272           88  CP-R-AS-MEAN                        VALUE '8'.
  1273           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1274           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1275           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1276         16  FILLER                PIC X(12).
  1277
  1278***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL150.cbl
  1279
  1280         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1281                                     COMP-3.
  1282         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1283                                     COMP-3.
  1284         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1285                                     COMP-3.
  1286         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1287                                     COMP-3.
  1288         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1289                                     COMP-3.
  1290         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1291                                     COMP-3.
  1292         16  CP-EARNING-TYPE-USED  PIC X.
  1293           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1294           88  CP-E-AS-R78                         VALUE '1'.
  1295           88  CP-E-AS-PRORATA                     VALUE '2'.
  1296           88  CP-E-AS-TEXAS                       VALUE '4'.
  1297           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1298           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1299           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1300           88  CP-E-AS-MEAN                        VALUE '8'.
  1301           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1302         16  FILLER                PIC X(12).
  1303
  1304***************    OUTPUT FROM ELPMNT   *************************
  1305
  1306         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1307                                     COMP-3.
  1308         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1309                                     COMP-3.
  1310         16  FILLER                PIC X(12).
  1311
  1312***************   MISC WORK AREAS    *****************************
  1313         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1314                                     COMP-3.
  1315         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1316                                     COMP-3.
  1317         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1318                                     COMP-3.
  1319         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1320                                     COMP-3.
  1321         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1322                                     COMP-3.
  1323         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1324                                     COMP-3.
  1325         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1326             88  OPEN-RATE-FILE                   VALUE 'O'.
  1327             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1328             88  IO-ERROR                         VALUE 'E'.
  1329
  1330         16  CP-FIRST-PAY-DATE     PIC XX.
  1331
  1332         16  CP-JOINT-INDICATOR    PIC X.
  1333
  1334         16  CP-RESERVE-REMAINING-TERM
  1335                                   PIC S9(4)V9    VALUE ZERO
  1336                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL150.cbl
  1337
  1338         16  CP-INSURED-BIRTH-DT   PIC XX.
  1339
  1340         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1341                                     COMP-3.
  1342
  1343         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1344                                     COMP-3.
  1345
  1346         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1347                                     COMP-3.
  1348
  1349         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1350                                     COMP-3.
  1351
  1352         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1353                                     COMP-3.
  1354
  1355         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1356                                     COMP-3.
  1357
  1358         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1359                                     COMP-3.
  1360
  1361         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1362             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1363
  1364         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1365                                     COMP-3.
  1366         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1367                                     COMP-3.
  1368         16  FILLER                PIC X(17).
  1369******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL150.cbl
  1371*                            COPY ELCLOGOF.
  1372******************************************************************
  1373*                                                                *
  1374*                                                                *
  1375*                            ELCLOGOF.                           *
  1376*                            VMOD=2.001                          *
  1377*                                                                *
  1378*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1379*                                                                *
  1380******************************************************************
  1381 01  CLASIC-LOGOFF.
  1382     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1383     12  LOGOFF-TEXT.
  1384         16  FILLER          PIC X(5)    VALUE SPACES.
  1385         16  LOGOFF-MSG.
  1386             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1387             20  FILLER      PIC X       VALUE SPACES.
  1388             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1389         16  FILLER          PIC X(80)
  1390           VALUE '* YOU ARE NOW LOGGED OFF'.
  1391         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1392         16  FILLER          PIC X       VALUE QUOTE.
  1393         16  LOGOFF-SYS-MSG  PIC X(17)
  1394           VALUE 'S CLAS-IC SYSTEM '.
  1395     12  TEXT-MESSAGES.
  1396         16  UNACCESS-MSG    PIC X(29)
  1397             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1398         16  PGMIDERR-MSG    PIC X(17)
  1399             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL150.cbl
  1401*                            COPY ELCATTR.
  1402******************************************************************
  1403*                                                                *
  1404*                            ELCATTR.                            *
  1405*                            VMOD=2.001                          *
  1406*                                                                *
  1407*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1408*                                                                *
  1409*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1410*                                                                *
  1411*                   POS 1   P=PROTECTED                          *
  1412*                           U=UNPROTECTED                        *
  1413*                           S=ASKIP                              *
  1414*                   POS 2   A=ALPHA/NUMERIC                      *
  1415*                           N=NUMERIC                            *
  1416*                   POS 3   N=NORMAL                             *
  1417*                           B=BRIGHT                             *
  1418*                           D=DARK                               *
  1419*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1420*                           OF=MODIFIED DATA TAG OFF             *
  1421*                                                                *
  1422*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1423******************************************************************
  1424 01  ATTRIBUTE-LIST.
  1425     12  AL-PABOF            PIC X       VALUE 'Y'.
  1426     12  AL-PABON            PIC X       VALUE 'Z'.
  1427     12  AL-PADOF            PIC X       VALUE '%'.
  1428     12  AL-PADON            PIC X       VALUE '_'.
  1429     12  AL-PANOF            PIC X       VALUE '-'.
  1430     12  AL-PANON            PIC X       VALUE '/'.
  1431     12  AL-SABOF            PIC X       VALUE '8'.
  1432     12  AL-SABON            PIC X       VALUE '9'.
  1433     12  AL-SADOF            PIC X       VALUE '@'.
  1434     12  AL-SADON            PIC X       VALUE QUOTE.
  1435     12  AL-SANOF            PIC X       VALUE '0'.
  1436     12  AL-SANON            PIC X       VALUE '1'.
  1437     12  AL-UABOF            PIC X       VALUE 'H'.
  1438     12  AL-UABON            PIC X       VALUE 'I'.
  1439     12  AL-UADOF            PIC X       VALUE '<'.
  1440     12  AL-UADON            PIC X       VALUE '('.
  1441     12  AL-UANOF            PIC X       VALUE ' '.
  1442     12  AL-UANON            PIC X       VALUE 'A'.
  1443     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1444     12  AL-UNBON            PIC X       VALUE 'R'.
  1445     12  AL-UNDOF            PIC X       VALUE '*'.
  1446     12  AL-UNDON            PIC X       VALUE ')'.
  1447     12  AL-UNNOF            PIC X       VALUE '&'.
  1448     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL150.cbl
  1450*                            COPY ELCMSTR.
  1451******************************************************************
  1452*                                                                *
  1453*                            ELCMSTR.                            *
  1454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1455*                            VMOD=2.012                          *
  1456*                                                                *
  1457*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1458*                                                                *
  1459*   FILE TYPE = VSAM,KSDS                                        *
  1460*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1461*                                                                *
  1462*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1463*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1464*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1465*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1466*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1467*                                                 RKP=75,LEN=21  *
  1468*                                                                *
  1469*   **** NOTE ****                                               *
  1470*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1471*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1472*                                                                *
  1473*   LOG = YES                                                    *
  1474*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1475******************************************************************
  1476*                   C H A N G E   L O G
  1477*
  1478* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1479*-----------------------------------------------------------------
  1480*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1481* EFFECTIVE    NUMBER
  1482*-----------------------------------------------------------------
  1483* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1484* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1485******************************************************************
  1486 01  CLAIM-MASTER.
  1487     12  CL-RECORD-ID                PIC XX.
  1488         88  VALID-CL-ID         VALUE 'CL'.
  1489
  1490     12  CL-CONTROL-PRIMARY.
  1491         16  CL-COMPANY-CD           PIC X.
  1492         16  CL-CARRIER              PIC X.
  1493         16  CL-CLAIM-NO             PIC X(7).
  1494         16  CL-CERT-NO.
  1495             20  CL-CERT-PRIME       PIC X(10).
  1496             20  CL-CERT-SFX         PIC X.
  1497
  1498     12  CL-CONTROL-BY-NAME.
  1499         16  CL-COMPANY-CD-A1        PIC X.
  1500         16  CL-INSURED-LAST-NAME    PIC X(15).
  1501         16  CL-INSURED-NAME.
  1502             20  CL-INSURED-1ST-NAME PIC X(12).
  1503             20  CL-INSURED-MID-INIT PIC X.
  1504
  1505     12  CL-CONTROL-BY-SSN.
  1506         16  CL-COMPANY-CD-A2        PIC X.
  1507         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL150.cbl
  1508             20  CL-SSN-STATE        PIC XX.
  1509             20  CL-SSN-ACCOUNT      PIC X(6).
  1510             20  CL-SSN-LN3          PIC X(3).
  1511
  1512     12  CL-CONTROL-BY-CERT-NO.
  1513         16  CL-COMPANY-CD-A4        PIC X.
  1514         16  CL-CERT-NO-A4.
  1515             20  CL-CERT-A4-PRIME    PIC X(10).
  1516             20  CL-CERT-A4-SFX      PIC X.
  1517
  1518     12  CL-CONTROL-BY-CCN.
  1519         16  CL-COMPANY-CD-A5        PIC X.
  1520         16  CL-CCN-A5.
  1521             20  CL-CCN.
  1522                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1523                 24  CL-CCN-PRIME-A5 PIC X(12).
  1524             20  CL-CCN-FILLER-A5    PIC X(4).
  1525
  1526     12  CL-INSURED-PROFILE-DATA.
  1527         16  CL-INSURED-BIRTH-DT     PIC XX.
  1528         16  CL-INSURED-SEX-CD       PIC X.
  1529             88  INSURED-IS-MALE        VALUE 'M'.
  1530             88  INSURED-IS-FEMALE      VALUE 'F'.
  1531             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1532         16  CL-INSURED-OCC-CD       PIC X(6).
  1533         16  FILLER                  PIC X(5).
  1534
  1535     12  CL-PROCESSING-INFO.
  1536         16  CL-PROCESSOR-ID         PIC X(4).
  1537         16  CL-CLAIM-STATUS         PIC X.
  1538             88  CLAIM-IS-OPEN          VALUE 'O'.
  1539             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1540         16  CL-CLAIM-TYPE           PIC X.
  1541*            88  AH-CLAIM               VALUE 'A'.
  1542*            88  LIFE-CLAIM             VALUE 'L'.
  1543*            88  PROPERTY-CLAIM         VALUE 'P'.
  1544*            88  IUI-CLAIM              VALUE 'I'.
  1545*            88  GAP-CLAIM              VALUE 'G'.
  1546         16  CL-CLAIM-PREM-TYPE      PIC X.
  1547             88  SINGLE-PREMIUM         VALUE '1'.
  1548             88  O-B-COVERAGE           VALUE '2'.
  1549             88  OPEN-END-COVERAGE      VALUE '3'.
  1550         16  CL-INCURRED-DT          PIC XX.
  1551         16  CL-REPORTED-DT          PIC XX.
  1552         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1553         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1554         16  CL-LAST-PMT-DT          PIC XX.
  1555         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1556         16  CL-PAID-THRU-DT         PIC XX.
  1557         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1558         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1559         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1560         16  CL-PMT-CALC-METHOD      PIC X.
  1561             88  CL-360-DAY-YR          VALUE '1'.
  1562             88  CL-365-DAY-YR          VALUE '2'.
  1563             88  CL-FULL-MONTHS         VALUE '3'.
  1564         16  CL-CAUSE-CD             PIC X(6).
  1565
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL150.cbl
  1566         16  CL-PRIME-CERT-NO.
  1567             20  CL-PRIME-CERT-PRIME PIC X(10).
  1568             20  CL-PRIME-CERT-SFX   PIC X.
  1569
  1570         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1571             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1572             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1573
  1574         16  CL-MICROFILM-NO         PIC X(10).
  1575         16  CL-PROG-FORM-TYPE       PIC X.
  1576         16  CL-LAST-ADD-ON-DT       PIC XX.
  1577
  1578         16  CL-LAST-REOPEN-DT       PIC XX.
  1579         16  CL-LAST-CLOSE-DT        PIC XX.
  1580         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1581             88  FINAL-PAID             VALUE '1'.
  1582             88  CLAIM-DENIED           VALUE '2'.
  1583             88  AUTO-CLOSE             VALUE '3'.
  1584             88  MANUAL-CLOSE           VALUE '4'.
  1585             88  BENEFITS-CHANGED       VALUE 'C'.
  1586             88  SETUP-ERRORS           VALUE 'E'.
  1587         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1588         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1589         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1590             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1591         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1592         16  FILLER                  PIC X.
  1593
  1594     12  CL-CERTIFICATE-DATA.
  1595         16  CL-CERT-ORIGIN          PIC X.
  1596             88  CERT-WAS-ONLINE        VALUE '1'.
  1597             88  CERT-WAS-CREATED       VALUE '2'.
  1598             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1599         16  CL-CERT-KEY-DATA.
  1600             20  CL-CERT-CARRIER     PIC X.
  1601             20  CL-CERT-GROUPING    PIC X(6).
  1602             20  CL-CERT-STATE       PIC XX.
  1603             20  CL-CERT-ACCOUNT.
  1604                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1605                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1606             20  CL-CERT-EFF-DT      PIC XX.
  1607
  1608     12  CL-STATUS-CONTROLS.
  1609         16  CL-PRIORITY-CD          PIC X.
  1610             88  CONFIDENTIAL-DATA      VALUE '8'.
  1611             88  HIGHEST-PRIORITY       VALUE '9'.
  1612         16  CL-SUPV-ATTN-CD         PIC X.
  1613             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1614             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1615         16  CL-PURGED-DT            PIC XX.
  1616         16  CL-RESTORED-DT          PIC XX.
  1617         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1618         16  CL-NEXT-RESEND-DT       PIC XX.
  1619         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1620         16  FILLER                  PIC XX.
  1621         16  CL-LAST-MAINT-DT        PIC XX.
  1622         16  CL-LAST-MAINT-USER      PIC X(4).
  1623         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL150.cbl
  1624         16  CL-LAST-MAINT-TYPE      PIC X.
  1625             88  CLAIM-SET-UP           VALUE ' '.
  1626             88  PAYMENT-MADE           VALUE '1'.
  1627             88  LETTER-SENT            VALUE '2'.
  1628             88  MASTER-WAS-ALTERED     VALUE '3'.
  1629             88  MASTER-WAS-RESTORED    VALUE '4'.
  1630             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1631             88  FILE-CONVERTED         VALUE '6'.
  1632             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1633             88  ERROR-CORRECTION       VALUE 'E'.
  1634         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1635         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1636         16  CL-BENEFICIARY          PIC X(10).
  1637         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1638         16  CL-DENIAL-TYPE          PIC X.
  1639             88  CL-TYPE-DENIAL          VALUE '1'.
  1640             88  CL-TYPE-RESCISSION      VALUE '2'.
  1641             88  CL-TYPE-REFORMATION     VALUE '3'.
  1642             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1643             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1644         16  FILLER                  PIC X(5).
  1645
  1646     12  CL-TRAILER-CONTROLS.
  1647         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1648             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1649             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1650             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1651         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1652         16  FILLER                  PIC XX.
  1653         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1654         16  CL-ADDRESS-TRAILER-CNT.
  1655             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1656                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1657             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1658                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1659             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1660                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1661             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1662                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1663             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1664                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1665             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1666                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1667             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1668                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1669
  1670     12  CL-CV-REFERENCE-NO.
  1671         16  CL-CV-REFNO-PRIME       PIC X(18).
  1672         16  CL-CV-REFNO-SFX         PIC XX.
  1673
  1674     12  CL-FILE-LOCATION            PIC X(4).
  1675
  1676     12  CL-PROCESS-ERRORS.
  1677         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1678             88  NO-FATAL-ERRORS        VALUE ZERO.
  1679         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1680             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1681
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL150.cbl
  1682     12  CL-PRODUCT-CD               PIC X.
  1683
  1684     12  CL-CURRENT-KEY-DATA.
  1685         16  CL-CURRENT-CARRIER      PIC X.
  1686         16  CL-CURRENT-GROUPING     PIC X(6).
  1687         16  CL-CURRENT-STATE        PIC XX.
  1688         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1689
  1690     12  CL-ASSOCIATES               PIC X.
  1691         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1692         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1693         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1694         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1695
  1696     12  CL-ACTIVITY-CODE            PIC 99.
  1697     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1698     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1699
  1700     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1701     12  CL-LAG-REPORT-CODE          PIC 9.
  1702     12  CL-LOAN-TYPE                PIC XX.
  1703     12  CL-LEGAL-STATE              PIC XX.
  1704
  1705*    12  FILLER                      PIC X(5).
  1706     12  CL-YESNOSW                  PIC X.
  1707     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL150.cbl
  1709*                            COPY ELCEMIB.
  1710******************************************************************
  1711*                                                                *
  1712*                                                                *
  1713*                            ELCEMIB.                            *
  1714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1715*                            VMOD=2.005                          *
  1716*                                                                *
  1717*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1718*                                                                *
  1719******************************************************************
  1720 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1721     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1722     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1723     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1724     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1725     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1726     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1727     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1728     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1729     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1730         88  EMI-NO-ERRORS                    VALUE '1'.
  1731         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1732         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1733     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1734         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1735     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1736         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1737         88  EMI-AREA1-FULL                   VALUE '2'.
  1738     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1739         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1740         88  EMI-AREA2-FULL                   VALUE '2'.
  1741     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1742         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1743         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1744         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1745         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1746         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1747     12  EMI-ERROR-LINES.
  1748         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1749         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1750         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1751         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1752             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1753                 24  EMI-ERR-NUM         PIC X(4).
  1754                 24  EMI-FILLER          PIC X.
  1755                 24  EMI-SEV             PIC X.
  1756                 24  FILLER              PIC X.
  1757             20  FILLER                  PIC X(02).
  1758     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1759         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1760             20  EMI-ERROR-NUMBER    PIC X(4).
  1761             20  EMI-FILL            PIC X.
  1762             20  EMI-SEVERITY        PIC X.
  1763             20  FILLER              PIC X.
  1764             20  EMI-ERROR-TEXT.
  1765                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1766                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL150.cbl
  1767     12  EMI-SEVERITY-SAVE           PIC X.
  1768         88  EMI-NOTE                    VALUE 'N'.
  1769         88  EMI-WARNING                 VALUE 'W'.
  1770         88  EMI-FORCABLE                VALUE 'F'.
  1771         88  EMI-FATAL                   VALUE 'X'.
  1772     12  EMI-MESSAGE-FLAG            PIC X.
  1773         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1774         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1775     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1776     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1777         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1778         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1779         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1780     12  FILLER                      PIC X(137)  VALUE SPACES.
  1781     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1782     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1783     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1784     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL150.cbl
  1786*                            COPY ELCLNKLT.
  1787******************************************************************
  1788*                                                                *
  1789*                                                                *
  1790*                           ELCLNKLT                             *
  1791*                            VMOD=2.003                          *
  1792*                                                                *
  1793*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1794*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1795*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1796*                                                                *
  1797*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1798*   COMPLETING THE REQUIRED FIELDS.                              *
  1799*                                                                *
  1800*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1801*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1802*                              9999 INDICATES AN UNKNOWN ABEND   *
  1803*                                   WAS DETECTED.                *
  1804*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1805*                              CODES FOUND IN THE ERROR FILE.    *
  1806******************************************************************
  1807 01  W-1523-LINKDATA.
  1808     12  W-1523-COMMON-PI-DATA.
  1809         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1810         16  FILLER              PIC  X(67).
  1811         16  W-1523-COMPANY-CD   PIC  X(01).
  1812         16  FILLER              PIC  X(10).
  1813         16  W-1523-CONTROL-IN-PROGRESS.
  1814             20  W-1523-CARRIER  PIC  X(01).
  1815             20  W-1523-GROUPING PIC  X(06).
  1816             20  W-1523-STATE    PIC  X(02).
  1817             20  W-1523-ACCOUNT  PIC  X(10).
  1818             20  W-1523-CLAIM-CERT-GRP.
  1819                 24  W-1523-CLAIM-NO
  1820                                 PIC  X(07).
  1821                 24  W-1523-CERT-NO.
  1822                     28  W-1523-CERT-PRIME
  1823                                 PIC  X(10).
  1824                     28  W-1523-CERT-SFX
  1825                                 PIC  X(01).
  1826                 24  W-1523-CERT-EFF-DT
  1827                                 PIC  X(02).
  1828         16  FILLER              PIC X(265).
  1829
  1830     12  W-1523-WORK-AREA.
  1831         16  W-1523-FORM-NUMBER  PIC  X(04).
  1832         16  W-1523-NUMBER-COPIES
  1833                                 PIC  9(01).
  1834         16  W-1523-ADDR-TYPE    PIC  X(02).
  1835         16  W-1523-FOLLOW-UP-DATE
  1836                                 PIC  X(02).
  1837         16  W-1523-RESEND-DATE  PIC  X(02).
  1838         16  W-1523-ERROR-CODE   PIC  9(04).
  1839             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1840             88  W-1523-FATAL-ERROR
  1841                                    VALUES  0006 0013 0042
  1842                                            0154 0168 0169
  1843                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL150.cbl
  1844                                            0179 0186 0281
  1845                                            0332 2055 3697
  1846                                            3698 3699 3770
  1847                                            3771 3772 7675
  1848                                            9106 9808 9883
  1849                                            9887.
  1850             88  W-1523-STOP-ERRORS
  1851                                    VALUES  0013 0042 0154
  1852                                            0168 0169 0172
  1853                                            0281 0332 2055
  1854                                            3698 3699 7675
  1855                                            9106 9808 9883
  1856                                            9999.
  1857         16  W-1523-REASON       PIC  X(70).
  1858         16  W-1523-ARCHIVE-NUMBER
  1859                                 PIC  9(08).
  1860     12  W-1523-POINTER-AREA.
  1861         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1862         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1863         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1864         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1865         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL150.cbl
  1867*                            COPY ELCINTF.
  1868******************************************************************
  1869*                                                                *
  1870*                                                                *
  1871*                            ELCINTF.                            *
  1872*                            VMOD=2.017                          *
  1873*                                                                *
  1874*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1875*                                                                *
  1876*       LENGTH = 1024                                            *
  1877*                                                                *
  1878******************************************************************
  1879 01  PROGRAM-INTERFACE-BLOCK.
  1880     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1881     12  PI-CALLING-PROGRAM              PIC X(8).
  1882     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1883     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1884     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1885     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1886     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1887     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1888     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1889     12  PI-COMPANY-ID                   PIC XXX.
  1890     12  PI-COMPANY-CD                   PIC X.
  1891
  1892     12  PI-COMPANY-PASSWORD             PIC X(8).
  1893
  1894     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1895
  1896     12  PI-CONTROL-IN-PROGRESS.
  1897         16  PI-CARRIER                  PIC X.
  1898         16  PI-GROUPING                 PIC X(6).
  1899         16  PI-STATE                    PIC XX.
  1900         16  PI-ACCOUNT                  PIC X(10).
  1901         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1902                                         PIC X(10).
  1903         16  PI-CLAIM-CERT-GRP.
  1904             20  PI-CLAIM-NO             PIC X(7).
  1905             20  PI-CERT-NO.
  1906                 25  PI-CERT-PRIME       PIC X(10).
  1907                 25  PI-CERT-SFX         PIC X.
  1908             20  PI-CERT-EFF-DT          PIC XX.
  1909         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1910             20  PI-PLAN-CODE            PIC X(2).
  1911             20  PI-REVISION-NUMBER      PIC X(3).
  1912             20  PI-PLAN-EFF-DT          PIC X(2).
  1913             20  PI-PLAN-EXP-DT          PIC X(2).
  1914             20  FILLER                  PIC X(11).
  1915         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1916             20  PI-OE-REFERENCE-1.
  1917                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1918                 25  PI-OE-REF-1-SUFF    PIC XX.
  1919
  1920     12  PI-SESSION-IN-PROGRESS          PIC X.
  1921         88  CLAIM-SESSION                   VALUE '1'.
  1922         88  CREDIT-SESSION                  VALUE '2'.
  1923         88  WARRANTY-SESSION                VALUE '3'.
  1924         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL150.cbl
  1925         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1926
  1927
  1928*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1929
  1930     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1931     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1932
  1933     12  PI-CREDIT-USER                  PIC X.
  1934         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1935         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1936
  1937     12  PI-CLAIM-USER                   PIC X.
  1938         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1939         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1940
  1941     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1942         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1943         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1944         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1945         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1946         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1947
  1948     12  PI-PROCESSOR-ID                 PIC X(4).
  1949
  1950     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1951
  1952     12  PI-MEMBER-CAPTION               PIC X(10).
  1953
  1954     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1955         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1956
  1957     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1958     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1959     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1960     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1961
  1962     12  PI-AH-OVERRIDE-L1               PIC X.
  1963     12  PI-AH-OVERRIDE-L2               PIC XX.
  1964     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1965     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1966
  1967     12  PI-NEW-SYSTEM                   PIC X(2).
  1968
  1969     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1970     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1971         88  PI-USES-PAID-TO                 VALUE '1'.
  1972     12  PI-CRDTCRD-SYSTEM.
  1973         16  PI-CRDTCRD-USER             PIC X.
  1974             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1975             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1976         16  PI-CC-MONTH-END-DT          PIC XX.
  1977     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1978
  1979     12  PI-OE-REFERENCE-2.
  1980         16  PI-OE-REF-2-PRIME           PIC X(10).
  1981         16  PI-OE-REF-2-SUFF            PIC X.
  1982
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL150.cbl
  1983     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1984
  1985     12  PI-LANGUAGE-TYPE                PIC X.
  1986             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1987             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1988             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1989
  1990     12  PI-POLICY-LINKAGE-IND           PIC X.
  1991         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1992         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1993                                                   LOW-VALUES.
  1994
  1995     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1996     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1997         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1998         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1999     12  FILLER                          PIC X(4).
  2000
  2001     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2002
  2003     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2004         PI-SYSTEM-LEVEL.
  2005
  2006         16  PI-ENTRY-CODES.
  2007             20  PI-ENTRY-CD-1           PIC X.
  2008             20  PI-ENTRY-CD-2           PIC X.
  2009
  2010         16  PI-RETURN-CODES.
  2011             20  PI-RETURN-CD-1          PIC X.
  2012             20  PI-RETURN-CD-2          PIC X.
  2013
  2014         16  PI-UPDATE-STATUS-SAVE.
  2015             20  PI-UPDATE-BY            PIC X(4).
  2016             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2017
  2018         16  PI-LOWER-CASE-LETTERS       PIC X.
  2019             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2020
  2021*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2022*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2023*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2024
  2025         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2026             88  ST-ACCNT-CNTL               VALUE ' '.
  2027             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2028             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2029             88  ACCNT-CNTL                  VALUE '3'.
  2030             88  CARR-ACCNT-CNTL             VALUE '4'.
  2031
  2032         16  PI-PROCESSOR-CAP-LIST.
  2033             20  PI-SYSTEM-CONTROLS.
  2034                24 PI-SYSTEM-DISPLAY     PIC X.
  2035                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2036                24 PI-SYSTEM-MODIFY      PIC X.
  2037                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2038             20  FILLER                  PIC XX.
  2039             20  PI-DISPLAY-CAP          PIC X.
  2040                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL150.cbl
  2041             20  PI-MODIFY-CAP           PIC X.
  2042                 88  MODIFY-CAP              VALUE 'Y'.
  2043             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2044                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2045             20  PI-FORCE-CAP            PIC X.
  2046                 88  FORCE-CAP               VALUE 'Y'.
  2047
  2048         16  PI-PROGRAM-CONTROLS.
  2049             20  PI-PGM-PRINT-OPT        PIC X.
  2050             20  PI-PGM-FORMAT-OPT       PIC X.
  2051             20  PI-PGM-PROCESS-OPT      PIC X.
  2052             20  PI-PGM-TOTALS-OPT       PIC X.
  2053
  2054         16  PI-HELP-INTERFACE.
  2055             20  PI-LAST-ERROR-NO        PIC X(4).
  2056             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2057
  2058         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2059             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2060
  2061         16  PI-CR-CONTROL-IN-PROGRESS.
  2062             20  PI-CR-CARRIER           PIC X.
  2063             20  PI-CR-GROUPING          PIC X(6).
  2064             20  PI-CR-STATE             PIC XX.
  2065             20  PI-CR-ACCOUNT           PIC X(10).
  2066             20  PI-CR-FIN-RESP          PIC X(10).
  2067             20  PI-CR-TYPE              PIC X.
  2068
  2069         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2070
  2071         16  PI-CR-MONTH-END-DT          PIC XX.
  2072
  2073         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2074             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2075             88  PI-ZERO-CARRIER             VALUE '1'.
  2076             88  PI-ZERO-GROUPING            VALUE '2'.
  2077             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2078
  2079         16  PI-CARRIER-SECURITY         PIC X.
  2080             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2081
  2082         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2083             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2084             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2085
  2086         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2087             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2088                                         INDEXED BY PI-ACCESS-NDX
  2089                                         PIC X.
  2090
  2091         16  PI-GA-BILLING-CONTROL       PIC X.
  2092             88  PI-GA-BILLING               VALUE '1'.
  2093
  2094         16  PI-MAIL-PROCESSING          PIC X.
  2095             88  PI-MAIL-YES                 VALUE 'Y'.
  2096
  2097         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2098
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL150.cbl
  2099         16  PI-AR-SYSTEM.
  2100             20  PI-AR-PROCESSING-CNTL   PIC X.
  2101                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2102             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2103             20  PI-AR-MONTH-END-DT      PIC XX.
  2104
  2105         16  PI-MP-SYSTEM.
  2106             20  PI-MORTGAGE-USER            PIC X.
  2107                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2108                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2109             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2110                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2111                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2112                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2113                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2114                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2115             20  PI-MP-MONTH-END-DT          PIC XX.
  2116             20  PI-MP-REFERENCE-NO.
  2117                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2118                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2119
  2120         16  PI-LABEL-CONTROL            PIC X(01).
  2121             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2122             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2123
  2124         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2125             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2126
  2127         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2128             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2129             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2130
  2131         16  FILLER                      PIC X(14).
  2132
  2133     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2134******************************************************************
  2135     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  2136         16  PI-PASS-AREA        PIC  S9(4) COMP.
  2137         16  PI-EL142-PRIORITY   PIC  X.
  2138         16  FILLER              PIC  X(211).
  2139         16  PI-CURRENT-FILE     PIC  X(08).
  2140         16  PI-ORIGINAL-ASS-CERT
  2141                                 PIC  X(20).
  2142         16  PI-TOTAL-PAID       PIC S9(07)V99 COMP-3.
  2143         16  PI-DAYS-PAID        PIC S9(05) COMP-3.
  2144         16  PI-LAST-SEQ-NO      PIC S9(03) COMP-3.
  2145         16  PI-LAST-PF-KEY-IND  PIC  X.
  2146             88  PI-PF15-LAST            VALUE 'F'.
  2147             88  PI-PF16-LAST            VALUE 'S'.
  2148         16  PI-ASSOCIATED-PROCESS-IND
  2149                                 PIC  X.
  2150             88  PI-ASS-PROCESSING       VALUE 'Y'.
  2151             88  PI-NOT-ASS-PROCESSING   VALUE SPACES LOW-VALUES.
  2152         16  PI-ASS-NDX          PIC S9(04) COMP.
  2153         16  PI-ASSOCIATED-CERTS-TABLE.
  2154             20  PI-ASS-CERTS OCCURS 24 TIMES
  2155                                 PIC  X(11).
  2156*00545          16  FILLER              PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL150.cbl
  2157         16  FILLER              PIC  X(05).
  2158         16  PI-FORCE-COUNT      PIC  99.
  2159         16  PI-PFKEY-USED       PIC  X.
  2160         16  PI-JOINT-COV-IND    PIC  X.
  2161             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2162             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2163         16  PI-JOINT-INSURED-IND PIC X.
  2164             88  PI-JOINT-INSURED        VALUE 'Y'.
  2165             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2166         16  PI-PRIORITY-CD      PIC  X.
  2167             88  PI-PRIORITY-9           VALUE '9'.
  2168         16  PI-STATUS-IND       PIC  X.
  2169             88  PI-CLOSED               VALUE 'C'.
  2170             88  PI-OPEN                 VALUE 'O'.
  2171         16  PI-LAST-CLOSE-REASON-IND
  2172                                 PIC  X.
  2173             88  PI-BENEFIT-CHANGE       VALUE 'C'.
  2174             88  PI-ERROR-CORRECTION     VALUE 'E'.
  2175         16  PI-PRIORITY-IND     PIC  X.
  2176             88  PI-SUPERVISOR-ONLY      VALUE 'S'.
  2177             88  PI-CONFIDENTIAL-UP      VALUE 'C'.
  2178         16  PI-RETRIEVED-DATA-IND
  2179                                 PIC  X.
  2180             88  PI-RETRIEVED-DATA       VALUE 'Y'.
  2181*        16  PI-SAVE             PIC  X(227).
  2182         16  PI-SAVE-TYPE        PIC  X.
  2183         16  PI-SAVE-FILETO      PIC  X(4).
  2184         16  PI-SAVE-PRTOPT      PIC  X.
  2185         16  PI-SAVE-FORMAT      PIC  X.
  2186         16  PI-SAVE-FORM        PIC  X(12).
  2187         16  PI-PREV-DISP        PIC  X.
  2188         16  PI-PREV-DIR         PIC  X.
  2189         16  PI-SAVE-CURSOR      PIC S9(04) COMP.
  2190         16  PI-SAVE-CNT         PIC S9(04) COMP.
  2191         16  PI-SAVE-LOW         PIC S9(04) COMP.
  2192         16  PI-SAVE-HIGH        PIC S9(04) COMP.
  2193         16  PI-PREV-CLAIM.
  2194             20  PI-PREV-COMP-CD PIC X.
  2195             20  PI-PREV-CARRIER PIC X.
  2196             20  PI-PREV-CLAIM-NO PIC X(7).
  2197             20  PI-PREV-CERT-NO.
  2198                 24  PI-PREV-CERT-NO-PRIME
  2199                                 PIC X(10).
  2200                 24  PI-CERT-NO-SUFX   PIC X.
  2201         16  PI-PREV-PRIME-CERT-NO
  2202                                 PIC X(11).
  2203         16  PI-PURGED-SW        PIC  X.
  2204             88  CLAIM-IS-PURGED         VALUE 'Y'.
  2205         16  PI-PREV-CLMNO       PIC  X(07).
  2206         16  PI-SAVE-MCRFLM      PIC  X(10).
  2207         16  PI-PREV-TRLR-KEY    PIC  X(22).
  2208         16  PI-SAVE-ACT-CD      PIC  XX.
  2209         16  PI-SAVE-ASSOC       PIC  X.
  2210         16  PI-SAVE-SYS-ID      PIC  XX.
  2211*        16  PI-SAVE-CLOAN       PIC  X(25).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL150.cbl
  2213*                            COPY ELCJPFX.
  2214******************************************************************
  2215*                                                                *
  2216*                                                                *
  2217*                            ELCJPFX.                            *
  2218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2219*                            VMOD=2.002                          *
  2220*                                                                *
  2221*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2222*                                                                *
  2223*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2224*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2225*        ELCNTL - CONTROL FILE                                   *
  2226*        ELMSTR - CLAIM MASTERS                                  *
  2227*        ELTRLR - ACTIVITY TRAILERS                              *
  2228*        ELCHKQ - CHECK QUE                                      *
  2229******************************************************************
  2230 01  JOURNAL-RECORD.
  2231     12  JP-USER-ID                  PIC X(4).
  2232     12  JP-FILE-ID                  PIC X(8).
  2233     12  JP-PROGRAM-ID               PIC X(8).
  2234     12  JP-RECORD-TYPE              PIC X.
  2235         88 JP-ADD              VALUE 'A'.
  2236         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2237         88 JP-AFTER-CHANGE     VALUE 'C'.
  2238         88 JP-DELETE           VALUE 'D'.
  2239         88 JP-GENERIC-DELETE   VALUE 'G'.
  2240         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2241         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2242     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2243     12  JP-RECORD-AREA
  2244
  2245
  2246                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL150.cbl
  2248*                            COPY ELCAID.
  2249******************************************************************
  2250*                                                                *
  2251*                            ELCAID.                             *
  2252*                            VMOD=2.001                          *
  2253*                                                                *
  2254*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2255*                                                                *
  2256*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2257*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2258******************************************************************
  2259
  2260 01  DFHAID.
  2261   02  DFHNULL   PIC  X  VALUE  ' '.
  2262   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2263   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2264   02  DFHPEN    PIC  X  VALUE  '='.
  2265   02  DFHOPID   PIC  X  VALUE  'W'.
  2266   02  DFHPA1    PIC  X  VALUE  '%'.
  2267   02  DFHPA2    PIC  X  VALUE  '>'.
  2268   02  DFHPA3    PIC  X  VALUE  ','.
  2269   02  DFHPF1    PIC  X  VALUE  '1'.
  2270   02  DFHPF2    PIC  X  VALUE  '2'.
  2271   02  DFHPF3    PIC  X  VALUE  '3'.
  2272   02  DFHPF4    PIC  X  VALUE  '4'.
  2273   02  DFHPF5    PIC  X  VALUE  '5'.
  2274   02  DFHPF6    PIC  X  VALUE  '6'.
  2275   02  DFHPF7    PIC  X  VALUE  '7'.
  2276   02  DFHPF8    PIC  X  VALUE  '8'.
  2277   02  DFHPF9    PIC  X  VALUE  '9'.
  2278   02  DFHPF10   PIC  X  VALUE  ':'.
  2279   02  DFHPF11   PIC  X  VALUE  '#'.
  2280   02  DFHPF12   PIC  X  VALUE  '@'.
  2281   02  DFHPF13   PIC  X  VALUE  'A'.
  2282   02  DFHPF14   PIC  X  VALUE  'B'.
  2283   02  DFHPF15   PIC  X  VALUE  'C'.
  2284   02  DFHPF16   PIC  X  VALUE  'D'.
  2285   02  DFHPF17   PIC  X  VALUE  'E'.
  2286   02  DFHPF18   PIC  X  VALUE  'F'.
  2287   02  DFHPF19   PIC  X  VALUE  'G'.
  2288   02  DFHPF20   PIC  X  VALUE  'H'.
  2289   02  DFHPF21   PIC  X  VALUE  'I'.
  2290*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2291   02  DFHPF22   PIC  X  VALUE  '['.
  2292   02  DFHPF23   PIC  X  VALUE  '.'.
  2293   02  DFHPF24   PIC  X  VALUE  '<'.
  2294   02  DFHMSRE   PIC  X  VALUE  'X'.
  2295   02  DFHSTRF   PIC  X  VALUE  'h'.
  2296   02  DFHTRIG   PIC  X  VALUE  '"'.
  2297 01  FILLER    REDEFINES DFHAID.
  2298     12  FILLER              PIC X(8).
  2299     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL150.cbl
  2301*                            COPY EL150S.
  2302 01  EL150AI.
  2303     05  FILLER            PIC  X(0012).
  2304*    -------------------------------
  2305     05  RUNDTEL PIC S9(0004) COMP.
  2306     05  RUNDTEF PIC  X(0001).
  2307     05  FILLER REDEFINES RUNDTEF.
  2308         10  RUNDTEA PIC  X(0001).
  2309     05  RUNDTEI PIC  X(0008).
  2310*    -------------------------------
  2311     05  RUNTIMEL PIC S9(0004) COMP.
  2312     05  RUNTIMEF PIC  X(0001).
  2313     05  FILLER REDEFINES RUNTIMEF.
  2314         10  RUNTIMEA PIC  X(0001).
  2315     05  RUNTIMEI PIC  X(0005).
  2316*    -------------------------------
  2317     05  SEQUL PIC S9(0004) COMP.
  2318     05  SEQUF PIC  X(0001).
  2319     05  FILLER REDEFINES SEQUF.
  2320         10  SEQUA PIC  X(0001).
  2321     05  SEQUI PIC  X(0010).
  2322*    -------------------------------
  2323     05  CMPNYIDL PIC S9(0004) COMP.
  2324     05  CMPNYIDF PIC  X(0001).
  2325     05  FILLER REDEFINES CMPNYIDF.
  2326         10  CMPNYIDA PIC  X(0001).
  2327     05  CMPNYIDI PIC  X(0003).
  2328*    -------------------------------
  2329     05  USERIDL PIC S9(0004) COMP.
  2330     05  USERIDF PIC  X(0001).
  2331     05  FILLER REDEFINES USERIDF.
  2332         10  USERIDA PIC  X(0001).
  2333     05  USERIDI PIC  X(0004).
  2334*    -------------------------------
  2335     05  RETMSTL PIC S9(0004) COMP.
  2336     05  RETMSTF PIC  X(0001).
  2337     05  FILLER REDEFINES RETMSTF.
  2338         10  RETMSTA PIC  X(0001).
  2339     05  RETMSTI PIC  X(0015).
  2340*    -------------------------------
  2341     05  CRDCARDL PIC S9(0004) COMP.
  2342     05  CRDCARDF PIC  X(0001).
  2343     05  FILLER REDEFINES CRDCARDF.
  2344         10  CRDCARDA PIC  X(0001).
  2345     05  CRDCARDI PIC  X(0016).
  2346*    -------------------------------
  2347     05  CLMNOL PIC S9(0004) COMP.
  2348     05  CLMNOF PIC  X(0001).
  2349     05  FILLER REDEFINES CLMNOF.
  2350         10  CLMNOA PIC  X(0001).
  2351     05  CLMNOI PIC  X(0007).
  2352*    -------------------------------
  2353     05  CARRL PIC S9(0004) COMP.
  2354     05  CARRF PIC  X(0001).
  2355     05  FILLER REDEFINES CARRF.
  2356         10  CARRA PIC  X(0001).
  2357     05  CARRI PIC  X(0001).
  2358*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL150.cbl
  2359     05  CERTNOL PIC S9(0004) COMP.
  2360     05  CERTNOF PIC  X(0001).
  2361     05  FILLER REDEFINES CERTNOF.
  2362         10  CERTNOA PIC  X(0001).
  2363     05  CERTNOI PIC  X(0010).
  2364*    -------------------------------
  2365     05  SUFXL PIC S9(0004) COMP.
  2366     05  SUFXF PIC  X(0001).
  2367     05  FILLER REDEFINES SUFXF.
  2368         10  SUFXA PIC  X(0001).
  2369     05  SUFXI PIC  X(0001).
  2370*    -------------------------------
  2371     05  CLMTYPL PIC S9(0004) COMP.
  2372     05  CLMTYPF PIC  X(0001).
  2373     05  FILLER REDEFINES CLMTYPF.
  2374         10  CLMTYPA PIC  X(0001).
  2375     05  CLMTYPI PIC  X(0006).
  2376*    -------------------------------
  2377     05  CLMSTATL PIC S9(0004) COMP.
  2378     05  CLMSTATF PIC  X(0001).
  2379     05  FILLER REDEFINES CLMSTATF.
  2380         10  CLMSTATA PIC  X(0001).
  2381     05  CLMSTATI PIC  X(0006).
  2382*    -------------------------------
  2383     05  LSTNMEL PIC S9(0004) COMP.
  2384     05  LSTNMEF PIC  X(0001).
  2385     05  FILLER REDEFINES LSTNMEF.
  2386         10  LSTNMEA PIC  X(0001).
  2387     05  LSTNMEI PIC  X(0015).
  2388*    -------------------------------
  2389     05  FSTNMEL PIC S9(0004) COMP.
  2390     05  FSTNMEF PIC  X(0001).
  2391     05  FILLER REDEFINES FSTNMEF.
  2392         10  FSTNMEA PIC  X(0001).
  2393     05  FSTNMEI PIC  X(0012).
  2394*    -------------------------------
  2395     05  MINITL PIC S9(0004) COMP.
  2396     05  MINITF PIC  X(0001).
  2397     05  FILLER REDEFINES MINITF.
  2398         10  MINITA PIC  X(0001).
  2399     05  MINITI PIC  X(0001).
  2400*    -------------------------------
  2401     05  PRIMHDGL PIC S9(0004) COMP.
  2402     05  PRIMHDGF PIC  X(0001).
  2403     05  FILLER REDEFINES PRIMHDGF.
  2404         10  PRIMHDGA PIC  X(0001).
  2405     05  PRIMHDGI PIC  X(0012).
  2406*    -------------------------------
  2407     05  PRIMCRTL PIC S9(0004) COMP.
  2408     05  PRIMCRTF PIC  X(0001).
  2409     05  FILLER REDEFINES PRIMCRTF.
  2410         10  PRIMCRTA PIC  X(0001).
  2411     05  PRIMCRTI PIC  X(0010).
  2412*    -------------------------------
  2413     05  PRIMSFXL PIC S9(0004) COMP.
  2414     05  PRIMSFXF PIC  X(0001).
  2415     05  FILLER REDEFINES PRIMSFXF.
  2416         10  PRIMSFXA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL150.cbl
  2417     05  PRIMSFXI PIC  X(0001).
  2418*    -------------------------------
  2419     05  NOTIFYL PIC S9(0004) COMP.
  2420     05  NOTIFYF PIC  X(0001).
  2421     05  FILLER REDEFINES NOTIFYF.
  2422         10  NOTIFYA PIC  X(0001).
  2423     05  NOTIFYI PIC  X(0013).
  2424*    -------------------------------
  2425     05  CLMTOTHL PIC S9(0004) COMP.
  2426     05  CLMTOTHF PIC  X(0001).
  2427     05  FILLER REDEFINES CLMTOTHF.
  2428         10  CLMTOTHA PIC  X(0001).
  2429     05  CLMTOTHI PIC  X(0027).
  2430*    -------------------------------
  2431     05  AMTPDL PIC S9(0004) COMP.
  2432     05  AMTPDF PIC  X(0001).
  2433     05  FILLER REDEFINES AMTPDF.
  2434         10  AMTPDA PIC  X(0001).
  2435     05  AMTPDI PIC  X(0011).
  2436*    -------------------------------
  2437     05  DAYSPDHL PIC S9(0004) COMP.
  2438     05  DAYSPDHF PIC  X(0001).
  2439     05  FILLER REDEFINES DAYSPDHF.
  2440         10  DAYSPDHA PIC  X(0001).
  2441     05  DAYSPDHI PIC  X(0010).
  2442*    -------------------------------
  2443     05  DAYSPDL PIC S9(0004) COMP.
  2444     05  DAYSPDF PIC  X(0001).
  2445     05  FILLER REDEFINES DAYSPDF.
  2446         10  DAYSPDA PIC  X(0001).
  2447     05  DAYSPDI PIC  X(0005).
  2448*    -------------------------------
  2449     05  YESNOSWL PIC S9(0004) COMP.
  2450     05  YESNOSWF PIC  X(0001).
  2451     05  FILLER REDEFINES YESNOSWF.
  2452         10  YESNOSWA PIC  X(0001).
  2453     05  YESNOSWI PIC  X(0001).
  2454*    -------------------------------
  2455     05  PDTHRHDL PIC S9(0004) COMP.
  2456     05  PDTHRHDF PIC  X(0001).
  2457     05  FILLER REDEFINES PDTHRHDF.
  2458         10  PDTHRHDA PIC  X(0001).
  2459     05  PDTHRHDI PIC  X(0014).
  2460*    -------------------------------
  2461     05  PDTHRUL PIC S9(0004) COMP.
  2462     05  PDTHRUF PIC  X(0001).
  2463     05  FILLER REDEFINES PDTHRUF.
  2464         10  PDTHRUA PIC  X(0001).
  2465     05  PDTHRUI PIC  X(0008).
  2466*    -------------------------------
  2467     05  TOTPAIDL PIC S9(0004) COMP.
  2468     05  TOTPAIDF PIC  X(0001).
  2469     05  FILLER REDEFINES TOTPAIDF.
  2470         10  TOTPAIDA PIC  X(0001).
  2471     05  TOTPAIDI PIC  X(0010).
  2472*    -------------------------------
  2473     05  COVERDL PIC S9(0004) COMP.
  2474     05  COVERDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL150.cbl
  2475     05  FILLER REDEFINES COVERDF.
  2476         10  COVERDA PIC  X(0001).
  2477     05  COVERDI PIC  X(0012).
  2478*    -------------------------------
  2479     05  COVERL PIC S9(0004) COMP.
  2480     05  COVERF PIC  X(0001).
  2481     05  FILLER REDEFINES COVERF.
  2482         10  COVERA PIC  X(0001).
  2483     05  COVERI PIC  X(0010).
  2484*    -------------------------------
  2485     05  INCURL PIC S9(0004) COMP.
  2486     05  INCURF PIC  X(0001).
  2487     05  FILLER REDEFINES INCURF.
  2488         10  INCURA PIC  X(0001).
  2489     05  INCURI PIC  X(0008).
  2490*    -------------------------------
  2491     05  NOPMTSL PIC S9(0004) COMP.
  2492     05  NOPMTSF PIC  X(0001).
  2493     05  FILLER REDEFINES NOPMTSF.
  2494         10  NOPMTSA PIC  X(0001).
  2495     05  NOPMTSI PIC  X(0007).
  2496*    -------------------------------
  2497     05  PRMTYPDL PIC S9(0004) COMP.
  2498     05  PRMTYPDF PIC  X(0001).
  2499     05  FILLER REDEFINES PRMTYPDF.
  2500         10  PRMTYPDA PIC  X(0001).
  2501     05  PRMTYPDI PIC  X(0012).
  2502*    -------------------------------
  2503     05  PRMTYPEL PIC S9(0004) COMP.
  2504     05  PRMTYPEF PIC  X(0001).
  2505     05  FILLER REDEFINES PRMTYPEF.
  2506         10  PRMTYPEA PIC  X(0001).
  2507     05  PRMTYPEI PIC  X(0008).
  2508*    -------------------------------
  2509     05  NXTAUTOL PIC S9(0004) COMP.
  2510     05  NXTAUTOF PIC  X(0001).
  2511     05  FILLER REDEFINES NXTAUTOF.
  2512         10  NXTAUTOA PIC  X(0001).
  2513     05  NXTAUTOI PIC  X(0008).
  2514*    -------------------------------
  2515     05  ESTABDTL PIC S9(0004) COMP.
  2516     05  ESTABDTF PIC  X(0001).
  2517     05  FILLER REDEFINES ESTABDTF.
  2518         10  ESTABDTA PIC  X(0001).
  2519     05  ESTABDTI PIC  X(0008).
  2520*    -------------------------------
  2521     05  CRTSTADL PIC S9(0004) COMP.
  2522     05  CRTSTADF PIC  X(0001).
  2523     05  FILLER REDEFINES CRTSTADF.
  2524         10  CRTSTADA PIC  X(0001).
  2525     05  CRTSTADI PIC  X(0012).
  2526*    -------------------------------
  2527     05  CRTSTATL PIC S9(0004) COMP.
  2528     05  CRTSTATF PIC  X(0001).
  2529     05  FILLER REDEFINES CRTSTATF.
  2530         10  CRTSTATA PIC  X(0001).
  2531     05  CRTSTATI PIC  X(0010).
  2532*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL150.cbl
  2533     05  EFFECTL PIC S9(0004) COMP.
  2534     05  EFFECTF PIC  X(0001).
  2535     05  FILLER REDEFINES EFFECTF.
  2536         10  EFFECTA PIC  X(0001).
  2537     05  EFFECTI PIC  X(0008).
  2538*    -------------------------------
  2539     05  TOTINTL PIC S9(0004) COMP.
  2540     05  TOTINTF PIC  X(0001).
  2541     05  FILLER REDEFINES TOTINTF.
  2542         10  TOTINTA PIC  X(0001).
  2543     05  TOTINTI PIC  X(0010).
  2544*    -------------------------------
  2545     05  STATEL PIC S9(0004) COMP.
  2546     05  STATEF PIC  X(0001).
  2547     05  FILLER REDEFINES STATEF.
  2548         10  STATEA PIC  X(0001).
  2549     05  STATEI PIC  X(0003).
  2550*    -------------------------------
  2551     05  ACCTL PIC S9(0004) COMP.
  2552     05  ACCTF PIC  X(0001).
  2553     05  FILLER REDEFINES ACCTF.
  2554         10  ACCTA PIC  X(0001).
  2555     05  ACCTI PIC  X(0010).
  2556*    -------------------------------
  2557     05  EXPIREL PIC S9(0004) COMP.
  2558     05  EXPIREF PIC  X(0001).
  2559     05  FILLER REDEFINES EXPIREF.
  2560         10  EXPIREA PIC  X(0001).
  2561     05  EXPIREI PIC  X(0008).
  2562*    -------------------------------
  2563     05  BENECAPL PIC S9(0004) COMP.
  2564     05  BENECAPF PIC  X(0001).
  2565     05  FILLER REDEFINES BENECAPF.
  2566         10  BENECAPA PIC  X(0001).
  2567     05  BENECAPI PIC  X(0013).
  2568*    -------------------------------
  2569     05  BENEL PIC S9(0004) COMP.
  2570     05  BENEF PIC  X(0001).
  2571     05  FILLER REDEFINES BENEF.
  2572         10  BENEA PIC  X(0001).
  2573     05  BENEI PIC  X(0009).
  2574*    -------------------------------
  2575     05  TERMSL PIC S9(0004) COMP.
  2576     05  TERMSF PIC  X(0001).
  2577     05  FILLER REDEFINES TERMSF.
  2578         10  TERMSA PIC  X(0001).
  2579     05  TERMSI PIC  X(0013).
  2580*    -------------------------------
  2581     05  DIAGL PIC S9(0004) COMP.
  2582     05  DIAGF PIC  X(0001).
  2583     05  FILLER REDEFINES DIAGF.
  2584         10  DIAGA PIC  X(0001).
  2585     05  DIAGI PIC  X(0056).
  2586*    -------------------------------
  2587     05  FILETOL PIC S9(0004) COMP.
  2588     05  FILETOF PIC  X(0001).
  2589     05  FILLER REDEFINES FILETOF.
  2590         10  FILETOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL150.cbl
  2591     05  FILETOI PIC  X(0004).
  2592*    -------------------------------
  2593     05  PRTOPTL PIC S9(0004) COMP.
  2594     05  PRTOPTF PIC  X(0001).
  2595     05  FILLER REDEFINES PRTOPTF.
  2596         10  PRTOPTA PIC  X(0001).
  2597     05  PRTOPTI PIC  X(0001).
  2598*    -------------------------------
  2599     05  FORMATL PIC S9(0004) COMP.
  2600     05  FORMATF PIC  X(0001).
  2601     05  FILLER REDEFINES FORMATF.
  2602         10  FORMATA PIC  X(0001).
  2603     05  FORMATI PIC  X(0001).
  2604*    -------------------------------
  2605     05  ALTPRTL PIC S9(0004) COMP.
  2606     05  ALTPRTF PIC  X(0001).
  2607     05  FILLER REDEFINES ALTPRTF.
  2608         10  ALTPRTA PIC  X(0001).
  2609     05  ALTPRTI PIC  X(0004).
  2610*    -------------------------------
  2611     05  CLOANL PIC S9(0004) COMP.
  2612     05  CLOANF PIC  X(0001).
  2613     05  FILLER REDEFINES CLOANF.
  2614         10  CLOANA PIC  X(0001).
  2615     05  CLOANI PIC  X(0025).
  2616*    -------------------------------
  2617     05  DENTYPL PIC S9(0004) COMP.
  2618     05  DENTYPF PIC  X(0001).
  2619     05  FILLER REDEFINES DENTYPF.
  2620         10  DENTYPA PIC  X(0001).
  2621     05  DENTYPI PIC  X(0029).
  2622*    -------------------------------
  2623     05  ACTCDL PIC S9(0004) COMP.
  2624     05  ACTCDF PIC  X(0001).
  2625     05  FILLER REDEFINES ACTCDF.
  2626         10  ACTCDA PIC  X(0001).
  2627     05  ACTCDI PIC  99.
  2628*    -------------------------------
  2629     05  ACTDTL PIC S9(0004) COMP.
  2630     05  ACTDTF PIC  X(0001).
  2631     05  FILLER REDEFINES ACTDTF.
  2632         10  ACTDTA PIC  X(0001).
  2633     05  ACTDTI PIC  X(0008).
  2634*    -------------------------------
  2635     05  ACTTYPL PIC S9(0004) COMP.
  2636     05  ACTTYPF PIC  X(0001).
  2637     05  FILLER REDEFINES ACTTYPF.
  2638         10  ACTTYPA PIC  X(0001).
  2639     05  ACTTYPI PIC  X(0004).
  2640*    -------------------------------
  2641     05  ASSHDGL PIC S9(0004) COMP.
  2642     05  ASSHDGF PIC  X(0001).
  2643     05  FILLER REDEFINES ASSHDGF.
  2644         10  ASSHDGA PIC  X(0001).
  2645     05  ASSHDGI PIC  X(0006).
  2646*    -------------------------------
  2647     05  ASSOCL PIC S9(0004) COMP.
  2648     05  ASSOCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL150.cbl
  2649     05  FILLER REDEFINES ASSOCF.
  2650         10  ASSOCA PIC  X(0001).
  2651     05  ASSOCI PIC  X(0001).
  2652*    -------------------------------
  2653     05  TRLR1L PIC S9(0004) COMP.
  2654     05  TRLR1F PIC  X(0001).
  2655     05  FILLER REDEFINES TRLR1F.
  2656         10  TRLR1A PIC  X(0001).
  2657     05  TRLR1I PIC  X(0079).
  2658*    -------------------------------
  2659     05  TRLR2L PIC S9(0004) COMP.
  2660     05  TRLR2F PIC  X(0001).
  2661     05  FILLER REDEFINES TRLR2F.
  2662         10  TRLR2A PIC  X(0001).
  2663     05  TRLR2I PIC  X(0079).
  2664*    -------------------------------
  2665     05  TRLR3L PIC S9(0004) COMP.
  2666     05  TRLR3F PIC  X(0001).
  2667     05  FILLER REDEFINES TRLR3F.
  2668         10  TRLR3A PIC  X(0001).
  2669     05  TRLR3I PIC  X(0079).
  2670*    -------------------------------
  2671     05  TRLR4L PIC S9(0004) COMP.
  2672     05  TRLR4F PIC  X(0001).
  2673     05  FILLER REDEFINES TRLR4F.
  2674         10  TRLR4A PIC  X(0001).
  2675     05  TRLR4I PIC  X(0079).
  2676*    -------------------------------
  2677     05  ERRMSG1L PIC S9(0004) COMP.
  2678     05  ERRMSG1F PIC  X(0001).
  2679     05  FILLER REDEFINES ERRMSG1F.
  2680         10  ERRMSG1A PIC  X(0001).
  2681     05  ERRMSG1I PIC  X(0079).
  2682*    -------------------------------
  2683     05  ENTERPFL PIC S9(0004) COMP.
  2684     05  ENTERPFF PIC  X(0001).
  2685     05  FILLER REDEFINES ENTERPFF.
  2686         10  ENTERPFA PIC  X(0001).
  2687     05  ENTERPFI PIC  99.
  2688*    -------------------------------
  2689     05  PFKEY11L PIC S9(0004) COMP.
  2690     05  PFKEY11F PIC  X(0001).
  2691     05  FILLER REDEFINES PFKEY11F.
  2692         10  PFKEY11A PIC  X(0001).
  2693     05  PFKEY11I PIC  X(0017).
  2694 01  EL150AO REDEFINES EL150AI.
  2695     05  FILLER            PIC  X(0012).
  2696*    -------------------------------
  2697     05  FILLER            PIC  X(0003).
  2698     05  RUNDTEO PIC  X(0008).
  2699*    -------------------------------
  2700     05  FILLER            PIC  X(0003).
  2701     05  RUNTIMEO PIC  99.99.
  2702*    -------------------------------
  2703     05  FILLER            PIC  X(0003).
  2704     05  SEQUO PIC  X(0010).
  2705*    -------------------------------
  2706     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL150.cbl
  2707     05  CMPNYIDO PIC  X(0003).
  2708*    -------------------------------
  2709     05  FILLER            PIC  X(0003).
  2710     05  USERIDO PIC  X(0004).
  2711*    -------------------------------
  2712     05  FILLER            PIC  X(0003).
  2713     05  RETMSTO PIC  X(0015).
  2714*    -------------------------------
  2715     05  FILLER            PIC  X(0003).
  2716     05  CRDCARDO PIC  X(0016).
  2717*    -------------------------------
  2718     05  FILLER            PIC  X(0003).
  2719     05  CLMNOO PIC  X(0007).
  2720*    -------------------------------
  2721     05  FILLER            PIC  X(0003).
  2722     05  CARRO PIC  X(0001).
  2723*    -------------------------------
  2724     05  FILLER            PIC  X(0003).
  2725     05  CERTNOO PIC  X(0010).
  2726*    -------------------------------
  2727     05  FILLER            PIC  X(0003).
  2728     05  SUFXO PIC  X(0001).
  2729*    -------------------------------
  2730     05  FILLER            PIC  X(0003).
  2731     05  CLMTYPO PIC  X(0006).
  2732*    -------------------------------
  2733     05  FILLER            PIC  X(0003).
  2734     05  CLMSTATO PIC  X(0006).
  2735*    -------------------------------
  2736     05  FILLER            PIC  X(0003).
  2737     05  LSTNMEO PIC  X(0015).
  2738*    -------------------------------
  2739     05  FILLER            PIC  X(0003).
  2740     05  FSTNMEO PIC  X(0012).
  2741*    -------------------------------
  2742     05  FILLER            PIC  X(0003).
  2743     05  MINITO PIC  X(0001).
  2744*    -------------------------------
  2745     05  FILLER            PIC  X(0003).
  2746     05  PRIMHDGO PIC  X(0012).
  2747*    -------------------------------
  2748     05  FILLER            PIC  X(0003).
  2749     05  PRIMCRTO PIC  X(0010).
  2750*    -------------------------------
  2751     05  FILLER            PIC  X(0003).
  2752     05  PRIMSFXO PIC  X(0001).
  2753*    -------------------------------
  2754     05  FILLER            PIC  X(0003).
  2755     05  NOTIFYO PIC  X(0013).
  2756*    -------------------------------
  2757     05  FILLER            PIC  X(0003).
  2758     05  CLMTOTHO PIC  X(0027).
  2759*    -------------------------------
  2760     05  FILLER            PIC  X(0003).
  2761     05  AMTPDO PIC  X(0011).
  2762*    -------------------------------
  2763     05  FILLER            PIC  X(0003).
  2764     05  DAYSPDHO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL150.cbl
  2765*    -------------------------------
  2766     05  FILLER            PIC  X(0003).
  2767     05  DAYSPDO PIC  X(0005).
  2768*    -------------------------------
  2769     05  FILLER            PIC  X(0003).
  2770     05  YESNOSWO PIC  X(0001).
  2771*    -------------------------------
  2772     05  FILLER            PIC  X(0003).
  2773     05  PDTHRHDO PIC  X(0014).
  2774*    -------------------------------
  2775     05  FILLER            PIC  X(0003).
  2776     05  PDTHRUO PIC  X(0008).
  2777*    -------------------------------
  2778     05  FILLER            PIC  X(0003).
  2779     05  TOTPAIDO PIC  Z(6).99-.
  2780*    -------------------------------
  2781     05  FILLER            PIC  X(0003).
  2782     05  COVERDO PIC  X(0012).
  2783*    -------------------------------
  2784     05  FILLER            PIC  X(0003).
  2785     05  COVERO PIC  X(0010).
  2786*    -------------------------------
  2787     05  FILLER            PIC  X(0003).
  2788     05  INCURO PIC  X(0008).
  2789*    -------------------------------
  2790     05  FILLER            PIC  X(0003).
  2791     05  NOPMTSO PIC  X(0007).
  2792*    -------------------------------
  2793     05  FILLER            PIC  X(0003).
  2794     05  PRMTYPDO PIC  X(0012).
  2795*    -------------------------------
  2796     05  FILLER            PIC  X(0003).
  2797     05  PRMTYPEO PIC  X(0008).
  2798*    -------------------------------
  2799     05  FILLER            PIC  X(0003).
  2800     05  NXTAUTOO PIC  X(0008).
  2801*    -------------------------------
  2802     05  FILLER            PIC  X(0003).
  2803     05  ESTABDTO PIC  X(0008).
  2804*    -------------------------------
  2805     05  FILLER            PIC  X(0003).
  2806     05  CRTSTADO PIC  X(0012).
  2807*    -------------------------------
  2808     05  FILLER            PIC  X(0003).
  2809     05  CRTSTATO PIC  X(0010).
  2810*    -------------------------------
  2811     05  FILLER            PIC  X(0003).
  2812     05  EFFECTO PIC  X(0008).
  2813*    -------------------------------
  2814     05  FILLER            PIC  X(0003).
  2815     05  TOTINTO PIC  Z(6).99-.
  2816*    -------------------------------
  2817     05  FILLER            PIC  X(0003).
  2818     05  STATEO PIC  X(0003).
  2819*    -------------------------------
  2820     05  FILLER            PIC  X(0003).
  2821     05  ACCTO PIC  X(0010).
  2822*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL150.cbl
  2823     05  FILLER            PIC  X(0003).
  2824     05  EXPIREO PIC  X(0008).
  2825*    -------------------------------
  2826     05  FILLER            PIC  X(0003).
  2827     05  BENECAPO PIC  X(0013).
  2828*    -------------------------------
  2829     05  FILLER            PIC  X(0003).
  2830     05  BENEO PIC  Z(6).99.
  2831*    -------------------------------
  2832     05  FILLER            PIC  X(0003).
  2833     05  TERMSO PIC  X(0013).
  2834*    -------------------------------
  2835     05  FILLER            PIC  X(0003).
  2836     05  DIAGO PIC  X(0056).
  2837*    -------------------------------
  2838     05  FILLER            PIC  X(0003).
  2839     05  FILETOO PIC  X(0004).
  2840*    -------------------------------
  2841     05  FILLER            PIC  X(0003).
  2842     05  PRTOPTO PIC  X(0001).
  2843*    -------------------------------
  2844     05  FILLER            PIC  X(0003).
  2845     05  FORMATO PIC  X(0001).
  2846*    -------------------------------
  2847     05  FILLER            PIC  X(0003).
  2848     05  ALTPRTO PIC  X(0004).
  2849*    -------------------------------
  2850     05  FILLER            PIC  X(0003).
  2851     05  CLOANO PIC  X(0025).
  2852*    -------------------------------
  2853     05  FILLER            PIC  X(0003).
  2854     05  DENTYPO PIC  X(0029).
  2855*    -------------------------------
  2856     05  FILLER            PIC  X(0003).
  2857     05  ACTCDO PIC  X(0002).
  2858*    -------------------------------
  2859     05  FILLER            PIC  X(0003).
  2860     05  ACTDTO PIC  X(0008).
  2861*    -------------------------------
  2862     05  FILLER            PIC  X(0003).
  2863     05  ACTTYPO PIC  X(0004).
  2864*    -------------------------------
  2865     05  FILLER            PIC  X(0003).
  2866     05  ASSHDGO PIC  X(0006).
  2867*    -------------------------------
  2868     05  FILLER            PIC  X(0003).
  2869     05  ASSOCO PIC  X(0001).
  2870*    -------------------------------
  2871     05  FILLER            PIC  X(0003).
  2872     05  TRLR1O PIC  X(0079).
  2873*    -------------------------------
  2874     05  FILLER            PIC  X(0003).
  2875     05  TRLR2O PIC  X(0079).
  2876*    -------------------------------
  2877     05  FILLER            PIC  X(0003).
  2878     05  TRLR3O PIC  X(0079).
  2879*    -------------------------------
  2880     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL150.cbl
  2881     05  TRLR4O PIC  X(0079).
  2882*    -------------------------------
  2883     05  FILLER            PIC  X(0003).
  2884     05  ERRMSG1O PIC  X(0079).
  2885*    -------------------------------
  2886     05  FILLER            PIC  X(0003).
  2887     05  ENTERPFO PIC  X(0002).
  2888*    -------------------------------
  2889     05  FILLER            PIC  X(0003).
  2890     05  PFKEY11O PIC  X(0017).
  2891*    -------------------------------
  2892 01  EL150AI-R REDEFINES EL150AI.
  2893*    12  FILLER              PIC X(665).
  2894*    12  FILLER              PIC X(706).
  2895     12  FILLER              PIC X(738).
  2896     12  EL150AI-OCCURS         OCCURS 4 TIMES.
  2897         16  FILLER          PIC X(3).
  2898         16  MAP-DISPLAY     PIC X(79).
  2899     12  FILLER              PIC X(40).
  2900
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL150.cbl
  2902****************************************************************
  2903*
  2904* Copyright (c) 2007 by Clerity Solutions, Inc.
  2905* All rights reserved.
  2906*
  2907****************************************************************
  2908 01  DFHEIV.
  2909   02  DFHEIV0               PIC X(35).
  2910   02  DFHEIV1               PIC X(08).
  2911   02  DFHEIV2               PIC X(08).
  2912   02  DFHEIV3               PIC X(08).
  2913   02  DFHEIV4               PIC X(06).
  2914   02  DFHEIV5               PIC X(04).
  2915   02  DFHEIV6               PIC X(04).
  2916   02  DFHEIV7               PIC X(02).
  2917   02  DFHEIV8               PIC X(02).
  2918   02  DFHEIV9               PIC X(01).
  2919   02  DFHEIV10              PIC S9(7) COMP-3.
  2920   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2921   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2922   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2923   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2924   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2925   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2926   02  DFHEIV17              PIC X(04).
  2927   02  DFHEIV18              PIC X(04).
  2928   02  DFHEIV19              PIC X(04).
  2929   02  DFHEIV20              USAGE IS POINTER.
  2930   02  DFHEIV21              USAGE IS POINTER.
  2931   02  DFHEIV22              USAGE IS POINTER.
  2932   02  DFHEIV23              USAGE IS POINTER.
  2933   02  DFHEIV24              USAGE IS POINTER.
  2934   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2935   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2936   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2937   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2938   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2939   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2940   02  FILLER                PIC X(02).
  2941   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2942   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2943   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2944   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2945   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2946 LINKAGE  SECTION.
  2947*****************************************************************
  2948*                                                               *
  2949* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2950* All rights reserved.                                          *
  2951*                                                               *
  2952*****************************************************************
  2953 01  dfheiblk.
  2954     02  eibtime          pic s9(7) comp-3.
  2955     02  eibdate          pic s9(7) comp-3.
  2956     02  eibtrnid         pic x(4).
  2957     02  eibtaskn         pic s9(7) comp-3.
  2958     02  eibtrmid         pic x(4).
  2959     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL150.cbl
  2960     02  eibcposn         pic s9(4) comp.
  2961     02  eibcalen         pic s9(4) comp.
  2962     02  eibaid           pic x(1).
  2963     02  eibfiller1       pic x(1).
  2964     02  eibfn            pic x(2).
  2965     02  eibfiller2       pic x(2).
  2966     02  eibrcode         pic x(6).
  2967     02  eibfiller3       pic x(2).
  2968     02  eibds            pic x(8).
  2969     02  eibreqid         pic x(8).
  2970     02  eibrsrce         pic x(8).
  2971     02  eibsync          pic x(1).
  2972     02  eibfree          pic x(1).
  2973     02  eibrecv          pic x(1).
  2974     02  eibsend          pic x(1).
  2975     02  eibatt           pic x(1).
  2976     02  eibeoc           pic x(1).
  2977     02  eibfmh           pic x(1).
  2978     02  eibcompl         pic x(1).
  2979     02  eibsig           pic x(1).
  2980     02  eibconf          pic x(1).
  2981     02  eiberr           pic x(1).
  2982     02  eibrldbk         pic x(1).
  2983     02  eiberrcd         pic x(4).
  2984     02  eibsynrb         pic x(1).
  2985     02  eibnodat         pic x(1).
  2986     02  eibfiller5       pic x(2).
  2987     02  eibresp          pic 9(09) comp.
  2988     02  eibresp2         pic 9(09) comp.
  2989     02  dfheigdj         pic s9(4) comp.
  2990     02  dfheigdk         pic s9(4) comp.
  2991 01  DFHCOMMAREA             PIC X(1024).
  2992
  2993 01  CLAIM-MASTER-L          PIC X(350).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL150.cbl
  2995*                            COPY ELCCNTL.
  2996******************************************************************
  2997*                                                                *
  2998*                                                                *
  2999*                            ELCCNTL.                            *
  3000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3001*                            VMOD=2.059                          *
  3002*                                                                *
  3003*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3004*                                                                *
  3005*   FILE TYPE = VSAM,KSDS                                        *
  3006*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3007*                                                                *
  3008*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3009*       ALTERNATE INDEX = NONE                                   *
  3010*                                                                *
  3011*   LOG = YES                                                    *
  3012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3013******************************************************************
  3014*                   C H A N G E   L O G
  3015*
  3016* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3017*-----------------------------------------------------------------
  3018*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3019* EFFECTIVE    NUMBER
  3020*-----------------------------------------------------------------
  3021* 082503                   PEMA  ADD BENEFIT GROUP
  3022* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3023* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3024* 092705    2005050300006  PEMA  ADD SPP LEASES
  3025* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3026* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3027* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3028* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3029******************************************************************
  3030*
  3031 01  CONTROL-FILE.
  3032     12  CF-RECORD-ID                       PIC XX.
  3033         88  VALID-CF-ID                        VALUE 'CF'.
  3034
  3035     12  CF-CONTROL-PRIMARY.
  3036         16  CF-COMPANY-ID                  PIC XXX.
  3037         16  CF-RECORD-TYPE                 PIC X.
  3038             88  CF-COMPANY-MASTER              VALUE '1'.
  3039             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3040             88  CF-STATE-MASTER                VALUE '3'.
  3041             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3042             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3043             88  CF-CARRIER-MASTER              VALUE '6'.
  3044             88  CF-MORTALITY-MASTER            VALUE '7'.
  3045             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3046             88  CF-TERMINAL-MASTER             VALUE '9'.
  3047             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3048             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3049             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3050             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3051             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3052             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL150.cbl
  3053             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3054             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3055             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3056         16  CF-ACCESS-CD-GENL              PIC X(4).
  3057         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3058             20  CF-PROCESSOR               PIC X(4).
  3059         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3060             20  CF-STATE-CODE              PIC XX.
  3061             20  FILLER                     PIC XX.
  3062         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3063             20  FILLER                     PIC XX.
  3064             20  CF-HI-BEN-IN-REC           PIC XX.
  3065         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3066             20  FILLER                     PIC XXX.
  3067             20  CF-CARRIER-CNTL            PIC X.
  3068         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3069             20  FILLER                     PIC XX.
  3070             20  CF-HI-TYPE-IN-REC          PIC 99.
  3071         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3072             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3073                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3074             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3075             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3076         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3077             20  FILLER                     PIC X.
  3078             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3079         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3080             20  FILLER                     PIC XX.
  3081             20  CF-MORTGAGE-PLAN           PIC XX.
  3082         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3083
  3084     12  CF-LAST-MAINT-DT                   PIC XX.
  3085     12  CF-LAST-MAINT-BY                   PIC X(4).
  3086     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3087
  3088     12  CF-RECORD-BODY                     PIC X(728).
  3089
  3090
  3091****************************************************************
  3092*             COMPANY MASTER RECORD                            *
  3093****************************************************************
  3094
  3095     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3096         16  CF-COMPANY-ADDRESS.
  3097             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3098             20  CF-CL-IN-CARE-OF           PIC X(30).
  3099             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3100             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3101             20  CF-CL-CITY-STATE           PIC X(30).
  3102             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3103             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3104         16  CF-COMPANY-CD                  PIC X.
  3105         16  CF-COMPANY-PASSWORD            PIC X(8).
  3106         16  CF-SECURITY-OPTION             PIC X.
  3107             88  ALL-SECURITY                   VALUE '1'.
  3108             88  COMPANY-VERIFY                 VALUE '2'.
  3109             88  PROCESSOR-VERIFY               VALUE '3'.
  3110             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL150.cbl
  3111             88  ALL-BUT-TERM                   VALUE '5'.
  3112         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3113             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3114         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3115             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3116         16  CF-INFORCE-LOCATION            PIC X.
  3117             88  CERTS-ARE-ONLINE               VALUE '1'.
  3118             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3119             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3120         16  CF-LOWER-CASE-LETTERS          PIC X.
  3121         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3122             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3123             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3124             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3125             88  CF-ACCNT-CNTL                  VALUE '3'.
  3126             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3127
  3128         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3129         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3130
  3131         16  CF-LGX-CREDIT-USER             PIC X.
  3132             88  CO-IS-NOT-USER                 VALUE 'N'.
  3133             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3134
  3135         16 CF-CREDIT-CALC-CODES.
  3136             20  CF-CR-REM-TERM-CALC PIC X.
  3137               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3138               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3139               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3140               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3141               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3142               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3143               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3144             20  CF-CR-R78-METHOD           PIC X.
  3145               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3146               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3147
  3148         16  CF-CLAIM-CONTROL-COUNTS.
  3149             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3150                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3151
  3152             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3153                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3154
  3155             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3156                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3157
  3158             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3159                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3160
  3161         16  CF-CURRENT-MONTH-END           PIC XX.
  3162
  3163         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3164             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3165             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3166             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3167             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3168                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL150.cbl
  3169                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3170             20  CF-CO-PREM-REJECT-SW       PIC X.
  3171                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3172                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3173             20  CF-CO-REF-REJECT-SW        PIC X.
  3174                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3175                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3176
  3177         16  CF-CO-REPORTING-DT             PIC XX.
  3178         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3179         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3180           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3181           88  CF-CO-MONTH-END                  VALUE '1'.
  3182
  3183         16  CF-LGX-CLAIM-USER              PIC X.
  3184             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3185             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3186
  3187         16  CF-CREDIT-EDIT-CONTROLS.
  3188             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3189             20  CF-MIN-AGE                 PIC 99.
  3190             20  CF-DEFAULT-AGE             PIC 99.
  3191             20  CF-MIN-TERM                PIC S999      COMP-3.
  3192             20  CF-MAX-TERM                PIC S999      COMP-3.
  3193             20  CF-DEFAULT-SEX             PIC X.
  3194             20  CF-JOINT-AGE-INPUT         PIC X.
  3195                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3196             20  CF-BIRTH-DATE-INPUT        PIC X.
  3197                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3198             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3199                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3200                 88  CF-ZERO-CARRIER            VALUE '1'.
  3201                 88  CF-ZERO-GROUPING           VALUE '2'.
  3202                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3203             20  CF-EDIT-SW                 PIC X.
  3204                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3205             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3206             20  CF-CR-PR-METHOD            PIC X.
  3207               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3208               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3209             20  FILLER                     PIC X.
  3210
  3211         16  CF-CREDIT-MISC-CONTROLS.
  3212             20  CF-REIN-TABLE-SW           PIC X.
  3213                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3214             20  CF-COMP-TABLE-SW           PIC X.
  3215                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3216             20  CF-EXPERIENCE-RETENTION-AGE
  3217                                            PIC S9        COMP-3.
  3218             20  CF-CONVERSION-DT           PIC XX.
  3219             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3220             20  CF-RUN-FREQUENCY-SW        PIC X.
  3221                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3222                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3223
  3224             20  CF-CR-CHECK-NO-CONTROL.
  3225                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3226                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL150.cbl
  3227                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3228                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3229                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3230                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3231
  3232                 24  CF-CR-CHECK-COUNT       REDEFINES
  3233                     CF-CR-CHECK-COUNTER      PIC X(4).
  3234
  3235                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3236                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3237
  3238                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3239                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3240                 24  CF-MAIL-PROCESSING       PIC X.
  3241                     88  MAIL-PROCESSING          VALUE 'Y'.
  3242
  3243         16  CF-MISC-SYSTEM-CONTROL.
  3244             20  CF-SYSTEM-C                 PIC X.
  3245                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3246             20  CF-SYSTEM-D                 PIC X.
  3247                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3248             20  CF-SOC-SEC-NO-SW            PIC X.
  3249                 88  SOC-SEC-NO-USED             VALUE '1'.
  3250             20  CF-MEMBER-NO-SW             PIC X.
  3251                 88  MEMBER-NO-USED              VALUE '1'.
  3252             20  CF-TAX-ID-NUMBER            PIC X(11).
  3253             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3254             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3255                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3256                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3257                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3258                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3259             20  CF-SYSTEM-E                 PIC X.
  3260                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3261
  3262         16  CF-LGX-LIFE-USER               PIC X.
  3263             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3264             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3265
  3266         16  CF-CR-MONTH-END-DT             PIC XX.
  3267
  3268         16  CF-FILE-MAINT-DATES.
  3269             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3270                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3271             20  CF-LAST-BATCH       REDEFINES
  3272                 CF-LAST-BATCH-NO               PIC X(4).
  3273             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3274             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3275             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3276             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3277             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3278             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3279             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3280             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3281             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3282             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3283
  3284         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL150.cbl
  3285         16  FILLER                         PIC X.
  3286
  3287         16  CF-ALT-MORT-CODE               PIC X(4).
  3288         16  CF-MEMBER-CAPTION              PIC X(10).
  3289
  3290         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3291             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3292             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3293             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3294             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3295             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3296
  3297         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3298
  3299         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3300         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3301         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3302         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3303
  3304         16  CF-AH-OVERRIDE-L1              PIC X.
  3305         16  CF-AH-OVERRIDE-L2              PIC XX.
  3306         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3307         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3308
  3309         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3310         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3311
  3312         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3313         16  CF-AR-LAST-EL860-DT            PIC XX.
  3314         16  CF-MP-MONTH-END-DT             PIC XX.
  3315
  3316         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3317         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3318             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3319
  3320         16  CF-AR-MONTH-END-DT             PIC XX.
  3321
  3322         16  CF-CRDTCRD-USER                PIC X.
  3323             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3324             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3325
  3326         16  CF-CC-MONTH-END-DT             PIC XX.
  3327
  3328         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3329
  3330         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3331             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3332             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3333             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3334         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3335         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3336         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3337         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3338             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3339             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3340         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3341         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3342         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL150.cbl
  3343             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3344         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3345
  3346         16  CF-CL-ZIP-CODE.
  3347             20  CF-CL-ZIP-PRIME.
  3348                 24  CF-CL-ZIP-1ST          PIC X.
  3349                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3350                 24  FILLER                 PIC X(4).
  3351             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3352         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3353             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3354             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3355             20  FILLER                     PIC XXX.
  3356
  3357         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3358         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3359         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3360         16  CF-CO-OPTION-START-DATE        PIC XX.
  3361         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3362           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3363                                                      '3' '4'.
  3364           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3365           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3366           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3367           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3368           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3369           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3370
  3371         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3372
  3373         16  CF-PAYMENT-APPROVAL-LEVELS.
  3374             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3375             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3376             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3377             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3378             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3379             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3380
  3381         16  CF-END-USER-REPORTING-USER     PIC X.
  3382             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3383             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3384
  3385         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3386             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3387             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3388
  3389         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3390
  3391         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3392         16  FILLER                         PIC X.
  3393
  3394         16  CF-CREDIT-ARCHIVE-CNTL.
  3395             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3396             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3397             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3398
  3399         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3400
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL150.cbl
  3401         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3402             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3403             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3404
  3405         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3406             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3407             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3408
  3409         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3410
  3411         16  CF-CO-ACH-ID-CODE              PIC  X.
  3412             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3413             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3414             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3415         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3416         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3417         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3418         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3419         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3420         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3421         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3422         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3423         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3424                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3425         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3426                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3427
  3428         16  CF-CO-OVER-SHORT.
  3429             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3430             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3431
  3432*         16  FILLER                         PIC X(102).
  3433         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3434             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3435             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3436
  3437         16  CF-AH-APPROVAL-DAYS.
  3438             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3439             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3440             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3441             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3442
  3443         16  FILLER                         PIC X(82).
  3444****************************************************************
  3445*             PROCESSOR/USER RECORD                            *
  3446****************************************************************
  3447
  3448     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3449         16  CF-PROCESSOR-NAME              PIC X(30).
  3450         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3451         16  CF-PROCESSOR-TITLE             PIC X(26).
  3452         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3453                 88  MESSAGE-YES                VALUE 'Y'.
  3454                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3455
  3456*****************************************************
  3457****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3458****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL150.cbl
  3459****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3460****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3461*****************************************************
  3462
  3463         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3464             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3465             20  CF-APPLICATION-FORCE       PIC X.
  3466             20  CF-INDIVIDUAL-APP.
  3467                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3468                     28  CF-BROWSE-APP      PIC X.
  3469                     28  CF-UPDATE-APP      PIC X.
  3470
  3471         16  CF-CURRENT-TERM-ON             PIC X(4).
  3472         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3473             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3474             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3475             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3476             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3477             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3478             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3479             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3480         16  CF-PROCESSOR-CARRIER           PIC X.
  3481             88  NO-CARRIER-SECURITY            VALUE ' '.
  3482         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3483             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3484         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3485             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3486         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3487             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3488
  3489         16  CF-PROC-SYS-ACCESS-SW.
  3490             20  CF-PROC-CREDIT-CLAIMS-SW.
  3491                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3492                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3493                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3494                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3495             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3496                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3497                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3498             20  CF-PROC-LIFE-GNRLDGR-SW.
  3499                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3500                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3501                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3502                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3503             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3504                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3505                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3506         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3507             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3508             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3509         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3510
  3511         16  CF-APPROVAL-LEVEL                  PIC X.
  3512             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3513             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3514             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3515             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3516
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL150.cbl
  3517         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3518
  3519         16  CF-LANGUAGE-TYPE                   PIC X.
  3520             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3521             88  CF-LANG-IS-FR                      VALUE 'F'.
  3522         16  FILLER                             PIC  X(240).
  3523
  3524****************************************************************
  3525*             PROCESSOR/REMINDERS RECORD                       *
  3526****************************************************************
  3527
  3528     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3529         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3530             20  CF-START-REMIND-DT         PIC XX.
  3531             20  CF-END-REMIND-DT           PIC XX.
  3532             20  CF-REMINDER-TEXT           PIC X(50).
  3533         16  FILLER                         PIC X(296).
  3534
  3535
  3536****************************************************************
  3537*             STATE MASTER RECORD                              *
  3538****************************************************************
  3539
  3540     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3541         16  CF-STATE-ABBREVIATION          PIC XX.
  3542         16  CF-STATE-NAME                  PIC X(25).
  3543         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3544         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3545             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3546             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3547             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3548             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3549                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3550                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3551             20  CF-ST-PREM-REJECT-SW       PIC X.
  3552                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3553                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3554             20  CF-ST-REF-REJECT-SW        PIC X.
  3555                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3556                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3557         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3558         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3559         16  CF-ST-REFUND-RULES.
  3560             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3561             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3562             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3563         16  CF-ST-FST-PMT-EXTENSION.
  3564             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3565             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3566                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3567                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3568                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3569                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3570         16  CF-ST-STATE-CALL.
  3571             20  CF-ST-CALL-UNEARNED        PIC X.
  3572             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3573             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3574         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL150.cbl
  3575             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3576             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3577         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3578         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3579         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3580         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3581         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3582         16  FILLER                         PIC X.
  3583         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3584             20  CF-ST-BENEFIT-CD           PIC XX.
  3585             20  CF-ST-BENEFIT-KIND         PIC X.
  3586                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3587                 88  CF-ST-AH-KIND              VALUE 'A'.
  3588             20  CF-ST-REM-TERM-CALC        PIC X.
  3589                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3590                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3591                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3592                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3593                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3594                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3595                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3596                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3597
  3598             20  CF-ST-REFUND-CALC          PIC X.
  3599                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3600                 88  ST-REFD-BY-R78             VALUE '1'.
  3601                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3602                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3603                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3604                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3605                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3606                 88  ST-REFD-UTAH               VALUE '7'.
  3607                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3608                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3609                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3610
  3611             20  CF-ST-EARNING-CALC         PIC X.
  3612                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3613                 88  ST-EARN-BY-R78             VALUE '1'.
  3614                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3615                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3616                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3617                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3618                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3619                 88  ST-EARN-MEAN               VALUE '8'.
  3620                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3621
  3622             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3623                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3624                 88  ST-OVRD-BY-R78             VALUE '1'.
  3625                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3626                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3627                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3628                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3629                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3630                 88  ST-OVRD-MEAN               VALUE '8'.
  3631                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3632             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL150.cbl
  3633
  3634         16  CF-ST-COMMISSION-CAPS.
  3635             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3636             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3637             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3638             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3639         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3640                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3641
  3642         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3643
  3644         16  CF-ST-STATUTORY-INTEREST.
  3645             20  CF-ST-STAT-DATE-FROM       PIC X.
  3646                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3647                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3648             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3649             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3650             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3651             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3652             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3653
  3654         16  CF-ST-OVER-SHORT.
  3655             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3656             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3657
  3658         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3659
  3660         16  CF-ST-RT-CALC                  PIC X.
  3661
  3662         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3663         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3664         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3665         16  CF-ST-RF-LR-CALC               PIC X.
  3666         16  CF-ST-RF-LL-CALC               PIC X.
  3667         16  CF-ST-RF-LN-CALC               PIC X.
  3668         16  CF-ST-RF-AH-CALC               PIC X.
  3669         16  CF-ST-RF-CP-CALC               PIC X.
  3670*        16  FILLER                         PIC X(206).
  3671*CIDMOD         16  FILLER                         PIC X(192).
  3672         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3673             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3674         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3675         16  FILLER                         PIC X(187).
  3676
  3677****************************************************************
  3678*             BENEFIT MASTER RECORD                            *
  3679****************************************************************
  3680
  3681     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3682         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3683             20  CF-BENEFIT-CODE            PIC XX.
  3684             20  CF-BENEFIT-NUMERIC  REDEFINES
  3685                 CF-BENEFIT-CODE            PIC XX.
  3686             20  CF-BENEFIT-ALPHA           PIC XXX.
  3687             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3688             20  CF-BENEFIT-COMMENT         PIC X(10).
  3689
  3690             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL150.cbl
  3691                 88  CF-REDUCING                VALUE 'R'.
  3692                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3693
  3694             20  CF-SPECIAL-CALC-CD         PIC X.
  3695                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3696                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3697                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3698                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3699                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3700                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3701                 88  CF-FARM-PLAN               VALUE 'F'.
  3702                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3703                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3704                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3705                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3706                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3707                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3708                 88  CF-PRUDENTIAL              VALUE 'P'.
  3709                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3710                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3711                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3712                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3713                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3714                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3715
  3716             20  CF-JOINT-INDICATOR         PIC X.
  3717                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3718
  3719*            20  FILLER                     PIC X(12).
  3720             20  FILLER                     PIC X(11).
  3721             20  CF-BENEFIT-CATEGORY        PIC X.
  3722             20  CF-LOAN-TYPE               PIC X(8).
  3723
  3724             20  CF-CO-REM-TERM-CALC        PIC X.
  3725                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3726                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3727                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3728                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3729                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3730
  3731             20  CF-CO-EARNINGS-CALC        PIC X.
  3732                 88  CO-EARN-BY-R78             VALUE '1'.
  3733                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3734                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3735                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3736                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3737                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3738                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3739                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3740
  3741             20  CF-CO-REFUND-CALC          PIC X.
  3742                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3743                 88  CO-REFD-BY-R78             VALUE '1'.
  3744                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3745                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3746                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3747                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3748                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL150.cbl
  3749                 88  CO-REFD-MEAN               VALUE '8'.
  3750                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3751                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3752                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3753
  3754             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3755                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3756                 88  CO-OVRD-BY-R78             VALUE '1'.
  3757                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3758                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3759                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3760                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3761                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3762                 88  CO-OVRD-MEAN               VALUE '8'.
  3763                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3764
  3765             20  CF-CO-BEN-I-G-CD           PIC X.
  3766                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3767                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3768                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3769
  3770         16  FILLER                         PIC X(304).
  3771
  3772
  3773****************************************************************
  3774*             CARRIER MASTER RECORD                            *
  3775****************************************************************
  3776
  3777     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3778         16  CF-ADDRESS-DATA.
  3779             20  CF-MAIL-TO-NAME            PIC X(30).
  3780             20  CF-IN-CARE-OF              PIC X(30).
  3781             20  CF-ADDRESS-LINE-1          PIC X(30).
  3782             20  CF-ADDRESS-LINE-2          PIC X(30).
  3783             20  CF-CITY-STATE              PIC X(30).
  3784             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3785             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3786
  3787         16  CF-CLAIM-NO-CONTROL.
  3788             20  CF-CLAIM-NO-METHOD         PIC X.
  3789                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3790                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3791                 88  CLAIM-NO-SEQ               VALUE '3'.
  3792                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3793             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3794                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3795                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3796                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3797
  3798         16  CF-CHECK-NO-CONTROL.
  3799             20  CF-CHECK-NO-METHOD         PIC X.
  3800                 88  CHECK-NO-MANUAL            VALUE '1'.
  3801                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3802                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3803                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3804             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3805                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3806
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL150.cbl
  3807         16  CF-DOMICILE-STATE              PIC XX.
  3808
  3809         16  CF-EXPENSE-CONTROLS.
  3810             20  CF-EXPENSE-METHOD          PIC X.
  3811                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3812                 88  DOLLARS-PER-PMT            VALUE '2'.
  3813                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3814                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3815             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3816             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3817
  3818         16  CF-CORRESPONDENCE-CONTROL.
  3819             20  CF-LETTER-RESEND-OPT       PIC X.
  3820                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3821                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3822             20  FILLER                     PIC X(4).
  3823
  3824         16  CF-RESERVE-CONTROLS.
  3825             20  CF-MANUAL-SW               PIC X.
  3826                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3827             20  CF-FUTURE-SW               PIC X.
  3828                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3829             20  CF-PTC-SW                  PIC X.
  3830                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3831             20  CF-IBNR-SW                 PIC X.
  3832                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3833             20  CF-PTC-LF-SW               PIC X.
  3834                 88  CF-LF-PTC-USED             VALUE '1'.
  3835             20  CF-CDT-ACCESS-METHOD       PIC X.
  3836                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3837                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3838                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3839             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3840
  3841         16  CF-CLAIM-CALC-METHOD           PIC X.
  3842             88  360-PLUS-MONTHS                VALUE '1'.
  3843             88  365-PLUS-MONTHS                VALUE '2'.
  3844             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3845             88  360-DAILY                      VALUE '4'.
  3846             88  365-DAILY                      VALUE '5'.
  3847
  3848         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3849         16  FILLER                         PIC X(11).
  3850
  3851         16  CF-LIMIT-AMOUNTS.
  3852             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3853             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3854             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3855             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3856             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3857             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3858             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3859             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3860             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3861             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3862
  3863         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3864         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL150.cbl
  3865         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3866
  3867         16  CF-ZIP-CODE.
  3868             20  CF-ZIP-PRIME.
  3869                 24  CF-ZIP-1ST             PIC X.
  3870                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3871                 24  FILLER                 PIC X(4).
  3872             20  CF-ZIP-PLUS4               PIC X(4).
  3873         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3874             20  CF-CAN-POSTAL-1            PIC XXX.
  3875             20  CF-CAN-POSTAL-2            PIC XXX.
  3876             20  FILLER                     PIC XXX.
  3877
  3878         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3879         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3880         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3881
  3882         16  CF-RATING-SWITCH               PIC X.
  3883             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3884             88  CF-NO-RATING                   VALUE 'N'.
  3885
  3886         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3887
  3888         16  CF-CARRIER-OVER-SHORT.
  3889             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3890             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3891
  3892         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3893         16  CF-SECPAY-SWITCH               PIC X.
  3894             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3895             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3896         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3897         16  FILLER                         PIC X(448).
  3898*        16  FILLER                         PIC X(452).
  3899
  3900
  3901****************************************************************
  3902*             MORTALITY MASTER RECORD                          *
  3903****************************************************************
  3904
  3905     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3906         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3907                                INDEXED BY CF-MORT-NDX.
  3908             20  CF-MORT-TABLE              PIC X(5).
  3909             20  CF-MORT-TABLE-TYPE         PIC X.
  3910                 88  CF-MORT-JOINT              VALUE 'J'.
  3911                 88  CF-MORT-SINGLE             VALUE 'S'.
  3912                 88  CF-MORT-COMBINED           VALUE 'C'.
  3913                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3914                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3915             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3916             20  CF-MORT-AGE-METHOD         PIC XX.
  3917                 88  CF-AGE-LAST                VALUE 'AL'.
  3918                 88  CF-AGE-NEAR                VALUE 'AN'.
  3919             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3920             20  CF-MORT-ADJUSTMENT-DIRECTION
  3921                                            PIC X.
  3922                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL150.cbl
  3923                 88  CF-PLUS                    VALUE '+'.
  3924             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3925             20  CF-MORT-JOINT-CODE         PIC X.
  3926                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3927             20  CF-MORT-PC-Q               PIC X.
  3928                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3929             20  CF-MORT-TABLE-CODE         PIC X(4).
  3930             20  CF-MORT-COMMENTS           PIC X(15).
  3931             20  FILLER                     PIC X(14).
  3932
  3933         16  FILLER                         PIC X(251).
  3934
  3935
  3936****************************************************************
  3937*             BUSSINESS TYPE MASTER RECORD                     *
  3938****************************************************************
  3939
  3940     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3941* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3942* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3943* AND RECORD 05 IS TYPES 81-99
  3944         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3945             20  CF-BUSINESS-TITLE          PIC  X(19).
  3946             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3947                                            PIC S9V9(4) COMP-3.
  3948             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3949             20  FILLER                     PIC  X.
  3950         16  FILLER                         PIC  X(248).
  3951
  3952
  3953****************************************************************
  3954*             TERMINAL MASTER RECORD                           *
  3955****************************************************************
  3956
  3957     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3958
  3959         16  CF-COMPANY-TERMINALS.
  3960             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3961                                  PIC X(4).
  3962         16  FILLER               PIC X(248).
  3963
  3964
  3965****************************************************************
  3966*             LIFE EDIT MASTER RECORD                          *
  3967****************************************************************
  3968
  3969     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3970         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3971             20  CF-LIFE-CODE-IN            PIC XX.
  3972             20  CF-LIFE-CODE-OUT           PIC XX.
  3973         16  FILLER                         PIC X(248).
  3974
  3975
  3976****************************************************************
  3977*             AH EDIT MASTER RECORD                            *
  3978****************************************************************
  3979
  3980     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL150.cbl
  3981         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3982             20  CF-AH-CODE-IN              PIC XXX.
  3983             20  CF-AH-CODE-OUT             PIC XX.
  3984         16  FILLER                         PIC X(248).
  3985
  3986
  3987****************************************************************
  3988*             CREDIBILITY TABLES                               *
  3989****************************************************************
  3990
  3991     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3992         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3993                             INDEXED BY CF-CRDB-NDX.
  3994             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3995             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3996             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3997         16  FILLER                         PIC  X(332).
  3998
  3999
  4000****************************************************************
  4001*             REPORT CUSTOMIZATION RECORD                      *
  4002****************************************************************
  4003
  4004     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4005         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4006             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4007             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4008             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4009**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4010****       A T-TRANSFER.                                   ****
  4011             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4012
  4013         16  FILLER                         PIC XX.
  4014
  4015         16  CF-CARRIER-CNTL-OPT.
  4016             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4017                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4018                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4019             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4020                                            PIC X.
  4021         16  CF-GROUP-CNTL-OPT.
  4022             20  CF-GROUP-OPT-SEQ           PIC 9.
  4023                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4024                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4025             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4026                                            PIC X(6).
  4027         16  CF-STATE-CNTL-OPT.
  4028             20  CF-STATE-OPT-SEQ           PIC 9.
  4029                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4030                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4031             20  CF-STATE-SELECT OCCURS 3 TIMES
  4032                                            PIC XX.
  4033         16  CF-ACCOUNT-CNTL-OPT.
  4034             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4035                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4036                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4037             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4038                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL150.cbl
  4039         16  CF-BUS-TYP-CNTL-OPT.
  4040             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4041                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4042                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4043             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4044                                            PIC XX.
  4045         16  CF-LF-TYP-CNTL-OPT.
  4046             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4047                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4048                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4049             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4050                                            PIC XX.
  4051         16  CF-AH-TYP-CNTL-OPT.
  4052             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4053                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4054                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4055             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4056                                            PIC XX.
  4057         16  CF-REPTCD1-CNTL-OPT.
  4058             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4059                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4060                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4061             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4062                                            PIC X(10).
  4063         16  CF-REPTCD2-CNTL-OPT.
  4064             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4065                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4066                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4067             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4068                                            PIC X(10).
  4069         16  CF-USER1-CNTL-OPT.
  4070             20  CF-USER1-OPT-SEQ           PIC 9.
  4071                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4072                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4073             20  CF-USER1-SELECT OCCURS 3 TIMES
  4074                                            PIC X(10).
  4075         16  CF-USER2-CNTL-OPT.
  4076             20  CF-USER2-OPT-SEQ           PIC 9.
  4077                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4078                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4079             20  CF-USER2-SELECT OCCURS 3 TIMES
  4080                                            PIC X(10).
  4081         16  CF-USER3-CNTL-OPT.
  4082             20  CF-USER3-OPT-SEQ           PIC 9.
  4083                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4084                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4085             20  CF-USER3-SELECT OCCURS 3 TIMES
  4086                                            PIC X(10).
  4087         16  CF-USER4-CNTL-OPT.
  4088             20  CF-USER4-OPT-SEQ           PIC 9.
  4089                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4090                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4091             20  CF-USER4-SELECT OCCURS 3 TIMES
  4092                                            PIC X(10).
  4093         16  CF-USER5-CNTL-OPT.
  4094             20  CF-USER5-OPT-SEQ           PIC 9.
  4095                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4096                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL150.cbl
  4097             20  CF-USER5-SELECT OCCURS 3 TIMES
  4098                                            PIC X(10).
  4099         16  CF-REINS-CNTL-OPT.
  4100             20  CF-REINS-OPT-SEQ           PIC 9.
  4101                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4102                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4103             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4104                 24  CF-REINS-PRIME         PIC XXX.
  4105                 24  CF-REINS-SUB           PIC XXX.
  4106
  4107         16  CF-AGENT-CNTL-OPT.
  4108             20  CF-AGENT-OPT-SEQ           PIC 9.
  4109                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4110                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4111             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4112                                            PIC X(10).
  4113
  4114         16  FILLER                         PIC X(43).
  4115
  4116         16  CF-LOSS-RATIO-SELECT.
  4117             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4118             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4119         16  CF-ENTRY-DATE-SELECT.
  4120             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4121             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4122         16  CF-EFFECTIVE-DATE-SELECT.
  4123             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4124             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4125
  4126         16  CF-EXCEPTION-LIST-IND          PIC X.
  4127             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4128
  4129         16  FILLER                         PIC X(318).
  4130
  4131****************************************************************
  4132*                  EXCEPTION REPORTING RECORD                  *
  4133****************************************************************
  4134
  4135     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4136         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4137             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4138
  4139         16  CF-COMBINED-LIFE-AH-OPT.
  4140             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4141             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4142             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4143             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4144
  4145         16  CF-LIFE-OPT.
  4146             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4147             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4148             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4149             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4150             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4151             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4152             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4153             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4154             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL150.cbl
  4155             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4156
  4157         16  CF-AH-OPT.
  4158             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4159             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4160             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4161             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4162             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4163             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4164             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4165             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4166             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4167             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4168
  4169         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4170             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4171             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4172             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4173
  4174         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4175
  4176         16  FILLER                         PIC X(673).
  4177
  4178
  4179****************************************************************
  4180*             MORTGAGE SYSTEM PLAN RECORD                      *
  4181****************************************************************
  4182
  4183     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4184         16  CF-PLAN-TYPE                   PIC X.
  4185             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4186             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4187             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4188         16  CF-PLAN-ABBREV                 PIC XXX.
  4189         16  CF-PLAN-DESCRIPT               PIC X(10).
  4190         16  CF-PLAN-NOTES                  PIC X(20).
  4191         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4192         16  CF-PLAN-UNDERWRITING.
  4193             20  CF-PLAN-TERM-DATA.
  4194                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4195                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4196             20  CF-PLAN-AGE-DATA.
  4197                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4198                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4199                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4200             20  CF-PLAN-BENEFIT-DATA.
  4201                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4202                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4203                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4204                                            PIC S9(7)V99  COMP-3.
  4205         16  CF-PLAN-POLICY-FORMS.
  4206             20  CF-POLICY-FORM             PIC X(12).
  4207             20  CF-MASTER-APPLICATION      PIC X(12).
  4208             20  CF-MASTER-POLICY           PIC X(12).
  4209         16  CF-PLAN-RATING.
  4210             20  CF-RATE-CODE               PIC X(5).
  4211             20  CF-SEX-RATING              PIC X.
  4212                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL150.cbl
  4213                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4214             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4215             20  CF-SUB-STD-TYPE            PIC X.
  4216                 88  CF-PCT-OF-PREM            VALUE '1'.
  4217                 88  CF-PCT-OF-BENE            VALUE '2'.
  4218         16  CF-PLAN-PREM-TOLERANCES.
  4219             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4220             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4221         16  CF-PLAN-PYMT-TOLERANCES.
  4222             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4223             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4224         16  CF-PLAN-MISC-DATA.
  4225             20  FILLER                     PIC X.
  4226             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4227             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4228         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4229         16  CF-PLAN-IND-GRP                PIC X.
  4230             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4231                                                     '1'.
  4232             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4233                                                     '2'.
  4234         16  CF-MIB-SEARCH-SW               PIC X.
  4235             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4236             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4237             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4238             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4239         16  CF-ALPHA-SEARCH-SW             PIC X.
  4240             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4241             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4242             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4243             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4244             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4245             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4246             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4247             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4248             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4249             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4250                                                     'A' 'B' 'C'
  4251                                                     'X' 'Y' 'Z'.
  4252         16  CF-EFF-DT-RULE-SW              PIC X.
  4253             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4254             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4255             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4256             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4257             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4258         16  FILLER                         PIC X(4).
  4259         16  CF-HEALTH-QUESTIONS            PIC X.
  4260             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4261         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4262         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4263         16  CF-PLAN-SNGL-JNT               PIC X.
  4264             88  CF-COMBINED-PLAN              VALUE 'C'.
  4265             88  CF-JNT-PLAN                   VALUE 'J'.
  4266             88  CF-SNGL-PLAN                  VALUE 'S'.
  4267         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4268         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4269         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4270         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL150.cbl
  4271         16  CF-RERATE-CNTL                 PIC  X.
  4272             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4273             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4274             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4275             88  CF-AUTO-RECALC                 VALUE '4'.
  4276         16  CF-BENEFIT-TYPE                PIC  X.
  4277             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4278             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4279         16  CF-POLICY-FEE                  PIC S999V99
  4280                                                    COMP-3.
  4281         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4282         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4283         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4284         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4285         16  FILLER                         PIC  X(32).
  4286         16  CF-TERMINATION-FORM            PIC  X(04).
  4287         16  FILLER                         PIC  X(08).
  4288         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4289                                                       COMP-3.
  4290         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4291         16  CF-ISSUE-LETTER                PIC  X(4).
  4292         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4293         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4294             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4295             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4296         16  CF-MP-REFUND-CALC              PIC X.
  4297             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4298             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4299             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4300             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4301             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4302             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4303             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4304             88  CF-MP-REFD-MEAN                VALUE '8'.
  4305         16  CF-ALT-RATE-CODE               PIC  X(5).
  4306
  4307
  4308         16  FILLER                         PIC X(498).
  4309****************************************************************
  4310*             MORTGAGE COMPANY MASTER RECORD                   *
  4311****************************************************************
  4312
  4313     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4314         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4315         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4316             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4317             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4318             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4319             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4320             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4321
  4322         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4323         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4324         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4325         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4326         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4327
  4328         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL150.cbl
  4329             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4330         16  CF-MP-RECON-USE-IND            PIC X(1).
  4331             88  CF-MP-USE-RECON             VALUE 'Y'.
  4332         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4333             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4334         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4335             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4336             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4337         16  FILLER                         PIC X(1).
  4338         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4339             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4340         16  CF-MORTG-MIB-VERSION           PIC X.
  4341             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4342             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4343             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4344         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4345             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4346                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4347             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4348                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4349             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4350                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4351             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4352                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4353             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4354                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4355             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4356                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4357         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4358         16  FILLER                         PIC X(7).
  4359         16  CF-MORTG-DESTINATION-SYMBOL.
  4360             20  CF-MORTG-MIB-COMM          PIC X(5).
  4361             20  CF-MORTG-MIB-TERM          PIC X(5).
  4362         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4363             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4364         16  FILLER                         PIC X(03).
  4365         16  CF-MP-CHECK-NO-CONTROL.
  4366             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4367                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4368                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4369                                                ' ' LOW-VALUES.
  4370                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4371                                               VALUE '3'.
  4372         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4373         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4374         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4375             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4376                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4377             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4378                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4379             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4380                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4381             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4382                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4383             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4384                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4385             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4386                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL150.cbl
  4387         16  CF-MORTG-BILLING-AREA.
  4388             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4389                                            PIC X.
  4390         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4391         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4392         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4393         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4394             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4395             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4396         16  FILLER                         PIC X.
  4397         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4398             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4399             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4400         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4401         16  FILLER                         PIC X(8).
  4402         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4403         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4404         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4405         16  CF-ACH-COMPANY-ID.
  4406             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4407                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4408                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4409                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4410             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4411         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4412             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4413         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4414             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4415             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4416         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4417         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4418         16  FILLER                         PIC X(536).
  4419
  4420****************************************************************
  4421*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4422****************************************************************
  4423
  4424     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4425         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4426             20  CF-FEMALE-HEIGHT.
  4427                 24  CF-FEMALE-FT           PIC 99.
  4428                 24  CF-FEMALE-IN           PIC 99.
  4429             20  CF-FEMALE-MIN-WT           PIC 999.
  4430             20  CF-FEMALE-MAX-WT           PIC 999.
  4431         16  FILLER                         PIC X(428).
  4432
  4433     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4434         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4435             20  CF-MALE-HEIGHT.
  4436                 24  CF-MALE-FT             PIC 99.
  4437                 24  CF-MALE-IN             PIC 99.
  4438             20  CF-MALE-MIN-WT             PIC 999.
  4439             20  CF-MALE-MAX-WT             PIC 999.
  4440         16  FILLER                         PIC X(428).
  4441******************************************************************
  4442*             AUTOMATIC ACTIVITY RECORD                          *
  4443******************************************************************
  4444     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL150.cbl
  4445         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4446             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4447             20  CF-SYS-LETTER-ID           PIC X(04).
  4448             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4449             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4450             20  CF-SYS-RESET-SW            PIC X(01).
  4451             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4452             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4453
  4454         16  FILLER                         PIC X(50).
  4455
  4456         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4457             20  CF-USER-ACTIVE-SW          PIC X(01).
  4458             20  CF-USER-LETTER-ID          PIC X(04).
  4459             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4460             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4461             20  CF-USER-RESET-SW           PIC X(01).
  4462             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4463             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4464             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4465
  4466         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL150.cbl
  4468*                            COPY ELCCERT.
  4469******************************************************************
  4470*                                                                *
  4471*                            ELCCERT.                            *
  4472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4473*                            VMOD=2.013                          *
  4474*                                                                *
  4475*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4476*                                                                *
  4477*   FILE TYPE = VSAM,KSDS                                        *
  4478*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4479*                                                                *
  4480*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4481*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4482*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4483*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4484*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4485*                                                                *
  4486*   LOG = YES                                                    *
  4487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4488******************************************************************
  4489*                   C H A N G E   L O G
  4490*
  4491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4492*-----------------------------------------------------------------
  4493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4494* EFFECTIVE    NUMBER
  4495*-----------------------------------------------------------------
  4496* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4497* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4498* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4499* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4500* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4501* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4502* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4503******************************************************************
  4504
  4505 01  CERTIFICATE-MASTER.
  4506     12  CM-RECORD-ID                      PIC XX.
  4507         88  VALID-CM-ID                      VALUE 'CM'.
  4508
  4509     12  CM-CONTROL-PRIMARY.
  4510         16  CM-COMPANY-CD                 PIC X.
  4511         16  CM-CARRIER                    PIC X.
  4512         16  CM-GROUPING.
  4513             20  CM-GROUPING-PREFIX        PIC X(3).
  4514             20  CM-GROUPING-PRIME         PIC X(3).
  4515         16  CM-STATE                      PIC XX.
  4516         16  CM-ACCOUNT.
  4517             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4518             20  CM-ACCOUNT-PRIME          PIC X(6).
  4519         16  CM-CERT-EFF-DT                PIC XX.
  4520         16  CM-CERT-NO.
  4521             20  CM-CERT-PRIME             PIC X(10).
  4522             20  CM-CERT-SFX               PIC X.
  4523
  4524     12  CM-CONTROL-BY-NAME.
  4525         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL150.cbl
  4526         16  CM-INSURED-LAST-NAME          PIC X(15).
  4527         16  CM-INSURED-INITIALS.
  4528             20  CM-INSURED-INITIAL1       PIC X.
  4529             20  CM-INSURED-INITIAL2       PIC X.
  4530
  4531     12  CM-CONTROL-BY-SSN.
  4532         16  CM-COMPANY-CD-A2              PIC X.
  4533         16  CM-SOC-SEC-NO.
  4534             20  CM-SSN-STATE              PIC XX.
  4535             20  CM-SSN-ACCOUNT            PIC X(6).
  4536             20  CM-SSN-LN3.
  4537                 25  CM-INSURED-INITIALS-A2.
  4538                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4539                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4540                 25 CM-PART-LAST-NAME-A2         PIC X.
  4541
  4542     12  CM-CONTROL-BY-CERT-NO.
  4543         16  CM-COMPANY-CD-A4              PIC X.
  4544         16  CM-CERT-NO-A4                 PIC X(11).
  4545
  4546     12  CM-CONTROL-BY-MEMB.
  4547         16  CM-COMPANY-CD-A5              PIC X.
  4548         16  CM-MEMBER-NO.
  4549             20  CM-MEMB-STATE             PIC XX.
  4550             20  CM-MEMB-ACCOUNT           PIC X(6).
  4551             20  CM-MEMB-LN4.
  4552                 25  CM-INSURED-INITIALS-A5.
  4553                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4554                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4555                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4556
  4557     12  CM-INSURED-PROFILE-DATA.
  4558         16  CM-INSURED-FIRST-NAME.
  4559             20  CM-INSURED-1ST-INIT       PIC X.
  4560             20  FILLER                    PIC X(9).
  4561         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4562         16  CM-INSURED-SEX                PIC X.
  4563             88  CM-SEX-MALE                  VALUE 'M'.
  4564             88  CM-SEX-FEMAL                 VALUE 'F'.
  4565         16  CM-INSURED-JOINT-AGE          PIC 99.
  4566         16  CM-JOINT-INSURED-NAME.
  4567             20  CM-JT-LAST-NAME           PIC X(15).
  4568             20  CM-JT-FIRST-NAME.
  4569                 24  CM-JT-1ST-INIT        PIC X.
  4570                 24  FILLER                PIC X(9).
  4571             20  CM-JT-INITIAL             PIC X.
  4572
  4573     12  CM-LIFE-DATA.
  4574         16  CM-LF-BENEFIT-CD              PIC XX.
  4575         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4576         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4577         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4578         16  CM-LF-DEV-CODE                PIC XXX.
  4579         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4580         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4581         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4582         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4583         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL150.cbl
  4584         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4585         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4586         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4587         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4588         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4589         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4590         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4591         16  FILLER                        PIC XX.
  4592
  4593     12  CM-AH-DATA.
  4594         16  CM-AH-BENEFIT-CD              PIC XX.
  4595         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4596         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4597         16  CM-AH-DEV-CODE                PIC XXX.
  4598         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4599         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4600         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4601         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4602         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4603         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4604         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4605         16  CM-AH-PAID-THRU-DT            PIC XX.
  4606             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4607         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4608         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4609         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4610         16  FILLER                        PIC X.
  4611
  4612     12  CM-LOAN-INFORMATION.
  4613         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4614         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4615         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4616         16  CM-PAY-FREQUENCY              PIC S99.
  4617         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4618         16  CM-RATE-CLASS                 PIC XX.
  4619         16  CM-BENEFICIARY                PIC X(25).
  4620         16  CM-POLICY-FORM-NO             PIC X(12).
  4621         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4622         16  CM-LAST-ADD-ON-DT             PIC XX.
  4623         16  CM-DEDUCTIBLE-AMOUNTS.
  4624             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4625             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4626         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4627             20  CM-RESIDENT-STATE         PIC XX.
  4628             20  CM-RATE-CODE              PIC X(4).
  4629             20  FILLER                    PIC XX.
  4630         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4631             20  CM-LOAN-OFFICER           PIC X(5).
  4632             20  FILLER                    PIC XXX.
  4633         16  CM-CSR-CODE                   PIC XXX.
  4634         16  CM-UNDERWRITING-CODE          PIC X.
  4635             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4636         16  CM-POST-CARD-IND              PIC X.
  4637         16  CM-NH-INTERFACE-SW            PIC X.
  4638         16  CM-PREMIUM-TYPE               PIC X.
  4639             88  CM-SING-PRM                  VALUE '1'.
  4640             88  CM-O-B-COVERAGE              VALUE '2'.
  4641             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL150.cbl
  4642         16  CM-IND-GRP-TYPE               PIC X.
  4643             88  CM-INDIVIDUAL                VALUE 'I'.
  4644             88  CM-GROUP                     VALUE 'G'.
  4645         16  CM-SKIP-CODE                  PIC X.
  4646             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4647             88  SKIP-JULY                    VALUE '1'.
  4648             88  SKIP-AUGUST                  VALUE '2'.
  4649             88  SKIP-SEPTEMBER               VALUE '3'.
  4650             88  SKIP-JULY-AUG                VALUE '4'.
  4651             88  SKIP-AUG-SEPT                VALUE '5'.
  4652             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4653             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4654             88  SKIP-JUNE                    VALUE '8'.
  4655             88  SKIP-JUNE-JULY               VALUE '9'.
  4656             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4657             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4658         16  CM-PAYMENT-MODE               PIC X.
  4659             88  PAY-MONTHLY                  VALUE SPACE.
  4660             88  PAY-WEEKLY                   VALUE '1'.
  4661             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4662             88  PAY-BI-WEEKLY                VALUE '3'.
  4663             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4664         16  CM-LOAN-NUMBER                PIC X(8).
  4665         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4666         16  CM-OLD-LOF                    PIC XXX.
  4667*        16  CM-LOAN-OFFICER               PIC XXX.
  4668         16  CM-REIN-TABLE                 PIC XXX.
  4669         16  CM-SPECIAL-REIN-CODE          PIC X.
  4670         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4671         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4672         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4673
  4674     12  CM-STATUS-DATA.
  4675         16  CM-ENTRY-STATUS               PIC X.
  4676         16  CM-ENTRY-DT                   PIC XX.
  4677
  4678         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4679         16  CM-LF-CANCEL-DT               PIC XX.
  4680         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4681
  4682         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4683         16  CM-LF-DEATH-DT                PIC XX.
  4684         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4685
  4686         16  CM-LF-CURRENT-STATUS          PIC X.
  4687             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4688                                                'M' '4' '5' '9'.
  4689             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4690             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4691             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4692             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4693             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4694             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4695             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4696             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4697             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4698             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4699             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL150.cbl
  4700             88  CM-LF-VOIDED                 VALUE 'V'.
  4701
  4702         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4703         16  CM-AH-CANCEL-DT               PIC XX.
  4704         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4705
  4706         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4707         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4708         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4709
  4710         16  CM-AH-CURRENT-STATUS          PIC X.
  4711             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4712                                                'M' '4' '5' '9'.
  4713             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4714             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4715             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4716             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4717             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4718             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4719             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4720             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4721             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4722             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4723             88  CM-AH-DECLINED               VALUE 'D'.
  4724             88  CM-AH-VOIDED                 VALUE 'V'.
  4725
  4726         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4727             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4728             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4729             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4730         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4731
  4732         16  CM-ENTRY-BATCH                PIC X(6).
  4733         16  CM-LF-EXIT-BATCH              PIC X(6).
  4734         16  CM-AH-EXIT-BATCH              PIC X(6).
  4735         16  CM-LAST-MONTH-END             PIC XX.
  4736
  4737     12  CM-NOTE-SW                        PIC X.
  4738         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4739         88  CERT-NOTES-PRESENT               VALUE '1'.
  4740         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4741         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4742         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4743         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4744         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4745         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4746     12  CM-COMP-EXCP-SW                   PIC X.
  4747         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4748         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4749     12  CM-INSURED-ADDRESS-SW             PIC X.
  4750         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4751         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4752
  4753*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4754     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4755     12  FILLER                            PIC X.
  4756
  4757*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL150.cbl
  4758     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4759     12  FILLER                            PIC X.
  4760*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4761     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4762
  4763     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4764         88  CERT-ADDED-BATCH                 VALUE ' '.
  4765         88  CERT-ADDED-ONLINE                VALUE '1'.
  4766         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4767         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4768         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4769     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4770         88  CERT-AS-LOADED                   VALUE ' '.
  4771         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4772         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4773         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4774         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4775         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4776         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4777         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4778
  4779     12  CM-ACCOUNT-COMM-PCTS.
  4780         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4781         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4782
  4783     12  CM-USER-FIELD                     PIC X.
  4784     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4785     12  CM-CLP-STATE                      PIC XX.
  4786     12  CM-USER-RESERVED                  PIC XXX.
  4787******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL150.cbl
  4789*                            COPY ELCTRLR.
  4790******************************************************************
  4791*                                                                *
  4792*                            ELCTRLR.                            *
  4793*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4794*                            VMOD=2.014                          *
  4795*                                                                *
  4796*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4797*                                                                *
  4798*   FILE TYPE = VSAM,KSDS                                        *
  4799*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4800*                                                                *
  4801*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4802*       ALTERNATE INDEX = NONE                                   *
  4803*                                                                *
  4804*   LOG = YES                                                    *
  4805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4806******************************************************************
  4807*                   C H A N G E   L O G
  4808*
  4809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4810*-----------------------------------------------------------------
  4811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4812* EFFECTIVE    NUMBER
  4813*-----------------------------------------------------------------
  4814* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4815* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4816* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4817* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4818* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4819* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4820* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4821* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4822* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4823* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4824* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4825* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4826******************************************************************
  4827 01  ACTIVITY-TRAILERS.
  4828     12  AT-RECORD-ID                    PIC XX.
  4829         88  VALID-AT-ID                       VALUE 'AT'.
  4830
  4831     12  AT-CONTROL-PRIMARY.
  4832         16  AT-COMPANY-CD               PIC X.
  4833         16  AT-CARRIER                  PIC X.
  4834         16  AT-CLAIM-NO                 PIC X(7).
  4835         16  AT-CERT-NO.
  4836             20  AT-CERT-PRIME           PIC X(10).
  4837             20  AT-CERT-SFX             PIC X.
  4838         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4839             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4840             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4841             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4842             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4843             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4844             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4845             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4846             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL150.cbl
  4847             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4848             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4849             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4850             88  AT-BENEFICIARY-TRL           VALUE +91.
  4851             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4852
  4853     12  AT-TRAILER-TYPE                 PIC X.
  4854         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4855         88  PAYMENT-TR                       VALUE '2'.
  4856         88  AUTO-PAY-TR                      VALUE '3'.
  4857         88  CORRESPONDENCE-TR                VALUE '4'.
  4858         88  ADDRESS-TR                       VALUE '5'.
  4859         88  GENERAL-INFO-TR                  VALUE '6'.
  4860         88  AUTO-PROMPT-TR                   VALUE '7'.
  4861         88  DENIAL-TR                        VALUE '8'.
  4862         88  INCURRED-CHG-TR                  VALUE '9'.
  4863         88  FORM-CONTROL-TR                  VALUE 'A'.
  4864
  4865     12  AT-RECORDED-DT                  PIC XX.
  4866     12  AT-RECORDED-BY                  PIC X(4).
  4867     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4868
  4869     12  AT-TRAILER-BODY                 PIC X(165).
  4870
  4871     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4872         16  AT-RESERVE-CONTROLS.
  4873             20  AT-MANUAL-SW            PIC X.
  4874                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4875             20  AT-FUTURE-SW            PIC X.
  4876                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4877             20  AT-PTC-SW               PIC X.
  4878                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4879             20  AT-IBNR-SW              PIC X.
  4880                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4881             20  AT-PTC-LF-SW            PIC X.
  4882                 88  AT-LF-PTC-USED          VALUE '1'.
  4883             20  AT-CDT-ACCESS-METHOD    PIC X.
  4884                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4885                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4886                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4887             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4888         16  AT-LAST-COMPUTED-DT         PIC XX.
  4889         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4890         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4891         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4892         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4893         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4894         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4895         16  AT-EXPENSE-CONTROLS.
  4896             20  AT-EXPENSE-METHOD       PIC X.
  4897                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4898                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4899                 88  PERCENT-OF-PMT           VALUE '3'.
  4900                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4901             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4902             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4903         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4904         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL150.cbl
  4905
  4906         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4907         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4908
  4909*        16  FILLER                      PIC X(53).
  4910         16  FILLER                      PIC X(47).
  4911
  4912         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4913         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4914
  4915         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4916             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4917             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4918*                    C = CLOSED
  4919*                    O = OPEN
  4920             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4921*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4922
  4923     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4924         16  AT-PAYMENT-TYPE             PIC X.
  4925             88  PARTIAL-PAYMENT                VALUE '1'.
  4926             88  FINAL-PAYMENT                  VALUE '2'.
  4927             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4928             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4929             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4930             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4931             88  VOIDED-PAYMENT                 VALUE '9'.
  4932             88  TRANSFER                       VALUE 'T'.
  4933             88  LIFE-INTEREST                  VALUE 'I'.
  4934
  4935         16  AT-CLAIM-TYPE               PIC X.
  4936             88  PAID-FOR-AH                    VALUE 'A'.
  4937             88  PAID-FOR-LIFE                  VALUE 'L'.
  4938             88  PAID-FOR-IUI                   VALUE 'I'.
  4939             88  PAID-FOR-GAP                   VALUE 'G'.
  4940         16  AT-CLAIM-PREM-TYPE          PIC X.
  4941             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4942             88  AT-O-B-COVERAGE                VALUE '2'.
  4943             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4944         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4945         16  AT-CHECK-NO                 PIC X(7).
  4946         16  AT-PAID-FROM-DT             PIC XX.
  4947         16  AT-PAID-THRU-DT             PIC XX.
  4948         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4949         16  FILLER                      PIC X.
  4950         16  AT-PAYEES-NAME              PIC X(30).
  4951         16  AT-PAYMENT-ORIGIN           PIC X.
  4952             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4953             88  ONLINE-AUTO-PMT                VALUE '2'.
  4954             88  OFFLINE-PMT                    VALUE '3'.
  4955         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4956         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4957         16  AT-VOID-DATA.
  4958             20  AT-VOID-DT              PIC XX.
  4959*00144       20  AT-VOID-REASON          PIC X(30).
  4960             20  AT-VOID-REASON          PIC X(26).
  4961         16  AT-PMT-APPROVED-BY          PIC X(04).
  4962         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL150.cbl
  4963         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4964         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4965                                         PIC S99V9(5)  COMP-3.
  4966         16  AT-CREDIT-INTERFACE.
  4967             20  AT-PMT-SELECT-DT        PIC XX.
  4968                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4969             20  AT-PMT-ACCEPT-DT        PIC XX.
  4970                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4971             20  AT-VOID-SELECT-DT       PIC XX.
  4972                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4973             20  AT-VOID-ACCEPT-DT       PIC XX.
  4974                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4975
  4976         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4977                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4978                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4979         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4980
  4981         16  AT-FORCE-CONTROL            PIC X.
  4982             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4983         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4984         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4985         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4986         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4987         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4988         16  AT-BENEFIT-TYPE             PIC X.
  4989
  4990         16  AT-EXPENSE-TYPE             PIC X.
  4991         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4992
  4993         16  AT-PAYEE-TYPE-CD.
  4994             20  AT-PAYEE-TYPE           PIC X.
  4995                 88  INSURED-PAID           VALUE 'I'.
  4996                 88  BENEFICIARY-PAID       VALUE 'B'.
  4997                 88  ACCOUNT-PAID           VALUE 'A'.
  4998                 88  OTHER-1-PAID           VALUE 'O'.
  4999                 88  OTHER-2-PAID           VALUE 'Q'.
  5000                 88  DOCTOR-PAID            VALUE 'P'.
  5001                 88  EMPLOYER-PAID          VALUE 'E'.
  5002             20  AT-PAYEE-SEQ            PIC X.
  5003
  5004         16  AT-CASH-PAYMENT             PIC X.
  5005         16  AT-GROUPED-PAYMENT          PIC X.
  5006         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5007         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5008         16  AT-APPROVED-LEVEL           PIC X.
  5009         16  AT-VOID-TYPE                PIC X.
  5010             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5011             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5012         16  AT-AIG-UNEMP-IND            PIC X.
  5013             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5014         16  AT-ASSOCIATES               PIC X.
  5015             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5016             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5017
  5018         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5019         16  AT-CV-PMT-CODE              PIC X.
  5020             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL150.cbl
  5021             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5022             88  FULL-ADD-PAYMENT           VALUE '3'.
  5023             88  HALF-ADD-PAYMENT           VALUE '4'.
  5024             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5025             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5026             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5027             88  ADDL-PAYMENT               VALUE '8'.
  5028
  5029         16  AT-EOB-CODE1                PIC XXX.
  5030         16  AT-EOB-CODE2                PIC XXX.
  5031         16  AT-EOB-CODE3                PIC XXX.
  5032         16  AT-EOB-CODE4                PIC XXX.
  5033         16  FILLER REDEFINES AT-EOB-CODE4.
  5034             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5035             20  FILLER                  PIC X.
  5036         16  AT-EOB-CODE5                PIC XXX.
  5037         16  FILLER REDEFINES AT-EOB-CODE5.
  5038             20  AT-PMT-PROOF-DT         PIC XX.
  5039             20  FILLER                  PIC X.
  5040
  5041         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5042             88  AT-PRINT-EOB            VALUE 'Y'.
  5043
  5044         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5045         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5046
  5047     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5048         16  AT-SCHEDULE-START-DT        PIC XX.
  5049         16  AT-SCHEDULE-END-DT          PIC XX.
  5050         16  AT-TERMINATED-DT            PIC XX.
  5051         16  AT-LAST-PMT-TYPE            PIC X.
  5052             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5053             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5054         16  AT-FIRST-PMT-DATA.
  5055             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5056             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5057             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5058         16  AT-REGULAR-PMT-DATA.
  5059             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5060             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5061             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5062         16  AT-AUTO-PAYEE-CD.
  5063             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5064                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5065                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5066                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5067                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5068                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5069             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5070         16  AT-AUTO-PAY-DAY             PIC 99.
  5071         16  AT-AUTO-CASH                PIC X.
  5072             88  AT-CASH                      VALUE 'Y'.
  5073             88  AT-NON-CASH                  VALUE 'N'.
  5074*        16  FILLER                      PIC X(129).
  5075         16  AT-AUTO-END-LETTER          PIC X(4).
  5076         16  FILLER                      PIC X(125).
  5077
  5078         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL150.cbl
  5079         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5080
  5081     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5082         16  AT-LETTER-SENT-DT           PIC XX.
  5083         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5084         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5085         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5086         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5087         16  AT-LETTER-ORIGIN            PIC X.
  5088             88  ONLINE-CREATION              VALUE '1' '3'.
  5089             88  OFFLINE-CREATION             VALUE '2' '4'.
  5090             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5091             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5092         16  AT-STD-LETTER-FORM          PIC X(4).
  5093         16  AT-REASON-TEXT              PIC X(70).
  5094         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5095         16  AT-ADDRESEE-TYPE            PIC X.
  5096              88  INSURED-ADDRESEE            VALUE 'I'.
  5097              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5098              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5099              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5100              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5101              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5102              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5103         16  AT-ADDRESSEE-NAME           PIC X(30).
  5104         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5105         16  AT-RESEND-PRINT-DATE        PIC XX.
  5106         16  AT-CORR-SOL-UNSOL           PIC X.
  5107         16  AT-LETTER-PURGED-DT         PIC XX.
  5108*
  5109*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5110*
  5111         16  AT-CSO-REDEFINITION.
  5112             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5113             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5114             20  AT-LETTER-TO-BENE       PIC X(1).
  5115             20  AT-STOP-LETTER-DT       PIC X(2).
  5116             20  FILLER                  PIC X(19).
  5117*             20  FILLER                  PIC X(27).
  5118             20  AT-CSO-LETTER-STATUS    PIC X.
  5119                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5120                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5121                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5122             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5123             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5124*
  5125*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5126*
  5127*        16  FILLER                      PIC X(26).
  5128*
  5129*        16  AT-DMD-BSR-CODE             PIC X.
  5130*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5131*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5132*
  5133*        16  AT-DMD-LETTER-STATUS        PIC X.
  5134*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  5135*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5136*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL150.cbl
  5137*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5138*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5139
  5140         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5141         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5142
  5143     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5144         16  AT-ADDRESS-TYPE             PIC X.
  5145             88  INSURED-ADDRESS               VALUE 'I'.
  5146             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5147             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5148             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5149             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5150             88  OTHER-ADDRESS-1               VALUE 'O'.
  5151             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5152         16  AT-MAIL-TO-NAME             PIC X(30).
  5153         16  AT-ADDRESS-LINE-1           PIC X(30).
  5154         16  AT-ADDRESS-LINE-2           PIC X(30).
  5155         16  AT-CITY-STATE.
  5156             20  AT-CITY                 PIC X(28).
  5157             20  AT-STATE                PIC XX.
  5158         16  AT-ZIP.
  5159             20  AT-ZIP-CODE.
  5160                 24  AT-ZIP-1ST          PIC X.
  5161                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5162                 24  FILLER              PIC X(4).
  5163             20  AT-ZIP-PLUS4            PIC X(4).
  5164         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5165             20  AT-CAN-POSTAL-1         PIC XXX.
  5166             20  AT-CAN-POSTAL-2         PIC XXX.
  5167             20  FILLER                  PIC XXX.
  5168         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5169         16  FILLER                      PIC X(23).
  5170         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5171         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5172
  5173     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5174         16  AT-INFO-LINE-1              PIC X(60).
  5175         16  AT-INFO-LINE-2              PIC X(60).
  5176         16  AT-INFO-TRAILER-TYPE        PIC X.
  5177             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5178             88  AT-CALL-NOTE            VALUE 'C'.
  5179             88  AT-MAINT-NOTE           VALUE 'M'.
  5180             88  AT-CERT-CHANGE          VALUE 'X'.
  5181             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5182             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5183         16  AT-CALL-TYPE                PIC X.
  5184             88  AT-PHONE-CALL-IN        VALUE 'I'.
  5185             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  5186         16  AT-NOTE-CONTINUATION        PIC X.
  5187             88  AT-CONTINUED-NOTE       VALUE 'X'.
  5188         16  AT-EOB-CODES-EXIST          PIC X.
  5189             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  5190         16  FILLER                      PIC X(35).
  5191         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  5192         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  5193
  5194     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL150.cbl
  5195         16  AT-PROMPT-LINE-1            PIC X(60).
  5196         16  AT-PROMPT-LINE-2            PIC X(60).
  5197         16  AT-PROMPT-START-DT          PIC XX.
  5198         16  AT-PROMPT-END-DT            PIC XX.
  5199         16  FILLER                      PIC X(35).
  5200         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  5201         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  5202
  5203     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5204         16  AT-DENIAL-INFO-1            PIC X(60).
  5205         16  AT-DENIAL-INFO-2            PIC X(60).
  5206         16  AT-DENIAL-DT                PIC XX.
  5207         16  AT-RETRACTION-DT            PIC XX.
  5208         16  AT-DENIAL-REASON-CODE       PIC X(4).
  5209*         16  FILLER                      PIC X(31).
  5210         16  AT-DENIAL-PROOF-DT          PIC XX.
  5211         16  FILLER                      PIC X(29).
  5212         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  5213         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  5214
  5215     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  5216         16  AT-OLD-INCURRED-DT          PIC XX.
  5217         16  AT-OLD-REPORTED-DT          PIC XX.
  5218         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  5219         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  5220         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  5221         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  5222         16  AT-OLD-PAID-THRU-DT         PIC XX.
  5223         16  AT-LAST-PMT-MADE-DT         PIC XX.
  5224         16  FILLER                      PIC X(26).
  5225         16  AT-OLD-DIAG-CODE            PIC X(6).
  5226         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  5227         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  5228         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  5229         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  5230         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  5231         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  5232         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  5233         16  FILLER                      PIC X(25).
  5234         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  5235
  5236     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  5237         16  AT-FORM-SEND-ON-DT          PIC XX.
  5238         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  5239         16  AT-FORM-RE-SEND-DT          PIC XX.
  5240         16  AT-FORM-ANSWERED-DT         PIC XX.
  5241         16  AT-FORM-PRINTED-DT          PIC XX.
  5242         16  AT-FORM-REPRINT-DT          PIC XX.
  5243         16  AT-FORM-TYPE                PIC X.
  5244             88  INITIAL-FORM                  VALUE '1'.
  5245             88  PROGRESS-FORM                 VALUE '2'.
  5246         16  AT-INSTRUCT-LN-1            PIC X(28).
  5247         16  AT-INSTRUCT-LN-2            PIC X(28).
  5248         16  AT-INSTRUCT-LN-3            PIC X(28).
  5249         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  5250         16  AT-FORM-ADDRESS             PIC X.
  5251             88  FORM-TO-INSURED              VALUE 'I'.
  5252             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL150.cbl
  5253             88  FORM-TO-OTHER-1              VALUE 'O'.
  5254             88  FORM-TO-OTHER-2              VALUE 'Q'.
  5255         16  AT-RELATED-1.
  5256             20 AT-REL-CARR-1            PIC X.
  5257             20 AT-REL-CLAIM-1           PIC X(7).
  5258             20 AT-REL-CERT-1            PIC X(11).
  5259         16  AT-RELATED-2.
  5260             20 AT-REL-CARR-2            PIC X.
  5261             20 AT-REL-CLAIM-2           PIC X(7).
  5262             20 AT-REL-CERT-2            PIC X(11).
  5263         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  5264         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  5265         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  5266         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  5267         16  AT-FORM-REM-PRINT-DT        PIC XX.
  5268         16  AT-STOP-FORM-DT             PIC X(2).
  5269
  5270         16  FILLER                      PIC X(09).
  5271         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  5272         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  5273******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL150.cbl
  5275*                            COPY ELCACTQ.
  5276******************************************************************
  5277*                                                                *
  5278*                            ELCACTQ.                            *
  5279*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5280*                            VMOD=2.004                          *
  5281*                                                                *
  5282*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5283*                                                                *
  5284*   FILE TYPE = VSAM,KSDS                                        *
  5285*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5286*                                                                *
  5287*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5288*       ALTERNATE INDEX = NONE                                   *
  5289*                                                                *
  5290*   LOG = YES                                                    *
  5291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5292*                                                                *
  5293*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5294******************************************************************
  5295
  5296 01  ACTIVITY-QUE.
  5297     12  AQ-RECORD-ID                PIC XX.
  5298         88  VALID-AQ-ID                VALUE 'AQ'.
  5299
  5300     12  AQ-CONTROL-PRIMARY.
  5301         16  AQ-COMPANY-CD           PIC X.
  5302         16  AQ-CARRIER              PIC X.
  5303         16  AQ-CLAIM-NO             PIC X(7).
  5304         16  AQ-CERT-NO.
  5305             20  AQ-CERT-PRIME       PIC X(10).
  5306             20  AQ-CERT-SFX         PIC X.
  5307
  5308     12  AQ-PENDING-ACTIVITY-FLAGS.
  5309         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5310         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5311             88  PENDING-PAYMENTS       VALUE '1'.
  5312         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5313             88  PENDING-FULL-PRINT     VALUE '1'.
  5314             88  PENDING-PART-PRINT     VALUE '2'.
  5315         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5316             88  PENDING-LETTERS        VALUE '1'.
  5317         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5318             88  PENDING-RESTORE        VALUE 'C'.
  5319             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5320
  5321     12  FILLER                      PIC X(20).
  5322
  5323     12  AQ-RESEND-DATE              PIC XX.
  5324     12  AQ-FOLLOWUP-DATE            PIC XX.
  5325     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5326     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5327     12  AQ-AUTO-LETTER              PIC X(4).
  5328     12  FILLER                      PIC XX.
  5329     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5330*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL150.cbl
  5332*                            COPY ERCACCT.
  5333******************************************************************
  5334*                                                                *
  5335*                                                                *
  5336*                            ERCACCT                             *
  5337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5338*                            VMOD=2.031                          *
  5339*                                                                *
  5340*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5341*                                                                *
  5342*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5343*   VSAM ACCOUNT MASTER FILES.                                   *
  5344*                                                                *
  5345*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5346*                                                                *
  5347*   FILE TYPE = VSAM,KSDS                                        *
  5348*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5349*                                                                *
  5350*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5351*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5352*                                                                *
  5353*   LOG = NO                                                     *
  5354*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5355*                                                                *
  5356*                                                                *
  5357******************************************************************
  5358*                   C H A N G E   L O G
  5359*
  5360* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5361*-----------------------------------------------------------------
  5362*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5363* EFFECTIVE    NUMBER
  5364*-----------------------------------------------------------------
  5365* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5366* 092705    2005050300006  PEMA  ADD SPP LEASES
  5367* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5368* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5369******************************************************************
  5370
  5371 01  ACCOUNT-MASTER.
  5372     12  AM-RECORD-ID                      PIC XX.
  5373         88  VALID-AM-ID                      VALUE 'AM'.
  5374
  5375     12  AM-CONTROL-PRIMARY.
  5376         16  AM-COMPANY-CD                 PIC X.
  5377         16  AM-MSTR-CNTRL.
  5378             20  AM-CONTROL-A.
  5379                 24  AM-CARRIER            PIC X.
  5380                 24  AM-GROUPING.
  5381                     28 AM-GROUPING-PREFIX PIC XXX.
  5382                     28 AM-GROUPING-PRIME  PIC XXX.
  5383                 24  AM-STATE              PIC XX.
  5384                 24  AM-ACCOUNT.
  5385                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5386                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5387             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5388                                           PIC X(19).
  5389             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL150.cbl
  5390                 24  AM-EXPIRATION-DT      PIC XX.
  5391                 24  FILLER                PIC X(4).
  5392             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5393                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5394
  5395     12  AM-CONTROL-BY-VAR-GRP.
  5396         16  AM-COMPANY-CD-A1              PIC X.
  5397         16  AM-VG-CARRIER                 PIC X.
  5398         16  AM-VG-GROUPING                PIC X(6).
  5399         16  AM-VG-STATE                   PIC XX.
  5400         16  AM-VG-ACCOUNT                 PIC X(10).
  5401         16  AM-VG-DATE.
  5402             20  AM-VG-EXPIRATION-DT       PIC XX.
  5403             20  FILLER                    PIC X(4).
  5404         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5405                                           PIC 9(11)      COMP-3.
  5406     12  AM-MAINT-INFORMATION.
  5407         16  AM-LAST-MAINT-DT              PIC XX.
  5408         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5409         16  AM-LAST-MAINT-USER            PIC X(4).
  5410         16  FILLER                        PIC XX.
  5411
  5412     12  AM-EFFECTIVE-DT                   PIC XX.
  5413     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5414
  5415     12  AM-PREV-DATES  COMP-3.
  5416         16  AM-PREV-EXP-DT                PIC 9(11).
  5417         16  AM-PREV-EFF-DT                PIC 9(11).
  5418
  5419     12  AM-REPORT-CODE-1                  PIC X(10).
  5420     12  AM-REPORT-CODE-2                  PIC X(10).
  5421
  5422     12  AM-CITY-CODE                      PIC X(4).
  5423     12  AM-COUNTY-PARISH                  PIC X(6).
  5424
  5425     12  AM-NAME                           PIC X(30).
  5426     12  AM-PERSON                         PIC X(30).
  5427     12  AM-ADDRS                          PIC X(30).
  5428     12  AM-CITY.
  5429         16  AM-ADDR-CITY                  PIC X(28).
  5430         16  AM-ADDR-STATE                 PIC XX.
  5431     12  AM-ZIP.
  5432         16  AM-ZIP-PRIME.
  5433             20  AM-ZIP-PRI-1ST            PIC X.
  5434                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5435             20  FILLER                    PIC X(4).
  5436         16  AM-ZIP-PLUS4                  PIC X(4).
  5437     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5438         16  AM-CAN-POSTAL-1               PIC XXX.
  5439         16  AM-CAN-POSTAL-2               PIC XXX.
  5440         16  FILLER                        PIC XXX.
  5441     12  AM-TEL-NO.
  5442         16  AM-AREA-CODE                  PIC 999.
  5443         16  AM-TEL-PRE                    PIC 999.
  5444         16  AM-TEL-NBR                    PIC 9(4).
  5445     12  AM-TEL-LOC                        PIC X.
  5446         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5447         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL150.cbl
  5448
  5449     12  AM-COMM-STRUCTURE.
  5450         16  AM-DEFN-1.
  5451             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5452                 24  AM-AGT.
  5453                     28  AM-AGT-PREFIX     PIC X(4).
  5454                     28  AM-AGT-PRIME      PIC X(6).
  5455                 24  AM-COM-TYP            PIC X.
  5456                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5457                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5458                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5459                 24  AM-RECALC-LV-INDIC    PIC X.
  5460                 24  AM-RETRO-LV-INDIC     PIC X.
  5461                 24  AM-GL-CODES           PIC X.
  5462                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5463                 24  FILLER                PIC X(01).
  5464         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5465             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5466                 24  FILLER                PIC X(11).
  5467                 24  AM-L-COMA             PIC XXX.
  5468                 24  AM-J-COMA             PIC XXX.
  5469                 24  AM-A-COMA             PIC XXX.
  5470                 24  FILLER                PIC X(6).
  5471
  5472     12  AM-COMM-CHANGE-STATUS             PIC X.
  5473         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5474
  5475     12  AM-CSR-CODE                       PIC X(4).
  5476
  5477     12  AM-BILLING-STATUS                 PIC X.
  5478         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5479         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5480     12  AM-AUTO-REFUND-SW                 PIC X.
  5481         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5482         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5483     12  AM-GPCD                           PIC 99.
  5484     12  AM-IG                             PIC X.
  5485         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5486         88  AM-HAS-GROUP                     VALUE '2'.
  5487     12  AM-STATUS                         PIC X.
  5488         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5489         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5490         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5491         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5492         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5493     12  AM-REMIT-TO                       PIC 99.
  5494     12  AM-ID-NO                          PIC X(11).
  5495
  5496     12  AM-CAL-TABLE                      PIC XX.
  5497     12  AM-LF-DEVIATION                   PIC XXX.
  5498     12  AM-AH-DEVIATION                   PIC XXX.
  5499     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5500     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5501     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5502     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5503     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5504     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5505
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL150.cbl
  5506     12  AM-USER-FIELDS.
  5507         16  AM-FLD-1                      PIC XX.
  5508         16  AM-FLD-2                      PIC XX.
  5509         16  AM-FLD-3                      PIC XX.
  5510         16  AM-FLD-4                      PIC XX.
  5511         16  AM-FLD-5                      PIC XX.
  5512
  5513     12  AM-1ST-PROD-DATE.
  5514         16  AM-1ST-PROD-YR                PIC XX.
  5515         16  AM-1ST-PROD-MO                PIC XX.
  5516         16  AM-1ST-PROD-DA                PIC XX.
  5517     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5518     12  AM-CERTS-PURGED-DATE.
  5519         16  AM-PUR-YR                     PIC XX.
  5520         16  AM-PUR-MO                     PIC XX.
  5521         16  AM-PUR-DA                     PIC XX.
  5522     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5523     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5524     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5525     12  AM-INACTIVE-DATE.
  5526         16  AM-INA-MO                     PIC 99.
  5527         16  AM-INA-DA                     PIC 99.
  5528         16  AM-INA-YR                     PIC 99.
  5529     12  AM-AR-HI-CERT-DATE                PIC XX.
  5530
  5531     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5532     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5533
  5534     12  AM-OB-PAYMENT-MODE                PIC X.
  5535         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5536         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5537         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5538         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5539
  5540     12  AM-AH-ONLY-INDICATOR              PIC X.
  5541         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5542         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5543
  5544     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5545
  5546     12  AM-OVER-SHORT.
  5547         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5548         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5549
  5550     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5551     12  AM-DCC-CLP-STATE                  PIC XX.
  5552
  5553     12  AM-RECALC-COMM                    PIC X.
  5554     12  AM-RECALC-REIN                    PIC X.
  5555
  5556     12  AM-REI-TABLE                      PIC XXX.
  5557     12  AM-REI-ET-LF                      PIC X.
  5558     12  AM-REI-ET-AH                      PIC X.
  5559     12  AM-REI-PE-LF                      PIC X.
  5560     12  AM-REI-PE-AH                      PIC X.
  5561     12  AM-REI-PRT-ST                     PIC X.
  5562     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5563     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL150.cbl
  5564     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5565     12  AM-REI-GROUP-A                    PIC X(6).
  5566     12  AM-REI-MORT                       PIC X(4).
  5567     12  AM-REI-PRT-OW                     PIC X.
  5568     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5569     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5570     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5571     12  AM-REI-GROUP-B                    PIC X(6).
  5572
  5573     12  AM-TRUST-TYPE                     PIC X(2).
  5574
  5575     12  AM-EMPLOYER-STMT-USED             PIC X.
  5576     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5577
  5578     12  AM-STD-AH-TYPE                    PIC XX.
  5579     12  AM-EARN-METHODS.
  5580         16  AM-EARN-METHOD-R              PIC X.
  5581             88 AM-REF-RL-R78                 VALUE 'R'.
  5582             88 AM-REF-RL-PR                  VALUE 'P'.
  5583             88 AM-REF-RL-MEAN                VALUE 'M'.
  5584             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5585         16  AM-EARN-METHOD-L              PIC X.
  5586             88 AM-REF-LL-R78                 VALUE 'R'.
  5587             88 AM-REF-LL-PR                  VALUE 'P'.
  5588             88 AM-REF-LL-MEAN                VALUE 'M'.
  5589             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5590         16  AM-EARN-METHOD-A              PIC X.
  5591             88 AM-REF-AH-R78                 VALUE 'R'.
  5592             88 AM-REF-AH-PR                  VALUE 'P'.
  5593             88 AM-REF-AH-MEAN                VALUE 'M'.
  5594             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5595             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5596             88 AM-REF-AH-NET                 VALUE 'N'.
  5597
  5598     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5599     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5600     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5601
  5602     12  AM-RET-Y-N                        PIC X.
  5603     12  AM-RET-P-E                        PIC X.
  5604     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5605     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5606     12  AM-RET-GRP                        PIC X(6).
  5607     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5608         16  AM-POOL-PRIME                 PIC XXX.
  5609         16  AM-POOL-SUB                   PIC XXX.
  5610     12  AM-RETRO-EARNINGS.
  5611         16  AM-RET-EARN-R                 PIC X.
  5612         16  AM-RET-EARN-L                 PIC X.
  5613         16  AM-RET-EARN-A                 PIC X.
  5614     12  AM-RET-ST-TAX-USE                 PIC X.
  5615         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5616         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5617     12  AM-RETRO-BEG-EARNINGS.
  5618         16  AM-RET-BEG-EARN-R             PIC X.
  5619         16  AM-RET-BEG-EARN-L             PIC X.
  5620         16  AM-RET-BEG-EARN-A             PIC X.
  5621     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL150.cbl
  5622     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5623
  5624     12  AM-USER-SELECT-OPTIONS.
  5625         16  AM-USER-SELECT-1              PIC X(10).
  5626         16  AM-USER-SELECT-2              PIC X(10).
  5627         16  AM-USER-SELECT-3              PIC X(10).
  5628         16  AM-USER-SELECT-4              PIC X(10).
  5629         16  AM-USER-SELECT-5              PIC X(10).
  5630
  5631     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5632
  5633     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5634
  5635     12  AM-RPT045A-SWITCH                 PIC X.
  5636         88  RPT045A-OFF                   VALUE 'N'.
  5637
  5638     12  AM-INSURANCE-LIMITS.
  5639         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5640         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5641
  5642     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5643         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5644
  5645     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5646         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5647         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5648
  5649     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5650
  5651     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5652     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5653     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5654     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5655     12  FILLER                            PIC X(5).
  5656     12  AM-REPORT-CODE-3                  PIC X(10).
  5657*    12  FILLER                            PIC X(22).
  5658
  5659     12  AM-RESERVE-DATE.
  5660         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5661         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5662         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5663
  5664     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5665     12  AM-NOTIFICATION-TYPES.
  5666         16  AM-NOTIF-OF-LETTERS           PIC X.
  5667         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5668         16  AM-NOTIF-OF-REPORTS           PIC X.
  5669         16  AM-NOTIF-OF-STATUS            PIC X.
  5670
  5671     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5672         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5673         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5674         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5675         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5676
  5677     12  AM-BENEFIT-CONTROLS.
  5678         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5679             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL150.cbl
  5680             20  AM-BENEFIT-TYPE           PIC X.
  5681             20  AM-BENEFIT-REVISION       PIC XXX.
  5682             20  AM-BENEFIT-REM-TERM       PIC X.
  5683             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5684             20  FILLER                    PIC XX.
  5685         16  FILLER                        PIC X(80).
  5686
  5687     12  AM-TRANSFER-DATA.
  5688         16  AM-TRANSFERRED-FROM.
  5689             20  AM-TRNFROM-CARRIER        PIC X.
  5690             20  AM-TRNFROM-GROUPING.
  5691                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5692                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5693             20  AM-TRNFROM-STATE          PIC XX.
  5694             20  AM-TRNFROM-ACCOUNT.
  5695                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5696                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5697             20  AM-TRNFROM-DTE            PIC XX.
  5698         16  AM-TRANSFERRED-TO.
  5699             20  AM-TRNTO-CARRIER          PIC X.
  5700             20  AM-TRNTO-GROUPING.
  5701                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5702                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5703             20  AM-TRNTO-STATE            PIC XX.
  5704             20  AM-TRNTO-ACCOUNT.
  5705                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5706                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5707             20  AM-TRNTO-DTE              PIC XX.
  5708         16  FILLER                        PIC X(10).
  5709
  5710     12  AM-SAVED-REMIT-TO                 PIC 99.
  5711
  5712     12  AM-COMM-STRUCTURE-SAVED.
  5713         16  AM-DEFN-1-SAVED.
  5714             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5715                 24  AM-AGT-SV             PIC X(10).
  5716                 24  AM-COM-TYP-SV         PIC X.
  5717                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5718                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5719                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5720                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5721                 24  FILLER                PIC X.
  5722                 24  AM-GL-CODES-SV        PIC X.
  5723                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5724                 24  FILLER                PIC X.
  5725         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5726             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5727                 24  FILLER                PIC X(11).
  5728                 24  AM-L-COMA-SV          PIC XXX.
  5729                 24  AM-J-COMA-SV          PIC XXX.
  5730                 24  AM-A-COMA-SV          PIC XXX.
  5731                 24  FILLER                PIC X(6).
  5732
  5733     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5734         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5735            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5736            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5737            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL150.cbl
  5738
  5739     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5740     12  FILLER                            PIC X(120).
  5741
  5742     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5743         16  AM-CONTROL-NAME               PIC X(30).
  5744         16  AM-EXECUTIVE-ONE.
  5745             20  AM-EXEC1-NAME             PIC X(15).
  5746             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5747                                                          COMP-3.
  5748             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5749                                                          COMP-3.
  5750         16  AM-EXECUTIVE-TWO.
  5751             20  AM-EXEC2-NAME             PIC X(15).
  5752             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5753                                                          COMP-3.
  5754             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5755                                                          COMP-3.
  5756
  5757     12  AM-RETRO-ADDITIONAL-DATA.
  5758         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5759         16  AM-RETRO-PREM-P-E             PIC X.
  5760         16  AM-RETRO-CLMS-P-I             PIC X.
  5761         16  AM-RETRO-RET-BRACKET-LF.
  5762             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5763                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5764                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5765             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5766                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5767                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5768             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5769                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5770                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5771         16  AM-RETRO-RET-BRACKET-AH.
  5772             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5773                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5774                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5775                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5776             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5777                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5778                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5779             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5780                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5781                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5782
  5783     12  AM-COMMENTS.
  5784         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5785
  5786     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5787         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5788         16  AM-FLI-BILLING-CODE           PIC X.
  5789         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5790         16  AM-FLI-UNITED-IDENT           PIC X.
  5791         16  AM-FLI-INTEREST-LOST-DATA.
  5792             20  AM-FLI-BANK-NO            PIC X(5).
  5793             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5794             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5795             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL150.cbl
  5796         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5797             20  AM-FLI-AGT                PIC X(9).
  5798             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5799             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5800         16  FILLER                        PIC X(102).
  5801
  5802     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5803         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5804             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5805             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5806             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5807             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5808             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5809         16  FILLER                          PIC X(10).
  5810******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL150.cbl
  5812*                            COPY ELCARCH.
  5813******************************************************************
  5814*                                                                *
  5815*                            ELCARCH.                            *
  5816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5817*                            VMOD=2.007                          *
  5818*                                                                *
  5819*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5820*                                                                *
  5821*   FILE TYPE = VSAM,KSDS                                        *
  5822*   RECORD SIZE = 090  RECFORM = FIXED                           *
  5823*                                                                *
  5824*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  5825*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  5826*                                                                *
  5827*   LOG = NO                                                     *
  5828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5829*                                                                *
  5830*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  5831******************************************************************
  5832 01  LETTER-ARCHIVE.
  5833     12  LA-RECORD-ID                PIC XX.
  5834         88  VALID-LA-ID                VALUE 'LA'.
  5835
  5836     12  LA-CONTROL-PRIMARY.
  5837         16  LA-COMPANY-CD           PIC X.
  5838         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  5839         16  LA-RECORD-TYPE          PIC X.
  5840             88  LA-HEADER-DATA         VALUE '1'.
  5841             88  LA-ADDRESS-DATA        VALUE '2'.
  5842             88  LA-TEXT-DATA           VALUE '3'.
  5843             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  5844         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  5845
  5846     12  LA-CONTROL-BY-TYPE.
  5847         16  LA-COMPANY-CD-A1        PIC X.
  5848         16  LA-RECORD-TYPE-A1       PIC X.
  5849         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  5850         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  5851
  5852     12  LA-TEXT-RECORD.
  5853         16  LA-SKIP-CONTROL         PIC XX.
  5854             88  NO-LINES-SKIPPED       VALUE SPACES.
  5855             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  5856         16  LA-TEXT-LINE            PIC X(70).
  5857
  5858     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  5859         16  FILLER                  PIC XX.
  5860         16  LA-ADDRESS-LINE         PIC X(30).
  5861         16  FILLER                  PIC X(40).
  5862
  5863     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  5864         16  FILLER                  PIC XX.
  5865         16  LA-CARRIER              PIC X.
  5866         16  LA-CLAIM-NO             PIC X(7).
  5867         16  LA-CERT-NO.
  5868             20  LA-CERT-PRIME       PIC X(10).
  5869             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL150.cbl
  5870         16  LA-NO-OF-COPIES         PIC S9.
  5871         16  LA-RESEND-DATE          PIC XX.
  5872         16  LA-PROCESSOR-CD         PIC X(4).
  5873         16  LA-CREATION-DT          PIC XX.
  5874         16  LA-INITIAL-PRINT-DATE   PIC XX.
  5875         16  LA-RESEND-PRINT-DATE    PIC XX.
  5876         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  5877         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  5878*
  5879* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  5880*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  5881*   I        20  LA-DMD-PROD-CODE        PIC XX.
  5882*   I        20  LA-DMD-RES-ST           PIC XX.
  5883*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  5884*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  5885*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  5886*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  5887*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  5888*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  5889*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  5890*   I        20  LA-DMD-UND-CODE         PIC XX.
  5891*   I        20  LA-DMD-BEN-CODE         PIC XX.
  5892*   V    16  FILLER                  PIC X(15).
  5893* -----
  5894*
  5895* REINSERTED  CSO  MODS
  5896*
  5897         16  FILLER.
  5898             20  FILLER                  PIC X(29).
  5899             20  LA-CSO-LETTER-STATUS    PIC X.
  5900                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  5901                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  5902                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  5903             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  5904             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  5905*
  5906
  5907     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  5908         16  FILLER                  PIC XX.
  5909         16  LA4-CARRIER             PIC X.
  5910         16  LA4-CLAIM-NO            PIC X(7).
  5911         16  LA4-CERT-NO.
  5912             20  LA4-CERT-PRIME      PIC X(10).
  5913             20  LA4-CERT-SFX        PIC X.
  5914         16  LA4-NO-OF-COPIES        PIC S9.
  5915         16  LA4-RESEND-DATE         PIC XX.
  5916         16  LA4-PROCESSOR-CD        PIC X(4).
  5917         16  LA4-CREATION-DT         PIC XX.
  5918         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  5919         16  LA4-RESEND-PRINT-DATE   PIC XX.
  5920         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  5921         16  LA4-FORM-TYPE           PIC X.
  5922             88  LA4-INITIAL-FORM    VALUE '1'.
  5923             88  LA4-PROGRESS-FORM   VALUE '2'.
  5924         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  5925         16  LA4-STATE               PIC X(02).
  5926         16  FILLER                  PIC X(31).
  5927******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL150.cbl
  5929*                COPY MTCPLCY REPLACING ==:TAG:== BY ==PM==.
  5930******************************************************************
  5931*                                                                *
  5932*                           MTCPLCY                              *
  5933*                            VMOD=1.003                          *
  5934*                                                                *
  5935*   FILE DESCRIPTION = POLICY MASTER                             *
  5936*                                                                *
  5937*   FILE TYPE = VSAM,KSDS                                        *
  5938*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5939*                                                                *
  5940*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5941*       ALTERNATE PATH2 = ** NOT USED **                         *
  5942*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5943*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5944*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5945*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5946*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5947*                                                                *
  5948*   LOG = YES                                                    *
  5949*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5950******************************************************************
  5951**WARNING*********************************************************
  5952**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5953**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5954**                             MPCPHSTD                          *
  5955**                             MPCPHSTC                          *
  5956**                             MPCPHSTT                          *
  5957**                                                               *
  5958******************************************************************
  5959
  5960 01  POLICY-MASTER.
  5961     12  PM-RECORD-ID                   PIC XX.
  5962         88  VALID-PM-ID                      VALUE 'PM'.
  5963
  5964******************************************************************
  5965*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5966******************************************************************
  5967
  5968     12  PM-CONTROL-PRIMARY.
  5969         16  PM-PRODUCER-PRIMARY.
  5970             20  PM-PROD-PRIMARY.
  5971                 24  PM-COMPANY-CD      PIC X.
  5972                 24  PM-CGSP-KEY.
  5973                     28  PM-CARRIER     PIC X.
  5974                     28  PM-GROUPING.
  5975                         32  PM-GROUPING-PREFIX
  5976                                           PIC X(3).
  5977                         32  PM-GROUPING-PRIME
  5978                                           PIC X(3).
  5979                     28  PM-STATE       PIC XX.
  5980                     28  PM-PRODUCER.
  5981                         32  PM-PRODUCER-PREFIX
  5982                                           PIC X(4).
  5983                         32  PM-PRODUCER-PRIME
  5984                                           PIC X(6).
  5985             20  PM-POLICY-EFF-DT       PIC XX.
  5986         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL150.cbl
  5987             20  PM-REFNO-PRIME         PIC X(18).
  5988             20  PM-REFNO-SFX           PIC XX.
  5989
  5990******************************************************************
  5991*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5992******************************************************************
  5993
  5994     12  PM-CONTROL-BY-SSN.
  5995         16  PM-COMPANY-CD-A3           PIC X.
  5996         16  PM-SOC-SEC-NO.
  5997             20  PM-SSN-STATE           PIC XX.
  5998             20  PM-SSN-PRODUCER        PIC X(6).
  5999             20  PM-SSN-LN3.
  6000                 25  PM-INSURED-INITIALS-A3.
  6001                     30 PM-INSURED-INITIAL1-A3 PIC X.
  6002                     30 PM-INSURED-INITIAL2-A3 PIC X.
  6003                 25 PM-PART-LAST-NAME-A3      PIC X.
  6004         16  PM-DATE-A3                  PIC XX.
  6005         16  PM-TIME-A3                  PIC S9(04)   COMP.
  6006
  6007******************************************************************
  6008*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  6009******************************************************************
  6010
  6011     12  PM-CONTROL-BY-POLICY-NO.
  6012         16  PM-COMPANY-CD-A4           PIC X.
  6013         16  PM-POLICY-NO-A4.
  6014             20  PM-POLICY-PRIME-A4     PIC X(18).
  6015             20  PM-POLICY-SFX-A4       PIC XX.
  6016         16  PM-DATE-A4                 PIC XX.
  6017         16  PM-TIME-A4                 PIC S9(04)   COMP.
  6018
  6019******************************************************************
  6020*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  6021******************************************************************
  6022
  6023     12  PM-CONTROL-BY-ACCOUNT.
  6024         16  PM-COMPANY-CD-A5           PIC X.
  6025         16  PM-BANK-ACCOUNT-NUMBER     PIC X(20).
  6026         16  PM-DATE-A5                 PIC XX.
  6027         16  PM-TIME-A5                 PIC S9(07)   COMP.
  6028
  6029******************************************************************
  6030*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  6031******************************************************************
  6032
  6033     12  PM-CONTROL-BY-TRANSIT.
  6034         16  PM-COMPANY-CD-A6           PIC X.
  6035         16  PM-BANK-TRANSIT-NUMBER.
  6036             20  PM-FEDERAL-NUMBER      PIC X(4).
  6037             20  PM-BANK-NUMBER         PIC X(4).
  6038         16  PM-DATE-A6                 PIC XX.
  6039         16  PM-TIME-A6                 PIC S9(07)   COMP.
  6040
  6041******************************************************************
  6042*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  6043******************************************************************
  6044
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL150.cbl
  6045     12  PM-CONTROL-BY-LOAN-NO.
  6046         16  PM-COMPANY-CD-A7           PIC X.
  6047         16  PM-LOAN-NUMBER             PIC X(20).
  6048         16  PM-DATE-A7                 PIC XX.
  6049         16  PM-TIME-A7                 PIC S9(07)   COMP.
  6050
  6051******************************************************************
  6052*                 FILE SYNCHRONIZATION DATA                      *
  6053******************************************************************
  6054
  6055     12  FILLER                            PIC X(05).
  6056     12  PM-FILE-SYNCH-DATA.
  6057         16  PM-LAST-CHANGE-DT          PIC XX.
  6058         16  PM-LAST-CHANGE-TIME        PIC S9(7)    COMP.
  6059         16  PM-LAST-CHANGE-PROCESSOR   PIC X(4).
  6060     12  FILLER                            PIC X(05).
  6061
  6062******************************************************************
  6063*                    INSUREDS PROFILE DATA                       *
  6064******************************************************************
  6065
  6066     12  PM-INSURED-PROFILE-DATA.
  6067         16  PM-INSURED-NAME.
  6068             20  PM-INSURED-LAST-NAME  PIC X(15).
  6069             20  PM-INSURED-FIRST-NAME.
  6070                 24  PM-INSURED-1ST-INIT PIC X.
  6071                 24  FILLER               PIC X(9).
  6072             20  PM-INSURED-MIDDLE-INIT PIC X.
  6073         16  PM-INSURED-ADDRESS.
  6074             20  PM-ADDRESS-LINE-1      PIC X(30).
  6075             20  PM-ADDRESS-LINE-2      PIC X(30).
  6076             20  PM-CITY                PIC X(25).
  6077             20  PM-RESIDENT-STATE      PIC XX.
  6078             20  PM-ZIP-CD.
  6079                 24  PM-ZIP-FIRST-FIVE  PIC X(5).
  6080                 24  PM-ZIP-PLUS-FOUR   PIC X(4).
  6081         16  PM-INSURED-PERSONAL.
  6082             20  PM-INSURED-OCC-CLASS   PIC X.
  6083                 88  PM-PREFERRED         VALUE '1'.
  6084                 88  PM-STANDARD          VALUE '2'.
  6085                 88  PM-HAZARDOUS         VALUE '3'.
  6086                 88  PM-VERY-HAZARDOUS    VALUE '4'.
  6087                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  6088                 88  PM-NOT-OCC           VALUE '6'.
  6089                 88  PM-OCC-UNKNOWN       VALUE '9'.
  6090             20  PM-INSURED-OCC-CD      PIC X(3).
  6091             20  PM-INSURED-OCC-CD-NUM REDEFINES
  6092                 PM-INSURED-OCC-CD      PIC 9(3).
  6093             20  PM-INSURED-SEX         PIC X.
  6094                 88  PM-INSURED-SEX-MALE   VALUE 'M'.
  6095                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  6096             20  PM-INSURED-BIRTH-DT    PIC XX.
  6097             20  PM-INSURED-ISSUE-AGE   PIC S9(3)     COMP-3.
  6098             20  PM-INSURED-HEIGHT-FT   PIC S9(3)     COMP-3.
  6099             20  PM-INSURED-HEIGHT-IN   PIC S9(3)     COMP-3.
  6100             20  PM-INSURED-WEIGHT      PIC S9(3)     COMP-3.
  6101             20  PM-INSURED-BIRTH-STATE PIC XX.
  6102             20  PM-INSURED-PHONE-NO    PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL150.cbl
  6103             20  PM-INSURED-RATED-AGE   PIC S9(3)     COMP-3.
  6104         16  PM-INS-LANGUAGE-IND        PIC X(01).
  6105             88  PM-ENGLISH                        VALUE 'E'.
  6106             88  PM-FRENCH                         VALUE 'F'.
  6107             88  PM-SPANISH                        VALUE 'S'.
  6108         16  PM-INSURED-TOT-BENEFIT     PIC S9(7)V99  COMP-3.
  6109
  6110         16  PM-INSURED-AGE-IND         PIC X(01).
  6111             88  PM-INSURED-AGE-75-REACHED         VALUE 'Y'.
  6112     12  FILLER                            PIC X(13).
  6113
  6114******************************************************************
  6115*                JOINT INSUREDS PROFILE DATA                     *
  6116******************************************************************
  6117
  6118     12  PM-JOINT-PROFILE-DATA.
  6119         16  PM-JOINT-NAME.
  6120             20  PM-JOINT-LAST-NAME     PIC X(15).
  6121             20  PM-JOINT-FIRST-NAME.
  6122                 24  PM-JOINT-1ST-INIT  PIC X.
  6123                 24  FILLER                PIC X(9).
  6124             20  PM-JOINT-MIDDLE-INIT   PIC X.
  6125         16  PM-JOINT-SOC-SEC-NO.
  6126             20  PM-JT-SSN-STATE        PIC XX.
  6127             20  PM-JT-SSN-PRODUCER     PIC X(6).
  6128             20  PM-JT-SSN-LN3.
  6129                 25  PM-JT-INSURED-INITIALS-A3.
  6130                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  6131                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  6132                 25 PM-JT-PART-LAST-NAME-A3     PIC X.
  6133         16  PM-JOINT-PERSONAL.
  6134             20  PM-JOINT-OCC-CLASS     PIC X.
  6135                 88 PM-JNT-PREFERRED       VALUE '1'.
  6136                 88 PM-JNT-STANDARD        VALUE '2'.
  6137                 88 PM-JNT-HAZARDOUS       VALUE '3'.
  6138                 88 PM-JNT-VERY-HAZARDOUS  VALUE '4'.
  6139                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  6140                 88 PM-JNT-NOT-OCC         VALUE '6'.
  6141                 88 PM-JNT-OCC-UNKNOWN     VALUE '9'.
  6142             20  PM-JOINT-OCC-CD        PIC X(3).
  6143             20  PM-JOINT-SEX           PIC X.
  6144                 88  PM-JOINT-SEX-MALE     VALUE 'M'.
  6145                 88  PM-JOINT-SEX-FEMALE   VALUE 'F'.
  6146             20  PM-JOINT-BIRTH-DT      PIC XX.
  6147             20  PM-JOINT-ISSUE-AGE     PIC S9(3)     COMP-3.
  6148             20  PM-JOINT-HEIGHT-FT     PIC S9(3)     COMP-3.
  6149             20  PM-JOINT-HEIGHT-IN     PIC S9(3)     COMP-3.
  6150             20  PM-JOINT-WEIGHT        PIC S9(3)     COMP-3.
  6151             20  PM-JOINT-BIRTH-STATE   PIC XX.
  6152             20  PM-JOINT-RATED-AGE     PIC S9(3)     COMP-3.
  6153         16  PM-JOINT-TOT-BENEFIT       PIC S9(7)V99  COMP-3.
  6154         16  PM-JOINT-AGE-IND           PIC X(01).
  6155             88  PM-JOINT-AGE-75-REACHED           VALUE 'Y'.
  6156
  6157     12  FILLER                            PIC X(12).
  6158
  6159******************************************************************
  6160*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL150.cbl
  6161******************************************************************
  6162
  6163     12  PM-INS-COVERAGE-DATA.
  6164         16  PM-FREE-PERIOD             PIC S9(03)    COMP-3.
  6165         16  PM-LOAN-TERM               PIC S9(3)     COMP-3.
  6166         16  PM-LOAN-APR                PIC S9V9999   COMP-3.
  6167         16  PM-LOAN-DT                 PIC XX.
  6168         16  PM-LOAN-PYMT               PIC S9(5)V99  COMP-3.
  6169         16  PM-LOAN-BALC               PIC S9(7)V99  COMP-3.
  6170         16  PM-INS-BENEFIT-MONTHS      PIC S9(3)     COMP-3.
  6171         16  PM-INS-MONTH-BENEFIT       PIC S9(7)V99  COMP-3.
  6172         16  PM-INS-TOTAL-BENEFIT       PIC S9(7)V99  COMP-3.
  6173         16  PM-INS-PLAN-TYPE           PIC X.
  6174             88  PM-AH-MORT-PLAN           VALUE 'A'.
  6175             88  PM-AD-D-MORT-PLAN         VALUE 'E'.
  6176             88  PM-DISMEM-MORT-PLAN       VALUE 'D'.
  6177             88  PM-LIFE-MORT-PLAN         VALUE 'L'.
  6178         16  PM-INS-PLAN-CD             PIC XX.
  6179         16  PM-INS-PLAN-REVISION       PIC X(3).
  6180         16  PM-INS-POLICY-FORM         PIC X(12).
  6181         16  PM-INS-MSTR-POLICY.
  6182             20  PM-FREE-TYPE           PIC X(04).
  6183             20  FILLER                    PIC X(08).
  6184         16  PM-INS-MSTR-APP.
  6185             20  FILLER                    PIC X(11).
  6186             20  PM-INS-B-C-TYPE        PIC X(01).
  6187         16  PM-INS-RATE-CD             PIC X(5).
  6188         16  PM-INS-SEX-RATING          PIC X.
  6189             88  PM-NOT-SEX-RATED           VALUE '1'.
  6190             88  PM-SEX-RATED               VALUE '2'.
  6191         16  PM-INS-SUBSTANDARD-PCT     PIC S9V9999   COMP-3.
  6192         16  PM-INS-SUBSTANDARD-TYPE    PIC X.
  6193         16  PM-INS-TERMINATION-DT      PIC XX.
  6194         16  PM-INS-MONTH-PREMIUM   PIC S9(5)V999999  COMP-3.
  6195         16  PM-INS-CALC-MO-PREM    PIC S9(5)V999999  COMP-3.
  6196         16  PM-REINSURANCE-TABLE       PIC X(3).
  6197         16  PM-MORTALITY-CD            PIC X(4).
  6198         16  PM-INS-TYPE                PIC X.
  6199             88  PM-INDIVIDUAL             VALUES ARE '1' 'I'.
  6200             88  PM-GROUP                  VALUES ARE '2' 'G'.
  6201         16  PM-LOAN-OFFICER            PIC X(5).
  6202         16  PM-POLICY-FEE              PIC S9(3)V99 COMP-3.
  6203         16  PM-DEPENDENT-COUNT         PIC S99      COMP-3.
  6204         16  PM-CWA-AMOUNT              PIC S9(5)V99  COMP-3.
  6205         16  PM-LAST-AUTO-RERATE-DT     PIC XX.
  6206         16  PM-PREM-FINANCED-SW        PIC X.
  6207             88  PM-PREM-FINANCED           VALUE 'Y'.
  6208             88  PM-PREM-NOT-FINANCED       VALUE 'N'.
  6209
  6210         16  PM-INS-TERM-LETTER-IND     PIC X.
  6211             88  PM-TERM-INITIALIZED        VALUE 'Y'.
  6212         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99  COMP-3.
  6213     12  FILLER                            PIC X(11).
  6214
  6215******************************************************************
  6216*                    POLICY BILLING DATA                         *
  6217******************************************************************
  6218
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL150.cbl
  6219     12  PM-BILLING-DATA.
  6220         16  PM-BILLING-MODE            PIC X(1).
  6221             88  PM-ANNUAL                 VALUE '1'.
  6222             88  PM-SEMI-ANNUAL            VALUE '2'.
  6223             88  PM-QUARTERLY              VALUE '3'.
  6224             88  PM-MONTHLY                VALUE '4'.
  6225             88  PM-BI-MONTHLY             VALUE '5'.
  6226             88  PM-SINGLE-PREM            VALUE '6'.
  6227         16  PM-BILLING-SCHEDULE        PIC X(1).
  6228         16  PM-BILLING-SW              PIC X(1).
  6229             88  PM-FIRST-BILLING          VALUE 'Y'.
  6230             88  PM-PAID-IN-ADVANCE        VALUE 'A'.
  6231             88  PM-POLICY-FEE-REFUNDED    VALUE 'F'.
  6232         16  PM-BILLING-TYPE            PIC X(1).
  6233             88  PM-LIST-BILL              VALUE '1'.
  6234             88  PM-TAPE-BILL              VALUE '2'.
  6235             88  PM-TAPE-LIST-BILL         VALUE '3'.
  6236             88  PM-GROUP-BILL       VALUE ARE '1' '2' '3'.
  6237             88  PM-DIRECT-BILL            VALUE '4'.
  6238             88  PM-PAC-BILL         VALUE ARE '5' 'C' 'S'.
  6239             88  PM-CHARGE-CARD-BILL       VALUE '6'.
  6240             88  PM-INDIV-BILL
  6241                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  6242             88  PM-GRP-PLCY-BILL          VALUE '7'.
  6243             88  PM-GRP-PLCY-PAC           VALUE '8'.
  6244             88  PM-GRP-PLCY-CR-CRD        VALUE '9'.
  6245             88  PM-GRP-PLCY         VALUE ARE '7' '8' '9'.
  6246             88  PM-GRP-PROD               VALUE 'A'.
  6247             88  PM-EFT-CHECKING           VALUE 'C'.
  6248             88  PM-EFT-SAVINGS            VALUE 'S'.
  6249         16  PM-PAYMENT-AMT             PIC S9(5)V99  COMP-3.
  6250         16  PM-OVER-SHORT-AMT          PIC S9(5)V99  COMP-3.
  6251         16  PM-LAST-BILL-DT            PIC XX.
  6252         16  PM-LAST-BILL-AMT           PIC S9(5)V99  COMP-3.
  6253         16  PM-BILL-TO-DT              PIC XX.
  6254         16  PM-LAST-PYMT-DT            PIC XX.
  6255         16  PM-PAID-TO-DT              PIC XX.
  6256         16  PM-PYMT-INVOICE-NUMBER     PIC X(6).
  6257         16  PM-MONTHS-PAID             PIC S9(3)     COMP-3.
  6258         16  PM-TOTAL-PREM-RECVD        PIC S9(7)V99  COMP-3.
  6259         16  PM-BILLING-GROUPING-CODE   PIC X(6).
  6260         16  PM-CHARGE-CARD-EXP-DT      PIC X(2).
  6261         16  PM-CHARGE-CARD-TYPE        PIC X(2).
  6262             88  PM-VISA                   VALUE 'VI'.
  6263             88  PM-MSTR-CARD              VALUE 'MC'.
  6264             88  PM-DINERS-CLUB            VALUE 'DN'.
  6265             88  PM-DISCOVER               VALUE 'DS'.
  6266             88  PM-CARTE-BLANCHE          VALUE 'CB'.
  6267             88  PM-AMERICAN-EXPRESS       VALUE 'AE'.
  6268         16  PM-BILL-INVOICE-NUMBER     PIC X(6).
  6269         16  PM-BILL-DAY                PIC S99       COMP-3.
  6270         16  PM-RES-PREM-TAX        PIC S9(3)V999999  COMP-3.
  6271     12  FILLER                            PIC X(15).
  6272
  6273******************************************************************
  6274*                     CLAIM PAYMENT DATA                         *
  6275******************************************************************
  6276
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL150.cbl
  6277     12  PM-CLAIM-PAYMENT-DATA.
  6278         16  PM-CLAIM-BENEFICIARY-NAME  PIC X(25).
  6279         16  PM-CLAIM-INTERFACE-SW      PIC X.
  6280             88  PM-NO-CLAIM-ATTACHED      VALUE SPACE.
  6281             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  6282             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  6283             88  PM-CLAIM-CLOSED           VALUE '3'.
  6284             88  PM-ACTIVE-CLAIM           VALUE '1' '2'.
  6285             88  PM-CLAIM-ATTACHED         VALUE '1' '2' '3'.
  6286         16  PM-CLAIM-INCURRED-DT       PIC XX.
  6287         16  PM-CLAIM-PAID-TO-DT        PIC XX.
  6288         16  PM-CLAIM-PAYMENT-CNT       PIC S9(3)     COMP-3.
  6289         16  PM-CLAIM-LAST-PAYMENT-AMT  PIC S9(7)V99  COMP-3.
  6290         16  PM-CLAIM-EXPENSES-ITD      PIC S9(7)V99  COMP-3.
  6291         16  PM-CLAIM-PAYMENTS-ITD      PIC S9(7)V99  COMP-3.
  6292         16  PM-CLAIM-ACCUMULATOR       PIC S9(7)V99  COMP-3.
  6293         16  PM-CLAIM-ATTACH-CNT        PIC S9(3)     COMP-3.
  6294         16  PM-CLAIM-LIFE-ITD          PIC S9(7)V99  COMP-3.
  6295         16  PM-CLAIM-AH-ITD            PIC S9(7)V99  COMP-3.
  6296         16  PM-CLAIM-RIDER-ITD         PIC S9(7)V99  COMP-3.
  6297
  6298     12  FILLER                            PIC X(03).
  6299
  6300******************************************************************
  6301*                POLICY STATUS AND DISPOSITION                   *
  6302******************************************************************
  6303
  6304     12  PM-STATUS-DISPOSITION-DATA.
  6305         16  PM-ISSUE-EOM-DT            PIC XX.
  6306         16  PM-REPLACEMENT-SWITCH      PIC X.
  6307         16  PM-APPL-SIGN-DT            PIC XX.
  6308         16  PM-UNDERWRITER             PIC X(3).
  6309         16  PM-ENTRY-PROCESSOR         PIC X(4).
  6310         16  PM-ENTRY-STATUS            PIC X.
  6311             88  PM-NORMAL                 VALUE '1'.
  6312             88  PM-TAKE-OVER              VALUE '2'.
  6313             88  PM-CONVERSION             VALUE '4'.
  6314             88  PM-RE-ISSUE               VALUE '5'.
  6315             88  PM-REINSURANCE-ONLY       VALUE '9'.
  6316         16  PM-ENTRY-DT                PIC XX.
  6317         16  PM-ENTRY-TIME              PIC S9(7) COMP-3.
  6318         16  PM-EXIT-DT                 PIC XX.
  6319         16  PM-CURRENT-STATUS          PIC X.
  6320             88  PM-LAPSE                  VALUE '0'.
  6321             88  PM-ACTIVE                 VALUE '1'.
  6322             88  PM-PENDING-ISSUE          VALUE '2'.
  6323             88  PM-DECLINED               VALUE '3'.
  6324             88  PM-PENDING-CANCEL         VALUE '4'.
  6325             88  PM-PENDING-ISSUE-ERROR    VALUE '5'.
  6326             88  PM-CLAIM-APPLIED          VALUE '6'.
  6327             88  PM-CANCEL                 VALUE '7'.
  6328             88  PM-PENDING-UNWTR-REVW     VALUE '8'.
  6329             88  PM-PENDING-CANCEL-ERROR   VALUE '9'.
  6330             88  PM-CANCEL-TRANSFER        VALUE 'C'.
  6331             88  PM-CLAIM-SETTLEMENT       VALUE 'F'.
  6332             88  PM-TERMINATE              VALUE 'T'.
  6333** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6334** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL150.cbl
  6335** THESE GROUPS.
  6336             88  PM-TYPE-STAT-1
  6337                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6338                                'C' 'F' 'T'.
  6339             88  PM-TYPE-STAT-2
  6340                     VALUES ARE '2' '3' '5' '8'.
  6341             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6342             88  PM-PENDING-STATUS
  6343                                VALUES ARE '2' '4' '5' '8' '9'.
  6344             88  PM-PENDING-ISSUE-STATUS
  6345                                VALUES ARE '2' '5' '8'.
  6346             88  PM-CANCEL-STATUS
  6347                                VALUES ARE '4' '7' '9' 'C'.
  6348         16  PM-CANCEL-CAUSE-CD         PIC X(3).
  6349         16  PM-CANCEL-DT               PIC XX.
  6350         16  PM-REFUND-AMT              PIC S9(5)V99  COMP-3.
  6351         16  PM-CALC-REFUND-AMT         PIC S9(5)V99  COMP-3.
  6352         16  PM-DECLINE-CD              PIC X(3).
  6353         16  PM-DECLINE-DT              PIC XX.
  6354         16  PM-LAST-LAPSE-DT           PIC XX.
  6355         16  PM-LAST-REINSTATE-DT       PIC XX.
  6356         16  PM-SECURITY-ACCESS-CODE    PIC X.
  6357         16  PM-PREV-CONTROL-PRIMARY.
  6358             20  PM-PREV-COMPANY-CD          PIC X.
  6359             20  PM-PREV-CARRIER             PIC X.
  6360             20  PM-PREV-GROUPING.
  6361                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6362                 24  PM-PREV-GROUPING-PRIME  PIC X(3).
  6363             20  PM-PREV-STATE               PIC XX.
  6364             20  PM-PREV-PRODUCER.
  6365                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6366                 24  PM-PREV-PRODUCER-PRIME  PIC X(6).
  6367             20  PM-PREV-POLICY-EFF-DT       PIC XX.
  6368             20  PM-PREV-REFERENCE-NUMBER.
  6369                 24  PM-PREV-REFNO-PRIME     PIC X(18).
  6370                 24  PM-PREV-REFNO-SFX       PIC XX.
  6371         16  PM-ACTION-DT               PIC XX.
  6372         16  PM-ACTION-CODE             PIC X(3).
  6373         16  PM-ACTION-DT-2             PIC XX.
  6374         16  PM-ACTION-CODE-2           PIC X(3).
  6375         16  PM-ACTION-DT-3             PIC XX.
  6376         16  PM-ACTION-CODE-3           PIC X(3).
  6377         16  PM-ACTION-DT-4             PIC XX.
  6378         16  PM-ACTION-CODE-4           PIC X(3).
  6379         16  PM-ACTION-DT-5             PIC XX.
  6380         16  PM-ACTION-CODE-5           PIC X(3).
  6381
  6382         16  PM-KEY-CHANGE              PIC X.
  6383                 88  PM-NO-KEY-CHG   VALUES ARE ' ' 'N'.
  6384                 88  PM-KEY-CHG           VALUE 'Y'.
  6385         16  PM-KEY-CHANGE-DT           PIC XX.
  6386
  6387         16  PM-RTI-INDICATOR           PIC X.
  6388         16  PM-REASON-CODE             PIC X(3).
  6389         16  PM-IN-OUT-PROCESSING-IND   PIC X(1).
  6390             88  PM-IN-OUT-PROCESSING   VALUE 'Y'.
  6391             88  PM-NOT-IN-OUT-PROCESSING
  6392                                           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL150.cbl
  6393
  6394     12  FILLER                            PIC X(12).
  6395
  6396******************************************************************
  6397*                 AGENT AND COMMISSION DATA                      *
  6398******************************************************************
  6399
  6400     12  PM-COMMISSION-DATA.
  6401         16  PM-REMIT-TO                PIC S9(3) COMP-3.
  6402         16  PM-COMM-CHANGE-SW          PIC X.
  6403                 88  PM-COMMISSION-CHANGE  VALUE 'Y'.
  6404         16  PM-AGENT-INFORMATION OCCURS  5 TIMES.
  6405             20  PM-AGENT-NUMBER        PIC X(10).
  6406             20  PM-AGENT-TYPE          PIC X.
  6407                 88  PM-PRODUCER-LEVEL-AGENT
  6408                                              VALUES ARE 'C' 'D'.
  6409                 88  PM-AGENT-GROSS        VALUE 'C'.
  6410                 88  PM-AGENT-REINS        VALUE 'R'.
  6411                 88  PM-AGENT-GROSS-REINS  VALUE 'D'.
  6412                 88  PM-OVERWRITE-GROSS    VALUE 'O'.
  6413                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6414                 88  PM-OVERWRITE-REINS    VALUE 'T'.
  6415                 88  PM-REINS-ONLY         VALUE 'W'.
  6416             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6417                 88  PM-GENERATE-BILL      VALUE 'B'.
  6418                 88  PM-GENERATE-PAID      VALUE 'P'.
  6419             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6420             20  PM-COMP-1ST-YEAR-TYPE  PIC X(1).
  6421                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6422                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6423                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6424             20  PM-RENEWAL-DATA.
  6425                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6426                     28  PM-RENEW-MONTHS  PIC S999    COMP-3.
  6427                     28  PM-RENEW-COMMISSION
  6428                                             PIC S99V999 COMP-3.
  6429                     28  PM-RENEW-TYPE    PIC X(1).
  6430                         88  PM-COMP-RENEW-PERCENT   VALUE '1'.
  6431                         88  PM-COMP-RENEW-DOLLARS   VALUE '2'.
  6432                         88  PM-COMP-RENEW-NOT-USED  VALUE '3'.
  6433             20  PM-COMP-RECALC-FLAG    PIC X(1).
  6434                 88  PM-BYPASS-RECALC      VALUE 'N'.
  6435     12  FILLER                            PIC X(20).
  6436******************************************************************
  6437*             CUSTOMER DATA                                      *
  6438******************************************************************
  6439     12  PM-CUSTOMER-ID                 PIC X(20).
  6440******************************************************************
  6441     12  FILLER                            PIC X(43).
  6442******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL150.cbl
  6444*                COPY MTCPLAN REPLACING ==:TAG:== BY ==PP==.
  6445******************************************************************
  6446*                                                                *
  6447*                            MTCPLAN                             *
  6448*                            VMOD=1.001                          *
  6449*                                                                *
  6450*   MORTGAGE SYSTEM PRODUCER PLAN MASTER FILE.                   *
  6451*                                                                *
  6452*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  6453*   PLAN CODE MASTER FILE.                                       *
  6454*                                                                *
  6455*   FILE DESCRIPTION = PRODUCER PLAN MASTER                      *
  6456*                                                                *
  6457*   FILE TYPE = VSAM,KSDS                                        *
  6458*   RECORD SIZE = 450  RECFORM = FIX                             *
  6459*                                                                *
  6460*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  6461*       ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25   *
  6462*                                                                *
  6463*   LOG = NO                                                     *
  6464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6465*                                                                *
  6466*                                                                *
  6467******************************************************************
  6468
  6469 01  PRODUCER-PLANS.
  6470     12  PP-RECORD-ID                   PIC  X(02).
  6471         88  VALID-PP-ID                      VALUE 'PP'.
  6472
  6473******************************************************************
  6474*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  6475******************************************************************
  6476
  6477     12  PP-CONTROL-PRIMARY.
  6478         16  PP-PROD-PRIMARY.
  6479             20  PP-COMPANY-CD          PIC  X(01).
  6480             20  PP-CONTROL-A.
  6481                 24  PP-CARRIER         PIC  X(01).
  6482                 24  PP-GROUPING.
  6483                     28  PP-GROUPING-PREFIX
  6484                                           PIC  X(03).
  6485                     28  PP-GROUPING-PRIME PIC X(03).
  6486                 24  PP-STATE           PIC  X(02).
  6487                 24  PP-PRODUCER.
  6488                     28  PP-PRODUCER-PREFIX
  6489                                           PIC  X(04).
  6490                     28  PP-PRODUCER-PRIME PIC X(06).
  6491         16  PP-PRODUCER-PLAN.
  6492             20  PP-PLAN-CODE           PIC  X(02).
  6493             20  PP-PLAN-REVISION       PIC  9(03).
  6494     12  FILLER                            PIC  X(20).
  6495
  6496******************************************************************
  6497*      ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25    *
  6498******************************************************************
  6499
  6500     12  PP-CONTROL-BY-VAR-GRP.
  6501         16  PP-COMPANY-CD-A1           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL150.cbl
  6502         16  PP-VG-CARRIER              PIC  X(01).
  6503         16  PP-VG-GROUPING             PIC  X(06).
  6504         16  PP-VG-STATE                PIC  X(02).
  6505         16  PP-VG-PRODUCER             PIC  X(10).
  6506         16  PP-VG-PLAN-CODE            PIC  X(02).
  6507         16  PP-VG-PLAN-REVISION        PIC  X(03).
  6508     12  FILLER                            PIC  X(20).
  6509
  6510******************************************************************
  6511*                PRODUCER SECURITY DATA                          *
  6512******************************************************************
  6513
  6514     12  PP-SECURITY-ACCESS-CODE        PIC  X(01).
  6515     12  PP-POLICY-CNT                  PIC S9(07)    COMP-3.
  6516
  6517******************************************************************
  6518*                FILE SYNCHRONIZATION DATA                       *
  6519******************************************************************
  6520
  6521     12  PP-MAINT-INFORMATION.
  6522         16  PP-LAST-MAINT-DATE         PIC  X(02).
  6523         16  PP-LAST-MAINT-HHMMSS       PIC S9(07)    COMP-3.
  6524         16  PP-LAST-MAINT-USER         PIC  X(04).
  6525     12  FILLER                            PIC  X(10).
  6526
  6527******************************************************************
  6528*                   CRITICAL FILE DATES                          *
  6529******************************************************************
  6530
  6531     12  PP-PLAN-DATES.
  6532         16  PP-PLAN-EFFECT-DATE        PIC  X(02).
  6533         16  PP-PLAN-EXPIRE-DATE        PIC  X(02).
  6534
  6535     12  FILLER                            PIC  X(10).
  6536
  6537******************************************************************
  6538*                GENERAL INFORMATION                             *
  6539******************************************************************
  6540
  6541     12  PP-GENERAL-INFORMATION.
  6542         16  PP-ALPHA-SEARCH-SW         PIC  X(01).
  6543             88  PP-MIB-ALPHA-ALL           VALUE '1'.
  6544             88  PP-MIB-ALPHA-NONE          VALUE '2'.
  6545             88  PP-MIB-ALPHA-EXCEEDED      VALUE '3'.
  6546             88  PP-CLIENT-ALPHA-ALL        VALUE 'A'.
  6547             88  PP-CLIENT-ALPHA-NONE       VALUE 'B'.
  6548             88  PP-CLIENT-ALPHA-EXCEEDED   VALUE 'C'.
  6549             88  PP-BOTH-ALPHA-ALL          VALUE 'X'.
  6550             88  PP-BOTH-ALPHA-NONE         VALUE 'Y'.
  6551             88  PP-BOTH-ALPHA-EXCEEDED     VALUE 'Z'.
  6552             88  PP-ALPHA-SEARCH-VALID VALUES ARE '1' '2' '3'
  6553                                                     'A' 'B' 'C'
  6554                                                     'X' 'Y' 'Z'.
  6555         16  PP-BENEFIT-TYPE            PIC  X(01).
  6556             88  PP-BENEFIT-IS-LEVEL         VALUE '1'.
  6557             88  PP-BENEFIT-REDUCES          VALUE '2'.
  6558         16  PP-DAYS-TO-1ST-NOTICE      PIC  9(02).
  6559         16  PP-DAYS-TO-2ND-NOTICE      PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL150.cbl
  6560         16  PP-DAYS-TO-3RD-NOTICE      PIC  9(02).
  6561         16  PP-DAYS-TO-4TH-NOTICE      PIC  9(02).
  6562         16  PP-EFF-DT-RULE-SW          PIC  X(01).
  6563             88  PP-EFF-DT-ENTER            VALUE 'E'.
  6564             88  PP-EFF-DT-MONTH            VALUE 'M'.
  6565             88  PP-EFF-DT-QTR              VALUE 'Q'.
  6566             88  PP-EFF-DT-SEMI             VALUE 'S'.
  6567             88  PP-EFF-DT-ANN              VALUE 'A'.
  6568         16  PP-FREE-EXAM-DAYS          PIC S9(03)   COMP-3.
  6569         16  PP-GRACE-PERIOD            PIC S9(03)   COMP-3.
  6570         16  PP-HEALTH-QUESTIONS        PIC  9(01).
  6571         16  PP-NUMBER-LAPSE-NOTICES    PIC S9(03)   COMP-3.
  6572         16  PP-MIB-SEARCH-SW           PIC  X(01).
  6573             88  PP-MIB-SEARCH-ALL          VALUE '1'.
  6574             88  PP-MIB-SEARCH-NONE         VALUE '2'.
  6575             88  PP-MIB-SEARCH-EXCEEDED     VALUE '3'.
  6576             88  PP-MIB-SEARCH-VALID   VALUES ARE '1' '2' '3'.
  6577         16  PP-PLAN-ABBREV             PIC  X(03).
  6578         16  PP-PLAN-AGES.
  6579             20  PP-MINIMUM-AGE         PIC S9(03)   COMP-3.
  6580             20  PP-MAXIMUM-AGE         PIC S9(03)   COMP-3.
  6581             20  PP-MAXIMUM-ATTAIN-AGE  PIC S9(03)   COMP-3.
  6582         16  PP-PLAN-BENEFITS.
  6583             20  PP-CLAIM-CAP           PIC S9(07)V99 COMP-3.
  6584             20  PP-MINIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  6585             20  PP-MAXIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  6586             20  PP-MAXIMUM-MONTHLY-BENEFIT
  6587                                           PIC S9(07)V99 COMP-3.
  6588         16  PP-PLAN-DESCRIPTION        PIC  X(10).
  6589         16  PP-POLICY-FEE              PIC S9(03)V9(02)
  6590                                                        COMP-3.
  6591         16  PP-PLAN-IND-GRP            PIC  X(01).
  6592         16  PP-PLAN-SNGL-JNT           PIC  X(01).
  6593             88  PP-COMBINED-PLAN          VALUE 'C'.
  6594             88  PP-JNT-PLAN               VALUE 'J'.
  6595             88  PP-SNGL-PLAN              VALUE 'S'.
  6596         16  PP-PLAN-TERMS.
  6597             20  PP-MINIMUM-TERM        PIC S9(03)   COMP-3.
  6598             20  PP-MAXIMUM-TERM        PIC S9(03)   COMP-3.
  6599         16  PP-PLAN-TYPE               PIC  X(01).
  6600             88  PP-AH-MORT-PLAN           VALUE 'A'.
  6601             88  PP-AD-D-MORT-PLAN         VALUE 'E'.
  6602             88  PP-DISMEM-MORT-PLAN       VALUE 'D'.
  6603             88  PP-LIFE-MORT-PLAN         VALUE 'L'.
  6604         16  PP-PREMIUM-TOLERANCES.
  6605             20  PP-PREM-TOLERANCE      PIC S9(03)   COMP-3.
  6606             20  PP-PREM-TOLERANCE-PCT  PIC SV9(03)  COMP-3.
  6607         16  PP-RATE-CODE               PIC  X(05).
  6608         16  PP-REOCCURRING-DISABILITY-PRD PIC S9(03) COMP-3.
  6609         16  PP-REPLACEMENT-LAW-SW      PIC  X(01).
  6610             88  PP-NO-REPLACE             VALUE '1'.
  6611             88  PP-REPLACE-APPLIES        VALUE '2'.
  6612             88  PP-VALID-REPLACEMENT-LAW  VALUE '1' '2'.
  6613         16  PP-RETRO-RETENTION         PIC S9V9(04) COMP-3.
  6614         16  PP-RERATE-CNTL             PIC  X(01).
  6615             88  PP-RERATE-WITH-ISSUE-AGE    VALUE '1'.
  6616             88  PP-RERATE-WITH-CURRENT-AGE  VALUE '2'.
  6617             88  PP-DO-NOT-RERATE            VALUE '3' ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL150.cbl
  6618             88  PP-AUTO-RECALC              VALUE '4'.
  6619         16  PP-SEX-RATING              PIC  X(01).
  6620             88  PP-NOT-SEX-RATED          VALUE '1'.
  6621             88  PP-SEX-RATED              VALUE '2'.
  6622         16  PP-SUBSTANDARD-DATA.
  6623             20  PP-SUBSTANDARD-PERCENT PIC S9(01)V9(04).
  6624             20  PP-SUBSTANDARD-TYPE    PIC  X(01).
  6625                 88  PP-PCT-OF-BENEFIT     VALUE '1'.
  6626                 88  PP-PCT-OF-PREMIUM     VALUE '2'.
  6627                 88  PP-NOT-APPLICABLE     VALUE '3'.
  6628         16  PP-YEARS-TO-NEXT-RERATE    PIC  9(02).
  6629         16  PP-DEPENDANT-COVERAGE      PIC  X(01).
  6630             88  PP-DEP-COVERED            VALUE 'Y'.
  6631             88  PP-DEP-NOT-COVERED        VALUE 'N' ' '.
  6632         16  PP-REFUND-CALC             PIC  X(01).
  6633             88  PP-RFND-MP-REFUND  VALUES ARE ' ' LOW-VALUES.
  6634             88  PP-RFND-BY-R78            VALUE '1'.
  6635             88  PP-RFND-BY-PRO-RATA       VALUE '2'.
  6636             88  PP-RFND-AS-CALIF          VALUE '3'.
  6637             88  PP-RFND-AS-TEXAS          VALUE '4'.
  6638             88  PP-RFND-IS-NET-PAY        VALUE '5'.
  6639             88  PP-RFND-ANTICIPATION      VALUE '6'.
  6640             88  PP-RFND-MEAN              VALUE '8'.
  6641             88  PP-VALID-REFUND    VALUES ARE ' ' '1' '2' '3'
  6642                                                  '4' '5' '6' '8'
  6643                                                  LOW-VALUES.
  6644         16  PP-ALT-RATE-CODE           PIC  X(05).
  6645
  6646     12  FILLER                            PIC  X(39).
  6647
  6648******************************************************************
  6649*                     PLAN FORMS AND LETTERS                     *
  6650******************************************************************
  6651
  6652     12  PP-PLAN-MASTER-FORMS.
  6653         16  PP-POLICY-FORM             PIC  X(12).
  6654         16  PP-MASTER-APPLICATION      PIC  X(12).
  6655         16  PP-MASTER-POLICY           PIC  X(12).
  6656     12  PP-DELINQUENCY-NOTICE-FORMS.
  6657         16  PP-1ST-NOTICE-FORM         PIC  X(04).
  6658         16  PP-2ND-NOTICE-FORM         PIC  X(04).
  6659         16  PP-3RD-NOTICE-FORM         PIC  X(04).
  6660         16  PP-4TH-NOTICE-FORM         PIC  X(04).
  6661     12  FILLER                            PIC  X(32).
  6662     12  PP-TERMINATION-FORM            PIC  X(04).
  6663     12  FILLER                            PIC  X(08).
  6664     12  PP-ISSUE-LETTER                PIC  X(04).
  6665
  6666     12  FILLER                            PIC  X(80).
  6667******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 127
* EL150.cbl
  6669*                COPY MTCPROD REPLACING ==:TAG:== BY ==PD==.
  6670******************************************************************
  6671*                                                                *
  6672*                            MTCPROD                             *
  6673*                            VMOD=1.001                          *
  6674*                                                                *
  6675*   MORTGAGE SYSTEM PRODUCER MASTER FILE                         *
  6676*                                                                *
  6677*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  6678*   VSAM PRODUCER MASTER FILE.                                   *
  6679*                                                                *
  6680*   FILE DESCRIPTION = PRODUCER MASTER FILE                      *
  6681*                                                                *
  6682*   FILE TYPE = VSAM,KSDS                                        *
  6683*   RECORD SIZE = 2000 RECFORM = FIXED                           *
  6684*                                                                *
  6685*   BASE CLUSTER NAME = MPPROD                    RKP=02,LEN=22  *
  6686*       ALTERNATE PATH1 = MPPROD2 (ALT GROUPING)  RKP=48,LEN=22  *
  6687*       ALTERNATE PATH2 = MPPROD3 (PRODUCER NAME) RKP=90,LEN=56  *
  6688*                                                                *
  6689*   LOG = NO                                                     *
  6690*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6691*                                                                *
  6692*                                                                *
  6693******************************************************************
  6694
  6695 01  PRODUCER-MASTER.
  6696     12  PD-RECORD-ID              PIC  X(02).
  6697         88  PD-VALID-ID                VALUE 'PD'.
  6698
  6699******************************************************************
  6700*   BASE CLUSTER NAME = MPPROD                    RKP=2,LEN=22   *
  6701******************************************************************
  6702
  6703     12  PD-CONTROL-PRIMARY-BATCH.
  6704         16  FILLER                   PIC  X(20).
  6705         16  PD-EXPIRE-DT.
  6706             20  PD-EXPIRE-DT-YY   PIC  9(02).
  6707             20  PD-EXPIRE-DT-MM   PIC  9(02).
  6708             20  PD-EXPIRE-DT-DD   PIC  9(02).
  6709     12  FILLER REDEFINES PD-CONTROL-PRIMARY-BATCH.
  6710         16  PD-CONTROL-PRIMARY.
  6711             20  PD-COMPANY-CD     PIC  X(01).
  6712             20  PD-MSTR-CNTRL.
  6713                 24  PD-CONTROL-A.
  6714                     28  PD-CARRIER PIC X(01).
  6715                     28  PD-GROUPING.
  6716                         32 PD-GROUPING-PREFIX
  6717                                      PIC  X(03).
  6718                         32 PD-GROUPING-PRIME
  6719                                      PIC  X(03).
  6720                     28  PD-STATE  PIC  X(02).
  6721                     28  PD-PRODUCER.
  6722                         32  PD-PRODUCER-PREFIX
  6723                                      PIC  X(04).
  6724                         32  PD-PRODUCER-PRIME
  6725                                      PIC  X(06).
  6726                 24  PD-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 128
* EL150.cbl
  6727                     28  PD-EXPIRE-DATE
  6728                                      PIC  X(02).
  6729         16  FILLER REDEFINES PD-CONTROL-PRIMARY.
  6730             20  FILLER               PIC  X(01).
  6731             20  PD-CGSPE-KEY      PIC  X(21).
  6732         16  FILLER                   PIC  X(04).
  6733     12  FILLER                       PIC  X(20).
  6734
  6735******************************************************************
  6736*      ALTERNATE PATH1 = MPPROD2 (ALT GROUPING) RKP=48,LEN=22    *
  6737******************************************************************
  6738
  6739     12  PD-CONTROL-BY-VAR-GRP.
  6740         16  PD-VG-CCGSP-KEYLET.
  6741             20  PD-COMPANY-CD-A1  PIC  X(01).
  6742             20  PD-VG-CARRIER     PIC  X(01).
  6743             20  PD-VG-GROUPING    PIC  X(06).
  6744             20  PD-VG-STATE       PIC  X(02).
  6745             20  PD-VG-PRODUCER    PIC  X(10).
  6746         16  PD-VG-DATE.
  6747             24  PD-VG-EXPIRE-DATE PIC  X(02).
  6748     12  FILLER                       PIC  X(20).
  6749
  6750
  6751******************************************************************
  6752*      ALTERNATE PATH2 = MPPROD3 (NAME)         RKP=90,LEN=56    *
  6753******************************************************************
  6754
  6755     12  PD-CONTROL-BY-NAME.
  6756         16  PD-COMPANY-CD-A2      PIC  X(01).
  6757         16  PD-NAME-A2            PIC  X(30).
  6758         16  PD-CGSPE-KEY-A2.
  6759             20  PD-CARRIER-A2     PIC  X(01).
  6760             20  PD-GROUPING-A2    PIC  X(06).
  6761             20  PD-STATE-A2       PIC  X(02).
  6762             20  PD-PRODUCER-A2    PIC  X(10).
  6763             20  PD-EXPIRE-DATE-A2 PIC  X(02).
  6764         16  PD-CURRENT-DATE-BIN-A2 PIC X(02).
  6765         16  PD-CURRENT-TIME-BIN-A2 PIC S9(04) COMP.
  6766     12  FILLER                       PIC  X(20).
  6767
  6768******************************************************************
  6769*                FILE SYNCHRONIZATION DATA                       *
  6770******************************************************************
  6771
  6772     12  PD-MAINT-INFORMATION.
  6773         16  PD-LAST-MAINT-DATE    PIC  X(02).
  6774         16  PD-LAST-MAINT-HHMMSS  PIC S9(07) COMP-3.
  6775         16  PD-LAST-MAINT-USER    PIC  X(04).
  6776
  6777******************************************************************
  6778*                PRODUCER SECURITY DATA                          *
  6779******************************************************************
  6780
  6781     12  PD-SECURITY-ACCESS-CODE   PIC  X(01).
  6782
  6783******************************************************************
  6784*                DATES                                           *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 129
* EL150.cbl
  6785******************************************************************
  6786
  6787     12  PD-ANNIVERSARY-DATE       PIC  X(02).
  6788
  6789     12  PD-AR-HI-DATE.
  6790         16  PD-AR-HI-POLICY-DATE  PIC  X(02).
  6791         16  FILLER                   PIC  X(04).
  6792     12  PD-AR-HI-POLICY-DT REDEFINES PD-AR-HI-DATE.
  6793         16  PD-AR-HI-POLICY-DT-YY PIC  9(02).
  6794         16  PD-AR-HI-POLICY-DT-MM PIC  9(02).
  6795         16  PD-AR-HI-POLICY-DT-DD PIC  9(02).
  6796
  6797     12  PD-ENTRY-DATE             PIC  X(02).
  6798
  6799     12  PD-EFFECT-DTE.
  6800         16  PD-EFFECT-DATE        PIC  X(02).
  6801         16  FILLER                   PIC  X(04).
  6802     12  PD-EFFECT-DT REDEFINES PD-EFFECT-DTE.
  6803         16  PD-EFFECT-DT-YY       PIC  9(02).
  6804         16  PD-EFFECT-DT-MM       PIC  9(02).
  6805         16  PD-EFFECT-DT-DD       PIC  9(02).
  6806
  6807     12  PD-HI-DATE.
  6808         16  PD-HI-POLICY-DATE     PIC  X(02).
  6809         16  FILLER                   PIC  X(04).
  6810     12  PD-HI-POLICY-DT REDEFINES PD-HI-DATE.
  6811         16  PD-HI-POLICY-DT-YY    PIC  9(02).
  6812         16  PD-HI-POLICY-DT-MM    PIC  9(02).
  6813         16  PD-HI-POLICY-DT-DD    PIC  9(02).
  6814
  6815     12  PD-INACTIVE-DATE          PIC  X(02).
  6816
  6817     12  PD-LO-DATE.
  6818         16  PD-LO-POLICY-DATE     PIC  X(02).
  6819         16  FILLER                   PIC  X(04).
  6820     12  PD-LO-POLICY-DT REDEFINES PD-LO-DATE.
  6821         16  PD-LO-POLICY-DT-YY    PIC  9(02).
  6822         16  PD-LO-POLICY-DT-MM    PIC  9(02).
  6823         16  PD-LO-POLICY-DT-DD    PIC  9(02).
  6824
  6825     12  PD-POLICIES-PURGED-DATE   PIC  X(02).
  6826
  6827     12  PD-PREV-DATES.
  6828         16  PD-PREV-EFF-DATE      PIC  X(02).
  6829         16  FILLER                   PIC  X(04).
  6830         16  PD-PREV-EXP-DATE      PIC  X(02).
  6831         16  FILLER                   PIC  X(04).
  6832     12  PD-PREV-DTS REDEFINES PD-PREV-DATES.
  6833         16  PD-PREV-EFF-DT.
  6834             20  PD-PREV-EFF-DT-YY PIC  9(02).
  6835             20  PD-PREV-EFF-DT-MM PIC  9(02).
  6836             20  PD-PREV-EFF-DT-DD PIC  9(02).
  6837         16  PD-PREV-EXP-DT.
  6838             20  PD-PREV-EXP-DT-YY PIC  9(02).
  6839             20  PD-PREV-EXP-DT-MM PIC  9(02).
  6840             20  PD-PREV-EXP-DT-DD PIC  9(02).
  6841
  6842     12  PD-1ST-PROD-DATE          PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 130
* EL150.cbl
  6843
  6844     12  FILLER                       PIC  X(20).
  6845
  6846******************************************************************
  6847*                MORTGAGE BILLING DATA                           *
  6848******************************************************************
  6849
  6850     12  PD-CONTACT                PIC  X(30).
  6851     12  PD-BILLING-MONTHS.
  6852         16  PD-BILLING-MONTH-ANNUAL PIC 9(02).
  6853         16  PD-BILLING-MONTH-SEMIANN PIC 9(02).
  6854     12  PD-BILLING-ADVANCE-ARREARS PIC X(01).
  6855         88  PD-BILL-ADVANCE           VALUE '1'.
  6856         88  PD-BILL-ARREARS           VALUE '2'.
  6857     12  PD-BILLING-MODE           PIC  X(01).
  6858         88  PD-ANNUAL-BILL            VALUE '1'.
  6859         88  PD-SEMI-ANNUAL-BILL       VALUE '2'.
  6860         88  PD-QUARTERLY-BILL         VALUE '3'.
  6861         88  PD-MONTHLY-BILL           VALUE '4'.
  6862         88  PD-BI-MONTHLY-BILL        VALUE '5'.
  6863         88  PD-SINGLE-PREM-BILL       VALUE '6'.
  6864     12  PD-BILLING-GROUPING-CODE  PIC  X(06).
  6865     12  PD-BILLING-SCHEDULE       PIC  X(01).
  6866         88  PD-BILL-1ST-WEEK          VALUE '1'.
  6867         88  PD-BILL-2ND-WEEK          VALUE '2'.
  6868         88  PD-BILL-3RD-WEEK          VALUE '3'.
  6869         88  PD-BILL-4TH-WEEK          VALUE '4'.
  6870         88  PD-BILL-5TH-WEEK          VALUE '5'.
  6871         88  PD-HOLD-BILL              VALUE '6'.
  6872         88  PD-NO-BILL                VALUE '7'.
  6873     12  PD-BILLING-SEQUENCE       PIC  X(01).
  6874         88  PD-BILL-NAME-SEQU         VALUE '1'.
  6875         88  PD-BILL-LOAN-SEQU         VALUE '2'.
  6876         88  PD-BILL-PLCY-SEQU         VALUE '3'.
  6877     12  PD-BILLING-TYPE           PIC  X(01).
  6878         88  PD-LIST-BILL              VALUE '1'.
  6879         88  PD-TAPE-BILL              VALUE '2'.
  6880         88  PD-TAPE-LIST-BILL         VALUE '3'.
  6881         88  PD-GROUP-BILL         VALUES ARE '1' '2' '3'.
  6882         88  PD-DIRECT-BILL            VALUE '4'.
  6883         88  PD-PAC                VALUES ARE '5' 'C' 'S'.
  6884         88  PD-CREDIT-CARD            VALUE '6'.
  6885         88  PD-INDIV-BILL
  6886                              VALUES ARE '4' '5' '6' 'C' 'S'.
  6887         88  PD-GROUP-BY-POLICY        VALUE '7'.
  6888         88  PD-GROUP-BY-POLICY-PAC    VALUE '8'.
  6889         88  PD-GROUP-BY-POLICY-CRDC   VALUE '9'.
  6890         88  PD-GROUP-BY-BILL          VALUE '7' '8' '9'.
  6891         88  PD-GROUP-BY-PROD          VALUE 'A'.
  6892         88  PD-EFT-CHECKING           VALUE 'C'.
  6893         88  PD-EFT-SAVINGS            VALUE 'S'.
  6894     12  PD-DATE-PAID              PIC  X(02).
  6895     12  PD-LAST-BILLING-DATE      PIC  X(02).
  6896     12  PD-LAST-BILL-TO-DATE      PIC  X(02).
  6897     12  PD-MAX-MONTHS-BILL        PIC S9(03)  COMP-3.
  6898     12  PD-PAID-TO-DATE           PIC  X(02).
  6899     12  PD-PREV-BILLING-DATE      PIC  X(02).
  6900     12  PD-PREV-BILL-TO-DATE      PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 131
* EL150.cbl
  6901
  6902     12  FILLER                       PIC  X(20).
  6903
  6904******************************************************************
  6905*                PERSONAL DATA                                   *
  6906******************************************************************
  6907
  6908     12  PD-ADDRS                  PIC  X(30).
  6909     12  PD-CITY                   PIC  X(30).
  6910     12  PD-CITY-CODE              PIC  X(04).
  6911     12  PD-COUNTY-CODE            PIC  X(03).
  6912     12  PD-NAME                   PIC  X(30).
  6913     12  PD-PARRISH-CODE           PIC  X(03).
  6914     12  PD-PERSON                 PIC  X(30).
  6915     12  PD-TEL-NO.
  6916         16  PD-AREA-CODE          PIC  9(03).
  6917         16  PD-TEL-PRE            PIC  9(03).
  6918         16  PD-TEL-NBR            PIC  9(04).
  6919     12  PD-ZIP.
  6920         16  PD-ZIP-PRIME          PIC  X(05).
  6921         16  PD-ZIP-PLUS4          PIC  X(04).
  6922     12  PD-LANGUAGE-IND           PIC  X(01).
  6923         88  PD-ENGLISH                       VALUE 'E'.
  6924         88  PD-FRENCH                        VALUE 'F'.
  6925         88  PD-SPANISH                       VALUE 'S'.
  6926
  6927     12  FILLER                       PIC  X(19).
  6928
  6929******************************************************************
  6930*                REINSURANCE DATA                                *
  6931******************************************************************
  6932
  6933     12  PD-REINS-TBL-CODE         PIC  X(03).
  6934     12  PD-REIN-RECALC            PIC  X(01).
  6935
  6936     12  PD-REI-AH-FEE             PIC S9(01)V9(04) COMP-3.
  6937     12  PD-REI-AH-PE              PIC  X(01).
  6938     12  PD-REI-AH-TAX             PIC S9(01)V9(04) COMP-3.
  6939
  6940     12  PD-REI-GROUP-A            PIC  X(06).
  6941     12  PD-REI-GROUP-B            PIC  X(06).
  6942
  6943     12  PD-REI-LF-FEE             PIC S9(01)V9(04) COMP-3.
  6944     12  PD-REI-LF-PE              PIC  X(01).
  6945     12  PD-REI-LF-TAX             PIC S9(01)V9(04) COMP-3.
  6946
  6947     12  PD-REI-MORT               PIC  X(04).
  6948     12  PD-REI-PRT-OW             PIC  X(01).
  6949     12  PD-REI-PRT-ST             PIC  X(01).
  6950
  6951     12  PD-REI-ADD-FEE            PIC S9(01)V9(04) COMP-3.
  6952     12  PD-REI-ADD-PE             PIC  X(01).
  6953     12  PD-REI-ADD-TAX            PIC S9(01)V9(04) COMP-3.
  6954
  6955     12  PD-REI-DIS-FEE            PIC S9(01)V9(04) COMP-3.
  6956     12  PD-REI-DIS-PE             PIC  X(01).
  6957     12  PD-REI-DIS-TAX            PIC S9(01)V9(04) COMP-3.
  6958
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 132
* EL150.cbl
  6959     12  FILLER                       PIC  X(10).
  6960******************************************************************
  6961*                RETRO DATA                                      *
  6962******************************************************************
  6963
  6964     12  PD-RET-AH                 PIC S9(01)V9(04) COMP-3.
  6965     12  PD-RET-GRP                PIC  X(06).
  6966     12  PD-RET-LF                 PIC S9(01)V9(04) COMP-3.
  6967     12  PD-RET-MIN-LOSS-A         PIC SV9(03)      COMP-3.
  6968     12  PD-RET-MIN-LOSS-L         PIC SV9(03)      COMP-3.
  6969     12  PD-RET-P-E                PIC  X(01).
  6970     12  PD-RET-ST-TAX-USE         PIC  X(01).
  6971         88  PD-CHARGE-ST-TAXES-ON-RETRO   VALUE 'Y' 'E' 'P'.
  6972         88  PD-TAXES-NOT-IN-RETRO         VALUE 'N' ' '.
  6973     12  PD-RET-Y-N                PIC  X(01).
  6974     12  PD-RET-ADD                PIC S9(01)V9(04) COMP-3.
  6975     12  PD-RET-MIN-LOSS-ADD       PIC SV9(03)      COMP-3.
  6976     12  PD-RET-DIS                PIC S9(01)V9(04) COMP-3.
  6977     12  PD-RET-MIN-LOSS-DIS       PIC SV9(03)      COMP-3.
  6978
  6979     12  FILLER                       PIC  X(10).
  6980
  6981******************************************************************
  6982*                     MANAGEMENT OPTIONS                         *
  6983******************************************************************
  6984
  6985     12  PD-DEFAULT-UNWTR-CODE     PIC  X(03).
  6986     12  PD-LAPSE-NOTICE-CNTL      PIC  X(01).
  6987     12  PD-CORRESPONDENCE-CNTL    PIC  X(01).
  6988     12  PD-RETAIN-BILLING-DATA-MTHS PIC S9(03) COMP-3.
  6989     12  PD-RETAIN-CLAIM-DATA-MTHS PIC S9(03)  COMP-3.
  6990     12  PD-RETAIN-COMMISSION-MTHS PIC S9(03)  COMP-3.
  6991     12  PD-RETAIN-DELINQUENCY-MTHS PIC S9(03) COMP-3.
  6992     12  PD-RETAIN-INSD-PROFILE-MTHS PIC S9(03) COMP-3.
  6993     12  PD-RETAIN-INS-COVERAGE-MTHS PIC S9(03) COMP-3.
  6994     12  PD-RETAIN-STATUS-DISP-MTHS PIC S9(03) COMP-3.
  6995     12  PD-NUM-BILLING-CYCLES-RETAINED
  6996                                      PIC S9(03)  COMP-3.
  6997     12  PD-RETAIN-UNDERWRITER-HST-MTHS
  6998                                      PIC S9(03)  COMP-3.
  6999
  7000     12  FILLER                       PIC X(098).
  7001
  7002
  7003******************************************************************
  7004*                MISCELLANEOUS DATA                              *
  7005******************************************************************
  7006
  7007     12  PD-AH-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7008     12  PD-AUTO-REFUND-SW         PIC  X(01).
  7009         88  PD-AUTO-REFUNDS-USED          VALUE 'Y'.
  7010         88  PD-AUTO-REFUNDS-NOT-USED      VALUE 'N' ' '.
  7011     12  PD-BUSINESS-TYPE          PIC  9(02).
  7012     12  PD-CAL-TABLE              PIC  X(02).
  7013     12  PD-COMMENTS.
  7014         16  PD-COMMENT-LINE       PIC  X(50)
  7015                                           OCCURS 5 TIMES.
  7016     12  PD-EMPLOYER-STMT-USED     PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 133
* EL150.cbl
  7017     12  PD-GROUPED-CHECKS-Y-N     PIC  X(01).
  7018     12  PD-IG                     PIC  X(01).
  7019         88  PD-HAS-INDIVIDUAL             VALUE 'I'
  7020                                                    '1'.
  7021         88  PD-HAS-GROUP                  VALUE 'G'
  7022                                                    '2'.
  7023     12  PD-LF-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7024     12  PD-REPORT-CODE-1          PIC  X(10).
  7025     12  PD-REPORT-CODE-2          PIC  X(10).
  7026     12  PD-RPT045A-SWITCH         PIC  X(01).
  7027         88  PD-RPT045A-OFF             VALUE 'N'.
  7028     12  PD-SPECIAL-BILLING-FREQ   PIC  X(01).
  7029         88  PD-HAS-SPECIAL-BILL-FREQ      VALUE 'Y'.
  7030         88  PD-NO-SPECIAL-BILL-FREQ       VALUE 'N' ' '.
  7031     12  PD-STATUS                 PIC  X(01).
  7032         88  PD-STATUS-ACTIVE              VALUE '0'.
  7033         88  PD-STATUS-INACTIVE            VALUE '1'.
  7034     12  PD-STD-AH-TYPE            PIC  X(02).
  7035     12  PD-TAX-NUMBER             PIC  X(11).
  7036     12  PD-TOL-CLM                PIC S9(03)V9(02) COMP-3.
  7037     12  PD-USER-FIELDS.
  7038         16  PD-USER-FLD-1         PIC  X(02).
  7039         16  PD-USER-FLD-2         PIC  X(02).
  7040         16  PD-USER-FLD-3         PIC  X(02).
  7041         16  PD-USER-FLD-4         PIC  X(02).
  7042         16  PD-USER-FLD-5         PIC  X(02).
  7043     12  PD-USER-SELECT-OPTIONS.
  7044         16  PD-USER-SELECT-1      PIC  X(10).
  7045         16  PD-USER-SELECT-2      PIC  X(10).
  7046         16  PD-USER-SELECT-3      PIC  X(10).
  7047         16  PD-USER-SELECT-4      PIC  X(10).
  7048         16  PD-USER-SELECT-5      PIC  X(10).
  7049     12  PD-DIS-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7050     12  PD-ADD-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7051     12  FILLER                       PIC  X(20).
  7052
  7053******************************************************************
  7054*                CLIENT USE AREAS                                *
  7055******************************************************************
  7056
  7057     12  PD-CLIENT-USE-AREA-1      PIC  X(30).
  7058     12  PD-CLIENT-USE-AREA-2      PIC  X(30).
  7059     12  PD-CLIENT-USE-AREA-3      PIC  X(11).
  7060     12  PD-CLIENT-USE-AREA-4      PIC  X(30).
  7061     12  PD-CLIENT-USE-AREA-5      PIC  X(30).
  7062     12  PD-CLIENT-USE-AREA-6      PIC  X(11).
  7063     12  PD-CLIENT-USE-AREA-7      PIC  X(30).
  7064     12  PD-CLIENT-USE-AREA-8      PIC  X(30).
  7065     12  PD-CLIENT-USE-AREA-9      PIC  X(11).
  7066
  7067******************************************************************
  7068*                TRANSFER DATA                                   *
  7069******************************************************************
  7070     12  PD-TRANSFERRED-FROM.
  7071         16  PD-TRNFROM-CARRIER    PIC  X(01).
  7072         16  PD-TRNFROM-GROUPING.
  7073             20  PD-TRNFROM-GRP-PREFIX
  7074                                      PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 134
* EL150.cbl
  7075             20  PD-TRNFROM-GRP-PRIME PIC X(03).
  7076         16  PD-TRNFROM-STATE      PIC  X(02).
  7077         16  PD-TRNFROM-PRODUCER.
  7078             20  PD-TRNFROM-PROD-PREFIX
  7079                                      PIC  X(04).
  7080             20  PD-TRNFROM-PROD-PRIME
  7081                                      PIC  X(06).
  7082         16  PD-TRNFROM-DATE       PIC  X(02).
  7083     12  PD-TRANSFERRED-TO.
  7084         16  PD-TRNTO-CARRIER      PIC  X(01).
  7085         16  PD-TRNTO-GROUPING.
  7086             20  PD-TRNTO-GRP-PREFIX PIC X(03).
  7087             20  PD-TRNTO-GRP-PRIME PIC X(03).
  7088         16  PD-TRNTO-STATE        PIC  X(02).
  7089         16  PD-TRNTO-PRODUCER.
  7090             20  PD-TRNTO-PROD-PREFIX PIC X(04).
  7091             20  PD-TRNTO-PROD-PRIME PIC X(06).
  7092         16  PD-TRNTO-DATE         PIC  X(02).
  7093     12  FILLER                       PIC  X(20).
  7094
  7095******************************************************************
  7096*                MORTGAGE PLANS SOLD                             *
  7097******************************************************************
  7098
  7099     12  PD-PLANS-SOLD.
  7100         16  PD-PRODUCER-PLANS OCCURS 40 TIMES
  7101                                INDEXED BY PD-PLAN-NDX
  7102                                           PD-PLAN-NDX2.
  7103             20  PD-INDIVIDUAL-PLAN.
  7104                 24  PD-PLAN-CODE  PIC  X(02).
  7105                 24  PD-PLAN-REVISION PIC X(03).
  7106             20  PD-IBNR-PERCENT   PIC S9(01)V9(04) COMP-3.
  7107     12  FILLER                       PIC  X(54).
  7108
  7109******************************************************************
  7110*                 AGENT AND COMMISSION DATA                      *
  7111******************************************************************
  7112
  7113     12  PD-COMMISSION-INFORMATION.
  7114         16  PD-REMIT-TO           PIC S9(03)   COMP-3.
  7115         16  PD-RECALCULATION-SW   PIC  X(01).
  7116             88  PD-RECALC-DETAIL          VALUE 'Y'.
  7117             88  PD-RECALC-NO-DETAIL       VALUE 'I'.
  7118             88  PD-IGNORE-RECALC          VALUE 'N'.
  7119             88  PD-VALID-RECALCULATION-SW VALUE 'Y' 'I' 'N'.
  7120         16  PD-AGENT-DATA.
  7121             20  PD-AGENT-ENTRY    OCCURS 5 TIMES
  7122                                    INDEXED BY PD-AGENT-NDX
  7123                                               PD-AGENT-NDX2.
  7124                 24  PD-AGENT-NUMBER PIC X(10).
  7125                 24  PD-AGENT-TYPE PIC  X(01).
  7126                     88  PD-AGENT-TYPE-A   VALUE 'C' 'D'.
  7127                     88  PD-AGENT-TYPE-G   VALUE 'O' 'R'
  7128                                                    'P' 'T'
  7129                                                    'W'.
  7130                     88  PD-AGENT-GROSS    VALUE 'C'.
  7131                     88  PD-AGENT-REINS    VALUE 'R'.
  7132                     88  PD-AGENT-GROSS-REINS VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 135
* EL150.cbl
  7133                     88  PD-OVERWRITE-GROSS VALUE 'O'.
  7134                     88  PD-OVERWRITE-GROSS-REINS
  7135                                          VALUE 'P'.
  7136                     88  PD-OVERWRITE-REINS VALUE 'T'.
  7137                     88  PD-REINS-ONLY     VALUE 'W'.
  7138                     88  PD-VALID-AGENT-TYPE VALUE 'C' 'R'
  7139                                                'D' 'O' 'P'
  7140                                                'T' 'W'.
  7141                 24  PD-COMMISSION-BILLED-PAID
  7142                                      PIC  X(01).
  7143                     88  PD-AGENT-BILLED   VALUE 'B'.
  7144                     88  PD-AGENT-PAID     VALUE 'P'.
  7145                 24  PD-COMP-RECALC-FLAG
  7146                                      PIC  X(01).
  7147                     88  PD-BYPASS-RECALC  VALUE 'N'.
  7148                     88  PD-VALID-RECALC-FLAG VALUE ' ' 'N'.
  7149     12  FILLER                       PIC  X(55).
  7150
  7151******************************************************************
  7152*                BANK DATA                                       *
  7153******************************************************************
  7154
  7155     12  PD-BANK-ACCOUNT-NUMBER    PIC  X(20).
  7156     12  PD-BANK-TRANSIT-NUMBER.
  7157         16  PD-FEDERAL-NUMBER     PIC  X(04).
  7158         16  PD-BANK-NUMBER        PIC  X(04).
  7159     12  PD-CHARGE-CARD-EXP-DT     PIC  X(02).
  7160     12  PD-CHARGE-CARD-TYPE       PIC  X(02).
  7161         88  PD-AMERICAN-EXPRESS              VALUE 'AE'.
  7162         88  PD-CARTE-BLANCHE                 VALUE 'CB'.
  7163         88  PD-DINERS-CLUB                   VALUE 'DN'.
  7164         88  PD-DISCOVER                      VALUE 'DS'.
  7165         88  PD-MASTER-CARD                   VALUE 'MC'.
  7166         88  PD-VISA                          VALUE 'VI'.
  7167     12  PD-SIGNATURE-NAME         PIC  X(25).
  7168     12  PD-AUTHORIZATION-SW       PIC  X(01).
  7169******************************************************************
  7170*                GENERIC FILLER                                  *
  7171******************************************************************
  7172
  7173     12  FILLER                       PIC  X(66).
  7174
  7175******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 136
* EL150.cbl
  7177*                            COPY ELCRETR.
  7178******************************************************************
  7179*                                                                *
  7180*                                                                *
  7181*                            ELCRETR.                            *
  7182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7183*                            VMOD=2.002                          *
  7184*                                                                *
  7185*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *
  7186*                                                                *
  7187*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *
  7188*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *
  7189*   ****      DUPLICATED IN THE OTHER.                           *
  7190*                                                                *
  7191*   FILE TYPE = VSAM,KSDS                                        *
  7192*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7193*                                                                *
  7194*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *
  7195*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *
  7196*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7197*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *
  7198*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)
  7199*                                                 RKP=75,LEN=21  *
  7200*                                                                *
  7201*   LOG = YES                                                    *
  7202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7203******************************************************************
  7204 01  RETRIEVE-MASTER.
  7205     12  RL-RECORD-ID                PIC XX.
  7206         88  VALID-RL-ID         VALUE 'RL'.
  7207
  7208     12  RL-CONTROL-PRIMARY.
  7209         16  RL-COMPANY-CD           PIC X.
  7210         16  RL-CARRIER              PIC X.
  7211         16  RL-CLAIM-NO             PIC X(7).
  7212         16  RL-CERT-NO.
  7213             20  RL-CERT-PRIME       PIC X(10).
  7214             20  RL-CERT-SFX         PIC X.
  7215
  7216     12  RL-CONTROL-BY-NAME.
  7217         16  RL-COMPANY-CD-A1        PIC X.
  7218         16  RL-INSURED-LAST-NAME    PIC X(15).
  7219         16  RL-INSURED-NAME.
  7220             20  RL-INSURED-1ST-NAME PIC X(12).
  7221             20  RL-INSURED-MID-INIT PIC X.
  7222
  7223     12  RL-CONTROL-BY-SSN.
  7224         16  RL-COMPANY-CD-A2        PIC X.
  7225         16  RL-SOC-SEC-NO.
  7226             20  RL-SSN-STATE        PIC XX.
  7227             20  RL-SSN-ACCOUNT      PIC X(6).
  7228             20  RL-SSN-LN3          PIC X(3).
  7229
  7230     12  RL-CONTROL-BY-CERT-NO.
  7231         16  RL-COMPANY-CD-A4        PIC X.
  7232         16  RL-CERT-NO-A4.
  7233             20  RL-CERT-A4-PRIME    PIC X(10).
  7234             20  RL-CERT-A4-SFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 137
* EL150.cbl
  7235
  7236     12  RL-CONTROL-BY-CCN.
  7237         16  RL-COMPANY-CD-A5        PIC X.
  7238         16  RL-CCN-A5.
  7239             20  RL-CCN-NO.
  7240                 24  RL-CCN-PREFIX-A5 PIC X(4).
  7241                 24  RL-CCN-PRIME-A5 PIC X(12).
  7242             20  RL-CCN-FILLER-A5    PIC X(4).
  7243
  7244     12  RL-INSURED-PROFILE-DATA.
  7245         16  RL-INSURED-BIRTH-DT     PIC XX.
  7246         16  RL-INSURED-SEX-CD       PIC X.
  7247             88  RL-INSURED-IS-MALE     VALUE 'M'.
  7248             88  RL-INSURED-IS-FEMALE   VALUE 'F'.
  7249             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.
  7250         16  RL-INSURED-OCC-CD       PIC X(6).
  7251         16  FILLER                  PIC X(5).
  7252
  7253     12  RL-PROCESSING-INFO.
  7254         16  RL-PROCESSOR-ID         PIC X(4).
  7255         16  RL-CLAIM-STATUS         PIC X.
  7256             88  RL-CLAIM-IS-OPEN       VALUE 'O'.
  7257             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.
  7258         16  RL-CLAIM-TYPE           PIC X.
  7259*            88  RL-AH-CLAIM            VALUE 'A'.
  7260*            88  RL-LIFE-CLAIM          VALUE 'L'.
  7261*            88  RL-PROPERTY-CLAIM      VALUE 'P'.
  7262*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.
  7263         16  RL-CLAIM-PREM-TYPE      PIC X.
  7264             88  RL-SINGLE-PREMIUM         VALUE '1'.
  7265             88  RL-O-B-COVERAGE           VALUE '2'.
  7266             88  RL-OPEN-END-COVERAGE      VALUE '3'.
  7267         16  RL-INCURRED-DT          PIC XX.
  7268         16  RL-REPORTED-DT          PIC XX.
  7269         16  RL-FILE-ESTABLISH-DT    PIC XX.
  7270         16  RL-EST-END-OF-DISAB-DT  PIC XX.
  7271         16  RL-LAST-PMT-DT          PIC XX.
  7272         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7273         16  RL-PAID-THRU-DT         PIC XX.
  7274         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7275         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7276         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7277         16  RL-PMT-CALC-METHOD      PIC X.
  7278             88  RL-360-DAY-YR          VALUE '1'.
  7279             88  RL-365-DAY-YR          VALUE '2'.
  7280             88  RL-FULL-MONTHS         VALUE '3'.
  7281         16  RL-CAUSE-CD             PIC X(6).
  7282
  7283         16  RL-PRIME-CERT-NO.
  7284             20  RL-PRIME-CERT-PRIME PIC X(10).
  7285             20  RL-PRIME-CERT-SFX   PIC X.
  7286
  7287         16  RL-SYSTEM-IDENTIFIER    PIC XX.
  7288             88  RL-CREDIT-CLAIM        VALUE 'CR'.
  7289             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7290
  7291         16  RL-MICROFILM-NO         PIC X(10).
  7292         16  RL-PROG-FORM-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 138
* EL150.cbl
  7293         16  RL-LAST-ADD-ON-DT       PIC XX.
  7294
  7295         16  RL-LAST-REOPEN-DT       PIC XX.
  7296         16  RL-LAST-CLOSE-DT        PIC XX.
  7297         16  RL-LAST-CLOSE-REASON    PIC X.
  7298             88  RL-FINAL-PAID          VALUE '1'.
  7299             88  RL-CLAIM-DENIED        VALUE '2'.
  7300             88  RL-AUTO-CLOSE          VALUE '3'.
  7301             88  RL-MANUAL-CLOSE        VALUE '4'.
  7302         16  RL-ASSOC-CERT-SEQU      PIC S99.
  7303         16  RL-ASSOC-CERT-TOTAL     PIC S99.
  7304         16  RL-CLAIM-PAYMENT-STATUS PIC 9.
  7305             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.
  7306         16  FILLER                  PIC X(5).
  7307
  7308     12  RL-CERTIFICATE-DATA.
  7309         16  RL-CERT-ORIGIN          PIC X.
  7310             88  RL-CERT-WAS-ONLINE     VALUE '1'.
  7311             88  RL-CERT-WAS-CREATED    VALUE '2'.
  7312             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.
  7313         16  RL-CERT-KEY-DATA.
  7314             20  RL-CERT-CARRIER     PIC X.
  7315             20  RL-CERT-GROUPING    PIC X(6).
  7316             20  RL-CERT-STATE       PIC XX.
  7317             20  RL-CERT-ACCOUNT.
  7318                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).
  7319                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).
  7320             20  RL-CERT-EFF-DT      PIC XX.
  7321
  7322     12  RL-STATUS-CONTROLS.
  7323         16  RL-PRIORITY-CD          PIC X.
  7324             88  RL-HIGHEST-PRIORITY    VALUE '9'.
  7325         16  RL-SUPV-ATTN-CD         PIC X.
  7326             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.
  7327             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.
  7328         16  RL-PURGED-DT            PIC XX.
  7329         16  RL-RESTORED-DT          PIC XX.
  7330         16  RL-NEXT-AUTO-PAY-DT     PIC XX.
  7331         16  RL-NEXT-RESEND-DT       PIC XX.
  7332         16  RL-NEXT-FOLLOWUP-DT     PIC XX.
  7333         16  FILLER                  PIC XX.
  7334         16  RL-LAST-MAINT-DT        PIC XX.
  7335         16  RL-LAST-MAINT-USER      PIC X(4).
  7336         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7337         16  RL-LAST-MAINT-TYPE      PIC X.
  7338             88  RL-CLAIM-SET-UP           VALUE ' '.
  7339             88  RL-PAYMENT-MADE           VALUE '1'.
  7340             88  RL-LETTER-SENT            VALUE '2'.
  7341             88  RL-MASTER-WAS-ALTERED     VALUE '3'.
  7342             88  RL-MASTER-WAS-RESTORED    VALUE '4'.
  7343             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.
  7344             88  RL-FILE-CONVERTED         VALUE '6'.
  7345         16  RL-RELATED-CLAIM-NO     PIC X(7).
  7346         16  RL-HISTORY-ARCHIVE-DT   PIC XX.
  7347         16  RL-BENEFICIARY          PIC X(10).
  7348         16  RL-FILE-ESTABLISHED-BY  PIC X(4).
  7349         16  FILLER                  PIC X(6).
  7350
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 139
* EL150.cbl
  7351     12  RL-TRAILER-CONTROLS.
  7352         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7353             88  RL-1ST-TRL-AVAIL       VALUE +4095.
  7354             88  RL-LAST-TRL-AVAIL      VALUE +100.
  7355             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.
  7356         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7357         16  FILLER                  PIC XX.
  7358         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7359         16  RL-ADDRESS-TRAILER-CNT.
  7360             20  RL-INSURED-ADDR-CNT  PIC S9.
  7361                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.
  7362             20  RL-ACCOUNT-ADDR-CNT  PIC S9.
  7363                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.
  7364             20  RL-BENIF-ADDR-CNT    PIC S9.
  7365                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.
  7366             20  RL-EMPLOYER-ADDR-CNT PIC S9.
  7367                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.
  7368             20  RL-DOCTOR-ADDR-CNT   PIC S9.
  7369                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.
  7370             20  RL-OTHER-1-ADDR-CNT  PIC S9.
  7371                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.
  7372             20  RL-OTHER-2-ADDR-CNT  PIC S9.
  7373                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.
  7374
  7375     12  RL-CV-REFERENCE-NO.
  7376         16  RL-CV-REFNO-PRIME       PIC X(18).
  7377         16  RL-CV-REFNO-SFX         PIC XX.
  7378
  7379     12  RL-FILE-LOCATION            PIC X(4).
  7380
  7381     12  RL-PROCESS-ERRORS.
  7382         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7383             88  RL-NO-FATAL-ERRORS     VALUE ZERO.
  7384         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7385             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.
  7386
  7387     12  RL-PRODUCT-CD               PIC X.
  7388
  7389     12  RL-CURRENT-KEY-DATA.
  7390         16  RL-CURRENT-CARRIER      PIC X.
  7391         16  RL-CURRENT-GROUPING     PIC X(6).
  7392         16  RL-CURRENT-STATE        PIC XX.
  7393         16  RL-CURRENT-ACCOUNT      PIC X(10).
  7394
  7395     12  RL-ASSOCIATES               PIC X.
  7396         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7397         88  RL-ASSOC-INTERFACE         VALUE 'I'.
  7398         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7399         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7400
  7401     12  RL-ACTIVITY-CODE            PIC 99.
  7402     12  RL-ACTIVITY-MAINT-DT        PIC XX.
  7403     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7404
  7405     12  RL-LAPSE-REPORT-CODE        PIC 9.
  7406     12  RL-LAG-REPORT-CODE          PIC 9.
  7407     12  RL-LOAN-TYPE                PIC XX.
  7408     12  RL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 140
* EL150.cbl
  7409
  7410     12  FILLER                      PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 141
* EL150.cbl
  7412*                COPY MTCPHST REPLACING ==:TAG:== BY ==PH==.
  7413******************************************************************
  7414*                                                                *
  7415*                           MTCPHST                              *
  7416*                            VMOD=1.001                          *
  7417*                                                                *
  7418*   FILE DESCRIPTION = POLICY HISTORY FILE                       *
  7419*                                                                *
  7420*   FILE TYPE = VSAM,KSDS                                        *
  7421*   RECORD SIZE = 132  RECFORM = FIXED                           *
  7422*                                                                *
  7423*   BASE CLUSTER = MPPHST                         RKP=2,LEN=46   *
  7424*       ALTERNATE (NONE)                                         *
  7425*                                                                *
  7426*   LOG = YES                                                    *
  7427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7428******************************************************************
  7429
  7430 01  POLICY-HISTORY.
  7431     12 PH-RECORD-ID                    PIC XX.
  7432         88  VALID-PH-ID                      VALUE 'PH'.
  7433
  7434******************************************************************
  7435*   BASE CLUSTER = MPPHST         (BASE KEY)      RKP=2,LEN=46   *
  7436******************************************************************
  7437
  7438     12 PH-CONTROL-PRIMARY.
  7439         16 PH-COMPANY-CD               PIC X.
  7440         16 PH-CARRIER                  PIC X.
  7441         16 PH-GROUPING.
  7442             20 PH-GROUPING-PREFIX      PIC X(3).
  7443             20 PH-GROUPING-PRIME       PIC X(3).
  7444         16 PH-STATE                    PIC XX.
  7445         16 PH-PRODUCER.
  7446             20 PH-PRODUCER-PREFIX      PIC X(4).
  7447             20 PH-PRODUCER-PRIME       PIC X(6).
  7448         16 PH-POLICY-EFF-DT            PIC XX.
  7449         16 PH-POLICY-NO.
  7450             20 PH-POLICY-PRIME         PIC X(18).
  7451             20 PH-POLICY-SFX           PIC XX.
  7452         16 PH-RECORD-TYPE              PIC X(2).
  7453         16 PH-FIELD-TYPE               PIC X(2).
  7454         16 PH-SEQUENCE-NO              PIC S9(4)    COMP.
  7455             88 PH-1ST-HISTORY-REC         VALUE +4095.
  7456     12  FILLER                            PIC X(16).
  7457
  7458******************************************************************
  7459*                 FILE SYNCHRONIZATION DATA                      *
  7460******************************************************************
  7461
  7462     12 PH-FILE-SYNCH-DATA.
  7463         16 PH-TRANSACTION-ID           PIC X(4).
  7464         16 PH-CHANGE-DT                PIC XX.
  7465         16 PH-CHANGE-TIME              PIC S9(7)  COMP-3.
  7466         16 PH-CHANGE-PROCESSOR         PIC X(4).
  7467         16 PH-MONTH-END-DT             PIC XX.
  7468
  7469******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 142
* EL150.cbl
  7470*                 POLICY HISTORY RECORD BODY                     *
  7471******************************************************************
  7472
  7473     12 PH-RECORD-BODY                  PIC X(50).
  7474
  7475******************************************************************
  7476*                       NUMERIC DATA                             *
  7477******************************************************************
  7478     12  FILLER           REDEFINES PH-RECORD-BODY.
  7479         20 PH-NUMERIC-FLD1             PIC S9(10)V99.
  7480         20  FILLER                        PIC X(38).
  7481
  7482     12  FILLER           REDEFINES PH-RECORD-BODY.
  7483         20 PH-NUMERIC-FLD2             PIC S9(2)V999.
  7484         20  FILLER                        PIC X(45).
  7485
  7486     12  FILLER           REDEFINES PH-RECORD-BODY.
  7487         20 PH-NUMERIC-FLD3             PIC S9(15).
  7488         20  FILLER                        PIC X(35).
  7489
  7490******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 143
* EL150.cbl
  7492 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER-L
  7493                          CONTROL-FILE CERTIFICATE-MASTER
  7494                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7495                          ACCOUNT-MASTER LETTER-ARCHIVE
  7496                          POLICY-MASTER PRODUCER-PLANS
  7497                          PRODUCER-MASTER RETRIEVE-MASTER
  7498                          POLICY-HISTORY.
  7499 0000-DFHEXIT SECTION.
  7500     MOVE '9#                    $   ' TO DFHEIV0.
  7501     MOVE 'EL150' TO DFHEIV1.
  7502     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7503
  7504     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7505     MOVE '5'                    TO DC-OPTION-CODE.
  7506     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7507     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7508     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7509
  7510     IF EIBCALEN = 0
  7511         GO TO 8800-UNAUTHORIZED-ACCESS.
  7512
  7513     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7514
  7515     IF PI-COMPANY-ID NOT = 'DMD'
  7516         MOVE SPACES             TO WST-REM-DAYS-GRP
  7517                                    WST-ORIG-DAYS-GRP.
  7518
  7519     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7520     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7521
  7522     MOVE EIBTRMID               TO QID-TERM.
  7523
  7524
  7525* EXEC CICS HANDLE CONDITION
  7526*        QIDERR   (1000-SHOW-CLAIM)
  7527*        MAPFAIL  (0100-FIRST-TIME-IN)
  7528*        NOTOPEN  (8500-FILE-NOTOPEN)
  7529*        PGMIDERR (9600-PGMID-ERROR)
  7530*        ERROR    (9990-ABEND)
  7531*    END-EXEC.
  7532*    MOVE '"$N?JL.               ! " #00007520' TO DFHEIV0
  7533     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7535     MOVE X'2220233030303037353230' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0
  7537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7538
  7539
  7540     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7541         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7542
  7543     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7544         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7545             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7546             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7547             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7548             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7549             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 144
* EL150.cbl
  7550             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7551             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7552             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7553         ELSE
  7554             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7555             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7556             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7557             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7558             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7559             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7560             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7561             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7562
  7563     IF RETURNED-FROM NOT = SPACES
  7564         GO TO 0600-RECOVER-TEMP-STORAGE.
  7565
  7566     IF EIBAID = DFHCLEAR
  7567         GO TO 9400-CLEAR.
  7568
  7569     IF PI-PROCESSOR-ID = 'LGXX'
  7570         NEXT SENTENCE
  7571     ELSE
  7572
  7573* EXEC CICS READQ TS
  7574*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7575*            INTO    (SECURITY-CONTROL)
  7576*            LENGTH  (SC-COMM-LENGTH)
  7577*            ITEM    (SC-ITEM)
  7578*        END-EXEC
  7579*    MOVE '*$II   L              ''   #00007560' TO DFHEIV0
  7580     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7582     MOVE X'2020233030303037353630' TO DFHEIV0(25:11)
  7583     CALL 'kxdfhei1' USING DFHEIV0,
  7584           PI-SECURITY-TEMP-STORE-ID,
  7585           SECURITY-CONTROL,
  7586           SC-COMM-LENGTH,
  7587           SC-ITEM,
  7588           DFHEIV99,
  7589           DFHEIV99
  7590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7591         MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  7592         MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  7593         IF NOT DISPLAY-CAP
  7594             MOVE 'READ'              TO  SM-READ
  7595             PERFORM 9995-SECURITY-VIOLATION
  7596             MOVE ER-0070             TO  EMI-ERROR
  7597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7598             GO TO 8100-SEND-INITIAL-MAP.
  7599
  7600     IF EIBTRNID = TRANS-ID
  7601         GO TO 0200-RECEIVE.
  7602
  7603 0100-FIRST-TIME-IN.
  7604
  7605     MOVE LOW-VALUES             TO EL150AO.
  7606
  7607     IF NOT PI-CONFIDENTIAL-UP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 145
* EL150.cbl
  7608         MOVE LOW-VALUES         TO PI-REDEF.
  7609
  7610     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
  7611     MOVE ZEROS                  TO PI-TOTAL-PAID
  7612                                    PI-DAYS-PAID
  7613                                    PI-LAST-SEQ-NO.
  7614
  7615     MOVE 0                      TO PI-FORCE-COUNT.
  7616
  7617
  7618* EXEC CICS DELETEQ TS
  7619*        QUEUE(QID)
  7620*    END-EXEC.
  7621*    MOVE '*&                    #   #00007592' TO DFHEIV0
  7622     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7624     MOVE X'2020233030303037353932' TO DFHEIV0(25:11)
  7625     CALL 'kxdfhei1' USING DFHEIV0,
  7626           QID,
  7627           DFHEIV99
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7629
  7630
  7631     GO TO 1000-SHOW-CLAIM.
  7632
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 146
* EL150.cbl
  7634 0200-RECEIVE.
  7635     MOVE 'B'                    TO PASS-SWITCH.
  7636
  7637     MOVE LOW-VALUES             TO EL150AI.
  7638
  7639     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7640         MOVE ER-0008            TO EMI-ERROR
  7641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7642         MOVE -1                 TO FILETOL
  7643         GO TO 8200-SEND-DATAONLY.
  7644
  7645
  7646* EXEC CICS RECEIVE
  7647*        MAP      (MAP-NAME)
  7648*        MAPSET   (MAPSET-NAME)
  7649*        INTO     (EL150AI)
  7650*    END-EXEC.
  7651     MOVE LENGTH OF
  7652      EL150AI
  7653       TO DFHEIV11
  7654*    MOVE '8"T I  L              ''   #00007610' TO DFHEIV0
  7655     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7657     MOVE X'2020233030303037363130' TO DFHEIV0(25:11)
  7658     CALL 'kxdfhei1' USING DFHEIV0,
  7659           MAP-NAME,
  7660           EL150AI,
  7661           DFHEIV11,
  7662           MAPSET-NAME,
  7663           DFHEIV99,
  7664           DFHEIV99
  7665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7666
  7667
  7668     IF ENTERPFL = 0
  7669         GO TO 0300-CHECK-PFKEYS.
  7670
  7671     IF EIBAID NOT = DFHENTER
  7672         MOVE ER-0004            TO EMI-ERROR
  7673         GO TO 0320-INPUT-ERROR.
  7674
  7675     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7676         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7677     ELSE
  7678         MOVE ER-0029            TO EMI-ERROR
  7679         GO TO 0320-INPUT-ERROR.
  7680
  7681 0300-CHECK-PFKEYS.
  7682     IF EIBAID = DFHPF23
  7683         GO TO 8810-PF23.
  7684
  7685     IF EIBAID = DFHPF24
  7686         GO TO 9200-RETURN-MAIN-MENU.
  7687
  7688     IF EIBAID = DFHPF12
  7689         GO TO 9500-PF12.
  7690
  7691     IF (EIBAID = DFHPF22) AND (NOT FORCE-CAP)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 147
* EL150.cbl
  7692         MOVE ER-0433            TO EMI-ERROR
  7693         GO TO 0320-INPUT-ERROR.
  7694
  7695     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF22)
  7696         MOVE ER-0500            TO EMI-ERROR
  7697         GO TO 0320-INPUT-ERROR.
  7698
  7699     IF PI-RETRIEVED-DATA
  7700         IF EIBAID = DFHPF1  OR DFHPF2 OR DFHPF15 OR
  7701                     DFHPF16 OR DFHPF21
  7702             NEXT SENTENCE
  7703         ELSE
  7704             MOVE ER-0926        TO EMI-ERROR
  7705             GO TO 0320-INPUT-ERROR.
  7706
  7707     IF EIBAID = DFHPF21
  7708         IF NOT PI-RETRIEVED-DATA
  7709             PERFORM 7650-CREATE-ACTQ THRU 7650-EXIT
  7710             MOVE ER-0927        TO EMI-ERROR
  7711             GO TO 0320-INPUT-ERROR
  7712         ELSE
  7713             GO TO 7700-CREATE-CLAIM.
  7714
  7715     IF CLAIM-IS-PURGED
  7716         IF EIBAID = DFHPF1  OR DFHPF2  OR DFHPF3  OR DFHPF4  OR
  7717                     DFHPF6  OR DFHPF7  OR DFHPF8  OR DFHPF9  OR
  7718                     DFHPF10 OR DFHPF11 OR DFHPF13 OR DFHPF14 OR
  7719                     DFHPF17 OR DFHPF18 OR DFHPF20
  7720                       MOVE -1            TO  ENTERPFL
  7721                       MOVE 'CLAIM IS PURGED, PFKEYS ARE INVALID'
  7722                                          TO  MAP-DISPLAY (1)
  7723                         GO TO 8200-SEND-DATAONLY.
  7724
  7725     IF (PI-SUPERVISOR-ONLY)
  7726        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  7727             AND 'AMWA')
  7728*       NOT SYSTEM-MODIFY-CAP
  7729*        IF EIBAID = DFHPF3  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  7730         IF EIBAID = DFHPF4  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  7731                     DFHPF9  or
  7732                     DFHPF11 OR DFHPF13 OR DFHPF14 OR DFHPF17 OR
  7733                     DFHPF21 OR DFHENTER
  7734             MOVE -1             TO ENTERPFL
  7735             MOVE ER-0931        TO EMI-ERROR
  7736             GO TO 0320-INPUT-ERROR.
  7737
  7738     IF EIBAID = DFHPF13 OR DFHPF19 OR DFHPF20
  7739         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7740             MOVE ER-0029            TO  EMI-ERROR
  7741             GO TO 0320-INPUT-ERROR.
  7742
  7743     IF EIBAID = DFHPF5 OR DFHPF18 OR DFHPF19 OR DFHPF20
  7744         IF PI-COMPANY-ID = 'DMD'
  7745             AND
  7746            NOT SYSTEM-MODIFY-CAP
  7747            IF PI-PRIORITY-9
  7748               MOVE ER-0931            TO  EMI-ERROR
  7749               GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 148
* EL150.cbl
  7750
  7751     IF EIBAID = DFHPF7 OR DFHPF6
  7752         IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
  7753            AND PI-TOTAL-PAID NOT GREATER THAN +0
  7754             MOVE EIBAID             TO PI-PFKEY-USED
  7755             MOVE ER-3550            TO  EMI-ERROR
  7756             GO TO 0320-INPUT-ERROR.
  7757
  7758     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7
  7759                 GO TO 0500-CREATE-TEMP-STORAGE.
  7760     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6
  7761         IF PI-SAVE-TYPE = 'L'
  7762             MOVE ER-0376        TO EMI-ERROR
  7763             GO TO 0320-INPUT-ERROR
  7764         ELSE
  7765             GO TO 0500-CREATE-TEMP-STORAGE.
  7766
  7767     IF EIBAID = DFHPF3  OR DFHPF4  OR DFHPF5  OR DFHPF7  OR
  7768                 DFHPF8  OR DFHPF9  OR DFHPF10 OR DFHPF13 OR
  7769                 DFHPF14 OR DFHPF17 OR DFHPF18 OR DFHPF19 OR
  7770                 DFHPF20
  7771                 GO TO 0500-CREATE-TEMP-STORAGE.
  7772
  7773     IF EIBAID = DFHPF6 OR DFHPF11
  7774         IF PI-SAVE-TYPE = 'L'
  7775             MOVE ER-0376        TO EMI-ERROR
  7776             GO TO 0320-INPUT-ERROR
  7777         ELSE
  7778             GO TO 0500-CREATE-TEMP-STORAGE.
  7779
  7780     MOVE SPACES                 TO ERRMSG1O.
  7781
  7782     IF EIBAID = DFHPF15
  7783         GO TO 7000-START-BROWSE.
  7784
  7785     IF EIBAID = DFHPF16
  7786         GO TO 7500-START-BROWSE.
  7787
  7788     IF EIBAID = DFHPF1
  7789         MOVE 'F'                TO DIRECTION-SWITCH
  7790         GO TO 1600-ROLL-TRAILERS.
  7791
  7792     IF EIBAID = DFHPF2
  7793         MOVE 'B'                TO DIRECTION-SWITCH
  7794         GO TO 1600-ROLL-TRAILERS.
  7795
  7796     IF EIBAID = DFHENTER
  7797         GO TO 0330-EDIT-DATA.
  7798
  7799*      string "EIBAID = " eibaid into map-display (1)
  7800*      GO TO 8200-SEND-DATAONLY.
  7801     MOVE ER-0029                TO EMI-ERROR.
  7802
  7803 0320-INPUT-ERROR.
  7804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7805
  7806     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT.
  7807
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 149
* EL150.cbl
  7808     IF ENTERPFL = 0
  7809         MOVE -1                 TO FILETOL
  7810     ELSE
  7811         MOVE AL-UNBON           TO ENTERPFA
  7812         MOVE -1                 TO ENTERPFL.
  7813
  7814     GO TO 8200-SEND-DATAONLY.
  7815
  7816 0330-EDIT-DATA.
  7817
  7818     MOVE 0                      TO PI-FORCE-COUNT.
  7819
  7820     IF NOT MODIFY-CAP
  7821         MOVE 'UPDATE'           TO  SM-READ
  7822         PERFORM 9995-SECURITY-VIOLATION
  7823         MOVE ER-0070            TO  EMI-ERROR
  7824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7825         GO TO 8100-SEND-INITIAL-MAP.
  7826
  7827     IF CLMNOL  > 0 OR
  7828        CARRL   > 0 OR
  7829        CERTNOL > 0 OR
  7830        SUFXL   > 0
  7831            GO TO 1000-SHOW-CLAIM.
  7832
  7833     IF YESNOSWL > 0
  7834         MOVE AL-UANON           TO YESNOSWA.
  7835
  7836*    IF MCRFLML > 0
  7837*        MOVE AL-UANON           TO MCRFLMA.
  7838
  7839     IF FILETOL > 0
  7840         MOVE AL-UANON           TO FILETOA.
  7841
  7842     IF CLOANL > 0
  7843        MOVE AL-UANON            TO CLOANA
  7844     END-IF
  7845
  7846     IF PRTOPTL > 0
  7847        IF PRTOPTI NOT = 'N' AND 'L'
  7848           MOVE AL-UABON         TO PRTOPTA
  7849           MOVE -1               TO PRTOPTL
  7850           MOVE ER-0334 TO EMI-ERROR
  7851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7852        ELSE
  7853           MOVE AL-UANON         TO PRTOPTA.
  7854
  7855     IF PRTOPTL > 0
  7856         IF (NOT PI-NO-CARRIER-SECURITY OR
  7857             NOT PI-NO-ACCOUNT-SECURITY)
  7858             IF PRTOPTI NOT = 'N'
  7859                 MOVE AL-UABON   TO PRTOPTA
  7860                 MOVE -1         TO PRTOPTL
  7861                 MOVE ER-2378    TO EMI-ERROR
  7862                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7863
  7864     IF FORMATL > 0
  7865         IF FORMATI NOT = 'F' AND 'P'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 150
* EL150.cbl
  7866             MOVE AL-UABON       TO FORMATA
  7867             MOVE -1             TO FORMATL
  7868             MOVE ER-0335        TO EMI-ERROR
  7869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7870         ELSE
  7871             MOVE AL-UANON       TO FORMATA.
  7872
  7873     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7874         IF ASSOCL > +0
  7875             IF ASSOCI = 'A' OR 'I' OR 'N' OR 'M'
  7876                 MOVE AL-UANON   TO  ASSOCA
  7877             ELSE
  7878                 MOVE AL-UABON   TO  ASSOCA
  7879                 MOVE -1         TO  ASSOCL
  7880                 MOVE ER-0804    TO  EMI-ERROR
  7881                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7882
  7883 0335-EDIT-ACTIVITY-CODE.
  7884******************************************************************
  7885*    THIS PARAGRAPH DETERMINES IF THE COMPANY IS CURRENTLY USING *
  7886*    THE AUTOMATIC ACTIVITY FUNCTIONS OF THE SYSTEM AND, IF SO,  *
  7887*    WHAT FUNCTIONS ARE TO BE PERFORMED BASED ON THE CODES SET   *
  7888*    IN THE AUTOMATIC ACTIVITY RECORD.                           *
  7889******************************************************************
  7890
  7891     IF ACTCDL = +0
  7892         GO TO 0340-EDIT-DATA.
  7893
  7894     IF ACTCDI IS NOT NUMERIC
  7895         MOVE ZEROS              TO  ACTCDI
  7896         MOVE AL-UABON           TO  ACTCDA
  7897         MOVE -1                 TO  ACTCDL
  7898         MOVE ER-3526            TO  EMI-ERROR
  7899         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7900         GO TO 0340-EDIT-DATA.
  7901
  7902     MOVE ACTCDI                 TO  WS-ACTIVITY-CODE.
  7903     IF NOT VALID-ACTIVITY-CODE
  7904         MOVE AL-UABON           TO  ACTCDA
  7905         MOVE -1                 TO  ACTCDL
  7906         MOVE ER-3526            TO  EMI-ERROR
  7907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7908         GO TO 0340-EDIT-DATA.
  7909
  7910     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7911     PERFORM 6000-CHECK-AUTO-ACTIVITY THRU 6000-EXIT.
  7912
  7913     IF WS-ACT-REC-FOUND-SW = 'N'
  7914          MOVE +0                TO  ACTCDL
  7915          GO TO 0340-EDIT-DATA.
  7916
  7917     IF ACTCDI = ZEROS
  7918         NEXT SENTENCE
  7919     ELSE
  7920         MOVE ACTCDI             TO  SUB
  7921         SUBTRACT +9 FROM SUB
  7922         IF CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N'
  7923             MOVE AL-UABON       TO  ACTCDA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 151
* EL150.cbl
  7924             MOVE -1             TO  ACTCDL
  7925             MOVE ER-3545        TO  EMI-ERROR
  7926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7927             GO TO 0340-EDIT-DATA.
  7928
  7929     IF ACTCDI = ZEROS
  7930         IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  7931             PERFORM 6100-RESET-AUTO-ACTIVITY THRU 6100-EXIT
  7932             MOVE AL-UANOF       TO  ACTCDA
  7933             GO TO 0340-EDIT-DATA.
  7934
  7935     MOVE 'Y'                    TO  WS-LETTER-SW.
  7936     MOVE AL-UANOF               TO  ACTCDA.
  7937
  7938 0340-EDIT-DATA.
  7939
  7940     IF EMI-NO-ERRORS
  7941         IF PRTOPTL NOT = FORMATL
  7942             MOVE AL-UABON       TO PRTOPTA  FORMATA
  7943             MOVE -1             TO PRTOPTL
  7944             MOVE ER-0336 TO EMI-ERROR
  7945             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7946
  7947     IF PRTOPTL > 0
  7948        IF (NOT PI-NO-CARRIER-SECURITY OR
  7949            NOT PI-NO-ACCOUNT-SECURITY)
  7950           IF ALTPRTL NOT > 0
  7951              MOVE AL-UABON      TO ALTPRTA
  7952              MOVE -1            TO ALTPRTL
  7953              MOVE ER-2379       TO EMI-ERROR
  7954              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7955
  7956     IF NOT EMI-NO-ERRORS
  7957         IF EMI-FORCABLE-CTR = ZEROS AND
  7958            EMI-FATAL-CTR = ZEROS
  7959             NEXT SENTENCE
  7960         ELSE
  7961             GO TO 8200-SEND-DATAONLY.
  7962
  7963     IF FILETOL NOT > 0        AND
  7964*       MCRFLML NOT > 0        AND
  7965        ACTCDL  NOT > 0        AND
  7966        ASSOCL  NOT > 0        AND
  7967        CLOANL  NOT > 0        AND
  7968        YESNOSWL NOT > 0
  7969         GO TO 0350-PROCESS-OPTIONS.
  7970
  7971
  7972* EXEC CICS HANDLE CONDITION
  7973*        NOTFND   (0450-NOT-FOUND)
  7974*    END-EXEC.
  7975*    MOVE '"$I                   ! # #00007919' TO DFHEIV0
  7976     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7978     MOVE X'2320233030303037393139' TO DFHEIV0(25:11)
  7979     CALL 'kxdfhei1' USING DFHEIV0
  7980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7981
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 152
* EL150.cbl
  7982
  7983     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7984     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7985     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  7986     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7987     MOVE 'MSTR'                 TO FILE-SWITCH.
  7988
  7989
  7990* EXEC CICS READ
  7991*        UPDATE
  7992*        DATASET   ('ELMSTR')
  7993*        RIDFLD    (ELMSTR-KEY)
  7994*        INTO      (CLAIM-MASTER)
  7995*    END-EXEC.
  7996     MOVE LENGTH OF
  7997      CLAIM-MASTER
  7998       TO DFHEIV11
  7999     MOVE 'ELMSTR' TO DFHEIV1
  8000*    MOVE '&"IL       EU         (   #00007929' TO DFHEIV0
  8001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8002     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8003     MOVE X'2020233030303037393239' TO DFHEIV0(25:11)
  8004     CALL 'kxdfhei1' USING DFHEIV0,
  8005           DFHEIV1,
  8006           CLAIM-MASTER,
  8007           DFHEIV11,
  8008           ELMSTR-KEY,
  8009           DFHEIV99,
  8010           DFHEIV99,
  8011           DFHEIV99
  8012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8013
  8014
  8015     IF ACTCDL > +0
  8016         IF CL-LAST-MAINT-USER NOT = PI-UPDATE-BY
  8017             MOVE ER-0068        TO  EMI-ERROR
  8018             MOVE -1             TO  ACTCDL
  8019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8020             GO TO 8200-SEND-DATAONLY
  8021         ELSE
  8022             NEXT SENTENCE
  8023     ELSE
  8024         IF (CL-LAST-MAINT-USER NOT = PI-UPDATE-BY) OR
  8025            (CL-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  8026               MOVE ER-0068      TO EMI-ERROR
  8027               MOVE -1           TO FILETOL
  8028               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029               GO TO 8200-SEND-DATAONLY.
  8030
  8031     MOVE 'ELMSTR  '             TO FILE-ID.
  8032
  8033*    IF MCRFLML > 0
  8034*        MOVE MCRFLMI            TO CL-MICROFILM-NO.
  8035
  8036     IF FILETOL > 0
  8037         IF FILETOI  = CL-FILE-LOCATION
  8038             MOVE ZEROS          TO FILETOL
  8039         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 153
* EL150.cbl
  8040             MOVE FILETOI        TO CL-FILE-LOCATION.
  8041
  8042     IF CLOANL > 0
  8043        IF CLOANI NOT = SPACES
  8044           MOVE CL-CONTROL-PRIMARY
  8045                                 TO ELTRLR-KEY
  8046           MOVE +91              TO TRLR-SEQ-NO
  8047           MOVE 'TRLR'           TO FILE-SWITCH
  8048
  8049* EXEC CICS READ
  8050*             UPDATE
  8051*             DATASET   ('ELTRLR')
  8052*             RIDFLD    (ELTRLR-KEY)
  8053*             SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8054*             RESP      (WS-RESPONSE)
  8055*          END-EXEC
  8056     MOVE 'ELTRLR' TO DFHEIV1
  8057*    MOVE '&"S        EU         (  N#00007969' TO DFHEIV0
  8058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8060     MOVE X'204E233030303037393639' TO DFHEIV0(25:11)
  8061     CALL 'kxdfhei1' USING DFHEIV0,
  8062           DFHEIV1,
  8063           DFHEIV20,
  8064           DFHEIV99,
  8065           ELTRLR-KEY,
  8066           DFHEIV99,
  8067           DFHEIV99,
  8068           DFHEIV99
  8069     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8070         DFHEIV20
  8071     MOVE EIBRESP  TO WS-RESPONSE
  8072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8073           IF WS-RESP-NORMAL
  8074              MOVE CLOANI        TO AT-INFO-LINE-1
  8075              MOVE PI-PROCESSOR-ID
  8076                                 TO AT-GEN-INFO-LAST-UPDATED-BY
  8077              MOVE SAVE-BIN-DATE TO AT-GEN-INFO-LAST-MAINT-DT
  8078              MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
  8079
  8080* EXEC CICS REWRITE
  8081*                DATASET   ('ELTRLR')
  8082*                FROM      (ACTIVITY-TRAILERS)
  8083*             END-EXEC
  8084     MOVE LENGTH OF
  8085      ACTIVITY-TRAILERS
  8086       TO DFHEIV11
  8087     MOVE 'ELTRLR' TO DFHEIV1
  8088*    MOVE '&& L                  %   #00007982' TO DFHEIV0
  8089     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8090     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8091     MOVE X'2020233030303037393832' TO DFHEIV0(25:11)
  8092     CALL 'kxdfhei1' USING DFHEIV0,
  8093           DFHEIV1,
  8094           ACTIVITY-TRAILERS,
  8095           DFHEIV11,
  8096           DFHEIV99
  8097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 154
* EL150.cbl
  8098           ELSE
  8099              IF WS-RESP-NOTFND
  8100
  8101* EXEC CICS GETMAIN
  8102*                   SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8103*                   LENGTH    (200)
  8104*                   INITIMG   (GETMAIN-SPACE)
  8105*                END-EXEC
  8106     MOVE 200
  8107       TO DFHEIV11
  8108*    MOVE ',"IL                  $   #00007988' TO DFHEIV0
  8109     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8110     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8111     MOVE X'2020233030303037393838' TO DFHEIV0(25:11)
  8112     CALL 'kxdfhei1' USING DFHEIV0,
  8113           DFHEIV20,
  8114           DFHEIV11,
  8115           GETMAIN-SPACE
  8116     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8117         DFHEIV20
  8118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8119                 MOVE 'AT'       TO AT-RECORD-ID
  8120                 MOVE CL-CONTROL-PRIMARY
  8121                                 TO AT-CONTROL-PRIMARY
  8122                 MOVE +91        TO AT-SEQUENCE-NO
  8123                 MOVE CLOANI     TO AT-INFO-LINE-1
  8124                 MOVE '6'        TO AT-TRAILER-TYPE
  8125                 MOVE PI-PROCESSOR-ID
  8126                                 TO AT-RECORDED-BY
  8127                                    AT-GEN-INFO-LAST-UPDATED-BY
  8128                 MOVE SAVE-BIN-DATE
  8129                                 TO AT-RECORDED-DT
  8130                                    AT-GEN-INFO-LAST-MAINT-DT
  8131                 MOVE EIBTIME    TO AT-LAST-MAINT-HHMMSS
  8132
  8133* EXEC CICS WRITE
  8134*                   DATASET   ('ELTRLR')
  8135*                   FROM      (ACTIVITY-TRAILERS)
  8136*                   RIDFLD    (AT-CONTROL-PRIMARY)
  8137*                END-EXEC
  8138     MOVE LENGTH OF
  8139      ACTIVITY-TRAILERS
  8140       TO DFHEIV11
  8141     MOVE 'ELTRLR' TO DFHEIV1
  8142*    MOVE '&$ L                  ''   #00008006' TO DFHEIV0
  8143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303038303036' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           DFHEIV1,
  8148           ACTIVITY-TRAILERS,
  8149           DFHEIV11,
  8150           AT-CONTROL-PRIMARY,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8154              END-IF
  8155           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 155
* EL150.cbl
  8156        END-IF
  8157     END-IF
  8158
  8159     IF YESNOSWI EQUAL TO CL-YESNOSW
  8160         MOVE ZEROS    TO YESNOSWL
  8161     ELSE
  8162         MOVE YESNOSWI TO CL-YESNOSW
  8163     END-IF.
  8164
  8165     IF WS-ACT-REC-FOUND-SW = 'Y'
  8166         IF ACTCDL > +0
  8167             MOVE ACTCDI             TO  CL-ACTIVITY-CODE
  8168             MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
  8169                                         DC-BIN-DATE-1
  8170             MOVE ' '                TO  DC-OPTION-CODE
  8171             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8172             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO.
  8173
  8174     IF WS-ACT-REC-FOUND-SW = 'Y'
  8175         IF ACTCDL > +0
  8176             IF ACTCDI = ZEROS
  8177                 MOVE SPACES         TO  CL-ACTIVITY-MAINT-TYPE
  8178                                         ACTTYPO
  8179             ELSE
  8180                 MOVE WS-ACTIVITY-CODE   TO  SUB
  8181                 SUBTRACT 9 FROM SUB
  8182                 MOVE CF-USER-ACTIVITY-DESC (SUB)
  8183                                     TO  WS-ACT-USER-DESC
  8184                 MOVE WS-DESC-1-3    TO  CL-ACTIVITY-MAINT-TYPE
  8185                                         ACTTYPO.
  8186
  8187     IF WS-ACT-REC-FOUND-SW = 'Y'
  8188         IF ACTCDL > +0
  8189             IF WS-UPDATE-SW = 'Y'
  8190                 MOVE LOW-VALUES     TO  CL-NEXT-RESEND-DT
  8191                                         CL-NEXT-FOLLOWUP-DT.
  8192
  8193     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8194         IF ASSOCL > +0
  8195             MOVE ASSOCI         TO  CL-ASSOCIATES.
  8196
  8197     IF PI-COMPANY-ID = 'FLA'
  8198         NEXT SENTENCE
  8199     ELSE
  8200         MOVE '3'                TO  CL-LAST-MAINT-TYPE
  8201         MOVE PI-PROCESSOR-ID    TO  CL-LAST-MAINT-USER
  8202                                     SV-LAST-BY
  8203         MOVE EIBTIME            TO  CL-LAST-MAINT-HHMMSS
  8204                                     SV-LAST-HHMMSS
  8205         MOVE SAVE-BIN-DATE      TO  CL-LAST-MAINT-DT.
  8206
  8207 0350-PROCESS-OPTIONS.
  8208     IF PRTOPTL NOT > 0
  8209         GO TO 0400-WRITE-CLAIM.
  8210
  8211     IF PRTOPTI = 'N'
  8212         GO TO 0380-START-PRINTER.
  8213
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 156
* EL150.cbl
  8214
  8215* EXEC CICS HANDLE CONDITION
  8216*        NOTFND(0360-CREATE-NEW-ACTQ)
  8217*    END-EXEC.
  8218*    MOVE '"$I                   ! $ #00008071' TO DFHEIV0
  8219     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8221     MOVE X'2420233030303038303731' TO DFHEIV0(25:11)
  8222     CALL 'kxdfhei1' USING DFHEIV0
  8223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8224
  8225
  8226     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
  8227     MOVE PI-CARRIER             TO ACTQ-CARRIER.
  8228     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
  8229     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
  8230
  8231     MOVE 'ACTQ'                 TO FILE-SWITCH.
  8232     MOVE 'ELACTQ  '             TO FILE-ID.
  8233
  8234
  8235* EXEC CICS READ
  8236*        UPDATE
  8237*        DATASET   ('ELACTQ')
  8238*        SET       (ADDRESS OF ACTIVITY-QUE)
  8239*        RIDFLD    (ELACTQ-KEY)
  8240*    END-EXEC.
  8241     MOVE 'ELACTQ' TO DFHEIV1
  8242*    MOVE '&"S        EU         (   #00008083' TO DFHEIV0
  8243     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8244     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8245     MOVE X'2020233030303038303833' TO DFHEIV0(25:11)
  8246     CALL 'kxdfhei1' USING DFHEIV0,
  8247           DFHEIV1,
  8248           DFHEIV20,
  8249           DFHEIV99,
  8250           ELACTQ-KEY,
  8251           DFHEIV99,
  8252           DFHEIV99,
  8253           DFHEIV99
  8254     SET ADDRESS OF ACTIVITY-QUE TO
  8255         DFHEIV20
  8256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8257
  8258
  8259     IF FORMATI = 'F'
  8260         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8261     ELSE
  8262         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8263
  8264     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8265
  8266     MOVE 'ELACTQ  '             TO FILE-ID.
  8267
  8268
  8269* EXEC CICS REWRITE
  8270*        DATASET   ('ELACTQ')
  8271*        FROM      (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 157
* EL150.cbl
  8272*    END-EXEC.
  8273     MOVE LENGTH OF
  8274      ACTIVITY-QUE
  8275       TO DFHEIV11
  8276     MOVE 'ELACTQ' TO DFHEIV1
  8277*    MOVE '&& L                  %   #00008099' TO DFHEIV0
  8278     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8280     MOVE X'2020233030303038303939' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0,
  8282           DFHEIV1,
  8283           ACTIVITY-QUE,
  8284           DFHEIV11,
  8285           DFHEIV99
  8286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8287
  8288
  8289     GO TO 0400-WRITE-CLAIM.
  8290
  8291 0360-CREATE-NEW-ACTQ.
  8292
  8293* EXEC CICS GETMAIN
  8294*        SET       (ADDRESS OF ACTIVITY-QUE)
  8295*        LENGTH    (60)
  8296*        INITIMG   (GETMAIN-SPACE)
  8297*    END-EXEC.
  8298     MOVE 60
  8299       TO DFHEIV11
  8300*    MOVE ',"IL                  $   #00008107' TO DFHEIV0
  8301     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8303     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8304     CALL 'kxdfhei1' USING DFHEIV0,
  8305           DFHEIV20,
  8306           DFHEIV11,
  8307           GETMAIN-SPACE
  8308     SET ADDRESS OF ACTIVITY-QUE TO
  8309         DFHEIV20
  8310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8311
  8312
  8313     MOVE 'AQ'                   TO AQ-RECORD-ID.
  8314     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
  8315     MOVE PI-CARRIER             TO AQ-CARRIER.
  8316     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
  8317     MOVE PI-CERT-NO             TO AQ-CERT-NO.
  8318
  8319     IF FORMATI = 'F'
  8320         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8321     ELSE
  8322         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8323
  8324     MOVE +0                     TO AQ-PAYMENT-COUNTER
  8325                                    AQ-PMT-UNAPPROVED-COUNT.
  8326
  8327     MOVE LOW-VALUES             TO AQ-RESEND-DATE
  8328                                    AQ-FOLLOWUP-DATE.
  8329
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 158
* EL150.cbl
  8330     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8331
  8332     MOVE 'ACTQ'                 TO FILE-SWITCH.
  8333
  8334     MOVE 'ELACTQ  '             TO FILE-ID.
  8335
  8336
  8337* EXEC CICS WRITE
  8338*        DATASET   ('ELACTQ')
  8339*        FROM      (ACTIVITY-QUE)
  8340*        RIDFLD    (AQ-CONTROL-PRIMARY)
  8341*    END-EXEC.
  8342     MOVE LENGTH OF
  8343      ACTIVITY-QUE
  8344       TO DFHEIV11
  8345     MOVE 'ELACTQ' TO DFHEIV1
  8346*    MOVE '&$ L                  ''   #00008136' TO DFHEIV0
  8347     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8349     MOVE X'2020233030303038313336' TO DFHEIV0(25:11)
  8350     CALL 'kxdfhei1' USING DFHEIV0,
  8351           DFHEIV1,
  8352           ACTIVITY-QUE,
  8353           DFHEIV11,
  8354           AQ-CONTROL-PRIMARY,
  8355           DFHEIV99,
  8356           DFHEIV99
  8357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8358
  8359
  8360     GO TO 0400-WRITE-CLAIM.
  8361
  8362 0380-START-PRINTER.
  8363
  8364* EXEC CICS HANDLE CONDITION
  8365*         TERMIDERR    (0385-TERMID-ERROR)
  8366*         TRANSIDERR   (0390-TRANS-ERROR)
  8367*    END-EXEC.
  8368*    MOVE '"$[\                  ! % #00008145' TO DFHEIV0
  8369     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  8370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8371     MOVE X'2520233030303038313435' TO DFHEIV0(25:11)
  8372     CALL 'kxdfhei1' USING DFHEIV0
  8373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8374
  8375
  8376     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  8377     MOVE '1'                    TO CNTL-REC-TYPE.
  8378     MOVE SPACES                 TO CNTL-ACCESS.
  8379     MOVE +0                     TO CNTL-SEQ-NO.
  8380     MOVE 'CNTL'                 TO FILE-SWITCH.
  8381
  8382
  8383* EXEC CICS READ
  8384*        DATASET   ('ELCNTL')
  8385*        SET       (ADDRESS OF CONTROL-FILE)
  8386*        RIDFLD    (ELCNTL-KEY)
  8387*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 159
* EL150.cbl
  8388     MOVE 'ELCNTL' TO DFHEIV1
  8389*    MOVE '&"S        E          (   #00008156' TO DFHEIV0
  8390     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8392     MOVE X'2020233030303038313536' TO DFHEIV0(25:11)
  8393     CALL 'kxdfhei1' USING DFHEIV0,
  8394           DFHEIV1,
  8395           DFHEIV20,
  8396           DFHEIV99,
  8397           ELCNTL-KEY,
  8398           DFHEIV99,
  8399           DFHEIV99,
  8400           DFHEIV99
  8401     SET ADDRESS OF CONTROL-FILE TO
  8402         DFHEIV20
  8403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8404
  8405
  8406     IF CF-FORMS-PRINTER-ID = SPACES
  8407         MOVE ER-0337            TO EMI-ERROR
  8408         MOVE -1                 TO FILETOL
  8409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8410         GO TO 8200-SEND-DATAONLY.
  8411
  8412     IF FORMATI = 'F'
  8413         MOVE '2'                TO PI-ENTRY-CD-1
  8414     ELSE
  8415         MOVE '1'                TO PI-ENTRY-CD-1.
  8416
  8417     IF PI-PROCESSOR-PRINTER NOT = SPACES
  8418         MOVE PI-PROCESSOR-PRINTER  TO  CF-FORMS-PRINTER-ID.
  8419
  8420     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8421
  8422     IF ALTPRTL > 0
  8423        MOVE ALTPRTI             TO CF-FORMS-PRINTER-ID
  8424                                    PI-ALT-DMD-PRT-ID.
  8425
  8426     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  8427*       MOVE EIBTRMID            TO CF-FORMS-PRINTER-ID
  8428
  8429* EXEC CICS START
  8430*            TRANSID   (START-TRANS-ID)
  8431*            FROM      (PROGRAM-INTERFACE-BLOCK)
  8432*            LENGTH    (PI-COMM-LENGTH)
  8433*            TERMID    ('A155')
  8434*            TERMID    (CF-FORMS-PRINTER-ID)
  8435*        END-EXEC
  8436*    MOVE '0( LF                 0   #00008184' TO DFHEIV0
  8437     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  8438     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  8439     MOVE X'2020233030303038313834' TO DFHEIV0(25:11)
  8440     CALL 'kxdfhei1' USING DFHEIV0,
  8441           DFHEIV99,
  8442           START-TRANS-ID,
  8443           DFHEIV99,
  8444           PROGRAM-INTERFACE-BLOCK,
  8445           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 160
* EL150.cbl
  8446           DFHEIV99,
  8447           DFHEIV99,
  8448           DFHEIV99,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99,
  8452           DFHEIV99,
  8453           DFHEIV99,
  8454           DFHEIV99,
  8455           DFHEIV99
  8456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8457     ELSE
  8458
  8459* EXEC CICS START
  8460*            TRANSID   (START-TRANS-ID)
  8461*            TERMID    (CF-FORMS-PRINTER-ID)
  8462*            TERMID    ('PRN1')
  8463*            FROM      (PROGRAM-INTERFACE-BLOCK)
  8464*            LENGTH    (PI-COMM-LENGTH)
  8465*        END-EXEC.
  8466*    MOVE '0( LFT                0   #00008192' TO DFHEIV0
  8467     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  8468     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  8469     MOVE X'2020233030303038313932' TO DFHEIV0(25:11)
  8470     CALL 'kxdfhei1' USING DFHEIV0,
  8471           DFHEIV99,
  8472           START-TRANS-ID,
  8473           DFHEIV99,
  8474           PROGRAM-INTERFACE-BLOCK,
  8475           PI-COMM-LENGTH,
  8476           CF-FORMS-PRINTER-ID,
  8477           DFHEIV99,
  8478           DFHEIV99,
  8479           DFHEIV99,
  8480           DFHEIV99,
  8481           DFHEIV99,
  8482           DFHEIV99,
  8483           DFHEIV99,
  8484           DFHEIV99,
  8485           DFHEIV99
  8486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8487
  8488
  8489      GO TO 0400-WRITE-CLAIM.
  8490
  8491 0385-TERMID-ERROR.
  8492     MOVE ER-0412                TO EMI-ERROR.
  8493     MOVE -1                     TO ALTPRTL.
  8494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8495     GO TO 8200-SEND-DATAONLY.
  8496
  8497 0390-TRANS-ERROR.
  8498     MOVE ER-0413                TO EMI-ERROR.
  8499     MOVE -1                     TO FILETOL.
  8500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8501     GO TO 8200-SEND-DATAONLY.
  8502
  8503 0400-WRITE-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 161
* EL150.cbl
  8504     IF FILETOL = 0  AND
  8505*       MCRFLML = 0  AND
  8506        ACTCDL  = 0  AND
  8507        ASSOCL  = 0  AND
  8508        CLOANL  = 0  AND
  8509        YESNOSWL = 0
  8510         GO TO 0440-UPDATE-DONE.
  8511
  8512
  8513* EXEC CICS HANDLE CONDITION
  8514*        NOTFND (0450-NOT-FOUND)
  8515*        DUPKEY (0440-UPDATE-DONE)
  8516*    END-EXEC.
  8517*    MOVE '"$I$                  ! & #00008223' TO DFHEIV0
  8518     MOVE X'222449242020202020202020' TO DFHEIV0(1:12)
  8519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8520     MOVE X'2620233030303038323233' TO DFHEIV0(25:11)
  8521     CALL 'kxdfhei1' USING DFHEIV0
  8522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8523
  8524
  8525     MOVE 'ELMSTR  '             TO FILE-ID.
  8526
  8527
  8528* EXEC CICS REWRITE
  8529*        DATASET   ('ELMSTR')
  8530*        FROM      (CLAIM-MASTER)
  8531*    END-EXEC.
  8532     MOVE LENGTH OF
  8533      CLAIM-MASTER
  8534       TO DFHEIV11
  8535     MOVE 'ELMSTR' TO DFHEIV1
  8536*    MOVE '&& L                  %   #00008230' TO DFHEIV0
  8537     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8538     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8539     MOVE X'2020233030303038323330' TO DFHEIV0(25:11)
  8540     CALL 'kxdfhei1' USING DFHEIV0,
  8541           DFHEIV1,
  8542           CLAIM-MASTER,
  8543           DFHEIV11,
  8544           DFHEIV99
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548 0440-UPDATE-DONE.
  8549     IF FILETOL  > 0 OR
  8550*       MCRFLML  > 0 OR
  8551        PRTOPTL  > 0 OR
  8552        FORMATL  > 0 OR
  8553        YESNOSWL > 0 OR
  8554        CLOANL   > 0 OR
  8555        ACTCDL   > 0
  8556            MOVE SV-LAST-BY             TO PI-UPDATE-BY
  8557            MOVE SV-LAST-HHMMSS         TO PI-UPDATE-HHMMSS.
  8558
  8559     PERFORM 6050-AUTO-LETTER-WRITER THRU 6050-EXIT.
  8560
  8561     MOVE ER-0000                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 162
* EL150.cbl
  8562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8563
  8564     IF CLAIM-IS-PURGED
  8565        CONTINUE
  8566*        MOVE -1                 TO  MCRFLML
  8567     ELSE
  8568         MOVE -1                 TO  FILETOL
  8569     END-IF
  8570
  8571     GO TO 8200-SEND-DATAONLY.
  8572
  8573 0450-NOT-FOUND.
  8574     IF FILE-SWITCH = 'MSTR'
  8575         MOVE ER-0204            TO EMI-ERROR
  8576     ELSE
  8577         MOVE ER-0190            TO EMI-ERROR.
  8578
  8579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8580
  8581     MOVE -1                     TO FILETOL.
  8582     GO TO 8200-SEND-DATAONLY.
  8583
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 163
* EL150.cbl
  8585 0500-CREATE-TEMP-STORAGE.
  8586
  8587     IF PI-SAVE-SYS-ID = 'CR'
  8588        IF PI-CLOSED
  8589           IF PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION
  8590              IF EIBAID = DFHPF7
  8591                 MOVE ER-0934            TO EMI-ERROR
  8592                 MOVE -1                 TO FILETOL
  8593                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8594                 GO TO 8200-SEND-DATAONLY
  8595              ELSE
  8596              IF EIBAID = DFHPF8
  8597                 MOVE ER-0935            TO EMI-ERROR
  8598                 MOVE -1                 TO FILETOL
  8599                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8600                 GO TO 8200-SEND-DATAONLY.
  8601
  8602     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8603
  8604     MOVE LOW-VALUES TO PI-SAVE-FILETO  PI-SAVE-PRTOPT
  8605                        PI-SAVE-FORMAT  PI-SAVE-MCRFLM
  8606                        PI-SAVE-ACT-CD  PI-SAVE-ASSOC
  8607                        TS-PI-SAVE-CLOAN.
  8608
  8609     MOVE FILETOI                TO PI-SAVE-FILETO.
  8610*    MOVE MCRFLMI                TO PI-SAVE-MCRFLM.
  8611     MOVE PRTOPTI                TO PI-SAVE-PRTOPT.
  8612     MOVE FORMATI                TO PI-SAVE-FORMAT.
  8613     MOVE ACTCDI                 TO PI-SAVE-ACT-CD.
  8614     MOVE CLOANI                 TO TS-PI-SAVE-CLOAN
  8615
  8616     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8617         MOVE ASSOCI             TO PI-SAVE-ASSOC.
  8618
  8619     MOVE PROGRAM-INTERFACE-BLOCK TO TS-PI-AREA
  8620
  8621
  8622* EXEC CICS WRITEQ TS
  8623*        QUEUE    (QID)
  8624*        FROM     (PROGRAM-INTERFACE-BLOCK)
  8625*        FROM     (TS-AREA)
  8626*        LENGTH   (PI-COMM-LENGTH)
  8627*        LENGTH   (TS-LENGTH)
  8628*    END-EXEC.
  8629*    MOVE '*"                    ''   #00008308' TO DFHEIV0
  8630     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8632     MOVE X'2020233030303038333038' TO DFHEIV0(25:11)
  8633     CALL 'kxdfhei1' USING DFHEIV0,
  8634           QID,
  8635           TS-AREA,
  8636           TS-LENGTH,
  8637           DFHEIV99,
  8638           DFHEIV99,
  8639           DFHEIV99
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 164
* EL150.cbl
  8643 0500-PF-CHECKS.
  8644
  8645     IF EIBAID = DFHPF3
  8646         IF PI-SAVE-SYS-ID = 'CV'
  8647             MOVE XCTL-EM131     TO PGM-NAME
  8648             GO TO 9300-XCTL
  8649         ELSE
  8650             MOVE XCTL-131       TO PGM-NAME
  8651             GO TO 9300-XCTL.
  8652
  8653     IF EIBAID = DFHPF4
  8654         MOVE XCTL-153           TO PGM-NAME
  8655         GO TO 9300-XCTL.
  8656
  8657     IF EIBAID = DFHPF5
  8658         IF PI-SAVE-SYS-ID = 'CV'
  8659             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  8660             MOVE XCTL-EM1273    TO PGM-NAME
  8661             GO TO 9300-XCTL
  8662         ELSE
  8663             MOVE XCTL-1273      TO PGM-NAME
  8664             GO TO 9300-XCTL.
  8665
  8666     IF EIBAID = DFHPF6
  8667       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6)
  8668         MOVE XCTL-154           TO PGM-NAME
  8669         GO TO 9300-XCTL.
  8670
  8671     IF EIBAID = DFHPF7
  8672       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7)
  8673         IF PI-SAVE-SYS-ID = 'CV'
  8674             IF PI-SAVE-TYPE = PI-LIFE-OVERRIDE-L1
  8675                 MOVE XCTL-EM156    TO  PGM-NAME
  8676                 GO TO 9300-XCTL
  8677             ELSE
  8678                 MOVE XCTL-EM1561   TO  PGM-NAME
  8679                 GO TO 9300-XCTL
  8680         ELSE
  8681             MOVE XCTL-156          TO PGM-NAME
  8682             GO TO 9300-XCTL.
  8683
  8684     IF EIBAID = DFHPF8
  8685         MOVE XCTL-151           TO PGM-NAME
  8686         GO TO 9300-XCTL.
  8687
  8688     IF EIBAID = DFHPF9
  8689         MOVE XCTL-152           TO PGM-NAME
  8690         GO TO 9300-XCTL.
  8691
  8692     IF EIBAID = DFHPF10
  8693         MOVE PI-SAVE-LOW        TO PI-PASS-AREA
  8694         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8695         MOVE XCTL-142           TO PGM-NAME
  8696         GO TO 9300-XCTL.
  8697
  8698     IF EIBAID = DFHPF11
  8699        IF PI-COMPANY-ID = 'DMD'
  8700           MOVE XCTL-155           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 165
* EL150.cbl
  8701           GO TO 9300-XCTL
  8702         ELSE
  8703           MOVE XCTL-157           TO PGM-NAME
  8704           GO TO 9300-XCTL.
  8705
  8706     IF EIBAID = DFHPF13
  8707         MOVE PI-SAVE-FORM       TO PI-PASS-AREA
  8708         MOVE XCTL-155           TO PGM-NAME
  8709         GO TO 9300-XCTL.
  8710
  8711     IF EIBAID = DFHPF14
  8712         MOVE XCTL-141           TO PGM-NAME
  8713         GO TO 9300-XCTL.
  8714
  8715     IF EIBAID = DFHPF17
  8716         MOVE XCTL-162           TO PGM-NAME
  8717         GO TO 9300-XCTL.
  8718
  8719     IF EIBAID = DFHPF18
  8720         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8721         MOVE XCTL-1501          TO PGM-NAME
  8722         GO TO 9300-XCTL.
  8723
  8724     IF EIBAID = DFHPF19
  8725         IF PI-SAVE-SYS-ID = 'CV'
  8726             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  8727             MOVE XCTL-EM1276    TO PGM-NAME
  8728             GO TO 9300-XCTL
  8729         ELSE
  8730         IF PI-COMPANY-ID = 'DMD'
  8731             MOVE 'EL401DMD'     TO PGM-NAME
  8732             GO TO 9300-XCTL
  8733          ELSE
  8734             MOVE XCTL-1279      TO PGM-NAME
  8735             GO TO 9300-XCTL.
  8736
  8737     IF EIBAID = DFHPF20
  8738         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8739         MOVE XCTL-1502          TO PGM-NAME
  8740         GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 166
* EL150.cbl
  8742 0600-RECOVER-TEMP-STORAGE.
  8743     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  8744
  8745
  8746* EXEC CICS HANDLE CONDITION
  8747*        QIDERR   (0690-QIDERR)
  8748*    END-EXEC
  8749*    MOVE '"$N                   ! '' #00008418' TO DFHEIV0
  8750     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8752     MOVE X'2720233030303038343138' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8755
  8756
  8757* EXEC CICS READQ TS
  8758*        QUEUE    (QID)
  8759*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8760*        INTO     (TS-AREA)
  8761*        LENGTH   (PI-COMM-LENGTH)
  8762*        LENGTH   (TS-LENGTH)
  8763*    END-EXEC
  8764*    MOVE '*$I    L              ''   #00008422' TO DFHEIV0
  8765     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8767     MOVE X'2020233030303038343232' TO DFHEIV0(25:11)
  8768     CALL 'kxdfhei1' USING DFHEIV0,
  8769           QID,
  8770           TS-AREA,
  8771           TS-LENGTH,
  8772           DFHEIV99,
  8773           DFHEIV99,
  8774           DFHEIV99
  8775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8776
  8777     MOVE TS-PI-AREA        TO PROGRAM-INTERFACE-BLOCK
  8778
  8779
  8780* EXEC CICS DELETEQ TS
  8781*        QUEUE   (QID)
  8782*    END-EXEC.
  8783*    MOVE '*&                    #   #00008432' TO DFHEIV0
  8784     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8785     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8786     MOVE X'2020233030303038343332' TO DFHEIV0(25:11)
  8787     CALL 'kxdfhei1' USING DFHEIV0,
  8788           QID,
  8789           DFHEIV99
  8790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8791
  8792
  8793     IF RETURNED-FROM NOT = XCTL-EM1273
  8794         MOVE SAVE-CONTROL       TO PI-CONTROL-IN-PROGRESS.
  8795
  8796     MOVE LOW-VALUES             TO EL150AO.
  8797
  8798*    IF PI-SAVE-MCRFLM NOT = LOW-VALUES
  8799*        MOVE PI-SAVE-MCRFLM     TO MCRFLMO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 167
* EL150.cbl
  8800
  8801     IF PI-SAVE-FILETO NOT = LOW-VALUES
  8802         MOVE PI-SAVE-FILETO     TO FILETOO.
  8803
  8804     IF TS-PI-SAVE-CLOAN NOT = LOW-VALUES
  8805        MOVE TS-PI-SAVE-CLOAN   TO CLOANO
  8806     END-IF
  8807
  8808     IF PI-SAVE-PRTOPT NOT = LOW-VALUES
  8809         MOVE PI-SAVE-PRTOPT     TO PRTOPTO
  8810         MOVE AL-UANON           TO PRTOPTA.
  8811
  8812     IF PI-SAVE-FORMAT NOT = LOW-VALUES
  8813         MOVE PI-SAVE-FORMAT     TO FORMATO
  8814         MOVE AL-UANON           TO FORMATA.
  8815
  8816     IF PI-SAVE-ACT-CD NOT = LOW-VALUES
  8817         MOVE PI-SAVE-ACT-CD     TO ACTCDO.
  8818
  8819     IF PI-SAVE-ASSOC  NOT = LOW-VALUES
  8820         MOVE PI-SAVE-ASSOC      TO ASSOCO.
  8821
  8822     MOVE 'N'                    TO DIRECTION-SWITCH.
  8823
  8824     MOVE SPACES TO PI-PFKEY-USED.
  8825     MOVE 0      TO PI-FORCE-COUNT.
  8826
  8827     GO TO 1000-SHOW-CLAIM.
  8828
  8829 0690-QIDERR.
  8830     MOVE ER-0033                TO EMI-ERROR.
  8831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8832     MOVE LOW-VALUES             TO EL150AO.
  8833     MOVE -1                     TO FILETOL.
  8834     GO TO 8100-SEND-INITIAL-MAP.
  8835
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 168
* EL150.cbl
  8837 1000-SHOW-CLAIM.
  8838
  8839     IF CLMNOL > 0
  8840         MOVE CLMNOI             TO PI-CLAIM-NO.
  8841
  8842     IF CARRL > 0
  8843         MOVE CARRI              TO PI-CARRIER.
  8844
  8845     IF CERTNOL > 0
  8846         MOVE CERTNOI            TO PI-CERT-PRIME.
  8847
  8848     IF SUFXL > 0
  8849         MOVE SUFXI              TO PI-CERT-SFX.
  8850
  8851     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8852     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8853     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  8854     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8855     MOVE 'MSTR'                 TO FILE-SWITCH.
  8856
  8857 1000-READ-CLAIM.
  8858
  8859
  8860* EXEC CICS HANDLE CONDITION
  8861*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  8862*    END-EXEC.
  8863*    MOVE '"$I                   ! ( #00008502' TO DFHEIV0
  8864     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8866     MOVE X'2820233030303038353032' TO DFHEIV0(25:11)
  8867     CALL 'kxdfhei1' USING DFHEIV0
  8868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8869
  8870
  8871
  8872* EXEC CICS READ
  8873*        DATASET   (PI-CURRENT-FILE)
  8874*        RIDFLD    (ELMSTR-KEY)
  8875*        INTO      (CLAIM-MASTER)
  8876*    END-EXEC.
  8877     MOVE LENGTH OF
  8878      CLAIM-MASTER
  8879       TO DFHEIV11
  8880*    MOVE '&"IL       E          (   #00008506' TO DFHEIV0
  8881     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8883     MOVE X'2020233030303038353036' TO DFHEIV0(25:11)
  8884     CALL 'kxdfhei1' USING DFHEIV0,
  8885           PI-CURRENT-FILE,
  8886           CLAIM-MASTER,
  8887           DFHEIV11,
  8888           ELMSTR-KEY,
  8889           DFHEIV99,
  8890           DFHEIV99,
  8891           DFHEIV99
  8892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8893
  8894
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 169
* EL150.cbl
  8895 1000-CONTINUE-WITH-RETRIEVED.
  8896
  8897     if (pi-company-id = 'CID' OR 'DCC')
  8898        and (cl-priority-cd = '8')
  8899        move 'S'                 to pi-priority-ind
  8900     end-if
  8901
  8902     IF PI-COMPANY-ID = 'DMD'
  8903         IF HIGHEST-PRIORITY
  8904             MOVE 'S'            TO PI-PRIORITY-IND
  8905             MOVE ER-0933        TO EMI-ERROR
  8906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8907         ELSE
  8908             IF NOT CONFIDENTIAL-DATA
  8909                 MOVE LOW-VALUES TO PI-PRIORITY-IND.
  8910
  8911     IF PI-COMPANY-ID = 'DMD'
  8912             AND
  8913        PI-ASS-PROCESSING
  8914             AND
  8915        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  8916         NEXT SENTENCE
  8917     ELSE
  8918         MOVE ELMSTR-KEY         TO PI-PREV-CLAIM
  8919         MOVE CL-PRIME-CERT-NO   TO PI-PREV-PRIME-CERT-NO.
  8920
  8921     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
  8922     MOVE CL-PRIORITY-CD         TO PI-PRIORITY-CD.
  8923
  8924     IF CL-LAST-MAINT-HHMMSS IS NOT NUMERIC
  8925         MOVE EIBTIME            TO PI-UPDATE-HHMMSS
  8926     ELSE
  8927         MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  8928
  8929     MOVE CL-TRAILER-SEQ-CNT     TO PI-SAVE-CNT.
  8930
  8931     IF CL-YESNOSW = 'Y' OR 'N'
  8932         MOVE CL-YESNOSW         TO YESNOSWO
  8933     ELSE
  8934         MOVE 'Y'                TO YESNOSWO
  8935     END-IF.
  8936
  8937     MOVE CL-CLAIM-NO            TO CLMNOO
  8938                                    PI-CLAIM-NO.
  8939     MOVE CL-CARRIER             TO CARRO
  8940                                    PI-CARRIER.
  8941     MOVE CL-CERT-PRIME          TO CERTNOO
  8942                                    PI-CERT-PRIME.
  8943     MOVE CL-CERT-SFX            TO SUFXO
  8944                                    PI-CERT-SFX.
  8945     MOVE CL-CCN                 TO CRDCARDO
  8946
  8947     MOVE CL-SYSTEM-IDENTIFIER   TO PI-SAVE-SYS-ID.
  8948
  8949     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8950         MOVE CL-CV-REFERENCE-NO TO PI-MP-REFERENCE-NO.
  8951
  8952     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 170
* EL150.cbl
  8953         MOVE SPACES                 TO PRIMCRTO
  8954                                        PRIMSFXO
  8955                                        PRIMHDGO
  8956                                        SEQUO
  8957         MOVE AL-SADOF               TO PRIMCRTA
  8958                                        PRIMSFXA
  8959                                        PRIMHDGA
  8960                                        SEQUA
  8961     ELSE
  8962         MOVE CL-ASSOC-CERT-SEQU     TO WS-CUR-SEQU
  8963         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
  8964         MOVE WS-CLAIM-SEQUENCE      TO SEQUO
  8965         MOVE CL-PRIME-CERT-PRIME    TO PRIMCRTO
  8966         MOVE CL-PRIME-CERT-SFX      TO PRIMSFXO
  8967         MOVE 'PRIME CERT :'         TO PRIMHDGO
  8968         MOVE AL-SABON               TO PRIMCRTA
  8969                                        PRIMSFXA
  8970                                        PRIMHDGA
  8971                                        SEQUA.
  8972
  8973     MOVE CL-CLAIM-TYPE          TO PI-SAVE-TYPE.
  8974     MOVE CL-CERT-GROUPING       TO PI-GROUPING.
  8975     MOVE CL-CERT-STATE          TO PI-STATE.
  8976
  8977     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8978         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  8979         MOVE CL-CURRENT-ACCOUNT TO  ACCTO
  8980     ELSE
  8981         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  8982                                     ACCTO.
  8983
  8984     MOVE CL-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8985
  8986     EVALUATE TRUE
  8987        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  8988           MOVE PI-AH-OVERRIDE-L6
  8989                                 TO CLMTYPO
  8990
  8991        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  8992           MOVE PI-LIFE-OVERRIDE-L6
  8993                                 TO CLMTYPO
  8994
  8995        WHEN CL-CLAIM-TYPE = 'I'
  8996           MOVE '  IU  '         TO CLMTYPO
  8997
  8998        WHEN CL-CLAIM-TYPE = 'G'
  8999           MOVE ' GAP  '         TO CLMTYPO
  9000
  9001     END-EVALUATE
  9002     IF CLAIM-IS-OPEN
  9003         MOVE ' OPEN'            TO CLMSTATO
  9004     ELSE
  9005         MOVE 'CLOSED'           TO CLMSTATO.
  9006
  9007*    IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  9008*        IF (CLAIM-IS-CLOSED)  AND
  9009*           (CL-LAST-CLOSE-REASON = '2')
  9010*            MOVE 'DENIED'       TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 171
* EL150.cbl
  9011
  9012     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
  9013     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  9014     MOVE CL-INSURED-MID-INIT    TO MINITO.
  9015
  9016     IF CL-NO-OF-PMTS-MADE = +0 AND
  9017        CL-TOTAL-PAID-AMT = +0
  9018         NEXT SENTENCE
  9019     ELSE
  9020         IF CL-PAID-THRU-DT NOT = LOW-VALUES
  9021             MOVE CL-PAID-THRU-DT        TO  DC-BIN-DATE-1
  9022             MOVE ' '                    TO  DC-OPTION-CODE
  9023             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9024             MOVE DC-GREG-DATE-1-EDIT    TO  PDTHRUO
  9025             IF PI-USES-PAID-TO
  9026                 MOVE CL-PAID-THRU-DT    TO  DC-BIN-DATE-1
  9027                 MOVE '6'                TO  DC-OPTION-CODE
  9028                 MOVE +1                 TO  DC-ELAPSED-DAYS
  9029                 MOVE +0                 TO  DC-ELAPSED-MONTHS
  9030                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9031                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
  9032
  9033     IF CL-INCURRED-DT NOT = LOW-VALUES
  9034         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9035         MOVE ' '                TO DC-OPTION-CODE
  9036         MOVE +0                 TO DC-ELAPSED-DAYS
  9037                                    DC-ELAPSED-MONTHS
  9038         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9039         MOVE DC-GREG-DATE-1-EDIT TO INCURO.
  9040
  9041     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
  9042        EVALUATE CL-DENIAL-TYPE
  9043           WHEN '1'
  9044              MOVE 'DENIAL STATUS - DENIAL       '
  9045                                 TO DENTYPO
  9046           WHEN '2'
  9047              MOVE 'DENIAL STATUS - RESCISSION   '
  9048                                 TO DENTYPO
  9049           WHEN '3'
  9050              MOVE 'DENIAL STATUS - REFORMATION  '
  9051                                 TO DENTYPO
  9052           WHEN '4'
  9053              MOVE 'DENIAL STATUS - REF TO RESC  '
  9054                                 TO DENTYPO
  9055           WHEN '5'
  9056              MOVE 'DENIAL STATUS - RECONSIDERED '
  9057                                 TO DENTYPO
  9058        END-EVALUATE
  9059        MOVE AL-SANOF            TO DENTYPA
  9060     END-IF
  9061     IF CL-NEXT-AUTO-PAY-DT NOT = LOW-VALUES
  9062         MOVE CL-NEXT-AUTO-PAY-DT TO DC-BIN-DATE-1
  9063         MOVE ' '                TO DC-OPTION-CODE
  9064         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9065         MOVE DC-GREG-DATE-1-EDIT TO NXTAUTOO
  9066         IF PI-USES-PAID-TO
  9067             MOVE CL-NEXT-AUTO-PAY-DT   TO  DC-BIN-DATE-1
  9068             MOVE '6'                   TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 172
* EL150.cbl
  9069             MOVE +1                    TO  DC-ELAPSED-DAYS
  9070             MOVE +0                    TO  DC-ELAPSED-MONTHS
  9071             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9072             IF NO-CONVERSION-ERROR
  9073                 MOVE DC-GREG-DATE-1-EDIT   TO  NXTAUTOO
  9074             ELSE
  9075                 MOVE LOW-VALUES            TO  NXTAUTOO.
  9076
  9077     IF CL-FILE-ESTABLISH-DT NOT = LOW-VALUES
  9078         MOVE CL-FILE-ESTABLISH-DT      TO  DC-BIN-DATE-1
  9079         MOVE ' '                       TO  DC-OPTION-CODE
  9080         MOVE +0                        TO  DC-ELAPSED-DAYS
  9081                                            DC-ELAPSED-MONTHS
  9082         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9083         IF NO-CONVERSION-ERROR
  9084             MOVE DC-GREG-DATE-1-EDIT   TO  ESTABDTO
  9085         ELSE
  9086             MOVE SPACES                TO  ESTABDTO.
  9087
  9088*    MOVE CL-MICROFILM-NO        TO MCRFLMO.
  9089     MOVE CL-FILE-LOCATION       TO FILETOO.
  9090
  9091     IF CL-CERT-EFF-DT NOT = LOW-VALUES
  9092         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
  9093         MOVE ' '                TO DC-OPTION-CODE
  9094         MOVE +0                 TO DC-ELAPSED-DAYS
  9095                                    DC-ELAPSED-MONTHS
  9096         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9097         MOVE DC-GREG-DATE-1-EDIT TO EFFECTO.
  9098
  9099     IF CL-TOTAL-INT-PAID NOT NUMERIC
  9100        MOVE +0                  TO CL-TOTAL-INT-PAID
  9101     END-IF
  9102     MOVE CL-TOTAL-INT-PAID      TO TOTINTO
  9103     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
  9104     MOVE CL-TOTAL-PAID-AMT      TO PI-TOTAL-PAID.
  9105
  9106     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9107         MOVE CL-CURRENT-STATE   TO  STATEO
  9108     ELSE
  9109     IF PI-COMPANY-ID = 'DMD'
  9110         MOVE PI-COMPANY-CD          TO CERT-COMP-CD
  9111         MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9112         MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9113         MOVE CL-CERT-STATE          TO CERT-STATE
  9114         MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9115         MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9116         MOVE CL-CERT-NO             TO CERT-CERT-NO
  9117         MOVE 'CERT'                 TO FILE-SWITCH
  9118
  9119* EXEC CICS READ
  9120*            DATASET   ('ELCERT')
  9121*            SET       (ADDRESS OF CERTIFICATE-MASTER)
  9122*            RIDFLD    (ELCERT-KEY)
  9123*        END-EXEC
  9124     MOVE 'ELCERT' TO DFHEIV1
  9125*    MOVE '&"S        E          (   #00008735' TO DFHEIV0
  9126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 173
* EL150.cbl
  9127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9128     MOVE X'2020233030303038373335' TO DFHEIV0(25:11)
  9129     CALL 'kxdfhei1' USING DFHEIV0,
  9130           DFHEIV1,
  9131           DFHEIV20,
  9132           DFHEIV99,
  9133           ELCERT-KEY,
  9134           DFHEIV99,
  9135           DFHEIV99,
  9136           DFHEIV99
  9137     SET ADDRESS OF CERTIFICATE-MASTER TO
  9138         DFHEIV20
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9140         MOVE CM-RESIDENT-STATE  TO  STATEO
  9141     ELSE
  9142         MOVE CL-CERT-STATE      TO  STATEO.
  9143
  9144     MOVE CL-ACTIVITY-CODE       TO  ACTCDO.
  9145     MOVE CL-ACTIVITY-MAINT-TYPE TO  ACTTYPO.
  9146
  9147     IF CL-ACTIVITY-MAINT-DT = SPACES OR LOW-VALUES
  9148         MOVE SPACES                     TO  ACTDTO
  9149     ELSE
  9150         MOVE CL-ACTIVITY-MAINT-DT       TO  DC-BIN-DATE-1
  9151         MOVE ' '                        TO  DC-OPTION-CODE
  9152         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9153         IF NO-CONVERSION-ERROR
  9154             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO
  9155         ELSE
  9156             MOVE SPACES                 TO  ACTDTO.
  9157
  9158     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9159         MOVE 'ASSOC:'               TO  ASSHDGO
  9160         MOVE AL-SABON               TO  ASSHDGA
  9161         MOVE CL-ASSOCIATES          TO  ASSOCO
  9162     ELSE
  9163         MOVE SPACES                 TO  ASSHDGO
  9164         MOVE AL-SADOF               TO  ASSOCA.
  9165
  9166     MOVE CL-CLAIM-STATUS        TO PI-STATUS-IND.
  9167     MOVE CL-LAST-CLOSE-REASON   TO PI-LAST-CLOSE-REASON-IND.
  9168
  9169     IF PI-COMPANY-ID = 'DMD'
  9170             AND
  9171         ((PI-ASS-PROCESSING  AND
  9172           PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO)
  9173                 OR
  9174         ((PI-CLOSED AND
  9175          (PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION))
  9176                 OR
  9177           CL-CERT-NO NOT = CL-PRIME-CERT-NO))
  9178         PERFORM 1200-GET-ASS-TOTALS THRU 1200-EXIT
  9179     ELSE
  9180         MOVE LOW-VALUES             TO PI-LAST-PF-KEY-IND
  9181                                        PI-ASSOCIATED-CERTS-TABLE
  9182                                        PI-ASSOCIATED-PROCESS-IND
  9183         MOVE SPACES                 TO AMTPDO
  9184                                        DAYSPDO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 174
* EL150.cbl
  9185                                        CLMTOTHO
  9186                                        DAYSPDHO
  9187*01745          MOVE ZEROS                  TO PI-TOTAL-PAID
  9188         MOVE ZEROS                  TO
  9189                                        PI-DAYS-PAID
  9190                                        PI-LAST-SEQ-NO
  9191                                        PI-ASS-NDX.
  9192
  9193
  9194* EXEC CICS HANDLE CONDITION
  9195*        NOTFND    (1005-END-BUILD-DIAGNOSIS)
  9196*    END-EXEC.
  9197*    MOVE '"$I                   ! ) #00008793' TO DFHEIV0
  9198     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9200     MOVE X'2920233030303038373933' TO DFHEIV0(25:11)
  9201     CALL 'kxdfhei1' USING DFHEIV0
  9202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9203
  9204
  9205     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9206     MOVE +90                 TO TRLR-SEQ-NO.
  9207     MOVE 'TRLR'              TO FILE-SWITCH.
  9208
  9209
  9210* EXEC CICS READ
  9211*        DATASET   ('ELTRLR')
  9212*        RIDFLD    (ELTRLR-KEY)
  9213*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9214*    END-EXEC.
  9215     MOVE 'ELTRLR' TO DFHEIV1
  9216*    MOVE '&"S        E          (   #00008801' TO DFHEIV0
  9217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9219     MOVE X'2020233030303038383031' TO DFHEIV0(25:11)
  9220     CALL 'kxdfhei1' USING DFHEIV0,
  9221           DFHEIV1,
  9222           DFHEIV20,
  9223           DFHEIV99,
  9224           ELTRLR-KEY,
  9225           DFHEIV99,
  9226           DFHEIV99,
  9227           DFHEIV99
  9228     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9229         DFHEIV20
  9230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9231
  9232
  9233     MOVE AT-INFO-LINE-1         TO DIAGO.
  9234
  9235 1005-END-BUILD-DIAGNOSIS.
  9236
  9237     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9238     MOVE +91                 TO TRLR-SEQ-NO.
  9239     MOVE 'TRLR'              TO FILE-SWITCH.
  9240
  9241
  9242* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 175
* EL150.cbl
  9243*        DATASET   ('ELTRLR')
  9244*        RIDFLD    (ELTRLR-KEY)
  9245*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9246*        RESP      (WS-RESPONSE)
  9247*    END-EXEC.
  9248     MOVE 'ELTRLR' TO DFHEIV1
  9249*    MOVE '&"S        E          (  N#00008815' TO DFHEIV0
  9250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9252     MOVE X'204E233030303038383135' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           DFHEIV1,
  9255           DFHEIV20,
  9256           DFHEIV99,
  9257           ELTRLR-KEY,
  9258           DFHEIV99,
  9259           DFHEIV99,
  9260           DFHEIV99
  9261     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9262         DFHEIV20
  9263     MOVE EIBRESP  TO WS-RESPONSE
  9264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9265
  9266
  9267     IF WS-RESP-NORMAL
  9268        MOVE AT-INFO-LINE-1      TO CLOANO
  9269     ELSE
  9270        MOVE SPACES              TO CLOANO
  9271     END-IF
  9272
  9273     IF CL-SYSTEM-IDENTIFIER = 'CV'
  9274         PERFORM 1500-READ-CONVENIENCE-FILES THRU 1500-EXIT
  9275         GO TO 1050-SHOW-CONTINUE.
  9276
  9277
  9278* EXEC CICS HANDLE CONDITION
  9279*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  9280*    END-EXEC.
  9281*    MOVE '"$I                   ! * #00008832' TO DFHEIV0
  9282     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9284     MOVE X'2A20233030303038383332' TO DFHEIV0(25:11)
  9285     CALL 'kxdfhei1' USING DFHEIV0
  9286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9287
  9288
  9289     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9290     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9291     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9292     MOVE CL-CERT-STATE          TO CERT-STATE.
  9293     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9294     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9295     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9296     MOVE 'CERT'                 TO FILE-SWITCH.
  9297
  9298
  9299* EXEC CICS READ
  9300*        DATASET   ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 176
* EL150.cbl
  9301*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  9302*        RIDFLD    (ELCERT-KEY)
  9303*    END-EXEC.
  9304     MOVE 'ELCERT' TO DFHEIV1
  9305*    MOVE '&"S        E          (   #00008845' TO DFHEIV0
  9306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9308     MOVE X'2020233030303038383435' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0,
  9310           DFHEIV1,
  9311           DFHEIV20,
  9312           DFHEIV99,
  9313           ELCERT-KEY,
  9314           DFHEIV99,
  9315           DFHEIV99,
  9316           DFHEIV99
  9317     SET ADDRESS OF CERTIFICATE-MASTER TO
  9318         DFHEIV20
  9319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9320
  9321
  9322     MOVE 'Y'                    TO WS-CERT-READ-SW.
  9323     MOVE LOW-VALUES             TO ERACCT-KEY.
  9324     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9325     MOVE CL-CERT-CARRIER        TO ACCT-CARRIER.
  9326     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9327     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9328     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9329     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT.
  9330     MOVE 'ACCT'                 TO FILE-SWITCH.
  9331
  9332     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9333     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9334
  9335
  9336* EXEC CICS HANDLE CONDITION
  9337*         NOTFND   (1005-NO-ERACCT)
  9338*         ENDFILE  (1005-NO-ERACCT)
  9339*    END-EXEC.
  9340*    MOVE '"$I''                  ! + #00008864' TO DFHEIV0
  9341     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9343     MOVE X'2B20233030303038383634' TO DFHEIV0(25:11)
  9344     CALL 'kxdfhei1' USING DFHEIV0
  9345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9346
  9347
  9348
  9349* EXEC CICS STARTBR
  9350*         DATASET   ('ERACCT')
  9351*         RIDFLD    (ERACCT-KEY)
  9352*         GTEQ
  9353*    END-EXEC.
  9354     MOVE 'ERACCT' TO DFHEIV1
  9355     MOVE 0
  9356       TO DFHEIV11
  9357*    MOVE '&,         G          &   #00008869' TO DFHEIV0
  9358     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 177
* EL150.cbl
  9359     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9360     MOVE X'2020233030303038383639' TO DFHEIV0(25:11)
  9361     CALL 'kxdfhei1' USING DFHEIV0,
  9362           DFHEIV1,
  9363           ERACCT-KEY,
  9364           DFHEIV99,
  9365           DFHEIV11,
  9366           DFHEIV99
  9367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9368
  9369
  9370 1005-READ-NEXT-ACCOUNT.
  9371
  9372
  9373* EXEC CICS READNEXT
  9374*         DATASET   ('ERACCT')
  9375*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9376*         RIDFLD    (ERACCT-KEY)
  9377*    END-EXEC.
  9378     MOVE 'ERACCT' TO DFHEIV1
  9379     MOVE 0
  9380       TO DFHEIV11
  9381*    MOVE '&.S                   )   #00008877' TO DFHEIV0
  9382     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9384     MOVE X'2020233030303038383737' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0,
  9386           DFHEIV1,
  9387           DFHEIV20,
  9388           DFHEIV99,
  9389           ERACCT-KEY,
  9390           DFHEIV99,
  9391           DFHEIV11,
  9392           DFHEIV99,
  9393           DFHEIV99
  9394     SET ADDRESS OF ACCOUNT-MASTER TO
  9395         DFHEIV20
  9396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9397
  9398
  9399     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9400        IF WS-ERACCT-HOLD-RECORD = SPACES
  9401           GO TO 1005-NO-ERACCT
  9402        ELSE
  9403           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9404           GO TO 1005-CONTINUE.
  9405
  9406     IF ACCT-EXP-DT = HIGH-VALUES
  9407        NEXT SENTENCE
  9408     ELSE
  9409        MOVE ACCOUNT-MASTER      TO WS-ERACCT-HOLD-RECORD
  9410        GO TO 1005-READ-NEXT-ACCOUNT.
  9411
  9412 1005-CONTINUE.
  9413
  9414     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9415        MOVE ZEROS               TO AM-3RD-PARTY-NOTIF-LEVEL.
  9416
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 178
* EL150.cbl
  9417     IF AM-3RD-PARTY-NOTIF-LEVEL > ZERO
  9418        MOVE 'THIRD PARTY'       TO NOTIFYO.
  9419
  9420 1005-NO-ERACCT.
  9421
  9422     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
  9423        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
  9424        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
  9425            MOVE 'N' TO PI-JOINT-INSURED-IND
  9426     ELSE
  9427            MOVE 'Y' TO PI-JOINT-INSURED-IND
  9428     END-IF.
  9429
  9430     IF CM-SING-PRM
  9431         MOVE 'SING PRM'         TO PRMTYPEO
  9432     ELSE
  9433         IF CM-O-B-COVERAGE
  9434             MOVE 'OUT BAL'      TO PRMTYPEO
  9435         ELSE
  9436             MOVE 'OPEN END'     TO PRMTYPEO.
  9437
  9438     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9439        GO TO 1006-CALC-LIFE.
  9440
  9441     MOVE 'MO. BENEFIT :'       TO BENECAPO.
  9442     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
  9443     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
  9444
  9445     IF PI-COMPANY-ID = 'DMD'
  9446         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
  9447         MOVE W-PAYMENTS         TO NOPMTSO
  9448         GO TO 1005-RTRM-CONT
  9449     ELSE
  9450         MOVE SAVE-BIN-DATE      TO CP-VALUATION-DT
  9451         MOVE SPACES             TO W-PAYMENTS
  9452         MOVE CL-NO-OF-PMTS-MADE TO W-PYMTS
  9453         MOVE W-PAYMENTS         TO NOPMTSO.
  9454
  9455     IF CM-AH-ORIG-TERM = +0
  9456        MOVE +1                 TO CP-ORIGINAL-TERM
  9457     ELSE
  9458        MOVE CM-AH-ORIG-TERM    TO CP-ORIGINAL-TERM.
  9459
  9460     MOVE PI-REM-TRM-CALC-OPTION
  9461                                TO CP-REM-TRM-CALC-OPTION.
  9462     MOVE '4'                   TO CP-REM-TERM-METHOD.
  9463     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID
  9464     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
  9465     PERFORM 9800-LINK-REM-TERM.
  9466     MOVE CP-REMAINING-TERM-3   TO WST-REM.
  9467
  9468 1005-RTRM-CONT.
  9469
  9470     MOVE CM-AH-BENEFIT-AMT     TO BENEO.
  9471
  9472     MOVE CM-POLICY-FORM-NO     TO PI-SAVE-FORM.
  9473     MOVE CM-STATE              TO PI-CR-STATE.
  9474     MOVE WS-TERMS              TO TERMSO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 179
* EL150.cbl
  9475     MOVE CM-AH-ORIG-TERM       TO WST-ORIG
  9476                                   DC-ELAPSED-MONTHS
  9477     MOVE WS-TERMS              TO TERMSO.
  9478     MOVE CM-AH-CURRENT-STATUS TO WS-STATUS.
  9479
  9480     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9481         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  9482         MOVE '6'                    TO  DC-OPTION-CODE
  9483         MOVE '1'                    TO  DC-END-OF-MONTH
  9484         MOVE +0                     TO  DC-ELAPSED-DAYS
  9485                                         DC-ODD-DAYS-OVER
  9486         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  9487         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9488         IF NO-CONVERSION-ERROR
  9489             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9490         ELSE
  9491             MOVE SPACES                 TO  EXPIREO
  9492     ELSE
  9493         MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  9494         MOVE ' '                    TO  DC-OPTION-CODE
  9495         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9496         IF NO-CONVERSION-ERROR
  9497             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9498         ELSE
  9499             MOVE SPACES                 TO  EXPIREO.
  9500
  9501     GO TO 1009-CONTINUE-BUILD.
  9502
  9503 1006-CALC-LIFE.
  9504
  9505     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9506     MOVE '4'                    TO CNTL-REC-TYPE.
  9507     MOVE SPACES                 TO CNTL-ACCESS.
  9508     MOVE CM-LF-BENEFIT-CD       TO CNTL-BEN-NO.
  9509     MOVE +0                     TO CNTL-SEQ-NO.
  9510     MOVE 'CNTL'                 TO FILE-SWITCH.
  9511
  9512
  9513* EXEC CICS HANDLE CONDITION
  9514*         NOTFND    (1008-NOTFND)
  9515*         ENDFILE   (1008-NOTFND)
  9516*    END-EXEC.
  9517*    MOVE '"$I''                  ! , #00008996' TO DFHEIV0
  9518     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9520     MOVE X'2C20233030303038393936' TO DFHEIV0(25:11)
  9521     CALL 'kxdfhei1' USING DFHEIV0
  9522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9523
  9524
  9525
  9526* EXEC CICS READ
  9527*        DATASET   ('ELCNTL')
  9528*        SET       (ADDRESS OF CONTROL-FILE)
  9529*        RIDFLD    (ELCNTL-KEY)
  9530*        GTEQ
  9531*    END-EXEC.
  9532     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 180
* EL150.cbl
  9533*    MOVE '&"S        G          (   #00009001' TO DFHEIV0
  9534     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9536     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9537     CALL 'kxdfhei1' USING DFHEIV0,
  9538           DFHEIV1,
  9539           DFHEIV20,
  9540           DFHEIV99,
  9541           ELCNTL-KEY,
  9542           DFHEIV99,
  9543           DFHEIV99,
  9544           DFHEIV99
  9545     SET ADDRESS OF CONTROL-FILE TO
  9546         DFHEIV20
  9547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9548
  9549
  9550     IF PI-COMPANY-ID NOT = CF-COMPANY-ID OR
  9551        CF-RECORD-TYPE NOT = '4'
  9552          GO TO 1008-NOTFND.
  9553
  9554     MOVE +1 TO WS-INDEX.
  9555
  9556 1007-TABLE-LOOKUP.
  9557
  9558     IF CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (WS-INDEX)
  9559        MOVE CF-LF-COVERAGE-TYPE (WS-INDEX) TO CP-BENEFIT-TYPE
  9560                                               WS-LF-COVERAGE-TYPE
  9561        MOVE CF-CO-EARNINGS-CALC (WS-INDEX) TO WS-EARNING-METHOD
  9562        MOVE CF-SPECIAL-CALC-CD (WS-INDEX)  TO CP-SPECIAL-CALC-CD
  9563        GO TO 1008-CONTINUE.
  9564
  9565     IF CF-BENEFIT-CODE (WS-INDEX) NOT < CF-HI-BEN-IN-REC
  9566        GO TO 1008-NOTFND.
  9567
  9568     IF WS-INDEX < +8
  9569        ADD +1 TO WS-INDEX
  9570        GO TO 1007-TABLE-LOOKUP.
  9571
  9572 1008-NOTFND.
  9573
  9574     MOVE ZEROS TO BENEO.
  9575     GO TO 1009-CONTINUE-BUILD.
  9576
  9577 1008-CONTINUE.
  9578
  9579     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
  9580     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
  9581     MOVE CL-INCURRED-DT        TO CP-VALUATION-DT.
  9582
  9583     IF CM-LF-ORIG-TERM = +0
  9584        MOVE +1                TO CP-ORIGINAL-TERM
  9585     ELSE
  9586        MOVE CM-LF-ORIG-TERM   TO CP-ORIGINAL-TERM.
  9587
  9588     MOVE CM-LF-ORIG-TERM      TO WST-ORIG
  9589                                  DC-ELAPSED-MONTHS.
  9590     MOVE CM-LF-CURRENT-STATUS TO WS-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 181
* EL150.cbl
  9591
  9592     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9593         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  9594         MOVE '6'                    TO  DC-OPTION-CODE
  9595         MOVE '1'                    TO  DC-END-OF-MONTH
  9596         MOVE +0                     TO  DC-ELAPSED-DAYS
  9597                                         DC-ODD-DAYS-OVER
  9598         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
  9599         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9600         IF NO-CONVERSION-ERROR
  9601             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9602         ELSE
  9603             MOVE SPACES                 TO  EXPIREO
  9604     ELSE
  9605         MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  9606         MOVE ' '                    TO  DC-OPTION-CODE
  9607         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9608         IF NO-CONVERSION-ERROR
  9609             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9610         ELSE
  9611             MOVE SPACES                 TO  EXPIREO.
  9612
  9613     MOVE PI-REM-TRM-CALC-OPTION
  9614                                TO CP-REM-TRM-CALC-OPTION.
  9615     MOVE '4'                   TO CP-REM-TERM-METHOD.
  9616     MOVE WS-EARNING-METHOD     TO CP-EARNING-METHOD.
  9617     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  9618     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
  9619     PERFORM 9800-LINK-REM-TERM.
  9620
  9621     MOVE CP-REMAINING-TERM-3    TO WST-REM.
  9622     MOVE SPACES                 TO WST-REM-DAYS-GRP
  9623                                    WST-ORIG-DAYS-GRP.
  9624     MOVE WS-TERMS               TO TERMSO.
  9625
  9626     MOVE SPACES                 TO W-PAYMENTS
  9627     MOVE CL-NO-OF-PMTS-MADE     TO W-PYMTS
  9628     MOVE W-PAYMENTS             TO NOPMTSO.
  9629
  9630 1009-CALC-REM-AMT.
  9631
  9632     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9633     MOVE PI-STATE               TO WS-ST-ACCESS.
  9634     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
  9635     MOVE '3'                    TO CNTL-REC-TYPE.
  9636     MOVE +0                     TO CNTL-SEQ-NO.
  9637     MOVE 'CNTL'                 TO  FILE-SWITCH.
  9638
  9639
  9640* EXEC CICS HANDLE CONDITION
  9641*        NOTFND   (1009-CONTINUE-BUILD)
  9642*        ENDFILE  (1009-CONTINUE-BUILD)
  9643*    END-EXEC.
  9644*    MOVE '"$I''                  ! - #00009097' TO DFHEIV0
  9645     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9647     MOVE X'2D20233030303039303937' TO DFHEIV0(25:11)
  9648     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 182
* EL150.cbl
  9649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9650
  9651
  9652
  9653* EXEC CICS READ
  9654*        DATASET   ('ELCNTL')
  9655*        SET       (ADDRESS OF CONTROL-FILE)
  9656*        RIDFLD    (ELCNTL-KEY)
  9657*    END-EXEC.
  9658     MOVE 'ELCNTL' TO DFHEIV1
  9659*    MOVE '&"S        E          (   #00009102' TO DFHEIV0
  9660     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9661     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9662     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9663     CALL 'kxdfhei1' USING DFHEIV0,
  9664           DFHEIV1,
  9665           DFHEIV20,
  9666           DFHEIV99,
  9667           ELCNTL-KEY,
  9668           DFHEIV99,
  9669           DFHEIV99,
  9670           DFHEIV99
  9671     SET ADDRESS OF CONTROL-FILE TO
  9672         DFHEIV20
  9673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9674
  9675
  9676     MOVE CF-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
  9677     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
  9678
  9679     IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  9680        MOVE ZEROS                 TO BENEO
  9681     ELSE
  9682        MOVE CP-REMAINING-TERM-3   TO CP-REMAINING-TERM
  9683        MOVE CM-LF-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  9684        MOVE CM-LF-ALT-BENEFIT-AMT TO CP-ALTERNATE-BENEFIT
  9685        MOVE CM-LOAN-APR           TO CP-LOAN-APR
  9686        MOVE CM-LOAN-TERM          TO CP-LOAN-TERM
  9687        MOVE CM-PAY-FREQUENCY      TO CP-PAY-FREQUENCY
  9688        PERFORM 9850-LINK-REM-AMT THRU 9850-EXIT
  9689        MOVE CP-REMAINING-AMT      TO BENEO.
  9690
  9691     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9692        WS-LF-COVERAGE-TYPE = 'P'
  9693         COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
  9694                                    CM-LF-ITD-DEATH-AMT
  9695         MOVE WS-REMAINING-AMT    TO  BENEO.
  9696
  9697 1009-CONTINUE-BUILD.
  9698
  9699     MOVE CM-POLICY-FORM-NO  TO PI-SAVE-FORM.
  9700
  9701     IF WS-STATUS = '6' OR '7' OR '8'
  9702        MOVE AL-SABOF              TO CRTSTATA.
  9703
  9704     IF WS-STATUS = '1' OR '4'
  9705        IF CP-REMAINING-TERM-3 = ZEROS
  9706           MOVE 'EXPIRED'        TO CRTSTATO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 183
* EL150.cbl
  9707        ELSE
  9708           MOVE 'ACTIVE  '       TO CRTSTATO.
  9709
  9710     IF WS-STATUS = '2'
  9711         MOVE 'PEND    '         TO CRTSTATO.
  9712
  9713     IF WS-STATUS = '3'
  9714         MOVE 'RESTORE '         TO CRTSTATO.
  9715
  9716     IF WS-STATUS = '5'
  9717         MOVE 'REISSUE '         TO CRTSTATO.
  9718
  9719     IF WS-STATUS = '6'
  9720         MOVE 'LMP DIS'          TO CRTSTATO.
  9721
  9722     IF WS-STATUS = '7'
  9723         MOVE 'DEATH'            TO CRTSTATO.
  9724
  9725     IF WS-STATUS = '8'
  9726         MOVE 'CANCEL'           TO CRTSTATO.
  9727
  9728     IF WS-STATUS = '9'
  9729         MOVE 'RE-ONLY '         TO CRTSTATO.
  9730
  9731     IF WS-STATUS = 'D'
  9732         MOVE 'DECLINE'          TO CRTSTATO.
  9733
  9734     IF WS-STATUS = 'V'
  9735         MOVE 'VOID'             TO CRTSTATO.
  9736
  9737     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
  9738        MOVE CM-AH-BENEFIT-CD    TO WS-BEN-CD
  9739        MOVE '5'                 TO CNTL-REC-TYPE
  9740     END-IF
  9741
  9742     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9743         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
  9744         MOVE '4'                TO CNTL-REC-TYPE.
  9745
  9746     MOVE '** NONE **'           TO COVERO.
  9747
  9748     IF WS-BEN-CD = ZERO
  9749         MOVE AL-SABOF           TO COVERA
  9750         MOVE SPACES             TO CRTSTATO
  9751         GO TO 1050-SHOW-CONTINUE.
  9752
  9753 1010-SHOW-CONTINUE.
  9754     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9755     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9756     MOVE +0                     TO CNTL-SEQ-NO.
  9757     MOVE 'CNTL'                 TO FILE-SWITCH.
  9758
  9759
  9760* EXEC CICS HANDLE CONDITION
  9761*        ENDFILE   (1050-SHOW-CONTINUE)
  9762*        NOTFND    (1050-SHOW-CONTINUE)
  9763*    END-EXEC.
  9764*    MOVE '"$''I                  ! . #00009191' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 184
* EL150.cbl
  9765     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9767     MOVE X'2E20233030303039313931' TO DFHEIV0(25:11)
  9768     CALL 'kxdfhei1' USING DFHEIV0
  9769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9770
  9771
  9772
  9773* EXEC CICS READ
  9774*        DATASET   ('ELCNTL')
  9775*        SET       (ADDRESS OF CONTROL-FILE)
  9776*        RIDFLD    (ELCNTL-KEY)
  9777*        GTEQ
  9778*    END-EXEC.
  9779     MOVE 'ELCNTL' TO DFHEIV1
  9780*    MOVE '&"S        G          (   #00009196' TO DFHEIV0
  9781     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9783     MOVE X'2020233030303039313936' TO DFHEIV0(25:11)
  9784     CALL 'kxdfhei1' USING DFHEIV0,
  9785           DFHEIV1,
  9786           DFHEIV20,
  9787           DFHEIV99,
  9788           ELCNTL-KEY,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV99
  9792     SET ADDRESS OF CONTROL-FILE TO
  9793         DFHEIV20
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9795
  9796
  9797     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID) OR
  9798        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9799           GO TO 1050-SHOW-CONTINUE.
  9800
  9801     PERFORM 1030-BENEFIT-DUMMY THRU 1030-EXIT
  9802         VARYING SUB-1 FROM 1 BY 1 UNTIL
  9803            ((SUB-1 > 8) OR
  9804            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  9805
  9806     IF SUB-1 NOT = 9
  9807         MOVE CF-BENEFIT-DESCRIP (SUB-1) TO COVERO
  9808         MOVE CF-JOINT-INDICATOR (SUB-1) TO PI-JOINT-COV-IND
  9809       ELSE
  9810         IF CRTSTATO = 'ACTIVE'
  9811             MOVE SPACES         TO  CRTSTATO.
  9812
  9813     GO TO 1050-SHOW-CONTINUE.
  9814
  9815 1030-BENEFIT-DUMMY.
  9816 1030-EXIT.
  9817     EXIT.
  9818
  9819 1050-SHOW-CONTINUE.
  9820
  9821     IF CL-PURGED-DT NOT = LOW-VALUES
  9822         MOVE 'Y'                        TO  PI-PURGED-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 185
* EL150.cbl
  9823         MOVE AL-SANOF                   TO  FILETOA    PRTOPTA
  9824                                             FORMATA    ALTPRTA
  9825                                             ACTCDA     ASSOCA
  9826                                             CLOANA
  9827         MOVE 'CLAIM IS PURGED - '       TO  WS-PURGED-MSG
  9828         MOVE CL-PURGED-DT               TO  DC-BIN-DATE-1
  9829         MOVE ' '                        TO  DC-OPTION-CODE
  9830         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9831         IF NO-CONVERSION-ERROR
  9832             MOVE DC-GREG-DATE-1-EDIT    TO  WS-PURGED-DATE
  9833             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
  9834         ELSE
  9835             MOVE SPACES                 TO  WS-PURGED-DATE
  9836             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
  9837     ELSE
  9838         MOVE 'N'                        TO  PI-PURGED-SW
  9839         PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
  9840
  9841     IF PI-COMPANY-ID = 'DMD'
  9842        MOVE COVERO                  TO  CRTSTATO
  9843        IF CL-LAST-PMT-AMT NOT = ZERO
  9844           MOVE CL-LAST-PMT-DT       TO  DC-BIN-DATE-1
  9845           MOVE ' '                  TO  DC-OPTION-CODE
  9846           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9847           MOVE DC-GREG-DATE-1-EDIT  TO  PRMTYPEO
  9848           MOVE CL-LAST-PMT-AMT      TO  WS-PMT-AMT
  9849           MOVE WS-PMT-AMTD          TO  COVERO
  9850         ELSE
  9851           MOVE SPACES               TO  COVERO
  9852                                         PRMTYPEO.
  9853
  9854     IF RETURNED-FROM NOT = SPACES
  9855         GO TO 8250-SEND-WITH-CURSOR.
  9856
  9857     IF CLAIM-IS-PURGED
  9858        CONTINUE
  9859*        MOVE -1                 TO  MCRFLML
  9860     ELSE
  9861         MOVE -1                 TO  FILETOL
  9862     END-IF
  9863
  9864     IF PI-COMPANY-ID = 'DMD'
  9865         IF CONFIDENTIAL-DATA
  9866             IF PI-CONFIDENTIAL-UP
  9867                 MOVE LOW-VALUE  TO PI-PRIORITY-IND
  9868                 MOVE ER-0932    TO EMI-ERROR
  9869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9870             ELSE
  9871                 MOVE 'C'        TO PI-PRIORITY-IND
  9872
  9873* EXEC CICS SEND TEXT
  9874*                    FROM     (W-CONF-TEXT)
  9875*                    LENGTH   (W-CONF-LENGTH)
  9876*                    ERASE
  9877*                    FREEKB
  9878*                END-EXEC
  9879*    MOVE '8&      T  E F  H   F -   #00009278' TO DFHEIV0
  9880     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 186
* EL150.cbl
  9881     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9882     MOVE X'2020233030303039323738' TO DFHEIV0(25:11)
  9883     CALL 'kxdfhei1' USING DFHEIV0,
  9884           W-CONF-TEXT,
  9885           W-CONF-LENGTH,
  9886           DFHEIV99,
  9887           DFHEIV99,
  9888           DFHEIV99,
  9889           DFHEIV99,
  9890           DFHEIV99,
  9891           DFHEIV99,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99,
  9895           DFHEIV99
  9896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9897                 GO TO 9100-RETURN-TRAN.
  9898
  9899     GO TO 8100-SEND-INITIAL-MAP.
  9900
  9901 1100-SHOW-RECORD-NOT-FOUND.
  9902
  9903     IF FILE-SWITCH = 'MSTR'
  9904         IF PI-CURRENT-FILE = 'ELRETR'
  9905             MOVE ER-0204        TO EMI-ERROR
  9906         ELSE
  9907             MOVE 'Y'            TO PI-RETRIEVED-DATA-IND
  9908             MOVE 'ELRETR'       TO PI-CURRENT-FILE
  9909             GO TO 1000-READ-CLAIM
  9910     ELSE
  9911         MOVE ER-0206            TO EMI-ERROR.
  9912
  9913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9914
  9915     IF FILE-SWITCH = 'CERT' AND PI-COMPANY-ID = 'CID'
  9916        GO TO 1050-SHOW-CONTINUE.
  9917
  9918     MOVE -1                     TO CLMNOL.
  9919
  9920     MOVE PI-CARRIER             TO CARRO.
  9921     MOVE PI-CLAIM-NO            TO CLMNOO.
  9922     MOVE PI-CERT-PRIME          TO CERTNOO.
  9923     MOVE PI-CERT-SFX            TO SUFXO.
  9924
  9925     MOVE AL-UABON               TO CLMNOA   CARRA
  9926                                    YESNOSWA
  9927                                    CERTNOA  SUFXA.
  9928
  9929     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 187
* EL150.cbl
  9931 1200-GET-ASS-TOTALS.
  9932
  9933     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
  9934
  9935     IF RETURNED-FROM NOT = 'EL156' AND 'EL1501' AND 'EL1502'
  9936         IF PI-ASS-PROCESSING
  9937                 AND
  9938            PI-ASS-CERTS (PI-ASS-NDX) = CL-CERT-NO
  9939                 AND
  9940            PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  9941             GO TO 1200-SET-UP-FIELDS.
  9942
  9943     MOVE CL-ASSOC-CERT-SEQU      TO PI-LAST-SEQ-NO.
  9944
  9945     IF EIBAID = DFHPF15 OR DFHPF16
  9946
  9947* EXEC CICS ENDBR
  9948*            DATASET   (PI-CURRENT-FILE)
  9949*        END-EXEC.
  9950     MOVE 0
  9951       TO DFHEIV11
  9952*    MOVE '&2                    $   #00009333' TO DFHEIV0
  9953     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9954     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303039333333' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           PI-CURRENT-FILE,
  9958           DFHEIV11,
  9959           DFHEIV99
  9960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9961
  9962
  9963     MOVE CLAIM-MASTER           TO W-CLAIM-MASTER-SAVE.
  9964     MOVE ZEROS                  TO PI-DAYS-PAID
  9965                                    PI-TOTAL-PAID.
  9966     MOVE LOW-VALUES             TO PI-ASSOCIATED-CERTS-TABLE
  9967                                    PI-LAST-PF-KEY-IND
  9968                                    PI-ASSOCIATED-PROCESS-IND
  9969     MOVE SPACES                 TO MSTR-CERT-NO.
  9970
  9971     IF RETURNED-FROM = 'EL156'
  9972             AND
  9973        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  9974         MOVE SPACES             TO RETURNED-FROM
  9975     ELSE
  9976         MOVE SPACES             TO RETURNED-FROM
  9977         MOVE CL-CONTROL-PRIMARY TO PI-ORIGINAL-ASS-CERT.
  9978
  9979
  9980* EXEC CICS HANDLE CONDITION
  9981*        NOTFND   (1220-NO-CLAIM-RECORD-FND)
  9982*        ENDFILE  (1200-ENDBR)
  9983*    END-EXEC.
  9984*    MOVE '"$I''                  ! / #00009353' TO DFHEIV0
  9985     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9987     MOVE X'2F20233030303039333533' TO DFHEIV0(25:11)
  9988     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 188
* EL150.cbl
  9989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9990
  9991
  9992
  9993* EXEC CICS STARTBR
  9994*         DATASET   (PI-CURRENT-FILE)
  9995*         RIDFLD    (ELMSTR-KEY)
  9996*    END-EXEC.
  9997     MOVE 0
  9998       TO DFHEIV11
  9999*    MOVE '&,         G          &   #00009358' TO DFHEIV0
 10000     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10002     MOVE X'2020233030303039333538' TO DFHEIV0(25:11)
 10003     CALL 'kxdfhei1' USING DFHEIV0,
 10004           PI-CURRENT-FILE,
 10005           ELMSTR-KEY,
 10006           DFHEIV99,
 10007           DFHEIV11,
 10008           DFHEIV99
 10009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10010
 10011
 10012 1200-GET-NEXT-RECORD.
 10013
 10014
 10015* EXEC CICS READNEXT
 10016*         DATASET   (PI-CURRENT-FILE)
 10017*         RIDFLD    (ELMSTR-KEY)
 10018*         INTO      (CLAIM-MASTER)
 10019*    END-EXEC.
 10020     MOVE LENGTH OF
 10021      CLAIM-MASTER
 10022       TO DFHEIV12
 10023     MOVE 0
 10024       TO DFHEIV11
 10025*    MOVE '&.IL                  )   #00009365' TO DFHEIV0
 10026     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10027     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10028     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
 10029     CALL 'kxdfhei1' USING DFHEIV0,
 10030           PI-CURRENT-FILE,
 10031           CLAIM-MASTER,
 10032           DFHEIV12,
 10033           ELMSTR-KEY,
 10034           DFHEIV99,
 10035           DFHEIV11,
 10036           DFHEIV99,
 10037           DFHEIV99
 10038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10039
 10040
 10041     IF PI-PREV-COMP-CD  NOT = CL-COMPANY-CD  OR
 10042        PI-PREV-CARRIER  NOT = CL-CARRIER     OR
 10043        PI-PREV-CLAIM-NO NOT = CL-CLAIM-NO
 10044         GO TO 1200-ENDBR.
 10045
 10046     IF CL-PRIME-CERT-NO NOT = PI-PREV-PRIME-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 189
* EL150.cbl
 10047         GO TO 1200-GET-NEXT-RECORD.
 10048
 10049     ADD CL-TOTAL-PAID-AMT       TO PI-TOTAL-PAID.
 10050     ADD CL-NO-OF-DAYS-PAID      TO PI-DAYS-PAID.
 10051
 10052     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
 10053     MOVE CL-CERT-NO             TO PI-ASS-CERTS (PI-ASS-NDX).
 10054
 10055     GO TO 1200-GET-NEXT-RECORD.
 10056
 10057 1200-ENDBR.
 10058
 10059
 10060* EXEC CICS ENDBR
 10061*        DATASET   (PI-CURRENT-FILE)
 10062*    END-EXEC.
 10063     MOVE 0
 10064       TO DFHEIV11
 10065*    MOVE '&2                    $   #00009389' TO DFHEIV0
 10066     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10067     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10068     MOVE X'2020233030303039333839' TO DFHEIV0(25:11)
 10069     CALL 'kxdfhei1' USING DFHEIV0,
 10070           PI-CURRENT-FILE,
 10071           DFHEIV11,
 10072           DFHEIV99
 10073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10074
 10075
 10076     MOVE W-CLAIM-MASTER-SAVE    TO CLAIM-MASTER.
 10077     MOVE PI-LAST-SEQ-NO         TO PI-ASS-NDX.
 10078
 10079 1200-SET-UP-FIELDS.
 10080
 10081     MOVE 'Y'                    TO PI-ASSOCIATED-PROCESS-IND.
 10082     MOVE PI-DAYS-PAID           TO W-DAYS-PAID-X.
 10083     MOVE PI-TOTAL-PAID          TO W-TOTAL-PAID-AMT-X.
 10084     MOVE W-TOTAL-PAID-AMT-X     TO AMTPDO.
 10085     MOVE W-DAYS-PAID-X          TO DAYSPDO.
 10086     MOVE 'CLAIM TOTALS...AMOUNT PD:'
 10087                                 TO CLMTOTHO.
 10088     MOVE 'DAYS PAID:'           TO DAYSPDHO.
 10089
 10090 1200-EXIT.
 10091     EXIT.
 10092
 10093 1220-NO-CLAIM-RECORD-FND.
 10094
 10095     MOVE ER-0204                TO EMI-ERROR.
 10096
 10097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10098
 10099     IF FILE-SWITCH = 'CERT' AND PI-COMPANY-ID = 'CID'
 10100         GO TO 1050-SHOW-CONTINUE.
 10101
 10102     MOVE -1                     TO CLMNOL.
 10103
 10104     MOVE PI-CARRIER             TO CARRO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 190
* EL150.cbl
 10105     MOVE PI-CLAIM-NO            TO CLMNOO.
 10106     MOVE PI-CERT-PRIME          TO CERTNOO.
 10107     MOVE PI-CERT-SFX            TO SUFXO.
 10108
 10109     MOVE AL-UABON               TO CLMNOA   CARRA
 10110                                    CERTNOA  SUFXA.
 10111
 10112     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 191
* EL150.cbl
 10114 1500-READ-CONVENIENCE-FILES.
 10115
 10116
 10117* EXEC CICS HANDLE CONDITION
 10118*        NOTFND   (1500-SHOW-RECORD-NOT-FOUND)
 10119*    END-EXEC.
 10120*    MOVE '"$I                   ! 0 #00009433' TO DFHEIV0
 10121     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10123     MOVE X'3020233030303039343333' TO DFHEIV0(25:11)
 10124     CALL 'kxdfhei1' USING DFHEIV0
 10125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10126
 10127
 10128     MOVE PI-COMPANY-CD              TO  PLCY-COMP-CD.
 10129     MOVE CL-CERT-CARRIER            TO  PLCY-CARRIER.
 10130     MOVE CL-CERT-GROUPING           TO  PLCY-GROUPING.
 10131     MOVE CL-CERT-STATE              TO  PLCY-STATE.
 10132     MOVE CL-CERT-ACCOUNT            TO  PLCY-PRODUCER.
 10133     MOVE CL-CERT-EFF-DT             TO  PLCY-EFF-DT.
 10134     MOVE CL-CV-REFERENCE-NO         TO  PLCY-REFERENCE-NO.
 10135     MOVE 'PLCY'                     TO  FILE-SWITCH.
 10136
 10137
 10138* EXEC CICS READ
 10139*        DATASET   ('MPPLCY')
 10140*        SET       (ADDRESS OF POLICY-MASTER)
 10141*        RIDFLD    (EMPLCY-KEY)
 10142*    END-EXEC.
 10143     MOVE 'MPPLCY' TO DFHEIV1
 10144*    MOVE '&"S        E          (   #00009446' TO DFHEIV0
 10145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039343436' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           DFHEIV1,
 10150           DFHEIV20,
 10151           DFHEIV99,
 10152           EMPLCY-KEY,
 10153           DFHEIV99,
 10154           DFHEIV99,
 10155           DFHEIV99
 10156     SET ADDRESS OF POLICY-MASTER TO
 10157         DFHEIV20
 10158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10159
 10160
 10161     MOVE 'Y'                        TO  WS-CERT-READ-SW.
 10162
 10163     PERFORM 1700-READ-EMPHST THRU 1700-EXIT.
 10164
 10165 1500-READ-EMPLAN.
 10166
 10167     MOVE PM-COMPANY-CD              TO  PLAN-COMP-CD.
 10168     MOVE PM-CARRIER                 TO  PLAN-CARRIER.
 10169     MOVE PM-GROUPING                TO  PLAN-GROUPING.
 10170     MOVE PM-STATE                   TO  PLAN-STATE.
 10171     MOVE PM-PRODUCER                TO  PLAN-PRODUCER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 192
* EL150.cbl
 10172     MOVE PM-INS-PLAN-CD             TO  PLAN-PLAN-CODE.
 10173     MOVE PM-INS-PLAN-REVISION       TO  PLAN-REV-NO.
 10174     MOVE 'PLAN'                     TO  FILE-SWITCH.
 10175
 10176
 10177* EXEC CICS HANDLE CONDITION
 10178*        NOTFND   (1500-NO-PLAN-RECORD)
 10179*    END-EXEC.
 10180*    MOVE '"$I                   ! 1 #00009467' TO DFHEIV0
 10181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10183     MOVE X'3120233030303039343637' TO DFHEIV0(25:11)
 10184     CALL 'kxdfhei1' USING DFHEIV0
 10185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10186
 10187
 10188
 10189* EXEC CICS READ
 10190*        DATASET   ('MPPLAN')
 10191*        RIDFLD    (EMPLAN-KEY)
 10192*        SET       (ADDRESS OF PRODUCER-PLANS)
 10193*    END-EXEC.
 10194     MOVE 'MPPLAN' TO DFHEIV1
 10195*    MOVE '&"S        E          (   #00009471' TO DFHEIV0
 10196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10198     MOVE X'2020233030303039343731' TO DFHEIV0(25:11)
 10199     CALL 'kxdfhei1' USING DFHEIV0,
 10200           DFHEIV1,
 10201           DFHEIV20,
 10202           DFHEIV99,
 10203           EMPLAN-KEY,
 10204           DFHEIV99,
 10205           DFHEIV99,
 10206           DFHEIV99
 10207     SET ADDRESS OF PRODUCER-PLANS TO
 10208         DFHEIV20
 10209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10210
 10211
 10212     MOVE PP-PLAN-ABBREV             TO  COVERO.
 10213     MOVE PP-REFUND-CALC             TO  CP-EARNING-METHOD
 10214                                         CP-RATING-METHOD.
 10215     IF PP-BENEFIT-IS-LEVEL
 10216         MOVE 'L'                    TO  CP-BENEFIT-TYPE
 10217     ELSE
 10218         MOVE 'R'                    TO  CP-BENEFIT-TYPE.
 10219
 10220     MOVE PM-LOAN-TERM               TO  CP-ORIGINAL-TERM
 10221                                         CP-LOAN-TERM.
 10222     MOVE SAVE-BIN-DATE              TO  CP-VALUATION-DT.
 10223     MOVE PM-POLICY-EFF-DT           TO  CP-CERT-EFF-DT.
 10224     MOVE PM-STATE                   TO  CP-STATE.
 10225     MOVE 'A'                        TO  CP-SPECIAL-CALC-CD.
 10226     MOVE '2'                        TO  CP-PROCESS-TYPE.
 10227     MOVE PI-COMPANY-ID              TO  CP-COMPANY-ID.
 10228     MOVE PI-COMPANY-CD              TO  CP-COMPANY-CD.
 10229     MOVE '1'                        TO  CP-REM-TRM-CALC-OPTION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 193
* EL150.cbl
 10230
 10231     IF PM-AH-MORT-PLAN
 10232         MOVE '3'                    TO  CP-REM-TERM-METHOD
 10233         MOVE PM-LOAN-DT             TO  CP-FIRST-PAY-DATE
 10234     ELSE
 10235         MOVE '2'                    TO  CP-REM-TERM-METHOD
 10236         MOVE PM-POLICY-EFF-DT       TO  CP-FIRST-PAY-DATE.
 10237
 10238     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
 10239     PERFORM 9800-LINK-REM-TERM.
 10240
 10241     IF PM-AH-MORT-PLAN
 10242       MOVE CP-REMAINING-TERM-1    TO  WST-REM
 10243     ELSE
 10244       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10245         COMPUTE CP-REMAINING-TERM-3 = CP-REMAINING-TERM-3 + 1
 10246         MOVE CP-REMAINING-TERM-3    TO  WST-REM
 10247       ELSE
 10248         MOVE CP-REMAINING-TERM-3    TO  WST-REM.
 10249
 10250     GO TO 1500-SHOW-CONTINUE.
 10251
 10252 1500-NO-PLAN-RECORD.
 10253
 10254     MOVE ZEROS                      TO  WST-REM.
 10255     MOVE '** NONE **'               TO  COVERO.
 10256
 10257 1500-SHOW-CONTINUE.
 10258
 10259     MOVE PM-LOAN-TERM               TO  WST-ORIG.
 10260     MOVE WS-TERMS                   TO  TERMSO.
 10261
 10262     IF PM-AH-MORT-PLAN
 10263         MOVE 'MO. BENEFIT :'        TO  BENECAPO
 10264         MOVE PM-INS-MONTH-BENEFIT   TO  BENEO
 10265     ELSE
 10266         MOVE PM-INS-TOTAL-BENEFIT   TO  BENEO.
 10267
 10268     IF PM-ANNUAL
 10269         MOVE 'ANNUAL'              TO  PRMTYPEO
 10270       ELSE
 10271     IF PM-SEMI-ANNUAL
 10272         MOVE 'SEMI ANL'            TO  PRMTYPEO
 10273       ELSE
 10274     IF PM-QUARTERLY
 10275         MOVE 'QTRLY'               TO  PRMTYPEO
 10276       ELSE
 10277     IF PM-BI-MONTHLY
 10278         MOVE 'BI MONTH'            TO  PRMTYPEO
 10279       ELSE
 10280     IF PM-SINGLE-PREM
 10281         MOVE 'SING PRM'            TO  PRMTYPEO.
 10282
 10283     MOVE PM-POLICY-EFF-DT           TO  DC-BIN-DATE-1.
 10284     MOVE '6'                        TO  DC-OPTION-CODE.
 10285     MOVE PM-LOAN-TERM               TO  DC-ELAPSED-MONTHS.
 10286     MOVE +0                         TO  DC-ELAPSED-DAYS.
 10287     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 194
* EL150.cbl
 10288     IF NO-CONVERSION-ERROR
 10289         MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10290     ELSE
 10291         MOVE SPACES                 TO  EXPIREO.
 10292
 10293     IF PM-CURRENT-STATUS = '0'
 10294         MOVE 'LAPSED'               TO  CRTSTATO.
 10295     IF PM-CURRENT-STATUS = '1'
 10296         MOVE 'ACTIVE'               TO  CRTSTATO.
 10297     IF PM-CURRENT-STATUS = '2'
 10298         MOVE 'PENDING'              TO  CRTSTATO.
 10299     IF PM-CURRENT-STATUS = '3'
 10300         MOVE 'DECLINE'              TO  CRTSTATO.
 10301     IF PM-CURRENT-STATUS = '4' OR '9'
 10302         MOVE 'PND CANC'             TO  CRTSTATO.
 10303     IF PM-CURRENT-STATUS = '5'
 10304         MOVE 'PND ISS'              TO  CRTSTATO.
 10305     IF PM-CURRENT-STATUS = '6'
 10306         MOVE 'CLAIM'                TO  CRTSTATO.
 10307     IF PM-CURRENT-STATUS = '7'
 10308         MOVE 'CANCEL'               TO  CRTSTATO.
 10309     IF PM-CURRENT-STATUS = '8'
 10310         MOVE 'PND UNDW'             TO  CRTSTATO.
 10311     IF PM-CURRENT-STATUS = 'C'
 10312         MOVE 'TRANSFER'             TO  CRTSTATO.
 10313     IF PM-CURRENT-STATUS = 'F'
 10314         MOVE 'SETTLE'               TO  CRTSTATO.
 10315     IF PM-CURRENT-STATUS = 'T'
 10316         MOVE 'TRMNAT'               TO  CRTSTATO.
 10317
 10318     GO TO 1500-EXIT.
 10319
 10320 1500-SHOW-RECORD-NOT-FOUND.
 10321
 10322     IF FILE-SWITCH = 'PLCY'
 10323         MOVE ER-9483            TO  EMI-ERROR.
 10324
 10325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10326     MOVE -1                     TO  CLMNOL.
 10327     MOVE PI-CARRIER             TO  CARRO.
 10328     MOVE PI-CLAIM-NO            TO  CLMNOL.
 10329     MOVE PI-CERT-PRIME          TO  CERTNOO.
 10330     MOVE PI-CERT-SFX            TO  SUFXO.
 10331
 10332     MOVE AL-UABON               TO  CLMNOA    CARRA
 10333                                     CERTNOA   SUFXA.
 10334     GO TO 8100-SEND-INITIAL-MAP.
 10335
 10336 1500-EXIT.
 10337     EXIT.
 10338
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 195
* EL150.cbl
 10340 1600-ROLL-TRAILERS.
 10341     MOVE SPACES                 TO MAP-DISPLAY (1)
 10342                                    MAP-DISPLAY (2)
 10343                                    MAP-DISPLAY (3)
 10344                                    MAP-DISPLAY (4).
 10345
 10346     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
 10347
 10348     MOVE -1                     TO FILETOL.
 10349     GO TO 8200-SEND-DATAONLY.
 10350
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 196
* EL150.cbl
 10352***************************************************************
 10353*    I/O REQUESTS AGAINST THE CONVENIENCE POLICY HISTORY FILE *
 10354***************************************************************
 10355 1700-READ-EMPHST.
 10356
 10357
 10358* EXEC CICS HANDLE CONDITION
 10359*        ENDFILE  (1700-ENDBROWSE)
 10360*        NOTFND   (1700-ENDBROWSE)
 10361*    END-EXEC.
 10362*    MOVE '"$''I                  ! 2 #00009622' TO DFHEIV0
 10363     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10365     MOVE X'3220233030303039363232' TO DFHEIV0(25:11)
 10366     CALL 'kxdfhei1' USING DFHEIV0
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370     MOVE PM-COMPANY-CD          TO  EMPHST-COMPANY-CD.
 10371     MOVE PM-CARRIER             TO  EMPHST-CARRIER.
 10372     MOVE PM-GROUPING            TO  EMPHST-GROUPING.
 10373     MOVE PM-STATE               TO  EMPHST-STATE.
 10374     MOVE PM-PRODUCER            TO  EMPHST-PRODUCER.
 10375     MOVE PM-POLICY-EFF-DT       TO  EMPHST-POLICY-EFF-DT.
 10376     MOVE PM-REFERENCE-NUMBER    TO  EMPHST-REFERENCE-NUMBER.
 10377     MOVE ZEROS                  TO  EMPHST-SEQUENCE-NO.
 10378
 10379     IF PM-LIFE-MORT-PLAN
 10380         MOVE '02'                   TO  EMPHST-RECORD-TYPE
 10381         MOVE '21'                   TO  EMPHST-FIELD-TYPE
 10382     ELSE
 10383         MOVE '04'                   TO  EMPHST-RECORD-TYPE
 10384         MOVE '07'                   TO  EMPHST-FIELD-TYPE.
 10385
 10386
 10387* EXEC CICS STARTBR
 10388*        DATASET   (EMPHST-FILE-ID)
 10389*        RIDFLD    (EMPHST-KEY)
 10390*        GTEQ
 10391*    END-EXEC.
 10392     MOVE 0
 10393       TO DFHEIV11
 10394*    MOVE '&,         G          &   #00009643' TO DFHEIV0
 10395     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10397     MOVE X'2020233030303039363433' TO DFHEIV0(25:11)
 10398     CALL 'kxdfhei1' USING DFHEIV0,
 10399           EMPHST-FILE-ID,
 10400           EMPHST-KEY,
 10401           DFHEIV99,
 10402           DFHEIV11,
 10403           DFHEIV99
 10404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10405
 10406
 10407     MOVE 'Y'                    TO  WS-BROWSE-START-SW.
 10408
 10409 1700-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 197
* EL150.cbl
 10410
 10411
 10412* EXEC CICS READNEXT
 10413*        DATASET   (EMPHST-FILE-ID)
 10414*        SET       (ADDRESS OF POLICY-HISTORY)
 10415*        RIDFLD    (EMPHST-KEY)
 10416*    END-EXEC.
 10417     MOVE 0
 10418       TO DFHEIV11
 10419*    MOVE '&.S                   )   #00009653' TO DFHEIV0
 10420     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10421     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10422     MOVE X'2020233030303039363533' TO DFHEIV0(25:11)
 10423     CALL 'kxdfhei1' USING DFHEIV0,
 10424           EMPHST-FILE-ID,
 10425           DFHEIV20,
 10426           DFHEIV99,
 10427           EMPHST-KEY,
 10428           DFHEIV99,
 10429           DFHEIV11,
 10430           DFHEIV99,
 10431           DFHEIV99
 10432     SET ADDRESS OF POLICY-HISTORY TO
 10433         DFHEIV20
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437     IF PM-COMPANY-CD       = PH-COMPANY-CD         AND
 10438        PM-CARRIER          = PH-CARRIER            AND
 10439        PM-GROUPING         = EMPHST-GROUPING       AND
 10440        PM-STATE            = EMPHST-STATE          AND
 10441        PM-PRODUCER         = EMPHST-PRODUCER       AND
 10442        PM-POLICY-EFF-DT    = EMPHST-POLICY-EFF-DT  AND
 10443        PM-REFERENCE-NUMBER = EMPHST-REFERENCE-NUMBER
 10444         NEXT SENTENCE
 10445     ELSE
 10446         GO TO 1700-ENDBROWSE.
 10447
 10448     IF PM-LIFE-MORT-PLAN
 10449         IF PH-RECORD-TYPE = '02' AND
 10450            PH-FIELD-TYPE  = '21'
 10451             NEXT SENTENCE
 10452         ELSE
 10453             GO TO 1700-ENDBROWSE.
 10454
 10455     IF NOT PM-LIFE-MORT-PLAN
 10456         IF PH-RECORD-TYPE = '04' AND
 10457            PH-FIELD-TYPE  = '07'
 10458             NEXT SENTENCE
 10459         ELSE
 10460             GO TO 1700-ENDBROWSE.
 10461
 10462     IF PH-CHANGE-DT > CL-INCURRED-DT
 10463         GO TO 1700-READ-NEXT.
 10464
 10465     MOVE PH-RECORD-BODY         TO  WS-HISTORY-AREA.
 10466
 10467
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 198
* EL150.cbl
 10468* EXEC CICS BIF
 10469*        DEEDIT
 10470*        FIELD (WS-HISTORY-AREA)
 10471*        LENGTH ('50')
 10472*    END-EXEC.
 10473     MOVE '50'
 10474       TO DFHEIV11
 10475*    MOVE '@"L                   #   #00009689' TO DFHEIV0
 10476     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10477     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10478     MOVE X'2020233030303039363839' TO DFHEIV0(25:11)
 10479     CALL 'kxdfhei1' USING DFHEIV0,
 10480           WS-HISTORY-AREA,
 10481           DFHEIV11
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485     IF PM-LIFE-MORT-PLAN
 10486         MOVE WS-NUMERIC-FLD1    TO  PM-INSURED-TOT-BENEFIT
 10487     ELSE
 10488         MOVE WS-NUMERIC-FLD1    TO  PM-INS-MONTH-BENEFIT.
 10489
 10490 1700-ENDBROWSE.
 10491
 10492
 10493* EXEC CICS ENDBR
 10494*        DATASET   (EMPHST-FILE-ID)
 10495*    END-EXEC.
 10496     MOVE 0
 10497       TO DFHEIV11
 10498*    MOVE '&2                    $   #00009702' TO DFHEIV0
 10499     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10500     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10501     MOVE X'2020233030303039373032' TO DFHEIV0(25:11)
 10502     CALL 'kxdfhei1' USING DFHEIV0,
 10503           EMPHST-FILE-ID,
 10504           DFHEIV11,
 10505           DFHEIV99
 10506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10507
 10508
 10509 1700-EXIT.
 10510      EXIT.
 10511
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 199
* EL150.cbl
 10513 2000-BUILD-TRAILER-DISPLAY.
 10514
 10515     IF DIRECTION-SWITCH = 'F'
 10516        IF PI-PREV-DIR = 'B' AND PI-PREV-DISP = 'N'
 10517           MOVE PI-SAVE-LOW    TO TRLR-SEQ-NO
 10518        ELSE
 10519           MOVE PI-SAVE-HIGH   TO TRLR-SEQ-NO
 10520           ADD +1              TO TRLR-SEQ-NO
 10521     ELSE
 10522        IF DIRECTION-SWITCH = 'B'
 10523           IF PI-PREV-DIR = 'F' AND PI-PREV-DISP = 'N'
 10524              MOVE PI-SAVE-HIGH TO TRLR-SEQ-NO
 10525           ELSE
 10526              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 10527        ELSE
 10528           IF DIRECTION-SWITCH = 'R'
 10529              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 10530              MOVE 'F'        TO DIRECTION-SWITCH
 10531           ELSE
 10532              IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10533                  MOVE +95     TO  TRLR-SEQ-NO
 10534                  MOVE +0      TO  PI-SAVE-LOW
 10535                                   PI-SAVE-HIGH
 10536                  MOVE 'N'     TO  PI-PREV-DISP
 10537                  MOVE 'F'     TO  DIRECTION-SWITCH
 10538              ELSE
 10539                  MOVE +93     TO  TRLR-SEQ-NO
 10540                  MOVE +0      TO  PI-SAVE-LOW
 10541                                   PI-SAVE-HIGH
 10542                  MOVE 'N'     TO  PI-PREV-DISP
 10543                  MOVE 'F'     TO  DIRECTION-SWITCH.
 10544
 10545     IF DIRECTION-SWITCH = 'F'
 10546         MOVE +1                 TO DISPLAY-CNT
 10547     ELSE
 10548         MOVE +4                 TO DISPLAY-CNT.
 10549
 10550     MOVE PI-COMPANY-CD          TO TRLR-COMP-CD.
 10551     MOVE PI-CARRIER             TO TRLR-CARRIER.
 10552     MOVE PI-CLAIM-NO            TO TRLR-CLAIM-NO.
 10553     MOVE PI-CERT-NO             TO TRLR-CERT-NO.
 10554     MOVE 'TRLR'                 TO FILE-SWITCH.
 10555
 10556     IF PI-SAVE-SYS-ID = 'CV'
 10557         NEXT SENTENCE
 10558     ELSE
 10559         GO TO 2005-BUILD-CR-LOAN-DATA.
 10560
 10561     IF WS-CERT-READ-SW = 'Y'
 10562       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10563         IF CL-SYSTEM-IDENTIFIER = 'CV'
 10564           MOVE PM-INS-TERMINATION-DT    TO  DC-BIN-DATE-1
 10565           MOVE ' '                      TO  DC-OPTION-CODE
 10566           MOVE +0                       TO  DC-ELAPSED-MONTHS
 10567                                             DC-ELAPSED-DAYS
 10568           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10569           IF NO-CONVERSION-ERROR
 10570               MOVE DC-GREG-DATE-1-EDIT  TO  WS-LOAN-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 200
* EL150.cbl
 10571           ELSE
 10572               MOVE SPACES               TO  WS-LOAN-EXPIRE-DT.
 10573
 10574     IF WS-CERT-READ-SW = 'Y'
 10575       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10576         MOVE SPACES                 TO  TRAILER-DISPLAY-WORK-AREA
 10577         MOVE 'LOAN INFO'            TO  DISPLAY-ACTION
 10578         MOVE ZEROS                  TO  DISPLAY-SEQ
 10579         MOVE WS-LOAN-EXPIRE-DT      TO  DISPLAY-DATE
 10580         MOVE PM-LOAN-NUMBER         TO  ASSOC-CV-LOAN
 10581         MOVE ASSOC-CV-LOAN-TEXT     TO  DISPLAY-TEXT
 10582         MOVE TRAILER-DISPLAY-WORK-AREA
 10583                                     TO  MAP-DISPLAY (DISPLAY-CNT)
 10584         ADD +1                      TO  DISPLAY-CNT.
 10585
 10586     GO TO 2010-CONTINUE-TRAILER-DISPLAY.
 10587
 10588 2005-BUILD-CR-LOAN-DATA.
 10589
 10590     IF WS-CERT-READ-SW = 'Y'
 10591        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10592          IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10593            MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10594            MOVE ' '                     TO  DC-OPTION-CODE
 10595            MOVE +0                      TO  DC-ELAPSED-MONTHS
 10596                                             DC-ELAPSED-DAYS
 10597            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10598            IF NO-CONVERSION-ERROR
 10599              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 10600            ELSE
 10601              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT
 10602          ELSE
 10603            MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10604            MOVE ' '                     TO  DC-OPTION-CODE
 10605            MOVE +0                      TO  DC-ELAPSED-MONTHS
 10606                                             DC-ELAPSED-DAYS
 10607            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10608            IF NO-CONVERSION-ERROR
 10609              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 10610            ELSE
 10611              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT.
 10612
 10613     IF WS-CERT-READ-SW = 'Y'
 10614       IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10615         MOVE SPACES             TO  TRAILER-DISPLAY-WORK-AREA
 10616         MOVE ZEROS              TO  DISPLAY-SEQ
 10617         MOVE 'LOAN DATA'        TO  DISPLAY-ACTION
 10618         MOVE WS-LOAN-EXPIRE-DT  TO  DISPLAY-DATE
 10619         MOVE CM-LOAN-NUMBER     TO  ASSOC-ORIG-LOAN
 10620         MOVE CM-MEMBER-NO       TO  ASSOC-CUR-LOAN
 10621         MOVE CL-LOAN-TYPE       TO  ASSOC-LOAN-TYPE
 10622         MOVE ASSOC-LOAN-TEXT    TO  DISPLAY-TEXT
 10623         MOVE TRAILER-DISPLAY-WORK-AREA
 10624                                 TO  MAP-DISPLAY (DISPLAY-CNT)
 10625         ADD +1                  TO  DISPLAY-CNT
 10626       ELSE
 10627         IF CM-OPEN-END
 10628           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 201
* EL150.cbl
 10629           MOVE 'LOAN INFO'      TO DISPLAY-ACTION
 10630           MOVE CM-LOAN-NUMBER   TO LOAN-NUMBER
 10631           MOVE CM-LOAN-BALANCE  TO LOAN-BALANCE
 10632           MOVE CM-MEMBER-NO     TO LOAN-MEMBER
 10633           MOVE LOAN-TEXT        TO DISPLAY-TEXT
 10634           MOVE TRAILER-DISPLAY-WORK-AREA
 10635                                 TO MAP-DISPLAY (DISPLAY-CNT)
 10636           ADD +1                TO DISPLAY-CNT.
 10637
 10638     IF PI-COMPANY-ID = 'CID' OR 'DCC'
 10639        PERFORM 6150-READ-TRLR92 THRU 6150-EXIT
 10640        if ws-resp-normal
 10641           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 10642           MOVE 'SPECIAL REVIEW' TO DISPLAY-ACTION
 10643           move at-recorded-by   to display-by
 10644           move at-recorded-dt   to dc-bin-date-1
 10645           MOVE ' '              TO DC-OPTION-CODE
 10646           PERFORM 9700-LINK-DATE-CONVERT
 10647                                 THRU 9700-EXIT
 10648           MOVE DC-GREG-DATE-1-EDIT
 10649                                 TO DISPLAY-DATE
 10650           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 10651           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 10652           MOVE TRAILER-DISPLAY-WORK-AREA
 10653                                 TO MAP-DISPLAY (1)
 10654           if direction-switch = 'F'
 10655              ADD +1             TO  DISPLAY-CNT
 10656           end-if
 10657        end-if
 10658     end-if
 10659     .
 10660 2010-CONTINUE-TRAILER-DISPLAY.
 10661
 10662
 10663* EXEC CICS HANDLE CONDITION
 10664*        ENDFILE   (2950-NO-MORE-TRAILERS)
 10665*        NOTFND    (2950-NO-MORE-TRAILERS)
 10666*    END-EXEC.
 10667*    MOVE '"$''I                  ! 3 #00009859' TO DFHEIV0
 10668     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10670     MOVE X'3320233030303039383539' TO DFHEIV0(25:11)
 10671     CALL 'kxdfhei1' USING DFHEIV0
 10672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10673
 10674
 10675
 10676* EXEC CICS STARTBR
 10677*        DATASET   ('ELTRLR')
 10678*        GTEQ
 10679*        RIDFLD    (ELTRLR-KEY)
 10680*    END-EXEC.
 10681     MOVE 'ELTRLR' TO DFHEIV1
 10682     MOVE 0
 10683       TO DFHEIV11
 10684*    MOVE '&,         G          &   #00009864' TO DFHEIV0
 10685     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10686     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 202
* EL150.cbl
 10687     MOVE X'2020233030303039383634' TO DFHEIV0(25:11)
 10688     CALL 'kxdfhei1' USING DFHEIV0,
 10689           DFHEIV1,
 10690           ELTRLR-KEY,
 10691           DFHEIV99,
 10692           DFHEIV11,
 10693           DFHEIV99
 10694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10695
 10696
 10697     IF DIRECTION-SWITCH = 'B'
 10698         IF (PI-PREV-DISP = 'Y') OR (PI-PREV-DIR = 'B')
 10699
 10700* EXEC CICS READPREV
 10701*                DATASET ('ELTRLR')
 10702*                RIDFLD  (ELTRLR-KEY)
 10703*                SET     (ADDRESS OF ACTIVITY-TRAILERS)
 10704*            END-EXEC.
 10705     MOVE 'ELTRLR' TO DFHEIV1
 10706     MOVE 0
 10707       TO DFHEIV11
 10708*    MOVE '&0S                   )   #00009872' TO DFHEIV0
 10709     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 10710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10711     MOVE X'2020233030303039383732' TO DFHEIV0(25:11)
 10712     CALL 'kxdfhei1' USING DFHEIV0,
 10713           DFHEIV1,
 10714           DFHEIV20,
 10715           DFHEIV99,
 10716           ELTRLR-KEY,
 10717           DFHEIV99,
 10718           DFHEIV11,
 10719           DFHEIV99,
 10720           DFHEIV99
 10721     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10722         DFHEIV20
 10723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10724
 10725
 10726     MOVE 'N'                    TO PI-PREV-DISP.
 10727
 10728     MOVE DIRECTION-SWITCH       TO PI-PREV-DIR.
 10729
 10730 2020-READ-TRAILER-LOOP.
 10731     IF DIRECTION-SWITCH = 'F'
 10732
 10733* EXEC CICS READNEXT
 10734*            DATASET   ('ELTRLR')
 10735*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10736*            RIDFLD    (ELTRLR-KEY)
 10737*        END-EXEC
 10738     MOVE 'ELTRLR' TO DFHEIV1
 10739     MOVE 0
 10740       TO DFHEIV11
 10741*    MOVE '&.S                   )   #00009884' TO DFHEIV0
 10742     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10743     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10744     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 203
* EL150.cbl
 10745     CALL 'kxdfhei1' USING DFHEIV0,
 10746           DFHEIV1,
 10747           DFHEIV20,
 10748           DFHEIV99,
 10749           ELTRLR-KEY,
 10750           DFHEIV99,
 10751           DFHEIV11,
 10752           DFHEIV99,
 10753           DFHEIV99
 10754     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10755         DFHEIV20
 10756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10757     ELSE
 10758
 10759* EXEC CICS READPREV
 10760*            DATASET   ('ELTRLR')
 10761*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10762*            RIDFLD    (ELTRLR-KEY)
 10763*        END-EXEC.
 10764     MOVE 'ELTRLR' TO DFHEIV1
 10765     MOVE 0
 10766       TO DFHEIV11
 10767*    MOVE '&0S                   )   #00009890' TO DFHEIV0
 10768     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 10769     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10770     MOVE X'2020233030303039383930' TO DFHEIV0(25:11)
 10771     CALL 'kxdfhei1' USING DFHEIV0,
 10772           DFHEIV1,
 10773           DFHEIV20,
 10774           DFHEIV99,
 10775           ELTRLR-KEY,
 10776           DFHEIV99,
 10777           DFHEIV11,
 10778           DFHEIV99,
 10779           DFHEIV99
 10780     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10781         DFHEIV20
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10783
 10784
 10785     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
 10786        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
 10787        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
 10788        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 10789            GO TO 2950-NO-MORE-TRAILERS.
 10790
 10791*    IF TRLR-SEQ-NO = 90
 10792     IF TRLR-SEQ-NO = 90 or 91 or 92
 10793         GO TO 2020-READ-TRAILER-LOOP.
 10794
 10795     IF PI-COMPANY-ID = 'LAP'
 10796         IF TRLR-SEQ-NO > +100 AND < +301
 10797             GO TO 2020-READ-TRAILER-LOOP.
 10798
 10799     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
 10800         GO TO 2020-READ-TRAILER-LOOP.
 10801
 10802     IF PAYMENT-TR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 204
* EL150.cbl
 10803         GO TO 2100-PAYMENT-TRAILER.
 10804
 10805     IF AUTO-PAY-TR
 10806        GO TO 2200-AUTO-PAYMENT-TRAILER.
 10807
 10808     IF CORRESPONDENCE-TR
 10809         GO TO 2300-CORRESPONDENCE-TRAILER.
 10810
 10811     IF GENERAL-INFO-TR
 10812         GO TO 2400-GENERAL-INFO-TRAILER.
 10813
 10814     IF AUTO-PROMPT-TR
 10815         GO TO 2500-AUTO-PROMPT-TRAILER.
 10816
 10817     IF DENIAL-TR
 10818         GO TO 2600-DENIAL-TRAILER.
 10819
 10820     IF INCURRED-CHG-TR
 10821         GO TO 2700-INCURRED-CHANGE-TRAILER.
 10822
 10823     IF FORM-CONTROL-TR
 10824         GO TO 2710-FORM-CONTROL-TRAILER.
 10825
 10826     GO TO 2020-READ-TRAILER-LOOP.
 10827
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 205
* EL150.cbl
 10829 2100-PAYMENT-TRAILER.
 10830
 10831     IF AT-PAYMENT-NOTE
 10832         GO TO 2020-READ-TRAILER-LOOP.
 10833
 10834     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 10835
 10836     IF AT-PAYMENT-TYPE = 'T'
 10837         MOVE 'TRANSFER PMT'     TO DISPLAY-ACTION
 10838         GO TO 2100-CONT.
 10839
 10840     IF PI-SAVE-SYS-ID = 'CV'
 10841         IF AT-CLAIM-TYPE = 'L'
 10842             MOVE AT-CV-PMT-CODE             TO  WS-SUB
 10843             IF WS-SUB < 1 OR > 8
 10844                 MOVE 1                      TO  WS-SUB
 10845                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION
 10846             ELSE
 10847                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION.
 10848
 10849     IF AT-PAYMENT-TYPE = 'I'
 10850        MOVE 'INTEREST PMT'      TO DISPLAY-ACTION
 10851     ELSE
 10852     IF (PI-SAVE-SYS-ID = 'CV' AND AT-CLAIM-TYPE = 'A')
 10853                  OR
 10854         PI-SAVE-SYS-ID NOT = 'CV'
 10855         MOVE AT-PAYMENT-TYPE           TO  WS-SUB
 10856         IF WS-SUB < 1 OR > 6
 10857             MOVE 2                     TO  WS-SUB
 10858             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION
 10859         ELSE
 10860             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION.
 10861
 10862 2100-CONT.
 10863
 10864     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 10865     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 10866     MOVE ' '                    TO DC-OPTION-CODE.
 10867     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10868     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 10869     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 10870
 10871     IF AT-VOID-DT NOT = LOW-VALUES
 10872        MOVE AT-VOID-DT         TO DC-BIN-DATE-1
 10873        MOVE ' '                TO DC-OPTION-CODE
 10874        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10875        MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10876        IF AT-VOID-TYPE = 'S'
 10877            MOVE 'STOP DT='     TO PMT-VAR
 10878        ELSE
 10879            MOVE 'VOIDED ='     TO PMT-VAR
 10880     ELSE
 10881        IF AT-PAID-THRU-DT NOT = LOW-VALUES
 10882           MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 10883           MOVE ' '             TO DC-OPTION-CODE
 10884           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10885           MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10886           MOVE 'PD THRU='     TO PMT-VAR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 206
* EL150.cbl
 10887           IF PI-USES-PAID-TO
 10888              MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 10889              MOVE '6'             TO DC-OPTION-CODE
 10890              MOVE +1              TO DC-ELAPSED-DAYS
 10891              MOVE +0              TO DC-ELAPSED-MONTHS
 10892              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10893              MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10894              MOVE 'PAID TO='      TO PMT-VAR
 10895           ELSE
 10896              NEXT SENTENCE
 10897        ELSE
 10898           IF CHARGEABLE-EXPENSE OR NON-CHARGEABLE-EXPENSE
 10899              MOVE 'EXP TYP='       TO PMT-VAR
 10900              MOVE AT-EXPENSE-TYPE  TO PMT-PD-THRU
 10901           ELSE
 10902              MOVE SPACES      TO PMT-VAR  PMT-PD-THRU.
 10903
 10904     MOVE AT-CHECK-NO               TO PMT-CHECK-NO.
 10905     MOVE AT-AMOUNT-PAID            TO PMT-AMOUNT.
 10906     MOVE PAYMENT-TEXT              TO DISPLAY-TEXT.
 10907     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 10908
 10909     GO TO 2800-INCR-DISPLAY-CNT.
 10910
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 207
* EL150.cbl
 10912 2200-AUTO-PAYMENT-TRAILER.
 10913     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 10914     MOVE 'AUTO PMT SETUP'       TO DISPLAY-ACTION.
 10915     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 10916
 10917     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 10918     MOVE ' '                    TO DC-OPTION-CODE.
 10919     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10920     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 10921
 10922     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 10923
 10924     IF PI-COMPANY-ID = 'DMD'
 10925        IF AT-TERMINATED-DT NOT = SPACES AND ZEROS
 10926                                         AND LOW-VALUES
 10927           MOVE AT-TERMINATED-DT          TO DC-BIN-DATE-1
 10928           MOVE ' '                       TO DC-OPTION-CODE
 10929           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10930           MOVE DC-GREG-DATE-1-EDIT       TO AUTO-TERMINATED
 10931           MOVE AT-REGULAR-PMT-AMT        TO AUTO-TERM-AMT
 10932           MOVE AUTO-TERM-TEXT            TO DISPLAY-TEXT
 10933           MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY
 10934                                            (DISPLAY-CNT)
 10935           GO TO 2800-INCR-DISPLAY-CNT.
 10936
 10937     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
 10938     MOVE ' '                    TO DC-OPTION-CODE.
 10939     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10940     MOVE DC-GREG-DATE-1-EDIT    TO AUTO-START.
 10941
 10942     IF PI-USES-PAID-TO
 10943         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 10944         MOVE '6'                       TO  DC-OPTION-CODE
 10945         MOVE +1                        TO  DC-ELAPSED-DAYS
 10946         MOVE +0                        TO  DC-ELAPSED-MONTHS
 10947         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10948         IF NO-CONVERSION-ERROR
 10949             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 10950         ELSE
 10951             MOVE SPACES                TO  AUTO-END
 10952     ELSE
 10953         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 10954         MOVE ' '                       TO  DC-OPTION-CODE
 10955         MOVE +0                        TO  DC-ELAPSED-DAYS
 10956                                            DC-ELAPSED-MONTHS
 10957         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10958         IF NO-CONVERSION-ERROR
 10959             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 10960         ELSE
 10961             MOVE SPACES                TO  AUTO-END.
 10962
 10963     MOVE AT-REGULAR-PMT-AMT        TO AUTO-AMOUNT.
 10964     MOVE AUTO-PMT-TEXT             TO DISPLAY-TEXT.
 10965     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 10966
 10967     GO TO 2800-INCR-DISPLAY-CNT.
 10968
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 208
* EL150.cbl
 10970 2300-CORRESPONDENCE-TRAILER.
 10971     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 10972     MOVE 'LETTER'               TO DISP-ACT-A.
 10973     MOVE AT-STD-LETTER-FORM     TO DISP-ACT-B.
 10974     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 10975
 10976     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 10977     MOVE ' '                    TO DC-OPTION-CODE.
 10978     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10979     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 10980
 10981     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 10982
 10983     IF AT-ADDRESEE-TYPE = 'I'
 10984         MOVE 1                  TO WS-SUB
 10985      ELSE
 10986     IF AT-ADDRESEE-TYPE = 'B'
 10987         MOVE 2                  TO WS-SUB
 10988      ELSE
 10989     IF AT-ADDRESEE-TYPE = 'A'
 10990         MOVE 3                  TO WS-SUB
 10991      ELSE
 10992     IF AT-ADDRESEE-TYPE = 'P'
 10993         MOVE 4                  TO WS-SUB
 10994      ELSE
 10995     IF AT-ADDRESEE-TYPE = 'E'
 10996         MOVE 5                  TO WS-SUB
 10997      ELSE
 10998     IF AT-ADDRESEE-TYPE = 'O'
 10999         MOVE 6                  TO WS-SUB
 11000      ELSE
 11001     IF AT-ADDRESEE-TYPE = 'Q'
 11002         MOVE 7                  TO WS-SUB
 11003      ELSE
 11004         MOVE 0                  TO WS-SUB.
 11005
 11006     IF WS-SUB = 0
 11007         MOVE SPACES             TO  CORR-TO
 11008     ELSE
 11009         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 11010
 11011     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
 11012        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
 11013             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
 11014          MOVE '   STOP='         TO CORR-RECVD-LIT
 11015          MOVE AT-STOP-LETTER-DT  TO DC-BIN-DATE-1
 11016          MOVE ' '                TO DC-OPTION-CODE
 11017          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11018          MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11019     ELSE
 11020        MOVE '  RECVD='         TO CORR-RECVD-LIT
 11021        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
 11022            MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
 11023            MOVE ' '                TO DC-OPTION-CODE
 11024            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11025            MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11026        ELSE
 11027            MOVE SPACES             TO CORR-RECVD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 209
* EL150.cbl
 11028        END-IF
 11029     END-IF.
 11030
 11031     IF AT-RESEND-PRINT-DATE NOT = LOW-VALUES
 11032         MOVE '  RESENT='          TO CORR-VAR
 11033         MOVE AT-RESEND-PRINT-DATE TO DC-BIN-DATE-1
 11034         MOVE ' '                  TO DC-OPTION-CODE
 11035         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11036         MOVE DC-GREG-DATE-1-EDIT  TO CORR-RESENT
 11037     ELSE
 11038         IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
 11039             MOVE '  RESEND='         TO CORR-VAR
 11040             MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
 11041             MOVE ' '                 TO DC-OPTION-CODE
 11042             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11043             MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11044         ELSE
 11045            IF AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11046               MOVE 'ARCH. NO='          TO CORR-VAR
 11047               MOVE AT-LETTER-ARCHIVE-NO TO CORR-ARCH-NO
 11048            ELSE
 11049               MOVE SPACES       TO CORR-RESENT  CORR-VAR.
 11050
 11051*    IF PI-COMPANY-ID = 'DMD'
 11052*        IF AT-DMD-LETTER-PURGE-DT NOT = SPACES AND LOW-VALUES
 11053*            MOVE '  PURGED='             TO CORR-VAR
 11054*            MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
 11055*            MOVE ' '                     TO DC-OPTION-CODE
 11056*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11057*            MOVE DC-GREG-DATE-1-EDIT     TO CORR-RESENT.
 11058
 11059     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 11060     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11061
 11062     GO TO 2800-INCR-DISPLAY-CNT.
 11063
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 210
* EL150.cbl
 11065 2400-GENERAL-INFO-TRAILER.
 11066
 11067     IF AT-PAYMENT-NOTE
 11068         GO TO 2020-READ-TRAILER-LOOP.
 11069
 11070     IF AT-CONTINUED-NOTE
 11071         GO TO 2020-READ-TRAILER-LOOP.
 11072
 11073     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11074
 11075     IF AT-MAINT-NOTE
 11076         MOVE 'MAINT NOTES'      TO DISPLAY-ACTION
 11077     ELSE
 11078         IF AT-CALL-NOTE
 11079             MOVE 'CALL'         TO DISP-ACT-A
 11080             IF AT-PHONE-CALL-IN
 11081                 MOVE 'IN'       TO DISP-ACT-B
 11082             ELSE
 11083                 MOVE 'OUT'      TO DISP-ACT-B
 11084         ELSE
 11085             IF AT-CERT-CHANGE
 11086                 MOVE 'CERT CHANGE'
 11087                                 TO DISPLAY-ACTION
 11088             ELSE IF AT-APPROVAL-NOTE
 11089                 MOVE 'APPROVL REVIEW' TO DISPLAY-ACTION
 11090             ELSE IF AT-NOTE-FILE-NOTE
 11091                 MOVE 'NOTE & FILE' TO DISPLAY-ACTION
 11092             ELSE
 11093                 MOVE 'NOTE'     TO DISPLAY-ACTION.
 11094
 11095     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11096     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11097     MOVE ' '                    TO DC-OPTION-CODE.
 11098     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11099     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11100
 11101     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11102     MOVE AT-INFO-LINE-1         TO DISPLAY-TEXT.
 11103     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11104     GO TO 2800-INCR-DISPLAY-CNT.
 11105
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 211
* EL150.cbl
 11107 2500-AUTO-PROMPT-TRAILER.
 11108     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11109     MOVE '5'                    TO DC-OPTION-CODE.
 11110     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11111
 11112     IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
 11113         GO TO 2020-READ-TRAILER-LOOP.
 11114
 11115     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11116     MOVE 'REMINDER'             TO DISPLAY-ACTION.
 11117     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11118
 11119     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11120     MOVE ' '                    TO DC-OPTION-CODE.
 11121     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11122     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11123
 11124     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11125
 11126     MOVE AT-PROMPT-END-DT       TO DC-BIN-DATE-1.
 11127     MOVE ' '                    TO DC-OPTION-CODE.
 11128     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11129     MOVE DC-GREG-DATE-1-EDIT    TO PROMPT-END.
 11130
 11131     MOVE AT-PROMPT-LINE-1       TO PROMPT-MSG.
 11132     MOVE PROMPT-TEXT            TO DISPLAY-TEXT.
 11133     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11134     GO TO 2800-INCR-DISPLAY-CNT.
 11135
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 212
* EL150.cbl
 11137 2600-DENIAL-TRAILER.
 11138     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11139     MOVE 'DENIAL'               TO DISPLAY-ACTION.
 11140     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11141
 11142     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11143     MOVE ' '                    TO DC-OPTION-CODE.
 11144     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11145     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11146
 11147     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11148
 11149     IF AT-RETRACTION-DT NOT = LOW-VALUES
 11150         MOVE AT-DENIAL-DT       TO DC-BIN-DATE-1
 11151         MOVE ' '                TO DC-OPTION-CODE
 11152         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11153         MOVE DC-GREG-DATE-1-EDIT TO DENIED-DATE
 11154         MOVE AT-RETRACTION-DT   TO DC-BIN-DATE-1
 11155         MOVE ' '                TO DC-OPTION-CODE
 11156         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11157         MOVE DC-GREG-DATE-1-EDIT TO RECONSIDERED-DATE
 11158         MOVE RECONSIDERED-TEXT   TO DISPLAY-TEXT
 11159         MOVE TRAILER-DISPLAY-WORK-AREA
 11160                                 TO MAP-DISPLAY (DISPLAY-CNT)
 11161         GO TO 2800-INCR-DISPLAY-CNT.
 11162
 11163     MOVE AT-DENIAL-DT           TO DC-BIN-DATE-1.
 11164     MOVE ' '                    TO DC-OPTION-CODE.
 11165     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11166     MOVE DC-GREG-DATE-1-EDIT    TO DENIAL-DATE.
 11167
 11168     MOVE AT-DENIAL-REASON-CODE  TO DENIAL-CODE.
 11169     MOVE AT-DENIAL-INFO-1       TO DENIAL-MSG.
 11170     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
 11171        EVALUATE CL-DENIAL-TYPE
 11172           WHEN '1'
 11173              MOVE 'DENIAL STATUS - DENIAL       '
 11174                                 TO DENTYPO
 11175           WHEN '2'
 11176              MOVE 'DENIAL STATUS - RESCISSION   '
 11177                                 TO DENTYPO
 11178           WHEN '3'
 11179              MOVE 'DENIAL STATUS - REFORMATION  '
 11180                                 TO DENTYPO
 11181           WHEN '4'
 11182              MOVE 'DENIAL STATUS - REF TO RESC  '
 11183                                 TO DENTYPO
 11184           WHEN '5'
 11185              MOVE 'DENIAL STATUS - RECONSIDERED '
 11186                                 TO DENTYPO
 11187        END-EVALUATE
 11188        MOVE AL-SANOF            TO DENTYPA
 11189     END-IF
 11190     MOVE DENIAL-TEXT            TO DISPLAY-TEXT.
 11191     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11192     GO TO 2800-INCR-DISPLAY-CNT.
 11193
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 213
* EL150.cbl
 11195 2700-INCURRED-CHANGE-TRAILER.
 11196     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11197     MOVE 'INCUR DATE CHG'       TO DISPLAY-ACTION.
 11198     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11199
 11200     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11201     MOVE ' '                    TO DC-OPTION-CODE.
 11202     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11203     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11204
 11205     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11206
 11207     IF AT-OLD-INCURRED-DT NOT = LOW-VALUES
 11208        MOVE AT-OLD-INCURRED-DT  TO DC-BIN-DATE-1
 11209        MOVE ' '                 TO DC-OPTION-CODE
 11210        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11211        IF DATE-CONVERSION-ERROR
 11212           MOVE SPACES           TO INCUR-DT
 11213        ELSE
 11214           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-DT
 11215     ELSE
 11216        MOVE SPACES              TO INCUR-DT.
 11217
 11218     IF PI-USES-PAID-TO
 11219        MOVE ' PD  TO ='         TO PDTHRU-HEAD.
 11220
 11221     IF AT-OLD-PAID-THRU-DT NOT = LOW-VALUES
 11222        MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 11223        MOVE ' '                 TO DC-OPTION-CODE
 11224        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11225        IF DATE-CONVERSION-ERROR
 11226           MOVE SPACES           TO INCUR-PDTHRU
 11227        ELSE
 11228           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 11229           IF PI-USES-PAID-TO
 11230              MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 11231              MOVE '6'                 TO DC-OPTION-CODE
 11232              MOVE +1                  TO DC-ELAPSED-DAYS
 11233              MOVE +0                  TO DC-ELAPSED-MONTHS
 11234              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11235              IF NO-CONVERSION-ERROR
 11236                 MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 11237              ELSE
 11238                 NEXT SENTENCE
 11239           ELSE
 11240              NEXT SENTENCE
 11241     ELSE
 11242        MOVE SPACES              TO INCUR-PDTHRU.
 11243
 11244     MOVE AT-OLD-TOTAL-PAID      TO INCUR-PAID.
 11245     MOVE INCUR-TEXT             TO DISPLAY-TEXT.
 11246     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11247     GO TO 2800-INCR-DISPLAY-CNT.
 11248
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 214
* EL150.cbl
 11250 2710-FORM-CONTROL-TRAILER.
 11251     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11252     MOVE 'FORM CTL'             TO DISP-ACT-A.
 11253     IF INITIAL-FORM
 11254        MOVE 'INIT'              TO DISP-ACT-B
 11255     ELSE
 11256        MOVE 'PROG'              TO DISP-ACT-B.
 11257
 11258     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11259
 11260     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11261     MOVE ' '                    TO DC-OPTION-CODE.
 11262     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11263     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11264
 11265     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11266
 11267     IF AT-FORM-ADDRESS = 'I'
 11268         MOVE 1                  TO WS-SUB
 11269      ELSE
 11270     IF AT-FORM-ADDRESS = 'A'
 11271         MOVE 3                  TO WS-SUB
 11272      ELSE
 11273     IF AT-FORM-ADDRESS = 'O'
 11274         MOVE 6                  TO WS-SUB
 11275      ELSE
 11276     IF AT-FORM-ADDRESS = 'Q'
 11277         MOVE 7                  TO WS-SUB
 11278      ELSE
 11279         MOVE 0                  TO WS-SUB.
 11280
 11281     IF WS-SUB = 0
 11282         MOVE SPACES             TO  CORR-TO
 11283     ELSE
 11284         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 11285
 11286     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
 11287         MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
 11288         MOVE ' '                 TO DC-OPTION-CODE
 11289         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11290         MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11291     ELSE
 11292         MOVE SPACES              TO CORR-RECVD.
 11293
 11294     IF AT-FORM-PRINTED-DT  = LOW-VALUES
 11295         MOVE '    SEND='         TO CORR-VAR
 11296         MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
 11297         MOVE ' '                 TO DC-OPTION-CODE
 11298         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11299         MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11300     ELSE
 11301         MOVE '    SENT='        TO CORR-VAR
 11302         IF AT-FORM-REPRINT-DT  = LOW-VALUES
 11303            MOVE AT-FORM-PRINTED-DT TO DC-BIN-DATE-1
 11304            MOVE ' '                TO DC-OPTION-CODE
 11305            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11306            MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11307         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 215
* EL150.cbl
 11308            MOVE AT-FORM-REPRINT-DT TO DC-BIN-DATE-1
 11309            MOVE ' '                TO DC-OPTION-CODE
 11310            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11311            MOVE DC-GREG-DATE-1-EDIT    TO CORR-RESENT.
 11312
 11313     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 11314     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11315
 11316     GO TO 2800-INCR-DISPLAY-CNT.
 11317
 11318 2800-INCR-DISPLAY-CNT.
 11319     IF LCP-ONCTR-01 =  0
 11320         ADD 1 TO LCP-ONCTR-01
 11321         MOVE 'Y'                TO PI-PREV-DISP
 11322         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW  PI-SAVE-HIGH.
 11323
 11324     IF DIRECTION-SWITCH = 'F'
 11325         MOVE TRLR-SEQ-NO        TO PI-SAVE-HIGH
 11326         ADD +1                  TO DISPLAY-CNT
 11327         IF DISPLAY-CNT > +4
 11328             GO TO 2999-EXIT
 11329         ELSE
 11330             NEXT SENTENCE
 11331     ELSE
 11332         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW
 11333         SUBTRACT +1 FROM DISPLAY-CNT
 11334         if map-display (1) (1:14) = 'SPECIAL REVIEW'
 11335            IF DISPLAY-CNT < +2
 11336               GO TO 2999-EXIT
 11337            END-IF
 11338         ELSE
 11339            IF DISPLAY-CNT < +1
 11340               GO TO 2999-EXIT.
 11341
 11342     GO TO 2020-READ-TRAILER-LOOP.
 11343
 11344 2950-NO-MORE-TRAILERS.
 11345     MOVE ER-0303                TO EMI-ERROR.
 11346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11347
 11348 2999-EXIT.
 11349     EXIT.
 11350
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 216
* EL150.cbl
 11352 6000-CHECK-AUTO-ACTIVITY.
 11353******************************************************************
 11354*    READ THE CONTROL FILE TO VERIFY THAT AN AUTOMATIC           *
 11355*    ACTIVITY RECORD EXISTS.                                     *
 11356******************************************************************
 11357
 11358
 11359* EXEC CICS HANDLE CONDITION
 11360*        NOTFND   (6000-NOT-FOUND)
 11361*    END-EXEC.
 11362*    MOVE '"$I                   ! 4 #00010469' TO DFHEIV0
 11363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11365     MOVE X'3420233030303130343639' TO DFHEIV0(25:11)
 11366     CALL 'kxdfhei1' USING DFHEIV0
 11367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11368
 11369
 11370     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
 11371     MOVE 'T'                    TO  CNTL-REC-TYPE
 11372     MOVE SPACES                 TO  CNTL-ACCESS
 11373     MOVE +0                     TO  CNTL-SEQ-NO
 11374     MOVE 'CNTL'                 TO  FILE-SWITCH.
 11375
 11376
 11377* EXEC CICS READ
 11378*        DATASET   ('ELCNTL')
 11379*        RIDFLD    (ELCNTL-KEY)
 11380*        SET       (ADDRESS OF CONTROL-FILE)
 11381*    END-EXEC.
 11382     MOVE 'ELCNTL' TO DFHEIV1
 11383*    MOVE '&"S        E          (   #00010479' TO DFHEIV0
 11384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11386     MOVE X'2020233030303130343739' TO DFHEIV0(25:11)
 11387     CALL 'kxdfhei1' USING DFHEIV0,
 11388           DFHEIV1,
 11389           DFHEIV20,
 11390           DFHEIV99,
 11391           ELCNTL-KEY,
 11392           DFHEIV99,
 11393           DFHEIV99,
 11394           DFHEIV99
 11395     SET ADDRESS OF CONTROL-FILE TO
 11396         DFHEIV20
 11397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11398
 11399
 11400     MOVE 'Y'                    TO  WS-ACT-REC-FOUND-SW.
 11401     GO TO 6000-EXIT.
 11402
 11403 6000-NOT-FOUND.
 11404     MOVE 'N'                    TO  WS-ACT-REC-FOUND-SW.
 11405     MOVE AL-UABON               TO  ACTCDA.
 11406     MOVE -1                     TO  ACTCDL.
 11407     MOVE ER-3516                TO  EMI-ERROR
 11408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11409
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 217
* EL150.cbl
 11410 6000-EXIT.
 11411     EXIT.
 11412
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 218
* EL150.cbl
 11414 6050-AUTO-LETTER-WRITER.
 11415******************************************************************
 11416*    THE FOLLOWING ACTIVITIES WILL BE PERFORMED BASED ON THE     *
 11417*    CODES ENTERED IN THE AUTOMATIC ACTIVITY RECORD.             *
 11418*       1.  IF SPECIFIED, THE AUTOMATIC LETTER WRITER PROGRAM    *
 11419*           WILL BE LINKED TO AND A LETTER WILL BE GENERATED.    *
 11420*           A.  ANY RESEND OR FOLLOW UP DATES SPECIFIED IN THE   *
 11421*               ACTIVITY RECORD WILL BE STORED IN THE LETTER     *
 11422******************************************************************
 11423
 11424     IF WS-ACTIVITY-CODE = ZERO
 11425         GO TO 6050-EXIT.
 11426
 11427     MOVE WS-ACTIVITY-CODE       TO  SUB.
 11428     SUBTRACT 9 FROM SUB.
 11429
 11430 6050-EDIT-USER-ACTIVITY-LOOP.
 11431
 11432     IF (CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N') OR
 11433        (CF-USER-LETTER-ID (SUB) = SPACES OR LOW-VALUES)
 11434             GO TO 6050-EXIT.
 11435
 11436 6050-START-AUTO-LETTER-WRITER.
 11437
 11438     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 11439     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 11440
 11441     MOVE CF-USER-LETTER-ID (SUB)    TO W-1523-FORM-NUMBER.
 11442
 11443     IF CF-USER-RESEND-DAYS (SUB) NOT = ZEROS
 11444         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 11445         MOVE '6'                    TO  DC-OPTION-CODE
 11446         MOVE CF-USER-RESEND-DAYS (SUB)  TO  DC-ELAPSED-DAYS
 11447         MOVE +0                     TO  DC-ELAPSED-MONTHS
 11448         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11449         IF NO-CONVERSION-ERROR
 11450             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 11451         ELSE
 11452             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
 11453
 11454     IF CF-USER-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 11455         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 11456         MOVE '6'                    TO  DC-OPTION-CODE
 11457         MOVE CF-USER-FOLLOW-UP-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 11458         MOVE +0                     TO  DC-ELAPSED-MONTHS
 11459         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11460         IF NO-CONVERSION-ERROR
 11461             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 11462         ELSE
 11463             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
 11464
 11465******************************************************************
 11466*    LINK TO THE AUTOMATIC LETTER WRITER PROGRAM.                *
 11467******************************************************************
 11468
 11469
 11470* EXEC CICS LINK
 11471*        PROGRAM    (LINK-1523)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 219
* EL150.cbl
 11472*        COMMAREA   (W-1523-LINKDATA)
 11473*        LENGTH     (W-1523-COMM-LENGTH)
 11474*    END-EXEC.
 11475*    MOVE '."C                   ''   #00010554' TO DFHEIV0
 11476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11478     MOVE X'2020233030303130353534' TO DFHEIV0(25:11)
 11479     CALL 'kxdfhei1' USING DFHEIV0,
 11480           LINK-1523,
 11481           W-1523-LINKDATA,
 11482           W-1523-COMM-LENGTH,
 11483           DFHEIV99,
 11484           DFHEIV99,
 11485           DFHEIV99
 11486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11487
 11488
 11489******************************************************************
 11490*    CHECK THE ERROR CODES FROM THE AUTOMATIC LETTER WRITER      *
 11491*    PROGRAM.                                                    *
 11492*        1.  IF FATAL ERRORS ARE DETECTED BY THE AUTO LETTER     *
 11493*            WRITER PROGRAM, THE LETTER IS NOT CREATED AND AN    *
 11494*            ERROR MESSAGE (#0802) IS DISPLAYED INDICATING THAT  *
 11495*            THE LETTER WAS NOT CREATED.                         *
 11496*        2.  IF THE AUTO LETTER WRITER PROGRAM IS UNABLE TO      *
 11497*            RESOLVE A VARIABLE, THE LETTER IS CREATED AND AN    *
 11498*            ERROR MESSAGE (#0803) INDICATING THAT THE LETTER    *
 11499*            WAS CREATED WITH ERRORS IS DISPLAYED.               *
 11500******************************************************************
 11501
 11502     IF W-1523-ERROR-CODE = ZEROS
 11503         GO TO 6050-EXIT.
 11504
 11505     IF W-1523-FATAL-ERROR
 11506         MOVE ER-0802                TO  EMI-ERROR
 11507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11508
 11509     IF W-1523-ERROR-CODE = 0191
 11510         MOVE ER-0803                TO  EMI-ERROR
 11511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11512
 11513 6050-EXIT.
 11514     EXIT.
 11515
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 220
* EL150.cbl
 11517 6100-RESET-AUTO-ACTIVITY.
 11518******************************************************************
 11519*    RESET ALL LETTER ACTIVITY AWAITING FURTHER ACTION (RESEND,  *
 11520*    FOLLOW-UP, ETC) IF THE AUTOMATIC ACTIVITY CODE IS SET       *
 11521*    TO ZEROS.                                                   *
 11522******************************************************************
 11523
 11524     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 11525     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 11526     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 11527     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 11528     MOVE +100                   TO  TRLR-SEQ-NO.
 11529     MOVE 'TRLR'                 TO  FILE-SWITCH.
 11530
 11531 6100-STARTBR-TRLR.
 11532
 11533
 11534* EXEC CICS HANDLE CONDITION
 11535*        ENDFILE  (6100-END-RESET)
 11536*        NOTFND   (6100-END-RESET)
 11537*    END-EXEC.
 11538*    MOVE '"$''I                  ! 5 #00010604' TO DFHEIV0
 11539     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11541     MOVE X'3520233030303130363034' TO DFHEIV0(25:11)
 11542     CALL 'kxdfhei1' USING DFHEIV0
 11543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11544
 11545
 11546
 11547* EXEC CICS STARTBR
 11548*        DATASET   ('ELTRLR')
 11549*        RIDFLD    (ELTRLR-KEY)
 11550*        GTEQ
 11551*    END-EXEC.
 11552     MOVE 'ELTRLR' TO DFHEIV1
 11553     MOVE 0
 11554       TO DFHEIV11
 11555*    MOVE '&,         G          &   #00010609' TO DFHEIV0
 11556     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11558     MOVE X'2020233030303130363039' TO DFHEIV0(25:11)
 11559     CALL 'kxdfhei1' USING DFHEIV0,
 11560           DFHEIV1,
 11561           ELTRLR-KEY,
 11562           DFHEIV99,
 11563           DFHEIV11,
 11564           DFHEIV99
 11565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11566
 11567
 11568     MOVE 'Y'                        TO  WS-BROWSE-SW.
 11569
 11570 6100-READ-NEXT.
 11571
 11572
 11573* EXEC CICS READNEXT
 11574*        DATASET   ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 221
* EL150.cbl
 11575*        RIDFLD    (ELTRLR-KEY)
 11576*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11577*    END-EXEC.
 11578     MOVE 'ELTRLR' TO DFHEIV1
 11579     MOVE 0
 11580       TO DFHEIV11
 11581*    MOVE '&.S                   )   #00010619' TO DFHEIV0
 11582     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11583     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11584     MOVE X'2020233030303130363139' TO DFHEIV0(25:11)
 11585     CALL 'kxdfhei1' USING DFHEIV0,
 11586           DFHEIV1,
 11587           DFHEIV20,
 11588           DFHEIV99,
 11589           ELTRLR-KEY,
 11590           DFHEIV99,
 11591           DFHEIV11,
 11592           DFHEIV99,
 11593           DFHEIV99
 11594     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11595         DFHEIV20
 11596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11597
 11598
 11599     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)   OR
 11600        (PI-CARRIER    NOT = TRLR-CARRIER)   OR
 11601        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO)  OR
 11602        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 11603         GO TO 6100-END-RESET.
 11604
 11605     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 11606         GO TO 6100-READ-NEXT.
 11607
 11608     IF AT-TRAILER-TYPE NOT = '4'
 11609         GO TO 6100-READ-NEXT.
 11610
 11611     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 11612         GO TO 6100-READ-NEXT.
 11613
 11614     IF (AT-AUTO-RE-SEND-DT = LOW-VALUES OR SPACES)
 11615       AND
 11616        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 11617         GO TO 6100-READ-NEXT.
 11618
 11619     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 11620        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 11621        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 11622         GO TO 6100-READ-NEXT.
 11623
 11624     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 11625       AND
 11626        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 11627       AND
 11628        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 11629         GO TO 6100-READ-NEXT.
 11630
 11631 6100-END-BROWSE.
 11632
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 222
* EL150.cbl
 11633     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 11634
 11635
 11636* EXEC CICS ENDBR
 11637*        DATASET   ('ELTRLR')
 11638*    END-EXEC.
 11639     MOVE 'ELTRLR' TO DFHEIV1
 11640     MOVE 0
 11641       TO DFHEIV11
 11642*    MOVE '&2                    $   #00010661' TO DFHEIV0
 11643     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11645     MOVE X'2020233030303130363631' TO DFHEIV0(25:11)
 11646     CALL 'kxdfhei1' USING DFHEIV0,
 11647           DFHEIV1,
 11648           DFHEIV11,
 11649           DFHEIV99
 11650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11651
 11652
 11653     MOVE 'N'                        TO  WS-BROWSE-SW.
 11654
 11655 6100-READ-TRLR-UPDATE.
 11656
 11657
 11658* EXEC CICS READ
 11659*        DATASET   ('ELTRLR')
 11660*        RIDFLD    (ELTRLR-KEY)
 11661*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11662*        UPDATE
 11663*    END-EXEC.
 11664     MOVE 'ELTRLR' TO DFHEIV1
 11665*    MOVE '&"S        EU         (   #00010669' TO DFHEIV0
 11666     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11667     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11668     MOVE X'2020233030303130363639' TO DFHEIV0(25:11)
 11669     CALL 'kxdfhei1' USING DFHEIV0,
 11670           DFHEIV1,
 11671           DFHEIV20,
 11672           DFHEIV99,
 11673           ELTRLR-KEY,
 11674           DFHEIV99,
 11675           DFHEIV99,
 11676           DFHEIV99
 11677     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11678         DFHEIV20
 11679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11680
 11681
 11682     MOVE 'Y'                        TO  WS-UPDATE-SW.
 11683
 11684     IF AT-AUTO-RE-SEND-DT IS NOT < SAVE-BIN-DATE
 11685         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 11686         MOVE PI-COMPANY-CD          TO  ARCH-COMP-CD
 11687         MOVE AT-LETTER-ARCHIVE-NO   TO  ARCH-ARCHIVE-NO
 11688         MOVE '1'                    TO  ARCH-RECORD-TYPE
 11689         MOVE +0                     TO  ARCH-SEQ-NO
 11690         PERFORM 6200-READ-ARCH-UPDATE THRU 6200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 223
* EL150.cbl
 11691
 11692     IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 11693         MOVE LOW-VALUES             TO  AT-RECEIPT-FOLLOW-UP.
 11694
 11695 6100-REWRITE-TRLR.
 11696
 11697
 11698* EXEC CICS REWRITE
 11699*        DATASET   ('ELTRLR')
 11700*        FROM      (ACTIVITY-TRAILERS)
 11701*    END-EXEC.
 11702     MOVE LENGTH OF
 11703      ACTIVITY-TRAILERS
 11704       TO DFHEIV11
 11705     MOVE 'ELTRLR' TO DFHEIV1
 11706*    MOVE '&& L                  %   #00010691' TO DFHEIV0
 11707     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11708     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11709     MOVE X'2020233030303130363931' TO DFHEIV0(25:11)
 11710     CALL 'kxdfhei1' USING DFHEIV0,
 11711           DFHEIV1,
 11712           ACTIVITY-TRAILERS,
 11713           DFHEIV11,
 11714           DFHEIV99
 11715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11716
 11717
 11718     GO TO 6100-STARTBR-TRLR.
 11719
 11720 6100-END-RESET.
 11721
 11722     IF WS-BROWSE-SW = 'Y'
 11723         MOVE 'N'                    TO  WS-BROWSE-SW
 11724
 11725* EXEC CICS ENDBR
 11726*            DATASET   ('ELTRLR')
 11727*        END-EXEC.
 11728     MOVE 'ELTRLR' TO DFHEIV1
 11729     MOVE 0
 11730       TO DFHEIV11
 11731*    MOVE '&2                    $   #00010702' TO DFHEIV0
 11732     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11733     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11734     MOVE X'2020233030303130373032' TO DFHEIV0(25:11)
 11735     CALL 'kxdfhei1' USING DFHEIV0,
 11736           DFHEIV1,
 11737           DFHEIV11,
 11738           DFHEIV99
 11739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11740
 11741
 11742 6100-EXIT.
 11743     EXIT.
 11744
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 224
* EL150.cbl
 11746 6150-READ-TRLR92.
 11747
 11748     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 11749     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 11750     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 11751     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 11752     MOVE +092                   TO  WS-TRLR-SEQ-NO.
 11753     MOVE 'TRLR'                 TO  FILE-SWITCH.
 11754
 11755
 11756* EXEC CICS READ
 11757*        DATASET   ('ELTRLR')
 11758*        RIDFLD    (WS-ELTRLR-KEY)
 11759*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11760*        RESP      (WS-RESPONSE)
 11761*    END-EXEC.
 11762     MOVE 'ELTRLR' TO DFHEIV1
 11763*    MOVE '&"S        E          (  N#00010719' TO DFHEIV0
 11764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11766     MOVE X'204E233030303130373139' TO DFHEIV0(25:11)
 11767     CALL 'kxdfhei1' USING DFHEIV0,
 11768           DFHEIV1,
 11769           DFHEIV20,
 11770           DFHEIV99,
 11771           WS-ELTRLR-KEY,
 11772           DFHEIV99,
 11773           DFHEIV99,
 11774           DFHEIV99
 11775     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11776         DFHEIV20
 11777     MOVE EIBRESP  TO WS-RESPONSE
 11778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11779
 11780
 11781     .
 11782 6150-EXIT.
 11783     EXIT.
 11784
 11785 6200-READ-ARCH-UPDATE.
 11786******************************************************************
 11787*  READ AND UPDATE THE RESEND DATE ON THE LETTER ARCHIVE RECORD  *
 11788******************************************************************
 11789
 11790
 11791* EXEC CICS HANDLE CONDITION
 11792*        NOTFND   (6200-EXIT)
 11793*    END-EXEC.
 11794*    MOVE '"$I                   ! 6 #00010735' TO DFHEIV0
 11795     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11797     MOVE X'3620233030303130373335' TO DFHEIV0(25:11)
 11798     CALL 'kxdfhei1' USING DFHEIV0
 11799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11800
 11801
 11802
 11803* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 225
* EL150.cbl
 11804*        DATASET   ('ELARCH')
 11805*        RIDFLD    (ELARCH-KEY)
 11806*        SET       (ADDRESS OF LETTER-ARCHIVE)
 11807*        UPDATE
 11808*    END-EXEC.
 11809     MOVE 'ELARCH' TO DFHEIV1
 11810*    MOVE '&"S        EU         (   #00010739' TO DFHEIV0
 11811     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11813     MOVE X'2020233030303130373339' TO DFHEIV0(25:11)
 11814     CALL 'kxdfhei1' USING DFHEIV0,
 11815           DFHEIV1,
 11816           DFHEIV20,
 11817           DFHEIV99,
 11818           ELARCH-KEY,
 11819           DFHEIV99,
 11820           DFHEIV99,
 11821           DFHEIV99
 11822     SET ADDRESS OF LETTER-ARCHIVE TO
 11823         DFHEIV20
 11824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11825
 11826
 11827     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 11828
 11829 6200-REWRITE-ARCH.
 11830
 11831* EXEC CICS REWRITE
 11832*        DATASET   ('ELARCH')
 11833*        FROM      (LETTER-ARCHIVE)
 11834*    END-EXEC.
 11835     MOVE LENGTH OF
 11836      LETTER-ARCHIVE
 11837       TO DFHEIV11
 11838     MOVE 'ELARCH' TO DFHEIV1
 11839*    MOVE '&& L                  %   #00010749' TO DFHEIV0
 11840     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11842     MOVE X'2020233030303130373439' TO DFHEIV0(25:11)
 11843     CALL 'kxdfhei1' USING DFHEIV0,
 11844           DFHEIV1,
 11845           LETTER-ARCHIVE,
 11846           DFHEIV11,
 11847           DFHEIV99
 11848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11849
 11850
 11851 6200-EXIT.
 11852     EXIT.
 11853
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 226
* EL150.cbl
 11855 7000-START-BROWSE.
 11856
 11857     IF PI-COMPANY-ID = 'DMD'
 11858             AND
 11859        PI-ASS-PROCESSING
 11860         GO TO 7200-BROWSING-ASS-FWRD.
 11861
 11862     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 11863     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 11864
 11865     IF CLMNOL > 0
 11866         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 11867     IF CARRL > 0
 11868         MOVE CARRI              TO  MSTR-CARRIER.
 11869     IF CERTNOL > 0
 11870         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 11871     IF SUFXL > 0
 11872         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 11873
 11874     IF PI-PREV-CLAIM = LOW-VALUES
 11875         NEXT SENTENCE
 11876     ELSE
 11877         IF CLMNOL  = 0 AND
 11878            CARRL   = 0 AND
 11879            CERTNOL = 0 AND
 11880            SUFXL   = 0
 11881                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 11882
 11883 7000-START-READING.
 11884
 11885
 11886* EXEC CICS HANDLE CONDITION
 11887*        ENDFILE  (8700-END-FILE)
 11888*        NOTFND   (8600-NOT-FOUND)
 11889*    END-EXEC.
 11890*    MOVE '"$''I                  ! 7 #00010788' TO DFHEIV0
 11891     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11893     MOVE X'3720233030303130373838' TO DFHEIV0(25:11)
 11894     CALL 'kxdfhei1' USING DFHEIV0
 11895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11896
 11897
 11898     IF YESNOSWL > 0
 11899         MOVE YESNOSWI TO CL-YESNOSW
 11900     END-IF.
 11901
 11902     MOVE 'MSTR'                 TO FILE-SWITCH.
 11903
 11904
 11905* EXEC CICS STARTBR
 11906*        DATASET   (PI-CURRENT-FILE)
 11907*        RIDFLD    (ELMSTR-KEY)
 11908*    END-EXEC.
 11909     MOVE 0
 11910       TO DFHEIV11
 11911*    MOVE '&,         G          &   #00010799' TO DFHEIV0
 11912     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 227
* EL150.cbl
 11913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11914     MOVE X'2020233030303130373939' TO DFHEIV0(25:11)
 11915     CALL 'kxdfhei1' USING DFHEIV0,
 11916           PI-CURRENT-FILE,
 11917           ELMSTR-KEY,
 11918           DFHEIV99,
 11919           DFHEIV11,
 11920           DFHEIV99
 11921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11922
 11923
 11924 7000-READ-NEXT.
 11925
 11926
 11927* EXEC CICS READNEXT
 11928*        DATASET   (PI-CURRENT-FILE)
 11929*        RIDFLD    (ELMSTR-KEY)
 11930*        INTO      (CLAIM-MASTER)
 11931*    END-EXEC.
 11932     MOVE LENGTH OF
 11933      CLAIM-MASTER
 11934       TO DFHEIV12
 11935     MOVE 0
 11936       TO DFHEIV11
 11937*    MOVE '&.IL                  )   #00010806' TO DFHEIV0
 11938     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11939     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11940     MOVE X'2020233030303130383036' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0,
 11942           PI-CURRENT-FILE,
 11943           CLAIM-MASTER,
 11944           DFHEIV12,
 11945           ELMSTR-KEY,
 11946           DFHEIV99,
 11947           DFHEIV11,
 11948           DFHEIV99,
 11949           DFHEIV99
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11951
 11952
 11953     IF ELMSTR-KEY = PI-PREV-CLAIM
 11954         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 11955         GO TO 7000-READ-NEXT.
 11956
 11957     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 11958         GO TO 8700-END-FILE.
 11959
 11960 7000-PICK-UP-LOGIC.
 11961
 11962     IF PI-COMPANY-ID  =  'CRI'
 11963         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 11964             GO TO 8700-END-FILE.
 11965
 11966     IF PI-CARRIER-SECURITY > SPACES
 11967         IF CL-CARRIER = PI-CARRIER-SECURITY
 11968             NEXT SENTENCE
 11969         ELSE
 11970             GO TO 7000-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 228
* EL150.cbl
 11971
 11972     IF PI-ACCOUNT-SECURITY > SPACES
 11973         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 11974             NEXT SENTENCE
 11975         ELSE
 11976             GO TO 7000-READ-NEXT.
 11977
 11978     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 229
* EL150.cbl
 11980 7200-BROWSING-ASS-FWRD.
 11981
 11982     COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1.
 11983
 11984     IF PI-ASS-NDX > +24
 11985             OR
 11986        PI-ASS-CERTS (PI-ASS-NDX) NOT > LOW-VALUE
 11987         IF PI-PF15-LAST
 11988             MOVE PI-ORIGINAL-ASS-CERT
 11989                                 TO ELMSTR-KEY
 11990             MOVE ZEROS          TO PI-DAYS-PAID
 11991                                    PI-TOTAL-PAID
 11992             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 11993                                    PI-LAST-PF-KEY-IND
 11994                                    PI-ASSOCIATED-PROCESS-IND
 11995             GO TO 7000-START-READING
 11996         ELSE
 11997             COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1
 11998             MOVE 'F'            TO PI-LAST-PF-KEY-IND
 11999             MOVE -1             TO ENTERPFL
 12000             MOVE ER-0936        TO EMI-ERROR
 12001             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002             GO TO 8200-SEND-DATAONLY.
 12003
 12004     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 12005     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12006                                 TO MSTR-CERT-NO.
 12007     MOVE 'MSTR'                 TO FILE-SWITCH.
 12008
 12009
 12010* EXEC CICS HANDLE CONDITION
 12011*        NOTFND   (0450-NOT-FOUND)
 12012*    END-EXEC.
 12013*    MOVE '"$I                   ! 8 #00010868' TO DFHEIV0
 12014     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12016     MOVE X'3820233030303130383638' TO DFHEIV0(25:11)
 12017     CALL 'kxdfhei1' USING DFHEIV0
 12018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12019
 12020
 12021
 12022* EXEC CICS READ
 12023*        DATASET   (PI-CURRENT-FILE)
 12024*        RIDFLD    (ELMSTR-KEY)
 12025*        INTO      (CLAIM-MASTER)
 12026*    END-EXEC.
 12027     MOVE LENGTH OF
 12028      CLAIM-MASTER
 12029       TO DFHEIV11
 12030*    MOVE '&"IL       E          (   #00010872' TO DFHEIV0
 12031     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12033     MOVE X'2020233030303130383732' TO DFHEIV0(25:11)
 12034     CALL 'kxdfhei1' USING DFHEIV0,
 12035           PI-CURRENT-FILE,
 12036           CLAIM-MASTER,
 12037           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 230
* EL150.cbl
 12038           ELMSTR-KEY,
 12039           DFHEIV99,
 12040           DFHEIV99,
 12041           DFHEIV99
 12042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12043
 12044
 12045     GO TO 7000-PICK-UP-LOGIC.
 12046
 12047 7200-EXIT.
 12048     EXIT.
 12049
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 231
* EL150.cbl
 12051 7500-START-BROWSE.
 12052
 12053     IF PI-COMPANY-ID = 'DMD'
 12054             AND
 12055        PI-ASS-PROCESSING
 12056         GO TO 7600-BROWSING-ASS-BWRD.
 12057
 12058     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 12059     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 12060
 12061     IF CLMNOL > 0
 12062         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 12063     IF CARRL > 0
 12064         MOVE CARRI              TO  MSTR-CARRIER.
 12065     IF CERTNOL > 0
 12066         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 12067     IF SUFXL > 0
 12068         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 12069
 12070     IF PI-PREV-CLAIM = LOW-VALUES
 12071         NEXT SENTENCE
 12072     ELSE
 12073         IF CLMNOL  = 0 AND
 12074            CARRL   = 0 AND
 12075            CERTNOL = 0 AND
 12076            SUFXL   = 0
 12077                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 12078
 12079 7500-START-READING.
 12080
 12081
 12082* EXEC CICS HANDLE CONDITION
 12083*        ENDFILE  (8700-END-FILE)
 12084*        NOTFND   (8600-NOT-FOUND)
 12085*    END-EXEC.
 12086*    MOVE '"$''I                  ! 9 #00010914' TO DFHEIV0
 12087     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 12088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12089     MOVE X'3920233030303130393134' TO DFHEIV0(25:11)
 12090     CALL 'kxdfhei1' USING DFHEIV0
 12091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12092
 12093
 12094     MOVE 'MSTR'                 TO  FILE-SWITCH.
 12095
 12096
 12097* EXEC CICS STARTBR
 12098*        DATASET   (PI-CURRENT-FILE)
 12099*        RIDFLD    (ELMSTR-KEY)
 12100*    END-EXEC.
 12101     MOVE 0
 12102       TO DFHEIV11
 12103*    MOVE '&,         G          &   #00010921' TO DFHEIV0
 12104     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12105     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12106     MOVE X'2020233030303130393231' TO DFHEIV0(25:11)
 12107     CALL 'kxdfhei1' USING DFHEIV0,
 12108           PI-CURRENT-FILE,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 232
* EL150.cbl
 12109           ELMSTR-KEY,
 12110           DFHEIV99,
 12111           DFHEIV11,
 12112           DFHEIV99
 12113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12114
 12115
 12116 7500-READ-PREV.
 12117
 12118
 12119* EXEC CICS READPREV
 12120*        DATASET   (PI-CURRENT-FILE)
 12121*        RIDFLD    (ELMSTR-KEY)
 12122*        INTO      (CLAIM-MASTER)
 12123*    END-EXEC.
 12124     MOVE LENGTH OF
 12125      CLAIM-MASTER
 12126       TO DFHEIV12
 12127     MOVE 0
 12128       TO DFHEIV11
 12129*    MOVE '&0IL                  )   #00010928' TO DFHEIV0
 12130     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
 12131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12132     MOVE X'2020233030303130393238' TO DFHEIV0(25:11)
 12133     CALL 'kxdfhei1' USING DFHEIV0,
 12134           PI-CURRENT-FILE,
 12135           CLAIM-MASTER,
 12136           DFHEIV12,
 12137           ELMSTR-KEY,
 12138           DFHEIV99,
 12139           DFHEIV11,
 12140           DFHEIV99,
 12141           DFHEIV99
 12142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12143
 12144
 12145     IF ELMSTR-KEY = PI-PREV-CLAIM
 12146         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 12147         GO TO 7500-READ-PREV.
 12148
 12149     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 12150         GO TO 8700-END-FILE.
 12151
 12152 7500-PICK-UP-LOGIC.
 12153
 12154     IF PI-COMPANY-ID  =  'CRI'
 12155         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 12156             GO TO 8700-END-FILE.
 12157
 12158     IF PI-CARRIER-SECURITY > SPACES
 12159         IF CL-CARRIER = PI-CARRIER-SECURITY
 12160             NEXT SENTENCE
 12161         ELSE
 12162             GO TO 7500-READ-PREV.
 12163
 12164     IF PI-ACCOUNT-SECURITY > SPACES
 12165         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 12166             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 233
* EL150.cbl
 12167         ELSE
 12168             GO TO 7500-READ-PREV.
 12169
 12170     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 234
* EL150.cbl
 12172 7600-BROWSING-ASS-BWRD.
 12173
 12174     COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1.
 12175
 12176     IF PI-ASS-NDX < +1
 12177         IF PI-PF16-LAST
 12178             MOVE PI-ORIGINAL-ASS-CERT
 12179                                 TO ELMSTR-KEY
 12180             MOVE ZEROS          TO PI-DAYS-PAID
 12181                                    PI-TOTAL-PAID
 12182             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 12183                                    PI-LAST-PF-KEY-IND
 12184                                    PI-ASSOCIATED-PROCESS-IND
 12185             GO TO 7500-START-READING
 12186         ELSE
 12187             COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1
 12188             MOVE 'S'            TO PI-LAST-PF-KEY-IND
 12189             MOVE -1             TO ENTERPFL
 12190             MOVE ER-0937        TO EMI-ERROR
 12191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12192             GO TO 8200-SEND-DATAONLY.
 12193
 12194     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 12195     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12196                                 TO MSTR-CERT-NO.
 12197     MOVE 'MSTR'                 TO FILE-SWITCH.
 12198
 12199
 12200* EXEC CICS HANDLE CONDITION
 12201*        NOTFND   (0450-NOT-FOUND)
 12202*    END-EXEC.
 12203*    MOVE '"$I                   ! : #00010988' TO DFHEIV0
 12204     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12206     MOVE X'3A20233030303130393838' TO DFHEIV0(25:11)
 12207     CALL 'kxdfhei1' USING DFHEIV0
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12209
 12210
 12211
 12212* EXEC CICS READ
 12213*        DATASET   (PI-CURRENT-FILE)
 12214*        RIDFLD    (ELMSTR-KEY)
 12215*        INTO      (CLAIM-MASTER)
 12216*    END-EXEC.
 12217     MOVE LENGTH OF
 12218      CLAIM-MASTER
 12219       TO DFHEIV11
 12220*    MOVE '&"IL       E          (   #00010992' TO DFHEIV0
 12221     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12222     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12223     MOVE X'2020233030303130393932' TO DFHEIV0(25:11)
 12224     CALL 'kxdfhei1' USING DFHEIV0,
 12225           PI-CURRENT-FILE,
 12226           CLAIM-MASTER,
 12227           DFHEIV11,
 12228           ELMSTR-KEY,
 12229           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 235
* EL150.cbl
 12230           DFHEIV99,
 12231           DFHEIV99
 12232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12233
 12234
 12235     GO TO 7500-PICK-UP-LOGIC.
 12236
 12237 7600-EXIT.
 12238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 236
* EL150.cbl
 12240 7650-CREATE-ACTQ.
 12241
 12242
 12243* EXEC CICS HANDLE CONDITION
 12244*        NOTFND(7650-CREATE-NEW-ACTQ)
 12245*    END-EXEC.
 12246*    MOVE '"$I                   ! ; #00011005' TO DFHEIV0
 12247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12249     MOVE X'3B20233030303131303035' TO DFHEIV0(25:11)
 12250     CALL 'kxdfhei1' USING DFHEIV0
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12252
 12253
 12254     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
 12255     MOVE PI-CARRIER             TO ACTQ-CARRIER.
 12256     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
 12257     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
 12258
 12259     MOVE 'ACTQ'                 TO FILE-SWITCH.
 12260     MOVE 'ELACTQ  '             TO FILE-ID.
 12261
 12262
 12263* EXEC CICS READ
 12264*        UPDATE
 12265*        DATASET   ('ELACTQ')
 12266*        SET       (ADDRESS OF ACTIVITY-QUE)
 12267*        RIDFLD    (ELACTQ-KEY)
 12268*    END-EXEC.
 12269     MOVE 'ELACTQ' TO DFHEIV1
 12270*    MOVE '&"S        EU         (   #00011017' TO DFHEIV0
 12271     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12272     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12273     MOVE X'2020233030303131303137' TO DFHEIV0(25:11)
 12274     CALL 'kxdfhei1' USING DFHEIV0,
 12275           DFHEIV1,
 12276           DFHEIV20,
 12277           DFHEIV99,
 12278           ELACTQ-KEY,
 12279           DFHEIV99,
 12280           DFHEIV99,
 12281           DFHEIV99
 12282     SET ADDRESS OF ACTIVITY-QUE TO
 12283         DFHEIV20
 12284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12285
 12286
 12287     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 12288
 12289     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 12290
 12291     MOVE 'ELACTQ  '             TO FILE-ID.
 12292
 12293
 12294* EXEC CICS REWRITE
 12295*        DATASET   ('ELACTQ')
 12296*        FROM      (ACTIVITY-QUE)
 12297*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 237
* EL150.cbl
 12298     MOVE LENGTH OF
 12299      ACTIVITY-QUE
 12300       TO DFHEIV11
 12301     MOVE 'ELACTQ' TO DFHEIV1
 12302*    MOVE '&& L                  %   #00011030' TO DFHEIV0
 12303     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12304     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12305     MOVE X'2020233030303131303330' TO DFHEIV0(25:11)
 12306     CALL 'kxdfhei1' USING DFHEIV0,
 12307           DFHEIV1,
 12308           ACTIVITY-QUE,
 12309           DFHEIV11,
 12310           DFHEIV99
 12311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12312
 12313
 12314     GO TO 7650-EXIT.
 12315
 12316 7650-CREATE-NEW-ACTQ.
 12317
 12318
 12319* EXEC CICS GETMAIN
 12320*        SET       (ADDRESS OF ACTIVITY-QUE)
 12321*        LENGTH    (60)
 12322*        INITIMG   (GETMAIN-SPACE)
 12323*    END-EXEC.
 12324     MOVE 60
 12325       TO DFHEIV11
 12326*    MOVE ',"IL                  $   #00011039' TO DFHEIV0
 12327     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12329     MOVE X'2020233030303131303339' TO DFHEIV0(25:11)
 12330     CALL 'kxdfhei1' USING DFHEIV0,
 12331           DFHEIV20,
 12332           DFHEIV11,
 12333           GETMAIN-SPACE
 12334     SET ADDRESS OF ACTIVITY-QUE TO
 12335         DFHEIV20
 12336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12337
 12338
 12339     MOVE 'AQ'                   TO AQ-RECORD-ID.
 12340     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
 12341     MOVE PI-CARRIER             TO AQ-CARRIER.
 12342     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
 12343     MOVE PI-CERT-NO             TO AQ-CERT-NO.
 12344
 12345     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 12346
 12347     MOVE +0                     TO AQ-PAYMENT-COUNTER
 12348                                    AQ-PMT-UNAPPROVED-COUNT.
 12349
 12350     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 12351                                    AQ-FOLLOWUP-DATE.
 12352
 12353     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 12354
 12355     MOVE 'ACTQ'                 TO FILE-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 238
* EL150.cbl
 12356
 12357     MOVE 'ELACTQ  '             TO FILE-ID.
 12358
 12359
 12360* EXEC CICS WRITE
 12361*        DATASET   ('ELACTQ')
 12362*        FROM      (ACTIVITY-QUE)
 12363*        RIDFLD    (AQ-CONTROL-PRIMARY)
 12364*    END-EXEC.
 12365     MOVE LENGTH OF
 12366      ACTIVITY-QUE
 12367       TO DFHEIV11
 12368     MOVE 'ELACTQ' TO DFHEIV1
 12369*    MOVE '&$ L                  ''   #00011065' TO DFHEIV0
 12370     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12372     MOVE X'2020233030303131303635' TO DFHEIV0(25:11)
 12373     CALL 'kxdfhei1' USING DFHEIV0,
 12374           DFHEIV1,
 12375           ACTIVITY-QUE,
 12376           DFHEIV11,
 12377           AQ-CONTROL-PRIMARY,
 12378           DFHEIV99,
 12379           DFHEIV99
 12380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12381
 12382
 12383 7650-EXIT.
 12384     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 239
* EL150.cbl
 12386 7700-CREATE-CLAIM.
 12387
 12388
 12389* EXEC CICS HANDLE CONDITION
 12390*        NOTFND   (7700-RETR-RECORD-NOT-FOUND)
 12391*        DUPREC   (7700-DUPLICATE-CLAIM)
 12392*    END-EXEC.
 12393*    MOVE '"$I%                  ! < #00011076' TO DFHEIV0
 12394     MOVE X'222449252020202020202020' TO DFHEIV0(1:12)
 12395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12396     MOVE X'3C20233030303131303736' TO DFHEIV0(25:11)
 12397     CALL 'kxdfhei1' USING DFHEIV0
 12398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12399
 12400
 12401     IF CLMNOL > 0
 12402         MOVE CLMNOI             TO PI-CLAIM-NO.
 12403
 12404     IF CARRL > 0
 12405         MOVE CARRI              TO PI-CARRIER.
 12406
 12407     IF CERTNOL > 0
 12408         MOVE CERTNOI            TO PI-CERT-PRIME.
 12409
 12410     IF SUFXL > 0
 12411         MOVE SUFXI              TO PI-CERT-SFX.
 12412
 12413     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12414     MOVE PI-CARRIER             TO MSTR-CARRIER.
 12415     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 12416     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 12417     MOVE +1                     TO PI-ASS-NDX.
 12418
 12419 7700-CONT-MOVE.
 12420
 12421     IF PI-ASS-PROCESSING
 12422         MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12423                                 TO MSTR-CERT-NO.
 12424
 12425     MOVE ELMSTR-KEY             TO W-ELRETR-KEY.
 12426
 12427
 12428* EXEC CICS READ
 12429*        DATASET   ('ELRETR')
 12430*        SET       (ADDRESS OF RETRIEVE-MASTER)
 12431*        RIDFLD    (W-ELRETR-KEY)
 12432*    END-EXEC.
 12433     MOVE 'ELRETR' TO DFHEIV1
 12434*    MOVE '&"S        E          (   #00011107' TO DFHEIV0
 12435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12437     MOVE X'2020233030303131313037' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           DFHEIV1,
 12440           DFHEIV20,
 12441           DFHEIV99,
 12442           W-ELRETR-KEY,
 12443           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 240
* EL150.cbl
 12444           DFHEIV99,
 12445           DFHEIV99
 12446     SET ADDRESS OF RETRIEVE-MASTER TO
 12447         DFHEIV20
 12448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12449
 12450
 12451
 12452* EXEC CICS GETMAIN
 12453*        SET       (ADDRESS OF CLAIM-MASTER-L)
 12454*        LENGTH    (350)
 12455*        INITIMG   (GETMAIN-SPACE)
 12456*    END-EXEC.
 12457     MOVE 350
 12458       TO DFHEIV11
 12459*    MOVE ',"IL                  $   #00011113' TO DFHEIV0
 12460     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12462     MOVE X'2020233030303131313133' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           DFHEIV20,
 12465           DFHEIV11,
 12466           GETMAIN-SPACE
 12467     SET ADDRESS OF CLAIM-MASTER-L TO
 12468         DFHEIV20
 12469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12470
 12471
 12472     MOVE RETRIEVE-MASTER        TO CLAIM-MASTER.
 12473     MOVE 'CL'                   TO CL-RECORD-ID.
 12474     MOVE SAVE-BIN-DATE          TO CL-RESTORED-DT.
 12475
 12476
 12477* EXEC CICS WRITE
 12478*        DATASET   ('ELMSTR')
 12479*        FROM      (CLAIM-MASTER)
 12480*        RIDFLD    (CL-CONTROL-PRIMARY)
 12481*    END-EXEC.
 12482     MOVE LENGTH OF
 12483      CLAIM-MASTER
 12484       TO DFHEIV11
 12485     MOVE 'ELMSTR' TO DFHEIV1
 12486*    MOVE '&$ L                  ''   #00011123' TO DFHEIV0
 12487     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12489     MOVE X'2020233030303131313233' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0,
 12491           DFHEIV1,
 12492           CLAIM-MASTER,
 12493           DFHEIV11,
 12494           CL-CONTROL-PRIMARY,
 12495           DFHEIV99,
 12496           DFHEIV99
 12497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12498
 12499
 12500
 12501* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 241
* EL150.cbl
 12502*        FILE      ('ELRETR')
 12503*        RIDFLD    (RL-CONTROL-PRIMARY)
 12504*    END-EXEC.
 12505     MOVE 'ELRETR' TO DFHEIV1
 12506*    MOVE '&(  R                 &   #00011129' TO DFHEIV0
 12507     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12509     MOVE X'2020233030303131313239' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0,
 12511           DFHEIV1,
 12512           RL-CONTROL-PRIMARY,
 12513           DFHEIV99,
 12514           DFHEIV99,
 12515           DFHEIV99
 12516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12517
 12518
 12519     IF PI-ASS-PROCESSING
 12520         ADD +1                  TO PI-ASS-NDX
 12521         IF PI-ASS-NDX < +25
 12522                 AND
 12523            PI-ASS-CERTS (PI-ASS-NDX) > SPACES
 12524             GO TO 7700-CONT-MOVE.
 12525
 12526     MOVE 'MSTR'                 TO FILE-SWITCH.
 12527     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
 12528     MOVE LOW-VALUES             TO PI-RETRIEVED-DATA-IND.
 12529     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 12530     MOVE XCTL-132               TO PGM-NAME.
 12531     GO TO 9300-XCTL.
 12532
 12533 7700-RETR-RECORD-NOT-FOUND.
 12534
 12535     MOVE ER-0929                TO EMI-ERROR.
 12536     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12537     MOVE -1                     TO CLMNOL.
 12538     MOVE PI-CARRIER             TO CARRO.
 12539     MOVE PI-CLAIM-NO            TO CLMNOO.
 12540     MOVE PI-CERT-PRIME          TO CERTNOO.
 12541     MOVE PI-CERT-SFX            TO SUFXO.
 12542     MOVE AL-UABON               TO CLMNOA   CARRA
 12543                                    CERTNOA  SUFXA.
 12544     GO TO 8100-SEND-INITIAL-MAP.
 12545
 12546 7700-DUPLICATE-CLAIM.
 12547
 12548     MOVE ER-0928                TO EMI-ERROR.
 12549     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12550     MOVE -1                     TO CLMNOL.
 12551     MOVE PI-CARRIER             TO CARRO.
 12552     MOVE PI-CLAIM-NO            TO CLMNOO.
 12553     MOVE PI-CERT-PRIME          TO CERTNOO.
 12554     MOVE PI-CERT-SFX            TO SUFXO.
 12555     MOVE AL-UABON               TO CLMNOA   CARRA
 12556                                    CERTNOA  SUFXA.
 12557     GO TO 8100-SEND-INITIAL-MAP.
 12558
 12559 7700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 242
* EL150.cbl
 12560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 243
* EL150.cbl
 12562 8000-LOAD-ERROR-MESSAGES.
 12563     IF EMI-NO-ERRORS
 12564         GO TO 8000-EXIT.
 12565
 12566     IF EMI-NUMBER-OF-LINES = 1
 12567         MOVE EMI-LINE1          TO ERRMSG1O
 12568         GO TO 8000-EXIT.
 12569
 12570     MOVE EMI-LINE1              TO ERRMSG1O.
 12571
 12572 8000-EXIT.
 12573     EXIT.
 12574
 12575 8100-SEND-INITIAL-MAP.
 12576
 12577     MOVE SAVE-DATE              TO RUNDTEO.
 12578     MOVE EIBTIME                TO TIME-IN.
 12579     MOVE TIME-OUT               TO RUNTIMEO.
 12580     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12581     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12582     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12583
 12584     IF PI-USES-PAID-TO
 12585        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12586
 12587     IF PI-RETRIEVED-DATA
 12588         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 12589
 12590     IF PI-COMPANY-ID = 'DMD'
 12591         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12592         MOVE 'LST PMT AMT:'     TO COVERDO
 12593         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12594         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12595
 12596
 12597* EXEC CICS SEND
 12598*        MAP      (MAP-NAME)
 12599*        MAPSET   (MAPSET-NAME)
 12600*        FROM     (EL150AO)
 12601*        ERASE
 12602*        CURSOR
 12603*    END-EXEC.
 12604     MOVE LENGTH OF
 12605      EL150AO
 12606       TO DFHEIV12
 12607     MOVE -1
 12608       TO DFHEIV11
 12609*    MOVE '8$     CT  E    H L F ,   #00011211' TO DFHEIV0
 12610     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12611     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12612     MOVE X'2020233030303131323131' TO DFHEIV0(25:11)
 12613     CALL 'kxdfhei1' USING DFHEIV0,
 12614           MAP-NAME,
 12615           EL150AO,
 12616           DFHEIV12,
 12617           MAPSET-NAME,
 12618           DFHEIV99,
 12619           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 244
* EL150.cbl
 12620           DFHEIV99,
 12621           DFHEIV11,
 12622           DFHEIV99,
 12623           DFHEIV99,
 12624           DFHEIV99
 12625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12626
 12627
 12628     GO TO 9100-RETURN-TRAN.
 12629
 12630 8200-SEND-DATAONLY.
 12631     MOVE SAVE-DATE              TO RUNDTEO.
 12632     MOVE EIBTIME                TO TIME-IN.
 12633     MOVE TIME-OUT               TO RUNTIMEO.
 12634     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12635     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12636     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12637
 12638     MOVE PI-CARRIER             TO CARRO.
 12639     MOVE PI-CLAIM-NO            TO CLMNOO.
 12640     MOVE PI-CERT-PRIME          TO CERTNOO.
 12641     MOVE PI-CERT-SFX            TO SUFXO.
 12642
 12643     IF PI-USES-PAID-TO
 12644        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12645
 12646     IF PI-RETRIEVED-DATA
 12647         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 12648
 12649     IF PI-COMPANY-ID = 'DMD'
 12650         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12651         MOVE 'LST PMT AMT:'     TO COVERDO
 12652         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12653         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12654
 12655
 12656* EXEC CICS SEND
 12657*        MAP      (MAP-NAME)
 12658*        MAPSET   (MAPSET-NAME)
 12659*        FROM     (EL150AO)
 12660*        DATAONLY
 12661*        CURSOR
 12662*    END-EXEC.
 12663     MOVE LENGTH OF
 12664      EL150AO
 12665       TO DFHEIV12
 12666     MOVE -1
 12667       TO DFHEIV11
 12668*    MOVE '8$D    CT       H L F ,   #00011246' TO DFHEIV0
 12669     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 12670     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12671     MOVE X'2020233030303131323436' TO DFHEIV0(25:11)
 12672     CALL 'kxdfhei1' USING DFHEIV0,
 12673           MAP-NAME,
 12674           EL150AO,
 12675           DFHEIV12,
 12676           MAPSET-NAME,
 12677           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 245
* EL150.cbl
 12678           DFHEIV99,
 12679           DFHEIV99,
 12680           DFHEIV11,
 12681           DFHEIV99,
 12682           DFHEIV99,
 12683           DFHEIV99
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12685
 12686
 12687     GO TO 9100-RETURN-TRAN.
 12688
 12689 8250-SEND-WITH-CURSOR.
 12690     MOVE SAVE-DATE              TO RUNDTEO.
 12691     MOVE EIBTIME                TO TIME-IN.
 12692     MOVE TIME-OUT               TO RUNTIMEO.
 12693     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12694     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12695     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12696
 12697     IF PI-USES-PAID-TO
 12698        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12699
 12700     IF PI-COMPANY-ID = 'DMD'
 12701         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12702         MOVE 'LST PMT AMT:'     TO COVERDO
 12703         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12704         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12705
 12706
 12707* EXEC CICS SEND
 12708*        MAP      (MAP-NAME)
 12709*        MAPSET   (MAPSET-NAME)
 12710*        FROM     (EL150AO)
 12711*        ERASE
 12712*        CURSOR   (PI-SAVE-CURSOR)
 12713*    END-EXEC.
 12714     MOVE LENGTH OF
 12715      EL150AO
 12716       TO DFHEIV11
 12717*    MOVE '8$     CT  E    H L F ,   #00011273' TO DFHEIV0
 12718     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12719     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12720     MOVE X'2020233030303131323733' TO DFHEIV0(25:11)
 12721     CALL 'kxdfhei1' USING DFHEIV0,
 12722           MAP-NAME,
 12723           EL150AO,
 12724           DFHEIV11,
 12725           MAPSET-NAME,
 12726           DFHEIV99,
 12727           DFHEIV99,
 12728           DFHEIV99,
 12729           PI-SAVE-CURSOR,
 12730           DFHEIV99,
 12731           DFHEIV99,
 12732           DFHEIV99
 12733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12734
 12735
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 246
* EL150.cbl
 12736     GO TO 9100-RETURN-TRAN.
 12737
 12738 8300-SEND-TEXT.
 12739
 12740* EXEC CICS SEND TEXT
 12741*        FROM     (LOGOFF-TEXT)
 12742*        LENGTH   (LOGOFF-LENGTH)
 12743*        ERASE
 12744*        FREEKB
 12745*    END-EXEC.
 12746*    MOVE '8&      T  E F  H   F -   #00011284' TO DFHEIV0
 12747     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 12748     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 12749     MOVE X'2020233030303131323834' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0,
 12751           LOGOFF-TEXT,
 12752           LOGOFF-LENGTH,
 12753           DFHEIV99,
 12754           DFHEIV99,
 12755           DFHEIV99,
 12756           DFHEIV99,
 12757           DFHEIV99,
 12758           DFHEIV99,
 12759           DFHEIV99,
 12760           DFHEIV99,
 12761           DFHEIV99,
 12762           DFHEIV99
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12764
 12765
 12766
 12767* EXEC CICS RETURN
 12768*    END-EXEC.
 12769*    MOVE '.(                    &   #00011291' TO DFHEIV0
 12770     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 12771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12772     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 12773     CALL 'kxdfhei1' USING DFHEIV0,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99,
 12777           DFHEIV99,
 12778           DFHEIV99
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782 8500-FILE-NOTOPEN.
 12783     IF FILE-SWITCH = 'MSTR'
 12784         MOVE ER-0154            TO EMI-ERROR.
 12785
 12786     IF FILE-SWITCH = 'TRLR'
 12787         MOVE ER-0172            TO EMI-ERROR.
 12788
 12789     IF FILE-SWITCH = 'CERT'
 12790         MOVE ER-0169            TO EMI-ERROR.
 12791
 12792     IF FILE-SWITCH = 'CNTL'
 12793         MOVE ER-0042            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 247
* EL150.cbl
 12794
 12795     IF FILE-SWITCH = 'ACTQ'
 12796         MOVE ER-0338            TO EMI-ERROR.
 12797
 12798     IF FILE-SWITCH = 'ACCT'
 12799         MOVE ER-0168            TO EMI-ERROR.
 12800
 12801     IF FILE-SWITCH = 'PLCY'
 12802         MOVE ER-9883            TO EMI-ERROR.
 12803
 12804     IF FILE-SWITCH = 'PLAN'
 12805         MOVE ER-9808            TO EMI-ERROR.
 12806
 12807     IF FILE-SWITCH = 'PROD'
 12808         MOVE ER-9886            TO EMI-ERROR.
 12809
 12810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12811
 12812     IF FILE-SWITCH = 'CERT' AND PI-COMPANY-ID = 'CID'
 12813        GO TO 1050-SHOW-CONTINUE.
 12814
 12815     MOVE -1                     TO FILETOL.
 12816
 12817     IF PASS-SWITCH = 'A'
 12818         GO TO 8100-SEND-INITIAL-MAP
 12819     ELSE
 12820         GO TO 8200-SEND-DATAONLY.
 12821
 12822 8600-NOT-FOUND.
 12823     MOVE AL-UABON               TO CLMNOA    CARRA
 12824                                    CERTNOA   SUFXA.
 12825     MOVE -1                     TO ENTERPFL.
 12826     MOVE ER-0204                TO EMI-ERROR.
 12827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828     GO TO 8200-SEND-DATAONLY.
 12829
 12830 8700-END-FILE.
 12831
 12832     MOVE -1                     TO ENTERPFL.
 12833     MOVE ER-0130                TO EMI-ERROR.
 12834     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12835     GO TO 8200-SEND-DATAONLY.
 12836
 12837 8800-UNAUTHORIZED-ACCESS.
 12838     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 12839     GO TO 8300-SEND-TEXT.
 12840
 12841 8810-PF23.
 12842     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 12843     MOVE XCTL-005               TO PGM-NAME.
 12844     GO TO 9300-XCTL.
 12845
 12846 8900-GET-FREE-LOOK.
 12847     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12848     MOVE SPACES                 TO CNTL-ACCESS.
 12849     MOVE PI-STATE               TO CNTL-ACCESS.
 12850     MOVE '3'                    TO CNTL-REC-TYPE.
 12851     MOVE +0                     TO CNTL-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 248
* EL150.cbl
 12852
 12853
 12854* EXEC CICS READ
 12855*        DATASET   ('ELCNTL')
 12856*        SET       (ADDRESS OF CONTROL-FILE)
 12857*        RIDFLD    (ELCNTL-KEY)
 12858*        RESP      (WS-RESPONSE)
 12859*    END-EXEC.
 12860     MOVE 'ELCNTL' TO DFHEIV1
 12861*    MOVE '&"S        E          (  N#00011365' TO DFHEIV0
 12862     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12864     MOVE X'204E233030303131333635' TO DFHEIV0(25:11)
 12865     CALL 'kxdfhei1' USING DFHEIV0,
 12866           DFHEIV1,
 12867           DFHEIV20,
 12868           DFHEIV99,
 12869           ELCNTL-KEY,
 12870           DFHEIV99,
 12871           DFHEIV99,
 12872           DFHEIV99
 12873     SET ADDRESS OF CONTROL-FILE TO
 12874         DFHEIV20
 12875     MOVE EIBRESP  TO WS-RESPONSE
 12876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12877
 12878
 12879     IF WS-RESP-NOTFND
 12880        MOVE ER-2848             TO EMI-ERROR
 12881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12882        GO TO 8100-SEND-INITIAL-MAP
 12883     ELSE
 12884        MOVE CF-ST-FREE-LOOK-PERIOD
 12885                                 TO CP-FREE-LOOK.
 12886
 12887 8900-EXIT.
 12888     EXIT.
 12889
 12890 9100-RETURN-TRAN.
 12891     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 12892     MOVE '150A'                 TO PI-CURRENT-SCREEN-NO.
 12893
 12894
 12895* EXEC CICS RETURN
 12896*        TRANSID    (TRANS-ID)
 12897*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 12898*        LENGTH     (PI-COMM-LENGTH)
 12899*    END-EXEC.
 12900*    MOVE '.(CT                  &   #00011387' TO DFHEIV0
 12901     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 12902     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12903     MOVE X'2020233030303131333837' TO DFHEIV0(25:11)
 12904     CALL 'kxdfhei1' USING DFHEIV0,
 12905           TRANS-ID,
 12906           PROGRAM-INTERFACE-BLOCK,
 12907           PI-COMM-LENGTH,
 12908           DFHEIV99,
 12909           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 249
* EL150.cbl
 12910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12911
 12912
 12913 9200-RETURN-MAIN-MENU.
 12914     MOVE XCTL-126               TO PGM-NAME.
 12915     GO TO 9300-XCTL.
 12916
 12917 9300-XCTL.
 12918
 12919* EXEC CICS XCTL
 12920*        PROGRAM    (PGM-NAME)
 12921*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 12922*        LENGTH     (PI-COMM-LENGTH)
 12923*    END-EXEC.
 12924*    MOVE '.$C                   $   #00011398' TO DFHEIV0
 12925     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 12926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12927     MOVE X'2020233030303131333938' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0,
 12929           PGM-NAME,
 12930           PROGRAM-INTERFACE-BLOCK,
 12931           PI-COMM-LENGTH
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935 9400-CLEAR.
 12936     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 12937     GO TO 9300-XCTL.
 12938
 12939 9500-PF12.
 12940     MOVE XCTL-010               TO PGM-NAME.
 12941     GO TO 9300-XCTL.
 12942
 12943 9600-PGMID-ERROR.
 12944
 12945* EXEC CICS HANDLE CONDITION
 12946*        PGMIDERR   (8300-SEND-TEXT)
 12947*    END-EXEC.
 12948*    MOVE '"$L                   ! = #00011413' TO DFHEIV0
 12949     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 12950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12951     MOVE X'3D20233030303131343133' TO DFHEIV0(25:11)
 12952     CALL 'kxdfhei1' USING DFHEIV0
 12953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12954
 12955
 12956     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 12957     MOVE ' '                    TO PI-ENTRY-CD-1.
 12958     MOVE XCTL-005               TO PGM-NAME.
 12959     MOVE PGM-NAME               TO LOGOFF-PGM.
 12960     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 12961     GO TO 9300-XCTL.
 12962
 12963 9700-LINK-DATE-CONVERT.
 12964     MOVE LINK-ELDATCV           TO PGM-NAME.
 12965
 12966
 12967* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 250
* EL150.cbl
 12968*        PROGRAM    (PGM-NAME)
 12969*        COMMAREA   (DATE-CONVERSION-DATA)
 12970*        LENGTH     (DC-COMM-LENGTH)
 12971*    END-EXEC.
 12972*    MOVE '."C                   ''   #00011427' TO DFHEIV0
 12973     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12974     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12975     MOVE X'2020233030303131343237' TO DFHEIV0(25:11)
 12976     CALL 'kxdfhei1' USING DFHEIV0,
 12977           PGM-NAME,
 12978           DATE-CONVERSION-DATA,
 12979           DC-COMM-LENGTH,
 12980           DFHEIV99,
 12981           DFHEIV99,
 12982           DFHEIV99
 12983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12984
 12985
 12986 9700-EXIT.
 12987     EXIT.
 12988
 12989 9800-LINK-REM-TERM.
 12990     MOVE LINK-ELRTRM            TO PGM-NAME.
 12991
 12992
 12993* EXEC CICS LINK
 12994*        PROGRAM    (PGM-NAME)
 12995*        COMMAREA   (CALCULATION-PASS-AREA)
 12996*        LENGTH     (CP-COMM-LENGTH)
 12997*    END-EXEC.
 12998*    MOVE '."C                   ''   #00011439' TO DFHEIV0
 12999     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13001     MOVE X'2020233030303131343339' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           PGM-NAME,
 13004           CALCULATION-PASS-AREA,
 13005           CP-COMM-LENGTH,
 13006           DFHEIV99,
 13007           DFHEIV99,
 13008           DFHEIV99
 13009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13010
 13011
 13012 9800-EXIT.
 13013     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 251
* EL150.cbl
 13015 9830-DMD-REMAINING-TERM.
 13016
 13017     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 13018         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 13019
 13020     MOVE W-PAID-MONTHS          TO W-PYMTS.
 13021     MOVE W-PAID-DAYS            TO W-ADD-DAYS.
 13022
 13023     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30
 13024                            + CM-PMT-EXTENSION-DAYS.
 13025
 13026     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS
 13027                                - CL-NO-OF-DAYS-PAID.
 13028
 13029     DIVIDE W-REM-TERM-IN-DAYS BY +30
 13030         GIVING W-REM REMAINDER W-REM-DAYS.
 13031
 13032     MOVE W-REM                  TO WST-REM.
 13033
 13034     IF CM-PMT-EXTENSION-DAYS > ZEROS
 13035         MOVE '/'                TO WST-SLASH1
 13036         MOVE CM-PMT-EXTENSION-DAYS TO WST-EXT-DAYS
 13037     ELSE
 13038         MOVE SPACES             TO WST-ORIG-DAYS-GRP.
 13039
 13040     IF W-REM-DAYS > ZEROS
 13041         MOVE '/'                TO WST-SLASH2
 13042         MOVE W-REM-DAYS         TO WST-REM-DAYS
 13043     ELSE
 13044         MOVE SPACES             TO WST-REM-DAYS-GRP.
 13045
 13046 9830-EXIT.
 13047     EXIT.
 13048
 13049 9850-LINK-REM-AMT.
 13050     MOVE 'ELRAMT  '             TO PGM-NAME.
 13051
 13052
 13053* EXEC CICS LINK
 13054*        PROGRAM    (PGM-NAME)
 13055*        COMMAREA   (CALCULATION-PASS-AREA)
 13056*        LENGTH     (CP-COMM-LENGTH)
 13057*    END-EXEC.
 13058*    MOVE '."C                   ''   #00011485' TO DFHEIV0
 13059     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13061     MOVE X'2020233030303131343835' TO DFHEIV0(25:11)
 13062     CALL 'kxdfhei1' USING DFHEIV0,
 13063           PGM-NAME,
 13064           CALCULATION-PASS-AREA,
 13065           CP-COMM-LENGTH,
 13066           DFHEIV99,
 13067           DFHEIV99,
 13068           DFHEIV99
 13069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13070
 13071
 13072 9850-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 252
* EL150.cbl
 13073     EXIT.
 13074
 13075 9900-ERROR-FORMAT.
 13076     IF NOT EMI-ERRORS-COMPLETE
 13077         MOVE LINK-001           TO PGM-NAME
 13078
 13079* EXEC CICS LINK
 13080*            PROGRAM    (PGM-NAME)
 13081*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 13082*            LENGTH     (EMI-COMM-LENGTH)
 13083*        END-EXEC.
 13084*    MOVE '."C                   ''   #00011497' TO DFHEIV0
 13085     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13087     MOVE X'2020233030303131343937' TO DFHEIV0(25:11)
 13088     CALL 'kxdfhei1' USING DFHEIV0,
 13089           PGM-NAME,
 13090           ERROR-MESSAGE-INTERFACE-BLOCK,
 13091           EMI-COMM-LENGTH,
 13092           DFHEIV99,
 13093           DFHEIV99,
 13094           DFHEIV99
 13095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13096
 13097
 13098 9900-EXIT.
 13099     EXIT.
 13100
 13101 9990-ABEND.
 13102     MOVE -1 TO FILETOL.
 13103     MOVE LINK-004 TO PGM-NAME.
 13104
 13105     MOVE DFHEIBLK               TO EMI-LINE1
 13106
 13107* EXEC CICS LINK
 13108*        PROGRAM   (PGM-NAME)
 13109*        COMMAREA  (EMI-LINE1)
 13110*        LENGTH    (72)
 13111*    END-EXEC.
 13112     MOVE 72
 13113       TO DFHEIV11
 13114*    MOVE '."C                   ''   #00011511' TO DFHEIV0
 13115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13117     MOVE X'2020233030303131353131' TO DFHEIV0(25:11)
 13118     CALL 'kxdfhei1' USING DFHEIV0,
 13119           PGM-NAME,
 13120           EMI-LINE1,
 13121           DFHEIV11,
 13122           DFHEIV99,
 13123           DFHEIV99,
 13124           DFHEIV99
 13125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13126
 13127
 13128     MOVE EMI-LINE1              TO ERRMSG1O.
 13129     GO TO 8200-SEND-DATAONLY.
 13130
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 253
* EL150.cbl
 13132 9995-SECURITY-VIOLATION.
 13133*                            COPY ELCSCTP.
 13134******************************************************************
 13135*                                                                *
 13136*                            ELCSCTP                             *
 13137*                            VMOD=2.001                          *
 13138*                                                                *
 13139*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13140******************************************************************
 13141
 13142
 13143     MOVE EIBDATE          TO SM-JUL-DATE.
 13144     MOVE EIBTRMID         TO SM-TERMID.
 13145     MOVE THIS-PGM         TO SM-PGM.
 13146     MOVE EIBTIME          TO TIME-IN.
 13147     MOVE TIME-OUT         TO SM-TIME.
 13148     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13149
 13150
 13151* EXEC CICS LINK
 13152*         PROGRAM  ('EL003')
 13153*         COMMAREA (SECURITY-MESSAGE)
 13154*         LENGTH   (80)
 13155*    END-EXEC.
 13156     MOVE 'EL003' TO DFHEIV1
 13157     MOVE 80
 13158       TO DFHEIV11
 13159*    MOVE '."C                   ''   #00011539' TO DFHEIV0
 13160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13162     MOVE X'2020233030303131353339' TO DFHEIV0(25:11)
 13163     CALL 'kxdfhei1' USING DFHEIV0,
 13164           DFHEIV1,
 13165           SECURITY-MESSAGE,
 13166           DFHEIV11,
 13167           DFHEIV99,
 13168           DFHEIV99,
 13169           DFHEIV99
 13170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13171
 13172
 13173******************************************************************
 13174
 13175
 13176
 13177 9999-DFHBACK SECTION.
 13178     MOVE '9%                    "   ' TO DFHEIV0
 13179     MOVE 'EL150' TO DFHEIV1
 13180     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13181     GOBACK.
 13182 9999-DFHEXIT.
 13183     IF DFHEIGDJ EQUAL 0001
 13184         NEXT SENTENCE
 13185     ELSE IF DFHEIGDJ EQUAL 2
 13186         GO TO 1000-SHOW-CLAIM,
 13187               0100-FIRST-TIME-IN,
 13188               8500-FILE-NOTOPEN,
 13189               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 254
* EL150.cbl
 13190               9990-ABEND
 13191         DEPENDING ON DFHEIGDI
 13192     ELSE IF DFHEIGDJ EQUAL 3
 13193         GO TO 0450-NOT-FOUND
 13194         DEPENDING ON DFHEIGDI
 13195     ELSE IF DFHEIGDJ EQUAL 4
 13196         GO TO 0360-CREATE-NEW-ACTQ
 13197         DEPENDING ON DFHEIGDI
 13198     ELSE IF DFHEIGDJ EQUAL 5
 13199         GO TO 0385-TERMID-ERROR,
 13200               0390-TRANS-ERROR
 13201         DEPENDING ON DFHEIGDI
 13202     ELSE IF DFHEIGDJ EQUAL 6
 13203         GO TO 0450-NOT-FOUND,
 13204               0440-UPDATE-DONE
 13205         DEPENDING ON DFHEIGDI
 13206     ELSE IF DFHEIGDJ EQUAL 7
 13207         GO TO 0690-QIDERR
 13208         DEPENDING ON DFHEIGDI
 13209     ELSE IF DFHEIGDJ EQUAL 8
 13210         GO TO 1100-SHOW-RECORD-NOT-FOUND
 13211         DEPENDING ON DFHEIGDI
 13212     ELSE IF DFHEIGDJ EQUAL 9
 13213         GO TO 1005-END-BUILD-DIAGNOSIS
 13214         DEPENDING ON DFHEIGDI
 13215     ELSE IF DFHEIGDJ EQUAL 10
 13216         GO TO 1100-SHOW-RECORD-NOT-FOUND
 13217         DEPENDING ON DFHEIGDI
 13218     ELSE IF DFHEIGDJ EQUAL 11
 13219         GO TO 1005-NO-ERACCT,
 13220               1005-NO-ERACCT
 13221         DEPENDING ON DFHEIGDI
 13222     ELSE IF DFHEIGDJ EQUAL 12
 13223         GO TO 1008-NOTFND,
 13224               1008-NOTFND
 13225         DEPENDING ON DFHEIGDI
 13226     ELSE IF DFHEIGDJ EQUAL 13
 13227         GO TO 1009-CONTINUE-BUILD,
 13228               1009-CONTINUE-BUILD
 13229         DEPENDING ON DFHEIGDI
 13230     ELSE IF DFHEIGDJ EQUAL 14
 13231         GO TO 1050-SHOW-CONTINUE,
 13232               1050-SHOW-CONTINUE
 13233         DEPENDING ON DFHEIGDI
 13234     ELSE IF DFHEIGDJ EQUAL 15
 13235         GO TO 1220-NO-CLAIM-RECORD-FND,
 13236               1200-ENDBR
 13237         DEPENDING ON DFHEIGDI
 13238     ELSE IF DFHEIGDJ EQUAL 16
 13239         GO TO 1500-SHOW-RECORD-NOT-FOUND
 13240         DEPENDING ON DFHEIGDI
 13241     ELSE IF DFHEIGDJ EQUAL 17
 13242         GO TO 1500-NO-PLAN-RECORD
 13243         DEPENDING ON DFHEIGDI
 13244     ELSE IF DFHEIGDJ EQUAL 18
 13245         GO TO 1700-ENDBROWSE,
 13246               1700-ENDBROWSE
 13247         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 255
* EL150.cbl
 13248     ELSE IF DFHEIGDJ EQUAL 19
 13249         GO TO 2950-NO-MORE-TRAILERS,
 13250               2950-NO-MORE-TRAILERS
 13251         DEPENDING ON DFHEIGDI
 13252     ELSE IF DFHEIGDJ EQUAL 20
 13253         GO TO 6000-NOT-FOUND
 13254         DEPENDING ON DFHEIGDI
 13255     ELSE IF DFHEIGDJ EQUAL 21
 13256         GO TO 6100-END-RESET,
 13257               6100-END-RESET
 13258         DEPENDING ON DFHEIGDI
 13259     ELSE IF DFHEIGDJ EQUAL 22
 13260         GO TO 6200-EXIT
 13261         DEPENDING ON DFHEIGDI
 13262     ELSE IF DFHEIGDJ EQUAL 23
 13263         GO TO 8700-END-FILE,
 13264               8600-NOT-FOUND
 13265         DEPENDING ON DFHEIGDI
 13266     ELSE IF DFHEIGDJ EQUAL 24
 13267         GO TO 0450-NOT-FOUND
 13268         DEPENDING ON DFHEIGDI
 13269     ELSE IF DFHEIGDJ EQUAL 25
 13270         GO TO 8700-END-FILE,
 13271               8600-NOT-FOUND
 13272         DEPENDING ON DFHEIGDI
 13273     ELSE IF DFHEIGDJ EQUAL 26
 13274         GO TO 0450-NOT-FOUND
 13275         DEPENDING ON DFHEIGDI
 13276     ELSE IF DFHEIGDJ EQUAL 27
 13277         GO TO 7650-CREATE-NEW-ACTQ
 13278         DEPENDING ON DFHEIGDI
 13279     ELSE IF DFHEIGDJ EQUAL 28
 13280         GO TO 7700-RETR-RECORD-NOT-FOUND,
 13281               7700-DUPLICATE-CLAIM
 13282         DEPENDING ON DFHEIGDI
 13283     ELSE IF DFHEIGDJ EQUAL 29
 13284         GO TO 8300-SEND-TEXT
 13285         DEPENDING ON DFHEIGDI.
 13286     MOVE '9%                    "   ' TO DFHEIV0
 13287     MOVE 'EL150' TO DFHEIV1
 13288     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13289     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       12332     Code:       38070
