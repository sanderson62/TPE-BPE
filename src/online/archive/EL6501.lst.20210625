* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    60* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    61* 102717  CR2017062000003  PEMA  Add comm cap edits
    62******************************************************************
    63
    64 ENVIRONMENT DIVISION.
    65 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   3
* EL6501.cbl
    67 WORKING-STORAGE SECTION.
    68 01  DFH-START PIC X(04).
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER  PIC X(32)  VALUE '********************************'.
    73 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    74 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    75 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    76     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    77 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    78     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    79 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    80 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    81 01  WS-DEGUG-AREA.
    82     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    83     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    84     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    85     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    86     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    87     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    88     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    89     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    90 01  S1                          PIC S999   VALUE +0    COMP.
    91 01  WS-WORK-FIELD.
    92     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    93 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    94 01  WS-DATE-AREA.
    95     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    96     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    97
    98***DMD CUSTOM CODE *****START
    99     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
   100     12  WS-DMD-AGENT            PIC X(10).
   101     12  WS-YYYYMMDD             PIC X(8).
   102     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   103                                 PIC 9(8).
   104***DMD CUSTOM CODE *****END
   105
   106 01  WS-ACCOUNT-NUM-AREA.
   107     12  WS-ACCOUNT-FILLER       PIC X(06).
   108     12  WS-ACCT-BRANCH-CD       PIC X(04).
   109
   110 01  WS-NAME-AREA.
   111     12  WS-NAME-1-4             PIC X(04).
   112     12  WS-NAME-FILLER          PIC X(26).
   113
   114 01  STANDARD-AREAS.
   115     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   116         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   117     12  WS-RESPONSE             PIC S9(8)   COMP.
   118         88  RESP-NORMAL                  VALUE +00.
   119         88  RESP-NOTFND                  VALUE +13.
   120         88  RESP-DUPREC                  VALUE +14.
   121         88  RESP-DUPKEY                  VALUE +15.
   122         88  RESP-NOTOPEN                 VALUE +19.
   123         88  RESP-ENDFILE                 VALUE +20.
   124
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   4
* EL6501.cbl
   125     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   126     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   127     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   128     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   129     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   130     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   131     12  PGM-NAME                PIC X(8).
   132     12  TIME-IN                 PIC S9(7).
   133     12  TIME-OUT-R REDEFINES TIME-IN.
   134         16  FILLER              PIC X.
   135         16  TIME-OUT            PIC 99V99.
   136         16  FILLER              PIC XX.
   137     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   138     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   139     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   140     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   141     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   142     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   143     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   144     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   145     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   146     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   147     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   148     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   149     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   150     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   151     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   152     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   153     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   154     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   155     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   156     12  FILE-ID                 PIC X(8).
   157     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   158     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   159     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   160     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   161     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   162     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   163     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   164     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   165     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   166     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   167     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   168     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   169     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   170     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   171     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   172     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   173     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   174     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   175     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   176     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   177     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   178*                                copy ERCGXRF.
   179******************************************************************
   180*                                                                *
   181*                                                                *
   182*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   5
* EL6501.cbl
   183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   184*                            VMOD=2.002                          *
   185*                                                                *
   186*   ONLINE CREDIT SYSTEM                                         *
   187*                                                                *
   188*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   189*                                                                *
   190*   FILE TYPE = VSAM,KSDS                                        *
   191*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   192*                                                                *
   193*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   194*       ALTERNATE PATH = NONE                                    *
   195*                                                                *
   196*   LOG = NO                                                     *
   197*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   198*                                                                *
   199******************************************************************
   200
   201 01  AGENT-CROSS-REFERENCE.
   202     12  GX-RECORD-ID                PIC XX.
   203         88  VALID-GX-ID             VALUE 'GX'.
   204
   205     12  GX-CONTROL-PRIMARY.
   206         16  GX-COMPANY-CD           PIC X.
   207         16  GX-CARRIER              PIC X.
   208         16  GX-GROUPING             PIC X(6).
   209         16  GX-AGENT-NO             PIC X(10).
   210
   211     12  GX-MAINT-INFORMATION.
   212         16  GX-LAST-MAINT-DT        PIC XX.
   213         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   214         16  GX-LAST-MAINT-USER      PIC X(4).
   215         16  FILLER                  PIC X(9).
   216
   217     12  FILLER                      PIC X(37).
   218
   219     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   220
   221     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   222                            DEPENDING ON GX-AGENT-POINTER-CNT.
   223         16  GX-AM-CARRIER           PIC X.
   224         16  GX-AM-GROUPING          PIC X(6).
   225         16  GX-AM-STATE             PIC XX.
   226         16  GX-AM-ACCOUNT           PIC X(10).
   227         16  GX-AM-EXPIRATION-DT     PIC XX.
   228         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   229         16  GX-LAST-BILL-DT         PIC XX.
   230         16  GX-AM-EFF-DT            PIC XX.
   231         16  FILLER                  PIC X(4).
   232
   233******************************************************************
   234 01  ERPDEF-KEY-SAVE             PIC X(18).
   235 01  ERPDEF-KEY.
   236     12  ERPDEF-COMPANY-CD       PIC X.
   237     12  ERPDEF-STATE            PIC XX.
   238     12  ERPDEF-PROD-CD          PIC XXX.
   239     12  F                       PIC X(7).
   240     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   6
* EL6501.cbl
   241     12  ERPDEF-BEN-CODE         PIC XX.
   242     12  ERPDEF-EXP-DT           PIC XX.
   243 01  WORK-AREAS-AND-SWITCHES.
   244     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   245     12  filler redefines ws-comp-cd-dis.
   246         16  filler              pic x.
   247         16  ws-comp-cd          pic x.
   248     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   249     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   250     12  WS-ST-COMMISSION-CAPS.
   251         16  WS-ST-COMM-CAP-SL     PIC S9V9(4) COMP-3 VALUE +0.
   252         16  WS-ST-COMM-CAP-JL     PIC S9V9(4) COMP-3 VALUE +0.
   253         16  WS-ST-COMM-CAP-SA     PIC S9V9(4) COMP-3 VALUE +0.
   254         16  WS-ST-COMM-CAP-JA     PIC S9V9(4) COMP-3 VALUE +0.
   255     12  WS-ST-GA-COMMISSION-CAPS.
   256         16  WS-ST-GA-COMM-CAP-SL  PIC S9V9(4) COMP-3 VALUE +0.
   257         16  WS-ST-GA-COMM-CAP-JL  PIC S9V9(4) COMP-3 VALUE +0.
   258         16  WS-ST-GA-COMM-CAP-SA  PIC S9V9(4) COMP-3 VALUE +0.
   259         16  WS-ST-GA-COMM-CAP-JA  PIC S9V9(4) COMP-3 VALUE +0.
   260     12  WS-ST-TOT-COMMISSION-CAPS.
   261         16  WS-ST-TOT-COMM-CAP-SL PIC S9V9(4) COMP-3 VALUE +0.
   262         16  WS-ST-TOT-COMM-CAP-JL PIC S9V9(4) COMP-3 VALUE +0.
   263         16  WS-ST-TOT-COMM-CAP-SA PIC S9V9(4) COMP-3 VALUE +0.
   264         16  WS-ST-TOT-COMM-CAP-JA PIC S9V9(4) COMP-3 VALUE +0.
   265     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   266     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   267         88  WS-EXCLUDE-ACCOUNT              VALUE 'A'.
   268         88  WS-EXCLUDE-GA                   VALUE 'G'.
   269         88  WS-EXCLUDE-BOTH                 VALUE 'B'.
   270
   271     12  COMMISSION-ACCUMS.
   272         16  COMM-SL-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   273         16  COMM-JL-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   274         16  COMM-AH-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   275         16  COMM-SL-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   276         16  COMM-JL-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   277         16  COMM-AH-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   278         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   279         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   280         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   281         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   282
   283     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   284     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   285     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   286     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   287     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   288     12  CURRENT-SAVE            PIC 9(8).
   289     12  BIN-CURRENT-SAVE        PIC XX.
   290     12  CYMD-CURRENT-SAVE       PIC 9(8).
   291     12  SUB                     PIC 99.
   292     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   293     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   294     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   295         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   296
   297     12  WS-EDIT-BEN-CODE        PIC XX.
   298         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   7
* EL6501.cbl
   299                                          '90' THRU '99'.
   300
   301     12  WS-KEY-SAVE.
   302           18  WS-ACCT-CCGSA-KEY.
   303             20  WS-ACCT-CO             PIC X.
   304             20  WS-ACCT-CARRIER        PIC X.
   305             20  WS-ACCT-GROUPING       PIC X(6).
   306             20  WS-ACCT-STATE          PIC XX.
   307             20  WS-ACCT-ACCOUNT        PIC X(10).
   308           18  WS-ACCT-EXP-DT           PIC XX.
   309           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   310
   311     12  DEEDIT-FIELD                   PIC X(15).
   312     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   313     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   314     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   315     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   316     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
   317
   318     12  ELCNTL-KEY.
   319         16  CNTL-COMP-ID        PIC XXX.
   320         16  CNTL-REC-TYPE       PIC X.
   321         16  CNTL-ACCESS.
   322             20  FILLER          PIC X(4).
   323         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   324             20  FILLER          PIC XX.
   325             20  CNTL-BUS-TYPE   PIC XX.
   326         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   327             20  FILLER          PIC XX.
   328             20  CNTL-BEN-TYPE   PIC XX.
   329         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   330
   331     12  REIN-KEY.
   332         16  REIN-COMP-CD        PIC X.
   333         16  REIN-CODE           PIC X.
   334         16  REIN-TABLE          PIC X(3).
   335         16  FILLER              PIC X(3).
   336
   337     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   338     12  COMM-KEY.
   339         16  COMM-COMP-CD        PIC X.
   340         16  COMM-TABLE          PIC XXX.
   341         16  COMM-LF-AH          PIC X.
   342         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   343
   344     12  RQST-KEY.
   345         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   346         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   347
   348     12  RQST3-KEY.
   349         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   350         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   351         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   352         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   353         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   354         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   355         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   356
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   8
* EL6501.cbl
   357     12  SAVE-RQST3-KEY.
   358         16  FILLER              PIC X     VALUE SPACES.
   359         16  FILLER              PIC X     VALUE SPACES.
   360         16  FILLER              PIC X(6)  VALUE SPACES.
   361         16  FILLER              PIC X(10) VALUE SPACES.
   362         16  FILLER              PIC X(10) VALUE SPACES.
   363         16  FILLER              PIC X(12) VALUE SPACES.
   364         16  FILLER              PIC X(6)  VALUE SPACES.
   365
   366     12  COMP-KEY.
   367         16  COMP-COMPANY-CD     PIC X.
   368         16  COMP-CARRIER        PIC X.
   369         16  COMP-GROUPING       PIC X(6).
   370         16  COMP-RESP-NO        PIC X(10).
   371         16  COMP-ACCOUNT        PIC X(10).
   372         16  COMP-TYPE           PIC X.
   373
   374     12  WS-AXRF-KEY.
   375         16  WS-AXRF-COMPANY-CD  PIC X.
   376         16  WS-AXRF-CARRIER     PIC X.
   377         16  WS-AXRF-GROUPING    PIC X(6).
   378         16  WS-AXRF-AGENT-NO    PIC X(10).
   379
   380     12  GX-AM-CONTROL-PRIMARY.
   381         16  GX-AM-COMPANY-CD    PIC X.
   382         16  GX-REST-OF-KEY      PIC X(20).
   383
   384     12  QID.
   385         16  QID-TERM            PIC X(4).
   386         16  FILLER              PIC X(4)    VALUE '6501'.
   387
   388     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   389         88  BROWSE-STARTED         VALUE 'Y'.
   390     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   391         88  FIRST-TIME             VALUE 'Y'.
   392
   393     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   394     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   395     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   396     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   397     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   398     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   399     12  GETMAIN-SW              PIC X       VALUE SPACES.
   400     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   401         88  GETMAIN-ACQUIRED                VALUE 'X'.
   402
   403     12  ER-0000                 PIC X(4)    VALUE '0000'.
   404     12  ER-0002                 PIC X(4)    VALUE '0002'.
   405     12  ER-0004                 PIC X(4)    VALUE '0004'.
   406     12  ER-0008                 PIC X(4)    VALUE '0008'.
   407     12  ER-0023                 PIC X(4)    VALUE '0023'.
   408     12  ER-0029                 PIC X(4)    VALUE '0029'.
   409     12  ER-0033                 PIC X(4)    VALUE '0033'.
   410     12  ER-0144                 PIC X(4)    VALUE '0144'.
   411     12  ER-0070                 PIC X(4)    VALUE '0070'.
   412     12  ER-0250                 PIC X(4)    VALUE '0250'.
   413     12  ER-0348                 PIC X(4)    VALUE '0348'.
   414     12  ER-0454                 PIC X(4)    VALUE '0454'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page   9
* EL6501.cbl
   415     12  ER-0625                 PIC X(4)    VALUE '0625'.
   416     12  ER-0759                 PIC X(4)    VALUE '0759'.
   417     12  ER-0788                 PIC X(4)    VALUE '0788'.
   418     12  ER-0852                 PIC X(4)    VALUE '0852'.
   419     12  ER-0899                 PIC X(4)    VALUE '0899'.
   420     12  ER-1778                 PIC X(4)    VALUE '1778'.
   421     12  ER-1817                 PIC X(4)    VALUE '1817'.
   422     12  ER-1883                 PIC X(4)    VALUE '1883'.
   423     12  ER-1884                 PIC X(4)    VALUE '1884'.
   424     12  ER-1885                 PIC X(4)    VALUE '1885'.
   425     12  ER-1886                 PIC X(4)    VALUE '1886'.
   426     12  ER-1887                 PIC X(4)    VALUE '1887'.
   427     12  ER-1955                 PIC X(4)    VALUE '1955'.
   428     12  ER-1956                 PIC X(4)    VALUE '1956'.
   429     12  ER-1957                 PIC X(4)    VALUE '1957'.
   430     12  ER-1958                 PIC X(4)    VALUE '1958'.
   431     12  ER-1959                 PIC X(4)    VALUE '1959'.
   432     12  ER-1960                 PIC X(4)    VALUE '1960'.
   433     12  ER-1961                 PIC X(4)    VALUE '1961'.
   434     12  ER-1962                 PIC X(4)    VALUE '1962'.
   435     12  ER-1963                 PIC X(4)    VALUE '1963'.
   436     12  ER-2045                 PIC X(4)    VALUE '2045'.
   437     12  ER-2071                 PIC X(4)    VALUE '2071'.
   438     12  ER-2131                 PIC X(4)    VALUE '2131'.
   439*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   440     12  ER-2151                 PIC X(4)    VALUE '2151'.
   441     12  ER-2152                 PIC X(4)    VALUE '2152'.
   442     12  ER-2153                 PIC X(4)    VALUE '2153'.
   443     12  ER-2154                 PIC X(4)    VALUE '2154'.
   444     12  ER-2155                 PIC X(4)    VALUE '2155'.
   445     12  ER-2156                 PIC X(4)    VALUE '2156'.
   446     12  ER-2157                 PIC X(4)    VALUE '2157'.
   447     12  ER-2158                 PIC X(4)    VALUE '2158'.
   448     12  ER-2159                 PIC X(4)    VALUE '2159'.
   449     12  ER-2160                 PIC X(4)    VALUE '2160'.
   450     12  ER-2165                 PIC X(4)    VALUE '2165'.
   451     12  ER-2168                 PIC X(4)    VALUE '2168'.
   452     12  ER-2169                 PIC X(4)    VALUE '2169'.
   453     12  ER-2170                 PIC X(4)    VALUE '2170'.
   454     12  ER-2172                 PIC X(4)    VALUE '2172'.
   455     12  ER-2173                 PIC X(4)    VALUE '2173'.
   456     12  ER-2174                 PIC X(4)    VALUE '2174'.
   457     12  ER-2175                 PIC X(4)    VALUE '2175'.
   458     12  ER-2176                 PIC X(4)    VALUE '2176'.
   459     12  ER-2177                 PIC X(4)    VALUE '2177'.
   460     12  ER-2178                 PIC X(4)    VALUE '2178'.
   461     12  ER-2179                 PIC X(4)    VALUE '2179'.
   462     12  ER-2180                 PIC X(4)    VALUE '2180'.
   463     12  ER-2181                 PIC X(4)    VALUE '2181'.
   464     12  ER-2182                 PIC X(4)    VALUE '2182'.
   465     12  ER-2183                 PIC X(4)    VALUE '2183'.
   466     12  ER-2189                 PIC X(4)    VALUE '2189'.
   467     12  ER-2572                 PIC X(4)    VALUE '2572'.
   468     12  ER-2615                 PIC X(4)    VALUE '2615'.
   469     12  ER-2949                 PIC X(4)    VALUE '2949'.
   470     12  ER-2970                 PIC X(4)    VALUE '2970'.
   471     12  ER-3065                 PIC X(4)    VALUE '3065'.
   472     12  ER-3066                 PIC X(4)    VALUE '3066'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  10
* EL6501.cbl
   473     12  ER-4009                 PIC X(4)    VALUE '4009'.
   474     12  ER-4010                 PIC X(4)    VALUE '4010'.
   475     12  ER-4011                 PIC X(4)    VALUE '4011'.
   476     12  ER-4012                 PIC X(4)    VALUE '4012'.
   477     12  ER-7717                 PIC X(4)    VALUE '7717'.
   478     12  er-8156                 pic x(4)    value '8156'.
   479     12  ER-9999                 PIC X(4)    VALUE '9999'.
   480     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   481
   482     12  WSS-LINE-LIAB-LIMITS.
   483         16  WSS-LF-LIMITS.
   484             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   485             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   486             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   487                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   488                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   489                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   490         16  WSS-AH-LIMITS.
   491             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   492             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   493             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   494                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   495                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   496                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   497                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   498
   499     12  WSS-COMM-STRUCTURE.
   500         16  WSS-DEFN-1.
   501             20  WSS-AGT-COMMS.
   502                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   503                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   504                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   505                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   506                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   507                 24  FILLER      PIC X(6)     VALUE SPACES.
   508
   509     12  WS-PHONE.
   510         16  WS-PH1              PIC XXX.
   511         16  WS-PH2              PIC XXX.
   512         16  WS-PH3              PIC XXXX.
   513     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   514
   515     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   516     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   517     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   518     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   519     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   520     12  WS-BUS-TYPE             PIC 99.
   521     12  WS-BUS-ENTRY            PIC 99.
   522     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   523     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   524     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   525     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   526     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   527     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   528     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   529         88  COMMISSION-ERROR    VALUE 1.
   530     12  WS-JTYPEID              PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  11
* EL6501.cbl
   531     12  AGENT-FIND              PIC X        VALUE SPACES.
   532         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   533         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   534         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   535
   536     12  WS-ZIP-CODE.
   537         16  WS-ZIP-1            PIC X.
   538             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   539         16  WS-ZIP-2-3          PIC XX.
   540         16  WS-ZIP-4            PIC X.
   541         16  WS-ZIP-5            PIC X.
   542         16  WS-ZIP-6            PIC X.
   543         16  FILLER              PIC X(4).
   544     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   545         16  WS-ZIP-AM-1-CODE    PIC X(5).
   546         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   547         16  FILLER              PIC X.
   548     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   549         16  WS-ZIP-AM-2-CODE    PIC X(5).
   550         16  WS-ZIP-AM-2-DASH    PIC X.
   551         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   552     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   553         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   554         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   555         16  FILLER              PIC X(4).
   556     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   557         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   558         16  FILLER              PIC X.
   559         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   560         16  FILLER              PIC XXX.
   561     12  WS-SOC-SEC-WORK.
   562         16  WS-SS-TYPE          PIC X.
   563         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  12
* EL6501.cbl
   565*    COPY ELCSCTM.
   566******************************************************************
   567*                                                                *
   568*                                                                *
   569*                            ELCSCTM                             *
   570*                            VMOD=2.001                          *
   571*                                                                *
   572*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   573*                                                                *
   574******************************************************************
   575 01  SECURITY-MESSAGE.
   576     12  FILLER                          PIC X(30)
   577            VALUE '** LOGIC SECURITY VIOLATION -'.
   578     12  SM-READ                         PIC X(6).
   579     12  FILLER                          PIC X(5)
   580            VALUE ' PGM='.
   581     12  SM-PGM                          PIC X(6).
   582     12  FILLER                          PIC X(5)
   583            VALUE ' OPR='.
   584     12  SM-PROCESSOR-ID                 PIC X(4).
   585     12  FILLER                          PIC X(6)
   586            VALUE ' TERM='.
   587     12  SM-TERMID                       PIC X(4).
   588     12  FILLER                          PIC XX   VALUE SPACE.
   589     12  SM-JUL-DATE                     PIC 9(5).
   590     12  FILLER                          PIC X    VALUE SPACE.
   591     12  SM-TIME                         PIC 99.99.
   592
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  13
* EL6501.cbl
   594*    COPY ELCSCRTY.
   595******************************************************************
   596*                                                                *
   597*                                                                *
   598*                            ELCSCRTY                            *
   599*                            VMOD=2.001                          *
   600*                                                                *
   601*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   602*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   603*        SAVED IN PI-SECURITY-ADDRESS.                           *
   604*                                                                *
   605******************************************************************
   606 01  SECURITY-CONTROL.
   607     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   608     12  FILLER                       PIC XX    VALUE 'SC'.
   609     12  SC-CREDIT-CODES.
   610         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   611             20  SC-CREDIT-DISPLAY    PIC X.
   612             20  SC-CREDIT-UPDATE     PIC X.
   613     12  SC-CLAIMS-CODES.
   614         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   615             20  SC-CLAIMS-DISPLAY    PIC X.
   616             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  14
* EL6501.cbl
   618*    COPY ELCLOGOF.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ELCLOGOF.                           *
   623*                            VMOD=2.001                          *
   624*                                                                *
   625*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   626*                                                                *
   627******************************************************************
   628 01  CLASIC-LOGOFF.
   629     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   630     12  LOGOFF-TEXT.
   631         16  FILLER          PIC X(5)    VALUE SPACES.
   632         16  LOGOFF-MSG.
   633             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   634             20  FILLER      PIC X       VALUE SPACES.
   635             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   636         16  FILLER          PIC X(80)
   637           VALUE '* YOU ARE NOW LOGGED OFF'.
   638         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   639         16  FILLER          PIC X       VALUE QUOTE.
   640         16  LOGOFF-SYS-MSG  PIC X(17)
   641           VALUE 'S CLAS-IC SYSTEM '.
   642     12  TEXT-MESSAGES.
   643         16  UNACCESS-MSG    PIC X(29)
   644             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   645         16  PGMIDERR-MSG    PIC X(17)
   646             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  15
* EL6501.cbl
   648*    COPY ELCDATE.
   649******************************************************************
   650*                                                                *
   651*                                                                *
   652*                            ELCDATE.                            *
   653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   654*                            VMOD=2.003
   655*                                                                *
   656*                                                                *
   657*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   658*                 LENGTH = 200                                   *
   659******************************************************************
   660
   661 01  DATE-CONVERSION-DATA.
   662     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   663     12  DC-OPTION-CODE                PIC X.
   664         88  BIN-TO-GREG                VALUE ' '.
   665         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   666         88  EDIT-GREG-TO-BIN           VALUE '2'.
   667         88  YMD-GREG-TO-BIN            VALUE '3'.
   668         88  MDY-GREG-TO-BIN            VALUE '4'.
   669         88  JULIAN-TO-BIN              VALUE '5'.
   670         88  BIN-PLUS-ELAPSED           VALUE '6'.
   671         88  FIND-CENTURY               VALUE '7'.
   672         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   673         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   674         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   675         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   676         88  JULIAN-TO-BIN-3            VALUE 'C'.
   677         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   678         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   679         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   680         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   681         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   682         88  CHECK-LEAP-YEAR            VALUE 'H'.
   683         88  BIN-3-TO-GREG              VALUE 'I'.
   684         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   685         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   686         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   687         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   688         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   689         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   690         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   691         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   692         88  THREE-CHARACTER-BIN
   693                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   694         88  GREGORIAN-TO-BIN
   695                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   696         88  BIN-TO-GREGORIAN
   697                  VALUES ' ' '1' 'I' '8' 'G'.
   698         88  JULIAN-TO-BINARY
   699                  VALUES '5' 'C' 'E' 'F'.
   700     12  DC-ERROR-CODE                 PIC X.
   701         88  NO-CONVERSION-ERROR        VALUE ' '.
   702         88  DATE-CONVERSION-ERROR
   703                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   704         88  DATE-IS-ZERO               VALUE '1'.
   705         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  16
* EL6501.cbl
   706         88  DATE-IS-INVALID            VALUE '3'.
   707         88  DATE1-GREATER-DATE2        VALUE '4'.
   708         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   709         88  DATE-INVALID-OPTION        VALUE '9'.
   710         88  INVALID-CENTURY            VALUE 'A'.
   711         88  ONLY-CENTURY               VALUE 'B'.
   712         88  ONLY-LEAP-YEAR             VALUE 'C'.
   713         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   714     12  DC-END-OF-MONTH               PIC X.
   715         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   716     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   717         88  USE-NORMAL-PROCESS         VALUE ' '.
   718         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   719         88  ADJUST-UP-100-YRS          VALUE '2'.
   720     12  FILLER                        PIC X.
   721     12  DC-CONVERSION-DATES.
   722         16  DC-BIN-DATE-1             PIC XX.
   723         16  DC-BIN-DATE-2             PIC XX.
   724         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   725         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   726                       DC-GREG-DATE-1-EDIT.
   727             20  DC-EDIT1-MONTH        PIC 99.
   728             20  SLASH1-1              PIC X.
   729             20  DC-EDIT1-DAY          PIC 99.
   730             20  SLASH1-2              PIC X.
   731             20  DC-EDIT1-YEAR         PIC 99.
   732         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   733         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   734                     DC-GREG-DATE-2-EDIT.
   735             20  DC-EDIT2-MONTH        PIC 99.
   736             20  SLASH2-1              PIC X.
   737             20  DC-EDIT2-DAY          PIC 99.
   738             20  SLASH2-2              PIC X.
   739             20  DC-EDIT2-YEAR         PIC 99.
   740         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   741         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   742                     DC-GREG-DATE-1-YMD.
   743             20  DC-YMD-YEAR           PIC 99.
   744             20  DC-YMD-MONTH          PIC 99.
   745             20  DC-YMD-DAY            PIC 99.
   746         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   747         16  DC-GREG-DATE-1-MDY-R REDEFINES
   748                      DC-GREG-DATE-1-MDY.
   749             20  DC-MDY-MONTH          PIC 99.
   750             20  DC-MDY-DAY            PIC 99.
   751             20  DC-MDY-YEAR           PIC 99.
   752         16  DC-GREG-DATE-1-ALPHA.
   753             20  DC-ALPHA-MONTH        PIC X(10).
   754             20  DC-ALPHA-DAY          PIC 99.
   755             20  FILLER                PIC XX.
   756             20  DC-ALPHA-CENTURY.
   757                 24 DC-ALPHA-CEN-N     PIC 99.
   758             20  DC-ALPHA-YEAR         PIC 99.
   759         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   760         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   761         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   762         16  DC-JULIAN-DATE            PIC 9(05).
   763         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  17
* EL6501.cbl
   764                                       PIC 9(05).
   765         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   766             20  DC-JULIAN-YEAR        PIC 99.
   767             20  DC-JULIAN-DAYS        PIC 999.
   768         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   769         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   770         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   771     12  DATE-CONVERSION-VARIBLES.
   772         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   773         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   774             20  FILLER                PIC 9(3).
   775             20  HOLD-CEN-1-CCYY.
   776                 24  HOLD-CEN-1-CC     PIC 99.
   777                 24  HOLD-CEN-1-YY     PIC 99.
   778             20  HOLD-CEN-1-MO         PIC 99.
   779             20  HOLD-CEN-1-DA         PIC 99.
   780         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   781             20  HOLD-CEN-1-R-MO       PIC 99.
   782             20  HOLD-CEN-1-R-DA       PIC 99.
   783             20  HOLD-CEN-1-R-CCYY.
   784                 24  HOLD-CEN-1-R-CC   PIC 99.
   785                 24  HOLD-CEN-1-R-YY   PIC 99.
   786             20  FILLER                PIC 9(3).
   787         16  HOLD-CENTURY-1-X.
   788             20  FILLER                PIC X(3)  VALUE SPACES.
   789             20  HOLD-CEN-1-X-CCYY.
   790                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   791                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   792             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   793             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   794         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   795             20  HOLD-CEN-1-R-X-MO     PIC XX.
   796             20  HOLD-CEN-1-R-X-DA     PIC XX.
   797             20  HOLD-CEN-1-R-X-CCYY.
   798                 24  HOLD-CEN-1-R-X-CC PIC XX.
   799                 24  HOLD-CEN-1-R-X-YY PIC XX.
   800             20  FILLER                PIC XXX.
   801         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   802         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   803         16  DC-JULIAN-DATE-1          PIC 9(07).
   804         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   805             20  DC-JULIAN-1-CCYY.
   806                 24  DC-JULIAN-1-CC    PIC 99.
   807                 24  DC-JULIAN-1-YR    PIC 99.
   808             20  DC-JULIAN-DA-1        PIC 999.
   809         16  DC-JULIAN-DATE-2          PIC 9(07).
   810         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   811             20  DC-JULIAN-2-CCYY.
   812                 24  DC-JULIAN-2-CC    PIC 99.
   813                 24  DC-JULIAN-2-YR    PIC 99.
   814             20  DC-JULIAN-DA-2        PIC 999.
   815         16  DC-GREG-DATE-A-EDIT.
   816             20  DC-EDITA-MONTH        PIC 99.
   817             20  SLASHA-1              PIC X VALUE '/'.
   818             20  DC-EDITA-DAY          PIC 99.
   819             20  SLASHA-2              PIC X VALUE '/'.
   820             20  DC-EDITA-CCYY.
   821                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  18
* EL6501.cbl
   822                 24  DC-EDITA-YEAR     PIC 99.
   823         16  DC-GREG-DATE-B-EDIT.
   824             20  DC-EDITB-MONTH        PIC 99.
   825             20  SLASHB-1              PIC X VALUE '/'.
   826             20  DC-EDITB-DAY          PIC 99.
   827             20  SLASHB-2              PIC X VALUE '/'.
   828             20  DC-EDITB-CCYY.
   829                 24  DC-EDITB-CENT     PIC 99.
   830                 24  DC-EDITB-YEAR     PIC 99.
   831         16  DC-GREG-DATE-CYMD         PIC 9(08).
   832         16  DC-GREG-DATE-CYMD-R REDEFINES
   833                              DC-GREG-DATE-CYMD.
   834             20  DC-CYMD-CEN           PIC 99.
   835             20  DC-CYMD-YEAR          PIC 99.
   836             20  DC-CYMD-MONTH         PIC 99.
   837             20  DC-CYMD-DAY           PIC 99.
   838         16  DC-GREG-DATE-MDCY         PIC 9(08).
   839         16  DC-GREG-DATE-MDCY-R REDEFINES
   840                              DC-GREG-DATE-MDCY.
   841             20  DC-MDCY-MONTH         PIC 99.
   842             20  DC-MDCY-DAY           PIC 99.
   843             20  DC-MDCY-CEN           PIC 99.
   844             20  DC-MDCY-YEAR          PIC 99.
   845    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   846        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   847    12  DC-EL310-DATE                  PIC X(21).
   848    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  19
* EL6501.cbl
   850*    COPY ELCATTR.
   851******************************************************************
   852*                                                                *
   853*                            ELCATTR.                            *
   854*                            VMOD=2.001                          *
   855*                                                                *
   856*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   857*                                                                *
   858*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   859*                                                                *
   860*                   POS 1   P=PROTECTED                          *
   861*                           U=UNPROTECTED                        *
   862*                           S=ASKIP                              *
   863*                   POS 2   A=ALPHA/NUMERIC                      *
   864*                           N=NUMERIC                            *
   865*                   POS 3   N=NORMAL                             *
   866*                           B=BRIGHT                             *
   867*                           D=DARK                               *
   868*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   869*                           OF=MODIFIED DATA TAG OFF             *
   870*                                                                *
   871*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   872******************************************************************
   873 01  ATTRIBUTE-LIST.
   874     12  AL-PABOF            PIC X       VALUE 'Y'.
   875     12  AL-PABON            PIC X       VALUE 'Z'.
   876     12  AL-PADOF            PIC X       VALUE '%'.
   877     12  AL-PADON            PIC X       VALUE '_'.
   878     12  AL-PANOF            PIC X       VALUE '-'.
   879     12  AL-PANON            PIC X       VALUE '/'.
   880     12  AL-SABOF            PIC X       VALUE '8'.
   881     12  AL-SABON            PIC X       VALUE '9'.
   882     12  AL-SADOF            PIC X       VALUE '@'.
   883     12  AL-SADON            PIC X       VALUE QUOTE.
   884     12  AL-SANOF            PIC X       VALUE '0'.
   885     12  AL-SANON            PIC X       VALUE '1'.
   886     12  AL-UABOF            PIC X       VALUE 'H'.
   887     12  AL-UABON            PIC X       VALUE 'I'.
   888     12  AL-UADOF            PIC X       VALUE '<'.
   889     12  AL-UADON            PIC X       VALUE '('.
   890     12  AL-UANOF            PIC X       VALUE ' '.
   891     12  AL-UANON            PIC X       VALUE 'A'.
   892     12  AL-UNBOF            PIC X       VALUE 'Q'.
   893     12  AL-UNBON            PIC X       VALUE 'R'.
   894     12  AL-UNDOF            PIC X       VALUE '*'.
   895     12  AL-UNDON            PIC X       VALUE ')'.
   896     12  AL-UNNOF            PIC X       VALUE '&'.
   897     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  20
* EL6501.cbl
   899*    COPY ELCEMIB.
   900******************************************************************
   901*                                                                *
   902*                                                                *
   903*                            ELCEMIB.                            *
   904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   905*                            VMOD=2.005                          *
   906*                                                                *
   907*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   908*                                                                *
   909******************************************************************
   910 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   911     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   912     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   913     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   914     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   915     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   916     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   917     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   918     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   919     12  EMI-SWITCH1             PIC X        VALUE '1'.
   920         88  EMI-NO-ERRORS                    VALUE '1'.
   921         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   922         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   923     12  EMI-SWITCH2             PIC X        VALUE '1'.
   924         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   925     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   926         88  EMI-AREA1-EMPTY                  VALUE '1'.
   927         88  EMI-AREA1-FULL                   VALUE '2'.
   928     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   929         88  EMI-AREA2-EMPTY                  VALUE '1'.
   930         88  EMI-AREA2-FULL                   VALUE '2'.
   931     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   932         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   933         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   934         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   935         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   936         88  EMI-BYPASS-FATALS                VALUE 'X'.
   937     12  EMI-ERROR-LINES.
   938         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   939         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   940         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   941         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   942             20  EMI-ERR-CODES OCCURS 10 TIMES.
   943                 24  EMI-ERR-NUM         PIC X(4).
   944                 24  EMI-FILLER          PIC X.
   945                 24  EMI-SEV             PIC X.
   946                 24  FILLER              PIC X.
   947             20  FILLER                  PIC X(02).
   948     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   949         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   950             20  EMI-ERROR-NUMBER    PIC X(4).
   951             20  EMI-FILL            PIC X.
   952             20  EMI-SEVERITY        PIC X.
   953             20  FILLER              PIC X.
   954             20  EMI-ERROR-TEXT.
   955                 24  EMI-TEXT-VARIABLE   PIC X(10).
   956                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  21
* EL6501.cbl
   957     12  EMI-SEVERITY-SAVE           PIC X.
   958         88  EMI-NOTE                    VALUE 'N'.
   959         88  EMI-WARNING                 VALUE 'W'.
   960         88  EMI-FORCABLE                VALUE 'F'.
   961         88  EMI-FATAL                   VALUE 'X'.
   962     12  EMI-MESSAGE-FLAG            PIC X.
   963         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   964         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   965     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   966     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   967         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   968         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   969         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   970     12  emi-claim-no                pic x(7).
   971     12  emi-claim-type              pic x(6).
   972     12  FILLER                      PIC X(124)  VALUE SPACES.
   973     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   974     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   975     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   976     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  22
* EL6501.cbl
   978*    COPY ELCINTF.
   979******************************************************************
   980*                                                                *
   981*                                                                *
   982*                            ELCINTF.                            *
   983*                            VMOD=2.017                          *
   984*                                                                *
   985*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   986*                                                                *
   987*       LENGTH = 1024                                            *
   988*                                                                *
   989******************************************************************
   990*                   C H A N G E   L O G
   991*
   992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   993*-----------------------------------------------------------------
   994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   995* EFFECTIVE    NUMBER
   996*-----------------------------------------------------------------
   997* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   998******************************************************************
   999 01  PROGRAM-INTERFACE-BLOCK.
  1000     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1001     12  PI-CALLING-PROGRAM              PIC X(8).
  1002     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1003     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1004     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1005     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1006     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1007     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1008     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1009     12  PI-COMPANY-ID                   PIC XXX.
  1010     12  PI-COMPANY-CD                   PIC X.
  1011
  1012     12  PI-COMPANY-PASSWORD             PIC X(8).
  1013
  1014     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1015
  1016     12  PI-CONTROL-IN-PROGRESS.
  1017         16  PI-CARRIER                  PIC X.
  1018         16  PI-GROUPING                 PIC X(6).
  1019         16  PI-STATE                    PIC XX.
  1020         16  PI-ACCOUNT                  PIC X(10).
  1021         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1022                                         PIC X(10).
  1023         16  PI-CLAIM-CERT-GRP.
  1024             20  PI-CLAIM-NO             PIC X(7).
  1025             20  PI-CERT-NO.
  1026                 25  PI-CERT-PRIME       PIC X(10).
  1027                 25  PI-CERT-SFX         PIC X.
  1028             20  PI-CERT-EFF-DT          PIC XX.
  1029         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1030             20  PI-PLAN-CODE            PIC X(2).
  1031             20  PI-REVISION-NUMBER      PIC X(3).
  1032             20  PI-PLAN-EFF-DT          PIC X(2).
  1033             20  PI-PLAN-EXP-DT          PIC X(2).
  1034             20  FILLER                  PIC X(11).
  1035         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  23
* EL6501.cbl
  1036             20  PI-OE-REFERENCE-1.
  1037                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1038                 25  PI-OE-REF-1-SUFF    PIC XX.
  1039
  1040     12  PI-SESSION-IN-PROGRESS          PIC X.
  1041         88  CLAIM-SESSION                   VALUE '1'.
  1042         88  CREDIT-SESSION                  VALUE '2'.
  1043         88  WARRANTY-SESSION                VALUE '3'.
  1044         88  MORTGAGE-SESSION                VALUE '4'.
  1045         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1046
  1047
  1048*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1049
  1050     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1051     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1052
  1053     12  PI-CREDIT-USER                  PIC X.
  1054         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1055         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1056
  1057     12  PI-CLAIM-USER                   PIC X.
  1058         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1059         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1060
  1061     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1062         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1063         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1064         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1065         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1066         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1067
  1068     12  PI-PROCESSOR-ID                 PIC X(4).
  1069
  1070     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1071
  1072     12  PI-MEMBER-CAPTION               PIC X(10).
  1073
  1074     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1075         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1076
  1077     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1078     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1079     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1080     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1081
  1082     12  PI-AH-OVERRIDE-L1               PIC X.
  1083     12  PI-AH-OVERRIDE-L2               PIC XX.
  1084     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1085     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1086
  1087     12  PI-NEW-SYSTEM                   PIC X(2).
  1088
  1089     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1090     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1091         88  PI-USES-PAID-TO                 VALUE '1'.
  1092     12  PI-CRDTCRD-SYSTEM.
  1093         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  24
* EL6501.cbl
  1094             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1095             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1096         16  PI-CC-MONTH-END-DT          PIC XX.
  1097     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1098
  1099     12  PI-OE-REFERENCE-2.
  1100         16  PI-OE-REF-2-PRIME           PIC X(10).
  1101         16  PI-OE-REF-2-SUFF            PIC X.
  1102
  1103     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1104
  1105     12  PI-LANGUAGE-TYPE                PIC X.
  1106             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1107             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1108             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1109
  1110     12  PI-POLICY-LINKAGE-IND           PIC X.
  1111         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1112         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1113                                                   LOW-VALUES.
  1114
  1115     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1116     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1117         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1118         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1119
  1120     12  PI-PROCESSOR-CSR-IND            PIC X.
  1121         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1122         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1123
  1124     12  FILLER                          PIC X(3).
  1125
  1126     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1127
  1128     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1129         PI-SYSTEM-LEVEL.
  1130
  1131         16  PI-ENTRY-CODES.
  1132             20  PI-ENTRY-CD-1           PIC X.
  1133             20  PI-ENTRY-CD-2           PIC X.
  1134
  1135         16  PI-RETURN-CODES.
  1136             20  PI-RETURN-CD-1          PIC X.
  1137             20  PI-RETURN-CD-2          PIC X.
  1138
  1139         16  PI-UPDATE-STATUS-SAVE.
  1140             20  PI-UPDATE-BY            PIC X(4).
  1141             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1142
  1143         16  PI-LOWER-CASE-LETTERS       PIC X.
  1144             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1145
  1146*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1147*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1148*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1149
  1150         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1151             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  25
* EL6501.cbl
  1152             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1153             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1154             88  ACCNT-CNTL                  VALUE '3'.
  1155             88  CARR-ACCNT-CNTL             VALUE '4'.
  1156
  1157         16  PI-PROCESSOR-CAP-LIST.
  1158             20  PI-SYSTEM-CONTROLS.
  1159                24 PI-SYSTEM-DISPLAY     PIC X.
  1160                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1161                24 PI-SYSTEM-MODIFY      PIC X.
  1162                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1163             20  FILLER                  PIC XX.
  1164             20  PI-DISPLAY-CAP          PIC X.
  1165                 88  DISPLAY-CAP             VALUE 'Y'.
  1166             20  PI-MODIFY-CAP           PIC X.
  1167                 88  MODIFY-CAP              VALUE 'Y'.
  1168             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1169                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1170             20  PI-FORCE-CAP            PIC X.
  1171                 88  FORCE-CAP               VALUE 'Y'.
  1172
  1173         16  PI-PROGRAM-CONTROLS.
  1174             20  PI-PGM-PRINT-OPT        PIC X.
  1175             20  PI-PGM-FORMAT-OPT       PIC X.
  1176             20  PI-PGM-PROCESS-OPT      PIC X.
  1177             20  PI-PGM-TOTALS-OPT       PIC X.
  1178
  1179         16  PI-HELP-INTERFACE.
  1180             20  PI-LAST-ERROR-NO        PIC X(4).
  1181             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1182
  1183         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1184             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1185
  1186         16  PI-CR-CONTROL-IN-PROGRESS.
  1187             20  PI-CR-CARRIER           PIC X.
  1188             20  PI-CR-GROUPING          PIC X(6).
  1189             20  PI-CR-STATE             PIC XX.
  1190             20  PI-CR-ACCOUNT           PIC X(10).
  1191             20  PI-CR-FIN-RESP          PIC X(10).
  1192             20  PI-CR-TYPE              PIC X.
  1193
  1194         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1195
  1196         16  PI-CR-MONTH-END-DT          PIC XX.
  1197
  1198         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1199             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1200             88  PI-ZERO-CARRIER             VALUE '1'.
  1201             88  PI-ZERO-GROUPING            VALUE '2'.
  1202             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1203
  1204         16  PI-CARRIER-SECURITY         PIC X.
  1205             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1206
  1207         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1208             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1209             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  26
* EL6501.cbl
  1210
  1211         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1212             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1213                                         INDEXED BY PI-ACCESS-NDX
  1214                                         PIC X.
  1215
  1216         16  PI-GA-BILLING-CONTROL       PIC X.
  1217             88  PI-GA-BILLING               VALUE '1'.
  1218
  1219         16  PI-MAIL-PROCESSING          PIC X.
  1220             88  PI-MAIL-YES                 VALUE 'Y'.
  1221
  1222         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1223
  1224         16  PI-AR-SYSTEM.
  1225             20  PI-AR-PROCESSING-CNTL   PIC X.
  1226                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1227             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1228             20  PI-AR-MONTH-END-DT      PIC XX.
  1229
  1230         16  PI-MP-SYSTEM.
  1231             20  PI-MORTGAGE-USER            PIC X.
  1232                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1233                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1234             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1235                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1236                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1237                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1238                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1239                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1240             20  PI-MP-MONTH-END-DT          PIC XX.
  1241             20  PI-MP-REFERENCE-NO.
  1242                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1243                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1244
  1245         16  PI-LABEL-CONTROL            PIC X(01).
  1246             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1247             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1248
  1249         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1250             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1251
  1252         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1253             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1254             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1255
  1256         16  FILLER                      PIC X(14).
  1257
  1258     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1259******************************************************************
  1260*    COPY ELC650PI.
  1261******************************************************************
  1262*
  1263*                            ELC650PI.
  1264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1265*                            VMOD=2.007
  1266*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1267*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  27
* EL6501.cbl
  1268* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1269*
  1270******************************************************************
  1271******************************************************************
  1272*                   C H A N G E   L O G
  1273*
  1274* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1275*-----------------------------------------------------------------
  1276*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1277* EFFECTIVE    NUMBER
  1278*-----------------------------------------------------------------
  1279* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
  1280
  1281     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1282         16  PI-MAINT                   PIC X.
  1283         16  PI-PREV-ACCOUNT            PIC X(20).
  1284         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1285         16  PI-ACCT-KEY.
  1286             20  PI-ACCT-CCGSA-KEY.
  1287                 24  PI-ACCT-CO             PIC X.
  1288                 24  PI-ACCT-CARRIER        PIC X.
  1289                 24  PI-ACCT-GROUPING       PIC X(6).
  1290                 24  PI-ACCT-STATE          PIC XX.
  1291                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1292             20  PI-ACCT-EXP-DT           PIC XX.
  1293             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1294         16  PI-ACCT-ID                 PIC X(8).
  1295         16  PI-PLAN-KEY.
  1296             20  PI-PLAN-ACCT-KEY.
  1297                 24  PI-PLAN-COMPANY-CD PIC X.
  1298                 24  PI-PLAN-CARRIER    PIC X.
  1299                 24  PI-PLAN-GROUP      PIC X(6).
  1300                 24  PI-PLAN-STATE      PIC X(2).
  1301                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1302             20  PI-PLAN-BEN-TYPE       PIC X.
  1303             20  PI-PLAN-BEN            PIC XX.
  1304             20  PI-PLAN-REVISION       PIC X(3).
  1305         16  PI-WS-STATE                PIC XX.
  1306         16  PI-WS-CLASS                PIC XX.
  1307         16  PI-WS-DEV                  PIC X(3).
  1308         16  PI-WS-TYPE                 PIC X.
  1309         16  PI-WS-PLAN                 PIC XX.
  1310
  1311         16  PI-ERPNDB-ALT-KEY.
  1312             20  PI-PB-COMPANY-CD-A1    PIC X.
  1313             20  PI-PB-CARRIER          PIC X.
  1314             20  PI-PB-GROUPING         PIC X(6).
  1315             20  PI-PB-STATE            PIC XX.
  1316             20  PI-PB-ACCOUNT          PIC X(10).
  1317             20  PI-PB-CERT-EFF-DT      PIC XX.
  1318             20  PI-PB-CERT-NO          PIC X(10).
  1319             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1320             20  PI-PB-RECORD-TYPE      PIC X.
  1321
  1322         16  PI-DATE-RANGE-TABLE.
  1323             20  PI-TABLE-ENT OCCURS 32 TIMES
  1324                            INDEXED BY T-INDEX.
  1325                 24  PI-BIN-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  28
* EL6501.cbl
  1326                 24  PI-BIN-EXP-DT          PIC XX.
  1327                 24  PI-BIN-MAINT-DT        PIC XX.
  1328                 24  PI-BIN-LO-CERT         PIC XX.
  1329                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1330                 24  PI-BIN-HI-CERT         PIC XX.
  1331         16  PI-PAGE-NUMBER             PIC S9.
  1332             88  PI-FST-PAGE               VALUE +1.
  1333             88  PI-2ND-PAGE               VALUE +2.
  1334             88  PI-3RD-PAGE               VALUE +3.
  1335             88  PI-LST-PAGE               VALUE +4.
  1336         16  PI-TOTAL-LINES             PIC S999.
  1337         16  PI-LINE-SELECTED    PIC S9.
  1338***  Y2K PROJ 7744
  1339         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1340         16  BIN-EFFCHG-SAVE     PIC XX.
  1341         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1342***  Y2K PROJ 7744
  1343         16  BIN-EXPCHG-SAVE     PIC XX.
  1344         16  PI-RECORD-ADDED-SW  PIC X.
  1345             88  PI-RECORD-ADDED            VALUE '1'.
  1346             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1347         16  PI-ACCNAME          PIC X(30).
  1348         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1349         16  PI-SV-MAINT         PIC X.
  1350         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1351         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1352         16  PI-UPDATE-SW        PIC X.
  1353             88  PI-CHANGES-MADE             VALUE '1'.
  1354         16  PI-NOTE-TYPE        PIC X.
  1355             88  PI-ACCT-NOTE                VALUE '1'.
  1356         16  PI-DMD-FILE-SW      PIC X.
  1357             88  END-OF-FILE                 VALUE 'E'.
  1358             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1359             88  FIRST-OCCURS                VALUE 'F'.
  1360         16  PI-DMD-OCCURS       PIC S999.
  1361         16  PI-DMD-SCREEN       PIC X.
  1362             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1363             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1364             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1365         16  PI-NAMEFLG          PIC X.
  1366         16  PI-EL650-DEL-SW     PIC X.
  1367         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1368         16  PI-DCC-PROD-CODE    PIC XXX.
  1369         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  29
* EL6501.cbl
  1371
  1372*    COPY ELCJPFX.
  1373******************************************************************
  1374*                                                                *
  1375*                                                                *
  1376*                            ELCJPFX.                            *
  1377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1378*                            VMOD=2.002                          *
  1379*                                                                *
  1380*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1381*                                                                *
  1382*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1383*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1384*        ELCNTL - CONTROL FILE                                   *
  1385*        ELMSTR - CLAIM MASTERS                                  *
  1386*        ELTRLR - ACTIVITY TRAILERS                              *
  1387*        ELCHKQ - CHECK QUE                                      *
  1388******************************************************************
  1389 01  JOURNAL-RECORD.
  1390     12  jp-date                     pic s9(5) comp-3.
  1391     12  jp-time                     pic s9(7) comp-3.
  1392     12  JP-USER-ID                  PIC X(4).
  1393     12  JP-FILE-ID                  PIC X(8).
  1394     12  JP-PROGRAM-ID               PIC X(8).
  1395     12  JP-RECORD-TYPE              PIC X.
  1396         88 JP-ADD              VALUE 'A'.
  1397         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1398         88 JP-AFTER-CHANGE     VALUE 'C'.
  1399         88 JP-DELETE           VALUE 'D'.
  1400         88 JP-GENERIC-DELETE   VALUE 'G'.
  1401         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1402         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1403     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1404     12  JP-RECORD-AREA
  1405
  1406
  1407         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  30
* EL6501.cbl
  1409*    COPY ELCAID.
  1410******************************************************************
  1411*                                                                *
  1412*                            ELCAID.                             *
  1413*                            VMOD=2.001                          *
  1414*                                                                *
  1415*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1416*                                                                *
  1417*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1418*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1419******************************************************************
  1420
  1421 01  DFHAID.
  1422   02  DFHNULL   PIC  X  VALUE  ' '.
  1423   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1424   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1425   02  DFHPEN    PIC  X  VALUE  '='.
  1426   02  DFHOPID   PIC  X  VALUE  'W'.
  1427   02  DFHPA1    PIC  X  VALUE  '%'.
  1428   02  DFHPA2    PIC  X  VALUE  '>'.
  1429   02  DFHPA3    PIC  X  VALUE  ','.
  1430   02  DFHPF1    PIC  X  VALUE  '1'.
  1431   02  DFHPF2    PIC  X  VALUE  '2'.
  1432   02  DFHPF3    PIC  X  VALUE  '3'.
  1433   02  DFHPF4    PIC  X  VALUE  '4'.
  1434   02  DFHPF5    PIC  X  VALUE  '5'.
  1435   02  DFHPF6    PIC  X  VALUE  '6'.
  1436   02  DFHPF7    PIC  X  VALUE  '7'.
  1437   02  DFHPF8    PIC  X  VALUE  '8'.
  1438   02  DFHPF9    PIC  X  VALUE  '9'.
  1439   02  DFHPF10   PIC  X  VALUE  ':'.
  1440   02  DFHPF11   PIC  X  VALUE  '#'.
  1441   02  DFHPF12   PIC  X  VALUE  '@'.
  1442   02  DFHPF13   PIC  X  VALUE  'A'.
  1443   02  DFHPF14   PIC  X  VALUE  'B'.
  1444   02  DFHPF15   PIC  X  VALUE  'C'.
  1445   02  DFHPF16   PIC  X  VALUE  'D'.
  1446   02  DFHPF17   PIC  X  VALUE  'E'.
  1447   02  DFHPF18   PIC  X  VALUE  'F'.
  1448   02  DFHPF19   PIC  X  VALUE  'G'.
  1449   02  DFHPF20   PIC  X  VALUE  'H'.
  1450   02  DFHPF21   PIC  X  VALUE  'I'.
  1451*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1452   02  DFHPF22   PIC  X  VALUE  '['.
  1453   02  DFHPF23   PIC  X  VALUE  '.'.
  1454   02  DFHPF24   PIC  X  VALUE  '<'.
  1455   02  DFHMSRE   PIC  X  VALUE  'X'.
  1456   02  DFHSTRF   PIC  X  VALUE  'h'.
  1457   02  DFHTRIG   PIC  X  VALUE  '"'.
  1458 01  FILLER    REDEFINES DFHAID.
  1459     12  FILLER                  PIC X(8).
  1460     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  31
* EL6501.cbl
  1462*    COPY EL6501S.
  1463 01  EL6501AI.
  1464     05  FILLER            PIC  X(0012).
  1465*    -------------------------------
  1466     05  DATEL PIC S9(0004) COMP.
  1467     05  DATEF PIC  X(0001).
  1468     05  FILLER REDEFINES DATEF.
  1469         10  DATEA PIC  X(0001).
  1470     05  DATEI PIC  X(0008).
  1471*    -------------------------------
  1472     05  TIMEL PIC S9(0004) COMP.
  1473     05  TIMEF PIC  X(0001).
  1474     05  FILLER REDEFINES TIMEF.
  1475         10  TIMEA PIC  X(0001).
  1476     05  TIMEI PIC  X(0005).
  1477*    -------------------------------
  1478     05  CMPNYIDL PIC S9(0004) COMP.
  1479     05  CMPNYIDF PIC  X(0001).
  1480     05  FILLER REDEFINES CMPNYIDF.
  1481         10  CMPNYIDA PIC  X(0001).
  1482     05  CMPNYIDI PIC  X(0003).
  1483*    -------------------------------
  1484     05  USERIDL PIC S9(0004) COMP.
  1485     05  USERIDF PIC  X(0001).
  1486     05  FILLER REDEFINES USERIDF.
  1487         10  USERIDA PIC  X(0001).
  1488     05  USERIDI PIC  X(0004).
  1489*    -------------------------------
  1490     05  MAINTL PIC S9(0004) COMP.
  1491     05  MAINTF PIC  X(0001).
  1492     05  FILLER REDEFINES MAINTF.
  1493         10  MAINTA PIC  X(0001).
  1494     05  MAINTI PIC  X(0001).
  1495*    -------------------------------
  1496     05  CARRL PIC S9(0004) COMP.
  1497     05  CARRF PIC  X(0001).
  1498     05  FILLER REDEFINES CARRF.
  1499         10  CARRA PIC  X(0001).
  1500     05  CARRI PIC  X(0001).
  1501*    -------------------------------
  1502     05  GROUPINL PIC S9(0004) COMP.
  1503     05  GROUPINF PIC  X(0001).
  1504     05  FILLER REDEFINES GROUPINF.
  1505         10  GROUPINA PIC  X(0001).
  1506     05  GROUPINI PIC  X(0006).
  1507*    -------------------------------
  1508     05  STATEL PIC S9(0004) COMP.
  1509     05  STATEF PIC  X(0001).
  1510     05  FILLER REDEFINES STATEF.
  1511         10  STATEA PIC  X(0001).
  1512     05  STATEI PIC  X(0002).
  1513*    -------------------------------
  1514     05  ACCOUNTL PIC S9(0004) COMP.
  1515     05  ACCOUNTF PIC  X(0001).
  1516     05  FILLER REDEFINES ACCOUNTF.
  1517         10  ACCOUNTA PIC  X(0001).
  1518     05  ACCOUNTI PIC  X(0010).
  1519*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  32
* EL6501.cbl
  1520     05  EFFDTEL PIC S9(0004) COMP.
  1521     05  EFFDTEF PIC  X(0001).
  1522     05  FILLER REDEFINES EFFDTEF.
  1523         10  EFFDTEA PIC  X(0001).
  1524     05  EFFDTEI PIC  X(0008).
  1525*    -------------------------------
  1526     05  EXPDTEL PIC S9(0004) COMP.
  1527     05  EXPDTEF PIC  X(0001).
  1528     05  FILLER REDEFINES EXPDTEF.
  1529         10  EXPDTEA PIC  X(0001).
  1530     05  EXPDTEI PIC  X(0008).
  1531*    -------------------------------
  1532     05  MAINTBYL PIC S9(0004) COMP.
  1533     05  MAINTBYF PIC  X(0001).
  1534     05  FILLER REDEFINES MAINTBYF.
  1535         10  MAINTBYA PIC  X(0001).
  1536     05  MAINTBYI PIC  X(0004).
  1537*    -------------------------------
  1538     05  PCONTL PIC S9(0004) COMP.
  1539     05  PCONTF PIC  X(0001).
  1540     05  FILLER REDEFINES PCONTF.
  1541         10  PCONTA PIC  X(0001).
  1542     05  PCONTI PIC  X(0030).
  1543*    -------------------------------
  1544     05  CSRL PIC S9(0004) COMP.
  1545     05  CSRF PIC  X(0001).
  1546     05  FILLER REDEFINES CSRF.
  1547         10  CSRA PIC  X(0001).
  1548     05  CSRI PIC  X(0004).
  1549*    -------------------------------
  1550     05  PDSPLYL PIC S9(0004) COMP.
  1551     05  PDSPLYF PIC  X(0001).
  1552     05  FILLER REDEFINES PDSPLYF.
  1553         10  PDSPLYA PIC  X(0001).
  1554     05  PDSPLYI PIC  X(0006).
  1555*    -------------------------------
  1556     05  PEFFDTEL PIC S9(0004) COMP.
  1557     05  PEFFDTEF PIC  X(0001).
  1558     05  FILLER REDEFINES PEFFDTEF.
  1559         10  PEFFDTEA PIC  X(0001).
  1560     05  PEFFDTEI PIC  X(0008).
  1561*    -------------------------------
  1562     05  PEXPDTEL PIC S9(0004) COMP.
  1563     05  PEXPDTEF PIC  X(0001).
  1564     05  FILLER REDEFINES PEXPDTEF.
  1565         10  PEXPDTEA PIC  X(0001).
  1566     05  PEXPDTEI PIC  X(0008).
  1567*    -------------------------------
  1568     05  NAMEL PIC S9(0004) COMP.
  1569     05  NAMEF PIC  X(0001).
  1570     05  FILLER REDEFINES NAMEF.
  1571         10  NAMEA PIC  X(0001).
  1572     05  NAMEI PIC  X(0030).
  1573*    -------------------------------
  1574     05  TAXNOL PIC S9(0004) COMP.
  1575     05  TAXNOF PIC  X(0001).
  1576     05  FILLER REDEFINES TAXNOF.
  1577         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  33
* EL6501.cbl
  1578     05  TAXNOI PIC  X(0011).
  1579*    -------------------------------
  1580     05  STATUSL PIC S9(0004) COMP.
  1581     05  STATUSF PIC  X(0001).
  1582     05  FILLER REDEFINES STATUSF.
  1583         10  STATUSA PIC  X(0001).
  1584     05  STATUSI PIC  X(0001).
  1585*    -------------------------------
  1586     05  INCAREL PIC S9(0004) COMP.
  1587     05  INCAREF PIC  X(0001).
  1588     05  FILLER REDEFINES INCAREF.
  1589         10  INCAREA PIC  X(0001).
  1590     05  INCAREI PIC  X(0030).
  1591*    -------------------------------
  1592     05  PHONEL PIC S9(0004) COMP.
  1593     05  PHONEF PIC  X(0001).
  1594     05  FILLER REDEFINES PHONEF.
  1595         10  PHONEA PIC  X(0001).
  1596     05  PHONEI PIC  X(0012).
  1597*    -------------------------------
  1598     05  INDGRPL PIC S9(0004) COMP.
  1599     05  INDGRPF PIC  X(0001).
  1600     05  FILLER REDEFINES INDGRPF.
  1601         10  INDGRPA PIC  X(0001).
  1602     05  INDGRPI PIC  X(0001).
  1603*    -------------------------------
  1604     05  ADDR1L PIC S9(0004) COMP.
  1605     05  ADDR1F PIC  X(0001).
  1606     05  FILLER REDEFINES ADDR1F.
  1607         10  ADDR1A PIC  X(0001).
  1608     05  ADDR1I PIC  X(0030).
  1609*    -------------------------------
  1610     05  CONTRL PIC S9(0004) COMP.
  1611     05  CONTRF PIC  X(0001).
  1612     05  FILLER REDEFINES CONTRF.
  1613         10  CONTRA PIC  X(0001).
  1614     05  CONTRI PIC  X(0008).
  1615*    -------------------------------
  1616     05  TYPEL PIC S9(0004) COMP.
  1617     05  TYPEF PIC  X(0001).
  1618     05  FILLER REDEFINES TYPEF.
  1619         10  TYPEA PIC  X(0001).
  1620     05  TYPEI PIC  99.
  1621*    -------------------------------
  1622     05  ACITYL PIC S9(0004) COMP.
  1623     05  ACITYF PIC  X(0001).
  1624     05  FILLER REDEFINES ACITYF.
  1625         10  ACITYA PIC  X(0001).
  1626     05  ACITYI PIC  X(0028).
  1627*    -------------------------------
  1628     05  ASTATEL PIC S9(0004) COMP.
  1629     05  ASTATEF PIC  X(0001).
  1630     05  FILLER REDEFINES ASTATEF.
  1631         10  ASTATEA PIC  X(0001).
  1632     05  ASTATEI PIC  X(0002).
  1633*    -------------------------------
  1634     05  PRODATEL PIC S9(0004) COMP.
  1635     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  34
* EL6501.cbl
  1636     05  FILLER REDEFINES PRODATEF.
  1637         10  PRODATEA PIC  X(0001).
  1638     05  PRODATEI PIC  X(0008).
  1639*    -------------------------------
  1640     05  STDBENL PIC S9(0004) COMP.
  1641     05  STDBENF PIC  X(0001).
  1642     05  FILLER REDEFINES STDBENF.
  1643         10  STDBENA PIC  X(0001).
  1644     05  STDBENI PIC  X(0002).
  1645*    -------------------------------
  1646     05  ZIPL PIC S9(0004) COMP.
  1647     05  ZIPF PIC  X(0001).
  1648     05  FILLER REDEFINES ZIPF.
  1649         10  ZIPA PIC  X(0001).
  1650     05  ZIPI PIC  X(0010).
  1651*    -------------------------------
  1652     05  CTPLABLL PIC S9(0004) COMP.
  1653     05  CTPLABLF PIC  X(0001).
  1654     05  FILLER REDEFINES CTPLABLF.
  1655         10  CTPLABLA PIC  X(0001).
  1656     05  CTPLABLI PIC  X(0010).
  1657*    -------------------------------
  1658     05  CLPTOLPL PIC S9(0004) COMP.
  1659     05  CLPTOLPF PIC  X(0001).
  1660     05  FILLER REDEFINES CLPTOLPF.
  1661         10  CLPTOLPA PIC  X(0001).
  1662     05  CLPTOLPI PIC  S9(02)V9999.
  1663*    -------------------------------
  1664     05  RETROCDL PIC S9(0004) COMP.
  1665     05  RETROCDF PIC  X(0001).
  1666     05  FILLER REDEFINES RETROCDF.
  1667         10  RETROCDA PIC  X(0001).
  1668     05  RETROCDI PIC  X(0003).
  1669*    -------------------------------
  1670     05  BILLCDL PIC S9(0004) COMP.
  1671     05  BILLCDF PIC  X(0001).
  1672     05  FILLER REDEFINES BILLCDF.
  1673         10  BILLCDA PIC  X(0001).
  1674     05  BILLCDI PIC  X(0003).
  1675*    -------------------------------
  1676     05  LCLABLL PIC S9(0004) COMP.
  1677     05  LCLABLF PIC  X(0001).
  1678     05  FILLER REDEFINES LCLABLF.
  1679         10  LCLABLA PIC  X(0001).
  1680     05  LCLABLI PIC  X(0011).
  1681*    -------------------------------
  1682     05  LCOMML PIC S9(0004) COMP.
  1683     05  LCOMMF PIC  X(0001).
  1684     05  FILLER REDEFINES LCOMMF.
  1685         10  LCOMMA PIC  X(0001).
  1686     05  LCOMMI PIC  S9(6)V9(2).
  1687*    -------------------------------
  1688     05  MAXFEEHL PIC S9(0004) COMP.
  1689     05  MAXFEEHF PIC  X(0001).
  1690     05  FILLER REDEFINES MAXFEEHF.
  1691         10  MAXFEEHA PIC  X(0001).
  1692     05  MAXFEEHI PIC  X(0013).
  1693*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  35
* EL6501.cbl
  1694     05  MAXMFEEL PIC S9(0004) COMP.
  1695     05  MAXMFEEF PIC  X(0001).
  1696     05  FILLER REDEFINES MAXMFEEF.
  1697         10  MAXMFEEA PIC  X(0001).
  1698     05  MAXMFEEI PIC  X(0005).
  1699*    -------------------------------
  1700     05  CLPSTHL PIC S9(0004) COMP.
  1701     05  CLPSTHF PIC  X(0001).
  1702     05  FILLER REDEFINES CLPSTHF.
  1703         10  CLPSTHA PIC  X(0001).
  1704     05  CLPSTHI PIC  X(0010).
  1705*    -------------------------------
  1706     05  CLPSTL PIC S9(0004) COMP.
  1707     05  CLPSTF PIC  X(0001).
  1708     05  FILLER REDEFINES CLPSTF.
  1709         10  CLPSTA PIC  X(0001).
  1710     05  CLPSTI PIC  X(0002).
  1711*    -------------------------------
  1712     05  PRODCDHL PIC S9(0004) COMP.
  1713     05  PRODCDHF PIC  X(0001).
  1714     05  FILLER REDEFINES PRODCDHF.
  1715         10  PRODCDHA PIC  X(0001).
  1716     05  PRODCDHI PIC  X(0012).
  1717*    -------------------------------
  1718     05  PRODCDL PIC S9(0004) COMP.
  1719     05  PRODCDF PIC  X(0001).
  1720     05  FILLER REDEFINES PRODCDF.
  1721         10  PRODCDA PIC  X(0001).
  1722     05  PRODCDI PIC  X(0003).
  1723*    -------------------------------
  1724     05  REMITL PIC S9(0004) COMP.
  1725     05  REMITF PIC  X(0001).
  1726     05  FILLER REDEFINES REMITF.
  1727         10  REMITA PIC  X(0001).
  1728     05  REMITI PIC  99.
  1729*    -------------------------------
  1730     05  COMMCALL PIC S9(0004) COMP.
  1731     05  COMMCALF PIC  X(0001).
  1732     05  FILLER REDEFINES COMMCALF.
  1733         10  COMMCALA PIC  X(0001).
  1734     05  COMMCALI PIC  X(0001).
  1735*    -------------------------------
  1736     05  REINTABL PIC S9(0004) COMP.
  1737     05  REINTABF PIC  X(0001).
  1738     05  FILLER REDEFINES REINTABF.
  1739         10  REINTABA PIC  X(0001).
  1740     05  REINTABI PIC  X(0003).
  1741*    -------------------------------
  1742     05  REINCALL PIC S9(0004) COMP.
  1743     05  REINCALF PIC  X(0001).
  1744     05  FILLER REDEFINES REINCALF.
  1745         10  REINCALA PIC  X(0001).
  1746     05  REINCALI PIC  X(0001).
  1747*    -------------------------------
  1748     05  AHHEADL PIC S9(0004) COMP.
  1749     05  AHHEADF PIC  X(0001).
  1750     05  FILLER REDEFINES AHHEADF.
  1751         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  36
* EL6501.cbl
  1752     05  AHHEADI PIC  X(0006).
  1753*    -------------------------------
  1754     05  AGNT1L PIC S9(0004) COMP.
  1755     05  AGNT1F PIC  X(0001).
  1756     05  FILLER REDEFINES AGNT1F.
  1757         10  AGNT1A PIC  X(0001).
  1758     05  AGNT1I PIC  X(0010).
  1759*    -------------------------------
  1760     05  TYPE1L PIC S9(0004) COMP.
  1761     05  TYPE1F PIC  X(0001).
  1762     05  FILLER REDEFINES TYPE1F.
  1763         10  TYPE1A PIC  X(0001).
  1764     05  TYPE1I PIC  X(0001).
  1765*    -------------------------------
  1766     05  SINRT1L PIC S9(0004) COMP.
  1767     05  SINRT1F PIC  X(0001).
  1768     05  FILLER REDEFINES SINRT1F.
  1769         10  SINRT1A PIC  X(0001).
  1770     05  SINRT1I PIC  X(0006).
  1771*    -------------------------------
  1772     05  JNTRT1L PIC S9(0004) COMP.
  1773     05  JNTRT1F PIC  X(0001).
  1774     05  FILLER REDEFINES JNTRT1F.
  1775         10  JNTRT1A PIC  X(0001).
  1776     05  JNTRT1I PIC  X(0006).
  1777*    -------------------------------
  1778     05  AHRT1L PIC S9(0004) COMP.
  1779     05  AHRT1F PIC  X(0001).
  1780     05  FILLER REDEFINES AHRT1F.
  1781         10  AHRT1A PIC  X(0001).
  1782     05  AHRT1I PIC  X(0006).
  1783*    -------------------------------
  1784     05  RECAL1L PIC S9(0004) COMP.
  1785     05  RECAL1F PIC  X(0001).
  1786     05  FILLER REDEFINES RECAL1F.
  1787         10  RECAL1A PIC  X(0001).
  1788     05  RECAL1I PIC  X(0001).
  1789*    -------------------------------
  1790     05  COMM1L PIC S9(0004) COMP.
  1791     05  COMM1F PIC  X(0001).
  1792     05  FILLER REDEFINES COMM1F.
  1793         10  COMM1A PIC  X(0001).
  1794     05  COMM1I PIC  X(0001).
  1795*    -------------------------------
  1796     05  CHGBK1L PIC S9(0004) COMP.
  1797     05  CHGBK1F PIC  X(0001).
  1798     05  FILLER REDEFINES CHGBK1F.
  1799         10  CHGBK1A PIC  X(0001).
  1800     05  CHGBK1I PIC  X(0002).
  1801*    -------------------------------
  1802     05  CCE01L PIC S9(0004) COMP.
  1803     05  CCE01F PIC  X(0001).
  1804     05  FILLER REDEFINES CCE01F.
  1805         10  CCE01A PIC  X(0001).
  1806     05  CCE01I PIC  X(0001).
  1807*    -------------------------------
  1808     05  AGNT2L PIC S9(0004) COMP.
  1809     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  37
* EL6501.cbl
  1810     05  FILLER REDEFINES AGNT2F.
  1811         10  AGNT2A PIC  X(0001).
  1812     05  AGNT2I PIC  X(0010).
  1813*    -------------------------------
  1814     05  TYPE2L PIC S9(0004) COMP.
  1815     05  TYPE2F PIC  X(0001).
  1816     05  FILLER REDEFINES TYPE2F.
  1817         10  TYPE2A PIC  X(0001).
  1818     05  TYPE2I PIC  X(0001).
  1819*    -------------------------------
  1820     05  SINRT2L PIC S9(0004) COMP.
  1821     05  SINRT2F PIC  X(0001).
  1822     05  FILLER REDEFINES SINRT2F.
  1823         10  SINRT2A PIC  X(0001).
  1824     05  SINRT2I PIC  X(0006).
  1825*    -------------------------------
  1826     05  JNTRT2L PIC S9(0004) COMP.
  1827     05  JNTRT2F PIC  X(0001).
  1828     05  FILLER REDEFINES JNTRT2F.
  1829         10  JNTRT2A PIC  X(0001).
  1830     05  JNTRT2I PIC  X(0006).
  1831*    -------------------------------
  1832     05  AHRT2L PIC S9(0004) COMP.
  1833     05  AHRT2F PIC  X(0001).
  1834     05  FILLER REDEFINES AHRT2F.
  1835         10  AHRT2A PIC  X(0001).
  1836     05  AHRT2I PIC  X(0006).
  1837*    -------------------------------
  1838     05  RECAL2L PIC S9(0004) COMP.
  1839     05  RECAL2F PIC  X(0001).
  1840     05  FILLER REDEFINES RECAL2F.
  1841         10  RECAL2A PIC  X(0001).
  1842     05  RECAL2I PIC  X(0001).
  1843*    -------------------------------
  1844     05  COMM2L PIC S9(0004) COMP.
  1845     05  COMM2F PIC  X(0001).
  1846     05  FILLER REDEFINES COMM2F.
  1847         10  COMM2A PIC  X(0001).
  1848     05  COMM2I PIC  X(0001).
  1849*    -------------------------------
  1850     05  CHGBK2L PIC S9(0004) COMP.
  1851     05  CHGBK2F PIC  X(0001).
  1852     05  FILLER REDEFINES CHGBK2F.
  1853         10  CHGBK2A PIC  X(0001).
  1854     05  CHGBK2I PIC  X(0002).
  1855*    -------------------------------
  1856     05  CCE02L PIC S9(0004) COMP.
  1857     05  CCE02F PIC  X(0001).
  1858     05  FILLER REDEFINES CCE02F.
  1859         10  CCE02A PIC  X(0001).
  1860     05  CCE02I PIC  X(0001).
  1861*    -------------------------------
  1862     05  AGNT3L PIC S9(0004) COMP.
  1863     05  AGNT3F PIC  X(0001).
  1864     05  FILLER REDEFINES AGNT3F.
  1865         10  AGNT3A PIC  X(0001).
  1866     05  AGNT3I PIC  X(0010).
  1867*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  38
* EL6501.cbl
  1868     05  TYPE3L PIC S9(0004) COMP.
  1869     05  TYPE3F PIC  X(0001).
  1870     05  FILLER REDEFINES TYPE3F.
  1871         10  TYPE3A PIC  X(0001).
  1872     05  TYPE3I PIC  X(0001).
  1873*    -------------------------------
  1874     05  SINRT3L PIC S9(0004) COMP.
  1875     05  SINRT3F PIC  X(0001).
  1876     05  FILLER REDEFINES SINRT3F.
  1877         10  SINRT3A PIC  X(0001).
  1878     05  SINRT3I PIC  X(0006).
  1879*    -------------------------------
  1880     05  JNTRT3L PIC S9(0004) COMP.
  1881     05  JNTRT3F PIC  X(0001).
  1882     05  FILLER REDEFINES JNTRT3F.
  1883         10  JNTRT3A PIC  X(0001).
  1884     05  JNTRT3I PIC  X(0006).
  1885*    -------------------------------
  1886     05  AHRT3L PIC S9(0004) COMP.
  1887     05  AHRT3F PIC  X(0001).
  1888     05  FILLER REDEFINES AHRT3F.
  1889         10  AHRT3A PIC  X(0001).
  1890     05  AHRT3I PIC  X(0006).
  1891*    -------------------------------
  1892     05  RECAL3L PIC S9(0004) COMP.
  1893     05  RECAL3F PIC  X(0001).
  1894     05  FILLER REDEFINES RECAL3F.
  1895         10  RECAL3A PIC  X(0001).
  1896     05  RECAL3I PIC  X(0001).
  1897*    -------------------------------
  1898     05  COMM3L PIC S9(0004) COMP.
  1899     05  COMM3F PIC  X(0001).
  1900     05  FILLER REDEFINES COMM3F.
  1901         10  COMM3A PIC  X(0001).
  1902     05  COMM3I PIC  X(0001).
  1903*    -------------------------------
  1904     05  CHGBK3L PIC S9(0004) COMP.
  1905     05  CHGBK3F PIC  X(0001).
  1906     05  FILLER REDEFINES CHGBK3F.
  1907         10  CHGBK3A PIC  X(0001).
  1908     05  CHGBK3I PIC  X(0002).
  1909*    -------------------------------
  1910     05  CCE03L PIC S9(0004) COMP.
  1911     05  CCE03F PIC  X(0001).
  1912     05  FILLER REDEFINES CCE03F.
  1913         10  CCE03A PIC  X(0001).
  1914     05  CCE03I PIC  X(0001).
  1915*    -------------------------------
  1916     05  AGNT4L PIC S9(0004) COMP.
  1917     05  AGNT4F PIC  X(0001).
  1918     05  FILLER REDEFINES AGNT4F.
  1919         10  AGNT4A PIC  X(0001).
  1920     05  AGNT4I PIC  X(0010).
  1921*    -------------------------------
  1922     05  TYPE4L PIC S9(0004) COMP.
  1923     05  TYPE4F PIC  X(0001).
  1924     05  FILLER REDEFINES TYPE4F.
  1925         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  39
* EL6501.cbl
  1926     05  TYPE4I PIC  X(0001).
  1927*    -------------------------------
  1928     05  SINRT4L PIC S9(0004) COMP.
  1929     05  SINRT4F PIC  X(0001).
  1930     05  FILLER REDEFINES SINRT4F.
  1931         10  SINRT4A PIC  X(0001).
  1932     05  SINRT4I PIC  X(0006).
  1933*    -------------------------------
  1934     05  JNTRT4L PIC S9(0004) COMP.
  1935     05  JNTRT4F PIC  X(0001).
  1936     05  FILLER REDEFINES JNTRT4F.
  1937         10  JNTRT4A PIC  X(0001).
  1938     05  JNTRT4I PIC  X(0006).
  1939*    -------------------------------
  1940     05  AHRT4L PIC S9(0004) COMP.
  1941     05  AHRT4F PIC  X(0001).
  1942     05  FILLER REDEFINES AHRT4F.
  1943         10  AHRT4A PIC  X(0001).
  1944     05  AHRT4I PIC  X(0006).
  1945*    -------------------------------
  1946     05  RECAL4L PIC S9(0004) COMP.
  1947     05  RECAL4F PIC  X(0001).
  1948     05  FILLER REDEFINES RECAL4F.
  1949         10  RECAL4A PIC  X(0001).
  1950     05  RECAL4I PIC  X(0001).
  1951*    -------------------------------
  1952     05  COMM4L PIC S9(0004) COMP.
  1953     05  COMM4F PIC  X(0001).
  1954     05  FILLER REDEFINES COMM4F.
  1955         10  COMM4A PIC  X(0001).
  1956     05  COMM4I PIC  X(0001).
  1957*    -------------------------------
  1958     05  CHGBK4L PIC S9(0004) COMP.
  1959     05  CHGBK4F PIC  X(0001).
  1960     05  FILLER REDEFINES CHGBK4F.
  1961         10  CHGBK4A PIC  X(0001).
  1962     05  CHGBK4I PIC  X(0002).
  1963*    -------------------------------
  1964     05  CCE04L PIC S9(0004) COMP.
  1965     05  CCE04F PIC  X(0001).
  1966     05  FILLER REDEFINES CCE04F.
  1967         10  CCE04A PIC  X(0001).
  1968     05  CCE04I PIC  X(0001).
  1969*    -------------------------------
  1970     05  AGNT5L PIC S9(0004) COMP.
  1971     05  AGNT5F PIC  X(0001).
  1972     05  FILLER REDEFINES AGNT5F.
  1973         10  AGNT5A PIC  X(0001).
  1974     05  AGNT5I PIC  X(0010).
  1975*    -------------------------------
  1976     05  TYPE5L PIC S9(0004) COMP.
  1977     05  TYPE5F PIC  X(0001).
  1978     05  FILLER REDEFINES TYPE5F.
  1979         10  TYPE5A PIC  X(0001).
  1980     05  TYPE5I PIC  X(0001).
  1981*    -------------------------------
  1982     05  SINRT5L PIC S9(0004) COMP.
  1983     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  40
* EL6501.cbl
  1984     05  FILLER REDEFINES SINRT5F.
  1985         10  SINRT5A PIC  X(0001).
  1986     05  SINRT5I PIC  X(0006).
  1987*    -------------------------------
  1988     05  JNTRT5L PIC S9(0004) COMP.
  1989     05  JNTRT5F PIC  X(0001).
  1990     05  FILLER REDEFINES JNTRT5F.
  1991         10  JNTRT5A PIC  X(0001).
  1992     05  JNTRT5I PIC  X(0006).
  1993*    -------------------------------
  1994     05  AHRT5L PIC S9(0004) COMP.
  1995     05  AHRT5F PIC  X(0001).
  1996     05  FILLER REDEFINES AHRT5F.
  1997         10  AHRT5A PIC  X(0001).
  1998     05  AHRT5I PIC  X(0006).
  1999*    -------------------------------
  2000     05  RECAL5L PIC S9(0004) COMP.
  2001     05  RECAL5F PIC  X(0001).
  2002     05  FILLER REDEFINES RECAL5F.
  2003         10  RECAL5A PIC  X(0001).
  2004     05  RECAL5I PIC  X(0001).
  2005*    -------------------------------
  2006     05  COMM5L PIC S9(0004) COMP.
  2007     05  COMM5F PIC  X(0001).
  2008     05  FILLER REDEFINES COMM5F.
  2009         10  COMM5A PIC  X(0001).
  2010     05  COMM5I PIC  X(0001).
  2011*    -------------------------------
  2012     05  CHGBK5L PIC S9(0004) COMP.
  2013     05  CHGBK5F PIC  X(0001).
  2014     05  FILLER REDEFINES CHGBK5F.
  2015         10  CHGBK5A PIC  X(0001).
  2016     05  CHGBK5I PIC  X(0002).
  2017*    -------------------------------
  2018     05  CCE05L PIC S9(0004) COMP.
  2019     05  CCE05F PIC  X(0001).
  2020     05  FILLER REDEFINES CCE05F.
  2021         10  CCE05A PIC  X(0001).
  2022     05  CCE05I PIC  X(0001).
  2023*    -------------------------------
  2024     05  AGNT6L PIC S9(0004) COMP.
  2025     05  AGNT6F PIC  X(0001).
  2026     05  FILLER REDEFINES AGNT6F.
  2027         10  AGNT6A PIC  X(0001).
  2028     05  AGNT6I PIC  X(0010).
  2029*    -------------------------------
  2030     05  TYPE6L PIC S9(0004) COMP.
  2031     05  TYPE6F PIC  X(0001).
  2032     05  FILLER REDEFINES TYPE6F.
  2033         10  TYPE6A PIC  X(0001).
  2034     05  TYPE6I PIC  X(0001).
  2035*    -------------------------------
  2036     05  SINRT6L PIC S9(0004) COMP.
  2037     05  SINRT6F PIC  X(0001).
  2038     05  FILLER REDEFINES SINRT6F.
  2039         10  SINRT6A PIC  X(0001).
  2040     05  SINRT6I PIC  X(0006).
  2041*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  41
* EL6501.cbl
  2042     05  JNTRT6L PIC S9(0004) COMP.
  2043     05  JNTRT6F PIC  X(0001).
  2044     05  FILLER REDEFINES JNTRT6F.
  2045         10  JNTRT6A PIC  X(0001).
  2046     05  JNTRT6I PIC  X(0006).
  2047*    -------------------------------
  2048     05  AHRT6L PIC S9(0004) COMP.
  2049     05  AHRT6F PIC  X(0001).
  2050     05  FILLER REDEFINES AHRT6F.
  2051         10  AHRT6A PIC  X(0001).
  2052     05  AHRT6I PIC  X(0006).
  2053*    -------------------------------
  2054     05  RECAL6L PIC S9(0004) COMP.
  2055     05  RECAL6F PIC  X(0001).
  2056     05  FILLER REDEFINES RECAL6F.
  2057         10  RECAL6A PIC  X(0001).
  2058     05  RECAL6I PIC  X(0001).
  2059*    -------------------------------
  2060     05  COMM6L PIC S9(0004) COMP.
  2061     05  COMM6F PIC  X(0001).
  2062     05  FILLER REDEFINES COMM6F.
  2063         10  COMM6A PIC  X(0001).
  2064     05  COMM6I PIC  X(0001).
  2065*    -------------------------------
  2066     05  CHGBK6L PIC S9(0004) COMP.
  2067     05  CHGBK6F PIC  X(0001).
  2068     05  FILLER REDEFINES CHGBK6F.
  2069         10  CHGBK6A PIC  X(0001).
  2070     05  CHGBK6I PIC  X(0002).
  2071*    -------------------------------
  2072     05  CCE06L PIC S9(0004) COMP.
  2073     05  CCE06F PIC  X(0001).
  2074     05  FILLER REDEFINES CCE06F.
  2075         10  CCE06A PIC  X(0001).
  2076     05  CCE06I PIC  X(0001).
  2077*    -------------------------------
  2078     05  AGNT7L PIC S9(0004) COMP.
  2079     05  AGNT7F PIC  X(0001).
  2080     05  FILLER REDEFINES AGNT7F.
  2081         10  AGNT7A PIC  X(0001).
  2082     05  AGNT7I PIC  X(0010).
  2083*    -------------------------------
  2084     05  TYPE7L PIC S9(0004) COMP.
  2085     05  TYPE7F PIC  X(0001).
  2086     05  FILLER REDEFINES TYPE7F.
  2087         10  TYPE7A PIC  X(0001).
  2088     05  TYPE7I PIC  X(0001).
  2089*    -------------------------------
  2090     05  SINRT7L PIC S9(0004) COMP.
  2091     05  SINRT7F PIC  X(0001).
  2092     05  FILLER REDEFINES SINRT7F.
  2093         10  SINRT7A PIC  X(0001).
  2094     05  SINRT7I PIC  X(0006).
  2095*    -------------------------------
  2096     05  JNTRT7L PIC S9(0004) COMP.
  2097     05  JNTRT7F PIC  X(0001).
  2098     05  FILLER REDEFINES JNTRT7F.
  2099         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  42
* EL6501.cbl
  2100     05  JNTRT7I PIC  X(0006).
  2101*    -------------------------------
  2102     05  AHRT7L PIC S9(0004) COMP.
  2103     05  AHRT7F PIC  X(0001).
  2104     05  FILLER REDEFINES AHRT7F.
  2105         10  AHRT7A PIC  X(0001).
  2106     05  AHRT7I PIC  X(0006).
  2107*    -------------------------------
  2108     05  RECAL7L PIC S9(0004) COMP.
  2109     05  RECAL7F PIC  X(0001).
  2110     05  FILLER REDEFINES RECAL7F.
  2111         10  RECAL7A PIC  X(0001).
  2112     05  RECAL7I PIC  X(0001).
  2113*    -------------------------------
  2114     05  COMM7L PIC S9(0004) COMP.
  2115     05  COMM7F PIC  X(0001).
  2116     05  FILLER REDEFINES COMM7F.
  2117         10  COMM7A PIC  X(0001).
  2118     05  COMM7I PIC  X(0001).
  2119*    -------------------------------
  2120     05  CHGBK7L PIC S9(0004) COMP.
  2121     05  CHGBK7F PIC  X(0001).
  2122     05  FILLER REDEFINES CHGBK7F.
  2123         10  CHGBK7A PIC  X(0001).
  2124     05  CHGBK7I PIC  X(0002).
  2125*    -------------------------------
  2126     05  CCE07L PIC S9(0004) COMP.
  2127     05  CCE07F PIC  X(0001).
  2128     05  FILLER REDEFINES CCE07F.
  2129         10  CCE07A PIC  X(0001).
  2130     05  CCE07I PIC  X(0001).
  2131*    -------------------------------
  2132     05  AGNT8L PIC S9(0004) COMP.
  2133     05  AGNT8F PIC  X(0001).
  2134     05  FILLER REDEFINES AGNT8F.
  2135         10  AGNT8A PIC  X(0001).
  2136     05  AGNT8I PIC  X(0010).
  2137*    -------------------------------
  2138     05  TYPE8L PIC S9(0004) COMP.
  2139     05  TYPE8F PIC  X(0001).
  2140     05  FILLER REDEFINES TYPE8F.
  2141         10  TYPE8A PIC  X(0001).
  2142     05  TYPE8I PIC  X(0001).
  2143*    -------------------------------
  2144     05  SINRT8L PIC S9(0004) COMP.
  2145     05  SINRT8F PIC  X(0001).
  2146     05  FILLER REDEFINES SINRT8F.
  2147         10  SINRT8A PIC  X(0001).
  2148     05  SINRT8I PIC  X(0006).
  2149*    -------------------------------
  2150     05  JNTRT8L PIC S9(0004) COMP.
  2151     05  JNTRT8F PIC  X(0001).
  2152     05  FILLER REDEFINES JNTRT8F.
  2153         10  JNTRT8A PIC  X(0001).
  2154     05  JNTRT8I PIC  X(0006).
  2155*    -------------------------------
  2156     05  AHRT8L PIC S9(0004) COMP.
  2157     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  43
* EL6501.cbl
  2158     05  FILLER REDEFINES AHRT8F.
  2159         10  AHRT8A PIC  X(0001).
  2160     05  AHRT8I PIC  X(0006).
  2161*    -------------------------------
  2162     05  RECAL8L PIC S9(0004) COMP.
  2163     05  RECAL8F PIC  X(0001).
  2164     05  FILLER REDEFINES RECAL8F.
  2165         10  RECAL8A PIC  X(0001).
  2166     05  RECAL8I PIC  X(0001).
  2167*    -------------------------------
  2168     05  COMM8L PIC S9(0004) COMP.
  2169     05  COMM8F PIC  X(0001).
  2170     05  FILLER REDEFINES COMM8F.
  2171         10  COMM8A PIC  X(0001).
  2172     05  COMM8I PIC  X(0001).
  2173*    -------------------------------
  2174     05  CHGBK8L PIC S9(0004) COMP.
  2175     05  CHGBK8F PIC  X(0001).
  2176     05  FILLER REDEFINES CHGBK8F.
  2177         10  CHGBK8A PIC  X(0001).
  2178     05  CHGBK8I PIC  X(0002).
  2179*    -------------------------------
  2180     05  CCE08L PIC S9(0004) COMP.
  2181     05  CCE08F PIC  X(0001).
  2182     05  FILLER REDEFINES CCE08F.
  2183         10  CCE08A PIC  X(0001).
  2184     05  CCE08I PIC  X(0001).
  2185*    -------------------------------
  2186     05  AGNT9L PIC S9(0004) COMP.
  2187     05  AGNT9F PIC  X(0001).
  2188     05  FILLER REDEFINES AGNT9F.
  2189         10  AGNT9A PIC  X(0001).
  2190     05  AGNT9I PIC  X(0010).
  2191*    -------------------------------
  2192     05  TYPE9L PIC S9(0004) COMP.
  2193     05  TYPE9F PIC  X(0001).
  2194     05  FILLER REDEFINES TYPE9F.
  2195         10  TYPE9A PIC  X(0001).
  2196     05  TYPE9I PIC  X(0001).
  2197*    -------------------------------
  2198     05  SINRT9L PIC S9(0004) COMP.
  2199     05  SINRT9F PIC  X(0001).
  2200     05  FILLER REDEFINES SINRT9F.
  2201         10  SINRT9A PIC  X(0001).
  2202     05  SINRT9I PIC  X(0006).
  2203*    -------------------------------
  2204     05  JNTRT9L PIC S9(0004) COMP.
  2205     05  JNTRT9F PIC  X(0001).
  2206     05  FILLER REDEFINES JNTRT9F.
  2207         10  JNTRT9A PIC  X(0001).
  2208     05  JNTRT9I PIC  X(0006).
  2209*    -------------------------------
  2210     05  AHRT9L PIC S9(0004) COMP.
  2211     05  AHRT9F PIC  X(0001).
  2212     05  FILLER REDEFINES AHRT9F.
  2213         10  AHRT9A PIC  X(0001).
  2214     05  AHRT9I PIC  X(0006).
  2215*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  44
* EL6501.cbl
  2216     05  RECAL9L PIC S9(0004) COMP.
  2217     05  RECAL9F PIC  X(0001).
  2218     05  FILLER REDEFINES RECAL9F.
  2219         10  RECAL9A PIC  X(0001).
  2220     05  RECAL9I PIC  X(0001).
  2221*    -------------------------------
  2222     05  COMM9L PIC S9(0004) COMP.
  2223     05  COMM9F PIC  X(0001).
  2224     05  FILLER REDEFINES COMM9F.
  2225         10  COMM9A PIC  X(0001).
  2226     05  COMM9I PIC  X(0001).
  2227*    -------------------------------
  2228     05  CHGBK9L PIC S9(0004) COMP.
  2229     05  CHGBK9F PIC  X(0001).
  2230     05  FILLER REDEFINES CHGBK9F.
  2231         10  CHGBK9A PIC  X(0001).
  2232     05  CHGBK9I PIC  X(0002).
  2233*    -------------------------------
  2234     05  CCE09L PIC S9(0004) COMP.
  2235     05  CCE09F PIC  X(0001).
  2236     05  FILLER REDEFINES CCE09F.
  2237         10  CCE09A PIC  X(0001).
  2238     05  CCE09I PIC  X(0001).
  2239*    -------------------------------
  2240     05  AGNT10L PIC S9(0004) COMP.
  2241     05  AGNT10F PIC  X(0001).
  2242     05  FILLER REDEFINES AGNT10F.
  2243         10  AGNT10A PIC  X(0001).
  2244     05  AGNT10I PIC  X(0010).
  2245*    -------------------------------
  2246     05  TYPE10L PIC S9(0004) COMP.
  2247     05  TYPE10F PIC  X(0001).
  2248     05  FILLER REDEFINES TYPE10F.
  2249         10  TYPE10A PIC  X(0001).
  2250     05  TYPE10I PIC  X(0001).
  2251*    -------------------------------
  2252     05  SINRT10L PIC S9(0004) COMP.
  2253     05  SINRT10F PIC  X(0001).
  2254     05  FILLER REDEFINES SINRT10F.
  2255         10  SINRT10A PIC  X(0001).
  2256     05  SINRT10I PIC  X(0006).
  2257*    -------------------------------
  2258     05  JNTRT10L PIC S9(0004) COMP.
  2259     05  JNTRT10F PIC  X(0001).
  2260     05  FILLER REDEFINES JNTRT10F.
  2261         10  JNTRT10A PIC  X(0001).
  2262     05  JNTRT10I PIC  X(0006).
  2263*    -------------------------------
  2264     05  AHRT10L PIC S9(0004) COMP.
  2265     05  AHRT10F PIC  X(0001).
  2266     05  FILLER REDEFINES AHRT10F.
  2267         10  AHRT10A PIC  X(0001).
  2268     05  AHRT10I PIC  X(0006).
  2269*    -------------------------------
  2270     05  RECAL10L PIC S9(0004) COMP.
  2271     05  RECAL10F PIC  X(0001).
  2272     05  FILLER REDEFINES RECAL10F.
  2273         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  45
* EL6501.cbl
  2274     05  RECAL10I PIC  X(0001).
  2275*    -------------------------------
  2276     05  COMM10L PIC S9(0004) COMP.
  2277     05  COMM10F PIC  X(0001).
  2278     05  FILLER REDEFINES COMM10F.
  2279         10  COMM10A PIC  X(0001).
  2280     05  COMM10I PIC  X(0001).
  2281*    -------------------------------
  2282     05  CHGBK10L PIC S9(0004) COMP.
  2283     05  CHGBK10F PIC  X(0001).
  2284     05  FILLER REDEFINES CHGBK10F.
  2285         10  CHGBK10A PIC  X(0001).
  2286     05  CHGBK10I PIC  X(0002).
  2287*    -------------------------------
  2288     05  CCE10L PIC S9(0004) COMP.
  2289     05  CCE10F PIC  X(0001).
  2290     05  FILLER REDEFINES CCE10F.
  2291         10  CCE10A PIC  X(0001).
  2292     05  CCE10I PIC  X(0001).
  2293*    -------------------------------
  2294     05  ERRMSG1L PIC S9(0004) COMP.
  2295     05  ERRMSG1F PIC  X(0001).
  2296     05  FILLER REDEFINES ERRMSG1F.
  2297         10  ERRMSG1A PIC  X(0001).
  2298     05  ERRMSG1I PIC  X(0075).
  2299*    -------------------------------
  2300     05  PFENTERL PIC S9(0004) COMP.
  2301     05  PFENTERF PIC  X(0001).
  2302     05  FILLER REDEFINES PFENTERF.
  2303         10  PFENTERA PIC  X(0001).
  2304     05  PFENTERI PIC  9(2).
  2305*    -------------------------------
  2306     05  PF1PF2L PIC S9(0004) COMP.
  2307     05  PF1PF2F PIC  X(0001).
  2308     05  FILLER REDEFINES PF1PF2F.
  2309         10  PF1PF2A PIC  X(0001).
  2310     05  PF1PF2I PIC  X(0035).
  2311 01  EL6501AO REDEFINES EL6501AI.
  2312     05  FILLER            PIC  X(0012).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  DATEO PIC  X(0008).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  TIMEO PIC  99.99.
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  CMPNYIDO PIC  X(0003).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  USERIDO PIC  X(0004).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  MAINTO PIC  X(0001).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  CARRO PIC  X(0001).
  2331*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  46
* EL6501.cbl
  2332     05  FILLER            PIC  X(0003).
  2333     05  GROUPINO PIC  X(0006).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  STATEO PIC  X(0002).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  ACCOUNTO PIC  X(0010).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  EFFDTEO PIC  X(0008).
  2343*    -------------------------------
  2344     05  FILLER            PIC  X(0003).
  2345     05  EXPDTEO PIC  99B99B99.
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  MAINTBYO PIC  X(0004).
  2349*    -------------------------------
  2350     05  FILLER            PIC  X(0003).
  2351     05  PCONTO PIC  X(0030).
  2352*    -------------------------------
  2353     05  FILLER            PIC  X(0003).
  2354     05  CSRO PIC  X(0004).
  2355*    -------------------------------
  2356     05  FILLER            PIC  X(0003).
  2357     05  PDSPLYO PIC  X(0006).
  2358*    -------------------------------
  2359     05  FILLER            PIC  X(0003).
  2360     05  PEFFDTEO PIC  X(0008).
  2361*    -------------------------------
  2362     05  FILLER            PIC  X(0003).
  2363     05  PEXPDTEO PIC  X(0008).
  2364*    -------------------------------
  2365     05  FILLER            PIC  X(0003).
  2366     05  NAMEO PIC  X(0030).
  2367*    -------------------------------
  2368     05  FILLER            PIC  X(0003).
  2369     05  TAXNOO PIC  X(0011).
  2370*    -------------------------------
  2371     05  FILLER            PIC  X(0003).
  2372     05  STATUSO PIC  X(0001).
  2373*    -------------------------------
  2374     05  FILLER            PIC  X(0003).
  2375     05  INCAREO PIC  X(0030).
  2376*    -------------------------------
  2377     05  FILLER            PIC  X(0003).
  2378     05  PHONEO PIC  999B999B9999.
  2379*    -------------------------------
  2380     05  FILLER            PIC  X(0003).
  2381     05  INDGRPO PIC  X(0001).
  2382*    -------------------------------
  2383     05  FILLER            PIC  X(0003).
  2384     05  ADDR1O PIC  X(0030).
  2385*    -------------------------------
  2386     05  FILLER            PIC  X(0003).
  2387     05  CONTRO PIC  X(0008).
  2388*    -------------------------------
  2389     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  47
* EL6501.cbl
  2390     05  TYPEO PIC  X(0002).
  2391*    -------------------------------
  2392     05  FILLER            PIC  X(0003).
  2393     05  ACITYO PIC  X(0028).
  2394*    -------------------------------
  2395     05  FILLER            PIC  X(0003).
  2396     05  ASTATEO PIC  X(0002).
  2397*    -------------------------------
  2398     05  FILLER            PIC  X(0003).
  2399     05  PRODATEO PIC  X(0008).
  2400*    -------------------------------
  2401     05  FILLER            PIC  X(0003).
  2402     05  STDBENO PIC  X(0002).
  2403*    -------------------------------
  2404     05  FILLER            PIC  X(0003).
  2405     05  ZIPO PIC  X(0010).
  2406*    -------------------------------
  2407     05  FILLER            PIC  X(0003).
  2408     05  CTPLABLO PIC  X(0010).
  2409*    -------------------------------
  2410     05  FILLER            PIC  X(0003).
  2411     05  CLPTOLPO PIC  Z.9999.
  2412*    -------------------------------
  2413     05  FILLER            PIC  X(0003).
  2414     05  RETROCDO PIC  X(0003).
  2415*    -------------------------------
  2416     05  FILLER            PIC  X(0003).
  2417     05  BILLCDO PIC  X(0003).
  2418*    -------------------------------
  2419     05  FILLER            PIC  X(0003).
  2420     05  LCLABLO PIC  X(0011).
  2421*    -------------------------------
  2422     05  FILLER            PIC  X(0003).
  2423     05  LCOMMO PIC  ZZ99.99-.
  2424*    -------------------------------
  2425     05  FILLER            PIC  X(0003).
  2426     05  MAXFEEHO PIC  X(0013).
  2427*    -------------------------------
  2428     05  FILLER            PIC  X(0003).
  2429     05  MAXMFEEO PIC  Z,Z99.
  2430*    -------------------------------
  2431     05  FILLER            PIC  X(0003).
  2432     05  CLPSTHO PIC  X(0010).
  2433*    -------------------------------
  2434     05  FILLER            PIC  X(0003).
  2435     05  CLPSTO PIC  X(0002).
  2436*    -------------------------------
  2437     05  FILLER            PIC  X(0003).
  2438     05  PRODCDHO PIC  X(0012).
  2439*    -------------------------------
  2440     05  FILLER            PIC  X(0003).
  2441     05  PRODCDO PIC  X(0003).
  2442*    -------------------------------
  2443     05  FILLER            PIC  X(0003).
  2444     05  REMITO PIC  X(0002).
  2445*    -------------------------------
  2446     05  FILLER            PIC  X(0003).
  2447     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  48
* EL6501.cbl
  2448*    -------------------------------
  2449     05  FILLER            PIC  X(0003).
  2450     05  REINTABO PIC  X(0003).
  2451*    -------------------------------
  2452     05  FILLER            PIC  X(0003).
  2453     05  REINCALO PIC  X(0001).
  2454*    -------------------------------
  2455     05  FILLER            PIC  X(0003).
  2456     05  AHHEADO PIC  X(0006).
  2457*    -------------------------------
  2458     05  FILLER            PIC  X(0003).
  2459     05  AGNT1O PIC  X(0010).
  2460*    -------------------------------
  2461     05  FILLER            PIC  X(0003).
  2462     05  TYPE1O PIC  X(0001).
  2463*    -------------------------------
  2464     05  FILLER            PIC  X(0003).
  2465     05  SINRT1O PIC  X(0006).
  2466*    -------------------------------
  2467     05  FILLER            PIC  X(0003).
  2468     05  JNTRT1O PIC  X(0006).
  2469*    -------------------------------
  2470     05  FILLER            PIC  X(0003).
  2471     05  AHRT1O PIC  X(0006).
  2472*    -------------------------------
  2473     05  FILLER            PIC  X(0003).
  2474     05  RECAL1O PIC  X(0001).
  2475*    -------------------------------
  2476     05  FILLER            PIC  X(0003).
  2477     05  COMM1O PIC  X(0001).
  2478*    -------------------------------
  2479     05  FILLER            PIC  X(0003).
  2480     05  CHGBK1O PIC  X(0002).
  2481*    -------------------------------
  2482     05  FILLER            PIC  X(0003).
  2483     05  CCE01O PIC  X(0001).
  2484*    -------------------------------
  2485     05  FILLER            PIC  X(0003).
  2486     05  AGNT2O PIC  X(0010).
  2487*    -------------------------------
  2488     05  FILLER            PIC  X(0003).
  2489     05  TYPE2O PIC  X(0001).
  2490*    -------------------------------
  2491     05  FILLER            PIC  X(0003).
  2492     05  SINRT2O PIC  X(0006).
  2493*    -------------------------------
  2494     05  FILLER            PIC  X(0003).
  2495     05  JNTRT2O PIC  X(0006).
  2496*    -------------------------------
  2497     05  FILLER            PIC  X(0003).
  2498     05  AHRT2O PIC  X(0006).
  2499*    -------------------------------
  2500     05  FILLER            PIC  X(0003).
  2501     05  RECAL2O PIC  X(0001).
  2502*    -------------------------------
  2503     05  FILLER            PIC  X(0003).
  2504     05  COMM2O PIC  X(0001).
  2505*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  49
* EL6501.cbl
  2506     05  FILLER            PIC  X(0003).
  2507     05  CHGBK2O PIC  X(0002).
  2508*    -------------------------------
  2509     05  FILLER            PIC  X(0003).
  2510     05  CCE02O PIC  X(0001).
  2511*    -------------------------------
  2512     05  FILLER            PIC  X(0003).
  2513     05  AGNT3O PIC  X(0010).
  2514*    -------------------------------
  2515     05  FILLER            PIC  X(0003).
  2516     05  TYPE3O PIC  X(0001).
  2517*    -------------------------------
  2518     05  FILLER            PIC  X(0003).
  2519     05  SINRT3O PIC  X(0006).
  2520*    -------------------------------
  2521     05  FILLER            PIC  X(0003).
  2522     05  JNTRT3O PIC  X(0006).
  2523*    -------------------------------
  2524     05  FILLER            PIC  X(0003).
  2525     05  AHRT3O PIC  X(0006).
  2526*    -------------------------------
  2527     05  FILLER            PIC  X(0003).
  2528     05  RECAL3O PIC  X(0001).
  2529*    -------------------------------
  2530     05  FILLER            PIC  X(0003).
  2531     05  COMM3O PIC  X(0001).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  CHGBK3O PIC  X(0002).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  CCE03O PIC  X(0001).
  2538*    -------------------------------
  2539     05  FILLER            PIC  X(0003).
  2540     05  AGNT4O PIC  X(0010).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  TYPE4O PIC  X(0001).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  SINRT4O PIC  X(0006).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  JNTRT4O PIC  X(0006).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  AHRT4O PIC  X(0006).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  RECAL4O PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  COMM4O PIC  X(0001).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  CHGBK4O PIC  X(0002).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  50
* EL6501.cbl
  2564     05  CCE04O PIC  X(0001).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  AGNT5O PIC  X(0010).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  TYPE5O PIC  X(0001).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  SINRT5O PIC  X(0006).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  JNTRT5O PIC  X(0006).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  AHRT5O PIC  X(0006).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  RECAL5O PIC  X(0001).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  COMM5O PIC  X(0001).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  CHGBK5O PIC  X(0002).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  CCE05O PIC  X(0001).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  AGNT6O PIC  X(0010).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  TYPE6O PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  SINRT6O PIC  X(0006).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  JNTRT6O PIC  X(0006).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  AHRT6O PIC  X(0006).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  RECAL6O PIC  X(0001).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  COMM6O PIC  X(0001).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  CHGBK6O PIC  X(0002).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  CCE06O PIC  X(0001).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  51
* EL6501.cbl
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  TYPE7O PIC  X(0001).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  SINRT7O PIC  X(0006).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  JNTRT7O PIC  X(0006).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  AHRT7O PIC  X(0006).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  RECAL7O PIC  X(0001).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  COMM7O PIC  X(0001).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  CHGBK7O PIC  X(0002).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  CCE07O PIC  X(0001).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  AGNT8O PIC  X(0010).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  TYPE8O PIC  X(0001).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  SINRT8O PIC  X(0006).
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  JNTRT8O PIC  X(0006).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  AHRT8O PIC  X(0006).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  RECAL8O PIC  X(0001).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  COMM8O PIC  X(0001).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  CHGBK8O PIC  X(0002).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  CCE08O PIC  X(0001).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  AGNT9O PIC  X(0010).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  TYPE9O PIC  X(0001).
  2679*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  52
* EL6501.cbl
  2680     05  FILLER            PIC  X(0003).
  2681     05  SINRT9O PIC  X(0006).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  JNTRT9O PIC  X(0006).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  AHRT9O PIC  X(0006).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  RECAL9O PIC  X(0001).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  COMM9O PIC  X(0001).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  CHGBK9O PIC  X(0002).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  CCE09O PIC  X(0001).
  2700*    -------------------------------
  2701     05  FILLER            PIC  X(0003).
  2702     05  AGNT10O PIC  X(0010).
  2703*    -------------------------------
  2704     05  FILLER            PIC  X(0003).
  2705     05  TYPE10O PIC  X(0001).
  2706*    -------------------------------
  2707     05  FILLER            PIC  X(0003).
  2708     05  SINRT10O PIC  X(0006).
  2709*    -------------------------------
  2710     05  FILLER            PIC  X(0003).
  2711     05  JNTRT10O PIC  X(0006).
  2712*    -------------------------------
  2713     05  FILLER            PIC  X(0003).
  2714     05  AHRT10O PIC  X(0006).
  2715*    -------------------------------
  2716     05  FILLER            PIC  X(0003).
  2717     05  RECAL10O PIC  X(0001).
  2718*    -------------------------------
  2719     05  FILLER            PIC  X(0003).
  2720     05  COMM10O PIC  X(0001).
  2721*    -------------------------------
  2722     05  FILLER            PIC  X(0003).
  2723     05  CHGBK10O PIC  X(0002).
  2724*    -------------------------------
  2725     05  FILLER            PIC  X(0003).
  2726     05  CCE10O PIC  X(0001).
  2727*    -------------------------------
  2728     05  FILLER            PIC  X(0003).
  2729     05  ERRMSG1O PIC  X(0075).
  2730*    -------------------------------
  2731     05  FILLER            PIC  X(0003).
  2732     05  PFENTERO PIC  X(0002).
  2733*    -------------------------------
  2734     05  FILLER            PIC  X(0003).
  2735     05  PF1PF2O PIC  X(0035).
  2736*    -------------------------------
  2737 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  53
* EL6501.cbl
  2738*    12  FILLER                  PIC X(518).
  2739*    12  FILLER                  PIC X(543).
  2740     12  FILLER                  PIC X(546).
  2741     12  MAP-AGENT-AREA.
  2742         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2743             20  AGENTL          PIC S9(4) COMP.
  2744             20  AGENTA          PIC X.
  2745             20  AGENT           PIC X(10).
  2746             20  ATYPEL          PIC S9(4) COMP.
  2747             20  ATYPEA          PIC X.
  2748             20  ATYPE           PIC X.
  2749             20  SINGLEL         PIC S9(4) COMP.
  2750             20  SINGLEA         PIC X.
  2751             20  SINGLE-COMM-T   PIC X(6).
  2752             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2753                 24  SINGLE-COMM-R PIC V9(5).
  2754                 24  SINGLE-DASH   PIC X.
  2755             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2756                                 PIC V9(5)-.
  2757             20  JOINTL          PIC S9(4) COMP.
  2758             20  JOINTA          PIC X.
  2759             20  JOINT-COMM-T    PIC X(6).
  2760             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2761                 24  JOINT-COMM-R PIC V9(5).
  2762                 24  JOINT-DASH   PIC X.
  2763             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2764                                 PIC V9(5)-.
  2765             20  A-HL            PIC S9(4) COMP.
  2766             20  A-HA            PIC X.
  2767             20  A-H-COMM-T      PIC X(6).
  2768             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2769                 24  A-H-COMM-R  PIC V9(5).
  2770                 24  A-H-DASH    PIC X.
  2771             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2772                                 PIC V9(5)-.
  2773             20  RECALL          PIC S9(4) COMP.
  2774             20  RECALA          PIC X.
  2775             20  RECAL           PIC X.
  2776             20  RCOMML          PIC S9(4) COMP.
  2777             20  RCOMMA          PIC X.
  2778             20  RCOMM           PIC X.
  2779             20  CHGBCKL         PIC S9(4) COMP.
  2780             20  CHGBCKA         PIC X.
  2781             20  CHGBCK          PIC X(02).
  2782             20  CCEL            PIC S9(4) COMP.
  2783             20  CCEA            PIC X.
  2784             20  CCEIND          PIC X.
  2785****************************************************************
  2786*
  2787* Copyright (c) 2007-2013 Dell Inc.
  2788* All rights reserved.
  2789*
  2790****************************************************************
  2791 01  DFHEIV.
  2792   02  DFHEIV0               PIC X(35).
  2793   02  DFHEIV1               PIC X(08).
  2794   02  DFHEIV2               PIC X(08).
  2795   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  54
* EL6501.cbl
  2796   02  DFHEIV4               PIC X(06).
  2797   02  DFHEIV5               PIC X(04).
  2798   02  DFHEIV6               PIC X(04).
  2799   02  DFHEIV7               PIC X(02).
  2800   02  DFHEIV8               PIC X(02).
  2801   02  DFHEIV9               PIC X(01).
  2802   02  DFHEIV10              PIC S9(7) COMP-3.
  2803   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2804   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2805   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2806   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2807   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2808   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2809   02  DFHEIV17              PIC X(04).
  2810   02  DFHEIV18              PIC X(04).
  2811   02  DFHEIV19              PIC X(04).
  2812   02  DFHEIV20              USAGE IS POINTER.
  2813   02  DFHEIV21              USAGE IS POINTER.
  2814   02  DFHEIV22              USAGE IS POINTER.
  2815   02  DFHEIV23              USAGE IS POINTER.
  2816   02  DFHEIV24              USAGE IS POINTER.
  2817   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2818   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2819   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2820   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2821   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2822   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2823   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2824   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2825   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2826   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2827   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2828   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2829   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2830   02  FILLER                PIC X(02).
  2831   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2832   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2833   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2834   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2835   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2836   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2837   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2838 LINKAGE  SECTION.
  2839*****************************************************************
  2840*                                                               *
  2841* Copyright (c) 2007-2013 Dell Inc.                             *
  2842* All rights reserved.                                          *
  2843*                                                               *
  2844*****************************************************************
  2845 01  dfheiblk.
  2846     02  eibtime          pic s9(7) comp-3.
  2847     02  eibdate          pic s9(7) comp-3.
  2848     02  eibtrnid         pic x(4).
  2849     02  eibtaskn         pic s9(7) comp-3.
  2850     02  eibtrmid         pic x(4).
  2851     02  dfheigdi         pic s9(4) comp.
  2852     02  eibcposn         pic s9(4) comp.
  2853     02  eibcalen         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  55
* EL6501.cbl
  2854     02  eibaid           pic x(1).
  2855     02  eibfiller1       pic x(1).
  2856     02  eibfn            pic x(2).
  2857     02  eibfiller2       pic x(2).
  2858     02  eibrcode         pic x(6).
  2859     02  eibfiller3       pic x(2).
  2860     02  eibds            pic x(8).
  2861     02  eibreqid         pic x(8).
  2862     02  eibrsrce         pic x(8).
  2863     02  eibsync          pic x(1).
  2864     02  eibfree          pic x(1).
  2865     02  eibrecv          pic x(1).
  2866     02  eibsend          pic x(1).
  2867     02  eibatt           pic x(1).
  2868     02  eibeoc           pic x(1).
  2869     02  eibfmh           pic x(1).
  2870     02  eibcompl         pic x(1).
  2871     02  eibsig           pic x(1).
  2872     02  eibconf          pic x(1).
  2873     02  eiberr           pic x(1).
  2874     02  eibrldbk         pic x(1).
  2875     02  eiberrcd         pic x(4).
  2876     02  eibsynrb         pic x(1).
  2877     02  eibnodat         pic x(1).
  2878     02  eibfiller5       pic x(2).
  2879     02  eibresp          pic s9(8) comp.
  2880     02  eibresp2         pic s9(8) comp.
  2881     02  dfheigdj         pic s9(4) comp.
  2882     02  dfheigdk         pic s9(4) comp.
  2883 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  56
* EL6501.cbl
  2885*01 PARMLIST .
  2886*    02  FILLER                  PIC S9(8)   COMP.
  2887*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2888*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2889*    02  REIN-POINTER            PIC S9(8)   COMP.
  2890*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2891*    02  COMM-POINTER            PIC S9(8)   COMP.
  2892*    02  COMP-POINTER            PIC S9(8)   COMP.
  2893*    02  NAME-POINTER            PIC S9(8)   COMP.
  2894*    02  RQST-POINTER            PIC S9(8)   COMP.
  2895*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2896*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2897*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2898*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2899*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2900*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2901*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2902*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2903*    COPY ERCACCT.
  2904******************************************************************
  2905*                                                                *
  2906*                                                                *
  2907*                            ERCACCT                             *
  2908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2909*                            VMOD=2.031                          *
  2910*                                                                *
  2911*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2912*                                                                *
  2913*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2914*   VSAM ACCOUNT MASTER FILES.                                   *
  2915*                                                                *
  2916*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2917*                                                                *
  2918*   FILE TYPE = VSAM,KSDS                                        *
  2919*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2920*                                                                *
  2921*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2922*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2923*                                                                *
  2924*   LOG = NO                                                     *
  2925*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2926*                                                                *
  2927*                                                                *
  2928******************************************************************
  2929*                   C H A N G E   L O G
  2930*
  2931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2932*-----------------------------------------------------------------
  2933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2934* EFFECTIVE    NUMBER
  2935*-----------------------------------------------------------------
  2936* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2937* 092705    2005050300006  PEMA  ADD SPP LEASES
  2938* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2939* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2940* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2941* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2942* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  57
* EL6501.cbl
  2943* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2944******************************************************************
  2945
  2946 01  ACCOUNT-MASTER.
  2947     12  AM-RECORD-ID                      PIC XX.
  2948         88  VALID-AM-ID                      VALUE 'AM'.
  2949
  2950     12  AM-CONTROL-PRIMARY.
  2951         16  AM-COMPANY-CD                 PIC X.
  2952         16  AM-MSTR-CNTRL.
  2953             20  AM-CONTROL-A.
  2954                 24  AM-CARRIER            PIC X.
  2955                 24  AM-GROUPING.
  2956                     28 AM-GROUPING-PREFIX PIC XXX.
  2957                     28 AM-GROUPING-PRIME  PIC XXX.
  2958                 24  AM-STATE              PIC XX.
  2959                 24  AM-ACCOUNT.
  2960                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2961                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2962             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2963                                           PIC X(19).
  2964             20  AM-CNTRL-B.
  2965                 24  AM-EXPIRATION-DT      PIC XX.
  2966                 24  FILLER                PIC X(4).
  2967             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2968                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2969
  2970     12  AM-CONTROL-BY-VAR-GRP.
  2971         16  AM-COMPANY-CD-A1              PIC X.
  2972         16  AM-VG-CARRIER                 PIC X.
  2973         16  AM-VG-GROUPING                PIC X(6).
  2974         16  AM-VG-STATE                   PIC XX.
  2975         16  AM-VG-ACCOUNT                 PIC X(10).
  2976         16  AM-VG-DATE.
  2977             20  AM-VG-EXPIRATION-DT       PIC XX.
  2978             20  FILLER                    PIC X(4).
  2979         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2980                                           PIC 9(11)      COMP-3.
  2981     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2982         16  FILLER                        PIC X(10).
  2983         16  AM-VG-KEY3.
  2984             20  AM-VG3-ACCOUNT            PIC X(10).
  2985             20  AM-VG3-EXP-DT             PIC XX.
  2986         16  FILLER                        PIC X(4).
  2987     12  AM-MAINT-INFORMATION.
  2988         16  AM-LAST-MAINT-DT              PIC XX.
  2989         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2990         16  AM-LAST-MAINT-USER            PIC X(4).
  2991         16  FILLER                        PIC XX.
  2992
  2993     12  AM-EFFECTIVE-DT                   PIC XX.
  2994     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2995
  2996     12  AM-PREV-DATES  COMP-3.
  2997         16  AM-PREV-EXP-DT                PIC 9(11).
  2998         16  AM-PREV-EFF-DT                PIC 9(11).
  2999
  3000     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  58
* EL6501.cbl
  3001     12  AM-REPORT-CODE-2                  PIC X(10).
  3002
  3003     12  AM-CITY-CODE                      PIC X(4).
  3004     12  AM-COUNTY-PARISH                  PIC X(6).
  3005
  3006     12  AM-NAME                           PIC X(30).
  3007     12  AM-PERSON                         PIC X(30).
  3008     12  AM-ADDRS                          PIC X(30).
  3009     12  AM-CITY.
  3010         16  AM-ADDR-CITY                  PIC X(28).
  3011         16  AM-ADDR-STATE                 PIC XX.
  3012     12  AM-ZIP.
  3013         16  AM-ZIP-PRIME.
  3014             20  AM-ZIP-PRI-1ST            PIC X.
  3015                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3016             20  FILLER                    PIC X(4).
  3017         16  AM-ZIP-PLUS4                  PIC X(4).
  3018     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3019         16  AM-CAN-POSTAL-1               PIC XXX.
  3020         16  AM-CAN-POSTAL-2               PIC XXX.
  3021         16  FILLER                        PIC XXX.
  3022     12  AM-TEL-NO.
  3023         16  AM-AREA-CODE                  PIC 999.
  3024         16  AM-TEL-PRE                    PIC 999.
  3025         16  AM-TEL-NBR                    PIC 9(4).
  3026     12  AM-TEL-LOC                        PIC X.
  3027         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3028         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3029
  3030     12  AM-COMM-STRUCTURE.
  3031         16  AM-DEFN-1.
  3032             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3033                 24  AM-AGT.
  3034                     28  AM-AGT-PREFIX     PIC X(4).
  3035                     28  AM-AGT-PRIME      PIC X(6).
  3036                 24  AM-COM-TYP            PIC X.
  3037                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3038                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3039                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3040                 24  AM-RECALC-LV-INDIC    PIC X.
  3041                 24  AM-RETRO-LV-INDIC     PIC X.
  3042                 24  AM-GL-CODES           PIC X.
  3043                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3044                 24  FILLER                PIC X(01).
  3045         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3046             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3047                 24  FILLER                PIC X(11).
  3048                 24  AM-L-COMA             PIC XXX.
  3049                 24  AM-J-COMA             PIC XXX.
  3050                 24  AM-A-COMA             PIC XXX.
  3051                 24  FILLER                PIC X(6).
  3052
  3053     12  AM-COMM-CHANGE-STATUS             PIC X.
  3054         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3055
  3056     12  AM-CSR-CODE                       PIC X(4).
  3057
  3058     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  59
* EL6501.cbl
  3059         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3060         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3061     12  AM-AUTO-REFUND-SW                 PIC X.
  3062         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3063         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3064     12  AM-GPCD                           PIC 99.
  3065     12  AM-IG                             PIC X.
  3066         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3067         88  AM-HAS-GROUP                     VALUE '2'.
  3068     12  AM-STATUS                         PIC X.
  3069         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3070         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3071         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3072         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3073         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3074         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3075         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3076         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3077         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3078         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3079     12  AM-REMIT-TO                       PIC 99.
  3080     12  AM-ID-NO                          PIC X(11).
  3081
  3082     12  AM-CAL-TABLE                      PIC XX.
  3083     12  AM-LF-DEVIATION                   PIC XXX.
  3084     12  AM-AH-DEVIATION                   PIC XXX.
  3085     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3086     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3087     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3088     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3089     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3090     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3091
  3092     12  AM-USER-FIELDS.
  3093         16  AM-FLD-1                      PIC XX.
  3094         16  AM-FLD-2                      PIC XX.
  3095         16  AM-FLD-3                      PIC XX.
  3096         16  AM-FLD-4                      PIC XX.
  3097         16  AM-FLD-5                      PIC XX.
  3098
  3099     12  AM-1ST-PROD-DATE.
  3100         16  AM-1ST-PROD-YR                PIC XX.
  3101         16  AM-1ST-PROD-MO                PIC XX.
  3102         16  AM-1ST-PROD-DA                PIC XX.
  3103     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3104     12  AM-CERTS-PURGED-DATE.
  3105         16  AM-PUR-YR                     PIC XX.
  3106         16  AM-PUR-MO                     PIC XX.
  3107         16  AM-PUR-DA                     PIC XX.
  3108     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3109     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3110     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3111     12  AM-INACTIVE-DATE.
  3112         16  AM-INA-MO                     PIC 99.
  3113         16  AM-INA-DA                     PIC 99.
  3114         16  AM-INA-YR                     PIC 99.
  3115     12  AM-AR-HI-CERT-DATE                PIC XX.
  3116
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  60
* EL6501.cbl
  3117     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3118     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3119
  3120     12  AM-OB-PAYMENT-MODE                PIC X.
  3121         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3122         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3123         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3124         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3125
  3126     12  AM-AH-ONLY-INDICATOR              PIC X.
  3127         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3128         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3129
  3130     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3131
  3132     12  AM-OVER-SHORT.
  3133         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3134         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3135
  3136     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3137     12  AM-DCC-CLP-STATE                  PIC XX.
  3138
  3139     12  AM-RECALC-COMM                    PIC X.
  3140     12  AM-RECALC-REIN                    PIC X.
  3141
  3142     12  AM-REI-TABLE                      PIC XXX.
  3143     12  AM-REI-ET-LF                      PIC X.
  3144     12  AM-REI-ET-AH                      PIC X.
  3145     12  AM-REI-PE-LF                      PIC X.
  3146     12  AM-REI-PE-AH                      PIC X.
  3147     12  AM-REI-PRT-ST                     PIC X.
  3148     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3149     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3150     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3151     12  AM-REI-GROUP-A                    PIC X(6).
  3152     12  AM-REI-MORT                       PIC X(4).
  3153     12  AM-REI-PRT-OW                     PIC X.
  3154     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3155     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3156     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3157     12  AM-REI-GROUP-B                    PIC X(6).
  3158
  3159     12  AM-TRUST-TYPE                     PIC X(2).
  3160
  3161     12  AM-EMPLOYER-STMT-USED             PIC X.
  3162     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3163
  3164     12  AM-STD-AH-TYPE                    PIC XX.
  3165     12  AM-EARN-METHODS.
  3166         16  AM-EARN-METHOD-R              PIC X.
  3167             88 AM-REF-RL-R78                 VALUE 'R'.
  3168             88 AM-REF-RL-PR                  VALUE 'P'.
  3169             88 AM-REF-RL-MEAN                VALUE 'M'.
  3170             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3171         16  AM-EARN-METHOD-L              PIC X.
  3172             88 AM-REF-LL-R78                 VALUE 'R'.
  3173             88 AM-REF-LL-PR                  VALUE 'P'.
  3174             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  61
* EL6501.cbl
  3175             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3176         16  AM-EARN-METHOD-A              PIC X.
  3177             88 AM-REF-AH-R78                 VALUE 'R'.
  3178             88 AM-REF-AH-PR                  VALUE 'P'.
  3179             88 AM-REF-AH-MEAN                VALUE 'M'.
  3180             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3181             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3182             88 AM-REF-AH-NET                 VALUE 'N'.
  3183
  3184     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3185     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3186     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3187
  3188     12  AM-RET-Y-N                        PIC X.
  3189     12  AM-RET-P-E                        PIC X.
  3190     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3191     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3192     12  AM-RET-GRP                        PIC X(6).
  3193     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3194         16  AM-POOL-PRIME                 PIC XXX.
  3195         16  AM-POOL-SUB                   PIC XXX.
  3196     12  AM-RETRO-EARNINGS.
  3197         16  AM-RET-EARN-R                 PIC X.
  3198         16  AM-RET-EARN-L                 PIC X.
  3199         16  AM-RET-EARN-A                 PIC X.
  3200     12  AM-RET-ST-TAX-USE                 PIC X.
  3201         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3202         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3203     12  AM-RETRO-BEG-EARNINGS.
  3204         16  AM-RET-BEG-EARN-R             PIC X.
  3205         16  AM-RET-BEG-EARN-L             PIC X.
  3206         16  AM-RET-BEG-EARN-A             PIC X.
  3207     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3208     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3209
  3210     12  AM-USER-SELECT-OPTIONS.
  3211         16  AM-USER-SELECT-1              PIC X(10).
  3212         16  AM-USER-SELECT-2              PIC X(10).
  3213         16  AM-USER-SELECT-3              PIC X(10).
  3214         16  AM-USER-SELECT-4              PIC X(10).
  3215         16  AM-USER-SELECT-5              PIC X(10).
  3216
  3217     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3218
  3219     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3220
  3221     12  AM-RPT045A-SWITCH                 PIC X.
  3222         88  RPT045A-OFF                   VALUE 'N'.
  3223
  3224     12  AM-INSURANCE-LIMITS.
  3225         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3226         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3227
  3228     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3229         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3230
  3231     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3232         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  62
* EL6501.cbl
  3233         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3234
  3235     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3236
  3237     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3238     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3239     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3240     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3241     12  AM-DCC-UEF-STATE                  PIC XX.
  3242     12  FILLER                            PIC XXX.
  3243     12  AM-REPORT-CODE-3                  PIC X(10).
  3244*    12  FILLER                            PIC X(22).
  3245
  3246     12  AM-RESERVE-DATE.
  3247         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3248         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3249         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3250
  3251     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3252     12  AM-NOTIFICATION-TYPES.
  3253         16  AM-NOTIF-OF-LETTERS           PIC X.
  3254         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3255         16  AM-NOTIF-OF-REPORTS           PIC X.
  3256         16  AM-NOTIF-OF-STATUS            PIC X.
  3257
  3258     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3259         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3260         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3261         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3262         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3263
  3264     12  AM-BENEFIT-CONTROLS.
  3265         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3266             20  AM-BENEFIT-CODE           PIC XX.
  3267             20  AM-BENEFIT-TYPE           PIC X.
  3268             20  AM-BENEFIT-REVISION       PIC XXX.
  3269             20  AM-BENEFIT-REM-TERM       PIC X.
  3270             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3271             20  FILLER                    PIC XX.
  3272         16  FILLER                        PIC X(80).
  3273
  3274     12  AM-TRANSFER-DATA.
  3275         16  AM-TRANSFERRED-FROM.
  3276             20  AM-TRNFROM-CARRIER        PIC X.
  3277             20  AM-TRNFROM-GROUPING.
  3278                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3279                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3280             20  AM-TRNFROM-STATE          PIC XX.
  3281             20  AM-TRNFROM-ACCOUNT.
  3282                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3283                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3284             20  AM-TRNFROM-DTE            PIC XX.
  3285         16  AM-TRANSFERRED-TO.
  3286             20  AM-TRNTO-CARRIER          PIC X.
  3287             20  AM-TRNTO-GROUPING.
  3288                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3289                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3290             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  63
* EL6501.cbl
  3291             20  AM-TRNTO-ACCOUNT.
  3292                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3293                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3294             20  AM-TRNTO-DTE              PIC XX.
  3295         16  FILLER                        PIC X(10).
  3296
  3297     12  AM-SAVED-REMIT-TO                 PIC 99.
  3298
  3299     12  AM-COMM-STRUCTURE-SAVED.
  3300         16  AM-DEFN-1-SAVED.
  3301             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3302                 24  AM-AGT-SV             PIC X(10).
  3303                 24  AM-COM-TYP-SV         PIC X.
  3304                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3305                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3306                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3307                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3308                 24  FILLER                PIC X.
  3309                 24  AM-GL-CODES-SV        PIC X.
  3310                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3311                 24  FILLER                PIC X.
  3312         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3313             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3314                 24  FILLER                PIC X(11).
  3315                 24  AM-L-COMA-SV          PIC XXX.
  3316                 24  AM-J-COMA-SV          PIC XXX.
  3317                 24  AM-A-COMA-SV          PIC XXX.
  3318                 24  FILLER                PIC X(6).
  3319
  3320     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3321         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3322            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3323            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3324            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3325
  3326     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3327     12  FILLER                            PIC X(120).
  3328
  3329     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3330         16  AM-CONTROL-NAME               PIC X(30).
  3331         16  AM-EXECUTIVE-ONE.
  3332             20  AM-EXEC1-NAME             PIC X(15).
  3333             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3334                                                          COMP-3.
  3335             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3336                                                          COMP-3.
  3337         16  AM-EXECUTIVE-TWO.
  3338             20  AM-EXEC2-NAME             PIC X(15).
  3339             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3340                                                          COMP-3.
  3341             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3342                                                          COMP-3.
  3343
  3344     12  AM-RETRO-ADDITIONAL-DATA.
  3345         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3346         16  AM-RETRO-PREM-P-E             PIC X.
  3347         16  AM-RETRO-CLMS-P-I             PIC X.
  3348         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  64
* EL6501.cbl
  3349             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3350                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3351                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3352             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3353                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3354                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3355             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3356                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3357                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3358         16  AM-RETRO-RET-BRACKET-AH.
  3359             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3360                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3361                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3362                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3363             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3364                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3365                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3366             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3367                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3368                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3369
  3370     12  AM-COMMENTS.
  3371         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3372
  3373     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3374         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3375         16  AM-FLI-BILLING-CODE           PIC X.
  3376         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3377         16  AM-FLI-UNITED-IDENT           PIC X.
  3378         16  AM-FLI-INTEREST-LOST-DATA.
  3379             20  AM-FLI-BANK-NO            PIC X(5).
  3380             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3381             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3382             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3383         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3384             20  AM-FLI-AGT                PIC X(9).
  3385             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3386             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3387         16  FILLER                        PIC X(102).
  3388
  3389     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3390         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3391             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3392             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3393             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3394             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3395             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3396         16  FILLER                          PIC X(10).
  3397******************************************************************
  3398*    copy ERCPDEF.
  3399******************************************************************
  3400*                                                                *
  3401*                                                                *
  3402*                            ERCPDEF.                            *
  3403*                                                                *
  3404*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3405*                                                                *
  3406*    FILE TYPE = VSAM,KSDS                                       *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  65
* EL6501.cbl
  3407*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3408*                                                                *
  3409*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3410*                                                                *
  3411*    LOG = YES                                                   *
  3412*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3413******************************************************************
  3414*                   C H A N G E   L O G
  3415*
  3416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3417*-----------------------------------------------------------------
  3418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3419* EFFECTIVE    NUMBER
  3420*-----------------------------------------------------------------
  3421* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3422* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3423* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3424******************************************************************
  3425 01  PRODUCT-MASTER.
  3426    12  PD-RECORD-ID                 PIC X(02).
  3427        88  VALID-PD-ID                  VALUE 'PD'.
  3428    12  PD-CONTROL-PRIMARY.
  3429        16  PD-COMPANY-CD            PIC X.
  3430        16  PD-STATE                 PIC XX.
  3431        16  PD-PRODUCT-CD            PIC XXX.
  3432        16  PD-FILLER                PIC X(7).
  3433        16  PD-BEN-TYPE              PIC X.
  3434        16  PD-BEN-CODE              PIC XX.
  3435        16  PD-PROD-EXP-DT           PIC XX.
  3436    12  FILLER                       PIC X(50).
  3437    12  PD-PRODUCT-DATA OCCURS 8.
  3438        16  PD-PROD-CODE             PIC X.
  3439            88  PD-PROD-LIFE           VALUE 'L'.
  3440            88  PD-PROD-PROP           VALUE 'P'.
  3441            88  PD-PROD-AH             VALUE 'A'.
  3442            88  PD-PROD-IU             VALUE 'I'.
  3443            88  PD-PROD-GAP            VALUE 'G'.
  3444            88  PD-PROD-FAML           VALUE 'F'.
  3445        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3446        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3447        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3448        16  PD-MAX-TERM              PIC S999        COMP-3.
  3449        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3450        16  FILLER                   PIC X.
  3451        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3452        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3453        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3454        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3455        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3456        16  PD-REC-CRIT-PERIOD       PIC 99.
  3457        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3458            20  PD-RECURRING-YN      PIC X.
  3459            20  FILLER               PIC X.
  3460        16  PD-RTW-MOS               PIC 99.
  3461        16  PD-MAX-EXTENSION         PIC 99.
  3462        16  pd-ben-pct               pic sv999 comp-3.
  3463*       16  FILLER                   PIC XX.
  3464    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  66
* EL6501.cbl
  3465    12  PD-TERM-LIMITS OCCURS 15.
  3466        16  PD-LOW-TERM              PIC S999        COMP-3.
  3467        16  PD-HI-TERM               PIC S999        COMP-3.
  3468*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3469    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3470        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3471        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3472    12  PD-EARN-FACTORS.
  3473        16  FILLER OCCURS 15.
  3474            20  FILLER OCCURS 15.
  3475                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3476    12  PD-PRODUCT-DESC              PIC X(80).
  3477    12  PD-TRUNCATED                 PIC X.
  3478    12  FILLER                       PIC X(59).
  3479    12  PD-MAINT-INFORMATION.
  3480        16  PD-LAST-MAINT-DT         PIC X(02).
  3481        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3482        16  PD-LAST-MAINT-BY         PIC X(04).
  3483*    COPY ELCCNTL.
  3484******************************************************************
  3485*                                                                *
  3486*                                                                *
  3487*                            ELCCNTL.                            *
  3488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3489*                            VMOD=2.059                          *
  3490*                                                                *
  3491*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3492*                                                                *
  3493*   FILE TYPE = VSAM,KSDS                                        *
  3494*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3495*                                                                *
  3496*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3497*       ALTERNATE INDEX = NONE                                   *
  3498*                                                                *
  3499*   LOG = YES                                                    *
  3500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3501******************************************************************
  3502*                   C H A N G E   L O G
  3503*
  3504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3505*-----------------------------------------------------------------
  3506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3507* EFFECTIVE    NUMBER
  3508*-----------------------------------------------------------------
  3509* 082503                   PEMA  ADD BENEFIT GROUP
  3510* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3511* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3512* 092705    2005050300006  PEMA  ADD SPP LEASES
  3513* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3514* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3515* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3516* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3517* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3518* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3519* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3520* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3521* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3522* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  67
* EL6501.cbl
  3523* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3524******************************************************************
  3525*
  3526 01  CONTROL-FILE.
  3527     12  CF-RECORD-ID                       PIC XX.
  3528         88  VALID-CF-ID                        VALUE 'CF'.
  3529
  3530     12  CF-CONTROL-PRIMARY.
  3531         16  CF-COMPANY-ID                  PIC XXX.
  3532         16  CF-RECORD-TYPE                 PIC X.
  3533             88  CF-COMPANY-MASTER              VALUE '1'.
  3534             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3535             88  CF-STATE-MASTER                VALUE '3'.
  3536             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3537             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3538             88  CF-CARRIER-MASTER              VALUE '6'.
  3539             88  CF-MORTALITY-MASTER            VALUE '7'.
  3540             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3541             88  CF-TERMINAL-MASTER             VALUE '9'.
  3542             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3543             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3544             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3545             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3546             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3547             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3548             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3549             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3550             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3551         16  CF-ACCESS-CD-GENL              PIC X(4).
  3552         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3553             20  CF-PROCESSOR               PIC X(4).
  3554         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3555             20  CF-STATE-CODE              PIC XX.
  3556             20  FILLER                     PIC XX.
  3557         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3558             20  FILLER                     PIC XX.
  3559             20  CF-HI-BEN-IN-REC           PIC XX.
  3560         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3561             20  FILLER                     PIC XXX.
  3562             20  CF-CARRIER-CNTL            PIC X.
  3563         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3564             20  FILLER                     PIC XX.
  3565             20  CF-HI-TYPE-IN-REC          PIC 99.
  3566         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3567             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3568                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3569             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3570             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3571         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3572             20  FILLER                     PIC X.
  3573             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3574         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3575             20  FILLER                     PIC XX.
  3576             20  CF-MORTGAGE-PLAN           PIC XX.
  3577         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3578
  3579     12  CF-LAST-MAINT-DT                   PIC XX.
  3580     12  CF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  68
* EL6501.cbl
  3581     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3582
  3583     12  CF-RECORD-BODY                     PIC X(728).
  3584
  3585
  3586****************************************************************
  3587*             COMPANY MASTER RECORD                            *
  3588****************************************************************
  3589
  3590     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3591         16  CF-COMPANY-ADDRESS.
  3592             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3593             20  CF-CL-IN-CARE-OF           PIC X(30).
  3594             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3595             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3596             20  CF-CL-CITY-STATE           PIC X(30).
  3597             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3598             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3599         16  CF-COMPANY-CD                  PIC X.
  3600         16  CF-COMPANY-PASSWORD            PIC X(8).
  3601         16  CF-SECURITY-OPTION             PIC X.
  3602             88  ALL-SECURITY                   VALUE '1'.
  3603             88  COMPANY-VERIFY                 VALUE '2'.
  3604             88  PROCESSOR-VERIFY               VALUE '3'.
  3605             88  NO-SECURITY                    VALUE '4'.
  3606             88  ALL-BUT-TERM                   VALUE '5'.
  3607         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3608             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3609         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3610             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3611         16  CF-INFORCE-LOCATION            PIC X.
  3612             88  CERTS-ARE-ONLINE               VALUE '1'.
  3613             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3614             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3615         16  CF-LOWER-CASE-LETTERS          PIC X.
  3616         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3617             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3618             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3619             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3620             88  CF-ACCNT-CNTL                  VALUE '3'.
  3621             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3622
  3623         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3624         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3625
  3626         16  CF-LGX-CREDIT-USER             PIC X.
  3627             88  CO-IS-NOT-USER                 VALUE 'N'.
  3628             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3629
  3630         16 CF-CREDIT-CALC-CODES.
  3631             20  CF-CR-REM-TERM-CALC PIC X.
  3632               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3633               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3634               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3635               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3636               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3637               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3638               88  CR-EARN-AFTER-16TH           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  69
* EL6501.cbl
  3639             20  CF-CR-R78-METHOD           PIC X.
  3640               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3641               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3642
  3643         16  CF-CLAIM-CONTROL-COUNTS.
  3644             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3645                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3646
  3647             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3648                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3649
  3650             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3651                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3652
  3653             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3654                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3655
  3656         16  CF-CURRENT-MONTH-END           PIC XX.
  3657
  3658         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3659             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3660             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3661             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3662             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3663                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3664                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3665             20  CF-CO-PREM-REJECT-SW       PIC X.
  3666                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3667                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3668             20  CF-CO-REF-REJECT-SW        PIC X.
  3669                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3670                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3671
  3672         16  CF-CO-REPORTING-DT             PIC XX.
  3673         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3674         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3675           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3676           88  CF-CO-MONTH-END                  VALUE '1'.
  3677
  3678         16  CF-LGX-CLAIM-USER              PIC X.
  3679             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3680             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3681
  3682         16  CF-CREDIT-EDIT-CONTROLS.
  3683             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3684             20  CF-MIN-AGE                 PIC 99.
  3685             20  CF-DEFAULT-AGE             PIC 99.
  3686             20  CF-MIN-TERM                PIC S999      COMP-3.
  3687             20  CF-MAX-TERM                PIC S999      COMP-3.
  3688             20  CF-DEFAULT-SEX             PIC X.
  3689             20  CF-JOINT-AGE-INPUT         PIC X.
  3690                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3691             20  CF-BIRTH-DATE-INPUT        PIC X.
  3692                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3693             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3694                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3695                 88  CF-ZERO-CARRIER            VALUE '1'.
  3696                 88  CF-ZERO-GROUPING           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  70
* EL6501.cbl
  3697                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3698             20  CF-EDIT-SW                 PIC X.
  3699                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3700             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3701             20  CF-CR-PR-METHOD            PIC X.
  3702               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3703               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3704             20  FILLER                     PIC X.
  3705
  3706         16  CF-CREDIT-MISC-CONTROLS.
  3707             20  CF-REIN-TABLE-SW           PIC X.
  3708                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3709             20  CF-COMP-TABLE-SW           PIC X.
  3710                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3711             20  CF-EXPERIENCE-RETENTION-AGE
  3712                                            PIC S9        COMP-3.
  3713             20  CF-CONVERSION-DT           PIC XX.
  3714             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3715             20  CF-RUN-FREQUENCY-SW        PIC X.
  3716                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3717                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3718
  3719             20  CF-CR-CHECK-NO-CONTROL.
  3720                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3721                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3722                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3723                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3724                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3725                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3726
  3727                 24  CF-CR-CHECK-COUNT       REDEFINES
  3728                     CF-CR-CHECK-COUNTER      PIC X(4).
  3729
  3730                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3731                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3732
  3733                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3734                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3735                 24  CF-MAIL-PROCESSING       PIC X.
  3736                     88  MAIL-PROCESSING          VALUE 'Y'.
  3737
  3738         16  CF-MISC-SYSTEM-CONTROL.
  3739             20  CF-SYSTEM-C                 PIC X.
  3740                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3741             20  CF-SYSTEM-D                 PIC X.
  3742                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3743             20  CF-SOC-SEC-NO-SW            PIC X.
  3744                 88  SOC-SEC-NO-USED             VALUE '1'.
  3745             20  CF-MEMBER-NO-SW             PIC X.
  3746                 88  MEMBER-NO-USED              VALUE '1'.
  3747             20  CF-TAX-ID-NUMBER            PIC X(11).
  3748             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3749             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3750                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3751                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3752                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3753                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3754             20  CF-SYSTEM-E                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  71
* EL6501.cbl
  3755                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3756
  3757         16  CF-LGX-LIFE-USER               PIC X.
  3758             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3759             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3760
  3761         16  CF-CR-MONTH-END-DT             PIC XX.
  3762
  3763         16  CF-FILE-MAINT-DATES.
  3764             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3765                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3766             20  CF-LAST-BATCH       REDEFINES
  3767                 CF-LAST-BATCH-NO               PIC X(4).
  3768             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3769             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3770             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3771             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3772             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3773             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3774             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3775             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3776             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3777             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3778
  3779         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3780         16  FILLER                         PIC X.
  3781
  3782         16  CF-ALT-MORT-CODE               PIC X(4).
  3783         16  CF-MEMBER-CAPTION              PIC X(10).
  3784
  3785         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3786             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3787             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3788             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3789             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3790             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3791
  3792         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3793
  3794         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3795         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3796         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3797         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3798
  3799         16  CF-AH-OVERRIDE-L1              PIC X.
  3800         16  CF-AH-OVERRIDE-L2              PIC XX.
  3801         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3802         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3803
  3804         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3805         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3806
  3807         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3808         16  CF-AR-LAST-EL860-DT            PIC XX.
  3809         16  CF-MP-MONTH-END-DT             PIC XX.
  3810
  3811         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3812         16  CF-CLAIM-PAID-THRU-TO          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  72
* EL6501.cbl
  3813             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3814
  3815         16  CF-AR-MONTH-END-DT             PIC XX.
  3816
  3817         16  CF-CRDTCRD-USER                PIC X.
  3818             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3819             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3820
  3821         16  CF-CC-MONTH-END-DT             PIC XX.
  3822
  3823         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3824
  3825         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3826             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3827             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3828             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3829         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3830         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3831         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3832         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3833             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3834             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3835         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3836         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3837         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3838             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3839         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3840
  3841         16  CF-CL-ZIP-CODE.
  3842             20  CF-CL-ZIP-PRIME.
  3843                 24  CF-CL-ZIP-1ST          PIC X.
  3844                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3845                 24  FILLER                 PIC X(4).
  3846             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3847         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3848             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3849             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3850             20  FILLER                     PIC XXX.
  3851
  3852         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3853         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3854         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3855         16  CF-CO-OPTION-START-DATE        PIC XX.
  3856         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3857           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3858                                                      '3' '4'.
  3859           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3860           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3861           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3862           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3863           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3864           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3865
  3866         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3867
  3868         16  CF-PAYMENT-APPROVAL-LEVELS.
  3869             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3870             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  73
* EL6501.cbl
  3871             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3872             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3873             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3874             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3875
  3876         16  CF-END-USER-REPORTING-USER     PIC X.
  3877             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3878             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3879
  3880         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3881             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3882             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3883
  3884         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3885
  3886         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3887         16  FILLER                         PIC X.
  3888
  3889         16  CF-CREDIT-ARCHIVE-CNTL.
  3890             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3891             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3892             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3893
  3894         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3895
  3896         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3897             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3898             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3899
  3900         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3901             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3902             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3903
  3904         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3905
  3906         16  CF-CO-ACH-ID-CODE              PIC  X.
  3907             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3908             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3909             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3910         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3911         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3912         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3913         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3914         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3915         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3916         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3917         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3918         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3919                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3920         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3921                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3922
  3923         16  CF-CO-OVER-SHORT.
  3924             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3925             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3926
  3927*         16  FILLER                         PIC X(102).
  3928         16  CF-PAYMENT-APPROVAL-LEVELS-2.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  74
* EL6501.cbl
  3929             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3930             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3931
  3932         16  CF-AH-APPROVAL-DAYS.
  3933             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3934             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3935             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3936             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3937
  3938         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3939
  3940         16  CF-APPROV-LEV-5.
  3941             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3942             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3943             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3944
  3945         16  FILLER                         PIC X(68).
  3946****************************************************************
  3947*             PROCESSOR/USER RECORD                            *
  3948****************************************************************
  3949
  3950     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3951         16  CF-PROCESSOR-NAME              PIC X(30).
  3952         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3953         16  CF-PROCESSOR-TITLE             PIC X(26).
  3954         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3955                 88  MESSAGE-YES                VALUE 'Y'.
  3956                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3957
  3958*****************************************************
  3959****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3960****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3961****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3962****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3963*****************************************************
  3964
  3965         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3966             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3967             20  CF-APPLICATION-FORCE       PIC X.
  3968             20  CF-INDIVIDUAL-APP.
  3969                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3970                     28  CF-BROWSE-APP      PIC X.
  3971                     28  CF-UPDATE-APP      PIC X.
  3972
  3973         16  CF-CURRENT-TERM-ON             PIC X(4).
  3974         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3975             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3976             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3977             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3978             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3979             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3980             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3981             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3982         16  CF-PROCESSOR-CARRIER           PIC X.
  3983             88  NO-CARRIER-SECURITY            VALUE ' '.
  3984         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3985             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3986         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  75
* EL6501.cbl
  3987             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3988         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3989             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3990
  3991         16  CF-PROC-SYS-ACCESS-SW.
  3992             20  CF-PROC-CREDIT-CLAIMS-SW.
  3993                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3994                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3995                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3996                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3997             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3998                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3999                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4000             20  CF-PROC-LIFE-GNRLDGR-SW.
  4001                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4002                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4003                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4004                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4005             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4006                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4007                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4008         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4009             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4010             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4011         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4012
  4013         16  CF-APPROVAL-LEVEL                  PIC X.
  4014             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4015             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4016             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4017             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4018             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4019
  4020         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4021
  4022         16  CF-LANGUAGE-TYPE                   PIC X.
  4023             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4024             88  CF-LANG-IS-FR                      VALUE 'F'.
  4025
  4026         16  CF-CSR-IND                         PIC X.
  4027         16  FILLER                             PIC X(239).
  4028
  4029****************************************************************
  4030*             PROCESSOR/REMINDERS RECORD                       *
  4031****************************************************************
  4032
  4033     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4034         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4035             20  CF-START-REMIND-DT         PIC XX.
  4036             20  CF-END-REMIND-DT           PIC XX.
  4037             20  CF-REMINDER-TEXT           PIC X(50).
  4038         16  FILLER                         PIC X(296).
  4039
  4040
  4041****************************************************************
  4042*             STATE MASTER RECORD                              *
  4043****************************************************************
  4044
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  76
* EL6501.cbl
  4045     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4046         16  CF-STATE-ABBREVIATION          PIC XX.
  4047         16  CF-STATE-NAME                  PIC X(25).
  4048         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4049         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4050             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4051             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4052             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4053             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4054                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4055                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4056             20  CF-ST-PREM-REJECT-SW       PIC X.
  4057                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4058                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4059             20  CF-ST-REF-REJECT-SW        PIC X.
  4060                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4061                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4062         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4063         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4064         16  CF-ST-REFUND-RULES.
  4065             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4066             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4067             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4068         16  CF-ST-FST-PMT-EXTENSION.
  4069             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4070             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4071                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4072                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4073                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4074                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4075         16  CF-ST-STATE-CALL.
  4076             20  CF-ST-CALL-UNEARNED        PIC X.
  4077             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4078             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4079         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4080             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4081             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4082         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4083         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4084         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4085         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4086         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4087         16  FILLER                         PIC X.
  4088         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4089             20  CF-ST-BENEFIT-CD           PIC XX.
  4090             20  CF-ST-BENEFIT-KIND         PIC X.
  4091                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4092                 88  CF-ST-AH-KIND              VALUE 'A'.
  4093             20  CF-ST-REM-TERM-CALC        PIC X.
  4094                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4095                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4096                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4097                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4098                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4099                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4100                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4101                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4102
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  77
* EL6501.cbl
  4103             20  CF-ST-REFUND-CALC          PIC X.
  4104                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4105                 88  ST-REFD-BY-R78             VALUE '1'.
  4106                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4107                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4108                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4109                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4110                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4111                 88  ST-REFD-UTAH               VALUE '7'.
  4112                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4113                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4114                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4115
  4116             20  CF-ST-EARNING-CALC         PIC X.
  4117                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4118                 88  ST-EARN-BY-R78             VALUE '1'.
  4119                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4120                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4121                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4122                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4123                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4124                 88  ST-EARN-MEAN               VALUE '8'.
  4125                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4126
  4127             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4128                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4129                 88  ST-OVRD-BY-R78             VALUE '1'.
  4130                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4131                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4132                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4133                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4134                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4135                 88  ST-OVRD-MEAN               VALUE '8'.
  4136                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4137             20  cf-st-extra-periods        pic 9.
  4138*            20  FILLER                     PIC X.
  4139
  4140         16  CF-ST-COMMISSION-CAPS.
  4141             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4142             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4143             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4144             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4145         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4146                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4147                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4148                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4149
  4150         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4151
  4152         16  CF-ST-STATUTORY-INTEREST.
  4153             20  CF-ST-STAT-DATE-FROM       PIC X.
  4154                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4155                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4156             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4157             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4158             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4159             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4160             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  78
* EL6501.cbl
  4161
  4162         16  CF-ST-OVER-SHORT.
  4163             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4164             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4165
  4166         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4167
  4168         16  CF-ST-RT-CALC                  PIC X.
  4169
  4170         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4171         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4172         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4173         16  CF-ST-RF-LR-CALC               PIC X.
  4174         16  CF-ST-RF-LL-CALC               PIC X.
  4175         16  CF-ST-RF-LN-CALC               PIC X.
  4176         16  CF-ST-RF-AH-CALC               PIC X.
  4177         16  CF-ST-RF-CP-CALC               PIC X.
  4178*        16  FILLER                         PIC X(206).
  4179*CIDMOD         16  FILLER                         PIC X(192).
  4180         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4181             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4182         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4183         16  CF-ST-VFY-2ND-BENE             PIC X.
  4184         16  CF-ST-CAUSAL-STATE             PIC X.
  4185         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4186         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4187         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4188             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4189         16  CF-ST-NET-ONLY-STATE           PIC X.
  4190             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4191         16  cf-commission-cap-required     pic x.
  4192         16  CF-ST-GA-COMMISSION-CAPS.
  4193             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4194             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4195             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4196             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4197         16  CF-ST-TOT-COMMISSION-CAPS.
  4198             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4199             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4200             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4201             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4202         16  FILLER                         PIC X(156).
  4203
  4204****************************************************************
  4205*             BENEFIT MASTER RECORD                            *
  4206****************************************************************
  4207
  4208     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4209         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4210             20  CF-BENEFIT-CODE            PIC XX.
  4211             20  CF-BENEFIT-NUMERIC  REDEFINES
  4212                 CF-BENEFIT-CODE            PIC XX.
  4213             20  CF-BENEFIT-ALPHA           PIC XXX.
  4214             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4215             20  CF-BENEFIT-COMMENT         PIC X(10).
  4216
  4217             20  CF-LF-COVERAGE-TYPE        PIC X.
  4218                 88  CF-REDUCING                VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  79
* EL6501.cbl
  4219                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4220
  4221             20  CF-SPECIAL-CALC-CD         PIC X.
  4222                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4223                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4224                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4225                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4226                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4227                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4228                 88  CF-FARM-PLAN               VALUE 'F'.
  4229                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4230                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4231                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4232                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4233                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4234                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4235                 88  CF-PRUDENTIAL              VALUE 'P'.
  4236                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4237                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4238                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4239                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4240                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4241                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4242
  4243             20  CF-JOINT-INDICATOR         PIC X.
  4244                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4245
  4246*            20  FILLER                     PIC X(12).
  4247             20  cf-maximum-benefits        pic s999 comp-3.
  4248             20  FILLER                     PIC X(09).
  4249             20  CF-BENEFIT-CATEGORY        PIC X.
  4250             20  CF-LOAN-TYPE               PIC X(8).
  4251
  4252             20  CF-CO-REM-TERM-CALC        PIC X.
  4253                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4254                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4255                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4256                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4257                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4258
  4259             20  CF-CO-EARNINGS-CALC        PIC X.
  4260                 88  CO-EARN-BY-R78             VALUE '1'.
  4261                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4262                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4263                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4264                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4265                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4266                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4267                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4268
  4269             20  CF-CO-REFUND-CALC          PIC X.
  4270                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4271                 88  CO-REFD-BY-R78             VALUE '1'.
  4272                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4273                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4274                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4275                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4276                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  80
* EL6501.cbl
  4277                 88  CO-REFD-MEAN               VALUE '8'.
  4278                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4279                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4280                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4281
  4282             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4283                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4284                 88  CO-OVRD-BY-R78             VALUE '1'.
  4285                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4286                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4287                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4288                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4289                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4290                 88  CO-OVRD-MEAN               VALUE '8'.
  4291                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4292
  4293             20  CF-CO-BEN-I-G-CD           PIC X.
  4294                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4295                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4296                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4297
  4298         16  FILLER                         PIC X(304).
  4299
  4300
  4301****************************************************************
  4302*             CARRIER MASTER RECORD                            *
  4303****************************************************************
  4304
  4305     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4306         16  CF-ADDRESS-DATA.
  4307             20  CF-MAIL-TO-NAME            PIC X(30).
  4308             20  CF-IN-CARE-OF              PIC X(30).
  4309             20  CF-ADDRESS-LINE-1          PIC X(30).
  4310             20  CF-ADDRESS-LINE-2          PIC X(30).
  4311             20  CF-CITY-STATE              PIC X(30).
  4312             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4313             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4314
  4315         16  CF-CLAIM-NO-CONTROL.
  4316             20  CF-CLAIM-NO-METHOD         PIC X.
  4317                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4318                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4319                 88  CLAIM-NO-SEQ               VALUE '3'.
  4320                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4321             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4322                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4323                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4324                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4325
  4326         16  CF-CHECK-NO-CONTROL.
  4327             20  CF-CHECK-NO-METHOD         PIC X.
  4328                 88  CHECK-NO-MANUAL            VALUE '1'.
  4329                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4330                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4331                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4332             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4333                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4334
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  81
* EL6501.cbl
  4335         16  CF-DOMICILE-STATE              PIC XX.
  4336
  4337         16  CF-EXPENSE-CONTROLS.
  4338             20  CF-EXPENSE-METHOD          PIC X.
  4339                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4340                 88  DOLLARS-PER-PMT            VALUE '2'.
  4341                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4342                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4343             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4344             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4345
  4346         16  CF-CORRESPONDENCE-CONTROL.
  4347             20  CF-LETTER-RESEND-OPT       PIC X.
  4348                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4349                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4350             20  FILLER                     PIC X(4).
  4351
  4352         16  CF-RESERVE-CONTROLS.
  4353             20  CF-MANUAL-SW               PIC X.
  4354                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4355             20  CF-FUTURE-SW               PIC X.
  4356                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4357             20  CF-PTC-SW                  PIC X.
  4358                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4359             20  CF-IBNR-SW                 PIC X.
  4360                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4361             20  CF-PTC-LF-SW               PIC X.
  4362                 88  CF-LF-PTC-USED             VALUE '1'.
  4363             20  CF-CDT-ACCESS-METHOD       PIC X.
  4364                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4365                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4366                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4367             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4368
  4369         16  CF-CLAIM-CALC-METHOD           PIC X.
  4370             88  360-PLUS-MONTHS                VALUE '1'.
  4371             88  365-PLUS-MONTHS                VALUE '2'.
  4372             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4373             88  360-DAILY                      VALUE '4'.
  4374             88  365-DAILY                      VALUE '5'.
  4375
  4376         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4377         16  FILLER                         PIC X(11).
  4378
  4379         16  CF-LIMIT-AMOUNTS.
  4380             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4381             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4382             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4383             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4384             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4385             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4386             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4387             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4388             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4389             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4390
  4391         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4392         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  82
* EL6501.cbl
  4393         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4394
  4395         16  CF-ZIP-CODE.
  4396             20  CF-ZIP-PRIME.
  4397                 24  CF-ZIP-1ST             PIC X.
  4398                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4399                 24  FILLER                 PIC X(4).
  4400             20  CF-ZIP-PLUS4               PIC X(4).
  4401         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4402             20  CF-CAN-POSTAL-1            PIC XXX.
  4403             20  CF-CAN-POSTAL-2            PIC XXX.
  4404             20  FILLER                     PIC XXX.
  4405
  4406         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4407         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4408         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4409
  4410         16  CF-RATING-SWITCH               PIC X.
  4411             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4412             88  CF-NO-RATING                   VALUE 'N'.
  4413
  4414         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4415
  4416         16  CF-CARRIER-OVER-SHORT.
  4417             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4418             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4419
  4420         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4421         16  CF-SECPAY-SWITCH               PIC X.
  4422             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4423             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4424         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4425         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4426         16  FILLER                         PIC X(444).
  4427*        16  FILLER                         PIC X(452).
  4428
  4429
  4430****************************************************************
  4431*             MORTALITY MASTER RECORD                          *
  4432****************************************************************
  4433
  4434     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4435         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4436                                INDEXED BY CF-MORT-NDX.
  4437             20  CF-MORT-TABLE              PIC X(5).
  4438             20  CF-MORT-TABLE-TYPE         PIC X.
  4439                 88  CF-MORT-JOINT              VALUE 'J'.
  4440                 88  CF-MORT-SINGLE             VALUE 'S'.
  4441                 88  CF-MORT-COMBINED           VALUE 'C'.
  4442                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4443                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4444             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4445             20  CF-MORT-AGE-METHOD         PIC XX.
  4446                 88  CF-AGE-LAST                VALUE 'AL'.
  4447                 88  CF-AGE-NEAR                VALUE 'AN'.
  4448             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4449             20  CF-MORT-ADJUSTMENT-DIRECTION
  4450                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  83
* EL6501.cbl
  4451                 88  CF-MINUS                   VALUE '-'.
  4452                 88  CF-PLUS                    VALUE '+'.
  4453             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4454             20  CF-MORT-JOINT-CODE         PIC X.
  4455                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4456             20  CF-MORT-PC-Q               PIC X.
  4457                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4458             20  CF-MORT-TABLE-CODE         PIC X(4).
  4459             20  CF-MORT-COMMENTS           PIC X(15).
  4460             20  FILLER                     PIC X(14).
  4461
  4462         16  FILLER                         PIC X(251).
  4463
  4464
  4465****************************************************************
  4466*             BUSSINESS TYPE MASTER RECORD                     *
  4467****************************************************************
  4468
  4469     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4470* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4471* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4472* AND RECORD 05 IS TYPES 81-99
  4473         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4474             20  CF-BUSINESS-TITLE          PIC  X(19).
  4475             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4476                                            PIC S9V9(4) COMP-3.
  4477             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4478             20  FILLER                     PIC  X.
  4479         16  FILLER                         PIC  X(248).
  4480
  4481
  4482****************************************************************
  4483*             TERMINAL MASTER RECORD                           *
  4484****************************************************************
  4485
  4486     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4487
  4488         16  CF-COMPANY-TERMINALS.
  4489             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4490                                  PIC X(4).
  4491         16  FILLER               PIC X(248).
  4492
  4493
  4494****************************************************************
  4495*             LIFE EDIT MASTER RECORD                          *
  4496****************************************************************
  4497
  4498     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4499         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4500             20  CF-LIFE-CODE-IN            PIC XX.
  4501             20  CF-LIFE-CODE-OUT           PIC XX.
  4502         16  FILLER                         PIC X(248).
  4503
  4504
  4505****************************************************************
  4506*             AH EDIT MASTER RECORD                            *
  4507****************************************************************
  4508
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  84
* EL6501.cbl
  4509     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4510         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4511             20  CF-AH-CODE-IN              PIC XXX.
  4512             20  CF-AH-CODE-OUT             PIC XX.
  4513         16  FILLER                         PIC X(248).
  4514
  4515
  4516****************************************************************
  4517*             CREDIBILITY TABLES                               *
  4518****************************************************************
  4519
  4520     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4521         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4522                             INDEXED BY CF-CRDB-NDX.
  4523             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4524             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4525             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4526         16  FILLER                         PIC  X(332).
  4527
  4528
  4529****************************************************************
  4530*             REPORT CUSTOMIZATION RECORD                      *
  4531****************************************************************
  4532
  4533     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4534         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4535             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4536             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4537             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4538**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4539****       A T-TRANSFER.                                   ****
  4540             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4541
  4542         16  FILLER                         PIC XX.
  4543
  4544         16  CF-CARRIER-CNTL-OPT.
  4545             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4546                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4547                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4548             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4549                                            PIC X.
  4550         16  CF-GROUP-CNTL-OPT.
  4551             20  CF-GROUP-OPT-SEQ           PIC 9.
  4552                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4553                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4554             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4555                                            PIC X(6).
  4556         16  CF-STATE-CNTL-OPT.
  4557             20  CF-STATE-OPT-SEQ           PIC 9.
  4558                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4559                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4560             20  CF-STATE-SELECT OCCURS 3 TIMES
  4561                                            PIC XX.
  4562         16  CF-ACCOUNT-CNTL-OPT.
  4563             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4564                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4565                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4566             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  85
* EL6501.cbl
  4567                                            PIC X(10).
  4568         16  CF-BUS-TYP-CNTL-OPT.
  4569             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4570                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4571                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4572             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4573                                            PIC XX.
  4574         16  CF-LF-TYP-CNTL-OPT.
  4575             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4576                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4577                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4578             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4579                                            PIC XX.
  4580         16  CF-AH-TYP-CNTL-OPT.
  4581             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4582                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4583                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4584             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4585                                            PIC XX.
  4586         16  CF-REPTCD1-CNTL-OPT.
  4587             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4588                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4589                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4590             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4591                                            PIC X(10).
  4592         16  CF-REPTCD2-CNTL-OPT.
  4593             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4594                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4595                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4596             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4597                                            PIC X(10).
  4598         16  CF-USER1-CNTL-OPT.
  4599             20  CF-USER1-OPT-SEQ           PIC 9.
  4600                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4601                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4602             20  CF-USER1-SELECT OCCURS 3 TIMES
  4603                                            PIC X(10).
  4604         16  CF-USER2-CNTL-OPT.
  4605             20  CF-USER2-OPT-SEQ           PIC 9.
  4606                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4607                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4608             20  CF-USER2-SELECT OCCURS 3 TIMES
  4609                                            PIC X(10).
  4610         16  CF-USER3-CNTL-OPT.
  4611             20  CF-USER3-OPT-SEQ           PIC 9.
  4612                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4613                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4614             20  CF-USER3-SELECT OCCURS 3 TIMES
  4615                                            PIC X(10).
  4616         16  CF-USER4-CNTL-OPT.
  4617             20  CF-USER4-OPT-SEQ           PIC 9.
  4618                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4619                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4620             20  CF-USER4-SELECT OCCURS 3 TIMES
  4621                                            PIC X(10).
  4622         16  CF-USER5-CNTL-OPT.
  4623             20  CF-USER5-OPT-SEQ           PIC 9.
  4624                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  86
* EL6501.cbl
  4625                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4626             20  CF-USER5-SELECT OCCURS 3 TIMES
  4627                                            PIC X(10).
  4628         16  CF-REINS-CNTL-OPT.
  4629             20  CF-REINS-OPT-SEQ           PIC 9.
  4630                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4631                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4632             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4633                 24  CF-REINS-PRIME         PIC XXX.
  4634                 24  CF-REINS-SUB           PIC XXX.
  4635
  4636         16  CF-AGENT-CNTL-OPT.
  4637             20  CF-AGENT-OPT-SEQ           PIC 9.
  4638                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4639                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4640             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4641                                            PIC X(10).
  4642
  4643         16  FILLER                         PIC X(43).
  4644
  4645         16  CF-LOSS-RATIO-SELECT.
  4646             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4647             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4648         16  CF-ENTRY-DATE-SELECT.
  4649             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4650             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4651         16  CF-EFFECTIVE-DATE-SELECT.
  4652             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4653             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4654
  4655         16  CF-EXCEPTION-LIST-IND          PIC X.
  4656             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4657
  4658         16  FILLER                         PIC X(318).
  4659
  4660****************************************************************
  4661*                  EXCEPTION REPORTING RECORD                  *
  4662****************************************************************
  4663
  4664     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4665         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4666             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4667
  4668         16  CF-COMBINED-LIFE-AH-OPT.
  4669             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4670             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4671             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4672             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4673
  4674         16  CF-LIFE-OPT.
  4675             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4676             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4677             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4678             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4679             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4680             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4681             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4682             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  87
* EL6501.cbl
  4683             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4684             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4685
  4686         16  CF-AH-OPT.
  4687             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4688             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4689             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4690             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4691             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4692             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4693             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4694             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4695             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4696             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4697
  4698         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4699             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4700             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4701             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4702
  4703         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4704
  4705         16  FILLER                         PIC X(673).
  4706
  4707
  4708****************************************************************
  4709*             MORTGAGE SYSTEM PLAN RECORD                      *
  4710****************************************************************
  4711
  4712     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4713         16  CF-PLAN-TYPE                   PIC X.
  4714             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4715             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4716             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4717         16  CF-PLAN-ABBREV                 PIC XXX.
  4718         16  CF-PLAN-DESCRIPT               PIC X(10).
  4719         16  CF-PLAN-NOTES                  PIC X(20).
  4720         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4721         16  CF-PLAN-UNDERWRITING.
  4722             20  CF-PLAN-TERM-DATA.
  4723                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4724                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4725             20  CF-PLAN-AGE-DATA.
  4726                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4727                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4728                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4729             20  CF-PLAN-BENEFIT-DATA.
  4730                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4731                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4732                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4733                                            PIC S9(7)V99  COMP-3.
  4734         16  CF-PLAN-POLICY-FORMS.
  4735             20  CF-POLICY-FORM             PIC X(12).
  4736             20  CF-MASTER-APPLICATION      PIC X(12).
  4737             20  CF-MASTER-POLICY           PIC X(12).
  4738         16  CF-PLAN-RATING.
  4739             20  CF-RATE-CODE               PIC X(5).
  4740             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  88
* EL6501.cbl
  4741                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4742                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4743             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4744             20  CF-SUB-STD-TYPE            PIC X.
  4745                 88  CF-PCT-OF-PREM            VALUE '1'.
  4746                 88  CF-PCT-OF-BENE            VALUE '2'.
  4747         16  CF-PLAN-PREM-TOLERANCES.
  4748             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4749             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4750         16  CF-PLAN-PYMT-TOLERANCES.
  4751             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4752             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4753         16  CF-PLAN-MISC-DATA.
  4754             20  FILLER                     PIC X.
  4755             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4756             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4757         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4758         16  CF-PLAN-IND-GRP                PIC X.
  4759             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4760                                                     '1'.
  4761             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4762                                                     '2'.
  4763         16  CF-MIB-SEARCH-SW               PIC X.
  4764             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4765             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4766             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4767             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4768         16  CF-ALPHA-SEARCH-SW             PIC X.
  4769             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4770             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4771             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4772             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4773             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4774             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4775             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4776             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4777             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4778             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4779                                                     'A' 'B' 'C'
  4780                                                     'X' 'Y' 'Z'.
  4781         16  CF-EFF-DT-RULE-SW              PIC X.
  4782             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4783             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4784             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4785             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4786             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4787         16  FILLER                         PIC X(4).
  4788         16  CF-HEALTH-QUESTIONS            PIC X.
  4789             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4790         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4791         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4792         16  CF-PLAN-SNGL-JNT               PIC X.
  4793             88  CF-COMBINED-PLAN              VALUE 'C'.
  4794             88  CF-JNT-PLAN                   VALUE 'J'.
  4795             88  CF-SNGL-PLAN                  VALUE 'S'.
  4796         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4797         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4798         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  89
* EL6501.cbl
  4799         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4800         16  CF-RERATE-CNTL                 PIC  X.
  4801             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4802             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4803             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4804             88  CF-AUTO-RECALC                 VALUE '4'.
  4805         16  CF-BENEFIT-TYPE                PIC  X.
  4806             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4807             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4808         16  CF-POLICY-FEE                  PIC S999V99
  4809                                                    COMP-3.
  4810         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4811         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4812         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4813         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4814         16  FILLER                         PIC  X(32).
  4815         16  CF-TERMINATION-FORM            PIC  X(04).
  4816         16  FILLER                         PIC  X(08).
  4817         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4818                                                       COMP-3.
  4819         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4820         16  CF-ISSUE-LETTER                PIC  X(4).
  4821         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4822         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4823             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4824             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4825         16  CF-MP-REFUND-CALC              PIC X.
  4826             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4827             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4828             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4829             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4830             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4831             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4832             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4833             88  CF-MP-REFD-MEAN                VALUE '8'.
  4834         16  CF-ALT-RATE-CODE               PIC  X(5).
  4835
  4836
  4837         16  FILLER                         PIC X(498).
  4838****************************************************************
  4839*             MORTGAGE COMPANY MASTER RECORD                   *
  4840****************************************************************
  4841
  4842     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4843         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4844         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4845             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4846             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4847             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4848             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4849             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4850
  4851         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4852         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4853         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4854         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4855         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4856
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  90
* EL6501.cbl
  4857         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4858             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4859         16  CF-MP-RECON-USE-IND            PIC X(1).
  4860             88  CF-MP-USE-RECON             VALUE 'Y'.
  4861         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4862             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4863         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4864             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4865             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4866         16  FILLER                         PIC X(1).
  4867         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4868             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4869         16  CF-MORTG-MIB-VERSION           PIC X.
  4870             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4871             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4872             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4873         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4874             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4875                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4876             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4877                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4878             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4879                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4880             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4881                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4882             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4883                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4884             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4885                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4886         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4887         16  FILLER                         PIC X(7).
  4888         16  CF-MORTG-DESTINATION-SYMBOL.
  4889             20  CF-MORTG-MIB-COMM          PIC X(5).
  4890             20  CF-MORTG-MIB-TERM          PIC X(5).
  4891         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4892             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4893         16  FILLER                         PIC X(03).
  4894         16  CF-MP-CHECK-NO-CONTROL.
  4895             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4896                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4897                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4898                                                ' ' LOW-VALUES.
  4899                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4900                                               VALUE '3'.
  4901         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4902         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4903         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4904             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4905                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4906             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4907                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4908             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4909                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4910             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4911                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4912             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4913                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4914             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  91
* EL6501.cbl
  4915                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4916         16  CF-MORTG-BILLING-AREA.
  4917             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4918                                            PIC X.
  4919         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4920         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4921         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4922         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4923             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4924             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4925         16  FILLER                         PIC X.
  4926         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4927             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4928             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4929         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4930         16  FILLER                         PIC X(8).
  4931         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4932         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4933         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4934         16  CF-ACH-COMPANY-ID.
  4935             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4936                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4937                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4938                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4939             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4940         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4941             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4942         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4943             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4944             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4945         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4946         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4947         16  FILLER                         PIC X(536).
  4948
  4949****************************************************************
  4950*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4951****************************************************************
  4952
  4953     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4954         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4955             20  CF-FEMALE-HEIGHT.
  4956                 24  CF-FEMALE-FT           PIC 99.
  4957                 24  CF-FEMALE-IN           PIC 99.
  4958             20  CF-FEMALE-MIN-WT           PIC 999.
  4959             20  CF-FEMALE-MAX-WT           PIC 999.
  4960         16  FILLER                         PIC X(428).
  4961
  4962     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4963         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4964             20  CF-MALE-HEIGHT.
  4965                 24  CF-MALE-FT             PIC 99.
  4966                 24  CF-MALE-IN             PIC 99.
  4967             20  CF-MALE-MIN-WT             PIC 999.
  4968             20  CF-MALE-MAX-WT             PIC 999.
  4969         16  FILLER                         PIC X(428).
  4970******************************************************************
  4971*             AUTOMATIC ACTIVITY RECORD                          *
  4972******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  92
* EL6501.cbl
  4973     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4974         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4975             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4976             20  CF-SYS-LETTER-ID           PIC X(04).
  4977             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4978             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4979             20  CF-SYS-RESET-SW            PIC X(01).
  4980             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4981             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4982
  4983         16  FILLER                         PIC X(50).
  4984
  4985         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4986             20  CF-USER-ACTIVE-SW          PIC X(01).
  4987             20  CF-USER-LETTER-ID          PIC X(04).
  4988             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4989             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4990             20  CF-USER-RESET-SW           PIC X(01).
  4991             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4992             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4993             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4994
  4995         16  FILLER                         PIC X(246).
  4996*    COPY ERCREIN.
  4997******************************************************************
  4998*                                                                *
  4999*                            ERCREIN                             *
  5000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5001*                            VMOD=2.010                          *
  5002*                                                                *
  5003*   ONLINE CREDIT SYSTEM                                         *
  5004*                                                                *
  5005*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  5006*                                                                *
  5007*   FILE TYPE = VSAM,KSDS                                        *
  5008*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  5009*                                                                *
  5010*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  5011*       ALTERNATE PATH = NONE                                    *
  5012*                                                                *
  5013*   LOG = NO                                                     *
  5014*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5015*                                                                *
  5016******************************************************************
  5017*                   C H A N G E   L O G
  5018*
  5019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5020*-----------------------------------------------------------------
  5021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5022* EFFECTIVE    NUMBER
  5023*-----------------------------------------------------------------
  5024* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  5025* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  5026******************************************************************
  5027 01  REINSURANCE-RECORD.
  5028     12  RE-RECORD-ID                      PIC XX.
  5029         88  VALID-RE-ID                      VALUE 'RE'.
  5030
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  93
* EL6501.cbl
  5031     12  RE-CONTROL-PRIMARY.
  5032         16  RE-COMPANY-CD                 PIC X.
  5033         16  RE-KEY.
  5034             20  RE-CODE                   PIC X.
  5035                 88  RE-TABLE-RECORD          VALUE 'A'.
  5036                 88  RE-COMPANY-RECORD        VALUE 'B'.
  5037             20  RE-TABLE                  PIC XXX.
  5038             20  FILLER                    PIC XXX.
  5039         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  5040             20  FILLER                    PIC X.
  5041             20  RE-COMPANY.
  5042                 24  RE-COMP-PRIME         PIC XXX.
  5043                 24  RE-COMP-SUB           PIC XXX.
  5044
  5045     12  RE-MAINT-INFORMATION.
  5046         16  RE-LAST-MAINT-DT              PIC XX.
  5047         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5048         16  RE-LAST-MAINT-USER            PIC X(4).
  5049         16  FILLER                        PIC X(10).
  5050
  5051     12  RE-TABLE-DATA.
  5052         16  RE-100-COMP                   PIC 99.
  5053
  5054         16  RE-COMP-INFO    OCCURS 30 TIMES.
  5055             20  RE-REI-COMP-NO.
  5056                 24  RE-REI-COMP           PIC XXX.
  5057                 24  RE-REI-COMP-SUB       PIC XXX.
  5058             20  RE-LF-QC                  PIC X.
  5059             20  RE-AH-QC                  PIC X.
  5060             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  5061             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  5062             20  RE-LFAGE-LO               PIC 99.
  5063             20  RE-LFAGE-HI               PIC 99.
  5064             20  RE-AHAGE-LO               PIC 99.
  5065             20  RE-AHAGE-HI               PIC 99.
  5066             20  RE-LFTRM-LO               PIC S999       COMP-3.
  5067             20  RE-LFTRM-HI               PIC S999       COMP-3.
  5068             20  RE-AHTRM-LO               PIC S999       COMP-3.
  5069             20  RE-AHTRM-HI               PIC S999       COMP-3.
  5070             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  5071             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  5072             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  5073             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  5074             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  5075             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  5076             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  5077             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5078             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5079             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5080             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5081             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5082             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5083             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5084             20  RE-LF-BEN-CODE            PIC X.
  5085             20  RE-AH-BEN-CODE            PIC X.
  5086             20  RE-INTERACTIVE            PIC X.
  5087             20  RE-REMAINING              PIC X.
  5088             20  RE-LF-RUNOFF-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  94
* EL6501.cbl
  5089             20  RE-AH-RUNOFF-SW           PIC X.
  5090             20  FILLER                    PIC X(19).
  5091
  5092         16  RE-COMP-INFO-END              PIC X(6).
  5093         16  RE-NSP-ST-CD-LF               PIC XX.
  5094         16  RE-NSP-ST-CD-AH               PIC XX.
  5095         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5096             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5097
  5098         16  FILLER                        PIC X(27).
  5099
  5100     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5101         16  RE-NAME                       PIC X(30).
  5102         16  RE-LF-PE                      PIC X.
  5103         16  RE-AH-PE                      PIC X.
  5104         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5105         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5106         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5107         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5108         16  RE-PRT-ST                     PIC X.
  5109         16  RE-PRT-OW                     PIC X.
  5110         16  RE-MORT-CODE                  PIC X(4).
  5111         16  RE-CLAIM-CODE                 PIC X.
  5112         16  RE-ZERO-LF-FEE                PIC X.
  5113         16  RE-ZERO-AH-FEE                PIC X.
  5114         16  RE-CEDE-NAME                  PIC X(30).
  5115         16  RE-LF-COMM                    PIC X.
  5116         16  RE-AH-COMM                    PIC X.
  5117         16  RE-LF-TAX                     PIC X.
  5118         16  RE-AH-TAX                     PIC X.
  5119         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5120         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5121         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5122
  5123         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5124             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5125
  5126         16  RE-LF-CEDING-FEE-BRACKETS.
  5127             20  RE-LF-FEE-METHOD          PIC X.
  5128                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5129                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5130                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5131                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5132             20  RE-LF-FEE-BASIS           PIC X.
  5133                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5134                 88  RE-LF-NET-CEDED               VALUE '2'.
  5135                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5136                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5137                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5138                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5139                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5140                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5141             20  FILLER                    PIC XXX.
  5142             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5143                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5144                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5145
  5146         16  RE-AH-CEDING-FEE-BRACKETS.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  95
* EL6501.cbl
  5147             20  RE-AH-FEE-METHOD          PIC X.
  5148                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5149                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5150                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5151                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5152             20  RE-AH-FEE-BASIS           PIC X.
  5153                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5154                 88  RE-AH-NET-CEDED               VALUE '2'.
  5155                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5156                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5157                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5158                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5159                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5160                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  5161             20  FILLER                    PIC XXX.
  5162             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5163                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5164                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5165
  5166         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5167
  5168         16  RE-OLD-CEDING-STMT            PIC X.
  5169
  5170         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5171         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5172         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5173         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5174         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5175         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5176         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5177         16  RE-MORT-SW                    PIC X.
  5178         16  RE-CEDING-TYPE-FLAG           PIC X.
  5179             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5180             88  RE-CEDED                          VALUE 'C'.
  5181             88  RE-ASSUMED                        VALUE 'A'.
  5182             88  RE-PHANTOM                        VALUE 'P'.
  5183
  5184         16  RE-CEDING-STMT-OPT-A          PIC X.
  5185             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5186         16  RE-CEDING-STMT-OPT-B          PIC X.
  5187             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5188         16  RE-CEDING-STMT-OPT-C          PIC X.
  5189             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5190         16  RE-CEDING-STMT-OPT-D          PIC X.
  5191             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5192         16  RE-CEDING-STMT-OPT-E          PIC X.
  5193             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5194
  5195         16  RE-PRT-CRSV                   PIC X.
  5196
  5197         16  RE-GL-CENTER                  PIC X(4).
  5198
  5199         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5200
  5201         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5202
  5203         16  RE-EARN-STOP-CODE             PIC X.
  5204             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  96
* EL6501.cbl
  5205             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5206
  5207         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5208             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5209
  5210         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5211         16  FILLER                        PIC X(2281).
  5212
  5213         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5214
  5215******************************************************************
  5216*    COPY ERCCTBL.
  5217******************************************************************
  5218*                                                                *
  5219*                                                                *
  5220*                            ERCCTBL                             *
  5221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5222*                            VMOD=2.003
  5223*                                                                *
  5224*   ONLINE CREDIT SYSTEM                                         *
  5225*                                                                *
  5226*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5227*                                                                *
  5228*   FILE TYPE = VSAM,KSDS                                        *
  5229*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5230*                                                                *
  5231*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5232*       ALTERNATE PATH = NONE                                    *
  5233*                                                                *
  5234*   LOG = NO                                                     *
  5235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5236*                                                                *
  5237*                                                                *
  5238******************************************************************
  5239
  5240 01  COMM-TABLE-RECORD.
  5241     12  CT-RECORD-ID                      PIC XX.
  5242         88  VALID-CT-ID                      VALUE 'CT'.
  5243
  5244     12  CT-CONTROL-PRIMARY.
  5245         16  CT-COMPANY-CD                 PIC X.
  5246         16  CT-TABLE                      PIC XXX.
  5247         16  CT-CNTRL-2.
  5248             20  CT-BEN-TYPE               PIC X.
  5249             20  CT-BEN-CODE               PIC XX.
  5250
  5251     12  CT-MAINT-INFORMATION.
  5252         16  CT-LAST-MAINT-DT              PIC XX.
  5253         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5254         16  CT-LAST-MAINT-USER            PIC X(4).
  5255         16  FILLER                        PIC X(31).
  5256
  5257     12  CT-LIMITS.
  5258         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5259
  5260         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5261
  5262         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  97
* EL6501.cbl
  5263
  5264     12  CT-RATES.
  5265         16  CT-RTX          OCCURS 27 TIMES.
  5266             20  CT-RT                     PIC SV9(5)     COMP-3.
  5267             20  CT-RT-R   REDEFINES
  5268                 CT-RT                     PIC XXX.
  5269
  5270     12  FILLER                            PIC  X(42).
  5271
  5272******************************************************************
  5273*                                COPY ERCACNT.
  5274******************************************************************
  5275*                                                                *
  5276*                                                                *
  5277*                            ERCACNT.                            *
  5278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5279*                            VMOD=2.002                          *
  5280*                                                                *
  5281*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5282*                                                                *
  5283*   FILE TYPE = VSAM,KSDS                                        *
  5284*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5285*                                                                *
  5286*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5287*       ALTERNATE INDEX = NONE                                   *
  5288*                                                                *
  5289*                                                                *
  5290*   LOG = YES                                                    *
  5291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5292******************************************************************
  5293*                   C H A N G E   L O G
  5294*
  5295* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5296*-----------------------------------------------------------------
  5297*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5298* EFFECTIVE    NUMBER
  5299*-----------------------------------------------------------------
  5300* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5301*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5302******************************************************************
  5303 01  NOTE-FILE.
  5304     12  NT-FILE-ID                  PIC XX.
  5305         88  VALID-NOTE-ID              VALUE 'NT'.
  5306
  5307     12  NT-CONTROL-PRIMARY.
  5308         16  NT-COMPANY-CD           PIC X.
  5309         16  NT-ACCT-NOTE-KEY.
  5310             18  NT-CARRIER              PIC X.
  5311             18  NT-GROUPING             PIC X(06).
  5312             18  NT-STATE                PIC XX.
  5313             18  NT-ACCOUNT              PIC X(10).
  5314         16  NT-RECORD-TYPE          PIC X.
  5315              88  ACCT-NOTE          VALUE '1'.
  5316              88  ACCT-BRANCH-LOC    VALUE '2'.
  5317              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5318         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5319
  5320     12  NT-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  98
* EL6501.cbl
  5321     12  NT-LAST-MAINT-BY            PIC X(4).
  5322     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5323
  5324*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5325*     SEQUENCE NUMBERS
  5326     12  NT-NOTE-INFORMATION.
  5327         16  NT-NOTE-LINE            PIC X(60).
  5328         16  FILLER                  PIC X(25).
  5329*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5330     12  NT-LOCATION-INFORMATION REDEFINES
  5331                         NT-NOTE-INFORMATION.
  5332         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5333         16  FILLER                  PIC X(25).
  5334*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5335*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5336*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5337*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5338*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5339*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5340*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5341     12  NT-SHIPPING-INFORMATION REDEFINES
  5342                         NT-NOTE-INFORMATION.
  5343         16  NT-SHIPPING-LINE        PIC X(60).
  5344         16  NT-SHIP-STATE           PIC XX.
  5345         16  NT-SHIP-ZIP             PIC X(10).
  5346         16  FILLER                  PIC X(13).
  5347*****************************************************************
  5348
  5349 01  COMMISSION-WORK-AREA.
  5350     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5351         10  WK-AM-AGT           PIC X(10).
  5352         10  WK-AM-TYPE          PIC X.
  5353         10  WK-FILLER           PIC X(13).
  5354         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page  99
* EL6501.cbl
  5356*    COPY ERCCOMP.
  5357******************************************************************
  5358*                                                                *
  5359*                                                                *
  5360*                            ERCCOMP                             *
  5361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5362*                            VMOD=2.019                          *
  5363*                                                                *
  5364*   ONLINE CREDIT SYSTEM                                         *
  5365*                                                                *
  5366*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5367*                                                                *
  5368*   FILE TYPE = VSAM,KSDS                                        *
  5369*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5370*                                                                *
  5371*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5372*       ALTERNATE PATH = NONE                                    *
  5373*                                                                *
  5374*   LOG = NO                                                     *
  5375*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5376*                                                                *
  5377******************************************************************
  5378*                   C H A N G E   L O G
  5379*
  5380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5381*-----------------------------------------------------------------
  5382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5383* EFFECTIVE    NUMBER
  5384*-----------------------------------------------------------------
  5385* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5386* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5387* 092205    2005050300006  PEMA  ADD LEASE FEE
  5388* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5389* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5390* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5391* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5392* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5393* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5394******************************************************************
  5395
  5396 01  COMPENSATION-MASTER.
  5397     12  CO-RECORD-ID                          PIC XX.
  5398         88  VALID-CO-ID                          VALUE 'CO'.
  5399
  5400     12  CO-CONTROL-PRIMARY.
  5401         16  CO-COMPANY-CD                     PIC X.
  5402         16  CO-CONTROL.
  5403             20  CO-CTL-1.
  5404                 24  CO-CARR-GROUP.
  5405                     28  CO-CARRIER            PIC X.
  5406                     28  CO-GROUPING.
  5407                         32  CO-GROUP-PREFIX   PIC XXX.
  5408                         32  CO-GROUP-PRIME    PIC XXX.
  5409                 24  CO-RESP-NO.
  5410                     28  CO-RESP-PREFIX        PIC X(4).
  5411                     28  CO-RESP-PRIME         PIC X(6).
  5412             20  CO-CTL-2.
  5413                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 100
* EL6501.cbl
  5414                     28  CO-ACCT-PREFIX        PIC X(4).
  5415                     28  CO-ACCT-PRIME         PIC X(6).
  5416         16  CO-TYPE                           PIC X.
  5417             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5418             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5419             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5420
  5421     12  CO-MAINT-INFORMATION.
  5422         16  CO-LAST-MAINT-DT                  PIC XX.
  5423         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5424         16  CO-LAST-MAINT-USER                PIC X(4).
  5425     12  FILLER                                PIC XX.
  5426     12  CO-STMT-TYPE                          PIC XXX.
  5427     12  CO-COMP-TYPE                          PIC X.
  5428         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5429     12  CO-STMT-OWNER                         PIC X(4).
  5430     12  CO-BALANCE-CONTROL                    PIC X.
  5431         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5432         88  CO-NO-BALANCE                        VALUE 'N'.
  5433
  5434     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5435         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5436         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5437         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5438
  5439     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5440         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5441         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5442
  5443     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5444     12  CO-GA-DIRECT-DEP                      PIC X.
  5445     12  CO-FUTURE-SPACE                       PIC X.
  5446         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5447
  5448     12  CO-ACCT-NAME                          PIC X(30).
  5449     12  CO-MAIL-NAME                          PIC X(30).
  5450     12  CO-ADDR-1                             PIC X(30).
  5451     12  CO-ADDR-2                             PIC X(30).
  5452     12  CO-ADDR-3.
  5453         16  CO-ADDR-CITY                      PIC X(27).
  5454         16  CO-ADDR-STATE                     PIC XX.
  5455     12  CO-CSO-1099                           PIC X.
  5456     12  CO-ZIP.
  5457         16  CO-ZIP-PRIME.
  5458             20  CO-ZIP-PRI-1ST                PIC X.
  5459                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5460             20  FILLER                        PIC X(4).
  5461         16  CO-ZIP-PLUS4                      PIC X(4).
  5462     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5463         16  CO-CAN-POSTAL-1                   PIC XXX.
  5464         16  CO-CAN-POSTAL-2                   PIC XXX.
  5465         16  FILLER                            PIC XXX.
  5466     12  CO-SOC-SEC                            PIC X(13).
  5467     12  CO-TELEPHONE.
  5468         16  CO-AREA-CODE                      PIC XXX.
  5469         16  CO-PREFIX                         PIC XXX.
  5470         16  CO-PHONE                          PIC X(4).
  5471
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 101
* EL6501.cbl
  5472     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5473
  5474     12  CO-AR-BAL-LEVEL                       PIC X.
  5475         88  CO-AR-REF-LVL                        VALUE '1'.
  5476         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5477         88  CO-AR-BILL-LVL                       VALUE '2'.
  5478         88  CO-AR-AGT-LVL                        VALUE '3'.
  5479         88  CO-AR-FR-LVL                         VALUE '4'.
  5480
  5481     12  CO-AR-NORMAL-PRINT                    PIC X.
  5482         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5483         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5484
  5485     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5486
  5487     12  CO-AR-REPORTING                       PIC X.
  5488         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5489         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5490
  5491     12  CO-AR-PULL-CHECK                      PIC X.
  5492         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5493         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5494
  5495     12  CO-AR-BALANCE-PRINT                   PIC X.
  5496         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5497
  5498     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5499         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5500         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5501         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5502
  5503     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5504
  5505     12  CO-USER-CODE                          PIC X.
  5506     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5507
  5508******************************************************************
  5509*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5510*    THE LAST MONTH END RUN.
  5511******************************************************************
  5512
  5513     12  CO-LAST-ACTIVITY-DATE.
  5514         16  CO-ACT-YEAR                       PIC 99.
  5515         16  CO-ACT-MONTH                      PIC 99.
  5516         16  CO-ACT-DAY                        PIC 99.
  5517
  5518     12  CO-LAST-STMT-DT.
  5519         16  CO-LAST-STMT-YEAR                 PIC 99.
  5520         16  CO-LAST-STMT-MONTH                PIC 99.
  5521         16  CO-LAST-STMT-DAY                  PIC 99.
  5522
  5523     12  CO-MO-END-TOTALS.
  5524         16  CO-MONTHLY-TOTALS.
  5525             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5526             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5527             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5528             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5529             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 102
* EL6501.cbl
  5530
  5531         16  CO-AGING-TOTALS.
  5532             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5533             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5534             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5535             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5536
  5537         16  CO-YTD-TOTALS.
  5538             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5539             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5540
  5541         16  CO-OVER-UNDER-TOTALS.
  5542             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5543             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5544
  5545     12  CO-MISCELLANEOUS-TOTALS.
  5546         16  CO-FICA-TOTALS.
  5547             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5548             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5549
  5550         16  CO-CLAIM-TOTALS.
  5551             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5552             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5553
  5554******************************************************************
  5555*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5556*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5557******************************************************************
  5558
  5559     12  CO-CURRENT-TOTALS.
  5560         16  CO-CURRENT-LAST-STMT-DT.
  5561             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5562             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5563             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5564
  5565         16  CO-CURRENT-MONTHLY-TOTALS.
  5566             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5567             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5568             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5569             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5570             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5571
  5572         16  CO-CURRENT-AGING-TOTALS.
  5573             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5574             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5575             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5576             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5577
  5578         16  CO-CURRENT-YTD-TOTALS.
  5579             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5580             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5581
  5582     12  CO-PAID-COMM-TOTALS.
  5583         16  CO-YTD-PAID-COMMS.
  5584             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5585             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5586
  5587     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 103
* EL6501.cbl
  5588         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5589         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5590
  5591     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5592         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5593         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5594         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5595         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5596         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5597         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5598         88  CO-FINAL-LETTER                  VALUE 'F'.
  5599         88  CO-RECONCILING                   VALUE 'R'.
  5600         88  CO-PHONE-CALL                    VALUE 'P'.
  5601         88  CO-LEGAL                         VALUE 'L'.
  5602         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5603         88  CO-WRITE-OFF                     VALUE 'W'.
  5604         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5605
  5606     12  CO-CSR-CODE                       PIC X(4).
  5607
  5608     12  CO-GA-STATUS-INFO.
  5609         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5610         16  CO-GA-TERMINATION-DT          PIC XX.
  5611         16  CO-GA-STATUS-CODE             PIC X.
  5612             88  CO-GA-ACTIVE                 VALUE 'A'.
  5613             88  CO-GA-INACTIVE               VALUE 'I'.
  5614             88  CO-GA-PENDING                VALUE 'P'.
  5615         16  CO-GA-COMMENTS.
  5616             20  CO-GA-COMMENT-1           PIC X(40).
  5617             20  CO-GA-COMMENT-2           PIC X(40).
  5618             20  CO-GA-COMMENT-3           PIC X(40).
  5619             20  CO-GA-COMMENT-4           PIC X(40).
  5620
  5621     12  CO-RPTCD2                         PIC X(10).
  5622     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5623         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5624         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5625
  5626     12  CO-TYPE-AGENT                     PIC X(01).
  5627         88  CO-CORPORATION                   VALUE 'C'.
  5628         88  CO-PARTNERSHIP                   VALUE 'P'.
  5629         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5630         88  CO-TRUST                         VALUE 'T'.
  5631         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5632
  5633     12  CO-FAXNO.
  5634         16  CO-FAX-AREA-CODE                  PIC XXX.
  5635         16  CO-FAX-PREFIX                     PIC XXX.
  5636         16  CO-FAX-PHONE                      PIC X(4).
  5637
  5638     12  CO-BANK-INFORMATION.
  5639         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5640         16  CO-BANK-TRANSIT-NON REDEFINES
  5641             CO-BANK-TRANSIT-NO                PIC 9(8).
  5642
  5643         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5644     12  CO-MISC-DEDUCT-INFO REDEFINES
  5645                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 104
* EL6501.cbl
  5646         16  CO-MD-GL-ACCT                     PIC X(10).
  5647         16  CO-MD-DIV                         PIC XX.
  5648         16  CO-MD-CENTER                      PIC X(4).
  5649         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5650         16  CO-CREATE-AP-CHECK                PIC X.
  5651         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5652         16  FILLER                            PIC XXX.
  5653     12  CO-ACH-STATUS                         PIC X.
  5654         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5655         88  CO-ACH-PENDING                        VALUE 'P'.
  5656
  5657     12  CO-BILL-SW                            PIC X.
  5658     12  CO-CONTROL-NAME                       PIC X(30).
  5659     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5660     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5661     12  CO-CLP-STATE                          PIC XX.
  5662     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5663     12  CO-SPP-REFUND-EDIT                    PIC X.
  5664
  5665******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 105
* EL6501.cbl
  5667*    COPY ERCNAME.
  5668******************************************************************
  5669*                                                                *
  5670*                                                                *
  5671*                            ERCNAME                             *
  5672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5673*                            VMOD=2.003                          *
  5674*                                                                *
  5675*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5676*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5677*                                                                *
  5678*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5679*                                                                *
  5680*   FILE TYPE = VSAM,KSDS                                        *
  5681*   RECORD SIZE = 160   RECFORM = FIX                            *
  5682*                                                                *
  5683*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5684*                                                                *
  5685*   LOG = NO                                                     *
  5686*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5687*                                                                *
  5688*                                                                *
  5689******************************************************************
  5690
  5691 01  NAME-LOOKUP-MASTER.
  5692     12  NL-RECORD-ID                PIC  X(02).
  5693         88  VALID-NL-ID                         VALUE 'NL'.
  5694
  5695     12  NL-RECORD-KEY.
  5696         16  NL-CONTROL-PRIMARY.
  5697             20  NL-COMPANY-CD       PIC  X(01).
  5698             20  NL-NAME             PIC  X(30).
  5699             20  NL-RECORD-TYPE      PIC  X(01).
  5700                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5701                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5702                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5703
  5704         16  NL-ACCOUNT-MASTER.
  5705             20  NL-AM-COMPANY-CD    PIC  X(01).
  5706             20  NL-AM-CARRIER       PIC  X(01).
  5707             20  NL-AM-GROUPING      PIC  X(06).
  5708             20  NL-AM-STATE         PIC  X(02).
  5709             20  NL-AM-ACCOUNT       PIC  X(10).
  5710             20  FILLER              PIC  X(09).
  5711
  5712         16  NL-COMPENSATION-MASTER
  5713                                 REDEFINES  NL-ACCOUNT-MASTER.
  5714             20  NL-CO-COMPANY-CD    PIC  X(01).
  5715             20  NL-CO-CARRIER       PIC  X(01).
  5716             20  NL-CO-GROUPING      PIC  X(06).
  5717             20  NL-CO-RESP-NO       PIC  X(10).
  5718             20  NL-CO-ACCOUNT       PIC  X(10).
  5719             20  NL-CO-TYPE          PIC  X(01).
  5720
  5721         16  NL-REINSURANCE-RECORD
  5722                                 REDEFINES  NL-ACCOUNT-MASTER.
  5723             20  NL-RE-COMPANY-CD    PIC  X(01).
  5724             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 106
* EL6501.cbl
  5725             20  NL-RE-COMPANY.
  5726                 24  NL-RE-COMP      PIC  X(03).
  5727                 24  NL-RE-CO-SUB    PIC  X(03).
  5728             20  NL-RE-TABLE         PIC  X(03).
  5729             20  FILLER              PIC  X(18).
  5730
  5731     12  NL-MAINT-INFORMATION.
  5732         16  NL-LAST-MAINT-DT        PIC  X(02).
  5733         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5734         16  NL-LAST-MAINT-USER      PIC  X(04).
  5735         16  FILLER                  PIC  X(10).
  5736
  5737     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5738         16  NL-RE-LEVEL             PIC  9(02).
  5739
  5740     12  NL-CITY                     PIC  X(15).
  5741     12  NL-ST                       PIC  XX.
  5742
  5743******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 107
* EL6501.cbl
  5745*    COPY ERCRQST.
  5746******************************************************************
  5747*                                                                *
  5748*                                                                *
  5749*                            ERCRQST.                            *
  5750*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5751*                            VMOD=2.002                          *
  5752*                                                                *
  5753*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5754*                                                                *
  5755*   FILE TYPE = VSAM,KSDS                                        *
  5756*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5757*                                                                *
  5758*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5759*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5760*                                   ACCOUNT, REF, BATCH)         *
  5761*                                                RKP=9, LEN=38   *
  5762*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5763*                                   ACCOUNT, REF, BATCH)         *
  5764*                                                RKP=47, LEN=46  *
  5765*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5766*                                   BATCH)                       *
  5767*                                                RKP=93, LEN=24  *
  5768*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5769*                                   REF, BATCH)                  *
  5770*                                                RKP=117, LEN=35 *
  5771*   LOG = NO                                                     *
  5772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5773******************************************************************
  5774
  5775 01  AR-REQUEST-RECORD.
  5776     12  RQ-RECORD-ID                     PIC XX.
  5777         88  VALID-RQ-ID                        VALUE 'RQ'.
  5778
  5779     12  RQ-CONTROL-PRIMARY.
  5780         16  RQ-COMPANY-CD                PIC X.
  5781         16  RQ-ENTRY-BATCH               PIC X(6).
  5782
  5783     12  RQ-CONTROL-BY-ACCT-REF.
  5784         16  RQ-COMPANY-CD-A1             PIC X.
  5785         16  RQ-CARRIER-A1                PIC X.
  5786         16  RQ-GROUPING-A1               PIC X(6).
  5787         16  RQ-STATE-A1                  PIC XX.
  5788         16  RQ-ACCOUNT-A1                PIC X(10).
  5789         16  RQ-REFERENCE-A1              PIC X(12).
  5790         16  RQ-BATCH-A1                  PIC X(6).
  5791
  5792     12  RQ-CONTROL-BY-FIN-RESP.
  5793         16  RQ-COMPANY-CD-A2             PIC X.
  5794         16  RQ-CARRIER-A2                PIC X.
  5795         16  RQ-GROUPING-A2               PIC X(6).
  5796         16  RQ-FIN-RESP-A2               PIC X(10).
  5797         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5798         16  RQ-REFERENCE-A2              PIC X(12).
  5799         16  RQ-BATCH-A2                  PIC X(6).
  5800
  5801     12  RQ-CONTROL-BY-ACCT-AGENT.
  5802         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 108
* EL6501.cbl
  5803         16  RQ-CARRIER-A3                PIC X.
  5804         16  RQ-GROUPING-A3               PIC X(6).
  5805         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5806         16  RQ-BATCH-A3                  PIC X(6).
  5807
  5808     12  RQ-CONTROL-BY-SUMMARY.
  5809         16  RQ-COMPANY-CD-A4             PIC X.
  5810         16  RQ-SUMMARY-CODE              PIC X(6).
  5811         16  RQ-ACCOUNT-A4                PIC X(10).
  5812         16  RQ-REFERENCE-A4              PIC X(12).
  5813         16  RQ-BATCH-A4                  PIC X(6).
  5814
  5815     12  RQ-REQUEST-METHOD                PIC X.
  5816         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5817         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5818         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5819         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5820     12  FILLER                           PIC X.
  5821     12  RQ-STATUS                        PIC X.
  5822         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5823         88  RQ-RESUBMIT                      VALUE 'R'.
  5824     12  RQ-PROCESSOR-ID                  PIC X(4).
  5825     12  RQ-ENTRY-DT                      PIC XX.
  5826     12  RQ-MO-END-DT                     PIC XX.
  5827     12  RQ-REQUEST-DT                    PIC XX.
  5828     12  RQ-STMT-DT                       PIC XX.
  5829     12  RQ-REVERSAL-DT                   PIC XX.
  5830     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5831     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5832
  5833     12  FILLER                           PIC X(27).
  5834
  5835******************************************************************
  5836
  5837*EJECT
  5838*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 109
* EL6501.cbl
  5840 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5841                          PRODUCT-MASTER CONTROL-FILE
  5842                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5843                          NOTE-FILE COMMISSION-WORK-AREA
  5844                          COMPENSATION-MASTER
  5845                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5846 0000-DFHEXIT SECTION.
  5847     MOVE '9#                    $   ' TO DFHEIV0.
  5848     MOVE 'EL6501' TO DFHEIV1.
  5849     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5850     MOVE EIBTRMID              TO QID-TERM.
  5851
  5852     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5853     MOVE '5'                   TO DC-OPTION-CODE.
  5854     PERFORM 9700-DATE-LINK.
  5855     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5856     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5857
  5858***  Y2K PROJ 7744
  5859     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5860                                    CURRENT-SAVE
  5861     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5862                                    CURRENT-SAVE(1:2)
  5863***  Y2K PROJ 7744
  5864
  5865     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5866     IF EIBCALEN = 0
  5867         GO TO 8800-UNAUTHORIZED-ACCESS.
  5868
  5869     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5870     MOVE LOW-VALUES             TO EL6501AI.
  5871
  5872
  5873* EXEC CICS HANDLE CONDITION
  5874*        PGMIDERR  (9600-PGMID-ERROR)
  5875*        ERROR     (9990-ABEND)
  5876*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5877*    END-EXEC.
  5878*    MOVE '"$L.N                 ! " #00005868' TO DFHEIV0
  5879     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5881     MOVE X'2220233030303035383638' TO DFHEIV0(25:11)
  5882     CALL 'kxdfhei1' USING DFHEIV0
  5883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5884
  5885
  5886     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5887         IF PI-CALLING-PROGRAM = XCTL-650
  5888             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5889             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5890             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5891             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5892             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5893             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5894             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5895             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5896             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5897             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 110
* EL6501.cbl
  5898         ELSE
  5899             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5900             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5901             GO TO 0600-DISPLAY-RECORD.
  5902
  5903     IF EIBAID = DFHCLEAR
  5904         GO TO 9400-CLEAR.
  5905
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 111
* EL6501.cbl
  5907 0200-RECEIVE.
  5908     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5909         MOVE ER-0008            TO EMI-ERROR
  5910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5911         MOVE -1                 TO PFENTERL
  5912         GO TO 8200-SEND-DATAONLY.
  5913
  5914
  5915* EXEC CICS RECEIVE
  5916*        MAP      (MAP-NAME)
  5917*        MAPSET   (MAPSET-NAME)
  5918*        INTO     (EL6501AI)
  5919*    END-EXEC.
  5920     MOVE LENGTH OF
  5921      EL6501AI
  5922       TO DFHEIV11
  5923*    MOVE '8"T I  L              ''   #00005902' TO DFHEIV0
  5924     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5926     MOVE X'2020233030303035393032' TO DFHEIV0(25:11)
  5927     CALL 'kxdfhei1' USING DFHEIV0,
  5928           MAP-NAME,
  5929           EL6501AI,
  5930           DFHEIV11,
  5931           MAPSET-NAME,
  5932           DFHEIV99,
  5933           DFHEIV99
  5934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5935
  5936
  5937     IF PFENTERL = 0
  5938         GO TO 0300-CHECK-PFKEYS.
  5939     IF EIBAID NOT = DFHENTER
  5940         MOVE ER-0004            TO EMI-ERROR
  5941         GO TO 0320-INPUT-ERROR.
  5942     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5943         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5944     ELSE
  5945         MOVE ER-0029            TO EMI-ERROR
  5946         GO TO 0320-INPUT-ERROR.
  5947
  5948 0300-CHECK-PFKEYS.
  5949     IF EIBAID = DFHPF23
  5950         GO TO 8810-PF23.
  5951     IF EIBAID = DFHPF24
  5952         GO TO 9200-RETURN-MAIN-MENU.
  5953     IF EIBAID = DFHPF12
  5954         GO TO 9500-PF12.
  5955
  5956* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5957*             MASTER(ERRESC)
  5958*
  5959*    IF  EIBAID = DFHPF10
  5960*        IF PI-COMPANY-ID = 'DMD'
  5961*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5962*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5963*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5964*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 112
* EL6501.cbl
  5965*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5966*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5967*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5968*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5969*           MOVE XCTL-608           TO PGM-NAME
  5970*                                      PI-RETURN-TO-PROGRAM
  5971*                                      PI-CALLING-PROGRAM
  5972*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5973*           GO TO 9300-XCTL.
  5974
  5975     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5976                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5977                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5978         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5979             MOVE ER-0029        TO  EMI-ERROR
  5980             GO TO 0320-INPUT-ERROR
  5981         ELSE
  5982             GO TO 0800-CHECK-MAINT.
  5983
  5984     IF EIBAID = DFHENTER
  5985         GO TO 0330-EDIT-DATA.
  5986
  5987     MOVE ER-0029                TO EMI-ERROR.
  5988
  5989 0320-INPUT-ERROR.
  5990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5991     MOVE AL-UNBON               TO PFENTERA.
  5992     MOVE -1                     TO PFENTERL.
  5993     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 113
* EL6501.cbl
  5995 0330-EDIT-DATA.
  5996     IF MAINTI  = 'S'
  5997        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5998        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5999        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  6000        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  6001        MOVE -1                  TO MAINTL
  6002        GO TO 8100-SEND-INITIAL-MAP.
  6003
  6004     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  6005     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  6006
  6007     IF EMI-ERROR NOT = ZEROS
  6008         MOVE -1                 TO MAINTL
  6009         GO TO 8200-SEND-DATAONLY.
  6010
  6011     IF NOT MODIFY-CAP
  6012         MOVE 'UPDATE'           TO SM-READ
  6013         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6014         MOVE ER-0070            TO EMI-ERROR
  6015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6016         GO TO 8100-SEND-INITIAL-MAP.
  6017
  6018     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  6019
  6020     IF MAINTI = 'A'
  6021        GO TO 1000-ADD-A-RECORD.
  6022
  6023     IF MAINTI = 'C'
  6024        IF PI-SV-MAINT  =  'L'
  6025            MOVE -1             TO MAINTL
  6026            MOVE AL-UABON       TO MAINTA
  6027            MOVE ER-0899        TO EMI-ERROR
  6028            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6029            GO TO 8200-SEND-DATAONLY
  6030        ELSE
  6031            GO TO 2000-CHANGE-A-RECORD.
  6032
  6033     IF MAINTI = 'L'
  6034        MOVE 'L'                TO PI-SV-MAINT
  6035        GO TO 3000-CHANGE-ALL-RECORDS.
  6036
  6037     MOVE ER-0023                TO EMI-ERROR.
  6038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6039     MOVE -1                     TO MAINTL.
  6040     MOVE AL-UABON               TO MAINTA.
  6041     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 114
* EL6501.cbl
  6043 0500-CHECK-MAINT-TYPE.
  6044     IF PI-MAINT = 'A'
  6045        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  6046        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  6047        MOVE -1                  TO NAMEL
  6048        GO TO 8100-SEND-INITIAL-MAP.
  6049
  6050 0600-DISPLAY-RECORD.
  6051     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  6052     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  6053     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6054     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  6055
  6056     IF PI-MAINT = 'A'
  6057        MOVE -1                  TO NAMEL
  6058     ELSE
  6059        MOVE -1                  TO MAINTL.
  6060
  6061     GO TO 8100-SEND-INITIAL-MAP.
  6062
  6063 0700-FORMAT-KEYDATA.
  6064     MOVE PI-MAINT               TO MAINTI.
  6065
  6066     IF PI-MAINT = 'A'
  6067        MOVE AL-PANON            TO MAINTA
  6068        SET T-INDEX TO 1
  6069     ELSE
  6070        SET T-INDEX              TO PI-LINE-SELECTED
  6071        MOVE AL-UANON            TO MAINTA.
  6072
  6073     IF PI-2ND-PAGE
  6074         SET T-INDEX UP BY 8
  6075     ELSE
  6076     IF PI-3RD-PAGE
  6077         SET T-INDEX UP BY 16
  6078     ELSE
  6079     IF PI-LST-PAGE
  6080         SET T-INDEX UP BY 24.
  6081
  6082     MOVE PI-ACCT-CARRIER        TO CARRI.
  6083     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6084     MOVE PI-ACCT-STATE          TO STATEI.
  6085     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6086
  6087     IF PI-ACCT-EXP-DT = LOW-VALUES
  6088        MOVE SPACES              TO EXPDTEI
  6089     ELSE
  6090        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6091           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6092           MOVE SPACE               TO DC-OPTION-CODE
  6093           PERFORM 9700-DATE-LINK
  6094           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6095        ELSE
  6096           MOVE 999999              TO EXPDTEO
  6097           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6098
  6099***DMD CUSTOM CODE *****START
  6100     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 115
* EL6501.cbl
  6101     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6102     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6103     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6104        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6105     ELSE
  6106        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6107***DMD CUSTOM CODE *****END
  6108
  6109     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6110     MOVE SPACE                   TO DC-OPTION-CODE.
  6111     PERFORM 9700-DATE-LINK.
  6112     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6113
  6114 0700-EXIT.
  6115      EXIT.
  6116
  6117 0800-CHECK-MAINT.
  6118     IF PI-MAINT = 'A'
  6119        IF PI-RECORD-NOT-CREATED
  6120           MOVE ER-2071          TO EMI-ERROR
  6121           MOVE  -1              TO NAMEL
  6122           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6123           GO TO 8200-SEND-DATAONLY.
  6124
  6125     IF  EIBAID = DFHPF1
  6126             AND
  6127         CREDIT-SESSION
  6128         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6129         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6130         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6131         MOVE PI-ACCT-STATE      TO PI-STATE
  6132         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6133         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6134         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6135         MOVE XCTL-689           TO PGM-NAME
  6136         GO TO 9300-XCTL.
  6137
  6138     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6139         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6140         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6141         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6142         MOVE PI-ACCT-STATE      TO PI-STATE
  6143         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6144         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6145         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6146         MOVE XCTL-690           TO PGM-NAME
  6147         GO TO 9300-XCTL
  6148     END-IF.
  6149
  6150     IF EIBAID = DFHPF3
  6151             AND
  6152         CREDIT-SESSION
  6153         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6154         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6155         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6156         MOVE PI-ACCT-STATE      TO PI-STATE
  6157         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6158         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 116
* EL6501.cbl
  6159         MOVE XCTL-653           TO PGM-NAME
  6160         GO TO 9300-XCTL.
  6161
  6162     IF EIBAID = DFHPF4
  6163         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6164         MOVE XCTL-652           TO PGM-NAME
  6165         GO TO 9300-XCTL.
  6166
  6167     IF EIBAID = DFHPF5
  6168         MOVE XCTL-6502          TO PGM-NAME
  6169         GO TO 9300-XCTL.
  6170
  6171     IF EIBAID = DFHPF7
  6172         MOVE XCTL-6504          TO PGM-NAME
  6173         GO TO 9300-XCTL.
  6174
  6175     IF EIBAID = DFHPF8
  6176         MOVE XCTL-6506          TO PGM-NAME
  6177         GO TO 9300-XCTL.
  6178
  6179     IF EIBAID = DFHPF9
  6180        MOVE XCTL-6505           TO PGM-NAME
  6181        GO TO 9300-XCTL.
  6182
  6183     IF EIBAID = DFHPF10
  6184        IF PI-COMPANY-ID = 'DMD'
  6185           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6186           MOVE XCTL-608         TO PGM-NAME
  6187           GO TO 9300-XCTL.
  6188
  6189     MOVE ER-0029                TO EMI-ERROR.
  6190     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6191     MOVE AL-UNBON               TO PFENTERA.
  6192     MOVE -1                     TO PFENTERL.
  6193     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 117
* EL6501.cbl
  6195 1000-ADD-A-RECORD.
  6196     IF PI-MAINT = 'A'
  6197        PERFORM 4000-EDITS THRU 4900-EXIT
  6198     ELSE
  6199        MOVE ER-2180             TO EMI-ERROR
  6200        MOVE -1                  TO MAINTL
  6201        MOVE AL-UABON            TO MAINTA
  6202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6203
  6204     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6205        EMI-FATAL-CTR    GREATER ZERO
  6206         GO TO 8200-SEND-DATAONLY.
  6207
  6208
  6209* EXEC CICS GETMAIN
  6210*         LENGTH   (ACCT-REC-LEN)
  6211*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6212*         INITIMG  (GETMAIN-SPACE)
  6213*    END-EXEC.
  6214*    MOVE ',"IL                  $   #00006179' TO DFHEIV0
  6215     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6216     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6217     MOVE X'2020233030303036313739' TO DFHEIV0(25:11)
  6218     CALL 'kxdfhei1' USING DFHEIV0,
  6219           DFHEIV20,
  6220           ACCT-REC-LEN,
  6221           GETMAIN-SPACE
  6222     SET ADDRESS OF ACCOUNT-MASTER TO
  6223         DFHEIV20
  6224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6225
  6226
  6227     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6228                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6229                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6230                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6231                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6232                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6233
  6234     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6235                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6236                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6237                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6238                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6239                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6240                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6241                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6242
  6243     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6244                                    AM-AGT-COMMS (2)
  6245                                    AM-AGT-COMMS (3)
  6246                                    AM-AGT-COMMS (4)
  6247                                    AM-AGT-COMMS (5)
  6248                                    AM-AGT-COMMS (6)
  6249                                    AM-AGT-COMMS (7)
  6250                                    AM-AGT-COMMS (8)
  6251                                    AM-AGT-COMMS (9)
  6252                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 118
* EL6501.cbl
  6253
  6254     IF PI-COMPANY-ID = 'FLI'
  6255         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6256                                    AM-FLI-BANK-1ST-6-PREM
  6257                                    AM-FLI-BANK-CAP-AMT
  6258                                    AM-FLI-AGT-SHARE-PCT (1)
  6259                                    AM-FLI-AGT-SHARE-PCT (2)
  6260                                    AM-FLI-AGT-SHARE-PCT (3)
  6261                                    AM-FLI-AGT-SHARE-PCT (4)
  6262                                    AM-FLI-AGT-SHARE-PCT (5)
  6263                                    AM-FLI-AGT-SHARE-PCT (6)
  6264                                    AM-FLI-AGT-SHARE-PCT (7)
  6265                                    AM-FLI-AGT-SHARE-PCT (8)
  6266                                    AM-FLI-AGT-SHARE-PCT (9)
  6267                                    AM-FLI-AGT-SHARE-PCT (10).
  6268
  6269     MOVE ZEROS                  TO AM-GPCD
  6270                                    AM-LF-RET
  6271                                    AM-AH-RET
  6272                                    AM-LF-OB-RATE
  6273                                    AM-LF-OB-RATE-JNT
  6274                                    AM-AH-OB-RATE
  6275                                    AM-AH-OB-RATE-JNT
  6276                                    AM-REI-FEE-LF
  6277                                    AM-REI-FEE-AH
  6278                                    AM-REI-LF-TAX
  6279                                    AM-REI-PR-PCT
  6280                                    AM-REI-78-PCT
  6281                                    AM-REI-AH-TAX
  6282                                    AM-TOL-PREM
  6283                                    AM-TOL-REF
  6284                                    AM-CLP-TOL-PCT
  6285                                    AM-TOL-CLM
  6286                                    AM-CERTS-PURGED-DATE
  6287                                    AM-HI-CERT-DATE
  6288                                    AM-LO-CERT-DATE
  6289                                    AM-1ST-PROD-DATE
  6290                                    AM-GPCD
  6291                                    AM-CAL-TABLE
  6292                                    AM-LF-DEVIATION
  6293                                    AM-LF-DEVIATION-PCT
  6294                                    AM-AH-DEVIATION
  6295                                    AM-AH-DEVIATION-PCT
  6296                                    AM-ANNIVERSARY-DATE
  6297                                    AM-TEL-NO
  6298                                    AM-ENTRY-DATE
  6299                                    AM-INACTIVE-DATE
  6300                                    AM-RET-MIN-LOSS-L
  6301                                    AM-RET-MIN-LOSS-A
  6302                                    AM-LF-RPT021-EXP-PCT
  6303                                    AM-AH-RPT021-EXP-PCT
  6304                                    AM-MAX-MON-BEN
  6305                                    AM-MAX-TOT-BEN
  6306                                    AM-DCC-MAX-MARKETING-FEE
  6307                                    AM-SPP-LEASE-COMM
  6308                                    AM-RETRO-QUALIFY-LIMIT
  6309                                    AM-RETRO-RET-PCT-LF (1)
  6310                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 119
* EL6501.cbl
  6311                                    AM-RETRO-RET-PCT-LF (3)
  6312                                    AM-RETRO-RET-THRU-LF (1)
  6313                                    AM-RETRO-RET-THRU-LF (2)
  6314                                    AM-RETRO-RET-THRU-LF (3)
  6315                                    AM-RETRO-RET-PCT-AH (1)
  6316                                    AM-RETRO-RET-PCT-AH (2)
  6317                                    AM-RETRO-RET-PCT-AH (3)
  6318                                    AM-RETRO-RET-THRU-AH (1)
  6319                                    AM-RETRO-RET-THRU-AH (2)
  6320                                    AM-RETRO-RET-THRU-AH (3).
  6321
  6322     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6323        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6324     END-IF
  6325     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6326                                    AM-AR-HI-CERT-DATE.
  6327
  6328     MOVE 'AM'                   TO AM-RECORD-ID.
  6329     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6330                                    AM-CONTROL-BY-VAR-GRP.
  6331
  6332     IF ST-ACCNT-CNTL
  6333        MOVE SPACES              TO AM-VG-CARRIER
  6334                                    AM-VG-GROUPING.
  6335     IF CARR-ST-ACCNT-CNTL
  6336        MOVE SPACES              TO AM-VG-GROUPING.
  6337
  6338     IF ACCNT-CNTL
  6339        MOVE SPACES              TO AM-VG-CARRIER
  6340                                    AM-VG-STATE
  6341                                    AM-VG-GROUPING.
  6342
  6343     IF CARR-ACCNT-CNTL
  6344        MOVE SPACES              TO AM-VG-STATE
  6345                                    AM-VG-GROUPING.
  6346
  6347     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6348     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6349     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6350
  6351     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6352     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6353     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6354
  6355     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6356
  6357     IF PI-COMPANY-ID = 'NCL'
  6358         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6359
  6360     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6361        EMI-FATAL-CTR    GREATER ZERO
  6362         GO TO 8200-SEND-DATAONLY.
  6363
  6364     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6365        IF CLPSTL <= ZEROS
  6366           MOVE ER-0144          TO  EMI-ERROR
  6367           MOVE -1               TO  CLPSTL
  6368           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 120
* EL6501.cbl
  6369           PERFORM 9900-ERROR-FORMAT
  6370                                 THRU  9900-EXIT
  6371           GO TO 8200-SEND-DATAONLY
  6372        END-IF
  6373     END-IF
  6374     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6375     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6376
  6377     MOVE +1 TO AXRF-SUB
  6378                COMM-WORK-SUB.
  6379
  6380     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6381     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6382
  6383     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6384
  6385     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6386         NEXT SENTENCE
  6387     ELSE
  6388         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6389
  6390
  6391* EXEC CICS WRITE
  6392*        FROM      (ACCOUNT-MASTER)
  6393*        RIDFLD    (AM-CONTROL-PRIMARY)
  6394*        DATASET   (ACCT-FILE-ID)
  6395*    END-EXEC.
  6396     MOVE LENGTH OF
  6397      ACCOUNT-MASTER
  6398       TO DFHEIV11
  6399*    MOVE '&$ L                  ''   #00006348' TO DFHEIV0
  6400     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6402     MOVE X'2020233030303036333438' TO DFHEIV0(25:11)
  6403     CALL 'kxdfhei1' USING DFHEIV0,
  6404           ACCT-FILE-ID,
  6405           ACCOUNT-MASTER,
  6406           DFHEIV11,
  6407           AM-CONTROL-PRIMARY,
  6408           DFHEIV99,
  6409           DFHEIV99
  6410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6411
  6412
  6413     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6414
  6415     MOVE PI-MAINT               TO PI-SV-MAINT.
  6416     MOVE 'C'                    TO PI-MAINT.
  6417     MOVE LOW-VALUES             TO EL6501AI.
  6418
  6419     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6420     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6421     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6422
  6423     IF PI-COMPANY-ID = 'NCL'
  6424         MOVE ER-4011            TO EMI-ERROR
  6425      ELSE
  6426         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 121
* EL6501.cbl
  6427
  6428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6429
  6430     MOVE -1                     TO MAINTL.
  6431     MOVE AL-UANON               TO MAINTA.
  6432     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6433     GO TO 8100-SEND-INITIAL-MAP.
  6434
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 122
* EL6501.cbl
  6436 1500-ADD-COMP.
  6437
  6438* EXEC CICS GETMAIN
  6439*         LENGTH   (COMP-REC-LEN)
  6440*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6441*         INITIMG  (GETMAIN-SPACE)
  6442*    END-EXEC.
  6443*    MOVE ',"IL                  $   #00006378' TO DFHEIV0
  6444     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6445     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6446     MOVE X'2020233030303036333738' TO DFHEIV0(25:11)
  6447     CALL 'kxdfhei1' USING DFHEIV0,
  6448           DFHEIV20,
  6449           COMP-REC-LEN,
  6450           GETMAIN-SPACE
  6451     SET ADDRESS OF COMPENSATION-MASTER TO
  6452         DFHEIV20
  6453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6454
  6455
  6456     MOVE SPACES                 TO COMPENSATION-MASTER.
  6457     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6458                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6459                   CO-OV30         CO-OV60      CO-OV90
  6460                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6461                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6462                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6463                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6464                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6465                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6466                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6467                   CO-CURRENT-CUR-PMT
  6468                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6469                   CO-ACT-YEAR        CO-ACT-MONTH
  6470                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6471                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6472                   CO-CURRENT-LAST-STMT-YEAR
  6473                   CO-CURRENT-LAST-STMT-MONTH
  6474                   CO-CURRENT-LAST-STMT-DAY
  6475                   CO-YTD-PAID-COM
  6476                   CO-YTD-PAID-OV
  6477                   co-ov120 co-current-ov120
  6478
  6479     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6480     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6481     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6482     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6483     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6484
  6485     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6486         MOVE ZEROS              TO CO-CARRIER
  6487     ELSE
  6488         MOVE AM-CARRIER         TO CO-CARRIER.
  6489
  6490     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6491         MOVE ZEROS              TO CO-GROUPING
  6492     ELSE
  6493         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 123
* EL6501.cbl
  6494
  6495     MOVE 'CO'                   TO CO-RECORD-ID
  6496     MOVE 'A'                    TO CO-TYPE.
  6497     MOVE AM-NAME                TO CO-ACCT-NAME.
  6498     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6499     MOVE AM-ADDRS               TO CO-ADDR-1.
  6500*    MOVE AM-CITY                TO CO-ADDR-3.
  6501     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6502     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6503     MOVE AM-ZIP                 TO CO-ZIP.
  6504     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6505     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6506
  6507     IF PI-COMPANY-ID = 'NCL'
  6508         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6509         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6510                         'X' OR 'I'
  6511             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6512             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6513         ELSE
  6514             MOVE SPACE          TO  CO-TYPE-AGENT
  6515             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6516     ELSE
  6517         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6518
  6519     IF AM-REMIT-TO NOT = ZERO
  6520         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6521       ELSE
  6522         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6523
  6524     MOVE +0                      TO AGT-SUB.
  6525
  6526     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6527
  6528     IF VALID-AGT-SW = 'Y'
  6529         NEXT SENTENCE
  6530     ELSE
  6531         GO TO 1500-EXIT.
  6532
  6533     IF CO-RESP-NO = CO-ACCOUNT
  6534         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6535     ELSE
  6536         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6537
  6538     IF PI-AR-PROCESSING
  6539        MOVE 'G'                   TO CO-AR-REPORTING
  6540        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6541        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6542        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6543
  6544     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6545        MOVE 'N'                   TO CO-AR-REPORTING.
  6546
  6547     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6548        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6549
  6550     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6551
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 124
* EL6501.cbl
  6552
  6553* EXEC CICS HANDLE CONDITION
  6554*         DUPREC   (1500-EXIT)
  6555*    END-EXEC.
  6556*    MOVE '"$%                   ! # #00006480' TO DFHEIV0
  6557     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6559     MOVE X'2320233030303036343830' TO DFHEIV0(25:11)
  6560     CALL 'kxdfhei1' USING DFHEIV0
  6561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6562
  6563
  6564
  6565* EXEC CICS WRITE
  6566*        FROM      (COMPENSATION-MASTER)
  6567*        RIDFLD    (CO-CONTROL-PRIMARY)
  6568*        DATASET   (COMP-FILE-ID)
  6569*    END-EXEC.
  6570     MOVE LENGTH OF
  6571      COMPENSATION-MASTER
  6572       TO DFHEIV11
  6573*    MOVE '&$ L                  ''   #00006484' TO DFHEIV0
  6574     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6576     MOVE X'2020233030303036343834' TO DFHEIV0(25:11)
  6577     CALL 'kxdfhei1' USING DFHEIV0,
  6578           COMP-FILE-ID,
  6579           COMPENSATION-MASTER,
  6580           DFHEIV11,
  6581           CO-CONTROL-PRIMARY,
  6582           DFHEIV99,
  6583           DFHEIV99
  6584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6585
  6586
  6587 1500-EXIT.
  6588      EXIT.
  6589
  6590 1600-FIND-C-AGT.
  6591     ADD 1 TO  AGT-SUB.
  6592     IF AGT-SUB GREATER 10
  6593         MOVE 'N'                TO  VALID-AGT-SW
  6594         GO TO 1600-EXIT.
  6595
  6596************************************************************
  6597**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6598************************************************************
  6599
  6600     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6601         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6602         MOVE 'Y'                TO  VALID-AGT-SW
  6603         GO TO 1600-EXIT
  6604     ELSE
  6605         GO TO 1600-FIND-C-AGT.
  6606
  6607 1600-EXIT.
  6608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 125
* EL6501.cbl
  6610 1700-CHANGE-COMP.
  6611     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6612     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6613
  6614     IF PI-ZERO-CARRIER
  6615       OR PI-ZERO-CAR-GROUP
  6616         MOVE ZEROS              TO COMP-CARRIER
  6617     ELSE
  6618         MOVE AM-CARRIER         TO COMP-CARRIER.
  6619
  6620     IF PI-ZERO-GROUPING
  6621       OR PI-ZERO-CAR-GROUP
  6622         MOVE ZEROS              TO COMP-GROUPING
  6623     ELSE
  6624         MOVE AM-GROUPING        TO COMP-GROUPING.
  6625
  6626     IF AM-REMIT-TO NOT = ZERO
  6627         MOVE AM-AGT (AM-REMIT-TO)
  6628                                 TO COMP-RESP-NO
  6629     ELSE
  6630         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6631
  6632     MOVE ZERO                   TO AGT-SUB.
  6633
  6634     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6635
  6636     IF VALID-AGT-SW = 'Y'
  6637         NEXT SENTENCE
  6638     ELSE
  6639         GO TO 1799-EXIT.
  6640
  6641     MOVE 'A'                    TO COMP-TYPE.
  6642
  6643
  6644* EXEC CICS HANDLE CONDITION
  6645*         ENDFILE     (1799-EXIT)
  6646*         NOTFND      (1799-EXIT)
  6647*    END-EXEC.
  6648*    MOVE '"$''I                  ! $ #00006546' TO DFHEIV0
  6649     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6651     MOVE X'2420233030303036353436' TO DFHEIV0(25:11)
  6652     CALL 'kxdfhei1' USING DFHEIV0
  6653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6654
  6655
  6656
  6657* EXEC CICS READ
  6658*        UPDATE
  6659*        DATASET   (COMP-FILE-ID)
  6660*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6661*        RIDFLD    (COMP-KEY)
  6662*    END-EXEC.
  6663*    MOVE '&"S        EU         (   #00006551' TO DFHEIV0
  6664     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6665     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6666     MOVE X'2020233030303036353531' TO DFHEIV0(25:11)
  6667     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 126
* EL6501.cbl
  6668           COMP-FILE-ID,
  6669           DFHEIV20,
  6670           DFHEIV99,
  6671           COMP-KEY,
  6672           DFHEIV99,
  6673           DFHEIV99,
  6674           DFHEIV99
  6675     SET ADDRESS OF COMPENSATION-MASTER TO
  6676         DFHEIV20
  6677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6678
  6679
  6680     IF (ON-LAST-DATE-RANGE)
  6681        IF NAMEL GREATER ZEROS
  6682           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6683           MOVE AM-NAME          TO CO-ACCT-NAME
  6684        END-IF
  6685        IF INCAREL GREATER ZEROS
  6686           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6687           MOVE AM-PERSON        TO CO-MAIL-NAME
  6688        END-IF
  6689        IF ADDR1L GREATER ZEROS
  6690           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6691           MOVE AM-ADDRS         TO CO-ADDR-1
  6692        END-IF
  6693        IF ACITYL  GREATER ZEROS
  6694           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6695           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6696        END-IF
  6697        IF ASTATEL  GREATER ZEROS
  6698           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6699           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6700        END-IF
  6701        IF ZIPL GREATER ZEROS
  6702           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6703           MOVE AM-ZIP           TO CO-ZIP
  6704        END-IF
  6705        IF CSRL GREATER ZEROS
  6706           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6707           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6708        END-IF
  6709        IF PHONEL GREATER ZEROS
  6710           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6711           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6712        END-IF
  6713        IF TAXNOL GREATER ZEROS
  6714           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6715           MOVE AM-ID-NO         TO CO-SOC-SEC
  6716        END-IF
  6717        IF AUTO-CANCEL-ACCOUNT
  6718           IF CO-BILL-SW = ' '
  6719              MOVE 'B'           TO CO-BILL-SW
  6720              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6721           END-IF
  6722        END-IF
  6723     END-IF
  6724
  6725     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 127
* EL6501.cbl
  6726         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6727         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6728     END-IF
  6729
  6730     IF CHANGE-WAS-MADE
  6731         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6732         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6733         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6734
  6735     IF NAMEL GREATER THAN ZERO
  6736         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6737
  6738
  6739* EXEC CICS REWRITE
  6740*        FROM      (COMPENSATION-MASTER)
  6741*        DATASET   (COMP-FILE-ID)
  6742*    END-EXEC.
  6743     MOVE LENGTH OF
  6744      COMPENSATION-MASTER
  6745       TO DFHEIV11
  6746*    MOVE '&& L                  %   #00006616' TO DFHEIV0
  6747     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6748     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6749     MOVE X'2020233030303036363136' TO DFHEIV0(25:11)
  6750     CALL 'kxdfhei1' USING DFHEIV0,
  6751           COMP-FILE-ID,
  6752           COMPENSATION-MASTER,
  6753           DFHEIV11,
  6754           DFHEIV99
  6755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6756
  6757
  6758 1799-EXIT.
  6759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 128
* EL6501.cbl
  6761 1800-FIND-C-AGT.
  6762     ADD 1                       TO  AGT-SUB.
  6763
  6764     IF AGT-SUB GREATER 10
  6765         MOVE 'N'                TO  VALID-AGT-SW
  6766         GO TO 1899-EXIT.
  6767
  6768************************************************************
  6769**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6770************************************************************
  6771
  6772     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6773         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6774         MOVE 'Y'                TO  VALID-AGT-SW
  6775         GO TO 1899-EXIT
  6776     ELSE
  6777         GO TO 1800-FIND-C-AGT.
  6778
  6779 1899-EXIT.
  6780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 129
* EL6501.cbl
  6782 2000-CHANGE-A-RECORD.
  6783     PERFORM 4000-EDITS THRU 4900-EXIT.
  6784
  6785     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6786        EMI-FATAL-CTR    GREATER ZERO
  6787         GO TO 8200-SEND-DATAONLY.
  6788
  6789
  6790* EXEC CICS READ
  6791*        UPDATE
  6792*        DATASET   (ACCT-FILE-ID)
  6793*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6794*        RIDFLD    (PI-ACCT-KEY)
  6795*    END-EXEC.
  6796*    MOVE '&"S        EU         (   #00006652' TO DFHEIV0
  6797     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6798     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6799     MOVE X'2020233030303036363532' TO DFHEIV0(25:11)
  6800     CALL 'kxdfhei1' USING DFHEIV0,
  6801           ACCT-FILE-ID,
  6802           DFHEIV20,
  6803           DFHEIV99,
  6804           PI-ACCT-KEY,
  6805           DFHEIV99,
  6806           DFHEIV99,
  6807           DFHEIV99
  6808     SET ADDRESS OF ACCOUNT-MASTER TO
  6809         DFHEIV20
  6810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6811
  6812
  6813     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6814
  6815     IF NOT PI-AR-PROCESSING
  6816        GO TO 2075-PROCESS-CHANGE.
  6817
  6818     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6819     MOVE +0                     TO SUB1.
  6820
  6821 2075-PROCESS-CHANGE.
  6822     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6823
  6824     IF PI-AR-PROCESSING
  6825        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6826
  6827     IF PI-COMPANY-ID = 'DMD'
  6828     IF AM-ANNIVERSARY-DATE = ZEROS
  6829           MOVE ER-0852             TO EMI-ERROR
  6830           MOVE -1                  TO CONTRL
  6831           MOVE AL-UABON            TO CONTRA
  6832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6833
  6834     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6835        EMI-FATAL-CTR    GREATER ZERO
  6836         GO TO 8200-SEND-DATAONLY.
  6837
  6838     MOVE +1                     TO AXRF-SUB
  6839                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 130
* EL6501.cbl
  6840     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6841
  6842     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6843     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6844     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6845
  6846     IF ((PI-FST-PAGE)
  6847        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6848                      OR
  6849        ((PI-2ND-PAGE)
  6850        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6851                      OR
  6852        ((PI-3RD-PAGE)
  6853        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6854                      OR
  6855        ((PI-LST-PAGE)
  6856        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6857        SET ON-LAST-DATE-RANGE   TO TRUE
  6858     END-IF
  6859     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6860         NEXT SENTENCE
  6861     ELSE
  6862         IF (ON-LAST-DATE-RANGE)
  6863                          OR
  6864            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6865             (PCONTL > ZERO))
  6866             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6867
  6868     IF NAMEL GREATER THAN ZERO
  6869         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6870
  6871
  6872* EXEC CICS REWRITE
  6873*        FROM      (ACCOUNT-MASTER)
  6874*        DATASET   (ACCT-FILE-ID)
  6875*    END-EXEC.
  6876     MOVE LENGTH OF
  6877      ACCOUNT-MASTER
  6878       TO DFHEIV11
  6879*    MOVE '&& L                  %   #00006717' TO DFHEIV0
  6880     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6881     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6882     MOVE X'2020233030303036373137' TO DFHEIV0(25:11)
  6883     CALL 'kxdfhei1' USING DFHEIV0,
  6884           ACCT-FILE-ID,
  6885           ACCOUNT-MASTER,
  6886           DFHEIV11,
  6887           DFHEIV99
  6888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6889
  6890
  6891     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6892
  6893     IF CSRL GREATER ZEROS
  6894         GO TO 3500-CHANGE-ALL-CSR.
  6895
  6896     MOVE ER-0000                TO EMI-ERROR.
  6897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 131
* EL6501.cbl
  6898     MOVE LOW-VALUES             TO EL6501AI.
  6899
  6900     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6901     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6902     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6903
  6904     MOVE ER-0000                TO EMI-ERROR.
  6905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6906
  6907     MOVE -1                     TO MAINTL.
  6908     MOVE AL-UANON               TO MAINTA.
  6909     GO TO 8100-SEND-INITIAL-MAP.
  6910
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 132
* EL6501.cbl
  6912 2100-ADD-ACCOUNT-NAME.
  6913
  6914* EXEC CICS HANDLE CONDITION
  6915*         DUPREC   (2100-EXIT)
  6916*    END-EXEC.
  6917*    MOVE '"$%                   ! % #00006744' TO DFHEIV0
  6918     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6920     MOVE X'2520233030303036373434' TO DFHEIV0(25:11)
  6921     CALL 'kxdfhei1' USING DFHEIV0
  6922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6923
  6924
  6925
  6926* EXEC CICS GETMAIN
  6927*         LENGTH   (NAME-REC-LEN)
  6928*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6929*         INITIMG  (GETMAIN-SPACE)
  6930*    END-EXEC.
  6931*    MOVE ',"IL                  $   #00006748' TO DFHEIV0
  6932     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6933     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6934     MOVE X'2020233030303036373438' TO DFHEIV0(25:11)
  6935     CALL 'kxdfhei1' USING DFHEIV0,
  6936           DFHEIV20,
  6937           NAME-REC-LEN,
  6938           GETMAIN-SPACE
  6939     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6940         DFHEIV20
  6941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6942
  6943
  6944     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6945     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6946     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6947     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6948     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6949     MOVE AM-NAME                TO  NL-NAME.
  6950     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6951        MOVE NL-NAME (5:26)      TO NL-NAME
  6952     END-IF
  6953     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6954     MOVE AM-ADDR-STATE          TO  NL-ST.
  6955     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6956     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6957     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6958     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6959     MOVE AM-STATE               TO  NL-AM-STATE.
  6960     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6961
  6962
  6963* EXEC CICS WRITE
  6964*        FROM      (NAME-LOOKUP-MASTER)
  6965*        RIDFLD    (NL-CONTROL-PRIMARY)
  6966*        DATASET   (NAME-FILE-ID)
  6967*    END-EXEC.
  6968     MOVE LENGTH OF
  6969      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 133
* EL6501.cbl
  6970       TO DFHEIV11
  6971*    MOVE '&$ L                  ''   #00006772' TO DFHEIV0
  6972     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6973     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6974     MOVE X'2020233030303036373732' TO DFHEIV0(25:11)
  6975     CALL 'kxdfhei1' USING DFHEIV0,
  6976           NAME-FILE-ID,
  6977           NAME-LOOKUP-MASTER,
  6978           DFHEIV11,
  6979           NL-CONTROL-PRIMARY,
  6980           DFHEIV99,
  6981           DFHEIV99
  6982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6983
  6984
  6985 2100-EXIT.
  6986     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 134
* EL6501.cbl
  6988 2200-ADD-COMPENSATION-NAME.
  6989
  6990* EXEC CICS HANDLE CONDITION
  6991*         DUPREC   (2200-EXIT)
  6992*    END-EXEC.
  6993*    MOVE '"$%                   ! & #00006782' TO DFHEIV0
  6994     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6996     MOVE X'2620233030303036373832' TO DFHEIV0(25:11)
  6997     CALL 'kxdfhei1' USING DFHEIV0
  6998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6999
  7000
  7001
  7002* EXEC CICS GETMAIN
  7003*         LENGTH   (NAME-REC-LEN)
  7004*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  7005*         INITIMG  (GETMAIN-SPACE)
  7006*    END-EXEC.
  7007*    MOVE ',"IL                  $   #00006786' TO DFHEIV0
  7008     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7009     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7010     MOVE X'2020233030303036373836' TO DFHEIV0(25:11)
  7011     CALL 'kxdfhei1' USING DFHEIV0,
  7012           DFHEIV20,
  7013           NAME-REC-LEN,
  7014           GETMAIN-SPACE
  7015     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7016         DFHEIV20
  7017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7018
  7019
  7020     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7021     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7022     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7023     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7024     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7025     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7026     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  7027        MOVE NL-NAME (5:26)      TO NL-NAME
  7028     END-IF
  7029     MOVE CO-ADDR-CITY           TO  NL-CITY.
  7030     MOVE CO-ADDR-STATE          TO  NL-ST
  7031     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7032     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7033     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7034     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7035     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7036     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7037     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7038
  7039
  7040* EXEC CICS WRITE
  7041*        FROM      (NAME-LOOKUP-MASTER)
  7042*        RIDFLD    (NL-CONTROL-PRIMARY)
  7043*        DATASET   (NAME-FILE-ID)
  7044*    END-EXEC.
  7045     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 135
* EL6501.cbl
  7046      NAME-LOOKUP-MASTER
  7047       TO DFHEIV11
  7048*    MOVE '&$ L                  ''   #00006811' TO DFHEIV0
  7049     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7050     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7051     MOVE X'2020233030303036383131' TO DFHEIV0(25:11)
  7052     CALL 'kxdfhei1' USING DFHEIV0,
  7053           NAME-FILE-ID,
  7054           NAME-LOOKUP-MASTER,
  7055           DFHEIV11,
  7056           NL-CONTROL-PRIMARY,
  7057           DFHEIV99,
  7058           DFHEIV99
  7059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7060
  7061
  7062 2200-EXIT.
  7063     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 136
* EL6501.cbl
  7065 3000-CHANGE-ALL-RECORDS.
  7066     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  7067     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7068
  7069
  7070* EXEC CICS HANDLE CONDITION
  7071*         ENDFILE     (3030-END-FILE)
  7072*    END-EXEC.
  7073*    MOVE '"$''                   ! '' #00006824' TO DFHEIV0
  7074     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7076     MOVE X'2720233030303036383234' TO DFHEIV0(25:11)
  7077     CALL 'kxdfhei1' USING DFHEIV0
  7078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7079
  7080
  7081     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7082
  7083 3010-READ-NEXT.
  7084     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7085
  7086     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7087        GO TO 3030-END-FILE.
  7088
  7089
  7090* EXEC CICS ENDBR
  7091*        DATASET   (ACCT-FILE-ID)
  7092*    END-EXEC.
  7093     MOVE 0
  7094       TO DFHEIV11
  7095*    MOVE '&2                    $   #00006836' TO DFHEIV0
  7096     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7097     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7098     MOVE X'2020233030303036383336' TO DFHEIV0(25:11)
  7099     CALL 'kxdfhei1' USING DFHEIV0,
  7100           ACCT-FILE-ID,
  7101           DFHEIV11,
  7102           DFHEIV99
  7103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7104
  7105     ADD +1                      TO WS-CHANGE-ALL-CNT
  7106
  7107* EXEC CICS READ
  7108*        UPDATE
  7109*        DATASET   (ACCT-FILE-ID)
  7110*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7111*        RIDFLD    (WS-KEY-SAVE)
  7112*    END-EXEC.
  7113*    MOVE '&"S        EU         (   #00006840' TO DFHEIV0
  7114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7115     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7116     MOVE X'2020233030303036383430' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           ACCT-FILE-ID,
  7119           DFHEIV20,
  7120           DFHEIV99,
  7121           WS-KEY-SAVE,
  7122           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 137
* EL6501.cbl
  7123           DFHEIV99,
  7124           DFHEIV99
  7125     SET ADDRESS OF ACCOUNT-MASTER TO
  7126         DFHEIV20
  7127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7128
  7129
  7130     IF NAMEL    GREATER THAN ZERO  OR
  7131        INCAREL  GREATER THAN ZERO  OR
  7132        ADDR1L   GREATER THAN ZERO  OR
  7133        ACITYL   GREATER THAN ZERO  OR
  7134        ASTATEL  GREATER THAN ZERO  OR
  7135        ZIPL     GREATER THAN ZERO  OR
  7136        CLPTOLPL GREATER THAN ZERO  OR
  7137        PHONEL   GREATER THAN ZERO
  7138         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7139
  7140     IF STATUSL > ZERO
  7141        EVALUATE TRUE
  7142           WHEN STATUSI = 'A'
  7143              MOVE '0'           TO AM-STATUS
  7144           WHEN STATUSI = 'I'
  7145              MOVE '1'           TO AM-STATUS
  7146           WHEN (STATUSI = 'C')
  7147              AND (AM-STATUS NOT = '3' AND 'C')
  7148              MOVE '3'           TO AM-STATUS
  7149              SET AUTO-CANCEL-ACCOUNT
  7150                                 TO TRUE
  7151           WHEN (STATUSI = 'C')
  7152              MOVE '3'           TO AM-STATUS
  7153           WHEN STATUSI = 'F'
  7154              MOVE '4'           TO AM-STATUS
  7155           WHEN STATUSI = 'S'
  7156              MOVE '5'           TO AM-STATUS
  7157           WHEN STATUSI = 'D'
  7158              MOVE '6'           TO AM-STATUS
  7159           WHEN STATUSI = 'L'
  7160              MOVE '7'           TO AM-STATUS
  7161           WHEN STATUSI = 'R'
  7162              MOVE '8'           TO AM-STATUS
  7163           WHEN STATUSI = 'P'
  7164              MOVE '9'           TO AM-STATUS
  7165           WHEN OTHER
  7166              MOVE -1            TO STATUSL
  7167              MOVE AL-UABON      TO STATUSA
  7168              MOVE ER-2153       TO EMI-ERROR
  7169              PERFORM 9900-ERROR-FORMAT
  7170                                 THRU 9900-EXIT
  7171        END-EVALUATE
  7172     END-IF
  7173*    IF STATUSL > ZERO
  7174*       IF STATUSI = 'A'
  7175*          MOVE '0'              TO AM-STATUS
  7176*       ELSE
  7177*          IF STATUSI = 'I'
  7178*             MOVE '1'           TO AM-STATUS
  7179*          ELSE
  7180*             IF STATUSI = 'C'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 138
* EL6501.cbl
  7181*                IF AM-STATUS NOT = '3' AND 'C'
  7182*                   SET AUTO-CANCEL-ACCOUNT
  7183*                                TO TRUE
  7184*                END-IF
  7185*                MOVE '3'        TO AM-STATUS
  7186*             ELSE
  7187*                IF STATUSI = 'F'
  7188*                   MOVE '4'     TO AM-STATUS
  7189*                ELSE
  7190*                   MOVE -1         TO STATUSL
  7191*                   MOVE AL-UABON   TO STATUSA
  7192*                   MOVE ER-2153    TO EMI-ERROR
  7193*                   PERFORM 9900-ERROR-FORMAT
  7194*                                THRU 9900-EXIT
  7195*                END-IF
  7196*             END-IF
  7197*          END-IF
  7198*       END-IF
  7199*    END-IF
  7200
  7201     IF CSRL GREATER ZERO
  7202        MOVE CSRI                TO AM-CSR-CODE.
  7203     IF NAMEL GREATER THAN ZERO
  7204        MOVE NAMEI               TO AM-NAME.
  7205     IF PCONTL GREATER THAN ZERO
  7206        MOVE PCONTI              TO AM-CONTROL-NAME
  7207     END-IF
  7208     IF INCAREL GREATER ZEROS
  7209        MOVE INCAREI             TO AM-PERSON.
  7210     IF ADDR1L GREATER ZEROS
  7211        MOVE ADDR1I              TO AM-ADDRS.
  7212     IF ACITYL GREATER ZEROS
  7213        MOVE ACITYI             TO AM-ADDR-CITY.
  7214     IF ASTATEL GREATER ZEROS
  7215        MOVE ASTATEI            TO AM-ADDR-STATE.
  7216     IF ZIPL NOT GREATER ZEROS
  7217         GO TO 3015-CONT-CHANGING.
  7218
  7219     MOVE ZIPI                   TO WS-ZIP-CODE.
  7220
  7221     IF WS-CANADIAN-ZIP
  7222         IF WS-ZIP-4 = SPACE  OR  '-'
  7223             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7224             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7225         ELSE
  7226             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7227             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7228     ELSE
  7229         IF WS-ZIP-6 = SPACE  OR  '-'
  7230             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7231             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7232         ELSE
  7233             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7234             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7235
  7236 3015-CONT-CHANGING.
  7237
  7238     IF CLPTOLPL GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 139
* EL6501.cbl
  7239
  7240* EXEC CICS BIF
  7241*            DEEDIT
  7242*            FIELD    (CLPTOLPI)
  7243*            LENGTH   (6)
  7244*        END-EXEC
  7245     MOVE 6
  7246       TO DFHEIV11
  7247*    MOVE '@"L                   #   #00006956' TO DFHEIV0
  7248     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7250     MOVE X'2020233030303036393536' TO DFHEIV0(25:11)
  7251     CALL 'kxdfhei1' USING DFHEIV0,
  7252           CLPTOLPI,
  7253           DFHEIV11
  7254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7255         IF CLPTOLPI NUMERIC
  7256             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7257         ELSE
  7258             MOVE -1                  TO CLPTOLPL
  7259             MOVE AL-UNBON            TO CLPTOLPA
  7260             MOVE ER-1778             TO EMI-ERROR
  7261             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7262         END-IF
  7263     END-IF
  7264
  7265     IF LCOMML > ZEROS
  7266
  7267* EXEC CICS BIF
  7268*            DEEDIT
  7269*            FIELD    (LCOMMI)
  7270*            LENGTH   (8)
  7271*        END-EXEC
  7272     MOVE 8
  7273       TO DFHEIV11
  7274*    MOVE '@"L                   #   #00006972' TO DFHEIV0
  7275     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7277     MOVE X'2020233030303036393732' TO DFHEIV0(25:11)
  7278     CALL 'kxdfhei1' USING DFHEIV0,
  7279           LCOMMI,
  7280           DFHEIV11
  7281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7282         IF LCOMMI NUMERIC
  7283            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7284         ELSE
  7285            MOVE -1              TO LCOMML
  7286            MOVE AL-UNBON        TO LCOMMA
  7287            MOVE ER-1778         TO EMI-ERROR
  7288            PERFORM 9900-ERROR-FORMAT
  7289                                 THRU 9900-EXIT
  7290         END-IF
  7291     END-IF
  7292
  7293     IF PHONEL GREATER ZEROS
  7294        MOVE PHONEI              TO DEEDIT-FIELD
  7295        PERFORM 8600-DEEDIT
  7296        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 140
* EL6501.cbl
  7297        MOVE WS-PH1              TO AM-AREA-CODE
  7298        MOVE WS-PH2              TO AM-TEL-PRE
  7299        MOVE WS-PH3              TO AM-TEL-NBR.
  7300
  7301*    IF PSILFFL GREATER +0
  7302*       MOVE PSILFFI             TO DEEDIT-FIELD
  7303*       PERFORM 8600-DEEDIT
  7304*       IF DEEDIT-FIELD NUMERIC
  7305*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7306*
  7307*    IF PSIAHFL GREATER +0
  7308*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7309*       PERFORM 8600-DEEDIT
  7310*       IF DEEDIT-FIELD NUMERIC
  7311*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7312
  7313     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7314     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7315     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7316
  7317     IF ((PI-FST-PAGE)
  7318        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7319                      OR
  7320        ((PI-2ND-PAGE)
  7321        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7322                      OR
  7323        ((PI-3RD-PAGE)
  7324        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7325                      OR
  7326        ((PI-LST-PAGE)
  7327        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7328        SET ON-LAST-DATE-RANGE   TO TRUE
  7329     END-IF
  7330*    IF ((PI-FST-PAGE)
  7331*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7332*                     OR
  7333*       ((PI-2ND-PAGE)
  7334*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7335*                     OR
  7336*       ((PI-3RD-PAGE)
  7337*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7338*                     OR
  7339*       ((PI-LST-PAGE)
  7340*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7341*       SET ON-LAST-DATE-RANGE   TO TRUE
  7342*    END-IF
  7343     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7344     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7345     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7346*    EXEC CICS DELAY
  7347*       INTERVAL (WS-DELAY-INT)
  7348*    END-EXEC
  7349     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7350        CONTINUE
  7351     ELSE
  7352        IF (ON-LAST-DATE-RANGE)
  7353                   OR
  7354           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 141
* EL6501.cbl
  7355           (PCONTL > ZERO))
  7356           PERFORM 1700-CHANGE-COMP
  7357                                 THRU 1799-EXIT
  7358        END-IF
  7359     END-IF
  7360
  7361     IF NAMEL GREATER THAN ZERO
  7362         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  7363
  7364
  7365* EXEC CICS REWRITE
  7366*        FROM      (ACCOUNT-MASTER)
  7367*        DATASET   (ACCT-FILE-ID)
  7368*    END-EXEC.
  7369     MOVE LENGTH OF
  7370      ACCOUNT-MASTER
  7371       TO DFHEIV11
  7372*    MOVE '&& L                  %   #00007059' TO DFHEIV0
  7373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7375     MOVE X'2020233030303037303539' TO DFHEIV0(25:11)
  7376     CALL 'kxdfhei1' USING DFHEIV0,
  7377           ACCT-FILE-ID,
  7378           ACCOUNT-MASTER,
  7379           DFHEIV11,
  7380           DFHEIV99
  7381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7382
  7383
  7384     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7385     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7386
  7387     GO TO 3010-READ-NEXT.
  7388
  7389 3030-END-FILE.
  7390     IF BROWSE-STARTED
  7391        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7392
  7393     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7394
  7395     IF AUTO-CANCEL-ACCOUNT
  7396
  7397* EXEC CICS GETMAIN
  7398*          LENGTH   (ERACNT-REC-LEN)
  7399*          SET      (ADDRESS OF NOTE-FILE)
  7400*          INITIMG  (GETMAIN-SPACE)
  7401*          RESP     (WS-RESPONSE)
  7402*       END-EXEC
  7403*    MOVE ',"IL                  $  N#00007076' TO DFHEIV0
  7404     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7406     MOVE X'204E233030303037303736' TO DFHEIV0(25:11)
  7407     CALL 'kxdfhei1' USING DFHEIV0,
  7408           DFHEIV20,
  7409           ERACNT-REC-LEN,
  7410           GETMAIN-SPACE
  7411     SET ADDRESS OF NOTE-FILE TO
  7412         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 142
* EL6501.cbl
  7413     MOVE EIBRESP  TO WS-RESPONSE
  7414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7415        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7416        MOVE '1'                 TO NT-RECORD-TYPE
  7417        MOVE +1                  TO NT-LINE-SEQUENCE
  7418        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7419        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7420        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
  7421        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7422                                 TO NT-NOTE-LINE
  7423        PERFORM WITH TEST AFTER UNTIL
  7424           (NOT RESP-DUPKEY)
  7425           AND (NOT RESP-DUPREC)
  7426
  7427* EXEC CICS WRITE
  7428*             FROM      (NOTE-FILE)
  7429*             RIDFLD    (NT-CONTROL-PRIMARY)
  7430*             DATASET   (ERACNT-FILE-ID)
  7431*             RESP      (WS-RESPONSE)
  7432*          END-EXEC
  7433     MOVE LENGTH OF
  7434      NOTE-FILE
  7435       TO DFHEIV11
  7436*    MOVE '&$ L                  ''  N#00007093' TO DFHEIV0
  7437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7439     MOVE X'204E233030303037303933' TO DFHEIV0(25:11)
  7440     CALL 'kxdfhei1' USING DFHEIV0,
  7441           ERACNT-FILE-ID,
  7442           NOTE-FILE,
  7443           DFHEIV11,
  7444           NT-CONTROL-PRIMARY,
  7445           DFHEIV99,
  7446           DFHEIV99
  7447     MOVE EIBRESP  TO WS-RESPONSE
  7448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7449           IF RESP-DUPKEY OR RESP-DUPREC
  7450              ADD +1             TO NT-LINE-SEQUENCE
  7451           END-IF
  7452        END-PERFORM
  7453     END-IF
  7454     IF NOT EMI-NO-ERRORS
  7455         GO TO 8200-SEND-DATAONLY.
  7456
  7457     MOVE -1                     TO NAMEL.
  7458     MOVE ER-0000                TO EMI-ERROR.
  7459     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7460     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 143
* EL6501.cbl
  7462 3500-CHANGE-ALL-CSR.
  7463     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7464     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7465                                    WS-ACCT-REST-OF-EXP.
  7466
  7467
  7468* EXEC CICS HANDLE CONDITION
  7469*         ENDFILE     (3530-END-FILE)
  7470*    END-EXEC.
  7471*    MOVE '"$''                   ! ( #00007117' TO DFHEIV0
  7472     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7474     MOVE X'2820233030303037313137' TO DFHEIV0(25:11)
  7475     CALL 'kxdfhei1' USING DFHEIV0
  7476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7477
  7478
  7479     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7480
  7481 3510-READ-NEXT.
  7482     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7483
  7484     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7485        GO TO 3530-END-FILE.
  7486
  7487
  7488* EXEC CICS ENDBR
  7489*        DATASET   (ACCT-FILE-ID)
  7490*    END-EXEC.
  7491     MOVE 0
  7492       TO DFHEIV11
  7493*    MOVE '&2                    $   #00007129' TO DFHEIV0
  7494     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7496     MOVE X'2020233030303037313239' TO DFHEIV0(25:11)
  7497     CALL 'kxdfhei1' USING DFHEIV0,
  7498           ACCT-FILE-ID,
  7499           DFHEIV11,
  7500           DFHEIV99
  7501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7502
  7503
  7504
  7505* EXEC CICS READ
  7506*        UPDATE
  7507*        DATASET   (ACCT-FILE-ID)
  7508*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7509*        RIDFLD    (WS-KEY-SAVE)
  7510*    END-EXEC.
  7511*    MOVE '&"S        EU         (   #00007133' TO DFHEIV0
  7512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7513     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303037313333' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           ACCT-FILE-ID,
  7517           DFHEIV20,
  7518           DFHEIV99,
  7519           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 144
* EL6501.cbl
  7520           DFHEIV99,
  7521           DFHEIV99,
  7522           DFHEIV99
  7523     SET ADDRESS OF ACCOUNT-MASTER TO
  7524         DFHEIV20
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527
  7528     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7529     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7530     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7531
  7532     MOVE CSRI                   TO AM-CSR-CODE.
  7533
  7534
  7535* EXEC CICS REWRITE
  7536*        FROM      (ACCOUNT-MASTER)
  7537*        DATASET   (ACCT-FILE-ID)
  7538*    END-EXEC.
  7539     MOVE LENGTH OF
  7540      ACCOUNT-MASTER
  7541       TO DFHEIV11
  7542*    MOVE '&& L                  %   #00007146' TO DFHEIV0
  7543     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7544     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7545     MOVE X'2020233030303037313436' TO DFHEIV0(25:11)
  7546     CALL 'kxdfhei1' USING DFHEIV0,
  7547           ACCT-FILE-ID,
  7548           ACCOUNT-MASTER,
  7549           DFHEIV11,
  7550           DFHEIV99
  7551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7552
  7553
  7554     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7555     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7556
  7557     GO TO 3510-READ-NEXT.
  7558
  7559 3530-END-FILE.
  7560     IF BROWSE-STARTED
  7561        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7562
  7563     MOVE ER-4009                TO EMI-ERROR.
  7564     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7565     MOVE LOW-VALUES             TO EL6501AI.
  7566
  7567     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7568     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7569     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7570
  7571     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7572
  7573     MOVE -1                     TO MAINTL.
  7574     MOVE AL-UANON               TO MAINTA.
  7575     GO TO 8100-SEND-INITIAL-MAP.
  7576
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 145
* EL6501.cbl
  7578 4000-EDITS.
  7579     IF PI-COMPANY-ID = 'NCL'
  7580      IF MAINTI = 'A' OR 'C'
  7581        IF CSRL GREATER ZEROS
  7582            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7583          ELSE
  7584            IF MAINTI = 'A'
  7585                MOVE ER-1883         TO EMI-ERROR
  7586                MOVE -1              TO CSRL
  7587                MOVE AL-UABON        TO CSRA
  7588                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7589
  7590     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7591        IF NAMEL NOT GREATER ZEROS
  7592           IF MAINTI = 'C'
  7593              GO TO 4070-CHECK-STATUS
  7594           ELSE
  7595              MOVE -1               TO  NAMEL
  7596              MOVE AL-UABON         TO  NAMEA
  7597              MOVE ER-2045          TO  EMI-ERROR
  7598              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7599        ELSE
  7600            GO TO 4065-CHECK-ASSOCIATES.
  7601
  7602     IF TYPEL NOT GREATER ZEROS
  7603        IF MAINTI = 'C'
  7604           GO TO 4050-CONTINUE
  7605        ELSE
  7606           GO TO 4020-BUS-TYPE-ERROR.
  7607
  7608     IF TYPEI NOT NUMERIC
  7609        GO TO 4020-BUS-TYPE-ERROR
  7610     ELSE
  7611        IF TYPEI LESS 1 OR GREATER 99
  7612           GO TO 4020-BUS-TYPE-ERROR.
  7613
  7614     MOVE SPACES                 TO ELCNTL-KEY.
  7615
  7616     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7617     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7618     MOVE '8'                    TO CNTL-REC-TYPE.
  7619     MOVE +0                     TO CNTL-SEQ-NO.
  7620
  7621
  7622* EXEC CICS HANDLE CONDITION
  7623*        NOTFND   (4020-BUS-TYPE-ERROR)
  7624*    END-EXEC.
  7625*    MOVE '"$I                   ! ) #00007218' TO DFHEIV0
  7626     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7628     MOVE X'2920233030303037323138' TO DFHEIV0(25:11)
  7629     CALL 'kxdfhei1' USING DFHEIV0
  7630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7631
  7632
  7633
  7634* EXEC CICS READ
  7635*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 146
* EL6501.cbl
  7636*        DATASET   (CNTL-FILE-ID)
  7637*        SET       (ADDRESS OF CONTROL-FILE)
  7638*        RIDFLD    (ELCNTL-KEY)
  7639*    END-EXEC.
  7640*    MOVE '&"S        G          (   #00007222' TO DFHEIV0
  7641     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7643     MOVE X'2020233030303037323232' TO DFHEIV0(25:11)
  7644     CALL 'kxdfhei1' USING DFHEIV0,
  7645           CNTL-FILE-ID,
  7646           DFHEIV20,
  7647           DFHEIV99,
  7648           ELCNTL-KEY,
  7649           DFHEIV99,
  7650           DFHEIV99,
  7651           DFHEIV99
  7652     SET ADDRESS OF CONTROL-FILE TO
  7653         DFHEIV20
  7654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7655
  7656
  7657     IF TYPEI LESS 21
  7658        MOVE TYPEI               TO WS-BUS-ENTRY
  7659     ELSE
  7660        DIVIDE TYPEI BY 20
  7661            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7662        IF WS-BUS-ENTRY = ZEROS
  7663           MOVE 20               TO WS-BUS-ENTRY.
  7664
  7665     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7666        GO TO 4050-CONTINUE.
  7667
  7668 4020-BUS-TYPE-ERROR.
  7669     MOVE -1                     TO TYPEL.
  7670     MOVE AL-UNBON               TO TYPEA.
  7671     MOVE ER-2178                TO EMI-ERROR.
  7672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7673
  7674 4050-CONTINUE.
  7675     IF ASTATEL > 0
  7676        MOVE SPACES                 TO  ELCNTL-KEY
  7677        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7678        MOVE '3'                    TO  CNTL-REC-TYPE
  7679        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7680        MOVE +0                     TO  CNTL-SEQ-NO
  7681
  7682* EXEC CICS  READ
  7683*           DATASET  ('ELCNTL')
  7684*           SET      (ADDRESS OF CONTROL-FILE)
  7685*           RIDFLD   (ELCNTL-KEY)
  7686*           RESP     (WS-RESPONSE)
  7687*       END-EXEC
  7688     MOVE 'ELCNTL' TO DFHEIV1
  7689*    MOVE '&"S        E          (  N#00007253' TO DFHEIV0
  7690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7692     MOVE X'204E233030303037323533' TO DFHEIV0(25:11)
  7693     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 147
* EL6501.cbl
  7694           DFHEIV1,
  7695           DFHEIV20,
  7696           DFHEIV99,
  7697           ELCNTL-KEY,
  7698           DFHEIV99,
  7699           DFHEIV99,
  7700           DFHEIV99
  7701     SET ADDRESS OF CONTROL-FILE TO
  7702         DFHEIV20
  7703     MOVE EIBRESP  TO WS-RESPONSE
  7704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7705        IF NOT RESP-NORMAL
  7706           MOVE ER-0144                TO  EMI-ERROR
  7707           MOVE -1                     TO  ASTATEL
  7708           MOVE AL-UABON               TO  ASTATEA
  7709           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7710        END-IF
  7711     ELSE
  7712        IF MAINTI = 'A'
  7713           MOVE ER-0144                TO  EMI-ERROR
  7714           MOVE -1                     TO  ASTATEL
  7715           MOVE AL-UABON               TO  ASTATEA
  7716           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7717        END-IF
  7718     END-IF
  7719     IF INDGRPL NOT GREATER ZEROS
  7720        IF MAINTI = 'C'
  7721           GO TO 4070-CHECK-STATUS
  7722        ELSE
  7723           GO TO 4060-IG-ERROR.
  7724
  7725     IF INDGRPI = 'I' OR 'G'
  7726        GO TO 4070-CHECK-STATUS.
  7727
  7728 4060-IG-ERROR.
  7729     MOVE -1                     TO INDGRPL.
  7730     MOVE AL-UABON               TO INDGRPA.
  7731     MOVE ER-2152                TO EMI-ERROR.
  7732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7733
  7734 4065-CHECK-ASSOCIATES.
  7735     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7736        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7737        MOVE  NAMEI              TO  WS-NAME-AREA
  7738     ELSE
  7739        GO TO 4070-CHECK-STATUS.
  7740
  7741     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7742        NEXT SENTENCE
  7743     ELSE
  7744        MOVE -1                  TO  NAMEL
  7745        MOVE AL-UABON            TO  NAMEA
  7746        MOVE ER-0788             TO  EMI-ERROR
  7747        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7748
  7749 4070-CHECK-STATUS.
  7750     IF STATUSL NOT GREATER ZEROS
  7751        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 148
* EL6501.cbl
  7752           GO TO 4090-CHECK-STD-AH-TYPE
  7753        ELSE
  7754           MOVE 'A'              TO STATUSI
  7755           MOVE AL-UANON         TO STATUSA
  7756           GO TO 4090-CHECK-STD-AH-TYPE.
  7757
  7758*    IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7759     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S' OR 'D' OR 'L'
  7760                      OR 'R' OR 'P'
  7761        GO TO 4090-CHECK-STD-AH-TYPE.
  7762
  7763 4080-STATUS-ERROR.
  7764     MOVE -1                     TO STATUSL.
  7765     MOVE AL-UABON               TO STATUSA.
  7766     MOVE ER-2153                TO EMI-ERROR.
  7767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7768
  7769 4090-CHECK-STD-AH-TYPE.
  7770
  7771     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7772         GO TO 4900-EXIT.
  7773
  7774     IF STDBENL NOT GREATER ZEROS
  7775        IF MAINTI = 'C'
  7776*          GO TO 4110-CHECK-REMIT
  7777           GO TO 4100-CHECK-CLPTOLP
  7778        ELSE
  7779           MOVE ZEROS            TO STDBENI
  7780           MOVE AL-UANON         TO STDBENA
  7781*          GO TO 4110-CHECK-REMIT.
  7782           GO TO 4100-CHECK-CLPTOLP.
  7783
  7784     IF STDBENI = SPACES
  7785         MOVE ZEROS               TO STDBENI.
  7786     IF STDBENI = ZEROS
  7787*        GO TO 4110-CHECK-REMIT.
  7788         GO TO 4100-CHECK-CLPTOLP.
  7789
  7790     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7791     IF INVALID-BENEFIT-CODE
  7792        GO TO 4099-STD-BEN-ERROR.
  7793
  7794     MOVE SPACES                 TO ELCNTL-KEY.
  7795
  7796     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7797     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7798     MOVE '5'                    TO CNTL-REC-TYPE.
  7799     MOVE +0                     TO CNTL-SEQ-NO.
  7800
  7801
  7802* EXEC CICS HANDLE CONDITION
  7803*        NOTFND   (4099-STD-BEN-ERROR)
  7804*    END-EXEC.
  7805*    MOVE '"$I                   ! * #00007355' TO DFHEIV0
  7806     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7808     MOVE X'2A20233030303037333535' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 149
* EL6501.cbl
  7810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7811
  7812
  7813
  7814* EXEC CICS READ
  7815*        GTEQ
  7816*        DATASET   (CNTL-FILE-ID)
  7817*        SET       (ADDRESS OF CONTROL-FILE)
  7818*        RIDFLD    (ELCNTL-KEY)
  7819*    END-EXEC.
  7820*    MOVE '&"S        G          (   #00007359' TO DFHEIV0
  7821     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7823     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
  7824     CALL 'kxdfhei1' USING DFHEIV0,
  7825           CNTL-FILE-ID,
  7826           DFHEIV20,
  7827           DFHEIV99,
  7828           ELCNTL-KEY,
  7829           DFHEIV99,
  7830           DFHEIV99,
  7831           DFHEIV99
  7832     SET ADDRESS OF CONTROL-FILE TO
  7833         DFHEIV20
  7834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7835
  7836
  7837     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7838        CNTL-REC-TYPE = CF-RECORD-TYPE
  7839         MOVE 1                  TO SUB
  7840     ELSE
  7841         GO TO 4099-STD-BEN-ERROR.
  7842
  7843 4095-CHECK-BEN-TYPE.
  7844     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7845*       GO TO 4110-CHECK-REMIT.
  7846        GO TO 4100-CHECK-CLPTOLP.
  7847
  7848     IF SUB LESS 8
  7849         ADD 1 TO SUB
  7850         GO TO 4095-CHECK-BEN-TYPE.
  7851
  7852 4099-STD-BEN-ERROR.
  7853     MOVE -1                     TO STDBENL.
  7854     MOVE AL-UABON               TO STDBENA.
  7855     MOVE ER-0250                TO EMI-ERROR.
  7856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7857
  7858 4100-CHECK-CLPTOLP.
  7859
  7860     IF CLPTOLPL > ZERO
  7861
  7862* EXEC CICS BIF
  7863*            DEEDIT
  7864*            FIELD    (CLPTOLPI)
  7865*            LENGTH   (6)
  7866*        END-EXEC
  7867     MOVE 6
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 150
* EL6501.cbl
  7868       TO DFHEIV11
  7869*    MOVE '@"L                   #   #00007390' TO DFHEIV0
  7870     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7872     MOVE X'2020233030303037333930' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0,
  7874           CLPTOLPI,
  7875           DFHEIV11
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7877         IF CLPTOLPI NOT NUMERIC
  7878             MOVE ER-1778        TO EMI-ERROR
  7879             MOVE -1             TO CLPTOLPL
  7880             MOVE AL-UNBON       TO CLPTOLPA
  7881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7882         END-IF
  7883     END-IF.
  7884     IF LCOMML > ZERO
  7885
  7886* EXEC CICS BIF
  7887*            DEEDIT
  7888*            FIELD    (LCOMMI)
  7889*            LENGTH   (8)
  7890*        END-EXEC
  7891     MOVE 8
  7892       TO DFHEIV11
  7893*    MOVE '@"L                   #   #00007403' TO DFHEIV0
  7894     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7895     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7896     MOVE X'2020233030303037343033' TO DFHEIV0(25:11)
  7897     CALL 'kxdfhei1' USING DFHEIV0,
  7898           LCOMMI,
  7899           DFHEIV11
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7901         IF LCOMMI NOT NUMERIC
  7902             MOVE ER-1778        TO EMI-ERROR
  7903             MOVE -1             TO LCOMML
  7904             MOVE AL-UNBON       TO LCOMMA
  7905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7906         END-IF
  7907     END-IF
  7908     IF MAXMFEEL > ZEROS
  7909
  7910* EXEC CICS BIF DEEDIT
  7911*          FIELD   (MAXMFEEI)
  7912*          LENGTH  (5)
  7913*       END-EXEC
  7914     MOVE 5
  7915       TO DFHEIV11
  7916*    MOVE '@"L                   #   #00007416' TO DFHEIV0
  7917     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7918     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7919     MOVE X'2020233030303037343136' TO DFHEIV0(25:11)
  7920     CALL 'kxdfhei1' USING DFHEIV0,
  7921           MAXMFEEI,
  7922           DFHEIV11
  7923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7924        IF MAXMFEEI NUMERIC
  7925           MOVE MAXMFEEI         TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 151
* EL6501.cbl
  7926           MOVE WS-WORK-NUM      TO MAXMFEEO
  7927        ELSE
  7928           MOVE -1               TO MAXMFEEL
  7929           MOVE AL-UABON         TO MAXMFEEA
  7930           MOVE ER-7717          TO EMI-ERROR
  7931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7932        END-IF
  7933     END-IF
  7934     IF (CLPSTL > 0)
  7935         MOVE AL-UANON           TO CLPSTA
  7936        IF (CLPSTI NOT = SPACES)
  7937           MOVE SPACES           TO ELCNTL-KEY
  7938           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7939           MOVE '3'              TO CNTL-REC-TYPE
  7940           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7941           MOVE +0               TO CNTL-SEQ-NO
  7942
  7943* EXEC CICS  READ
  7944*              DATASET  ('ELCNTL')
  7945*              SET      (ADDRESS OF CONTROL-FILE)
  7946*              RIDFLD   (ELCNTL-KEY)
  7947*              RESP     (WS-RESPONSE)
  7948*          END-EXEC
  7949     MOVE 'ELCNTL' TO DFHEIV1
  7950*    MOVE '&"S        E          (  N#00007438' TO DFHEIV0
  7951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7953     MOVE X'204E233030303037343338' TO DFHEIV0(25:11)
  7954     CALL 'kxdfhei1' USING DFHEIV0,
  7955           DFHEIV1,
  7956           DFHEIV20,
  7957           DFHEIV99,
  7958           ELCNTL-KEY,
  7959           DFHEIV99,
  7960           DFHEIV99,
  7961           DFHEIV99
  7962     SET ADDRESS OF CONTROL-FILE TO
  7963         DFHEIV20
  7964     MOVE EIBRESP  TO WS-RESPONSE
  7965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7966           IF NOT RESP-NORMAL
  7967              MOVE ER-0144       TO EMI-ERROR
  7968              MOVE -1            TO CLPSTL
  7969              MOVE AL-UABON      TO CLPSTA
  7970              PERFORM 9900-ERROR-FORMAT
  7971                                 THRU  9900-EXIT
  7972           END-IF
  7973        ELSE
  7974           MOVE ER-0144          TO EMI-ERROR
  7975           MOVE -1               TO CLPSTL
  7976           MOVE AL-UABON         TO CLPSTA
  7977           PERFORM 9900-ERROR-FORMAT
  7978                                 THRU  9900-EXIT
  7979        END-IF
  7980     END-IF
  7981     IF (PRODCDL > ZEROS)
  7982        and (emi-error not = er-0144)
  7983        if prodcdi = spaces
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 152
* EL6501.cbl
  7984           continue
  7985        else
  7986           move low-values       to erpdef-key
  7987           move pi-company-cd    to erpdef-company-cd
  7988           move clpsti           to erpdef-state
  7989           move prodcdi          to erpdef-prod-cd
  7990           move erpdef-key       to erpdef-key-save
  7991
  7992* exec cics read
  7993*             dataset ('ERPDEF')
  7994*             set     (address of product-master)
  7995*             ridfld  (erpdef-key)
  7996*             length  (6)
  7997*             gteq
  7998*             resp    (ws-response)
  7999*          end-exec
  8000     MOVE 'ERPDEF' TO DFHEIV1
  8001*    MOVE '&"S        G          (  N#00007469' TO DFHEIV0
  8002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8004     MOVE X'204E233030303037343639' TO DFHEIV0(25:11)
  8005     CALL 'kxdfhei1' USING DFHEIV0,
  8006           DFHEIV1,
  8007           DFHEIV20,
  8008           DFHEIV99,
  8009           erpdef-key,
  8010           DFHEIV99,
  8011           DFHEIV99,
  8012           DFHEIV99
  8013     SET ADDRESS OF product-master TO
  8014         DFHEIV20
  8015     MOVE EIBRESP  TO ws-response
  8016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8017           if (resp-normal)
  8018              and (pd-control-primary (1:6) =
  8019                           erpdef-key-save (1:6))
  8020              continue
  8021           else
  8022              move er-8156       to emi-error
  8023              MOVE -1            TO PRODCDL
  8024              MOVE AL-UABON      TO PRODCDA
  8025              PERFORM 9900-ERROR-FORMAT
  8026                                 THRU  9900-EXIT
  8027           end-if
  8028        end-if
  8029     end-if
  8030     .
  8031 4110-CHECK-REMIT.
  8032     IF REMITL NOT GREATER ZEROS
  8033        MOVE 1                   TO REMITI
  8034        MOVE AL-UNNON            TO REMITA
  8035        GO TO 4120-REMIT-ERROR.
  8036
  8037     IF (REMITI NOT NUMERIC)  OR
  8038        (REMITI LESS 1 OR GREATER 10)
  8039           GO TO 4120-REMIT-ERROR.
  8040
  8041 4115-CHECK-AGENT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 153
* EL6501.cbl
  8042     SET M-INDEX                 TO REMITI.
  8043
  8044     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  8045        MOVE ER-2156             TO EMI-ERROR
  8046        GO TO 4120-R-ERROR.
  8047
  8048     GO TO 4130-CHECK-CONTRACT.
  8049
  8050 4120-REMIT-ERROR.
  8051     MOVE ER-2155                TO EMI-ERROR.
  8052
  8053 4120-R-ERROR.
  8054     MOVE -1                     TO REMITL.
  8055     MOVE AL-UABON               TO REMITA.
  8056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8057
  8058 4130-CHECK-CONTRACT.
  8059     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  8060        MOVE CONTRI                TO DEEDIT-FIELD
  8061        PERFORM 8600-DEEDIT
  8062        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8063        MOVE '4'                    TO DC-OPTION-CODE
  8064        PERFORM 9700-DATE-LINK
  8065        IF DATE-CONVERSION-ERROR
  8066           MOVE ER-2157             TO EMI-ERROR
  8067           MOVE -1                  TO CONTRL
  8068           MOVE AL-UABON            TO CONTRA
  8069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8070        ELSE
  8071***  Y2K PROJ 7744
  8072           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  8073           MOVE AL-UANON            TO CONTRA
  8074           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  8075           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  8076        END-IF
  8077     END-IF.
  8078***  Y2K PROJ 7744
  8079
  8080     IF PI-COMPANY-ID = 'DMD'
  8081       IF PI-MAINT = 'A'
  8082        IF CONTRL = ZERO
  8083           MOVE ER-0852             TO EMI-ERROR
  8084           MOVE -1                  TO CONTRL
  8085           MOVE AL-UABON            TO CONTRA
  8086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8087
  8088*4131-CHECK-PSI-FACTOR.
  8089*    IF PSILFFL GREATER +0
  8090*       MOVE PSILFFI             TO DEEDIT-FIELD
  8091*       PERFORM 8600-DEEDIT
  8092*       IF DEEDIT-FIELD NUMERIC
  8093*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8094*                                   PSILFFO
  8095*       ELSE
  8096*          MOVE ER-9999          TO EMI-ERROR
  8097*          MOVE -1               TO PSILFFL
  8098*          MOVE AL-UABON         TO PSILFFA
  8099*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 154
* EL6501.cbl
  8100*
  8101*    IF PSIAHFL GREATER +0
  8102*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8103*       PERFORM 8600-DEEDIT
  8104*       IF DEEDIT-FIELD NUMERIC
  8105*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8106*                                   PSIAHFO
  8107*       ELSE
  8108*          MOVE ER-9999          TO EMI-ERROR
  8109*          MOVE -1               TO PSIAHFL
  8110*          MOVE AL-UABON         TO PSIAHFA
  8111*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8112
  8113 4135-CHECK-PREVIOUS-DATES.
  8114     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8115        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8116        PERFORM 8600-DEEDIT
  8117        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8118        MOVE '4'                    TO DC-OPTION-CODE
  8119        PERFORM 9700-DATE-LINK
  8120        IF DATE-CONVERSION-ERROR
  8121           MOVE ER-0348             TO EMI-ERROR
  8122           MOVE -1                  TO PEFFDTEL
  8123           MOVE AL-UABON            TO PEFFDTEA
  8124           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8125        ELSE
  8126***  Y2K PROJ 7744
  8127           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8128           MOVE AL-UANON            TO PEFFDTEA
  8129           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8130           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8131        END-IF
  8132     END-IF.
  8133
  8134     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8135        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8136        PERFORM 8600-DEEDIT
  8137        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8138           MOVE '99/99/99'             TO PEXPDTEO
  8139           MOVE 99999999999            TO WS-PEXP-DT
  8140           MOVE AL-UANON               TO PEXPDTEA
  8141        ELSE
  8142           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8143           MOVE '4'                    TO DC-OPTION-CODE
  8144           PERFORM 9700-DATE-LINK
  8145           IF DATE-CONVERSION-ERROR
  8146              MOVE ER-0454             TO EMI-ERROR
  8147              MOVE -1                  TO PEXPDTEL
  8148              MOVE AL-UABON            TO PEXPDTEA
  8149              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8150           ELSE
  8151              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8152              MOVE AL-UANON            TO PEXPDTEA
  8153              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8154              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8155           END-IF
  8156        END-IF
  8157     END-IF.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 155
* EL6501.cbl
  8158***  Y2K PROJ 7744
  8159
  8160     IF COMMCALL NOT GREATER ZEROS
  8161         GO TO 4150-CHECK-REINCAL.
  8162
  8163     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8164         (EFFCHG-SAVE LESS 841101)       AND
  8165         (COMMCALI = 'Y' OR '1')         AND
  8166         (NOT MODIFY-CAP)
  8167           MOVE -1               TO COMMCALL
  8168           MOVE AL-UABON         TO COMMCALA
  8169           MOVE ER-2189          TO EMI-ERROR
  8170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8171
  8172     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8173         GO TO 4150-CHECK-REINCAL.
  8174
  8175 4140-COMMCAL-ERROR.
  8176     MOVE -1                     TO COMMCALL.
  8177     MOVE AL-UABON               TO COMMCALA.
  8178     MOVE ER-2158                TO EMI-ERROR.
  8179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8180
  8181 4150-CHECK-REINCAL.
  8182     IF REINCALL NOT GREATER ZEROS
  8183         GO TO 4170-CHECK-REINTAB.
  8184
  8185     IF REINCALI = 'Y' OR 'N'
  8186        GO TO 4170-CHECK-REINTAB.
  8187
  8188 4160-REINCAL-ERROR.
  8189     MOVE -1                     TO REINCALL.
  8190     MOVE AL-UABON               TO REINCALA.
  8191     MOVE ER-2179                TO EMI-ERROR.
  8192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8193
  8194 4170-CHECK-REINTAB.
  8195     IF REINTABL NOT GREATER ZEROS
  8196        IF PI-COMPANY-ID = 'NCL' AND
  8197           MAINTI = 'A'
  8198                MOVE ER-4010         TO EMI-ERROR
  8199                MOVE -1              TO REINTABL
  8200                MOVE AL-UABON        TO REINTABA
  8201                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8202
  8203     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8204         GO TO 4410-CHECK-AGENTS.
  8205     IF PI-COMPANY-ID = 'CID'
  8206        IF PI-ACCT-STATE = 'KY'
  8207           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8208              MOVE -1            TO REINTABL
  8209              MOVE AL-UABON      TO REINTABA
  8210              MOVE ER-2159       TO EMI-ERROR
  8211              PERFORM 9900-ERROR-FORMAT
  8212                                 THRU 9900-EXIT
  8213           END-IF
  8214        END-IF
  8215     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 156
* EL6501.cbl
  8216     MOVE LOW-VALUES             TO REIN-KEY.
  8217
  8218     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8219     MOVE 'A'                    TO REIN-CODE.
  8220     MOVE REINTABI               TO REIN-TABLE.
  8221
  8222
  8223* EXEC CICS HANDLE CONDITION
  8224*        NOTFND   (4180-REIN-ERROR)
  8225*    END-EXEC.
  8226*    MOVE '"$I                   ! + #00007682' TO DFHEIV0
  8227     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8229     MOVE X'2B20233030303037363832' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0
  8231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8232
  8233
  8234
  8235* EXEC CICS READ
  8236*        DATASET   (REIN-FILE-ID)
  8237*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8238*        RIDFLD    (REIN-KEY)
  8239*    END-EXEC.
  8240*    MOVE '&"S        E          (   #00007686' TO DFHEIV0
  8241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8243     MOVE X'2020233030303037363836' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0,
  8245           REIN-FILE-ID,
  8246           DFHEIV20,
  8247           DFHEIV99,
  8248           REIN-KEY,
  8249           DFHEIV99,
  8250           DFHEIV99,
  8251           DFHEIV99
  8252     SET ADDRESS OF REINSURANCE-RECORD TO
  8253         DFHEIV20
  8254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8255
  8256
  8257     GO TO 4410-CHECK-AGENTS.
  8258
  8259 4180-REIN-ERROR.
  8260     MOVE -1                     TO REINTABL.
  8261     MOVE AL-UABON               TO REINTABA.
  8262     MOVE ER-2615                TO EMI-ERROR.
  8263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8264
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 157
* EL6501.cbl
  8266 4410-CHECK-AGENTS.
  8267     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8268     SET M-INDEX TO 1.
  8269
  8270     IF PI-COMPANY-ID = 'NCL'
  8271       IF AGENTL (M-INDEX) GREATER ZEROS
  8272         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8273
  8274 4420-LOOP.
  8275     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8276        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8277            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8278           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8279           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8280           A-HL    (M-INDEX) GREATER ZEROS  OR
  8281           RECALL  (M-INDEX) GREATER ZEROS  OR
  8282           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8283           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8284           CCEL    (M-INDEX) GREATER ZEROS
  8285           MOVE ER-2172          TO EMI-ERROR
  8286           MOVE -1               TO AGENTL (M-INDEX)
  8287           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8288           GO TO 4450-BUMP-INDEX
  8289        else
  8290           go to 4430-check-single
  8291*       ELSE
  8292*          GO TO 4450-BUMP-INDEX.
  8293        end-if
  8294     end-if
  8295     IF AGENT (M-INDEX) = ZEROS
  8296         MOVE ER-2970            TO  EMI-ERROR
  8297         MOVE -1                 TO  AGENTL (M-INDEX)
  8298         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8300         GO TO 4450-BUMP-INDEX.
  8301
  8302     IF ATYPEL (M-INDEX) = ZEROS
  8303        MOVE -1                  TO ATYPEL (M-INDEX)
  8304        MOVE ER-2173             TO EMI-ERROR
  8305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8306        GO TO 4430-CHECK-SINGLE.
  8307
  8308     IF ATYPE (M-INDEX) = 'C'
  8309        ADD 1                    TO WS-ACCOUNT-CTR-C
  8310       ELSE
  8311        IF ATYPE (M-INDEX) = 'R'
  8312           ADD 1                 TO WS-ACCOUNT-CTR-R
  8313          ELSE
  8314           IF ATYPE (M-INDEX) = 'D'
  8315              ADD 1                 TO WS-ACCOUNT-CTR-D
  8316             ELSE
  8317              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8318                                OR 'B' OR 'I' OR 'K' OR 'L'
  8319                                OR 'J' OR 'M' OR 'A' OR 'N'
  8320                                OR 'S'
  8321                 NEXT SENTENCE
  8322                ELSE
  8323                 IF ATYPE (M-INDEX) = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 158
* EL6501.cbl
  8324                    NEXT SENTENCE
  8325                   ELSE
  8326                    MOVE ER-2175       TO EMI-ERROR
  8327                    MOVE -1            TO ATYPEL (M-INDEX)
  8328                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8329                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8330
  8331 4430-CHECK-SINGLE.
  8332     IF SINGLEL (M-INDEX) GREATER ZEROS
  8333        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8334           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8335           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8336           MOVE LOW-VALUES                 TO COMM-FILLER
  8337           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8338           IF COMMISSION-ERROR
  8339              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8340              MOVE -1            TO SINGLEL (M-INDEX)
  8341           ELSE
  8342              if cceind(m-index) <> 'Y'
  8343                 add ws-table-max to COMM-SL-ACCUM
  8344                 if atype (m-index) = 'C' or 'D'
  8345                    add ws-table-max to comm-sl-accum-al
  8346                 else
  8347                    if atype (m-index) = 'O' OR 'P'
  8348                       add ws-table-max to comm-sl-accum-gl
  8349                    end-if
  8350                 end-if
  8351              end-if
  8352           END-IF
  8353        END-IF
  8354     END-IF
  8355     IF JOINTL (M-INDEX) GREATER ZEROS
  8356        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8357           MOVE JOINT-COMM-T (M-INDEX) TO COMM-TABLE
  8358           MOVE PI-LIFE-OVERRIDE-L1    TO COMM-LF-AH
  8359           MOVE LOW-VALUES             TO COMM-FILLER
  8360           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8361           IF COMMISSION-ERROR
  8362              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8363              MOVE -1            TO JOINTL (M-INDEX)
  8364           ELSE
  8365              if cceind(m-index) <> 'Y'
  8366                 add ws-table-max to COMM-JL-ACCUM
  8367                 if atype (m-index) = 'C' or 'D'
  8368                    add ws-table-max to comm-jl-accum-al
  8369                 else
  8370                    if atype (m-index) = 'O' OR 'P'
  8371                       add ws-table-max to comm-jl-accum-gl
  8372                 end-if
  8373              end-if
  8374           END-IF
  8375        END-IF
  8376     END-IF
  8377     IF A-HL (M-INDEX) GREATER ZEROS
  8378        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8379           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8380           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8381           MOVE LOW-VALUES                 TO COMM-FILLER
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 159
* EL6501.cbl
  8382           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8383           IF COMMISSION-ERROR
  8384              MOVE AL-UABON      TO A-HA (M-INDEX)
  8385              MOVE -1            TO A-HL (M-INDEX)
  8386           ELSE
  8387              if cceind(m-index) <> 'Y'
  8388                 add ws-table-max to COMM-ah-ACCUM
  8389                 if atype (m-index) = 'C' or 'D'
  8390                    add ws-table-max to comm-ah-accum-al
  8391                 else
  8392                    if atype (m-index) = 'O' OR 'P'
  8393                       add ws-table-max to comm-ah-accum-gl
  8394                 end-if
  8395              end-if
  8396           END-IF
  8397        END-IF
  8398     END-IF
  8399     IF RECALL (M-INDEX) GREATER ZEROS
  8400         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8401             MOVE AL-UANON       TO RECALA (M-INDEX)
  8402         ELSE
  8403             MOVE -1             TO RECALL (M-INDEX)
  8404             MOVE AL-UABON       TO RECALA (M-INDEX)
  8405             MOVE ER-2158        TO EMI-ERROR
  8406             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8407
  8408     IF RCOMML (M-INDEX) GREATER ZEROS
  8409         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8410             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8411         ELSE
  8412             MOVE -1             TO RCOMML (M-INDEX)
  8413             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8414             MOVE ER-0625        TO EMI-ERROR
  8415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8416
  8417     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8418         IF  CHGBCK (M-INDEX)    NUMERIC
  8419             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8420         ELSE
  8421             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8422             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8423             MOVE  ER-0759         TO  EMI-ERROR
  8424             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8425     IF CCEL (M-INDEX) <> ZEROS
  8426        IF CCEIND(M-INDEX) = 'Y'
  8427           MOVE AL-UANON         TO CCEA(M-INDEX)
  8428           IF ATYPE(M-INDEX) = 'C' OR 'D'
  8429              IF WS-COMM-CAP-LIMIT-TO <> 'A' AND 'B'
  8430                 MOVE  -1        TO CCEL (M-INDEX)
  8431                 MOVE  AL-UABON  TO CCEA (M-INDEX)
  8432                 MOVE  ER-3065   TO EMI-ERROR
  8433                 PERFORM  9900-ERROR-FORMAT
  8434                                 THRU 9900-EXIT
  8435              END-IF
  8436           ELSE
  8437              IF ATYPE(M-INDEX) = 'O' OR 'P'
  8438                 IF WS-COMM-CAP-LIMIT-TO <> 'G' AND 'B'
  8439                    MOVE  -1        TO CCEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 160
* EL6501.cbl
  8440                    MOVE  AL-UABON  TO CCEA (M-INDEX)
  8441                    MOVE  ER-3065   TO EMI-ERROR
  8442                    PERFORM  9900-ERROR-FORMAT
  8443                                    THRU 9900-EXIT
  8444                 END-IF
  8445              END-IF
  8446           END-IF
  8447        ELSE
  8448           IF CCEIND (M-INDEX) = 'N' OR ' '
  8449              MOVE  AL-UANON        TO CCEA (M-INDEX)
  8450           ELSE
  8451              MOVE  -1              TO CCEL (M-INDEX)
  8452              MOVE  AL-UABON        TO CCEA (M-INDEX)
  8453              MOVE  ER-3066         TO EMI-ERROR
  8454              PERFORM  9900-ERROR-FORMAT
  8455                                 THRU 9900-EXIT
  8456           END-IF
  8457        END-IF
  8458     END-IF
  8459     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8460        AND 'J'
  8461         GO TO 4450-BUMP-INDEX.
  8462     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8463        if cceind(m-index) <> 'Y'
  8464           ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM
  8465           if atype (m-index) = 'C' or 'D'
  8466              add SINGLE-COMM-R (M-INDEX) to comm-sl-accum-al
  8467           else
  8468              if atype (m-index) = 'O' or 'P'
  8469                 add single-comm-r (m-index) to comm-sl-accum-gl
  8470              end-if
  8471           end-if
  8472        end-if
  8473     else
  8474        display ' single comm r not numeric '
  8475     end-if
  8476
  8477     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8478        if cceind(m-index) <> 'Y'
  8479           ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM
  8480           if atype (m-index) = 'C' or 'D'
  8481              add JOINT-COMM-R (M-INDEX) to comm-jl-accum-al
  8482           else
  8483              if atype (m-index) = 'O' or 'P'
  8484                 add joint-comm-r (m-index) to comm-jl-accum-gl
  8485              end-if
  8486           end-if
  8487        end-if
  8488     end-if
  8489
  8490     IF A-H-COMM-R (M-INDEX) NUMERIC
  8491        if cceind(m-index) <> 'Y'
  8492           ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8493           if atype (m-index) = 'C' or 'D'
  8494              add A-H-COMM-R (M-INDEX) to comm-ah-accum-al
  8495           else
  8496              if atype (m-index) = 'O' or 'P'
  8497                 add a-h-comm-r (m-index) to comm-ah-accum-gl
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 161
* EL6501.cbl
  8498              end-if
  8499           end-if
  8500        end-if
  8501     END-IF
  8502     .
  8503 4450-BUMP-INDEX.
  8504     SET M-INDEX UP BY 1.
  8505
  8506     IF M-INDEX NOT = 11
  8507        GO TO 4420-LOOP.
  8508
  8509     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8510        WS-ACCOUNT-CTR-D = ZEROS AND
  8511        WS-ACCOUNT-CTR-R = ZEROS
  8512          MOVE ER-2177             TO EMI-ERROR
  8513          MOVE -1                  TO AGENTL (1)
  8514          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8515          GO TO 4900-EXIT.
  8516
  8517     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8518         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8519        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8520         WS-ACCOUNT-CTR-D  GREATER 0)
  8521           MOVE ER-2174             TO EMI-ERROR
  8522           MOVE -1                  TO AGENTL (1)
  8523           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8524           GO TO 4900-EXIT.
  8525
  8526     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8527        WS-ACCOUNT-CTR-R GREATER 1 OR
  8528        WS-ACCOUNT-CTR-D GREATER 1
  8529          MOVE ER-2182             TO EMI-ERROR
  8530          MOVE -1                  TO AGENTL (1)
  8531          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8532          GO TO 4900-EXIT.
  8533
  8534
  8535     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8536        MOVE ZEROS               TO WS-ST-COMM-CAP-SL
  8537     end-if
  8538     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8539        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8540     END-IF
  8541     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8542        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8543     END-IF
  8544
  8545     if ws-st-comm-cap-sl = zeros
  8546        continue
  8547     else
  8548        if comm-sl-accum-al numeric
  8549           if (comm-sl-accum-al > ws-st-comm-cap-sl)
  8550              MOVE -1         TO MAINTL
  8551              MOVE ER-1955    TO EMI-ERROR
  8552              PERFORM 9900-ERROR-FORMAT
  8553                              THRU 9900-EXIT
  8554           end-if
  8555        end-if
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 162
* EL6501.cbl
  8556     end-if
  8557
  8558     if ws-st-comm-cap-jl = zeros
  8559        continue
  8560     else
  8561        if comm-jl-accum-al numeric
  8562           if (comm-jl-accum-al > ws-st-comm-cap-jl)
  8563              MOVE -1         TO MAINTL
  8564              MOVE ER-1956    TO EMI-ERROR
  8565              PERFORM 9900-ERROR-FORMAT
  8566                              THRU 9900-EXIT
  8567           end-if
  8568        end-if
  8569     end-if
  8570
  8571     if ws-st-comm-cap-sa = zeros
  8572        continue
  8573     else
  8574        if comm-ah-accum-al numeric
  8575           if (comm-ah-accum-al > ws-st-comm-cap-sa)
  8576              MOVE -1         TO MAINTL
  8577              MOVE ER-1957    TO EMI-ERROR
  8578              PERFORM 9900-ERROR-FORMAT
  8579                              THRU 9900-EXIT
  8580           end-if
  8581        end-if
  8582     end-if
  8583     if ws-st-ga-comm-cap-sl = zeros
  8584        continue
  8585     else
  8586        if comm-sl-accum-gl numeric
  8587           if (comm-sl-accum-gl > ws-st-ga-comm-cap-sl)
  8588              MOVE -1         TO MAINTL
  8589              MOVE ER-1958    TO EMI-ERROR
  8590              PERFORM 9900-ERROR-FORMAT
  8591                              THRU 9900-EXIT
  8592           end-if
  8593        end-if
  8594     end-if
  8595
  8596     if ws-st-ga-comm-cap-jl = zeros
  8597        continue
  8598     else
  8599        if comm-jl-accum-gl numeric
  8600           if (comm-jl-accum-gl > ws-st-ga-comm-cap-jl)
  8601              MOVE -1         TO MAINTL
  8602              MOVE ER-1959    TO EMI-ERROR
  8603              PERFORM 9900-ERROR-FORMAT
  8604                              THRU 9900-EXIT
  8605           end-if
  8606        end-if
  8607     end-if
  8608
  8609     if ws-st-ga-comm-cap-sa = zeros
  8610        continue
  8611     else
  8612        if comm-ah-accum-gl numeric
  8613           if (comm-ah-accum-gl > ws-st-ga-comm-cap-sa)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 163
* EL6501.cbl
  8614              MOVE -1         TO MAINTL
  8615              MOVE ER-1960    TO EMI-ERROR
  8616              PERFORM 9900-ERROR-FORMAT
  8617                              THRU 9900-EXIT
  8618           end-if
  8619        end-if
  8620     end-if
  8621     if ws-st-tot-comm-cap-sl = zeros
  8622        continue
  8623     else
  8624        if comm-sl-accum numeric
  8625           if (comm-sl-accum > ws-st-tot-comm-cap-sl)
  8626              MOVE -1         TO MAINTL
  8627              MOVE ER-1961    TO EMI-ERROR
  8628              PERFORM 9900-ERROR-FORMAT
  8629                              THRU 9900-EXIT
  8630           end-if
  8631        end-if
  8632     end-if
  8633
  8634     if ws-st-tot-comm-cap-jl = zeros
  8635        continue
  8636     else
  8637        if comm-jl-accum numeric
  8638           if (comm-jl-accum > ws-st-tot-comm-cap-jl)
  8639              MOVE -1         TO MAINTL
  8640              MOVE ER-1962    TO EMI-ERROR
  8641              PERFORM 9900-ERROR-FORMAT
  8642                              THRU 9900-EXIT
  8643           end-if
  8644        end-if
  8645     end-if
  8646
  8647     if ws-st-tot-comm-cap-sa = zeros
  8648        continue
  8649     else
  8650        if comm-ah-accum numeric
  8651           if (comm-ah-accum > ws-st-tot-comm-cap-sa)
  8652              MOVE -1         TO MAINTL
  8653              MOVE ER-1963    TO EMI-ERROR
  8654              PERFORM 9900-ERROR-FORMAT
  8655                              THRU 9900-EXIT
  8656           end-if
  8657        end-if
  8658     end-if
  8659     IF MAINTI NOT = 'C'
  8660        GO TO 4900-EXIT.
  8661
  8662     IF NOT PI-GA-BILLING
  8663        GO TO 4900-EXIT.
  8664
  8665 4460-CHECK-IF-GA-BILLED.
  8666     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8667
  8668     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8669     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8670     SET M-INDEX TO +1.
  8671     MOVE +1 TO AXRF-SUB.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 164
* EL6501.cbl
  8672
  8673 4470-GA-LOOP.
  8674     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8675        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8676        SINGLEL (M-INDEX) GREATER ZERO                OR
  8677        JOINTL  (M-INDEX) GREATER ZERO                OR
  8678        A-HL    (M-INDEX) GREATER ZERO                OR
  8679        RCOMML  (M-INDEX) GREATER ZERO                OR
  8680        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8681        CCEL    (M-INDEX) GREATER ZERO)               AND
  8682        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8683           MOVE ER-2131   TO EMI-ERROR
  8684           MOVE -1        TO AGENTL (M-INDEX)
  8685           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8687
  8688     ADD +1 TO AXRF-SUB.
  8689     SET M-INDEX UP BY +1.
  8690
  8691     IF AXRF-SUB NOT = +11
  8692        GO TO 4470-GA-LOOP.
  8693
  8694 4900-EXIT.
  8695      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 165
* EL6501.cbl
  8697 5000-MOVE-TO-RECORD.
  8698
  8699     IF NAMEL   GREATER THAN ZERO  OR
  8700        INCAREL GREATER THAN ZERO  OR
  8701        ADDR1L  GREATER THAN ZERO  OR
  8702        ACITYL  GREATER THAN ZERO  OR
  8703        ASTATEL GREATER THAN ZERO  OR
  8704        ZIPL    GREATER THAN ZERO  OR
  8705        PHONEL  GREATER THAN ZERO  OR
  8706        TAXNOL  GREATER THAN ZERO
  8707         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8708
  8709     IF CSRL GREATER ZEROS
  8710        MOVE CSRI                TO AM-CSR-CODE.
  8711     IF NAMEL GREATER ZEROS
  8712        MOVE NAMEI               TO AM-NAME.
  8713     IF PCONTL GREATER ZEROS
  8714        MOVE PCONTI              TO AM-CONTROL-NAME
  8715     END-IF
  8716     IF INCAREL GREATER ZEROS
  8717        MOVE INCAREI             TO AM-PERSON.
  8718     IF ADDR1L GREATER ZEROS
  8719        MOVE ADDR1I              TO AM-ADDRS.
  8720     IF TAXNOL GREATER ZEROS
  8721        MOVE TAXNOI              TO AM-ID-NO.
  8722     IF PHONEL GREATER ZEROS
  8723        MOVE PHONEI              TO DEEDIT-FIELD
  8724        PERFORM 8600-DEEDIT
  8725        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8726        MOVE WS-PH1              TO AM-AREA-CODE
  8727        MOVE WS-PH2              TO AM-TEL-PRE
  8728        MOVE WS-PH3              TO AM-TEL-NBR.
  8729
  8730     IF ACITYL GREATER ZEROS
  8731        MOVE ACITYI             TO AM-ADDR-CITY.
  8732     IF ASTATEL GREATER ZEROS
  8733        MOVE ASTATEI            TO AM-ADDR-STATE.
  8734
  8735     IF ZIPL NOT GREATER ZEROS
  8736         GO TO 5010-CONT-MOVING.
  8737
  8738     MOVE ZIPI                   TO WS-ZIP-CODE.
  8739
  8740     IF WS-CANADIAN-ZIP
  8741         IF WS-ZIP-4 = SPACE  OR  '-'
  8742             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8743             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8744         ELSE
  8745             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8746             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8747     ELSE
  8748         IF WS-ZIP-6 = SPACE  OR  '-'
  8749             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8750             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8751         ELSE
  8752             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8753             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8754
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 166
* EL6501.cbl
  8755 5010-CONT-MOVING.
  8756     IF TYPEL GREATER ZEROS
  8757        MOVE TYPEI               TO AM-GPCD.
  8758
  8759     IF STDBENL GREATER ZEROS
  8760        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8761
  8762     IF INDGRPL GREATER ZEROS
  8763        MOVE INDGRPI             TO AM-IG
  8764        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8765
  8766     IF STATUSL GREATER ZEROS
  8767        MOVE STATUSI             TO AM-STATUS
  8768*       INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8769        INSPECT AM-STATUS CONVERTING 'PRLDSFCTIA' TO '9876543210'
  8770     END-IF
  8771
  8772     IF CLPTOLPL GREATER ZEROS
  8773        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8774     END-IF.
  8775
  8776     IF PRODCDL > 0
  8777        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8778     END-IF
  8779     IF CLPSTL > 0
  8780        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8781     END-IF
  8782     IF MAXMFEEL > ZEROS
  8783        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8784     END-IF
  8785     IF LCOMML > ZEROS
  8786        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8787     END-IF
  8788
  8789     IF REMITL GREATER ZEROS
  8790        MOVE REMITI              TO AM-REMIT-TO.
  8791     IF CONTRL GREATER ZEROS
  8792        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8793*    IF PSILFFL GREATER +0
  8794*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8795*    IF PSIAHFL GREATER +0
  8796*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8797     IF PEFFDTEL GREATER ZEROS
  8798        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8799     IF PEXPDTEL GREATER ZEROS
  8800        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8801     IF COMMCALL GREATER ZEROS
  8802        MOVE COMMCALI            TO AM-RECALC-COMM
  8803        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8804     ELSE
  8805         IF MAINTI = 'A'
  8806             MOVE 'N'            TO AM-RECALC-COMM.
  8807
  8808     IF REINCALL GREATER ZEROS
  8809        MOVE REINCALI            TO AM-RECALC-REIN
  8810     ELSE
  8811         IF MAINTI = 'A'
  8812             MOVE 'N'            TO AM-RECALC-REIN.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 167
* EL6501.cbl
  8813
  8814     IF REINTABL GREATER ZEROS
  8815        MOVE REINTABI            TO AM-REI-TABLE.
  8816
  8817     IF PI-MAINT = 'A'
  8818        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8819     END-IF
  8820
  8821     MOVE 1                      TO SUB.
  8822     SET M-INDEX                 TO 1.
  8823
  8824
  8825* EXEC CICS
  8826*         ASKTIME
  8827*    END-EXEC.
  8828*    MOVE '0"                    "   #00008259' TO DFHEIV0
  8829     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8830     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8831     MOVE X'2020233030303038323539' TO DFHEIV0(25:11)
  8832     CALL 'kxdfhei1' USING DFHEIV0,
  8833           DFHEIV99
  8834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8835
  8836
  8837 5000-LOOP.
  8838*    IF PI-COMPANY-ID = 'DCC'
  8839*       IF (M-INDEX = +5)
  8840*          AND ((AGENTL (5) > ZEROS)
  8841*              OR (ATYPEL (5) > ZEROS))
  8842*             MOVE ER-3057         TO EMI-ERROR
  8843*             MOVE -1              TO AGENTL (5)
  8844*             MOVE AL-UABON        TO AGENTA (5)
  8845*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8846*             GO TO 5000-EXIT
  8847*       END-IF
  8848*    END-IF
  8849     IF MAINTI = 'C'
  8850        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8851           (COMMCALI NOT = 'Y' AND '1')                    AND
  8852            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8853           ((AM-AGT (SUB) = ZEROS AND
  8854             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8855                                     ZEROS) AND
  8856           (COMMCALI NOT = 'Y' AND '1')  AND
  8857            AM-HI-CERT-DATE NOT = ZEROS)
  8858              MOVE ER-2181         TO EMI-ERROR
  8859              MOVE -1              TO COMMCALL
  8860              MOVE AL-UABON        TO COMMCALA
  8861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8862              GO TO 5000-EXIT.
  8863
  8864     IF MAINTI = 'C'
  8865        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8866             ATYPE (M-INDEX)) AND
  8867           (COMMCALI NOT = 'Y' AND '1') AND
  8868            AM-HI-CERT-DATE NOT = ZEROS)
  8869            OR
  8870           ((AM-COM-TYP (SUB) = SPACES AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 168
* EL6501.cbl
  8871             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
  8872           (COMMCALI NOT = 'Y' AND '1')  AND
  8873            AM-HI-CERT-DATE NOT = ZEROS)
  8874              MOVE ER-2181         TO EMI-ERROR
  8875              MOVE -1              TO COMMCALL
  8876              MOVE AL-UABON        TO COMMCALA
  8877              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8878              GO TO 5000-EXIT.
  8879
  8880     IF AM-ACCOUNT-BILLED
  8881        IF COMMCALI = 'Y' OR '1'
  8882            MOVE ER-2183         TO EMI-ERROR
  8883            MOVE -1              TO COMMCALL
  8884            MOVE AL-UABON        TO COMMCALA
  8885            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8886            GO TO 5000-EXIT.
  8887
  8888     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8889        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8890        OR
  8891        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8892         ATYPE  (M-INDEX) = SPACES)
  8893           MOVE ZEROS              TO AM-AGT   (SUB)
  8894                                      AM-L-COM (SUB)
  8895                                      AM-J-COM (SUB)
  8896                                      AM-A-COM (SUB)
  8897           MOVE SPACE TO AM-COM-TYP (SUB)
  8898           SET M-INDEX UP BY 1
  8899           ADD 1 TO SUB
  8900           IF SUB = 11
  8901              GO TO 5000-CHECK-MAX-FEES
  8902            ELSE
  8903              GO TO 5000-LOOP.
  8904
  8905     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8906     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8907
  8908     IF SINGLEL (M-INDEX) GREATER ZEROS
  8909        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8910        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8911           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8912          ELSE
  8913           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8914           IF SINGLE-DASH (M-INDEX) = '-'
  8915               MULTIPLY AM-L-COM (SUB) BY -1
  8916                     GIVING AM-L-COM (SUB).
  8917
  8918     IF JOINTL (M-INDEX) GREATER ZEROS
  8919        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8920        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8921           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8922          ELSE
  8923           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8924           IF JOINT-DASH (M-INDEX) = '-'
  8925               MULTIPLY AM-J-COM (SUB) BY -1
  8926                     GIVING AM-J-COM (SUB).
  8927
  8928     IF A-HL (M-INDEX) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 169
* EL6501.cbl
  8929        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8930        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8931           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8932          ELSE
  8933           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8934           IF A-H-DASH (M-INDEX) = '-'
  8935               MULTIPLY AM-A-COM (SUB) BY -1
  8936                     GIVING AM-A-COM (SUB).
  8937
  8938     IF RECALL (M-INDEX) GREATER ZEROS
  8939         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8940
  8941     IF RCOMML (M-INDEX) GREATER ZEROS
  8942         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8943
  8944     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8945         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8946
  8947     IF CCEL (M-INDEX) GREATER ZEROS
  8948         MOVE CCEIND (M-INDEX)   TO AM-GL-CODES (SUB).
  8949
  8950     SET M-INDEX UP BY 1.
  8951     ADD 1 TO SUB.
  8952     IF M-INDEX NOT = 11
  8953        GO TO 5000-LOOP.
  8954
  8955 5000-CHECK-MAX-FEES.
  8956     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8957        MOVE +1                     TO S1
  8958        PERFORM UNTIL S1 > +10
  8959           IF (AM-A-COM (S1) NUMERIC)
  8960              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8961                     AND 'O')
  8962              AND (AM-COM-TYP (S1) = 'J')
  8963                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8964                    + (AM-A-COM (S1) * +1000)
  8965           END-IF
  8966           ADD +1             TO S1
  8967        END-PERFORM
  8968        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8969           MOVE -1               TO MAXMFEEL
  8970           MOVE AL-UABON         TO MAXMFEEA
  8971           MOVE ER-1817          TO EMI-ERROR
  8972           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8973        END-IF
  8974     END-IF
  8975     .
  8976 5000-EXIT.
  8977      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 170
* EL6501.cbl
  8979
  8980 5100-WRITE-TS.
  8981     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8982
  8983     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8984         MOVE ZEROS              TO PI-CR-CARRIER
  8985     ELSE
  8986         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8987
  8988     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8989         MOVE ZEROS              TO PI-CR-GROUPING
  8990     ELSE
  8991         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8992
  8993     IF AM-REMIT-TO NOT = ZERO
  8994         MOVE AM-AGT (AM-REMIT-TO)
  8995                                 TO PI-CR-FIN-RESP
  8996       ELSE
  8997         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8998
  8999     MOVE 'A'                    TO PI-CR-TYPE.
  9000 5110-AGT-LOOP.
  9001     ADD 1                       TO  AGT-SUB.
  9002     IF AGT-SUB GREATER 10
  9003         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  9004         GO TO 5120-WRITE.
  9005
  9006************************************************************
  9007**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9008************************************************************
  9009
  9010     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  9011                  OR 'F' OR 'U'
  9012         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  9013         GO TO 5120-WRITE
  9014     ELSE
  9015         GO TO 5110-AGT-LOOP.
  9016
  9017 5120-WRITE.
  9018
  9019* EXEC CICS WRITEQ TS
  9020*         QUEUE    (QID)
  9021*         FROM     (PROGRAM-INTERFACE-BLOCK)
  9022*         LENGTH   (WS-COMM-LENGTH)
  9023*         ITEM     (W-ONE)
  9024*    END-EXEC.
  9025*    MOVE '*" I   L              ''   #00008444' TO DFHEIV0
  9026     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9028     MOVE X'2020233030303038343434' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           QID,
  9031           PROGRAM-INTERFACE-BLOCK,
  9032           WS-COMM-LENGTH,
  9033           W-ONE,
  9034           DFHEIV99,
  9035           DFHEIV99
  9036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 171
* EL6501.cbl
  9037
  9038
  9039 5199-EXIT.
  9040     EXIT.
  9041
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 172
* EL6501.cbl
  9043
  9044 5200-RECOVER-TS.
  9045
  9046     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  9047                                 XCTL-653 AND
  9048                                 XCTL-689 AND
  9049                                 XCTL-608 AND
  9050                                 XCTL-690
  9051         GO TO 5299-EXIT.
  9052
  9053
  9054* EXEC CICS HANDLE CONDITION
  9055*        QIDERR  (5250-QID-ERROR)
  9056*    END-EXEC.
  9057*    MOVE '"$N                   ! , #00008465' TO DFHEIV0
  9058     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9060     MOVE X'2C20233030303038343635' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0
  9062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9063
  9064
  9065
  9066* EXEC CICS READQ TS
  9067*        QUEUE    (QID)
  9068*        INTO     (PROGRAM-INTERFACE-BLOCK)
  9069*        LENGTH   (WS-COMM-LENGTH)
  9070*        ITEM     (W-ONE)
  9071*    END-EXEC.
  9072*    MOVE '*$II   L              ''   #00008469' TO DFHEIV0
  9073     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9074     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9075     MOVE X'2020233030303038343639' TO DFHEIV0(25:11)
  9076     CALL 'kxdfhei1' USING DFHEIV0,
  9077           QID,
  9078           PROGRAM-INTERFACE-BLOCK,
  9079           WS-COMM-LENGTH,
  9080           W-ONE,
  9081           DFHEIV99,
  9082           DFHEIV99
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9084
  9085
  9086 5200-DELETE-TS.
  9087
  9088
  9089* EXEC CICS DELETEQ TS
  9090*        QUEUE    (QID)
  9091*    END-EXEC.
  9092*    MOVE '*&                    #   #00008478' TO DFHEIV0
  9093     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9095     MOVE X'2020233030303038343738' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0,
  9097           QID,
  9098           DFHEIV99
  9099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9100
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 173
* EL6501.cbl
  9101
  9102     GO TO 5299-EXIT.
  9103
  9104 5250-QID-ERROR.
  9105     MOVE ER-0033                TO  EMI-ERROR.
  9106     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9107
  9108 5299-EXIT.
  9109     EXIT.
  9110
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 174
* EL6501.cbl
  9112
  9113 5300-UPDATE-REQUEST-FILE.
  9114     MOVE +0                     TO SUB1.
  9115
  9116 5300-FIND-ACCOUNT-AGENT.
  9117     ADD +1                      TO SUB1.
  9118
  9119     IF SUB1 GREATER THAN +10
  9120        MOVE ER-2949             TO EMI-ERROR
  9121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9122        MOVE -1                  TO AGENTL (1)
  9123
  9124* EXEC CICS SYNCPOINT ROLLBACK
  9125*       END-EXEC
  9126*    MOVE '6"R                   !   #00008503' TO DFHEIV0
  9127     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  9128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9129     MOVE X'2020233030303038353033' TO DFHEIV0(25:11)
  9130     CALL 'kxdfhei1' USING DFHEIV0
  9131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9132        GO TO 8200-SEND-DATAONLY.
  9133
  9134     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  9135
  9136************************************************************
  9137**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9138************************************************************
  9139
  9140     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  9141        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  9142           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  9143
  9144     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  9145        GO TO 5325-PROCESS-RQST-FILE.
  9146
  9147     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  9148        GO TO 5325-PROCESS-RQST-FILE.
  9149
  9150     GO TO 5399-EXIT.
  9151
  9152 5325-PROCESS-RQST-FILE.
  9153     MOVE LOW-VALUES             TO RQST3-KEY.
  9154     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  9155     MOVE AM-CARRIER             TO RQST3-CARRIER.
  9156     MOVE AM-GROUPING            TO RQST3-GROUPING.
  9157     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  9158     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  9159
  9160
  9161* EXEC CICS HANDLE CONDITION
  9162*        NOTFND(5399-EXIT)
  9163*        ENDFILE(5399-EXIT)
  9164*    END-EXEC.
  9165*    MOVE '"$I''                  ! - #00008533' TO DFHEIV0
  9166     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9168     MOVE X'2D20233030303038353333' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 175
* EL6501.cbl
  9170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9171
  9172
  9173 5325-PROCESS-REQUEST-FILE.
  9174
  9175* EXEC CICS STARTBR
  9176*         DATASET   (RQST3-FILE-ID)
  9177*         RIDFLD    (RQST3-KEY)
  9178*    END-EXEC.
  9179     MOVE 0
  9180       TO DFHEIV11
  9181*    MOVE '&,         G          &   #00008539' TO DFHEIV0
  9182     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9183     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9184     MOVE X'2020233030303038353339' TO DFHEIV0(25:11)
  9185     CALL 'kxdfhei1' USING DFHEIV0,
  9186           RQST3-FILE-ID,
  9187           RQST3-KEY,
  9188           DFHEIV99,
  9189           DFHEIV11,
  9190           DFHEIV99
  9191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9192
  9193
  9194 5330-READNEXT-REQUEST.
  9195
  9196* EXEC CICS READNEXT
  9197*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9198*        DATASET(RQST3-FILE-ID)
  9199*        RIDFLD (RQST3-KEY)
  9200*    END-EXEC.
  9201     MOVE 0
  9202       TO DFHEIV11
  9203*    MOVE '&.S                   )   #00008545' TO DFHEIV0
  9204     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9206     MOVE X'2020233030303038353435' TO DFHEIV0(25:11)
  9207     CALL 'kxdfhei1' USING DFHEIV0,
  9208           RQST3-FILE-ID,
  9209           DFHEIV20,
  9210           DFHEIV99,
  9211           RQST3-KEY,
  9212           DFHEIV99,
  9213           DFHEIV11,
  9214           DFHEIV99,
  9215           DFHEIV99
  9216     SET ADDRESS OF AR-REQUEST-RECORD TO
  9217         DFHEIV20
  9218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9219
  9220
  9221     IF RQST3-KEY = SAVE-RQST3-KEY
  9222        GO TO 5330-READNEXT-REQUEST.
  9223
  9224     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9225
  9226     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9227        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 176
* EL6501.cbl
  9228
  9229     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9230        GO TO 5350-REQUESTS-FINISHED.
  9231
  9232     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9233        GO TO 5350-REQUESTS-FINISHED.
  9234
  9235     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9236
  9237
  9238* EXEC CICS ENDBR
  9239*        DATASET(RQST3-FILE-ID)
  9240*    END-EXEC.
  9241     MOVE 0
  9242       TO DFHEIV11
  9243*    MOVE '&2                    $   #00008567' TO DFHEIV0
  9244     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9245     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9246     MOVE X'2020233030303038353637' TO DFHEIV0(25:11)
  9247     CALL 'kxdfhei1' USING DFHEIV0,
  9248           RQST3-FILE-ID,
  9249           DFHEIV11,
  9250           DFHEIV99
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9252
  9253
  9254
  9255* EXEC CICS READ
  9256*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9257*        DATASET(RQST-FILE-ID)
  9258*        RIDFLD (RQST-KEY)
  9259*        UPDATE
  9260*    END-EXEC.
  9261*    MOVE '&"S        EU         (   #00008571' TO DFHEIV0
  9262     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9263     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9264     MOVE X'2020233030303038353731' TO DFHEIV0(25:11)
  9265     CALL 'kxdfhei1' USING DFHEIV0,
  9266           RQST-FILE-ID,
  9267           DFHEIV20,
  9268           DFHEIV99,
  9269           RQST-KEY,
  9270           DFHEIV99,
  9271           DFHEIV99,
  9272           DFHEIV99
  9273     SET ADDRESS OF AR-REQUEST-RECORD TO
  9274         DFHEIV20
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9276
  9277
  9278     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9279     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9280
  9281
  9282* EXEC CICS REWRITE
  9283*        DATASET   (RQST-FILE-ID)
  9284*        FROM      (AR-REQUEST-RECORD)
  9285*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 177
* EL6501.cbl
  9286     MOVE LENGTH OF
  9287      AR-REQUEST-RECORD
  9288       TO DFHEIV11
  9289*    MOVE '&& L                  %   #00008581' TO DFHEIV0
  9290     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9291     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9292     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  9293     CALL 'kxdfhei1' USING DFHEIV0,
  9294           RQST-FILE-ID,
  9295           AR-REQUEST-RECORD,
  9296           DFHEIV11,
  9297           DFHEIV99
  9298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9299
  9300
  9301     GO TO  5325-PROCESS-REQUEST-FILE.
  9302
  9303 5350-REQUESTS-FINISHED.
  9304
  9305* EXEC CICS ENDBR
  9306*        DATASET(RQST3-FILE-ID)
  9307*    END-EXEC.
  9308     MOVE 0
  9309       TO DFHEIV11
  9310*    MOVE '&2                    $   #00008589' TO DFHEIV0
  9311     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9312     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9313     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  9314     CALL 'kxdfhei1' USING DFHEIV0,
  9315           RQST3-FILE-ID,
  9316           DFHEIV11,
  9317           DFHEIV99
  9318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9319
  9320
  9321 5399-EXIT.
  9322     EXIT.
  9323
  9324
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 178
* EL6501.cbl
  9326
  9327 6000-MOVE-TO-SCREEN.
  9328     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9329
  9330     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9331     MOVE AM-NAME                TO NAMEO.
  9332     MOVE AM-CONTROL-NAME        TO PCONTO.
  9333     MOVE AM-CSR-CODE            TO CSRO.
  9334     MOVE AM-PERSON              TO INCAREO.
  9335     MOVE AM-ADDRS               TO ADDR1O.
  9336     MOVE AM-ID-NO               TO TAXNOO.
  9337     MOVE AM-TEL-NO              TO WS-PHONE.
  9338     MOVE WS-PHONE-NUM           TO PHONEO.
  9339     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9340     MOVE AM-ADDR-CITY           TO ACITYO
  9341     MOVE AM-ADDR-STATE          TO ASTATEO
  9342
  9343     MOVE SPACES                 TO WS-ZIP-CODE.
  9344     IF AM-CANADIAN-POST-CODE
  9345         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9346         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9347     ELSE
  9348         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9349         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9350             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9351             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9352
  9353     MOVE WS-ZIP-CODE            TO ZIPO.
  9354
  9355     MOVE AM-GPCD                TO TYPEO.
  9356     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9357
  9358     MOVE AM-IG                  TO INDGRPO.
  9359     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9360
  9361     MOVE AM-STATUS              TO STATUSO.
  9362*    INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9363     INSPECT STATUSO CONVERTING '9876543210' TO 'PRLDSFCTIA'
  9364
  9365     MOVE AM-REMIT-TO            TO REMITO.
  9366
  9367     IF PI-AR-PROCESSING
  9368        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9369           MOVE AL-UNNON         TO REMITA
  9370        ELSE
  9371           MOVE AL-SANON         TO REMITA
  9372     ELSE
  9373        MOVE AL-UNNON            TO REMITA.
  9374
  9375***  Y2K PROJ 7744
  9376     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9377     MOVE '3'                    TO DC-OPTION-CODE.
  9378     PERFORM 9700-DATE-LINK.
  9379     IF DATE-CONVERSION-ERROR
  9380        MOVE SPACES              TO CONTRO
  9381     ELSE
  9382        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9383     END-IF.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 179
* EL6501.cbl
  9384***  Y2K PROJ 7744
  9385
  9386*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9387*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9388
  9389*    IF AM-LF-PSI-FACTOR NUMERIC
  9390*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9391*
  9392*    IF AM-AH-PSI-FACTOR NUMERIC
  9393*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9394
  9395     MOVE AM-RECALC-COMM         TO COMMCALO.
  9396     MOVE AL-UANON               TO COMMCALA.
  9397     MOVE AM-RECALC-REIN         TO REINCALO.
  9398     MOVE AM-REI-TABLE           TO REINTABO.
  9399     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9400     MOVE '3'                    TO DC-OPTION-CODE.
  9401     PERFORM 9700-DATE-LINK.
  9402     IF DATE-CONVERSION-ERROR
  9403        MOVE SPACES              TO PRODATEO
  9404     ELSE
  9405        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9406
  9407     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  9408        IF AM-CLP-TOL-PCT NOT NUMERIC
  9409           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9410        END-IF
  9411        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9412           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9413        END-IF
  9414        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9415        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9416        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9417        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9418        MOVE AL-UANON            TO CLPSTA
  9419        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9420           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9421        END-IF
  9422        MOVE AM-DCC-MAX-MARKETING-FEE
  9423                                 TO MAXMFEEO
  9424     ELSE
  9425        MOVE AL-SADOF            TO CTPLABLA
  9426                                    CLPTOLPA
  9427                                    LCLABLA
  9428                                    LCOMMA
  9429     END-IF
  9430
  9431     IF AM-RET-Y-N = ' '  OR  'N'
  9432         MOVE 'NO '              TO RETROCDO
  9433     ELSE
  9434         MOVE 'YES'              TO RETROCDO.
  9435
  9436     IF AM-ACCOUNT-BILLED
  9437         MOVE 'YES'              TO BILLCDO
  9438     ELSE
  9439         MOVE 'NO '              TO BILLCDO.
  9440
  9441     MOVE AL-UANON               TO RETROCDA.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 180
* EL6501.cbl
  9442     MOVE AL-SANON               TO PRODATEA
  9443                                    BILLCDA.
  9444     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9445     MOVE '3' TO DC-OPTION-CODE.
  9446     PERFORM 9700-DATE-LINK.
  9447     IF DATE-CONVERSION-ERROR
  9448        MOVE SPACES TO PEFFDTEO
  9449     ELSE
  9450        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9451
  9452     IF AM-PREV-EXP-DT NOT = 99999999999
  9453        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9454        MOVE '3' TO DC-OPTION-CODE
  9455        PERFORM 9700-DATE-LINK
  9456        IF DATE-CONVERSION-ERROR
  9457           MOVE SPACES TO PEXPDTEO
  9458        ELSE
  9459           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9460     ELSE
  9461        MOVE '99/99/99' TO PEXPDTEO.
  9462
  9463     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9464        MOVE AL-UANON            TO PEXPDTEA
  9465                                    PEFFDTEA
  9466        MOVE AL-SANOF TO            PDSPLYA.
  9467
  9468     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9469     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9470     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9471
  9472     MOVE 1  TO SUB.
  9473     SET M-INDEX TO 1.
  9474
  9475 6005-LOOP.
  9476     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9477        IF PI-AR-PROCESSING
  9478           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9479              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9480                                   ATYPEA (M-INDEX)
  9481                                   SINGLEA (M-INDEX)
  9482                                   JOINTA (M-INDEX)
  9483                                   A-HA    (M-INDEX)
  9484              GO TO 6010-BUMP-SUB
  9485           ELSE
  9486              GO TO 6010-BUMP-SUB
  9487        ELSE
  9488           GO TO 6010-BUMP-SUB.
  9489
  9490     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9491
  9492***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9493     IF WS-DMD-AGENT = LOW-VALUES
  9494        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9495***DMD ******************************************************
  9496
  9497     IF PI-GA-BILLING
  9498        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9499     MOVE AL-UANON               TO AGENTA (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 181
* EL6501.cbl
  9500
  9501     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9502     IF PI-GA-BILLING
  9503        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9504     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9505
  9506     IF (AM-L-COM (SUB) NOT NUMERIC)
  9507        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9508        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9509     ELSE
  9510        IF AM-L-COM (SUB) NOT = ZEROS
  9511           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9512     move al-uanon to singlea (m-index)
  9513
  9514     IF (AM-J-COM (SUB) NOT NUMERIC)
  9515        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9516        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9517     ELSE
  9518        IF AM-J-COM (SUB) NOT = ZEROS
  9519           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9520     move al-uanon to jointa (m-index)
  9521
  9522     IF (AM-A-COM (SUB) NOT NUMERIC)
  9523        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9524        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9525     ELSE
  9526        IF AM-A-COM (SUB) NOT = ZEROS
  9527           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9528     move al-uanon to a-ha (m-index)
  9529
  9530************************************************************
  9531**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9532************************************************************
  9533
  9534     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9535            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9536            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9537         GO TO 6006-CONTINUE.
  9538     .
  9539 6006-CONTINUE.
  9540     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9541        MOVE ZEROS               TO WS-ST-COMM-CAP-SL
  9542     end-if
  9543     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9544        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  9545     end-if
  9546     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9547        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  9548     end-if
  9549     IF (AM-L-COM (SUB) NUMERIC)
  9550        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9551        if am-gl-codes(sub) <> 'Y'
  9552           ADD AM-L-COM (SUB)    TO COMM-SL-ACCUM
  9553           if am-com-typ (sub) = 'C' or 'D'
  9554              ADD AM-L-COM (SUB) TO COMM-SL-ACCUM-al
  9555           else
  9556              if am-com-typ (sub) = 'O' or 'P'
  9557                 add am-l-com (sub) to comm-sl-accum-gl
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 182
* EL6501.cbl
  9558              end-if
  9559           end-if
  9560        end-if
  9561     ELSE
  9562        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9563        MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9564        MOVE PI-LIFE-OVERRIDE-L1
  9565                              TO COMM-LF-AH
  9566        MOVE LOW-VALUES       TO COMM-FILLER
  9567        PERFORM 6400-READ-COMMISSION
  9568                              THRU 6459-EXIT
  9569        if am-gl-codes(sub) <> 'Y'
  9570           add ws-table-max         to COMM-SL-ACCUM
  9571           if atype (m-index) = 'C' or 'D'
  9572              add ws-table-max to comm-sl-accum-al
  9573           else
  9574              if atype (m-index) = 'O' or 'P'
  9575                 add ws-table-max to comm-sl-accum-gl
  9576              end-if
  9577           end-if
  9578        end-if
  9579     END-IF
  9580     IF (AM-J-COM (SUB) NUMERIC)
  9581        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9582        if am-gl-codes(sub) <> 'Y'
  9583           ADD AM-J-COM (SUB)    TO COMM-JL-ACCUM
  9584           if am-com-typ (sub) = 'C' or 'D'
  9585              ADD AM-J-COM (SUB) TO COMM-JL-ACCUM-al
  9586           else
  9587              if am-com-typ (sub) = 'O' or 'P'
  9588                 add am-J-com (sub) to comm-Jl-accum-gl
  9589              end-if
  9590           end-if
  9591        end-if
  9592     ELSE
  9593        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9594        MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9595        MOVE PI-LIFE-OVERRIDE-L1
  9596                              TO COMM-LF-AH
  9597        MOVE LOW-VALUES       TO COMM-FILLER
  9598        PERFORM 6400-READ-COMMISSION
  9599                              THRU 6459-EXIT
  9600        if am-gl-codes(sub) <> 'Y'
  9601           add ws-table-max to COMM-JL-ACCUM
  9602           if atype (m-index) = 'C' or 'D'
  9603              add ws-table-max to comm-jl-accum-al
  9604           else
  9605              if atype (m-index) = 'O' or 'P'
  9606                 add ws-table-max to comm-jl-accum-gl
  9607              end-if
  9608           end-if
  9609        end-if
  9610     END-IF
  9611     IF (AM-A-COM (SUB) NUMERIC)
  9612        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9613        if am-gl-codes(sub) <> 'Y'
  9614           ADD AM-A-COM (SUB)    TO COMM-AH-ACCUM
  9615           if am-com-typ (sub) = 'C' or 'D'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 183
* EL6501.cbl
  9616              ADD AM-A-COM (SUB) TO COMM-AH-ACCUM-al
  9617           else
  9618              if am-com-typ (sub) = 'O' or 'P'
  9619                 add am-a-com (sub) to comm-AH-accum-gl
  9620              end-if
  9621           end-if
  9622        end-if
  9623     ELSE
  9624        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9625        MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9626        MOVE PI-AH-OVERRIDE-L1
  9627                              TO COMM-LF-AH
  9628        MOVE LOW-VALUES       TO COMM-FILLER
  9629        PERFORM 6400-READ-COMMISSION
  9630                              THRU 6459-EXIT
  9631        if am-gl-codes(sub) <> 'Y'
  9632           add ws-table-max to COMM-AH-ACCUM
  9633           if atype (m-index) = 'C' or 'D'
  9634              add ws-table-max to comm-AH-accum-al
  9635           else
  9636              if atype (m-index) = 'O' or 'P'
  9637                 add ws-table-max to comm-ah-accum-gl
  9638              end-if
  9639           end-if
  9640        end-if
  9641     END-IF
  9642
  9643
  9644     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9645         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9646
  9647     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9648         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9649
  9650     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9651        NEXT SENTENCE
  9652     ELSE
  9653        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9654
  9655     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9656         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9657     IF AM-GL-CODES (SUB) = 'Y'
  9658        MOVE AM-GL-CODES (SUB)   TO CCEIND (M-INDEX)
  9659        MOVE AL-UANON            TO CCEA   (M-INDEX)
  9660     ELSE
  9661        MOVE 'N'                 TO CCEIND (M-INDEX)
  9662     END-IF
  9663     if am-gl-codes(sub) = 'Y'
  9664        if ((am-com-typ(sub) = 'C' OR 'D')
  9665           and (WS-COMM-CAP-LIMIT-TO not = 'A' AND 'B'))
  9666                            or
  9667           ((am-com-typ(sub) = 'O' or 'P')
  9668           and (ws-comm-cap-limit-to not = 'G' AND 'B'))
  9669           move er-3065       to emi-error
  9670           move -1            to maintl
  9671           perform 9900-error-format
  9672                                 thru 9900-exit
  9673        end-if
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 184
* EL6501.cbl
  9674     end-if
  9675     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9676         MOVE AM-GL-CODES (SUB)  TO  CCEIND (M-INDEX).
  9677
  9678     IF NOT PI-AR-PROCESSING
  9679        GO TO 6010-BUMP-SUB.
  9680
  9681     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9682        GO TO 6010-BUMP-SUB.
  9683
  9684     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9685                                   ATYPEA  (M-INDEX)
  9686                                   SINGLEA (M-INDEX)
  9687                                   JOINTA  (M-INDEX)
  9688                                   A-HA    (M-INDEX).
  9689
  9690 6010-BUMP-SUB.
  9691     ADD 1  TO SUB.
  9692     SET M-INDEX UP BY 1.
  9693     IF SUB LESS 11
  9694        GO TO 6005-LOOP.
  9695     if ws-st-comm-cap-sl = zeros
  9696        continue
  9697     else
  9698        if comm-sl-accum-al > ws-st-comm-cap-sl
  9699           MOVE -1               TO MAINTL
  9700           MOVE ER-1955          TO EMI-ERROR
  9701           PERFORM 9900-ERROR-FORMAT
  9702                                 THRU 9900-EXIT
  9703        end-if
  9704     end-if
  9705
  9706     if ws-st-comm-cap-jl = zeros
  9707        continue
  9708     else
  9709        if comm-jl-accum-al > ws-st-comm-cap-jl
  9710           MOVE -1               TO MAINTL
  9711           MOVE ER-1956          TO EMI-ERROR
  9712           PERFORM 9900-ERROR-FORMAT
  9713                                 THRU 9900-EXIT
  9714        end-if
  9715     end-if
  9716
  9717     if ws-st-comm-cap-sa = zeros
  9718        continue
  9719     else
  9720        if comm-ah-accum-al > ws-st-comm-cap-sa
  9721           MOVE -1               TO MAINTL
  9722           MOVE ER-1957          TO EMI-ERROR
  9723           PERFORM 9900-ERROR-FORMAT
  9724                                 THRU 9900-EXIT
  9725        end-if
  9726     end-if
  9727
  9728
  9729     if ws-st-ga-comm-cap-sl = zeros
  9730        continue
  9731     else
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 185
* EL6501.cbl
  9732        if comm-sl-accum-gl > ws-st-ga-comm-cap-sl
  9733           MOVE -1               TO MAINTL
  9734           MOVE ER-1958          TO EMI-ERROR
  9735           PERFORM 9900-ERROR-FORMAT
  9736                                 THRU 9900-EXIT
  9737        end-if
  9738     end-if
  9739
  9740     if ws-st-ga-comm-cap-jl = zeros
  9741        continue
  9742     else
  9743        if comm-jl-accum-gl > ws-st-ga-comm-cap-jl
  9744           MOVE -1               TO MAINTL
  9745           MOVE ER-1959          TO EMI-ERROR
  9746           PERFORM 9900-ERROR-FORMAT
  9747                                 THRU 9900-EXIT
  9748        end-if
  9749     end-if
  9750
  9751     if ws-st-ga-comm-cap-sa = zeros
  9752        continue
  9753     else
  9754        if comm-ah-accum-gl > ws-st-ga-comm-cap-sa
  9755           MOVE -1               TO MAINTL
  9756           MOVE ER-1960          TO EMI-ERROR
  9757           PERFORM 9900-ERROR-FORMAT
  9758                                 THRU 9900-EXIT
  9759        end-if
  9760     end-if
  9761
  9762     if ws-st-tot-comm-cap-sl = zeros
  9763        continue
  9764     else
  9765        if comm-sl-accum > ws-st-tot-comm-cap-sl
  9766           MOVE -1                  TO MAINTL
  9767           MOVE ER-1961             TO EMI-ERROR
  9768           PERFORM 9900-ERROR-FORMAT
  9769                                    THRU 9900-EXIT
  9770        end-if
  9771     end-if
  9772
  9773     if ws-st-tot-comm-cap-jl = zeros
  9774        continue
  9775     else
  9776        if comm-jl-accum > ws-st-tot-comm-cap-jl
  9777           MOVE -1                  TO MAINTL
  9778           MOVE ER-1962             TO EMI-ERROR
  9779           PERFORM 9900-ERROR-FORMAT
  9780                                    THRU 9900-EXIT
  9781        end-if
  9782     end-if
  9783
  9784     if ws-st-tot-comm-cap-sa = zeros
  9785        continue
  9786     else
  9787        if comm-ah-accum > ws-st-tot-comm-cap-sa
  9788           MOVE -1                  TO MAINTL
  9789           MOVE ER-1963             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 186
* EL6501.cbl
  9790           PERFORM 9900-ERROR-FORMAT
  9791                                    THRU 9900-EXIT
  9792        end-if
  9793     end-if
  9794     .
  9795 6099-EXIT.
  9796      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 187
* EL6501.cbl
  9798 6300-STARTBR.
  9799
  9800* EXEC CICS STARTBR
  9801*         DATASET   (ACCT-FILE-ID)
  9802*         RIDFLD    (WS-KEY-SAVE)
  9803*    END-EXEC.
  9804     MOVE 0
  9805       TO DFHEIV11
  9806*    MOVE '&,         G          &   #00009071' TO DFHEIV0
  9807     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9809     MOVE X'2020233030303039303731' TO DFHEIV0(25:11)
  9810     CALL 'kxdfhei1' USING DFHEIV0,
  9811           ACCT-FILE-ID,
  9812           WS-KEY-SAVE,
  9813           DFHEIV99,
  9814           DFHEIV11,
  9815           DFHEIV99
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
  9818
  9819     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9820
  9821 6300-EXIT.
  9822      EXIT.
  9823
  9824 6310-READNEXT.
  9825
  9826* EXEC CICS READNEXT
  9827*         DATASET    (ACCT-FILE-ID)
  9828*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9829*         RIDFLD     (WS-KEY-SAVE)
  9830*    END-EXEC.
  9831     MOVE 0
  9832       TO DFHEIV11
  9833*    MOVE '&.S                   )   #00009082' TO DFHEIV0
  9834     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9835     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9836     MOVE X'2020233030303039303832' TO DFHEIV0(25:11)
  9837     CALL 'kxdfhei1' USING DFHEIV0,
  9838           ACCT-FILE-ID,
  9839           DFHEIV20,
  9840           DFHEIV99,
  9841           WS-KEY-SAVE,
  9842           DFHEIV99,
  9843           DFHEIV11,
  9844           DFHEIV99,
  9845           DFHEIV99
  9846     SET ADDRESS OF ACCOUNT-MASTER TO
  9847         DFHEIV20
  9848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9849
  9850
  9851 6310-EXIT.
  9852      EXIT.
  9853
  9854 6320-ENDBR.
  9855     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 188
* EL6501.cbl
  9856
  9857* EXEC CICS ENDBR
  9858*        DATASET(ACCT-FILE-ID)
  9859*    END-EXEC.
  9860     MOVE 0
  9861       TO DFHEIV11
  9862*    MOVE '&2                    $   #00009093' TO DFHEIV0
  9863     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9865     MOVE X'2020233030303039303933' TO DFHEIV0(25:11)
  9866     CALL 'kxdfhei1' USING DFHEIV0,
  9867           ACCT-FILE-ID,
  9868           DFHEIV11,
  9869           DFHEIV99
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
  9873 6320-EXIT.
  9874      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 189
* EL6501.cbl
  9876 6400-READ-COMMISSION.
  9877     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9878
  9879* EXEC CICS HANDLE CONDITION
  9880*         NOTFND   (6450-NOT-FOUND)
  9881*    END-EXEC
  9882*    MOVE '"$I                   ! . #00009102' TO DFHEIV0
  9883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9885     MOVE X'2E20233030303039313032' TO DFHEIV0(25:11)
  9886     CALL 'kxdfhei1' USING DFHEIV0
  9887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9888
  9889
  9890* EXEC CICS READ
  9891*        GTEQ
  9892*        DATASET   (COMM-FILE-ID)
  9893*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9894*        RIDFLD    (COMM-KEY)
  9895*    END-EXEC
  9896*    MOVE '&"S        G          (   #00009106' TO DFHEIV0
  9897     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9899     MOVE X'2020233030303039313036' TO DFHEIV0(25:11)
  9900     CALL 'kxdfhei1' USING DFHEIV0,
  9901           COMM-FILE-ID,
  9902           DFHEIV20,
  9903           DFHEIV99,
  9904           COMM-KEY,
  9905           DFHEIV99,
  9906           DFHEIV99,
  9907           DFHEIV99
  9908     SET ADDRESS OF COMM-TABLE-RECORD TO
  9909         DFHEIV20
  9910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9911
  9912     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9913        CT-TABLE      = COMM-TABLE    AND
  9914        CT-BEN-TYPE   = COMM-LF-AH
  9915        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9916        GO TO 6459-EXIT
  9917     END-IF
  9918     .
  9919 6450-NOT-FOUND.
  9920     MOVE ER-2176                TO EMI-ERROR.
  9921     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9922     MOVE 1  TO WS-COMM-ERROR-SW.
  9923
  9924 6459-EXIT.
  9925      EXIT.
  9926
  9927 6460-CHECK-MAX.
  9928
  9929
  9930* EXEC CICS STARTBR
  9931*         DATASET   (COMM-FILE-ID)
  9932*         RIDFLD    (COMM-KEY)
  9933*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 190
* EL6501.cbl
  9934*    END-EXEC
  9935     MOVE 0
  9936       TO DFHEIV11
  9937*    MOVE '&,         G          &  N#00009130' TO DFHEIV0
  9938     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9939     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9940     MOVE X'204E233030303039313330' TO DFHEIV0(25:11)
  9941     CALL 'kxdfhei1' USING DFHEIV0,
  9942           COMM-FILE-ID,
  9943           COMM-KEY,
  9944           DFHEIV99,
  9945           DFHEIV11,
  9946           DFHEIV99
  9947     MOVE EIBRESP  TO WS-RESPONSE
  9948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9949
  9950     MOVE SPACES          TO WS-STATE-MAX-SW
  9951
  9952     IF RESP-NORMAL
  9953        MOVE LOW-VALUES          TO COMM-FILLER
  9954        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9955        MOVE ZEROS               TO WS-TABLE-MAX
  9956        PERFORM UNTIL
  9957              (NOT RESP-NORMAL) OR
  9958              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9959
  9960* EXEC CICS READNEXT
  9961*             DATASET   (COMM-FILE-ID)
  9962*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9963*             RIDFLD    (COMM-KEY)
  9964*             RESP      (WS-RESPONSE)
  9965*           END-EXEC
  9966     MOVE 0
  9967       TO DFHEIV11
  9968*    MOVE '&.S                   )  N#00009145' TO DFHEIV0
  9969     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9970     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9971     MOVE X'204E233030303039313435' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           COMM-FILE-ID,
  9974           DFHEIV20,
  9975           DFHEIV99,
  9976           COMM-KEY,
  9977           DFHEIV99,
  9978           DFHEIV11,
  9979           DFHEIV99,
  9980           DFHEIV99
  9981     SET ADDRESS OF COMM-TABLE-RECORD TO
  9982         DFHEIV20
  9983     MOVE EIBRESP  TO WS-RESPONSE
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9985            IF (RESP-NORMAL) AND
  9986               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9987               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9988                   (WS-NDX > +27)
  9989                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9990                      MOVE CT-RT (WS-NDX)
  9991                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 191
* EL6501.cbl
  9992                   END-IF
  9993               END-PERFORM
  9994            END-IF
  9995        END-PERFORM
  9996
  9997* EXEC CICS ENDBR
  9998*            DATASET   (COMM-FILE-ID)
  9999*       END-EXEC
 10000     MOVE 0
 10001       TO DFHEIV11
 10002*    MOVE '&2                    $   #00009162' TO DFHEIV0
 10003     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10004     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10005     MOVE X'2020233030303039313632' TO DFHEIV0(25:11)
 10006     CALL 'kxdfhei1' USING DFHEIV0,
 10007           COMM-FILE-ID,
 10008           DFHEIV11,
 10009           DFHEIV99
 10010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10011     END-IF
 10012
 10013     .
 10014 6460-EXIT.
 10015      EXIT.
 10016
 10017
 10018 6500-READ-ACCT.
 10019
 10020* EXEC CICS READ
 10021*        GTEQ
 10022*        DATASET   (ACCT-FILE-ID)
 10023*        SET       (ADDRESS OF ACCOUNT-MASTER)
 10024*        RIDFLD    (PI-ACCT-KEY)
 10025*    END-EXEC.
 10026*    MOVE '&"S        G          (   #00009173' TO DFHEIV0
 10027     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10029     MOVE X'2020233030303039313733' TO DFHEIV0(25:11)
 10030     CALL 'kxdfhei1' USING DFHEIV0,
 10031           ACCT-FILE-ID,
 10032           DFHEIV20,
 10033           DFHEIV99,
 10034           PI-ACCT-KEY,
 10035           DFHEIV99,
 10036           DFHEIV99,
 10037           DFHEIV99
 10038     SET ADDRESS OF ACCOUNT-MASTER TO
 10039         DFHEIV20
 10040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10041
 10042
 10043 6599-EXIT.
 10044      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 192
* EL6501.cbl
 10046 6600-UPDATE-MAINT-DT.
 10047     MOVE SPACES                 TO ELCNTL-KEY.
 10048
 10049     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10050     MOVE '1'                    TO CNTL-REC-TYPE.
 10051     MOVE +0                     TO CNTL-SEQ-NO.
 10052
 10053
 10054* EXEC CICS HANDLE CONDITION
 10055*        NOTFND   (6699-EXIT)
 10056*    END-EXEC.
 10057*    MOVE '"$I                   ! / #00009190' TO DFHEIV0
 10058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10060     MOVE X'2F20233030303039313930' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0
 10062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10063
 10064
 10065
 10066* EXEC CICS READ
 10067*        UPDATE
 10068*        DATASET   (CNTL-FILE-ID)
 10069*        SET       (ADDRESS OF CONTROL-FILE)
 10070*        RIDFLD    (ELCNTL-KEY)
 10071*    END-EXEC.
 10072*    MOVE '&"S        EU         (   #00009194' TO DFHEIV0
 10073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10074     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10075     MOVE X'2020233030303039313934' TO DFHEIV0(25:11)
 10076     CALL 'kxdfhei1' USING DFHEIV0,
 10077           CNTL-FILE-ID,
 10078           DFHEIV20,
 10079           DFHEIV99,
 10080           ELCNTL-KEY,
 10081           DFHEIV99,
 10082           DFHEIV99,
 10083           DFHEIV99
 10084     SET ADDRESS OF CONTROL-FILE TO
 10085         DFHEIV20
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10087
 10088
 10089     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
 10090
 10091
 10092* EXEC CICS REWRITE
 10093*        DATASET   (CNTL-FILE-ID)
 10094*        FROM      (CONTROL-FILE)
 10095*    END-EXEC.
 10096     MOVE LENGTH OF
 10097      CONTROL-FILE
 10098       TO DFHEIV11
 10099*    MOVE '&& L                  %   #00009203' TO DFHEIV0
 10100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039323033' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 193
* EL6501.cbl
 10104           CNTL-FILE-ID,
 10105           CONTROL-FILE,
 10106           DFHEIV11,
 10107           DFHEIV99
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111 6699-EXIT.
 10112      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 194
* EL6501.cbl
 10114 6700-BUILD-COMM-WORK.
 10115     IF NOT PI-GA-BILLING
 10116         GO TO 6799-EXIT.
 10117
 10118
 10119* EXEC CICS GETMAIN
 10120*         LENGTH   (260)
 10121*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
 10122*         INITIMG  (GETMAIN-SPACE)
 10123*     END-EXEC.
 10124     MOVE 260
 10125       TO DFHEIV11
 10126*    MOVE ',"IL                  $   #00009215' TO DFHEIV0
 10127     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10128     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10129     MOVE X'2020233030303039323135' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0,
 10131           DFHEIV20,
 10132           DFHEIV11,
 10133           GETMAIN-SPACE
 10134     SET ADDRESS OF COMMISSION-WORK-AREA TO
 10135         DFHEIV20
 10136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10137
 10138     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
 10139
 10140     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
 10141     MOVE SPACES             TO COMMISSION-WORK-AREA.
 10142     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
 10143
 10144     IF PI-MAINT = 'A'
 10145         GO TO 6799-EXIT.
 10146
 10147     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
 10148     MOVE +1                TO AXRF-SUB.
 10149
 10150 6710-AXRF-LOOP.
 10151     MOVE SPACES         TO AGENT-FIND.
 10152     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
 10153
 10154     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
 10155
 10156     IF AGENT-FIND = SPACES
 10157        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
 10158             WK-GA-BILL-DT (AXRF-SUB)
 10159     ELSE
 10160        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
 10161
 10162     ADD +1 TO AXRF-SUB.
 10163
 10164     IF AXRF-SUB NOT = +11
 10165        GO TO 6710-AXRF-LOOP.
 10166
 10167 6799-EXIT.
 10168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 195
* EL6501.cbl
 10170 6800-COMPANY-REC-READ.
 10171     MOVE SPACES                 TO ELCNTL-KEY.
 10172     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10173     MOVE '1'                    TO CNTL-REC-TYPE.
 10174     MOVE +0                     TO CNTL-SEQ-NO.
 10175
 10176* EXEC CICS HANDLE CONDITION
 10177*        NOTFND   (6880-NO-COMP)
 10178*    END-EXEC.
 10179*    MOVE '"$I                   ! 0 #00009257' TO DFHEIV0
 10180     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10182     MOVE X'3020233030303039323537' TO DFHEIV0(25:11)
 10183     CALL 'kxdfhei1' USING DFHEIV0
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187
 10188* EXEC CICS READ
 10189*        DATASET   (CNTL-FILE-ID)
 10190*        SET       (ADDRESS OF CONTROL-FILE)
 10191*        RIDFLD    (ELCNTL-KEY)
 10192*    END-EXEC.
 10193*    MOVE '&"S        E          (   #00009261' TO DFHEIV0
 10194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10196     MOVE X'2020233030303039323631' TO DFHEIV0(25:11)
 10197     CALL 'kxdfhei1' USING DFHEIV0,
 10198           CNTL-FILE-ID,
 10199           DFHEIV20,
 10200           DFHEIV99,
 10201           ELCNTL-KEY,
 10202           DFHEIV99,
 10203           DFHEIV99,
 10204           DFHEIV99
 10205     SET ADDRESS OF CONTROL-FILE TO
 10206         DFHEIV20
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10208
 10209
 10210     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
 10211         MOVE ER-2572               TO EMI-ERROR
 10212         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10213
 10214     GO TO 6899-EXIT.
 10215
 10216 6880-NO-COMP.
 10217     MOVE ER-0002                TO EMI-ERROR.
 10218     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10219
 10220 6899-EXIT.
 10221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 196
* EL6501.cbl
 10223 6900-READ-AND-CHECK-AXRF.
 10224     IF NOT PI-GA-BILLING
 10225        GO TO 6999-EXIT.
 10226
 10227     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10228     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
 10229
 10230 6905-AGENT-LEVEL-LOOP.
 10231     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10232     MOVE SPACES TO AGENT-FIND.
 10233     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
 10234      OR
 10235        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
 10236      AND
 10237        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
 10238                             OR 'B' OR 'I'
 10239                             OR 'K' OR 'L' OR 'J' OR 'M'
 10240                             OR 'S' OR 'A' OR 'N')
 10241                            OR
 10242        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
 10243                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
 10244                                  OR 'S' OR 'A' OR 'N'))
 10245            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
 10246            IF AGENT-RECORD-NOT-FOUND
 10247               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
 10248           ELSE
 10249            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
 10250               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
 10251           ELSE
 10252        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
 10253              AND 'B' AND 'I' AND 'S'
 10254              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
 10255           (AM-AGT (AXRF-SUB) NOT =
 10256                   WK-AM-AGT (AXRF-SUB))
 10257           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
 10258           GO TO 6910-INC-SUB.
 10259
 10260     MOVE SPACES TO AGENT-FIND.
 10261     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
 10262        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
 10263                               SPACES AND ZEROS)
 10264          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
 10265          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
 10266          PERFORM 6921-READ-AXRF THRU 6929-EXIT
 10267          IF AGENT-FIND = SPACES
 10268              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
 10269
 10270 6910-INC-SUB.
 10271     ADD +1                      TO AXRF-SUB.
 10272     IF AXRF-SUB NOT = +11
 10273        GO TO 6905-AGENT-LEVEL-LOOP.
 10274
 10275     GO TO 6999-EXIT.
 10276
 10277 6920-READ-AXRF-FILE.
 10278*    IF GETMAIN-SW = 'X'
 10279*       GO TO 6920-BUILD-KEY.
 10280*
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 197
* EL6501.cbl
 10281*    EXEC CICS GETMAIN
 10282*         LENGTH   (ERGXRF-REC-LEN)
 10283*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10284*         INITIMG  (GETMAIN-SPACE)
 10285*    END-EXEC.
 10286*
 10287*    MOVE 'X' TO GETMAIN-SW.
 10288
 10289 6920-BUILD-KEY.
 10290     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10291
 10292     IF PI-ZERO-CARRIER
 10293       OR PI-ZERO-CAR-GROUP
 10294         MOVE ZERO               TO WS-AXRF-CARRIER
 10295     ELSE
 10296         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10297
 10298     IF PI-ZERO-GROUPING
 10299       OR PI-ZERO-CAR-GROUP
 10300         MOVE ZEROS              TO WS-AXRF-GROUPING
 10301     ELSE
 10302         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10303
 10304     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10305                                              LOW-VALUES
 10306        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10307     ELSE
 10308     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10309                                              LOW-VALUES
 10310        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10311     ELSE
 10312        MOVE 'X' TO AGENT-FIND
 10313        GO TO 6929-EXIT.
 10314
 10315     MOVE +1 TO GX-AGENT-SUB.
 10316
 10317 6921-READ-AXRF.
 10318
 10319* EXEC CICS HANDLE CONDITION
 10320*         ENDFILE     (6925-NOT-FIND)
 10321*         NOTFND      (6925-NOT-FIND)
 10322*    END-EXEC.
 10323*    MOVE '"$''I                  ! 1 #00009375' TO DFHEIV0
 10324     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10326     MOVE X'3120233030303039333735' TO DFHEIV0(25:11)
 10327     CALL 'kxdfhei1' USING DFHEIV0
 10328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10329
 10330
 10331
 10332* EXEC CICS READ
 10333*        DATASET   (ERGXRF-FILE-ID)
 10334*        LENGTH    (ERGXRF-REC-LEN)
 10335*        INTO      (AGENT-CROSS-REFERENCE)
 10336*        RIDFLD    (WS-AXRF-KEY)
 10337*        EQUAL
 10338*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 198
* EL6501.cbl
 10339*    MOVE '&"IL       E          (   #00009380' TO DFHEIV0
 10340     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10341     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10342     MOVE X'2020233030303039333830' TO DFHEIV0(25:11)
 10343     CALL 'kxdfhei1' USING DFHEIV0,
 10344           ERGXRF-FILE-ID,
 10345           AGENT-CROSS-REFERENCE,
 10346           ERGXRF-REC-LEN,
 10347           WS-AXRF-KEY,
 10348           DFHEIV99,
 10349           DFHEIV99,
 10350           DFHEIV99
 10351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10352
 10353
 10354     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10355
 10356     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10357             FROM +1 BY +1 UNTIL
 10358         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10359         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10360         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10361         AND
 10362         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10363         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10364         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10365         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10366
 10367     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10368        MOVE 'Y' TO AGENT-FIND
 10369        GO TO 6929-EXIT.
 10370
 10371     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10372        MOVE 'Z' TO AGENT-FIND.
 10373
 10374     GO TO 6929-EXIT.
 10375
 10376 6921-FIND-ACCT-LOOP.
 10377***  DUMMY PARAGRAPH  ***
 10378
 10379 6925-NOT-FIND.
 10380     MOVE 'X' TO AGENT-FIND.
 10381
 10382 6929-EXIT.
 10383     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 199
* EL6501.cbl
 10385 6950-ADD-AGENT-RECORD.
 10386     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10387        GO TO 6959-EXIT.
 10388
 10389     MOVE +109                   TO ERGXRF-REC-LEN.
 10390
 10391     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10392     MOVE 'GX'                   TO GX-RECORD-ID.
 10393     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10394
 10395     IF PI-ZERO-CARRIER
 10396       OR PI-ZERO-CAR-GROUP
 10397         MOVE ZERO               TO GX-CARRIER
 10398     ELSE
 10399         MOVE AM-CARRIER         TO GX-CARRIER.
 10400
 10401     IF PI-ZERO-GROUPING
 10402       OR PI-ZERO-CAR-GROUP
 10403         MOVE ZERO               TO GX-GROUPING
 10404     ELSE
 10405         MOVE AM-GROUPING        TO GX-GROUPING.
 10406
 10407     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10408
 10409     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10410     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10411     MOVE AM-STATE               TO GX-AM-STATE (1).
 10412     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10413     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10414     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10415     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10416     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10417
 10418     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10419     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10420     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10421
 10422
 10423* EXEC CICS WRITE
 10424*        FROM      (AGENT-CROSS-REFERENCE)
 10425*        LENGTH    (ERGXRF-REC-LEN)
 10426*        RIDFLD    (GX-CONTROL-PRIMARY)
 10427*        DATASET   (ERGXRF-FILE-ID)
 10428*    END-EXEC.
 10429*    MOVE '&$ L                  ''   #00009456' TO DFHEIV0
 10430     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10432     MOVE X'2020233030303039343536' TO DFHEIV0(25:11)
 10433     CALL 'kxdfhei1' USING DFHEIV0,
 10434           ERGXRF-FILE-ID,
 10435           AGENT-CROSS-REFERENCE,
 10436           ERGXRF-REC-LEN,
 10437           GX-CONTROL-PRIMARY,
 10438           DFHEIV99,
 10439           DFHEIV99
 10440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10441
 10442
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 200
* EL6501.cbl
 10443 6959-EXIT.
 10444      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 201
* EL6501.cbl
 10446 6970-REWRITE-AGENT-RECORD.
 10447     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10448
 10449
 10450* EXEC CICS READ
 10451*        DATASET   (ERGXRF-FILE-ID)
 10452*        INTO      (AGENT-CROSS-REFERENCE)
 10453*        LENGTH    (ERGXRF-REC-LEN)
 10454*        RIDFLD    (WS-AXRF-KEY)
 10455*        EQUAL
 10456*        UPDATE
 10457*    END-EXEC.
 10458*    MOVE '&"IL       EU         (   #00009469' TO DFHEIV0
 10459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10461     MOVE X'2020233030303039343639' TO DFHEIV0(25:11)
 10462     CALL 'kxdfhei1' USING DFHEIV0,
 10463           ERGXRF-FILE-ID,
 10464           AGENT-CROSS-REFERENCE,
 10465           ERGXRF-REC-LEN,
 10466           WS-AXRF-KEY,
 10467           DFHEIV99,
 10468           DFHEIV99,
 10469           DFHEIV99
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10474
 10475     IF ACCT-LEVEL-DIFFERENT
 10476        GO TO 6975-UPDATE-LEVEL-NO.
 10477
 10478     IF GX-AGENT-POINTER-CNT = +1006
 10479         GO TO 6979-EXIT.
 10480
 10481     MOVE +1 TO FIND-AGENT-SUB1.
 10482
 10483 6972-FIND-REC-LOCATION.
 10484     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10485     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10486
 10487     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10488        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10489        NEXT SENTENCE
 10490     ELSE
 10491        ADD +1 TO FIND-AGENT-SUB1
 10492        GO TO 6972-FIND-REC-LOCATION.
 10493
 10494     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10495                                  FIND-AGENT-SUB3.
 10496     ADD +1 TO FIND-AGENT-SUB3.
 10497
 10498     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10499        NEXT SENTENCE
 10500     ELSE
 10501        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10502        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10503        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 202
* EL6501.cbl
 10504
 10505     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10506     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10507
 10508     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10509     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10510
 10511     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10512     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10513     MOVE AM-EXPIRATION-DT TO
 10514                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10515     MOVE AM-EFFECTIVE-DT  TO
 10516                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10517     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10518     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10519
 10520 6975-UPDATE-LEVEL-NO.
 10521     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10522     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10523     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10524     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10525     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10526     if ergxrf-rec-len > +31264
 10527        move +31264               to ergxrf-rec-len
 10528        move +1006                to gx-agent-pointer-cnt
 10529     end-if
 10530
 10531
 10532* EXEC CICS REWRITE
 10533*        FROM      (AGENT-CROSS-REFERENCE)
 10534*        LENGTH    (ERGXRF-REC-LEN)
 10535*        DATASET   (ERGXRF-FILE-ID)
 10536*    END-EXEC.
 10537*    MOVE '&& L                  %   #00009536' TO DFHEIV0
 10538     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10539     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10540     MOVE X'2020233030303039353336' TO DFHEIV0(25:11)
 10541     CALL 'kxdfhei1' USING DFHEIV0,
 10542           ERGXRF-FILE-ID,
 10543           AGENT-CROSS-REFERENCE,
 10544           ERGXRF-REC-LEN,
 10545           DFHEIV99
 10546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10547
 10548
 10549     GO TO 6979-EXIT.
 10550
 10551 6977-BUMP-AXRF-REC.
 10552     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10553          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10554
 10555     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10556
 10557 6979-EXIT.
 10558     EXIT.
 10559
 10560 6999-EXIT.
 10561     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 203
* EL6501.cbl
 10563 7000-DELETE-AXRF-REC.
 10564     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10565
 10566
 10567* EXEC CICS HANDLE CONDITION
 10568*         ENDFILE     (7999-EXIT)
 10569*         NOTFND      (7999-EXIT)
 10570*    END-EXEC.
 10571*    MOVE '"$''I                  ! 2 #00009559' TO DFHEIV0
 10572     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10574     MOVE X'3220233030303039353539' TO DFHEIV0(25:11)
 10575     CALL 'kxdfhei1' USING DFHEIV0
 10576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10577
 10578
 10579
 10580* EXEC CICS READ
 10581*        DATASET   (ERGXRF-FILE-ID)
 10582*        INTO      (AGENT-CROSS-REFERENCE)
 10583*        LENGTH    (ERGXRF-REC-LEN)
 10584*        RIDFLD    (WS-AXRF-KEY)
 10585*        EQUAL
 10586*        UPDATE
 10587*    END-EXEC.
 10588*    MOVE '&"IL       EU         (   #00009564' TO DFHEIV0
 10589     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10591     MOVE X'2020233030303039353634' TO DFHEIV0(25:11)
 10592     CALL 'kxdfhei1' USING DFHEIV0,
 10593           ERGXRF-FILE-ID,
 10594           AGENT-CROSS-REFERENCE,
 10595           ERGXRF-REC-LEN,
 10596           WS-AXRF-KEY,
 10597           DFHEIV99,
 10598           DFHEIV99,
 10599           DFHEIV99
 10600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10601
 10602
 10603     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10604
 10605     IF GX-AGENT-SUB = +0
 10606        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10607        FROM +1 BY +1 UNTIL
 10608         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10609         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10610         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10611         AND
 10612         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10613         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10614         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10615         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10616
 10617     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10618        GO TO 7999-EXIT.
 10619
 10620     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 204
* EL6501.cbl
 10621     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10622                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10623                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10624     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10625     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10626     GO TO 7020-REWRITE-AXRF-RECORD.
 10627
 10628 7010-BUMP-RECORDS.
 10629     ADD +1 TO FIND-AGENT-SUB1.
 10630     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10631          GX-AGENT-POINTER (GX-AGENT-SUB).
 10632
 10633 7020-REWRITE-AXRF-RECORD.
 10634     IF GX-AGENT-POINTER-CNT = +0
 10635
 10636* EXEC CICS DELETE
 10637*            DATASET   (ERGXRF-FILE-ID)
 10638*       END-EXEC
 10639*    MOVE '&(                    &   #00009605' TO DFHEIV0
 10640     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10641     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10642     MOVE X'2020233030303039363035' TO DFHEIV0(25:11)
 10643     CALL 'kxdfhei1' USING DFHEIV0,
 10644           ERGXRF-FILE-ID,
 10645           DFHEIV99,
 10646           DFHEIV99,
 10647           DFHEIV99,
 10648           DFHEIV99
 10649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10650     ELSE
 10651        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10652        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10653        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10654        compute ergxrf-rec-len =
 10655            (gx-agent-pointer-cnt * +31) + +78
 10656        if ergxrf-rec-len > +31264
 10657           move +31264               to ergxrf-rec-len
 10658           move +1006                to gx-agent-pointer-cnt
 10659        end-if
 10660
 10661* EXEC CICS REWRITE
 10662*            FROM      (AGENT-CROSS-REFERENCE)
 10663*            LENGTH    (ERGXRF-REC-LEN)
 10664*            DATASET   (ERGXRF-FILE-ID)
 10665*       END-EXEC.
 10666*    MOVE '&& L                  %   #00009618' TO DFHEIV0
 10667     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303039363138' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           ERGXRF-FILE-ID,
 10672           AGENT-CROSS-REFERENCE,
 10673           ERGXRF-REC-LEN,
 10674           DFHEIV99
 10675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10676
 10677
 10678 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 205
* EL6501.cbl
 10679     EXIT.
 10680
 10681*************************************
 10682 8000-STATE-REC-READ.
 10683     MOVE SPACES                 TO ELCNTL-KEY.
 10684     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10685     MOVE '3'                    TO CNTL-REC-TYPE.
 10686     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10687     MOVE +0                     TO CNTL-SEQ-NO.
 10688
 10689* EXEC CICS HANDLE CONDITION
 10690*        NOTFND  (8010-EXIT)
 10691*    END-EXEC.
 10692*    MOVE '"$I                   ! 3 #00009634' TO DFHEIV0
 10693     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10695     MOVE X'3320233030303039363334' TO DFHEIV0(25:11)
 10696     CALL 'kxdfhei1' USING DFHEIV0
 10697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10698
 10699
 10700
 10701* EXEC CICS READ
 10702*        DATASET   (CNTL-FILE-ID)
 10703*        SET       (ADDRESS OF CONTROL-FILE)
 10704*        RIDFLD    (ELCNTL-KEY)
 10705*    END-EXEC.
 10706*    MOVE '&"S        E          (   #00009638' TO DFHEIV0
 10707     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10709     MOVE X'2020233030303039363338' TO DFHEIV0(25:11)
 10710     CALL 'kxdfhei1' USING DFHEIV0,
 10711           CNTL-FILE-ID,
 10712           DFHEIV20,
 10713           DFHEIV99,
 10714           ELCNTL-KEY,
 10715           DFHEIV99,
 10716           DFHEIV99,
 10717           DFHEIV99
 10718     SET ADDRESS OF CONTROL-FILE TO
 10719         DFHEIV20
 10720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10721
 10722
 10723     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS
 10724     MOVE CF-ST-GA-COMMISSION-CAPS
 10725                                  TO WS-ST-GA-COMMISSION-CAPS
 10726     MOVE CF-ST-TOT-COMMISSION-CAPS
 10727                                  TO WS-ST-TOT-COMMISSION-CAPS
 10728     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10729
 10730 8010-EXIT.
 10731      EXIT.
 10732
 10733 8050-USER-REC-READ.
 10734     MOVE SPACES                 TO ELCNTL-KEY.
 10735     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10736     MOVE '2'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 206
* EL6501.cbl
 10737     MOVE CSRI                   TO CNTL-ACCESS.
 10738     MOVE +0                     TO CNTL-SEQ-NO.
 10739
 10740* EXEC CICS HANDLE CONDITION
 10741*        NOTFND  (8055-NOTFND)
 10742*    END-EXEC.
 10743*    MOVE '"$I                   ! 4 #00009660' TO DFHEIV0
 10744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10746     MOVE X'3420233030303039363630' TO DFHEIV0(25:11)
 10747     CALL 'kxdfhei1' USING DFHEIV0
 10748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10749
 10750
 10751
 10752* EXEC CICS READ
 10753*        DATASET   (CNTL-FILE-ID)
 10754*        SET       (ADDRESS OF CONTROL-FILE)
 10755*        RIDFLD    (ELCNTL-KEY)
 10756*    END-EXEC.
 10757*    MOVE '&"S        E          (   #00009664' TO DFHEIV0
 10758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10760     MOVE X'2020233030303039363634' TO DFHEIV0(25:11)
 10761     CALL 'kxdfhei1' USING DFHEIV0,
 10762           CNTL-FILE-ID,
 10763           DFHEIV20,
 10764           DFHEIV99,
 10765           ELCNTL-KEY,
 10766           DFHEIV99,
 10767           DFHEIV99,
 10768           DFHEIV99
 10769     SET ADDRESS OF CONTROL-FILE TO
 10770         DFHEIV20
 10771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10772
 10773
 10774     GO TO 8060-EXIT.
 10775
 10776 8055-NOTFND.
 10777     MOVE ER-1883             TO EMI-ERROR.
 10778     MOVE -1                  TO CSRL.
 10779     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10780
 10781 8060-EXIT.
 10782      EXIT.
 10783
 10784*************************************
 10785
 10786 8100-SEND-INITIAL-MAP.
 10787     MOVE SAVE-DATE              TO DATEO.
 10788     MOVE EIBTIME                TO TIME-IN.
 10789     MOVE TIME-OUT               TO TIMEO.
 10790     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10791     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10792     MOVE -1                     TO PFENTERL.
 10793     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10794
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 207
* EL6501.cbl
 10795     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10796
 10797*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10798*       NEXT SENTENCE
 10799*    ELSE
 10800*       MOVE AL-SADOF            TO PSIHEADA
 10801*                                   PSILFTA
 10802*                                   PSILFCA
 10803*                                   PSIAHTA
 10804*                                   PSIAHCA
 10805*                                   PSILFFA
 10806*                                   PSIAHFA.
 10807
 10808*    IF PI-COMPANY-ID = 'DMD'
 10809*         MOVE AL-SANOF          TO KEY10A.
 10810
 10811     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10812        CONTINUE
 10813     ELSE
 10814        MOVE AL-SADOF            TO CTPLABLA
 10815                                    CLPTOLPA
 10816                                    LCLABLA
 10817                                    LCOMMA
 10818                                    MAXFEEHA
 10819                                    CLPSTHA
 10820                                    PRODCDHA
 10821     END-IF
 10822     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10823        MOVE -1                  TO CSRL.
 10824
 10825     IF  CLAIM-SESSION
 10826         MOVE SPACES             TO PF1PF2O
 10827         MOVE AL-SANOF           TO PF1PF2A.
 10828
 10829
 10830* EXEC CICS SEND
 10831*        MAP      (MAP-NAME)
 10832*        MAPSET   (MAPSET-NAME)
 10833*        FROM     (EL6501AO)
 10834*        ERASE
 10835*        CURSOR
 10836*    END-EXEC.
 10837     MOVE LENGTH OF
 10838      EL6501AO
 10839       TO DFHEIV12
 10840     MOVE -1
 10841       TO DFHEIV11
 10842*    MOVE '8$     CT  E    H L F ,   #00009725' TO DFHEIV0
 10843     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10844     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10845     MOVE X'2020233030303039373235' TO DFHEIV0(25:11)
 10846     CALL 'kxdfhei1' USING DFHEIV0,
 10847           MAP-NAME,
 10848           EL6501AO,
 10849           DFHEIV12,
 10850           MAPSET-NAME,
 10851           DFHEIV99,
 10852           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 208
* EL6501.cbl
 10853           DFHEIV99,
 10854           DFHEIV11,
 10855           DFHEIV99,
 10856           DFHEIV99,
 10857           DFHEIV99
 10858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10859
 10860
 10861     GO TO 9100-RETURN-TRAN.
 10862
 10863 8200-SEND-DATAONLY.
 10864     MOVE SAVE-DATE              TO DATEO.
 10865     MOVE EIBTIME                TO TIME-IN.
 10866     MOVE TIME-OUT               TO TIMEO.
 10867     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10868     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10869     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10870
 10871     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10872
 10873     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10874        CONTINUE
 10875     ELSE
 10876        MOVE AL-SADOF            TO CTPLABLA
 10877                                    CLPTOLPA
 10878                                    LCLABLA
 10879                                    LCOMMA
 10880                                    MAXFEEHA
 10881                                    CLPSTHA
 10882                                    PRODCDHA
 10883     END-IF
 10884     IF  CLAIM-SESSION
 10885         MOVE SPACES             TO PF1PF2O
 10886         MOVE AL-SANOF           TO PF1PF2A.
 10887
 10888
 10889* EXEC CICS SEND
 10890*        MAP      (MAP-NAME)
 10891*        MAPSET   (MAPSET-NAME)
 10892*        FROM     (EL6501AO)
 10893*        DATAONLY
 10894*        CURSOR
 10895*    END-EXEC.
 10896     MOVE LENGTH OF
 10897      EL6501AO
 10898       TO DFHEIV12
 10899     MOVE -1
 10900       TO DFHEIV11
 10901*    MOVE '8$D    CT       H L F ,   #00009760' TO DFHEIV0
 10902     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10903     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10904     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0,
 10906           MAP-NAME,
 10907           EL6501AO,
 10908           DFHEIV12,
 10909           MAPSET-NAME,
 10910           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 209
* EL6501.cbl
 10911           DFHEIV99,
 10912           DFHEIV99,
 10913           DFHEIV11,
 10914           DFHEIV99,
 10915           DFHEIV99,
 10916           DFHEIV99
 10917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10918
 10919
 10920     GO TO 9100-RETURN-TRAN.
 10921
 10922 8300-SEND-TEXT.
 10923
 10924* EXEC CICS SEND TEXT
 10925*        FROM     (LOGOFF-TEXT)
 10926*        LENGTH   (LOGOFF-LENGTH)
 10927*        ERASE
 10928*        FREEKB
 10929*    END-EXEC.
 10930*    MOVE '8&      T  E F  H   F -   #00009771' TO DFHEIV0
 10931     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10932     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10933     MOVE X'2020233030303039373731' TO DFHEIV0(25:11)
 10934     CALL 'kxdfhei1' USING DFHEIV0,
 10935           LOGOFF-TEXT,
 10936           LOGOFF-LENGTH,
 10937           DFHEIV99,
 10938           DFHEIV99,
 10939           DFHEIV99,
 10940           DFHEIV99,
 10941           DFHEIV99,
 10942           DFHEIV99,
 10943           DFHEIV99,
 10944           DFHEIV99,
 10945           DFHEIV99,
 10946           DFHEIV99
 10947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10948
 10949
 10950
 10951* EXEC CICS RETURN
 10952*    END-EXEC.
 10953*    MOVE '.(                    ''   #00009778' TO DFHEIV0
 10954     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10956     MOVE X'2020233030303039373738' TO DFHEIV0(25:11)
 10957     CALL 'kxdfhei1' USING DFHEIV0,
 10958           DFHEIV99,
 10959           DFHEIV99,
 10960           DFHEIV99,
 10961           DFHEIV99,
 10962           DFHEIV99,
 10963           DFHEIV99
 10964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10965
 10966
 10967 8600-DEEDIT.
 10968
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 210
* EL6501.cbl
 10969* EXEC CICS BIF DEEDIT
 10970*         FIELD(DEEDIT-FIELD)
 10971*         LENGTH(15)
 10972*     END-EXEC.
 10973     MOVE 15
 10974       TO DFHEIV11
 10975*    MOVE '@"L                   #   #00009782' TO DFHEIV0
 10976     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10977     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10978     MOVE X'2020233030303039373832' TO DFHEIV0(25:11)
 10979     CALL 'kxdfhei1' USING DFHEIV0,
 10980           DEEDIT-FIELD,
 10981           DFHEIV11
 10982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10983
 10984
 10985 8800-UNAUTHORIZED-ACCESS.
 10986     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10987     GO TO 8300-SEND-TEXT.
 10988
 10989 8810-PF23.
 10990     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10991     MOVE XCTL-005               TO PGM-NAME.
 10992     GO TO 9300-XCTL.
 10993
 10994 9100-RETURN-TRAN.
 10995     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10996     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10997
 10998* EXEC CICS RETURN
 10999*        TRANSID    (TRANS-ID)
 11000*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11001*        LENGTH     (WS-COMM-LENGTH)
 11002*    END-EXEC.
 11003*    MOVE '.(CT                  ''   #00009799' TO DFHEIV0
 11004     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 11005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11006     MOVE X'2020233030303039373939' TO DFHEIV0(25:11)
 11007     CALL 'kxdfhei1' USING DFHEIV0,
 11008           TRANS-ID,
 11009           PROGRAM-INTERFACE-BLOCK,
 11010           WS-COMM-LENGTH,
 11011           DFHEIV99,
 11012           DFHEIV99,
 11013           DFHEIV99
 11014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11015
 11016
 11017 9200-RETURN-MAIN-MENU.
 11018     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11019         MOVE XCTL-126           TO  PGM-NAME
 11020     ELSE
 11021         MOVE XCTL-626           TO  PGM-NAME.
 11022
 11023     GO TO 9300-XCTL.
 11024
 11025 9300-XCTL.
 11026
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 211
* EL6501.cbl
 11027* EXEC CICS XCTL
 11028*        PROGRAM    (PGM-NAME)
 11029*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11030*        LENGTH     (WS-COMM-LENGTH)
 11031*    END-EXEC.
 11032*    MOVE '.$C                   %   #00009814' TO DFHEIV0
 11033     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 11034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11035     MOVE X'2020233030303039383134' TO DFHEIV0(25:11)
 11036     CALL 'kxdfhei1' USING DFHEIV0,
 11037           PGM-NAME,
 11038           PROGRAM-INTERFACE-BLOCK,
 11039           WS-COMM-LENGTH,
 11040           DFHEIV99
 11041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11042
 11043
 11044 9400-CLEAR.
 11045     IF PI-GA-BILLING
 11046        IF GETMAIN-ACQUIRED
 11047           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 11048           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 11049
 11050* EXEC CICS FREEMAIN
 11051*               DATA     (COMMISSION-WORK-AREA)
 11052*          END-EXEC.
 11053*    MOVE ',$D                   "   #00009825' TO DFHEIV0
 11054     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 11055     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 11056     MOVE X'2020233030303039383235' TO DFHEIV0(25:11)
 11057     CALL 'kxdfhei1' USING DFHEIV0,
 11058           COMMISSION-WORK-AREA
 11059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11060
 11061
 11062     MOVE SPACES                 TO PI-SV-MAINT.
 11063     MOVE XCTL-650               TO PGM-NAME.
 11064     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 11065     GO TO 9300-XCTL.
 11066
 11067 9500-PF12.
 11068     MOVE XCTL-010               TO PGM-NAME.
 11069     GO TO 9300-XCTL.
 11070
 11071 9600-PGMID-ERROR.
 11072
 11073* EXEC CICS HANDLE CONDITION
 11074*        PGMIDERR    (8300-SEND-TEXT)
 11075*    END-EXEC.
 11076*    MOVE '"$L                   ! 5 #00009839' TO DFHEIV0
 11077     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 11078     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11079     MOVE X'3520233030303039383339' TO DFHEIV0(25:11)
 11080     CALL 'kxdfhei1' USING DFHEIV0
 11081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11082
 11083
 11084     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 212
* EL6501.cbl
 11085     MOVE ' '                    TO PI-ENTRY-CD-1.
 11086     MOVE XCTL-005               TO PGM-NAME.
 11087     MOVE PGM-NAME               TO LOGOFF-PGM.
 11088     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 11089     GO TO 9300-XCTL.
 11090
 11091 9700-DATE-LINK.
 11092     MOVE LINK-ELDATCV           TO PGM-NAME.
 11093
 11094* EXEC CICS LINK
 11095*        PROGRAM    (PGM-NAME)
 11096*        COMMAREA   (DATE-CONVERSION-DATA)
 11097*        LENGTH     (DC-COMM-LENGTH)
 11098*    END-EXEC.
 11099*    MOVE '."C                   (   #00009852' TO DFHEIV0
 11100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11102     MOVE X'2020233030303039383532' TO DFHEIV0(25:11)
 11103     CALL 'kxdfhei1' USING DFHEIV0,
 11104           PGM-NAME,
 11105           DATE-CONVERSION-DATA,
 11106           DC-COMM-LENGTH,
 11107           DFHEIV99,
 11108           DFHEIV99,
 11109           DFHEIV99,
 11110           DFHEIV99
 11111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11112
 11113
 11114 9900-ERROR-FORMAT.
 11115     IF NOT EMI-ERRORS-COMPLETE
 11116         MOVE LINK-001           TO PGM-NAME
 11117
 11118* EXEC CICS LINK
 11119*            PROGRAM    (PGM-NAME)
 11120*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 11121*            LENGTH     (EMI-COMM-LENGTH)
 11122*        END-EXEC.
 11123*    MOVE '."C                   (   #00009861' TO DFHEIV0
 11124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11126     MOVE X'2020233030303039383631' TO DFHEIV0(25:11)
 11127     CALL 'kxdfhei1' USING DFHEIV0,
 11128           PGM-NAME,
 11129           ERROR-MESSAGE-INTERFACE-BLOCK,
 11130           EMI-COMM-LENGTH,
 11131           DFHEIV99,
 11132           DFHEIV99,
 11133           DFHEIV99,
 11134           DFHEIV99
 11135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11136
 11137
 11138 9900-EXIT.
 11139     EXIT.
 11140
 11141 9990-ABEND.
 11142     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 213
* EL6501.cbl
 11143     MOVE DFHEIBLK               TO EMI-LINE1.
 11144
 11145* EXEC CICS LINK
 11146*        PROGRAM   (PGM-NAME)
 11147*        COMMAREA  (EMI-LINE1)
 11148*        LENGTH    (72)
 11149*    END-EXEC.
 11150     MOVE 72
 11151       TO DFHEIV11
 11152*    MOVE '."C                   (   #00009873' TO DFHEIV0
 11153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11155     MOVE X'2020233030303039383733' TO DFHEIV0(25:11)
 11156     CALL 'kxdfhei1' USING DFHEIV0,
 11157           PGM-NAME,
 11158           EMI-LINE1,
 11159           DFHEIV11,
 11160           DFHEIV99,
 11161           DFHEIV99,
 11162           DFHEIV99,
 11163           DFHEIV99
 11164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11165
 11166
 11167     MOVE -1                     TO PFENTERL.
 11168     GO TO 8200-SEND-DATAONLY.
 11169
 11170
 11171* GOBACK.
 11172     MOVE '9%                    "   ' TO DFHEIV0
 11173     MOVE 'EL6501' TO DFHEIV1
 11174     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11175     GOBACK.
 11176
 11177 9995-SECURITY-VIOLATION.
 11178*                            COPY ELCSCTP.
 11179******************************************************************
 11180*                                                                *
 11181*                            ELCSCTP                             *
 11182*                            VMOD=2.001                          *
 11183*                                                                *
 11184*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 11185******************************************************************
 11186
 11187
 11188     MOVE EIBDATE          TO SM-JUL-DATE.
 11189     MOVE EIBTRMID         TO SM-TERMID.
 11190     MOVE THIS-PGM         TO SM-PGM.
 11191     MOVE EIBTIME          TO TIME-IN.
 11192     MOVE TIME-OUT         TO SM-TIME.
 11193     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 11194
 11195
 11196* EXEC CICS LINK
 11197*         PROGRAM  ('EL003')
 11198*         COMMAREA (SECURITY-MESSAGE)
 11199*         LENGTH   (80)
 11200*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 214
* EL6501.cbl
 11201     MOVE 'EL003' TO DFHEIV1
 11202     MOVE 80
 11203       TO DFHEIV11
 11204*    MOVE '."C                   (   #00009902' TO DFHEIV0
 11205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11207     MOVE X'2020233030303039393032' TO DFHEIV0(25:11)
 11208     CALL 'kxdfhei1' USING DFHEIV0,
 11209           DFHEIV1,
 11210           SECURITY-MESSAGE,
 11211           DFHEIV11,
 11212           DFHEIV99,
 11213           DFHEIV99,
 11214           DFHEIV99,
 11215           DFHEIV99
 11216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11217
 11218
 11219******************************************************************
 11220
 11221
 11222 9995-EXIT.
 11223     EXIT.
 11224
 11225 9999-DFHBACK SECTION.
 11226     MOVE '9%                    "   ' TO DFHEIV0
 11227     MOVE 'EL6501' TO DFHEIV1
 11228     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11229     GOBACK.
 11230 9999-DFHEXIT.
 11231     IF DFHEIGDJ EQUAL 0001
 11232         NEXT SENTENCE
 11233     ELSE IF DFHEIGDJ EQUAL 2
 11234         GO TO 9600-PGMID-ERROR,
 11235               9990-ABEND,
 11236               0500-CHECK-MAINT-TYPE
 11237         DEPENDING ON DFHEIGDI
 11238     ELSE IF DFHEIGDJ EQUAL 3
 11239         GO TO 1500-EXIT
 11240         DEPENDING ON DFHEIGDI
 11241     ELSE IF DFHEIGDJ EQUAL 4
 11242         GO TO 1799-EXIT,
 11243               1799-EXIT
 11244         DEPENDING ON DFHEIGDI
 11245     ELSE IF DFHEIGDJ EQUAL 5
 11246         GO TO 2100-EXIT
 11247         DEPENDING ON DFHEIGDI
 11248     ELSE IF DFHEIGDJ EQUAL 6
 11249         GO TO 2200-EXIT
 11250         DEPENDING ON DFHEIGDI
 11251     ELSE IF DFHEIGDJ EQUAL 7
 11252         GO TO 3030-END-FILE
 11253         DEPENDING ON DFHEIGDI
 11254     ELSE IF DFHEIGDJ EQUAL 8
 11255         GO TO 3530-END-FILE
 11256         DEPENDING ON DFHEIGDI
 11257     ELSE IF DFHEIGDJ EQUAL 9
 11258         GO TO 4020-BUS-TYPE-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:30 Page 215
* EL6501.cbl
 11259         DEPENDING ON DFHEIGDI
 11260     ELSE IF DFHEIGDJ EQUAL 10
 11261         GO TO 4099-STD-BEN-ERROR
 11262         DEPENDING ON DFHEIGDI
 11263     ELSE IF DFHEIGDJ EQUAL 11
 11264         GO TO 4180-REIN-ERROR
 11265         DEPENDING ON DFHEIGDI
 11266     ELSE IF DFHEIGDJ EQUAL 12
 11267         GO TO 5250-QID-ERROR
 11268         DEPENDING ON DFHEIGDI
 11269     ELSE IF DFHEIGDJ EQUAL 13
 11270         GO TO 5399-EXIT,
 11271               5399-EXIT
 11272         DEPENDING ON DFHEIGDI
 11273     ELSE IF DFHEIGDJ EQUAL 14
 11274         GO TO 6450-NOT-FOUND
 11275         DEPENDING ON DFHEIGDI
 11276     ELSE IF DFHEIGDJ EQUAL 15
 11277         GO TO 6699-EXIT
 11278         DEPENDING ON DFHEIGDI
 11279     ELSE IF DFHEIGDJ EQUAL 16
 11280         GO TO 6880-NO-COMP
 11281         DEPENDING ON DFHEIGDI
 11282     ELSE IF DFHEIGDJ EQUAL 17
 11283         GO TO 6925-NOT-FIND,
 11284               6925-NOT-FIND
 11285         DEPENDING ON DFHEIGDI
 11286     ELSE IF DFHEIGDJ EQUAL 18
 11287         GO TO 7999-EXIT,
 11288               7999-EXIT
 11289         DEPENDING ON DFHEIGDI
 11290     ELSE IF DFHEIGDJ EQUAL 19
 11291         GO TO 8010-EXIT
 11292         DEPENDING ON DFHEIGDI
 11293     ELSE IF DFHEIGDJ EQUAL 20
 11294         GO TO 8055-NOTFND
 11295         DEPENDING ON DFHEIGDI
 11296     ELSE IF DFHEIGDJ EQUAL 21
 11297         GO TO 8300-SEND-TEXT
 11298         DEPENDING ON DFHEIGDI.
 11299     MOVE '9%                    "   ' TO DFHEIV0
 11300     MOVE 'EL6501' TO DFHEIV1
 11301     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11302     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39964     Code:       37253
