* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44******************************************************************
    45
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   3
* EL130.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    54 77  A1                          PIC S999 COMP-3 VALUE +0.
    55 77  E1                          PIC S999 COMP-3 VALUE +0.
    56 77  s1                          pic s999 comp-3 value +0.
    57 77  s2                          pic s999 comp-3 value +0.
    58 77  P1                          PIC S999 COMP-3 VALUE +0.
    59 77  P2                          PIC S999 COMP-3 VALUE +0.
    60 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    61 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    62 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    63 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    64 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    65 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    66 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    67 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    68     88  ERPDEF-FOUND                 VALUE 'Y'.
    69 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    70 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    71 77  ws-dcc-product-code         pic xxx value spaces.
    72 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    73 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    74 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    75 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    76 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    77 77  ws-zero-bens-avail          pic x value ' '.
    78*    COPY ELCSCTM.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCTM                             *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-MESSAGE.
    89     12  FILLER                          PIC X(30)
    90            VALUE '** LOGIC SECURITY VIOLATION -'.
    91     12  SM-READ                         PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' PGM='.
    94     12  SM-PGM                          PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' OPR='.
    97     12  SM-PROCESSOR-ID                 PIC X(4).
    98     12  FILLER                          PIC X(6)
    99            VALUE ' TERM='.
   100     12  SM-TERMID                       PIC X(4).
   101     12  FILLER                          PIC XX   VALUE SPACE.
   102     12  SM-JUL-DATE                     PIC 9(5).
   103     12  FILLER                          PIC X    VALUE SPACE.
   104     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   4
* EL130.cbl
   105
   106
   107*    COPY ELCSCRTY.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCRTY                            *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   115*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   116*        SAVED IN PI-SECURITY-ADDRESS.                           *
   117*                                                                *
   118******************************************************************
   119 01  SECURITY-CONTROL.
   120     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   121     12  FILLER                       PIC XX    VALUE 'SC'.
   122     12  SC-CREDIT-CODES.
   123         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   124             20  SC-CREDIT-DISPLAY    PIC X.
   125             20  SC-CREDIT-UPDATE     PIC X.
   126     12  SC-CLAIMS-CODES.
   127         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   128             20  SC-CLAIMS-DISPLAY    PIC X.
   129             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   5
* EL130.cbl
   131 01  WS-DATE-AREA.
   132     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   133     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   134     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   135
   136 01  ws-dcc-error-line.
   137     05  filler occurs 15.
   138         10  ws-error-no        pic x(4).
   139 01  WS-CRI-SSN-WORK-AREA.
   140     05  WS-CRI-SOC-SEC-NO.
   141         10  WS-SS-REPT-CD       PIC X(5).
   142         10  WS-SS-LAST-NAME     PIC X(5).
   143         10  WS-SS-INITIAL       PIC X.
   144
   145     05  WS-CRI-REPORT-CODE.
   146         10  FILLER              PIC X(5).
   147         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   148
   149     05  WS-CRI-LAST-NAME.
   150         10  WS-CRI-NAME-MOVE    PIC X(5).
   151         10  FILLER              PIC X(10).
   152
   153 01  STANDARD-AREAS.
   154     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   155     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   156     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   157     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   158     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   159     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   160     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   161     12  PGM-NAME            PIC X(8).
   162     12  TIME-IN             PIC S9(7).
   163     12  TIME-OUT-R  REDEFINES TIME-IN.
   164         16  FILLER          PIC X.
   165         16  TIME-OUT        PIC 99V99.
   166         16  FILLER          PIC X(2).
   167     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   168     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   169     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   170     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   171     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   172     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   173     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   174     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   175     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   176     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   177     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   178     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   179     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   180     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   181     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   182     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   183     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   184     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   185     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   186     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   187     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   188     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   6
* EL130.cbl
   189     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   190     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   191     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   192     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   193     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   194     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   195     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   196     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   197     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   198     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   199     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   200     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   201     12  FILE-ID             PIC X(8).
   202     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   203     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   204     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   205     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   206     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   207     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   208     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   209     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   210     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   211
   212 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   213     12  M                   PIC S9(7)V99           VALUE ZEROS.
   214     12  L                   PIC S9(7)V99           VALUE ZEROS.
   215     12  N                   PIC S9(3)              VALUE ZEROS.
   216     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   217     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   218     12  I                   PIC S99V9(5)           VALUE ZEROS.
   219     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   220     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   221     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   222     12  R                   PIC S9(3)              VALUE ZEROS.
   223     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   224     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   225     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   226     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   227     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   228     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   229     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   230     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   231     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   232
   233 01  TERM-CALC-WORK-AREA.
   234     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   235     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   236     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   237     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   238     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   239     12  V-EXPONENTS.
   240        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   241     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   242
   243 01  MISC-WORK-AREAS.
   244     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   245     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   246     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   7
* EL130.cbl
   247     12  QID.
   248         16  QID-TERM        PIC X(4).
   249         16  FILLER          PIC X(4)    VALUE '130A'.
   250     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   251     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   252     12  WS-GROUP-NO.
   253         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   254         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   255
   256     12  WS-RESPONSE         PIC S9(8)   COMP.
   257         88  WS-RESP-NORMAL              VALUE +00.
   258         88  WS-RESP-ERROR               VALUE +01.
   259         88  WS-RESP-NOTFND              VALUE +13.
   260         88  WS-RESP-DUPKEY              VALUE +15.
   261         88  WS-RESP-NOTOPEN             VALUE +19.
   262         88  WS-RESP-ENDFILE             VALUE +20.
   263
   264***************************************************************
   265*                                                             *
   266*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   267*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   268*    CHANGES WITH IN MAP EL130A.                              *
   269*                                                             *
   270***************************************************************
   271
   272     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   273     12  WS-SAVE-CLAIM-MASTER.
   274         16  FILLER                    PIC XX.
   275         16  WS-SAVE-CLAIM-KEY.
   276             20  WS-SAVE-COMPANY-CD    PIC X.
   277             20  WS-SAVE-CARRIER       PIC X.
   278             20  WS-SAVE-CLAIM-NO      PIC X(7).
   279             20  WS-SAVE-CERT-NO       PIC X(11).
   280         16  FILLER                    PIC X(328).
   281     12  SAVE-CURRENT-DATE         PIC XX.
   282     12  SAVE-CONTROL              PIC X(39).
   283     12  SAVE-ERACCT-KEY           PIC X(26).
   284     12  SAVE-COUNTER              PIC S9(8)   COMP.
   285     12  SAVE-METHOD               PIC X.
   286     12  SAVE-COMPANY-ID           PIC XXX.
   287     12  SAVE-COMPANY-CD           PIC X.
   288     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   289     12  SAVE-CREDIT-USER          PIC X.
   290     12  SAVE-CLAIM-USER           PIC X.
   291     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   292     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   293     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   294     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   295     12  SAVE-AH-OVERRIDE-L1       PIC X.
   296     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   297     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   298     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   299     12  FILLER                    PIC X.
   300*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   301     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   302     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   303     12  SAVE-EL127-TO-EL130-CNTRL.
   304         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   8
* EL130.cbl
   305         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   306         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   307             20  SAVE-EL127-CARRIER  PIC X.
   308             20  SAVE-EL127-GROUPING PIC X(6).
   309             20  SAVE-EL127-STATE    PIC X(2).
   310             20  SAVE-EL127-ACCOUNT  PIC X(10).
   311             20  SAVE-EL127-CERT-NO  PIC X(11).
   312             20  SAVE-EL127-EFF-DT   PIC XX.
   313     12  SAVE-EL659-TO-EL130-CNTRL.
   314         16  SAVE-EL659-CARRIER    PIC X.
   315         16  SAVE-EL659-GROUPING   PIC X(6).
   316         16  SAVE-EL659-STATE      PIC XX.
   317         16  SAVE-EL659-ACCOUNT    PIC X(10).
   318     12  DIVIDE-QUOT               PIC 999.
   319     12  DIVIDE-REM                PIC 999.
   320     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   321     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   322     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   323     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   324     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   325     12  WS-RESERVE-CONTROLS       PIC X(9).
   326     12  WS-EXPENSE-CONTROLS       PIC X(7).
   327     12  WS-REIN-TABLE.
   328         16  WS-REIN-1             PIC X            VALUE SPACE.
   329         16  WS-REIN-2             PIC X            VALUE SPACE.
   330         16  WS-REIN-3             PIC X            VALUE SPACE.
   331     12  WS-BENE-CALC-METHOD       PIC X.
   332     12  ws-lf-joint-indicator     pic x.
   333     12  ws-ah-joint-indicator     pic x.
   334     12  WS-EARNINGS-CALC          PIC X.
   335     12  WS-LF-EARNINGS-CALC       PIC X.
   336         88 TEX-REG                VALUE '4'.
   337         88 NET-PAY                VALUE '5'.
   338     12  WS-AH-EARNINGS-CALC       PIC X.
   339     12  WS-SPECIAL-CALC-CD        PIC X(01).
   340     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   341     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   342     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   343     12  WS-ICD-CODE-1             PIC X(8).
   344     12  WS-ICD-CODE-2             PIC X(8).
   345     12  WS-CLAIM-NUMBER.
   346         16  WS-CN-PREFIX.
   347             20  WS-CN-PRF-A PIC X.
   348             20  WS-CN-PRF-B PIC X.
   349         16  WS-CN-NUMBER    PIC 9(5).
   350     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   351     12  WS-CLAIM-SEQU.
   352         16  FILLER          PIC X    VALUE '('.
   353         16  WS-CURRENT-SEQU PIC Z9.
   354         16  FILLER          PIC X(4) VALUE ' OF '.
   355         16  WS-OF-SEQU      PIC Z9.
   356         16  FILLER          PIC X    VALUE ')'.
   357     12  DATE-WORK.
   358       14  FILLER                PIC XX.
   359       14  DATE-MM               PIC XX.
   360       14  DATE-DD               PIC XX.
   361       14  DATE-YY               PIC XX.
   362     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   9
* EL130.cbl
   363         16  CURR-MM.
   364           18  CURR-M1           PIC 9.
   365           18  CURR-M2           PIC 9.
   366         16  FILLER              PIC X(5).
   367         16  CURR-YEAR           PIC 9.
   368     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   369     12  SUB                     PIC 99.
   370     12  MY-DATE.
   371         16  MY-MM               PIC XX.
   372         16  FILLER              PIC X VALUE '/'.
   373         16  MY-YY               PIC XX.
   374
   375     12  WS-EDIT-BEN-CODE        PIC XX.
   376         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   377                                          '90' THRU '99'.
   378
   379     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   380     12  WS-BEN-HOLD             PIC XX.
   381     12  WS-BEN-ALPHA-HOLD.
   382         15  WS-BEN-ALPHA-2      PIC XX.
   383         15  WS-BEN-ALPHA-1      PIC X.
   384     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   385     12  WS-REC-TYPE             PIC X.
   386     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   387     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   388     12  ARCH-NUMBER             PIC S9(8)   COMP.
   389     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   390         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   391         88  REIN-REC-FOUND                  VALUE 'Y'.
   392
   393     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   394     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   395
   396
   397 01  CSO-WORK-FIELDS.
   398     12  WS-BLANK            PIC X       VALUE ' '.
   399
   400     12  WS-MA-CONTROL-PRIMARY.
   401         16  WS-MA-COMPANY-CD        PIC  X.
   402         16  WS-MA-CARRIER           PIC  X.
   403         16  WS-MA-GROUPING          PIC  X(6).
   404         16  WS-MA-STATE             PIC  XX.
   405         16  WS-MA-ACCOUNT           PIC  X(10).
   406         16  WS-MA-CERT-EFF-DT       PIC  XX.
   407         16  WS-MA-CERT-NO.
   408             20  WS-MA-CERT-PRIME    PIC  X(10).
   409             20  WS-MA-CERT-SFX      PIC  X.
   410
   411     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   412     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   413     12  WS-SOC-SEC-NUMBER.
   414         16  WS-SOC-SEC-NO       PIC 9(9).
   415         16  WS-SOC-SEC-BLANK    PIC X(2).
   416     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   417         16  WS-SSN-1-3          PIC 9(3).
   418         16  WS-SSN-DASH1        PIC X(1).
   419         16  WS-SSN-4-5          PIC 9(2).
   420         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  10
* EL130.cbl
   421         16  WS-SSN-6-9          PIC 9(4).
   422
   423     12  WS-DIAG-VIN-MSG.
   424         16  FILLER          PIC X(11)
   425             VALUE 'VIN NUMBER '.
   426         16  WS-DIAG-VIN     PIC X(17).
   427
   428     12  WS-VERIFY-NOTE      PIC X(34)
   429         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   430
   431     12  WS-CAUSAL-NOTE      PIC X(40)
   432         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   433
   434     12  WS-VFY-SSN-NOTE     PIC X(25)
   435         VALUE 'SSN VERIFICATION REQUIRED'.
   436
   437 01  MAP-DATE-AREAS.
   438     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   439     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   440     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   441     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   442     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   443     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   444     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   445     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   446     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   447     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   448     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   449     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   450     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   451     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   452     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   453     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   454     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   455     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   456     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   457         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   458     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   459     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   460     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   461     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   462
   463 01  ACCESS-KEYS.
   464     12  ELACTQ-KEY.
   465         16  ELACTQ-COMPANY-CD       PIC X.
   466         16  ELACTQ-CARRIER          PIC X.
   467         16  ELACTQ-CLAIM-NO         PIC X(7).
   468         16  ELACTQ-CERT-NO          PIC X(11).
   469     12  ELMSTR-KEY.
   470         16  MSTR-COMP-CD            PIC X.
   471         16  MSTR-CARRIER            PIC X.
   472         16  MSTR-CLAIM-NO           PIC X(7).
   473         16  MSTR-CERT-NO.
   474             20  MSTR-CERT-NO-PRIME  PIC X(10).
   475             20  MSTR-CERT-NO-SUFX   PIC X.
   476     12  SAVE-ELMSTR-KEY.
   477         16  SAVE-COMP-CD            PIC X.
   478         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  11
* EL130.cbl
   479         16  SAVE-CLAIM-NO           PIC X(7).
   480         16  SAVE-CERT-NO.
   481             20  SAVE-CERT-NO-PRIME  PIC X(10).
   482             20  SAVE-CERT-NO-SUFX   PIC X.
   483     12  ELMSTR5-KEY.
   484         16  MSTR5-COMP-CD           PIC X.
   485         16  MSTR5-CERT-NO.
   486             20  MSTR5-CERT-NO-PRIME PIC X(10).
   487             20  MSTR5-CERT-NO-SUFX  PIC X.
   488     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   489         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   490         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   491         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   492     12  ELCNTL-KEY.
   493         16  CNTL-COMP-ID    PIC X(3).
   494         16  CNTL-REC-TYPE   PIC X.
   495         16  CNTL-ACCESS.
   496             20  FILLER      PIC XX.
   497             20  CNTL-BENEFIT.
   498                 24  FILLER  PIC X.
   499                 24  CNTL-CARRIER PIC X.
   500         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   501     12  ELCERT-KEY.
   502         16  CERT-COMP-CD    PIC X.
   503         16  CERT-CARRIER    PIC X.
   504         16  CERT-GROUPING   PIC X(6).
   505         16  CERT-STATE      PIC X(2).
   506         16  CERT-ACCOUNT.
   507             20  CERT-ACCOUNT-PREFIX PIC X(4).
   508             20  CERT-ACCOUNT-PRIME  PIC X(6).
   509         16  CERT-EFF-DT     PIC XX.
   510         16  CERT-CERT-NO.
   511             20  CERT-CERT-NO-PRIME  PIC X(10).
   512             20  CERT-CERT-NO-SUFX   PIC X.
   513     12  ELCERT-KEY-5.
   514         16  CERT-COMP-CD-5      PIC X.
   515         16  CERT-CERT-5.
   516             20  CERT-CERT-5-PRIME   PIC X(10).
   517             20  CERT-CERT-5-SUFX    PIC X.
   518     12  ERACCT-KEY.
   519         16  ACCT-COMP-CD    PIC X.
   520         16  ACCT-CARRIER    PIC X.
   521         16  ACCT-GROUPING   PIC X(6).
   522         16  ACCT-STATE      PIC X(2).
   523         16  ACCT-ACCOUNT    PIC X(10).
   524         16  ACCT-EXP-DT     PIC XX.
   525     12  ELTRLR-KEY.
   526         16  TRLR-COMP-CD    PIC X.
   527         16  TRLR-CARRIER    PIC X.
   528         16  TRLR-CLAIM-NO   PIC X(7).
   529         16  TRLR-CERT-NO.
   530             20  TRLR-CERT-NO-PRIME  PIC X(10).
   531             20  TRLR-CERT-NO-SUFX   PIC X.
   532         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   533         16  TRLR-TYPE       PIC X.
   534     12  ELBENE-KEY.
   535         16  BENE-COMP-CD    PIC X.
   536         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  12
* EL130.cbl
   537         16  BENE-CODE       PIC X(10).
   538     12  ERREIN-KEY.
   539         16  REIN-COMP-CD        PIC X(01).
   540         16  REIN-TYPE           PIC X(01).
   541         16  REIN-TABLE-CO.
   542             20  REIN-CODE-1     PIC X(01).
   543             20  REIN-CODE-2     PIC X(01).
   544             20  REIN-CODE-3     PIC X(01).
   545         16  FILLER              PIC X(03).
   546     12  ELCRTT-KEY.
   547         16  CTRLR-COMP-CD       PIC X.
   548         16  CTRLR-CARRIER       PIC X.
   549         16  CTRLR-GROUPING      PIC X(6).
   550         16  CTRLR-STATE         PIC X(2).
   551         16  CTRLR-ACCOUNT       PIC X(10).
   552         16  CTRLR-EFF-DT        PIC XX.
   553         16  CTRLR-CERT-NO       PIC X(11).
   554         16  CTRLR-REC-TYPE      PIC X.
   555 01  ws-acct-found-sw            pic x value ' '.
   556     88  acct-found                value 'Y'.
   557 01  ERPDEF-KEY-SAVE             PIC X(18).
   558 01  ERPDEF-KEY.
   559     12  ERPDEF-COMPANY-CD       PIC X.
   560     12  ERPDEF-STATE            PIC XX.
   561     12  ERPDEF-PROD-CD          PIC XXX.
   562     12  F                       PIC X(7).
   563     12  ERPDEF-BEN-TYPE         PIC X.
   564     12  ERPDEF-BEN-CODE         PIC XX.
   565     12  ERPDEF-EXP-DT           PIC XX.
   566 01  ERROR-MESSAGES.
   567     12  ER-0000                 PIC X(4)  VALUE '0000'.
   568     12  ER-0004                 PIC X(4)  VALUE '0004'.
   569     12  ER-0019                 PIC X(4)  VALUE '0019'.
   570     12  ER-0023                 PIC X(4)  VALUE '0023'.
   571     12  ER-0029                 PIC X(4)  VALUE '0029'.
   572     12  ER-0033                 PIC X(4)  VALUE '0033'.
   573     12  ER-0068                 PIC X(4)  VALUE '0068'.
   574     12  ER-0070                 PIC X(4)  VALUE '0070'.
   575     12  ER-0194                 PIC X(4)  VALUE '0194'.
   576     12  ER-0202                 PIC X(4)  VALUE '0202'.
   577     12  ER-0203                 PIC X(4)  VALUE '0203'.
   578     12  ER-0204                 PIC X(4)  VALUE '0204'.
   579     12  ER-0205                 PIC X(4)  VALUE '0205'.
   580     12  ER-0206                 PIC X(4)  VALUE '0206'.
   581     12  ER-0207                 PIC X(4)  VALUE '0207'.
   582     12  ER-0213                 PIC X(4)  VALUE '0213'.
   583     12  ER-0214                 PIC X(4)  VALUE '0214'.
   584     12  ER-0217                 PIC X(4)  VALUE '0217'.
   585     12  ER-0219                 PIC X(4)  VALUE '0219'.
   586     12  ER-0220                 PIC X(4)  VALUE '0220'.
   587     12  ER-0221                 PIC X(4)  VALUE '0221'.
   588     12  ER-0222                 PIC X(4)  VALUE '0222'.
   589     12  ER-0223                 PIC X(4)  VALUE '0223'.
   590     12  ER-0224                 PIC X(4)  VALUE '0224'.
   591     12  ER-0225                 PIC X(4)  VALUE '0225'.
   592     12  ER-0226                 PIC X(4)  VALUE '0226'.
   593     12  ER-0227                 PIC X(4)  VALUE '0227'.
   594     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  13
* EL130.cbl
   595     12  ER-0230                 PIC X(4)  VALUE '0230'.
   596     12  ER-0231                 PIC X(4)  VALUE '0231'.
   597     12  ER-0232                 PIC X(4)  VALUE '0232'.
   598     12  ER-0233                 PIC X(4)  VALUE '0233'.
   599     12  ER-0234                 PIC X(4)  VALUE '0234'.
   600     12  ER-0235                 PIC X(4)  VALUE '0235'.
   601     12  ER-0236                 PIC X(4)  VALUE '0236'.
   602     12  ER-0237                 PIC X(4)  VALUE '0237'.
   603     12  ER-0238                 PIC X(4)  VALUE '0238'.
   604     12  ER-0239                 PIC X(4)  VALUE '0239'.
   605     12  ER-0240                 PIC X(4)  VALUE '0240'.
   606     12  ER-0241                 PIC X(4)  VALUE '0241'.
   607     12  ER-0243                 PIC X(4)  VALUE '0243'.
   608     12  ER-0244                 PIC X(4)  VALUE '0244'.
   609     12  ER-0245                 PIC X(4)  VALUE '0245'.
   610     12  ER-0246                 PIC X(4)  VALUE '0246'.
   611     12  ER-0247                 PIC X(4)  VALUE '0247'.
   612     12  ER-0248                 PIC X(4)  VALUE '0248'.
   613     12  ER-0250                 PIC X(4)  VALUE '0250'.
   614     12  ER-0251                 PIC X(4)  VALUE '0251'.
   615     12  ER-0252                 PIC X(4)  VALUE '0252'.
   616     12  ER-0253                 PIC X(4)  VALUE '0253'.
   617     12  ER-0254                 PIC X(4)  VALUE '0254'.
   618     12  ER-0257                 PIC X(4)  VALUE '0257'.
   619     12  ER-0258                 PIC X(4)  VALUE '0258'.
   620     12  ER-0260                 PIC X(4)  VALUE '0260'.
   621     12  ER-0261                 PIC X(4)  VALUE '0261'.
   622     12  ER-0263                 PIC X(4)  VALUE '0263'.
   623     12  ER-0264                 PIC X(4)  VALUE '0264'.
   624     12  ER-0265                 PIC X(4)  VALUE '0265'.
   625     12  ER-0266                 PIC X(4)  VALUE '0266'.
   626     12  ER-0267                 PIC X(4)  VALUE '0267'.
   627     12  ER-0334                 PIC X(4)  VALUE '0334'.
   628     12  ER-0337                 PIC X(4)  VALUE '0337'.
   629     12  ER-0412                 PIC X(4)  VALUE '0412'.
   630     12  ER-0413                 PIC X(4)  VALUE '0413'.
   631     12  ER-0428                 PIC X(4)  VALUE '0428'.
   632     12  ER-0429                 PIC X(4)  VALUE '0429'.
   633     12  ER-0430                 PIC X(4)  VALUE '0430'.
   634     12  ER-0433                 PIC X(4)  VALUE '0433'.
   635     12  ER-0434                 PIC X(4)  VALUE '0434'.
   636     12  ER-0458                 PIC X(4)  VALUE '0458'.
   637     12  ER-0489                 PIC X(4)  VALUE '0489'.
   638     12  ER-0509                 PIC X(4)  VALUE '0509'.
   639     12  ER-0510                 PIC X(4)  VALUE '0510'.
   640     12  ER-0511                 PIC X(4)  VALUE '0511'.
   641     12  ER-0512                 PIC X(4)  VALUE '0512'.
   642     12  ER-0516                 PIC X(4)  VALUE '0516'.
   643     12  ER-0517                 PIC X(4)  VALUE '0517'.
   644     12  ER-0518                 PIC X(4)  VALUE '0518'.
   645     12  ER-0519                 PIC X(4)  VALUE '0519'.
   646     12  ER-0520                 PIC X(4)  VALUE '0520'.
   647     12  ER-0521                 PIC X(4)  VALUE '0521'.
   648     12  ER-0522                 PIC X(4)  VALUE '0522'.
   649     12  ER-0523                 PIC X(4)  VALUE '0523'.
   650     12  ER-0544                 PIC X(4)  VALUE '0544'.
   651     12  ER-0546                 PIC X(4)  VALUE '0546'.
   652     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  14
* EL130.cbl
   653     12  ER-0560                 PIC X(4)  VALUE '0560'.
   654     12  ER-0562                 PIC X(4)  VALUE '0562'.
   655     12  ER-0565                 PIC X(4)  VALUE '0565'.
   656     12  ER-0569                 PIC X(4)  VALUE '0569'.
   657     12  ER-0693                 PIC X(4)  VALUE '0693'.
   658     12  ER-0715                 PIC X(4)  VALUE '0715'.
   659     12  ER-0840                 PIC X(4)  VALUE '0840'.
   660     12  ER-0841                 PIC X(4)  VALUE '0841'.
   661     12  ER-0842                 PIC X(4)  VALUE '0842'.
   662     12  ER-0843                 PIC X(4)  VALUE '0843'.
   663     12  ER-0878                 PIC X(4)  VALUE '0878'.
   664     12  ER-0887                 PIC X(4)  VALUE '0887'.
   665     12  ER-0992                 PIC X(4)  VALUE '0992'.
   666     12  ER-1651                 PIC X(4)  VALUE '1651'.
   667     12  ER-1652                 PIC X(4)  VALUE '1652'.
   668     12  ER-1653                 PIC X(4)  VALUE '1653'.
   669     12  ER-1654                 PIC X(4)  VALUE '1654'.
   670     12  ER-1655                 PIC X(4)  VALUE '1655'.
   671     12  er-1659                 pic x(4)  value '1659'.
   672     12  er-1660                 pic x(4)  value '1660'.
   673     12  er-1661                 pic x(4)  value '1661'.
   674     12  er-1671                 pic x(4)  value '1671'.
   675     12  er-1672                 pic x(4)  value '1672'.
   676     12  er-1673                 pic x(4)  value '1673'.
   677     12  er-1675                 pic x(4)  value '1675'.
   678     12  er-1676                 pic x(4)  value '1676'.
   679     12  ER-2280                 PIC X(4)  VALUE '2280'.
   680     12  ER-2370                 PIC X(4)  VALUE '2370'.
   681     12  ER-2371                 PIC X(4)  VALUE '2371'.
   682     12  ER-2378                 PIC X(4)  VALUE '2378'.
   683     12  ER-2380                 PIC X(4)  VALUE '2380'.
   684     12  ER-2566                 PIC X(4)  VALUE '2566'.
   685     12  ER-2848                 PIC X(4)  VALUE '2848'.
   686     12  ER-3548                 PIC X(4)  VALUE '3548'.
   687     12  ER-7008                 PIC X(4)  VALUE '7008'.
   688     12  ER-7319                 PIC X(4)  VALUE '7319'.
   689     12  ER-7321                 PIC X(4)  VALUE '7321'.
   690     12  ER-7352                 PIC X(4)  VALUE '7352'.
   691     12  ER-7353                 PIC X(4)  VALUE '7353'.
   692     12  ER-7575                 PIC X(4)  VALUE '7575'.
   693     12  ER-7577                 PIC X(4)  VALUE '7577'.
   694     12  ER-7582                 PIC X(4)  VALUE '7582'.
   695     12  ER-7634                 PIC X(4)  VALUE '7634'.
   696     12  ER-7635                 PIC X(4)  VALUE '7635'.
   697     12  ER-7636                 PIC X(4)  VALUE '7636'.
   698     12  ER-7637                 PIC X(4)  VALUE '7637'.
   699     12  ER-7638                 PIC X(4)  VALUE '7638'.
   700     12  ER-7639                 PIC X(4)  VALUE '7639'.
   701     12  ER-7640                 PIC X(4)  VALUE '7640'.
   702     12  ER-7641                 PIC X(4)  VALUE '7641'.
   703     12  ER-7642                 PIC X(4)  VALUE '7642'.
   704     12  ER-7643                 PIC X(4)  VALUE '7643'.
   705     12  ER-7646                 PIC X(4)  VALUE '7646'.
   706     12  ER-7647                 PIC X(4)  VALUE '7647'.
   707     12  ER-7648                 PIC X(4)  VALUE '7648'.
   708     12  ER-7649                 PIC X(4)  VALUE '7649'.
   709     12  ER-7651                 PIC X(4)  VALUE '7651'.
   710     12  ER-7670                 PIC X(4)  VALUE '7670'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  15
* EL130.cbl
   711     12  ER-7671                 PIC X(4)  VALUE '7671'.
   712     12  ER-7686                 PIC X(4)  VALUE '7686'.
   713     12  ER-7688                 PIC X(4)  VALUE '7688'.
   714     12  ER-7689                 PIC X(4)  VALUE '7689'.
   715     12  ER-7691                 PIC X(4)  VALUE '7691'.
   716*    COPY ERCPDEF.
   717******************************************************************
   718*                                                                *
   719*                                                                *
   720*                            ERCPDEF.                            *
   721*                                                                *
   722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   723*                                                                *
   724*    FILE TYPE = VSAM,KSDS                                       *
   725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   726*                                                                *
   727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   728*                                                                *
   729*    LOG = YES                                                   *
   730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   740* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   741* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   742******************************************************************
   743 01  PRODUCT-MASTER.
   744    12  PD-RECORD-ID                 PIC X(02).
   745        88  VALID-PD-ID                  VALUE 'PD'.
   746    12  PD-CONTROL-PRIMARY.
   747        16  PD-COMPANY-CD            PIC X.
   748        16  PD-STATE                 PIC XX.
   749        16  PD-PRODUCT-CD            PIC XXX.
   750        16  PD-FILLER                PIC X(7).
   751        16  PD-BEN-TYPE              PIC X.
   752        16  PD-BEN-CODE              PIC XX.
   753        16  PD-PROD-EXP-DT           PIC XX.
   754    12  FILLER                       PIC X(50).
   755    12  PD-PRODUCT-DATA OCCURS 8.
   756        16  PD-PROD-CODE             PIC X.
   757            88  PD-PROD-LIFE           VALUE 'L'.
   758            88  PD-PROD-PROP           VALUE 'P'.
   759            88  PD-PROD-AH             VALUE 'A'.
   760            88  PD-PROD-IU             VALUE 'I'.
   761            88  PD-PROD-GAP            VALUE 'G'.
   762            88  PD-PROD-FAML           VALUE 'F'.
   763        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   764        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   765        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   766        16  PD-MAX-TERM              PIC S999        COMP-3.
   767        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   768        16  FILLER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  16
* EL130.cbl
   769        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   770        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   771        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   772        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   773        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   774        16  PD-REC-CRIT-PERIOD       PIC 99.
   775        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   776            20  PD-RECURRING-YN      PIC X.
   777            20  FILLER               PIC X.
   778        16  PD-RTW-MOS               PIC 99.
   779        16  PD-MAX-EXTENSION         PIC 99.
   780        16  pd-ben-pct               pic sv999 comp-3.
   781*       16  FILLER                   PIC XX.
   782    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   783    12  PD-TERM-LIMITS OCCURS 15.
   784        16  PD-LOW-TERM              PIC S999        COMP-3.
   785        16  PD-HI-TERM               PIC S999        COMP-3.
   786*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   787    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   788        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   789        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   790    12  PD-EARN-FACTORS.
   791        16  FILLER OCCURS 15.
   792            20  FILLER OCCURS 15.
   793                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   794    12  PD-PRODUCT-DESC              PIC X(80).
   795    12  PD-TRUNCATED                 PIC X.
   796    12  FILLER                       PIC X(59).
   797    12  PD-MAINT-INFORMATION.
   798        16  PD-LAST-MAINT-DT         PIC X(02).
   799        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   800        16  PD-LAST-MAINT-BY         PIC X(04).
   801*    COPY ELCLNKLT.
   802******************************************************************
   803*                                                                *
   804*                                                                *
   805*                           ELCLNKLT                             *
   806*                            VMOD=2.003                          *
   807*                                                                *
   808*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   809*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   810*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   811*                                                                *
   812*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   813*   COMPLETING THE REQUIRED FIELDS.                              *
   814*                                                                *
   815*   THE CALLING PROGRAM SHOULD CHECK:                            *
   816*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   817*                              9999 INDICATES AN UNKNOWN ABEND   *
   818*                                   WAS DETECTED.                *
   819*                              ALL OTHER VALUES ARE NORMAL ERROR *
   820*                              CODES FOUND IN THE ERROR FILE.    *
   821******************************************************************
   822 01  W-1523-LINKDATA.
   823     12  W-1523-COMMON-PI-DATA.
   824         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   825         16  FILLER              PIC  X(67).
   826         16  W-1523-COMPANY-CD   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  17
* EL130.cbl
   827         16  FILLER              PIC  X(10).
   828         16  W-1523-CONTROL-IN-PROGRESS.
   829             20  W-1523-CARRIER  PIC  X(01).
   830             20  W-1523-GROUPING PIC  X(06).
   831             20  W-1523-STATE    PIC  X(02).
   832             20  W-1523-ACCOUNT  PIC  X(10).
   833             20  W-1523-CLAIM-CERT-GRP.
   834                 24  W-1523-CLAIM-NO
   835                                 PIC  X(07).
   836                 24  W-1523-CERT-NO.
   837                     28  W-1523-CERT-PRIME
   838                                 PIC  X(10).
   839                     28  W-1523-CERT-SFX
   840                                 PIC  X(01).
   841                 24  W-1523-CERT-EFF-DT
   842                                 PIC  X(02).
   843         16  FILLER              PIC X(265).
   844
   845     12  W-1523-WORK-AREA.
   846         16  W-1523-FORM-NUMBER  PIC  X(04).
   847         16  W-1523-NUMBER-COPIES
   848                                 PIC  9(01).
   849         16  W-1523-ADDR-TYPE    PIC  X(02).
   850         16  W-1523-FOLLOW-UP-DATE
   851                                 PIC  X(02).
   852         16  W-1523-RESEND-DATE  PIC  X(02).
   853         16  W-1523-ERROR-CODE   PIC  9(04).
   854             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   855             88  W-1523-FATAL-ERROR
   856                                    VALUES  0006 0013 0042
   857                                            0154 0168 0169
   858                                            0176 9999 0172
   859                                            0179 0186 0281
   860                                            0332 2055 3697
   861                                            3698 3699 3770
   862                                            3771 3772 7675
   863                                            9106 9808 9883
   864                                            9887.
   865             88  W-1523-STOP-ERRORS
   866                                    VALUES  0013 0042 0154
   867                                            0168 0169 0172
   868                                            0281 0332 2055
   869                                            3698 3699 7675
   870                                            9106 9808 9883
   871                                            9999.
   872         16  W-1523-REASON       PIC  X(70).
   873         16  W-1523-ARCHIVE-NUMBER
   874                                 PIC  9(08).
   875     12  W-1523-POINTER-AREA.
   876         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   877         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   878         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   879         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   880         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  18
* EL130.cbl
   882*    COPY ELCINTF.
   883******************************************************************
   884*                                                                *
   885*                                                                *
   886*                            ELCINTF.                            *
   887*                            VMOD=2.017                          *
   888*                                                                *
   889*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   890*                                                                *
   891*       LENGTH = 1024                                            *
   892*                                                                *
   893******************************************************************
   894*                   C H A N G E   L O G
   895*
   896* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   897*-----------------------------------------------------------------
   898*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   899* EFFECTIVE    NUMBER
   900*-----------------------------------------------------------------
   901* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   902******************************************************************
   903 01  PROGRAM-INTERFACE-BLOCK.
   904     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   905     12  PI-CALLING-PROGRAM              PIC X(8).
   906     12  PI-SAVED-PROGRAM-1              PIC X(8).
   907     12  PI-SAVED-PROGRAM-2              PIC X(8).
   908     12  PI-SAVED-PROGRAM-3              PIC X(8).
   909     12  PI-SAVED-PROGRAM-4              PIC X(8).
   910     12  PI-SAVED-PROGRAM-5              PIC X(8).
   911     12  PI-SAVED-PROGRAM-6              PIC X(8).
   912     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   913     12  PI-COMPANY-ID                   PIC XXX.
   914     12  PI-COMPANY-CD                   PIC X.
   915
   916     12  PI-COMPANY-PASSWORD             PIC X(8).
   917
   918     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   919
   920     12  PI-CONTROL-IN-PROGRESS.
   921         16  PI-CARRIER                  PIC X.
   922         16  PI-GROUPING                 PIC X(6).
   923         16  PI-STATE                    PIC XX.
   924         16  PI-ACCOUNT                  PIC X(10).
   925         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   926                                         PIC X(10).
   927         16  PI-CLAIM-CERT-GRP.
   928             20  PI-CLAIM-NO             PIC X(7).
   929             20  PI-CERT-NO.
   930                 25  PI-CERT-PRIME       PIC X(10).
   931                 25  PI-CERT-SFX         PIC X.
   932             20  PI-CERT-EFF-DT          PIC XX.
   933         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   934             20  PI-PLAN-CODE            PIC X(2).
   935             20  PI-REVISION-NUMBER      PIC X(3).
   936             20  PI-PLAN-EFF-DT          PIC X(2).
   937             20  PI-PLAN-EXP-DT          PIC X(2).
   938             20  FILLER                  PIC X(11).
   939         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  19
* EL130.cbl
   940             20  PI-OE-REFERENCE-1.
   941                 25  PI-OE-REF-1-PRIME   PIC X(18).
   942                 25  PI-OE-REF-1-SUFF    PIC XX.
   943
   944     12  PI-SESSION-IN-PROGRESS          PIC X.
   945         88  CLAIM-SESSION                   VALUE '1'.
   946         88  CREDIT-SESSION                  VALUE '2'.
   947         88  WARRANTY-SESSION                VALUE '3'.
   948         88  MORTGAGE-SESSION                VALUE '4'.
   949         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   950
   951
   952*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   953
   954     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   955     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   956
   957     12  PI-CREDIT-USER                  PIC X.
   958         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   959         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   960
   961     12  PI-CLAIM-USER                   PIC X.
   962         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   963         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   964
   965     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   966         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   967         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   968         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   969         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   970         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   971
   972     12  PI-PROCESSOR-ID                 PIC X(4).
   973
   974     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   975
   976     12  PI-MEMBER-CAPTION               PIC X(10).
   977
   978     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   979         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   980
   981     12  PI-LIFE-OVERRIDE-L1             PIC X.
   982     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   983     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   984     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   985
   986     12  PI-AH-OVERRIDE-L1               PIC X.
   987     12  PI-AH-OVERRIDE-L2               PIC XX.
   988     12  PI-AH-OVERRIDE-L6               PIC X(6).
   989     12  PI-AH-OVERRIDE-L12              PIC X(12).
   990
   991     12  PI-NEW-SYSTEM                   PIC X(2).
   992
   993     12  PI-PRIMARY-CERT-NO              PIC X(11).
   994     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   995         88  PI-USES-PAID-TO                 VALUE '1'.
   996     12  PI-CRDTCRD-SYSTEM.
   997         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  20
* EL130.cbl
   998             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   999             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1000         16  PI-CC-MONTH-END-DT          PIC XX.
  1001     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1002
  1003     12  PI-OE-REFERENCE-2.
  1004         16  PI-OE-REF-2-PRIME           PIC X(10).
  1005         16  PI-OE-REF-2-SUFF            PIC X.
  1006
  1007     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1008
  1009     12  PI-LANGUAGE-TYPE                PIC X.
  1010             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1011             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1012             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1013
  1014     12  PI-POLICY-LINKAGE-IND           PIC X.
  1015         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1016         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1017                                                   LOW-VALUES.
  1018
  1019     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1020     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1021         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1022         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1023
  1024     12  PI-PROCESSOR-CSR-IND            PIC X.
  1025         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1026         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1027
  1028     12  FILLER                          PIC X(3).
  1029
  1030     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1031
  1032     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1033         PI-SYSTEM-LEVEL.
  1034
  1035         16  PI-ENTRY-CODES.
  1036             20  PI-ENTRY-CD-1           PIC X.
  1037             20  PI-ENTRY-CD-2           PIC X.
  1038
  1039         16  PI-RETURN-CODES.
  1040             20  PI-RETURN-CD-1          PIC X.
  1041             20  PI-RETURN-CD-2          PIC X.
  1042
  1043         16  PI-UPDATE-STATUS-SAVE.
  1044             20  PI-UPDATE-BY            PIC X(4).
  1045             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1046
  1047         16  PI-LOWER-CASE-LETTERS       PIC X.
  1048             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1049
  1050*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1051*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1052*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1053
  1054         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1055             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  21
* EL130.cbl
  1056             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1057             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1058             88  ACCNT-CNTL                  VALUE '3'.
  1059             88  CARR-ACCNT-CNTL             VALUE '4'.
  1060
  1061         16  PI-PROCESSOR-CAP-LIST.
  1062             20  PI-SYSTEM-CONTROLS.
  1063                24 PI-SYSTEM-DISPLAY     PIC X.
  1064                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1065                24 PI-SYSTEM-MODIFY      PIC X.
  1066                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1067             20  FILLER                  PIC XX.
  1068             20  PI-DISPLAY-CAP          PIC X.
  1069                 88  DISPLAY-CAP             VALUE 'Y'.
  1070             20  PI-MODIFY-CAP           PIC X.
  1071                 88  MODIFY-CAP              VALUE 'Y'.
  1072             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1073                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1074             20  PI-FORCE-CAP            PIC X.
  1075                 88  FORCE-CAP               VALUE 'Y'.
  1076
  1077         16  PI-PROGRAM-CONTROLS.
  1078             20  PI-PGM-PRINT-OPT        PIC X.
  1079             20  PI-PGM-FORMAT-OPT       PIC X.
  1080             20  PI-PGM-PROCESS-OPT      PIC X.
  1081             20  PI-PGM-TOTALS-OPT       PIC X.
  1082
  1083         16  PI-HELP-INTERFACE.
  1084             20  PI-LAST-ERROR-NO        PIC X(4).
  1085             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1086
  1087         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1088             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1089
  1090         16  PI-CR-CONTROL-IN-PROGRESS.
  1091             20  PI-CR-CARRIER           PIC X.
  1092             20  PI-CR-GROUPING          PIC X(6).
  1093             20  PI-CR-STATE             PIC XX.
  1094             20  PI-CR-ACCOUNT           PIC X(10).
  1095             20  PI-CR-FIN-RESP          PIC X(10).
  1096             20  PI-CR-TYPE              PIC X.
  1097
  1098         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1099
  1100         16  PI-CR-MONTH-END-DT          PIC XX.
  1101
  1102         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1103             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1104             88  PI-ZERO-CARRIER             VALUE '1'.
  1105             88  PI-ZERO-GROUPING            VALUE '2'.
  1106             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1107
  1108         16  PI-CARRIER-SECURITY         PIC X.
  1109             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1110
  1111         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1112             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1113             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  22
* EL130.cbl
  1114
  1115         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1116             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1117                                         INDEXED BY PI-ACCESS-NDX
  1118                                         PIC X.
  1119
  1120         16  PI-GA-BILLING-CONTROL       PIC X.
  1121             88  PI-GA-BILLING               VALUE '1'.
  1122
  1123         16  PI-MAIL-PROCESSING          PIC X.
  1124             88  PI-MAIL-YES                 VALUE 'Y'.
  1125
  1126         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1127
  1128         16  PI-AR-SYSTEM.
  1129             20  PI-AR-PROCESSING-CNTL   PIC X.
  1130                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1131             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1132             20  PI-AR-MONTH-END-DT      PIC XX.
  1133
  1134         16  PI-MP-SYSTEM.
  1135             20  PI-MORTGAGE-USER            PIC X.
  1136                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1137                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1138             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1139                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1140                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1141                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1142                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1143                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1144             20  PI-MP-MONTH-END-DT          PIC XX.
  1145             20  PI-MP-REFERENCE-NO.
  1146                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1147                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1148
  1149         16  PI-LABEL-CONTROL            PIC X(01).
  1150             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1151             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1152
  1153         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1154             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1155
  1156         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1157             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1158             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1159
  1160         16  FILLER                      PIC X(14).
  1161
  1162     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1163******************************************************************
  1164     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1165         16  PI-MSTR-DT               PIC XX.
  1166         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1167         16  PI-TRLR-DT               PIC XX.
  1168         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1169         16  PI-LAST-CLAIM            PIC X(7).
  1170         16  PI-LAST-CARR             PIC X.
  1171         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  23
* EL130.cbl
  1172             20  PI-LAST-CERT-PRIME   PIC X(10).
  1173             20  PI-LAST-CERT-SUFX    PIC X.
  1174         16  PI-LAST-CLAIM-TYPE       PIC X.
  1175         16  PI-CURSOR                PIC S9(4)   COMP.
  1176         16  PI-SAVE-CERT.
  1177             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1178             20  PI-SAVE-CERT-SUFX    PIC X.
  1179         16  PI-SAVE-EFFDT            PIC X(2).
  1180         16  PI-SAVE-ACCOUNT          PIC X(10).
  1181         16  PI-INCURR-SW             PIC X.
  1182         16  PI-PRT-OPT               PIC X.
  1183         16  PI-ALT-PRT               PIC X(4).
  1184         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1185             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1186         16  FILLER                   PIC X(272).
  1187         16  PI-EL127-TO-EL130-CNTRL.
  1188             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1189             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1190             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1191                 24  PI-EL127-CARRIER        PIC X.
  1192                 24  PI-EL127-GROUPING       PIC X(6).
  1193                 24  PI-EL127-STATE          PIC X(2).
  1194                 24  PI-EL127-ACCOUNT        PIC X(10).
  1195                 24  PI-EL127-CERT-NO.
  1196                     28  PI-EL127-CERT-PRIME PIC X(10).
  1197                     28  PI-EL127-CERT-SUFX  PIC X.
  1198                 24  PI-EL127-EFF-DT         PIC XX.
  1199*        16  FILLER                          PIC X(50).
  1200         16  FILLER                          PIC X(31).
  1201         16  PI-EL659-TO-EL130-CNTRL.
  1202             20  PI-EL659-CARRIER            PIC X.
  1203             20  PI-EL659-GROUPING           PIC X(6).
  1204             20  PI-EL659-STATE              PIC XX.
  1205             20  PI-EL659-ACCOUNT            PIC X(10).
  1206
  1207         16  FILLER                          PIC X(19).
  1208
  1209         16  PI-SAVE-INCUR-DT                PIC X(02).
  1210         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1211*         16  FILLER                          PIC X(65).
  1212         16  PI-ST-VFY-2ND-BENE              PIC X.
  1213         16  PI-ST-CAUSAL-STATE              PIC X.
  1214         16  pi-dcc-max-benefits             pic s999 comp-3.
  1215         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1216         16  pi-emi-sub                      pic 99.
  1217         16  FILLER                          PIC X(53).
  1218
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  24
* EL130.cbl
  1220*    COPY EL130S.
  1221 01  EL130AI.
  1222     05  FILLER            PIC  X(0012).
  1223*    -------------------------------
  1224     05  RUNDTEL PIC S9(0004) COMP.
  1225     05  RUNDTEF PIC  X(0001).
  1226     05  FILLER REDEFINES RUNDTEF.
  1227         10  RUNDTEA PIC  X(0001).
  1228     05  RUNDTEI PIC  X(0008).
  1229*    -------------------------------
  1230     05  RUNTIMEL PIC S9(0004) COMP.
  1231     05  RUNTIMEF PIC  X(0001).
  1232     05  FILLER REDEFINES RUNTIMEF.
  1233         10  RUNTIMEA PIC  X(0001).
  1234     05  RUNTIMEI PIC  X(0005).
  1235*    -------------------------------
  1236     05  COMPL PIC S9(0004) COMP.
  1237     05  COMPF PIC  X(0001).
  1238     05  FILLER REDEFINES COMPF.
  1239         10  COMPA PIC  X(0001).
  1240     05  COMPI PIC  X(0003).
  1241*    -------------------------------
  1242     05  SEQUL PIC S9(0004) COMP.
  1243     05  SEQUF PIC  X(0001).
  1244     05  FILLER REDEFINES SEQUF.
  1245         10  SEQUA PIC  X(0001).
  1246     05  SEQUI PIC  X(0010).
  1247*    -------------------------------
  1248     05  MAINTL PIC S9(0004) COMP.
  1249     05  MAINTF PIC  X(0001).
  1250     05  FILLER REDEFINES MAINTF.
  1251         10  MAINTA PIC  X(0001).
  1252     05  MAINTI PIC  X(0001).
  1253*    -------------------------------
  1254     05  CLMNOL PIC S9(0004) COMP.
  1255     05  CLMNOF PIC  X(0001).
  1256     05  FILLER REDEFINES CLMNOF.
  1257         10  CLMNOA PIC  X(0001).
  1258     05  CLMNOI PIC  X(0007).
  1259*    -------------------------------
  1260     05  CLMCARRL PIC S9(0004) COMP.
  1261     05  CLMCARRF PIC  X(0001).
  1262     05  FILLER REDEFINES CLMCARRF.
  1263         10  CLMCARRA PIC  X(0001).
  1264     05  CLMCARRI PIC  X(0001).
  1265*    -------------------------------
  1266     05  CLMTYPEL PIC S9(0004) COMP.
  1267     05  CLMTYPEF PIC  X(0001).
  1268     05  FILLER REDEFINES CLMTYPEF.
  1269         10  CLMTYPEA PIC  X(0001).
  1270     05  CLMTYPEI PIC  X(0001).
  1271*    -------------------------------
  1272     05  CERTNOL PIC S9(0004) COMP.
  1273     05  CERTNOF PIC  X(0001).
  1274     05  FILLER REDEFINES CERTNOF.
  1275         10  CERTNOA PIC  X(0001).
  1276     05  CERTNOI PIC  X(0010).
  1277*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  25
* EL130.cbl
  1278     05  SUFXL PIC S9(0004) COMP.
  1279     05  SUFXF PIC  X(0001).
  1280     05  FILLER REDEFINES SUFXF.
  1281         10  SUFXA PIC  X(0001).
  1282     05  SUFXI PIC  X(0001).
  1283*    -------------------------------
  1284     05  PCERTNOL PIC S9(0004) COMP.
  1285     05  PCERTNOF PIC  X(0001).
  1286     05  FILLER REDEFINES PCERTNOF.
  1287         10  PCERTNOA PIC  X(0001).
  1288     05  PCERTNOI PIC  X(0010).
  1289*    -------------------------------
  1290     05  PSUFXL PIC S9(0004) COMP.
  1291     05  PSUFXF PIC  X(0001).
  1292     05  FILLER REDEFINES PSUFXF.
  1293         10  PSUFXA PIC  X(0001).
  1294     05  PSUFXI PIC  X(0001).
  1295*    -------------------------------
  1296     05  INCURL PIC S9(0004) COMP.
  1297     05  INCURF PIC  X(0001).
  1298     05  FILLER REDEFINES INCURF.
  1299         10  INCURA PIC  X(0001).
  1300     05  INCURI PIC  X(0008).
  1301*    -------------------------------
  1302     05  REPORTL PIC S9(0004) COMP.
  1303     05  REPORTF PIC  X(0001).
  1304     05  FILLER REDEFINES REPORTF.
  1305         10  REPORTA PIC  X(0001).
  1306     05  REPORTI PIC  X(0008).
  1307*    -------------------------------
  1308     05  ICD1L PIC S9(0004) COMP.
  1309     05  ICD1F PIC  X(0001).
  1310     05  FILLER REDEFINES ICD1F.
  1311         10  ICD1A PIC  X(0001).
  1312     05  ICD1I PIC  X(0008).
  1313*    -------------------------------
  1314     05  ICD2L PIC S9(0004) COMP.
  1315     05  ICD2F PIC  X(0001).
  1316     05  FILLER REDEFINES ICD2F.
  1317         10  ICD2A PIC  X(0001).
  1318     05  ICD2I PIC  X(0008).
  1319*    -------------------------------
  1320     05  DIAGL PIC S9(0004) COMP.
  1321     05  DIAGF PIC  X(0001).
  1322     05  FILLER REDEFINES DIAGF.
  1323         10  DIAGA PIC  X(0001).
  1324     05  DIAGI PIC  X(0060).
  1325*    -------------------------------
  1326     05  BENECDL PIC S9(0004) COMP.
  1327     05  BENECDF PIC  X(0001).
  1328     05  FILLER REDEFINES BENECDF.
  1329         10  BENECDA PIC  X(0001).
  1330     05  BENECDI PIC  X(0010).
  1331*    -------------------------------
  1332     05  BIRTHDTL PIC S9(0004) COMP.
  1333     05  BIRTHDTF PIC  X(0001).
  1334     05  FILLER REDEFINES BIRTHDTF.
  1335         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  26
* EL130.cbl
  1336     05  BIRTHDTI PIC  X(0008).
  1337*    -------------------------------
  1338     05  SSNL PIC S9(0004) COMP.
  1339     05  SSNF PIC  X(0001).
  1340     05  FILLER REDEFINES SSNF.
  1341         10  SSNA PIC  X(0001).
  1342     05  SSNI PIC  X(0011).
  1343*    -------------------------------
  1344     05  SEXL PIC S9(0004) COMP.
  1345     05  SEXF PIC  X(0001).
  1346     05  FILLER REDEFINES SEXF.
  1347         10  SEXA PIC  X(0001).
  1348     05  SEXI PIC  X(0001).
  1349*    -------------------------------
  1350     05  INSTYPEL PIC S9(0004) COMP.
  1351     05  INSTYPEF PIC  X(0001).
  1352     05  FILLER REDEFINES INSTYPEF.
  1353         10  INSTYPEA PIC  X(0001).
  1354     05  INSTYPEI PIC  X(0001).
  1355*    -------------------------------
  1356     05  LSTNMEL PIC S9(0004) COMP.
  1357     05  LSTNMEF PIC  X(0001).
  1358     05  FILLER REDEFINES LSTNMEF.
  1359         10  LSTNMEA PIC  X(0001).
  1360     05  LSTNMEI PIC  X(0015).
  1361*    -------------------------------
  1362     05  FSTNMEL PIC S9(0004) COMP.
  1363     05  FSTNMEF PIC  X(0001).
  1364     05  FILLER REDEFINES FSTNMEF.
  1365         10  FSTNMEA PIC  X(0001).
  1366     05  FSTNMEI PIC  X(0012).
  1367*    -------------------------------
  1368     05  INITL PIC S9(0004) COMP.
  1369     05  INITF PIC  X(0001).
  1370     05  FILLER REDEFINES INITF.
  1371         10  INITA PIC  X(0001).
  1372     05  INITI PIC  X(0001).
  1373*    -------------------------------
  1374     05  LOANNOL PIC S9(0004) COMP.
  1375     05  LOANNOF PIC  X(0001).
  1376     05  FILLER REDEFINES LOANNOF.
  1377         10  LOANNOA PIC  X(0001).
  1378     05  LOANNOI PIC  X(0008).
  1379*    -------------------------------
  1380     05  CRTLNMEL PIC S9(0004) COMP.
  1381     05  CRTLNMEF PIC  X(0001).
  1382     05  FILLER REDEFINES CRTLNMEF.
  1383         10  CRTLNMEA PIC  X(0001).
  1384     05  CRTLNMEI PIC  X(0015).
  1385*    -------------------------------
  1386     05  CRTFNMEL PIC S9(0004) COMP.
  1387     05  CRTFNMEF PIC  X(0001).
  1388     05  FILLER REDEFINES CRTFNMEF.
  1389         10  CRTFNMEA PIC  X(0001).
  1390     05  CRTFNMEI PIC  X(0012).
  1391*    -------------------------------
  1392     05  CRTINITL PIC S9(0004) COMP.
  1393     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  27
* EL130.cbl
  1394     05  FILLER REDEFINES CRTINITF.
  1395         10  CRTINITA PIC  X(0001).
  1396     05  CRTINITI PIC  X(0001).
  1397*    -------------------------------
  1398     05  LOANBALL PIC S9(0004) COMP.
  1399     05  LOANBALF PIC  X(0001).
  1400     05  FILLER REDEFINES LOANBALF.
  1401         10  LOANBALA PIC  X(0001).
  1402     05  LOANBALI PIC  9(7)V99.
  1403*    -------------------------------
  1404     05  MANRSVL PIC S9(0004) COMP.
  1405     05  MANRSVF PIC  X(0001).
  1406     05  FILLER REDEFINES MANRSVF.
  1407         10  MANRSVA PIC  X(0001).
  1408     05  MANRSVI PIC  9(7)V99.
  1409*    -------------------------------
  1410     05  SUPVL PIC S9(0004) COMP.
  1411     05  SUPVF PIC  X(0001).
  1412     05  FILLER REDEFINES SUPVF.
  1413         10  SUPVA PIC  X(0001).
  1414     05  SUPVI PIC  X(0001).
  1415*    -------------------------------
  1416     05  PRICDL PIC S9(0004) COMP.
  1417     05  PRICDF PIC  X(0001).
  1418     05  FILLER REDEFINES PRICDF.
  1419         10  PRICDA PIC  X(0001).
  1420     05  PRICDI PIC  X(0001).
  1421*    -------------------------------
  1422     05  PRODL PIC S9(0004) COMP.
  1423     05  PRODF PIC  X(0001).
  1424     05  FILLER REDEFINES PRODF.
  1425         10  PRODA PIC  X(0001).
  1426     05  PRODI PIC  X(0008).
  1427*    -------------------------------
  1428     05  PRODCDL PIC S9(0004) COMP.
  1429     05  PRODCDF PIC  X(0001).
  1430     05  FILLER REDEFINES PRODCDF.
  1431         10  PRODCDA PIC  X(0001).
  1432     05  PRODCDI PIC  X(0001).
  1433*    -------------------------------
  1434     05  FILETOL PIC S9(0004) COMP.
  1435     05  FILETOF PIC  X(0001).
  1436     05  FILLER REDEFINES FILETOF.
  1437         10  FILETOA PIC  X(0001).
  1438     05  FILETOI PIC  X(0004).
  1439*    -------------------------------
  1440     05  PROCCDL PIC S9(0004) COMP.
  1441     05  PROCCDF PIC  X(0001).
  1442     05  FILLER REDEFINES PROCCDF.
  1443         10  PROCCDA PIC  X(0001).
  1444     05  PROCCDI PIC  X(0004).
  1445*    -------------------------------
  1446     05  RELCLML PIC S9(0004) COMP.
  1447     05  RELCLMF PIC  X(0001).
  1448     05  FILLER REDEFINES RELCLMF.
  1449         10  RELCLMA PIC  X(0001).
  1450     05  RELCLMI PIC  X(0007).
  1451*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  28
* EL130.cbl
  1452     05  PRTOPTL PIC S9(0004) COMP.
  1453     05  PRTOPTF PIC  X(0001).
  1454     05  FILLER REDEFINES PRTOPTF.
  1455         10  PRTOPTA PIC  X(0001).
  1456     05  PRTOPTI PIC  X(0001).
  1457*    -------------------------------
  1458     05  ALTPRTL PIC S9(0004) COMP.
  1459     05  ALTPRTF PIC  X(0001).
  1460     05  FILLER REDEFINES ALTPRTF.
  1461         10  ALTPRTA PIC  X(0001).
  1462     05  ALTPRTI PIC  X(0004).
  1463*    -------------------------------
  1464     05  CERTMTL PIC S9(0004) COMP.
  1465     05  CERTMTF PIC  X(0001).
  1466     05  FILLER REDEFINES CERTMTF.
  1467         10  CERTMTA PIC  X(0001).
  1468     05  CERTMTI PIC  X(0001).
  1469*    -------------------------------
  1470     05  CRTCARRL PIC S9(0004) COMP.
  1471     05  CRTCARRF PIC  X(0001).
  1472     05  FILLER REDEFINES CRTCARRF.
  1473         10  CRTCARRA PIC  X(0001).
  1474     05  CRTCARRI PIC  X(0001).
  1475*    -------------------------------
  1476     05  GROUPL PIC S9(0004) COMP.
  1477     05  GROUPF PIC  X(0001).
  1478     05  FILLER REDEFINES GROUPF.
  1479         10  GROUPA PIC  X(0001).
  1480     05  GROUPI PIC  X(0006).
  1481*    -------------------------------
  1482     05  STATEL PIC S9(0004) COMP.
  1483     05  STATEF PIC  X(0001).
  1484     05  FILLER REDEFINES STATEF.
  1485         10  STATEA PIC  X(0001).
  1486     05  STATEI PIC  X(0002).
  1487*    -------------------------------
  1488     05  ACCOUNTL PIC S9(0004) COMP.
  1489     05  ACCOUNTF PIC  X(0001).
  1490     05  FILLER REDEFINES ACCOUNTF.
  1491         10  ACCOUNTA PIC  X(0001).
  1492     05  ACCOUNTI PIC  X(0010).
  1493*    -------------------------------
  1494     05  EFFDTL PIC S9(0004) COMP.
  1495     05  EFFDTF PIC  X(0001).
  1496     05  FILLER REDEFINES EFFDTF.
  1497         10  EFFDTA PIC  X(0001).
  1498     05  EFFDTI PIC  X(0008).
  1499*    -------------------------------
  1500     05  CRTSSNL PIC S9(0004) COMP.
  1501     05  CRTSSNF PIC  X(0001).
  1502     05  FILLER REDEFINES CRTSSNF.
  1503         10  CRTSSNA PIC  X(0001).
  1504     05  CRTSSNI PIC  X(0011).
  1505*    -------------------------------
  1506     05  MEMCAPL PIC S9(0004) COMP.
  1507     05  MEMCAPF PIC  X(0001).
  1508     05  FILLER REDEFINES MEMCAPF.
  1509         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  29
* EL130.cbl
  1510     05  MEMCAPI PIC  X(0010).
  1511*    -------------------------------
  1512     05  MEMBERL PIC S9(0004) COMP.
  1513     05  MEMBERF PIC  X(0001).
  1514     05  FILLER REDEFINES MEMBERF.
  1515         10  MEMBERA PIC  X(0001).
  1516     05  MEMBERI PIC  X(0012).
  1517*    -------------------------------
  1518     05  REINCDL PIC S9(0004) COMP.
  1519     05  REINCDF PIC  X(0001).
  1520     05  FILLER REDEFINES REINCDF.
  1521         10  REINCDA PIC  X(0001).
  1522     05  REINCDI PIC  X(0001).
  1523*    -------------------------------
  1524     05  ISSAGEL PIC S9(0004) COMP.
  1525     05  ISSAGEF PIC  X(0001).
  1526     05  FILLER REDEFINES ISSAGEF.
  1527         10  ISSAGEA PIC  X(0001).
  1528     05  ISSAGEI PIC  X(0002).
  1529*    -------------------------------
  1530     05  APRL PIC S9(0004) COMP.
  1531     05  APRF PIC  X(0001).
  1532     05  FILLER REDEFINES APRF.
  1533         10  APRA PIC  X(0001).
  1534     05  APRI PIC  9(4)V9(4).
  1535*    -------------------------------
  1536     05  PMTFREQL PIC S9(0004) COMP.
  1537     05  PMTFREQF PIC  X(0001).
  1538     05  FILLER REDEFINES PMTFREQF.
  1539         10  PMTFREQA PIC  X(0001).
  1540     05  PMTFREQI PIC  99.
  1541*    -------------------------------
  1542     05  INDGRPL PIC S9(0004) COMP.
  1543     05  INDGRPF PIC  X(0001).
  1544     05  FILLER REDEFINES INDGRPF.
  1545         10  INDGRPA PIC  X(0001).
  1546     05  INDGRPI PIC  X(0001).
  1547*    -------------------------------
  1548     05  PREMTYPL PIC S9(0004) COMP.
  1549     05  PREMTYPF PIC  X(0001).
  1550     05  FILLER REDEFINES PREMTYPF.
  1551         10  PREMTYPA PIC  X(0001).
  1552     05  PREMTYPI PIC  X(0001).
  1553*    -------------------------------
  1554     05  ADDONDTL PIC S9(0004) COMP.
  1555     05  ADDONDTF PIC  X(0001).
  1556     05  FILLER REDEFINES ADDONDTF.
  1557         10  ADDONDTA PIC  X(0001).
  1558     05  ADDONDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  JNTLNMEL PIC S9(0004) COMP.
  1561     05  JNTLNMEF PIC  X(0001).
  1562     05  FILLER REDEFINES JNTLNMEF.
  1563         10  JNTLNMEA PIC  X(0001).
  1564     05  JNTLNMEI PIC  X(0015).
  1565*    -------------------------------
  1566     05  JNTFNMEL PIC S9(0004) COMP.
  1567     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  30
* EL130.cbl
  1568     05  FILLER REDEFINES JNTFNMEF.
  1569         10  JNTFNMEA PIC  X(0001).
  1570     05  JNTFNMEI PIC  X(0002).
  1571*    -------------------------------
  1572     05  JNTINITL PIC S9(0004) COMP.
  1573     05  JNTINITF PIC  X(0001).
  1574     05  FILLER REDEFINES JNTINITF.
  1575         10  JNTINITA PIC  X(0001).
  1576     05  JNTINITI PIC  X(0001).
  1577*    -------------------------------
  1578     05  JNTAGEL PIC S9(0004) COMP.
  1579     05  JNTAGEF PIC  X(0001).
  1580     05  FILLER REDEFINES JNTAGEF.
  1581         10  JNTAGEA PIC  X(0001).
  1582     05  JNTAGEI PIC  X(0002).
  1583*    -------------------------------
  1584     05  LCVDSCRL PIC S9(0004) COMP.
  1585     05  LCVDSCRF PIC  X(0001).
  1586     05  FILLER REDEFINES LCVDSCRF.
  1587         10  LCVDSCRA PIC  X(0001).
  1588     05  LCVDSCRI PIC  X(0006).
  1589*    -------------------------------
  1590     05  LCVKINDL PIC S9(0004) COMP.
  1591     05  LCVKINDF PIC  X(0001).
  1592     05  FILLER REDEFINES LCVKINDF.
  1593         10  LCVKINDA PIC  X(0001).
  1594     05  LCVKINDI PIC  X(0003).
  1595*    -------------------------------
  1596     05  LCVCDL PIC S9(0004) COMP.
  1597     05  LCVCDF PIC  X(0001).
  1598     05  FILLER REDEFINES LCVCDF.
  1599         10  LCVCDA PIC  X(0001).
  1600     05  LCVCDI PIC  X(0002).
  1601*    -------------------------------
  1602     05  LCVOTRML PIC S9(0004) COMP.
  1603     05  LCVOTRMF PIC  X(0001).
  1604     05  FILLER REDEFINES LCVOTRMF.
  1605         10  LCVOTRMA PIC  X(0001).
  1606     05  LCVOTRMI PIC  999.
  1607*    -------------------------------
  1608     05  LCVRTRML PIC S9(0004) COMP.
  1609     05  LCVRTRMF PIC  X(0001).
  1610     05  FILLER REDEFINES LCVRTRMF.
  1611         10  LCVRTRMA PIC  X(0001).
  1612     05  LCVRTRMI PIC  X(0003).
  1613*    -------------------------------
  1614     05  LCVRATEL PIC S9(0004) COMP.
  1615     05  LCVRATEF PIC  X(0001).
  1616     05  FILLER REDEFINES LCVRATEF.
  1617         10  LCVRATEA PIC  X(0001).
  1618     05  LCVRATEI PIC  9999V99.
  1619*    -------------------------------
  1620     05  LCVBENEL PIC S9(0004) COMP.
  1621     05  LCVBENEF PIC  X(0001).
  1622     05  FILLER REDEFINES LCVBENEF.
  1623         10  LCVBENEA PIC  X(0001).
  1624     05  LCVBENEI PIC  9(9)V99.
  1625*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  31
* EL130.cbl
  1626     05  LCVFORML PIC S9(0004) COMP.
  1627     05  LCVFORMF PIC  X(0001).
  1628     05  FILLER REDEFINES LCVFORMF.
  1629         10  LCVFORMA PIC  X(0001).
  1630     05  LCVFORMI PIC  X(0012).
  1631*    -------------------------------
  1632     05  LCVCNDTL PIC S9(0004) COMP.
  1633     05  LCVCNDTF PIC  X(0001).
  1634     05  FILLER REDEFINES LCVCNDTF.
  1635         10  LCVCNDTA PIC  X(0001).
  1636     05  LCVCNDTI PIC  X(0008).
  1637*    -------------------------------
  1638     05  LCVEXITL PIC S9(0004) COMP.
  1639     05  LCVEXITF PIC  X(0001).
  1640     05  FILLER REDEFINES LCVEXITF.
  1641         10  LCVEXITA PIC  X(0001).
  1642     05  LCVEXITI PIC  X(0008).
  1643*    -------------------------------
  1644     05  LCVSTATL PIC S9(0004) COMP.
  1645     05  LCVSTATF PIC  X(0001).
  1646     05  FILLER REDEFINES LCVSTATF.
  1647         10  LCVSTATA PIC  X(0001).
  1648     05  LCVSTATI PIC  X(0006).
  1649*    -------------------------------
  1650     05  ACVDSCRL PIC S9(0004) COMP.
  1651     05  ACVDSCRF PIC  X(0001).
  1652     05  FILLER REDEFINES ACVDSCRF.
  1653         10  ACVDSCRA PIC  X(0001).
  1654     05  ACVDSCRI PIC  X(0006).
  1655*    -------------------------------
  1656     05  ACVKINDL PIC S9(0004) COMP.
  1657     05  ACVKINDF PIC  X(0001).
  1658     05  FILLER REDEFINES ACVKINDF.
  1659         10  ACVKINDA PIC  X(0001).
  1660     05  ACVKINDI PIC  X(0003).
  1661*    -------------------------------
  1662     05  ACVCDL PIC S9(0004) COMP.
  1663     05  ACVCDF PIC  X(0001).
  1664     05  FILLER REDEFINES ACVCDF.
  1665         10  ACVCDA PIC  X(0001).
  1666     05  ACVCDI PIC  X(0002).
  1667*    -------------------------------
  1668     05  ACVOTRML PIC S9(0004) COMP.
  1669     05  ACVOTRMF PIC  X(0001).
  1670     05  FILLER REDEFINES ACVOTRMF.
  1671         10  ACVOTRMA PIC  X(0001).
  1672     05  ACVOTRMI PIC  999.
  1673*    -------------------------------
  1674     05  ACVRTRML PIC S9(0004) COMP.
  1675     05  ACVRTRMF PIC  X(0001).
  1676     05  FILLER REDEFINES ACVRTRMF.
  1677         10  ACVRTRMA PIC  X(0001).
  1678     05  ACVRTRMI PIC  X(0003).
  1679*    -------------------------------
  1680     05  ACVRATEL PIC S9(0004) COMP.
  1681     05  ACVRATEF PIC  X(0001).
  1682     05  FILLER REDEFINES ACVRATEF.
  1683         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  32
* EL130.cbl
  1684     05  ACVRATEI PIC  9999V99.
  1685*    -------------------------------
  1686     05  ACVBENEL PIC S9(0004) COMP.
  1687     05  ACVBENEF PIC  X(0001).
  1688     05  FILLER REDEFINES ACVBENEF.
  1689         10  ACVBENEA PIC  X(0001).
  1690     05  ACVBENEI PIC  9(9)V99.
  1691*    -------------------------------
  1692     05  ACVFORML PIC S9(0004) COMP.
  1693     05  ACVFORMF PIC  X(0001).
  1694     05  FILLER REDEFINES ACVFORMF.
  1695         10  ACVFORMA PIC  X(0001).
  1696     05  ACVFORMI PIC  X(0012).
  1697*    -------------------------------
  1698     05  ACVCNDTL PIC S9(0004) COMP.
  1699     05  ACVCNDTF PIC  X(0001).
  1700     05  FILLER REDEFINES ACVCNDTF.
  1701         10  ACVCNDTA PIC  X(0001).
  1702     05  ACVCNDTI PIC  X(0008).
  1703*    -------------------------------
  1704     05  ACVEXITL PIC S9(0004) COMP.
  1705     05  ACVEXITF PIC  X(0001).
  1706     05  FILLER REDEFINES ACVEXITF.
  1707         10  ACVEXITA PIC  X(0001).
  1708     05  ACVEXITI PIC  X(0008).
  1709*    -------------------------------
  1710     05  ACVSTATL PIC S9(0004) COMP.
  1711     05  ACVSTATF PIC  X(0001).
  1712     05  FILLER REDEFINES ACVSTATF.
  1713         10  ACVSTATA PIC  X(0001).
  1714     05  ACVSTATI PIC  X(0006).
  1715*    -------------------------------
  1716     05  ERRMSG1L PIC S9(0004) COMP.
  1717     05  ERRMSG1F PIC  X(0001).
  1718     05  FILLER REDEFINES ERRMSG1F.
  1719         10  ERRMSG1A PIC  X(0001).
  1720     05  ERRMSG1I PIC  X(0072).
  1721*    -------------------------------
  1722     05  ERRMSG2L PIC S9(0004) COMP.
  1723     05  ERRMSG2F PIC  X(0001).
  1724     05  FILLER REDEFINES ERRMSG2F.
  1725         10  ERRMSG2A PIC  X(0001).
  1726     05  ERRMSG2I PIC  X(0072).
  1727*    -------------------------------
  1728     05  BCERT1L PIC S9(0004) COMP.
  1729     05  BCERT1F PIC  X(0001).
  1730     05  FILLER REDEFINES BCERT1F.
  1731         10  BCERT1A PIC  X(0001).
  1732     05  BCERT1I PIC  X(0010).
  1733*    -------------------------------
  1734     05  BSUFX1L PIC S9(0004) COMP.
  1735     05  BSUFX1F PIC  X(0001).
  1736     05  FILLER REDEFINES BSUFX1F.
  1737         10  BSUFX1A PIC  X(0001).
  1738     05  BSUFX1I PIC  X(0001).
  1739*    -------------------------------
  1740     05  BCERT2L PIC S9(0004) COMP.
  1741     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  33
* EL130.cbl
  1742     05  FILLER REDEFINES BCERT2F.
  1743         10  BCERT2A PIC  X(0001).
  1744     05  BCERT2I PIC  X(0010).
  1745*    -------------------------------
  1746     05  BSUFX2L PIC S9(0004) COMP.
  1747     05  BSUFX2F PIC  X(0001).
  1748     05  FILLER REDEFINES BSUFX2F.
  1749         10  BSUFX2A PIC  X(0001).
  1750     05  BSUFX2I PIC  X(0001).
  1751*    -------------------------------
  1752     05  BCERT3L PIC S9(0004) COMP.
  1753     05  BCERT3F PIC  X(0001).
  1754     05  FILLER REDEFINES BCERT3F.
  1755         10  BCERT3A PIC  X(0001).
  1756     05  BCERT3I PIC  X(0010).
  1757*    -------------------------------
  1758     05  BSUFX3L PIC S9(0004) COMP.
  1759     05  BSUFX3F PIC  X(0001).
  1760     05  FILLER REDEFINES BSUFX3F.
  1761         10  BSUFX3A PIC  X(0001).
  1762     05  BSUFX3I PIC  X(0001).
  1763*    -------------------------------
  1764     05  BCERT4L PIC S9(0004) COMP.
  1765     05  BCERT4F PIC  X(0001).
  1766     05  FILLER REDEFINES BCERT4F.
  1767         10  BCERT4A PIC  X(0001).
  1768     05  BCERT4I PIC  X(0010).
  1769*    -------------------------------
  1770     05  BSUFX4L PIC S9(0004) COMP.
  1771     05  BSUFX4F PIC  X(0001).
  1772     05  FILLER REDEFINES BSUFX4F.
  1773         10  BSUFX4A PIC  X(0001).
  1774     05  BSUFX4I PIC  X(0001).
  1775*    -------------------------------
  1776     05  BCERT5L PIC S9(0004) COMP.
  1777     05  BCERT5F PIC  X(0001).
  1778     05  FILLER REDEFINES BCERT5F.
  1779         10  BCERT5A PIC  X(0001).
  1780     05  BCERT5I PIC  X(0010).
  1781*    -------------------------------
  1782     05  BSUFX5L PIC S9(0004) COMP.
  1783     05  BSUFX5F PIC  X(0001).
  1784     05  FILLER REDEFINES BSUFX5F.
  1785         10  BSUFX5A PIC  X(0001).
  1786     05  BSUFX5I PIC  X(0001).
  1787*    -------------------------------
  1788     05  ENTERPFL PIC S9(0004) COMP.
  1789     05  ENTERPFF PIC  X(0001).
  1790     05  FILLER REDEFINES ENTERPFF.
  1791         10  ENTERPFA PIC  X(0001).
  1792     05  ENTERPFI PIC  99.
  1793*    -------------------------------
  1794     05  PF5L PIC S9(0004) COMP.
  1795     05  PF5F PIC  X(0001).
  1796     05  FILLER REDEFINES PF5F.
  1797         10  PF5A PIC  X(0001).
  1798     05  PF5I PIC  X(0013).
  1799 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  34
* EL130.cbl
  1800     05  FILLER            PIC  X(0012).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RUNDTEO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RUNTIMEO PIC  99.99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  COMPO PIC  X(0003).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  SEQUO PIC  X(0010).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  MAINTO PIC  X(0001).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CLMNOO PIC  X(0007).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CLMCARRO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CLMTYPEO PIC  X(0001).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CERTNOO PIC  X(0010).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  SUFXO PIC  X(0001).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  PCERTNOO PIC  X(0010).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PSUFXO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  INCURO PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  REPORTO PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  ICD1O PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  ICD2O PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  DIAGO PIC  X(0060).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  BENECDO PIC  X(0010).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  35
* EL130.cbl
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  SSNO PIC  X(0011).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  SEXO PIC  X(0001).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  INSTYPEO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  LSTNMEO PIC  X(0015).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  FSTNMEO PIC  X(0012).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  INITO PIC  X(0001).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  LOANNOO PIC  X(0008).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  CRTLNMEO PIC  X(0015).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  CRTFNMEO PIC  X(0012).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  CRTINITO PIC  X(0001).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  LOANBALO PIC  ZZZZZ9.99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  MANRSVO PIC  Z(5)9.99.
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  SUPVO PIC  X(0001).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  PRICDO PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PRODO PIC  X(0008).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  PRODCDO PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  FILETOO PIC  X(0004).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  PROCCDO PIC  X(0004).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  RELCLMO PIC  X(0007).
  1915*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  36
* EL130.cbl
  1916     05  FILLER            PIC  X(0003).
  1917     05  PRTOPTO PIC  X(0001).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  ALTPRTO PIC  X(0004).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  CERTMTO PIC  X(0001).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  CRTCARRO PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  GROUPO PIC  X(0006).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  STATEO PIC  X(0002).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ACCOUNTO PIC  X(0010).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  EFFDTO PIC  X(0008).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  CRTSSNO PIC  X(0011).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  MEMCAPO PIC  X(0010).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  MEMBERO PIC  X(0012).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  REINCDO PIC  X(0001).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  ISSAGEO PIC  X(0002).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  APRO PIC  9(3).9(4).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  PMTFREQO PIC  99.
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  INDGRPO PIC  X(0001).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  PREMTYPO PIC  X(0001).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  ADDONDTO PIC  X(0008).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  JNTLNMEO PIC  X(0015).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  37
* EL130.cbl
  1974     05  JNTFNMEO PIC  X(0002).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  JNTINITO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  JNTAGEO PIC  X(0002).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  LCVDSCRO PIC  X(0006).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  LCVKINDO PIC  X(0003).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  LCVCDO PIC  X(0002).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  LCVOTRMO PIC  999.
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVRTRMO PIC  ZZZ.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVRATEO PIC  ZZZ.ZZ.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVFORMO PIC  X(0012).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVCNDTO PIC  X(0008).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVEXITO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVSTATO PIC  X(0006).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  ACVDSCRO PIC  X(0006).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  ACVKINDO PIC  X(0003).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACVCDO PIC  X(0002).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ACVOTRMO PIC  999.
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVRTRMO PIC  ZZZ.
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  38
* EL130.cbl
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVFORMO PIC  X(0012).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVCNDTO PIC  X(0008).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVEXITO PIC  X(0008).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVSTATO PIC  X(0006).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ERRMSG1O PIC  X(0072).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ERRMSG2O PIC  X(0072).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  BCERT1O PIC  X(0010).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  BSUFX1O PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BCERT2O PIC  X(0010).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BSUFX2O PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BCERT3O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BSUFX3O PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BCERT4O PIC  X(0010).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BSUFX4O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BCERT5O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BSUFX5O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  ENTERPFO PIC  X(0002).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  PF5O PIC  X(0013).
  2089*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  39
* EL130.cbl
  2091*    COPY ELCDATE.
  2092******************************************************************
  2093*                                                                *
  2094*                                                                *
  2095*                            ELCDATE.                            *
  2096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2097*                            VMOD=2.003
  2098*                                                                *
  2099*                                                                *
  2100*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2101*                 LENGTH = 200                                   *
  2102******************************************************************
  2103
  2104 01  DATE-CONVERSION-DATA.
  2105     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2106     12  DC-OPTION-CODE                PIC X.
  2107         88  BIN-TO-GREG                VALUE ' '.
  2108         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2109         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2110         88  YMD-GREG-TO-BIN            VALUE '3'.
  2111         88  MDY-GREG-TO-BIN            VALUE '4'.
  2112         88  JULIAN-TO-BIN              VALUE '5'.
  2113         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2114         88  FIND-CENTURY               VALUE '7'.
  2115         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2116         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2117         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2118         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2119         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2120         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2121         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2122         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2123         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2124         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2125         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2126         88  BIN-3-TO-GREG              VALUE 'I'.
  2127         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2128         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2129         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2130         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2131         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2132         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2133         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2134         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2135         88  THREE-CHARACTER-BIN
  2136                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2137         88  GREGORIAN-TO-BIN
  2138                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2139         88  BIN-TO-GREGORIAN
  2140                  VALUES ' ' '1' 'I' '8' 'G'.
  2141         88  JULIAN-TO-BINARY
  2142                  VALUES '5' 'C' 'E' 'F'.
  2143     12  DC-ERROR-CODE                 PIC X.
  2144         88  NO-CONVERSION-ERROR        VALUE ' '.
  2145         88  DATE-CONVERSION-ERROR
  2146                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2147         88  DATE-IS-ZERO               VALUE '1'.
  2148         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  40
* EL130.cbl
  2149         88  DATE-IS-INVALID            VALUE '3'.
  2150         88  DATE1-GREATER-DATE2        VALUE '4'.
  2151         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2152         88  DATE-INVALID-OPTION        VALUE '9'.
  2153         88  INVALID-CENTURY            VALUE 'A'.
  2154         88  ONLY-CENTURY               VALUE 'B'.
  2155         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2156         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2157     12  DC-END-OF-MONTH               PIC X.
  2158         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2159     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2160         88  USE-NORMAL-PROCESS         VALUE ' '.
  2161         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2162         88  ADJUST-UP-100-YRS          VALUE '2'.
  2163     12  FILLER                        PIC X.
  2164     12  DC-CONVERSION-DATES.
  2165         16  DC-BIN-DATE-1             PIC XX.
  2166         16  DC-BIN-DATE-2             PIC XX.
  2167         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2168         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2169                       DC-GREG-DATE-1-EDIT.
  2170             20  DC-EDIT1-MONTH        PIC 99.
  2171             20  SLASH1-1              PIC X.
  2172             20  DC-EDIT1-DAY          PIC 99.
  2173             20  SLASH1-2              PIC X.
  2174             20  DC-EDIT1-YEAR         PIC 99.
  2175         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2176         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2177                     DC-GREG-DATE-2-EDIT.
  2178             20  DC-EDIT2-MONTH        PIC 99.
  2179             20  SLASH2-1              PIC X.
  2180             20  DC-EDIT2-DAY          PIC 99.
  2181             20  SLASH2-2              PIC X.
  2182             20  DC-EDIT2-YEAR         PIC 99.
  2183         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2184         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2185                     DC-GREG-DATE-1-YMD.
  2186             20  DC-YMD-YEAR           PIC 99.
  2187             20  DC-YMD-MONTH          PIC 99.
  2188             20  DC-YMD-DAY            PIC 99.
  2189         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2190         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2191                      DC-GREG-DATE-1-MDY.
  2192             20  DC-MDY-MONTH          PIC 99.
  2193             20  DC-MDY-DAY            PIC 99.
  2194             20  DC-MDY-YEAR           PIC 99.
  2195         16  DC-GREG-DATE-1-ALPHA.
  2196             20  DC-ALPHA-MONTH        PIC X(10).
  2197             20  DC-ALPHA-DAY          PIC 99.
  2198             20  FILLER                PIC XX.
  2199             20  DC-ALPHA-CENTURY.
  2200                 24 DC-ALPHA-CEN-N     PIC 99.
  2201             20  DC-ALPHA-YEAR         PIC 99.
  2202         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2203         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2204         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2205         16  DC-JULIAN-DATE            PIC 9(05).
  2206         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  41
* EL130.cbl
  2207                                       PIC 9(05).
  2208         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2209             20  DC-JULIAN-YEAR        PIC 99.
  2210             20  DC-JULIAN-DAYS        PIC 999.
  2211         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2212         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2213         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2214     12  DATE-CONVERSION-VARIBLES.
  2215         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2216         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2217             20  FILLER                PIC 9(3).
  2218             20  HOLD-CEN-1-CCYY.
  2219                 24  HOLD-CEN-1-CC     PIC 99.
  2220                 24  HOLD-CEN-1-YY     PIC 99.
  2221             20  HOLD-CEN-1-MO         PIC 99.
  2222             20  HOLD-CEN-1-DA         PIC 99.
  2223         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2224             20  HOLD-CEN-1-R-MO       PIC 99.
  2225             20  HOLD-CEN-1-R-DA       PIC 99.
  2226             20  HOLD-CEN-1-R-CCYY.
  2227                 24  HOLD-CEN-1-R-CC   PIC 99.
  2228                 24  HOLD-CEN-1-R-YY   PIC 99.
  2229             20  FILLER                PIC 9(3).
  2230         16  HOLD-CENTURY-1-X.
  2231             20  FILLER                PIC X(3)  VALUE SPACES.
  2232             20  HOLD-CEN-1-X-CCYY.
  2233                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2234                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2235             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2236             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2237         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2238             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2239             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2240             20  HOLD-CEN-1-R-X-CCYY.
  2241                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2242                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2243             20  FILLER                PIC XXX.
  2244         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2245         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2246         16  DC-JULIAN-DATE-1          PIC 9(07).
  2247         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2248             20  DC-JULIAN-1-CCYY.
  2249                 24  DC-JULIAN-1-CC    PIC 99.
  2250                 24  DC-JULIAN-1-YR    PIC 99.
  2251             20  DC-JULIAN-DA-1        PIC 999.
  2252         16  DC-JULIAN-DATE-2          PIC 9(07).
  2253         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2254             20  DC-JULIAN-2-CCYY.
  2255                 24  DC-JULIAN-2-CC    PIC 99.
  2256                 24  DC-JULIAN-2-YR    PIC 99.
  2257             20  DC-JULIAN-DA-2        PIC 999.
  2258         16  DC-GREG-DATE-A-EDIT.
  2259             20  DC-EDITA-MONTH        PIC 99.
  2260             20  SLASHA-1              PIC X VALUE '/'.
  2261             20  DC-EDITA-DAY          PIC 99.
  2262             20  SLASHA-2              PIC X VALUE '/'.
  2263             20  DC-EDITA-CCYY.
  2264                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  42
* EL130.cbl
  2265                 24  DC-EDITA-YEAR     PIC 99.
  2266         16  DC-GREG-DATE-B-EDIT.
  2267             20  DC-EDITB-MONTH        PIC 99.
  2268             20  SLASHB-1              PIC X VALUE '/'.
  2269             20  DC-EDITB-DAY          PIC 99.
  2270             20  SLASHB-2              PIC X VALUE '/'.
  2271             20  DC-EDITB-CCYY.
  2272                 24  DC-EDITB-CENT     PIC 99.
  2273                 24  DC-EDITB-YEAR     PIC 99.
  2274         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2275         16  DC-GREG-DATE-CYMD-R REDEFINES
  2276                              DC-GREG-DATE-CYMD.
  2277             20  DC-CYMD-CEN           PIC 99.
  2278             20  DC-CYMD-YEAR          PIC 99.
  2279             20  DC-CYMD-MONTH         PIC 99.
  2280             20  DC-CYMD-DAY           PIC 99.
  2281         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2282         16  DC-GREG-DATE-MDCY-R REDEFINES
  2283                              DC-GREG-DATE-MDCY.
  2284             20  DC-MDCY-MONTH         PIC 99.
  2285             20  DC-MDCY-DAY           PIC 99.
  2286             20  DC-MDCY-CEN           PIC 99.
  2287             20  DC-MDCY-YEAR          PIC 99.
  2288    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2289        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2290    12  DC-EL310-DATE                  PIC X(21).
  2291    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  43
* EL130.cbl
  2293*    COPY ELCCALC.
  2294******************************************************************
  2295*                                                                *
  2296*                           ELCCALC.                            *
  2297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2298*                            VMOD=2.025                          *
  2299*                                                                *
  2300*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2301*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2302*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2303*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2304*                                                                *
  2305*  PASSED TO ELRTRM                                              *
  2306*  -----------------                                             *
  2307*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2308*  ORIGINAL TERM                                                 *
  2309*  BEGINNING DATE                                                *
  2310*  ENDING DATE                                                   *
  2311*  COMPANY I.D.                                                  *
  2312*  ACCOUNT MASTER USER FIELD                                     *
  2313*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2314*  FREE LOOK DAYS                                                *
  2315*                                                                *
  2316*  RETURNED FROM ELRTRM                                          *
  2317*  ---------------------                                         *
  2318*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2319*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2320*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2321*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2322*----------------------------------------------------------------*
  2323*  PASSED TO ELRAMT                                              *
  2324*  ----------------                                              *
  2325*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2326*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2327*  ORIGINAL AMOUNT                                               *
  2328*  ALTERNATE BENEFIT (BALLON)                                    *
  2329*  A.P.R. - NET PAY ONLY                                         *
  2330*  METHOD
  2331*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2332*  COMPANY I.D.                                                  *
  2333*  BENEFIT TYPE                                                  *
  2334*                                                                *
  2335*  RETURNED FROM ELRAMT                                          *
  2336*  --------------------                                          *
  2337*  REMAINING AMOUNT 1 - CURRENT                                  *
  2338*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2339*  REMAINING AMOUNT FACTOR
  2340*----------------------------------------------------------------*
  2341*  PASSED TO ELRESV                                              *
  2342*  -----------------                                             *
  2343*  CERTIFICATE EFFECTIVE DATE                                    *
  2344*  VALUATION DATE                                                *
  2345*  PAID THRU DATE                                                *
  2346*  BENEFIT                                                       *
  2347*  INCURRED DATE                                                 *
  2348*  REPORTED DATE                                                 *
  2349*  ISSUE AGE                                                     *
  2350*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  44
* EL130.cbl
  2351*  CDT PERCENT                                                   *
  2352*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2353* *CLAIM TYPE (LIFE, A/H)                                        *
  2354* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2355* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2356*                                                                *
  2357*  RETURNED FROM ELRESV                                          *
  2358*  --------------------                                          *
  2359*  CDT TABLE USED                                                *
  2360*  CDT FACTOR USED                                               *
  2361*  PAY TO CURRENT RESERVE                                        *
  2362*  I.B.N.R. - A/H ONLY                                           *
  2363*  FUTURE (ACCRUED) AH ONLY                                      *
  2364*----------------------------------------------------------------*
  2365*  PASSED TO ELRATE                                              *
  2366*  ----------------                                              *
  2367*  CERT ISSUE DATE                                               *
  2368*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2369*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2370*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2371*  STATE CODE (CLIENT DEFINED)                                   *
  2372*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2373*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2374*  DEVIATION CODE                                                *
  2375*  ISSUE AGE                                                     *
  2376*  ORIGINAL BENEFIT AMOUNT                                       *
  2377*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2378*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2379*  BENEFIT KIND (LIFE OR A/H)                                    *
  2380*  A.P.R.                                                        *
  2381*  METHOD
  2382*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2383*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2384*  COMPANY I.D. (3 CHARACTER)                                    *
  2385*  BENEFIT CODE                                                  *
  2386*  BENEFIT OVERRIDE CODE                                         *
  2387*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2388*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2389*  JOINT INDICATOR (CSL ONLY)                                    *
  2390*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2391*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2392*                                                                *
  2393*  RETURNED FROM ELRATE                                          *
  2394*  --------------------                                          *
  2395*  CALCULATED PREMIUM                                            *
  2396*  PREMIUM RATE                                                  *
  2397*  MORTALITY CODE                                                *
  2398*  MAX ATTAINED AGE                                              *
  2399*  MAX AGE                                                       *
  2400*  MAX TERM                                                      *
  2401*  MAX MONTHLY BENEFIT                                           *
  2402*  MAX TOTAL BENIFIT                                             *
  2403*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2404*----------------------------------------------------------------*
  2405*  PASSED TO ELRFND                                              *
  2406*  ----------------                                              *
  2407*  CERT ISSUE DATE                                               *
  2408*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  45
* EL130.cbl
  2409*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2410*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2411*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2412*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2413*  STATE CODE (CLIENT DEFINED)                                   *
  2414*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2415*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2416*  DEVIATION CODE                                                *
  2417*  ISSUE AGE                                                     *
  2418*  ORIGINAL BENEFIT AMOUNT                                       *
  2419*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2420*  PROCESS TYPE (CANCEL)                                         *
  2421*  BENEFIT KIND (LIFE OR A/H)                                    *
  2422*  A.P.R.                                                        *
  2423*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2424*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2425*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2426*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2427*  COMPANY I.D. (3 CHARACTER)                                    *
  2428*  BENEFIT CODE                                                  *
  2429*  BENEFIT OVERRIDE CODE                                         *
  2430*                                                                *
  2431*  RETURNED FROM ELRFND                                          *
  2432*  --------------------                                          *
  2433*  CALCULATED REFUND                                             *
  2434*----------------------------------------------------------------*
  2435*  PASSED TO ELEARN                                              *
  2436*  ----------------                                              *
  2437*  CERT ISSUE DATE                                               *
  2438*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2439*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2440*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2441*  STATE CODE (CLIENT DEFINED)                                   *
  2442*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2443*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2444*  DEVIATION CODE                                                *
  2445*  ISSUE AGE                                                     *
  2446*  ORIGINAL BENEFIT AMOUNT                                       *
  2447*  BENEFIT KIND (LIFE OR A/H)                                    *
  2448*  A.P.R.                                                        *
  2449*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2450*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2451*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2452*  COMPANY I.D. (3 CHARACTER)                                    *
  2453*  BENEFIT CODE                                                  *
  2454*  BENEFIT OVERRIDE CODE                                         *
  2455*                                                                *
  2456*  RETURNED FROM ELEARN                                          *
  2457*  --------------------                                          *
  2458*  INDICATED  EARNINGS                                           *
  2459*----------------------------------------------------------------*
  2460*                 LENGTH = 450                                   *
  2461*                                                                *
  2462******************************************************************
  2463******************************************************************
  2464*                   C H A N G E   L O G
  2465*
  2466* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  46
* EL130.cbl
  2467*-----------------------------------------------------------------
  2468*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2469* EFFECTIVE    NUMBER
  2470*-----------------------------------------------------------------
  2471* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2472* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2473* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2474* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2475* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2476* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2477* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2478* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2479* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2480* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2481* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2482******************************************************************
  2483
  2484 01  CALCULATION-PASS-AREA.
  2485     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2486                                     COMP.
  2487
  2488     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2489       88  NO-CP-ERROR                             VALUE ZERO.
  2490       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2491                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2492       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2493       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2494       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2495       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2496       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2497       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2498       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2499       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2500       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2501       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2502       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2503       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2504       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2505       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2506       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2507       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2508       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2509
  2510     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2511       88  NO-CP-ERROR-2                           VALUE ZERO.
  2512***********************  INPUT AREAS ****************************
  2513
  2514     12  CP-CALCULATION-AREA.
  2515         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2516         16  CP-CERT-EFF-DT        PIC XX.
  2517         16  CP-VALUATION-DT       PIC XX.
  2518         16  CP-PAID-THRU-DT       PIC XX.
  2519         16  CP-BENEFIT-TYPE       PIC X.
  2520           88  CP-AH                               VALUE 'A' 'D'
  2521                                                   'I' 'U'.
  2522           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2523           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2524         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  47
* EL130.cbl
  2525         16  CP-REPORTED-DT        PIC XX.
  2526         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2527         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2528         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2529                                     COMP-3.
  2530         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2531                                     COMP-3.
  2532         16  CP-CDT-METHOD         PIC X.
  2533           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2534           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2535           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2536         16  CP-CLAIM-TYPE         PIC X.
  2537           88  CP-AH-CLAIM                         VALUE 'A'.
  2538           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2539         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2540                                     COMP-3.
  2541         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2542                                     COMP-3.
  2543         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-REM-TERM-METHOD    PIC X.
  2554           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2555           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2556           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2557           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2558           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2559           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2560           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2561         16  CP-EARNING-METHOD     PIC X.
  2562           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2563           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2564           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2565           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2566           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2567           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2568           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2569           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2570           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2571           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2572           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2573           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2574           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2575           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2576         16  CP-PROCESS-TYPE       PIC X.
  2577           88  CP-CLAIM                            VALUE '1'.
  2578           88  CP-CANCEL                           VALUE '2'.
  2579           88  CP-ISSUE                            VALUE '3'.
  2580         16  CP-SPECIAL-CALC-CD    PIC X.
  2581           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2582           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  48
* EL130.cbl
  2583           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2584           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2585           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2586           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2587           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2588           88  CP-FARM-PLAN                    VALUE 'F'.
  2589           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2590           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2591           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2592           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2593           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2594           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2595           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2596           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2597           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2598           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2599                                                     'W' 'X'.
  2600           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2601           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2602           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2603           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2604           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2605           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2606           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2607           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2608           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2609           88  CP-CSL-METH-1                   VALUE '5'.
  2610           88  CP-CSL-METH-2                   VALUE '6'.
  2611           88  CP-CSL-METH-3                   VALUE '7'.
  2612           88  CP-CSL-METH-4                   VALUE '8'.
  2613
  2614         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2615                                     COMP-3.
  2616         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2617         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2618         16  CP-STATE              PIC XX          VALUE SPACE.
  2619         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2620         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2621           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2622               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2623         16  CP-R78-OPTION         PIC X.
  2624           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2625           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2626
  2627         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2628         16  CP-IBNR-RESERVE-SW    PIC X.
  2629         16  CP-CLAIM-STATUS       PIC X.
  2630         16  CP-RATE-FILE          PIC X.
  2631         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2632                                     COMP-3.
  2633
  2634         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2635         16  CP-AH-OVERRIDE-CODE   PIC X.
  2636
  2637         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2640                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  49
* EL130.cbl
  2641         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2648                                  PIC S9(7)V99 COMP-3.
  2649
  2650         16  CP-PAID-FROM-DATE     PIC X(02).
  2651         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2652         16  CP-EXT-DAYS-CALC      PIC X.
  2653           88  CP-EXT-NO-CHG                   VALUE ' '.
  2654           88  CP-EXT-CHG-LF                   VALUE '1'.
  2655           88  CP-EXT-CHG-AH                   VALUE '2'.
  2656           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2657         16  CP-DOMICILE-STATE     PIC XX.
  2658         16  CP-CARRIER            PIC X.
  2659         16  CP-REIN-FLAG          PIC X.
  2660         16  CP-REM-TRM-CALC-OPTION PIC X.
  2661           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2662                      '2' '3' '4' '5'.
  2663           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2664           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2665           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2666           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2667           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2668           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2669           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2670           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2671         16  CP-SIG-SWITCH         PIC X.
  2672         16  CP-RATING-METHOD      PIC X.
  2673           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2674           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2675           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2676           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2677           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2678           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2679           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2680           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2681           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2682         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2683                                     COMP-3.
  2684         16  CP-BEN-CATEGORY       PIC X.
  2685         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2686         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2687                                   PIC S99V9(5) COMP-3.
  2688         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2689         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2690                                   PIC S99V9(5) COMP-3.
  2691         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2692         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2693         16  CP-EXPIRE-DT          PIC XX.
  2694         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2695         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2696         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2697         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2698         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  50
* EL130.cbl
  2699             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2700             88  CP-CALC-CLP              VALUE 'C'.
  2701         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2702         16  CP-CANCEL-REASON      PIC X.
  2703         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2704         16  CP-PMT-MODE           PIC X.
  2705         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2706         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2707         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2708         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2709         16  FILLER                PIC X.
  2710
  2711***************    OUTPUT FROM ELRESV   ************************
  2712
  2713         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2714
  2715         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2722                                     COMP-3.
  2723         16  FILLER                PIC X(09).
  2724***************    OUTPUT FROM ELRTRM   *************************
  2725
  2726         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2727                                     COMP-3.
  2728         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2729                                     COMP-3.
  2730         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2733                                     COMP-3.
  2734         16  FILLER                PIC X(12).
  2735
  2736***************    OUTPUT FROM ELRAMT   *************************
  2737
  2738         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2741                                     COMP-3.
  2742         16  FILLER                PIC X(12).
  2743
  2744***************    OUTPUT FROM ELRATE   *************************
  2745
  2746         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2747                                     COMP-3.
  2748         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-MORTALITY-CODE     PIC X(4).
  2751         16  CP-RATE-EDIT-FLAG     PIC X.
  2752             88  CP-RATES-NEED-APR                  VALUE '1'.
  2753         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2754                                     COMP-3.
  2755         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2756         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  51
* EL130.cbl
  2757         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2758                                   PIC S9(7)V99 COMP-3.
  2759         16  FILLER                PIC X(07).
  2760
  2761***************    OUTPUT FROM ELRFND   *************************
  2762
  2763         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2764                                     COMP-3.
  2765         16  CP-REFUND-TYPE-USED   PIC X.
  2766           88  CP-R-AS-R78                         VALUE '1'.
  2767           88  CP-R-AS-PRORATA                     VALUE '2'.
  2768           88  CP-R-AS-CALIF                       VALUE '3'.
  2769           88  CP-R-AS-TEXAS                       VALUE '4'.
  2770           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2771           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2772           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2773           88  CP-R-AS-MEAN                        VALUE '8'.
  2774           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2775           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2776           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2777           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2778           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2779           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2780         16  FILLER                PIC X(12).
  2781
  2782***************    OUTPUT FROM ELEARN   *************************
  2783
  2784         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2795                                     COMP-3.
  2796         16  CP-EARNING-TYPE-USED  PIC X.
  2797           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2798           88  CP-E-AS-R78                         VALUE '1'.
  2799           88  CP-E-AS-PRORATA                     VALUE '2'.
  2800           88  CP-E-AS-TEXAS                       VALUE '4'.
  2801           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2802           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2803           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2804           88  CP-E-AS-MEAN                        VALUE '8'.
  2805           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2806         16  FILLER                PIC X(12).
  2807
  2808***************    OUTPUT FROM ELPMNT   *************************
  2809
  2810         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2811                                     COMP-3.
  2812         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2813                                     COMP-3.
  2814         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  52
* EL130.cbl
  2815
  2816***************   MISC WORK AREAS    *****************************
  2817         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2828                                     COMP-3.
  2829         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2830             88  OPEN-RATE-FILE                   VALUE 'O'.
  2831             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2832             88  IO-ERROR                         VALUE 'E'.
  2833
  2834         16  CP-FIRST-PAY-DATE     PIC XX.
  2835
  2836         16  CP-JOINT-INDICATOR    PIC X.
  2837
  2838         16  CP-RESERVE-REMAINING-TERM
  2839                                   PIC S9(4)V9    VALUE ZERO
  2840                                     COMP-3.
  2841
  2842         16  CP-INSURED-BIRTH-DT   PIC XX.
  2843
  2844         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2845                                     COMP-3.
  2846
  2847         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2848                                     COMP-3.
  2849
  2850         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2851                                     COMP-3.
  2852
  2853         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2854                                     COMP-3.
  2855
  2856         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2857                                     COMP-3.
  2858
  2859         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2860                                     COMP-3.
  2861
  2862         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2863                                     COMP-3.
  2864
  2865         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2866             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2867
  2868         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2869                                     COMP-3.
  2870         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2871                                     COMP-3.
  2872         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  53
* EL130.cbl
  2873         16  cp-extra-periods      pic 9 value zeros.
  2874         16  cp-net-only-state     pic x value spaces.
  2875         16  FILLER                PIC X(13).
  2876******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  54
* EL130.cbl
  2878*    COPY ELCLOGOF.
  2879******************************************************************
  2880*                                                                *
  2881*                                                                *
  2882*                            ELCLOGOF.                           *
  2883*                            VMOD=2.001                          *
  2884*                                                                *
  2885*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2886*                                                                *
  2887******************************************************************
  2888 01  CLASIC-LOGOFF.
  2889     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2890     12  LOGOFF-TEXT.
  2891         16  FILLER          PIC X(5)    VALUE SPACES.
  2892         16  LOGOFF-MSG.
  2893             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2894             20  FILLER      PIC X       VALUE SPACES.
  2895             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2896         16  FILLER          PIC X(80)
  2897           VALUE '* YOU ARE NOW LOGGED OFF'.
  2898         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2899         16  FILLER          PIC X       VALUE QUOTE.
  2900         16  LOGOFF-SYS-MSG  PIC X(17)
  2901           VALUE 'S CLAS-IC SYSTEM '.
  2902     12  TEXT-MESSAGES.
  2903         16  UNACCESS-MSG    PIC X(29)
  2904             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2905         16  PGMIDERR-MSG    PIC X(17)
  2906             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  55
* EL130.cbl
  2908*    COPY ELCATTR.
  2909******************************************************************
  2910*                                                                *
  2911*                            ELCATTR.                            *
  2912*                            VMOD=2.001                          *
  2913*                                                                *
  2914*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2915*                                                                *
  2916*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2917*                                                                *
  2918*                   POS 1   P=PROTECTED                          *
  2919*                           U=UNPROTECTED                        *
  2920*                           S=ASKIP                              *
  2921*                   POS 2   A=ALPHA/NUMERIC                      *
  2922*                           N=NUMERIC                            *
  2923*                   POS 3   N=NORMAL                             *
  2924*                           B=BRIGHT                             *
  2925*                           D=DARK                               *
  2926*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2927*                           OF=MODIFIED DATA TAG OFF             *
  2928*                                                                *
  2929*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2930******************************************************************
  2931 01  ATTRIBUTE-LIST.
  2932     12  AL-PABOF            PIC X       VALUE 'Y'.
  2933     12  AL-PABON            PIC X       VALUE 'Z'.
  2934     12  AL-PADOF            PIC X       VALUE '%'.
  2935     12  AL-PADON            PIC X       VALUE '_'.
  2936     12  AL-PANOF            PIC X       VALUE '-'.
  2937     12  AL-PANON            PIC X       VALUE '/'.
  2938     12  AL-SABOF            PIC X       VALUE '8'.
  2939     12  AL-SABON            PIC X       VALUE '9'.
  2940     12  AL-SADOF            PIC X       VALUE '@'.
  2941     12  AL-SADON            PIC X       VALUE QUOTE.
  2942     12  AL-SANOF            PIC X       VALUE '0'.
  2943     12  AL-SANON            PIC X       VALUE '1'.
  2944     12  AL-UABOF            PIC X       VALUE 'H'.
  2945     12  AL-UABON            PIC X       VALUE 'I'.
  2946     12  AL-UADOF            PIC X       VALUE '<'.
  2947     12  AL-UADON            PIC X       VALUE '('.
  2948     12  AL-UANOF            PIC X       VALUE ' '.
  2949     12  AL-UANON            PIC X       VALUE 'A'.
  2950     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2951     12  AL-UNBON            PIC X       VALUE 'R'.
  2952     12  AL-UNDOF            PIC X       VALUE '*'.
  2953     12  AL-UNDON            PIC X       VALUE ')'.
  2954     12  AL-UNNOF            PIC X       VALUE '&'.
  2955     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  56
* EL130.cbl
  2957*    COPY ELCEMIB.
  2958******************************************************************
  2959*                                                                *
  2960*                                                                *
  2961*                            ELCEMIB.                            *
  2962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2963*                            VMOD=2.005                          *
  2964*                                                                *
  2965*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2966*                                                                *
  2967******************************************************************
  2968 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2969     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2970     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2971     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2972     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2973     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2974     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2975     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2976     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2977     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2978         88  EMI-NO-ERRORS                    VALUE '1'.
  2979         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2980         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2981     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2982         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2983     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2984         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2985         88  EMI-AREA1-FULL                   VALUE '2'.
  2986     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2987         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2988         88  EMI-AREA2-FULL                   VALUE '2'.
  2989     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2990         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2991         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2992         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2993         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2994         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2995     12  EMI-ERROR-LINES.
  2996         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2997         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2998         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2999         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3000             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3001                 24  EMI-ERR-NUM         PIC X(4).
  3002                 24  EMI-FILLER          PIC X.
  3003                 24  EMI-SEV             PIC X.
  3004                 24  FILLER              PIC X.
  3005             20  FILLER                  PIC X(02).
  3006     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3007         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3008             20  EMI-ERROR-NUMBER    PIC X(4).
  3009             20  EMI-FILL            PIC X.
  3010             20  EMI-SEVERITY        PIC X.
  3011             20  FILLER              PIC X.
  3012             20  EMI-ERROR-TEXT.
  3013                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3014                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  57
* EL130.cbl
  3015     12  EMI-SEVERITY-SAVE           PIC X.
  3016         88  EMI-NOTE                    VALUE 'N'.
  3017         88  EMI-WARNING                 VALUE 'W'.
  3018         88  EMI-FORCABLE                VALUE 'F'.
  3019         88  EMI-FATAL                   VALUE 'X'.
  3020     12  EMI-MESSAGE-FLAG            PIC X.
  3021         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3022         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3023     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3024     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3025         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3026         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3027         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3028     12  emi-claim-no                pic x(7).
  3029     12  emi-claim-type              pic x(6).
  3030     12  FILLER                      PIC X(124)  VALUE SPACES.
  3031     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3032     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3033     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3034     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  58
* EL130.cbl
  3036*    COPY ELCJPFX.
  3037******************************************************************
  3038*                                                                *
  3039*                                                                *
  3040*                            ELCJPFX.                            *
  3041*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3042*                            VMOD=2.002                          *
  3043*                                                                *
  3044*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3045*                                                                *
  3046*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3047*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3048*        ELCNTL - CONTROL FILE                                   *
  3049*        ELMSTR - CLAIM MASTERS                                  *
  3050*        ELTRLR - ACTIVITY TRAILERS                              *
  3051*        ELCHKQ - CHECK QUE                                      *
  3052******************************************************************
  3053 01  JOURNAL-RECORD.
  3054     12  jp-date                     pic s9(5) comp-3.
  3055     12  jp-time                     pic s9(7) comp-3.
  3056     12  JP-USER-ID                  PIC X(4).
  3057     12  JP-FILE-ID                  PIC X(8).
  3058     12  JP-PROGRAM-ID               PIC X(8).
  3059     12  JP-RECORD-TYPE              PIC X.
  3060         88 JP-ADD              VALUE 'A'.
  3061         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3062         88 JP-AFTER-CHANGE     VALUE 'C'.
  3063         88 JP-DELETE           VALUE 'D'.
  3064         88 JP-GENERIC-DELETE   VALUE 'G'.
  3065         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3066         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3067     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3068     12  JP-RECORD-AREA
  3069
  3070
  3071         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  59
* EL130.cbl
  3073*    COPY ELCAID.
  3074******************************************************************
  3075*                                                                *
  3076*                            ELCAID.                             *
  3077*                            VMOD=2.001                          *
  3078*                                                                *
  3079*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3080*                                                                *
  3081*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3082*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3083******************************************************************
  3084
  3085 01  DFHAID.
  3086   02  DFHNULL   PIC  X  VALUE  ' '.
  3087   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3088   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3089   02  DFHPEN    PIC  X  VALUE  '='.
  3090   02  DFHOPID   PIC  X  VALUE  'W'.
  3091   02  DFHPA1    PIC  X  VALUE  '%'.
  3092   02  DFHPA2    PIC  X  VALUE  '>'.
  3093   02  DFHPA3    PIC  X  VALUE  ','.
  3094   02  DFHPF1    PIC  X  VALUE  '1'.
  3095   02  DFHPF2    PIC  X  VALUE  '2'.
  3096   02  DFHPF3    PIC  X  VALUE  '3'.
  3097   02  DFHPF4    PIC  X  VALUE  '4'.
  3098   02  DFHPF5    PIC  X  VALUE  '5'.
  3099   02  DFHPF6    PIC  X  VALUE  '6'.
  3100   02  DFHPF7    PIC  X  VALUE  '7'.
  3101   02  DFHPF8    PIC  X  VALUE  '8'.
  3102   02  DFHPF9    PIC  X  VALUE  '9'.
  3103   02  DFHPF10   PIC  X  VALUE  ':'.
  3104   02  DFHPF11   PIC  X  VALUE  '#'.
  3105   02  DFHPF12   PIC  X  VALUE  '@'.
  3106   02  DFHPF13   PIC  X  VALUE  'A'.
  3107   02  DFHPF14   PIC  X  VALUE  'B'.
  3108   02  DFHPF15   PIC  X  VALUE  'C'.
  3109   02  DFHPF16   PIC  X  VALUE  'D'.
  3110   02  DFHPF17   PIC  X  VALUE  'E'.
  3111   02  DFHPF18   PIC  X  VALUE  'F'.
  3112   02  DFHPF19   PIC  X  VALUE  'G'.
  3113   02  DFHPF20   PIC  X  VALUE  'H'.
  3114   02  DFHPF21   PIC  X  VALUE  'I'.
  3115*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3116   02  DFHPF22   PIC  X  VALUE  '['.
  3117   02  DFHPF23   PIC  X  VALUE  '.'.
  3118   02  DFHPF24   PIC  X  VALUE  '<'.
  3119   02  DFHMSRE   PIC  X  VALUE  'X'.
  3120   02  DFHSTRF   PIC  X  VALUE  'h'.
  3121   02  DFHTRIG   PIC  X  VALUE  '"'.
  3122
  3123 01  FILLER    REDEFINES DFHAID.
  3124     12  FILLER              PIC X(8).
  3125     12  PF-VALUES           PIC X       OCCURS 12.
  3126
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  60
* EL130.cbl
  3128****************************************************************
  3129*
  3130* Copyright (c) 2007 by Clerity Solutions, Inc.
  3131* All rights reserved.
  3132*
  3133****************************************************************
  3134 01  DFHEIV.
  3135   02  DFHEIV0               PIC X(35).
  3136   02  DFHEIV1               PIC X(08).
  3137   02  DFHEIV2               PIC X(08).
  3138   02  DFHEIV3               PIC X(08).
  3139   02  DFHEIV4               PIC X(06).
  3140   02  DFHEIV5               PIC X(04).
  3141   02  DFHEIV6               PIC X(04).
  3142   02  DFHEIV7               PIC X(02).
  3143   02  DFHEIV8               PIC X(02).
  3144   02  DFHEIV9               PIC X(01).
  3145   02  DFHEIV10              PIC S9(7) COMP-3.
  3146   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3147   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3148   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3149   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3150   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3151   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3152   02  DFHEIV17              PIC X(04).
  3153   02  DFHEIV18              PIC X(04).
  3154   02  DFHEIV19              PIC X(04).
  3155   02  DFHEIV20              USAGE IS POINTER.
  3156   02  DFHEIV21              USAGE IS POINTER.
  3157   02  DFHEIV22              USAGE IS POINTER.
  3158   02  DFHEIV23              USAGE IS POINTER.
  3159   02  DFHEIV24              USAGE IS POINTER.
  3160   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3161   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3162   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3163   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3164   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3165   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3166   02  FILLER                PIC X(02).
  3167   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3168   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3169   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3170   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3171   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3172 LINKAGE  SECTION.
  3173*****************************************************************
  3174*                                                               *
  3175* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3176* All rights reserved.                                          *
  3177*                                                               *
  3178*****************************************************************
  3179 01  dfheiblk.
  3180     02  eibtime          pic s9(7) comp-3.
  3181     02  eibdate          pic s9(7) comp-3.
  3182     02  eibtrnid         pic x(4).
  3183     02  eibtaskn         pic s9(7) comp-3.
  3184     02  eibtrmid         pic x(4).
  3185     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  61
* EL130.cbl
  3186     02  eibcposn         pic s9(4) comp.
  3187     02  eibcalen         pic s9(4) comp.
  3188     02  eibaid           pic x(1).
  3189     02  eibfiller1       pic x(1).
  3190     02  eibfn            pic x(2).
  3191     02  eibfiller2       pic x(2).
  3192     02  eibrcode         pic x(6).
  3193     02  eibfiller3       pic x(2).
  3194     02  eibds            pic x(8).
  3195     02  eibreqid         pic x(8).
  3196     02  eibrsrce         pic x(8).
  3197     02  eibsync          pic x(1).
  3198     02  eibfree          pic x(1).
  3199     02  eibrecv          pic x(1).
  3200     02  eibsend          pic x(1).
  3201     02  eibatt           pic x(1).
  3202     02  eibeoc           pic x(1).
  3203     02  eibfmh           pic x(1).
  3204     02  eibcompl         pic x(1).
  3205     02  eibsig           pic x(1).
  3206     02  eibconf          pic x(1).
  3207     02  eiberr           pic x(1).
  3208     02  eibrldbk         pic x(1).
  3209     02  eiberrcd         pic x(4).
  3210     02  eibsynrb         pic x(1).
  3211     02  eibnodat         pic x(1).
  3212     02  eibfiller5       pic x(2).
  3213     02  eibresp          pic 9(09) comp.
  3214     02  eibresp2         pic 9(09) comp.
  3215     02  dfheigdj         pic s9(4) comp.
  3216     02  dfheigdk         pic s9(4) comp.
  3217
  3218 01  DFHCOMMAREA             PIC X(1024).
  3219
  3220*01 PARMLIST .
  3221*    02  FILLER              PIC S9(8)   COMP.
  3222*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3223*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3224*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3225*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3226*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3227*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3228*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3229*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3230*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  62
* EL130.cbl
  3232*    COPY ELCMSTR.
  3233******************************************************************
  3234*                                                                *
  3235*                            ELCMSTR.                            *
  3236*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3237*                            VMOD=2.012                          *
  3238*                                                                *
  3239*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3240*                                                                *
  3241*   FILE TYPE = VSAM,KSDS                                        *
  3242*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3243*                                                                *
  3244*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3245*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3246*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3247*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3248*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3249*                                                 RKP=75,LEN=21  *
  3250*                                                                *
  3251*   **** NOTE ****                                               *
  3252*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3253*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3254*                                                                *
  3255*   LOG = YES                                                    *
  3256*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3257******************************************************************
  3258*                   C H A N G E   L O G
  3259*
  3260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3261*-----------------------------------------------------------------
  3262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3263* EFFECTIVE    NUMBER
  3264*-----------------------------------------------------------------
  3265* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3266* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3267* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3268* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3269* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3270******************************************************************
  3271 01  CLAIM-MASTER.
  3272     12  CL-RECORD-ID                PIC XX.
  3273         88  VALID-CL-ID         VALUE 'CL'.
  3274
  3275     12  CL-CONTROL-PRIMARY.
  3276         16  CL-COMPANY-CD           PIC X.
  3277         16  CL-CARRIER              PIC X.
  3278         16  CL-CLAIM-NO             PIC X(7).
  3279         16  CL-CERT-NO.
  3280             20  CL-CERT-PRIME       PIC X(10).
  3281             20  CL-CERT-SFX         PIC X.
  3282
  3283     12  CL-CONTROL-BY-NAME.
  3284         16  CL-COMPANY-CD-A1        PIC X.
  3285         16  CL-INSURED-LAST-NAME    PIC X(15).
  3286         16  CL-INSURED-NAME.
  3287             20  CL-INSURED-1ST-NAME PIC X(12).
  3288             20  CL-INSURED-MID-INIT PIC X.
  3289
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  63
* EL130.cbl
  3290     12  CL-CONTROL-BY-SSN.
  3291         16  CL-COMPANY-CD-A2        PIC X.
  3292         16  CL-SOC-SEC-NO.
  3293             20  CL-SSN-STATE        PIC XX.
  3294             20  CL-SSN-ACCOUNT      PIC X(6).
  3295             20  CL-SSN-LN3          PIC X(3).
  3296
  3297     12  CL-CONTROL-BY-CERT-NO.
  3298         16  CL-COMPANY-CD-A4        PIC X.
  3299         16  CL-CERT-NO-A4.
  3300             20  CL-CERT-A4-PRIME    PIC X(10).
  3301             20  CL-CERT-A4-SFX      PIC X.
  3302
  3303     12  CL-CONTROL-BY-CCN.
  3304         16  CL-COMPANY-CD-A5        PIC X.
  3305         16  CL-CCN-A5.
  3306             20  CL-CCN.
  3307                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3308                 24  CL-CCN-PRIME-A5 PIC X(12).
  3309             20  CL-CCN-FILLER-A5    PIC X(4).
  3310
  3311     12  CL-INSURED-PROFILE-DATA.
  3312         16  CL-INSURED-BIRTH-DT     PIC XX.
  3313         16  CL-INSURED-SEX-CD       PIC X.
  3314             88  INSURED-IS-MALE        VALUE 'M'.
  3315             88  INSURED-IS-FEMALE      VALUE 'F'.
  3316             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3317         16  CL-INSURED-OCC-CD       PIC X(6).
  3318         16  FILLER                  PIC X(5).
  3319
  3320     12  CL-PROCESSING-INFO.
  3321         16  CL-PROCESSOR-ID         PIC X(4).
  3322         16  CL-CLAIM-STATUS         PIC X.
  3323             88  CLAIM-IS-OPEN          VALUE 'O'.
  3324             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3325         16  CL-CLAIM-TYPE           PIC X.
  3326*            88  AH-CLAIM               VALUE 'A'.
  3327*            88  LIFE-CLAIM             VALUE 'L'.
  3328*            88  PROPERTY-CLAIM         VALUE 'P'.
  3329*            88  IUI-CLAIM              VALUE 'I'.
  3330*            88  GAP-CLAIM              VALUE 'G'.
  3331*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3332         16  CL-CLAIM-PREM-TYPE      PIC X.
  3333             88  SINGLE-PREMIUM         VALUE '1'.
  3334             88  O-B-COVERAGE           VALUE '2'.
  3335             88  OPEN-END-COVERAGE      VALUE '3'.
  3336         16  CL-INCURRED-DT          PIC XX.
  3337         16  CL-REPORTED-DT          PIC XX.
  3338         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3339         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3340         16  CL-LAST-PMT-DT          PIC XX.
  3341         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3342         16  CL-PAID-THRU-DT         PIC XX.
  3343         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3344         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3345         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3346         16  CL-PMT-CALC-METHOD      PIC X.
  3347             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  64
* EL130.cbl
  3348             88  CL-365-DAY-YR          VALUE '2'.
  3349             88  CL-FULL-MONTHS         VALUE '3'.
  3350         16  CL-CAUSE-CD             PIC X(6).
  3351
  3352         16  CL-PRIME-CERT-NO.
  3353             20  CL-PRIME-CERT-PRIME PIC X(10).
  3354             20  CL-PRIME-CERT-SFX   PIC X.
  3355
  3356         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3357             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3358             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3359
  3360         16  CL-MICROFILM-NO         PIC X(10).
  3361         16  FILLER REDEFINES CL-MICROFILM-NO.
  3362             20  CL-BENEFIT-PERIOD   PIC 99.
  3363             20  FILLER              PIC X(8).
  3364         16  CL-PROG-FORM-TYPE       PIC X.
  3365         16  CL-LAST-ADD-ON-DT       PIC XX.
  3366
  3367         16  CL-LAST-REOPEN-DT       PIC XX.
  3368         16  CL-LAST-CLOSE-DT        PIC XX.
  3369         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3370             88  FINAL-PAID             VALUE '1'.
  3371             88  CLAIM-DENIED           VALUE '2'.
  3372             88  AUTO-CLOSE             VALUE '3'.
  3373             88  MANUAL-CLOSE           VALUE '4'.
  3374             88  BENEFITS-CHANGED       VALUE 'C'.
  3375             88  SETUP-ERRORS           VALUE 'E'.
  3376         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3377         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3378         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3379             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3380         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3381         16  FILLER                  PIC X.
  3382
  3383     12  CL-CERTIFICATE-DATA.
  3384         16  CL-CERT-ORIGIN          PIC X.
  3385             88  CERT-WAS-ONLINE        VALUE '1'.
  3386             88  CERT-WAS-CREATED       VALUE '2'.
  3387             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3388         16  CL-CERT-KEY-DATA.
  3389             20  CL-CERT-CARRIER     PIC X.
  3390             20  CL-CERT-GROUPING    PIC X(6).
  3391             20  CL-CERT-STATE       PIC XX.
  3392             20  CL-CERT-ACCOUNT.
  3393                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3394                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3395             20  CL-CERT-EFF-DT      PIC XX.
  3396
  3397     12  CL-STATUS-CONTROLS.
  3398         16  CL-PRIORITY-CD          PIC X.
  3399             88  CONFIDENTIAL-DATA      VALUE '8'.
  3400             88  HIGHEST-PRIORITY       VALUE '9'.
  3401         16  CL-SUPV-ATTN-CD         PIC X.
  3402             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3403             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3404         16  CL-PURGED-DT            PIC XX.
  3405         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  65
* EL130.cbl
  3406         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3407         16  CL-NEXT-RESEND-DT       PIC XX.
  3408         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3409         16  CL-CRITICAL-PERIOD      PIC 99.
  3410*        16  FILLER                  PIC XX.
  3411         16  CL-LAST-MAINT-DT        PIC XX.
  3412         16  CL-LAST-MAINT-USER      PIC X(4).
  3413         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3414         16  CL-LAST-MAINT-TYPE      PIC X.
  3415             88  CLAIM-SET-UP           VALUE ' '.
  3416             88  PAYMENT-MADE           VALUE '1'.
  3417             88  LETTER-SENT            VALUE '2'.
  3418             88  MASTER-WAS-ALTERED     VALUE '3'.
  3419             88  MASTER-WAS-RESTORED    VALUE '4'.
  3420             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3421             88  FILE-CONVERTED         VALUE '6'.
  3422             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3423             88  ERROR-CORRECTION       VALUE 'E'.
  3424         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3425         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3426         16  CL-BENEFICIARY          PIC X(10).
  3427         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3428         16  CL-DENIAL-TYPE          PIC X.
  3429             88  CL-TYPE-DENIAL          VALUE '1'.
  3430             88  CL-TYPE-RESCISSION      VALUE '2'.
  3431             88  CL-TYPE-REFORMATION     VALUE '3'.
  3432             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3433             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3434         16  filler                  pic x(5).
  3435*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3436*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3437*        16  CL-RTW-DT               PIC XX.
  3438
  3439     12  CL-TRAILER-CONTROLS.
  3440         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3441             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3442             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3443             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3444         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3445         16  FILLER                  PIC XX.
  3446         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3447         16  CL-ADDRESS-TRAILER-CNT.
  3448             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3449                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3450             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3451                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3452             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3453                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3454             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3455                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3456             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3457                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3458             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3459                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3460             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3461                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3462
  3463     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  66
* EL130.cbl
  3464         16  CL-CV-REFNO-PRIME       PIC X(18).
  3465         16  CL-CV-REFNO-SFX         PIC XX.
  3466
  3467     12  CL-FILE-LOCATION            PIC X(4).
  3468
  3469     12  CL-PROCESS-ERRORS.
  3470         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3471             88  NO-FATAL-ERRORS        VALUE ZERO.
  3472         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3473             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3474
  3475     12  CL-PRODUCT-CD               PIC X.
  3476
  3477     12  CL-CURRENT-KEY-DATA.
  3478         16  CL-CURRENT-CARRIER      PIC X.
  3479         16  CL-CURRENT-GROUPING     PIC X(6).
  3480         16  CL-CURRENT-STATE        PIC XX.
  3481         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3482
  3483     12  CL-ASSOCIATES               PIC X.
  3484         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3485         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3486         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3487         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3488
  3489     12  CL-ACTIVITY-CODE            PIC 99.
  3490     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3491     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3492
  3493     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3494     12  CL-LAG-REPORT-CODE          PIC 9.
  3495     12  CL-LOAN-TYPE                PIC XX.
  3496     12  CL-LEGAL-STATE              PIC XX.
  3497
  3498     12  CL-YESNOSW                  PIC X.
  3499     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3500         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3501         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3502         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3503     12  cl-insured-type             pic x.
  3504         88  cl-claim-on-primary         value 'P'.
  3505         88  cl-claim-on-co-borrower     value 'C'.
  3506     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  67
* EL130.cbl
  3508*    COPY ELCCNTL.
  3509******************************************************************
  3510*                                                                *
  3511*                                                                *
  3512*                            ELCCNTL.                            *
  3513*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3514*                            VMOD=2.059                          *
  3515*                                                                *
  3516*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3517*                                                                *
  3518*   FILE TYPE = VSAM,KSDS                                        *
  3519*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3520*                                                                *
  3521*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3522*       ALTERNATE INDEX = NONE                                   *
  3523*                                                                *
  3524*   LOG = YES                                                    *
  3525*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3526******************************************************************
  3527*                   C H A N G E   L O G
  3528*
  3529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3530*-----------------------------------------------------------------
  3531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3532* EFFECTIVE    NUMBER
  3533*-----------------------------------------------------------------
  3534* 082503                   PEMA  ADD BENEFIT GROUP
  3535* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3536* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3537* 092705    2005050300006  PEMA  ADD SPP LEASES
  3538* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3539* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3540* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3541* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3542* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3543* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3544* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3545* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3546* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3547* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3548******************************************************************
  3549*
  3550 01  CONTROL-FILE.
  3551     12  CF-RECORD-ID                       PIC XX.
  3552         88  VALID-CF-ID                        VALUE 'CF'.
  3553
  3554     12  CF-CONTROL-PRIMARY.
  3555         16  CF-COMPANY-ID                  PIC XXX.
  3556         16  CF-RECORD-TYPE                 PIC X.
  3557             88  CF-COMPANY-MASTER              VALUE '1'.
  3558             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3559             88  CF-STATE-MASTER                VALUE '3'.
  3560             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3561             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3562             88  CF-CARRIER-MASTER              VALUE '6'.
  3563             88  CF-MORTALITY-MASTER            VALUE '7'.
  3564             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3565             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  68
* EL130.cbl
  3566             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3567             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3568             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3569             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3570             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3571             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3572             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3573             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3574             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3575         16  CF-ACCESS-CD-GENL              PIC X(4).
  3576         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3577             20  CF-PROCESSOR               PIC X(4).
  3578         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3579             20  CF-STATE-CODE              PIC XX.
  3580             20  FILLER                     PIC XX.
  3581         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3582             20  FILLER                     PIC XX.
  3583             20  CF-HI-BEN-IN-REC           PIC XX.
  3584         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3585             20  FILLER                     PIC XXX.
  3586             20  CF-CARRIER-CNTL            PIC X.
  3587         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3588             20  FILLER                     PIC XX.
  3589             20  CF-HI-TYPE-IN-REC          PIC 99.
  3590         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3591             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3592                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3593             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3594             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3595         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3596             20  FILLER                     PIC X.
  3597             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3598         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3599             20  FILLER                     PIC XX.
  3600             20  CF-MORTGAGE-PLAN           PIC XX.
  3601         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3602
  3603     12  CF-LAST-MAINT-DT                   PIC XX.
  3604     12  CF-LAST-MAINT-BY                   PIC X(4).
  3605     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3606
  3607     12  CF-RECORD-BODY                     PIC X(728).
  3608
  3609
  3610****************************************************************
  3611*             COMPANY MASTER RECORD                            *
  3612****************************************************************
  3613
  3614     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3615         16  CF-COMPANY-ADDRESS.
  3616             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3617             20  CF-CL-IN-CARE-OF           PIC X(30).
  3618             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3619             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3620             20  CF-CL-CITY-STATE           PIC X(30).
  3621             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3622             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3623         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  69
* EL130.cbl
  3624         16  CF-COMPANY-PASSWORD            PIC X(8).
  3625         16  CF-SECURITY-OPTION             PIC X.
  3626             88  ALL-SECURITY                   VALUE '1'.
  3627             88  COMPANY-VERIFY                 VALUE '2'.
  3628             88  PROCESSOR-VERIFY               VALUE '3'.
  3629             88  NO-SECURITY                    VALUE '4'.
  3630             88  ALL-BUT-TERM                   VALUE '5'.
  3631         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3632             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3633         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3634             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3635         16  CF-INFORCE-LOCATION            PIC X.
  3636             88  CERTS-ARE-ONLINE               VALUE '1'.
  3637             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3638             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3639         16  CF-LOWER-CASE-LETTERS          PIC X.
  3640         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3641             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3642             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3643             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3644             88  CF-ACCNT-CNTL                  VALUE '3'.
  3645             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3646
  3647         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3648         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3649
  3650         16  CF-LGX-CREDIT-USER             PIC X.
  3651             88  CO-IS-NOT-USER                 VALUE 'N'.
  3652             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3653
  3654         16 CF-CREDIT-CALC-CODES.
  3655             20  CF-CR-REM-TERM-CALC PIC X.
  3656               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3657               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3658               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3659               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3660               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3661               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3662               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3663             20  CF-CR-R78-METHOD           PIC X.
  3664               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3665               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3666
  3667         16  CF-CLAIM-CONTROL-COUNTS.
  3668             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3669                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3670
  3671             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3672                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3673
  3674             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3675                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3676
  3677             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3678                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3679
  3680         16  CF-CURRENT-MONTH-END           PIC XX.
  3681
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  70
* EL130.cbl
  3682         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3683             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3684             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3685             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3686             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3687                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3688                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3689             20  CF-CO-PREM-REJECT-SW       PIC X.
  3690                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3691                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3692             20  CF-CO-REF-REJECT-SW        PIC X.
  3693                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3694                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3695
  3696         16  CF-CO-REPORTING-DT             PIC XX.
  3697         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3698         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3699           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3700           88  CF-CO-MONTH-END                  VALUE '1'.
  3701
  3702         16  CF-LGX-CLAIM-USER              PIC X.
  3703             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3704             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3705
  3706         16  CF-CREDIT-EDIT-CONTROLS.
  3707             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3708             20  CF-MIN-AGE                 PIC 99.
  3709             20  CF-DEFAULT-AGE             PIC 99.
  3710             20  CF-MIN-TERM                PIC S999      COMP-3.
  3711             20  CF-MAX-TERM                PIC S999      COMP-3.
  3712             20  CF-DEFAULT-SEX             PIC X.
  3713             20  CF-JOINT-AGE-INPUT         PIC X.
  3714                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3715             20  CF-BIRTH-DATE-INPUT        PIC X.
  3716                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3717             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3718                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3719                 88  CF-ZERO-CARRIER            VALUE '1'.
  3720                 88  CF-ZERO-GROUPING           VALUE '2'.
  3721                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3722             20  CF-EDIT-SW                 PIC X.
  3723                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3724             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3725             20  CF-CR-PR-METHOD            PIC X.
  3726               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3727               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3728             20  FILLER                     PIC X.
  3729
  3730         16  CF-CREDIT-MISC-CONTROLS.
  3731             20  CF-REIN-TABLE-SW           PIC X.
  3732                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3733             20  CF-COMP-TABLE-SW           PIC X.
  3734                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3735             20  CF-EXPERIENCE-RETENTION-AGE
  3736                                            PIC S9        COMP-3.
  3737             20  CF-CONVERSION-DT           PIC XX.
  3738             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3739             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  71
* EL130.cbl
  3740                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3741                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3742
  3743             20  CF-CR-CHECK-NO-CONTROL.
  3744                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3745                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3746                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3747                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3748                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3749                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3750
  3751                 24  CF-CR-CHECK-COUNT       REDEFINES
  3752                     CF-CR-CHECK-COUNTER      PIC X(4).
  3753
  3754                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3755                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3756
  3757                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3758                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3759                 24  CF-MAIL-PROCESSING       PIC X.
  3760                     88  MAIL-PROCESSING          VALUE 'Y'.
  3761
  3762         16  CF-MISC-SYSTEM-CONTROL.
  3763             20  CF-SYSTEM-C                 PIC X.
  3764                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3765             20  CF-SYSTEM-D                 PIC X.
  3766                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3767             20  CF-SOC-SEC-NO-SW            PIC X.
  3768                 88  SOC-SEC-NO-USED             VALUE '1'.
  3769             20  CF-MEMBER-NO-SW             PIC X.
  3770                 88  MEMBER-NO-USED              VALUE '1'.
  3771             20  CF-TAX-ID-NUMBER            PIC X(11).
  3772             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3773             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3774                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3775                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3776                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3777                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3778             20  CF-SYSTEM-E                 PIC X.
  3779                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3780
  3781         16  CF-LGX-LIFE-USER               PIC X.
  3782             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3783             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3784
  3785         16  CF-CR-MONTH-END-DT             PIC XX.
  3786
  3787         16  CF-FILE-MAINT-DATES.
  3788             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3789                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3790             20  CF-LAST-BATCH       REDEFINES
  3791                 CF-LAST-BATCH-NO               PIC X(4).
  3792             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3793             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3794             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3795             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3796             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3797             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  72
* EL130.cbl
  3798             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3799             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3800             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3801             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3802
  3803         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3804         16  FILLER                         PIC X.
  3805
  3806         16  CF-ALT-MORT-CODE               PIC X(4).
  3807         16  CF-MEMBER-CAPTION              PIC X(10).
  3808
  3809         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3810             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3811             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3812             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3813             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3814             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3815
  3816         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3817
  3818         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3819         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3820         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3821         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3822
  3823         16  CF-AH-OVERRIDE-L1              PIC X.
  3824         16  CF-AH-OVERRIDE-L2              PIC XX.
  3825         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3826         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3827
  3828         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3829         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3830
  3831         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3832         16  CF-AR-LAST-EL860-DT            PIC XX.
  3833         16  CF-MP-MONTH-END-DT             PIC XX.
  3834
  3835         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3836         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3837             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3838
  3839         16  CF-AR-MONTH-END-DT             PIC XX.
  3840
  3841         16  CF-CRDTCRD-USER                PIC X.
  3842             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3843             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3844
  3845         16  CF-CC-MONTH-END-DT             PIC XX.
  3846
  3847         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3848
  3849         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3850             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3851             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3852             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3853         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3854         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3855         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  73
* EL130.cbl
  3856         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3857             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3858             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3859         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3860         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3861         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3862             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3863         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3864
  3865         16  CF-CL-ZIP-CODE.
  3866             20  CF-CL-ZIP-PRIME.
  3867                 24  CF-CL-ZIP-1ST          PIC X.
  3868                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3869                 24  FILLER                 PIC X(4).
  3870             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3871         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3872             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3873             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3874             20  FILLER                     PIC XXX.
  3875
  3876         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3877         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3878         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3879         16  CF-CO-OPTION-START-DATE        PIC XX.
  3880         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3881           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3882                                                      '3' '4'.
  3883           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3884           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3885           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3886           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3887           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3888           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3889
  3890         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3891
  3892         16  CF-PAYMENT-APPROVAL-LEVELS.
  3893             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3894             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3895             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3896             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3897             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3898             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3899
  3900         16  CF-END-USER-REPORTING-USER     PIC X.
  3901             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3902             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3903
  3904         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3905             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3906             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3907
  3908         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3909
  3910         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3911         16  FILLER                         PIC X.
  3912
  3913         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  74
* EL130.cbl
  3914             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3915             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3916             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3917
  3918         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3919
  3920         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3921             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3922             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3923
  3924         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3925             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3926             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3927
  3928         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3929
  3930         16  CF-CO-ACH-ID-CODE              PIC  X.
  3931             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3932             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3933             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3934         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3935         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3936         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3937         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3938         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3939         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3940         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3941         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3942         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3943                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3944         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3945                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3946
  3947         16  CF-CO-OVER-SHORT.
  3948             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3949             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3950
  3951*         16  FILLER                         PIC X(102).
  3952         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3953             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3954             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3955
  3956         16  CF-AH-APPROVAL-DAYS.
  3957             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3958             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3959             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3960             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3961
  3962         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3963
  3964         16  CF-APPROV-LEV-5.
  3965             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3966             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3967             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3968
  3969         16  FILLER                         PIC X(68).
  3970****************************************************************
  3971*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  75
* EL130.cbl
  3972****************************************************************
  3973
  3974     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3975         16  CF-PROCESSOR-NAME              PIC X(30).
  3976         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3977         16  CF-PROCESSOR-TITLE             PIC X(26).
  3978         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3979                 88  MESSAGE-YES                VALUE 'Y'.
  3980                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3981
  3982*****************************************************
  3983****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3984****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3985****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3986****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3987*****************************************************
  3988
  3989         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3990             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3991             20  CF-APPLICATION-FORCE       PIC X.
  3992             20  CF-INDIVIDUAL-APP.
  3993                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3994                     28  CF-BROWSE-APP      PIC X.
  3995                     28  CF-UPDATE-APP      PIC X.
  3996
  3997         16  CF-CURRENT-TERM-ON             PIC X(4).
  3998         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3999             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4000             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4001             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4002             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4003             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4004             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4005             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4006         16  CF-PROCESSOR-CARRIER           PIC X.
  4007             88  NO-CARRIER-SECURITY            VALUE ' '.
  4008         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4009             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4010         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4011             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4012         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4013             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4014
  4015         16  CF-PROC-SYS-ACCESS-SW.
  4016             20  CF-PROC-CREDIT-CLAIMS-SW.
  4017                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4018                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4019                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4020                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4021             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4022                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4023                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4024             20  CF-PROC-LIFE-GNRLDGR-SW.
  4025                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4026                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4027                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4028                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4029             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  76
* EL130.cbl
  4030                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4031                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4032         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4033             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4034             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4035         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4036
  4037         16  CF-APPROVAL-LEVEL                  PIC X.
  4038             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4039             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4040             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4041             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4042             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4043
  4044         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4045
  4046         16  CF-LANGUAGE-TYPE                   PIC X.
  4047             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4048             88  CF-LANG-IS-FR                      VALUE 'F'.
  4049
  4050         16  CF-CSR-IND                         PIC X.
  4051         16  FILLER                             PIC X(239).
  4052
  4053****************************************************************
  4054*             PROCESSOR/REMINDERS RECORD                       *
  4055****************************************************************
  4056
  4057     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4058         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4059             20  CF-START-REMIND-DT         PIC XX.
  4060             20  CF-END-REMIND-DT           PIC XX.
  4061             20  CF-REMINDER-TEXT           PIC X(50).
  4062         16  FILLER                         PIC X(296).
  4063
  4064
  4065****************************************************************
  4066*             STATE MASTER RECORD                              *
  4067****************************************************************
  4068
  4069     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4070         16  CF-STATE-ABBREVIATION          PIC XX.
  4071         16  CF-STATE-NAME                  PIC X(25).
  4072         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4073         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4074             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4075             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4076             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4077             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4078                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4079                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4080             20  CF-ST-PREM-REJECT-SW       PIC X.
  4081                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4082                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4083             20  CF-ST-REF-REJECT-SW        PIC X.
  4084                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4085                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4086         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4087         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  77
* EL130.cbl
  4088         16  CF-ST-REFUND-RULES.
  4089             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4090             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4091             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4092         16  CF-ST-FST-PMT-EXTENSION.
  4093             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4094             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4095                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4096                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4097                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4098                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4099         16  CF-ST-STATE-CALL.
  4100             20  CF-ST-CALL-UNEARNED        PIC X.
  4101             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4102             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4103         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4104             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4105             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4106         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4107         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4108         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4109         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4110         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4111         16  FILLER                         PIC X.
  4112         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4113             20  CF-ST-BENEFIT-CD           PIC XX.
  4114             20  CF-ST-BENEFIT-KIND         PIC X.
  4115                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4116                 88  CF-ST-AH-KIND              VALUE 'A'.
  4117             20  CF-ST-REM-TERM-CALC        PIC X.
  4118                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4119                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4120                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4121                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4122                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4123                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4124                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4125                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4126
  4127             20  CF-ST-REFUND-CALC          PIC X.
  4128                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4129                 88  ST-REFD-BY-R78             VALUE '1'.
  4130                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4131                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4132                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4133                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4134                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4135                 88  ST-REFD-UTAH               VALUE '7'.
  4136                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4137                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4138                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4139
  4140             20  CF-ST-EARNING-CALC         PIC X.
  4141                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4142                 88  ST-EARN-BY-R78             VALUE '1'.
  4143                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4144                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4145                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  78
* EL130.cbl
  4146                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4147                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4148                 88  ST-EARN-MEAN               VALUE '8'.
  4149                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4150
  4151             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4152                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4153                 88  ST-OVRD-BY-R78             VALUE '1'.
  4154                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4155                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4156                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4157                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4158                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4159                 88  ST-OVRD-MEAN               VALUE '8'.
  4160                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4161             20  cf-st-extra-periods        pic 9.
  4162*            20  FILLER                     PIC X.
  4163
  4164         16  CF-ST-COMMISSION-CAPS.
  4165             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4166             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4167             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4168             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4169         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4170                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4171
  4172         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4173
  4174         16  CF-ST-STATUTORY-INTEREST.
  4175             20  CF-ST-STAT-DATE-FROM       PIC X.
  4176                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4177                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4178             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4179             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4180             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4181             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4182             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4183
  4184         16  CF-ST-OVER-SHORT.
  4185             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4186             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4187
  4188         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4189
  4190         16  CF-ST-RT-CALC                  PIC X.
  4191
  4192         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4193         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4194         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4195         16  CF-ST-RF-LR-CALC               PIC X.
  4196         16  CF-ST-RF-LL-CALC               PIC X.
  4197         16  CF-ST-RF-LN-CALC               PIC X.
  4198         16  CF-ST-RF-AH-CALC               PIC X.
  4199         16  CF-ST-RF-CP-CALC               PIC X.
  4200*        16  FILLER                         PIC X(206).
  4201*CIDMOD         16  FILLER                         PIC X(192).
  4202         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4203             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  79
* EL130.cbl
  4204         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4205         16  CF-ST-VFY-2ND-BENE             PIC X.
  4206         16  CF-ST-CAUSAL-STATE             PIC X.
  4207         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4208         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4209         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4210             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4211         16  CF-ST-NET-ONLY-STATE           PIC X.
  4212             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4213         16  FILLER                         PIC X(181).
  4214
  4215****************************************************************
  4216*             BENEFIT MASTER RECORD                            *
  4217****************************************************************
  4218
  4219     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4220         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4221             20  CF-BENEFIT-CODE            PIC XX.
  4222             20  CF-BENEFIT-NUMERIC  REDEFINES
  4223                 CF-BENEFIT-CODE            PIC XX.
  4224             20  CF-BENEFIT-ALPHA           PIC XXX.
  4225             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4226             20  CF-BENEFIT-COMMENT         PIC X(10).
  4227
  4228             20  CF-LF-COVERAGE-TYPE        PIC X.
  4229                 88  CF-REDUCING                VALUE 'R'.
  4230                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4231
  4232             20  CF-SPECIAL-CALC-CD         PIC X.
  4233                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4234                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4235                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4236                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4237                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4238                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4239                 88  CF-FARM-PLAN               VALUE 'F'.
  4240                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4241                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4242                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4243                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4244                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4245                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4246                 88  CF-PRUDENTIAL              VALUE 'P'.
  4247                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4248                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4249                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4250                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4251                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4252                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4253
  4254             20  CF-JOINT-INDICATOR         PIC X.
  4255                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4256
  4257*            20  FILLER                     PIC X(12).
  4258             20  cf-maximum-benefits        pic s999 comp-3.
  4259             20  FILLER                     PIC X(09).
  4260             20  CF-BENEFIT-CATEGORY        PIC X.
  4261             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  80
* EL130.cbl
  4262
  4263             20  CF-CO-REM-TERM-CALC        PIC X.
  4264                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4265                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4266                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4267                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4268                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4269
  4270             20  CF-CO-EARNINGS-CALC        PIC X.
  4271                 88  CO-EARN-BY-R78             VALUE '1'.
  4272                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4273                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4274                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4275                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4276                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4277                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4278                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4279
  4280             20  CF-CO-REFUND-CALC          PIC X.
  4281                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4282                 88  CO-REFD-BY-R78             VALUE '1'.
  4283                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4284                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4285                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4286                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4287                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4288                 88  CO-REFD-MEAN               VALUE '8'.
  4289                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4290                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4291                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4292
  4293             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4294                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4295                 88  CO-OVRD-BY-R78             VALUE '1'.
  4296                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4297                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4298                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4299                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4300                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4301                 88  CO-OVRD-MEAN               VALUE '8'.
  4302                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4303
  4304             20  CF-CO-BEN-I-G-CD           PIC X.
  4305                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4306                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4307                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4308
  4309         16  FILLER                         PIC X(304).
  4310
  4311
  4312****************************************************************
  4313*             CARRIER MASTER RECORD                            *
  4314****************************************************************
  4315
  4316     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4317         16  CF-ADDRESS-DATA.
  4318             20  CF-MAIL-TO-NAME            PIC X(30).
  4319             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  81
* EL130.cbl
  4320             20  CF-ADDRESS-LINE-1          PIC X(30).
  4321             20  CF-ADDRESS-LINE-2          PIC X(30).
  4322             20  CF-CITY-STATE              PIC X(30).
  4323             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4324             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4325
  4326         16  CF-CLAIM-NO-CONTROL.
  4327             20  CF-CLAIM-NO-METHOD         PIC X.
  4328                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4329                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4330                 88  CLAIM-NO-SEQ               VALUE '3'.
  4331                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4332             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4333                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4334                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4335                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4336
  4337         16  CF-CHECK-NO-CONTROL.
  4338             20  CF-CHECK-NO-METHOD         PIC X.
  4339                 88  CHECK-NO-MANUAL            VALUE '1'.
  4340                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4341                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4342                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4343             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4344                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4345
  4346         16  CF-DOMICILE-STATE              PIC XX.
  4347
  4348         16  CF-EXPENSE-CONTROLS.
  4349             20  CF-EXPENSE-METHOD          PIC X.
  4350                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4351                 88  DOLLARS-PER-PMT            VALUE '2'.
  4352                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4353                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4354             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4355             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4356
  4357         16  CF-CORRESPONDENCE-CONTROL.
  4358             20  CF-LETTER-RESEND-OPT       PIC X.
  4359                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4360                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4361             20  FILLER                     PIC X(4).
  4362
  4363         16  CF-RESERVE-CONTROLS.
  4364             20  CF-MANUAL-SW               PIC X.
  4365                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4366             20  CF-FUTURE-SW               PIC X.
  4367                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4368             20  CF-PTC-SW                  PIC X.
  4369                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4370             20  CF-IBNR-SW                 PIC X.
  4371                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4372             20  CF-PTC-LF-SW               PIC X.
  4373                 88  CF-LF-PTC-USED             VALUE '1'.
  4374             20  CF-CDT-ACCESS-METHOD       PIC X.
  4375                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4376                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4377                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  82
* EL130.cbl
  4378             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4379
  4380         16  CF-CLAIM-CALC-METHOD           PIC X.
  4381             88  360-PLUS-MONTHS                VALUE '1'.
  4382             88  365-PLUS-MONTHS                VALUE '2'.
  4383             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4384             88  360-DAILY                      VALUE '4'.
  4385             88  365-DAILY                      VALUE '5'.
  4386
  4387         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4388         16  FILLER                         PIC X(11).
  4389
  4390         16  CF-LIMIT-AMOUNTS.
  4391             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4392             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4393             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4394             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4395             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4396             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4397             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4398             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4399             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4400             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4401
  4402         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4403         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4404         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4405
  4406         16  CF-ZIP-CODE.
  4407             20  CF-ZIP-PRIME.
  4408                 24  CF-ZIP-1ST             PIC X.
  4409                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4410                 24  FILLER                 PIC X(4).
  4411             20  CF-ZIP-PLUS4               PIC X(4).
  4412         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4413             20  CF-CAN-POSTAL-1            PIC XXX.
  4414             20  CF-CAN-POSTAL-2            PIC XXX.
  4415             20  FILLER                     PIC XXX.
  4416
  4417         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4418         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4419         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4420
  4421         16  CF-RATING-SWITCH               PIC X.
  4422             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4423             88  CF-NO-RATING                   VALUE 'N'.
  4424
  4425         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4426
  4427         16  CF-CARRIER-OVER-SHORT.
  4428             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4429             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4430
  4431         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4432         16  CF-SECPAY-SWITCH               PIC X.
  4433             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4434             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4435         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  83
* EL130.cbl
  4436         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4437         16  FILLER                         PIC X(444).
  4438*        16  FILLER                         PIC X(452).
  4439
  4440
  4441****************************************************************
  4442*             MORTALITY MASTER RECORD                          *
  4443****************************************************************
  4444
  4445     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4446         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4447                                INDEXED BY CF-MORT-NDX.
  4448             20  CF-MORT-TABLE              PIC X(5).
  4449             20  CF-MORT-TABLE-TYPE         PIC X.
  4450                 88  CF-MORT-JOINT              VALUE 'J'.
  4451                 88  CF-MORT-SINGLE             VALUE 'S'.
  4452                 88  CF-MORT-COMBINED           VALUE 'C'.
  4453                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4454                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4455             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4456             20  CF-MORT-AGE-METHOD         PIC XX.
  4457                 88  CF-AGE-LAST                VALUE 'AL'.
  4458                 88  CF-AGE-NEAR                VALUE 'AN'.
  4459             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4460             20  CF-MORT-ADJUSTMENT-DIRECTION
  4461                                            PIC X.
  4462                 88  CF-MINUS                   VALUE '-'.
  4463                 88  CF-PLUS                    VALUE '+'.
  4464             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4465             20  CF-MORT-JOINT-CODE         PIC X.
  4466                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4467             20  CF-MORT-PC-Q               PIC X.
  4468                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4469             20  CF-MORT-TABLE-CODE         PIC X(4).
  4470             20  CF-MORT-COMMENTS           PIC X(15).
  4471             20  FILLER                     PIC X(14).
  4472
  4473         16  FILLER                         PIC X(251).
  4474
  4475
  4476****************************************************************
  4477*             BUSSINESS TYPE MASTER RECORD                     *
  4478****************************************************************
  4479
  4480     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4481* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4482* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4483* AND RECORD 05 IS TYPES 81-99
  4484         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4485             20  CF-BUSINESS-TITLE          PIC  X(19).
  4486             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4487                                            PIC S9V9(4) COMP-3.
  4488             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4489             20  FILLER                     PIC  X.
  4490         16  FILLER                         PIC  X(248).
  4491
  4492
  4493****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  84
* EL130.cbl
  4494*             TERMINAL MASTER RECORD                           *
  4495****************************************************************
  4496
  4497     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4498
  4499         16  CF-COMPANY-TERMINALS.
  4500             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4501                                  PIC X(4).
  4502         16  FILLER               PIC X(248).
  4503
  4504
  4505****************************************************************
  4506*             LIFE EDIT MASTER RECORD                          *
  4507****************************************************************
  4508
  4509     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4510         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4511             20  CF-LIFE-CODE-IN            PIC XX.
  4512             20  CF-LIFE-CODE-OUT           PIC XX.
  4513         16  FILLER                         PIC X(248).
  4514
  4515
  4516****************************************************************
  4517*             AH EDIT MASTER RECORD                            *
  4518****************************************************************
  4519
  4520     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4521         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4522             20  CF-AH-CODE-IN              PIC XXX.
  4523             20  CF-AH-CODE-OUT             PIC XX.
  4524         16  FILLER                         PIC X(248).
  4525
  4526
  4527****************************************************************
  4528*             CREDIBILITY TABLES                               *
  4529****************************************************************
  4530
  4531     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4532         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4533                             INDEXED BY CF-CRDB-NDX.
  4534             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4535             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4536             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4537         16  FILLER                         PIC  X(332).
  4538
  4539
  4540****************************************************************
  4541*             REPORT CUSTOMIZATION RECORD                      *
  4542****************************************************************
  4543
  4544     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4545         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4546             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4547             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4548             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4549**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4550****       A T-TRANSFER.                                   ****
  4551             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  85
* EL130.cbl
  4552
  4553         16  FILLER                         PIC XX.
  4554
  4555         16  CF-CARRIER-CNTL-OPT.
  4556             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4557                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4558                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4559             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4560                                            PIC X.
  4561         16  CF-GROUP-CNTL-OPT.
  4562             20  CF-GROUP-OPT-SEQ           PIC 9.
  4563                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4564                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4565             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4566                                            PIC X(6).
  4567         16  CF-STATE-CNTL-OPT.
  4568             20  CF-STATE-OPT-SEQ           PIC 9.
  4569                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4570                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4571             20  CF-STATE-SELECT OCCURS 3 TIMES
  4572                                            PIC XX.
  4573         16  CF-ACCOUNT-CNTL-OPT.
  4574             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4575                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4576                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4577             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4578                                            PIC X(10).
  4579         16  CF-BUS-TYP-CNTL-OPT.
  4580             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4581                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4582                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4583             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4584                                            PIC XX.
  4585         16  CF-LF-TYP-CNTL-OPT.
  4586             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4587                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4588                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4589             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4590                                            PIC XX.
  4591         16  CF-AH-TYP-CNTL-OPT.
  4592             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4593                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4594                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4595             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4596                                            PIC XX.
  4597         16  CF-REPTCD1-CNTL-OPT.
  4598             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4599                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4600                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4601             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4602                                            PIC X(10).
  4603         16  CF-REPTCD2-CNTL-OPT.
  4604             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4605                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4606                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4607             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4608                                            PIC X(10).
  4609         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  86
* EL130.cbl
  4610             20  CF-USER1-OPT-SEQ           PIC 9.
  4611                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4612                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4613             20  CF-USER1-SELECT OCCURS 3 TIMES
  4614                                            PIC X(10).
  4615         16  CF-USER2-CNTL-OPT.
  4616             20  CF-USER2-OPT-SEQ           PIC 9.
  4617                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4618                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4619             20  CF-USER2-SELECT OCCURS 3 TIMES
  4620                                            PIC X(10).
  4621         16  CF-USER3-CNTL-OPT.
  4622             20  CF-USER3-OPT-SEQ           PIC 9.
  4623                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4624                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4625             20  CF-USER3-SELECT OCCURS 3 TIMES
  4626                                            PIC X(10).
  4627         16  CF-USER4-CNTL-OPT.
  4628             20  CF-USER4-OPT-SEQ           PIC 9.
  4629                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4630                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4631             20  CF-USER4-SELECT OCCURS 3 TIMES
  4632                                            PIC X(10).
  4633         16  CF-USER5-CNTL-OPT.
  4634             20  CF-USER5-OPT-SEQ           PIC 9.
  4635                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4636                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4637             20  CF-USER5-SELECT OCCURS 3 TIMES
  4638                                            PIC X(10).
  4639         16  CF-REINS-CNTL-OPT.
  4640             20  CF-REINS-OPT-SEQ           PIC 9.
  4641                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4642                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4643             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4644                 24  CF-REINS-PRIME         PIC XXX.
  4645                 24  CF-REINS-SUB           PIC XXX.
  4646
  4647         16  CF-AGENT-CNTL-OPT.
  4648             20  CF-AGENT-OPT-SEQ           PIC 9.
  4649                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4650                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4651             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4652                                            PIC X(10).
  4653
  4654         16  FILLER                         PIC X(43).
  4655
  4656         16  CF-LOSS-RATIO-SELECT.
  4657             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4658             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4659         16  CF-ENTRY-DATE-SELECT.
  4660             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4661             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4662         16  CF-EFFECTIVE-DATE-SELECT.
  4663             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4664             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4665
  4666         16  CF-EXCEPTION-LIST-IND          PIC X.
  4667             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  87
* EL130.cbl
  4668
  4669         16  FILLER                         PIC X(318).
  4670
  4671****************************************************************
  4672*                  EXCEPTION REPORTING RECORD                  *
  4673****************************************************************
  4674
  4675     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4676         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4677             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4678
  4679         16  CF-COMBINED-LIFE-AH-OPT.
  4680             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4681             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4682             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4683             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4684
  4685         16  CF-LIFE-OPT.
  4686             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4687             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4688             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4689             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4690             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4691             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4692             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4693             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4694             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4695             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4696
  4697         16  CF-AH-OPT.
  4698             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4699             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4700             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4701             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4702             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4703             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4704             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4705             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4706             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4707             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4708
  4709         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4710             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4711             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4712             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4713
  4714         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4715
  4716         16  FILLER                         PIC X(673).
  4717
  4718
  4719****************************************************************
  4720*             MORTGAGE SYSTEM PLAN RECORD                      *
  4721****************************************************************
  4722
  4723     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4724         16  CF-PLAN-TYPE                   PIC X.
  4725             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  88
* EL130.cbl
  4726             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4727             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4728         16  CF-PLAN-ABBREV                 PIC XXX.
  4729         16  CF-PLAN-DESCRIPT               PIC X(10).
  4730         16  CF-PLAN-NOTES                  PIC X(20).
  4731         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4732         16  CF-PLAN-UNDERWRITING.
  4733             20  CF-PLAN-TERM-DATA.
  4734                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4735                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4736             20  CF-PLAN-AGE-DATA.
  4737                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4738                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4739                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4740             20  CF-PLAN-BENEFIT-DATA.
  4741                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4742                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4743                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4744                                            PIC S9(7)V99  COMP-3.
  4745         16  CF-PLAN-POLICY-FORMS.
  4746             20  CF-POLICY-FORM             PIC X(12).
  4747             20  CF-MASTER-APPLICATION      PIC X(12).
  4748             20  CF-MASTER-POLICY           PIC X(12).
  4749         16  CF-PLAN-RATING.
  4750             20  CF-RATE-CODE               PIC X(5).
  4751             20  CF-SEX-RATING              PIC X.
  4752                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4753                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4754             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4755             20  CF-SUB-STD-TYPE            PIC X.
  4756                 88  CF-PCT-OF-PREM            VALUE '1'.
  4757                 88  CF-PCT-OF-BENE            VALUE '2'.
  4758         16  CF-PLAN-PREM-TOLERANCES.
  4759             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4760             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4761         16  CF-PLAN-PYMT-TOLERANCES.
  4762             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4763             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4764         16  CF-PLAN-MISC-DATA.
  4765             20  FILLER                     PIC X.
  4766             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4767             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4768         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4769         16  CF-PLAN-IND-GRP                PIC X.
  4770             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4771                                                     '1'.
  4772             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4773                                                     '2'.
  4774         16  CF-MIB-SEARCH-SW               PIC X.
  4775             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4776             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4777             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4778             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4779         16  CF-ALPHA-SEARCH-SW             PIC X.
  4780             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4781             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4782             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4783             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  89
* EL130.cbl
  4784             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4785             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4786             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4787             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4788             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4789             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4790                                                     'A' 'B' 'C'
  4791                                                     'X' 'Y' 'Z'.
  4792         16  CF-EFF-DT-RULE-SW              PIC X.
  4793             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4794             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4795             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4796             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4797             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4798         16  FILLER                         PIC X(4).
  4799         16  CF-HEALTH-QUESTIONS            PIC X.
  4800             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4801         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4802         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4803         16  CF-PLAN-SNGL-JNT               PIC X.
  4804             88  CF-COMBINED-PLAN              VALUE 'C'.
  4805             88  CF-JNT-PLAN                   VALUE 'J'.
  4806             88  CF-SNGL-PLAN                  VALUE 'S'.
  4807         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4808         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4809         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4810         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4811         16  CF-RERATE-CNTL                 PIC  X.
  4812             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4813             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4814             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4815             88  CF-AUTO-RECALC                 VALUE '4'.
  4816         16  CF-BENEFIT-TYPE                PIC  X.
  4817             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4818             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4819         16  CF-POLICY-FEE                  PIC S999V99
  4820                                                    COMP-3.
  4821         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4822         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4823         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4824         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4825         16  FILLER                         PIC  X(32).
  4826         16  CF-TERMINATION-FORM            PIC  X(04).
  4827         16  FILLER                         PIC  X(08).
  4828         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4829                                                       COMP-3.
  4830         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4831         16  CF-ISSUE-LETTER                PIC  X(4).
  4832         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4833         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4834             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4835             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4836         16  CF-MP-REFUND-CALC              PIC X.
  4837             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4838             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4839             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4840             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4841             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  90
* EL130.cbl
  4842             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4843             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4844             88  CF-MP-REFD-MEAN                VALUE '8'.
  4845         16  CF-ALT-RATE-CODE               PIC  X(5).
  4846
  4847
  4848         16  FILLER                         PIC X(498).
  4849****************************************************************
  4850*             MORTGAGE COMPANY MASTER RECORD                   *
  4851****************************************************************
  4852
  4853     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4854         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4855         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4856             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4857             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4858             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4859             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4860             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4861
  4862         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4863         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4864         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4865         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4866         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4867
  4868         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4869             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4870         16  CF-MP-RECON-USE-IND            PIC X(1).
  4871             88  CF-MP-USE-RECON             VALUE 'Y'.
  4872         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4873             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4874         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4875             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4876             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4877         16  FILLER                         PIC X(1).
  4878         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4879             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4880         16  CF-MORTG-MIB-VERSION           PIC X.
  4881             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4882             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4883             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4884         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4885             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4886                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4887             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4888                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4889             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4890                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4891             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4892                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4893             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4894                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4895             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4896                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4897         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4898         16  FILLER                         PIC X(7).
  4899         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  91
* EL130.cbl
  4900             20  CF-MORTG-MIB-COMM          PIC X(5).
  4901             20  CF-MORTG-MIB-TERM          PIC X(5).
  4902         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4903             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4904         16  FILLER                         PIC X(03).
  4905         16  CF-MP-CHECK-NO-CONTROL.
  4906             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4907                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4908                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4909                                                ' ' LOW-VALUES.
  4910                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4911                                               VALUE '3'.
  4912         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4913         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4914         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4915             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4916                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4917             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4918                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4919             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4920                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4921             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4922                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4923             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4924                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4925             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4926                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4927         16  CF-MORTG-BILLING-AREA.
  4928             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4929                                            PIC X.
  4930         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4931         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4932         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4933         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4934             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4935             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4936         16  FILLER                         PIC X.
  4937         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4938             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4939             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4940         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4941         16  FILLER                         PIC X(8).
  4942         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4943         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4944         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4945         16  CF-ACH-COMPANY-ID.
  4946             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4947                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4948                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4949                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4950             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4951         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4952             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4953         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4954             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4955             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4956         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4957         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  92
* EL130.cbl
  4958         16  FILLER                         PIC X(536).
  4959
  4960****************************************************************
  4961*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4962****************************************************************
  4963
  4964     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4965         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4966             20  CF-FEMALE-HEIGHT.
  4967                 24  CF-FEMALE-FT           PIC 99.
  4968                 24  CF-FEMALE-IN           PIC 99.
  4969             20  CF-FEMALE-MIN-WT           PIC 999.
  4970             20  CF-FEMALE-MAX-WT           PIC 999.
  4971         16  FILLER                         PIC X(428).
  4972
  4973     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4974         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4975             20  CF-MALE-HEIGHT.
  4976                 24  CF-MALE-FT             PIC 99.
  4977                 24  CF-MALE-IN             PIC 99.
  4978             20  CF-MALE-MIN-WT             PIC 999.
  4979             20  CF-MALE-MAX-WT             PIC 999.
  4980         16  FILLER                         PIC X(428).
  4981******************************************************************
  4982*             AUTOMATIC ACTIVITY RECORD                          *
  4983******************************************************************
  4984     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4985         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4986             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4987             20  CF-SYS-LETTER-ID           PIC X(04).
  4988             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4989             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4990             20  CF-SYS-RESET-SW            PIC X(01).
  4991             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4992             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4993
  4994         16  FILLER                         PIC X(50).
  4995
  4996         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4997             20  CF-USER-ACTIVE-SW          PIC X(01).
  4998             20  CF-USER-LETTER-ID          PIC X(04).
  4999             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5000             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5001             20  CF-USER-RESET-SW           PIC X(01).
  5002             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5003             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5004             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5005
  5006         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  93
* EL130.cbl
  5008*    COPY ELCCERT.
  5009******************************************************************
  5010*                                                                *
  5011*                            ELCCERT.                            *
  5012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5013*                            VMOD=2.013                          *
  5014*                                                                *
  5015*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5016*                                                                *
  5017*   FILE TYPE = VSAM,KSDS                                        *
  5018*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5019*                                                                *
  5020*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5021*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5022*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5023*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5024*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5025*                                                                *
  5026*   LOG = YES                                                    *
  5027*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5028******************************************************************
  5029*                   C H A N G E   L O G
  5030*
  5031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5032*-----------------------------------------------------------------
  5033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5034* EFFECTIVE    NUMBER
  5035*-----------------------------------------------------------------
  5036* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5037* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5038* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5039* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5040* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5041* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5042* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5043* 032612  CR2011110200001  PEMA  AHL CHANGES
  5044* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5045* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5046******************************************************************
  5047
  5048 01  CERTIFICATE-MASTER.
  5049     12  CM-RECORD-ID                      PIC XX.
  5050         88  VALID-CM-ID                      VALUE 'CM'.
  5051
  5052     12  CM-CONTROL-PRIMARY.
  5053         16  CM-COMPANY-CD                 PIC X.
  5054         16  CM-CARRIER                    PIC X.
  5055         16  CM-GROUPING.
  5056             20  CM-GROUPING-PREFIX        PIC X(3).
  5057             20  CM-GROUPING-PRIME         PIC X(3).
  5058         16  CM-STATE                      PIC XX.
  5059         16  CM-ACCOUNT.
  5060             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5061             20  CM-ACCOUNT-PRIME          PIC X(6).
  5062         16  CM-CERT-EFF-DT                PIC XX.
  5063         16  CM-CERT-NO.
  5064             20  CM-CERT-PRIME             PIC X(10).
  5065             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  94
* EL130.cbl
  5066
  5067     12  CM-CONTROL-BY-NAME.
  5068         16  CM-COMPANY-CD-A1              PIC X.
  5069         16  CM-INSURED-LAST-NAME          PIC X(15).
  5070         16  CM-INSURED-INITIALS.
  5071             20  CM-INSURED-INITIAL1       PIC X.
  5072             20  CM-INSURED-INITIAL2       PIC X.
  5073
  5074     12  CM-CONTROL-BY-SSN.
  5075         16  CM-COMPANY-CD-A2              PIC X.
  5076         16  CM-SOC-SEC-NO.
  5077             20  CM-SSN-STATE              PIC XX.
  5078             20  CM-SSN-ACCOUNT            PIC X(6).
  5079             20  CM-SSN-LN3.
  5080                 25  CM-INSURED-INITIALS-A2.
  5081                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5082                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5083                 25 CM-PART-LAST-NAME-A2         PIC X.
  5084
  5085     12  CM-CONTROL-BY-CERT-NO.
  5086         16  CM-COMPANY-CD-A4              PIC X.
  5087         16  CM-CERT-NO-A4                 PIC X(11).
  5088
  5089     12  CM-CONTROL-BY-MEMB.
  5090         16  CM-COMPANY-CD-A5              PIC X.
  5091         16  CM-MEMBER-NO.
  5092             20  CM-MEMB-STATE             PIC XX.
  5093             20  CM-MEMB-ACCOUNT           PIC X(6).
  5094             20  CM-MEMB-LN4.
  5095                 25  CM-INSURED-INITIALS-A5.
  5096                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5097                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5098                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5099
  5100     12  CM-INSURED-PROFILE-DATA.
  5101         16  CM-INSURED-FIRST-NAME.
  5102             20  CM-INSURED-1ST-INIT       PIC X.
  5103             20  FILLER                    PIC X(9).
  5104         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5105         16  CM-INSURED-SEX                PIC X.
  5106             88  CM-SEX-MALE                  VALUE 'M'.
  5107             88  CM-SEX-FEMAL                 VALUE 'F'.
  5108         16  CM-INSURED-JOINT-AGE          PIC 99.
  5109         16  CM-JOINT-INSURED-NAME.
  5110             20  CM-JT-LAST-NAME           PIC X(15).
  5111             20  CM-JT-FIRST-NAME.
  5112                 24  CM-JT-1ST-INIT        PIC X.
  5113                 24  FILLER                PIC X(9).
  5114             20  CM-JT-INITIAL             PIC X.
  5115
  5116     12  CM-LIFE-DATA.
  5117         16  CM-LF-BENEFIT-CD              PIC XX.
  5118         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5119         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5120         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5121         16  CM-LF-DEV-CODE                PIC XXX.
  5122         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5123         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  95
* EL130.cbl
  5124         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5125         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5126         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5127         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5128         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5129         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5130         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5131         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5132         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5133         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5134         16  cm-temp-epiq                  pic xx.
  5135             88  EPIQ-CLASS                  value 'EQ'.
  5136*        16  FILLER                        PIC XX.
  5137
  5138     12  CM-AH-DATA.
  5139         16  CM-AH-BENEFIT-CD              PIC XX.
  5140         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5141         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5142         16  CM-AH-DEV-CODE                PIC XXX.
  5143         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5144         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5145         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5146         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5147         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5148         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5149         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5150         16  CM-AH-PAID-THRU-DT            PIC XX.
  5151             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5152         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5153         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5154         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5155         16  FILLER                        PIC X.
  5156
  5157     12  CM-LOAN-INFORMATION.
  5158         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5159         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5160                                           PIC S9(5)V99  COMP-3.
  5161         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5162         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5163         16  CM-PAY-FREQUENCY              PIC S99.
  5164         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5165         16  CM-RATE-CLASS                 PIC XX.
  5166         16  CM-BENEFICIARY                PIC X(25).
  5167         16  CM-POLICY-FORM-NO             PIC X(12).
  5168         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5169         16  CM-LAST-ADD-ON-DT             PIC XX.
  5170         16  CM-DEDUCTIBLE-AMOUNTS.
  5171             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5172             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5173         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5174             20  CM-RESIDENT-STATE         PIC XX.
  5175             20  CM-RATE-CODE              PIC X(4).
  5176             20  FILLER                    PIC XX.
  5177         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5178             20  CM-LOAN-OFFICER           PIC X(5).
  5179             20  FILLER                    PIC XXX.
  5180         16  CM-CSR-CODE                   PIC XXX.
  5181         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  96
* EL130.cbl
  5182             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5183         16  CM-POST-CARD-IND              PIC X.
  5184         16  CM-NH-INTERFACE-SW            PIC X.
  5185         16  CM-PREMIUM-TYPE               PIC X.
  5186             88  CM-SING-PRM                  VALUE '1'.
  5187             88  CM-O-B-COVERAGE              VALUE '2'.
  5188             88  CM-OPEN-END                  VALUE '3'.
  5189         16  CM-IND-GRP-TYPE               PIC X.
  5190             88  CM-INDIVIDUAL                VALUE 'I'.
  5191             88  CM-GROUP                     VALUE 'G'.
  5192         16  CM-SKIP-CODE                  PIC X.
  5193             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5194             88  SKIP-JULY                    VALUE '1'.
  5195             88  SKIP-AUGUST                  VALUE '2'.
  5196             88  SKIP-SEPTEMBER               VALUE '3'.
  5197             88  SKIP-JULY-AUG                VALUE '4'.
  5198             88  SKIP-AUG-SEPT                VALUE '5'.
  5199             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5200             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5201             88  SKIP-JUNE                    VALUE '8'.
  5202             88  SKIP-JUNE-JULY               VALUE '9'.
  5203             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5204             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5205         16  CM-PAYMENT-MODE               PIC X.
  5206             88  PAY-MONTHLY                  VALUE SPACE.
  5207             88  PAY-WEEKLY                   VALUE '1'.
  5208             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5209             88  PAY-BI-WEEKLY                VALUE '3'.
  5210             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5211         16  CM-LOAN-NUMBER                PIC X(8).
  5212         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5213         16  CM-OLD-LOF                    PIC XXX.
  5214*        16  CM-LOAN-OFFICER               PIC XXX.
  5215         16  CM-REIN-TABLE                 PIC XXX.
  5216         16  CM-SPECIAL-REIN-CODE          PIC X.
  5217         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5218         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5219         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5220
  5221     12  CM-STATUS-DATA.
  5222         16  CM-ENTRY-STATUS               PIC X.
  5223         16  CM-ENTRY-DT                   PIC XX.
  5224
  5225         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5226         16  CM-LF-CANCEL-DT               PIC XX.
  5227         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5228
  5229         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5230         16  CM-LF-DEATH-DT                PIC XX.
  5231         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5232
  5233         16  CM-LF-CURRENT-STATUS          PIC X.
  5234             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5235                                                'M' '4' '5' '9'.
  5236             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5237             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5238             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5239             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  97
* EL130.cbl
  5240             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5241             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5242             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5243             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5244             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5245             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5246             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5247             88  CM-LF-DECLINED               VALUE 'D'.
  5248             88  CM-LF-VOIDED                 VALUE 'V'.
  5249
  5250         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5251         16  CM-AH-CANCEL-DT               PIC XX.
  5252         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5253
  5254         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5255         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5256         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5257
  5258         16  CM-AH-CURRENT-STATUS          PIC X.
  5259             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5260                                                'M' '4' '5' '9'.
  5261             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5262             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5263             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5264             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5265             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5266             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5267             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5268             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5269             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5270             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5271             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5272             88  CM-AH-DECLINED               VALUE 'D'.
  5273             88  CM-AH-VOIDED                 VALUE 'V'.
  5274
  5275         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5276             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5277             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5278             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5279         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5280
  5281         16  CM-ENTRY-BATCH                PIC X(6).
  5282         16  CM-LF-EXIT-BATCH              PIC X(6).
  5283         16  CM-AH-EXIT-BATCH              PIC X(6).
  5284         16  CM-LAST-MONTH-END             PIC XX.
  5285
  5286     12  CM-NOTE-SW                        PIC X.
  5287         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5288         88  CERT-NOTES-PRESENT               VALUE '1'.
  5289         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5290         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5291         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5292         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5293         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5294         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5295     12  CM-COMP-EXCP-SW                   PIC X.
  5296         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5297         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  98
* EL130.cbl
  5298     12  CM-INSURED-ADDRESS-SW             PIC X.
  5299         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5300         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5301
  5302*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5303     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5304     12  FILLER                            PIC X.
  5305
  5306*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5307     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5308     12  FILLER                            PIC X.
  5309*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5310     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5311
  5312     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5313         88  CERT-ADDED-BATCH                 VALUE ' '.
  5314         88  CERT-ADDED-ONLINE                VALUE '1'.
  5315         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5316         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5317         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5318     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5319         88  CERT-AS-LOADED                   VALUE ' '.
  5320         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5321         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5322         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5323         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5324         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5325         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5326         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5327
  5328     12  CM-ACCOUNT-COMM-PCTS.
  5329         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5330         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5331
  5332     12  CM-USER-FIELD                     PIC X.
  5333     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5334     12  CM-CLP-STATE                      PIC XX.
  5335     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5336     12  CM-USER-RESERVED                  PIC XXX.
  5337     12  FILLER REDEFINES CM-USER-RESERVED.
  5338         16  CM-AH-CLASS-CD                PIC XX.
  5339         16  F                             PIC X.
  5340******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  99
* EL130.cbl
  5342*    COPY ERCACCT.
  5343******************************************************************
  5344*                                                                *
  5345*                                                                *
  5346*                            ERCACCT                             *
  5347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5348*                            VMOD=2.031                          *
  5349*                                                                *
  5350*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5351*                                                                *
  5352*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5353*   VSAM ACCOUNT MASTER FILES.                                   *
  5354*                                                                *
  5355*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5356*                                                                *
  5357*   FILE TYPE = VSAM,KSDS                                        *
  5358*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5359*                                                                *
  5360*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5361*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5362*                                                                *
  5363*   LOG = NO                                                     *
  5364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5365*                                                                *
  5366*                                                                *
  5367******************************************************************
  5368*                   C H A N G E   L O G
  5369*
  5370* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5371*-----------------------------------------------------------------
  5372*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5373* EFFECTIVE    NUMBER
  5374*-----------------------------------------------------------------
  5375* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5376* 092705    2005050300006  PEMA  ADD SPP LEASES
  5377* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5378* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5379* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5380* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5381* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5382******************************************************************
  5383
  5384 01  ACCOUNT-MASTER.
  5385     12  AM-RECORD-ID                      PIC XX.
  5386         88  VALID-AM-ID                      VALUE 'AM'.
  5387
  5388     12  AM-CONTROL-PRIMARY.
  5389         16  AM-COMPANY-CD                 PIC X.
  5390         16  AM-MSTR-CNTRL.
  5391             20  AM-CONTROL-A.
  5392                 24  AM-CARRIER            PIC X.
  5393                 24  AM-GROUPING.
  5394                     28 AM-GROUPING-PREFIX PIC XXX.
  5395                     28 AM-GROUPING-PRIME  PIC XXX.
  5396                 24  AM-STATE              PIC XX.
  5397                 24  AM-ACCOUNT.
  5398                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5399                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 100
* EL130.cbl
  5400             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5401                                           PIC X(19).
  5402             20  AM-CNTRL-B.
  5403                 24  AM-EXPIRATION-DT      PIC XX.
  5404                 24  FILLER                PIC X(4).
  5405             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5406                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5407
  5408     12  AM-CONTROL-BY-VAR-GRP.
  5409         16  AM-COMPANY-CD-A1              PIC X.
  5410         16  AM-VG-CARRIER                 PIC X.
  5411         16  AM-VG-GROUPING                PIC X(6).
  5412         16  AM-VG-STATE                   PIC XX.
  5413         16  AM-VG-ACCOUNT                 PIC X(10).
  5414         16  AM-VG-DATE.
  5415             20  AM-VG-EXPIRATION-DT       PIC XX.
  5416             20  FILLER                    PIC X(4).
  5417         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5418                                           PIC 9(11)      COMP-3.
  5419     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5420         16  FILLER                        PIC X(10).
  5421         16  AM-VG-KEY3.
  5422             20  AM-VG3-ACCOUNT            PIC X(10).
  5423             20  AM-VG3-EXP-DT             PIC XX.
  5424         16  FILLER                        PIC X(4).
  5425     12  AM-MAINT-INFORMATION.
  5426         16  AM-LAST-MAINT-DT              PIC XX.
  5427         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5428         16  AM-LAST-MAINT-USER            PIC X(4).
  5429         16  FILLER                        PIC XX.
  5430
  5431     12  AM-EFFECTIVE-DT                   PIC XX.
  5432     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5433
  5434     12  AM-PREV-DATES  COMP-3.
  5435         16  AM-PREV-EXP-DT                PIC 9(11).
  5436         16  AM-PREV-EFF-DT                PIC 9(11).
  5437
  5438     12  AM-REPORT-CODE-1                  PIC X(10).
  5439     12  AM-REPORT-CODE-2                  PIC X(10).
  5440
  5441     12  AM-CITY-CODE                      PIC X(4).
  5442     12  AM-COUNTY-PARISH                  PIC X(6).
  5443
  5444     12  AM-NAME                           PIC X(30).
  5445     12  AM-PERSON                         PIC X(30).
  5446     12  AM-ADDRS                          PIC X(30).
  5447     12  AM-CITY.
  5448         16  AM-ADDR-CITY                  PIC X(28).
  5449         16  AM-ADDR-STATE                 PIC XX.
  5450     12  AM-ZIP.
  5451         16  AM-ZIP-PRIME.
  5452             20  AM-ZIP-PRI-1ST            PIC X.
  5453                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5454             20  FILLER                    PIC X(4).
  5455         16  AM-ZIP-PLUS4                  PIC X(4).
  5456     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5457         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 101
* EL130.cbl
  5458         16  AM-CAN-POSTAL-2               PIC XXX.
  5459         16  FILLER                        PIC XXX.
  5460     12  AM-TEL-NO.
  5461         16  AM-AREA-CODE                  PIC 999.
  5462         16  AM-TEL-PRE                    PIC 999.
  5463         16  AM-TEL-NBR                    PIC 9(4).
  5464     12  AM-TEL-LOC                        PIC X.
  5465         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5466         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5467
  5468     12  AM-COMM-STRUCTURE.
  5469         16  AM-DEFN-1.
  5470             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5471                 24  AM-AGT.
  5472                     28  AM-AGT-PREFIX     PIC X(4).
  5473                     28  AM-AGT-PRIME      PIC X(6).
  5474                 24  AM-COM-TYP            PIC X.
  5475                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5476                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5477                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5478                 24  AM-RECALC-LV-INDIC    PIC X.
  5479                 24  AM-RETRO-LV-INDIC     PIC X.
  5480                 24  AM-GL-CODES           PIC X.
  5481                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5482                 24  FILLER                PIC X(01).
  5483         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5484             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5485                 24  FILLER                PIC X(11).
  5486                 24  AM-L-COMA             PIC XXX.
  5487                 24  AM-J-COMA             PIC XXX.
  5488                 24  AM-A-COMA             PIC XXX.
  5489                 24  FILLER                PIC X(6).
  5490
  5491     12  AM-COMM-CHANGE-STATUS             PIC X.
  5492         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5493
  5494     12  AM-CSR-CODE                       PIC X(4).
  5495
  5496     12  AM-BILLING-STATUS                 PIC X.
  5497         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5498         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5499     12  AM-AUTO-REFUND-SW                 PIC X.
  5500         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5501         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5502     12  AM-GPCD                           PIC 99.
  5503     12  AM-IG                             PIC X.
  5504         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5505         88  AM-HAS-GROUP                     VALUE '2'.
  5506     12  AM-STATUS                         PIC X.
  5507         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5508         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5509         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5510         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5511         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5512         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5513     12  AM-REMIT-TO                       PIC 99.
  5514     12  AM-ID-NO                          PIC X(11).
  5515
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 102
* EL130.cbl
  5516     12  AM-CAL-TABLE                      PIC XX.
  5517     12  AM-LF-DEVIATION                   PIC XXX.
  5518     12  AM-AH-DEVIATION                   PIC XXX.
  5519     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5520     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5521     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5522     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5523     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5524     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5525
  5526     12  AM-USER-FIELDS.
  5527         16  AM-FLD-1                      PIC XX.
  5528         16  AM-FLD-2                      PIC XX.
  5529         16  AM-FLD-3                      PIC XX.
  5530         16  AM-FLD-4                      PIC XX.
  5531         16  AM-FLD-5                      PIC XX.
  5532
  5533     12  AM-1ST-PROD-DATE.
  5534         16  AM-1ST-PROD-YR                PIC XX.
  5535         16  AM-1ST-PROD-MO                PIC XX.
  5536         16  AM-1ST-PROD-DA                PIC XX.
  5537     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5538     12  AM-CERTS-PURGED-DATE.
  5539         16  AM-PUR-YR                     PIC XX.
  5540         16  AM-PUR-MO                     PIC XX.
  5541         16  AM-PUR-DA                     PIC XX.
  5542     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5543     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5544     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5545     12  AM-INACTIVE-DATE.
  5546         16  AM-INA-MO                     PIC 99.
  5547         16  AM-INA-DA                     PIC 99.
  5548         16  AM-INA-YR                     PIC 99.
  5549     12  AM-AR-HI-CERT-DATE                PIC XX.
  5550
  5551     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5552     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5553
  5554     12  AM-OB-PAYMENT-MODE                PIC X.
  5555         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5556         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5557         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5558         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5559
  5560     12  AM-AH-ONLY-INDICATOR              PIC X.
  5561         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5562         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5563
  5564     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5565
  5566     12  AM-OVER-SHORT.
  5567         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5568         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5569
  5570     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5571     12  AM-DCC-CLP-STATE                  PIC XX.
  5572
  5573     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 103
* EL130.cbl
  5574     12  AM-RECALC-REIN                    PIC X.
  5575
  5576     12  AM-REI-TABLE                      PIC XXX.
  5577     12  AM-REI-ET-LF                      PIC X.
  5578     12  AM-REI-ET-AH                      PIC X.
  5579     12  AM-REI-PE-LF                      PIC X.
  5580     12  AM-REI-PE-AH                      PIC X.
  5581     12  AM-REI-PRT-ST                     PIC X.
  5582     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5583     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5584     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5585     12  AM-REI-GROUP-A                    PIC X(6).
  5586     12  AM-REI-MORT                       PIC X(4).
  5587     12  AM-REI-PRT-OW                     PIC X.
  5588     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5589     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5590     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5591     12  AM-REI-GROUP-B                    PIC X(6).
  5592
  5593     12  AM-TRUST-TYPE                     PIC X(2).
  5594
  5595     12  AM-EMPLOYER-STMT-USED             PIC X.
  5596     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5597
  5598     12  AM-STD-AH-TYPE                    PIC XX.
  5599     12  AM-EARN-METHODS.
  5600         16  AM-EARN-METHOD-R              PIC X.
  5601             88 AM-REF-RL-R78                 VALUE 'R'.
  5602             88 AM-REF-RL-PR                  VALUE 'P'.
  5603             88 AM-REF-RL-MEAN                VALUE 'M'.
  5604             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5605         16  AM-EARN-METHOD-L              PIC X.
  5606             88 AM-REF-LL-R78                 VALUE 'R'.
  5607             88 AM-REF-LL-PR                  VALUE 'P'.
  5608             88 AM-REF-LL-MEAN                VALUE 'M'.
  5609             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5610         16  AM-EARN-METHOD-A              PIC X.
  5611             88 AM-REF-AH-R78                 VALUE 'R'.
  5612             88 AM-REF-AH-PR                  VALUE 'P'.
  5613             88 AM-REF-AH-MEAN                VALUE 'M'.
  5614             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5615             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5616             88 AM-REF-AH-NET                 VALUE 'N'.
  5617
  5618     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5619     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5620     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5621
  5622     12  AM-RET-Y-N                        PIC X.
  5623     12  AM-RET-P-E                        PIC X.
  5624     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5625     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5626     12  AM-RET-GRP                        PIC X(6).
  5627     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5628         16  AM-POOL-PRIME                 PIC XXX.
  5629         16  AM-POOL-SUB                   PIC XXX.
  5630     12  AM-RETRO-EARNINGS.
  5631         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 104
* EL130.cbl
  5632         16  AM-RET-EARN-L                 PIC X.
  5633         16  AM-RET-EARN-A                 PIC X.
  5634     12  AM-RET-ST-TAX-USE                 PIC X.
  5635         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5636         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5637     12  AM-RETRO-BEG-EARNINGS.
  5638         16  AM-RET-BEG-EARN-R             PIC X.
  5639         16  AM-RET-BEG-EARN-L             PIC X.
  5640         16  AM-RET-BEG-EARN-A             PIC X.
  5641     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5642     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5643
  5644     12  AM-USER-SELECT-OPTIONS.
  5645         16  AM-USER-SELECT-1              PIC X(10).
  5646         16  AM-USER-SELECT-2              PIC X(10).
  5647         16  AM-USER-SELECT-3              PIC X(10).
  5648         16  AM-USER-SELECT-4              PIC X(10).
  5649         16  AM-USER-SELECT-5              PIC X(10).
  5650
  5651     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5652
  5653     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5654
  5655     12  AM-RPT045A-SWITCH                 PIC X.
  5656         88  RPT045A-OFF                   VALUE 'N'.
  5657
  5658     12  AM-INSURANCE-LIMITS.
  5659         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5660         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5661
  5662     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5663         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5664
  5665     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5666         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5667         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5668
  5669     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5670
  5671     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5672     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5673     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5674     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5675     12  AM-DCC-UEF-STATE                  PIC XX.
  5676     12  FILLER                            PIC XXX.
  5677     12  AM-REPORT-CODE-3                  PIC X(10).
  5678*    12  FILLER                            PIC X(22).
  5679
  5680     12  AM-RESERVE-DATE.
  5681         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5682         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5683         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5684
  5685     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5686     12  AM-NOTIFICATION-TYPES.
  5687         16  AM-NOTIF-OF-LETTERS           PIC X.
  5688         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5689         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 105
* EL130.cbl
  5690         16  AM-NOTIF-OF-STATUS            PIC X.
  5691
  5692     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5693         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5694         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5695         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5696         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5697
  5698     12  AM-BENEFIT-CONTROLS.
  5699         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5700             20  AM-BENEFIT-CODE           PIC XX.
  5701             20  AM-BENEFIT-TYPE           PIC X.
  5702             20  AM-BENEFIT-REVISION       PIC XXX.
  5703             20  AM-BENEFIT-REM-TERM       PIC X.
  5704             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5705             20  FILLER                    PIC XX.
  5706         16  FILLER                        PIC X(80).
  5707
  5708     12  AM-TRANSFER-DATA.
  5709         16  AM-TRANSFERRED-FROM.
  5710             20  AM-TRNFROM-CARRIER        PIC X.
  5711             20  AM-TRNFROM-GROUPING.
  5712                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5713                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5714             20  AM-TRNFROM-STATE          PIC XX.
  5715             20  AM-TRNFROM-ACCOUNT.
  5716                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5717                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5718             20  AM-TRNFROM-DTE            PIC XX.
  5719         16  AM-TRANSFERRED-TO.
  5720             20  AM-TRNTO-CARRIER          PIC X.
  5721             20  AM-TRNTO-GROUPING.
  5722                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5723                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5724             20  AM-TRNTO-STATE            PIC XX.
  5725             20  AM-TRNTO-ACCOUNT.
  5726                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5727                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5728             20  AM-TRNTO-DTE              PIC XX.
  5729         16  FILLER                        PIC X(10).
  5730
  5731     12  AM-SAVED-REMIT-TO                 PIC 99.
  5732
  5733     12  AM-COMM-STRUCTURE-SAVED.
  5734         16  AM-DEFN-1-SAVED.
  5735             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5736                 24  AM-AGT-SV             PIC X(10).
  5737                 24  AM-COM-TYP-SV         PIC X.
  5738                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5739                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5740                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5741                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5742                 24  FILLER                PIC X.
  5743                 24  AM-GL-CODES-SV        PIC X.
  5744                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5745                 24  FILLER                PIC X.
  5746         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5747             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 106
* EL130.cbl
  5748                 24  FILLER                PIC X(11).
  5749                 24  AM-L-COMA-SV          PIC XXX.
  5750                 24  AM-J-COMA-SV          PIC XXX.
  5751                 24  AM-A-COMA-SV          PIC XXX.
  5752                 24  FILLER                PIC X(6).
  5753
  5754     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5755         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5756            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5757            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5758            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5759
  5760     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5761     12  FILLER                            PIC X(120).
  5762
  5763     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5764         16  AM-CONTROL-NAME               PIC X(30).
  5765         16  AM-EXECUTIVE-ONE.
  5766             20  AM-EXEC1-NAME             PIC X(15).
  5767             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5768                                                          COMP-3.
  5769             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5770                                                          COMP-3.
  5771         16  AM-EXECUTIVE-TWO.
  5772             20  AM-EXEC2-NAME             PIC X(15).
  5773             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5774                                                          COMP-3.
  5775             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5776                                                          COMP-3.
  5777
  5778     12  AM-RETRO-ADDITIONAL-DATA.
  5779         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5780         16  AM-RETRO-PREM-P-E             PIC X.
  5781         16  AM-RETRO-CLMS-P-I             PIC X.
  5782         16  AM-RETRO-RET-BRACKET-LF.
  5783             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5784                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5785                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5786             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5787                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5788                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5789             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5790                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5791                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5792         16  AM-RETRO-RET-BRACKET-AH.
  5793             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5794                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5795                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5796                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5797             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5798                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5799                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5800             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5801                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5802                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5803
  5804     12  AM-COMMENTS.
  5805         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 107
* EL130.cbl
  5806
  5807     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5808         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5809         16  AM-FLI-BILLING-CODE           PIC X.
  5810         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5811         16  AM-FLI-UNITED-IDENT           PIC X.
  5812         16  AM-FLI-INTEREST-LOST-DATA.
  5813             20  AM-FLI-BANK-NO            PIC X(5).
  5814             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5815             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5816             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5817         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5818             20  AM-FLI-AGT                PIC X(9).
  5819             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5820             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5821         16  FILLER                        PIC X(102).
  5822
  5823     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5824         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5825             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5826             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5827             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5828             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5829             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5830         16  FILLER                          PIC X(10).
  5831******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 108
* EL130.cbl
  5833*    COPY ELCTRLR.
  5834******************************************************************
  5835*                                                                *
  5836*                            ELCTRLR.                            *
  5837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5838*                            VMOD=2.014                          *
  5839*                                                                *
  5840*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5841*                                                                *
  5842*   FILE TYPE = VSAM,KSDS                                        *
  5843*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5844*                                                                *
  5845*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5846*       ALTERNATE INDEX = NONE                                   *
  5847*                                                                *
  5848*   LOG = YES                                                    *
  5849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5850******************************************************************
  5851*                   C H A N G E   L O G
  5852*
  5853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5854*-----------------------------------------------------------------
  5855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5856* EFFECTIVE    NUMBER
  5857*-----------------------------------------------------------------
  5858* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5859* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5860* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5861* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5862* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5863* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5864* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5865* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5866* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5867* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5868* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5869* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5870* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5871* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5872* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5873* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5874* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5875* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5876* 040814    2014030500002  AJRA  ADD ICD CODES
  5877* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5878******************************************************************
  5879 01  ACTIVITY-TRAILERS.
  5880     12  AT-RECORD-ID                    PIC XX.
  5881         88  VALID-AT-ID                       VALUE 'AT'.
  5882
  5883     12  AT-CONTROL-PRIMARY.
  5884         16  AT-COMPANY-CD               PIC X.
  5885         16  AT-CARRIER                  PIC X.
  5886         16  AT-CLAIM-NO                 PIC X(7).
  5887         16  AT-CERT-NO.
  5888             20  AT-CERT-PRIME           PIC X(10).
  5889             20  AT-CERT-SFX             PIC X.
  5890         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 109
* EL130.cbl
  5891             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5892             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5893             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5894             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5895             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5896             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5897             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5898             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5899             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5900             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5901             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5902             88  AT-BENEFICIARY-TRL           VALUE +91.
  5903             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5904             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5905             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5906             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5907
  5908     12  AT-TRAILER-TYPE                 PIC X.
  5909         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5910         88  PAYMENT-TR                       VALUE '2'.
  5911         88  AUTO-PAY-TR                      VALUE '3'.
  5912         88  CORRESPONDENCE-TR                VALUE '4'.
  5913         88  ADDRESS-TR                       VALUE '5'.
  5914         88  GENERAL-INFO-TR                  VALUE '6'.
  5915         88  AUTO-PROMPT-TR                   VALUE '7'.
  5916         88  DENIAL-TR                        VALUE '8'.
  5917         88  INCURRED-CHG-TR                  VALUE '9'.
  5918         88  FORM-CONTROL-TR                  VALUE 'A'.
  5919
  5920     12  AT-RECORDED-DT                  PIC XX.
  5921     12  AT-RECORDED-BY                  PIC X(4).
  5922     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5923
  5924     12  AT-TRAILER-BODY                 PIC X(165).
  5925
  5926     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5927         16  AT-RESERVE-CONTROLS.
  5928             20  AT-MANUAL-SW            PIC X.
  5929                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5930             20  AT-FUTURE-SW            PIC X.
  5931                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5932             20  AT-PTC-SW               PIC X.
  5933                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5934             20  AT-IBNR-SW              PIC X.
  5935                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5936             20  AT-PTC-LF-SW            PIC X.
  5937                 88  AT-LF-PTC-USED          VALUE '1'.
  5938             20  AT-CDT-ACCESS-METHOD    PIC X.
  5939                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5940                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5941                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5942             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5943         16  AT-LAST-COMPUTED-DT         PIC XX.
  5944         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5945         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5946         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5947         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5948         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 110
* EL130.cbl
  5949         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5950         16  AT-EXPENSE-CONTROLS.
  5951             20  AT-EXPENSE-METHOD       PIC X.
  5952                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5953                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5954                 88  PERCENT-OF-PMT           VALUE '3'.
  5955                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5956             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5957             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5958         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5959         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5960
  5961         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5962         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5963
  5964*        16  FILLER                      PIC X(53).
  5965         16  FILLER                      PIC X(47).
  5966
  5967         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5968         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5969
  5970         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5971             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5972             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5973*                    C = CLOSED
  5974*                    O = OPEN
  5975             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5976*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5977
  5978     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5979         16  AT-PAYMENT-TYPE             PIC X.
  5980             88  PARTIAL-PAYMENT                VALUE '1'.
  5981             88  FINAL-PAYMENT                  VALUE '2'.
  5982             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5983             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5984             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5985             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5986             88  VOIDED-PAYMENT                 VALUE '9'.
  5987             88  TRANSFER                       VALUE 'T'.
  5988             88  LIFE-INTEREST                  VALUE 'I'.
  5989
  5990         16  AT-CLAIM-TYPE               PIC X.
  5991             88  PAID-FOR-AH                    VALUE 'A'.
  5992             88  PAID-FOR-LIFE                  VALUE 'L'.
  5993             88  PAID-FOR-IUI                   VALUE 'I'.
  5994             88  PAID-FOR-GAP                   VALUE 'G'.
  5995             88  PAID-FOR-FAM                   VALUE 'F'.
  5996         16  AT-CLAIM-PREM-TYPE          PIC X.
  5997             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5998             88  AT-O-B-COVERAGE                VALUE '2'.
  5999             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6000         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6001         16  AT-CHECK-NO                 PIC X(7).
  6002         16  AT-PAID-FROM-DT             PIC XX.
  6003         16  AT-PAID-THRU-DT             PIC XX.
  6004         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6005         16  FILLER                      PIC X.
  6006         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 111
* EL130.cbl
  6007         16  AT-PAYMENT-ORIGIN           PIC X.
  6008             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6009             88  ONLINE-AUTO-PMT                VALUE '2'.
  6010             88  OFFLINE-PMT                    VALUE '3'.
  6011         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6012         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6013         16  AT-VOID-DATA.
  6014             20  AT-VOID-DT              PIC XX.
  6015*00144       20  AT-VOID-REASON          PIC X(30).
  6016             20  AT-VOID-REASON          PIC X(26).
  6017         16  AT-PMT-APPROVED-BY          PIC X(04).
  6018         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6019         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6020         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6021                                         PIC S99V9(5)  COMP-3.
  6022         16  AT-CREDIT-INTERFACE.
  6023             20  AT-PMT-SELECT-DT        PIC XX.
  6024                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6025             20  AT-PMT-ACCEPT-DT        PIC XX.
  6026                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6027             20  AT-VOID-SELECT-DT       PIC XX.
  6028                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6029             20  AT-VOID-ACCEPT-DT       PIC XX.
  6030                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6031
  6032         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6033                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6034                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6035         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6036
  6037         16  AT-FORCE-CONTROL            PIC X.
  6038             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6039         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6040         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6041         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6042         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6043         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6044         16  AT-BENEFIT-TYPE             PIC X.
  6045
  6046         16  AT-EXPENSE-TYPE             PIC X.
  6047         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6048
  6049         16  AT-PAYEE-TYPE-CD.
  6050             20  AT-PAYEE-TYPE           PIC X.
  6051                 88  INSURED-PAID           VALUE 'I'.
  6052                 88  BENEFICIARY-PAID       VALUE 'B'.
  6053                 88  ACCOUNT-PAID           VALUE 'A'.
  6054                 88  OTHER-1-PAID           VALUE 'O'.
  6055                 88  OTHER-2-PAID           VALUE 'Q'.
  6056                 88  DOCTOR-PAID            VALUE 'P'.
  6057                 88  EMPLOYER-PAID          VALUE 'E'.
  6058             20  AT-PAYEE-SEQ            PIC X.
  6059
  6060         16  AT-CASH-PAYMENT             PIC X.
  6061         16  AT-GROUPED-PAYMENT          PIC X.
  6062         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6063         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6064         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 112
* EL130.cbl
  6065         16  AT-VOID-TYPE                PIC X.
  6066             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6067             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6068         16  AT-AIG-UNEMP-IND            PIC X.
  6069             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6070         16  AT-ASSOCIATES               PIC X.
  6071             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6072             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6073
  6074         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6075         16  AT-CV-PMT-CODE              PIC X.
  6076             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6077             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6078             88  FULL-ADD-PAYMENT           VALUE '3'.
  6079             88  HALF-ADD-PAYMENT           VALUE '4'.
  6080             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6081             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6082             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6083             88  ADDL-PAYMENT               VALUE '8'.
  6084
  6085         16  AT-EOB-CODE1                PIC XXX.
  6086         16  AT-EOB-CODE2                PIC XXX.
  6087         16  AT-EOB-CODE3                PIC XXX.
  6088         16  FILLER REDEFINES AT-EOB-CODE3.
  6089             20  AT-PRINT-CLM-FORM       PIC X.
  6090             20  AT-PRINT-SURVEY         PIC X.
  6091             20  AT-SPECIAL-RELEASE      PIC X.
  6092         16  AT-EOB-CODE4                PIC XXX.
  6093         16  FILLER REDEFINES AT-EOB-CODE4.
  6094             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6095             20  FILLER                  PIC X.
  6096         16  AT-EOB-CODE5                PIC XXX.
  6097         16  FILLER REDEFINES AT-EOB-CODE5.
  6098             20  AT-PMT-PROOF-DT         PIC XX.
  6099             20  FILLER                  PIC X.
  6100
  6101         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6102             88  AT-PRINT-EOB            VALUE 'Y'.
  6103
  6104         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6105         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6106
  6107     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6108         16  AT-SCHEDULE-START-DT        PIC XX.
  6109         16  AT-SCHEDULE-END-DT          PIC XX.
  6110         16  AT-TERMINATED-DT            PIC XX.
  6111         16  AT-LAST-PMT-TYPE            PIC X.
  6112             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6113             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6114         16  AT-FIRST-PMT-DATA.
  6115             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6116             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6117             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6118         16  AT-REGULAR-PMT-DATA.
  6119             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6120             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6121             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6122         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 113
* EL130.cbl
  6123             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6124                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6125                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6126                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6127                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6128                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6129             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6130         16  AT-AUTO-PAY-DAY             PIC 99.
  6131         16  AT-AUTO-CASH                PIC X.
  6132             88  AT-CASH                      VALUE 'Y'.
  6133             88  AT-NON-CASH                  VALUE 'N'.
  6134*        16  FILLER                      PIC X(129).
  6135         16  AT-AUTO-END-LETTER          PIC X(4).
  6136         16  FILLER                      PIC X(125).
  6137
  6138         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6139         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6140
  6141     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6142         16  AT-LETTER-SENT-DT           PIC XX.
  6143         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6144         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6145         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6146         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6147         16  AT-LETTER-ORIGIN            PIC X.
  6148             88  ONLINE-CREATION              VALUE '1' '3'.
  6149             88  OFFLINE-CREATION             VALUE '2' '4'.
  6150             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6151             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6152         16  AT-STD-LETTER-FORM          PIC X(4).
  6153         16  AT-REASON-TEXT              PIC X(70).
  6154         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6155         16  AT-ADDRESEE-TYPE            PIC X.
  6156              88  INSURED-ADDRESEE            VALUE 'I'.
  6157              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6158              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6159              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6160              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6161              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6162              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6163         16  AT-ADDRESSEE-NAME           PIC X(30).
  6164         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6165         16  AT-RESEND-PRINT-DATE        PIC XX.
  6166         16  AT-CORR-SOL-UNSOL           PIC X.
  6167         16  AT-LETTER-PURGED-DT         PIC XX.
  6168*
  6169*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6170*
  6171         16  AT-CSO-REDEFINITION.
  6172             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6173             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6174             20  AT-LETTER-TO-BENE       PIC X(1).
  6175             20  AT-STOP-LETTER-DT       PIC X(2).
  6176             20  FILLER                  PIC X(19).
  6177*             20  FILLER                  PIC X(27).
  6178             20  AT-CSO-LETTER-STATUS    PIC X.
  6179                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6180                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 114
* EL130.cbl
  6181                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6182             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6183             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6184*
  6185*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6186*
  6187*        16  FILLER                      PIC X(26).
  6188*
  6189*        16  AT-DMD-BSR-CODE             PIC X.
  6190*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6191*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6192*
  6193*        16  AT-DMD-LETTER-STATUS        PIC X.
  6194*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6195*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6196*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6197*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6198*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6199
  6200         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6201         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6202
  6203     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6204         16  AT-ADDRESS-TYPE             PIC X.
  6205             88  INSURED-ADDRESS               VALUE 'I'.
  6206             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6207             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6208             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6209             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6210             88  OTHER-ADDRESS-1               VALUE 'O'.
  6211             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6212         16  AT-MAIL-TO-NAME             PIC X(30).
  6213         16  AT-ADDRESS-LINE-1           PIC X(30).
  6214         16  AT-ADDRESS-LINE-2           PIC X(30).
  6215         16  AT-CITY-STATE.
  6216             20  AT-CITY                 PIC X(28).
  6217             20  AT-STATE                PIC XX.
  6218         16  AT-ZIP.
  6219             20  AT-ZIP-CODE.
  6220                 24  AT-ZIP-1ST          PIC X.
  6221                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6222                 24  FILLER              PIC X(4).
  6223             20  AT-ZIP-PLUS4            PIC X(4).
  6224         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6225             20  AT-CAN-POSTAL-1         PIC XXX.
  6226             20  AT-CAN-POSTAL-2         PIC XXX.
  6227             20  FILLER                  PIC XXX.
  6228         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6229*         16  FILLER                      PIC X(23).
  6230         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6231         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6232         16  FILLER                      PIC X(13).
  6233         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6234         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6235
  6236     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6237         16  AT-INFO-LINE-1              PIC X(60).
  6238         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 115
* EL130.cbl
  6239             20  AT-NOTE-ERROR-NO OCCURS 15
  6240                                         PIC X(4).
  6241         16  AT-INFO-LINE-2              PIC X(60).
  6242         16  FILLER REDEFINES AT-INFO-LINE-2.
  6243             20  AT-ICD-CODE-1           PIC X(8).
  6244             20  AT-ICD-CODE-2           PIC X(8).
  6245             20  FILLER                  PIC X(44).
  6246         16  AT-INFO-TRAILER-TYPE        PIC X.
  6247             88  AT-ERRORS-NOTE          VALUE 'E'.
  6248             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6249             88  AT-CALL-NOTE            VALUE 'C'.
  6250             88  AT-MAINT-NOTE           VALUE 'M'.
  6251             88  AT-CERT-CHANGE          VALUE 'X'.
  6252             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6253             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6254             88  AT-CERT-CANCELLED       VALUE 'T'.
  6255         16  AT-CALL-TYPE                PIC X.
  6256             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6257             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6258         16  AT-NOTE-CONTINUATION        PIC X.
  6259             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6260         16  AT-EOB-CODES-EXIST          PIC X.
  6261             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6262         16  FILLER                      PIC X(35).
  6263         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6264         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6265
  6266     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6267         16  AT-PROMPT-LINE-1            PIC X(60).
  6268         16  AT-PROMPT-LINE-2            PIC X(60).
  6269         16  AT-PROMPT-START-DT          PIC XX.
  6270         16  AT-PROMPT-END-DT            PIC XX.
  6271         16  FILLER                      PIC X(35).
  6272         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6273         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6274
  6275     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6276         16  AT-DENIAL-INFO-1            PIC X(60).
  6277         16  AT-DENIAL-INFO-2            PIC X(60).
  6278         16  AT-DENIAL-DT                PIC XX.
  6279         16  AT-RETRACTION-DT            PIC XX.
  6280         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6281*         16  FILLER                      PIC X(31).
  6282         16  AT-DENIAL-PROOF-DT          PIC XX.
  6283         16  FILLER                      PIC X(29).
  6284         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6285         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6286
  6287     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6288         16  AT-OLD-INCURRED-DT          PIC XX.
  6289         16  AT-OLD-REPORTED-DT          PIC XX.
  6290         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6291         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6292         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6293         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6294         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6295         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6296         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 116
* EL130.cbl
  6297         16  AT-OLD-DIAG-CODE            PIC X(6).
  6298         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6299         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6300         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6301         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6302         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6303         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6304         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6305         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6306         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6307         16  FILLER                      PIC X(9).
  6308         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6309
  6310     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6311         16  AT-FORM-SEND-ON-DT          PIC XX.
  6312         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6313         16  AT-FORM-RE-SEND-DT          PIC XX.
  6314         16  AT-FORM-ANSWERED-DT         PIC XX.
  6315         16  AT-FORM-PRINTED-DT          PIC XX.
  6316         16  AT-FORM-REPRINT-DT          PIC XX.
  6317         16  AT-FORM-TYPE                PIC X.
  6318             88  INITIAL-FORM                  VALUE '1'.
  6319             88  PROGRESS-FORM                 VALUE '2'.
  6320         16  AT-INSTRUCT-LN-1            PIC X(28).
  6321         16  AT-INSTRUCT-LN-2            PIC X(28).
  6322         16  AT-INSTRUCT-LN-3            PIC X(28).
  6323         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6324         16  AT-FORM-ADDRESS             PIC X.
  6325             88  FORM-TO-INSURED              VALUE 'I'.
  6326             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6327             88  FORM-TO-OTHER-1              VALUE 'O'.
  6328             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6329         16  AT-RELATED-1.
  6330             20 AT-REL-CARR-1            PIC X.
  6331             20 AT-REL-CLAIM-1           PIC X(7).
  6332             20 AT-REL-CERT-1            PIC X(11).
  6333         16  AT-RELATED-2.
  6334             20 AT-REL-CARR-2            PIC X.
  6335             20 AT-REL-CLAIM-2           PIC X(7).
  6336             20 AT-REL-CERT-2            PIC X(11).
  6337         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6338         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6339         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6340         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6341         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6342         16  AT-STOP-FORM-DT             PIC X(2).
  6343
  6344         16  FILLER                      PIC X(09).
  6345         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6346         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6347******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 117
* EL130.cbl
  6349*    COPY ELCBENE.
  6350******************************************************************
  6351*                                                                *
  6352*                            ELCBENE.                            *
  6353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6354*                            VMOD=2.006                          *
  6355*                                                                *
  6356*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6357*                                                                *
  6358*   FILE TYPE = VSAM,KSDS                                        *
  6359*   RECORD SIZE = 500   RECFORM = FIX                            *
  6360*                                                                *
  6361*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6362*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6363*                                                                *
  6364*   LOG = YES                                                    *
  6365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6366*                                                                *
  6367*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6368******************************************************************
  6369
  6370 01  BENEFICIARY-MASTER.
  6371     12  BE-RECORD-ID                PIC XX.
  6372         88  VALID-BE-ID                VALUE 'BE'.
  6373
  6374     12  BE-CONTROL-PRIMARY.
  6375         16  BE-COMPANY-CD           PIC X.
  6376         16  BE-RECORD-TYPE          PIC X.
  6377             88  BENEFICIARY-RECORD  VALUE 'B'.
  6378             88  ADJUSTOR-RECORD     VALUE 'A'.
  6379         16  BE-BENEFICIARY          PIC X(10).
  6380     12  BE-CONTROL-BY-NAME.
  6381         16  BE-COMPANY-CD-A1        PIC X.
  6382         16  BE-RECORD-TYPE-A1       PIC X.
  6383         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6384         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6385
  6386     12  BE-LAST-MAINT-DT            PIC XX.
  6387     12  BE-LAST-MAINT-BY            PIC X(4).
  6388     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6389
  6390     12  BE-ADDRESS-DATA.
  6391         16  BE-MAIL-TO-NAME         PIC X(30).
  6392         16  BE-ADDRESS-LINE-1       PIC X(30).
  6393         16  BE-ADDRESS-LINE-2       PIC X(30).
  6394         16  BE-ADDRESS-LINE-3       PIC X(30).
  6395         16  BE-CITY-STATE.
  6396             20  BE-CITY             PIC X(28).
  6397             20  BE-STATE            PIC XX.
  6398         16  BE-ZIP-CODE.
  6399             20  BE-ZIP-PRIME.
  6400                 24  BE-ZIP-1ST      PIC X.
  6401                     88  BE-CANADIAN-POST-CODE
  6402                                         VALUE 'A' THRU 'Z'.
  6403                 24  FILLER          PIC X(4).
  6404             20  BE-ZIP-PLUS4        PIC X(4).
  6405         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6406             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 118
* EL130.cbl
  6407             20  BE-CAN-POSTAL-2     PIC XXX.
  6408             20  FILLER              PIC XXX.
  6409         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6410         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6411
  6412******************************************************************
  6413*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6414*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6415******************************************************************
  6416     12  BE-CARRIER                  PIC X.
  6417
  6418     12  BE-ADDRESS-DATA2.
  6419         16  BE-MAIL-TO-NAME2        PIC X(30).
  6420         16  BE-ADDRESS-LINE-12      PIC X(30).
  6421         16  BE-ADDRESS-LINE-22      PIC X(30).
  6422         16  BE-ADDRESS-LINE-32      PIC X(30).
  6423         16  BE-CITY-STATE2.
  6424             20  BE-CITY2            PIC X(28).
  6425             20  BE-STATE2           PIC XX.
  6426         16  BE-ZIP-CODE2.
  6427             20  BE-ZIP-PRIME2.
  6428                 24  BE-ZIP-1ST2     PIC X.
  6429                     88  BE-CANADIAN-POST-CODE2
  6430                                         VALUE 'A' THRU 'Z'.
  6431                 24  FILLER          PIC X(4).
  6432             20  BE-ZIP-PLUS42       PIC X(4).
  6433         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6434             20  BE-CAN-POSTAL-12    PIC XXX.
  6435             20  BE-CAN-POSTAL-22    PIC XXX.
  6436             20  FILLER              PIC XXX.
  6437         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6438         16  BE-BILLING-STMT-DATA.
  6439             20  BE-BSR              PIC X.
  6440                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6441                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6442             20  BE-BSR-FROM         PIC X(30).
  6443             20  BE-BSR-DEPT         PIC X(30).
  6444             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6445             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6446             20  BE-OUTPUT-TYPE      PIC X.
  6447                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6448                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6449
  6450     12  FILLER                      PIC X(28).
  6451******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 119
* EL130.cbl
  6453*    COPY ELCDAR.
  6454******************************************************************
  6455*                                                                *
  6456*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6457*   FILE TYPE = VSAM,KSDS                                        *
  6458*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6459*   BASE CLUSTER = DLYACTV                                       *
  6460*   LOG = YES                                                    *
  6461*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6462*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6463*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6464*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6465*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6466*               BY PROGRAM "LGINFCE".                            *
  6467*                                                                *
  6468******************************************************************
  6469 01  DAILY-ACTIVITY-RECORD.
  6470     05  DA-KEY.
  6471         10  DA-COMP-CD          PIC X.
  6472         10  DA-CARRIER          PIC X.
  6473         10  DA-CLAIM-NO         PIC X(7).
  6474         10  DA-CERT-NO.
  6475             15  DA-CERT-PRIME   PIC X(10).
  6476             15  DA-CERT-SFX     PIC X.
  6477     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6478     05  DA-RECORD-TYPE          PIC X.
  6479     05  FILLER                  PIC X(2).
  6480******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 120
* EL130.cbl
  6482*    COPY ELCACTQ.
  6483******************************************************************
  6484*                                                                *
  6485*                            ELCACTQ.                            *
  6486*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6487*                            VMOD=2.004                          *
  6488*                                                                *
  6489*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6490*                                                                *
  6491*   FILE TYPE = VSAM,KSDS                                        *
  6492*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6493*                                                                *
  6494*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6495*       ALTERNATE INDEX = NONE                                   *
  6496*                                                                *
  6497*   LOG = YES                                                    *
  6498*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6499*                                                                *
  6500*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6501******************************************************************
  6502
  6503 01  ACTIVITY-QUE.
  6504     12  AQ-RECORD-ID                PIC XX.
  6505         88  VALID-AQ-ID                VALUE 'AQ'.
  6506
  6507     12  AQ-CONTROL-PRIMARY.
  6508         16  AQ-COMPANY-CD           PIC X.
  6509         16  AQ-CARRIER              PIC X.
  6510         16  AQ-CLAIM-NO             PIC X(7).
  6511         16  AQ-CERT-NO.
  6512             20  AQ-CERT-PRIME       PIC X(10).
  6513             20  AQ-CERT-SFX         PIC X.
  6514
  6515     12  AQ-PENDING-ACTIVITY-FLAGS.
  6516         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6517         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6518             88  PENDING-PAYMENTS       VALUE '1'.
  6519         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6520             88  PENDING-FULL-PRINT     VALUE '1'.
  6521             88  PENDING-PART-PRINT     VALUE '2'.
  6522         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6523             88  PENDING-LETTERS        VALUE '1'.
  6524         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6525             88  PENDING-RESTORE        VALUE 'C'.
  6526             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6527
  6528     12  FILLER                      PIC X(20).
  6529
  6530     12  AQ-RESEND-DATE              PIC XX.
  6531     12  AQ-FOLLOWUP-DATE            PIC XX.
  6532     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6533     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6534     12  AQ-AUTO-LETTER              PIC X(4).
  6535     12  FILLER                      PIC XX.
  6536     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6537*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 121
* EL130.cbl
  6539*    COPY ELCARCH.
  6540******************************************************************
  6541*                                                                *
  6542*                            ELCARCH.                            *
  6543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6544*                            VMOD=2.007                          *
  6545*                                                                *
  6546*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6547*                                                                *
  6548*   FILE TYPE = VSAM,KSDS                                        *
  6549*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6550*                                                                *
  6551*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6552*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6553*                                                                *
  6554*   LOG = NO                                                     *
  6555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6556*                                                                *
  6557*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6558******************************************************************
  6559 01  LETTER-ARCHIVE.
  6560     12  LA-RECORD-ID                PIC XX.
  6561         88  VALID-LA-ID                VALUE 'LA'.
  6562
  6563     12  LA-CONTROL-PRIMARY.
  6564         16  LA-COMPANY-CD           PIC X.
  6565         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6566         16  LA-RECORD-TYPE          PIC X.
  6567             88  LA-HEADER-DATA         VALUE '1'.
  6568             88  LA-ADDRESS-DATA        VALUE '2'.
  6569             88  LA-TEXT-DATA           VALUE '3'.
  6570             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6571         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6572
  6573     12  LA-CONTROL-BY-TYPE.
  6574         16  LA-COMPANY-CD-A1        PIC X.
  6575         16  LA-RECORD-TYPE-A1       PIC X.
  6576         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6577         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6578
  6579     12  LA-TEXT-RECORD.
  6580         16  LA-SKIP-CONTROL         PIC XX.
  6581             88  NO-LINES-SKIPPED       VALUE SPACES.
  6582             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6583         16  LA-TEXT-LINE            PIC X(70).
  6584
  6585     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6586         16  FILLER                  PIC XX.
  6587         16  LA-ADDRESS-LINE         PIC X(30).
  6588         16  FILLER                  PIC X(40).
  6589
  6590     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6591         16  FILLER                  PIC XX.
  6592         16  LA-CARRIER              PIC X.
  6593         16  LA-CLAIM-NO             PIC X(7).
  6594         16  LA-CERT-NO.
  6595             20  LA-CERT-PRIME       PIC X(10).
  6596             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 122
* EL130.cbl
  6597         16  LA-NO-OF-COPIES         PIC S9.
  6598         16  LA-RESEND-DATE          PIC XX.
  6599         16  LA-PROCESSOR-CD         PIC X(4).
  6600         16  LA-CREATION-DT          PIC XX.
  6601         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6602         16  LA-RESEND-PRINT-DATE    PIC XX.
  6603         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6604         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6605*
  6606* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6607*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6608*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6609*   I        20  LA-DMD-RES-ST           PIC XX.
  6610*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6611*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6612*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6613*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6614*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6615*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6616*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6617*   I        20  LA-DMD-UND-CODE         PIC XX.
  6618*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6619*   V    16  FILLER                  PIC X(15).
  6620* -----
  6621*
  6622* REINSERTED  CSO  MODS
  6623*
  6624         16  FILLER.
  6625             20  FILLER                  PIC X(29).
  6626             20  LA-CSO-LETTER-STATUS    PIC X.
  6627                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6628                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6629                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6630             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6631             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6632*
  6633
  6634     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6635         16  FILLER                  PIC XX.
  6636         16  LA4-CARRIER             PIC X.
  6637         16  LA4-CLAIM-NO            PIC X(7).
  6638         16  LA4-CERT-NO.
  6639             20  LA4-CERT-PRIME      PIC X(10).
  6640             20  LA4-CERT-SFX        PIC X.
  6641         16  LA4-NO-OF-COPIES        PIC S9.
  6642         16  LA4-RESEND-DATE         PIC XX.
  6643         16  LA4-PROCESSOR-CD        PIC X(4).
  6644         16  LA4-CREATION-DT         PIC XX.
  6645         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6646         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6647         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6648         16  LA4-FORM-TYPE           PIC X.
  6649             88  LA4-INITIAL-FORM    VALUE '1'.
  6650             88  LA4-PROGRESS-FORM   VALUE '2'.
  6651         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6652         16  LA4-STATE               PIC X(02).
  6653         16  FILLER                  PIC X(31).
  6654******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 123
* EL130.cbl
  6656*    COPY ERCREIN.
  6657******************************************************************
  6658*                                                                *
  6659*                            ERCREIN                             *
  6660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6661*                            VMOD=2.010                          *
  6662*                                                                *
  6663*   ONLINE CREDIT SYSTEM                                         *
  6664*                                                                *
  6665*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6666*                                                                *
  6667*   FILE TYPE = VSAM,KSDS                                        *
  6668*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6669*                                                                *
  6670*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6671*       ALTERNATE PATH = NONE                                    *
  6672*                                                                *
  6673*   LOG = NO                                                     *
  6674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6675*                                                                *
  6676******************************************************************
  6677*                   C H A N G E   L O G
  6678*
  6679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6680*-----------------------------------------------------------------
  6681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6682* EFFECTIVE    NUMBER
  6683*-----------------------------------------------------------------
  6684* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6685* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6686******************************************************************
  6687 01  REINSURANCE-RECORD.
  6688     12  RE-RECORD-ID                      PIC XX.
  6689         88  VALID-RE-ID                      VALUE 'RE'.
  6690
  6691     12  RE-CONTROL-PRIMARY.
  6692         16  RE-COMPANY-CD                 PIC X.
  6693         16  RE-KEY.
  6694             20  RE-CODE                   PIC X.
  6695                 88  RE-TABLE-RECORD          VALUE 'A'.
  6696                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6697             20  RE-TABLE                  PIC XXX.
  6698             20  FILLER                    PIC XXX.
  6699         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6700             20  FILLER                    PIC X.
  6701             20  RE-COMPANY.
  6702                 24  RE-COMP-PRIME         PIC XXX.
  6703                 24  RE-COMP-SUB           PIC XXX.
  6704
  6705     12  RE-MAINT-INFORMATION.
  6706         16  RE-LAST-MAINT-DT              PIC XX.
  6707         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6708         16  RE-LAST-MAINT-USER            PIC X(4).
  6709         16  FILLER                        PIC X(10).
  6710
  6711     12  RE-TABLE-DATA.
  6712         16  RE-100-COMP                   PIC 99.
  6713
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 124
* EL130.cbl
  6714         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6715             20  RE-REI-COMP-NO.
  6716                 24  RE-REI-COMP           PIC XXX.
  6717                 24  RE-REI-COMP-SUB       PIC XXX.
  6718             20  RE-LF-QC                  PIC X.
  6719             20  RE-AH-QC                  PIC X.
  6720             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6721             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6722             20  RE-LFAGE-LO               PIC 99.
  6723             20  RE-LFAGE-HI               PIC 99.
  6724             20  RE-AHAGE-LO               PIC 99.
  6725             20  RE-AHAGE-HI               PIC 99.
  6726             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6727             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6728             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6729             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6730             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6731             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6732             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6733             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6734             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6735             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6736             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6737             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6738             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6739             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6740             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6741             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6742             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6743             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6744             20  RE-LF-BEN-CODE            PIC X.
  6745             20  RE-AH-BEN-CODE            PIC X.
  6746             20  RE-INTERACTIVE            PIC X.
  6747             20  RE-REMAINING              PIC X.
  6748             20  RE-LF-RUNOFF-SW           PIC X.
  6749             20  RE-AH-RUNOFF-SW           PIC X.
  6750             20  FILLER                    PIC X(19).
  6751
  6752         16  RE-COMP-INFO-END              PIC X(6).
  6753         16  RE-NSP-ST-CD-LF               PIC XX.
  6754         16  RE-NSP-ST-CD-AH               PIC XX.
  6755         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6756             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6757
  6758         16  FILLER                        PIC X(27).
  6759
  6760     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6761         16  RE-NAME                       PIC X(30).
  6762         16  RE-LF-PE                      PIC X.
  6763         16  RE-AH-PE                      PIC X.
  6764         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6765         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6766         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6767         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6768         16  RE-PRT-ST                     PIC X.
  6769         16  RE-PRT-OW                     PIC X.
  6770         16  RE-MORT-CODE                  PIC X(4).
  6771         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 125
* EL130.cbl
  6772         16  RE-ZERO-LF-FEE                PIC X.
  6773         16  RE-ZERO-AH-FEE                PIC X.
  6774         16  RE-CEDE-NAME                  PIC X(30).
  6775         16  RE-LF-COMM                    PIC X.
  6776         16  RE-AH-COMM                    PIC X.
  6777         16  RE-LF-TAX                     PIC X.
  6778         16  RE-AH-TAX                     PIC X.
  6779         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6780         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6781         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6782
  6783         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6784             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6785
  6786         16  RE-LF-CEDING-FEE-BRACKETS.
  6787             20  RE-LF-FEE-METHOD          PIC X.
  6788                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6789                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6790                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6791                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6792             20  RE-LF-FEE-BASIS           PIC X.
  6793                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6794                 88  RE-LF-NET-CEDED               VALUE '2'.
  6795                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6796                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6797                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6798                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6799                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6800                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6801             20  FILLER                    PIC XXX.
  6802             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6803                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6804                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6805
  6806         16  RE-AH-CEDING-FEE-BRACKETS.
  6807             20  RE-AH-FEE-METHOD          PIC X.
  6808                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6809                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6810                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6811                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6812             20  RE-AH-FEE-BASIS           PIC X.
  6813                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6814                 88  RE-AH-NET-CEDED               VALUE '2'.
  6815                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6816                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6817                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6818                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6819                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6820                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6821             20  FILLER                    PIC XXX.
  6822             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6823                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6824                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6825
  6826         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6827
  6828         16  RE-OLD-CEDING-STMT            PIC X.
  6829
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 126
* EL130.cbl
  6830         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6831         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6832         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6833         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6834         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6835         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6836         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6837         16  RE-MORT-SW                    PIC X.
  6838         16  RE-CEDING-TYPE-FLAG           PIC X.
  6839             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6840             88  RE-CEDED                          VALUE 'C'.
  6841             88  RE-ASSUMED                        VALUE 'A'.
  6842             88  RE-PHANTOM                        VALUE 'P'.
  6843
  6844         16  RE-CEDING-STMT-OPT-A          PIC X.
  6845             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6846         16  RE-CEDING-STMT-OPT-B          PIC X.
  6847             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6848         16  RE-CEDING-STMT-OPT-C          PIC X.
  6849             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6850         16  RE-CEDING-STMT-OPT-D          PIC X.
  6851             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6852         16  RE-CEDING-STMT-OPT-E          PIC X.
  6853             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6854
  6855         16  RE-PRT-CRSV                   PIC X.
  6856
  6857         16  RE-GL-CENTER                  PIC X(4).
  6858
  6859         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6860
  6861         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6862
  6863         16  RE-EARN-STOP-CODE             PIC X.
  6864             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6865             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6866
  6867         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6868             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6869
  6870         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6871         16  FILLER                        PIC X(2281).
  6872
  6873         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6874
  6875******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 127
* EL130.cbl
  6877*    COPY ERCMAIL.
  6878******************************************************************
  6879*                                                                *
  6880*                                                                *
  6881*                            ERCMAIL                             *
  6882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6883*                            VMOD=2.003                          *
  6884*                                                                *
  6885*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6886*                                                                *
  6887*   FILE TYPE = VSAM,KSDS                                        *
  6888*   RECORD SIZE = 374   RECFORM = FIX                            *
  6889*                                                                *
  6890*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6891*   ALTERNATE PATH    = NOT USED                                 *
  6892*                                                                *
  6893*   LOG = YES                                                    *
  6894*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6895******************************************************************
  6896*                   C H A N G E   L O G
  6897*
  6898* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6899*-----------------------------------------------------------------
  6900*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6901* EFFECTIVE    NUMBER
  6902*-----------------------------------------------------------------
  6903* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6904* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6905* 111108                   PEMA  ADD CRED BENE ADDR2
  6906******************************************************************
  6907
  6908 01  MAILING-DATA.
  6909     12  MA-RECORD-ID                      PIC XX.
  6910         88  VALID-MA-ID                       VALUE 'MA'.
  6911
  6912     12  MA-CONTROL-PRIMARY.
  6913         16  MA-COMPANY-CD                 PIC X.
  6914         16  MA-CARRIER                    PIC X.
  6915         16  MA-GROUPING.
  6916             20  MA-GROUPING-PREFIX        PIC XXX.
  6917             20  MA-GROUPING-PRIME         PIC XXX.
  6918         16  MA-STATE                      PIC XX.
  6919         16  MA-ACCOUNT.
  6920             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6921             20  MA-ACCOUNT-PRIME          PIC X(6).
  6922         16  MA-CERT-EFF-DT                PIC XX.
  6923         16  MA-CERT-NO.
  6924             20  MA-CERT-PRIME             PIC X(10).
  6925             20  MA-CERT-SFX               PIC X.
  6926
  6927     12  FILLER                            PIC XX.
  6928
  6929     12  MA-ACCESS-CONTROL.
  6930         16  MA-SOURCE-SYSTEM              PIC XX.
  6931             88  MA-FROM-CREDIT                VALUE 'CR'.
  6932             88  MA-FROM-VSI                   VALUE 'VS'.
  6933             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6934             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 128
* EL130.cbl
  6935         16  MA-RECORD-ADD-DT              PIC XX.
  6936         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6937         16  MA-LAST-MAINT-DT              PIC XX.
  6938         16  MA-LAST-MAINT-BY              PIC XXXX.
  6939         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6940
  6941     12  MA-PROFILE-INFO.
  6942         16  MA-QUALIFY-CODE-1             PIC XX.
  6943         16  MA-QUALIFY-CODE-2             PIC XX.
  6944         16  MA-QUALIFY-CODE-3             PIC XX.
  6945         16  MA-QUALIFY-CODE-4             PIC XX.
  6946         16  MA-QUALIFY-CODE-5             PIC XX.
  6947
  6948         16  MA-INSURED-LAST-NAME          PIC X(15).
  6949         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6950         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6951         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6952         16  MA-INSURED-BIRTH-DT           PIC XX.
  6953         16  MA-INSURED-SEX                PIC X.
  6954             88  MA-SEX-MALE                   VALUE 'M'.
  6955             88  MA-SEX-FEMALE                 VALUE 'F'.
  6956         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6957
  6958         16  MA-ADDRESS-CORRECTED          PIC X.
  6959         16  MA-JOINT-BIRTH-DT             PIC XX.
  6960*        16  FILLER                        PIC X(12).
  6961
  6962         16  MA-ADDRESS-LINE-1             PIC X(30).
  6963         16  MA-ADDRESS-LINE-2             PIC X(30).
  6964         16  MA-CITY-STATE.
  6965             20  MA-CITY                   PIC X(28).
  6966             20  MA-ADDR-STATE             PIC XX.
  6967         16  MA-ZIP.
  6968             20  MA-ZIP-CODE.
  6969                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6970                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6971                 24  FILLER                PIC X(4).
  6972             20  MA-ZIP-PLUS4              PIC X(4).
  6973         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6974             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6975             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6976             20  FILLER                    PIC X(3).
  6977
  6978         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6979
  6980         16  FILLER                        PIC XXX.
  6981*        16  FILLER                        PIC X(10).
  6982
  6983     12  MA-CRED-BENE-INFO.
  6984         16  MA-CRED-BENE-NAME                 PIC X(25).
  6985         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6986         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6987         16  MA-CRED-BENE-CTYST.
  6988             20  MA-CRED-BENE-CITY             PIC X(28).
  6989             20  MA-CRED-BENE-STATE            PIC XX.
  6990         16  MA-CRED-BENE-ZIP.
  6991             20  MA-CB-ZIP-CODE.
  6992                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 129
* EL130.cbl
  6993                     88  MA-CB-CANADIAN-POST-CODE
  6994                                           VALUE 'A' THRU 'Z'.
  6995                 24  FILLER                    PIC X(4).
  6996             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6997         16  MA-CB-CANADIAN-POSTAL-CODE
  6998                            REDEFINES MA-CRED-BENE-ZIP.
  6999             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7000             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7001             20  FILLER                        PIC X(3).
  7002     12  MA-POST-CARD-MAIL-DATA.
  7003         16  MA-MAIL-DATA OCCURS 7.
  7004             20  MA-MAIL-TYPE              PIC X.
  7005                 88  MA-12MO-MAILING           VALUE '1'.
  7006                 88  MA-EXP-MAILING            VALUE '2'.
  7007             20  MA-MAIL-STATUS            PIC X.
  7008                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7009                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7010                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7011             20  MA-MAIL-DATE              PIC XX.
  7012     12  FILLER                            PIC XX.
  7013     12  FILLER                            PIC XX.
  7014*    12  FILLER                            PIC X(30).
  7015******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 130
* EL130.cbl
  7017*    COPY ELCCRTT.
  7018******************************************************************
  7019*                                                                *
  7020*                            ELCCRTT.                            *
  7021*                                                                *
  7022*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7023*                                                                *
  7024*   FILE TYPE = VSAM,KSDS                                        *
  7025*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7026*                                                                *
  7027*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7028*                                                                *
  7029*   LOG = YES                                                    *
  7030*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7031******************************************************************
  7032*                   C H A N G E   L O G
  7033*
  7034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7035*-----------------------------------------------------------------
  7036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7037* EFFECTIVE    NUMBER
  7038*-----------------------------------------------------------------
  7039* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7040* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7041* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7042* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7043* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7044* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7045* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7046* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7047* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7048******************************************************************
  7049
  7050 01  CERTIFICATE-TRAILERS.
  7051     12  CS-RECORD-ID                      PIC XX.
  7052         88  VALID-CS-ID                      VALUE 'CS'.
  7053
  7054     12  CS-CONTROL-PRIMARY.
  7055         16  CS-COMPANY-CD                 PIC X.
  7056         16  CS-CARRIER                    PIC X.
  7057         16  CS-GROUPING                   PIC X(6).
  7058         16  CS-STATE                      PIC XX.
  7059         16  CS-ACCOUNT                    PIC X(10).
  7060         16  CS-CERT-EFF-DT                PIC XX.
  7061         16  CS-CERT-NO.
  7062             20  CS-CERT-PRIME             PIC X(10).
  7063             20  CS-CERT-SFX               PIC X.
  7064         16  CS-TRAILER-TYPE               PIC X.
  7065             88  COMM-TRLR           VALUE 'A'.
  7066             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7067             88  CERT-DATA-TRLR      VALUE 'C'.
  7068
  7069     12  CS-DATA-AREA                      PIC X(516).
  7070
  7071     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7072         16  CS-BANK-COMMISSION-AREA.
  7073             20  CS-BANK-COMMS       OCCURS 10.
  7074                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 131
* EL130.cbl
  7075                 24  CS-COM-TYP            PIC X.
  7076                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7077                 24  CS-RECALC-LV-INDIC    PIC X.
  7078                 24  FILLER                PIC X(10).
  7079         16  FILLER                        PIC X(256).
  7080
  7081     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7082****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7083         16  CS-MB-CLAIM-DATA OCCURS 24.
  7084             20  CS-CLAIM-NO               PIC X(7).
  7085             20  CS-CLAIM-TYPE             PIC X.
  7086                 88  CS-AH-CLM               VALUE 'A'.
  7087                 88  CS-IU-CLM               VALUE 'I'.
  7088                 88  CS-GP-CLM               VALUE 'G'.
  7089                 88  CS-LF-CLM               VALUE 'L'.
  7090                 88  CS-PR-CLM               VALUE 'P'.
  7091                 88  CS-FL-CLM               VALUE 'F'.
  7092             20  CS-INSURED-TYPE           PIC X.
  7093                 88  CS-PRIM-INSURED          VALUE 'P'.
  7094                 88  CS-CO-BORROWER           VALUE 'C'.
  7095             20  CS-BENEFIT-PERIOD         PIC 99.
  7096             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7097             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7098             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7099         16  FILLER                        PIC X(12).
  7100     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7101         16  CS-VIN-NUMBER                 PIC X(17).
  7102         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7103         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7104         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7105         16  cs-agent-name.
  7106             20  cs-agent-fname            pic x(20).
  7107             20  cs-agent-mi               pic x.
  7108             20  cs-agent-lname            pic x(25).
  7109         16  cs-license-no                 pic x(15).
  7110         16  cs-npn-number                 pic x(10).
  7111         16  cs-agent-edit-status          pic x.
  7112             88  cs-ae-refer-to-manager      value 'M'.
  7113             88  cs-ae-cover-sheet           value 'C'.
  7114             88  cs-ae-sig-form              value 'S'.
  7115             88  cs-ae-verified              value 'V'.
  7116             88  cs-unidentified-signature   value 'U'.
  7117             88  cs-cert-returned            value 'R'.
  7118             88  cs-accept-no-commission     value 'N'.
  7119         16  cs-year                       pic 9999.
  7120         16  cs-make                       pic x(20).
  7121         16  cs-model                      pic x(20).
  7122         16  cs-future                     pic x(20).
  7123         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7124         16  FILLER                        PIC X(356). *> was 420
  7125*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 132
* EL130.cbl
  7127
  7128 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7129                          CONTROL-FILE CERTIFICATE-MASTER
  7130                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7131                          BENEFICIARY-MASTER
  7132                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7133                          LETTER-ARCHIVE REINSURANCE-RECORD
  7134                          MAILING-DATA CERTIFICATE-TRAILERS.
  7135 0000-DFHEXIT SECTION.
  7136     MOVE '9#                    $   ' TO DFHEIV0.
  7137     MOVE 'EL130' TO DFHEIV1.
  7138     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7139     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7140     MOVE '5'                    TO DC-OPTION-CODE.
  7141     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7142     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7143     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7144
  7145     IF EIBCALEN = ZERO
  7146         GO TO 8800-UNAUTHORIZED-ACCESS
  7147     END-IF.
  7148
  7149     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7150     MOVE EIBTRMID               TO QID-TERM.
  7151     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7152     move spaces                 to emi-error-lines
  7153     MOVE '2'                    TO EMI-SWITCH2.
  7154     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7155     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7156
  7157
  7158* EXEC CICS HANDLE CONDITION
  7159*        QIDERR     (0100-TEST-ENTRY)
  7160*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7161*        PGMIDERR   (9600-PGMID-ERROR)
  7162*        TERMIDERR  (8820-TERM-ERROR)
  7163*        TRANSIDERR (8830-TRAN-ERROR)
  7164*        ERROR      (9990-ABEND)
  7165*    END-EXEC.
  7166*    MOVE '"$N?L[\.              ! " #00007153' TO DFHEIV0
  7167     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7169     MOVE X'2220233030303037313533' TO DFHEIV0(25:11)
  7170     CALL 'kxdfhei1' USING DFHEIV0
  7171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7172
  7173
  7174     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7175        PI-CALLING-PROGRAM   = XCTL-6592
  7176         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7177     ELSE
  7178         MOVE SPACES             TO RETURNED-FROM
  7179     END-IF.
  7180
  7181     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7182         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7183             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7184             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 133
* EL130.cbl
  7185             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7186             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7187             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7188             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7189             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7190             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7191         ELSE
  7192             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7193             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7194             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7195             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7196             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7197             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7198             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7199             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7200         END-IF
  7201     END-IF.
  7202
  7203     IF EIBTRNID = TRANS-ID
  7204         IF EIBAID = DFHCLEAR
  7205             GO TO 9400-CLEAR
  7206         ELSE
  7207             GO TO 0200-RECEIVE
  7208         END-IF
  7209     END-IF.
  7210
  7211     IF RETURNED-FROM NOT = SPACES
  7212         GO TO 0600-RECOVER-TEMP-STORAGE
  7213     END-IF.
  7214
  7215     MOVE LOW-VALUES TO EL130AO.
  7216     move zeros to pi-dcc-max-amt
  7217                   pi-dcc-max-benefits
  7218
  7219
  7220
  7221* EXEC CICS DELETEQ TS
  7222*         QUEUE   (QID)
  7223*    END-EXEC.
  7224*    MOVE '*&                    #   #00007208' TO DFHEIV0
  7225     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7227     MOVE X'2020233030303037323038' TO DFHEIV0(25:11)
  7228     CALL 'kxdfhei1' USING DFHEIV0,
  7229           QID,
  7230           DFHEIV99
  7231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7232
  7233
  7234 0100-TEST-ENTRY.
  7235     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7236         GO TO 0650-FROM-EL127
  7237     ELSE
  7238         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7239                                    PI-CERT-PROCESSED
  7240                                    PI-LETTER-ERROR-CODE
  7241     END-IF.
  7242
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 134
* EL130.cbl
  7243     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7244         GO TO 0640-FROM-EL132
  7245     END-IF.
  7246
  7247     GO TO 8100-SEND-INITIAL-MAP.
  7248
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 135
* EL130.cbl
  7250 0200-RECEIVE.
  7251     MOVE LOW-VALUES             TO EL130AI.
  7252
  7253     IF PI-PROCESSOR-ID = 'LGXX'
  7254*        NEXT SENTENCE
  7255         CONTINUE
  7256     ELSE
  7257
  7258* EXEC CICS READQ TS
  7259*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7260*            INTO    (SECURITY-CONTROL)
  7261*            LENGTH  (SC-COMM-LENGTH)
  7262*            ITEM    (SC-ITEM)
  7263*        END-EXEC
  7264*    MOVE '*$II   L              ''   #00007235' TO DFHEIV0
  7265     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7267     MOVE X'2020233030303037323335' TO DFHEIV0(25:11)
  7268     CALL 'kxdfhei1' USING DFHEIV0,
  7269           PI-SECURITY-TEMP-STORE-ID,
  7270           SECURITY-CONTROL,
  7271           SC-COMM-LENGTH,
  7272           SC-ITEM,
  7273           DFHEIV99,
  7274           DFHEIV99
  7275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7276         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7277         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7278         IF NOT DISPLAY-CAP
  7279             MOVE 'READ'              TO  SM-READ
  7280             PERFORM 9995-SECURITY-VIOLATION
  7281             MOVE ER-0070             TO  EMI-ERROR
  7282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7283             GO TO 8100-SEND-INITIAL-MAP
  7284         END-IF
  7285     END-IF.
  7286
  7287     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7288         MOVE ER-7008 TO EMI-ERROR
  7289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7290         MOVE -1 TO MAINTL
  7291         GO TO 8200-SEND-DATAONLY
  7292     END-IF.
  7293
  7294
  7295
  7296* EXEC CICS RECEIVE
  7297*         MAP     (MAP-NAME)
  7298*         MAPSET  (MAPSET-NAME)
  7299*         INTO    (EL130AI)
  7300*    END-EXEC.
  7301     MOVE LENGTH OF
  7302      EL130AI
  7303       TO DFHEIV11
  7304*    MOVE '8"T I  L              ''   #00007260' TO DFHEIV0
  7305     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7307     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 136
* EL130.cbl
  7308     CALL 'kxdfhei1' USING DFHEIV0,
  7309           MAP-NAME,
  7310           EL130AI,
  7311           DFHEIV11,
  7312           MAPSET-NAME,
  7313           DFHEIV99,
  7314           DFHEIV99
  7315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7316
  7317
  7318     IF NOT PI-NO-CARRIER-SECURITY
  7319        MOVE +1                  TO CLMCARRL
  7320        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7321     END-IF.
  7322
  7323     IF ENTERPFL = ZERO
  7324         GO TO 0300-CHECK-PFKEYS
  7325     END-IF.
  7326
  7327     IF EIBAID NOT = DFHENTER
  7328         MOVE ER-0004            TO EMI-ERROR
  7329         GO TO 0320-INPUT-ERROR
  7330     END-IF.
  7331
  7332     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7333         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7334     ELSE
  7335         MOVE ER-0029            TO EMI-ERROR
  7336         GO TO 0320-INPUT-ERROR
  7337     END-IF.
  7338
  7339 0300-CHECK-PFKEYS.
  7340     IF EIBAID = DFHPF23
  7341         GO TO 8810-PF23
  7342     END-IF.
  7343
  7344     IF EIBAID = DFHPF24
  7345         GO TO 9200-RETURN-MAIN-MENU
  7346     END-IF.
  7347
  7348     IF EIBAID = DFHPF12
  7349         GO TO 9500-PF12
  7350     END-IF.
  7351
  7352     IF EIBAID = DFHPF3
  7353         MOVE SPACES              TO MAINTI
  7354         MOVE ZEROS               TO MAINTL
  7355         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7356         MOVE XCTL-127            TO PGM-NAME
  7357         GO TO 9300-XCTL
  7358     END-IF.
  7359
  7360     IF EIBAID = DFHPF4
  7361         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7362         MOVE XCTL-132            TO PGM-NAME
  7363         GO TO 9300-XCTL
  7364     END-IF.
  7365
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 137
* EL130.cbl
  7366     IF EIBAID = DFHPF13
  7367         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7368             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7369             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7370             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7371             MOVE PI-STATE            TO  PI-CR-STATE
  7372             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7373             MOVE XCTL-650            TO  PGM-NAME
  7374             GO TO 9300-XCTL
  7375         ELSE
  7376             MOVE -1                  TO  ENTERPFL
  7377             MOVE ER-2566             TO  EMI-ERROR
  7378             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7379             GO TO 8100-SEND-INITIAL-MAP
  7380         END-IF
  7381     END-IF.
  7382
  7383     IF EIBAID = DFHPF5
  7384         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7385             ADD +1 TO PI-CERT-PROCESSED
  7386             GO TO 0650-FROM-EL127
  7387         ELSE
  7388             MOVE ER-7686         TO EMI-ERROR
  7389             GO TO 0320-INPUT-ERROR
  7390         END-IF
  7391     END-IF.
  7392
  7393     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7394         GO TO 0800-TEST-PREVIOUS-CONTROL
  7395     END-IF.
  7396
  7397     IF PI-HAS-CLAS-IC-CRDTCRD
  7398         IF EIBAID = DFHPF10
  7399             MOVE XCTL-725          TO PGM-NAME
  7400             GO TO 9300-XCTL
  7401         END-IF
  7402     END-IF.
  7403
  7404     IF EIBAID = DFHPF14
  7405         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7406         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7407         MOVE XCTL-659            TO PGM-NAME
  7408         GO TO 9300-XCTL
  7409     END-IF.
  7410
  7411     IF EIBAID = DFHPF15
  7412         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7413         MOVE XCTL-114            TO PGM-NAME
  7414         GO TO 9300-XCTL
  7415     END-IF.
  7416
  7417*    IF EIBAID = DFHPF11
  7418*       GO TO 0600-RECOVER-TEMP-STORAGE
  7419*    END-IF
  7420     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7421         GO TO 0330-EDIT-DATA
  7422     END-IF.
  7423
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 138
* EL130.cbl
  7424     MOVE ER-0029                TO EMI-ERROR.
  7425
  7426 0320-INPUT-ERROR.
  7427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7428
  7429     MOVE AL-UNBON               TO ENTERPFA.
  7430
  7431     IF ENTERPFL = ZERO
  7432         MOVE -1                 TO MAINTL
  7433     ELSE
  7434         MOVE -1                 TO ENTERPFL
  7435     END-IF.
  7436
  7437     GO TO 8200-SEND-DATAONLY.
  7438
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 139
* EL130.cbl
  7440 0330-EDIT-DATA.
  7441
  7442     IF MAINTI = 'S'
  7443         IF PRTOPTL GREATER THAN 0
  7444             IF PRTOPTI NOT = 'N' AND 'L'
  7445                 MOVE AL-UABON   TO  PRTOPTA
  7446                 MOVE -1         TO  PRTOPTL
  7447                 MOVE ER-0334    TO  EMI-ERROR
  7448                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7449                 GO TO 8200-SEND-DATAONLY
  7450             ELSE
  7451                 IF PRTOPTI = 'L'
  7452                     GO TO 0400-CREATE-ELACTQ
  7453                 ELSE
  7454                     GO TO 0480-PRINT-NOW
  7455                 END-IF
  7456             END-IF
  7457         ELSE
  7458             GO TO 1000-SHOW-CLAIM
  7459         END-IF
  7460     END-IF.
  7461
  7462     IF NOT MODIFY-CAP
  7463         MOVE 'UPDATE'       TO  SM-READ
  7464         PERFORM 9995-SECURITY-VIOLATION
  7465         MOVE ER-0070        TO  EMI-ERROR
  7466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7467         GO TO 8100-SEND-INITIAL-MAP
  7468     END-IF.
  7469
  7470     IF MAINTI = 'D'
  7471         GO TO 2000-DELETE-CLAIM
  7472     END-IF.
  7473
  7474     IF MAINTI = 'A'
  7475         GO TO 3000-ADD-CLAIM
  7476     END-IF.
  7477
  7478     IF MAINTI = 'I'
  7479         GO TO 5000-INCURRED-CHANGE
  7480     END-IF.
  7481
  7482     MOVE ER-0023                TO EMI-ERROR.
  7483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7484     MOVE -1                     TO MAINTL.
  7485     MOVE AL-UABON               TO MAINTA.
  7486
  7487     GO TO 8200-SEND-DATAONLY.
  7488
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 140
* EL130.cbl
  7490 0400-CREATE-ELACTQ.
  7491     IF CLMNOI   = PI-LAST-CLAIM      AND
  7492        CLMCARRI = PI-LAST-CARR       AND
  7493        CERTNOI  = PI-LAST-CERT-PRIME AND
  7494        SUFXI    = PI-LAST-CERT-SUFX
  7495         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7496         MOVE PI-LAST-CARR       TO PI-CARRIER
  7497         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7498     ELSE
  7499         MOVE ER-0207            TO EMI-ERROR
  7500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7501         MOVE -1                 TO MAINTL
  7502         GO TO 8200-SEND-DATAONLY
  7503     END-IF.
  7504
  7505     IF (NOT PI-NO-CARRIER-SECURITY OR
  7506         NOT PI-NO-ACCOUNT-SECURITY)
  7507         MOVE AL-UABON      TO  PRTOPTA
  7508         MOVE -1            TO  PRTOPTL
  7509         MOVE ER-2378       TO  EMI-ERROR
  7510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7511         GO TO 8200-SEND-DATAONLY
  7512     END-IF.
  7513
  7514     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7515     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7516     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7517     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7518
  7519
  7520
  7521* EXEC CICS HANDLE CONDITION
  7522*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7523*    END-EXEC.
  7524*    MOVE '"$I                   ! # #00007468' TO DFHEIV0
  7525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7527     MOVE X'2320233030303037343638' TO DFHEIV0(25:11)
  7528     CALL 'kxdfhei1' USING DFHEIV0
  7529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7530
  7531
  7532
  7533
  7534* EXEC CICS READ
  7535*         UPDATE
  7536*         DATASET    (ELACTQ-DSID)
  7537*         SET        (ADDRESS OF ACTIVITY-QUE)
  7538*         RIDFLD     (ELACTQ-KEY)
  7539*    END-EXEC.
  7540*    MOVE '&"S        EU         (   #00007473' TO DFHEIV0
  7541     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7542     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7543     MOVE X'2020233030303037343733' TO DFHEIV0(25:11)
  7544     CALL 'kxdfhei1' USING DFHEIV0,
  7545           ELACTQ-DSID,
  7546           DFHEIV20,
  7547           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 141
* EL130.cbl
  7548           ELACTQ-KEY,
  7549           DFHEIV99,
  7550           DFHEIV99,
  7551           DFHEIV99
  7552     SET ADDRESS OF ACTIVITY-QUE TO
  7553         DFHEIV20
  7554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7555
  7556
  7557     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7558     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7559
  7560
  7561
  7562* EXEC CICS REWRITE
  7563*         DATASET     (ELACTQ-DSID)
  7564*         FROM        (ACTIVITY-QUE)
  7565*    END-EXEC.
  7566     MOVE LENGTH OF
  7567      ACTIVITY-QUE
  7568       TO DFHEIV11
  7569*    MOVE '&& L                  %   #00007484' TO DFHEIV0
  7570     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7571     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037343834' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           ELACTQ-DSID,
  7575           ACTIVITY-QUE,
  7576           DFHEIV11,
  7577           DFHEIV99
  7578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7579
  7580
  7581     GO TO 0470-STATUS-FINISH.
  7582
  7583 0450-ADD-ELACTQ-RECORD.
  7584
  7585
  7586* EXEC CICS GETMAIN
  7587*        SET     (ADDRESS OF ACTIVITY-QUE)
  7588*        LENGTH  (ELACTQ-LENGTH)
  7589*        INITIMG (GETMAIN-SPACE)
  7590*    END-EXEC.
  7591*    MOVE ',"IL                  $   #00007493' TO DFHEIV0
  7592     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7594     MOVE X'2020233030303037343933' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0,
  7596           DFHEIV20,
  7597           ELACTQ-LENGTH,
  7598           GETMAIN-SPACE
  7599     SET ADDRESS OF ACTIVITY-QUE TO
  7600         DFHEIV20
  7601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7602
  7603
  7604     MOVE 'AQ'              TO AQ-RECORD-ID.
  7605     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 142
* EL130.cbl
  7606     MOVE +0                TO AQ-PAYMENT-COUNTER
  7607                               AQ-PMT-UNAPPROVED-COUNT.
  7608     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7609                               AQ-FOLLOWUP-DATE.
  7610     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7611     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7612
  7613
  7614
  7615* EXEC CICS WRITE
  7616*         DATASET     (ELACTQ-DSID)
  7617*         FROM        (ACTIVITY-QUE)
  7618*         RIDFLD      (ELACTQ-KEY)
  7619*    END-EXEC.
  7620     MOVE LENGTH OF
  7621      ACTIVITY-QUE
  7622       TO DFHEIV11
  7623*    MOVE '&$ L                  ''   #00007509' TO DFHEIV0
  7624     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7625     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7626     MOVE X'2020233030303037353039' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0,
  7628           ELACTQ-DSID,
  7629           ACTIVITY-QUE,
  7630           DFHEIV11,
  7631           ELACTQ-KEY,
  7632           DFHEIV99,
  7633           DFHEIV99
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7635
  7636
  7637 0470-STATUS-FINISH.
  7638     MOVE AL-UANOF               TO  PRTOPTA
  7639                                     ALTPRTA.
  7640
  7641     MOVE SPACES                 TO  PRTOPTO
  7642                                     ALTPRTO.
  7643
  7644     MOVE ER-0000                TO EMI-ERROR.
  7645     MOVE -1                     TO MAINTL.
  7646     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7647     GO TO 8100-SEND-INITIAL-MAP.
  7648
  7649 0480-PRINT-NOW.
  7650
  7651
  7652* EXEC CICS HANDLE CONDITION
  7653*        TERMIDERR   (8820-TERM-ERROR)
  7654*        TRANSIDERR  (8830-TRAN-ERROR)
  7655*    END-EXEC.
  7656*    MOVE '"$[\                  ! $ #00007529' TO DFHEIV0
  7657     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7659     MOVE X'2420233030303037353239' TO DFHEIV0(25:11)
  7660     CALL 'kxdfhei1' USING DFHEIV0
  7661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7662
  7663
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 143
* EL130.cbl
  7664     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7665     MOVE '1'                    TO  CNTL-REC-TYPE.
  7666     MOVE SPACES                 TO  CNTL-ACCESS.
  7667     MOVE +0                     TO  CNTL-SEQ-NO.
  7668     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7669
  7670     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7671
  7672     IF CF-FORMS-PRINTER-ID = SPACES
  7673         IF ALTPRTL NOT GREATER THAN 0
  7674             MOVE ER-0337        TO  EMI-ERROR
  7675             MOVE -1             TO  ALTPRTL
  7676             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7677             GO TO 8200-SEND-DATAONLY
  7678         END-IF
  7679     END-IF.
  7680
  7681     IF ALTPRTL GREATER THAN 0
  7682         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7683     END-IF.
  7684
  7685     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7686     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7687     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7688
  7689
  7690
  7691* EXEC CICS START
  7692*        TRANSID   (START-TRANS-ID)
  7693*        TERMID    (CF-FORMS-PRINTER-ID)
  7694*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7695*        LENGTH    (PI-COMM-LENGTH)
  7696*    END-EXEC.
  7697*    MOVE '0( LFT                1   #00007560' TO DFHEIV0
  7698     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7699     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7700     MOVE X'2020233030303037353630' TO DFHEIV0(25:11)
  7701     CALL 'kxdfhei1' USING DFHEIV0,
  7702           DFHEIV99,
  7703           START-TRANS-ID,
  7704           DFHEIV99,
  7705           PROGRAM-INTERFACE-BLOCK,
  7706           PI-COMM-LENGTH,
  7707           CF-FORMS-PRINTER-ID,
  7708           DFHEIV99,
  7709           DFHEIV99,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99,
  7713           DFHEIV99,
  7714           DFHEIV99,
  7715           DFHEIV99,
  7716           DFHEIV99,
  7717           DFHEIV99
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7719
  7720
  7721     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 144
* EL130.cbl
  7722                                     ALTPRTA.
  7723
  7724     MOVE SPACES                 TO  PRTOPTO
  7725                                     ALTPRTO.
  7726
  7727     MOVE ER-0000                TO  EMI-ERROR.
  7728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7729     MOVE -1                     TO  MAINTL.
  7730     GO TO 8100-SEND-INITIAL-MAP.
  7731
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 145
* EL130.cbl
  7733 0500-CREATE-TEMP-STORAGE.
  7734     MOVE EIBCPOSN               TO PI-CURSOR.
  7735
  7736    move emi-line1               to errmsg1o
  7737    move emi-line2               to errmsg2o
  7738    move emi-sub                 to pi-emi-sub
  7739
  7740
  7741* EXEC CICS WRITEQ TS
  7742*        QUEUE   (QID)
  7743*        FROM    (EL130AI)
  7744*        LENGTH  (QID-MAP-LENGTH)
  7745*    END-EXEC.
  7746*    MOVE '*"                    ''   #00007586' TO DFHEIV0
  7747     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7749     MOVE X'2020233030303037353836' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0,
  7751           QID,
  7752           EL130AI,
  7753           QID-MAP-LENGTH,
  7754           DFHEIV99,
  7755           DFHEIV99,
  7756           DFHEIV99
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7758
  7759
  7760
  7761
  7762* EXEC CICS WRITEQ TS
  7763*        QUEUE    (QID)
  7764*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7765*        LENGTH   (PI-COMM-LENGTH)
  7766*    END-EXEC.
  7767*    MOVE '*"                    ''   #00007593' TO DFHEIV0
  7768     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7770     MOVE X'2020233030303037353933' TO DFHEIV0(25:11)
  7771     CALL 'kxdfhei1' USING DFHEIV0,
  7772           QID,
  7773           PROGRAM-INTERFACE-BLOCK,
  7774           PI-COMM-LENGTH,
  7775           DFHEIV99,
  7776           DFHEIV99,
  7777           DFHEIV99
  7778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7779
  7780
  7781 0599-EXIT.
  7782      EXIT.
  7783
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 146
* EL130.cbl
  7785 0600-RECOVER-TEMP-STORAGE.
  7786     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7787     MOVE PI-EL127-TO-EL130-CNTRL
  7788                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7789     MOVE PI-EL659-TO-EL130-CNTRL
  7790                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7791     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7792     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7793     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7794     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7795     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7796     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7797     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7798     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7799     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7800     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7801     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7802     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7803     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7804     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7805     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7806     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7807                                 TO SAVE-BENEFICIARY
  7808
  7809
  7810
  7811* EXEC CICS HANDLE CONDITION
  7812*        NOTFND  (0660-NOT-FOUND)
  7813*        QIDERR  (0670-QIDERR)
  7814*    END-EXEC.
  7815*    MOVE '"$IN                  ! % #00007628' TO DFHEIV0
  7816     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7818     MOVE X'2520233030303037363238' TO DFHEIV0(25:11)
  7819     CALL 'kxdfhei1' USING DFHEIV0
  7820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7821
  7822
  7823
  7824
  7825* EXEC CICS READQ TS
  7826*        QUEUE    (QID)
  7827*        INTO     (EL130AI)
  7828*        LENGTH   (QID-MAP-LENGTH)
  7829*    END-EXEC.
  7830*    MOVE '*$I    L              ''   #00007634' TO DFHEIV0
  7831     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7833     MOVE X'2020233030303037363334' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0,
  7835           QID,
  7836           EL130AI,
  7837           QID-MAP-LENGTH,
  7838           DFHEIV99,
  7839           DFHEIV99,
  7840           DFHEIV99
  7841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7842
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 147
* EL130.cbl
  7843
  7844     IF RETURNED-FROM = XCTL-131
  7845        IF CLAIM-DELETED-BY-EL131
  7846            MOVE LOW-VALUES      TO CERTNOI
  7847                                    SUFXI
  7848            MOVE ZEROS           TO CERTNOL
  7849                                    SUFXL
  7850         END-IF
  7851     END-IF.
  7852
  7853     IF RETURNED-FROM = XCTL-131
  7854         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7855         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7856                                    PI-CERT-PROCESSED
  7857     ELSE
  7858
  7859
  7860* EXEC CICS READQ TS
  7861*             QUEUE   (QID)
  7862*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7863*             LENGTH  (PI-COMM-LENGTH)
  7864*        END-EXEC
  7865*    MOVE '*$I    L              ''   #00007655' TO DFHEIV0
  7866     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7868     MOVE X'2020233030303037363535' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           QID,
  7871           PROGRAM-INTERFACE-BLOCK,
  7872           PI-COMM-LENGTH,
  7873           DFHEIV99,
  7874           DFHEIV99,
  7875           DFHEIV99
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7877     END-IF.
  7878
  7879
  7880* EXEC CICS DELETEQ TS
  7881*        QUEUE   (QID)
  7882*    END-EXEC.
  7883*    MOVE '*&                    #   #00007662' TO DFHEIV0
  7884     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7885     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7886     MOVE X'2020233030303037363632' TO DFHEIV0(25:11)
  7887     CALL 'kxdfhei1' USING DFHEIV0,
  7888           QID,
  7889           DFHEIV99
  7890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7891
  7892
  7893     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7894
  7895     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7896         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7897         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7898         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7899         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7900         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 148
* EL130.cbl
  7901         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7902         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7903         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7904         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7905         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7906         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7907         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7908         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7909         MOVE SAVE-CERT-ACCESS-CONTROL
  7910                                    TO PI-CERT-ACCESS-CONTROL
  7911         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7912                                    TO PI-CARRIER-CONTROL-LEVEL
  7913     END-IF.
  7914
  7915*    IF EIBAID = DFHPF11
  7916*       move errmsg1i            to emi-line1
  7917*       move errmsg2i            to emi-line2
  7918*       move pi-emi-sub          to emi-sub
  7919*       go to 8200-SEND-DATAONLY
  7920*    end-if
  7921     IF RETURNED-FROM = XCTL-127
  7922         MOVE SAVE-EL127-TO-EL130-CNTRL
  7923                                 TO PI-EL127-TO-EL130-CNTRL
  7924     END-IF.
  7925
  7926     IF RETURNED-FROM = XCTL-6592
  7927        MOVE SAVE-EL659-TO-EL130-CNTRL
  7928                                 TO PI-EL659-TO-EL130-CNTRL
  7929     END-IF.
  7930
  7931     IF RETURNED-FROM = XCTL-114
  7932        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7933           MOVE SAVE-BENEFICIARY TO BENECDI
  7934           MOVE +10              TO BENECDL
  7935           MOVE -1               TO BIRTHDTL
  7936        END-IF
  7937     END-IF.
  7938     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7939
  7940     IF MAINTL NOT = ZERO
  7941         MOVE AL-UANON           TO MAINTA
  7942     END-IF.
  7943
  7944     IF ENTERPFL NOT = ZERO
  7945         MOVE AL-UNNON           TO ENTERPFA
  7946     END-IF.
  7947
  7948     IF RETURNED-FROM = XCTL-127
  7949         GO TO 0650-FROM-EL127
  7950     END-IF.
  7951
  7952     IF RETURNED-FROM = XCTL-132
  7953         GO TO 0640-FROM-EL132
  7954     END-IF.
  7955
  7956     IF RETURNED-FROM = XCTL-650
  7957         MOVE AL-SABON           TO PF5A
  7958         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 149
* EL130.cbl
  7959     END-IF.
  7960
  7961     IF RETURNED-FROM = XCTL-6592
  7962         GO TO 0630-FROM-EL6592
  7963     END-IF.
  7964
  7965     IF MAINTI = 'S' OR 'I'
  7966        GO TO 1000-SHOW-CLAIM
  7967     END-IF.
  7968
  7969     GO TO 8100-SEND-INITIAL-MAP.
  7970
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 150
* EL130.cbl
  7972 0630-FROM-EL6592.
  7973     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7974     MOVE PI-EL659-GROUPING      TO GROUPO.
  7975     MOVE PI-EL659-STATE         TO STATEO.
  7976     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7977
  7978     MOVE AL-UANON               TO CRTCARRA
  7979                                    GROUPA
  7980                                    STATEA
  7981                                    ACCOUNTA.
  7982     GO TO 8100-SEND-INITIAL-MAP.
  7983
  7984 0640-FROM-EL132.
  7985     IF PI-CLAIM-NO = SPACES
  7986         GO TO 0645-NO-CLAIM-SELECTED
  7987     END-IF.
  7988
  7989     MOVE LOW-VALUES             TO EL130AI.
  7990     MOVE 'MSTR'                 TO FILE-SWITCH.
  7991     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7992     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7993     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7994                                    CLMNOO.
  7995     MOVE AL-UANON               TO CLMNOA.
  7996     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7997
  7998
  7999
  8000* EXEC CICS HANDLE CONDITION
  8001*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8002*    END-EXEC.
  8003*    MOVE '"$I                   ! & #00007772' TO DFHEIV0
  8004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8006     MOVE X'2620233030303037373732' TO DFHEIV0(25:11)
  8007     CALL 'kxdfhei1' USING DFHEIV0
  8008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8009
  8010
  8011     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8012     MOVE 'X'                    TO CLAIM-SWITCH.
  8013     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8014     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8015     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8016     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8017     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8018     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8019
  8020     MOVE ER-0213                TO EMI-ERROR.
  8021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8022     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8023     GO TO 8100-SEND-INITIAL-MAP.
  8024
  8025 0645-NO-CLAIM-SELECTED.
  8026
  8027     IF MAINTI = 'S' OR 'I'
  8028        GO TO 1000-SHOW-CLAIM
  8029     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 151
* EL130.cbl
  8030
  8031     GO TO 8100-SEND-INITIAL-MAP.
  8032
  8033 0650-FROM-EL127.
  8034
  8035     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8036         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8037                                    PI-CERT-PROCESSED
  8038     END-IF.
  8039
  8040     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8041         MOVE +1                 TO PI-CERT-SELECT-CNT
  8042                                    PI-CERT-PROCESSED
  8043         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8044         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8045         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8046         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8047         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8048         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8049     END-IF.
  8050
  8051     IF PI-CERT-SELECT-CNT = ZERO
  8052         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8053             MOVE CERTNOI        TO PI-CERT-NO
  8054             MOVE SUFXI          TO PI-CERT-SFX
  8055             GO TO 3000-READ-CERT
  8056         ELSE
  8057             GO TO 8100-SEND-INITIAL-MAP
  8058         END-IF
  8059     END-IF.
  8060
  8061     MOVE AL-SABON               TO PF5A.
  8062
  8063     IF PI-CERT-PROCESSED = 1
  8064         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8065     END-IF.
  8066
  8067     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8068     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8069
  8070     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8071     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8072                                 TO CERT-CARRIER
  8073                                    PI-CARRIER.
  8074     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8075                                 TO CERT-GROUPING
  8076                                    PI-GROUPING.
  8077     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8078                                 TO CERT-STATE
  8079                                    PI-STATE.
  8080     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8081                                 TO CERT-ACCOUNT
  8082                                    PI-ACCOUNT.
  8083     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8084                                 TO CERT-EFF-DT
  8085                                    PI-CERT-EFF-DT.
  8086     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8087                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 152
* EL130.cbl
  8088                                    PI-CERT-NO.
  8089
  8090     MOVE 'CERT'                 TO FILE-SWITCH.
  8091     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8092
  8093     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8094     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8095     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8096
  8097     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8098         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8099         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8100         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8101         IF INCURRED-DATE-MATCH
  8102             MOVE ER-7352        TO EMI-ERROR
  8103             MOVE -1             TO CERTNOL
  8104             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8105         ELSE
  8106             IF NO-CLAIMS-FOR-CERT
  8107                 MOVE ER-7353    TO EMI-ERROR
  8108                 MOVE -1         TO CERTNOL
  8109                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8110             ELSE
  8111                 MOVE ER-0558    TO EMI-ERROR
  8112                 MOVE -1         TO CERTNOL
  8113                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8114             END-IF
  8115         END-IF
  8116     END-IF.
  8117
  8118     MOVE SPACES                 TO PI-PRT-OPT
  8119                                    PI-ALT-PRT.
  8120
  8121     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8122
  8123     if (ws-lf-joint-indicator not = 'J')
  8124        and (ws-ah-joint-indicator not = 'J')
  8125        move 'P'                 to INSTYPEO
  8126        MOVE AL-UANON            TO INSTYPEA
  8127     end-if
  8128     IF LSTNMEL NOT GREATER ZERO
  8129        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8130         MOVE CRTLNMEI           TO  LSTNMEO
  8131         MOVE CRTFNMEI           TO  FSTNMEO
  8132         MOVE CRTINITI           TO  INITO
  8133         MOVE AL-UANON           TO  LSTNMEA
  8134                                     FSTNMEA
  8135                                     INITA
  8136     END-IF.
  8137
  8138     IF SSNL GREATER ZERO
  8139         GO TO 0655-SKIP-SOCIAL-SECURITY
  8140     END-IF.
  8141
  8142     IF CRTSSNI = SPACES OR LOW-VALUES
  8143         GO TO 0655-SKIP-SOCIAL-SECURITY
  8144     END-IF.
  8145
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 153
* EL130.cbl
  8146     IF CM-SSN-STATE   = CM-STATE AND
  8147        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8148            GO TO 0655-SKIP-SOCIAL-SECURITY
  8149     END-IF.
  8150
  8151     MOVE CRTSSNI                TO SSNO
  8152     MOVE AL-UANON               TO SSNA.
  8153
  8154 0655-SKIP-SOCIAL-SECURITY.
  8155
  8156     IF CLMCARRL NOT = ZERO  AND
  8157        CLMCARRI NOT = CRTCARRI
  8158        MOVE ER-0562             TO EMI-ERROR
  8159        MOVE AL-UABON            TO CLMCARRA
  8160        MOVE -1                  TO CLMCARRL
  8161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8162     END-IF.
  8163
  8164     IF CLMCARRL = ZERO
  8165        MOVE AL-UANON            TO CLMCARRA
  8166        MOVE CRTCARRI            TO CLMCARRI
  8167     END-IF.
  8168
  8169     MOVE 'A'                    TO MAINTO.
  8170     MOVE AL-UANON               TO MAINTA.
  8171
  8172     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8173        GO TO 8100-SEND-INITIAL-MAP
  8174     ELSE
  8175        GO TO 8150-SEND-MAP-CURSOR
  8176     END-IF.
  8177
  8178 0660-NOT-FOUND.
  8179     MOVE ER-0214                TO EMI-ERROR.
  8180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8181     GO TO 8100-SEND-INITIAL-MAP.
  8182
  8183 0670-QIDERR.
  8184     MOVE ER-0033                TO EMI-ERROR.
  8185     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8186     GO TO 8100-SEND-INITIAL-MAP.
  8187
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 154
* EL130.cbl
  8189 0680-PLUG-SELECTED-CERTS.
  8190
  8191     MOVE AL-SANON               TO BCERT1A
  8192                                    BSUFX1A
  8193                                    BCERT2A
  8194                                    BSUFX2A
  8195                                    BCERT3A
  8196                                    BSUFX3A
  8197                                    BCERT4A
  8198                                    BSUFX4A
  8199                                    BCERT5A
  8200                                    BSUFX5A.
  8201
  8202     IF PCERTNOO = SPACES OR LOW-VALUES
  8203         MOVE PI-EL127-CERT-PRIME (1)
  8204                                 TO PCERTNOO
  8205         MOVE PI-EL127-CERT-SUFX  (1)
  8206                                 TO PSUFXO
  8207     END-IF.
  8208
  8209     MOVE PI-EL127-CERT-PRIME (1)
  8210                                 TO BCERT1O.
  8211     MOVE PI-EL127-CERT-SUFX  (1)
  8212                                 TO BSUFX1O.
  8213
  8214     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8215         MOVE PI-EL127-CERT-PRIME (2)
  8216                                 TO BCERT2O
  8217         MOVE PI-EL127-CERT-SUFX  (2)
  8218                                 TO BSUFX2O
  8219     ELSE
  8220         MOVE LOW-VALUES         TO BCERT2O
  8221                                    BSUFX2O
  8222     END-IF.
  8223
  8224     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8225         MOVE PI-EL127-CERT-PRIME (3)
  8226                                 TO BCERT3O
  8227         MOVE PI-EL127-CERT-SUFX  (3)
  8228                                 TO BSUFX3O
  8229     ELSE
  8230         MOVE LOW-VALUES         TO BCERT3O
  8231                                    BSUFX3O
  8232     END-IF.
  8233
  8234     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8235         MOVE PI-EL127-CERT-PRIME (4)
  8236                                 TO BCERT4O
  8237         MOVE PI-EL127-CERT-SUFX  (4)
  8238                                 TO BSUFX4O
  8239     ELSE
  8240         MOVE LOW-VALUES         TO BCERT4O
  8241                                    BSUFX4O
  8242     END-IF.
  8243
  8244     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8245         MOVE PI-EL127-CERT-PRIME (5)
  8246                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 155
* EL130.cbl
  8247         MOVE PI-EL127-CERT-SUFX  (5)
  8248                                 TO BSUFX5O
  8249     ELSE
  8250         MOVE LOW-VALUES         TO BCERT5O
  8251                                    BSUFX5O
  8252     END-IF.
  8253
  8254 0680-EXIT.
  8255     EXIT.
  8256
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 156
* EL130.cbl
  8258 0690-HIGHLIGHT-CERTS.
  8259
  8260     MOVE AL-UANON               TO PCERTNOA
  8261                                    PSUFXA.
  8262
  8263     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8264        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8265            MOVE AL-SABON        TO BCERT1A
  8266                                    BSUFX1A
  8267     ELSE
  8268         MOVE AL-SANON           TO BCERT1A
  8269                                    BSUFX1A
  8270     END-IF.
  8271
  8272     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8273        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8274            MOVE AL-SABON        TO BCERT2A
  8275                                    BSUFX2A
  8276     ELSE
  8277         MOVE AL-SANON           TO BCERT2A
  8278                                    BSUFX2A
  8279     END-IF.
  8280
  8281     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8282        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8283            MOVE AL-SABON        TO BCERT3A
  8284                                    BSUFX3A
  8285     ELSE
  8286         MOVE AL-SANON           TO BCERT3A
  8287                                    BSUFX3A
  8288     END-IF.
  8289
  8290     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8291        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8292            MOVE AL-SABON        TO BCERT4A
  8293                                    BSUFX4A
  8294     ELSE
  8295         MOVE AL-SANON           TO BCERT4A
  8296                                    BSUFX4A
  8297     END-IF.
  8298
  8299     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8300        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8301            MOVE AL-SABON        TO BCERT5A
  8302                                    BSUFX5A
  8303     ELSE
  8304         MOVE AL-SANON           TO BCERT5A
  8305                                    BSUFX5A
  8306     END-IF.
  8307
  8308 0690-EXIT.
  8309     EXIT.
  8310
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 157
* EL130.cbl
  8312 0800-TEST-PREVIOUS-CONTROL.
  8313     IF CLMNOI   = PI-LAST-CLAIM       AND
  8314        CLMCARRI = PI-LAST-CARR        AND
  8315        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8316        SUFXI    = PI-LAST-CERT-SUFX
  8317*        NEXT SENTENCE
  8318         CONTINUE
  8319     ELSE
  8320         MOVE ER-0207            TO EMI-ERROR
  8321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8322         MOVE -1                 TO MAINTL
  8323         GO TO 8200-SEND-DATAONLY
  8324     END-IF.
  8325
  8326     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8327
  8328     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8329     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8330     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8331
  8332     IF EIBAID = DFHPF7
  8333         MOVE XCTL-157           TO PGM-NAME
  8334     END-IF.
  8335
  8336     IF EIBAID = DFHPF8
  8337         MOVE XCTL-141           TO PGM-NAME
  8338     END-IF.
  8339
  8340     IF EIBAID = DFHPF9
  8341        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8342                                    PI-SAVED-PROGRAM-2
  8343                                    PI-SAVED-PROGRAM-3
  8344                                    PI-SAVED-PROGRAM-4
  8345                                    PI-SAVED-PROGRAM-5
  8346                                    PI-SAVED-PROGRAM-6
  8347        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8348        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8349        MOVE XCTL-150            TO PGM-NAME
  8350     END-IF.
  8351
  8352     GO TO 9300-XCTL.
  8353
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 158
* EL130.cbl
  8355 1000-SHOW-CLAIM.
  8356
  8357     IF CLMNOL = ZERO
  8358         MOVE -1                 TO CLMNOL
  8359         MOVE AL-UABON           TO CLMNOA
  8360         MOVE ER-0202            TO EMI-ERROR
  8361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8362     ELSE
  8363         MOVE AL-UANON           TO CLMNOA
  8364     END-IF.
  8365
  8366     IF PI-NO-CARRIER-SECURITY
  8367        IF CLMCARRL = ZERO
  8368             MOVE -1             TO CLMCARRL
  8369             MOVE AL-UABON       TO CLMCARRA
  8370             MOVE ER-0194        TO EMI-ERROR
  8371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8372         ELSE
  8373             MOVE AL-UANON       TO CLMCARRA
  8374         END-IF
  8375     END-IF.
  8376
  8377     IF SUFXL = ZERO
  8378         MOVE SPACES             TO SUFXI
  8379         MOVE AL-UANON           TO SUFXA
  8380     ELSE
  8381         MOVE AL-UANON           TO SUFXA
  8382     END-IF.
  8383
  8384     IF NOT EMI-NO-ERRORS
  8385         GO TO 1050-SEND-CHECK
  8386     END-IF.
  8387
  8388
  8389
  8390* EXEC CICS HANDLE CONDITION
  8391*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8392*    END-EXEC.
  8393*    MOVE '"$I                   ! '' #00008154' TO DFHEIV0
  8394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8396     MOVE X'2720233030303038313534' TO DFHEIV0(25:11)
  8397     CALL 'kxdfhei1' USING DFHEIV0
  8398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8399
  8400
  8401     MOVE 'MSTR'                 TO FILE-SWITCH
  8402     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8403
  8404     MOVE CLMCARRI               TO MSTR-CARRIER.
  8405     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8406
  8407     IF CERTNOL = ZERO     OR
  8408        CERTNOI = SPACES   OR
  8409        CERTNOI = LOW-VALUES
  8410         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8411         MOVE AL-SANON        TO CERTNOA
  8412                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 159
* EL130.cbl
  8413     ELSE
  8414         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8415     END-IF.
  8416
  8417     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8418     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8419
  8420
  8421
  8422* EXEC CICS HANDLE CONDITION
  8423*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8424*    END-EXEC.
  8425*    MOVE '"$I                   ! ( #00008178' TO DFHEIV0
  8426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8428     MOVE X'2820233030303038313738' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0
  8430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8431
  8432
  8433     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8434
  8435     IF NOT PI-NO-ACCOUNT-SECURITY
  8436         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8437           MOVE ER-2371          TO EMI-ERROR
  8438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8439           MOVE -1               TO MAINTL
  8440           GO TO 8200-SEND-DATAONLY
  8441         END-IF
  8442     END-IF.
  8443
  8444
  8445
  8446* EXEC CICS HANDLE CONDITION
  8447*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8448*    END-EXEC.
  8449*    MOVE '"$I                   ! ) #00008194' TO DFHEIV0
  8450     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8452     MOVE X'2920233030303038313934' TO DFHEIV0(25:11)
  8453     CALL 'kxdfhei1' USING DFHEIV0
  8454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8455
  8456
  8457     MOVE 'Y'                    TO CLAIM-SWITCH.
  8458     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8459     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8460     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8461     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8462     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8463
  8464 1000-SHOW-END-OF-PERFORM.
  8465
  8466     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8467     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8468     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8469     MOVE CL-CERT-STATE          TO CERT-STATE.
  8470     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 160
* EL130.cbl
  8471     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8472     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8473
  8474     MOVE 'CERT'                 TO FILE-SWITCH.
  8475
  8476     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8477
  8478     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8479     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8480     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8481     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8482     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8483     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8484     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8485     MOVE CLMCARRI               TO PI-LAST-CARR.
  8486
  8487     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8488
  8489     IF MAINTI = 'I'
  8490         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8491                 BIRTHDTA  LSTNMEA   RELCLMA
  8492                 LOANNOA   LOANBALA  BENECDA
  8493         MOVE AL-SANON TO  SSNA
  8494         MOVE SPACES   TO  INCURI    REPORTI
  8495         MOVE 'Y'      TO PI-INCURR-SW
  8496         MOVE ER-0522  TO EMI-ERROR
  8497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8498     ELSE
  8499         MOVE ' '      TO PI-INCURR-SW
  8500     END-IF.
  8501
  8502     MOVE -1                     TO MAINTL.
  8503     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8504     MOVE CERT-GROUPING          TO PI-GROUPING.
  8505     MOVE CERT-STATE             TO PI-STATE.
  8506     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8507     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8508     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8509     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8510
  8511     IF RETURNED-FROM NOT = SPACES
  8512         GO TO 8100-SEND-INITIAL-MAP
  8513     ELSE
  8514         GO TO 8200-SEND-DATAONLY
  8515     END-IF.
  8516
  8517 1025-SHOW-RECORD-NOT-FOUND.
  8518
  8519     IF FILE-SWITCH = 'MSTR'
  8520         MOVE ER-0204            TO EMI-ERROR
  8521     ELSE
  8522         IF FILE-SWITCH = 'TRLR'
  8523             MOVE ER-0205        TO EMI-ERROR
  8524         ELSE
  8525             MOVE ER-0206        TO EMI-ERROR
  8526         END-IF
  8527     END-IF.
  8528
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 161
* EL130.cbl
  8529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8530
  8531 1050-SEND-CHECK.
  8532
  8533     IF RETURNED-FROM NOT = SPACES
  8534         GO TO 8100-SEND-INITIAL-MAP
  8535     ELSE
  8536         MOVE -1                 TO MAINTL
  8537         GO TO 8200-SEND-DATAONLY
  8538     END-IF.
  8539
  8540 2000-DELETE-CLAIM.
  8541     IF NOT MODIFY-CAP
  8542         MOVE ER-0070            TO EMI-ERROR
  8543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544         MOVE -1                 TO MAINTL
  8545         GO TO 8200-SEND-DATAONLY
  8546     END-IF.
  8547
  8548     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8549        CLMCARRI NOT = PI-LAST-CARR        OR
  8550        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8551        SUFXI    NOT = PI-LAST-CERT-SUFX
  8552         MOVE ER-0207            TO EMI-ERROR
  8553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554         MOVE -1                 TO MAINTL
  8555         GO TO 8200-SEND-DATAONLY
  8556     END-IF.
  8557
  8558
  8559
  8560* EXEC CICS HANDLE CONDITION
  8561*        NOTFND   (2050-DELETE-NOT-FOUND)
  8562*    END-EXEC.
  8563*    MOVE '"$I                   ! * #00008300' TO DFHEIV0
  8564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8566     MOVE X'2A20233030303038333030' TO DFHEIV0(25:11)
  8567     CALL 'kxdfhei1' USING DFHEIV0
  8568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8569
  8570
  8571     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8572
  8573     MOVE CLMCARRI               TO MSTR-CARRIER.
  8574     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8575     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8576     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8577
  8578     MOVE 'MSTR'                 TO FILE-SWITCH.
  8579     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8580
  8581     MOVE 'Y'                    TO CLAIM-SWITCH.
  8582
  8583     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8584        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8585         MOVE ER-0068        TO EMI-ERROR
  8586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 162
* EL130.cbl
  8587         MOVE -1             TO MAINTL
  8588         GO TO 8200-SEND-DATAONLY
  8589     END-IF.
  8590
  8591     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8592         MOVE ER-0569            TO EMI-ERROR
  8593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8594         MOVE -1                 TO MAINTL
  8595         GO TO 8200-SEND-DATAONLY
  8596     END-IF.
  8597
  8598     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8599         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8600     END-IF.
  8601
  8602     IF CL-PURGED-DT NOT = LOW-VALUES
  8603         MOVE ER-7691            TO EMI-ERROR
  8604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8605         MOVE -1                 TO MAINTL
  8606         GO TO 8200-SEND-DATAONLY
  8607     END-IF.
  8608
  8609     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8610     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8611     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8612     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8613     MOVE +0                     TO TRLR-SEQ-NO.
  8614     MOVE '1'                    TO TRLR-TYPE.
  8615
  8616     MOVE 'TRLR'                 TO FILE-SWITCH.
  8617
  8618
  8619
  8620* EXEC CICS READ
  8621*        UPDATE
  8622*        DATASET  (ELTRLR-DSID)
  8623*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8624*        RIDFLD   (ELTRLR-KEY)
  8625*    END-EXEC.
  8626*    MOVE '&"S        EU         (   #00008352' TO DFHEIV0
  8627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8629     MOVE X'2020233030303038333532' TO DFHEIV0(25:11)
  8630     CALL 'kxdfhei1' USING DFHEIV0,
  8631           ELTRLR-DSID,
  8632           DFHEIV20,
  8633           DFHEIV99,
  8634           ELTRLR-KEY,
  8635           DFHEIV99,
  8636           DFHEIV99,
  8637           DFHEIV99
  8638     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8639         DFHEIV20
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
  8643     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8644        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 163
* EL130.cbl
  8645         MOVE ER-0068        TO EMI-ERROR
  8646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8647         MOVE -1             TO MAINTL
  8648         GO TO 8200-SEND-DATAONLY
  8649     END-IF.
  8650
  8651
  8652
  8653* EXEC CICS DELETE
  8654*        DATASET   (ELTRLR-DSID)
  8655*    END-EXEC.
  8656*    MOVE '&(                    &   #00008368' TO DFHEIV0
  8657     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8658     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8659     MOVE X'2020233030303038333638' TO DFHEIV0(25:11)
  8660     CALL 'kxdfhei1' USING DFHEIV0,
  8661           ELTRLR-DSID,
  8662           DFHEIV99,
  8663           DFHEIV99,
  8664           DFHEIV99,
  8665           DFHEIV99
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669     MOVE +90                    TO TRLR-SEQ-NO.
  8670     MOVE '6'                    TO TRLR-TYPE.
  8671
  8672
  8673
  8674* EXEC CICS READ
  8675*        UPDATE
  8676*        DATASET  (ELTRLR-DSID)
  8677*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8678*        RIDFLD   (ELTRLR-KEY)
  8679*    END-EXEC.
  8680*    MOVE '&"S        EU         (   #00008376' TO DFHEIV0
  8681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8683     MOVE X'2020233030303038333736' TO DFHEIV0(25:11)
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           ELTRLR-DSID,
  8686           DFHEIV20,
  8687           DFHEIV99,
  8688           ELTRLR-KEY,
  8689           DFHEIV99,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8693         DFHEIV20
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8695
  8696
  8697
  8698
  8699* EXEC CICS DELETE
  8700*        DATASET   (ELTRLR-DSID)
  8701*    END-EXEC.
  8702*    MOVE '&(                    &   #00008384' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 164
* EL130.cbl
  8703     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038333834' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           ELTRLR-DSID,
  8708           DFHEIV99,
  8709           DFHEIV99,
  8710           DFHEIV99,
  8711           DFHEIV99
  8712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8713
  8714
  8715     MOVE +91                    TO TRLR-SEQ-NO.
  8716     MOVE '6'                    TO TRLR-TYPE.
  8717
  8718
  8719
  8720* EXEC CICS READ
  8721*        UPDATE
  8722*        DATASET  (ELTRLR-DSID)
  8723*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8724*        RIDFLD   (ELTRLR-KEY)
  8725*        RESP     (WS-RESPONSE)
  8726*    END-EXEC
  8727*    MOVE '&"S        EU         (  N#00008392' TO DFHEIV0
  8728     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8729     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8730     MOVE X'204E233030303038333932' TO DFHEIV0(25:11)
  8731     CALL 'kxdfhei1' USING DFHEIV0,
  8732           ELTRLR-DSID,
  8733           DFHEIV20,
  8734           DFHEIV99,
  8735           ELTRLR-KEY,
  8736           DFHEIV99,
  8737           DFHEIV99,
  8738           DFHEIV99
  8739     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8740         DFHEIV20
  8741     MOVE EIBRESP  TO WS-RESPONSE
  8742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8743
  8744     IF WS-RESP-NORMAL
  8745
  8746* EXEC CICS DELETE
  8747*          DATASET   (ELTRLR-DSID)
  8748*       END-EXEC
  8749*    MOVE '&(                    &   #00008401' TO DFHEIV0
  8750     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303038343031' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           ELTRLR-DSID,
  8755           DFHEIV99,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8760     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 165
* EL130.cbl
  8761
  8762     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8763     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8764     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8765     MOVE CL-CERT-STATE          TO CERT-STATE.
  8766     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8767     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8768     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8769
  8770     MOVE 'CERT'                 TO FILE-SWITCH.
  8771
  8772     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8773
  8774     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8775
  8776     IF WS-NUM-HOLD NOT = +0
  8777         GO TO 2005-REWRITE-CERT
  8778     END-IF.
  8779
  8780     IF NOT CERT-WAS-CREATED
  8781         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8782         GO TO 2005-REWRITE-CERT
  8783     END-IF.
  8784
  8785
  8786
  8787* EXEC CICS DELETE
  8788*        DATASET   (ELCERT-DSID)
  8789*    END-EXEC.
  8790*    MOVE '&(                    &   #00008430' TO DFHEIV0
  8791     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8793     MOVE X'2020233030303038343330' TO DFHEIV0(25:11)
  8794     CALL 'kxdfhei1' USING DFHEIV0,
  8795           ELCERT-DSID,
  8796           DFHEIV99,
  8797           DFHEIV99,
  8798           DFHEIV99,
  8799           DFHEIV99
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8801
  8802
  8803     GO TO 2010-DELETE-CL.
  8804
  8805 2005-REWRITE-CERT.
  8806
  8807     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8808
  8809
  8810
  8811* EXEC CICS HANDLE CONDITION
  8812*         DUPKEY   (2010-DELETE-CL)
  8813*    END-EXEC.
  8814*    MOVE '"$$                   ! + #00008441' TO DFHEIV0
  8815     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8817     MOVE X'2B20233030303038343431' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 166
* EL130.cbl
  8819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8820
  8821
  8822
  8823
  8824* EXEC CICS REWRITE
  8825*        DATASET  (ELCERT-DSID)
  8826*        FROM     (CERTIFICATE-MASTER)
  8827*    END-EXEC.
  8828     MOVE LENGTH OF
  8829      CERTIFICATE-MASTER
  8830       TO DFHEIV11
  8831*    MOVE '&& L                  %   #00008446' TO DFHEIV0
  8832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8834     MOVE X'2020233030303038343436' TO DFHEIV0(25:11)
  8835     CALL 'kxdfhei1' USING DFHEIV0,
  8836           ELCERT-DSID,
  8837           CERTIFICATE-MASTER,
  8838           DFHEIV11,
  8839           DFHEIV99
  8840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8841
  8842
  8843 2010-DELETE-CL.
  8844
  8845
  8846
  8847* EXEC CICS DELETE
  8848*        DATASET  (ELMSTR-DSID)
  8849*    END-EXEC.
  8850*    MOVE '&(                    &   #00008454' TO DFHEIV0
  8851     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303038343534' TO DFHEIV0(25:11)
  8854     CALL 'kxdfhei1' USING DFHEIV0,
  8855           ELMSTR-DSID,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99,
  8859           DFHEIV99
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8861
  8862
  8863     MOVE -1                     TO ONE-OR-MIN1.
  8864     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8865
  8866     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8867         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8868                                    WS-SAVE-CLAIM-KEY
  8869         MOVE +1                 TO ONE-OR-MIN1
  8870         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8871     END-IF.
  8872
  8873     MOVE ER-0000                TO EMI-ERROR.
  8874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8875     MOVE LOW-VALUES             TO EL130AO.
  8876     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 167
* EL130.cbl
  8877     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8878     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8879                                    PI-CERT-PROCESSED
  8880                                    PI-LETTER-ERROR-CODE.
  8881     GO TO 8100-SEND-INITIAL-MAP.
  8882
  8883 2050-DELETE-NOT-FOUND.
  8884     IF FILE-SWITCH = 'MSTR'
  8885         MOVE -1                 TO CLMNOL
  8886         MOVE ER-0204            TO EMI-ERROR
  8887     ELSE
  8888         IF FILE-SWITCH = 'TRLR'
  8889             MOVE -1             TO MAINTL
  8890             MOVE ER-0205        TO EMI-ERROR
  8891         ELSE
  8892             MOVE -1             TO CERTNOL
  8893             MOVE ER-0206        TO EMI-ERROR
  8894         END-IF
  8895     END-IF.
  8896
  8897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8898     GO TO 8200-SEND-DATAONLY.
  8899
  8900 3000-ADD-CLAIM.
  8901     IF NOT MODIFY-CAP
  8902         MOVE ER-0070            TO EMI-ERROR
  8903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8904         MOVE -1                 TO MAINTL
  8905         GO TO 8200-SEND-DATAONLY
  8906     END-IF.
  8907
  8908     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8909
  8910     IF CERTMTI = 'S'
  8911         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8912            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8913            WS-EFFDT = PI-SAVE-EFFDT       AND
  8914            ACCOUNTI = PI-SAVE-ACCOUNT
  8915             IF EMI-ERROR = 0
  8916                 GO TO 3010-TEST-FOR-ERRORS
  8917             ELSE
  8918                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8919                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8920                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8921                 MOVE PI-STATE         TO  CERT-STATE
  8922                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8923                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8924                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8925
  8926
  8927* EXEC CICS HANDLE CONDITION
  8928*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8929*                END-EXEC
  8930*    MOVE '"$I                   ! , #00008521' TO DFHEIV0
  8931     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8933     MOVE X'2C20233030303038353231' TO DFHEIV0(25:11)
  8934     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 168
* EL130.cbl
  8935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8936                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8937                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8938                 GO TO 3010-TEST-FOR-ERRORS
  8939             END-IF
  8940         END-IF
  8941     END-IF.
  8942
  8943     IF CERTMTI = 'A'
  8944         IF NOT PI-NO-CARRIER-SECURITY OR
  8945             NOT PI-NO-ACCOUNT-SECURITY
  8946             MOVE ER-2370          TO EMI-ERROR
  8947             MOVE -1               TO MAINTL
  8948             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8949             GO TO 8200-SEND-DATAONLY
  8950         ELSE
  8951             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8952             GO TO 3010-TEST-FOR-ERRORS
  8953         END-IF
  8954     END-IF.
  8955
  8956     IF CERTNOL = ZEROS
  8957        GO TO 3010-TEST-FOR-ERRORS
  8958     END-IF.
  8959
  8960 3000-READ-CERT.
  8961
  8962     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8963                                    MSTR5-COMP-CD.
  8964     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8965                                    MSTR5-CERT-NO-PRIME.
  8966     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8967                                    MSTR5-CERT-NO-SUFX.
  8968
  8969
  8970
  8971* EXEC CICS HANDLE CONDITION
  8972*         DUPKEY   (3008-DUP-ERROR)
  8973*         NOTFND   (3009-NOT-FOUND)
  8974*    END-EXEC
  8975*    MOVE '"$$I                  ! - #00008558' TO DFHEIV0
  8976     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8978     MOVE X'2D20233030303038353538' TO DFHEIV0(25:11)
  8979     CALL 'kxdfhei1' USING DFHEIV0
  8980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8981
  8982     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8983
  8984     IF NOT PI-NO-ACCOUNT-SECURITY
  8985         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8986             MOVE ER-2371          TO EMI-ERROR
  8987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8988             MOVE -1               TO MAINTL
  8989             GO TO 8200-SEND-DATAONLY
  8990         END-IF
  8991     END-IF.
  8992
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 169
* EL130.cbl
  8993     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8994     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  8995     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8996     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8997     MOVE CM-CARRIER             TO PI-CARRIER.
  8998     MOVE CM-GROUPING            TO PI-GROUPING.
  8999     MOVE CM-STATE               TO PI-STATE.
  9000     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9001     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9002     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9003     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9004
  9005     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9006         IF LSTNMEO = SPACES OR LOW-VALUES
  9007             MOVE CRTLNMEI       TO  LSTNMEO
  9008             MOVE AL-UANON       TO  LSTNMEA
  9009         END-IF
  9010     END-IF.
  9011
  9012     MOVE 'S'                    TO CERTMTO.
  9013*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9014     MOVE AL-SANON               TO CERTNOA.
  9015     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9016                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9017     IF EMI-NO-ERRORS
  9018         MOVE -1                  TO MAINTL
  9019     END-IF.
  9020
  9021     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9022         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9023         IF INCURRED-DATE-MATCH
  9024             MOVE ER-7352         TO EMI-ERROR
  9025             MOVE -1              TO CERTNOL
  9026             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9027         ELSE
  9028             IF NO-CLAIMS-FOR-CERT
  9029                 MOVE ER-7353     TO EMI-ERROR
  9030                 MOVE -1          TO CERTNOL
  9031                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9032             ELSE
  9033                 MOVE ER-0558     TO EMI-ERROR
  9034                 MOVE -1          TO CERTNOL
  9035                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9036                 GO TO 3010-TEST-FOR-ERRORS
  9037             END-IF
  9038         END-IF
  9039     END-IF.
  9040
  9041 3007-SEND-SCREEN.
  9042     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9043         GO TO 8150-SEND-MAP-CURSOR
  9044     ELSE
  9045         GO TO 8200-SEND-DATAONLY
  9046     END-IF.
  9047
  9048 3008-DUP-ERROR.
  9049     MOVE ER-0560                TO EMI-ERROR.
  9050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 170
* EL130.cbl
  9051     MOVE -1                     TO CERTNOL.
  9052     GO TO 3007-SEND-SCREEN.
  9053
  9054 3009-NOT-FOUND.
  9055     MOVE ER-0214                TO EMI-ERROR.
  9056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9057     MOVE -1                     TO CERTNOL.
  9058     GO TO 3007-SEND-SCREEN.
  9059
  9060 3010-TEST-FOR-ERRORS.
  9061
  9062     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9063     perform 6500-get-acct    thru 6500-exit
  9064     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9065*     perform 6500-get-acct    thru 6500-exit
  9066
  9067     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9068     move +0                     to e1
  9069     move spaces                 to ws-dcc-error-line
  9070     move ' '                    to ws-zero-bens-avail
  9071
  9072     if ws-dcc-product-code not = spaces
  9073        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9074        IF ERPDEF-FOUND
  9075           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9076           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9077           MOVE '1'              TO DC-OPTION-CODE
  9078           MOVE +0               TO DC-ELAPSED-MONTHS
  9079                                    DC-ELAPSED-DAYS
  9080           PERFORM 9700-LINK-DATE-CONVERT
  9081                                 THRU 9700-EXIT
  9082           IF NO-CONVERSION-ERROR
  9083              MOVE DC-ELAPSED-MONTHS
  9084                                 TO WS-MONTHS-BETWEEN
  9085              IF DC-ELAPSED-DAYS > 1
  9086                 ADD 1 TO WS-MONTHS-BETWEEN
  9087              END-IF
  9088           ELSE
  9089              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9090           END-IF
  9091
  9092           evaluate true
  9093              when (ws-excl-period not = zeros)
  9094                 and (ws-months-between <= ws-excl-period)
  9095                 MOVE -1         TO MAINTL
  9096                 add +1          to e1
  9097                 move 'Y'        to ws-zero-bens-avail
  9098                 MOVE ER-1651    TO EMI-ERROR
  9099                                    ws-error-no (e1)
  9100                 PERFORM 9900-ERROR-FORMAT
  9101                                 THRU 9900-EXIT
  9102              when (ws-cov-ends not = zeros)
  9103                 and (ws-months-between > ws-cov-ends)
  9104                 MOVE -1         TO MAINTL
  9105                 add +1          to e1
  9106                 move 'Y'        to ws-zero-bens-avail
  9107                 MOVE ER-1653    TO EMI-ERROR
  9108                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 171
* EL130.cbl
  9109                 evaluate true
  9110                    when clmtypei = 'L'
  9111                       move '  LF  ' to emi-claim-type
  9112                    when clmtypei = 'I'
  9113                       move '  IU  ' to emi-claim-type
  9114                    when clmtypei = 'F'
  9115                       move '  FL  ' to emi-claim-type
  9116                    when other
  9117                       move '  AH  ' to emi-claim-type
  9118                 end-evaluate
  9119                 PERFORM 9900-ERROR-FORMAT
  9120                                 THRU 9900-EXIT
  9121              when (ws-acc-period not = zeros)
  9122                 and (ws-months-between <= ws-acc-period)
  9123                 MOVE -1         TO MAINTL
  9124                 add +1          to e1
  9125                 MOVE ER-1652    TO EMI-ERROR
  9126                                    ws-error-no (e1)
  9127                 PERFORM 9900-ERROR-FORMAT
  9128                                 THRU 9900-EXIT
  9129                 add +1          to e1
  9130                 move er-1655    to emi-error
  9131                                    ws-error-no (e1)
  9132                 PERFORM 9900-ERROR-FORMAT
  9133                                 THRU 9900-EXIT
  9134              when clmtypei = 'I'
  9135                 add +1          to e1
  9136                 move er-1661    to emi-error
  9137                                    ws-error-no (e1)
  9138                 PERFORM 9900-ERROR-FORMAT
  9139                                 THRU 9900-EXIT
  9140           end-evaluate
  9141        END-IF
  9142*       perform 3996-read-cert-claim-trailer
  9143*                                thru 3996-exit
  9144     END-IF
  9145     perform 3996-read-cert-claim-trailer
  9146                                 thru 3996-exit
  9147     IF CERTMTI NOT = 'A'
  9148         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9149             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9150             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9151             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9152             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9153             IF INCURRED-DATE-MATCH
  9154                 MOVE ER-7352         TO EMI-ERROR
  9155                 MOVE -1              TO CERTNOL
  9156                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9157             ELSE
  9158                 IF NO-CLAIMS-FOR-CERT
  9159                     MOVE ER-7353     TO EMI-ERROR
  9160                     MOVE -1          TO CERTNOL
  9161                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9162                 ELSE
  9163                     MOVE ER-0558     TO EMI-ERROR
  9164                     MOVE -1          TO CERTNOL
  9165                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9166                 END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 172
* EL130.cbl
  9167             END-IF
  9168         END-IF
  9169     END-IF.
  9170
  9171     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9172         MOVE ER-0433             TO EMI-ERROR
  9173         MOVE -1                  TO MAINTL
  9174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9175         GO TO 8200-SEND-DATAONLY
  9176     END-IF.
  9177
  9178     IF (EMI-NO-ERRORS)
  9179        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9180         GO TO 3015-TRY-TO-BUILD
  9181     END-IF.
  9182
  9183     IF EIBAID = DFHPF6
  9184         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9185             MOVE ER-0434         TO EMI-ERROR
  9186             MOVE -1              TO MAINTL
  9187             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9188             GO TO 8200-SEND-DATAONLY
  9189         ELSE
  9190             MOVE +1              TO INCURL
  9191             GO TO 3015-TRY-TO-BUILD
  9192         END-IF
  9193     END-IF.
  9194
  9195     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9196         GO TO 8150-SEND-MAP-CURSOR
  9197     ELSE
  9198         GO TO 8200-SEND-DATAONLY
  9199     END-IF.
  9200
  9201 3015-TRY-TO-BUILD.
  9202     IF CLMNOL EQUAL ZERO
  9203         GO TO 3030-BUILD-CONT
  9204     END-IF.
  9205
  9206
  9207
  9208* EXEC CICS HANDLE CONDITION
  9209*        NOTFND   (3030-BUILD-CONT)
  9210*    END-EXEC.
  9211*    MOVE '"$I                   ! . #00008788' TO DFHEIV0
  9212     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9214     MOVE X'2E20233030303038373838' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0
  9216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9217
  9218
  9219     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9220
  9221     MOVE CLMCARRI               TO MSTR-CARRIER.
  9222     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9223     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9224     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 173
* EL130.cbl
  9225
  9226     MOVE 'MSTR'                 TO FILE-SWITCH.
  9227
  9228     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9229
  9230     MOVE ER-0221                TO EMI-ERROR.
  9231
  9232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9233     MOVE -1                     TO MAINTL.
  9234     GO TO 8200-SEND-DATAONLY.
  9235
  9236 3030-BUILD-CONT.
  9237     IF (CERTMTI NOT = 'A')
  9238        and (pi-company-id not = 'DCC' and 'VPP')
  9239         GO TO 3060-BUILD-CONT
  9240     END-IF.
  9241
  9242
  9243
  9244* EXEC CICS HANDLE CONDITION
  9245*        NOTFND   (3033-ACCT-NOT-FOUND)
  9246*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9247*    END-EXEC.
  9248*    MOVE '"$I''                  ! / #00008816' TO DFHEIV0
  9249     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9251     MOVE X'2F20233030303038383136' TO DFHEIV0(25:11)
  9252     CALL 'kxdfhei1' USING DFHEIV0
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9254
  9255
  9256     MOVE SPACES                 TO ERACCT-KEY.
  9257
  9258     IF CARR-GROUP-ST-ACCNT-CNTL
  9259         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9260         MOVE CRTCARRI           TO ACCT-CARRIER
  9261         MOVE GROUPI             TO ACCT-GROUPING
  9262         MOVE STATEI             TO ACCT-STATE
  9263         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9264         GO TO 3031-MOVE-ACCT-KEY
  9265     END-IF.
  9266
  9267     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9268     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9269
  9270     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9271         MOVE STATEI             TO ACCT-STATE
  9272     END-IF.
  9273
  9274     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9275         MOVE CRTCARRI           TO ACCT-CARRIER
  9276     END-IF.
  9277
  9278 3031-MOVE-ACCT-KEY.
  9279     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9280
  9281
  9282
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 174
* EL130.cbl
  9283* EXEC CICS STARTBR
  9284*        DATASET     (ERACCT2-DSID)
  9285*        RIDFLD      (SAVE-ERACCT-KEY)
  9286*        GENERIC
  9287*        KEYLENGTH   (20)
  9288*    END-EXEC.
  9289     MOVE 20
  9290       TO DFHEIV11
  9291     MOVE 0
  9292       TO DFHEIV12
  9293*    MOVE '&,   KG    G          &   #00008847' TO DFHEIV0
  9294     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9296     MOVE X'2020233030303038383437' TO DFHEIV0(25:11)
  9297     CALL 'kxdfhei1' USING DFHEIV0,
  9298           ERACCT2-DSID,
  9299           SAVE-ERACCT-KEY,
  9300           DFHEIV11,
  9301           DFHEIV12,
  9302           DFHEIV99
  9303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9304
  9305
  9306
  9307
  9308* EXEC CICS HANDLE CONDITION
  9309*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9310*    END-EXEC.
  9311*    MOVE '"$''                   ! 0 #00008855' TO DFHEIV0
  9312     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9314     MOVE X'3020233030303038383535' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9317
  9318
  9319 3031-READ-ACCT-LOOP.
  9320
  9321
  9322* EXEC CICS READNEXT
  9323*        DATASET   (ERACCT2-DSID)
  9324*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9325*        RIDFLD    (SAVE-ERACCT-KEY)
  9326*    END-EXEC.
  9327     MOVE 0
  9328       TO DFHEIV11
  9329*    MOVE '&.S                   )   #00008861' TO DFHEIV0
  9330     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9331     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9332     MOVE X'2020233030303038383631' TO DFHEIV0(25:11)
  9333     CALL 'kxdfhei1' USING DFHEIV0,
  9334           ERACCT2-DSID,
  9335           DFHEIV20,
  9336           DFHEIV99,
  9337           SAVE-ERACCT-KEY,
  9338           DFHEIV99,
  9339           DFHEIV11,
  9340           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 175
* EL130.cbl
  9341           DFHEIV99
  9342     SET ADDRESS OF ACCOUNT-MASTER TO
  9343         DFHEIV20
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9348        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9349        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9350        ACCT-STATE    NOT = AM-VG-STATE       OR
  9351        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9352         GO TO 3033-ACCT-NOT-FOUND
  9353     END-IF.
  9354
  9355     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9356        WS-EFFDT LESS AM-EXPIRATION-DT
  9357         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9358         MOVE AM-CARRIER       TO CERT-CARRIER
  9359         MOVE AM-GROUPING      TO CERT-GROUPING
  9360         MOVE AM-STATE         TO CERT-STATE
  9361         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9362         MOVE WS-EFFDT         TO CERT-EFF-DT
  9363         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9364         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9365         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9366         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9367     END-IF.
  9368
  9369     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9370         GO TO 3031-READ-ACCT-LOOP
  9371     END-IF.
  9372
  9373 3032-NOT-IN-DT-RANGE.
  9374     MOVE ER-0226                TO EMI-ERROR.
  9375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9376     MOVE -1                     TO EFFDTL.
  9377     GO TO 8200-SEND-DATAONLY.
  9378
  9379 3033-ACCT-NOT-FOUND.
  9380     MOVE ER-0226 TO EMI-ERROR.
  9381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9382     MOVE -1                     TO ACCOUNTL.
  9383     GO TO 8200-SEND-DATAONLY.
  9384
  9385 3034-CHECK-EMPLOYER-STATEMENT.
  9386
  9387     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9388*        NEXT SENTENCE
  9389         CONTINUE
  9390     ELSE
  9391         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9392     END-IF.
  9393
  9394     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9395     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9396     MOVE '1'                    TO  DC-OPTION-CODE.
  9397     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9398                                     DC-ELAPSED-DAYS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 176
* EL130.cbl
  9399     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9400
  9401     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9402         DC-ELAPSED-DAYS LESS THAN +31)
  9403                      OR
  9404        (AM-EMPLOYER-STMT-USED = '2' AND
  9405         DC-ELAPSED-DAYS LESS THAN +61)
  9406                      OR
  9407        (AM-EMPLOYER-STMT-USED = '3' AND
  9408         DC-ELAPSED-DAYS LESS THAN +91)
  9409            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9410     END-IF.
  9411
  9412 3034-CHECK-ACCOUNT-LIMITS.
  9413
  9414     IF CERTMTI NOT = 'A'
  9415         GO TO 3060-BUILD-CONT
  9416     END-IF.
  9417
  9418     IF AM-STATUS NOT = '0'
  9419         MOVE ER-0225                TO EMI-ERROR
  9420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9421         MOVE -1                     TO ACCOUNTL
  9422     END-IF.
  9423
  9424     IF EIBAID = DFHPF6
  9425         IF EMI-FATAL-CTR NOT = ZERO
  9426             MOVE ER-0434         TO EMI-ERROR
  9427             MOVE -1              TO MAINTL
  9428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9429             GO TO 8200-SEND-DATAONLY
  9430         END-IF
  9431     END-IF.
  9432
  9433*    IF PI-COMPANY-ID NOT = 'CRI'
  9434*        GO TO 3035-END-BROWSE
  9435*    END-IF.
  9436
  9437 3035-END-BROWSE.
  9438
  9439
  9440* EXEC CICS ENDBR
  9441*        DATASET    (ERACCT2-DSID)
  9442*    END-EXEC.
  9443     MOVE 0
  9444       TO DFHEIV11
  9445*    MOVE '&2                    $   #00008959' TO DFHEIV0
  9446     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9447     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9448     MOVE X'2020233030303038393539' TO DFHEIV0(25:11)
  9449     CALL 'kxdfhei1' USING DFHEIV0,
  9450           ERACCT2-DSID,
  9451           DFHEIV11,
  9452           DFHEIV99
  9453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9454
  9455
  9456 3040-CHECK-CERT-ALREADY-ON.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 177
* EL130.cbl
  9457
  9458
  9459* EXEC CICS HANDLE CONDITION
  9460*        NOTFND   (3070-BUILD-CONT)
  9461*    END-EXEC.
  9462*    MOVE '"$I                   ! 1 #00008965' TO DFHEIV0
  9463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9465     MOVE X'3120233030303038393635' TO DFHEIV0(25:11)
  9466     CALL 'kxdfhei1' USING DFHEIV0
  9467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9468
  9469
  9470     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9471
  9472     MOVE ER-0229                TO EMI-ERROR.
  9473     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9474     MOVE -1                     TO MAINTL.
  9475     GO TO 8200-SEND-DATAONLY.
  9476
  9477 3060-BUILD-CONT.
  9478     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9479     MOVE CRTCARRI               TO CERT-CARRIER.
  9480     MOVE GROUPI                 TO CERT-GROUPING.
  9481     MOVE STATEI                 TO CERT-STATE.
  9482     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9483     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9484     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9485     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9486
  9487
  9488
  9489* EXEC CICS HANDLE CONDITION
  9490*        NOTFND  (3065-CERT-NOT-FOUND)
  9491*    END-EXEC.
  9492*    MOVE '"$I                   ! 2 #00008987' TO DFHEIV0
  9493     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9495     MOVE X'3220233030303038393837' TO DFHEIV0(25:11)
  9496     CALL 'kxdfhei1' USING DFHEIV0
  9497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9498
  9499
  9500     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9501
  9502     GO TO 3070-BUILD-CONT.
  9503
  9504 3065-CERT-NOT-FOUND.
  9505     MOVE ER-0244                TO EMI-ERROR.
  9506     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9507     MOVE -1                     TO CERTNOL.
  9508     GO TO 8200-SEND-DATAONLY.
  9509
  9510 3070-BUILD-CONT.
  9511     IF CLMNOL NOT = ZERO
  9512         GO TO 3200-BUILD-ZERO-TRAILER
  9513     END-IF.
  9514
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 178
* EL130.cbl
  9515     MOVE SPACES                 TO ELCNTL-KEY.
  9516
  9517     IF CONTROL-IS-ACTUAL-CARRIER
  9518         MOVE PI-CARRIER         TO CNTL-CARRIER
  9519     ELSE
  9520         MOVE PI-CARRIER-CONTROL-LEVEL
  9521                                 TO CNTL-CARRIER
  9522     END-IF.
  9523
  9524     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9525     MOVE '6'                    TO CNTL-REC-TYPE.
  9526     MOVE +0                     TO CNTL-SEQ-NO.
  9527
  9528
  9529
  9530* EXEC CICS HANDLE CONDITION
  9531*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9532*    END-EXEC.
  9533*    MOVE '"$I                   ! 3 #00009020' TO DFHEIV0
  9534     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9536     MOVE X'3320233030303039303230' TO DFHEIV0(25:11)
  9537     CALL 'kxdfhei1' USING DFHEIV0
  9538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9539
  9540
  9541
  9542
  9543* EXEC CICS READ
  9544*        UPDATE
  9545*        DATASET   (ELCNTL-DSID)
  9546*        SET       (ADDRESS OF CONTROL-FILE)
  9547*        RIDFLD    (ELCNTL-KEY)
  9548*    END-EXEC.
  9549*    MOVE '&"S        EU         (   #00009025' TO DFHEIV0
  9550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9552     MOVE X'2020233030303039303235' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ELCNTL-DSID,
  9555           DFHEIV20,
  9556           DFHEIV99,
  9557           ELCNTL-KEY,
  9558           DFHEIV99,
  9559           DFHEIV99,
  9560           DFHEIV99
  9561     SET ADDRESS OF CONTROL-FILE TO
  9562         DFHEIV20
  9563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9564
  9565
  9566     IF CLAIM-NO-MANUAL
  9567         GO TO 3120-CLAIM-MUST-BE-INPUT
  9568     END-IF.
  9569
  9570     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9571     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9572
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 179
* EL130.cbl
  9573     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9574         CONTINUE
  9575     ELSE
  9576         GO TO 3080-ASSIGN-LOOP
  9577     END-IF.
  9578
  9579
  9580
  9581* EXEC CICS UNLOCK
  9582*        DATASET   (ELCNTL-DSID)
  9583*    END-EXEC.
  9584*    MOVE '&*                    #   #00009046' TO DFHEIV0
  9585     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9586     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9587     MOVE X'2020233030303039303436' TO DFHEIV0(25:11)
  9588     CALL 'kxdfhei1' USING DFHEIV0,
  9589           ELCNTL-DSID,
  9590           DFHEIV99
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594     MOVE '1'                    TO CNTL-REC-TYPE.
  9595     MOVE SPACES                 TO CNTL-ACCESS.
  9596
  9597     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9598
  9599
  9600
  9601* EXEC CICS HANDLE CONDITION
  9602*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9603*    END-EXEC.
  9604*    MOVE '"$I                   ! 4 #00009056' TO DFHEIV0
  9605     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9607     MOVE X'3420233030303039303536' TO DFHEIV0(25:11)
  9608     CALL 'kxdfhei1' USING DFHEIV0
  9609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9610
  9611
  9612     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9613
  9614     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9615
  9616 3080-ASSIGN-LOOP.
  9617     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9618        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9619         MOVE +0                 TO SAVE-COUNTER
  9620     END-IF.
  9621
  9622     ADD +1 TO SAVE-COUNTER.
  9623
  9624     IF SAVE-METHOD  = '3'
  9625         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9626         GO TO 3090-SET-COMP
  9627     END-IF.
  9628
  9629     IF SAVE-METHOD  = '4'
  9630         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 180
* EL130.cbl
  9631         MOVE CLMCARRI           TO WS-CN-PRF-A
  9632         GO TO 3090-SET-COMP
  9633     END-IF.
  9634
  9635     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9636     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9637     MOVE SAVE-DATE              TO CURR-DATE.
  9638
  9639     IF CURR-MM LESS '10'
  9640         MOVE CURR-M2             TO WS-CN-PRF-B
  9641     END-IF.
  9642
  9643     IF CURR-MM = '10'
  9644        MOVE 'A'                 TO WS-CN-PRF-B
  9645     END-IF.
  9646     IF CURR-MM = '11'
  9647        MOVE 'B'                 TO WS-CN-PRF-B
  9648     END-IF.
  9649     IF CURR-MM = '12'
  9650        MOVE 'C'                 TO WS-CN-PRF-B
  9651     END-IF.
  9652
  9653     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9654
  9655 3090-SET-COMP.
  9656
  9657     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9658     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9659                                    CLMNOO.
  9660     MOVE AL-UANON               TO CLMNOA.
  9661     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9662     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9663     MOVE CLMCARRI               TO MSTR-CARRIER.
  9664
  9665
  9666
  9667* EXEC CICS HANDLE CONDITION
  9668*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9669*    END-EXEC.
  9670*    MOVE '"$I                   ! 5 #00009114' TO DFHEIV0
  9671     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9673     MOVE X'3520233030303039313134' TO DFHEIV0(25:11)
  9674     CALL 'kxdfhei1' USING DFHEIV0
  9675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9676
  9677
  9678     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9679
  9680     GO TO 3080-ASSIGN-LOOP.
  9681
  9682 3100-CARRIER-NOT-FOUND.
  9683     MOVE ER-0252                TO EMI-ERROR.
  9684     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9685     MOVE -1                     TO CLMCARRL.
  9686     GO TO 8200-SEND-DATAONLY.
  9687
  9688 3110-COMPANY-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 181
* EL130.cbl
  9689     MOVE ER-0254                TO EMI-ERROR.
  9690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9691     MOVE -1                     TO MAINTL.
  9692     GO TO 8200-SEND-DATAONLY.
  9693
  9694 3120-CLAIM-MUST-BE-INPUT.
  9695     MOVE ER-0264                TO EMI-ERROR.
  9696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9697     MOVE -1                     TO CLMNOL.
  9698     GO TO 8200-SEND-DATAONLY.
  9699
  9700 3200-BUILD-ZERO-TRAILER.
  9701
  9702
  9703* EXEC CICS HANDLE CONDITION
  9704*        NOTFND
  9705*    END-EXEC.
  9706*    MOVE '"$                   ! 6 #00009142' TO DFHEIV0
  9707     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9709     MOVE X'3620233030303039313432' TO DFHEIV0(25:11)
  9710     CALL 'kxdfhei1' USING DFHEIV0
  9711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9712
  9713
  9714
  9715
  9716* EXEC CICS GETMAIN
  9717*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9718*        LENGTH  (ELTRLR-LENGTH)
  9719*    END-EXEC.
  9720*    MOVE '," L                  $   #00009147' TO DFHEIV0
  9721     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9722     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9723     MOVE X'2020233030303039313437' TO DFHEIV0(25:11)
  9724     CALL 'kxdfhei1' USING DFHEIV0,
  9725           DFHEIV20,
  9726           ELTRLR-LENGTH,
  9727           DFHEIV99
  9728     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9729         DFHEIV20
  9730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9731
  9732
  9733     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9734     MOVE 'AT'                   TO AT-RECORD-ID.
  9735
  9736     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9737     MOVE CLMCARRI               TO AT-CARRIER.
  9738     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9739     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9740     MOVE +0                     TO AT-SEQUENCE-NO.
  9741     MOVE '1'                    TO AT-TRAILER-TYPE.
  9742
  9743     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9744     MOVE '5'                    TO DC-OPTION-CODE.
  9745     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9746     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 182
* EL130.cbl
  9747                                    AT-RESERVES-LAST-MAINT-DT.
  9748
  9749     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9750                                    AT-RESERVES-LAST-UPDATED-BY.
  9751
  9752     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9753
  9754     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9755
  9756     MOVE +0                     TO AT-FUTURE-RESERVE
  9757                                    AT-IBNR-RESERVE
  9758                                    AT-PAY-CURRENT-RESERVE
  9759                                    AT-INITIAL-MANUAL-RESERVE
  9760                                    AT-CURRENT-MANUAL-RESERVE
  9761                                    AT-ITD-LIFE-REFUNDS
  9762                                    AT-ITD-AH-REFUNDS
  9763                                    AT-ITD-ADDITIONAL-RESERVE.
  9764
  9765     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9766
  9767     IF MANRSVL NOT = ZERO
  9768         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9769                                    AT-CURRENT-MANUAL-RESERVE
  9770     END-IF.
  9771
  9772     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9773
  9774     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9775                                    AT-ITD-CHARGEABLE-EXPENSE.
  9776
  9777     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9778     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9779     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9780
  9781
  9782
  9783* EXEC CICS WRITE
  9784*        DATASET   (ELTRLR-DSID)
  9785*        FROM      (ACTIVITY-TRAILERS)
  9786*        RIDFLD    (AT-CONTROL-PRIMARY)
  9787*    END-EXEC.
  9788     MOVE LENGTH OF
  9789      ACTIVITY-TRAILERS
  9790       TO DFHEIV11
  9791*    MOVE '&$ L                  ''   #00009201' TO DFHEIV0
  9792     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9794     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
  9795     CALL 'kxdfhei1' USING DFHEIV0,
  9796           ELTRLR-DSID,
  9797           ACTIVITY-TRAILERS,
  9798           DFHEIV11,
  9799           AT-CONTROL-PRIMARY,
  9800           DFHEIV99,
  9801           DFHEIV99
  9802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9803
  9804
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 183
* EL130.cbl
  9805     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9806
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 184
* EL130.cbl
  9808
  9809 3250-BUILD-I1-ADDRESS-TRAILER.
  9810
  9811     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9812     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9813     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9814     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9815     MOVE GROUPI                 TO WS-MA-GROUPING.
  9816     MOVE STATEI                 TO WS-MA-STATE.
  9817     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9818     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9819     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9820     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9821
  9822
  9823* EXEC CICS HANDLE CONDITION
  9824*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9825*    END-EXEC.
  9826*    MOVE '"$I                   ! 7 #00009224' TO DFHEIV0
  9827     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9829     MOVE X'3720233030303039323234' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9832
  9833
  9834
  9835* EXEC CICS READ
  9836*        EQUAL
  9837*        DATASET   (ERMAIL-DSID)
  9838*        SET       (ADDRESS OF MAILING-DATA)
  9839*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9840*    END-EXEC.
  9841*    MOVE '&"S        E          (   #00009228' TO DFHEIV0
  9842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9844     MOVE X'2020233030303039323238' TO DFHEIV0(25:11)
  9845     CALL 'kxdfhei1' USING DFHEIV0,
  9846           ERMAIL-DSID,
  9847           DFHEIV20,
  9848           DFHEIV99,
  9849           WS-MA-CONTROL-PRIMARY,
  9850           DFHEIV99,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     SET ADDRESS OF MAILING-DATA TO
  9854         DFHEIV20
  9855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9856
  9857
  9858     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9859         GO TO 3290-NO-INSURED-ADDRESS
  9860     END-IF.
  9861
  9862     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9863     MOVE 'AT'                   TO AT-RECORD-ID.
  9864
  9865     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 185
* EL130.cbl
  9866     MOVE CLMCARRI               TO AT-CARRIER.
  9867     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9868     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9869     MOVE +1                     TO AT-SEQUENCE-NO.
  9870     MOVE '5'                    TO AT-TRAILER-TYPE.
  9871
  9872     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9873     IF MA-INSURED-MIDDLE-INIT > SPACES
  9874        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9875               ' ' DELIMITED BY SIZE
  9876               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9877               ' ' DELIMITED BY SIZE
  9878               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9879        INTO AT-MAIL-TO-NAME
  9880     ELSE
  9881        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9882               ' ' DELIMITED BY SIZE
  9883               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9884        INTO AT-MAIL-TO-NAME
  9885     END-IF.
  9886     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9887     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9888*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9889     MOVE MA-CITY                TO AT-CITY
  9890     MOVE MA-ADDR-STATE          TO AT-STATE
  9891     MOVE MA-ZIP                 TO AT-ZIP
  9892     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9893
  9894     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9895                                    AT-ADDRESS-LAST-MAINT-DT.
  9896
  9897     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9898                                    AT-ADDRESS-LAST-UPDATED-BY.
  9899
  9900     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9901
  9902
  9903* EXEC CICS WRITE
  9904*        DATASET   (ELTRLR-DSID)
  9905*        FROM      (ACTIVITY-TRAILERS)
  9906*        RIDFLD    (AT-CONTROL-PRIMARY)
  9907*    END-EXEC.
  9908     MOVE LENGTH OF
  9909      ACTIVITY-TRAILERS
  9910       TO DFHEIV11
  9911*    MOVE '&$ L                  ''   #00009279' TO DFHEIV0
  9912     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9914     MOVE X'2020233030303039323739' TO DFHEIV0(25:11)
  9915     CALL 'kxdfhei1' USING DFHEIV0,
  9916           ELTRLR-DSID,
  9917           ACTIVITY-TRAILERS,
  9918           DFHEIV11,
  9919           AT-CONTROL-PRIMARY,
  9920           DFHEIV99,
  9921           DFHEIV99
  9922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9923
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 186
* EL130.cbl
  9924
  9925     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9926     GO TO 3300-BUILD-NINETY-TRAILER.
  9927
  9928 3290-NO-INSURED-ADDRESS.
  9929      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9930
  9931 3300-BUILD-NINETY-TRAILER.
  9932
  9933     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9934     MOVE 'AT'                   TO AT-RECORD-ID.
  9935
  9936     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9937     MOVE CLMCARRI               TO AT-CARRIER.
  9938
  9939     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9940     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9941     MOVE +90                    TO AT-SEQUENCE-NO.
  9942     MOVE '6'                    TO AT-TRAILER-TYPE.
  9943
  9944     IF DIAGL NOT = ZERO
  9945         MOVE DIAGI              TO AT-INFO-LINE-1
  9946     END-IF.
  9947
  9948     IF ICD1L NOT = ZERO
  9949         MOVE ICD1I              TO AT-ICD-CODE-1
  9950     END-IF.
  9951
  9952     IF ICD2L NOT = ZERO
  9953         MOVE ICD2I              TO AT-ICD-CODE-2
  9954     END-IF.
  9955
  9956     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9957                                    AT-GEN-INFO-LAST-MAINT-DT.
  9958
  9959     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9960                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9961     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9962
  9963
  9964
  9965* EXEC CICS WRITE
  9966*        DATASET   (ELTRLR-DSID)
  9967*        FROM      (ACTIVITY-TRAILERS)
  9968*        RIDFLD    (AT-CONTROL-PRIMARY)
  9969*    END-EXEC.
  9970     MOVE LENGTH OF
  9971      ACTIVITY-TRAILERS
  9972       TO DFHEIV11
  9973*    MOVE '&$ L                  ''   #00009324' TO DFHEIV0
  9974     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9976     MOVE X'2020233030303039333234' TO DFHEIV0(25:11)
  9977     CALL 'kxdfhei1' USING DFHEIV0,
  9978           ELTRLR-DSID,
  9979           ACTIVITY-TRAILERS,
  9980           DFHEIV11,
  9981           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 187
* EL130.cbl
  9982           DFHEIV99,
  9983           DFHEIV99
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9985
  9986
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 188
* EL130.cbl
  9988 3400-CHECK-CERT-MAINT.
  9989
  9990     IF CERTMTI = 'A'
  9991         GO TO 3600-BUILD-NEW-CERT
  9992     END-IF.
  9993
  9994     IF NO-CLAIM-ATTACHED
  9995         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9996     END-IF.
  9997
  9998     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9999
 10000     IF CM-LF-CURRENT-STATUS = '2' OR
 10001        CM-AH-CURRENT-STATUS = '2'
 10002         GO TO 3400-REWRITE-CERT
 10003     END-IF.
 10004
 10005     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10006
 10007 3400-REWRITE-CERT.
 10008
 10009
 10010
 10011* EXEC CICS HANDLE CONDITION
 10012*        DUPKEY (3410-DUP-KEY)
 10013*    END-EXEC.
 10014*    MOVE '"$$                   ! 8 #00009353' TO DFHEIV0
 10015     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10017     MOVE X'3820233030303039333533' TO DFHEIV0(25:11)
 10018     CALL 'kxdfhei1' USING DFHEIV0
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022
 10023
 10024* EXEC CICS REWRITE
 10025*        DATASET   (ELCERT-DSID)
 10026*        FROM      (CERTIFICATE-MASTER)
 10027*    END-EXEC.
 10028     MOVE LENGTH OF
 10029      CERTIFICATE-MASTER
 10030       TO DFHEIV11
 10031*    MOVE '&& L                  %   #00009358' TO DFHEIV0
 10032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10034     MOVE X'2020233030303039333538' TO DFHEIV0(25:11)
 10035     CALL 'kxdfhei1' USING DFHEIV0,
 10036           ELCERT-DSID,
 10037           CERTIFICATE-MASTER,
 10038           DFHEIV11,
 10039           DFHEIV99
 10040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10041
 10042
 10043 3410-DUP-KEY.
 10044     GO TO 3800-BUILD-NEW-CLAIM.
 10045
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 189
* EL130.cbl
 10046 3600-BUILD-NEW-CERT.
 10047
 10048
 10049* EXEC CICS GETMAIN
 10050*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10051*        LENGTH   (ELCERT-LENGTH)
 10052*    END-EXEC.
 10053*    MOVE '," L                  $   #00009368' TO DFHEIV0
 10054     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10055     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10056     MOVE X'2020233030303039333638' TO DFHEIV0(25:11)
 10057     CALL 'kxdfhei1' USING DFHEIV0,
 10058           DFHEIV20,
 10059           ELCERT-LENGTH,
 10060           DFHEIV99
 10061     SET ADDRESS OF CERTIFICATE-MASTER TO
 10062         DFHEIV20
 10063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10064
 10065
 10066     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10067
 10068     MOVE 'CM'                   TO CM-RECORD-ID.
 10069
 10070     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10071                                    CM-COMPANY-CD-A1
 10072                                    CM-COMPANY-CD-A2
 10073                                    CM-COMPANY-CD-A4
 10074                                    CM-COMPANY-CD-A5.
 10075
 10076     MOVE CERT-CARRIER           TO CM-CARRIER.
 10077     MOVE CERT-GROUPING          TO CM-GROUPING.
 10078     MOVE CERT-STATE             TO CM-STATE.
 10079     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10080     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10081     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10082
 10083     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10084                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10085                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10086                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10087                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10088                       CM-LIVES              CM-LOAN-TERM
 10089                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10090                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10091                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10092                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10093                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10094                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10095                       CM-LF-ALT-PREMIUM-RATE
 10096                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10097                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10098                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10099                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10100                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10101
 10102     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10103                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 190
* EL130.cbl
 10104                                    CM-AH-SETTLEMENT-DT
 10105                                    CM-AH-CANCEL-EXIT-DT
 10106                                    CM-AH-SETTLEMENT-EXIT-DT
 10107                                    CM-LF-LOAN-EXPIRE-DT
 10108                                    CM-LF-CANCEL-DT
 10109                                    CM-LF-DEATH-DT
 10110                                    CM-LF-CANCEL-EXIT-DT
 10111                                    CM-LF-DEATH-EXIT-DT
 10112                                    CM-LAST-ADD-ON-DT
 10113                                    CM-ENTRY-DT.
 10114
 10115     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10116     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10117     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10118
 10119     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10120                                    CM-PART-LAST-NAME-A2
 10121                                    CM-PART-LAST-NAME-A5.
 10122
 10123     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10124                                    CM-INSURED-INITIAL1-A2
 10125                                    CM-INSURED-INITIAL1-A5
 10126                                    CM-INSURED-FIRST-NAME.
 10127
 10128     IF CRTINITL GREATER ZERO
 10129         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10130                                    CM-INSURED-INITIAL2-A2
 10131                                    CM-INSURED-INITIAL2-A5
 10132     ELSE
 10133         MOVE SPACES             TO CM-INSURED-INITIAL2
 10134                                    CM-INSURED-INITIAL2-A2
 10135                                    CM-INSURED-INITIAL2-A5
 10136     END-IF.
 10137
 10138     IF CM-INSURED-INITIALS = SPACES
 10139         MOVE '**'               TO CM-INSURED-INITIALS
 10140     END-IF.
 10141
 10142     IF MEMBERL GREATER ZERO
 10143         MOVE MEMBERI              TO CM-MEMBER-NO
 10144     ELSE
 10145         MOVE CERT-STATE           TO CM-MEMB-STATE
 10146         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10147         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10148         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10149     END-IF.
 10150
 10151     IF JNTLNMEL GREATER ZERO
 10152         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10153     END-IF.
 10154
 10155     IF JNTFNMEL GREATER ZERO
 10156         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10157     END-IF.
 10158
 10159     IF JNTINITL GREATER ZERO
 10160         MOVE JNTINITI           TO CM-JT-INITIAL
 10161     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 191
* EL130.cbl
 10162
 10163     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10164
 10165
 10166
 10167* EXEC CICS HANDLE CONDITION
 10168*        DUPKEY   (3690-CERT-WRITTEN)
 10169*    END-EXEC.
 10170*    MOVE '"$$                   ! 9 #00009473' TO DFHEIV0
 10171     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10173     MOVE X'3920233030303039343733' TO DFHEIV0(25:11)
 10174     CALL 'kxdfhei1' USING DFHEIV0
 10175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10176
 10177
 10178
 10179
 10180* EXEC CICS WRITE
 10181*        DATASET   (ELCERT-DSID)
 10182*        FROM      (CERTIFICATE-MASTER)
 10183*        RIDFLD    (CM-CONTROL-PRIMARY)
 10184*    END-EXEC.
 10185     MOVE LENGTH OF
 10186      CERTIFICATE-MASTER
 10187       TO DFHEIV11
 10188*    MOVE '&$ L                  ''   #00009478' TO DFHEIV0
 10189     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10190     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10191     MOVE X'2020233030303039343738' TO DFHEIV0(25:11)
 10192     CALL 'kxdfhei1' USING DFHEIV0,
 10193           ELCERT-DSID,
 10194           CERTIFICATE-MASTER,
 10195           DFHEIV11,
 10196           CM-CONTROL-PRIMARY,
 10197           DFHEIV99,
 10198           DFHEIV99
 10199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10200
 10201
 10202 3690-CERT-WRITTEN.
 10203
 10204     GO TO 3800-BUILD-NEW-CLAIM.
 10205
 10206 3690-EXIT.
 10207      EXIT.
 10208
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 192
* EL130.cbl
 10210 3700-BUILD-CERT.
 10211
 10212     IF CERTMTI NOT = 'A'
 10213         GO TO 3700-FINISH-CERT-BUILD
 10214     END-IF.
 10215
 10216     IF CERTMTI = 'A'
 10217         IF LCVCDL = ZEROS
 10218             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10219                                    CM-LF-ORIG-TERM
 10220                                    CM-LF-BENEFIT-AMT
 10221                                    CM-LF-PREMIUM-RATE
 10222             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10223         END-IF
 10224     END-IF.
 10225
 10226     IF LCVCDL GREATER ZERO
 10227         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10228     END-IF.
 10229
 10230     IF LCVOTRML GREATER ZERO
 10231         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10232     END-IF.
 10233
 10234     IF LCVBENEL GREATER ZERO
 10235         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10236     END-IF.
 10237
 10238     IF LCVRATEL GREATER ZERO
 10239         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10240     END-IF.
 10241
 10242     IF WS-EXPIRE NOT = LOW-VALUES
 10243         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10244     END-IF.
 10245
 10246     IF LCVFORML GREATER ZERO
 10247         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10248     END-IF.
 10249
 10250     IF LCVCNDTL = ZERO
 10251        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10252     END-IF.
 10253
 10254     IF WS-LCVCNDT NOT = LOW-VALUES
 10255        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10256        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10257        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10258     END-IF.
 10259
 10260     IF CM-LF-CURRENT-STATUS = '7'
 10261        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10262        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10263        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10264                                    CM-LF-DEATH-DT
 10265        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10266     END-IF.
 10267
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 193
* EL130.cbl
 10268     IF CM-LF-CURRENT-STATUS = '8'
 10269        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10270        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10271     END-IF.
 10272
 10273 3700-BUILD-AH-COVERAGE-SIDE.
 10274
 10275     IF CERTMTI = 'A'
 10276         IF ACVCDL = ZEROS
 10277             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10278                                    CM-AH-ORIG-TERM
 10279                                    CM-AH-BENEFIT-AMT
 10280                                    CM-AH-PREMIUM-RATE
 10281             GO TO 3700-COVERAGE-BUILT
 10282         END-IF
 10283     END-IF.
 10284
 10285     IF ACVCDL GREATER ZERO
 10286         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10287     END-IF.
 10288
 10289     IF ACVOTRML GREATER ZERO
 10290         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10291     END-IF.
 10292
 10293     IF ACVBENEL GREATER ZERO
 10294         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10295     END-IF.
 10296
 10297     IF ACVRATEL GREATER ZERO
 10298         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10299     END-IF.
 10300
 10301     IF WS-EXPIRE NOT = LOW-VALUES
 10302         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10303     END-IF.
 10304
 10305     IF ACVFORML GREATER ZERO
 10306         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10307     END-IF.
 10308
 10309     IF ACVCNDTL = ZERO
 10310        GO TO 3700-COVERAGE-BUILT
 10311     END-IF.
 10312
 10313     IF WS-ACVCNDT NOT = LOW-VALUES
 10314        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10315        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10316        GO TO 3700-COVERAGE-BUILT
 10317     END-IF.
 10318
 10319     IF CM-AH-CURRENT-STATUS = '6'
 10320        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10321        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10322        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10323        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10324        GO TO 3700-COVERAGE-BUILT
 10325     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 194
* EL130.cbl
 10326
 10327     IF CM-AH-CURRENT-STATUS = '8'
 10328        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10329        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10330     END-IF.
 10331
 10332 3700-COVERAGE-BUILT.
 10333     IF ISSAGEL GREATER ZERO
 10334         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10335     END-IF.
 10336
 10337     IF JNTAGEL GREATER ZERO
 10338         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10339     END-IF.
 10340
 10341     IF SEXL GREATER ZERO
 10342         MOVE SEXI               TO CM-INSURED-SEX
 10343     END-IF.
 10344
 10345     IF APRL GREATER ZERO
 10346         MOVE WS-APR             TO CM-LOAN-APR
 10347     END-IF.
 10348
 10349     IF PMTFREQL GREATER ZERO
 10350         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10351     END-IF.
 10352
 10353     IF INDGRPL GREATER ZERO
 10354         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10355     END-IF.
 10356
 10357     IF CERTMTI = 'A'
 10358         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10359     END-IF.
 10360
 10361     IF REINCDL GREATER ZERO
 10362         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10363                                    WS-REIN-1
 10364                                    WS-REIN-2
 10365                                    WS-REIN-3
 10366         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10367     END-IF.
 10368
 10369     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10370         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10371     END-IF.
 10372
 10373     IF CRTSSNL GREATER ZERO
 10374         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10375     ELSE
 10376         IF SSNL GREATER ZERO
 10377             MOVE SSNI           TO CM-SOC-SEC-NO
 10378         END-IF
 10379     END-IF.
 10380
 10381     IF CRTSSNL = ZERO AND
 10382        SSNL    = ZERO
 10383         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 195
* EL130.cbl
 10384         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10385         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10386         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10387     END-IF.
 10388
 10389     IF CM-LF-CURRENT-STATUS = SPACES
 10390         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10391     END-IF.
 10392
 10393     IF CM-AH-CURRENT-STATUS = SPACES
 10394         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10395     END-IF.
 10396
 10397     IF CERTMTI = 'A'
 10398         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10399     END-IF.
 10400
 10401 3700-FINISH-CERT-BUILD.
 10402
 10403     IF LOANNOL GREATER ZERO
 10404         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10405     END-IF.
 10406
 10407     IF LOANBALL GREATER ZERO
 10408         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10409     END-IF.
 10410
 10411     IF PREMTYPL GREATER ZERO
 10412         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10413     END-IF.
 10414
 10415 3700-EXIT.
 10416      EXIT.
 10417
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 196
* EL130.cbl
 10419 3800-BUILD-NEW-CLAIM.
 10420
 10421*************************************************************
 10422*****           START OF ACTIVITY FILE PROCESSING          **
 10423*************************************************************
 10424     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10425         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10426                 6700-EXIT
 10427     END-IF.
 10428*************************************************************
 10429*****            END OF ACTIVITY FILE PROCESSING           **
 10430*************************************************************
 10431
 10432
 10433
 10434
 10435* EXEC CICS GETMAIN
 10436*        SET     (ADDRESS OF CLAIM-MASTER)
 10437*        LENGTH  (ELMSTR-LENGTH)
 10438*    END-EXEC.
 10439*    MOVE '," L                  $   #00009716' TO DFHEIV0
 10440     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10441     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10442     MOVE X'2020233030303039373136' TO DFHEIV0(25:11)
 10443     CALL 'kxdfhei1' USING DFHEIV0,
 10444           DFHEIV20,
 10445           ELMSTR-LENGTH,
 10446           DFHEIV99
 10447     SET ADDRESS OF CLAIM-MASTER TO
 10448         DFHEIV20
 10449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10450
 10451
 10452     MOVE SPACES TO CLAIM-MASTER.
 10453
 10454     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10455         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10456         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10457         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10458         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10459         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10460         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10461         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10462
 10463     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10464             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10465             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10466             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10467             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10468             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10469             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10470             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10471             CL-FORCEABLE-ERROR-CNT.
 10472
 10473     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10474
 10475     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10476                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 197
* EL130.cbl
 10477                                    CL-LAG-REPORT-CODE
 10478                                    CL-CRITICAL-PERIOD
 10479*                                   CL-CRIT-PER-RTW-MOS
 10480     move 01                     to cl-benefit-period
 10481
 10482     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10483     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10484
 10485     IF BENECDL NOT = ZEROS
 10486        MOVE BENECDI             TO CL-BENEFICIARY
 10487     END-IF.
 10488
 10489     MOVE 'CL'                   TO CL-RECORD-ID.
 10490     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10491
 10492     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10493                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10494                             CL-COMPANY-CD-A5.
 10495
 10496     MOVE CLMCARRI               TO CL-CARRIER.
 10497
 10498     IF CLMNOL = ZERO
 10499         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10500     ELSE
 10501         MOVE CLMNOI             TO CL-CLAIM-NO
 10502     END-IF.
 10503
 10504     MOVE CERTNOI                TO CL-CERT-PRIME
 10505                                    CL-CERT-A4-PRIME.
 10506
 10507     MOVE SUFXI                  TO CL-CERT-SFX
 10508                                    CL-CERT-A4-SFX.
 10509
 10510     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10511
 10512     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10513
 10514     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10515
 10516     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10517
 10518     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10519     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10520
 10521     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10522
 10523     IF CERTMTI = 'A'
 10524         MOVE '2'                TO CL-CERT-ORIGIN
 10525     ELSE
 10526         MOVE '1'                TO CL-CERT-ORIGIN
 10527     END-IF.
 10528
 10529     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10530     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10531     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10532     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10533     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10534
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 198
* EL130.cbl
 10535 3820-REWRITE-CONTROL-FILE.
 10536
 10537     IF CLMNOL GREATER ZERO
 10538         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10539     END-IF.
 10540
 10541     IF CF-RECORD-TYPE = '6'
 10542         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10543     ELSE
 10544         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10545     END-IF.
 10546
 10547
 10548
 10549* EXEC CICS REWRITE
 10550*        DATASET   (ELCNTL-DSID)
 10551*        FROM      (CONTROL-FILE)
 10552*    END-EXEC.
 10553     MOVE LENGTH OF
 10554      CONTROL-FILE
 10555       TO DFHEIV11
 10556*    MOVE '&& L                  %   #00009817' TO DFHEIV0
 10557     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10558     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10559     MOVE X'2020233030303039383137' TO DFHEIV0(25:11)
 10560     CALL 'kxdfhei1' USING DFHEIV0,
 10561           ELCNTL-DSID,
 10562           CONTROL-FILE,
 10563           DFHEIV11,
 10564           DFHEIV99
 10565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10566
 10567
 10568 3830-SEQUENCE-CLAIM-RECORDS.
 10569
 10570     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10571     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10572     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10573
 10574     IF WS-ASSOC-CERT-TOTAL = ZERO
 10575         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10576                                    CL-ASSOC-CERT-TOTAL
 10577         GO TO 3840-WRITE-CLAIM-MASTER
 10578     END-IF.
 10579
 10580     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10581         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10582     ELSE
 10583         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10584     END-IF.
 10585
 10586     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10587     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10588     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10589
 10590 3840-WRITE-CLAIM-MASTER.
 10591
 10592     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 199
* EL130.cbl
 10593     IF WS-REC-FOUND-SW = 'Y'
 10594         MOVE 01                 TO  CL-ACTIVITY-CODE
 10595         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10596         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10597     END-IF.
 10598
 10599
 10600
 10601* EXEC CICS HANDLE CONDITION
 10602*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10603*    END-EXEC.
 10604*    MOVE '"$$                   ! : #00009854' TO DFHEIV0
 10605     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10607     MOVE X'3A20233030303039383534' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0
 10609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10610
 10611
 10612** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10613     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10614
 10615
 10616*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10617*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10618*       CL-CERT-NO
 10619*    IF CL-COMPANY-CD = X'04'
 10620*       DISPLAY ' CID COMP CD '
 10621*    ELSE
 10622*       IF CL-COMPANY-CD = X'05'
 10623*          DISPLAY ' DCC COMP CD '
 10624*       ELSE
 10625*          DISPLAY ' UNKNOWN COMP CD '
 10626*       END-IF
 10627*    END-IF
 10628
 10629* EXEC CICS WRITE
 10630*        DATASET   (ELMSTR-DSID)
 10631*        FROM      (CLAIM-MASTER)
 10632*        RIDFLD    (CL-CONTROL-PRIMARY)
 10633*    END-EXEC.
 10634     MOVE LENGTH OF
 10635      CLAIM-MASTER
 10636       TO DFHEIV11
 10637*    MOVE '&$ L                  ''   #00009874' TO DFHEIV0
 10638     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10639     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10640     MOVE X'2020233030303039383734' TO DFHEIV0(25:11)
 10641     CALL 'kxdfhei1' USING DFHEIV0,
 10642           ELMSTR-DSID,
 10643           CLAIM-MASTER,
 10644           DFHEIV11,
 10645           CL-CONTROL-PRIMARY,
 10646           DFHEIV99,
 10647           DFHEIV99
 10648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10649
 10650
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 200
* EL130.cbl
 10651 3850-CLAIM-MSTR-WRITTEN.
 10652
 10653     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10654         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10655     END-IF.
 10656
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 201
* EL130.cbl
 10658 3990-ADD-DONE.
 10659*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10660*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10661*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10662*                                  EMI-ERROR-LINES.
 10663
 10664     IF CLMNOL = ZERO
 10665         move spaces             to emi-claim-no
 10666         MOVE ER-0265            TO EMI-ERROR
 10667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10668         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10669                                    PI-LAST-CLAIM
 10670     ELSE
 10671         MOVE CLMNOI             TO PI-LAST-CLAIM
 10672                                    MSTR-CLAIM-NO
 10673         MOVE ER-0000            TO EMI-ERROR
 10674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10675     END-IF.
 10676
 10677     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10678       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10679         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10680         MOVE ER-7575            TO EMI-ERROR
 10681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10682     END-IF.
 10683
 10684     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10685       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10686         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10687         MOVE ER-7582            TO EMI-ERROR
 10688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10689     END-IF.
 10690
 10691     IF WS-NO-INSURED-ADDRESS = 'Y'
 10692         MOVE ER-3548            TO EMI-ERROR
 10693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10694     END-IF.
 10695
 10696     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10697       (PI-ST-CAUSAL-STATE = 'L' AND
 10698              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10699       (PI-ST-CAUSAL-STATE = 'A' AND
 10700              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10701         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10702         MOVE ER-7577            TO EMI-ERROR
 10703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10704     END-IF.
 10705     if pi-company-id = 'DCC' OR 'VPP'
 10706        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10707                                 THRU 3994C-EXIT
 10708     end-if
 10709     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10710     MOVE CLMCARRI                   TO  PI-CARRIER.
 10711     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10712     MOVE SUFXI                      TO  PI-CERT-SFX.
 10713
 10714     IF WS-LETTER-SW = 'Y'
 10715         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 202
* EL130.cbl
 10716         IF W-1523-ERROR-CODE NOT = ZEROS
 10717             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10719         END-IF
 10720     END-IF.
 10721
 10722     perform 3998-update-cert-claim-trailer
 10723                                 thru 3998-exit
 10724     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10725     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10726     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10727     MOVE CLMCARRI               TO PI-LAST-CARR.
 10728
 10729     IF PRTOPTL GREATER THAN 0
 10730         MOVE PRTOPTI            TO PI-PRT-OPT
 10731     END-IF.
 10732     IF ALTPRTL GREATER THAN 0
 10733         MOVE ALTPRTI            TO PI-ALT-PRT
 10734     END-IF.
 10735
 10736     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10737         MOVE LOW-VALUES         TO EL130AI
 10738         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10739         MOVE AL-SANON           TO CERTNOA
 10740         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10741         MOVE AL-SANON           TO SUFXA
 10742         MOVE PI-LAST-CARR       TO CLMCARRO
 10743         MOVE AL-UANON           TO CLMCARRA
 10744         MOVE PI-LAST-CLAIM      TO CLMNOO
 10745         MOVE AL-UANON           TO CLMNOA
 10746         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10747         MOVE AL-UANON           TO CLMTYPEA
 10748     ELSE
 10749         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10750         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10751     END-IF.
 10752
 10753     IF PI-PRT-OPT = 'N' OR 'L'
 10754         MOVE PI-PRT-OPT         TO PRTOPTO
 10755         MOVE 1                  TO PRTOPTL
 10756     END-IF.
 10757
 10758     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10759         MOVE PI-ALT-PRT         TO ALTPRTO
 10760         MOVE 4                  TO ALTPRTL
 10761     END-IF.
 10762
 10763     IF PRTOPTL GREATER THAN 0
 10764         IF PRTOPTI = 'L'
 10765             GO TO 0400-CREATE-ELACTQ
 10766         ELSE
 10767             GO TO 0480-PRINT-NOW
 10768         END-IF
 10769     END-IF.
 10770     move 'S'                    to mainti
 10771     PERFORM 0500-CREATE-TEMP-STORAGE
 10772                                 THRU 0599-EXIT
 10773     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 203
* EL130.cbl
 10774         GO TO 8100-SEND-INITIAL-MAP
 10775     ELSE
 10776         MOVE LOW-VALUES         TO MAINTO
 10777         MOVE -1                 TO MAINTL
 10778         GO TO 8200-SEND-DATAONLY
 10779     END-IF.
 10780
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 204
* EL130.cbl
 10782 3993-MODIFY-SCREEN-ATTRB.
 10783
 10784     IF CERTMTL GREATER ZERO
 10785         MOVE AL-UANON           TO CERTMTA
 10786     END-IF.
 10787
 10788     IF EFFDTL GREATER ZERO
 10789         MOVE AL-UANON           TO EFFDTA
 10790     END-IF.
 10791
 10792     IF ACCOUNTL GREATER ZERO
 10793         MOVE AL-UANON           TO ACCOUNTA
 10794     END-IF.
 10795
 10796     IF STATEL GREATER ZERO
 10797         MOVE AL-UANON           TO STATEA
 10798     END-IF.
 10799
 10800     IF CRTCARRL GREATER ZERO
 10801         MOVE AL-UANON           TO CRTCARRA
 10802     END-IF.
 10803
 10804     IF GROUPL GREATER ZERO
 10805         MOVE AL-UANON           TO GROUPA
 10806     END-IF.
 10807
 10808     IF CRTLNMEL GREATER ZERO
 10809         MOVE AL-UANON           TO CRTLNMEA
 10810     END-IF.
 10811
 10812     IF CRTFNMEL GREATER ZERO
 10813         MOVE AL-UANON           TO CRTFNMEA
 10814     END-IF.
 10815
 10816     IF CRTINITL GREATER ZERO
 10817         MOVE AL-UANON           TO CRTINITA
 10818     END-IF.
 10819
 10820     IF ISSAGEL GREATER ZERO
 10821         MOVE AL-UNNON           TO ISSAGEA
 10822     END-IF.
 10823
 10824     IF JNTLNMEL GREATER ZERO
 10825         MOVE AL-UANON           TO JNTLNMEA
 10826     END-IF.
 10827
 10828     IF JNTFNMEL GREATER ZERO
 10829         MOVE AL-UANON           TO JNTFNMEA
 10830     END-IF.
 10831
 10832     IF JNTINITL GREATER ZERO
 10833         MOVE AL-UANON           TO JNTINITA
 10834     END-IF.
 10835
 10836     IF JNTAGEL GREATER ZERO
 10837         MOVE AL-UNNON           TO JNTAGEA
 10838     END-IF.
 10839
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 205
* EL130.cbl
 10840     IF CRTSSNL GREATER ZERO
 10841         MOVE AL-UANON           TO CRTSSNA
 10842     END-IF.
 10843
 10844     IF ACVDSCRL GREATER ZERO
 10845         MOVE AL-SANON           TO ACVDSCRA
 10846     END-IF.
 10847
 10848     IF ACVKINDL GREATER ZERO
 10849         MOVE AL-SANON           TO ACVKINDA
 10850     END-IF.
 10851
 10852     IF ACVCDL GREATER ZERO
 10853         MOVE AL-UANON           TO ACVCDA
 10854     END-IF.
 10855
 10856     IF ACVOTRML GREATER ZERO
 10857         MOVE AL-UNNON           TO ACVOTRMA
 10858     END-IF.
 10859
 10860     IF ACVRTRML GREATER ZERO
 10861         MOVE AL-UNNON           TO ACVRTRMA
 10862     END-IF.
 10863
 10864     IF ACVRATEL GREATER ZERO
 10865         MOVE AL-UNNON           TO ACVRATEA
 10866     END-IF.
 10867
 10868     IF ACVBENEL GREATER ZERO
 10869         MOVE AL-UNNON           TO ACVBENEA
 10870     END-IF.
 10871
 10872     IF ACVFORML GREATER ZERO
 10873         MOVE AL-UANON           TO ACVFORMA
 10874     END-IF.
 10875
 10876     IF ACVCNDTL GREATER ZERO
 10877         MOVE AL-UANON           TO ACVCNDTA
 10878     END-IF.
 10879
 10880     IF ACVEXITL GREATER ZERO
 10881         MOVE AL-UANON           TO ACVEXITA
 10882     END-IF.
 10883
 10884     IF ACVSTATL GREATER ZERO
 10885         MOVE AL-UANON           TO ACVSTATA
 10886     END-IF.
 10887
 10888     IF LCVDSCRL GREATER ZERO
 10889         MOVE AL-SANON           TO LCVDSCRA
 10890     END-IF.
 10891
 10892     IF LCVKINDL GREATER ZERO
 10893         MOVE AL-SANON           TO LCVKINDA
 10894     END-IF.
 10895
 10896     IF LCVCDL GREATER ZERO
 10897         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 206
* EL130.cbl
 10898     END-IF.
 10899
 10900     IF LCVOTRML GREATER ZERO
 10901         MOVE AL-UNNON           TO LCVOTRMA
 10902     END-IF.
 10903
 10904     IF LCVRTRML GREATER ZERO
 10905         MOVE AL-UNNON           TO LCVRTRMA
 10906     END-IF.
 10907
 10908     IF LCVRATEL GREATER ZERO
 10909         MOVE AL-UNNON           TO LCVRATEA
 10910     END-IF.
 10911
 10912     IF LCVBENEL GREATER ZERO
 10913         MOVE AL-UNNON           TO LCVBENEA
 10914     END-IF.
 10915
 10916     IF LCVFORML GREATER ZERO
 10917         MOVE AL-UANON           TO LCVFORMA
 10918     END-IF.
 10919
 10920     IF LCVCNDTL GREATER ZERO
 10921         MOVE AL-UANON           TO LCVCNDTA
 10922     END-IF.
 10923
 10924     IF LCVEXITL GREATER ZERO
 10925         MOVE AL-UANON           TO LCVEXITA
 10926     END-IF.
 10927
 10928     IF LCVSTATL GREATER ZERO
 10929         MOVE AL-UANON           TO LCVSTATA
 10930     END-IF.
 10931
 10932     IF MEMCAPL GREATER ZERO
 10933         MOVE AL-UANON           TO MEMCAPA
 10934     END-IF.
 10935
 10936     IF APRL GREATER ZERO
 10937         MOVE AL-UNNON           TO APRA
 10938     END-IF.
 10939
 10940     IF PMTFREQL GREATER ZERO
 10941         MOVE AL-UNNON           TO PMTFREQA
 10942     END-IF.
 10943
 10944     IF INDGRPL GREATER ZERO
 10945         MOVE AL-UANON           TO INDGRPA
 10946     END-IF.
 10947
 10948     IF PREMTYPL GREATER ZERO
 10949         MOVE AL-UANON           TO PREMTYPA
 10950     END-IF.
 10951
 10952     IF REINCDL GREATER ZERO
 10953         MOVE AL-UANON           TO REINCDA
 10954     END-IF.
 10955
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 207
* EL130.cbl
 10956     IF ADDONDTL GREATER ZERO
 10957         MOVE AL-UANON           TO ADDONDTA
 10958     END-IF.
 10959
 10960     IF MEMBERL GREATER ZERO
 10961         MOVE AL-UANON           TO MEMBERA
 10962     END-IF.
 10963
 10964     IF BCERT1L GREATER ZERO
 10965         MOVE AL-SANON           TO BCERT1A
 10966                                    BSUFX1A
 10967     END-IF.
 10968
 10969     IF BCERT2L GREATER ZERO
 10970         MOVE AL-SANON           TO BCERT2A
 10971                                    BSUFX2A
 10972     END-IF.
 10973
 10974     IF BCERT3L GREATER ZERO
 10975         MOVE AL-SANON           TO BCERT3A
 10976                                    BSUFX3A
 10977     END-IF.
 10978
 10979     IF BCERT4L GREATER ZERO
 10980         MOVE AL-SANON           TO BCERT4A
 10981                                    BSUFX4A
 10982     END-IF.
 10983
 10984     IF BCERT5L GREATER ZERO
 10985         MOVE AL-SANON           TO BCERT5A
 10986                                    BSUFX5A
 10987     END-IF.
 10988
 10989 3993-MODIFY-CLAIM-ATTRB.
 10990
 10991     IF PCERTNOL GREATER ZERO
 10992         MOVE AL-UANON           TO PCERTNOA
 10993     END-IF.
 10994
 10995     IF PSUFXL GREATER ZERO
 10996         MOVE AL-UANON           TO PSUFXA
 10997     END-IF.
 10998
 10999     IF LSTNMEL GREATER ZERO
 11000         MOVE AL-UANON           TO LSTNMEA
 11001     END-IF.
 11002
 11003     IF FSTNMEL GREATER ZERO
 11004         MOVE AL-UANON           TO FSTNMEA
 11005     END-IF.
 11006
 11007     IF INITL GREATER ZERO
 11008         MOVE AL-UANON           TO INITA
 11009     END-IF.
 11010
 11011     IF SEXL GREATER ZERO
 11012         MOVE AL-UANON           TO SEXA
 11013     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 208
* EL130.cbl
 11014
 11015     IF BIRTHDTL GREATER ZERO
 11016         MOVE AL-UANON           TO BIRTHDTA
 11017     END-IF.
 11018
 11019     IF SSNL GREATER ZERO
 11020         MOVE AL-UANON           TO SSNA
 11021     END-IF.
 11022
 11023     IF INCURL GREATER ZERO
 11024         MOVE AL-UANON           TO INCURA
 11025     END-IF.
 11026
 11027     IF REPORTL GREATER ZERO
 11028         MOVE AL-UANON           TO REPORTA
 11029     END-IF.
 11030
 11031*    IF ESTENDL GREATER ZERO
 11032*        MOVE AL-UANON           TO ESTENDA
 11033*    END-IF.
 11034
 11035     IF DIAGL GREATER ZERO
 11036         MOVE AL-UANON           TO DIAGA
 11037     END-IF.
 11038*
 11039     IF ICD1L GREATER ZERO
 11040         MOVE AL-UANON           TO ICD1A
 11041     END-IF.
 11042
 11043     IF ICD2L GREATER ZERO
 11044         MOVE AL-UANON           TO ICD2A
 11045     END-IF.
 11046
 11047*    IF CAUSEL GREATER ZERO
 11048*        MOVE AL-UANON           TO CAUSEA
 11049*    END-IF.
 11050
 11051     IF MANRSVL GREATER ZERO
 11052         MOVE AL-UNNON           TO MANRSVA
 11053     END-IF.
 11054
 11055     IF RELCLML GREATER ZERO
 11056         MOVE AL-UANON           TO RELCLMA
 11057     END-IF.
 11058
 11059     IF LOANNOL GREATER ZERO
 11060         MOVE AL-UANON           TO LOANNOA
 11061     END-IF.
 11062
 11063     IF LOANBALL GREATER ZERO
 11064         MOVE AL-UNNON           TO LOANBALA
 11065     END-IF.
 11066
 11067     IF PROCCDL GREATER ZERO
 11068         MOVE AL-UANON           TO PROCCDA
 11069     END-IF.
 11070
 11071     IF BENECDL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 209
* EL130.cbl
 11072         MOVE AL-UANON           TO  BENECDA
 11073     END-IF.
 11074
 11075     IF PRICDL GREATER ZERO
 11076         MOVE AL-UANON           TO PRICDA
 11077     END-IF.
 11078
 11079     IF SUPVL GREATER ZERO
 11080         MOVE AL-UANON           TO SUPVA
 11081     END-IF.
 11082
 11083     IF FILETOL GREATER ZERO
 11084         MOVE AL-UANON           TO FILETOA
 11085     END-IF.
 11086
 11087
 11088 3993-MODIFY-CLAIM-KEY-ATTRB.
 11089
 11090     IF CLMNOL GREATER ZERO
 11091         MOVE AL-UANON           TO CLMNOA
 11092     END-IF.
 11093
 11094     IF CLMCARRL GREATER ZERO
 11095         MOVE AL-UANON           TO CLMCARRA
 11096     END-IF.
 11097
 11098     IF CLMTYPEL GREATER ZERO
 11099         MOVE AL-UANON           TO CLMTYPEA
 11100     END-IF.
 11101
 11102     IF CERTNOL GREATER ZERO
 11103         MOVE AL-SANON           TO CERTNOA
 11104     END-IF.
 11105
 11106     IF SUFXL GREATER ZERO
 11107         MOVE AL-SANON           TO SUFXA
 11108     END-IF.
 11109
 11110 3993-EXIT.
 11111     EXIT.
 11112
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 210
* EL130.cbl
 11114 3994-BUILD-NINETY-THREE-TRAILER.
 11115
 11116     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11117     MOVE 'AT'                   TO AT-RECORD-ID.
 11118
 11119     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11120     MOVE CLMCARRI               TO AT-CARRIER.
 11121
 11122     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11123     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11124     MOVE +93                    TO AT-SEQUENCE-NO.
 11125     MOVE '6'                    TO AT-TRAILER-TYPE.
 11126     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11127
 11128     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11129         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11130     ELSE
 11131         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11132     END-IF
 11133
 11134     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11135                                    AT-GEN-INFO-LAST-MAINT-DT.
 11136
 11137     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11138                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11139     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11140
 11141
 11142
 11143* EXEC CICS WRITE
 11144*        DATASET   (ELTRLR-DSID)
 11145*        FROM      (ACTIVITY-TRAILERS)
 11146*        RIDFLD    (AT-CONTROL-PRIMARY)
 11147*    END-EXEC.
 11148     MOVE LENGTH OF
 11149      ACTIVITY-TRAILERS
 11150       TO DFHEIV11
 11151*    MOVE '&$ L                  ''   #00010371' TO DFHEIV0
 11152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11154     MOVE X'2020233030303130333731' TO DFHEIV0(25:11)
 11155     CALL 'kxdfhei1' USING DFHEIV0,
 11156           ELTRLR-DSID,
 11157           ACTIVITY-TRAILERS,
 11158           DFHEIV11,
 11159           AT-CONTROL-PRIMARY,
 11160           DFHEIV99,
 11161           DFHEIV99
 11162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11163
 11164
 11165 3994-EXIT.
 11166     EXIT.
 11167
 11168 3994B-BUILD-NINETY-FOUR-TRAILER.
 11169
 11170     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11171     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 211
* EL130.cbl
 11172
 11173     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11174     MOVE CLMCARRI               TO AT-CARRIER.
 11175
 11176     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11177     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11178     MOVE +94                    TO AT-SEQUENCE-NO.
 11179     MOVE '6'                    TO AT-TRAILER-TYPE.
 11180     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11181
 11182     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11183
 11184     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11185                                    AT-GEN-INFO-LAST-MAINT-DT.
 11186
 11187     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11188                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11189     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11190
 11191
 11192
 11193* EXEC CICS WRITE
 11194*        DATASET   (ELTRLR-DSID)
 11195*        FROM      (ACTIVITY-TRAILERS)
 11196*        RIDFLD    (AT-CONTROL-PRIMARY)
 11197*    END-EXEC.
 11198     MOVE LENGTH OF
 11199      ACTIVITY-TRAILERS
 11200       TO DFHEIV11
 11201*    MOVE '&$ L                  ''   #00010404' TO DFHEIV0
 11202     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11204     MOVE X'2020233030303130343034' TO DFHEIV0(25:11)
 11205     CALL 'kxdfhei1' USING DFHEIV0,
 11206           ELTRLR-DSID,
 11207           ACTIVITY-TRAILERS,
 11208           DFHEIV11,
 11209           AT-CONTROL-PRIMARY,
 11210           DFHEIV99,
 11211           DFHEIV99
 11212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11213
 11214
 11215 3994B-EXIT.
 11216     EXIT.
 11217 3994C-BUILD-NINETY-FIVE-TRAILER.
 11218
 11219     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11220     MOVE 'AT'                   TO AT-RECORD-ID
 11221
 11222     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11223     MOVE CLMCARRI               TO AT-CARRIER
 11224
 11225     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11226     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11227     MOVE +95                    TO AT-SEQUENCE-NO
 11228     MOVE '6'                    TO AT-TRAILER-TYPE
 11229     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 212
* EL130.cbl
 11230
 11231     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11232                                    AT-GEN-INFO-LAST-MAINT-DT
 11233
 11234     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11235                                    AT-GEN-INFO-LAST-UPDATED-BY
 11236     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11237
 11238     perform varying e1 from +1 by +1 until
 11239        ws-error-no (e1) = spaces
 11240        move ws-error-no (e1)    to at-note-error-no (e1)
 11241     end-perform
 11242
 11243     if at-info-line-1 not = spaces
 11244
 11245* EXEC CICS WRITE
 11246*          DATASET  (ELTRLR-DSID)
 11247*          FROM     (ACTIVITY-TRAILERS)
 11248*          RIDFLD   (AT-CONTROL-PRIMARY)
 11249*       END-EXEC
 11250     MOVE LENGTH OF
 11251      ACTIVITY-TRAILERS
 11252       TO DFHEIV11
 11253*    MOVE '&$ L                  ''   #00010439' TO DFHEIV0
 11254     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11256     MOVE X'2020233030303130343339' TO DFHEIV0(25:11)
 11257     CALL 'kxdfhei1' USING DFHEIV0,
 11258           ELTRLR-DSID,
 11259           ACTIVITY-TRAILERS,
 11260           DFHEIV11,
 11261           AT-CONTROL-PRIMARY,
 11262           DFHEIV99,
 11263           DFHEIV99
 11264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11265     end-if
 11266
 11267     .
 11268 3994C-EXIT.
 11269     EXIT.
 11270 3995-BUILD-CLAIM-RECORD.
 11271     IF PROCCDL GREATER ZERO
 11272         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11273     ELSE
 11274         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11275     END-IF.
 11276
 11277     IF FSTNMEL GREATER ZERO
 11278         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11279     END-IF.
 11280
 11281     IF INITL GREATER ZERO
 11282         MOVE INITI              TO CL-INSURED-MID-INIT
 11283     END-IF.
 11284
 11285     IF BIRTHDTL GREATER ZERO
 11286         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11287     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 213
* EL130.cbl
 11288
 11289     IF SEXL GREATER ZERO
 11290         MOVE SEXI               TO CL-INSURED-SEX-CD
 11291     END-IF.
 11292
 11293     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11294
 11295*    IF CLMTYPEL GREATER ZERO
 11296     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11297*    END-IF.
 11298
 11299     IF PREMTYPL GREATER ZERO
 11300         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11301     END-IF.
 11302
 11303     IF INCURL GREATER ZERO
 11304         MOVE WS-INCUR           TO CL-INCURRED-DT
 11305     END-IF.
 11306
 11307     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11308        AND (ERPDEF-FOUND)
 11309        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11310*       MOVE WS-CRIT-PER-RECURRENT
 11311*                                TO CL-CRIT-PER-RECURRENT
 11312*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11313        if ws-crit-per-recurrent > 01
 11314           move zeros            to cl-benefit-period
 11315        end-if
 11316     ELSE
 11317        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11318           MOVE CM-LF-CRITICAL-PERIOD
 11319                                 TO CL-CRITICAL-PERIOD
 11320        ELSE
 11321           MOVE CM-AH-CRITICAL-PERIOD
 11322                                 TO CL-CRITICAL-PERIOD
 11323        END-IF
 11324     END-IF
 11325
 11326     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11327        COMPUTE DC-ELAPSED-MONTHS =
 11328           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11329        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11330        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11331        MOVE '6'                 TO DC-OPTION-CODE
 11332        PERFORM 9700-LINK-DATE-CONVERT
 11333                                 THRU 9700-EXIT
 11334        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11335     END-IF
 11336
 11337     if instypel > zero
 11338        move instypei            to cl-insured-type
 11339     end-if
 11340     IF REPORTL GREATER ZERO
 11341         MOVE WS-REPORT          TO CL-REPORTED-DT
 11342     END-IF.
 11343
 11344     IF EIBAID = DFHPF6
 11345         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 214
* EL130.cbl
 11346             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11347                 IF EMI-FORCABLE-CTR = +1
 11348                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11349                 END-IF
 11350         END-IF
 11351     END-IF.
 11352
 11353*    IF ESTENDL GREATER ZERO
 11354*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11355*    END-IF.
 11356
 11357     IF ADDONDTL GREATER ZERO
 11358         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11359     END-IF.
 11360
 11361*    IF CAUSEL GREATER ZERO
 11362*        MOVE CAUSEI             TO CL-CAUSE-CD
 11363*    END-IF.
 11364
 11365     IF SSNL GREATER ZERO
 11366         MOVE SSNI               TO CL-SOC-SEC-NO
 11367     ELSE
 11368         MOVE CERT-STATE         TO CL-SSN-STATE
 11369         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11370         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11371     END-IF.
 11372
 11373     IF PRICDL GREATER ZERO
 11374         MOVE PRICDI             TO CL-PRIORITY-CD
 11375     END-IF.
 11376
 11377     IF SUPVL GREATER ZERO
 11378         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11379     END-IF.
 11380
 11381     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11382     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11383     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11384
 11385     IF RELCLML GREATER ZERO
 11386         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11387     END-IF.
 11388
 11389     IF FILETOL GREATER ZERO
 11390         MOVE FILETOI            TO CL-FILE-LOCATION
 11391     END-IF.
 11392
 11393 3995-EXIT.
 11394      EXIT.
 11395 3996-read-cert-claim-trailer.
 11396
 11397     move cm-ah-benefit-amt      to ws-monthly-benefit
 11398     if (pi-dcc-max-amt < ws-monthly-benefit)
 11399        and (pi-dcc-max-amt not = zeros)
 11400        move pi-dcc-max-amt      to ws-monthly-benefit
 11401     end-if
 11402
 11403     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 215
* EL130.cbl
 11404     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11405     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11406     MOVE CM-STATE               TO CTRLR-STATE
 11407     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11408     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11409     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11410     MOVE 'B'                    TO CTRLR-REC-TYPE
 11411
 11412* EXEC CICS READ
 11413*       DATASET  (ELCRTT-DSID)
 11414*       set     (address of CERTIFICATE-TRAILERS)
 11415*       RIDFLD   (ELCRTT-KEY)
 11416*       RESP     (WS-RESPONSE)
 11417*    END-EXEC
 11418*    MOVE '&"S        E          (  N#00010590' TO DFHEIV0
 11419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11421     MOVE X'204E233030303130353930' TO DFHEIV0(25:11)
 11422     CALL 'kxdfhei1' USING DFHEIV0,
 11423           ELCRTT-DSID,
 11424           DFHEIV20,
 11425           DFHEIV99,
 11426           ELCRTT-KEY,
 11427           DFHEIV99,
 11428           DFHEIV99,
 11429           DFHEIV99
 11430     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11431         DFHEIV20
 11432     MOVE EIBRESP  TO WS-RESPONSE
 11433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11434***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11435***                                                            ***
 11436***  This may need some work here. I think I should accumulate ***
 11437***  all the claims with the same claim type?????????          ***
 11438***                                                            ***
 11439***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11440     IF WS-RESP-NORMAL
 11441        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11442        perform varying s1 from +1 by +1 until
 11443           (s1 > +24)
 11444           or (cs-claim-no (s1) = spaces)
 11445           if cs-claim-type (s1) = clmtypei
 11446              move er-1659       to ws-error-no (e1)
 11447              compute ws-tot-days-paid =
 11448                 ws-tot-days-paid + cs-days-paid (s1)
 11449              compute ws-tot-amt-paid =
 11450                 ws-tot-amt-paid + cs-total-paid (s1)
 11451           end-if
 11452        end-perform
 11453*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11454*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11455*           and (pi-dcc-max-benefits not = zeros)
 11456*           add +1                to e1
 11457*           MOVE ER-1660          TO EMI-ERROR
 11458*                                    ws-error-no (e1)
 11459*           PERFORM 9900-ERROR-FORMAT
 11460*                                 THRU 9900-EXIT
 11461*        end-if
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 216
* EL130.cbl
 11462     end-if
 11463**       if instypei = 'P'
 11464**          move +1 to s1
 11465**       else
 11466**          MOVE +2 to s1
 11467**       end-if
 11468*
 11469*        move +1 to s1
 11470*        evaluate clmtypei
 11471*           when 'A'
 11472*              move +1 to s2
 11473*           when 'I'
 11474*              move +2 to s2
 11475*           when 'G'
 11476*              move +3 to s2
 11477*           when 'L'
 11478*              move +4 to s2
 11479*           when 'P'
 11480*              move +5 to s2
 11481*        end-evaluate
 11482*        if cs-claim-type (s1 s2) = clmtypei
 11483*           if cs-no-of-claims (s1 s2) > zeros
 11484*              move er-1659       to ws-error-no (e1)
 11485*           end-if
 11486*           compute WS-BENEFITS-PREV-PAID =
 11487*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11488*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11489*              and (pi-dcc-max-benefits not = zeros)
 11490*              add +1             to e1
 11491*              MOVE ER-1660       TO EMI-ERROR
 11492*                                    ws-error-no (e1)
 11493*              PERFORM 9900-ERROR-FORMAT
 11494*                                 THRU 9900-EXIT
 11495*           end-if
 11496*        end-if
 11497*     end-if
 11498
 11499     .
 11500 3996-exit.
 11501     exit.
 11502
 11503 3997-GET-ERPDEF.
 11504
 11505     if cm-clp-state = spaces or low-values or zeros
 11506        move cm-state            to cm-clp-state
 11507     end-if
 11508     MOVE SPACES                 TO WS-ERPDEF-SW
 11509     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11510                                    WS-CRIT-PER-RTW-MOS
 11511                                    WS-CRIT-PER-RECURRENT
 11512
 11513     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11514     MOVE CM-clp-state        TO ERPDEF-STATE
 11515     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11516***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11517***                                                            ***
 11518***  If they set up a claim where there is no coverage on the  ***
 11519***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 217
* EL130.cbl
 11520***  some funky stuff here.                                    ***
 11521***                                                            ***
 11522***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11523
 11524     evaluate true
 11525        when (clmtypei = 'L' or 'P')
 11526           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11527              and 'CU')
 11528           move 'L'              to erpdef-ben-type
 11529           move cm-lf-benefit-cd to erpdef-ben-code
 11530        when (clmtypei not = 'L' and 'P')
 11531           and (cm-ah-benefit-cd not = '00' and '  ')
 11532           move 'A'              to erpdef-ben-type
 11533           move cm-ah-benefit-cd to erpdef-ben-code
 11534        when (clmtypei not = 'L' and 'P')
 11535           and (cm-ah-benefit-cd = '00' or '  ')
 11536           move 'L'              to erpdef-ben-type
 11537           move cm-lf-benefit-cd to erpdef-ben-code
 11538        when (clmtypei = 'L' or 'P')
 11539           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11540           move 'A'              to erpdef-ben-type
 11541           move cm-ah-benefit-cd to erpdef-ben-code
 11542        when other
 11543           move 'A'              to erpdef-ben-type
 11544           move cm-ah-benefit-cd to erpdef-ben-code
 11545     end-evaluate
 11546*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11547*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11548     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11549     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11550
 11551
 11552* EXEC CICS STARTBR
 11553*        DATASET  ('ERPDEF')
 11554*        RIDFLD   (ERPDEF-KEY)
 11555*        GTEQ
 11556*        RESP     (WS-RESPONSE)
 11557*    END-EXEC
 11558     MOVE 'ERPDEF' TO DFHEIV1
 11559     MOVE 0
 11560       TO DFHEIV11
 11561*    MOVE '&,         G          &  N#00010713' TO DFHEIV0
 11562     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11563     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11564     MOVE X'204E233030303130373133' TO DFHEIV0(25:11)
 11565     CALL 'kxdfhei1' USING DFHEIV0,
 11566           DFHEIV1,
 11567           ERPDEF-KEY,
 11568           DFHEIV99,
 11569           DFHEIV11,
 11570           DFHEIV99
 11571     MOVE EIBRESP  TO WS-RESPONSE
 11572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11573
 11574     IF WS-RESP-NORMAL
 11575
 11576* EXEC CICS READNEXT
 11577*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 218
* EL130.cbl
 11578*          INTO     (PRODUCT-MASTER)
 11579*          RIDFLD   (ERPDEF-KEY)
 11580*          RESP     (WS-RESPONSE)
 11581*       END-EXEC
 11582     MOVE LENGTH OF
 11583      PRODUCT-MASTER
 11584       TO DFHEIV12
 11585     MOVE 'ERPDEF' TO DFHEIV1
 11586     MOVE 0
 11587       TO DFHEIV11
 11588*    MOVE '&.IL                  )  N#00010721' TO DFHEIV0
 11589     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11590     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11591     MOVE X'204E233030303130373231' TO DFHEIV0(25:11)
 11592     CALL 'kxdfhei1' USING DFHEIV0,
 11593           DFHEIV1,
 11594           PRODUCT-MASTER,
 11595           DFHEIV12,
 11596           ERPDEF-KEY,
 11597           DFHEIV99,
 11598           DFHEIV11,
 11599           DFHEIV99,
 11600           DFHEIV99
 11601     MOVE EIBRESP  TO WS-RESPONSE
 11602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11603
 11604        IF WS-RESP-NORMAL
 11605           IF (ERPDEF-KEY-SAVE (1:16) =
 11606              PD-CONTROL-PRIMARY (1:16))
 11607              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11608
 11609              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11610                 (A1 > +8)
 11611                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11612              END-PERFORM
 11613              IF A1 < +9
 11614                 SET ERPDEF-FOUND TO TRUE
 11615                 move pd-max-amt (a1)
 11616                              to pi-dcc-max-amt
 11617                 MOVE PD-CRIT-PERIOD (A1)
 11618                              TO WS-MAX-BENEFITS
 11619                                 pi-dcc-max-benefits
 11620                 if pd-rec-crit-period (a1) not numeric
 11621                    move 01      to pd-rec-crit-period (a1)
 11622                 end-if
 11623                 MOVE PD-REC-CRIT-PERIOD (A1)
 11624                              TO WS-CRIT-PER-RECURRENT
 11625                 IF PD-RTW-MOS (A1) NUMERIC
 11626                    MOVE PD-RTW-MOS (A1)
 11627                              TO WS-CRIT-PER-RTW-MOS
 11628                 ELSE
 11629                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11630                 END-IF
 11631                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11632                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11633                                 TO WS-EXCL-PERIOD
 11634                 END-IF
 11635                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 219
* EL130.cbl
 11636                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11637                                 TO WS-COV-ENDS
 11638                 END-IF
 11639                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11640                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11641                                 TO WS-ACC-PERIOD
 11642                 END-IF
 11643              else
 11644                 MOVE -1         TO MAINTL
 11645                 move er-1673    to emi-error
 11646                 PERFORM 9900-ERROR-FORMAT
 11647                                 THRU 9900-EXIT
 11648              END-IF
 11649           else
 11650              MOVE -1            TO MAINTL
 11651              move er-1671       to emi-error
 11652              PERFORM 9900-ERROR-FORMAT
 11653                                 THRU 9900-EXIT
 11654           END-IF
 11655        END-IF
 11656     END-IF
 11657
 11658     .
 11659 3997-EXIT.
 11660     EXIT.
 11661
 11662 3998-update-cert-claim-trailer.
 11663
 11664
 11665* EXEC CICS GETMAIN
 11666*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11667*       LENGTH   (ELCRTT-LENGTH)
 11668*       INITIMG  (GETMAIN-SPACE)
 11669*    END-EXEC
 11670*    MOVE ',"IL                  $   #00010788' TO DFHEIV0
 11671     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11673     MOVE X'2020233030303130373838' TO DFHEIV0(25:11)
 11674     CALL 'kxdfhei1' USING DFHEIV0,
 11675           DFHEIV20,
 11676           ELCRTT-LENGTH,
 11677           GETMAIN-SPACE
 11678     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11679         DFHEIV20
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11681
 11682     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11683     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11684     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11685     MOVE CM-STATE         TO CTRLR-STATE
 11686     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11687     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11688     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11689     MOVE 'B'              TO CTRLR-REC-TYPE
 11690
 11691* EXEC CICS READ
 11692*       UPDATE
 11693*       DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 220
* EL130.cbl
 11694*       into     (CERTIFICATE-TRAILERS)
 11695*       RIDFLD   (ELCRTT-KEY)
 11696*       RESP     (WS-RESPONSE)
 11697*    END-EXEC
 11698     MOVE LENGTH OF
 11699      CERTIFICATE-TRAILERS
 11700       TO DFHEIV11
 11701*    MOVE '&"IL       EU         (  N#00010802' TO DFHEIV0
 11702     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11703     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11704     MOVE X'204E233030303130383032' TO DFHEIV0(25:11)
 11705     CALL 'kxdfhei1' USING DFHEIV0,
 11706           ELCRTT-DSID,
 11707           CERTIFICATE-TRAILERS,
 11708           DFHEIV11,
 11709           ELCRTT-KEY,
 11710           DFHEIV99,
 11711           DFHEIV99,
 11712           DFHEIV99
 11713     MOVE EIBRESP  TO WS-RESPONSE
 11714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11715     IF WS-RESP-NORMAL
 11716        perform varying s1 from +1 by +1 until
 11717           (s1 > +24)
 11718           or (cs-claim-no (s1) = spaces)
 11719        end-perform
 11720        if s1 < +25
 11721           perform 3999-upd-crt-trlr thru 3999-exit
 11722
 11723* EXEC CICS REWRITE
 11724*             DATASET  (ELCRTT-DSID)
 11725*             from     (CERTIFICATE-TRAILERS)
 11726*             RESP     (WS-RESPONSE)
 11727*          END-EXEC
 11728     MOVE LENGTH OF
 11729      CERTIFICATE-TRAILERS
 11730       TO DFHEIV11
 11731*    MOVE '&& L                  %  N#00010816' TO DFHEIV0
 11732     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11733     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11734     MOVE X'204E233030303130383136' TO DFHEIV0(25:11)
 11735     CALL 'kxdfhei1' USING DFHEIV0,
 11736           ELCRTT-DSID,
 11737           CERTIFICATE-TRAILERS,
 11738           DFHEIV11,
 11739           DFHEIV99
 11740     MOVE EIBRESP  TO WS-RESPONSE
 11741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11742        end-if
 11743     else
 11744        if ws-resp-notfnd
 11745           move 'CS'             to certificate-trailers
 11746           move cm-control-primary to cs-control-primary
 11747           move 'B'              to cs-trailer-type
 11748           perform varying s1 from +1 by +1 until s1 > +24
 11749              move zeros         to cs-days-paid (s1)
 11750                                    cs-total-paid (s1)
 11751                                    cs-benefit-period (s1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 221
* EL130.cbl
 11752                                    cs-remaining-bens (s1)
 11753           end-perform
 11754           move +1               to s1
 11755           perform 3999-upd-crt-trlr
 11756                                 thru 3999-exit
 11757
 11758* EXEC CICS WRITE
 11759*             DATASET  (ELCRTT-DSID)
 11760*             from     (CERTIFICATE-TRAILERS)
 11761*             RIDFLD   (cs-control-primary)
 11762*             RESP     (WS-RESPONSE)
 11763*          END-EXEC
 11764     MOVE LENGTH OF
 11765      CERTIFICATE-TRAILERS
 11766       TO DFHEIV11
 11767*    MOVE '&$ L                  ''  N#00010836' TO DFHEIV0
 11768     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11770     MOVE X'204E233030303130383336' TO DFHEIV0(25:11)
 11771     CALL 'kxdfhei1' USING DFHEIV0,
 11772           ELCRTT-DSID,
 11773           CERTIFICATE-TRAILERS,
 11774           DFHEIV11,
 11775           cs-control-primary,
 11776           DFHEIV99,
 11777           DFHEIV99
 11778     MOVE EIBRESP  TO WS-RESPONSE
 11779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11780        end-if
 11781     END-IF
 11782
 11783     .
 11784 3998-exit.
 11785     exit.
 11786
 11787 3999-upd-crt-trlr.
 11788     move clmnoi                 to cs-claim-no       (s1)
 11789     move clmtypei               to cs-claim-type     (s1)
 11790     move instypei               to cs-insured-type   (s1)
 11791     move cl-benefit-period      to cs-benefit-period (s1)
 11792*    move cl-critical-period     to cs-remaining-bens (s1)
 11793     move zeros                  to cs-remaining-bens (s1)
 11794     .
 11795 3999-exit.
 11796     exit.
 11797 4000-CALCULATE-CERT-TERM.
 11798
 11799     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11800
 11801     MOVE N                      TO WS-TERM.
 11802
 11803     IF WS-TERM GREATER 120
 11804         MOVE 120                TO WS-TERM
 11805     END-IF.
 11806
 11807 4000-CALC-TERM-EXIT.
 11808      EXIT.
 11809
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 222
* EL130.cbl
 11810 4100-CALC-GROSS-TERM.
 11811     MOVE HOLD-LOAN-BAL           TO L.
 11812     MOVE WS-ACVBENE              TO M.
 11813     COMPUTE N = L / M.
 11814     IF N LESS 1
 11815         MOVE 1  TO N
 11816     END-IF.
 11817
 11818     IF LCVCDL GREATER ZERO
 11819         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11820     ELSE
 11821         MOVE ZEROS               TO WS-LF-RATE
 11822     END-IF.
 11823
 11824     IF ACVCDL GREATER ZERO
 11825         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11826     ELSE
 11827         MOVE ZEROS               TO WS-AH-RATE
 11828     END-IF.
 11829
 11830     COMPUTE I = WS-APR / +1200.
 11831
 11832 4105-LOOP.
 11833     IF N GREATER 240
 11834         GO TO 4200-EXIT
 11835     END-IF.
 11836
 11837     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11838
 11839     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11840         ADD 1 TO N
 11841         GO TO 4105-LOOP
 11842     END-IF.
 11843
 11844 4200-EXIT.
 11845      EXIT.
 11846
 11847 4210-CALC-LEFT-RIGHTONE.
 11848      MOVE L         TO LEFT-TOT-1.
 11849      SUBTRACT 1 FROM N.
 11850      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11851      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11852      ADD 1 TO N.
 11853
 11854 4211-CALC-TERM1.
 11855      MOVE N         TO TERM1.
 11856      MULTIPLY M BY TERM1.
 11857
 11858 4212-LOOP.
 11859      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11860      ADD 1 TO A-N.
 11861      MULTIPLY A-N BY TERM1.
 11862      SUBTRACT 1 FROM A-N.
 11863      ADD TERM1 TO LEFT-TOT-1.
 11864
 11865 4213-CALC-TERM2.
 11866      MOVE M         TO TERM2.
 11867      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 223
* EL130.cbl
 11868      MULTIPLY IA-N BY TERM2.
 11869      SUBTRACT TERM2 FROM LEFT-TOT-1.
 11870
 11871 4215-CALC-RIGHTONE.
 11872      MOVE M         TO RIGHT-TOT-1.
 11873      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11874      MULTIPLY A-N BY RIGHT-TOT-1.
 11875
 11876 4220-EXIT.
 11877      EXIT.
 11878
 11879 4300-CALC-A-N.
 11880     IF N LESS 1
 11881         MOVE 0     TO A-N
 11882         GO TO 4300-EXIT
 11883     END-IF.
 11884
 11885     IF I = 0
 11886         MOVE .00001 TO I
 11887     END-IF.
 11888
 11889     ADD 1 TO I.
 11890     DIVIDE I INTO 1 GIVING V.
 11891     SUBTRACT 1 FROM I.
 11892     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11893     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11894     DIVIDE I INTO TERM3 GIVING A-N.
 11895
 11896 4300-EXIT.
 11897      EXIT.
 11898
 11899 4350-CALC-IA-N.
 11900     IF N LESS 1
 11901         MOVE 0      TO IA-N
 11902         GO TO 4400-EXIT
 11903     END-IF.
 11904
 11905     ADD 1 TO N.
 11906     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11907     SUBTRACT 1 FROM N.
 11908     MULTIPLY N BY V-EX-N GIVING TERM3.
 11909     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11910     SUBTRACT V FROM 1 GIVING TERM4.
 11911     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11912
 11913 4400-EXIT.
 11914      EXIT.
 11915
 11916 4450-CALC-V-EX-N.
 11917     IF N LESS 1
 11918         MOVE 1    TO V-EX-N
 11919         GO TO 4490-EXIT
 11920     END-IF.
 11921
 11922     MOVE N        TO NV-STORE.
 11923
 11924     IF V-EX-ONETIME = 1  OR
 11925        V NOT = V-EXPONENT (1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 224
* EL130.cbl
 11926          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11927     END-IF.
 11928
 11929 4460-LOOP.
 11930     IF N GREATER 248
 11931         MOVE 248 TO N
 11932     END-IF.
 11933
 11934     IF N = 1
 11935         MOVE V               TO V-EX-N
 11936     ELSE
 11937         MOVE V-EXPONENT (N)  TO V-EX-N
 11938     END-IF.
 11939
 11940     GO TO 4490-EXIT.
 11941
 11942 4470-BUILD-V-EX-TABLE.
 11943     MOVE 2      TO N.
 11944     MOVE V      TO V-EXPONENT (1)
 11945                    V-EX-N.
 11946
 11947 4471-LOOP.
 11948     MULTIPLY V BY V-EX-N.
 11949     MOVE V-EX-N   TO V-EXPONENT (N).
 11950
 11951     ADD 1 TO N.
 11952     IF N LESS 248
 11953         GO TO 4471-LOOP
 11954     END-IF.
 11955
 11956     MOVE NV-STORE     TO N.
 11957     MOVE ZERO         TO V-EX-ONETIME.
 11958
 11959 4480-EXIT.
 11960      EXIT.
 11961
 11962 4490-EXIT.
 11963      EXIT.
 11964
 11965 4500-CALC-NET-TERM.
 11966     MOVE HOLD-LOAN-BAL           TO L.
 11967     MOVE WS-ACVBENE              TO M.
 11968     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11969
 11970     IF WS-REMAIN GREATER ZERO
 11971         ADD 1 TO N
 11972     END-IF.
 11973
 11974     IF N = 0
 11975         MOVE 1 TO N
 11976     END-IF.
 11977
 11978 4700-EXIT.
 11979      EXIT.
 11980
 11981 4999-CALC-TERM-EXIT.
 11982     EXIT.
 11983
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 225
* EL130.cbl
 11985 5000-INCURRED-CHANGE.
 11986     IF NOT MODIFY-CAP
 11987         MOVE ER-0070            TO EMI-ERROR
 11988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989         MOVE -1                 TO MAINTL
 11990         GO TO 8200-SEND-DATAONLY
 11991     END-IF.
 11992
 11993     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11994        CLMCARRI     NOT = PI-LAST-CARR        OR
 11995        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11996        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11997        PI-INCURR-SW NOT = 'Y'
 11998          GO TO 1000-SHOW-CLAIM
 11999     END-IF.
 12000
 12001     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12002     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12003     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12004
 12005     IF EMI-NO-ERRORS
 12006         GO TO 5000-TRY-TO-BUILD
 12007     END-IF.
 12008
 12009     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12010        MOVE ER-0433             TO EMI-ERROR
 12011        MOVE -1                  TO MAINTL
 12012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12013        GO TO 8200-SEND-DATAONLY
 12014     END-IF.
 12015
 12016     IF EIBAID = DFHPF6
 12017         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12018            MOVE ER-0434         TO EMI-ERROR
 12019            MOVE -1              TO MAINTL
 12020            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12021            GO TO 8200-SEND-DATAONLY
 12022         ELSE
 12023            MOVE +1              TO INCURL
 12024            GO TO 5000-TRY-TO-BUILD
 12025         END-IF
 12026     END-IF.
 12027
 12028     GO TO 8200-SEND-DATAONLY.
 12029
 12030 5000-TRY-TO-BUILD.
 12031
 12032     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12033
 12034     MOVE CLMCARRI               TO MSTR-CARRIER.
 12035
 12036     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12037     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12038     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12039
 12040     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12041
 12042     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 226
* EL130.cbl
 12043         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12044     END-IF.
 12045
 12046     IF CL-PURGED-DT NOT = LOW-VALUES
 12047
 12048
 12049* EXEC CICS UNLOCK
 12050*            DATASET   (ELMSTR-DSID)
 12051*        END-EXEC
 12052*    MOVE '&*                    #   #00011110' TO DFHEIV0
 12053     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12054     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12055     MOVE X'2020233030303131313130' TO DFHEIV0(25:11)
 12056     CALL 'kxdfhei1' USING DFHEIV0,
 12057           ELMSTR-DSID,
 12058           DFHEIV99
 12059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12060         MOVE ER-7691            TO EMI-ERROR
 12061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12062         MOVE -1                 TO MAINTL
 12063         GO TO 8200-SEND-DATAONLY
 12064     END-IF.
 12065
 12066     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12067
 12068
 12069* EXEC CICS UNLOCK
 12070*            DATASET   (ELMSTR-DSID)
 12071*       END-EXEC
 12072*    MOVE '&*                    #   #00011121' TO DFHEIV0
 12073     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12074     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12075     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0,
 12077           ELMSTR-DSID,
 12078           DFHEIV99
 12079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12080         MOVE ER-0523             TO EMI-ERROR
 12081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12082         MOVE -1                  TO MAINTL
 12083         GO TO 8200-SEND-DATAONLY
 12084     END-IF.
 12085
 12086     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12087
 12088     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12089     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12090     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12091     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12092     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12093
 12094     IF MANRSVL GREATER ZERO
 12095        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12096                                    AT-CURRENT-MANUAL-RESERVE
 12097     END-IF.
 12098     MOVE 1                      TO SUB.
 12099
 12100 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 227
* EL130.cbl
 12101     IF SUB = 1
 12102        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12103        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12104        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12105     ELSE
 12106        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12107        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12108                                    AT-OPEN-CLOSE-REASON (SUB)
 12109     END-IF.
 12110
 12111     IF SUB NOT = 6
 12112        ADD 1                    TO SUB
 12113        GO TO 5010-LOOP
 12114     END-IF.
 12115
 12116 5020-UPDATE.
 12117
 12118     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12119
 12120     IF DIAGL = ZERO
 12121       AND ICD1L = ZERO
 12122       AND ICD2L = ZERO
 12123         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12124         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12125         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12126         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12127         GO TO 5025-BYPASS-UPDATE
 12128     END-IF.
 12129
 12130     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12131
 12132     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12133     IF DIAGL NOT = ZERO
 12134         MOVE DIAGI              TO AT-INFO-LINE-1
 12135     END-IF.
 12136
 12137     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12138     IF ICD1L NOT = ZERO
 12139         MOVE ICD1I              TO AT-ICD-CODE-1
 12140     END-IF.
 12141
 12142     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12143     IF ICD2L NOT = ZERO
 12144         MOVE ICD2I              TO AT-ICD-CODE-2
 12145     END-IF.
 12146
 12147     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12148
 12149 5025-BYPASS-UPDATE.
 12150
 12151
 12152
 12153* EXEC CICS GETMAIN
 12154*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12155*        LENGTH   (ELTRLR-LENGTH)
 12156*    END-EXEC.
 12157*    MOVE '," L                  $   #00011196' TO DFHEIV0
 12158     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 228
* EL130.cbl
 12159     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12160     MOVE X'2020233030303131313936' TO DFHEIV0(25:11)
 12161     CALL 'kxdfhei1' USING DFHEIV0,
 12162           DFHEIV20,
 12163           ELTRLR-LENGTH,
 12164           DFHEIV99
 12165     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12166         DFHEIV20
 12167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12168
 12169
 12170     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12171     MOVE 'AT'                   TO AT-RECORD-ID.
 12172
 12173     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12174     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12175     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12176     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12177     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12178     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12179     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12180     MOVE '9'                    TO AT-TRAILER-TYPE.
 12181     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12182     MOVE '5'                    TO DC-OPTION-CODE.
 12183     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12184     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12185
 12186     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12187     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12188
 12189     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12190     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12191     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12192     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12193     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12194     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12195     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12196     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12197     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12198     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12199     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12200     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12201
 12202     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12203     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12204     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12205     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12206     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12207
 12208
 12209
 12210* EXEC CICS WRITE
 12211*        DATASET   (ELTRLR-DSID)
 12212*        FROM      (ACTIVITY-TRAILERS)
 12213*        RIDFLD    (AT-CONTROL-PRIMARY)
 12214*    END-EXEC.
 12215     MOVE LENGTH OF
 12216      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 229
* EL130.cbl
 12217       TO DFHEIV11
 12218*    MOVE '&$ L                  ''   #00011240' TO DFHEIV0
 12219     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12221     MOVE X'2020233030303131323430' TO DFHEIV0(25:11)
 12222     CALL 'kxdfhei1' USING DFHEIV0,
 12223           ELTRLR-DSID,
 12224           ACTIVITY-TRAILERS,
 12225           DFHEIV11,
 12226           AT-CONTROL-PRIMARY,
 12227           DFHEIV99,
 12228           DFHEIV99
 12229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12230
 12231
 12232     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12233     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12234     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12235     MOVE CL-CERT-STATE          TO CERT-STATE.
 12236     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12237     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12238     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12239
 12240
 12241
 12242* EXEC CICS HANDLE CONDITION
 12243*        NOTFND   (5050-CERT-NOT-FOUND)
 12244*    END-EXEC.
 12245*    MOVE '"$I                   ! ; #00011255' TO DFHEIV0
 12246     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12248     MOVE X'3B20233030303131323535' TO DFHEIV0(25:11)
 12249     CALL 'kxdfhei1' USING DFHEIV0
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12251
 12252
 12253     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12254
 12255     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12256
 12257
 12258
 12259* EXEC CICS HANDLE CONDITION
 12260*         DUPKEY   (5030-CERT-WRITTEN)
 12261*    END-EXEC.
 12262*    MOVE '"$$                   ! < #00011264' TO DFHEIV0
 12263     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12265     MOVE X'3C20233030303131323634' TO DFHEIV0(25:11)
 12266     CALL 'kxdfhei1' USING DFHEIV0
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12268
 12269
 12270
 12271
 12272* EXEC CICS REWRITE
 12273*        DATASET  (ELCERT-DSID)
 12274*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 230
* EL130.cbl
 12275*    END-EXEC.
 12276     MOVE LENGTH OF
 12277      CERTIFICATE-MASTER
 12278       TO DFHEIV11
 12279*    MOVE '&& L                  %   #00011269' TO DFHEIV0
 12280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12282     MOVE X'2020233030303131323639' TO DFHEIV0(25:11)
 12283     CALL 'kxdfhei1' USING DFHEIV0,
 12284           ELCERT-DSID,
 12285           CERTIFICATE-MASTER,
 12286           DFHEIV11,
 12287           DFHEIV99
 12288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12289
 12290
 12291 5030-CERT-WRITTEN.
 12292
 12293     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12294                                    CL-INCURRED-DT
 12295                                    CL-REPORTED-DT
 12296                                    CL-EST-END-OF-DISAB-DT
 12297                                    CL-PAID-THRU-DT.
 12298
 12299     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12300                                    CL-NO-OF-PMTS-MADE
 12301                                    CL-NO-OF-DAYS-PAID.
 12302
 12303     IF CLAIM-IS-CLOSED
 12304        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12305        MOVE 'O'                 TO CL-CLAIM-STATUS
 12306     END-IF.
 12307
 12308     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12309     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12310     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12311
 12312
 12313
 12314* EXEC CICS HANDLE CONDITION
 12315*         DUPKEY   (5035-CLAIM-WRITTEN)
 12316*    END-EXEC.
 12317*    MOVE '"$$                   ! = #00011296' TO DFHEIV0
 12318     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12320     MOVE X'3D20233030303131323936' TO DFHEIV0(25:11)
 12321     CALL 'kxdfhei1' USING DFHEIV0
 12322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12323
 12324
 12325
 12326
 12327* EXEC CICS REWRITE
 12328*        DATASET   (ELMSTR-DSID)
 12329*        FROM      (CLAIM-MASTER)
 12330*    END-EXEC.
 12331     MOVE LENGTH OF
 12332      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 231
* EL130.cbl
 12333       TO DFHEIV11
 12334*    MOVE '&& L                  %   #00011301' TO DFHEIV0
 12335     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303131333031' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           ELMSTR-DSID,
 12340           CLAIM-MASTER,
 12341           DFHEIV11,
 12342           DFHEIV99
 12343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12344
 12345
 12346 5035-CLAIM-WRITTEN.
 12347
 12348     MOVE ER-0000                TO EMI-ERROR.
 12349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12350
 12351     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12352     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12353     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12354     MOVE CLMCARRI               TO PI-LAST-CARR.
 12355
 12356     IF PRTOPTL GREATER ZERO
 12357         MOVE PRTOPTI            TO PI-PRT-OPT
 12358     END-IF.
 12359
 12360     IF ALTPRTL GREATER ZERO
 12361         MOVE ALTPRTI            TO PI-ALT-PRT
 12362     END-IF.
 12363
 12364     MOVE LOW-VALUES             TO EL130AI.
 12365
 12366     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12367     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12368     MOVE PI-LAST-CARR           TO CLMCARRO.
 12369     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12370
 12371     IF PI-PRT-OPT = 'N' OR 'L'
 12372         MOVE PI-PRT-OPT         TO PRTOPTO
 12373         MOVE 1                  TO PRTOPTL
 12374     END-IF.
 12375
 12376     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12377         MOVE PI-ALT-PRT         TO ALTPRTO
 12378         MOVE 4                  TO ALTPRTL
 12379     END-IF.
 12380
 12381     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12382     MOVE AL-SANON               TO CERTNOA SUFXA.
 12383
 12384     MOVE SPACES                 TO PI-INCURR-SW.
 12385
 12386     IF PRTOPTL GREATER ZERO
 12387         IF PRTOPTI = 'L'
 12388             GO TO 0400-CREATE-ELACTQ
 12389         ELSE
 12390             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 232
* EL130.cbl
 12391         END-IF
 12392     END-IF.
 12393
 12394     GO TO 8100-SEND-INITIAL-MAP.
 12395
 12396 5050-CERT-NOT-FOUND.
 12397
 12398     MOVE ER-0244                TO EMI-ERROR.
 12399     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12400     MOVE -1                     TO CERTNOL.
 12401     GO TO 8200-SEND-DATAONLY.
 12402
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 233
* EL130.cbl
 12404 5500-BUILD-FORM-TRAILER.
 12405*************************************************************
 12406*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12407*************************************************************
 12408
 12409     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12410
 12411     IF  WS-BEN-ALPHA-2 = '30'
 12412         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12413         MOVE '6'                TO DC-OPTION-CODE
 12414         IF CL-CARRIER = 'C'
 12415             MOVE +14            TO DC-ELAPSED-DAYS
 12416             MOVE +0             TO DC-ELAPSED-MONTHS
 12417             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12418             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12419         ELSE
 12420             MOVE +21            TO DC-ELAPSED-DAYS
 12421             MOVE +0             TO DC-ELAPSED-MONTHS
 12422             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12423             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12424         END-IF
 12425     END-IF.
 12426
 12427
 12428
 12429* EXEC CICS GETMAIN
 12430*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12431*         LENGTH   (ELTRLR-LENGTH)
 12432*         INITIMG  (GETMAIN-SPACE)
 12433*    END-EXEC.
 12434*    MOVE ',"IL                  $   #00011388' TO DFHEIV0
 12435     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12437     MOVE X'2020233030303131333838' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           DFHEIV20,
 12440           ELTRLR-LENGTH,
 12441           GETMAIN-SPACE
 12442     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12443         DFHEIV20
 12444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12445
 12446
 12447     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12448     MOVE 'AT'                   TO AT-RECORD-ID.
 12449
 12450     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12451     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12452     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12453     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12454                                    AT-FORM-LAST-MAINT-DT.
 12455     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12456                                    AT-FORM-LAST-UPDATED-BY.
 12457     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12458     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12459     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12460                                    AT-FORM-RE-SEND-DT
 12461                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 234
* EL130.cbl
 12462                                    AT-EMP-FORM-ANSWERED-DT
 12463                                    AT-PHY-FORM-ANSWERED-DT
 12464                                    AT-EMP-FORM-SEND-ON-DT
 12465                                    AT-FORM-PRINTED-DT
 12466                                    AT-FORM-REPRINT-DT.
 12467     MOVE '1'                    TO AT-FORM-TYPE.
 12468
 12469     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12470                                    AT-INSTRUCT-LN-2
 12471                                    AT-INSTRUCT-LN-3.
 12472
 12473     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12474     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12475
 12476     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12477
 12478     IF AM-EMPLOYER-STMT-USED = 'Y'
 12479        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12480     END-IF.
 12481
 12482
 12483
 12484* EXEC CICS WRITE
 12485*         DATASET  (ELTRLR-DSID)
 12486*         FROM     (ACTIVITY-TRAILERS)
 12487*         RIDFLD   (AT-CONTROL-PRIMARY)
 12488*    END-EXEC.
 12489     MOVE LENGTH OF
 12490      ACTIVITY-TRAILERS
 12491       TO DFHEIV11
 12492*    MOVE '&$ L                  ''   #00011430' TO DFHEIV0
 12493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12495     MOVE X'2020233030303131343330' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0,
 12497           ELTRLR-DSID,
 12498           ACTIVITY-TRAILERS,
 12499           DFHEIV11,
 12500           AT-CONTROL-PRIMARY,
 12501           DFHEIV99,
 12502           DFHEIV99
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 235
* EL130.cbl
 12508*************************************************************
 12509*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12510*************************************************************
 12511
 12512 5700-BUILD-ARCHIVE-HEADER.
 12513
 12514     MOVE '1'                    TO CNTL-REC-TYPE.
 12515     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12516     MOVE SPACES                 TO CNTL-ACCESS.
 12517
 12518
 12519
 12520* EXEC CICS READ
 12521*         DATASET  (ELCNTL-DSID)
 12522*         SET      (ADDRESS OF CONTROL-FILE)
 12523*         RIDFLD   (ELCNTL-KEY)
 12524*         UPDATE
 12525*    END-EXEC.
 12526*    MOVE '&"S        EU         (   #00011449' TO DFHEIV0
 12527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12528     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12529     MOVE X'2020233030303131343439' TO DFHEIV0(25:11)
 12530     CALL 'kxdfhei1' USING DFHEIV0,
 12531           ELCNTL-DSID,
 12532           DFHEIV20,
 12533           DFHEIV99,
 12534           ELCNTL-KEY,
 12535           DFHEIV99,
 12536           DFHEIV99,
 12537           DFHEIV99
 12538     SET ADDRESS OF CONTROL-FILE TO
 12539         DFHEIV20
 12540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12541
 12542
 12543     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12544
 12545     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12546
 12547
 12548
 12549* EXEC CICS REWRITE
 12550*         FROM     (CONTROL-FILE)
 12551*         DATASET  (ELCNTL-DSID)
 12552*    END-EXEC.
 12553     MOVE LENGTH OF
 12554      CONTROL-FILE
 12555       TO DFHEIV11
 12556*    MOVE '&& L                  %   #00011461' TO DFHEIV0
 12557     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12558     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12559     MOVE X'2020233030303131343631' TO DFHEIV0(25:11)
 12560     CALL 'kxdfhei1' USING DFHEIV0,
 12561           ELCNTL-DSID,
 12562           CONTROL-FILE,
 12563           DFHEIV11,
 12564           DFHEIV99
 12565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 236
* EL130.cbl
 12566
 12567
 12568
 12569
 12570* EXEC CICS HANDLE CONDITION
 12571*         NOTOPEN  (9990-ABEND)
 12572*         DUPKEY   (5799-EXIT)
 12573*    END-EXEC.
 12574*    MOVE '"$J$                  ! > #00011467' TO DFHEIV0
 12575     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12577     MOVE X'3E20233030303131343637' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582
 12583
 12584* EXEC CICS GETMAIN
 12585*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12586*         LENGTH  (ELARCH-LENGTH)
 12587*    END-EXEC.
 12588*    MOVE '," L                  $   #00011473' TO DFHEIV0
 12589     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12590     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12591     MOVE X'2020233030303131343733' TO DFHEIV0(25:11)
 12592     CALL 'kxdfhei1' USING DFHEIV0,
 12593           DFHEIV20,
 12594           ELARCH-LENGTH,
 12595           DFHEIV99
 12596     SET ADDRESS OF LETTER-ARCHIVE TO
 12597         DFHEIV20
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12599
 12600
 12601     MOVE SPACES                 TO LETTER-ARCHIVE.
 12602     MOVE 'LA'                   TO LA-RECORD-ID.
 12603     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12604                                    LA-ARCHIVE-NO-A1.
 12605     MOVE '4'                    TO LA-RECORD-TYPE
 12606                                    LA-RECORD-TYPE-A1.
 12607     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12608                                    LA-LINE-SEQ-NO-A1.
 12609     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12610                                    LA-COMPANY-CD-A1.
 12611     MOVE CL-CARRIER             TO LA4-CARRIER.
 12612     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12613     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12614     MOVE CL-CERT-STATE          TO LA4-STATE.
 12615     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12616     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12617     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12618     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12619                                    LA4-RESEND-PRINT-DATE
 12620                                    LA4-FORM-REM-PRINT-DT
 12621                                    LA4-RESEND-DATE.
 12622     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12623     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 237
* EL130.cbl
 12624
 12625
 12626
 12627* EXEC CICS WRITE
 12628*         DATASET  (ELARCH-DSID)
 12629*         FROM     (LETTER-ARCHIVE)
 12630*         RIDFLD   (LA-CONTROL-PRIMARY)
 12631*    END-EXEC.
 12632     MOVE LENGTH OF
 12633      LETTER-ARCHIVE
 12634       TO DFHEIV11
 12635*    MOVE '&$ L                  ''   #00011503' TO DFHEIV0
 12636     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12638     MOVE X'2020233030303131353033' TO DFHEIV0(25:11)
 12639     CALL 'kxdfhei1' USING DFHEIV0,
 12640           ELARCH-DSID,
 12641           LETTER-ARCHIVE,
 12642           DFHEIV11,
 12643           LA-CONTROL-PRIMARY,
 12644           DFHEIV99,
 12645           DFHEIV99
 12646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12647
 12648
 12649 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 238
* EL130.cbl
 12651 6000-EDIT-CLAIM-DATA.
 12652
 12653     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12654     MOVE '2'                    TO DC-OPTION-CODE.
 12655     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12656     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12657
 12658     IF MAINTL NOT = ZERO
 12659         MOVE AL-UANON           TO MAINTA
 12660     END-IF
 12661
 12662     IF CLMNOL GREATER ZERO
 12663         IF CLMNOI = SPACES OR LOW-VALUES
 12664             MOVE -1             TO CLMNOL
 12665             MOVE AL-UABON       TO CLMNOA
 12666             MOVE ER-7688        TO EMI-ERROR
 12667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12668         ELSE
 12669             MOVE AL-UANON       TO CLMNOA
 12670         END-IF
 12671     END-IF.
 12672
 12673     IF CERTNOL = ZERO
 12674         MOVE -1                 TO CERTNOL
 12675         MOVE AL-SABON           TO CERTNOA
 12676         MOVE ER-0203            TO EMI-ERROR
 12677         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12678     ELSE
 12679         MOVE AL-SANON           TO CERTNOA
 12680     END-IF.
 12681
 12682     IF SUFXL = ZERO
 12683         MOVE SPACES             TO SUFXI
 12684         MOVE AL-SANON           TO SUFXA
 12685     ELSE
 12686         MOVE AL-SANON           TO SUFXA
 12687     END-IF.
 12688
 12689     IF CLMCARRL = ZERO
 12690         MOVE -1                 TO CLMCARRL
 12691         MOVE ER-0194            TO EMI-ERROR
 12692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12693     ELSE
 12694         MOVE CLMCARRI           TO PI-CARRIER
 12695         IF PI-NO-CARRIER-SECURITY
 12696             MOVE AL-UANON       TO CLMCARRA
 12697         END-IF
 12698     END-IF.
 12699
 12700     IF CLMTYPEL > ZERO
 12701        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12702           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12703              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12704                        OR
 12705           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12706           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12707              AND PI-AH-OVERRIDE-L1))
 12708              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 239
* EL130.cbl
 12709              MOVE AL-UABON       TO CLMTYPEA
 12710              MOVE ER-7634        TO EMI-ERROR
 12711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12712        ELSE
 12713           MOVE AL-UANON       TO CLMTYPEA
 12714        END-IF
 12715     ELSE
 12716        IF MAINTI = 'A'
 12717           MOVE -1             TO CLMTYPEL
 12718           MOVE AL-UABON       TO CLMTYPEA
 12719           MOVE ER-0546        TO EMI-ERROR
 12720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12721        END-IF
 12722     END-IF
 12723     if instypel > ZERO
 12724        if instypei = 'P' OR 'C'
 12725           move al-uanon         to instypea
 12726        else
 12727           MOVE -1               TO INSTYPEL
 12728           MOVE AL-UABON         TO INSTYPEA
 12729           MOVE ER-1654          TO EMI-ERROR
 12730           PERFORM 9900-ERROR-FORMAT
 12731                                 THRU 9900-EXIT
 12732        END-IF
 12733     ELSE
 12734        IF MAINTI = 'A'
 12735           MOVE -1               TO INSTYPEL
 12736           MOVE AL-UABON         TO INSTYPEA
 12737           MOVE ER-1654          TO EMI-ERROR
 12738           PERFORM 9900-ERROR-FORMAT
 12739                                 THRU 9900-EXIT
 12740        END-IF
 12741     END-IF
 12742     if (instypel <> zeros)
 12743        and (emi-error not = er-1654)
 12744        and (instypei = 'C')
 12745        and (crtfnmei = fstnmei)
 12746        move er-1675             to emi-error
 12747        MOVE -1                  TO INSTYPEL
 12748        MOVE AL-UABON            TO INSTYPEA
 12749        PERFORM 9900-ERROR-FORMAT
 12750                                 THRU 9900-EXIT
 12751    end-if
 12752     if (instypel <> zeros)
 12753        and (emi-error not = er-1654)
 12754        and (instypei = 'P')
 12755        and (crtfnmei <> fstnmei)
 12756        move er-1676             to emi-error
 12757        MOVE -1                  TO INSTYPEL
 12758        MOVE AL-UABON            TO INSTYPEA
 12759        PERFORM 9900-ERROR-FORMAT
 12760                                 THRU 9900-EXIT
 12761    end-if
 12762     IF PCERTNOL = ZERO
 12763        MOVE CERTNOI             TO PCERTNOI
 12764        MOVE CERTNOL             TO PCERTNOL
 12765        MOVE AL-UANON            TO PCERTNOA
 12766     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 240
* EL130.cbl
 12767        MOVE AL-UANON            TO PCERTNOA
 12768     END-IF.
 12769
 12770     IF PSUFXL = ZERO
 12771        MOVE SUFXI               TO PSUFXI
 12772        MOVE SUFXL               TO PSUFXL
 12773        MOVE AL-UANON            TO PSUFXA
 12774     ELSE
 12775        MOVE AL-UANON            TO PSUFXA
 12776     END-IF.
 12777
 12778     IF MAINTI = 'I'
 12779         GO TO 6020-EDIT
 12780     END-IF.
 12781
 12782     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12783         MOVE -1                 TO LSTNMEL
 12784         MOVE ER-0236            TO EMI-ERROR
 12785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12786     ELSE
 12787         MOVE AL-UANON           TO LSTNMEA
 12788     END-IF.
 12789     if fstnmel not = zeros
 12790        move al-uanon            to fstnmea
 12791     end-if
 12792     IF SEXL > ZEROS
 12793        IF SEXI = 'M' OR 'F'
 12794           move al-uanon         to sexa
 12795           CONTINUE
 12796        ELSE
 12797           MOVE -1               TO SEXL
 12798           MOVE AL-UABON         TO SEXA
 12799           MOVE ER-0219          TO EMI-ERROR
 12800           PERFORM 9900-ERROR-FORMAT
 12801                                 THRU 9900-EXIT
 12802        END-IF
 12803     ELSE
 12804        IF MAINTI = 'A'
 12805           MOVE -1               TO SEXL
 12806           MOVE AL-UABON         TO SEXA
 12807           MOVE ER-0219          TO EMI-ERROR
 12808           PERFORM 9900-ERROR-FORMAT
 12809                                 THRU 9900-EXIT
 12810        END-IF
 12811     END-IF
 12812     IF SSNL GREATER THAN ZERO
 12813         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12814         IF WS-SOC-SEC-NO NUMERIC AND
 12815           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12816             NEXT SENTENCE
 12817         ELSE
 12818            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12819               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12820               WS-SSN-DASH2 = '-'
 12821                 NEXT SENTENCE
 12822            ELSE
 12823                 MOVE ER-0887        TO  EMI-ERROR
 12824                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 241
* EL130.cbl
 12825                 MOVE AL-UABON       TO  SSNA
 12826                 MOVE -1             TO  SSNL
 12827            END-IF
 12828        END-IF
 12829     END-IF.
 12830
 12831     IF BIRTHDTL = ZERO
 12832         GO TO 6020-EDIT
 12833     END-IF.
 12834
 12835     IF BIRTHDTL GREATER ZERO
 12836         MOVE BIRTHDTI           TO DATE-WORK
 12837         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12838         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12839         MOVE '4'                TO DC-OPTION-CODE
 12840         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12841         IF DATE-CONVERSION-ERROR
 12842             MOVE AL-UABON       TO BIRTHDTA
 12843             MOVE -1             TO BIRTHDTL
 12844             MOVE ER-0220        TO EMI-ERROR
 12845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12846             GO TO 6020-EDIT
 12847         END-IF
 12848     END-IF.
 12849
 12850******************************************************************
 12851**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12852**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12853**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 12854******************************************************************
 12855
 12856     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12857         MOVE BIRTHDTI           TO  DATE-WORK
 12858         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12859         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12860         MOVE '4'                TO  DC-OPTION-CODE
 12861         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12862         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12863                                     DC-ELAPSED-DAYS
 12864         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12865         IF DATE-CONVERSION-ERROR
 12866             MOVE AL-UABON       TO  BIRTHDTA
 12867             MOVE -1             TO  BIRTHDTL
 12868             MOVE ER-0220        TO  EMI-ERROR
 12869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12870             GO TO 6020-EDIT
 12871         END-IF
 12872     END-IF.
 12873
 12874     MOVE AL-UANON               TO  BIRTHDTA.
 12875     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12876     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12877     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12878
 12879 6020-EDIT.
 12880     IF INCURL GREATER ZERO
 12881         MOVE INCURI             TO DATE-WORK
 12882         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 242
* EL130.cbl
 12883         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12884         MOVE '4'                TO DC-OPTION-CODE
 12885         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12886         IF DATE-CONVERSION-ERROR
 12887             MOVE AL-UABON       TO INCURA
 12888             MOVE -1             TO INCURL
 12889             MOVE ER-0222        TO EMI-ERROR
 12890             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12891         ELSE
 12892             MOVE AL-UANON       TO INCURA
 12893             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12894             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12895                                    PI-SAVE-INCUR-DT
 12896             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12897                 MOVE ER-0511     TO EMI-ERROR
 12898                 MOVE -1          TO INCURL
 12899                 MOVE AL-UABON    TO INCURA
 12900                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901             ELSE
 12902*                NEXT SENTENCE
 12903                 CONTINUE
 12904             END-IF
 12905         END-IF
 12906     ELSE
 12907         MOVE ER-0516         TO EMI-ERROR
 12908         MOVE AL-UABON        TO INCURA
 12909         MOVE -1              TO INCURL
 12910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12911     END-IF.
 12912
 12913     IF REPORTL GREATER ZERO
 12914         MOVE REPORTI            TO DATE-WORK
 12915         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12916         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12917         MOVE '4'                TO DC-OPTION-CODE
 12918         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12919         IF DATE-CONVERSION-ERROR
 12920             MOVE AL-UABON       TO REPORTA
 12921             MOVE -1             TO REPORTL
 12922             MOVE ER-0223        TO EMI-ERROR
 12923             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12924         ELSE
 12925             MOVE AL-UANON       TO REPORTA
 12926             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12927             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12928             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12929                 MOVE ER-0512     TO EMI-ERROR
 12930                 MOVE -1          TO REPORTL
 12931                 MOVE AL-UABON    TO REPORTA
 12932                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933             ELSE
 12934*                NEXT SENTENCE
 12935                 CONTINUE
 12936             END-IF
 12937         END-IF
 12938     ELSE
 12939         MOVE ER-0517         TO EMI-ERROR
 12940         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 243
* EL130.cbl
 12941         MOVE AL-UABON        TO REPORTA
 12942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12943     END-IF.
 12944
 12945     IF WS-REPORT NOT = LOW-VALUES
 12946         IF WS-INCUR GREATER THAN WS-REPORT
 12947             MOVE AL-UABON       TO REPORTA
 12948             MOVE -1             TO REPORTL
 12949             MOVE ER-0509        TO EMI-ERROR
 12950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12951         END-IF
 12952     END-IF.
 12953
 12954     IF ICD1L GREATER THAN ZERO
 12955         IF (ICD1I GREATER THAN SPACES) AND
 12956            (ICD1I(4:1) NOT = '.')
 12957             IF ICD1I(4:1) = ' '
 12958                 MOVE '.' TO ICD1I(4:1)
 12959             ELSE
 12960                 IF ICD1I(8:1) = ' '
 12961                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 12962                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 12963                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 12964                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 12965                     MOVE '.'        TO ICD1I(4:1)
 12966                 END-IF
 12967             END-IF
 12968         END-IF
 12969         IF (ICD1I GREATER THAN SPACES) AND
 12970            (ICD1I(1:1) NOT > ' ' OR
 12971             ICD1I(2:1) NOT > ' ' OR
 12972             ICD1I(3:1) NOT > ' ' OR
 12973             ICD1I(4:1) NOT = '.')
 12974              MOVE ER-0992        TO  EMI-ERROR
 12975              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976              MOVE AL-UABON       TO ICD1A
 12977              MOVE -1             TO ICD1L
 12978         END-IF
 12979     END-IF.
 12980
 12981     IF ICD2L GREATER THAN ZERO
 12982         IF (ICD2I GREATER THAN SPACES) AND
 12983            (ICD2I(4:1) NOT = '.')
 12984             IF ICD2I(4:1) = ' '
 12985                 MOVE '.' TO ICD2I(4:1)
 12986             ELSE
 12987                 IF ICD2I(8:1) = ' '
 12988                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 12989                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 12990                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 12991                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 12992                     MOVE '.'        TO ICD2I(4:1)
 12993                 END-IF
 12994             END-IF
 12995         END-IF
 12996         IF (ICD2I GREATER THAN SPACES) AND
 12997            (ICD2I(1:1) NOT > ' ' OR
 12998             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 244
* EL130.cbl
 12999             ICD2I(3:1) NOT > ' ' OR
 13000             ICD2I(4:1) NOT = '.')
 13001              MOVE ER-0992        TO  EMI-ERROR
 13002              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13003              MOVE AL-UABON       TO ICD2A
 13004              MOVE -1             TO ICD2L
 13005         END-IF
 13006     END-IF
 13007
 13008*    IF ESTENDL GREATER ZERO
 13009*        MOVE ESTENDI            TO DATE-WORK
 13010*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13011*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13012*        MOVE '4'                TO DC-OPTION-CODE
 13013*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13014*        IF DATE-CONVERSION-ERROR
 13015*            MOVE AL-UABON       TO ESTENDA
 13016*            MOVE -1             TO ESTENDL
 13017*            MOVE ER-0224        TO EMI-ERROR
 13018*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13019*        ELSE
 13020*            MOVE AL-UANON       TO ESTENDA
 13021*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13022*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13023*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13024*               MOVE AL-UABON    TO ESTENDA
 13025*               MOVE -1          TO ESTENDL
 13026*               MOVE ER-0544     TO EMI-ERROR
 13027*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13028*            END-IF
 13029*        END-IF
 13030*    END-IF.
 13031*
 13032*    IF WS-ESTEND NOT = LOW-VALUES
 13033*        IF WS-INCUR GREATER THAN WS-ESTEND
 13034*            MOVE AL-UABON       TO ESTENDA
 13035*            MOVE -1             TO ESTENDL
 13036*            MOVE ER-0510        TO EMI-ERROR
 13037*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13038*        END-IF
 13039*    END-IF.
 13040
 13041     IF PRTOPTL GREATER ZERO
 13042         IF PRTOPTI NOT = 'N' AND 'L'
 13043             MOVE AL-UABON       TO PRTOPTA
 13044             MOVE -1             TO PRTOPTL
 13045             MOVE ER-0334        TO EMI-ERROR
 13046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047         END-IF
 13048     END-IF.
 13049
 13050     IF MANRSVL GREATER ZERO
 13051
 13052* EXEC CICS BIF DEEDIT
 13053*            FIELD   (MANRSVI)
 13054*            LENGTH  (9)
 13055*        END-EXEC
 13056     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 245
* EL130.cbl
 13057       TO DFHEIV11
 13058*    MOVE '@"L                   #   #00011911' TO DFHEIV0
 13059     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13061     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 13062     CALL 'kxdfhei1' USING DFHEIV0,
 13063           MANRSVI,
 13064           DFHEIV11
 13065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13066         IF MANRSVI NOT NUMERIC
 13067             MOVE AL-UNBON       TO MANRSVA
 13068             MOVE -1             TO MANRSVL
 13069             MOVE ER-0489        TO EMI-ERROR
 13070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13071         ELSE
 13072             MOVE AL-UNNON       TO MANRSVA
 13073             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13074         END-IF
 13075     END-IF.
 13076
 13077     MOVE SPACES                 TO ELCNTL-KEY.
 13078
 13079     IF CONTROL-IS-ACTUAL-CARRIER
 13080         MOVE PI-CARRIER         TO CNTL-CARRIER
 13081     ELSE
 13082         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13083     END-IF.
 13084
 13085     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13086     MOVE '6'                    TO CNTL-REC-TYPE.
 13087     MOVE +0                     TO CNTL-SEQ-NO.
 13088
 13089
 13090
 13091* EXEC CICS HANDLE CONDITION
 13092*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13093*    END-EXEC.
 13094*    MOVE '"$I                   ! ? #00011939' TO DFHEIV0
 13095     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13097     MOVE X'3F20233030303131393339' TO DFHEIV0(25:11)
 13098     CALL 'kxdfhei1' USING DFHEIV0
 13099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13100
 13101
 13102     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13103
 13104     IF NOT CF-MANUAL-RESERVES-USED AND
 13105           WS-MANRSV GREATER ZERO
 13106         MOVE ER-0518             TO EMI-ERROR
 13107         MOVE -1                  TO MANRSVL
 13108         MOVE AL-UNBON            TO MANRSVA
 13109         MOVE ZEROS               TO WS-MANRSV
 13110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13111     END-IF.
 13112
 13113     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13114     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 246
* EL130.cbl
 13115
 13116     IF SUPVL GREATER ZERO
 13117         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13118             MOVE -1             TO SUPVL
 13119             MOVE AL-UABON       TO SUPVA
 13120             MOVE ER-0230        TO EMI-ERROR
 13121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13122         ELSE
 13123             MOVE AL-UANON       TO SUPVA
 13124         END-IF
 13125     END-IF.
 13126
 13127     IF PROCCDL = ZERO
 13128        GO TO 6050-CONTINUE-EDITS
 13129     END-IF.
 13130
 13131     MOVE SPACES                 TO ELCNTL-KEY.
 13132     MOVE PROCCDI                TO CNTL-ACCESS.
 13133
 13134     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13135     MOVE '2'                    TO CNTL-REC-TYPE.
 13136     MOVE +0                     TO CNTL-SEQ-NO.
 13137
 13138
 13139
 13140* EXEC CICS HANDLE CONDITION
 13141*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13142*    END-EXEC.
 13143*    MOVE '"$I                   ! @ #00011980' TO DFHEIV0
 13144     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13146     MOVE X'4020233030303131393830' TO DFHEIV0(25:11)
 13147     CALL 'kxdfhei1' USING DFHEIV0
 13148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13149
 13150
 13151     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13152
 13153     GO TO 6050-CONTINUE-EDITS.
 13154
 13155 6040-NO-PROCESSOR-RECORD.
 13156     MOVE ER-0019                TO EMI-ERROR.
 13157     MOVE -1                     TO PROCCDL.
 13158     MOVE AL-UABON               TO PROCCDA.
 13159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160
 13161 6050-CONTINUE-EDITS.
 13162     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13163           GO TO 6070-CONTINUE-EDITS
 13164     END-IF.
 13165
 13166     MOVE BENECDI                TO BENE-CODE.
 13167     MOVE 'B'                    TO BENE-RCD-TYPE.
 13168     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13169
 13170
 13171
 13172* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 247
* EL130.cbl
 13173*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13174*    END-EXEC.
 13175*    MOVE '"$I                   ! A #00012004' TO DFHEIV0
 13176     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13178     MOVE X'4120233030303132303034' TO DFHEIV0(25:11)
 13179     CALL 'kxdfhei1' USING DFHEIV0
 13180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13181
 13182
 13183
 13184* EXEC CICS READ
 13185*         DATASET   (ELBENE-DSID)
 13186*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13187*         RIDFLD    (ELBENE-KEY)
 13188*    END-EXEC.
 13189*    MOVE '&"S        E          (   #00012008' TO DFHEIV0
 13190     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13192     MOVE X'2020233030303132303038' TO DFHEIV0(25:11)
 13193     CALL 'kxdfhei1' USING DFHEIV0,
 13194           ELBENE-DSID,
 13195           DFHEIV20,
 13196           DFHEIV99,
 13197           ELBENE-KEY,
 13198           DFHEIV99,
 13199           DFHEIV99,
 13200           DFHEIV99
 13201     SET ADDRESS OF BENEFICIARY-MASTER TO
 13202         DFHEIV20
 13203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13204
 13205
 13206     GO TO 6070-CONTINUE-EDITS.
 13207
 13208 6060-NO-BENEFICIARY-RECORD.
 13209     MOVE ER-0565                TO EMI-ERROR.
 13210     MOVE -1                     TO BENECDL.
 13211     MOVE AL-UABON               TO BENECDA.
 13212     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13213
 13214
 13215 6070-CONTINUE-EDITS.
 13216     IF CERTMTL GREATER ZERO
 13217         IF CERTMTI NOT = 'A' AND 'S'
 13218             MOVE -1             TO CERTMTL
 13219             MOVE AL-UABON       TO CERTMTA
 13220             MOVE ER-0267        TO EMI-ERROR
 13221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13222         ELSE
 13223             MOVE AL-UANON       TO CERTMTA
 13224         END-IF
 13225     ELSE
 13226         GO TO 6000-EXIT
 13227     END-IF.
 13228
 13229     IF EFFDTL GREATER ZERO
 13230         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 248
* EL130.cbl
 13231         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13232         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13233         MOVE '4'                TO DC-OPTION-CODE
 13234         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13235         IF DATE-CONVERSION-ERROR
 13236             MOVE AL-UABON       TO EFFDTA
 13237             MOVE -1             TO EFFDTL
 13238             MOVE ER-0231        TO EMI-ERROR
 13239             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13240         ELSE
 13241             MOVE AL-UANON       TO EFFDTA
 13242             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13243             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13244         END-IF
 13245     ELSE
 13246         MOVE ER-0231            TO EMI-ERROR
 13247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13248         MOVE -1                 TO EFFDTL
 13249         MOVE AL-UABON           TO EFFDTA
 13250     END-IF.
 13251
 13252     IF ACCOUNTL = ZERO
 13253         MOVE ER-0232            TO EMI-ERROR
 13254         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13255         MOVE AL-UABON           TO ACCOUNTA
 13256         MOVE -1                 TO ACCOUNTL
 13257     ELSE
 13258         MOVE AL-UANON           TO ACCOUNTA
 13259     END-IF.
 13260
 13261     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13262        (STATEL = ZERO)
 13263         MOVE ER-0233        TO EMI-ERROR
 13264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13265         MOVE AL-UABON       TO STATEA
 13266         MOVE -1             TO STATEL
 13267     ELSE
 13268         MOVE AL-UANON       TO STATEA
 13269     END-IF.
 13270
 13271     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13272        (CRTCARRL = ZERO)
 13273         MOVE ER-0234        TO EMI-ERROR
 13274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13275         MOVE AL-UABON       TO CRTCARRA
 13276         MOVE -1             TO CRTCARRL
 13277     ELSE
 13278         MOVE AL-UANON       TO CRTCARRA
 13279     END-IF.
 13280
 13281     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13282        GROUPL = ZERO
 13283         MOVE ER-0235            TO EMI-ERROR
 13284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13285         MOVE AL-UABON           TO GROUPA
 13286         MOVE -1                 TO GROUPL
 13287     ELSE
 13288         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 249
* EL130.cbl
 13289     END-IF.
 13290
 13291     IF CRTLNMEL = ZERO
 13292         IF LSTNMEI = SPACES OR LOW-VALUES
 13293             MOVE ER-0236            TO  EMI-ERROR
 13294             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13295             MOVE AL-UABON           TO  CRTLNMEA
 13296             MOVE -1                 TO  CRTLNMEL
 13297         ELSE
 13298             MOVE LSTNMEI            TO  CRTLNMEI
 13299             MOVE AL-UANON           TO  CRTLNMEA
 13300         END-IF
 13301     ELSE
 13302         MOVE AL-UANON               TO  CRTLNMEA
 13303     END-IF.
 13304
 13305     IF CRTFNMEL = ZERO
 13306         IF FSTNMEI = SPACES OR LOW-VALUES
 13307*            NEXT SENTENCE
 13308             CONTINUE
 13309         ELSE
 13310             MOVE FSTNMEI            TO  CRTFNMEI
 13311             MOVE AL-UANON           TO  CRTFNMEA
 13312         END-IF
 13313     END-IF.
 13314
 13315     IF CRTINITL = ZERO
 13316         IF INITI = SPACES OR LOW-VALUES
 13317*            NEXT SENTENCE
 13318             CONTINUE
 13319         ELSE
 13320             MOVE INITI              TO  CRTINITI
 13321             MOVE AL-UANON           TO  CRTINITA
 13322         END-IF
 13323     END-IF.
 13324
 13325 6000-EXIT.
 13326     EXIT.
 13327
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 250
* EL130.cbl
 13329 6200-EDIT-CERT-DATA.
 13330     IF ISSAGEL GREATER ZERO
 13331         IF ISSAGEI NOT NUMERIC
 13332             MOVE ER-0237        TO EMI-ERROR
 13333             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13334             MOVE -1             TO ISSAGEL
 13335             MOVE AL-UNBON       TO ISSAGEA
 13336         ELSE
 13337             MOVE AL-UNNON       TO ISSAGEA
 13338         END-IF
 13339     END-IF.
 13340
 13341     IF JNTAGEL GREATER ZERO
 13342         IF JNTAGEI NOT NUMERIC
 13343             MOVE ER-0238        TO EMI-ERROR
 13344             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13345             MOVE -1             TO JNTAGEL
 13346             MOVE AL-UNBON       TO JNTAGEA
 13347         ELSE
 13348             MOVE AL-UNNON       TO JNTAGEA
 13349         END-IF
 13350     END-IF.
 13351
 13352     IF LCVCDL GREATER ZERO
 13353         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13354         IF INVALID-BENEFIT-CODE
 13355             MOVE ER-7635        TO EMI-ERROR
 13356             MOVE -1             TO LCVCDL
 13357             MOVE AL-UABON       TO LCVCDA
 13358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13359         ELSE
 13360             MOVE LCVCDI         TO WS-BEN-HOLD
 13361             MOVE '4'            TO WS-REC-TYPE
 13362             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13363             IF WS-BEN-ALPHA-HOLD = SPACES
 13364                MOVE ER-7635     TO EMI-ERROR
 13365                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13366                MOVE -1          TO LCVCDL
 13367                MOVE AL-UABON    TO LCVCDA
 13368             ELSE
 13369                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13370                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13371                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13372                MOVE AL-UANON           TO LCVCDA
 13373             END-IF
 13374         END-IF
 13375     END-IF.
 13376
 13377     IF ACVCDL GREATER ZERO
 13378         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13379         IF INVALID-BENEFIT-CODE
 13380             MOVE ER-7635        TO EMI-ERROR
 13381             MOVE -1             TO ACVCDL
 13382             MOVE AL-UABON       TO ACVCDA
 13383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13384         ELSE
 13385             MOVE ACVCDI         TO WS-BEN-HOLD
 13386             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 251
* EL130.cbl
 13387             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13388             IF WS-BEN-ALPHA-HOLD = SPACES
 13389                MOVE ER-7635     TO EMI-ERROR
 13390                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13391                MOVE -1          TO ACVCDL
 13392                MOVE AL-UABON    TO ACVCDA
 13393             ELSE
 13394                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13395                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13396                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13397                MOVE AL-UANON           TO ACVCDA
 13398             END-IF
 13399         END-IF
 13400     END-IF.
 13401
 13402     IF LCVOTRML GREATER ZERO
 13403         IF LCVOTRMI NOT NUMERIC
 13404             MOVE ER-7636        TO EMI-ERROR
 13405             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13406             MOVE -1             TO LCVOTRML
 13407             MOVE AL-UNBON       TO LCVOTRMA
 13408         ELSE
 13409             MOVE AL-UNNON       TO LCVOTRMA
 13410         END-IF
 13411     END-IF.
 13412
 13413     IF ACVOTRML GREATER ZERO
 13414         IF ACVOTRMI NOT NUMERIC
 13415             MOVE ER-7636        TO EMI-ERROR
 13416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13417             MOVE -1             TO ACVOTRML
 13418             MOVE AL-UNBON       TO ACVOTRMA
 13419         ELSE
 13420             MOVE AL-UNNON       TO ACVOTRMA
 13421         END-IF
 13422     END-IF.
 13423
 13424     IF LCVRATEL GREATER ZERO
 13425
 13426* EXEC CICS BIF DEEDIT
 13427*            FIELD    (LCVRATEI)
 13428*            LENGTH   (06)
 13429*        END-EXEC
 13430     MOVE 06
 13431       TO DFHEIV11
 13432*    MOVE '@"L                   #   #00012233' TO DFHEIV0
 13433     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13434     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13435     MOVE X'2020233030303132323333' TO DFHEIV0(25:11)
 13436     CALL 'kxdfhei1' USING DFHEIV0,
 13437           LCVRATEI,
 13438           DFHEIV11
 13439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13440         IF LCVRATEI NOT NUMERIC
 13441             MOVE AL-UNBON       TO LCVRATEA
 13442             MOVE -1             TO LCVRATEL
 13443             MOVE ER-2280        TO EMI-ERROR
 13444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 252
* EL130.cbl
 13445         ELSE
 13446             MOVE AL-UNNON       TO LCVRATEA
 13447             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13448         END-IF
 13449     END-IF.
 13450
 13451     IF ACVRATEL GREATER ZERO
 13452
 13453* EXEC CICS BIF DEEDIT
 13454*            FIELD    (ACVRATEI)
 13455*            LENGTH   (06)
 13456*        END-EXEC
 13457     MOVE 06
 13458       TO DFHEIV11
 13459*    MOVE '@"L                   #   #00012249' TO DFHEIV0
 13460     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13462     MOVE X'2020233030303132323439' TO DFHEIV0(25:11)
 13463     CALL 'kxdfhei1' USING DFHEIV0,
 13464           ACVRATEI,
 13465           DFHEIV11
 13466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13467         IF ACVRATEI NOT NUMERIC
 13468             MOVE AL-UNBON       TO ACVRATEA
 13469             MOVE -1             TO ACVRATEL
 13470             MOVE ER-2280        TO EMI-ERROR
 13471             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13472         ELSE
 13473             MOVE AL-UNNON       TO ACVRATEA
 13474             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13475         END-IF
 13476     END-IF.
 13477
 13478     IF LCVBENEL GREATER ZERO
 13479
 13480* EXEC CICS BIF DEEDIT
 13481*            FIELD    (LCVBENEI)
 13482*            LENGTH   (11)
 13483*        END-EXEC
 13484     MOVE 11
 13485       TO DFHEIV11
 13486*    MOVE '@"L                   #   #00012265' TO DFHEIV0
 13487     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13488     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13489     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           LCVBENEI,
 13492           DFHEIV11
 13493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13494         IF LCVBENEI NOT NUMERIC
 13495             MOVE AL-UNBON       TO LCVBENEA
 13496             MOVE -1             TO LCVBENEL
 13497             MOVE ER-7637        TO EMI-ERROR
 13498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13499         ELSE
 13500             MOVE AL-UNNON       TO LCVBENEA
 13501             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13502         END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 253
* EL130.cbl
 13503     END-IF.
 13504
 13505     IF ACVBENEL GREATER ZERO
 13506
 13507* EXEC CICS BIF DEEDIT
 13508*            FIELD    (ACVBENEI)
 13509*            LENGTH   (11)
 13510*        END-EXEC
 13511     MOVE 11
 13512       TO DFHEIV11
 13513*    MOVE '@"L                   #   #00012281' TO DFHEIV0
 13514     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13515     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13516     MOVE X'2020233030303132323831' TO DFHEIV0(25:11)
 13517     CALL 'kxdfhei1' USING DFHEIV0,
 13518           ACVBENEI,
 13519           DFHEIV11
 13520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13521         IF ACVBENEI NOT NUMERIC
 13522             MOVE AL-UNBON       TO ACVBENEA
 13523             MOVE -1             TO ACVBENEL
 13524             MOVE ER-7637        TO EMI-ERROR
 13525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13526         ELSE
 13527             MOVE AL-UNNON       TO ACVBENEA
 13528             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13529         END-IF
 13530     END-IF.
 13531
 13532     IF LCVCNDTL GREATER ZERO
 13533         IF LCVCNDTI NOT = SPACES
 13534             MOVE LCVCNDTI        TO DATE-WORK
 13535             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13536             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13537             MOVE '4'             TO DC-OPTION-CODE
 13538             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13539             IF DATE-CONVERSION-ERROR
 13540                 MOVE AL-UABON    TO LCVCNDTA
 13541                 MOVE -1          TO LCVCNDTL
 13542                 MOVE ER-7638     TO EMI-ERROR
 13543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13544             ELSE
 13545                 MOVE AL-UANON    TO LCVCNDTA
 13546                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13547                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13548             END-IF
 13549         END-IF
 13550     END-IF.
 13551
 13552     IF ACVCNDTL GREATER ZERO
 13553         IF ACVCNDTI NOT = SPACES
 13554             MOVE ACVCNDTI        TO DATE-WORK
 13555             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13556             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13557             MOVE '4'             TO DC-OPTION-CODE
 13558             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13559             IF DATE-CONVERSION-ERROR
 13560                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 254
* EL130.cbl
 13561                 MOVE -1          TO ACVCNDTL
 13562                 MOVE ER-7638     TO EMI-ERROR
 13563                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13564             ELSE
 13565                 MOVE AL-UANON    TO ACVCNDTA
 13566                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13567                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13568             END-IF
 13569         END-IF
 13570     END-IF.
 13571
 13572     IF ADDONDTL GREATER ZERO
 13573         MOVE ADDONDTI        TO DATE-WORK
 13574         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13575         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13576         MOVE '4'             TO DC-OPTION-CODE
 13577         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13578         IF DATE-CONVERSION-ERROR
 13579             MOVE AL-UABON    TO ADDONDTA
 13580             MOVE -1          TO ADDONDTL
 13581             MOVE ER-7651     TO EMI-ERROR
 13582             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583         ELSE
 13584             MOVE AL-UANON    TO ADDONDTA
 13585             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13586             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13587         END-IF
 13588     END-IF.
 13589
 13590     IF APRL GREATER ZERO
 13591
 13592* EXEC CICS BIF DEEDIT
 13593*            FIELD    (APRI)
 13594*            LENGTH   (8)
 13595*        END-EXEC
 13596     MOVE 8
 13597       TO DFHEIV11
 13598*    MOVE '@"L                   #   #00012355' TO DFHEIV0
 13599     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13600     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13601     MOVE X'2020233030303132333535' TO DFHEIV0(25:11)
 13602     CALL 'kxdfhei1' USING DFHEIV0,
 13603           APRI,
 13604           DFHEIV11
 13605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13606         IF APRI NOT NUMERIC
 13607             MOVE AL-UNBON       TO APRA
 13608             MOVE -1             TO APRL
 13609             MOVE ER-0248        TO EMI-ERROR
 13610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13611         ELSE
 13612             MOVE AL-UNNON       TO APRA
 13613             MOVE APRI           TO WS-APR APRO
 13614         END-IF
 13615     END-IF.
 13616
 13617     IF PMTFREQL GREATER ZERO
 13618
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 255
* EL130.cbl
 13619* EXEC CICS BIF DEEDIT
 13620*            FIELD   (PMTFREQI)
 13621*            LENGTH  (2)
 13622*        END-EXEC
 13623     MOVE 2
 13624       TO DFHEIV11
 13625*    MOVE '@"L                   #   #00012371' TO DFHEIV0
 13626     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13628     MOVE X'2020233030303132333731' TO DFHEIV0(25:11)
 13629     CALL 'kxdfhei1' USING DFHEIV0,
 13630           PMTFREQI,
 13631           DFHEIV11
 13632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13633         IF PMTFREQI NOT NUMERIC
 13634             MOVE -1             TO PMTFREQL
 13635             MOVE AL-UNBON       TO PMTFREQA
 13636             MOVE ER-0258        TO EMI-ERROR
 13637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13638         ELSE
 13639             MOVE AL-UNNON       TO PMTFREQA
 13640             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13641         END-IF
 13642     END-IF.
 13643
 13644     IF INDGRPL GREATER ZERO
 13645         IF INDGRPI = 'I' OR 'G'
 13646             MOVE AL-UANON       TO INDGRPA
 13647         ELSE
 13648             MOVE -1 TO INDGRPL
 13649             MOVE AL-UABON       TO INDGRPA
 13650             MOVE ER-0260        TO EMI-ERROR
 13651             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13652         END-IF
 13653     END-IF.
 13654
 13655     IF LOANBALL GREATER ZERO
 13656         MOVE LOANBALI           TO DEEDIT-FIELD
 13657
 13658* EXEC CICS BIF DEEDIT
 13659*            FIELD   (DEEDIT-FIELD)
 13660*            LENGTH  (12)
 13661*        END-EXEC
 13662     MOVE 12
 13663       TO DFHEIV11
 13664*    MOVE '@"L                   #   #00012399' TO DFHEIV0
 13665     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13666     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13667     MOVE X'2020233030303132333939' TO DFHEIV0(25:11)
 13668     CALL 'kxdfhei1' USING DFHEIV0,
 13669           DEEDIT-FIELD,
 13670           DFHEIV11
 13671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13672         IF DEEDIT-FIELD NOT NUMERIC
 13673             MOVE AL-UNBON       TO LOANBALA
 13674             MOVE -1             TO LOANBALL
 13675             MOVE ER-0247        TO EMI-ERROR
 13676             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 256
* EL130.cbl
 13677         ELSE
 13678             MOVE AL-UNNON       TO LOANBALA
 13679             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13680         END-IF
 13681     END-IF.
 13682
 13683     IF PREMTYPL GREATER ZERO
 13684         IF (PREMTYPI = '1' OR '2' OR '3')
 13685             MOVE AL-UANON       TO PREMTYPA
 13686         ELSE
 13687             MOVE -1             TO PREMTYPL
 13688             MOVE AL-UABON       TO PREMTYPA
 13689             MOVE ER-0227        TO EMI-ERROR
 13690             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13691         END-IF
 13692     END-IF.
 13693
 13694     IF REINCDL GREATER ZERO
 13695         MOVE LOW-VALUES         TO  ERREIN-KEY
 13696         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13697         MOVE REINCDI            TO  REIN-CODE-1
 13698                                     REIN-CODE-2
 13699                                     REIN-CODE-3
 13700         MOVE 'A'                TO  REIN-TYPE
 13701         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13702         IF REIN-REC-NOT-FOUND
 13703             MOVE ER-0266        TO  EMI-ERROR
 13704             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13705             MOVE -1             TO  REINCDL
 13706             MOVE AL-UABON       TO  REINCDA
 13707         ELSE
 13708             MOVE AL-UANON       TO  REINCDA
 13709         END-IF
 13710     END-IF.
 13711
 13712     IF CERTMTI NOT = 'A'
 13713        GO TO 6200-EXIT
 13714     END-IF.
 13715
 13716     IF PREMTYPI = '1'
 13717         IF LCVCDL GREATER ZERO
 13718             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13719                 MOVE ER-0841        TO  EMI-ERROR
 13720                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13721                 MOVE -1             TO  PREMTYPL
 13722                 MOVE AL-UABON       TO  PREMTYPA
 13723             END-IF
 13724         END-IF
 13725     END-IF.
 13726
 13727     IF PREMTYPI = '1'
 13728         IF ACVCDL GREATER ZERO
 13729             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13730                 MOVE ER-0841        TO  EMI-ERROR
 13731                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13732                 MOVE -1             TO  PREMTYPL
 13733                 MOVE AL-UABON       TO  PREMTYPA
 13734             END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 257
* EL130.cbl
 13735         END-IF
 13736     END-IF.
 13737
 13738     IF PREMTYPI = '2'
 13739         IF LCVCDL GREATER ZERO
 13740             IF (PI-COMPANY-ID = 'HAN') AND
 13741                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13742                        OR
 13743                 WS-LF-SPECIAL-CALC-CD = 'O'
 13744*                NEXT SENTENCE
 13745                 CONTINUE
 13746             ELSE
 13747                 MOVE ER-0840        TO  EMI-ERROR
 13748                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13749                 MOVE -1             TO  PREMTYPL
 13750                 MOVE AL-UABON       TO  PREMTYPA
 13751             END-IF
 13752         END-IF
 13753     END-IF.
 13754
 13755     IF PREMTYPI = '2'
 13756         IF ACVCDL GREATER ZERO
 13757             IF (PI-COMPANY-ID = 'HAN')  AND
 13758                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13759                        OR
 13760                 WS-AH-SPECIAL-CALC-CD = 'O'
 13761*                NEXT SENTENCE
 13762                 CONTINUE
 13763             ELSE
 13764                 MOVE ER-0840        TO  EMI-ERROR
 13765                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13766                 MOVE -1             TO  PREMTYPL
 13767                 MOVE AL-UABON       TO  PREMTYPA
 13768             END-IF
 13769         END-IF
 13770     END-IF.
 13771
 13772     IF LCVCDL = ZEROS
 13773        GO TO 6200-EXIT
 13774     END-IF.
 13775
 13776     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13777         IF PMTFREQI NOT = ZEROS
 13778             MOVE ER-0428        TO EMI-ERROR
 13779             MOVE -1             TO PMTFREQL
 13780             MOVE AL-UNBON       TO PMTFREQA
 13781             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13782             GO TO 6200-CHECK-APR
 13783         END-IF
 13784     END-IF.
 13785
 13786     IF PMTFREQL = ZEROS AND TEX-REG
 13787         MOVE ER-0429            TO EMI-ERROR
 13788         MOVE -1                 TO PMTFREQL
 13789         MOVE AL-UNBON           TO PMTFREQA
 13790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13791         GO TO 6200-CHECK-APR
 13792     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 258
* EL130.cbl
 13793
 13794     IF LCVOTRMI NOT NUMERIC
 13795         GO TO 6200-CHECK-APR
 13796     END-IF.
 13797
 13798     IF WS-PMTFREQ NOT = ZERO
 13799         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13800         GIVING DIVIDE-QUOT
 13801         REMAINDER DIVIDE-REM
 13802         IF DIVIDE-REM GREATER ZERO
 13803             MOVE ER-0430            TO EMI-ERROR
 13804             MOVE -1                 TO PMTFREQL
 13805             MOVE AL-UNBON           TO PMTFREQA
 13806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13807         END-IF
 13808     END-IF.
 13809
 13810 6200-CHECK-APR.
 13811     IF NET-PAY AND APRL = ZEROS
 13812        MOVE ER-0257             TO EMI-ERROR
 13813        MOVE -1                  TO APRL
 13814        MOVE AL-UABON            TO APRA
 13815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13816     END-IF.
 13817
 13818 6200-EXIT.
 13819     EXIT.
 13820
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 259
* EL130.cbl
 13822 6300-REQUIRED-CERT-EDIT.
 13823
 13824     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13825        GO TO 6300-REQUIRED-AH-EDIT
 13826     END-IF
 13827
 13828     IF LCVCDL = ZERO
 13829        MOVE ER-7639             TO EMI-ERROR
 13830        MOVE -1                  TO LCVCDL
 13831        MOVE AL-UABON            TO LCVCDA
 13832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13833     END-IF.
 13834
 13835     IF LCVOTRML = ZERO
 13836        MOVE ER-7670             TO EMI-ERROR
 13837        MOVE -1                  TO LCVOTRML
 13838        MOVE AL-UNBON            TO LCVOTRMA
 13839        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13840     END-IF.
 13841
 13842     IF LCVBENEL = ZERO
 13843        MOVE ER-7671             TO EMI-ERROR
 13844        MOVE -1                  TO LCVBENEL
 13845        MOVE AL-UNBON            TO LCVBENEA
 13846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13847     END-IF.
 13848
 13849     GO TO 6399-EXIT.
 13850
 13851 6300-REQUIRED-AH-EDIT.
 13852
 13853     IF ACVCDL = ZERO
 13854        MOVE ER-7639             TO EMI-ERROR
 13855        MOVE -1                  TO ACVCDL
 13856        MOVE AL-UABON            TO ACVCDA
 13857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13858     END-IF.
 13859
 13860     IF ACVOTRML = ZERO
 13861         MOVE ER-7670             TO EMI-ERROR
 13862         MOVE -1                  TO ACVOTRML
 13863         MOVE AL-UNBON            TO ACVOTRMA
 13864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13865     END-IF.
 13866
 13867     IF ACVBENEL = ZERO
 13868        MOVE ER-7671             TO EMI-ERROR
 13869        MOVE -1                  TO ACVBENEL
 13870        MOVE AL-UNBON            TO ACVBENEA
 13871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13872     END-IF.
 13873
 13874 6399-EXIT.
 13875      EXIT.
 13876
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 260
* EL130.cbl
 13878 6400-TEST-CLAIM-REASONABILITY.
 13879
 13880     IF WS-INCUR = LOW-VALUES
 13881        GO TO 6499-EXIT
 13882     END-IF.
 13883
 13884     IF WS-EFFDT NOT = LOW-VALUES
 13885         IF WS-INCUR LESS WS-EFFDT
 13886             MOVE ER-0458          TO EMI-ERROR
 13887             MOVE -1               TO INCURL
 13888             MOVE AL-UABON         TO INCURA
 13889             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890         END-IF
 13891     END-IF.
 13892
 13893     IF CERTMTI = 'A'
 13894        GO TO 6460-TEST-NEW-CERT
 13895     END-IF.
 13896
 13897     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13898     MOVE CRTCARRI               TO CERT-CARRIER.
 13899     MOVE GROUPI                 TO CERT-GROUPING.
 13900     MOVE STATEI                 TO CERT-STATE.
 13901     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13902     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13903     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13904
 13905
 13906
 13907* EXEC CICS HANDLE CONDITION
 13908*         DUPKEY   (6499-EXIT)
 13909*         NOTFND   (6499-EXIT)
 13910*    END-EXEC.
 13911*    MOVE '"$$I                  ! B #00012637' TO DFHEIV0
 13912     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13914     MOVE X'4220233030303132363337' TO DFHEIV0(25:11)
 13915     CALL 'kxdfhei1' USING DFHEIV0
 13916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13917
 13918
 13919     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13920
 13921     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13922        'I' OR 'G' OR 'F')
 13923        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13924     ELSE
 13925        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13926     END-IF.
 13927
 13928     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13929     MOVE '6'                    TO DC-OPTION-CODE.
 13930     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13931
 13932     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 13933        and (dc-elapsed-months > zeros)
 13934        MOVE ER-0519             TO EMI-ERROR
 13935        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 261
* EL130.cbl
 13936        MOVE AL-UABON            TO INCURA
 13937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13938     END-IF.
 13939
 13940     IF CLMCARRI NOT = CRTCARRI
 13941        MOVE ER-0562             TO EMI-ERROR
 13942        MOVE AL-UABON            TO CLMCARRA
 13943        MOVE -1                  TO CLMCARRL
 13944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13945     END-IF.
 13946
 13947     if (pi-company-id = 'DCC' OR 'VPP')
 13948        and (ws-dcc-product-code <> spaces)
 13949        continue
 13950     else
 13951      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 13952        CM-AH-BENEFIT-CD = '00')
 13953                  OR
 13954        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13955        CM-LF-BENEFIT-CD = '00')
 13956         MOVE ER-0521         TO EMI-ERROR
 13957         MOVE AL-UABON        TO CLMTYPEA
 13958         MOVE -1              TO CLMTYPEL
 13959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13960      END-IF
 13961     end-if
 13962*    IF CLMTYPEI = 'I' AND
 13963*       CM-AH-CRITICAL-PERIOD = +0
 13964*        MOVE ER-0521         TO EMI-ERROR
 13965*        MOVE AL-UABON        TO CLMTYPEA
 13966*        MOVE -1              TO CLMTYPEL
 13967*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13968*    END-IF
 13969
 13970*    IF PI-COMPANY-ID = 'CRI'
 13971*        IF MAINTI = 'A'
 13972*            IF CERT-PEND-ISSUE-ERROR  OR
 13973*               CERT-PEND-ISSUE-RETURNED
 13974*                MOVE -1                 TO CERTNOL
 13975*                MOVE AL-UABON           TO CERTNOA
 13976*                MOVE ER-7640            TO EMI-ERROR
 13977*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13978*            END-IF
 13979*        END-IF
 13980*    END-IF.
 13981
 13982     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13983         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 13984         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13985             GO TO 6450-DATE-ERROR
 13986         END-IF
 13987     END-IF.
 13988
 13989     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13990         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13991         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13992             GO TO 6450-DATE-ERROR
 13993         END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 262
* EL130.cbl
 13994     END-IF.
 13995
 13996     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13997         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13998             GO TO 6450-DATE-ERROR
 13999         END-IF
 14000     END-IF.
 14001
 14002     GO TO 6499-EXIT.
 14003
 14004 6450-DATE-ERROR.
 14005     MOVE ER-0520                TO EMI-ERROR.
 14006     MOVE -1                     TO INCURL.
 14007     MOVE AL-UABON               TO INCURA.
 14008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14009
 14010*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14011*       (EMI-SEVERITY-SAVE = 'X')
 14012*        ADD 1                TO EMI-FORCABLE-CTR
 14013*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14014*    END-IF.
 14015
 14016     GO TO 6499-EXIT.
 14017
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 263
* EL130.cbl
 14019 6460-TEST-NEW-CERT.
 14020
 14021     IF NOT EMI-NO-ERRORS
 14022        GO TO 6499-EXIT
 14023     END-IF.
 14024
 14025     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14026
 14027     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14028          OR 'F') AND
 14029         ACVOTRML GREATER ZERO)
 14030        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14031     END-IF.
 14032
 14033     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14034         LCVOTRML GREATER ZERO
 14035        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14036     END-IF.
 14037
 14038     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14039
 14040*    IF PI-COMPANY-ID = 'HAN'
 14041*        IF ADDONDTL GREATER ZERO
 14042*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14043*            IF CLMTYPEI = 'A'
 14044*                IF ACVOTRMI NOT = ZEROS
 14045*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14046*                ELSE
 14047*                    NEXT SENTENCE
 14048*                    CONTINUE
 14049*                END-IF
 14050*            ELSE
 14051*                IF LCVOTRMI NOT = ZEROS
 14052*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14053*                END-IF
 14054*            END-IF
 14055*        END-IF
 14056*    END-IF.
 14057
 14058     MOVE '6'                    TO DC-OPTION-CODE.
 14059     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14060
 14061     IF NO-CONVERSION-ERROR
 14062         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14063     END-IF.
 14064
 14065     IF WS-INCUR GREATER THAN WS-EXPIRE
 14066        MOVE ER-0519             TO EMI-ERROR
 14067        MOVE -1                  TO INCURL
 14068        MOVE AL-UABON            TO INCURA
 14069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14070     END-IF.
 14071
 14072     IF CLMCARRI NOT = CRTCARRI
 14073        MOVE ER-0562             TO EMI-ERROR
 14074        MOVE AL-UABON            TO CLMCARRA
 14075        MOVE -1                  TO CLMCARRL
 14076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 264
* EL130.cbl
 14077     END-IF.
 14078
 14079     if (pi-company-id = 'DCC' OR 'VPP')
 14080        and (ws-dcc-product-code <> spaces)
 14081        continue
 14082     else
 14083        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14084           and (ACVCDL = ZEROS)
 14085           MOVE ER-0521          TO EMI-ERROR
 14086           MOVE AL-UABON         TO CLMTYPEA
 14087           MOVE -1               TO CLMTYPEL
 14088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14089        END-IF
 14090     end-if
 14091
 14092     if (pi-company-id = 'DCC' OR 'VPP')
 14093        and (ws-dcc-product-code <> spaces)
 14094        continue
 14095     else
 14096        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14097           and (LCVCDL = ZEROS)
 14098           MOVE ER-0521          TO EMI-ERROR
 14099           MOVE AL-UABON         TO CLMTYPEA
 14100           MOVE -1               TO CLMTYPEL
 14101           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14102        END-IF
 14103     end-if
 14104
 14105     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14106         IF LCVCNDTL GREATER ZERO
 14107             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14108                 GO TO 6450-DATE-ERROR
 14109             END-IF
 14110         END-IF
 14111     END-IF.
 14112
 14113     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14114         IF ACVCNDTL GREATER ZERO
 14115             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14116                 GO TO 6450-DATE-ERROR
 14117             END-IF
 14118         END-IF
 14119     END-IF.
 14120
 14121 6499-EXIT.
 14122     EXIT.
 14123 6500-get-acct.
 14124
 14125     MOVE SPACES                 TO ERACCT-KEY
 14126                                    ws-dcc-product-code
 14127                                    ws-acct-found-sw
 14128
 14129     IF CARR-GROUP-ST-ACCNT-CNTL
 14130        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14131        MOVE CRTCARRI            TO ACCT-CARRIER
 14132        MOVE GROUPI              TO ACCT-GROUPING
 14133        MOVE STATEI              TO ACCT-STATE
 14134        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 265
* EL130.cbl
 14135        GO TO 6500-startbr
 14136     END-IF
 14137
 14138     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14139     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14140
 14141     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14142        MOVE STATEI             TO ACCT-STATE
 14143     END-IF
 14144
 14145     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14146        MOVE CRTCARRI           TO ACCT-CARRIER
 14147     END-IF
 14148
 14149     .
 14150 6500-startbr.
 14151
 14152     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14153
 14154
 14155* EXEC CICS STARTBR
 14156*       DATASET     (ERACCT2-DSID)
 14157*       RIDFLD      (SAVE-ERACCT-KEY)
 14158*       GENERIC
 14159*       KEYLENGTH   (20)
 14160*       resp        (ws-response)
 14161*    END-EXEC
 14162     MOVE 20
 14163       TO DFHEIV11
 14164     MOVE 0
 14165       TO DFHEIV12
 14166*    MOVE '&,   KG    G          &  N#00012877' TO DFHEIV0
 14167     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14169     MOVE X'204E233030303132383737' TO DFHEIV0(25:11)
 14170     CALL 'kxdfhei1' USING DFHEIV0,
 14171           ERACCT2-DSID,
 14172           SAVE-ERACCT-KEY,
 14173           DFHEIV11,
 14174           DFHEIV12,
 14175           DFHEIV99
 14176     MOVE EIBRESP  TO ws-response
 14177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14178
 14179     if not ws-resp-normal
 14180        go to 6500-exit
 14181     end-if
 14182
 14183     .
 14184 6500-readnext.
 14185
 14186
 14187* EXEC CICS READNEXT
 14188*       DATASET   (ERACCT2-DSID)
 14189*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14190*       RIDFLD    (SAVE-ERACCT-KEY)
 14191*    END-EXEC
 14192     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 266
* EL130.cbl
 14193       TO DFHEIV11
 14194*    MOVE '&.S                   )   #00012892' TO DFHEIV0
 14195     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14197     MOVE X'2020233030303132383932' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0,
 14199           ERACCT2-DSID,
 14200           DFHEIV20,
 14201           DFHEIV99,
 14202           SAVE-ERACCT-KEY,
 14203           DFHEIV99,
 14204           DFHEIV11,
 14205           DFHEIV99,
 14206           DFHEIV99
 14207     SET ADDRESS OF ACCOUNT-MASTER TO
 14208         DFHEIV20
 14209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14210
 14211     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14212        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14213        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14214        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14215        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14216        go to 6500-endbr
 14217     END-IF
 14218
 14219     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14220        and (WS-EFFDT < AM-EXPIRATION-DT)
 14221        set acct-found to true
 14222        MOVE AM-dcc-product-code to ws-dcc-product-code
 14223        GO TO 6500-endbr
 14224     END-IF
 14225
 14226     IF WS-EFFDT >= AM-EXPIRATION-DT
 14227         GO TO 6500-readnext
 14228     END-IF
 14229
 14230     .
 14231 6500-endbr.
 14232
 14233
 14234* EXEC CICS ENDBR
 14235*        DATASET    (ERACCT2-DSID)
 14236*    END-EXEC
 14237     MOVE 0
 14238       TO DFHEIV11
 14239*    MOVE '&2                    $   #00012920' TO DFHEIV0
 14240     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14242     MOVE X'2020233030303132393230' TO DFHEIV0(25:11)
 14243     CALL 'kxdfhei1' USING DFHEIV0,
 14244           ERACCT2-DSID,
 14245           DFHEIV11,
 14246           DFHEIV99
 14247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14248
 14249     .
 14250 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 267
* EL130.cbl
 14251     exit.
 14252 6600-CHECK-AUTO-ACTIVITY.
 14253
 14254
 14255* EXEC CICS HANDLE CONDITION
 14256*        NOTFND   (6600-NOT-FOUND)
 14257*    END-EXEC.
 14258*    MOVE '"$I                   ! C #00012929' TO DFHEIV0
 14259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14261     MOVE X'4320233030303132393239' TO DFHEIV0(25:11)
 14262     CALL 'kxdfhei1' USING DFHEIV0
 14263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14264
 14265
 14266     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14267     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14268     MOVE SPACES                     TO  CNTL-ACCESS.
 14269     MOVE +0                         TO  CNTL-SEQ-NO.
 14270
 14271     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14272
 14273     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14274         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14275                                         WS-LETTER-SW
 14276         GO TO 6600-EXIT
 14277     END-IF.
 14278
 14279     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14280         MOVE 'N'                     TO  WS-LETTER-SW
 14281     ELSE
 14282         MOVE 'Y'                     TO  WS-LETTER-SW
 14283     END-IF.
 14284
 14285     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14286     GO TO 6600-EXIT.
 14287
 14288 6600-START-AUTO-LETTER-WRITER.
 14289
 14290     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14291     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14292
 14293     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14294
 14295     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14296         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14297         MOVE '6'                     TO  DC-OPTION-CODE
 14298         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14299         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14300         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14301         IF NO-CONVERSION-ERROR
 14302             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14303         ELSE
 14304             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14305         END-IF
 14306     END-IF.
 14307
 14308     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 268
* EL130.cbl
 14309         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14310         MOVE '6'                     TO  DC-OPTION-CODE
 14311         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14312         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14313         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14314         IF NO-CONVERSION-ERROR
 14315             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14316         ELSE
 14317             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14318         END-IF
 14319     END-IF.
 14320
 14321
 14322
 14323* EXEC CICS LINK
 14324*        PROGRAM    (LINK-1523)
 14325*        COMMAREA   (W-1523-LINKDATA)
 14326*        LENGTH     (W-1523-COMM-LENGTH)
 14327*    END-EXEC.
 14328*    MOVE '."C                   (   #00012989' TO DFHEIV0
 14329     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14331     MOVE X'2020233030303132393839' TO DFHEIV0(25:11)
 14332     CALL 'kxdfhei1' USING DFHEIV0,
 14333           LINK-1523,
 14334           W-1523-LINKDATA,
 14335           W-1523-COMM-LENGTH,
 14336           DFHEIV99,
 14337           DFHEIV99,
 14338           DFHEIV99,
 14339           DFHEIV99
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
 14343     GO TO 6600-EXIT.
 14344
 14345 6600-NOT-FOUND.
 14346     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14347
 14348 6600-EXIT.
 14349     EXIT.
 14350
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 269
* EL130.cbl
 14351/
 14352*************************************************************
 14353*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14354*************************************************************
 14355
 14356 6700-OUTPUT-ACTIVITY-RECORD.
 14357
 14358
 14359
 14360* EXEC CICS GETMAIN
 14361*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14362*        LENGTH (DLYACTV-LENGTH)
 14363*        INITIMG (WS-BLANK)
 14364*    END-EXEC.
 14365*    MOVE ',"IL                  $   #00013011' TO DFHEIV0
 14366     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14368     MOVE X'2020233030303133303131' TO DFHEIV0(25:11)
 14369     CALL 'kxdfhei1' USING DFHEIV0,
 14370           DFHEIV20,
 14371           DLYACTV-LENGTH,
 14372           WS-BLANK
 14373     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14374         DFHEIV20
 14375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14376
 14377
 14378     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14379     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14380     MOVE CLMCARRI               TO DA-CARRIER.
 14381     IF CLMNOL EQUAL ZERO
 14382         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14383     ELSE
 14384         MOVE CLMNOI             TO DA-CLAIM-NO
 14385     END-IF.
 14386     MOVE CERTNOI                TO DA-CERT-PRIME.
 14387     MOVE SUFXI                  TO DA-CERT-SFX.
 14388     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14389     MOVE 'A'                    TO DA-RECORD-TYPE.
 14390
 14391
 14392* EXEC CICS HANDLE CONDITION
 14393*        NOTOPEN (6700-NOTOPEN-ERROR)
 14394*        DUPREC (6700-EXIT)
 14395*    END-EXEC.
 14396*    MOVE '"$J%                  ! D #00013030' TO DFHEIV0
 14397     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14399     MOVE X'4420233030303133303330' TO DFHEIV0(25:11)
 14400     CALL 'kxdfhei1' USING DFHEIV0
 14401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14402
 14403
 14404
 14405* EXEC CICS WRITE
 14406*        DATASET (DLYACTV-DSID)
 14407*        RIDFLD (DA-KEY)
 14408*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 270
* EL130.cbl
 14409*        LENGTH (DLYACTV-LENGTH)
 14410*    END-EXEC.
 14411*    MOVE '&$ L                  ''   #00013035' TO DFHEIV0
 14412     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14414     MOVE X'2020233030303133303335' TO DFHEIV0(25:11)
 14415     CALL 'kxdfhei1' USING DFHEIV0,
 14416           DLYACTV-DSID,
 14417           DAILY-ACTIVITY-RECORD,
 14418           DLYACTV-LENGTH,
 14419           DA-KEY,
 14420           DFHEIV99,
 14421           DFHEIV99
 14422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14423
 14424     GO TO 6700-EXIT.
 14425
 14426 6700-NOTOPEN-ERROR.
 14427     MOVE '2955'                 TO EMI-ERROR.
 14428     MOVE -1                     TO MAINTL.
 14429     MOVE AL-UANON               TO MAINTA.
 14430     PERFORM 9900-ERROR-FORMAT THRU
 14431             9900-EXIT.
 14432     GO TO 8200-SEND-DATAONLY.
 14433
 14434 6700-EXIT.
 14435     EXIT.
 14436
 14437*************************************************************
 14438*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14439*************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 271
* EL130.cbl
 14440/
 14441 6990-DEEDIT-DATE.
 14442
 14443
 14444* EXEC CICS BIF DEEDIT
 14445*        FIELD   (DATE-WORK)
 14446*        LENGTH  (8)
 14447*    END-EXEC.
 14448     MOVE 8
 14449       TO DFHEIV11
 14450*    MOVE '@"L                   #   #00013060' TO DFHEIV0
 14451     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14452     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14453     MOVE X'2020233030303133303630' TO DFHEIV0(25:11)
 14454     CALL 'kxdfhei1' USING DFHEIV0,
 14455           DATE-WORK,
 14456           DFHEIV11
 14457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14458
 14459 6990-EXIT.
 14460     EXIT.
 14461
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 272
* EL130.cbl
 14463 7000-BUILD-OUTPUT-MAP.
 14464
 14465     IF CLAIM-SWITCH = 'N'
 14466         GO TO 7050-BUILD-MAP-CERT-DATA
 14467     END-IF.
 14468
 14469     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14470         MOVE SPACES                 TO SEQUO
 14471         MOVE AL-SABOF               TO SEQUA
 14472     ELSE
 14473         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14474         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14475         MOVE WS-CLAIM-SEQU          TO SEQUO
 14476         MOVE AL-SABON               TO SEQUA
 14477     END-IF.
 14478
 14479     MOVE CL-CARRIER             TO CLMCARRO.
 14480     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14481     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14482     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14483     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14484     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14485     MOVE CL-INSURED-MID-INIT    TO INITO.
 14486     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14487     move cl-insured-type        to instypeo
 14488*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14489
 14490     MOVE AL-UANON               TO CLMCARRA
 14491                                    CLMTYPEA
 14492                                    PCERTNOA
 14493                                    PSUFXA
 14494                                    LSTNMEA
 14495                                    FSTNMEA
 14496                                    INITA
 14497                                    SEXA
 14498
 14499     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14500
 14501     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14502         MOVE ' '                 TO DC-OPTION-CODE
 14503         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14504         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14505         IF NOT DATE-CONVERSION-ERROR
 14506             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14507             MOVE AL-UANON            TO BIRTHDTA
 14508         END-IF
 14509     END-IF.
 14510
 14511     MOVE CL-SOC-SEC-NO          TO SSNO.
 14512     MOVE AL-UANON               TO SSNA.
 14513
 14514     IF CL-INCURRED-DT NOT = LOW-VALUES
 14515         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14516         MOVE ' '                TO DC-OPTION-CODE
 14517         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14518         IF NOT DATE-CONVERSION-ERROR
 14519             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14520             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 273
* EL130.cbl
 14521         END-IF
 14522     END-IF.
 14523
 14524     IF CL-REPORTED-DT NOT = LOW-VALUES
 14525         MOVE ' '                TO DC-OPTION-CODE
 14526         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14527         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14528         IF NOT DATE-CONVERSION-ERROR
 14529             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14530             MOVE AL-UANON            TO REPORTA
 14531         END-IF
 14532     END-IF.
 14533
 14534*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14535*        MOVE ' '                 TO DC-OPTION-CODE
 14536*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14537*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14538*        IF NOT DATE-CONVERSION-ERROR
 14539*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14540*            MOVE AL-UANON            TO ESTENDA
 14541*        END-IF
 14542*    END-IF.
 14543
 14544     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14545     MOVE WS-ICD-CODE-1          TO ICD1O.
 14546     MOVE WS-ICD-CODE-2          TO ICD2O.
 14547*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14548     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14549     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14550     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14551     MOVE CL-PRIORITY-CD         TO PRICDO.
 14552     MOVE AL-UANON               TO DIAGA
 14553                                    ICD1A
 14554                                    ICD2A
 14555*                                   CAUSEA
 14556                                    RELCLMA
 14557                                    PROCCDA
 14558                                    PRICDA.
 14559     MOVE AL-UNNON               TO MANRSVA.
 14560
 14561*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14562*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14563*        MOVE AL-UANON               TO PRODCDA
 14564*    END-IF.
 14565
 14566     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14567     MOVE CL-FILE-LOCATION       TO FILETOO.
 14568     MOVE CL-BENEFICIARY         TO BENECDO.
 14569     MOVE AL-UANON               TO SUPVA
 14570                                    FILETOA
 14571                                    BENECDA.
 14572
 14573     IF CLAIM-SWITCH = 'X'
 14574         GO TO 7099-EXIT
 14575     END-IF.
 14576
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 274
* EL130.cbl
 14578 7050-BUILD-MAP-CERT-DATA.
 14579     MOVE CM-CERT-PRIME          TO CERTNOO.
 14580     MOVE CM-CERT-SFX            TO SUFXO.
 14581     MOVE AL-SANON               TO CERTNOA
 14582                                    SUFXA.
 14583
 14584     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14585         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14586         MOVE ' '                TO DC-OPTION-CODE
 14587         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14588         IF NOT DATE-CONVERSION-ERROR
 14589             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14590         END-IF
 14591     END-IF.
 14592
 14593     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14594     MOVE CM-STATE               TO STATEO.
 14595     MOVE CM-CARRIER             TO CRTCARRO.
 14596     MOVE CM-GROUPING            TO GROUPO.
 14597     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14598     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14599     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14600     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14601     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14602     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14603     MOVE CM-JT-INITIAL          TO JNTINITO.
 14604     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14605     MOVE AL-UANON               TO ACCOUNTA
 14606                                    STATEA
 14607                                    CRTCARRA
 14608                                    GROUPA
 14609                                    CRTLNMEA
 14610                                    CRTFNMEA
 14611                                    CRTINITA
 14612                                    JNTLNMEA
 14613                                    JNTFNMEA
 14614                                    JNTINITA.
 14615     MOVE AL-UNNON               TO ISSAGEA
 14616                                    JNTAGEA.
 14617
 14618     IF CM-SSN-STATE   = CM-STATE AND
 14619        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14620*        NEXT SENTENCE
 14621         CONTINUE
 14622     ELSE
 14623         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14624     END-IF.
 14625
 14626     MOVE AL-UANON               TO CRTSSNA.
 14627
 14628     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14629     MOVE '2'                    TO DC-OPTION-CODE.
 14630     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14631     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14632
 14633*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14634     MOVE SPACES                 TO ELCNTL-KEY.
 14635     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 275
* EL130.cbl
 14636     MOVE '3'                    TO CNTL-REC-TYPE.
 14637     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14638     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14639
 14640
 14641
 14642* EXEC CICS READ
 14643*        DATASET  (ELCNTL-DSID)
 14644*        SET      (ADDRESS OF CONTROL-FILE)
 14645*        RIDFLD   (ELCNTL-KEY)
 14646*        RESP     (WS-RESPONSE)
 14647*    END-EXEC.
 14648*    MOVE '&"S        E          (  N#00013246' TO DFHEIV0
 14649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14651     MOVE X'204E233030303133323436' TO DFHEIV0(25:11)
 14652     CALL 'kxdfhei1' USING DFHEIV0,
 14653           ELCNTL-DSID,
 14654           DFHEIV20,
 14655           DFHEIV99,
 14656           ELCNTL-KEY,
 14657           DFHEIV99,
 14658           DFHEIV99,
 14659           DFHEIV99
 14660     SET ADDRESS OF CONTROL-FILE TO
 14661         DFHEIV20
 14662     MOVE EIBRESP  TO WS-RESPONSE
 14663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14664
 14665
 14666     IF WS-RESP-NOTFND
 14667          MOVE ER-2848           TO EMI-ERROR
 14668          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14669          GO TO 8100-SEND-INITIAL-MAP
 14670     END-IF.
 14671
 14672     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14673     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14674     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 276
* EL130.cbl
 14676     IF CM-LF-BENEFIT-CD = '00'
 14677         MOVE ZEROS              TO LCVOTRMO
 14678                                    LCVRTRMO
 14679                                    LCVRATEO
 14680                                    LCVBENEO
 14681         MOVE SPACES             TO LCVDSCRO
 14682                                    LCVCDO
 14683                                    LCVKINDO
 14684                                    LCVFORMO
 14685                                    LCVCNDTO
 14686                                    LCVEXITO
 14687                                    LCVSTATO
 14688         IF CLMTYPEL GREATER THAN ZERO AND
 14689            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14690                MOVE ER-0521     TO EMI-ERROR
 14691                MOVE AL-UABON    TO CLMTYPEA
 14692                MOVE -1          TO CLMTYPEL
 14693                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14694                GO TO 7060-FILL-AH-COVERAGE
 14695         ELSE
 14696             GO TO 7060-FILL-AH-COVERAGE
 14697         END-IF
 14698     END-IF.
 14699
 14700     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14701     MOVE AL-UANON               TO LCVDSCRA.
 14702     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14703     MOVE '4'                    TO WS-REC-TYPE.
 14704     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14705     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14706     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14707     MOVE AL-UANON               TO LCVCDA.
 14708     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14709                                    CP-ORIGINAL-TERM.
 14710     MOVE AL-UNNON               TO LCVOTRMA.
 14711     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14712     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14713     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14714     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14715     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14716     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14717
 14718     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14719     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14720
 14721     IF CM-LF-PREMIUM-RATE NUMERIC
 14722         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14723     ELSE
 14724         MOVE ZEROS              TO LCVRATEO
 14725     END-IF.
 14726
 14727     MOVE AL-UNNON               TO LCVRATEA.
 14728
 14729     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14730         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14731     END-IF.
 14732
 14733     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 277
* EL130.cbl
 14734
 14735     MOVE AL-UNNON               TO LCVBENEA.
 14736
 14737     IF CM-POLICY-FORM-NO NOT = SPACES
 14738         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14739     ELSE
 14740         MOVE WS-FORM-HOLD       TO LCVFORMO
 14741     END-IF.
 14742
 14743     MOVE SPACES                 TO WS-FORM-HOLD.
 14744     MOVE 'L'                    TO WS-REC-TYPE.
 14745     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14746
 14747     IF WS-FORM-HOLD NOT = SPACES
 14748         MOVE WS-FORM-HOLD       TO LCVFORMO
 14749         MOVE AL-UANON           TO LCVFORMA
 14750     END-IF.
 14751
 14752     IF CM-LF-CURRENT-STATUS = '8'
 14753         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14754             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14755             MOVE ' '             TO DC-OPTION-CODE
 14756             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14757             IF NOT DATE-CONVERSION-ERROR
 14758                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14759                 MOVE AL-UANON            TO LCVCNDTA
 14760             END-IF
 14761         END-IF
 14762     END-IF.
 14763
 14764     IF CM-LF-CURRENT-STATUS = '7'
 14765         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14766             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14767             MOVE ' '            TO DC-OPTION-CODE
 14768             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14769             IF NOT DATE-CONVERSION-ERROR
 14770                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14771                 MOVE AL-UANON   TO LCVCNDTA
 14772             END-IF
 14773         END-IF
 14774     END-IF.
 14775
 14776     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14777         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14778             MOVE ' '            TO DC-OPTION-CODE
 14779             MOVE CM-LF-DEATH-EXIT-DT
 14780                                 TO DC-BIN-DATE-1
 14781             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14782             IF NOT DATE-CONVERSION-ERROR
 14783                 MOVE DC-GREG-DATE-1-EDIT
 14784                                 TO LCVEXITO
 14785             END-IF
 14786         END-IF
 14787     END-IF.
 14788
 14789     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14790         IF CP-REMAINING-TERM-3 = ZEROS
 14791             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 278
* EL130.cbl
 14792         ELSE
 14793             MOVE 'ACTIVE'       TO LCVSTATO
 14794         END-IF
 14795     END-IF.
 14796
 14797     IF CM-LF-CURRENT-STATUS = '2'
 14798        MOVE 'PEND  '            TO LCVSTATO
 14799     END-IF.
 14800     IF CM-LF-CURRENT-STATUS = '3'
 14801        MOVE 'RESTORE'           TO LCVSTATO
 14802     END-IF.
 14803     IF CM-LF-CURRENT-STATUS = '5'
 14804        MOVE 'REISSUE'           TO LCVSTATO
 14805     END-IF.
 14806     IF CM-LF-CURRENT-STATUS = '6'
 14807        MOVE 'LMP DIS'           TO LCVSTATO
 14808     END-IF.
 14809     IF CM-LF-CURRENT-STATUS = '7'
 14810        MOVE 'DEATH  '           TO LCVSTATO
 14811     END-IF.
 14812     IF CM-LF-CURRENT-STATUS = '8'
 14813        MOVE 'CANCEL '           TO LCVSTATO
 14814     END-IF.
 14815     IF CM-LF-CURRENT-STATUS = '9'
 14816        MOVE 'RE-ONLY'           TO LCVSTATO
 14817     END-IF.
 14818     IF CM-LF-CURRENT-STATUS = 'V'
 14819        MOVE 'VOID   '           TO LCVSTATO
 14820     END-IF.
 14821     IF CM-LF-CURRENT-STATUS = 'D'
 14822        MOVE 'DECLINE'           TO LCVSTATO
 14823     END-IF.
 14824
 14825     IF PI-COMPANY-ID = 'CID'
 14826         IF CM-LF-BENEFIT-CD >= '2O' AND
 14827            CM-LF-BENEFIT-CD <= '2V'
 14828             MOVE ER-0878       TO EMI-ERROR
 14829             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14830         END-IF
 14831     END-IF.
 14832
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 279
* EL130.cbl
 14834 7060-FILL-AH-COVERAGE.
 14835
 14836     IF CM-AH-BENEFIT-CD = '00'
 14837         MOVE ZEROS              TO ACVOTRMO
 14838                                    ACVRTRMO
 14839                                    ACVRATEO
 14840                                    ACVBENEO
 14841         MOVE SPACES             TO ACVDSCRO
 14842                                    ACVCDO
 14843                                    ACVKINDO
 14844                                    ACVFORMO
 14845                                    ACVCNDTO
 14846                                    ACVEXITO
 14847                                    ACVSTATO
 14848         IF (CLMTYPEL GREATER THAN ZERO AND
 14849             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14850             MOVE ER-0521     TO EMI-ERROR
 14851             MOVE AL-UABON    TO CLMTYPEA
 14852             MOVE -1          TO CLMTYPEL
 14853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14854             GO TO 7070-BUILD-MAP-FINISH
 14855         ELSE
 14856             GO TO 7070-BUILD-MAP-FINISH
 14857         END-IF
 14858     END-IF.
 14859
 14860     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14861     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14862     MOVE AL-UANON               TO ACVDSCRA
 14863                                    ACVCDA.
 14864     MOVE '5'                    TO WS-REC-TYPE.
 14865     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14866     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14867
 14868     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14869                                    CP-ORIGINAL-TERM.
 14870     MOVE AL-UNNON               TO ACVOTRMA.
 14871
 14872     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14873     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14874     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14875     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14876     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14877     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14878
 14879     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14880     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14881
 14882     IF CM-AH-PREMIUM-RATE NUMERIC
 14883         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14884     ELSE
 14885         MOVE ZEROS              TO ACVRATEO
 14886     END-IF.
 14887
 14888     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14889     MOVE AL-UNNON               TO ACVRATEA
 14890                                    ACVBENEA.
 14891
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 280
* EL130.cbl
 14892     IF CM-POLICY-FORM-NO NOT = SPACES
 14893         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14894     ELSE
 14895         MOVE WS-FORM-HOLD       TO ACVFORMO
 14896         MOVE SPACES TO WS-FORM-HOLD
 14897         MOVE 'A'                TO WS-REC-TYPE
 14898         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14899         IF WS-FORM-HOLD NOT = SPACES
 14900             MOVE WS-FORM-HOLD   TO ACVFORMO
 14901         END-IF
 14902     END-IF.
 14903
 14904     MOVE AL-UANON               TO ACVFORMA.
 14905
 14906     IF CM-AH-CURRENT-STATUS = '8'
 14907         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14908             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14909             MOVE ' '             TO DC-OPTION-CODE
 14910             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14911             IF NOT DATE-CONVERSION-ERROR
 14912                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14913                MOVE AL-UANON    TO ACVCNDTA
 14914             END-IF
 14915         END-IF
 14916     END-IF.
 14917
 14918     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14919         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14920             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14921             MOVE ' '             TO DC-OPTION-CODE
 14922             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14923             IF NOT DATE-CONVERSION-ERROR
 14924                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14925                MOVE AL-UANON            TO ACVCNDTA
 14926             END-IF
 14927         END-IF
 14928     END-IF.
 14929
 14930     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14931         MOVE ' '                TO DC-OPTION-CODE
 14932         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14933         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14934         IF NOT DATE-CONVERSION-ERROR
 14935             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14936         END-IF
 14937     END-IF.
 14938
 14939     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14940         IF CP-REMAINING-TERM-3 = ZEROS
 14941             MOVE 'EXPIRED'      TO ACVSTATO
 14942         ELSE
 14943             MOVE 'ACTIVE'       TO ACVSTATO
 14944         END-IF
 14945     END-IF.
 14946
 14947     IF CM-AH-CURRENT-STATUS = '2'
 14948         MOVE 'PEND  '           TO ACVSTATO
 14949     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 281
* EL130.cbl
 14950     IF CM-AH-CURRENT-STATUS = '3'
 14951         MOVE 'RESTORE'          TO ACVSTATO
 14952     END-IF.
 14953     IF CM-AH-CURRENT-STATUS = '5'
 14954         MOVE 'REISSUE'          TO ACVSTATO
 14955     END-IF.
 14956     IF CM-AH-CURRENT-STATUS = '6'
 14957         MOVE 'LMP DIS'          TO ACVSTATO
 14958     END-IF.
 14959     IF CM-AH-CURRENT-STATUS = '7'
 14960         MOVE 'DEATH  '          TO ACVSTATO
 14961     END-IF.
 14962     IF CM-AH-CURRENT-STATUS = '8'
 14963         MOVE 'CANCEL '          TO ACVSTATO
 14964     END-IF.
 14965     IF CM-AH-CURRENT-STATUS = '9'
 14966         MOVE 'RE-ONLY'          TO ACVSTATO
 14967     END-IF.
 14968     IF CM-AH-CURRENT-STATUS = 'V'
 14969         MOVE 'VOID   '          TO ACVSTATO
 14970     END-IF.
 14971     IF CM-AH-CURRENT-STATUS = 'D'
 14972         MOVE 'DECLINE'          TO ACVSTATO
 14973     END-IF.
 14974
 14975     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 14976        IF CM-ACCOUNT (9:2) = 'BI'
 14977           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14978           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14979           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14980           MOVE CM-STATE         TO CTRLR-STATE
 14981           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14982           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14983           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14984           MOVE 'C'              TO CTRLR-REC-TYPE
 14985
 14986* EXEC CICS READ
 14987*            DATASET  (ELCRTT-DSID)
 14988*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14989*            RIDFLD   (ELCRTT-KEY)
 14990*            RESP     (WS-RESPONSE)
 14991*          END-EXEC
 14992*    MOVE '&"S        E          (  N#00013572' TO DFHEIV0
 14993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14995     MOVE X'204E233030303133353732' TO DFHEIV0(25:11)
 14996     CALL 'kxdfhei1' USING DFHEIV0,
 14997           ELCRTT-DSID,
 14998           DFHEIV20,
 14999           DFHEIV99,
 15000           ELCRTT-KEY,
 15001           DFHEIV99,
 15002           DFHEIV99,
 15003           DFHEIV99
 15004     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15005         DFHEIV20
 15006     MOVE EIBRESP  TO WS-RESPONSE
 15007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 282
* EL130.cbl
 15008           IF WS-RESP-NORMAL
 15009               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15010               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15011               MOVE AL-UANON        TO DIAGA
 15012           END-IF
 15013        END-IF
 15014     END-IF.
 15015
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 283
* EL130.cbl
 15017 7070-BUILD-MAP-FINISH.
 15018     MOVE CM-LOAN-APR            TO APRO.
 15019     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15020     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15021     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15022     MOVE AL-UNNON               TO APRA
 15023                                    PMTFREQA.
 15024     MOVE AL-UANON               TO INDGRPA
 15025                                    PREMTYPA.
 15026
 15027     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15028         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15029         MOVE AL-UANON               TO REINCDA
 15030     END-IF.
 15031
 15032     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15033*        NEXT SENTENCE
 15034         CONTINUE
 15035     ELSE
 15036         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15037         MOVE ' '                TO DC-OPTION-CODE
 15038         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15039         IF NOT DATE-CONVERSION-ERROR
 15040             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15041             MOVE AL-UANON            TO ADDONDTA
 15042         END-IF
 15043     END-IF.
 15044
 15045     IF CLAIM-SWITCH = 'N'
 15046         IF SEXL = ZEROS
 15047             MOVE CM-INSURED-SEX TO SEXO
 15048*            MOVE AL-UANON       TO SEXA
 15049         END-IF
 15050     END-IF.
 15051
 15052     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15053         MOVE CM-MEMBER-NO       TO MEMBERO
 15054         MOVE AL-UANON           TO MEMBERA
 15055     END-IF.
 15056
 15057     IF MAINTI = 'A'
 15058         IF (LOANNOL = ZEROS OR
 15059             EIBAID = DFHPF5)
 15060             MOVE CM-LOAN-NUMBER TO LOANNOO
 15061             MOVE AL-UANON       TO LOANNOA
 15062         ELSE
 15063*            NEXT SENTENCE
 15064             CONTINUE
 15065         END-IF
 15066     ELSE
 15067         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15068         MOVE AL-UANON           TO LOANNOA
 15069     END-IF.
 15070
 15071     IF MAINTI = 'A'
 15072         IF (LOANBALL = ZEROS OR
 15073             EIBAID = DFHPF5)
 15074             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 284
* EL130.cbl
 15075             MOVE AL-UNNON       TO LOANBALA
 15076         ELSE
 15077*            NEXT SENTENCE
 15078             CONTINUE
 15079         END-IF
 15080     ELSE
 15081         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15082         MOVE AL-UNNON           TO LOANBALA
 15083     END-IF.
 15084
 15085     IF CM-PREMIUM-TYPE NOT = '3'
 15086         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15087             PERFORM 7200-PROTECT-CERT-FIELDS
 15088         ELSE
 15089             PERFORM 7300-RESET-KEY-ATTRBS
 15090         END-IF
 15091     ELSE
 15092         PERFORM 7300-RESET-KEY-ATTRBS
 15093     END-IF.
 15094
 15095*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15096*        NEXT SENTENCE
 15097*        CONTINUE
 15098*    ELSE
 15099         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15100*    END-IF.
 15101
 15102 7099-EXIT.
 15103     EXIT.
 15104
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 285
* EL130.cbl
 15106 7100-READ-BENEFIT.
 15107
 15108
 15109* EXEC CICS HANDLE CONDITION
 15110*         NOTFND   (7120-NOT-FOUND)
 15111*    END-EXEC.
 15112*    MOVE '"$I                   ! E #00013678' TO DFHEIV0
 15113     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15115     MOVE X'4520233030303133363738' TO DFHEIV0(25:11)
 15116     CALL 'kxdfhei1' USING DFHEIV0
 15117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15118
 15119
 15120     MOVE SPACES                 TO ELCNTL-KEY.
 15121     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15122     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15123     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15124     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15125
 15126 7105-READ-FILE.
 15127     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15128
 15129     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15130        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15131          GO TO 7120-NOT-FOUND
 15132     END-IF.
 15133
 15134     MOVE 1                      TO SUB.
 15135 7110-LOOP.
 15136     IF SUB = 9
 15137         GO TO 7120-NOT-FOUND
 15138     END-IF.
 15139
 15140     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15141         ADD 1                   TO SUB
 15142         GO TO 7110-LOOP
 15143     END-IF.
 15144
 15145     if ws-rec-type = '4'
 15146        move cf-joint-indicator (sub)
 15147                                 to ws-lf-joint-indicator
 15148     else
 15149        move cf-joint-indicator (sub)
 15150                                 to ws-ah-joint-indicator
 15151     end-if
 15152     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15153     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15154     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15155
 15156     GO TO 7199-EXIT.
 15157
 15158 7120-NOT-FOUND.
 15159     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15160                                    WS-FORM-HOLD.
 15161
 15162 7199-EXIT.
 15163      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 286
* EL130.cbl
 15164
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 287
* EL130.cbl
 15166 7200-PROTECT-CERT-FIELDS.
 15167     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15168                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15169                                LCVFORMA ACVFORMA JNTLNMEA
 15170                                JNTFNMEA JNTINITA.
 15171
 15172     IF CM-LF-CURRENT-STATUS = '2' OR
 15173        CM-AH-CURRENT-STATUS = '2'
 15174         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15175     END-IF.
 15176
 15177     MOVE AL-SANOF TO
 15178            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15179            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15180            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15181            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15182            LCVRATEA   ACVRATEA.
 15183
 15184     MOVE 'S'                    TO CERTMTI.
 15185
 15186 7300-RESET-KEY-ATTRBS.
 15187     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15188                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15189                                LCVFORMA ACVFORMA JNTLNMEA
 15190                                JNTFNMEA JNTINITA.
 15191
 15192     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15193         MOVE AL-SANOF           TO REINCDA
 15194     END-IF.
 15195
 15196     MOVE 'S'                    TO CERTMTI.
 15197
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 288
* EL130.cbl
 15199 7400-READ-STATE.
 15200
 15201
 15202* EXEC CICS HANDLE CONDITION
 15203*         NOTFND   (7499-EXIT)
 15204*    END-EXEC.
 15205*    MOVE '"$I                   ! F #00013763' TO DFHEIV0
 15206     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15208     MOVE X'4620233030303133373633' TO DFHEIV0(25:11)
 15209     CALL 'kxdfhei1' USING DFHEIV0
 15210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15211
 15212
 15213     MOVE SPACES                 TO ELCNTL-KEY.
 15214     MOVE CM-STATE               TO CNTL-ACCESS.
 15215     MOVE '3'                    TO CNTL-REC-TYPE.
 15216     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15217     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15218
 15219     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15220
 15221     MOVE 1                      TO SUB.
 15222
 15223 7410-LOOP.
 15224     IF SUB = 21
 15225        GO TO 7499-EXIT
 15226     END-IF.
 15227
 15228*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15229*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15230*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15231*        GO TO 7499-EXIT.
 15232
 15233     ADD 1                       TO SUB.
 15234     GO TO 7410-LOOP.
 15235
 15236 7499-EXIT.
 15237      EXIT.
 15238
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 289
* EL130.cbl
 15240 7500-BROWSE-FOR-DUPLICATE.
 15241
 15242     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15243
 15244
 15245
 15246* EXEC CICS HANDLE CONDITION
 15247*        NOTFND   (7500-EXIT)
 15248*        DUPKEY   (7500-DUPLICATE-KEY)
 15249*        ENDFILE  (7500-EXIT)
 15250*    END-EXEC.
 15251*    MOVE '"$I$''                 ! G #00013799' TO DFHEIV0
 15252     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15254     MOVE X'4720233030303133373939' TO DFHEIV0(25:11)
 15255     CALL 'kxdfhei1' USING DFHEIV0
 15256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15257
 15258
 15259
 15260
 15261* EXEC CICS STARTBR
 15262*        DATASET    (ELMSTR5-DSID)
 15263*        RIDFLD     (ELMSTR5-KEY)
 15264*    END-EXEC.
 15265     MOVE 0
 15266       TO DFHEIV11
 15267*    MOVE '&,         G          &   #00013806' TO DFHEIV0
 15268     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15269     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15270     MOVE X'2020233030303133383036' TO DFHEIV0(25:11)
 15271     CALL 'kxdfhei1' USING DFHEIV0,
 15272           ELMSTR5-DSID,
 15273           ELMSTR5-KEY,
 15274           DFHEIV99,
 15275           DFHEIV11,
 15276           DFHEIV99
 15277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15278
 15279
 15280
 15281
 15282* EXEC CICS HANDLE CONDITION
 15283*        ENDFILE  (7500-END-BROWSE)
 15284*    END-EXEC.
 15285*    MOVE '"$''                   ! H #00013812' TO DFHEIV0
 15286     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15288     MOVE X'4820233030303133383132' TO DFHEIV0(25:11)
 15289     CALL 'kxdfhei1' USING DFHEIV0
 15290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15291
 15292
 15293 7500-READ-CLAIM-LOOP.
 15294
 15295
 15296
 15297* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 290
* EL130.cbl
 15298*        DATASET   (ELMSTR5-DSID)
 15299*        SET       (ADDRESS OF CLAIM-MASTER)
 15300*        RIDFLD    (ELMSTR5-KEY)
 15301*    END-EXEC.
 15302     MOVE 0
 15303       TO DFHEIV11
 15304*    MOVE '&.S                   )   #00013819' TO DFHEIV0
 15305     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15306     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15307     MOVE X'2020233030303133383139' TO DFHEIV0(25:11)
 15308     CALL 'kxdfhei1' USING DFHEIV0,
 15309           ELMSTR5-DSID,
 15310           DFHEIV20,
 15311           DFHEIV99,
 15312           ELMSTR5-KEY,
 15313           DFHEIV99,
 15314           DFHEIV11,
 15315           DFHEIV99,
 15316           DFHEIV99
 15317     SET ADDRESS OF CLAIM-MASTER TO
 15318         DFHEIV20
 15319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15320
 15321
 15322 7500-DUPLICATE-KEY.
 15323
 15324     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15325        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15326        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15327        CL-CERT-STATE     NOT = CM-STATE       OR
 15328        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15329        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15330        CL-CERT-NO        NOT = CM-CERT-NO
 15331           GO TO 7500-CHECK-MATCH-COUNT
 15332     END-IF.
 15333
 15334     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15335
 15336     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15337        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15338        GO TO 7500-END-BROWSE
 15339     ELSE
 15340        GO TO 7500-READ-CLAIM-LOOP
 15341     END-IF.
 15342
 15343 7500-CHECK-MATCH-COUNT.
 15344
 15345     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15346        CL-CERT-NO    = CM-CERT-NO
 15347          GO TO 7500-READ-CLAIM-LOOP
 15348     END-IF.
 15349
 15350 7500-END-BROWSE.
 15351
 15352
 15353
 15354* EXEC CICS ENDBR
 15355*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 291
* EL130.cbl
 15356*    END-EXEC.
 15357     MOVE 0
 15358       TO DFHEIV11
 15359*    MOVE '&2                    $   #00013856' TO DFHEIV0
 15360     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15362     MOVE X'2020233030303133383536' TO DFHEIV0(25:11)
 15363     CALL 'kxdfhei1' USING DFHEIV0,
 15364           ELMSTR5-DSID,
 15365           DFHEIV11,
 15366           DFHEIV99
 15367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15368
 15369
 15370 7500-EXIT.
 15371     EXIT.
 15372
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 292
* EL130.cbl
 15374 7550-FALL-THRU-PARA.
 15375
 15376
 15377
 15378* EXEC CICS DUMP
 15379*         DUMPCODE ('E130')
 15380*         TASK
 15381*    END-EXEC.
 15382     MOVE 'E130' TO DFHEIV5
 15383*    MOVE '<"   T                $   #00013867' TO DFHEIV0
 15384     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15385     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15386     MOVE X'2020233030303133383637' TO DFHEIV0(25:11)
 15387     CALL 'kxdfhei1' USING DFHEIV0,
 15388           DFHEIV5,
 15389           DFHEIV99,
 15390           DFHEIV99
 15391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15392
 15393
 15394
 15395
 15396* EXEC CICS RETURN
 15397*    END-EXEC.
 15398*    MOVE '.(                    ''   #00013873' TO DFHEIV0
 15399     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15401     MOVE X'2020233030303133383733' TO DFHEIV0(25:11)
 15402     CALL 'kxdfhei1' USING DFHEIV0,
 15403           DFHEIV99,
 15404           DFHEIV99,
 15405           DFHEIV99,
 15406           DFHEIV99,
 15407           DFHEIV99,
 15408           DFHEIV99
 15409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15410
 15411
 15412 7600-BROWSE-CLAIM.
 15413
 15414
 15415
 15416* EXEC CICS READ
 15417*        DATASET(ELMSTR-DSID)
 15418*        SET    (ADDRESS OF CLAIM-MASTER)
 15419*        RIDFLD (ELMSTR-KEY)
 15420*        GENERIC
 15421*        EQUAL
 15422*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15423*    END-EXEC.
 15424*    MOVE '&"S  KG    E          (   #00013879' TO DFHEIV0
 15425     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15427     MOVE X'2020233030303133383739' TO DFHEIV0(25:11)
 15428     CALL 'kxdfhei1' USING DFHEIV0,
 15429           ELMSTR-DSID,
 15430           DFHEIV20,
 15431           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 293
* EL130.cbl
 15432           ELMSTR-KEY,
 15433           ELMSTR-GENERIC-LENGTH,
 15434           DFHEIV99,
 15435           DFHEIV99
 15436     SET ADDRESS OF CLAIM-MASTER TO
 15437         DFHEIV20
 15438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15439
 15440
 15441     MOVE CL-CERT-PRIME          TO CERTNOI.
 15442     MOVE CL-CERT-SFX            TO SUFXI.
 15443
 15444 7610-BROWSE-CLAIM-LOOP.
 15445
 15446     MOVE LOW-VALUES             TO BCERT1O
 15447                                    BSUFX1O
 15448                                    BCERT2O
 15449                                    BSUFX2O
 15450                                    BCERT3O
 15451                                    BSUFX3O
 15452                                    BCERT4O
 15453                                    BSUFX4O
 15454                                    BCERT5O
 15455                                    BSUFX5O.
 15456
 15457     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15458
 15459
 15460
 15461* EXEC CICS HANDLE CONDITION
 15462*        ENDFILE  (7630-END-BROWSE)
 15463*    END-EXEC.
 15464*    MOVE '"$''                   ! I #00013907' TO DFHEIV0
 15465     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15467     MOVE X'4920233030303133393037' TO DFHEIV0(25:11)
 15468     CALL 'kxdfhei1' USING DFHEIV0
 15469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15470
 15471
 15472
 15473
 15474* EXEC CICS STARTBR
 15475*        DATASET    (ELMSTR-DSID)
 15476*        RIDFLD     (ELMSTR-KEY)
 15477*    END-EXEC.
 15478     MOVE 0
 15479       TO DFHEIV11
 15480*    MOVE '&,         G          &   #00013912' TO DFHEIV0
 15481     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15482     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15483     MOVE X'2020233030303133393132' TO DFHEIV0(25:11)
 15484     CALL 'kxdfhei1' USING DFHEIV0,
 15485           ELMSTR-DSID,
 15486           ELMSTR-KEY,
 15487           DFHEIV99,
 15488           DFHEIV11,
 15489           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 294
* EL130.cbl
 15490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15491
 15492
 15493     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15494
 15495 7620-READ-CLAIM-LOOP.
 15496
 15497
 15498
 15499* EXEC CICS READNEXT
 15500*        DATASET   (ELMSTR-DSID)
 15501*        SET       (ADDRESS OF CLAIM-MASTER)
 15502*        RIDFLD    (ELMSTR-KEY)
 15503*    END-EXEC.
 15504     MOVE 0
 15505       TO DFHEIV11
 15506*    MOVE '&.S                   )   #00013922' TO DFHEIV0
 15507     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15508     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15509     MOVE X'2020233030303133393232' TO DFHEIV0(25:11)
 15510     CALL 'kxdfhei1' USING DFHEIV0,
 15511           ELMSTR-DSID,
 15512           DFHEIV20,
 15513           DFHEIV99,
 15514           ELMSTR-KEY,
 15515           DFHEIV99,
 15516           DFHEIV11,
 15517           DFHEIV99,
 15518           DFHEIV99
 15519     SET ADDRESS OF CLAIM-MASTER TO
 15520         DFHEIV20
 15521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15522
 15523
 15524     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15525        CL-CARRIER     NOT = CLMCARRI       OR
 15526        CL-CLAIM-NO    NOT = CLMNOI
 15527          GO TO 7630-END-BROWSE
 15528     END-IF.
 15529
 15530     IF WS-ASSOCIATED-CERTS = 1
 15531         MOVE CL-CERT-PRIME      TO BCERT1O
 15532         MOVE CL-CERT-SFX        TO BSUFX1O
 15533     END-IF.
 15534
 15535     IF WS-ASSOCIATED-CERTS = 2
 15536         MOVE CL-CERT-PRIME      TO BCERT2O
 15537         MOVE CL-CERT-SFX        TO BSUFX2O
 15538     END-IF.
 15539
 15540     IF WS-ASSOCIATED-CERTS = 3
 15541         MOVE CL-CERT-PRIME      TO BCERT3O
 15542         MOVE CL-CERT-SFX        TO BSUFX3O
 15543     END-IF.
 15544
 15545     IF WS-ASSOCIATED-CERTS = 4
 15546         MOVE CL-CERT-PRIME      TO BCERT4O
 15547         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 295
* EL130.cbl
 15548     END-IF.
 15549
 15550     IF WS-ASSOCIATED-CERTS = 5
 15551         MOVE CL-CERT-PRIME      TO BCERT5O
 15552         MOVE CL-CERT-SFX        TO BSUFX5O
 15553     ELSE
 15554         ADD +1                  TO WS-ASSOCIATED-CERTS
 15555         GO TO 7620-READ-CLAIM-LOOP
 15556     END-IF.
 15557
 15558 7630-END-BROWSE.
 15559
 15560
 15561
 15562* EXEC CICS ENDBR
 15563*        DATASET   (ELMSTR-DSID)
 15564*    END-EXEC.
 15565     MOVE 0
 15566       TO DFHEIV11
 15567*    MOVE '&2                    $   #00013965' TO DFHEIV0
 15568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15570     MOVE X'2020233030303133393635' TO DFHEIV0(25:11)
 15571     CALL 'kxdfhei1' USING DFHEIV0,
 15572           ELMSTR-DSID,
 15573           DFHEIV11,
 15574           DFHEIV99
 15575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15576
 15577
 15578 7640-HIGHLIGHT-CERT-DISPLAYED.
 15579
 15580     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15581     MOVE AL-SANON               TO BCERT1A
 15582                                    BSUFX1A
 15583                                    BCERT2A
 15584                                    BSUFX2A
 15585                                    BCERT3A
 15586                                    BSUFX3A
 15587                                    BCERT4A
 15588                                    BSUFX4A
 15589                                    BCERT5A
 15590                                    BSUFX5A.
 15591
 15592     IF BCERT1O = CERTNOI AND
 15593        BSUFX1O = SUFXI
 15594            MOVE AL-SABON        TO BCERT1A
 15595                                    BSUFX1A
 15596     END-IF.
 15597
 15598     IF BCERT2O = CERTNOI AND
 15599        BSUFX2O = SUFXI
 15600            MOVE AL-SABON        TO BCERT2A
 15601                                    BSUFX2A
 15602     END-IF.
 15603
 15604     IF BCERT3O = CERTNOI AND
 15605        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 296
* EL130.cbl
 15606            MOVE AL-SABON        TO BCERT3A
 15607                                    BSUFX3A
 15608     END-IF.
 15609
 15610     IF BCERT4O = CERTNOI AND
 15611        BSUFX4O = SUFXI
 15612            MOVE AL-SABON        TO BCERT4A
 15613                                    BSUFX4A
 15614     END-IF.
 15615
 15616     IF BCERT5O = CERTNOI AND
 15617        BSUFX5O = SUFXI
 15618            MOVE AL-SABON        TO BCERT5A
 15619                                    BSUFX5A
 15620     END-IF.
 15621
 15622 7699-EXIT.
 15623     EXIT.
 15624
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 297
* EL130.cbl
 15626 7700-CHECK-SEQUENCE.
 15627
 15628
 15629
 15630* EXEC CICS HANDLE CONDITION
 15631*        ENDFILE  (7799-EXIT)
 15632*        NOTFND   (7799-EXIT)
 15633*    END-EXEC.
 15634*    MOVE '"$''I                  ! J #00014020' TO DFHEIV0
 15635     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15637     MOVE X'4A20233030303134303230' TO DFHEIV0(25:11)
 15638     CALL 'kxdfhei1' USING DFHEIV0
 15639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15640
 15641
 15642
 15643
 15644* EXEC CICS READ
 15645*        DATASET(ELMSTR-DSID)
 15646*        SET    (ADDRESS OF CLAIM-MASTER)
 15647*        RIDFLD (ELMSTR-KEY)
 15648*        GENERIC
 15649*        EQUAL
 15650*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15651*    END-EXEC.
 15652*    MOVE '&"S  KG    E          (   #00014026' TO DFHEIV0
 15653     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15655     MOVE X'2020233030303134303236' TO DFHEIV0(25:11)
 15656     CALL 'kxdfhei1' USING DFHEIV0,
 15657           ELMSTR-DSID,
 15658           DFHEIV20,
 15659           DFHEIV99,
 15660           ELMSTR-KEY,
 15661           ELMSTR-GENERIC-LENGTH,
 15662           DFHEIV99,
 15663           DFHEIV99
 15664     SET ADDRESS OF CLAIM-MASTER TO
 15665         DFHEIV20
 15666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15667
 15668
 15669     COMPUTE WS-ASSOC-CERT-TOTAL =
 15670             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15671
 15672     GO TO 7799-EXIT.
 15673
 15674 7710-RESEQUENCE-CLAIMS.
 15675
 15676
 15677
 15678* EXEC CICS HANDLE CONDITION
 15679*        ENDFILE  (7790-END-BROWSE)
 15680*    END-EXEC.
 15681*    MOVE '"$''                   ! K #00014043' TO DFHEIV0
 15682     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 298
* EL130.cbl
 15684     MOVE X'4B20233030303134303433' TO DFHEIV0(25:11)
 15685     CALL 'kxdfhei1' USING DFHEIV0
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689
 15690
 15691* EXEC CICS STARTBR
 15692*        DATASET    (ELMSTR-DSID)
 15693*        RIDFLD     (ELMSTR-KEY)
 15694*    END-EXEC.
 15695     MOVE 0
 15696       TO DFHEIV11
 15697*    MOVE '&,         G          &   #00014048' TO DFHEIV0
 15698     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15700     MOVE X'2020233030303134303438' TO DFHEIV0(25:11)
 15701     CALL 'kxdfhei1' USING DFHEIV0,
 15702           ELMSTR-DSID,
 15703           ELMSTR-KEY,
 15704           DFHEIV99,
 15705           DFHEIV11,
 15706           DFHEIV99
 15707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15708
 15709
 15710     ADD +1 TO WS-ASSOC-CERT-SEQU
 15711               WS-READNEXT-SWITCH.
 15712
 15713 7720-READ-CLAIM-LOOP.
 15714
 15715
 15716
 15717* EXEC CICS READNEXT
 15718*        DATASET   (ELMSTR-DSID)
 15719*        SET       (ADDRESS OF CLAIM-MASTER)
 15720*        RIDFLD    (ELMSTR-KEY)
 15721*    END-EXEC.
 15722     MOVE 0
 15723       TO DFHEIV11
 15724*    MOVE '&.S                   )   #00014059' TO DFHEIV0
 15725     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15726     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15727     MOVE X'2020233030303134303539' TO DFHEIV0(25:11)
 15728     CALL 'kxdfhei1' USING DFHEIV0,
 15729           ELMSTR-DSID,
 15730           DFHEIV20,
 15731           DFHEIV99,
 15732           ELMSTR-KEY,
 15733           DFHEIV99,
 15734           DFHEIV11,
 15735           DFHEIV99,
 15736           DFHEIV99
 15737     SET ADDRESS OF CLAIM-MASTER TO
 15738         DFHEIV20
 15739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15740
 15741
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 299
* EL130.cbl
 15742     IF WS-READNEXT-SWITCH = 1
 15743         ADD 1 TO WS-READNEXT-SWITCH
 15744         GO TO 7720-READ-CLAIM-LOOP
 15745     END-IF.
 15746
 15747 7730-END-BROWSE.
 15748
 15749
 15750
 15751* EXEC CICS ENDBR
 15752*        DATASET   (ELMSTR-DSID)
 15753*    END-EXEC.
 15754     MOVE 0
 15755       TO DFHEIV11
 15756*    MOVE '&2                    $   #00014073' TO DFHEIV0
 15757     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15759     MOVE X'2020233030303134303733' TO DFHEIV0(25:11)
 15760     CALL 'kxdfhei1' USING DFHEIV0,
 15761           ELMSTR-DSID,
 15762           DFHEIV11,
 15763           DFHEIV99
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
 15766
 15767 7740-READ-CLAIM-UPDATE.
 15768
 15769     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15770        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15771        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15772          GO TO 7799-EXIT
 15773     ELSE
 15774          MOVE ZERO              TO WS-READNEXT-SWITCH
 15775     END-IF.
 15776
 15777
 15778
 15779* EXEC CICS READ
 15780*        DATASET(ELMSTR-DSID)
 15781*        SET    (ADDRESS OF CLAIM-MASTER)
 15782*        RIDFLD (ELMSTR-KEY)
 15783*        UPDATE
 15784*    END-EXEC.
 15785*    MOVE '&"S        EU         (   #00014088' TO DFHEIV0
 15786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15787     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15788     MOVE X'2020233030303134303838' TO DFHEIV0(25:11)
 15789     CALL 'kxdfhei1' USING DFHEIV0,
 15790           ELMSTR-DSID,
 15791           DFHEIV20,
 15792           DFHEIV99,
 15793           ELMSTR-KEY,
 15794           DFHEIV99,
 15795           DFHEIV99,
 15796           DFHEIV99
 15797     SET ADDRESS OF CLAIM-MASTER TO
 15798         DFHEIV20
 15799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 300
* EL130.cbl
 15800
 15801
 15802     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15803     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15804
 15805
 15806
 15807* EXEC CICS REWRITE
 15808*         DATASET     (ELMSTR-DSID)
 15809*         FROM        (CLAIM-MASTER)
 15810*    END-EXEC.
 15811     MOVE LENGTH OF
 15812      CLAIM-MASTER
 15813       TO DFHEIV11
 15814*    MOVE '&& L                  %   #00014099' TO DFHEIV0
 15815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15817     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 15818     CALL 'kxdfhei1' USING DFHEIV0,
 15819           ELMSTR-DSID,
 15820           CLAIM-MASTER,
 15821           DFHEIV11,
 15822           DFHEIV99
 15823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15824
 15825
 15826     GO TO 7710-RESEQUENCE-CLAIMS.
 15827
 15828 7790-END-BROWSE.
 15829
 15830
 15831
 15832* EXEC CICS ENDBR
 15833*        DATASET   (ELMSTR-DSID)
 15834*    END-EXEC.
 15835     MOVE 0
 15836       TO DFHEIV11
 15837*    MOVE '&2                    $   #00014109' TO DFHEIV0
 15838     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15839     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15840     MOVE X'2020233030303134313039' TO DFHEIV0(25:11)
 15841     CALL 'kxdfhei1' USING DFHEIV0,
 15842           ELMSTR-DSID,
 15843           DFHEIV11,
 15844           DFHEIV99
 15845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15846
 15847
 15848 7799-EXIT.
 15849     EXIT.
 15850
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 301
* EL130.cbl
 15852************************************************
 15853*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15854************************************************
 15855
 15856 7900-READ-ACTV-UPDATE.
 15857     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15858     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15859     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15860     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15861     MOVE +0                     TO TRLR-SEQ-NO.
 15862     MOVE '1'                    TO TRLR-TYPE.
 15863     GO TO 7900-READ-TRAILER-UPDATE.
 15864
 15865 7900-READ-NINETY-UPDATE.
 15866     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15867     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15868     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15869     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15870     MOVE +90                    TO TRLR-SEQ-NO.
 15871     MOVE '6'                    TO TRLR-TYPE.
 15872
 15873 7900-READ-TRAILER-UPDATE.
 15874
 15875
 15876* EXEC CICS READ  UPDATE
 15877*        DATASET    (ELTRLR-DSID)
 15878*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15879*        RIDFLD     (ELTRLR-KEY)
 15880*    END-EXEC.
 15881*    MOVE '&"S        EU         (   #00014140' TO DFHEIV0
 15882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15884     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 15885     CALL 'kxdfhei1' USING DFHEIV0,
 15886           ELTRLR-DSID,
 15887           DFHEIV20,
 15888           DFHEIV99,
 15889           ELTRLR-KEY,
 15890           DFHEIV99,
 15891           DFHEIV99,
 15892           DFHEIV99
 15893     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15894         DFHEIV20
 15895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15896
 15897
 15898 7900-EXIT.
 15899      EXIT.
 15900
 15901 7910-READ-ACTV.
 15902     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15903     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15904     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15905     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15906     MOVE +0                     TO TRLR-SEQ-NO.
 15907     MOVE '1'                    TO TRLR-TYPE.
 15908     GO TO 7910-READ-TRAILER.
 15909
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 302
* EL130.cbl
 15910 7910-READ-NINETY.
 15911     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15912     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15913     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15914     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15915     MOVE +90                    TO TRLR-SEQ-NO.
 15916     MOVE '6'                    TO TRLR-TYPE.
 15917
 15918 7910-READ-TRAILER.
 15919     MOVE 'TRLR'                 TO FILE-SWITCH.
 15920
 15921
 15922
 15923* EXEC CICS READ
 15924*        DATASET   (ELTRLR-DSID)
 15925*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15926*        RIDFLD    (ELTRLR-KEY)
 15927*    END-EXEC.
 15928*    MOVE '&"S        E          (   #00014170' TO DFHEIV0
 15929     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15931     MOVE X'2020233030303134313730' TO DFHEIV0(25:11)
 15932     CALL 'kxdfhei1' USING DFHEIV0,
 15933           ELTRLR-DSID,
 15934           DFHEIV20,
 15935           DFHEIV99,
 15936           ELTRLR-KEY,
 15937           DFHEIV99,
 15938           DFHEIV99,
 15939           DFHEIV99
 15940     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15941         DFHEIV20
 15942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15943
 15944
 15945 7910-EXIT.
 15946      EXIT.
 15947
 15948 7915-REWRITE-TRAILER.
 15949
 15950
 15951* EXEC CICS REWRITE
 15952*        DATASET   (ELTRLR-DSID)
 15953*        FROM      (ACTIVITY-TRAILERS)
 15954*    END-EXEC.
 15955     MOVE LENGTH OF
 15956      ACTIVITY-TRAILERS
 15957       TO DFHEIV11
 15958*    MOVE '&& L                  %   #00014181' TO DFHEIV0
 15959     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15960     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15961     MOVE X'2020233030303134313831' TO DFHEIV0(25:11)
 15962     CALL 'kxdfhei1' USING DFHEIV0,
 15963           ELTRLR-DSID,
 15964           ACTIVITY-TRAILERS,
 15965           DFHEIV11,
 15966           DFHEIV99
 15967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 303
* EL130.cbl
 15968
 15969
 15970 7915-EXIT.
 15971      EXIT.
 15972
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 304
* EL130.cbl
 15974********************************************
 15975*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15976********************************************
 15977
 15978 7920-READ-CLAIM-UPDATE.
 15979
 15980
 15981
 15982* EXEC CICS READ
 15983*        UPDATE
 15984*        DATASET   (ELMSTR-DSID)
 15985*        SET       (ADDRESS OF CLAIM-MASTER)
 15986*        RIDFLD    (ELMSTR-KEY)
 15987*    END-EXEC.
 15988*    MOVE '&"S        EU         (   #00014197' TO DFHEIV0
 15989     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15990     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15991     MOVE X'2020233030303134313937' TO DFHEIV0(25:11)
 15992     CALL 'kxdfhei1' USING DFHEIV0,
 15993           ELMSTR-DSID,
 15994           DFHEIV20,
 15995           DFHEIV99,
 15996           ELMSTR-KEY,
 15997           DFHEIV99,
 15998           DFHEIV99,
 15999           DFHEIV99
 16000     SET ADDRESS OF CLAIM-MASTER TO
 16001         DFHEIV20
 16002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16003
 16004
 16005 7920-EXIT.
 16006      EXIT.
 16007
 16008 7950-READ-CLAIM.
 16009
 16010
 16011* EXEC CICS READ
 16012*        DATASET   (ELMSTR-DSID)
 16013*        SET       (ADDRESS OF CLAIM-MASTER)
 16014*        RIDFLD    (ELMSTR-KEY)
 16015*    END-EXEC.
 16016*    MOVE '&"S        E          (   #00014209' TO DFHEIV0
 16017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16019     MOVE X'2020233030303134323039' TO DFHEIV0(25:11)
 16020     CALL 'kxdfhei1' USING DFHEIV0,
 16021           ELMSTR-DSID,
 16022           DFHEIV20,
 16023           DFHEIV99,
 16024           ELMSTR-KEY,
 16025           DFHEIV99,
 16026           DFHEIV99,
 16027           DFHEIV99
 16028     SET ADDRESS OF CLAIM-MASTER TO
 16029         DFHEIV20
 16030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16031
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 305
* EL130.cbl
 16032
 16033 7950-EXIT.
 16034      EXIT.
 16035
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 306
* EL130.cbl
 16037***************************************
 16038*  I/O REQUESTS AGAINST CONTROL FILE  *
 16039***************************************
 16040
 16041 7960-READ-CNTL-UPDATE.
 16042
 16043
 16044* EXEC CICS READ
 16045*        UPDATE
 16046*        DATASET  (ELCNTL-DSID)
 16047*        SET      (ADDRESS OF CONTROL-FILE)
 16048*        RIDFLD   (ELCNTL-KEY)
 16049*    END-EXEC.
 16050*    MOVE '&"S        EU         (   #00014225' TO DFHEIV0
 16051     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16052     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16053     MOVE X'2020233030303134323235' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0,
 16055           ELCNTL-DSID,
 16056           DFHEIV20,
 16057           DFHEIV99,
 16058           ELCNTL-KEY,
 16059           DFHEIV99,
 16060           DFHEIV99,
 16061           DFHEIV99
 16062     SET ADDRESS OF CONTROL-FILE TO
 16063         DFHEIV20
 16064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16065
 16066
 16067 7960-EXIT.
 16068      EXIT.
 16069
 16070 7970-READ-CNTL.
 16071
 16072
 16073* EXEC CICS READ
 16074*        DATASET  (ELCNTL-DSID)
 16075*        SET      (ADDRESS OF CONTROL-FILE)
 16076*        RIDFLD   (ELCNTL-KEY)
 16077*    END-EXEC.
 16078*    MOVE '&"S        E          (   #00014237' TO DFHEIV0
 16079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303134323337' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           ELCNTL-DSID,
 16084           DFHEIV20,
 16085           DFHEIV99,
 16086           ELCNTL-KEY,
 16087           DFHEIV99,
 16088           DFHEIV99,
 16089           DFHEIV99
 16090     SET ADDRESS OF CONTROL-FILE TO
 16091         DFHEIV20
 16092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16093
 16094
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 307
* EL130.cbl
 16095 7970-EXIT.
 16096      EXIT.
 16097
 16098 7975-READ-CNTL-GTEQ.
 16099
 16100
 16101* EXEC CICS READ
 16102*         DATASET   (ELCNTL-DSID)
 16103*         SET       (ADDRESS OF CONTROL-FILE)
 16104*         RIDFLD    (ELCNTL-KEY)
 16105*         GTEQ
 16106*     END-EXEC.
 16107*    MOVE '&"S        G          (   #00014248' TO DFHEIV0
 16108     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16110     MOVE X'2020233030303134323438' TO DFHEIV0(25:11)
 16111     CALL 'kxdfhei1' USING DFHEIV0,
 16112           ELCNTL-DSID,
 16113           DFHEIV20,
 16114           DFHEIV99,
 16115           ELCNTL-KEY,
 16116           DFHEIV99,
 16117           DFHEIV99,
 16118           DFHEIV99
 16119     SET ADDRESS OF CONTROL-FILE TO
 16120         DFHEIV20
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16122
 16123
 16124 7975-EXIT.
 16125      EXIT.
 16126
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 308
* EL130.cbl
 16128**************************************************
 16129*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16130**************************************************
 16131
 16132 7980-READ-CERT5.
 16133
 16134
 16135* EXEC CICS READ
 16136*         DATASET  (ELCERT5-DSID)
 16137*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16138*         RIDFLD   (ELCERT-KEY-5)
 16139*     END-EXEC.
 16140*    MOVE '&"S        E          (   #00014265' TO DFHEIV0
 16141     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16143     MOVE X'2020233030303134323635' TO DFHEIV0(25:11)
 16144     CALL 'kxdfhei1' USING DFHEIV0,
 16145           ELCERT5-DSID,
 16146           DFHEIV20,
 16147           DFHEIV99,
 16148           ELCERT-KEY-5,
 16149           DFHEIV99,
 16150           DFHEIV99,
 16151           DFHEIV99
 16152     SET ADDRESS OF CERTIFICATE-MASTER TO
 16153         DFHEIV20
 16154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16155
 16156
 16157 7980-EXIT.
 16158      EXIT.
 16159
 16160 7930-READ-CERT-UPDATE.
 16161
 16162
 16163* EXEC CICS READ
 16164*        DATASET  (ELCERT-DSID)
 16165*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16166*        RIDFLD   (ELCERT-KEY)
 16167*        UPDATE
 16168*    END-EXEC.
 16169*    MOVE '&"S        EU         (   #00014276' TO DFHEIV0
 16170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16171     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16172     MOVE X'2020233030303134323736' TO DFHEIV0(25:11)
 16173     CALL 'kxdfhei1' USING DFHEIV0,
 16174           ELCERT-DSID,
 16175           DFHEIV20,
 16176           DFHEIV99,
 16177           ELCERT-KEY,
 16178           DFHEIV99,
 16179           DFHEIV99,
 16180           DFHEIV99
 16181     SET ADDRESS OF CERTIFICATE-MASTER TO
 16182         DFHEIV20
 16183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16184
 16185
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 309
* EL130.cbl
 16186 7930-EXIT.
 16187      EXIT.
 16188
 16189 7940-READ-CERT.
 16190
 16191
 16192* EXEC CICS READ
 16193*        DATASET  (ELCERT-DSID)
 16194*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16195*        RIDFLD   (ELCERT-KEY)
 16196*    END-EXEC.
 16197*    MOVE '&"S        E          (   #00014288' TO DFHEIV0
 16198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16200     MOVE X'2020233030303134323838' TO DFHEIV0(25:11)
 16201     CALL 'kxdfhei1' USING DFHEIV0,
 16202           ELCERT-DSID,
 16203           DFHEIV20,
 16204           DFHEIV99,
 16205           ELCERT-KEY,
 16206           DFHEIV99,
 16207           DFHEIV99,
 16208           DFHEIV99
 16209     SET ADDRESS OF CERTIFICATE-MASTER TO
 16210         DFHEIV20
 16211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16212
 16213
 16214 7940-EXIT.
 16215      EXIT.
 16216
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 310
* EL130.cbl
 16218**************************************************
 16219*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16220**************************************************
 16221
 16222 7991-READ-BENE.
 16223
 16224
 16225* EXEC CICS READ
 16226*         DATASET   (ELBENE-DSID)
 16227*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16228*         RIDFLD    (ELBENE-KEY)
 16229*     END-EXEC.
 16230*    MOVE '&"S        E          (   #00014304' TO DFHEIV0
 16231     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16233     MOVE X'2020233030303134333034' TO DFHEIV0(25:11)
 16234     CALL 'kxdfhei1' USING DFHEIV0,
 16235           ELBENE-DSID,
 16236           DFHEIV20,
 16237           DFHEIV99,
 16238           ELBENE-KEY,
 16239           DFHEIV99,
 16240           DFHEIV99,
 16241           DFHEIV99
 16242     SET ADDRESS OF BENEFICIARY-MASTER TO
 16243         DFHEIV20
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
 16247 7991-EXIT.
 16248      EXIT.
 16249
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 311
* EL130.cbl
 16251**************************************************
 16252*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16253**************************************************
 16254
 16255 7992-READ-REIN.
 16256
 16257
 16258
 16259* EXEC CICS HANDLE CONDITION
 16260*        NOTFND   (7992-NOT-FOUND)
 16261*    END-EXEC.
 16262*    MOVE '"$I                   ! L #00014321' TO DFHEIV0
 16263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16265     MOVE X'4C20233030303134333231' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0
 16267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16268
 16269
 16270
 16271
 16272* EXEC CICS READ
 16273*        DATASET   (ERREIN-DSID)
 16274*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16275*        RIDFLD    (ERREIN-KEY)
 16276*    END-EXEC.
 16277*    MOVE '&"S        E          (   #00014326' TO DFHEIV0
 16278     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16280     MOVE X'2020233030303134333236' TO DFHEIV0(25:11)
 16281     CALL 'kxdfhei1' USING DFHEIV0,
 16282           ERREIN-DSID,
 16283           DFHEIV20,
 16284           DFHEIV99,
 16285           ERREIN-KEY,
 16286           DFHEIV99,
 16287           DFHEIV99,
 16288           DFHEIV99
 16289     SET ADDRESS OF REINSURANCE-RECORD TO
 16290         DFHEIV20
 16291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16292
 16293
 16294     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16295
 16296     GO TO 7992-EXIT.
 16297
 16298 7992-NOT-FOUND.
 16299     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16300
 16301 7992-EXIT.
 16302     EXIT.
 16303
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 312
* EL130.cbl
 16305 8000-LOAD-ERROR-MESSAGES.
 16306     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16307
 16308     IF EMI-NO-ERRORS
 16309         GO TO 8000-EXIT
 16310     END-IF.
 16311
 16312     perform varying e1 from +1 by +1 until e1 > +3
 16313        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16314                                or '1655' or '1660'
 16315           move 'W'              to emi-severity (e1)
 16316        end-if
 16317     end-perform
 16318     IF EMI-NUMBER-OF-LINES = 1
 16319         MOVE EMI-LINE1          TO ERRMSG1O
 16320         GO TO 8000-EXIT
 16321     END-IF.
 16322
 16323     IF EMI-NUMBER-OF-LINES = 2
 16324          MOVE EMI-LINE1         TO ERRMSG1O
 16325          MOVE EMI-LINE2         TO ERRMSG2O
 16326          GO TO 8000-EXIT
 16327     END-IF.
 16328
 16329     MOVE EMI-LINE1              TO ERRMSG1O.
 16330
 16331 8000-EXIT.
 16332     EXIT.
 16333
 16334 8100-SEND-INITIAL-MAP.
 16335     MOVE SAVE-DATE              TO RUNDTEO.
 16336     MOVE EIBTIME                TO TIME-IN.
 16337     MOVE TIME-OUT               TO RUNTIMEO.
 16338     IF EIBAID = DFHPF11
 16339        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341     end-if
 16342     IF RETURNED-FROM = XCTL-114
 16343        CONTINUE
 16344     ELSE
 16345        MOVE -1                  TO MAINTL
 16346     END-IF.
 16347
 16348*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16349         MOVE SPACES             TO PRODO.
 16350         MOVE AL-SANOF           TO PRODCDA.
 16351*    END-IF.
 16352
 16353     MOVE PI-COMPANY-ID          TO COMPO.
 16354     MOVE AL-PABOF               TO COMPA.
 16355     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16356     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16357     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16358
 16359     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16360
 16361     IF NOT PI-NO-CARRIER-SECURITY
 16362        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 313
* EL130.cbl
 16363        MOVE AL-SABOF            TO CLMCARRA
 16364     END-IF.
 16365
 16366     IF PI-PROCESSOR-ID = 'PEMA'
 16367        MOVE AL-UANON            TO CERTNOA
 16368                                    SUFXA
 16369     END-IF.
 16370*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16371*        NEXT SENTENCE
 16372*        CONTINUE
 16373*    ELSE
 16374         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16375*    END-IF.
 16376
 16377
 16378
 16379* EXEC CICS SEND
 16380*        MAP     (MAP-NAME)
 16381*        MAPSET  (MAPSET-NAME)
 16382*        FROM    (EL130AO)
 16383*        ERASE
 16384*        CURSOR
 16385*    END-EXEC.
 16386     MOVE LENGTH OF
 16387      EL130AO
 16388       TO DFHEIV12
 16389     MOVE -1
 16390       TO DFHEIV11
 16391*    MOVE '8$     CT  E    H L F ,   #00014416' TO DFHEIV0
 16392     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16393     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16394     MOVE X'2020233030303134343136' TO DFHEIV0(25:11)
 16395     CALL 'kxdfhei1' USING DFHEIV0,
 16396           MAP-NAME,
 16397           EL130AO,
 16398           DFHEIV12,
 16399           MAPSET-NAME,
 16400           DFHEIV99,
 16401           DFHEIV99,
 16402           DFHEIV99,
 16403           DFHEIV11,
 16404           DFHEIV99,
 16405           DFHEIV99,
 16406           DFHEIV99
 16407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16408
 16409
 16410     GO TO 9100-RETURN-TRAN.
 16411
 16412 8150-SEND-MAP-CURSOR.
 16413     MOVE SAVE-DATE              TO RUNDTEO.
 16414     MOVE EIBTIME                TO TIME-IN.
 16415     MOVE TIME-OUT               TO RUNTIMEO.
 16416     IF EIBAID = DFHPF11
 16417        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16418        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16419     end-if
 16420     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 314
* EL130.cbl
 16421     MOVE AL-PABOF               TO COMPA
 16422     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16423     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16424     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16425
 16426*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16427         MOVE SPACES             TO PRODO.
 16428         MOVE AL-SANOF           TO PRODCDA.
 16429*    END-IF.
 16430
 16431     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16432
 16433     IF NOT PI-NO-CARRIER-SECURITY
 16434         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16435         MOVE AL-SABOF            TO CLMCARRA
 16436     END-IF.
 16437
 16438     IF PI-PROCESSOR-ID = 'PEMA'
 16439        MOVE AL-UANON            TO CERTNOA
 16440                                    SUFXA
 16441     END-IF.
 16442*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16443*        NEXT SENTENCE
 16444*        CONTINUE
 16445*    ELSE
 16446         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16447*    END-IF.
 16448
 16449
 16450
 16451* EXEC CICS SEND
 16452*        MAP      (MAP-NAME)
 16453*        MAPSET   (MAPSET-NAME)
 16454*        FROM     (EL130AO)
 16455*        CURSOR   (PI-CURSOR)
 16456*        ERASE
 16457*    END-EXEC.
 16458     MOVE LENGTH OF
 16459      EL130AO
 16460       TO DFHEIV11
 16461*    MOVE '8$     CT  E    H L F ,   #00014464' TO DFHEIV0
 16462     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16463     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16464     MOVE X'2020233030303134343634' TO DFHEIV0(25:11)
 16465     CALL 'kxdfhei1' USING DFHEIV0,
 16466           MAP-NAME,
 16467           EL130AO,
 16468           DFHEIV11,
 16469           MAPSET-NAME,
 16470           DFHEIV99,
 16471           DFHEIV99,
 16472           DFHEIV99,
 16473           PI-CURSOR,
 16474           DFHEIV99,
 16475           DFHEIV99,
 16476           DFHEIV99
 16477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16478
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 315
* EL130.cbl
 16479
 16480     GO TO 9100-RETURN-TRAN.
 16481
 16482 8200-SEND-DATAONLY.
 16483     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16484
 16485     IF EIBAID = DFHPF11
 16486        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16488        go to 8100-send-initial-map
 16489     end-if
 16490*    IF EIBAID = DFHPF11
 16491*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16492*       move pi-last-claim       to emi-claim-no
 16493*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16494*       go to 8100-send-initial-map
 16495*    END-IF.
 16496     .
 16497 8200-BYPASS-ERROR.
 16498     MOVE SAVE-DATE              TO RUNDTEO.
 16499     MOVE EIBTIME                TO TIME-IN.
 16500     MOVE TIME-OUT               TO RUNTIMEO.
 16501     MOVE PI-COMPANY-ID          TO COMPO.
 16502     MOVE AL-PABOF               TO COMPA
 16503     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16504
 16505*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16506         MOVE SPACES             TO PRODO.
 16507         MOVE AL-SANOF           TO PRODCDA.
 16508*    END-IF.
 16509
 16510     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16511     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16512
 16513     IF PI-PROCESSOR-ID = 'PEMA'
 16514        MOVE AL-UANON            TO CERTNOA
 16515                                    SUFXA
 16516     END-IF.
 16517     IF NOT PI-NO-CARRIER-SECURITY
 16518        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16519        MOVE AL-SABOF            TO CLMCARRA
 16520     END-IF.
 16521
 16522*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16523*        NEXT SENTENCE
 16524*        CONTINUE
 16525*    ELSE
 16526         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16527*    END-IF.
 16528
 16529*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16530         MOVE AL-SANOF           TO PRODCDA.
 16531*    END-IF.
 16532
 16533
 16534
 16535* EXEC CICS SEND
 16536*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 316
* EL130.cbl
 16537*        MAPSET   (MAPSET-NAME)
 16538*        FROM     (EL130AO)
 16539*        DATAONLY
 16540*        CURSOR
 16541*    END-EXEC.
 16542     MOVE LENGTH OF
 16543      EL130AO
 16544       TO DFHEIV12
 16545     MOVE -1
 16546       TO DFHEIV11
 16547*    MOVE '8$D    CT       H L F ,   #00014526' TO DFHEIV0
 16548     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16549     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16550     MOVE X'2020233030303134353236' TO DFHEIV0(25:11)
 16551     CALL 'kxdfhei1' USING DFHEIV0,
 16552           MAP-NAME,
 16553           EL130AO,
 16554           DFHEIV12,
 16555           MAPSET-NAME,
 16556           DFHEIV99,
 16557           DFHEIV99,
 16558           DFHEIV99,
 16559           DFHEIV11,
 16560           DFHEIV99,
 16561           DFHEIV99,
 16562           DFHEIV99
 16563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16564
 16565
 16566     GO TO 9100-RETURN-TRAN.
 16567
 16568 8300-SEND-TEXT.
 16569
 16570
 16571* EXEC CICS SEND TEXT
 16572*        FROM     (LOGOFF-TEXT)
 16573*        LENGTH   (LOGOFF-LENGTH)
 16574*        ERASE
 16575*        FREEKB
 16576*    END-EXEC.
 16577*    MOVE '8&      T  E F  H   F -   #00014538' TO DFHEIV0
 16578     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16579     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16580     MOVE X'2020233030303134353338' TO DFHEIV0(25:11)
 16581     CALL 'kxdfhei1' USING DFHEIV0,
 16582           LOGOFF-TEXT,
 16583           LOGOFF-LENGTH,
 16584           DFHEIV99,
 16585           DFHEIV99,
 16586           DFHEIV99,
 16587           DFHEIV99,
 16588           DFHEIV99,
 16589           DFHEIV99,
 16590           DFHEIV99,
 16591           DFHEIV99,
 16592           DFHEIV99,
 16593           DFHEIV99
 16594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 317
* EL130.cbl
 16595
 16596
 16597
 16598
 16599* EXEC CICS RETURN
 16600*    END-EXEC.
 16601*    MOVE '.(                    ''   #00014546' TO DFHEIV0
 16602     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16604     MOVE X'2020233030303134353436' TO DFHEIV0(25:11)
 16605     CALL 'kxdfhei1' USING DFHEIV0,
 16606           DFHEIV99,
 16607           DFHEIV99,
 16608           DFHEIV99,
 16609           DFHEIV99,
 16610           DFHEIV99,
 16611           DFHEIV99
 16612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16613
 16614
 16615 8800-UNAUTHORIZED-ACCESS.
 16616     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16617     GO TO 8300-SEND-TEXT.
 16618
 16619 8810-PF23.
 16620     MOVE EIBAID TO PI-ENTRY-CD-1.
 16621     MOVE XCTL-005               TO PGM-NAME.
 16622     GO TO 9300-XCTL.
 16623
 16624 8820-TERM-ERROR.
 16625     MOVE ER-0412                TO EMI-ERROR.
 16626     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16627     MOVE -1                     TO MAINTL.
 16628     GO TO 8200-SEND-DATAONLY.
 16629
 16630 8830-TRAN-ERROR.
 16631     MOVE ER-0413                TO EMI-ERROR.
 16632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16633     MOVE -1                     TO MAINTL.
 16634     GO TO 8200-SEND-DATAONLY.
 16635
 16636 9000-RETURN-CICS.
 16637
 16638
 16639* EXEC CICS RETURN
 16640*    END-EXEC.
 16641*    MOVE '.(                    ''   #00014572' TO DFHEIV0
 16642     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16644     MOVE X'2020233030303134353732' TO DFHEIV0(25:11)
 16645     CALL 'kxdfhei1' USING DFHEIV0,
 16646           DFHEIV99,
 16647           DFHEIV99,
 16648           DFHEIV99,
 16649           DFHEIV99,
 16650           DFHEIV99,
 16651           DFHEIV99
 16652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 318
* EL130.cbl
 16653
 16654
 16655 9100-RETURN-TRAN.
 16656     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16657     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16658
 16659
 16660
 16661* EXEC CICS RETURN
 16662*        TRANSID   (TRANS-ID)
 16663*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16664*        LENGTH    (PI-COMM-LENGTH)
 16665*    END-EXEC.
 16666*    MOVE '.(CT                  ''   #00014580' TO DFHEIV0
 16667     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16669     MOVE X'2020233030303134353830' TO DFHEIV0(25:11)
 16670     CALL 'kxdfhei1' USING DFHEIV0,
 16671           TRANS-ID,
 16672           PROGRAM-INTERFACE-BLOCK,
 16673           PI-COMM-LENGTH,
 16674           DFHEIV99,
 16675           DFHEIV99,
 16676           DFHEIV99
 16677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16678
 16679
 16680 9200-RETURN-MAIN-MENU.
 16681     MOVE XCTL-126               TO PGM-NAME.
 16682     GO TO 9300-XCTL.
 16683
 16684 9300-XCTL.
 16685
 16686
 16687* EXEC CICS XCTL
 16688*        PROGRAM   (PGM-NAME)
 16689*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16690*        LENGTH    (PI-COMM-LENGTH)
 16691*    END-EXEC.
 16692*    MOVE '.$C                   %   #00014592' TO DFHEIV0
 16693     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16694     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16695     MOVE X'2020233030303134353932' TO DFHEIV0(25:11)
 16696     CALL 'kxdfhei1' USING DFHEIV0,
 16697           PGM-NAME,
 16698           PROGRAM-INTERFACE-BLOCK,
 16699           PI-COMM-LENGTH,
 16700           DFHEIV99
 16701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16702
 16703
 16704 9400-CLEAR.
 16705     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16706     GO TO 9300-XCTL.
 16707
 16708 9500-PF12.
 16709     MOVE XCTL-010               TO PGM-NAME.
 16710     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 319
* EL130.cbl
 16711
 16712 9600-PGMID-ERROR.
 16713
 16714
 16715* EXEC CICS HANDLE CONDITION
 16716*        PGMIDERR  (8300-SEND-TEXT)
 16717*    END-EXEC.
 16718*    MOVE '"$L                   ! M #00014608' TO DFHEIV0
 16719     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16721     MOVE X'4D20233030303134363038' TO DFHEIV0(25:11)
 16722     CALL 'kxdfhei1' USING DFHEIV0
 16723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16724
 16725
 16726     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16727     MOVE ' '                    TO PI-ENTRY-CD-1.
 16728     MOVE XCTL-005               TO PGM-NAME.
 16729     MOVE PGM-NAME               TO LOGOFF-PGM.
 16730     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16731     GO TO 9300-XCTL.
 16732
 16733 9700-LINK-DATE-CONVERT.
 16734     MOVE LINK-ELDATCV           TO PGM-NAME.
 16735
 16736
 16737* EXEC CICS LINK
 16738*        PROGRAM    (PGM-NAME)
 16739*        COMMAREA   (DATE-CONVERSION-DATA)
 16740*        LENGTH     (DC-COMM-LENGTH)
 16741*    END-EXEC.
 16742*    MOVE '."C                   (   #00014622' TO DFHEIV0
 16743     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16745     MOVE X'2020233030303134363232' TO DFHEIV0(25:11)
 16746     CALL 'kxdfhei1' USING DFHEIV0,
 16747           PGM-NAME,
 16748           DATE-CONVERSION-DATA,
 16749           DC-COMM-LENGTH,
 16750           DFHEIV99,
 16751           DFHEIV99,
 16752           DFHEIV99,
 16753           DFHEIV99
 16754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16755
 16756
 16757 9700-EXIT.
 16758     EXIT.
 16759
 16760 9800-LINK-REM-TERM.
 16761     MOVE LINK-ELRTRM            TO PGM-NAME.
 16762
 16763
 16764* EXEC CICS LINK
 16765*        PROGRAM    (PGM-NAME)
 16766*        COMMAREA   (CALCULATION-PASS-AREA)
 16767*        LENGTH     (CP-COMM-LENGTH)
 16768*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 320
* EL130.cbl
 16769*    MOVE '."C                   (   #00014634' TO DFHEIV0
 16770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16772     MOVE X'2020233030303134363334' TO DFHEIV0(25:11)
 16773     CALL 'kxdfhei1' USING DFHEIV0,
 16774           PGM-NAME,
 16775           CALCULATION-PASS-AREA,
 16776           CP-COMM-LENGTH,
 16777           DFHEIV99,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV99
 16781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16782
 16783
 16784 9800-EXIT.
 16785     EXIT.
 16786
 16787 9900-ERROR-FORMAT.
 16788*    if emi-error = 1651 or 1652 or 1653 or 1655
 16789*       display ' 9900 error ' emi-error
 16790*       display emi-message-area (1)
 16791*       display emi-message-area (2)
 16792*       display emi-message-area (3)
 16793*    end-if
 16794     IF NOT EMI-ERRORS-COMPLETE
 16795         MOVE LINK-001           TO PGM-NAME
 16796
 16797* EXEC CICS LINK
 16798*            PROGRAM   (PGM-NAME)
 16799*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16800*            LENGTH    (EMI-COMM-LENGTH)
 16801*        END-EXEC
 16802*    MOVE '."C                   (   #00014652' TO DFHEIV0
 16803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16805     MOVE X'2020233030303134363532' TO DFHEIV0(25:11)
 16806     CALL 'kxdfhei1' USING DFHEIV0,
 16807           PGM-NAME,
 16808           ERROR-MESSAGE-INTERFACE-BLOCK,
 16809           EMI-COMM-LENGTH,
 16810           DFHEIV99,
 16811           DFHEIV99,
 16812           DFHEIV99,
 16813           DFHEIV99
 16814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16815         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16816            subtract 1 from emi-fatal-ctr
 16817         end-if
 16818     END-IF.
 16819
 16820     .
 16821 9900-EXIT.
 16822     EXIT.
 16823
 16824 9990-ABEND.
 16825     MOVE -1                     TO MAINTL.
 16826     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 321
* EL130.cbl
 16827     MOVE DFHEIBLK               TO EMI-LINE1.
 16828
 16829
 16830* EXEC CICS LINK
 16831*        PROGRAM   (PGM-NAME)
 16832*        COMMAREA  (EMI-LINE1)
 16833*        LENGTH    (72)
 16834*    END-EXEC.
 16835     MOVE 72
 16836       TO DFHEIV11
 16837*    MOVE '."C                   (   #00014671' TO DFHEIV0
 16838     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16840     MOVE X'2020233030303134363731' TO DFHEIV0(25:11)
 16841     CALL 'kxdfhei1' USING DFHEIV0,
 16842           PGM-NAME,
 16843           EMI-LINE1,
 16844           DFHEIV11,
 16845           DFHEIV99,
 16846           DFHEIV99,
 16847           DFHEIV99,
 16848           DFHEIV99
 16849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16850
 16851
 16852     MOVE EMI-LINE1              TO ERRMSG2O.
 16853
 16854     GO TO 8200-BYPASS-ERROR.
 16855
 16856
 16857
 16858* GOBACK.
 16859     MOVE '9%                    "   ' TO DFHEIV0
 16860     MOVE 'EL130' TO DFHEIV1
 16861     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16862     GOBACK.
 16863
 16864 9995-SECURITY-VIOLATION.
 16865*             COPY ELCSCTP.
 16866******************************************************************
 16867*                                                                *
 16868*                            ELCSCTP                             *
 16869*                            VMOD=2.001                          *
 16870*                                                                *
 16871*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16872******************************************************************
 16873
 16874
 16875     MOVE EIBDATE          TO SM-JUL-DATE.
 16876     MOVE EIBTRMID         TO SM-TERMID.
 16877     MOVE THIS-PGM         TO SM-PGM.
 16878     MOVE EIBTIME          TO TIME-IN.
 16879     MOVE TIME-OUT         TO SM-TIME.
 16880     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16881
 16882
 16883* EXEC CICS LINK
 16884*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 322
* EL130.cbl
 16885*         COMMAREA (SECURITY-MESSAGE)
 16886*         LENGTH   (80)
 16887*    END-EXEC.
 16888     MOVE 'EL003' TO DFHEIV1
 16889     MOVE 80
 16890       TO DFHEIV11
 16891*    MOVE '."C                   (   #00014702' TO DFHEIV0
 16892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16894     MOVE X'2020233030303134373032' TO DFHEIV0(25:11)
 16895     CALL 'kxdfhei1' USING DFHEIV0,
 16896           DFHEIV1,
 16897           SECURITY-MESSAGE,
 16898           DFHEIV11,
 16899           DFHEIV99,
 16900           DFHEIV99,
 16901           DFHEIV99,
 16902           DFHEIV99
 16903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16904
 16905
 16906******************************************************************
 16907
 16908
 16909 9995-EXIT.
 16910     EXIT.
 16911
 16912
 16913 9999-DFHBACK SECTION.
 16914     MOVE '9%                    "   ' TO DFHEIV0
 16915     MOVE 'EL130' TO DFHEIV1
 16916     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16917     GOBACK.
 16918 9999-DFHEXIT.
 16919     IF DFHEIGDJ EQUAL 0001
 16920         NEXT SENTENCE
 16921     ELSE IF DFHEIGDJ EQUAL 2
 16922         GO TO 0100-TEST-ENTRY,
 16923               8100-SEND-INITIAL-MAP,
 16924               9600-PGMID-ERROR,
 16925               8820-TERM-ERROR,
 16926               8830-TRAN-ERROR,
 16927               9990-ABEND
 16928         DEPENDING ON DFHEIGDI
 16929     ELSE IF DFHEIGDJ EQUAL 3
 16930         GO TO 0450-ADD-ELACTQ-RECORD
 16931         DEPENDING ON DFHEIGDI
 16932     ELSE IF DFHEIGDJ EQUAL 4
 16933         GO TO 8820-TERM-ERROR,
 16934               8830-TRAN-ERROR
 16935         DEPENDING ON DFHEIGDI
 16936     ELSE IF DFHEIGDJ EQUAL 5
 16937         GO TO 0660-NOT-FOUND,
 16938               0670-QIDERR
 16939         DEPENDING ON DFHEIGDI
 16940     ELSE IF DFHEIGDJ EQUAL 6
 16941         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16942         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 323
* EL130.cbl
 16943     ELSE IF DFHEIGDJ EQUAL 7
 16944         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16945         DEPENDING ON DFHEIGDI
 16946     ELSE IF DFHEIGDJ EQUAL 8
 16947         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16948         DEPENDING ON DFHEIGDI
 16949     ELSE IF DFHEIGDJ EQUAL 9
 16950         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16951         DEPENDING ON DFHEIGDI
 16952     ELSE IF DFHEIGDJ EQUAL 10
 16953         GO TO 2050-DELETE-NOT-FOUND
 16954         DEPENDING ON DFHEIGDI
 16955     ELSE IF DFHEIGDJ EQUAL 11
 16956         GO TO 2010-DELETE-CL
 16957         DEPENDING ON DFHEIGDI
 16958     ELSE IF DFHEIGDJ EQUAL 12
 16959         GO TO 3010-TEST-FOR-ERRORS
 16960         DEPENDING ON DFHEIGDI
 16961     ELSE IF DFHEIGDJ EQUAL 13
 16962         GO TO 3008-DUP-ERROR,
 16963               3009-NOT-FOUND
 16964         DEPENDING ON DFHEIGDI
 16965     ELSE IF DFHEIGDJ EQUAL 14
 16966         GO TO 3030-BUILD-CONT
 16967         DEPENDING ON DFHEIGDI
 16968     ELSE IF DFHEIGDJ EQUAL 15
 16969         GO TO 3033-ACCT-NOT-FOUND,
 16970               3033-ACCT-NOT-FOUND
 16971         DEPENDING ON DFHEIGDI
 16972     ELSE IF DFHEIGDJ EQUAL 16
 16973         GO TO 3032-NOT-IN-DT-RANGE
 16974         DEPENDING ON DFHEIGDI
 16975     ELSE IF DFHEIGDJ EQUAL 17
 16976         GO TO 3070-BUILD-CONT
 16977         DEPENDING ON DFHEIGDI
 16978     ELSE IF DFHEIGDJ EQUAL 18
 16979         GO TO 3065-CERT-NOT-FOUND
 16980         DEPENDING ON DFHEIGDI
 16981     ELSE IF DFHEIGDJ EQUAL 19
 16982         GO TO 3100-CARRIER-NOT-FOUND
 16983         DEPENDING ON DFHEIGDI
 16984     ELSE IF DFHEIGDJ EQUAL 20
 16985         GO TO 3110-COMPANY-NOT-FOUND
 16986         DEPENDING ON DFHEIGDI
 16987     ELSE IF DFHEIGDJ EQUAL 21
 16988         GO TO 3200-BUILD-ZERO-TRAILER
 16989         DEPENDING ON DFHEIGDI
 16990     ELSE IF DFHEIGDJ EQUAL 22
 16991         GO TO 9999-DFHBACK
 16992         DEPENDING ON DFHEIGDI
 16993     ELSE IF DFHEIGDJ EQUAL 23
 16994         GO TO 3290-NO-INSURED-ADDRESS
 16995         DEPENDING ON DFHEIGDI
 16996     ELSE IF DFHEIGDJ EQUAL 24
 16997         GO TO 3410-DUP-KEY
 16998         DEPENDING ON DFHEIGDI
 16999     ELSE IF DFHEIGDJ EQUAL 25
 17000         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 324
* EL130.cbl
 17001         DEPENDING ON DFHEIGDI
 17002     ELSE IF DFHEIGDJ EQUAL 26
 17003         GO TO 3850-CLAIM-MSTR-WRITTEN
 17004         DEPENDING ON DFHEIGDI
 17005     ELSE IF DFHEIGDJ EQUAL 27
 17006         GO TO 5050-CERT-NOT-FOUND
 17007         DEPENDING ON DFHEIGDI
 17008     ELSE IF DFHEIGDJ EQUAL 28
 17009         GO TO 5030-CERT-WRITTEN
 17010         DEPENDING ON DFHEIGDI
 17011     ELSE IF DFHEIGDJ EQUAL 29
 17012         GO TO 5035-CLAIM-WRITTEN
 17013         DEPENDING ON DFHEIGDI
 17014     ELSE IF DFHEIGDJ EQUAL 30
 17015         GO TO 9990-ABEND,
 17016               5799-EXIT
 17017         DEPENDING ON DFHEIGDI
 17018     ELSE IF DFHEIGDJ EQUAL 31
 17019         GO TO 3100-CARRIER-NOT-FOUND
 17020         DEPENDING ON DFHEIGDI
 17021     ELSE IF DFHEIGDJ EQUAL 32
 17022         GO TO 6040-NO-PROCESSOR-RECORD
 17023         DEPENDING ON DFHEIGDI
 17024     ELSE IF DFHEIGDJ EQUAL 33
 17025         GO TO 6060-NO-BENEFICIARY-RECORD
 17026         DEPENDING ON DFHEIGDI
 17027     ELSE IF DFHEIGDJ EQUAL 34
 17028         GO TO 6499-EXIT,
 17029               6499-EXIT
 17030         DEPENDING ON DFHEIGDI
 17031     ELSE IF DFHEIGDJ EQUAL 35
 17032         GO TO 6600-NOT-FOUND
 17033         DEPENDING ON DFHEIGDI
 17034     ELSE IF DFHEIGDJ EQUAL 36
 17035         GO TO 6700-NOTOPEN-ERROR,
 17036               6700-EXIT
 17037         DEPENDING ON DFHEIGDI
 17038     ELSE IF DFHEIGDJ EQUAL 37
 17039         GO TO 7120-NOT-FOUND
 17040         DEPENDING ON DFHEIGDI
 17041     ELSE IF DFHEIGDJ EQUAL 38
 17042         GO TO 7499-EXIT
 17043         DEPENDING ON DFHEIGDI
 17044     ELSE IF DFHEIGDJ EQUAL 39
 17045         GO TO 7500-EXIT,
 17046               7500-DUPLICATE-KEY,
 17047               7500-EXIT
 17048         DEPENDING ON DFHEIGDI
 17049     ELSE IF DFHEIGDJ EQUAL 40
 17050         GO TO 7500-END-BROWSE
 17051         DEPENDING ON DFHEIGDI
 17052     ELSE IF DFHEIGDJ EQUAL 41
 17053         GO TO 7630-END-BROWSE
 17054         DEPENDING ON DFHEIGDI
 17055     ELSE IF DFHEIGDJ EQUAL 42
 17056         GO TO 7799-EXIT,
 17057               7799-EXIT
 17058         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 325
* EL130.cbl
 17059     ELSE IF DFHEIGDJ EQUAL 43
 17060         GO TO 7790-END-BROWSE
 17061         DEPENDING ON DFHEIGDI
 17062     ELSE IF DFHEIGDJ EQUAL 44
 17063         GO TO 7992-NOT-FOUND
 17064         DEPENDING ON DFHEIGDI
 17065     ELSE IF DFHEIGDJ EQUAL 45
 17066         GO TO 8300-SEND-TEXT
 17067         DEPENDING ON DFHEIGDI.
 17068     MOVE '9%                    "   ' TO DFHEIV0
 17069     MOVE 'EL130' TO DFHEIV1
 17070     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17071     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12280     Code:       54100
